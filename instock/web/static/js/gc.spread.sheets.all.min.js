/*!
 * 
 * SpreadJS Library 17.0.10
 *
 * Copyright(c) of respective holders.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 *
 */
var GC;!function(){var e,i,t;function r(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,r)),n.exports}e={"./all.entry.js":function(t,n,e){(GC=GC||{}).Spread=GC.Spread||{},GC.Spread=e("./node_modules_local/@spreadjs/js-sheets-common/index.js"),GC.Spread.CalcEngine=e("./node_modules_local/@spreadjs/js-calc/index.js"),GC.Spread.CalcEngine.BasicFunctions=e("./node_modules_local/@spreadjs/js-calc-basicfunctions/index.js"),GC.Spread.CalcEngine.AdvancedFunctions=e("./node_modules_local/@spreadjs/js-calc-advancedfunctions/index.js"),GC.Data=e("./node_modules_local/@spreadjs/js-data-manager/index.js"),GC.Spread.Sheets=e("./dist/core/core.entry.js"),GC.Spread.Sheets.Bindings=e("./dist/plugins/data/data.entry.js"),GC.Spread.Sheets.Outlines=e("./dist/plugins/group/group.entry.js"),GC.Spread.Sheets.CalcEngine=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),GC.Spread.Sheets.ConditionalFormatting=e("./dist/plugins/conditional/conditional.entry.js"),GC.Spread.Sheets.DataValidation=e("./dist/plugins/validation/datavalidation.entry.js"),GC.Spread.Sheets.Search=e("./dist/plugins/search/search.entry.js"),GC.Spread.Sheets.Touch=e("./dist/plugins/touch/touch.entry.js"),GC.Spread.Sheets.FloatingObjects=e("./dist/plugins/floatingObject/floatingobject.entry.js"),GC.Spread.Sheets.Sparklines=e("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),GC.Spread.Sheets.Comments=e("./dist/plugins/comment/comment.entry.js"),GC.Spread.Sheets.CellState=e("./dist/plugins/cellState/cellstate.entry.js"),GC.Spread.Sheets.CellTypes=e("./dist/plugins/celltype/celltypes.entry.js"),GC.Spread.Sheets.Filter=e("./dist/plugins/filter/filter.entry.js"),GC.Spread.Sheets.Tables=e("./dist/plugins/table/table.entry.js"),GC.Spread.Sheets.Fill=e("./dist/plugins/fill/fill.entry.js"),GC.Spread.Sheets.ContextMenu=e("./dist/plugins/contextMenu/context-menu.entry.js"),GC.Spread.Sheets.FormulaTextBox=e("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),GC.Spread.Sheets.OutlineColumn=e("./dist/plugins/outlineColumn/outlineColumn.entry.js"),GC.Spread.Sheets.DragMerge=e("./dist/plugins/dragMerge/dragMerge.entry.js"),GC.Spread.Sheets.StatusBar=e("./dist/plugins/statusBar/statusBar.entry.js"),GC.Spread.Sheets.AutoMerge=e("./dist/plugins/autoMerge/autoMerge.js"),GC.Spread.Sheets.Hyperlink=e("./dist/plugins/hyperlink/hyperlink.js"),GC.Spread.Sheets.NameBox=e("./dist/plugins/namebox/namebox.entry.js"),GC.Spread.Sheets.InputMask=e("./dist/plugins/inputMask/inputMask.entry.js"),t.exports=GC.Spread},"./dist/core/celltype/basecelltype.js":function(n,u,t){"use strict";var c,v,ht,dt,m,Z,e,l,h,d,p,t,W,o,Q,Mt,J,vt,y,M,K,F,et,C,L,S,A,X,q,$,_,tt,b,j,I,mt,N,gt,pt,Ct,i,bt,r,s,T,wt,St,D,O,k,E,R,B,P,G,x,U,a,H;function nt(t){var n=t.isPrinting,t=t.printZoomFactor;return n&&typeof t===b&&1!==t}function V(t){var n;return!(t instanceof CanvasRenderingContext2D)&&!C(t._ae)}function z(t,n){var e,i,r,e=0,i=t.font+n,r=!V(t);return r&&O[i]?e=O[i]:(e=K(t,t.font,n),r&&(O[i]=e)),e}function w(){}function Y(t,n){var e;return n/2-t/2+(8<t?mt((t-8)/5+2):1)-1}function it(t,n,e){return W(t.x)||(t.x+=n.width),t.width=t.width-n.width-e.width,t}function rt(t,n,e,i,r){var o,a,o=e+" - "+n+" - "+t;return u.wordWrapInfoCache||(u.wordWrapInfoCache={}),a=2e3,C(u.clearCacheTimer)&&(u.clearCacheTimer=setTimeout(function(){u.wordWrapInfoCache=null,u.clearCacheTimer=null},a)),u.wordWrapInfoCache[o]||(u.wordWrapInfoCache[o]=ht.q.un(t,n,e,!1,r)),u.wordWrapInfoCache[o]}function ot(t,n){return dt.W.gfe(t,Z.IconPosition.left)&&(n+=1),dt.W.gfe(t,Z.IconPosition.right)&&(n+=2),n}function at(t,n){return dt.W.gfe(t,Z.IconPosition.left)&&--n,dt.W.gfe(t,Z.IconPosition.right)&&(n-=2),n}function Tt(t,n,e,i,r,o){var n=new ht.Rect(t?t.x:n+1,t?t.y:e+1,t?t.width:i-2,t?t.height:r-2);return n=o?n.getIntersectRect(o):n}function ut(t,n,e){var t=t.text;return(t=e?(0,ht.r2e)(t):t)===n}function f(){this.allowOverflow=!1,this.typeName="0"}function st(t,n,e,i){var r,o,r=t.conditionalFormats;return r&&(o=t.getValue(n,e,i),r.O(n,e,i))&&r.U(t,n,e,o,i).iconSet}function ct(t,n,e){for(var i,r,o,i=0,r=0;r<t.length;r++)o=void 0,o=t[r].style&&t[r].style.font?t[r].style.font:n,i=Math.max(Q(o,I,J(t[r].text))/e,i),(t[r].style&&1===t[r].style.vertAlign||2===t[r].style.vertAlign)&&(i=Math.max(Q(o,I,J(t[r].text))/e+2*dt.W.V(o,D).fontSize*.218,i));return i}function ft(t,n,e,i,r){var o,a,u,s,c,f,o=ht.q.J();if(!o)return 0;for(u=a=0;u<t.length;u++)s=void 0,s=t[u].style&&t[u].style.font?t[u].style.font:n,t[u].style&&t[u].style.vertAlign&&(s=dt.W.V(s,D).font),vt(o,s),c="",c=u===t.length-1&&r?ht.q.tt(t[u].text):t[u].text,f=0,i?f=Q(s)*c.length/e:W(t[u].text)||(f=K(o,s,t[u].text)/e),a+=f;return a}function lt(t,n,e,i,r){var o,a,u,o;if(!ht.q.J())return 0;for(u=a=0;u<t.length;u++)a+=ft(t[u],n,e,i,r);return a}function At(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,s,a,m,g,w,y,M,C,S,T,p,b,c=a.backColor,f=a.backgroundImage,l=a.textOrientation,h=a.isVerticalText,d=a.textIndent&&0!==a.textIndent,v=a.backgroundImageLayout,m=s.row,g=s.col,p=s.sheet,b=p.Jt,s=s.sheet&&s.sheet.getSpan(m,g,s.sheetArea),a=a&&(a.borderLeft||a.borderTop||a.borderRight||a.borderBottom),w=0,y=n;t.save(),g+1<p.getColumnCount()&&(S=b.qt(m,g+1)),0<=g-1&&(T=b.qt(m,g-1)),p=function(t){return t!==I&&t&&-90<=t&&t<=90},b=function(){t.fillRect(n,e,i,r)},l&&0!==l&&a&&u&&!s&&!h&&!d&&(m=bt(l*Math.PI/180),g=Ct(m),w=mt(r/g),-90<l&&l<0&&(S&&!p(S.textOrientation)&&(C=S.backColor),y=n-w),0<l&&l<90&&(T&&!p(T.textOrientation)&&(C=T.backColor),y=n+w),M=function(){t.beginPath(),t.moveTo(y,e),t.lineTo(y+i,e),t.lineTo(n+i,e+r),t.lineTo(n,e+r),t.fill()}),(c||f)&&(C&&dt.W.setFillStyle(t,C,n,e,i,r,b),M?dt.W.setFillStyle(t,c,Math.min(y,n),e,i+w,r,M):c&&dt.W.setFillStyle(t,c,n,e,i,r,b),x.nt(t,n,e,i,r,f,v,o)),t.restore()}function It(t,n,e,i,r,o,a){var t;(0===t||5===t||a)&&st(n,e,i,r)&&(t=xt(n),o.x+=t,o.width-=t)}function xt(t){return parseInt(_*t.zoom(),10)}function yt(t,n,e,i){var r=t.cellPadding,o=0,t=t.labelOptions;return(r=e?t?t.margin:"0":r)&&(o=typeof(o=parseInt(Et(r)[n],10))===b&&0<o?o:0),i===I?o:o*i}function Nt(t){var n={context:t,value:0};return a.et(t.sheet,"getOutlineColumnOffset",n),n.value}function kt(t,n){var n={context:t,value:0,cellStyle:n};return a.et(t.sheet,"getCellButtonAutoWidth",n),n.value}function _t(t,n){var n={context:t,value:0,cellStyle:n};return vn(n),a.et(t.sheet,"getSpecialIconsAutoWidth",n),n.value}function Dt(t,n){var n={context:t,value:0,cellStyle:n};return a.et(t.sheet,"getCellButtonAutoHeight",n),n.value}function jt(t,n){var n={context:t,value:0,cellStyle:n};return mn(n),a.et(t.sheet,"getSpecialIconsAutoHeight",n),n.value}function Ot(t,n,e,i){var r,i,r,n,o,r=i&&i.sheet;r&&e&&(i=i.canvasOffset||r.rt.it(),r=r.ot(),(n=(n=n.backColor||"white").stops?(o=n.stops)[0]&&o[0].color:n).backgroundColor&&(n=n.backgroundColor),(0,v.GC$)(t).width(e.width).height(e.height).css({top:i.top+r.y+e.y-2,left:i.left+r.x+e.x-2,"background-color":n}))}function Et(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===tt&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}function Rt(t,n){var e,i,r,o,a,e=yt(t,0),i=yt(t,2),r=yt(t,0,!0),o=yt(t,2,!0);if(!(yt(t,3,!0)+yt(t,1,!0)>=n.width))if(0===(a=(a=t.labelOptions.alignment)===I?t.labelOptions.alignment=0:a)||1===a||2===a){if(0<e&&r+o<e)return 1}else if((3===a||4===a||5===a)&&e<n.height&&0<i&&r+o<i)return 1}function Ft(t,n){var e,i,r,o,a,e=yt(n,0),i=yt(n,3,!0),r=yt(n,2,!0),o=t.clone(),a=n.labelOptions.alignment;return 0===a||1===a||2===a?e<t.height&&(o.height=e-r+1):3!==a&&4!==a&&5!==a||(o.height=t.height-r),o.x+=i,o.width-=i+yt(n,1,!0),o}function Lt(t){var n="left";return 1===t||4===t?n="center":2!==t&&5!==t||(n="right"),n}function Bt(t,n,e,i){var r,e,o,a,u,s,c,t,f,l,h,i,d,v,r=new ht.Point(t.x,t.y),e=parseInt(e.fontSize,10),o=yt(n,0),a=yt(n,2),u=yt(n,3,!0),s=yt(n,1,!0),c=t.width,t=t.height,f,l,h=8<e?1:2,i=i-(i/2-e/2+(8<e?Math.floor((e-8)/5+2):1)-1)+yt(n,0,!0),d=i+1,v=t<o+a?o+i:t-a+i-1;switch(n.labelOptions.alignment){case 0:r.x+=u+h+1,r.y+=d;break;case 1:r.x+=u+(c-u-s)/2,r.y+=d;break;case 2:r.x+=c-s-2,r.y+=d;break;case 3:r.x+=u+h+1,r.y+=v;break;case 4:r.x+=u+(c-u-s)/2,r.y+=v;break;case 5:r.x+=c-s-2,r.y+=v}return r}function Pt(t,n){var e,i,r,o,a,u,e=yt(n,3,!0),i=yt(n,1,!0),r=yt(n,0,!0),o=yt(n,2,!0),a=t.clone(),u=n.labelOptions.alignment;return a.x=e+1,a.width-=e+i,0===u||1===u||2===u?(a.y=r,a.height=yt(n,0)-r-o):3!==u&&4!==u&&5!==u||(a.y=t.height-yt(n,2)+r,a.height=yt(n,2)-r-o),2!==u&&5!==u||(a.width-=2),a}function Gt(t,n,e){var i,r;if(o(n,tt))return z(t,n);if(e&&n&&n[0]&&n[0].value)return n[0].value.length*Q(t.font);for(r=i=0;r<n.length;r++)"fillingChar"!==n[r].type&&(i+=z(t,n[r].value));return i}function Ut(t){for(var n,e,i,r,o,n=t[0].type,e=0,i=[t[0]],r=1;r<t.length;r++)o=t[r],n===T&&o.type===T?i[e].value+=o.value:(i.push(o),n=o.type,e++);return i}function Ht(t,n,e,i,r){var i,i=i?Math.floor(n/r):Math.floor(n/K(t,t.font,e));return new Array(i+1).join(e)}function Vt(t){var t=t.clone();return t.width--,t.height--,t}function zt(t,n,e,i){for(var r,o,a,r=0;r<t.length;r++)o=void 0,t[r].style=t[r].style||{},(a=t[r].style).font?(o=dt.W.V(a.font,e).font,W(i)||(o=dt.W.V(o,i).font)):o="object"==typeof n?n.font:n,a.font=o}function Yt(t,n,e,i,r){var o=e*pt(-i)+r*gt(-i),e=e*pt(-i)+r*gt(-i),a,u;return new ht.Rect(t-o/2,n-e/2,o,e)}function Zt(t){return"string"==typeof t.src&&0<t.src.length&&-1===t.src.indexOf("<script")}function Wt(t,n,e,i){var r,r,r,o;C(e)||(a.et(i.sheet,"beforePaintDecoration",o={context:i,style:e}),null!=(r=e.decoration)&&r.cornerFold&&Qt(t,n,e.decoration.cornerFold,i),0<(null==(r=null==(r=e.decoration)?void 0:r.icons)?void 0:r.length)&&Jt(t,n,e.decoration.icons.filter(Zt),e.vAlign,i))}function Qt(t,n,e,i){var r,o,e,a,u,s,n,c,r,i,e,f,l,h,d,r=e.size,o=e.position,e=e.color;C(r)&&(r=6),C(o)&&(o=m.CornerPosition.leftTop),a=n.x,u=n.y,s=n.height,n=n.width,r=r*(c=i.sheet).zoom(),t&&0<n&&0<s&&(t.save(),t.rect(a,u,n,s),t.clip(),t.fillStyle=e||"#FF3D00",t.beginPath(),t.fillStyle=e,d=h=l=f=e=i=void 0,o&m.CornerPosition.leftTop&&(f=i=a,l=(e=u)+r,h=i+r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&m.CornerPosition.rightBottom&&(l=(e=u+s)-r,h=(f=i=a+n)-r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&m.CornerPosition.leftBottom&&(f=i=a,l=(e=u+s)-r,h=i+r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&m.CornerPosition.rightTop&&(l=(e=u)+r,h=(f=i=a+n)-r,d=e,t.moveTo(i,e),t.lineTo(f,l),t.lineTo(h,d),t.fill()),t.closePath(),t.restore())}function Jt(t,n,e,i,r){var o,e,a,a,u,s,c;!r.cellOverflowLayout&&0<e.length&&(o=e.filter(function(t){return C(t.position)||t.position===Z.IconPosition.left}),e=e.filter(function(t){return t.position===Z.IconPosition.right}),0<(a=o.concat(e)).length)&&(hn(a,r),t)&&(a=dn(n.clone(),r),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),s=u=a.x,c=a.x+a.width,0<o.length&&(s=u=nn(t,o,a,i,r)),0<e.length&&(c=u=$t(t,e,a,i,r)),t.restore(),n.width=n.x+n.width-(a.x+a.width-c)-s,n.x=s)}function Kt(t,n,e,i,r){var o,e,a,u;t&&0<e.length&&(o=e.filter(function(t){return t.position===Z.IconPosition.outsideLeft&&Zt(t)}),e=e.filter(function(t){return t.position===Z.IconPosition.outsideRight&&Zt(t)}),a=3,u=n.x,0<o.length||0<e.length)&&(hn(o,r),hn(e,r),2===r.columnHeaderFitMode&&r.cornerX&&((n=n.clone()).height=n.height-(r.cornerY-n.y)-1,n.y=r.cornerY-1),0<o.length&&(n.x=u-3,Xt(t,o,n,i,r)),0<e.length)&&(n.x=u+3,qt(t,e,n,i,r))}function Xt(t,n,e,i,r){tn(t,n,e.x,e,i,r)}function qt(t,n,e,i,r){en(t,n,e.x+e.width,e,i,r)}function $t(t,n,e,i,r){return tn(t,n,e.x+e.width,e,i,r)}function tn(t,n,e,i,r,o){var a,u,s,c,a,u;for(e-=fn(o),s=n.length-1;0<=s;s--)e-=c=g(o,n[s],"width"),on(t,n[s],e,i.y,c,i.height,o,i,r);return e}function nn(t,n,e,i,r){return en(t,n,e.x,e,i,r)}function en(t,n,e,i,r,o){var a,u,s,c,a,u;for(e+=fn(o),s=0;s<n.length;s++)c=g(o,n[s],"width"),on(t,n[s],e,i.y,c,i.height,o,i,r),e+=c;return e}function rn(t,n){var e,i,r,o,n,a,t,u,u,n,e=n.ctx,i=n.style,r=n.context,o=n.textRect,n=n.availRect;!C(i.decoration)&&e&&(a="beforeFillTextArea"===t?Z.IconPosition.leftOfText:Z.IconPosition.rightOfText,t=i.decoration.icons&&i.decoration.icons.filter(function(t){return t.position===a&&Zt(t)}))&&0<t.length&&(hn(t,r),2===r.columnHeaderFitMode&&r.cornerX&&(u=r.cellRect.x+r.cellRect.width-(n.x+n.width),(n=n.clone()).width=r.cornerX-n.x-u,n.height=n.height-(r.cornerY-n.y)-1,n.y=r.cornerY-1),u=void 0,n=sn(n,o,a),e.save(),e.rect(n.x,n.y,n.width,n.height),e.clip(),e.beginPath(),a===Z.IconPosition.leftOfText?(u=$t(e,t,n,i.vAlign,r),o.x=u):(u=nn(e,t,n,i.vAlign,r),o.width=u-o.x),e.restore())}function on(t,n,e,i,r,o,a,u,s){var c,f,l,e,r,o,h,s,n,a,n,h,i,d;t.save(),t.beginPath(),t.rect(e,i,r,o),t.clip(),c=0,f=ln(a),l=n.src,f.getState(l)?f.qh(l)&&(e=new ht.Rect(e,i,r,o),r=g(a,n,"width"),o=g(a,n,"height"),s=cn(e,h=new ht.Rect(0,0,r,o),s,fn(a)),n.position!==Z.IconPosition.leftOfText&&n.position!==Z.IconPosition.rightOfText||((n=a.textRect)&&(s.y=wt(n.y-n.height/2-h.height/2,i+4)),s.y+s.height>e.y+e.height&&(s.y=wt(s.y-(s.y+s.height-e.y-e.height),e.y))),n=(a=f.getImage(l)).width,h=a.height,ht.mt.Tt.msie&&(E[l]||(a.style.position="absolute",a.style.left="-10000px",a.style.top="-100000px",document.body.appendChild(a),E[l]={width:a.width,height:a.height},document.body.removeChild(a)),n=E[l].width,h=E[l].height),u&&ht.mt.Tt.msie&&s.x+s.width>u.x+u.width?0<(i=c=u.x+u.width-s.x)&&t.drawImage(a,0,0,i*(d=n/r),h,N(s.x),N(s.y),i,o):(c=r,t.drawImage(a,0,0,n,h,N(s.x),N(s.y),c,o))):f.addImage(l,"anonymous"),t.restore()}function an(t){var n=t.context,e=t.style,t=t.externals;dt.W.Xue(e)&&(t.left=t.left.concat(un(n,e,Z.IconPosition.leftOfText)),t.right=t.right.concat(un(n,e,Z.IconPosition.rightOfText)))}function un(n,t,e){for(var i,r,o,a,i=!1,r=0,o=t.decoration.icons;r<o.length;r++)if((a=o[r]).v_i){i=!0;break}return t.decoration.icons.filter(function(t){return t.position===e&&(!n.cellOverflowLayout||i)}).map(function(t){return{width:g(n,t,"width"),height:g(n,t,"height"),isStick:t.v_i}})}function sn(t,n,e){switch(e){case Z.IconPosition.leftOfText:return new ht.Rect(t.x,t.y,n.x-t.x,t.height);case Z.IconPosition.rightOfText:return new ht.Rect(n.x+n.width,t.y,t.x+t.width-n.x-n.width,t.height)}}function cn(t,n,e,i){var r,o=2*i;switch(e){case Z.VerticalAlign.top:r=0+o;break;case Z.VerticalAlign.bottom:r=Math.max(0,t.height-n.height)-o;break;default:r=Math.max(0,(t.height-n.height)/2)}return new ht.Rect(t.x,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height))}function fn(t){return nt(t)?t.printZoomFactor:t.sheet.zoom()}function g(t,n,e){var n=n[e],e=fn(t);return(n=C(n)||isNaN(n)||n<=0?12:n)*e}function ln(t){var n=t.sheet,e;return n.MC||t.imageLoader||n.BO()}function hn(t,n){for(var e,i,r,e=ln(n),i=0;i<t.length;i++)(r=t[i].src)&&e.addImage(r,"anonymous")}function dn(t,n){return 2===n.columnHeaderFitMode&&n.cornerX&&(t.width=n.cornerX-t.x,t.height=t.height-(n.cornerY-t.y)-1,t.y=n.cornerY-1),t}function vn(t){gn(t,"width")}function mn(t){gn(t,"height")}function gn(t,n){var e,i,r,o,a,e=t.cellStyle;if(e.decoration&&e.decoration.icons&&0!==e.decoration.icons.length){for(i=e.decoration.icons,o=r=0;o<i.length;o++)a=i[o],dt.W.Kue(a)&&(r+=g(t.context,a,n));t.value=r}}function pn(t,n,e){var n,i,t,r,o,e,i,n=(t.length-1)*n,i=t[0],t=t[t.length-1],r,o=document.createElement("canvas").getContext("2d");return o.font=e.font,e=o.measureText(i),i=o.measureText(t),{height:n=e.actualBoundingBoxAscent+i.actualBoundingBoxDescent+n,descenderHeight:i.actualBoundingBoxDescent}}function bn(t,n,e,i,r,o,a,u){var s,c,f,l,h,s=e.content;if(s&&0<s.length)for(l=0<(l=o-a-(f=Gt(t,s,!0))-2)?l:0,h=void 0,c=0;c<s.length;c++)"fillingChar"===s[c].type||"numberPlaceholder"===s[c].type?r+=l:"placeholder"===s[c].type?r+=s[c].value?s[c].value.length*u:0:r+=h=s[c].value?s[c].value.length*u:0;else if(n)for(c=0;c<n.length;c++)r=wn(t,n[c],i,r).y;return r}function wn(t,n,e,i){var t,r,o,a;if(n&&0<n.length)for(t=t.font,r=Q(t,I,J(n)),o=Y(dt.W.V(t,1).fontSize,r),a=0;a<n.length;a++)i=i+r-o,i+=o;return{x:e,y:i}}Object.defineProperty(u,"__esModule",{value:!0}),u.Context=u.Base=u.paintStyleDecorationOutSideIcons=u.paintDecoration=u.clearCacheTimer=u.wordWrapInfoCache=void 0,c=t("Common"),v=t("./dist/core/util/domUtil.js"),ht=t("./dist/core/util/common.js"),dt=t("./dist/core/worksheet/stylehelper.js"),m=t("./dist/core/core.interface.js"),Z=t("./dist/core/core.enum.js"),e=t("./dist/core/celltype/celltype.ns.js"),l=t("CalcEngine"),h=c.Common.CultureManager,d=c.Common.st,p=c.Common.ct,t=c.Common.lt,W=t.ht,o=t.dt,Q=ht.mt.vt,Mt=ht.mt.gt,J=ht.mt.pt,vt=ht.mt.bt,y=ht.mt.yt,M=ht.mt.wt,K=ht.mt.Mt,F=ht.mt.Ct,et=ht.mt.St,C=c.Common.lt.ht,L=v.GC$.extend,S=ht.mt.Tt,A="left",X="right",q="center",$="alphabetic",_=16,tt="string",b="number",j=null,I=void 0,mt=Math.floor,N=Math.ceil,gt=Math.sin,pt=Math.cos,Ct=Math.tan,i=Math.PI,bt=Math.abs,r="none",s="General",T="text",wt=Math.max,St=Math.min,D=.7,O={},k="...",E={},B=" ",P=new RegExp(R="\xa0","g"),H=G={top:0,0:"top",right:1,1:"right",bottom:2,2:"bottom",left:3,3:"left"},w.At=function(t){var t,n,e,t=t.split("e")[1];if(t&&0<t.length&&("+"===t[0]?n=!0:"-"===t[0]&&(n=!1),e=t.slice(1)),void 0!==n)return{isAdd:n,length:e}},w.It=function(t,n,e){var i,r,i=w.xt,r=i[n+e];return r||(r=K(t,n,e),i[n+e]=r),r},w.Nt=function(t,n,e,i,r){var o,r,a,a,r,a,u,s,s,c,u,f,a,l,h,o,d,v,m,g,p,o=i.font;if(e=e-1-at(i,3)*r,r=i.textIndent&&0!==i.textIndent,a=i.isVerticalText,typeof n!==b||!0===i.shrinkToFit||a||r)return i._autoFormatter;if(a=n<0,n=bt(n),r=a?w.It(t,o,"-"):0,a=n.toString(),(u=w.At(a))&&!1===u.isAdd&&(s=ht.mt.toPlainString(n)).split(".")[1].length<10&&(a=s,u=I),s=void 0,c=w.Dt(i._autoFormatter,n),u)return s=u.length.toString().length,s=wt(s,2),w._t(t,e,i,s,r,u.isAdd,c);if(u=r,f=w.It(t,o,"0"),a=a.split("."),u+=h=f*(l=Math.round(n).toString().length),o=w.It(t,o,"."),d=void 0,h<=e){if(!a[1]||0===a[1].length)return i._autoFormatter;if((u=u+a[1].length*f+o)<=e)return i._autoFormatter;if(n<.001)return s=a[1].length.toString().length,s=wt(s,2),w._t(t,e,i,s,r,!1,c);for(m=Math.floor((v=e-r-h-o)/f),d="0",0<(m=Math.min(m,a[1].length))&&(d+="."),g=0;g<m;g++)d+="0";return d}return s=(p=Math.round(n)).toString().length.toString().length,s=wt(s,2),w._t(t,e,i,s,r,!0,c)},w._t=function(t,n,e,i,r,o,a){var e,u,s,c,f,l,h,n,r,d,v,m,e=e.font,u=w.It(t,e,"0"),s=w.It(t,e,"E"),c=w.It(t,e,"+"),f=w.It(t,e,"-"),l,h,n=n-r-i*u-s-(o?c:f)-u,r=n-w.It(t,e,".");if(r<=u)return o?"0E+00":0<n?"0E-00":"0";for(d=Math.floor(r/u),d=Math.min(d,a),v="0",m=0;m<d;m++)0===m&&(v+="."),v+="0";return v+=o?"E+00":"E-00"},w.Et=function(t,n,e,i,r){var o,r,a,u,s,i,c,f,l,o=i.font;if(e=e-1-at(i,3)*r,r=i.textIndent||0,u=e,(u=1!==(a=i.hAlign)&&0<r?e-8*r:e)<(s=K(t,o,n))){for(i=w.It(t,o,"#"),c=Math.floor(e/i),f="",l=0;l<c;l++)f+="#";return f}return n},w.nt=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w;if(o&&"none"!==o&&u)try{u.getState(o)?(s=u.getImage(o),c=void 0,S.msie&&((c=document.createElement("div")).appendChild(s),document.body.appendChild(c)),f=s.width,l=s.height,S.msie&&(c.removeChild(s),document.body.removeChild(c)),d=h=0,v=f,m=l,g=i,p=r,b=n,w=e,1===a?(v=f<=i?f:i,m=l<=r?l:r,b=f<i&&0<f?N(n+i/2-f/2):n,w=l<r&&0<l?N(e+r/2-l/2):e,g=v,p=m):2===a?0<r&&0<l&&f/l<i/r?b=n+i/2-(g=f/l*r)/2:0<i&&0<f&&l/f<r/i&&(w=e+r/2-(p=l/f*i)/2):3===a&&(g=v=f<=i?f:i,p=m=l<=r?l:r),t.drawImage(s,0,0,v,m,b,w,g,p)):u.addImage(o)}catch(t){}},w.Bt=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,b,y,M,C,S,C,T,A,I,S,t,C,x,N,k,t,o=0,a=r&&r.sheet,u=r.sheetArea,s=r.row,c=r.col,f=e.textIndent,l=e.hAlign,h=e.isVerticalText,d,v=1===u&&1===a.Lt(c)?-90:e.textOrientation,m=e.borderTop||e.borderBottom||e.borderLeft||e.borderRight,w=e.font;if(v&&-90<=v&&v<=90&&(b=bt(v*Math.PI/180),p=gt(b),b=pt(b)),a&&typeof n===tt&&n)if(y=[],M=void 0,t&&t.richText)if(C=e.formatter||e._autoFormatter,C=(S=a.getCellType(s,c,u)).Ft(C,t.text),zt(M=L(!0,[],S.Pt(t,n,C,w,e.foreColor)),w,i),h)if(e.wordWrap||5===l){if(T=a.Gt(s,u),(A=a.Ut.findSpan(s,c,u))&&A.row>=s&&A.col>=c&&1<A.rowCount)for(I=s+1;I<s+A.rowCount;I++)T+=a.Gt(I,u);for((S=0)<f&&(S=8*f*i),0<(t=yt(e,0))&&(T-=t),0<(C=yt(e,2))&&(T-=C),y=ht.q.Ht(n,++T-at(e,3)-S,w,M,h),g=0;g<y.length;g++)o+=ct(y[g].textInfos,w,i)}else o=ct(M,w,i);else{if(e.wordWrap||5===l){for(x=n.split(/\r\n|\r|\n/),g=0;g<x.length;g++)y.push((0,ht.zt)(x[g]));for(y=ht.q.Vt(y,ht.q.Yt(M)),g=0;g<y.length;g++)o=Math.max(o,lt(y[g],w,i,h,!0))}else o=ft(M,w,i);0<f&&4!==l&&(o+=1===l||5===l?8*f*2:8*f),st(a,s,c,r.sheetArea)&&(o+=xt(a))}else if(y=n.split(/\r\n|\r|\n/),k=Q(N=w)/i,h)if(e.wordWrap||5===l)for(g=0;g<y.length;g++)o+=k;else o=k;else{if(e.wordWrap||5===l){if(v)return t=a.Gt(s,u),ht.q.Zt(s,c,p,b,n,N,t);for(g=0;g<y.length;g++)o=Math.max(o,ht.q.Wt(y[g],N,!0)/i)}else o=v?m?(4+k)/p:b*(a.Qt(n,N)/i)+k*p:4===e.hAlign?a.Jt.Kt(c,u):a.Qt(n,N)/i;0<f&&4!==l&&(o+=1===l||5===l?8*f*2:8*f),st(a,s,c,r.sheetArea)&&(o+=_)}return o},w.Xt=function(t,n,e,i){for(var r,o,a,u,r=t.Jt.Kt(e,i),o=e+1;o<t.getColumnCount(i)&&(a=t.Jt.qt(n,o,i),u=t.Jt.$t(n,o,i,1,a),C(u))&&!a.watermark&&!(a.cellType&&"1"!==a.cellType.typeName||a.cellButtons&&0<a.cellButtons.length||dt.W.Jue(a))&&4===a.hAlign;o++)r+=t.Jt.Kt(o,i);return r},w.tn=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,h,I,x,N,h,k,h,A,_,A,D,_,j,O,l,E,R,o=0,u=r&&r.sheet,s=e.font,c=e.isVerticalText,f=e.textIndent,l=e.vAlign,h=e.hAlign,d=e.textOrientation,v=r.row,m=r.col,g=r.sheetArea,N=0<f?8*f*i:0;if(1!==h&&5!==h||(N*=2),d&&-90<=d&&d<=90&&(h=bt(d*Math.PI/180),I=gt(h),x=pt(h)),u&&typeof n===tt&&n)if(k=[],h=void 0,t&&t.richText)if(A=e.formatter||e._autoFormatter,A=(_=u.getCellType(v,m,g)).Ft(A,t.text),zt(h=L(!0,[],_.Pt(t,n,A,s,e.foreColor)),s,i),c){if(e.wordWrap||5===e.hAlign){for(D=n.split(/\r\n|\r|\n/),a=0;a<D.length;a++)k.push((0,ht.zt)(D[a]));for(k=ht.q.Vt(k,ht.q.Yt(h)),a=0;a<k.length;a++)o=Math.max(o,lt(k[a],s,i,c,!0))}else o=ft(h,s,i,c);0<f&&(o+=1===l?8*f*2:8*f)}else if(e.wordWrap||5===e.hAlign){if(p=u.nn(m,g),(y=u.Ut.findSpan(v,m,g))&&y.row>=v&&y.col>=m&&1<y.colCount)for(M=m+1;M<m+y.colCount;M++)p+=u.nn(M,g);for(S=yt(e,1),0<(T=yt(e,3))&&(p-=T),0<S&&(p-=S),k=ht.q.Ht(n,++p-at(e,3)-N,s,h),a=0;a<k.length;a++)o+=ct(k[a].textInfos,s,i)}else o=ct(h,s,i);else if(_=e.font,j=Q(_)/i,c){if(e.wordWrap||5===e.hAlign)for(k=n.split(/\r\n|\r|\n/),a=0;a<k.length;a++)O=k[a].length*j,o=Math.max(o,O);else o=n.length*j;0<f&&(o+=1===l?8*f*2:8*f)}else if(e.wordWrap||5===e.hAlign){if(g=r.sheetArea,p=4===e.hAlign?this.Xt(r.sheet,v,m,g):u.nn(m,g),b=u.Gt(v,g),(y=u.Ut.findSpan(v,m,g))&&y.row>=v&&y.col>=m&&1<y.colCount){for(M=m+1;M<m+y.colCount;M++)p+=u.nn(M,g);for(C=v+1;C<v+y.colCount;C++)b+=u.Gt(C,g)}if(S=yt(e,1),0<(T=yt(e,3))&&(p-=T),0<S&&(p-=S),0<(A=yt(e,0))&&(b-=A),0<(h=yt(e,2))&&(b-=h),e.cellButtons&&0<e.cellButtons.length&&(p-=kt(r,e)),dt.W.Jue(e)&&(p-=_t(r,e)),e.cellType&&e.cellType.Tfe&&(p-=e.cellType.Tfe(i)),1===g&&(E=!!((l=u.rowFilter&&u.rowFilter())&&l.rn(v,m,g)&&l.filterButtonVisible(m)))&&(p-=u.an(new ht.Rect(0,0,p,b),g).width),d)return k=ht.q.un(n,R=(b-j*x)/I,_),o=I*(w=u.Qt(k[0],_)/i)+j*x;o=(k=F(t)?[n]:ht.q.un(n,p-at(e,3)-N,_)).length*j}else o=d?I*(w=u.Qt(n,_)/i)+j*x:j;return o},w.cn=function(t,n,e,i,r,o,a,u,s,c,f){var l;1===s?(t.beginPath(),(l=t.createLinearGradient(n,e+1,n,e+r-2)).addColorStop(0,u.borderLeftColor),l.addColorStop(1,u.borderRightColor),t.strokeStyle!==l&&(t.strokeStyle=l),o.borderLeft||(t.moveTo(n+.5,e),t.lineTo(n+.5,e+r)),o.borderRight||(t.moveTo(n+i-.5,e),t.lineTo(n+i-.5,e+r)),c&&!o.borderTop&&(t.moveTo(n,e+.5),t.lineTo(n+i,e+.5)),t.stroke(),u.borderBottomWidth&&!o.borderBottom&&(t.beginPath(),t.strokeStyle!==u.borderBottomColor&&(t.strokeStyle=u.borderBottomColor),t.moveTo(n+1,e+r-.5),t.lineTo(n+i,e+r-.5),t.stroke())):(t.beginPath(),(l=t.createLinearGradient(n,e,n+i-2,e)).addColorStop(0,u.borderTopColor),l.addColorStop(1,u.borderBottomColor),t.strokeStyle!==l&&(t.strokeStyle=l),o.borderTop||(t.moveTo(n,e+.5),t.lineTo(n+i,e+.5)),o.borderBottom||(t.moveTo(n,e+r-.5),t.lineTo(n+i,e+r-.5)),f&&!o.borderLeft&&(t.moveTo(n+.5,e),t.lineTo(n+.5,e+r)),t.stroke(),u.borderRightWidth&&!o.borderRight&&(t.beginPath(),t.strokeStyle!==u.borderRightColor&&(t.strokeStyle=u.borderRightColor),t.moveTo(n+i-.5,e+1),t.lineTo(n+i-.5,e+r),t.stroke()))},w.hn=function(t,n){var n,n=2===n?"active":4===n?"inactive":0===n?"disabled":"auto";(0,v.GC$)(t).css("ime-mode",n)},w.dn=function(t,n,e,i,r,o,a){var u,s,s,c,f;return!!(n&&"SparklineExValue"===n.typeName&&(s=(u=a.sheet)&&u.parent)&&(s=s.getSparklineEx(n.name)))&&(f={zoomFactor:c=nt(a)?a.printZoomFactor:u.zoom(),sheet:u,rowIndex:a.row,columnIndex:a.col},2===a.columnHeaderFitMode&&(r=u.getColumnWidth(a.col,a.sheetArea)+1),s.paint(t,n.value,e,i,r,o,f),!0)},w.xt={},w.Dt=function(t,n){var e,t,n,n,t,t;return t&&t.vn&&(t=(e=t.vn(n)).format(n))&&t[1]&&"decimalSeparator"===t[1].type?(n=t[2])&&n.type===b?(n=n.value,t=(t=t[3])&&"exponent"===t.type&&t.value&&-1<t.value.indexOf("E"),!W(n)&&t?n.length:5):0:5},w.gn=yt,x=w,u.Context=x,U={"\u2329":1,"\u232a":1,"\u27e8":1,"\u27e9":1,"\u276c":1,"\u276d":1,"\u2770":1,"\u2771":1,"\u3008":1,"\u3009":1,"\u23a1":1,"\u23a6":1,"\u300c":1,"\u300d":1,"\uff62":1,"\uff63":1,"(":1,")":1,"[":1,"]":1,"\uff3b":1,"\uff3d":1,"{":1,"}":1,"\u2774":1,"\u2775":1,"\ufe5b":1,"\ufe5c":1,"\uff5b":1,"\uff5d":1,"\u3016":1,"\u3017":1,"\u2772":1,"\u2773":1,"\u3014":1,"\u3015":1,"\ufe5d":1,"\ufe5e":1,"\u3010":1,"\u3011":1,"\u27ea":1,"\u27eb":1,"\u300a":1,"\u300b":1,"\u300e":1,"\u300f":1},f.prototype.Rge=function(t,n){var e;f.et(t.sheet,"beforePaintCellContent",{context:t,style:n})},f.prototype.pn=function(t,n,e,i){var t={ctx:t,options:{rect:n,context:e,value:i}};return f.et(e.sheet,"paintCellPadding",t),t.options.rect},f.prototype.bn=function(t,n,e){var n={context:t,options:{dom:n,cellRect:e,contentRect:e.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)}};return f.et(t.sheet,"onCreateCellEditor",n),n.options.dom},f.prototype.yn=function(t,n,e){var n={ctx:null,options:{rect:n.clone(),context:t,value:null,style:e}};return f.et(t.sheet,"getCellButtonRect",n),n.options.rect},f.prototype.wn=function(t,n,e,i){var n={context:t,options:{dom:n,cellRect:e,cellStyle:i,contentRect:e.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)}};return f.et(t.sheet,"onActivateCellEditor",n),n},f.prototype.Mn=function(t,n,e,i){var n={context:t,contentContainer:n,editorBounds:e,cellStyle:i,contentRect:e.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)};return f.et(t.sheet,"onUpdateContainer",n),n},f.prototype.Cn=function(t,n,e){var n={context:t,options:{dom:n,cellRect:e,contentRect:e.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)}};return f.et(t.sheet,"onDeactivateCellEditor",n),n.options.dom},f.prototype.Sn=function(t,n,e){var i=this;i.deactivateEditor(t,n),i.Cn(n,t,e)},f.prototype.Tn=function(t,n,e,i){var r,o,a,u,i,u,o,i,o,u,s,r=e.labelOptions;r&&(o=i.sheet,a=e.watermark)&&(u=r.visibility,i=o.getText(i.row,i.col,i.sheetArea),1!==u)&&(2!==u&&u!==I||""!==i)&&(u=o.zoom(),i=void 0,i=(o=r.font)?dt.W.V(o,u):dt.W.Lge(e,1),o=Q(i.font),u=Ft(n,e),s=void 0,s=Rt(e,n)?Bt(n,e,i,o):s)&&(t.save(),t.textAlign=Lt(r.alignment),t.textBaseline="alphabetic",vt(t,i.font),t.fillStyle=r.foreColor||e.foreColor||"grey",t.rect(u.x,u.y,u.width,u.height),t.clip(),t.beginPath(),t.fillText(a,s.x,s.y),t.restore())},f.prototype.An=function(t,n,e){var i,r,o,a,n,i=t.clone(),r=yt(n,0,!1,e),o=yt(n,1,!1,e),a=yt(n,2,!1,e),n=yt(n,3,!1,e);return 0<r&&(i.y+=r,i.height-=r),0<a&&(i.height-=a),0<n&&(i.x+=n,i.width-=n),0<o&&(i.width-=o),o+n>=t.width&&(i.width=0),r+a>=t.height&&(i.height=0),i},f.prototype.In=function(t,n,e,i){var r,o,r,r=this,o=nt(i)?i.printZoomFactor:i.sheet.zoom();return n=r.An(n,e,o),f.et(i.sheet,"getCellPaddingRect",r={ctx:t,options:{rect:n,context:i}}),r.options.rect},f.prototype.xn=function(t,n,e,i){var r,o,i,a,u,s,c,o,f,l,n,a,h,d,r=e.labelOptions;r&&(i=(o=i.sheet).getText(i.row,i.col,i.sheetArea),a=e.watermark,1!==(u=r.visibility))&&a&&(s=r.font||e.font||o.Dn.Nn(),1!==(c=o.zoom())&&(s=o.Dn._n(s)),o=Q(s),f=Rt(e,n)?Pt(n,e):f)&&((l=(0,v.GC$)(ht.mt.En("span"))).text(a),n=(2===u||u===I)&&""===i,a=f.height-o,h=f.y+(n&&0<a?a:0),l.css({display:"block",position:"absolute",left:f.x,top:h,width:f.width,height:f.height,font:y(s),color:r.foreColor||e.foreColor||"grey",textAlign:Lt(r.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),(0,v.GC$)(t).append(l),n)&&(d=setInterval(function(){h--,l.css("top",h),h<=f.y&&clearInterval(d)},20))},f.prototype.jn=function(t){var n,e,i,r,i,n=this,e=ht.mt.En("div");return e.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(i=ht.mt.En("div")).style.cssText="position: absolute; outline: none; border: none",(0,v.GC$)(e).append((0,v.GC$)(i)),(r=n.createEditorElement(t,e))&&(0,v.GC$)(i).append((0,v.GC$)(r)),i=t.sheetArea,n.bn(t,e,t.sheet.getCellRect(t.row,t.col,1===i?-1:I,2===i?-1:I)),e},f.prototype.On=function(t,n,e,i){var r,e,e,o,a,u,e,s,o,c;t&&t.firstChild&&(r=this,Ot(t,n,e=Vt(e),i),o=(e=r.wn(i,t,e,n)).options.contentRect,a=e.options.cellRect,u=e.options.leftExternalRect,e=e.options.rightExternalRect,r.xn&&r.xn(t,o,n,i),s=i.sheet.zoom(),o=it(o=r.An?r.An(o,n,s):o,u,e),c=t.firstChild,(0,v.GC$)(c).css({left:(+(0,v.GC$)(c).css("left").replace("px","")||0)+yt(n,3,!1,s),top:(+(0,v.GC$)(c).css("top").replace("px","")||0)+yt(n,0,!1,s)}),r.activateEditor(t.firstChild.firstChild,n,o,i,a,u,e))},f.prototype.updateEditorContainer=function(t,n,e,i,r,o,a){var n,t,n,u,s,t;t&&n&&(t=(n=t.parentNode)?n.parentNode:I)&&r&&(n=(0,v.GC$)(t),u=r.width,s=r.height,0<u&&(n.width(u),t=t.lastChild,e)&&"gcEditorLabel"===t.getAttribute("gcUIElement")&&(0,v.GC$)(t).width(u-yt(e,3,!0)-yt(e,1,!0)-2),0<s&&n.height(s),W(r.x)||n.css("left",r.x+"px"),W(r.y)||n.css("top",r.y+"px"))},f.prototype.Rn=function(t,n,e,i){var r,o,e,t,e,a,u,t,o,a,a,u,t,s,c,e,r=this,o=t.firstChild,e=Vt(e);Ot(t,n,e,i),e=(t=r.Mn(i,o,e,n)).editorBounds,a=t.contentRect,u=t.leftExternalRect,t=t.rightExternalRect,o=o.firstChild,a=it(a=r.An?r.An(a,n,i.sheet.zoom()):a,u,t),a=r.updateEditor(o,n,a,i,e,u,t),u={width:u.width,height:u.height},t={width:t.width,height:t.height},c=!isNaN(a&&a.width)&&a.width+u.width+t.width>e.width?a.width+u.width+t.width:e.width,e=!isNaN(a&&a.height)&&a.height+u.height+t.height>e.height?a.height+u.height+t.height:e.height,r.updateEditorContainer(o,a,n,i,s={width:c,height:e},u,t)},f.prototype.Bn=function(t,n,e,i,r){return this.getCellAndPaddingHitInfo(t,n,e,i,r)},f.prototype.Ln=function(t,n,e,i,r){var o,t,o=kt(r,e)+Nt(r)+_t(r,e),t=this.getAutoFitWidth(t,n,e,i,r);return 0<t&&(o+=t+yt(e,3,!1)+yt(e,1,!1)),o},f.prototype.Fn=function(t,n,e,i,r){var o,t,o=0,t=this.getAutoFitHeight(t,n,e,i,r);return 0<t&&(o+=t+yt(e,0,!1)+yt(e,2,!1)),o=Math.max(jt(r,e),o),Math.max(Dt(r,e),o)},f.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,l,s=this,c={};u.quotePrefix=a.quotePrefix,(f=this.format(M(n),a.formatter||a._autoFormatter,c,u))&&(l=new ht.Rect(e,i,r,o),this.adjustRectForIconSet(a.hAlign,u.sheet,u.row,u.col,u.sheetArea,l,c.content&&this.hasInfilling(c.content)),e=l.x,r=l.width,l=s.Pn(t,f,a,u,e,i,r,o),this.paintText(t,n,e,i,r,o,a,u,f,c,I,l.externals))},f.prototype.Gn=function(t,n,e,i){var t=0<t?8*t*i:0;return t=n&&n.Un(e)?0:t},f.prototype.Ft=function(t,n){return!!(!t||o(t,tt)&&t===s||t&&t.formatString&&t.formatString()===s)||!(n&&(!isNaN(n)||"TRUE"===n.toUpperCase()||"FALSE"===n.toUpperCase())&&"@"!==t)},f.prototype.Hn=function(t){for(var n,e,n=0,e=0;e<t.length;e++)n+=t[e].width;return n},f.prototype.Fge=function(t){for(var n,t,e,i,r,o,a,n=t.left,t=t.right,e=0,i=n;e<i.length;e++)if((r=i[e]).isStick)return!0;for(o=0,a=t;o<a.length;o++)if((r=a[o]).isStick)return!0;return!1},f.prototype.zn=function(t){for(var n,e,n=0,e=0;e<t.length;e++)n+=t[e].height;return n},f.prototype.Vn=function(t,n,e,i,r){var o;f.et(n.sheet,"beforePaintLabel",{ctx:t,options:{rect:e,context:n,value:i,style:r}})},f.prototype.Pn=function(t,n,e,i,r,o,a,u){var t={ctx:t,text:n,rect:new ht.Rect(r,o,a,u),style:e,context:i,externals:{left:[],right:[]}};return f.et(i.sheet,"beforePaintText",t),an(t),t},f.prototype.Yn=function(t,n,e,i,r,o,a,u,s){var t={ctx:t,style:n,context:e,textRect:new ht.Rect(i,r,o,a),availRect:u};return f.et(e.sheet,s,t),rn(s,t),t},f.prototype.Zn=function(t,n,e,i,r,o,a,u){return this.Yn(t,n,e,i,r,o,a,u,"beforeFillTextArea")},f.prototype.Wn=function(t,n,e,i,r,o,a,u){return this.Yn(t,n,e,i,r,o,a,u,"afterFillTextArea")},f.prototype.paintText=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,w,y,M,w,y,p,h=this;t.save(),t.beginPath(),d=a.textOrientation,v=a.textIndent&&0!==a.textIndent,m=a.hAlign,g=a.isVerticalText&&4!==m,4===m&&(d=0,v=!1),p=u.sheet,b=u.sheetArea,w=p.rowFilter&&p.rowFilter(),y=u.columnHeaderFitMode,!(M=!!(w&&w.rn(u.row,u.col,b)&&w.filterButtonVisible(u.col)))||y!==Z.ColumnHeaderFitMode.normal&&y!==Z.ColumnHeaderFitMode.vertical||(C(u.cornerX)||(r=u.cornerX-e),r-=p.an(new ht.Rect(e,i,r,o),b).width),w=a.wordWrap,y=a.shrinkToFit,p=a.showEllipsis,5===m&&(u.sheet.options.showFormulas&&u.isFormula?(a.hAlign=1,a.wordWrap=!1):a.wordWrap=!0,a.shrinkToFit=!1,a.showEllipsis=!1),n&&n.richText&&0<n.richText.length&&ut(n,s,a.wordWrap)||g?h.Qn(t,n,e,i,r,o,a,u,s,c,f,l):0!==d&&!W(d)&&-90<=d&&d<=90&&!v&&!g?h.Kn(t,n,e,i,r,o,a,u,s,c,f,l):h.Jn(t,n,e,i,r,o,a,u,s,c,f,l),5===m&&(a.hAlign=5,a.wordWrap=w,a.shrinkToFit=y,a.showEllipsis=p),t.restore()},f.prototype.Xn=function(t,n,e,i,r,o,a,u,s,c){for(var f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,f=n.sheet,l=n.row,h=n.col,d=r.vAlign,v=n.sheetArea,m=0;m<e.length;m++)if(g=e[m].text,p=i[m].lineHeight,b=1===d?0:u,w=this.qn(t,"0"),y="",(M=o)-1-2-b<g.length*p){if(M<3*w)c.push(0),y=k;else if(C=mt((M-1-2-3*w-(1===d?0:u))/p),(S=0)===d){for(T=0;T<C;T++)y+=g[T];A=y.length,3*w+((y+=k).length-3)*p+u>M-1-2?(y=y.substring(0,y.length-4)+k,c.push(y.split(k)[0].length)):c.push(A)}else if(1===d){for(I=0;I<N(C/2);I++)y+=x=g.charAt(I),S=I;for(A=y.length,y+=k,I=N(g.length-C/2);I<g.length;I++)y+=x=g.charAt(I);3*w+(y.length-3)*p+u>M-1-2?(y=y.replace(g[S],""),c.push(y.split(k)[0].length)):c.push(A),s[m].y=a+(o-(3*w+(y.length-3)*p))/2}else{for(c.push(0),T=g.length-1;T>=g.length-C;T--)y=g[T]+y;3*w+((y=k+y).length-3)*p+u>M-1-2&&(y=y.replace(g[g.length-C],"")),s[m].y=a+o-u-(3*w+(y.length-3)*p)-2}e[m].textInfos[0].text=y,f.Ut.$n(l,h,g,v)}else f.Ut.$n(l,h,null,v)},f.prototype.Qn=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,w,y,M,C,w,S,v,m,T,l,v,A,I,m,T,x,N,k,p,C,_,D,h=this,d=new ht.Rect(e,i,r,o),v=u.sheet?u.sheet.zoom():1,m=u.printZoomFactor;if(m=nt(u)?m:j,g=h.Gn(a.textIndent,u.sheet.outlineColumn,u.col,m?m*v:v),p=u.cellOverflowLayout&&u.cellOverflowLayout.expandedWidth,b=a.hAlign,w=a.formatter||a._autoFormatter,3===b&&(b=Mt(b,n,w)),M=!!(y=a.isVerticalText&&4!==b)&&J(s),C=a.font,w=h.Ft(w,n.text),S=L(!0,[],h.Pt(n,s,w,C,a.foreColor)),(0,ht.resetFillStyle)(t,u.sheet,a,f),n&&n.richText&&0<n.richText.length&&h.te(S,C,v,m),m=v=0,l&&(v=h.Hn(l.left),m=h.Hn(l.right),T=h.Fge(l)),l=v+m,v={left:v,right:m,isStick:T},!a.wordWrap&&a.shrinkToFit&&(4===a.hAlign?h.ne(S,p-l,o,a,C,1,y):h.ne(S,r-l,o,a,C,1,y)),A=h.ee(t,s,a.font,y?o:r-l,g,y?a.vAlign:a.hAlign,a.wordWrap,y,S),I=h.re(A,a,b,f),m=h.oe(t,a,e,i,r,o,a.wordWrap,u.cellOverflowLayout,b,g,y,A[0].textLength,I[0].lineHeight,u.clipRect),T=!1,a.showEllipsis&&y&&!n.richText&&(T=!0),x=[],x=4===b?h.ae(e,i,u.cellOverflowLayout.expandedWidth,o,b,a.vAlign,g,y,M,A,I,v,T,a):h.ae(e,i,r,o,b,a.vAlign,g,y,M,A,I,v,T,a),N=A.length,k=[],T&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===A.length&&A[0].text)&&this.Xn(t,u,A,I,a,o,i,g,x,k),1===N&&c&&!w)h.ue(t,u.sheet,s,c,x[0].x,x[0].y,r,o,b,a,m.width,m.height,g,y,A[0].textLength,u,v,d);else{for(p=h.se(A),C=x[0].x,t.textAlign===q?C-=p/2:t.textAlign===X&&(C-=p),h.Zn(t,a,u,x[0].x,x[0].y,p,0,d),_=r-l-4-2*g,D=0;D<N;D++)h.ce(t,u.sheet,x[D].x,x[D].y,I[D],b,A[D],k[D],_);h.Zn(t,a,u,C,x[0].x,p,0,d)}},f.prototype.se=function(t){for(var n,e,n=t[0].textLength,e=0;e<t.length;e++)n=wt(n,t[e].textLength);return n},f.prototype.qn=z,f.prototype.fe=function(t,n,e,i,r,o,a){var u,s,e,c,f,t,l,h,r,d,v,m,g,p,b,w,y,M,C,S,C,s=t.sheetArea,u=e,e=this.qn(i,u),c=t.sheet,f=t.row,t=t.col,l=r,h=0,r=this.qn(i,"0"),d;if(h=this.qn(i,k),l-1-2-(v=1===o?0:a)<e){if(m="",2===o)for(g=u.length-1;0<=g;g--){if(l-1-2-a<h){p=m.length,m=k+m.substring(1,p);break}m=(b=u.charAt(g))+m,h+=w=this.qn(i,b)}else if(1===o){for(y=N((l-h)/r),g=0;g<y/2;g++)m+=b=u.charAt(g);for(m+=k,g=mt(u.length-y/2);g<u.length;g++)m+=b=u.charAt(g);for(M=this.qn(i,m);l-1-2<M&&m!==k;)S=(C=m.split(k))[0],C=C[1],m=S.length>C.length?S.substring(0,S.length-1)+k+C:S+k+C.substring(1,C.length),M=this.qn(i,m)}else for(g=0;g<u.length;g++){if(l-1-2-a<h){p=m.length,m=m.substring(0,p-1)+k;break}m+=b=u.charAt(g),h+=w=this.qn(i,b)}n.content=[{value:m,type:"text"}],c.Ut.$n(f,t,u,s)}},f.prototype.Jn=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,F,w,y,M,C,L,S,T,A,I,B,P,x,N,f,v,f,k,_,G,l,U,H,V,D,z,_,A,b,Y,k,w,b,p,k,v,b,j,p,O,m,E,R,R,E,o,f,n,_,R,E,m,h=this,d=0,v=a.textIndent,m=a.wordWrap,g=a.hAlign,p=a.vAlign,b=a.shrinkToFit,F=a.textDecoration,w="left",y=2,M=2,C=a.font,L=0,S=[],T=0,A=u.sheet,I=new ht.Rect(e,i,r,o),B=u.cellOverflowLayout&&u.cellOverflowLayout.expandedWidth,P=u.offsetX;if(P=P||0,4===g&&(v=0),W(u.fontInfo)&&(u.fontInfo=dt.W.Lge(a,A.zoom()),nt(u))&&(u.fontInfo=dt.W.V(u.fontInfo.font,u.printZoomFactor)),x=parseInt(u.fontInfo.fontSize,10),W(u.lineHeight)&&(u.lineHeight=Q(dt.W.Lge(a,A.zoom()).font,!1,J(s))),N=u.lineHeight,(0,ht.resetFillStyle)(t,A,a,f),f=A.zoom()||1,nt(u)&&(f*=u.printZoomFactor),0<v&&(d=8*v*f),A.outlineColumn&&A.outlineColumn.Un(u.col)&&(d=0),3===g&&(g=Mt(g,n,a.formatter||a._autoFormatter)),v=1,vt(t,C),k=f=0,l&&(f=h.Hn(l.left),k=h.Hn(l.right),_=h.Fge(l)),G=f+k,l={left:f,right:k,isStick:_},!m&&b){for(H={value:!1},V=void(U=0),D=0;D<3&&!1===H.value&&(z=t.measureText(s).width,U=wt(0,r-4-(1===g?0:d)-G),(U=4===g?wt(0,B-4-d-G):U)<z);D++)C=(V=dt.W.V(C,U/z,H,!0)).font,vt(t,C);V&&(v=x/V.fontSize,x=V.fontSize)}if(_=(_=A.parent&&A.parent.options.numbersFitMode===Z.NumbersFitMode.overflow||!1)||(c&&c.content?!(!c.content||1!==c.content.length||"text"!==c.content[0].type):"string"==typeof n&&n===s),!m&&!b&&a.showEllipsis&&_&&this.fe(u,c,s,t,r,g,d),y+=d+f,1===g||4===g||5===g?(y=(r+f-k)/2,w=q):2===g&&(y=r-k-1-2,w=X,y=ot(a,y-=d)),t.textAlign!==w&&(t.textAlign=w),A=0,m&&(A=r-G-(b=at(a,3))-(1===g||5===g?2*d:d),4===g&&(A=B-G-b-d),--A,1<(T=(S=u.isPrinting?ht.q.un(s,A,C,!1,t):rt(s,A,C,!1,t)).length))&&0!==p&&(L=(T-1)*N),M=(M+(N-(k=N/2-x/2+(Y=8<x?mt((x-8)/5+2):1)-1)))/v,1===p?M=(o-L)/2+N/2-k:2===p&&(M=o-(L+2+k)/v),t.textBaseline!==$&&(t.textBaseline=$),p=Tt(b=(w=u.cellOverflowLayout)&&w.layout,e,i,r,o,u.clipRect))if(w&&4===g&&(y+=(w.expandedWidth-r)/2),y+=P,k=b&&b.width>r||4===g,v=p.x,b=p.y,j=p.width,p=p.height,m)if(t.rect(v,b,j,p),t.clip(),t.beginPath(),O=i+M,1<T||5===g)if(m=e+y,t.textAlign===q?m-=A/2:t.textAlign===X&&(m-=A),R=O,(E=pn(S,N,a)).descenderHeight&&(R+=E.descenderHeight),u.textRect=new ht.Rect(m,St(R+(S.length-1)*N,i+o),A,St(E.height,o)),5===g)R=y,E=2+d+f+P,!_&&!et(a.formatter)&&typeof a.formatter===tt&&"object"!=typeof n||_&&1===T&&!h.Bge(S[0])?h.he(t,s,c,e+R,i+M,1,j,d,F,Y,x,u,a,l,I,k):(h.Zn(t,a,u,m,O,A,N*T,I),h.Pge(t,S,e,O,A,R,E,N,a,x,Y),h.Wn(t,a,u,m,O,A,N*T,I));else{for(h.Zn(t,a,u,m,O,A,N*T,I),D=0;D<T;D++)t.fillText(S[D],e+y,O),F&&(z=t.measureText(S[D]).width,h.le(t,F,e+y,O,z,x,Y)),O+=N;h.Wn(t,a,u,m,O,A,N*T,I)}else h.he(t,s,c,e+y,i+M,g,j,d,F,Y,x,u,a,l,I,k);else f=j-(e+1-v)<(o=K(t,t.font,s)+G)||p<N||0!==P,4===g&&(f=!0),n=yt(a,0),_=yt(a,1),R=yt(a,2),E=yt(a,3),f||(1===g||4===g?w&&((m=o/2)>w.backgroundLeftWidth||m>w.backgroundRightWidth)&&(f=!0):(j<o+d+n+R||p<L+E+_)&&(f=!0)),f&&(t.rect(v,b,j,p),t.clip(),t.beginPath()),h.he(t,s,c,e+y,i+M,g,j,d,F,Y,x,u,a,l,I,k)},f.prototype.Bge=function(t){var t=ht.q.Gge(t);return 1<t.length||1===t.length&&0<t[0].prefixSpaceCount},f.prototype.Pge=function(t,n,e,i,r,o,a,u,s,c,f){for(var l,h,d,v,m,g,p,b,w,y,w,M,C,S,T,T,l=n.length,h=i,d=s.textDecoration,v=this,m=r,g=0;g<l;g++){if(p=n[g]){if(1===(b=ht.q.Gge(p)).length)t.textAlign=q,t.fillText(p,e+o,h),d&&(w=t.measureText(p).width,v.le(t,d,e+o,h,w,c,f));else for(t.textAlign=A,y=t.measureText(" ").width,w=t.measureText(p).width,M=e+a,(C=0)<b[0].prefixSpaceCount?M+=C=(m-w)/b.length:C=(m-w)/(b.length-1),S=0;S<b.length;S++)M+=(T=b[S]).prefixSpaceCount*y,t.fillText(T.word,M,h),T=t.measureText(T.word).width,d&&v.le(t,d,M,h,T,c,f),M+=T+C}h+=u}},f.prototype.Kn=function(t,F,L,n,e,i,r,o,a,u,B,P){var G,s,c,f,U,H,V,l,h,d,z,v,m,g,Y,p,Z,b,W,w,w,y,M,Q,C,J,S,T,A,I,w,K,X,x,w,N,k,q,$,_,D,j,tt,nt,O,et,it,rt,ot,at,E,R,ut,st,ct,ft,lt,u,B,F,P,H,J,U,c,s=this,c=r.wordWrap,f=r.hAlign,U=r.vAlign,H=r.shrinkToFit,V=r.textDecoration,l=2,h=2,d=r.font,z=[],v=0,p=parseInt(o.fontInfo.fontSize,10),Z=o.sheet,W=new ht.Rect(L,n,e,i),w=o.cellOverflowLayout,w=w&&w.layout,y=r&&(r.borderLeft||r.borderTop||r.borderRight||r.borderBottom)&&!Z.getSpan(o.row,o.col,o.sheetArea),M=r.textOrientation,Q=M*Math.PI/180,C=bt(Q),J=pt(C),S=gt(C),T=Ct(C),A=o.lineHeight,I=90===M||-90===M;if(y&&(-90<M&&M<0&&(b=!1),0<M)&&M<90&&(b=!0),w=Tt(w,L,n,e,i,o.clipRect)){if(K=w.x,X=w.y,x=w.width,w=w.height,N=A/2*gt(C),k=A/2*pt(C),$=A/2-p/2+(q=8<p?mt((p-8)/5+2):1)-1,u&&u.content&&0<u.content.length&&!H&&(a=s.de(t,u.content,i-4,d)),_=Z.Qt(a,d),(0,ht.resetFillStyle)(t,Z,r,B),3===f&&(f=Mt(f,F,r.formatter||r._autoFormatter,M)),vt(t,d),j=D=0,P&&(D=s.Hn(P.left),j=s.Hn(P.right)),!c&&H)for(nt={value:!1},O=tt=0;O<3&&!1===nt.value&&(tt=wt(0,(i-4-2*k)/S))<_;O++)d=dt.W.V(d,tt/_,nt,!0).font,vt(t,d),p=null!=(G=r.Uge)?G:parseInt(o.fontInfo.fontSize,10),_=Z.Qt(a,d),N=(A=ht.mt.vt(d))/2*gt(C),k=A/2*pt(C);if(it=et=0,c)for(v=(z=ht.q.un(a,it=(i-4-2*k)/S,d,!1,t)).length,_=Z.Qt(z[0],d),rt=0;rt<v;rt++)et<(ot=Z.Qt(z[rt],d))&&(et=ot);switch(m=_/2*J,g=(c?et:_)/2*S,5===f&&(M<0&&(f=2,I)&&1===v&&(j=(x-A)/2),0<M&&(f=0,I)&&1===v&&(D=(x-A)/2),I)&&1<v&&(A=(x-A)/(v-1))<o.lineHeight&&(A=o.lineHeight),at=""+f+(U=i<=(Y=(c?et:_)*S+2*k)?2:U)){case"00":l+=m+N+D,h+=g,I||(h+=k),y&&(l=(i-h)/T*(b?1:-1)+(A/2+2)/S+D);break;case"01":l+=m+N+D,h=i/2,y&&(l=(i-h)/T*(b?1:-1)+(A/2+2)/S+D);break;case"02":l+=m+N+D,h+=g,I||(h+=k),y&&(l=h/T*(b?1:-1)+(A/2+2)/S+D),h=i-h;break;case"10":l=(e+D-j)/2,h+=g,I||(h+=k),y&&(l+=(b?1:-1)*(i-h)/T);break;case"11":l=(e+D-j)/2,h=i/2,y&&(l+=(b?1:-1)*(i-h)/T);break;case"12":l=(e+D-j)/2,h+=g,I||(h+=k),y&&(l+=(b?1:-1)*h/T),h=i-h;break;case"20":l=e-2-m-N-j,h+=g,I||(h+=k),y&&(l=e+(i-h)/T*(b?1:-1)-(A/2+2)/S-j);break;case"21":l=e-2-m-N-j,h=i/2,y&&(l=e+(i-h)/T*(b?1:-1)-(A/2+2)/S-j);break;case"22":l=e-2-m-N-j,h+=g,I||(h+=k),y&&(l=e+h/T*(b?1:-1)-(A/2+2)/S-j),h=i-h}if(c)if(E=L+l,R=A/S,ut=void 0,90===Math.abs(M)&&(ft=x<_*v+(st=yt(r,1))+(ct=yt(r,3)))&&(t.rect(K,X,x,w),t.clip()),1<v){for(1===f&&(E-=(lt=v%2!=0)?R*(v-1)/2:v/2*R-.5*R),B=(u=Yt(E,n+h,_,Q,A)).width+R*(v-1),F=u.height,P=u.y,H=u.x-R*(v-1),o.textRect=new ht.Rect(H,St(n+2*h,W.y+W.height),B,2*h-A/2),s.Zn(t,r,o,H,P,B,F,W),O=0;O<v;O++)ut=O,(0<r.textOrientation&&2===f||r.textOrientation<0&&(0===f||1===f))&&(ut=v-O-1),s.ve(t,Q,z[ut],E,n+h,V,p,q,$),E=2===f?E-R:E+R;s.Zn(t,r,o,H,P,B,F,W)}else s.me(t,a,L,n,l,h,o,r,_,Q,V,p,q,A,$,W);else J=_*S+p*S+2,U=yt(r,0),c=yt(r,2),(ft=w-(n+1-X)<J||w<A||w<J+U+c)&&(t.rect(K,X,x,w),t.clip()),s.me(t,a,L,n,l,h,o,r,_,Q,V,p,q,A,$,W)}},f.prototype.me=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m){var g,p,b,w,y,p,M,g=this,p=Yt(e,i,s,c,d),b=p.width,w=p.height,y=p.x,p=p.y;(dt.W.Hge(u)||dt.W.Vge(u))&&(M=bt(c),y=e+r-(b=s*pt(M)+d*gt(M))/2,p=i+o-(w=s*gt(M)+d*pt(M))/2),a.textRect=new ht.Rect(y,St(p+w,m.height+m.y),b,w),g.Zn(t,u,a,y,p,b,w,m),g.ve(t,c,n,e+r,i+o,f,l,h,v),g.Wn(t,u,a,y,p,b,w,m)},f.prototype.te=function(t,n,e,i){zt(t,n,e,i)},f.prototype.ne=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,u=0,s={value:!1},c=0;c<3&&!1===s.value&&(f=ft(t,r,o,a),u=wt(0,(a?e:n)-4),(u=(a?i.vAlign:1!==i.hAlign&&i.textIndent)?wt(0,u-8*i.textIndent*o):u)<f);c++)for(l=0;l<t.length;l++)t[l].style.font=dt.W.V(t[l].style.font,u/f,s,!0).font},f.prototype.Pt=function(t,n,e,i,r){var t=t.richText;return t=!W(t)&&e?t:[{style:{font:i,foreColor:r},text:n}]},f.prototype.oe=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,r,o,d,m,g,p,v,r=Tt(u&&u.layout,e,i,r,o,d);if(r)return o=r.x,d=r.y,m=r.width,g=r.height,(a||(p=this.ge(n,s,n.vAlign,e,i,g,m,o,d,l,h,c,f,u)))&&(t.rect(o,d,m,g),t.clip(),t.beginPath()),r},f.prototype.ge=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,t,h,m=yt(t,0),g=yt(t,1),p=yt(t,2),t=yt(t,3);return h?(!(v=o-(r+1-s)<c||a<f)&&1!==e&&o<c+l+m+p||a<f+t+g)&&(v=!0):(v=a-(i+1-u)<c||o<f)||(1===n?d&&((h=c/2)>d.backgroundLeftWidth||h>d.backgroundRightWidth)&&(v=!0):(a<c+l+t+g||o<f+m+p)&&(v=!0)),v},f.prototype.ee=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,h;if(i=1===o||5===o?i-3-2*r:i-3-r,a)return ht.q.Ht(n,i,e,s,u,t);for(f=c=0;f<s.length;f++)l=s[f].text,u?c+=Q(s[f].style.font)*(l?l.length:0):(h=dt.W.V(s[f].style.font,1),h=s[f].style.vertAlign?h.fontSize*D+"px "+h.fontFamily:s[f].style.font,c+=K(t,h,l));return[{textLength:c,text:n,textInfos:s}]},f.prototype.ue=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p){var b,w,y,b=dt.W.Lge(c,1).fontSize,w=8<b?mt((b-8)/5+2):1;this.pe(t,n,c),d?this.be(t,e,i,c,r,o,l,h,l,m,g,p):this.he(t,e,i,r,o,s,f,h,c.textDecoration,w,b,m,c,g,p,y=a<f,v)},f.prototype.be=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,w,h=this,d=e.content,m=o;if(c.textRect=new ht.Rect(r,m,s,bn(t,n,e,r,o,a,u,s)-m),h.Zn(t,i,c,r,m,s,s*n.length,l),d&&0<d.length)for(p=0<(p=a-u-(g=Gt(t,d,!0))-2)?p:0,b=void 0,v=0;v<d.length;v++)"fillingChar"===d[v].type?(w=Ht(t,p,d[v].value,!0),this.ye(t,w,r,o),o+=p):"placeholder"===d[v].type?o+=d[v].value?d[v].value.length*s:0:"numberPlaceholder"===d[v].type?o+=s:(this.ye(t,d[v].value,r,o),o+=b=d[v].value?d[v].value.length*s:0);else if(n)for(v=0;v<n.length;v++)o=this.ye(t,n[v],r,o,s).y;h.Wn(t,i,c,r,m,s,o-m,l)},f.prototype.we=function(t){var n=A;return 1===t?n=q:2===t&&(n=X),n},f.prototype.ce=function(t,n,e,i,r,o,a,u,s){for(var c,f,l,h,d,c=[],f=a.textInfos,l=0;l<f.length;l++)c.push(L(!0,{},r,f[l].style));for(h=0,!r.isVerticalText&&5===o&&1<a.textInfos.length&&a.text.includes(" ")&&s&&(h=(s-a.textLength)/(a.textInfos.length-1))<0&&(h=0),l=0;l<f.length;l++)e=(d=this.Me(t,n,e,i,c[l],f[l].text,u)).x+h,i=d.y},f.prototype.re=function(t,n,e,i){for(var r,o,a,u,r=[],o=t.length,a=0;a<o;a++)u=this.Ce(n,e,i,t[a].textInfos),r.push(u);return r},f.prototype.Ce=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=0,a=0;if(i)for(u=0;u<i.length;u++)s=void 0,s=(i[u].style&&i[u].style.font&&i[u].text?i[u].style:t).font,o=Math.max(Q(s,I,J(i[u].text)),o),a=Math.max(dt.W.V(s,1).fontSize,a),(i[u].style&&1===i[u].style.vertAlign||2===i[u].style.vertAlign)&&(o=Math.max(Q(s,I,J(i[u].text))+2*dt.W.V(s,D).fontSize*.218,o));return{lineHeight:o,fontSize:a,baselineOffset:c=8<a?mt((a-8)/5+2):1,lineOffset:f=o/2-a/2+c-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:r.we(n),textBaseline:$,opacity:e}},f.prototype.Se=function(t,n,e){for(var i=0,r=0,o,o=0;o<t.length;o++)r+=n[o].lineHeight,i=Math.max(t[o].textLength,i);return{width:e?r:i,height:e?i:r}},f.prototype.ae=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,b,w,y,v,v=this.Se(c,f,u),m=v.height,g=v.width,p=[];if(u)for(y=0,5===(w=r)&&(1===c.length?w=1:(w=0,g<(v=e-4-l.left-l.right)&&(y=(v-g)/(c.length-1)))),b=0;b<c.length;b++)p.push(this.Te(t,n,e,i,w,o,a,g,c[b].textLength,f[b].lineHeight,f[b].lineOffset,s,l,c[b],h,d)),s?t-=f[b].lineHeight+y:t+=f[b].lineHeight+y;else for(b=0;b<c.length;b++)5===(w=r)&&(w=c[b].text.includes(" ")?0:1),p.push(this.Ae(t,n,e,i,w,o,a,c[b].textLength,m,f[b].lineHeight,f[b].lineOffset,l,d)),n+=f[b].lineHeight;return p},f.prototype.Ae=function(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,m,l,d=0,v=0,m=l.left,l=l.right;return v=1===o?(i-s)/2+c-f:2===o?i-s-2+c-f:2+c-f,1===r||4===r?d=(e-u+m-l)/2:2===r?(d=ot(h,d=e-1-2-u-l),d-=a):d=2+a+m,{x:t+d,y:n+v}},f.prototype.Te=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m){var g,p,b,w,h,g=0,p=0,w=h.left,h=h.right;return l?0===r?g=2+u+h-c/2:1===r?g=(e-w+h+u)/2-c/2:2===r&&(g=ot(m,g=e-w-1-2-c/2)):1===r?g=(e-u+w-h)/2+c/2:2===r?g=ot(m,g=e-1-2-h-u+c/2):0===r&&(g=2+w+c/2),{x:t+g,y:n+(p=1===o?(i-s)/2:2===o?i-a-s-2:2+a)}},f.prototype.Me=function(t,n,e,i,r,o,a){var n,a;return t.save(),this.pe(t,n,r),n=r.vertAlign,a=r.isVerticalText?this.ye(t,o,e,i,r.textDecoration,r.baselineOffset,a):this.Ie(t,e,i,r,o,n),t.restore(),a},f.prototype.pe=function(t,n,e){(0,ht.resetFillStyle)(t,n,e);var n=e.vertAlign?this.xe(e.font):e.font;W(e.textBaseline)||t.textBaseline===e.textBaseline?W(t.textBaseline)&&t.textBaseline!==$&&(t.textBaseline=$):t.textBaseline=e.textBaseline,e.isVerticalText?t.textAlign!==q&&(t.textAlign=q):t.textAlign!==A&&(t.textAlign=A),vt(t,n)},f.prototype.xe=function(t){var t,n,t=dt.W.Ne(t),n=parseFloat(t.fontSize)*D;return t.fontSize=n+"px",this.ke(t)},f.prototype.ke=function(t){var n,e,i,r,o,a,t,n="",e="normal",i,r=t.fontStyle,o=t.fontSize,a=t.fontWeight,t=t.fontFamily;return n=void 0!==r?r:e,n=(n=(n+=void 0!==a?(n?" ":"")+a:(n?" ":"")+e)+((n?" ":"")+o))+(void 0!==t?(n?" ":"")+t:(n?" ":"")+"Calibri")},f.prototype.OCe=function(t,n,e,i,r,o){n.save(),n.translate(e+o-r/2,i+o-r/2),n.rotate(Math.PI/2),n.fillText(t,0,0),n.restore()},f.prototype.ye=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,m;if(n&&0<n.length)for(u=this,s=t.font,c=Q(s,I,J(n)),f=Y(dt.W.V(s,1).fontSize,c),h=(l=u.qn(t,"0"))/2,d=0;d<n.length;d++)v=n[d],i=i+(g=(m=void 0!==a&&a<=d&&d<=a+2&&(a+3===n.length||0===a&&a+3<n.length||0!==a&&a+3<n.length))?l:c)-(m=m?h:f),U[v]?u.OCe(v,t,e,i,c,f):t.fillText(v,e,i),this.De(t,r,e,i,K(t,t.font,v),dt.W.V(t.font,1).fontSize,o),i+=m;return{x:e,y:i}},f.prototype.De=function(t,n,e,i,r,o,a){var u,s,c,f,s;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=u=0,c=.5,s=mt(((f=o<=12?12:o)-12)/21+1),t.lineWidth!==s&&(t.lineWidth=s),0==(1&s)&&(c=0),(s=t.textAlign)===q?e-=r/2:s===X&&(e-=r),t.beginPath(),2==(2&n)&&(u=N(i+a-o/2)-c,t.moveTo(e,u),t.lineTo(e+r,u)),t.stroke()},f.prototype.Ie=function(t,n,e,i,r,o){var a,u,s,o,r;return W(r)?{x:n,y:e}:(u=8<(a=dt.W.V(t.font,1).fontSize)?mt((a-8)/5+2):1,s=0,o?t.fillText(r,n,e-(s=1===o?.74*a:.28*-a)):t.fillText(r,n,e),o=K(t,t.font,r),r=i.textDecoration,this.le(t,r,n,e,o,a,u-s),{x:n+o,y:e})},f.prototype._e=function(t,n,e,i,r,o,a,u){var s={row:u.row,col:u.col,sheet:u.sheet,sheetArea:u.sheetArea,style:a,underline:a.textDecoration,foreColor:a.foreColor};f.et(u.sheet,"applyHyperlinkStyle",s),this.paint(t,n,e,i,r,o,a,u)},f.prototype.paint=function(t,n,e,i,r,o,a,u){var s,s,c,f,c,f,c;t&&(s=a.backColor,u.parentBackColor!==s&&At(t,e,i,r,o,u.imageLoader,a,n,u),2!==(s=u.sheetArea)&&1!==s||(c=u.visualState||0,f="columnHeader",c=this.getThemeStyle(u.visualState,"gc-"+(f=2===s?"rowHeader":f)+"-"+ht.I.Ee(c)),x.cn(t,e,i,r,o,a,f,c,s)),f=this,c=new ht.Rect(e,i,r,o),u.cellRect=c.clone(),f.Vn(t,u,c,n,a),Wt(t,c,a,u),f.Tn&&(f.Tn(t,c,a,u),c=f.An(c,a,nt(u)?u.printZoomFactor:u.sheet.zoom())),u.cellOverflowLayout||f.pn(t,c,u,M(n)),0<c.width)&&0<c.height&&(a&&a.showEllipsis&&u.sheet.Ut.$n(u.row,u.col,null,u.sheetArea),f.paintContent(t,n,c.x,c.y,c.width,c.height,a,u))},f.prototype.paintContent=function(t,n,e,i,r,o,a,u){var s,c,c,c,s,c=u.conditionalFormats;c&&(s=c._e(t,M(n),e,i,r,o,a,u)),u.showBarIconOnly=s,(c=u.sparkline)&&c.paintSparkline(t,e,i,r,o),c=x.dn(t,M(n),e,i,r,o,u),u.cellOverflowLayout||s||c||(s=new ht.Rect(e,i,r,o),this.Rge(u,a),this.paintValue(t,n,s.x,s.y,s.width,s.height,a,u))},f.prototype.adjustRectForIconSet=function(t,n,e,i,r,o,a){It(t,n,e,i,r,o,a)},f.prototype.hasInfilling=function(t){for(var n=0;n<t.length;n++)if("fillingChar"===t[n].type)return!0;return!1},f.prototype.createEditorElement=function(t,n){return j},f.prototype.getEditorValue=function(t,n){return j},f.prototype.je=function(t,n,e,i){return e},f.prototype.setEditorValue=function(t,n,e){},f.prototype.getEditingElement=function(){return j},f.prototype.parse=function(t,n,e){var i,r,o,a,i=W(n),r=W(t);try{if(o=c.Formatter&&c.Formatter.GeneralFormatter,!i&&!r&&o)return(a=typeof n===tt?new o(n):n).parse(t)}catch(t){}return r?"":t.toString()},f.prototype.format=function(n,t,e,i){var r,o,a,a,i,u,s,r=et(t);if(i&&r&&(a=(o=i.sheet).Oe(i.row,i.col,i.sheetArea,t),W(a)||(n=a)),W(n)||""===n)return"";if(i&&i.quotePrefix&&typeof n===tt)return n.toString();if(!r&&typeof t===tt&&"object"!=typeof n)return ht.Be.Re(n,t,e);if(!t||"General"===t||r)return"boolean"==typeof n||n instanceof Boolean?(n=l?n?l.getBoolean().boolean_true:l.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(i=(a=h.Fe(h.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(i=a.defaultDatePattern),p.Pe(n,i)):(n=typeof n===b?d.Ge(n.toString()):n).toString();try{return(u=c.Formatter&&c.Formatter.GeneralFormatter)?(s=void 0,(s=typeof t===tt?ht.Be.Ue(t):t).format(n,e)):n.toString()}catch(t){return n.toString()}},f.prototype.focus=function(t,n){t&&t.focus&&t.focus()},f.prototype.getThemeStyle=function(t,n){return ht.I.He(t,n)},f.prototype.activateEditor=function(t,n,e,i,r,o,a){},f.prototype.deactivateEditor=function(t,n){},f.prototype.selectAll=function(t,n){t&&t.select&&t.select()},f.prototype.updateEditor=function(t,n,e,i,r,o,a){},f.prototype.setImeMode=function(t,n,e){this.isImeAware(e)?this.updateImeMode(t,n,e):t&&x.hn(t,0)},f.prototype.updateImeMode=function(t,n,e){t&&x.hn(t,n)},f.prototype.getHitInfo=function(t,n,e,i,r){return j},f.prototype.getCellAndPaddingHitInfo=function(t,n,e,i,r){var o,a,u,o=this;if(r){if(a={x:t,y:n,context:r,cellStyle:e,cellRect:i,paddingHitInfo:null},f.et(r.sheet,"getCellButtonHitInfo",a,function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo}),u=a.paddingHitInfo,a.paddingHitInfo&&!W(a.paddingHitInfo.cellButtonHitInfo)&&!W(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=o.An?o.An(a.cellRect,e,r.sheet.zoom()):a.cellRect,f.et(r.sheet,"getCellTextHitInfo",a,function(){return!W(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation}),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===r.sheetArea)return f.et(r.sheet,"getCellPaddingHitInfo",a,function(){return!W(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation}),a.paddingHitInfo||u||this.getHitInfo(t,n,e,i,r)}return this.getHitInfo(t,n,e,i,r)},f.prototype.processCellAndPaddingMouseDown=function(t){return f.et(t.sheet,"processMouseDownOnCellPadding",t),this.processMouseDown(t)},f.prototype.processMouseDown=function(t){return!1},f.prototype.ze=function(t){return f.et(t.sheet,"processMouseMoveOnCellPadding",t),this.processMouseMove(t)},f.prototype.processMouseMove=function(t){return!1},f.prototype.Ve=function(t){return f.et(t.sheet,"processMouseUpOnCellPadding",t),this.processMouseUp(t)},f.prototype.processMouseUp=function(t){return!1},f.prototype.processMouseEnter=function(t){return!1},f.prototype.Ye=function(t){return f.et(t.sheet,"processMouseLeaveOnCellPadding",t),this.processMouseLeave(t)},f.prototype.processMouseLeave=function(t){return!1},f.prototype.isReservedKey=function(t,n){return!1},f.prototype.isEditingValueChanged=function(t,n,e){var i,r,o,e,i,i=e.sheet,r=e.row,o=e.col,e=e.sheetArea||Z.SheetArea.viewport,i=i&&i.getValue(r,o,e,Z.ValueType.richText);return i&&i.richText&&(t=t.replace(/\r\n?/g,"\n").replace(P,B),n)&&n.replace&&(n=n.replace(/\r\n?/g,"\n").replace(P,B)),(t=t===j?I:t)!==(n=n===j?I:n)},f.prototype.processCompositionStart=function(t,n){return!1},f.prototype.processKeyDown=function(t,n){return!1},f.prototype.processKeyUp=function(t,n){return!1},f.prototype.getAutoFitWidth=function(t,n,e,i,r){return x.Bt(t,n,e,i,r)},f.prototype.getAutoFitHeight=function(t,n,e,i,r){return x.tn(t,n,e,i,r)},f.prototype.xTe=function(t,n,e,i){return t&&t.content&&0<t.content.length&&(n||!e||4===i)},f.prototype.NTe=function(t){t=Ut(JSON.parse(JSON.stringify(t)));var n="";return t.forEach(function(t){if(t)switch(t.type){case"fillingChar":break;case"numberPlaceholder":n+="0";break;default:t.value&&(n+=t.value)}}),n},f.prototype.he=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p){var b,w,p,m,e,a,o,b=this,w=d.isStick;b.xTe(e,p,m,o)?this.Ze(t,e.content,i,r,o,a,u,s,c,f,l,h,d,v,g):(g=g||K(t,t.font,n),p=i,m=void 0,t.textAlign===q?(p-=g/2,0<d.left&&v.width<g+d.left&&(i=g/2+d.left+v.x)):t.textAlign===X&&(p-=g,0<d.left)&&v.width<g+d.left&&(m={x:v.x+d.left,y:v.y,width:v.width-d.left,height:v.height}),e=p,0<d.left&&p-v.x<d.left&&w&&(e=v.x+d.left),o=r,(a=pn([n],l.lineHeight,h)).descenderHeight&&(o+=a.descenderHeight),l.textRect=new ht.Rect(p,o,g,a.height),b.Zn(t,h,l,e,r,g,l.lineHeight,v),m&&w?(t.save(),t.beginPath(),t.rect(m.x,m.y,m.width,m.height),t.clip(),t.fillText(n,i,r),t.restore()):t.fillText(n,i,r),s&&this.le(t,s,i,r,g,f,c),b.Wn(t,h,l,p,r,g,l.lineHeight,v))},f.prototype.ve=function(t,n,e,i,r,o,a,u,s){var i;t.save(),t.textAlign="center",t.textBaseline="middle",t.translate(i,r),t.rotate(-n),t.fillText(e,0,0),o&&(i=t.measureText(e).width,this.le(t,o,0,s,i,a,u)),t.restore()},f.prototype.de=function(t,n,e,i){var r,o,a,u;for(t.font||vt(t,i),o=0<(o=e-(r=Gt(t,n)))?o:0,a=[],u=0;u<n.length;u++)"fillingChar"===n[u].type?a.push(Ht(t,o,n[u].value)):"placeholder"!==n[u].type&&"numberPlaceholder"!==n[u].type&&a.push(n[u].value);return a.join("")},f.prototype.Ze=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v){var m,g,p,b,h,w,y,o,M,C,S,a,h;t.save(),t.textAlign!==A&&(t.textAlign=A),m=this,g=Gt(t,n=Ut(JSON.parse(JSON.stringify(n)))),p=h.isStick,y=0<(y=o-a-g-(w=(b=h?h.left:0)+(h=h?h.right:0))-2)?y:0,W(v)?this.hasInfilling(n)?1===r||4===r?e=e-(o+b-h)/2+(a+b):2===r&&(e=e-o+h+2,e+=a+b):W(g)||(1===r||4===r?e-=g/2:2===r&&(e-=g)):this.hasInfilling(n)?1===r?(e=e+(v||g)/2-(o+b-h)/2,e+=a+b):2===r&&(e=e+(v||g)-o+h+2,e+=a+b):W(g)||(1===r?e=e+v/2-g/2:2===r&&(e=e+v-g)),o=e,0<b&&b>e-d.x&&p&&(o=d.x+b+1,M=d.width-b-1),S="",n.forEach(function(t){return S+=t.value}),h=i,(a=pn([S],f.lineHeight,l)).descenderHeight&&(h+=a.descenderHeight),f.textRect=new ht.Rect(e,h,e,a.height),m.Zn(t,l,f,o,i,g,f.lineHeight,d),M?(t.save(),t.beginPath(),t.rect(o,d.y,M,d.height),t.clip(),C=this.We(t,n,e,i,y,u,s,c),t.restore()):C=this.We(t,n,e,i,y,u,s,c),m.Wn(t,l,f,e,i,C-e,f.lineHeight,d),t.restore()},f.prototype.We=function(t,n,e,i,r,o,a,u,s){for(var c,f,l,l,c=this.qn(t,"0"),f=0;f<n.length;f++)"fillingChar"===n[f].type?(t.fillText(Ht(t,r,n[f].value),e,i),o&&this.le(t,o,e,i,r,u,a),e+=r):"placeholder"===n[f].type?e+=K(t,t.font,n[f].value):"numberPlaceholder"===n[f].type?e+=c:((l=n[f].value)!==j&&t.fillText(l,e,i),l=K(t,t.font,l),o&&this.le(t,o,e,i,l,u,a),e+=l);return e},f.prototype.le=function(t,n,e,i,r,o,a){var u,s,c,f,l;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),u=t.textAlign,c=s=0,f=.5,c=mt(((l=o<=12?12:o)-12)/21+1),t.lineWidth!==c&&(t.lineWidth=c),0==(1&c)&&(f=0),u===q?e-=r/2:u===X&&(e-=r),t.beginPath(),4==(4&n)&&(s=N(i+a-o-1)-f,t.moveTo(e,s),t.lineTo(e+r,s)),2==(2&n)&&(s=N(i+a-o/2)-f,t.moveTo(e,s),t.lineTo(e+r,s)),1==(1&n)&&(s=N(i+a-1)-f,t.moveTo(e,s),t.lineTo(e+r,s)),8==(8&n)&&(s=N(i+a-1)-f,t.moveTo(e,s-c),t.lineTo(e+r,s-c),t.moveTo(e,s+c),t.lineTo(e+r,s+c)),t.stroke()},f.prototype.Qe=function(t,n){var e=4==(4&n)?"overline":"";2==(2&n)&&(e+=" line-through"),1==(1&n)&&(e+=" underline"),t.css("text-decoration",e)},f.prototype.Ke=function(){return j},f.prototype.isImeAware=function(t){return!1},f.prototype.isEditing=function(){return!1},f.prototype.Je=function(t){},f.prototype.Xe=function(t,n,e,i,r){},f.prototype.qe=function(t,n,e,i,r){},f.prototype.lfe=function(t,n){return t},f.prototype.toJSON=function(){var t,n,e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},f.prototype.fromJSON=function(t){if(t)for(var n in t)W(t[n])||(this[n]=t[n])},a=f,u.Base=a,(0,ht.$e)(a),e.ti[0]=a,u.paintDecoration=Wt,u.paintStyleDecorationOutSideIcons=Kt},"./dist/core/celltype/cellType.entry.js":function(t,n,e){"use strict";var i,r,o,a,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),o=e("./dist/core/celltype/headercelltype.js"),a=e("./dist/core/celltype/textcelltype.js"),Object.defineProperty(n,"Corner",{set:function(t){t!==o.Corner&&(o.Corner=t)},get:function(){return o.Corner}}),Object.defineProperty(n,"ColumnHeader",{set:function(t){t!==o.ColumnHeader&&(o.ColumnHeader=t)},get:function(){return o.ColumnHeader}}),Object.defineProperty(n,"RowHeader",{set:function(t){t!==o.RowHeader&&(o.RowHeader=t)},get:function(){return o.RowHeader}}),Object.defineProperty(n,"Text",{set:function(t){t!==a.Text&&(a.Text=t)},get:function(){return a.Text}}),r(e("./dist/core/celltype/celltype.ns.js"),n),r(e("./dist/core/celltype/basecelltype.js"),n),r(e("./dist/core/celltype/textcelltype.js"),n),r(e("./dist/core/celltype/headercelltype.js"),n)},"./dist/core/celltype/celltype.ns.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ti=void 0,n.ti={}},"./dist/core/celltype/headercelltype.js":function(p,t,n){"use strict";var e,i,r,b,F,o,S,L,w,B,T,D,P,G,j,O,A,E,U,H,n,i,r,a,u,s,c;function d(t,n){return w.He(t=t||0,"gc-"+n+"-"+w.Ee(t))}function I(t,n,e,i,r,o){var a,o,a=new Image,o=o;o=(o=o.replace('url("',"")).replace('")',""),a.src=o,t.drawImage(a,n,e,i,r)}function v(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,w,y,M;function C(){t.fillRect(n+1,e+1,i-1,r-1)}if(!G(u)){if(t.save(),t.beginPath(),c=o.backColor,0===u&&c)F.W.setFillStyle(t,c,n,e,i,r,C);else try{if(c=s&&s.backgroundColor,f=s&&s.backgroundImage,l=a.sheet,h=a.row,d=a.col,v=a.sheetArea,m=void 0,g=!1,l.cellStates&&u===L.VisualState.hover&&(m=l.cellStates.getStyle(h,d,v))&&m.backColor&&(c=m.backColor,g=!0),!g&&f&&-1!==f.indexOf("linear-gradient")){for(p=T(f),b={degree:90,stops:[]},w=0,y=p.length;w<y;w++)M=p[w],b.stops.push({position:M.point,color:M.color});F.W.setFillStyleGradient(t,b,n,e,i,r,C)}else c?(t.fillStyle=c,C()):f&&f!==A&&I(t,n+1,e+1,i-1,r-1,f)}catch(t){}2===a.columnHeaderFitMode&&(i=a.sheet.getColumnWidth(a.col)+1),S.Context.nt(t,n,e,i,r,o.backgroundImage,o.backgroundImageLayout,a.imageLoader),t.restore()}}function f(t,n,e,i,r,o,a,u,s,c,f,l){var h,h,c,h,f;n&&(v(n,i,r,o,a,u,s,h=s.visualState||0,h=d(h,c)),S.Context.cn(n,i,r,o,a,u,c,h,f,s.needTopGridline,s.needLeftGridline),c=new b.Rect(i,r,o,a),s.cellRect=c.clone(),t.Vn(n,s,c,e,u),(0,S.paintDecoration)(n,c,u,s),t.Tn&&(t.Tn(n,c,u,s),h=s.printZoomFactor,f=s.isPrinting&&"number"==typeof h&&1!==h?h:s.sheet.zoom(),c=t.An(c,u,f)),0<c.width)&&0<c.height&&t.paintContent(n,e,c.x,c.y,c.width,c.height,u,s,l)}function V(t,n,e,i,r,o){var n,e,o,a,n={font:n,fillStyle:e},e=i.sheet;return 0!==i.visualState&&2007<parseInt(o.zIndex,10)&&e.ni(i.row,i.col,r)&&(o=void 0,a=r===L.SheetArea.rowHeader?"gc-rowHeader":"gc-columnHeader",o=e.ei(i.row,i.col,r)?t(i.visualState,a+"-selected"):t(i.visualState,a+"-highlight"),n.fillStyle=o.color,n.font=F.W.ii(n.font,"bold")),n}function l(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,v,m,g,p,m,l,m,l,m,d,h={},d=s.sheet,v={sheet:d,row:s.row,col:s.col,sheetArea:c,quotePrefix:u.quotePrefix},v=t.format(j(e),u.formatter,h,v);v&&(n.save(),n.beginPath(),m=d.rowFilter&&d.rowFilter(),g=s.columnHeaderFitMode,!(p=!!(m&&m.rn(s.row,s.col,c)&&m.filterButtonVisible(s.col)))&&!l||g!==L.ColumnHeaderFitMode.normal&&g!==L.ColumnHeaderFitMode.vertical||(G(s.cornerX)||(o=s.cornerX-i),o-=d.an(new b.Rect(i,r,o,a),c).width),(m=(m=u.foreColor)||f.color)&&n.fillStyle!==m&&(n.fillStyle=m),l=u.textOrientation,m=u.isVerticalText,l=0===g&&d.NMi&&0!==l&&!G(l)&&-90<=l&&l<=90&&!m,e&&e.richText&&0<e.richText.length||m?y(t,d,n,e,i,r,o,a,u,v,h,s,c,f):1===g||l?(m=V(t.getThemeStyle,u.font||n.font,n.fillStyle,s,c,f),u.foreColor=m.fillStyle,u.font=b.util.yt(m.font),1===g&&(u.textOrientation=-90),d=t.Pn(n,v,u,s,i,r,o,a),t.Kn(n,e,i,r,o,a,u,s,v,h,E,d.externals)):M(t,n,e,i,r,o,a,u,v,h,s,c,f),n.restore())}function y(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,h,d,m,g,p,b,w,y,w,y,w,M,y,C,S,w,h,T,A,I,x,N,k,_,v=new H(r,o,a,u),h=V(t.getThemeStyle,s.font||e.font,e.fillStyle,l,h,d),d=s.isVerticalText,m=s.hAlign,g=z(s),p=t.Ft(s.formatter||s._autoFormatter,i.text),b=O(!0,[],t.Pt(i,c,p,h.font,h.fillStyle));if(i&&i.richText&&0<i.richText.length&&(w=l.sheet?l.sheet.zoom():1,y=l.printZoomFactor,y=l.isPrinting&&"number"==typeof y&&1!==y?y:E,t.te(b,h,w,y)),w=t.Pn(e,j(i),s,l,r,o,a,u),M=(y=t.Hn(w.externals.left))+(w=t.Hn(w.externals.right)),y={left:y,right:w},!s.wordWrap&&s.shrinkToFit&&t.ne(b,a-M,u,s,h,1,d),C=t.ee(e,c,s.font,d?u:a-M,g,d?s.vAlign:s.hAlign,s.wordWrap,d,b),S=t.re(C,s,m),R(e,s,r,o,a,u,g,C[0].textLength,S[0].lineHeight),w=d?D(c):E,h=!1,s.wordWrap||s.shrinkToFit||!s.showEllipsis||!d||i.richText||(h=!0),T=t.ae(v.x,v.y,v.width,v.height,m,s.vAlign,g,d,w,C,S,y,h),A=[],h&&f&&(f.content&&1===f.content.length&&"text"===f.content[0].type||!f.content&&1===C.length&&C[0].text)&&t.Xn(e,l,C,S,s,u,o,g,T,A),1===(I=C.length)&&f.content&&!p)t.ue(e,n,c,f,T[0].x,T[0].y,a,u,m,s,v.width,v.height,g,d,C[0].textLength,l,y,v);else for(x=0;x<I;x++)N=t.se(C),k=T[0].x,"center"===e.textAlign?k-=N/2:"right"===e.textAlign&&(k-=N),t.Zn(e,s,l,k,T[0].y,N,0,v),t.ce(e,n,T[x].x,T[x].y,S[x],m,C[x],A[x],_=a-M-3-2*g),t.Zn(e,s,l,k,T[0].x,N,0,v)}function M(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,l,m,h,g,p,h,b,w,y,M,y,C,S,v,v,M,y,b,e,v,M,y,T,A,I,x,N,k,_,D,y,j,C,O,l,M,h,a,E,R,d=new H(i,r,o,a),v=f.columnHeaderFitMode,l=V(t.getThemeStyle,u.font||n.font,n.fillStyle,f,l,h);if(P(n,l.font),n.fillStyle=l.fillStyle,(m=0)<(h=u.textIndent)&&(m=8*h),g=parseInt(f.fontInfo.fontSize,10),p=u.hAlign,h=u.vAlign,b="left",w=2,y=t.Pn(n,s,u,f,i,r,o,a),C=(M=t.Hn(y.externals.left))+(y=t.Hn(y.externals.right)),S={left:M,right:y},w+=m+M,1===(p=v!==L.ColumnHeaderFitMode.stack||G(f.cornerX)||(a=f.cornerY-r,(v=f.colStyle)&&!G(v.hAlign))?p:0))w=(o+M-y)/2,b="center";else if(2===p)w=o-y-1,w-=m,b="right";else if(5===p)return v=u.wordWrap,M=u.shrinkToFit,y=u.showEllipsis,f.sheet.options.showFormulas&&f.isFormula?(u.hAlign=1,u.wordWrap=!1):u.wordWrap=!0,u.shrinkToFit=!1,u.showEllipsis=!1,t.Jn(n,e,i,r,o,a,u,f,s,c,null,S),u.hAlign=5,u.wordWrap=v,u.shrinkToFit=M,void(u.showEllipsis=y);if(n.textAlign!==b&&(n.textAlign=b),e="alphabetic",v=2,M=u.wordWrap,y=u.shrinkToFit,T=u.font,A=f.lineHeight,I=[],x=b=0,!M&&y)for(k={value:!1},_=N=0;_<3&&!1===k.value&&(D=n.measureText(s).width,(N=Math.max(0,o-4-(1===p?0:m)))<D);_++)T=F.W.V(T,N/D,k,!0).font,P(n,T);if(y=0,M&&(y=o-C-3-m,1<(x=(I=B.un(s,--y,l.font)).length))&&0!==h&&(b=(x-1)*A),C=A/2-g/2+(j=8<g?U((g-8)/5+2):1)-1,!M&&u.showEllipsis&&t.fe(f,c,s,n,o,p,m),v+=A-C,1===h?v=(a-b)/2+A/2-C:2===h&&(v=a-b-2-C),n.textBaseline!==e&&(n.textBaseline=e),O=u.textDecoration,l=d.x,M=d.y,h=d.width,a=d.height,u.wordWrap)if(n.rect(l,M,h,a),n.clip(),n.beginPath(),E=r+v,1<x){for(t.Zn(n,u,f,i+w,E,y,A*x,d),_=0;_<x;_++)n.fillText(I[_],i+w,E),O&&(D=n.measureText(I[_]).width,t.le(n,O,i+w,E,D,g,j)),E+=A;t.Zn(n,u,f,i+w,E,y,A*x,d)}else t.he(n,s,c,i+w,r+v,p,h,m,O,j,g,f,u,S,d);else(h<(R=n.measureText(s).width)||a<A)&&(n.rect(l,M,h,a),n.clip(),n.beginPath()),t.he(n,s,c,i+w,r+v,p,h,m,O,j,g,f,u,S,d,void 0,void 0,u.showEllipsis)}function R(t,n,e,i,r,o,a,u,s){var c=!1,c;(c=!!n.wordWrap||(n.isVerticalText?o<u+a||r<s:r<u+a||o<s))&&(t.rect(e,i,r,o),t.clip(),t.beginPath())}function z(t){var n=0,t=t.textIndent;return n=0<t?8*t:n}function h(){var t=u.call(this)||this;return t.typeName="2",t}function m(){var t=s.call(this)||this;return t.typeName="3",t}function g(){var t=c.call(this)||this;return t.typeName="4",t}e=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RowHeader=t.ColumnHeader=t.Corner=void 0,i=n("Common"),r=n("./dist/core/util/domUtil.js"),b=n("./dist/core/util/common.js"),F=n("./dist/core/worksheet/stylehelper.js"),o=n("./dist/core/celltype/celltype.ns.js"),S=n("./dist/core/celltype/basecelltype.js"),L=n("./dist/core/core.enum.js"),w=b.I,B=b.q,T=b.mt.ri,D=b.mt.pt,P=b.mt.bt,G=i.Common.lt.ht,j=b.mt.wt,O=r.GC$.extend,A="none",E=void 0,U=Math.floor,H=b.Rect,u=S.Base,e(h,u),h.prototype.paint=function(t,n,e,i,r,o,a,u,s){f(this,t,n,e,i,r,o,a,u,"columnHeader",1,s)},h.prototype.paintContent=function(t,n,e,i,r,o,a,u,s){var c,f,c;S.Context.dn(t,j(n),e,i,r,o,u)||l(this,t,n,e,i,r,o,a,u,1,f=d(u.visualState,"columnHeader"),s)},t.ColumnHeader=n=h,o.ti[2]=n,s=S.Base,e(m,s),m.prototype.paint=function(t,n,e,i,r,o,a,u){f(this,t,n,e,i,r,o,a,u,"rowHeader",2)},m.prototype.paintContent=function(t,n,e,i,r,o,a,u){var s,c,s;S.Context.dn(t,j(n),e,i,r,o,u)||l(this,t,n,e,i,r,o,a,u,2,c=d(u.visualState,"rowHeader"))},t.RowHeader=i=m,o.ti[3]=i,c=S.Base,e(g,c),g.prototype.paint=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,f,l,h,d,v,m,g,p,s,c,b,l;if(t){t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),s=this,c=u.visualState||0;try{l=(f=s.getThemeStyle(u.visualState,"gc-corner-"+w.Ee(c)))&&f.backgroundColor,h=f&&f.backgroundImage,l?(t.fillStyle=l,t.fillRect(e,i,r,o)):h&&h!==A&&I(t,e,i,r,o,h)}catch(t){}if(l=(f=s.getThemeStyle(4,"gc-corner-triangle-"+w.Ee(c)))&&f.backgroundImage,h=f&&f.backgroundColor,d=t.createLinearGradient(e+r/2,i,e+r/2,i+o),l&&-1!==l.indexOf("linear-gradient")){for(m=0,g=(v=T(l)).length;m<g;m++)p=v[m],d.addColorStop(p.point,p.color);t.fillStyle=d}else h&&(d.addColorStop(.125,"#f6fafb"),d.addColorStop(1,h),t.fillStyle=d);(s=t.createLinearGradient(e+r,i+1,e+r,i+o-2)).addColorStop(0,f.borderLeftColor),s.addColorStop(1,f.borderRightColor),t.beginPath(),t.strokeStyle=s,t.moveTo(e+r-.5,i),t.lineTo(e+r-.5,i+o),t.stroke(),u.needLeftGridline&&(t.beginPath(),t.strokeStyle=f.borderLeftColor,t.moveTo(e+.5,i),t.lineTo(e+.5,i+o),t.stroke()),(c=t.createLinearGradient(e,i,e+r-2,i)).addColorStop(0,f.borderTopColor),c.addColorStop(1,f.borderBottomColor),t.beginPath(),t.strokeStyle=c,t.moveTo(e,i+o-.5),t.lineTo(e+r,i+o-.5),t.stroke(),u.needTopGridline&&(t.beginPath(),t.strokeStyle=f.borderTopColor,t.moveTo(e,i+.5),t.lineTo(e+r,i+.5),t.stroke()),t.beginPath(),t.moveTo(e+r-(l=r<(l=o)?r:o)+(b=3),i+o-3),t.lineTo(e+r-3,i+o-3),t.lineTo(e+r-3,i+o-l+3),t.fill(),t.restore()}},t.Corner=r=g,o.ti[4]=r},"./dist/core/celltype/textcelltype.js":function(a,t,n){"use strict";var u,e,h,E,i,l,R,A,F,n,_,L,X,d,v,r,s,D,m,c,B,j,q,y,$,g,p,f,tt,b,w,O,nt,et,it,P,rt,ot,at,M,G,C,S,U,H,ut,V,z,Y,st,Z,ct,ft,lt,ht,dt,T,I,vt,mt,gt,x,N,pt,W,bt,wt,yt,Mt,Q,Ct,St,Tt,At,It,xt,Nt,kt,e,_t,n,Dt;function jt(t){return gt||0===t}function Ot(t){return jt(t)?(0,E.GC$)(m("textarea")):(0,E.GC$)(m("div"))}function J(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function K(t){return J(t)?B&&parseFloat(c.version)<10?r.oi(t):t.innerText:t.value}function k(t,n){J(t)?t.innerText=L(n)?"":n:t.value=n}function Et(t){var n;J(t)?((n=T.getSelection()).selectAllChildren(t),0<n.rangeCount&&n.collapseToEnd()):t.selectionStart=t.selectionEnd=t.value.length}function Rt(t){var n,e;return J(t)?0<(n=T.getSelection()).rangeCount?(e=n.getRangeAt(0)).startOffset:0:t.selectionStart}function Ft(t){var n,e;return J(t)?0<(n=T.getSelection()).rangeCount?(e=n.getRangeAt(0)).endOffset:0:t.selectionEnd}function Lt(t){var n,t,e,i,r,o,n=t.keyCode,t=t.shiftKey,e={106:42,107:43,109:45,110:46,111:47,173:45},i={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},r={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},o=n;return 96<=n&&n<=105?o=n-48:e[n]?o=e[n]:t&&r[n]?o=r[n]:!t&&i[n]?o=i[n]:!t&&65<=n&&n<=90&&(o=n+32),o}function Bt(t){return t&&"BR"===t.tagName}function Pt(t){return t&&"SPAN"===t.tagName}function Gt(t){return t&&"DIV"===t.tagName}function Ut(t){return t instanceof Text}function Ht(t){return t===St}function Vt(t,n,e,i){var r,o,r,o;return t.substr(0,n)+i+t.substr(e,t.length-e)}function zt(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,a="",u=t.childNodes,s=u.length,c=0;c<s;c++)Pt(f=u[c])?a+=zt(f,n,e,i,r,o):Ut(f)?(l=n&&n.startContainer,h=n&&n.endContainer,d=f.textContent,f===l||f===h?l!==h?o=f===l?(a+=Vt(d,e,d.length,r),!0):(a+=Vt(d,0,i,""),!1):a+=Vt(d,e,i,r):o||(a+=d)):Bt(f)&&!o&&(a+="\n");return a}function Yt(t,n,e,i,r){var r,o,a,r=String.fromCharCode(Lt(r));return J(t)?0<(o=T.getSelection()).rangeCount&&Ut((a=o.getRangeAt(0)).startContainer)?zt(t,a,e,i,r):a&&a.startOffset===a.endOffset?n+r:r:Vt(n,e,i,r)}function Zt(t){var t=Kt(t);return t=t&&0<=t.indexOf(" ")?O(t," ",Ct):t}function Wt(t,n,e,i,r,o){var a,u,s,e,c,f,l,f,c,l,e,f,a=t.srcElement||t.target;a&&a.getAttribute(M)===S&&13===t.keyCode&&(t.ctrlKey||t.altKey)&&((u=v.ai())instanceof h.Worksheet&&(s=u.getCellType(u.ui,u.ci))&&(J(a)?(e&&(a.blur(),a.focus()),0<(e=T.getSelection()).rangeCount&&(c=e.getRangeAt(0),f=I.createElement("br"),l=I.createTextNode(St),c.insertNode(l),c.insertNode(f),Qt(c),(f=I.createRange()).setStartAfter(l),f.setEndAfter(l),f.collapse(!1),e.removeAllRanges(),e.addRange(f))):(c=a.selectionStart,e=(l=a.value).substr(0,c),f=l.substr(c,l.length-c),a.value=e+"\n"+f,a.selectionStart=c+1,a.selectionEnd=c+1),s.fi(u.li,x,x,t,n,!0)),y(t))}function Qt(t){var t,n,e,t=t.endContainer,n=t.lastChild;Ut(n)&&0===n.textContent.length&&t.removeChild(n),e=(n=t.lastChild).previousSibling,Ht(n.textContent)&&!Bt(e)&&0===e.textContent.length&&t.removeChild(e)}function Jt(t){var n,t,n=t;return n&&(n.indexOf(St)<0&&n.indexOf("\n")<0?n:((t=t.split("\n")).forEach(function(t,n,e){Ht(t[0])&&(e[n]=t.substr(1))}),t.join("\n")))}function Kt(t){var t,n,t=t;return t=t&&0<(n=t.length)?t.replace(/\n/g,"\n"+St):t}function Xt(t){var n,e,i,r,o,n,a,u,s,n,c,f,l,h,d,n=T.getSelection(),e=!1,i=0,r=0,o="";if(0<n.rangeCount){if(n=n.getRangeAt(0),a=Rt(t),u=Ft(t),s=n.startContainer,n=n.endContainer,Gt(s))e=!0,i=a;else if(l=void 0,0<(f=(c=s.childNodes).length))for(l=0;l<f;l++){if(!(h=c[l]).tagName||"br"!==h.tagName.toLocaleLowerCase()){s=h;break}o+="\n"}return o+(d=qt(t,a,u,s,n,e,i,r=Gt(n)?u:r)).content}}function qt(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v;if(i===r&&!o)return{content:Jt(i.textContent.slice(n,e))};for(s="",c=a,h=t.childNodes,d=u||h.length;c<d;c++)if(Pt(v=h[c])){if(s+=(f=qt(v,n,e,i,r,o,0,0)).content,f.startFlag&&(o=!0),f.endFlag){l=!0;break}}else if(Ut(v)&&v===i)s+=v.textContent.slice(n,v.textContent.length),o=!0;else{if(Ut(v)&&v===r){s+=v.textContent.slice(0,e),l=!0;break}o&&(Bt(v)?s+="\n":s+=v.innerText||v.textContent)}return{content:Jt(s),startFlag:o,endFlag:l}}function $t(t,n){for(var e,i,r,e=t.length,i=[],r=0;r<e;r++)i.push(b(t[r],n));return i}function tn(t){for(var n,e,i,n=t.length,e=0,i=0;i<n;i++)e+=t[i];return e}function nn(t,n,e,i){for(var r,o,a,u,r=0,o=e,a=0;a<t.length;a++)q&&(o=i[a]),t[a]>n?r+=o*(u=pt(t[a]/n)):r+=o;return r}function en(t,n,e){var t=K(t);return t&&"="===t[0]||""===t&&"="===n[0]||0===e&&"="===n[0]}function rn(t){var t=t&&t.tagName;return"TEXTAREA"===t||"INPUT"===t}function on(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?It:At)}function an(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?At:It)}function un(t,n){t.ki(d,{sheet:t,sheetName:t.name(),row:t.ui,col:t.ci,editingText:n})}function sn(t){var n,e,i;if(t&&t.content)for(n=t.content.length-1;0<=n&&((e=t.content[n])&&e.value&&e.value.endsWith(Tt));n--){for(i=e.value.length-1;0<=i&&e.value[i]===Tt;i--);if(-1!==i){e.value=e.value.substring(0,i+1);break}t.content.pop()}}function o(t){var n=Dt.call(this)||this;return n.allowOverflow=!0,n.typeName="1",n.editorType=L(t)?1:t,n}function cn(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===xt&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}u=this&&this.__extends||(_t=function(t,n){return(_t=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}_t(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Text=t.TextCellType=t.EditorType=void 0,e=n("Common"),h=n("./dist/core/worksheet/worksheet.js"),E=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),l=n("./dist/core/celltype/celltype.ns.js"),R=n("./dist/core/celltype/basecelltype.js"),A=n("./dist/core/core.enum.js"),F=n("./dist/core/util/common.js"),n=n("CalcEngine"),_=!!n,L=e.Common.lt.ht,X=i.q,d=i.Events.EditChange,v=i.hi,r=i.mt,s=i.di,D=r.St,m=r.En,c=r.Tt,B=c.msie,j=c.edge,q=c.chrome,y=r.vi,$=r.gt,g=r.mi,p=r.gi,f=r.pi(),tt=r.vt,b=r.bi,w=r.Mt,O=r.yi,nt=r.yt,et=r.wt,it=r.Ct,P="left",rt="right",ot="center",at="top",M="gcUIElement",G="none",C=".gcEditingInput",S="gcEditingInput",U="width",H="height",ut="text-align",V="hidden",z="word-wrap",Y="overflow",st="vertical-align",Z="normal",ct="break-word",ft="overflow-y",lt="scroll",ht="word-break",dt="float",T=window,I=document,vt=.337,mt=f.ipad,gt=f.iphone||mt||f.android,x=null,N=void 0,pt=Math.ceil,W=Math.min,bt=Math.sin,wt=Math.cos,yt=Math.abs,Mt=Math.max,Q=parseInt,Ct="\xa0",St="\u200b",Tt=" ",At=90,It=89,xt="string",Nt="number",(n=kt=t.EditorType||(t.EditorType={}))[n.textarea=0]="textarea",n[n.editableDiv=1]="editableDiv",Dt=R.Base,u(o,Dt),o.prototype.getText=function(t,n){return t},o.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,p,g,y,p,M,C,M,S,C,T,p,v,M,s=this,c=u.sheet,f=c.zoom?c.zoom():1;if(n=s.getText(n,u),l={},u.quotePrefix=a.quotePrefix,v=(d=a.formatter)&&"General"!==d,m=D(d),"string"==typeof d&&(v=v&&!m),g=a.textOrientation,p=a.textIndent&&0!==a.textIndent,b=a.isVerticalText,w=r,g&&-90<=g&&g<=90&&!p&&!b&&(p=yt(g*Math.PI/180),w=(o-u.lineHeight*wt(p))/bt(p)),g=(y=s.Pn(t,h,a,u,e,i,r,o)).externals,p=s.Hn(g.left),M=s.Hn(g.right),2===(C=3===(C=a.hAlign)?$(C,n,a.formatter||a._autoFormatter):C)?w-=M:0===C&&(w-=p),M=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,v?S=a.formatter:M?S=a._autoFormatter:c.parent&&c.parent.options.numbersFitMode===A.NumbersFitMode.mask?S=R.Context.Nt(t,n,w,a,f):c.parent&&c.parent.options.numbersFitMode===A.NumbersFitMode.overflow&&(S=a._autoFormatter),!(h=m&&(n instanceof Date||"boolean"==typeof n||n instanceof Boolean||"number"==typeof n)?s.format(n,d,{}):s.format(et(n),S,l,u))||!h.endsWith(Tt)||!0!==a.wordWrap&&(5!==a.hAlign||u.sheet.options.showFormulas&&u.isFormula)||(h=(0,F.r2e)(h),sn(l)),C=new F.Rect(e,i,r,o),this.adjustRectForIconSet(a.hAlign,u.sheet,u.row,u.col,u.sheetArea,C,l.content&&this.hasInfilling(l.content)),e=C.x,r=C.width,!0!==a.shrinkToFit&&!b)if(it(n)){if(c.parent){switch(T=h,c.parent.options.numbersFitMode){case A.NumbersFitMode.mask:T=this.wi(t,h,w,a,f,u,l,c);break;case A.NumbersFitMode.overflow:T=this.overflow(t,u,n,a,c,h,l)}h=T}}else void 0===c.Ut.Ci(u.row,u.col,u.sheetArea)||a.showEllipsis||c.Ut.$n(u.row,u.col,void 0,u.sheetArea);p=a.labelOptions,v=a.watermark,M=!p||0!==p.visibility,v&&!h&&M?s.paintText(t,v,e,i,r,o,a,u,v,l,vt):(h||l.content&&l.content.length||a.cellButtons&&a.cellButtons.length)&&s.paintText(t,n,e,i,r,o,a,u,h,l,N,g)},o.prototype.wi=function(t,n,e,i,r,o,a,u){var s,t,e,s,s=o.cellOverflowLayout&&o.cellOverflowLayout.expandedWidth,t=R.Context.Et(t,n,L(s)?e:s,i,r),e=o.row,s=o.col;return n!==t?(delete a.content,i.textIndent=0,u.Ut.$n(e,s,u.getText(e,s,o.sheetArea),o.sheetArea)):u.Ut.$n(e,s,void 0,o.sheetArea),t},o.prototype.overflow=function(t,n,e,i,r,o,a){var u,s,t,c,f,l,h,u=n.row,s=n.col;if(i.wordWrap&&(i.wordWrap=!1),t=w(t,i.font,o),c=r.Jt.Kt(s),l=void 0,!(f=n.cellOverflowLayout)&&c<t)l=r.getText(u,s,n.sheetArea);else if(f&&c<t&&this.Si(f.backgroundWidth)&&this.Si(f.valueWidth)){if(!this.Si(i.hAlign))return;h=void 0,l=(h=1!==i.hAlign?f.valueWidth>f.backgroundWidth:f.valueWidth/2>f.backgroundLeftWidth||f.valueWidth/2>f.backgroundRightWidth)?r.getText(u,s,n.sheetArea):void 0}return r.Ut.$n(u,s,l,n.sheetArea),o},o.prototype.Si=function(t){return null!=t},o.prototype.createEditorElement=function(t,n){var t,t,n,e,t=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,t=p(t)+1e3;return(0,E.GC$)(n).css("z-index",t),n=Ot(this.editorType),(0,E.GC$)(n).css({font:"normal 11pt calibri",outline:G,resize:G,border:G,"vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(z,Z).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(Y,V).attr(M,S),c.safari&&(0,E.GC$)(n).css("-webkit-user-select","auto"),(e=J((0,E.GC$)(n)[0]))&&((0,E.GC$)(n).css("display","table-cell"),(0,E.GC$)(n).css(ht,Z)),(0,E.GC$)(n)[0]},o.prototype.getEditorValue=function(t,n){var e,i,n,t;return t&&(e=K(t),i=!L(e)&&0<e.length,R.Base.et(n&&n.sheet,"getEditorValue",n={editor:t,ns:C,editorValue:e}),i)?(t=(t=Jt(e=n.editorValue)).replace(/\r\n?/g,"\n")).indexOf(Ct)<0?t:O(t,Ct," "):x},o.prototype.setEditorValue=function(t,n,e,i,r){var o,a,n,a,r;t&&(a=o=void 0,e&&e.sheet&&(o=e.sheet.Ai,a=e.sheet.getValue(e.row,e.col)),n=Zt(n),R.Base.et(e&&e.sheet,"setEditorValue",a={editor:t,ns:C,editorValue:n,originValue:a,startEditByKeydown:o,addPercent:i||r,cancel:!1}),!0===a.cancel?(k(t,a.editorValue),this.qmt(t,a.caret),e&&e.sheet&&(r=e.sheet).ki(F.Events.FormulaTextBoxTextChanged,{sheet:r,sheetName:r.name(),text:a.editorValue})):B?o&&e.isImeInput||k(t,n=L(n)?i?"%":"":n):k(t,n=o?i?"%":"":n))},o.prototype.selectAll=function(t,n){var e;t&&t.select?t.select():T.getSelection().selectAllChildren(t)},o.prototype.focus=function(t,n){var e,i,t,n,e=this;e.isImeAware()&&t?Et(i=t):i=t.parentNode.parentNode,i.focus(),t=e.Xmt(i),R.Base.et(n&&n.sheet,"afterSetEditorFocus",n={editor:i,caret:t,cancel:!1}),!0===n.cancel&&n.caret&&e.qmt(i,n.caret)},o.prototype.je=function(t,n,e,i){var r,o,n,r=t&&i&&i.sheet,o={},n=g(n,e,r,i,o);return t.Ii=o.formatter||N,n},o.prototype.Xmt=function(t){var n,e,i,r,o,r;return t&&(n=I.activeElement===t)?(i=e=-1,o=r=void 0,rn(t)?(e=t.selectionStart,i=t.selectionEnd):J(t)&&0<(r=T.getSelection()).rangeCount&&((r=(o=r.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(o.endContainer,o.endOffset),i=r.toString().length,(r=o.cloneRange()).selectNodeContents(t),r.setEnd(o.startContainer,o.startOffset),e=r.toString().length,r.detach()),{start:e,end:i,length:i-e}):null},o.prototype.qmt=function(t,n){var e,i,r,o,a,u,s,e=n.start,i=n.end,r=document.createRange(),o=window.getSelection();if(t.childNodes[0]){if((a=t.childNodes[0].textContent.length)<e){for(u=0;t.childNodes[u]&&0<=e;)e-=t.childNodes[u].textContent.length,u++;r.setStart(t.childNodes[u-1],e+t.childNodes[u-1].textContent.length)}else r.setStart(t.childNodes[0],e);if(a<(i=i>n.start?i-1:i)){for(u=0;t.childNodes[u]&&0<=i;)i-=t.childNodes[u].textContent.length,u++;r.setEnd(t.childNodes[u-1],i+t.childNodes[u-1].textContent.length)}else r.setEnd(t.childNodes[0],i);r.collapse(!0),o.removeAllRanges(),o.addRange(r)}else t.value&&(a=(s=t.value).length,e=W(e,a),i=i>n.start?i-1:i,i=W(i,a),t.setSelectionRange(e,i))},o.prototype.activateEditor=function(n,l,h,d,v,m,g){var p,b,w,n,o,n,t,e,i,r,a,u,e,p=d&&d.sheet;if(p&&(b=this,w=n)){if(n=(0,E.GC$)(w),o=J(w),b._editingElement=w,n.attr(M)||n.attr(M,S),f.android&&n.bind("input"+C,function(t){try{b.fi(w,l,h,t,d,!1,v,m,g)}catch(t){}}),n.bind("keydown"+C,function(t){var n,e,i;try{n=t.keyCode,e={event:t,editor:w,value:K(w),caret:b.Xmt(w),cancel:!1},8===n?(R.Base.et(p,"editorBackspace",e),!0===e.cancel?(y(t),k(w,e.value),b.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})):o&&s.processBackspaceAndLeftArrowKeyEvent(t,!0)):46===n?(R.Base.et(p,"editorDelete",e),!0===e.cancel?(y(t),k(w,e.value),b.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})):o&&s.processDeleteAndRightArrowKeyEvent(t,!0)):37===n&&o?s.processBackspaceAndLeftArrowKeyEvent(t,!1):39===n&&o&&s.processDeleteAndRightArrowKeyEvent(t,!1),on(t)&&o?(R.Base.et(p,"editorUndo",e),!0===e.cancel&&(y(t),k(w,e.value),b.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value}))):an(t)&&o&&(R.Base.et(p,"editorRedo",e),!0===e.cancel)&&(y(t),k(w,e.value),b.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})),((i=229===n||0===n)||b.Ni)&&!f.android||b.fi(w,l,h,t,d,!0,v,m,g),Wt(t,d,b.Ni,v,m,g)}catch(t){}}),n.bind("keyup"+C,function(t){var n,e,i,r,n=t.keyCode,e=t.ctrlKey,i=t.altKey,r;(!(229===n||0===n)&&!b.Ni||f.android)&&(46!==n&&8!==n&&(90!==n&&89!==n||!e||i)||(o&&"\n"===w.innerText&&(0,E.GC$)(w).empty(),b.fi(w,l,h,t,d,!1,v,m,g)),13!==n&&9!==n&&27!==n&&16!==n||e||i)&&un(p,b.getEditorValue(w,d))}),n.bind("mousedown"+C,function(){1===p.Di&&(p.Di=2,p._i(1,2))}),n.bind("textInput"+C,function(t){var n,n,e,e;if(c.safari){if(t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key)return;n=t.key||t.data,n={editor:w,value:n,caret:b.Xmt(w),cancel:!1},R.Base.et(p,"editorInput",n),!0===n.cancel&&(y(t),k(w,n.value),e=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&e&&e.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value}))}t.data&&(b.probabilityAddPercentSpec||b.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)&&((e=document.createElement("span")).innerText="%",e.id="updateEditorImpAddPercent",("#text"===w.firstChild.nodeName?w:w.firstChild).appendChild(e),delete b.probabilityAddPercentSpec,delete b.probabilityAddPercent)}),n.bind("compositionstart"+C,function(){b.Ni=!0,b.Ei=K(w)}),n.bind("compositionupdate"+C,function(t){b.fi(w,l,h,t||x,d,!0,v,m,g)}),n.bind("compositionend"+C,function(t){var n,n,e,e,n,t,i,n=t.data,n={editor:w,value:n,caret:b.Xmt(w),isImeInputting:!0,cancel:!1};R.Base.et(p,"editorInput",n),!0===n.cancel&&(y(t),k(w,n.value),e=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&e&&e.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})),b.fi(w,l,h,t||x,d,!1,v,m,g),b.Ni=!1,e=t.keyCode,n=t.ctrlKey,t=t.altKey,i=b.getEditorValue(w,d)||"",b.Ei!==i&&(e===N||13!==e&&9!==e||n||t)&&un(p,i)}),o&&(n.bind("copy"+C,function(t){var n=T.clipboardData,e=t.clipboardData,i=Xt(t.currentTarget);L(i)||(n&&n.setData?(n.setData("text",i),y(t)):e&&e.setData&&(e.setData("text/plain",i),y(t)))}),n.bind("cut"+C,function(t){var n,n,e,i,r,r,n=Xt(t.currentTarget),e="editorCut";!L(n)&&w.Rse&&(T.clipboardData&&T.clipboardData.setData?(i="text",r=T.clipboardData):t.clipboardData&&t.clipboardData.setData&&(i="text/plain",r=t.clipboardData),n={editor:w,clipboardData:r,dataName:i,caret:b.Xmt(w)},R.Base.et(p,e,n),y(t),k(w,n.value),r=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&r&&r.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(w,n.caret)),b.ji=T.setTimeout(function(){un(p,b.getEditorValue(w,d)),b.ji&&(clearTimeout(b.ji),delete b.ji)},10)}),n.bind("paste"+C,function(t){var n,e,i,r,o,a,u,s,c,f,n=!1;try{e=void 0,B&&!j&&T.clipboardData&&T.clipboardData.getData?e=T.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(e=t.clipboardData.getData("text/plain")),e=Zt(e=e.replace(/\r\n?/g,"\n")),i={editor:w,pasteValue:e,caret:b.Xmt(w),cancel:!1},R.Base.et(p,"editorPaste",i),!0===i.cancel?(n=!0,k(w,i.pasteValue),b.qmt(w,i.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:i.pasteValue})):0<(r=T.getSelection()).rangeCount&&((a=(o=r.getRangeAt(0)).startOffset)!==(u=o.endOffset)&&o.deleteContents(),en(w,e,a)||(s=I.createElement("span"),"\n"===(e=e.replace(/\u200B/g,""))[(c=e.length)-1]&&(e="\r"===e[c-2]?e.substr(0,c-2):e.substr(0,c-1)),s.innerText=e,o.insertNode(s),(f=document.createRange()).setStartAfter(s),f.setEndAfter(s),f.collapse(!1),r.removeAllRanges(),r.addRange(f),n=!0))}catch(t){}if(b.ji=T.setTimeout(function(){b.fi(w,l,h,t,d,!1,v,m,g),p.parent&&p.parent.ki(F.Events.FormulaTextBoxUpdatePosition,void 0),un(p,b.getEditorValue(w,d)),b.ji&&(clearTimeout(b.ji),delete b.ji)},10),n)return!1}),n.bind("keypress"+C,function(t){var n,n,t;t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key||(n=t.key||t.data,n={editor:w,value:n,caret:b.Xmt(w),cancel:!1},R.Base.et(p,"editorInput",n),!0===n.cancel&&(y(t),k(w,n.value),t=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&t&&t.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),b.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})))})),t=n=void 0,(n=!d||(t=_&&p.getFormula(d.row,d.col))?n:l.mask)&&n.pattern&&"="===n.pattern[0]){e=p.Lp,i=p.Uw(3),r=0<=d.row?d.row:0,a=0<=d.col?d.col:0;try{u=e.evaluate(i,n.pattern,r,a),n.pattern="object"==typeof u?"":""+u}catch(t){n.pattern=""}}e={editor:w,ns:C,mask:n,text:K(w)},R.Base.et(p,"activateEditor",e)}},o.prototype.deactivateEditor=function(t,n){var e,i,r,o,a,u,s,c,f,l,e=this;if(R.Base.et(n&&n.sheet,"deactivateEditor",{editor:t}),t&&n&&n.sheet){if(i=n.sheet,e.Ni&&mt&&i.Oi)try{(0,E.GC$)(t).trigger("compositionend"+C)}catch(t){}if(r=i.getActualStyle(n.row,n.col,n.sheetArea).cellPadding)for(o=[P,at],a=[3,0],u=0;u<o.length;u++)s=parseInt(cn(r)[a[u]],10),e.shiftPadding(t,o[u],s=typeof s==Nt&&0<s?s:0);(0,E.GC$)(t).unbind(C),c=i.getActiveRowIndex(),f=i.getActiveColumnIndex(),l=i.getActualStyle(c,f),i.Ri(e,t,c,f,l,N,N,N,N,n.sheetArea)}e._editingElement=x},o.prototype.shiftPadding=function(t,n,e){var t=(0,E.GC$)(t).parent();t&&(n===P?t.css({left:(+(0,E.GC$)(t).css(P).replace("px","")||0)-e}):n===at&&t.css({top:(+(0,E.GC$)(t).css(at).replace("px","")||0)-e}))},o.prototype.getEditingElement=function(){return this._editingElement},o.prototype.Bi=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,r,m,g,p,b,w,y,M,C,S,T,A,y,A,t,I,a,I,l,t,e,x,v,e,N,k,_,D,v,x,j,O,e,a,I,m,f,i,c=r&&r.sheet,f=this,l=c.options.sheetAreaOffset,h=t;if(h&&c&&(d=(0,E.GC$)(h),v=c.Dn,r=r.preventOverflow,m=K(h),c.isEditing())){if(g=J(h),b=P,w=p=void 0,y=R.Context.gn,T=S=C=M=0,n&&(M=y(n,0,!1,A=c.zoom()),C=y(n,1,!1,A),S=y(n,2,!1,A),T=y(n,3,!1,A),1===(p=$(n.hAlign,t.Li))||5===p?b=ot:2===p&&(b=rt),d.css(ut,b),n.foreColor&&d.css("color",n.foreColor),(w=n.font||v.Nn())&&(1<c.zoom()&&(w=v._n(w)),d.css("font",nt(w))),n.textDecoration)&&f.Qe(d,n.textDecoration),y=(Q(d.css("padding-left"),10)||0)+(Q(d.css("padding-right"),10)||0),A=(Q(d.css("padding-top"),10)||0)+(Q(d.css("padding-bottom"),10)||0),e||(y+=2*Number(d.parent().css("left").replace("px","")),A+=2*Number(d.parent().css("top").replace("px",""))),(a=L(a)?e:a)&&(t=c.Fi(),I=e.width,a.x+a.width-l.left>t.width&&(I=e.width=t.width-e.x,a.width=t.width-a.x),d.css(U,I-y).css(H,e.height-A),h.maxWidth=l.left+t.width-e.x-y-C,d.css("max-width",h.maxWidth+"px"),h.maxHeight=l.top+t.height-e.y-A-S,h.minWidth=Q(h.style.width,10),h.minHeight=Q(h.style.height,10)),a=Rt(h),I=Ft(h),l=(o=(o=o&&i&&i.keyCode&&c.rt.Pi(i)&&0===a&&I===m.length)||c.Ai)&&!n.mask?"":m,w=(w=h.style.font)||v._n(v.Nn()),t=tt(w),i&&f.probabilityAddPercent&&(e=i.key)&&-1!==F.NUMBER_ARRAY.indexOf(e)&&(c.parent.options.enableFormulaTextbox?(v=h.innerText,/[a-z]/i.test(v)?f.probabilityAddPercent=!1:((x=document.createElement("span")).innerText="%",x.id="updateEditorImpAddPercent",h.appendChild(x),delete f.probabilityAddPercent)):((x=document.createElement("span")).innerText="%",x.id="updateEditorImpAddPercent",h.firstChild.appendChild(x),delete f.probabilityAddPercent)),!o&&i&&(e=c.parent,c.rt.Pi(i)&&8!==i.keyCode&&L(e.contextMenu.menuView.getHost())&&(l=Yt(h,l,a,I,i)),f.Ni)&&(l=B?m:f.Ei+i.data),N=[],_=k=void 0,D=(N=n&&(n.wordWrap||5===p)?X.un(l,Q(h.style.width)-y,w):l.split(/\r\n|\r|\n/)).length,h.minWidth=W(h.minWidth,h.maxWidth),h.minHeight=W(h.minHeight,h.maxHeight),n&&(n.wordWrap||5===p)||0<D){if(x=v=void 0,v=q?tn(x=$t(N,w)):D*t,n&&(n.wordWrap||5===p))d.css(z,ct).css(Y,V).css("max-width",h.style.width);else{for(O=[],k=j=0;k<D;k++)_=pt(c.Gi(N[k],w)),O.push(_),j=Mt(j,_);e=d.css(z),a=Q(h.style.width),n||e!==ct?j<=h.minWidth?(d.css(U,h.minWidth).css(z,Z).css(Y,V),g&&d.css(ht,Z)):j>h.minWidth&&j<=h.maxWidth&&!r?(d.css(U,j).css(z,Z).css(Y,V),g&&d.css(ht,Z)):j>h.maxWidth&&!r&&(d.css(U,h.maxWidth-2).css(z,ct).css(Y,V),v=nn(O,h.maxWidth,t,x)):a<j&&!r&&(v=nn(O,a,t,x))}v<=h.minHeight?d.css(H,h.minHeight).css(dt,G):v>h.minHeight&&v<=h.maxHeight?d.css(H,v).css(dt,G):v>h.maxHeight&&d.css(H,h.maxHeight-1).css(ft,lt).css(dt,P)}return b=d.css(ut),I=d.width()-h.minWidth,L(b)||b===P||(b===ot?d.css(P,h.originalLeft-I/2):b===rt&&d.css(P,h.originalLeft-I)),n&&g&&(1===(m=n.vAlign)?d.css(st,"middle"):2===m&&d.css(st,"bottom")),f=Q(h.style.height)+A+M+S,i=y+T+C,d.css(ft)===lt?{width:h.offsetWidth+i,height:o?0:f}:{width:Q(h.style.width)+i,height:f}}},o.prototype.updateEditor=function(t,n,e,i,r,o,a){var n,i,u;return e=this.Bi(t,n,e,x,i,!1,r,o,a),B&&t&&(i=(n=(0,E.GC$)(t))[0].style.width,n.width(i+1).width(i)),u=!L(e)&&t?new F.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,e.width,e.height):u},o.prototype.fi=function(t,n,e,i,r,o,a,u,s){var i,o;e=this.Bi(t,n,e,i,r,o,a,u,s),B&&t&&(o=(i=(0,E.GC$)(t))[0].style.width,i.width(o+1).width(o)),!L(e)&&t&&(L(a)?a=e:(a.x=N,a.y=N),this.updateEditorContainer(t,e,n,r,a,u,s))},o.prototype.updateEditorContainer=function(t,n,e,i,r,o,a){var u,u,s;i&&i.preventOverflow?(Dt.prototype.updateEditorContainer.call(this,t,n,e,i,r,o,a),(u=t.parentNode)&&n&&(u=(0,E.GC$)(u),0<(s=n.width))&&u.width(s)):(n&&n.width&&r&&r.width&&(r.width=n.width),n&&n.height&&r&&r.height&&(r.height=n.height),Dt.prototype.updateEditorContainer.call(this,t,n,e,i,r,o,a))},o.prototype.updateImeMode=function(t,n,e){this.isImeAware()&&t&&R.Context.hn(t,n)},o.prototype.isReservedKey=function(t,n){var e=t.srcElement||t.target,i=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.metaKey;return!!(e&&n&&n.isEditing&&e.getAttribute(M)===S)&&(13===i&&(r&&!t.shiftKey||o)||90===i&&r&&!o||89===i&&r&&!o||67===i&&(r||a)&&!o||88===i&&(r||a)&&!o)},o.prototype.isImeAware=function(t){return!0},o.prototype.toJSON=function(){var t,n,e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&"_editingElement"!==e&&(t[e]=n[e]);return t},o.prototype.lfe=function(t,n){var n={eventName:n,eventArg:t};return R.Base.et(t.sheet,"onCreateEventArg",n),n.eventArg},t.TextCellType=e=o,t.Text=e,l.ti[1]=e},"./dist/core/core.definition.js":function(){},"./dist/core/core.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,s,r,e;function c(t,n){return a.n1e(t,n)}i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)},Object.defineProperty(n,"__esModule",{value:!0}),n.Aoe=n.n1e=n.CellTypes=void 0,e("./dist/core/core.res.en.js"),o=e("./dist/core/util/common.js"),Object.defineProperty(n,"getTypeFromString",{set:function(t){o.getTypeFromString=t},get:function(){return o.getTypeFromString}}),r(e("./dist/core/core.ns.js"),n),r(e("./dist/core/core.interface.js"),n),r(e("./dist/core/core.enum.js"),n),r(e("./dist/core/util/common.js"),n),r(e("./dist/core/excel-io-util/common.js"),n),r(e("./dist/core/excel-io-util/excel-types.js"),n),r(e("./dist/core/excel-io-util/range-parser.js"),n),r(e("./dist/core/excel-io-util/excel-helper.js"),n),r(e("./dist/core/excel-io-util/excel-style.js"),n),r(e("./dist/core/util/domUtil.js"),n),e("./dist/core/core.definition.js"),s=-1,1===(u=(a=e("./dist/core/lc/releaseLc.js"))._pt)&&(s=Math.floor(5*Math.random()),n["G".concat("C","$")]["s".concat("d")]=s),r(e("./dist/core/util/theme.js"),n),r(e("./dist/core/util/basedialog.js"),n),r(e("./dist/core/util/imageLoader.js"),n),r(e("./dist/core/util/tasks.js"),n),r(e("./dist/core/util/crypto.js"),n),r(e("./dist/core/util/dataManager.js"),n),0===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/stylehelper.js"),n),1===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/style.js"),n),2===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/clipboardhelper.js"),n),3===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/worksheet-model.js"),n),4===s&&e("./dist/core/lc/lcRegister.js"),r(e("./dist/core/worksheet/worksheet.js"),n),r(e("./dist/core/worksheet/worksheet-formatter.js"),n),r(e("./dist/core/worksheet/worksheet-actions.js"),n),r(e("./dist/core/worksheet/worksheet-border.js"),n),e("./dist/core/worksheet/worksheet-edit.js"),r(e("./dist/core/worksheet/worksheet-event.js"),n),e("./dist/core/worksheet/worksheet-json.js"),r(e("./dist/core/worksheet/worksheet-render.js"),n),e("./dist/core/worksheet/worksheet-selection.js"),e("./dist/core/worksheet/worksheet-sort.js"),r(e("./dist/core/worksheet/worksheet-ui.js"),n),r(e("./dist/core/worksheet/worksheet-static.js"),n),r(e("./dist/core/worksheet/worksheet-clipboard.js"),n),r(e("./dist/core/workbook/workbook.js"),n),r(e("./dist/core/workbook/workbook-json.js"),n),r(e("./dist/core/workbook/sheettabbase.js"),n),r(e("./dist/core/workbook/sheettab.js"),n),r(e("./dist/core/workbook/sheettab2007.js"),n),r(e("./dist/core/workbook/workbookpanelex.js"),n),r(e("./dist/core/util/styleManager.js"),n),s=e("./dist/core/celltype/cellType.entry.js"),n.CellTypes=s,r=e("./dist/core/celltype/headercelltype.js"),e=e("./dist/core/celltype/textcelltype.js"),s.Hi=r,s.zi=e,1!==u&&2!==u||a.Vi(n),n.n1e=c,n.Aoe=a.Aoe},"./dist/core/core.enum.js":function(F,t){"use strict";var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,L,B,P,G,U,H,V,z,Y,Z,W,E,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,R,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R,E,R;Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutDirection=t.CaptionAlignment=t.IconPosition=t.ButtonPosition=t.DropDownType=t.ButtonImageType=t.ButtonVisibility=t.RowColumnStates=t.CellStatesType=t.SortState=t.SheetArea=t.VerticalPosition=t.HorizontalPosition=t.Yi=t.ImageLayout=t.ValueType=t.RangeChangedAction=t.HeaderAutoText=t.StorageType=t.SelectionUnit=t.SelectionPolicy=t.ImeMode=t.EditorStatus=t.VisualState=t.Zi=t.VertAlign=t.VerticalAlign=t.HorizontalAlign=t.TextDecorationType=t.LabelVisibility=t.LabelAlignment=t.PasteOperationOptions=t.CopyToOptions=t.ClipboardPasteOptions=t.AutoFitType=t.InvalidOperationType=t.ResizeZeroIndicator=t.HeaderOptions=t.CalculationType=t.CalculationMode=t.CopyPasteHeaderOptions=t.ResizeMode=t.InsertShiftCell=t.ShowScrollTip=t.ScrollbarAppearance=t.ShowResizeTip=t.WorksheetType=t.ScrollbarState=t.AxisInfoChangeType=t.ScrollType=void 0,t.SheetTabState=t.DefaultChangeValueType=t.ClipboardActionType=t.OpenMode=t.OpenSaveFileType=t.FileType=t.TableStyleElement=t.SortBy=t.UsedRangeType=t.ColumnHeaderFitMode=t.AllSheetsListVisibility=t.SheetTabVisible=t.SheetType=t.HyperlinkTargetType=t.TabStripPosition=t.NumbersFitMode=t.PatternType=t.DropDownAlignment=t.DropDownDirection=t.DropdownListValue=t.GroupSort=t.CalendarStartDay=t.CalendarPage=t.LayoutDisplayAs=void 0,(E=n=t.ScrollType||(t.ScrollType={}))[E.pixels=0]="pixels",E[E.continuous=1]="continuous",(E=e=t.AxisInfoChangeType||(t.AxisInfoChangeType={}))[E.setRowCount=0]="setRowCount",E[E.setColumnCount=1]="setColumnCount",E[E.addRows=2]="addRows",E[E.deleteRows=3]="deleteRows",E[E.addColumns=4]="addColumns",E[E.deleteColumns=5]="deleteColumns",E[E.setRowHeight=6]="setRowHeight",E[E.setColumnWidth=7]="setColumnWidth",E[E.setRowVisible=8]="setRowVisible",E[E.setColumnVisible=9]="setColumnVisible",E[E.filterRows=10]="filterRows",E[E.outlineExpandRows=11]="outlineExpandRows",E[E.outlineExpandColumns=12]="outlineExpandColumns",(E=i=t.ScrollbarState||(t.ScrollbarState={}))[E.hide=0]="hide",E[E.show=1]="show",E[E.active=2]="active",E[E.inactive=3]="inactive",(E=r=t.WorksheetType||(t.WorksheetType={}))[E.worksheet=0]="worksheet",E[E.reportTemplateSheet=1]="reportTemplateSheet",(E=o=t.ShowResizeTip||(t.ShowResizeTip={}))[E.none=0]="none",E[E.column=1]="column",E[E.row=2]="row",E[E.both=3]="both",(E=a=t.ScrollbarAppearance||(t.ScrollbarAppearance={}))[E.skin=0]="skin",E[E.mobile=1]="mobile",(E=u=t.ShowScrollTip||(t.ShowScrollTip={}))[E.none=0]="none",E[E.horizontal=1]="horizontal",E[E.vertical=2]="vertical",E[E.both=3]="both",(E=s=t.InsertShiftCell||(t.InsertShiftCell={}))[E.right=0]="right",E[E.down=1]="down",(E=c=t.ResizeMode||(t.ResizeMode={}))[E.normal=0]="normal",E[E.split=1]="split",(E=f=t.CopyPasteHeaderOptions||(t.CopyPasteHeaderOptions={}))[E.noHeaders=0]="noHeaders",E[E.rowHeaders=1]="rowHeaders",E[E.columnHeaders=2]="columnHeaders",E[E.allHeaders=3]="allHeaders",(E=l=t.CalculationMode||(t.CalculationMode={}))[E.auto=0]="auto",E[E.manual=1]="manual",(E=h=t.CalculationType||(t.CalculationType={}))[E.all=0]="all",E[E.rebuild=1]="rebuild",E[E.minimal=2]="minimal",E[E.regular=3]="regular",(E=d=t.HeaderOptions||(t.HeaderOptions={}))[E.noHeaders=0]="noHeaders",E[E.rowHeaders=1]="rowHeaders",E[E.columnHeaders=2]="columnHeaders",E[E.allHeaders=3]="allHeaders",(E=v=t.ResizeZeroIndicator||(t.ResizeZeroIndicator={}))[E.default=0]="default",E[E.enhanced=1]="enhanced",(E=m=t.InvalidOperationType||(t.InvalidOperationType={}))[E.setFormula=0]="setFormula",E[E.copyPaste=1]="copyPaste",E[E.dragFill=2]="dragFill",E[E.dragDrop=3]="dragDrop",E[E.changePartOfArrayFormula=4]="changePartOfArrayFormula",E[E.changeSheetName=5]="changeSheetName",E[E.table=6]="table",E[E.filter=7]="filter",E[E.hideSheet=8]="hideSheet",E[E.sort=9]="sort",E[E.pivotTable=10]="pivotTable",E[E.ptOverlapValue=11]="ptOverlapValue",E[E.groupProtected=12]="groupProtected",E[E.editProtected=13]="editProtected",E[E.cutProtected=14]="cutProtected",E[E.customName=15]="customName",E[E.dataObjectCellTypeInsertData=16]="dataObjectCellTypeInsertData",E[E.reportSheet=17]="reportSheet",(E=g=t.AutoFitType||(t.AutoFitType={}))[E.cell=0]="cell",E[E.cellWithHeader=1]="cellWithHeader",(E=p=t.ClipboardPasteOptions||(t.ClipboardPasteOptions={}))[E.all=0]="all",E[E.values=1]="values",E[E.formatting=2]="formatting",E[E.formulas=3]="formulas",E[E.valuesAndFormatting=4]="valuesAndFormatting",E[E.formulasAndFormatting=5]="formulasAndFormatting",E[E.comments=6]="comments",E[E.validation=7]="validation",E[E.usingSourceTheme=8]="usingSourceTheme",E[E.noBorder=9]="noBorder",E[E.columnWidths=10]="columnWidths",E[E.formulasAndNumberFormatting=11]="formulasAndNumberFormatting",E[E.valuesAndNumberFormatting=12]="valuesAndNumberFormatting",E[E.valuesAndSourceFormatting=13]="valuesAndSourceFormatting",E[E.allAndColumnWidth=14]="allAndColumnWidth",(E=b=t.CopyToOptions||(t.CopyToOptions={}))[E.value=1]="value",E[E.formula=2]="formula",E[E.comment=4]="comment",E[E.outline=8]="outline",E[E.sparkline=16]="sparkline",E[E.span=32]="span",E[E.style=64]="style",E[E.tag=128]="tag",E[E.bindingPath=256]="bindingPath",E[E.conditionalFormat=512]="conditionalFormat",E[E.hyperlink=1024]="hyperlink",E[E.defaultValue=2048]="defaultValue",E[E.altText=4096]="altText",E[E.all=8191]="all",(E=w=t.PasteOperationOptions||(t.PasteOperationOptions={}))[E.none=0]="none",E[E.add=1]="add",E[E.subtract=2]="subtract",E[E.multiply=3]="multiply",E[E.divide=4]="divide",(E=y=t.LabelAlignment||(t.LabelAlignment={}))[E.topLeft=0]="topLeft",E[E.topCenter=1]="topCenter",E[E.topRight=2]="topRight",E[E.bottomLeft=3]="bottomLeft",E[E.bottomCenter=4]="bottomCenter",E[E.bottomRight=5]="bottomRight",(E=M=t.LabelVisibility||(t.LabelVisibility={}))[E.visible=0]="visible",E[E.hidden=1]="hidden",E[E.auto=2]="auto",(E=C=t.TextDecorationType||(t.TextDecorationType={}))[E.underline=1]="underline",E[E.lineThrough=2]="lineThrough",E[E.overline=4]="overline",E[E.doubleUnderline=8]="doubleUnderline",E[E.none=0]="none",(E=S=t.HorizontalAlign||(t.HorizontalAlign={}))[E.left=0]="left",E[E.center=1]="center",E[E.right=2]="right",E[E.general=3]="general",E[E.centerContinuous=4]="centerContinuous",E[E.distributed=5]="distributed",(E=T=t.VerticalAlign||(t.VerticalAlign={}))[E.top=0]="top",E[E.center=1]="center",E[E.bottom=2]="bottom",(E=A=t.VertAlign||(t.VertAlign={}))[E.normal=0]="normal",E[E.superscript=1]="superscript",E[E.subscript=2]="subscript",(E=I=t.Zi||(t.Zi={}))[E.smallDecrement=0]="smallDecrement",E[E.smallIncrement=1]="smallIncrement",E[E.largeDecrement=2]="largeDecrement",E[E.largeIncrement=3]="largeIncrement",E[E.thumbPosition=4]="thumbPosition",E[E.thumbTrack=5]="thumbTrack",E[E.endScroll=6]="endScroll",(E=x=t.VisualState||(t.VisualState={}))[E.normal=0]="normal",E[E.highlight=1]="highlight",E[E.selected=2]="selected",E[E.active=3]="active",E[E.hover=4]="hover",E[E.activeNotSelected=5]="activeNotSelected",(E=N=t.EditorStatus||(t.EditorStatus={}))[E.ready=0]="ready",E[E.enter=1]="enter",E[E.edit=2]="edit",(E=k=t.ImeMode||(t.ImeMode={}))[E.auto=1]="auto",E[E.active=2]="active",E[E.inactive=4]="inactive",E[E.disabled=0]="disabled",(E=_=t.SelectionPolicy||(t.SelectionPolicy={}))[E.single=0]="single",E[E.range=1]="range",E[E.multiRange=2]="multiRange",(E=D=t.SelectionUnit||(t.SelectionUnit={}))[E.cell=0]="cell",E[E.row=1]="row",E[E.column=2]="column",(E=j=t.StorageType||(t.StorageType={}))[E.data=1]="data",E[E.style=2]="style",E[E.comment=4]="comment",E[E.tag=8]="tag",E[E.sparkline=16]="sparkline",E[E.axis=32]="axis",E[E.bindingPath=64]="bindingPath",E[E.hyperlink=256]="hyperlink",E[E.altText=512]="altText",(E=O=t.HeaderAutoText||(t.HeaderAutoText={}))[E.blank=0]="blank",E[E.numbers=1]="numbers",E[E.letters=2]="letters",(E=L=t.RangeChangedAction||(t.RangeChangedAction={}))[E.dragDrop=0]="dragDrop",E[E.dragFill=1]="dragFill",E[E.clear=2]="clear",E[E.paste=3]="paste",E[E.sort=4]="sort",E[E.setArrayFormula=5]="setArrayFormula",E[E.evaluateFormula=6]="evaluateFormula",(E=B=t.ValueType||(t.ValueType={}))[E.normal=0]="normal",E[E.richText=1]="richText",(E=P=t.ImageLayout||(t.ImageLayout={}))[E.stretch=0]="stretch",E[E.center=1]="center",E[E.zoom=2]="zoom",E[E.none=3]="none",(E=G=t.Yi||(t.Yi={})).ThumbButton="thumbButton",E.TrackButton="trackButton",E.LeftButton="leftButton",E.RightButton="rightButton",E.UpButton="upButton",E.DownButton="downButton",(E=U=t.HorizontalPosition||(t.HorizontalPosition={}))[E.left=0]="left",E[E.center=1]="center",E[E.right=2]="right",E[E.nearest=3]="nearest",(E=H=t.VerticalPosition||(t.VerticalPosition={}))[E.top=0]="top",E[E.center=1]="center",E[E.bottom=2]="bottom",E[E.nearest=3]="nearest",(E=V=t.SheetArea||(t.SheetArea={}))[E.corner=0]="corner",E[E.colHeader=1]="colHeader",E[E.rowHeader=2]="rowHeader",E[E.viewport=3]="viewport",(E=z=t.SortState||(t.SortState={}))[E.none=0]="none",E[E.ascending=1]="ascending",E[E.descending=2]="descending",(E=Y=t.CellStatesType||(t.CellStatesType={}))[E.hover=1]="hover",E[E.invalid=2]="invalid",E[E.readonly=4]="readonly",E[E.edit=8]="edit",E[E.active=16]="active",E[E.selected=32]="selected",E[E.dirty=64]="dirty",E[E.invalidFormula=128]="invalidFormula",(E=Z=t.RowColumnStates||(t.RowColumnStates={}))[E.hover=1]="hover",E[E.invalid=2]="invalid",E[E.edit=8]="edit",E[E.active=16]="active",E[E.selected=32]="selected",E[E.dirty=64]="dirty",E[E.inserted=128]="inserted",E[E.invalidFormula=512]="invalidFormula",(E=W=t.ButtonVisibility||(t.ButtonVisibility={}))[E.always=0]="always",E[E.onSelected=1]="onSelected",E[E.onEditing=2]="onEditing",(R=E=t.ButtonImageType||(t.ButtonImageType={}))[R.none=0]="none",R[R.custom=1]="custom",R[R.clear=2]="clear",R[R.cancel=3]="cancel",R[R.ok=4]="ok",R[R.dropdown=5]="dropdown",R[R.ellipsis=6]="ellipsis",R[R.left=7]="left",R[R.right=8]="right",R[R.plus=9]="plus",R[R.minus=10]="minus",R[R.undo=11]="undo",R[R.redo=12]="redo",R[R.search=13]="search",R[R.separator=14]="separator",R[R.spinLeft=15]="spinLeft",R[R.spinRight=16]="spinRight",R[R.collapse=17]="collapse",R[R.expand=18]="expand",E.calcel=E.cancel,(R=Q=t.DropDownType||(t.DropDownType={}))[R.colorPicker=0]="colorPicker",R[R.dateTimePicker=1]="dateTimePicker",R[R.timePicker=2]="timePicker",R[R.monthPicker=3]="monthPicker",R[R.list=4]="list",R[R.slider=5]="slider",R[R.calculator=6]="calculator",R[R.workflowList=7]="workflowList",R[R.multiColumn=8]="multiColumn",(E=J=t.ButtonPosition||(t.ButtonPosition={}))[E.left=0]="left",E[E.right=1]="right",E[E.leftOfText=2]="leftOfText",E[E.rightOfText=3]="rightOfText",(R=K=t.IconPosition||(t.IconPosition={}))[R.left=0]="left",R[R.right=1]="right",R[R.leftOfText=2]="leftOfText",R[R.rightOfText=3]="rightOfText",R[R.outsideLeft=4]="outsideLeft",R[R.outsideRight=5]="outsideRight",(E=X=t.CaptionAlignment||(t.CaptionAlignment={}))[E.left=0]="left",E[E.right=1]="right",(R=q=t.LayoutDirection||(t.LayoutDirection={}))[R.horizontal=0]="horizontal",R[R.vertical=1]="vertical",(E=$=t.LayoutDisplayAs||(t.LayoutDisplayAs={}))[E.inline=0]="inline",E[E.popup=1]="popup",E[E.tree=2]="tree",(R=tt=t.CalendarPage||(t.CalendarPage={}))[R.year=1]="year",R[R.month=2]="month",R[R.day=3]="day",(E=nt=t.CalendarStartDay||(t.CalendarStartDay={}))[E.monday=1]="monday",E[E.tuesday=2]="tuesday",E[E.wednesday=3]="wednesday",E[E.thursday=4]="thursday",E[E.friday=5]="friday",E[E.saturday=6]="saturday",E[E.sunday=7]="sunday",(R=et=t.GroupSort||(t.GroupSort={}))[R.none=0]="none",R[R.group=1]="group",R[R.child=2]="child",R[R.full=3]="full",(E=it=t.DropdownListValue||(t.DropdownListValue={}))[E.string=0]="string",E[E.array=1]="array",(R=rt=t.DropDownDirection||(t.DropDownDirection={}))[R.Down=0]="Down",R[R.Up=1]="Up",R[R.Left=2]="Left",R[R.Right=3]="Right",(E=ot=t.DropDownAlignment||(t.DropDownAlignment={}))[E.Near=0]="Near",E[E.Center=1]="Center",E[E.Far=2]="Far",(R=at=t.PatternType||(t.PatternType={}))[R.solid=1]="solid",R[R.darkGray=2]="darkGray",R[R.mediumGray=3]="mediumGray",R[R.lightGray=4]="lightGray",R[R.gray125=5]="gray125",R[R.gray0625=6]="gray0625",R[R.darkHorizontal=7]="darkHorizontal",R[R.darkVertical=8]="darkVertical",R[R.darkDown=9]="darkDown",R[R.darkUp=10]="darkUp",R[R.darkGrid=11]="darkGrid",R[R.darkTrellis=12]="darkTrellis",R[R.lightHorizontal=13]="lightHorizontal",R[R.lightVertical=14]="lightVertical",R[R.lightDown=15]="lightDown",R[R.lightUp=16]="lightUp",R[R.lightGrid=17]="lightGrid",R[R.lightTrellis=18]="lightTrellis",(E=ut=t.NumbersFitMode||(t.NumbersFitMode={}))[E.mask=0]="mask",E[E.overflow=1]="overflow",(R=st=t.TabStripPosition||(t.TabStripPosition={}))[R.bottom=0]="bottom",R[R.top=1]="top",R[R.left=2]="left",R[R.right=3]="right",(E=ct=t.HyperlinkTargetType||(t.HyperlinkTargetType={}))[E.blank=0]="blank",E[E.self=1]="self",E[E.parent=2]="parent",E[E.top=3]="top",(R=ft=t.SheetType||(t.SheetType={}))[R.tableSheet=0]="tableSheet",R[R.ganttSheet=1]="ganttSheet",R[R.customSheetTab=2]="customSheetTab",R[R.reportSheet=3]="reportSheet",R[R.printSheet=9007199254740991]="printSheet",(E=lt=t.SheetTabVisible||(t.SheetTabVisible={}))[E.hidden=0]="hidden",E[E.visible=1]="visible",E[E.veryHidden=2]="veryHidden",(R=ht=t.AllSheetsListVisibility||(t.AllSheetsListVisibility={}))[R.hide=0]="hide",R[R.show=1]="show",R[R.auto=2]="auto",(E=dt=t.ColumnHeaderFitMode||(t.ColumnHeaderFitMode={}))[E.normal=0]="normal",E[E.vertical=1]="vertical",E[E.stack=2]="stack",(R=vt=t.UsedRangeType||(t.UsedRangeType={}))[R.all=262143]="all",R[R.axis=1]="axis",R[R.style=2]="style",R[R.rowStyle=4]="rowStyle",R[R.colStyle=8]="colStyle",R[R.data=16]="data",R[R.formula=32]="formula",R[R.span=64]="span",R[R.shape=128]="shape",R[R.table=256]="table",R[R.sparkLine=512]="sparkLine",R[R.comment=1024]="comment",R[R.slicer=2048]="slicer",R[R.pivottable=4096]="pivottable",R[R.filter=8192]="filter",R[R.dataValidation=16384]="dataValidation",R[R.conditionFormat=32768]="conditionFormat",R[R.chart=65536]="chart",R[R.picture=131072]="picture",(E=mt=t.SortBy||(t.SortBy={})).cellColor="cellColor",E.fontColor="fontColor",E.icon="icon",E.value="value",(R=gt=t.TableStyleElement||(t.TableStyleElement={})).wholeTable="wholeTable",R.firstColumnStripe="firstColumnStripe",R.secondColumnStripe="secondColumnStripe",R.firstRowStripe="firstRowStripe",R.secondRowStripe="secondRowStripe",R.lastColumn="lastColumn",R.firstColumn="firstColumn",R.headerRow="headerRow",R.totalRow="totalRow",R.firstHeaderCell="firstHeaderCell",R.lastHeaderCell="lastHeaderCell",R.firstTotalCell="firstTotalCell",R.lastTotalCell="lastTotalCell",(E=pt=t.FileType||(t.FileType={}))[E.excel=0]="excel",E[E.ssjson=1]="ssjson",E[E.csv=2]="csv",(R=bt=t.OpenSaveFileType||(t.OpenSaveFileType={}))[R.excel=0]="excel",R[R.sjs=1]="sjs",(E=wt=t.OpenMode||(t.OpenMode={}))[E.normal=0]="normal",E[E.lazy=1]="lazy",E[E.incremental=2]="incremental",(R=yt=t.ClipboardActionType||(t.ClipboardActionType={}))[R.copy=1]="copy",R[R.cut=2]="cut",R[R.reset=3]="reset",(E=Mt=t.DefaultChangeValueType||(t.DefaultChangeValueType={})).Expression="expr",E.Value="value",(R=Ct=t.SheetTabState||(t.SheetTabState={}))[R.hover=1]="hover",R[R.selected=2]="selected",R[R.active=4]="active",R[R.protected=8]="protected",R[R.normal=16]="normal"},"./dist/core/core.interface.js":function(t,n){"use strict";var e,n;Object.defineProperty(n,"__esModule",{value:!0}),n.CornerPosition=void 0,(n=e=n.CornerPosition||(n.CornerPosition={}))[n.leftTop=1]="leftTop",n[n.rightTop=2]="rightTop",n[n.leftBottom=4]="leftBottom",n[n.rightBottom=8]="rightBottom"},"./dist/core/core.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/core/core.res.en.js");n.SR={en:e}},"./dist/core/core.res.en.js":function(t,n,e){"use strict";var i,r;for(r in Object.defineProperty(n,"__esModule",{value:!0}),n.ARIA_HasValue=n.ARIA_Cell=n.ARIA_Scrollbar_TRACK_Button=n.ARIA_Scrollbar_Bottom_Button=n.ARIA_Scrollbar_Right_Button=n.ARIA_Scrollbar_Thumb_Button=n.ARIA_Scrollbar_Top_Button=n.ARIA_Scrollbar_Left_Button=n.ARIA_Blank=n.ARIA_NewSheet=n.ARIA_SheetTab=n.ARIA_NextButton=n.ARIA_PreviousButton=n.ARIA_Last=n.ARIA_NextArrow=n.ARIA_PreviousArrow=n.ARIA_First=n.ARIA_Resize=n.NeedCanvasSupport=n.Exp_OverlappingSpans=n.Exp_SheetIsNull=n.Exp_DestSheetIsNull=n.Exp_ArrayFormulaSpan=n.Exp_SheetNameConflict=n.Exp_SheetNameInvalid=n.Exp_EmptyNamedStyle=n.NewTab=n.Tip_Width=n.Tip_Height=n.Tip_Column_Offset=n.Tip_Column=n.Tip_Row=n.Exp_PasteChangeMergeCell=n.Exp_PasteDestinationCellsLocked=n.Exp_InvalidCopyPasteSize=n.Exp_PasteSourceCellsLocked=n.Exp_ArgumentOutOfRange=n.Exp_NotAFunction=n.Exp_InvalidRange=n.Exp_IndexOutOfRange=n.Exp_InvalidCustomName=n.Exp_InvalidCustomFunction=n.Exp_DestIsNull=n.Exp_SrcIsNull=n.Exp_InvalidAndSpace=n.Exp_ChangePartOfArray=n.Exp_MultipleSelections=n.Exp_InvalidPastedArea=n.Exp_PasteExtentIsNull=n.Exp_NotSupported=void 0,n.cancel=n.ok=n.pasteSpecialOptionDialog=n.STEP=n.EXP_UNSUPPORT_CRYPTO_ALGORITHM=n.GENERAL=n.NORMAL=n.EXP_INVALID_PASSWORD=n.EXP_NO_PASSWORD=n.EXP_FILE_FORMAT=n.EXP_IO=n.Exp_InvalidOperationInProtect=n.Exp_InvalidSortPartTableOrMultiTableInRange=n.Exp_InvalidSortSpanInRange=n.Exp_InvalidSortArrayFormulaInRange=n.Exp_InsertCopiedCutCellsAffectTable=n.Exp_InsertCopiedCutCellsOverlap=n.Exp_InsertCopiedCutCellsNoRange=n.Exp_InsertCopiedCutCellsOnSpanTable=n.Exp_InsertCopiedCutCells=n.REPORT_SUMMARY=n.SHEET_NAME=n.ARIA_ColumnHeader=n.ARIA_RowHeader=n.ARIA_HasComment=n.ARIA_HasHyperlink=n.ARIA_HasButton=n.ARIA_HasCheckbox=n.ARIA_HasFormula=void 0,n.Exp_NotSupported="Not supported exception",n.Exp_PasteExtentIsNull="pasteExtent is null",n.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",n.Exp_MultipleSelections="This action won't work on multiple selections.",n.Exp_ChangePartOfArray="Cannot change part of an array.",n.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",n.Exp_SrcIsNull="The argument 'src' is null",n.Exp_DestIsNull="The argument 'dest' is null",n.Exp_InvalidCustomFunction="invalid custom function",n.Exp_InvalidCustomName="invalid custom name",n.Exp_IndexOutOfRange="Index is out of range!",n.Exp_InvalidRange="Invalid range",n.Exp_NotAFunction="Not A Function",n.Exp_ArgumentOutOfRange="ArgumentOutOfRange",n.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",n.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",n.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",n.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",n.Tip_Row="Row: ",n.Tip_Column="Column: ",n.Tip_Column_Offset="Offset: ",n.Tip_Height="Height: {0} pixels",n.Tip_Width="Width: {0} pixels",n.NewTab="New...",n.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",n.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",n.Exp_SheetNameConflict="That name is already taken. Try a different one.",n.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",n.Exp_DestSheetIsNull="destSheet is null",n.Exp_SheetIsNull="sheet is null.",n.Exp_OverlappingSpans="This operation will cause overlapping spans.",n.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",n.ARIA_Resize="resize",n.ARIA_First="first",n.ARIA_PreviousArrow="previous arrow",n.ARIA_NextArrow="next arrow",n.ARIA_Last="last",n.ARIA_PreviousButton="previous button",n.ARIA_NextButton="next button",n.ARIA_SheetTab="sheet tab",n.ARIA_NewSheet="new sheet",n.ARIA_Blank="blank",n.ARIA_Scrollbar_Left_Button="scrollbar left button",n.ARIA_Scrollbar_Top_Button="scrollbar top button",n.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",n.ARIA_Scrollbar_Right_Button="scrollbar right button",n.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",n.ARIA_Scrollbar_TRACK_Button="scrollbar track button",n.ARIA_Cell="cell",n.ARIA_HasValue="has value {0}",n.ARIA_HasFormula="has formula {0}",n.ARIA_HasCheckbox="has checkbox {0}",n.ARIA_HasButton="has button {0}",n.ARIA_HasHyperlink="has hyperlink {0}",n.ARIA_HasComment="has comment {0}",n.ARIA_RowHeader="row header",n.ARIA_ColumnHeader="column header",n.SHEET_NAME="Sheet",n.REPORT_SUMMARY="Sum",i=e("./dist/core/lc/lr.en.js"))i.hasOwnProperty(r)&&(n[r]=i[r]);n.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",n.Exp_InsertCopiedCutCellsOnSpanTable="This won\u2019t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",n.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",n.Exp_InsertCopiedCutCellsOverlap="This selection isn't valid. Make sure the copy and paste areas don't overlap unless they are the same size and shape.",n.Exp_InsertCopiedCutCellsAffectTable="You can't rearrange cells within a table this way, because it might affect other table cells in an unexpected way.",n.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",n.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",n.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist.",n.Exp_InvalidOperationInProtect="The cell or chart you're trying to change is on a protected sheet. To make a change, unprotect the sheet.",n.EXP_IO="File read and write exception.",n.EXP_FILE_FORMAT="Incorrect file format.",n.EXP_NO_PASSWORD="The Excel file cannot be opened because the workbook/worksheet is password protected.",n.EXP_INVALID_PASSWORD="The specified password is incorrect.",n.NORMAL="Normal",n.GENERAL="General",n.EXP_UNSUPPORT_CRYPTO_ALGORITHM="Unsupported cryptographic algorithms",n.STEP={start:"start load {0}",loadFileData:"load {0}'s data to spread",loadSheetData:"load {0}'s data",startCalc:"start reCalc",loadSheetFormula:"load {0}'s formula",parseFile:"parse {0} content"},n.pasteSpecialOptionDialog={title:"Paste Special",paste:"Paste",pasteOptions:{all:"All",formulas:"Formulas",values:"Values",formats:"Formats",comments:"Comments",validation:"Validation",usingSourceTheme:"All using Source theme",noBorders:"All except borders",columnWidth:"Column widths",formulasAndNumberFormats:"Formulas and number formats",valueAndNumberFormats:"Value and number formats"},operation:"Operation",operationOptions:{none:"None",add:"Add",subtract:"Subtract",multiply:"Multiply",divide:"Divide"},skipBlanks:"Skip blanks",transpose:"Transpose",pasteLink:"Paste Link"},n.ok="OK",n.cancel="Cancel"},"./dist/core/excel-io-util/common.js":function(t,n,e){"use strict";var i,r,u,v,m,s,c,f,l,o,a,h,d,g,e,p,b,w,y,M,C;function S(){}function T(){}function A(){}function I(t,n){var n,n,e,n=n.toUpperCase(),n=p[n];return n?(e=g,(e=n.reg?n.prefix:g)+t):t}function x(n,t,e){var i,r,e,t,i,r=function(t){return n.getColumnWidth(t)},e=N(e,function(t){return n.getRowHeight(t)},n.getRowCount(),n.defaults.rowHeight),t=N(t,r,n.getColumnCount(),n.defaults.colWidth);return{rowIndex:e.index,rowOffset:e.offset,colIndex:t.index,colOffset:t.offset}}function N(t,n,e,i){for(var r,o,a,u,s,c,r=-1,o=-1,a=0,u=0;u<e;u++)if(t<(a+=s=n(u))){r=u,o=t-(a-s);break}return-1===r&&a<t&&(r=e+(c=i?Math.floor((t-a)/i):0),o=t-(a+c*i)),{index:r,offset:o}}function k(t,n){for(var e=n;e<t.length;e++)if("'"===t[e]||'"'===t[e])return e;return e}function _(t,n){var e,i,r;if(t&&"string"==typeof t){for(e=[],i=0;i<t.length&&(r=k(t,i),e.push(n(t.substring(i,r))),r<t.length);i++){if(-1===(i=t.indexOf(t[r],r+1))){e.push(t.substring(r));break}e.push(t.substring(r,i+1))}return e.join("")}return t}function D(){}function j(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedNumberFormatHelper=n.excelSupportProtectionOptions=n.protectionOptionsMap=n.SJSStylePropsToStyleProps=n.Util=n.NodeHelper=n.IndexHelper=n.StringEx=n.STEP_RATE=void 0,i=e("Common"),r=e("./dist/core/core.enum.js"),u=e("./dist/core/util/domUtil.js"),v=e("./dist/core/util/common.js"),m=e("./dist/core/excel-io-util/excel-types.js"),s=e("./dist/core/excel-io-util/excel-helper.js"),c=/_x00[0-1][0-9A-Fa-f]_/,f=i.Common.lt.ht,l=null,o=m.XFileConstants.Wi,a=m.XFileConstants.Qi,h=m.XFileConstants.Ki,d=/([A-Z][A-Z.]+)\(/gi,g="_xlfn.",p={AVERAGEIF:/\bAVERAGEIF\b\(/gi,AVERAGEIFS:/\bAVERAGEIFS\b\(/gi,CUBEKPIMEMBER:/\bCUBEKPIMEMBER\b\(/gi,CUBEMEMBER:/\bCUBEMEMBER\b\(/gi,CUBEMEMBERPROPERTY:/\bCUBEMEMBERPROPERTY\b\(/gi,CUBERANKEDMEMBER:/\bCUBERANKEDMEMBER\b\(/gi,CUBESET:/\bCUBESET\b\(/gi,CUBESETCOUNT:/\bCUBESETCOUNT\b\(/gi,CUBEVALUE:/\bCUBEVALUE\b\(/gi,COUNTIFS:/\bCOUNTIFS\b\(/gi,IFERROR:/\bIFERROR\b\(/gi,SUMIFS:/\bSUMIFS\b\(/gi,ACOT:/\bACOT\b\(/gi,ACOTH:/\bACOTH\b\(/gi,AGGREGATE:/\bAGGREGATE\b\(/gi,ARABIC:/\bARABIC\b\(/gi,BASE:/\bBASE\b\(/gi,"BETA.DIST":/\bBETA\.DIST\b\(/gi,"BETA.INV":/\bBETA\.INV\b\(/gi,"BINOM.DIST":/\bBINOM\.DIST\b\(/gi,"BINOM.DIST.RANGE":/\bBINOM\.DIST\.RANGE\b\(/gi,"BINOM.INV":/\bBINOM\.INV\b\(/gi,BITAND:/\bBITAND\b\(/gi,BITLSHIFT:/\bBITLSHIFT\b\(/gi,BITOR:/\bBITOR\b\(/gi,BITRSHIFT:/\bBITRSHIFT\b\(/gi,BITXOR:/\bBITXOR\b\(/gi,"CEILING.MATH":/\bCEILING\.MATH\b\(/gi,"CEILING.PRECISE":/\bCEILING\.PRECISE\b\(/gi,"CHISQ.DIST":/\bCHISQ\.DIST\b\(/gi,"CHISQ.DIST.RT":/\bCHISQ\.DIST\.RT\b\(/gi,"CHISQ.INV":/\bCHISQ\.INV\b\(/gi,"CHISQ.INV.RT":/\bCHISQ\.INV\.RT\b\(/gi,"CHISQ.TEST":/\bCHISQ\.TEST\b\(/gi,COMBINA:/\bCOMBINA\b\(/gi,CONCAT:/\bCONCAT\b\(/gi,"CONFIDENCE.T":/\bCONFIDENCE\.T\b\(/gi,"CONFIDENCE.NORM":/\bCONFIDENCE\.NORM\b\(/gi,COT:/\bCOT\b\(/gi,"COVARIANCE.P":/\bCOVARIANCE\.P\b\(/gi,"COVARIANCE.S":/\bCOVARIANCE\.S\b\(/gi,CSC:/\bCSC\b\(/gi,CSCH:/\bCSCH\b\(/gi,DAYS:/\bDAYS\b\(/gi,DECIMAL:/\bDECIMAL\b\(/gi,ENCODEURL:/\bENCODEURL\b\(/gi,"ERF.PRECISE":/\bERF\.PRECISE\b\(/gi,"ERFC.PRECISE":/\bERFC\.PRECISE\b\(/gi,"EXPON.DIST":/\bEXPON\.DIST\b\(/gi,"F.DIST":/\bF\.DIST\b\(/gi,"F.DIST.RT":/\bF\.DIST\.RT\b\(/gi,"F.INV":/\bF\.INV\b\(/gi,"F.INV.RT":/\bF\.INV\.RT\b\(/gi,FILTERXML:/\bFILTERXML\b\(/gi,"FLOOR.MATH":/\bFLOOR\.MATH\b\(/gi,"FLOOR.PRECISE":/\bFLOOR\.PRECISE\b\(/gi,FORMULATEXT:/\bFORMULATEXT\b\(/gi,GAMMA:/\bGAMMA\b\(/gi,"GAMMA.DIST":/\bGAMMA\.DIST\b\(/gi,"GAMMA.INV":/\bGAMMA\.INV\b\(/gi,"GAMMALN.PRECISE":/\bGAMMALN\.PRECISE\b\(/gi,"HYPGEOM.DIST":/\bHYPGEOM\.DIST\b\(/gi,IFNA:/\bIFNA\b\(/gi,IFS:/\bIFS\b\(/gi,IMCOSH:/\bIMCOSH\b\(/gi,IMCOT:/\bIMCOT\b\(/gi,IMCSCH:/\bIMCSCH\b\(/gi,IMSEC:/\bIMSEC\b\(/gi,IMSECH:/\bIMSECH\b\(/gi,IMSINH:/\bIMSINH\b\(/gi,IMTAN:/\bIMTAN\b\(/gi,ISFORMULA:/\bISFORMULA\b\(/gi,ISOWEEKNUM:/\bISOWEEKNUM\b\(/gi,"LOGNORM.DIST":/\bLOGNORM\.DIST\b\(/gi,"LOGNORM.INV":/\bLOGNORM\.INV\b\(/gi,MAXIFS:/\bMAXIFS\b\(/gi,MINIFS:/\bMINIFS\b\(/gi,"MODE.MULT":/\bMODE\.MULT\b\(/gi,"MODE.SNGL":/\bMODE\.SNGL\b\(/gi,MUNIT:/\bMUNIT\b\(/gi,"NEGBINOM.DIST":/\bNEGBINOM\.DIST\b\(/gi,"NORM.DIST":/\bNORM\.DIST\b\(/gi,"NORM.INV":/\bNORM\.INV\b\(/gi,"NORM.S.DIST":/\bNORM\.S\.DIST\b\(/gi,"NORM.S.INV":/\bNORM\.S\.INV\b\(/gi,NUMBERVALUE:/\bNUMBERVALUE\b\(/gi,PDURATION:/\bPDURATION\b\(/gi,"PERCENTILE.EXC":/\bPERCENTILE\.EXC\b\(/gi,"PERCENTILE.INC":/\bPERCENTILE\.INC\b\(/gi,"PERCENTRANK.EXC":/\bPERCENTRANK\.EXC\b\(/gi,"PERCENTRANK.INC":/\bPERCENTRANK\.INC\b\(/gi,PERMUTATIONA:/\bPERMUTATIONA\b\(/gi,PHI:/\bPHI\b\(/gi,"POISSON.DIST":/\bPOISSON\.DIST\b\(/gi,"QUARTILE.EXC":/\bQUARTILE\.EXC\b\(/gi,"QUARTILE.INC":/\bQUARTILE\.INC\b\(/gi,"RANK.AVG":/\bRANK\.AVG\b\(/gi,"RANK.EQ":/\bRANK\.EQ\b\(/gi,RRI:/\bRRI\b\(/gi,SECH:/\bSECH\b\(/gi,SHEET:/\bSHEET\b\(/gi,SHEETS:/\bSHEETS\b\(/gi,"STDEV.P":/\bSTDEV\.P\b\(/gi,"STDEV.S":/\bSTDEV\.S\b\(/gi,SWITCH:/\bSWITCH\b\(/gi,"T.DIST":/\bT\.DIST\b\(/gi,"T.DIST.2T":/\bT\.DIST\.2T\b\(/gi,"T.DIST.RT":/\bT\.DIST\.RT\b\(/gi,"T.INV":/\bT\.INV\b\(/gi,"T.INV.2T":/\bT\.INV\.2T\b\(/gi,TEXTJOIN:/\bTEXTJOIN\b\(/gi,UNICHAR:/\bUNICHAR\b\(/gi,UNICODE:/\bUNICODE\b\(/gi,"VAR.P":/\bVAR\.P\b\(/gi,"VAR.S":/\bVAR\.S\b\(/gi,WEBSERVICE:/\bWEBSERVICE\b\(/gi,"WEIBULL.DIST":/\bWEIBULL\.DIST\b\(/gi,XOR:/\bXOR\b\(/gi,"Z.TEST":/\bZ\.TEST\b\(/gi,XMATCH:/\bXLOOKUP\b\(/gi,XLOOKUP:/\bXLOOKUP\b\(/gi,RANDARRAY:/RANDARRAY\(/gi,SEQUENCE:/SEQUENCE\(/gi,IMAGE:/IMAGE\(/gi,SORTBY:/SORTBY\(/gi,UNIQUE:/UNIQUE\(/gi,ANCHORARRAY:/ANCHORARRAY\(/gi,SINGLE:/SINGLE\(/gi,LET:/\bLET\b\(/gi,LAMBDA:/\bLAMBDA\b\(/gi,MAP:/\bMAP\b\(/gi,REDUCE:/\bREDUCE\b\(/gi,SCAN:/\bSCAN\b\(/gi,MAKEARRAY:/\bMAKEARRAY\b\(/gi,BYCOL:/\bBYCOL\b\(/gi,BYROW:/\bBYROW\b\(/gi,ISOMITTED:/\bISOMITTED\b\(/gi,FILTER:{reg:/FILTER\(/gi,prefix:e="_xlfn._xlws."},SORT:{reg:/SORT\(/gi,prefix:e},TEXTBEFORE:/\bTEXTBEFORE\b\(/gi,TEXTAFTER:/\bTEXTAFTER\b\(/gi,TEXTSPLIT:/\bTEXTSPLIT\b\(/gi,VSTACK:/\bVSTACK\b\(/gi,HSTACK:/\bHSTACK\b\(/gi,TOROW:/\bTOROW\b\(/gi,TOCOL:/\bTOCOL\b\(/gi,WRAPROWS:/\bWRAPROWS\b\(/gi,WRAPCOLS:/\bWRAPCOLS\b\(/gi,TAKE:/\bTAKE\b\(/gi,DROP:/\bDROP\b\(/gi,EXPAND:/\bEXPAND\b\(/gi,CHOOSEROWS:/\bCHOOSEROWS\b\(/gi,CHOOSECOLS:/\bCHOOSECOLS\b\(/gi},n.STEP_RATE={start:0,loadFileData:.1,loadSheetData:.4,loadSheetDataWithCalc:.3,startCalc:.2,loadSheetFormula:.4,loadSheetFormulaWithCalc:.3,parseFile:.1,end:1},S.Ji=function(t){return!t||""===t},S.Xi=function(t){return!t||" "===t},b=S,n.StringEx=b,T.qi=function(t){if(b.Ji(t))return 0;for(var n=0,e=0;e<t.length&&isNaN(parseInt(t[e],10));)e++;return(n=e<t.length?parseInt(t.substring(e),10):n)-1},T.$i=function(t){for(var n,e,i,r,o,a,n=0,e=t.length,i=0;i<e&&!(25<(a=(o=(r=t[i]).charCodeAt())-97))&&!((a=a<0?o-65:a)<0);i++)n=26*n+a+1;return--n},T.nr=function(t){var n,e,i,r,o,a;if(t<0)return"";if(!(n=T.er[t])){for(e=t,r=(i="").length,t+=1;0<t;t=Math.floor((t-1)/26))o=i.substring(0,r),a=i.substring(r),i=o+String.fromCharCode(65+(t-1)%26)+a;n=i.toString(),T.er[e]=n}return n},T.er=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],w=T,n.IndexHelper=w,A.ar=function(t,n){if(!f(t)){var t=parseFloat(t);if(!isNaN(t))return t}return n},A.ur=function(t,n){return"1"===t||"true"===t||"0"!==t&&"false"!==t&&n},A.sr=function(t,n){if(!isNaN(t)){var t=parseInt(t,10);if(!isNaN(t))return t}return n},A.cr=function(t){return t=Array.isArray(t)?t:t?[t]:[]},A.lr=function(t,n){var e,i,r;if(t){for(e=n.split("."),i=t;e.length;){if(r=e.shift(),f(i[r]))return;i=i[r]}return i}},A.dr=function(t,n){return f(t)?n:t?"1":"0"},n.NodeHelper=A,D.vr=function(t){return t.split("/").pop().slice(0,-4)},D.mr=function(t){return _(t,function(t){return 0<=t.toLowerCase().indexOf("_xl")?t.replace(/_xlfn\.|_xlws\.|_xll\./gi,""):t})},D.gr=function(t,n,e){return t.split(n).join(e)},D.pr=function(t,n){var e,i,r,o,a,u;if(f(t)||""===t)return t;for(t.match(c)!==l&&(t=t.replace(e=/(_x00[0-1][0-9A-Fa-f]_)/g,function(t){return"_x005F"+t})),i=["_x0000_","_x0001_","_x0002_","_x0003_","_x0004_","_x0005_","_x0006_","_x0007_","_x0008_","_x0009_","_x000A_","_x000B_","_x000C_","_x000D_","_x000E_","_x000F_","_x0010_","_x0011_","_x0012_","_x0013_","_x0014_","_x0015_","_x0016_","_x0017_","_x0018_","_x0019_","_x001A_","_x001B_","_x001C_","_x001D_","_x001E_","_x001F_"],r=[],o=0;o<t.length;o++)a=t.charCodeAt(o),u=t[o],r.push(31<a||(10===a||13===a)&&n?u:i[a]);return r.join("")},D.addXLFNPrefix=function(t){return _(t,function(t){return t.replace(d,I)})},D.wr=function(t){return t.c_||(t.c_=[]),t.c_.length+1},D.Mr=function(t){return t+"."+m.XFileConstants.Cr},D.Sr=function(t,n){for(var e,i,r,e=0,i=t;e<i.length;e++)if((r=i[e]).Id===n)return r},D.Tr=function(t,n,e){var t,n,t,t=t&&D.Sr(t.c_,n);if(t)return n=D.vr(t.Target),(t=e.drawings)&&t[n]},D.Ir=function(t,n){var e=v.util.xr(t,o);if(e)return D.Tr(t.rels,e[h],n)},D.Nr=function(t){t.rels||(t.rels={n_:m.XFileConstants.Dr,xmlns:m.RelationshipConstants._r,c_:[]})},D.Er=function(t,n){var e,n,e,n,e=v.util.xr(n,o),n=e&&D.Sr(n.rels.c_,e[h]),e=n&&D.vr(n.Target);if(e)return t.drawings||(t.drawings={}),(n=t.drawings)[e]||(n[e]={n_:"wsDr",r_:[5,4],c_:[],rels:{n_:m.XFileConstants.Dr,xmlns:m.RelationshipConstants._r,c_:[]}}),n[e]},D.jr=function(t,n){var e,i,i,n,e=t.rels;v.util.xr(t,o)||(n.drawing++,i=D.wr(e),i=m.XFileConstants.Rr+i,n=m.XFileConstants.Wi+n.drawing,e.c_.push({n_:m.XFileConstants.Lr,Id:i,Type:m.RelationshipConstants.Fr,Target:"../drawings/"+n+"."+m.XFileConstants.Cr}),t.c_||(t.c_=[]),t.c_.push({n_:o,"r:id":i}),v.util.Pr(t,m.WorkSheetNodeOrder))},D.Gr=function(t,n,e){return D.Tr(t,n,e)},D.Ur=function(t,n,e){var e,n,e,n,i,e=v.util.xr(n,e||a),n=e&&D.Sr(n.rels.c_,e[h]),e=n&&D.vr(n.Target);if(e)return t.drawings||(t.drawings={}),(n=t.drawings)[e]||(n[e]={n_:"xml",r_:[10,11,12],c_:[i={n_:"shapelayout","v:ext":"edit",c_:[{n_:"idmap","v:ext":"edit",data:"1"}]}]}),n[e]},D.Hr=function(t,n,e){var i,n,r,r,n,i=t.rels;v.util.xr(t,e=e||a)||(n.vmlDrawing++,n=n.vmlDrawing,r=D.wr(i),r=m.XFileConstants.Rr+r,n=m.XFileConstants.zr+n,i.c_.push({n_:m.XFileConstants.Lr,Id:r,Type:m.RelationshipConstants.Vr,Target:"../drawings/"+n+"."+m.XFileConstants.Yr}),t.c_||(t.c_=[]),t.c_.push({n_:e,"r:id":r}))},D.Zr=function(t,n,e){var n,t,i,n,n,n=D.Sr(n.c_,t),t=n&&n.Target;if(t)return-1!==(n=(t=-1!==(n=t.lastIndexOf("/"))?t.substring(n+1):t).lastIndexOf("."))&&(i=t.substring(n+1)),{blob:n=(n=e.media[t])&&i?D.Wr(n,i):n,type:i}},D.Wr=function(t,n){var n=n;return"data:image/".concat(n="svg"===n?"svg+xml":n,";base64,").concat(t)},D.Qr=function(t){var n,e,i,n=t.indexOf(";base64,");if(-1!==n)return e=t.substring(n+8),{type:i=t.substring(11,n),base64Content:e}},D.Kr=function(t,n,e){var i,t,r,o,a,u,t,i=D.Qr(t);if(i){for(e.media||(e.media={}),"svg+xml"===(t=i.type)?t="svg":"x-icon"===t&&(t="png"),r="",o=Object.keys(e.media),a=0;a<o.length;a++)u=o[a],e.media[u]===i.base64Content&&(r=u);return r||(r=m.XFileConstants.Jr+Object.keys(e.media).length+"."+t,e.media[r]=i.base64Content),f(n)?r:(t=m.XFileConstants.Rr+D.wr(n),n.c_.push({n_:m.XFileConstants.Lr,Id:t,Type:m.RelationshipConstants.Xr,Target:"../media/"+r}),t)}},D.qr=function(t,n){var t=1024*(t+1)+1;return n&&(t+=n.c_.filter(function(t){return t.n_===m.XFileConstants.$r}).length),t},D.StringToByteArray=function(t){var n,e,i,n=[];if(t&&!(t instanceof Array))for(e=t.length,i=0;i<e;i+=2)n[i/2]=parseInt(t.substr(i,2),16);return n},D.no=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,function(t){var n=16*Math.random()|0,e;return("x"===t?n:3&n|8).toString(16)})},D.eo=function(t,n){var e,i,r,e=t.split("/"),i=n.split("/");for(e.pop();0<i.length;)if(".."===(r=i[0]))i.shift(),e.pop();else{if("."!==r)break;i.shift()}return e.concat(i).join("/")},D.io=function(t){var n;return f(t)||t.match(c)===l?t:t.replace(/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,function(t,n,e){var i=0;return e&&(i=parseInt(e,16)),n?"_x00"+e+"_":String.fromCharCode(i)}).replace(/(\r)+\n/g,"\r\n")},D.ro=function(){var t,n,e,i;try{n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},e="object"===("undefined"==typeof global?"undefined":n(global))&&global&&global.Object===Object&&global,i="object"===("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,t=e||i||Function("return this")()}catch(t){}return t},D.oo=function(){var t=D.ro();return t&&t.gcCultureInfo},D.ao=function(){var t=D.ro();return t&&t.gcCultureObj},D.uo=function(t){var n,e,e,n=!0,e=D.ro(),e=e&&e.GC&&e.GC.Spread&&e.GC.Spread.Formatter&&e.GC.Spread.Formatter.GeneralFormatter;if(t&&"="!==t[0]&&!f(e))try{new e(t)}catch(t){n=!1}return n},D.so=function(t,o){var a;return u.GC$.each(t,function(t,n){var e,i,r,e=n.rels&&n.rels.c_;if(e&&e.length)for(i=0;i<e.length;i++)if((r=D.vr(e[i].Target))===o)return a=t,!1}),a},D.co=function(t,n){var e,i,r,o,a,u,s,c;if(n&&n.rels&&n.c_&&n.c_.length){for(e=n.rels.c_,i={},r=0;r<e.length;r++)(o=e[r]).Type===m.RelationshipConstants.fo&&(i[o.Id]=D.vr(o.Target));for(r=0;r<n.c_.length;r++)if("sheets"===(a=n.c_[r]).n_)for(u=a.c_,s=0;s<u.length;s++)if(i[(c=u[s])[m.XFileConstants.Ki]]===t)return c.name}},D.ho=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d;for(n=v.util.vo(n),i=t.workbook,o=-1,u=0,s=r=v.util.xr(i,m.XFileConstants.mo).c_;u<s.length;u++)if(n===(c=s[u]).name){o=c[m.XFileConstants.Ki];break}if(-1!==o){for(l=0,h=f=v.util.go(i.rels,m.XFileConstants.Lr);l<h.length;l++)if(o===(d=h[l]).Id){a=D.vr(d.Target);break}a&&(e=t.sheets[a])}return e},D.po=function(t,n){var t=D.ho(t,n);return t&&v.util.xr(t,m.XFileConstants.bo)},D.yo=function(t,n,e,i,r){var o,a;f(i)||t&&((a=(a=(o=(o=t[n])||(t[n]={}))[e])||(o[e]={})).v=r.getTextIndex(i))},D.wo=function(t,n){return t&&t.openMode&r.OpenMode.lazy&&!f(n)},D.Mo=function(t){return t&&t.openMode&r.OpenMode.incremental},D.Co=function(t){return t&&t.fileType===r.OpenSaveFileType.excel},D.So=function(t,n,e,i){var r,o,a,u,r=t.getRowCount(),o=t.getColumnCount(),u=i&&i.dataEffectByInflate&&i.dataEffectByInflate[t.name()];r<n&&(a=new v.Range(r,-1,n-r,-1),t.setRowCount(n),u)&&Object.keys(u).forEach(function(t){u[t](a)}),o<e&&(a=new v.Range(-1,o,-1,e-o),t.setColumnCount(e),u)&&Object.keys(u).forEach(function(t){u[t](a)})},D.ume=function(a,t){var t=t.sheetColumnInfos,n=a.name(),t=t&&t[n],n=a.Ut,u=a.getColumnCount(),s=n.Q_(!1,3);t&&t.forEach(function(t){for(var n,e,i,r,o,n=t.columnSize,e=t.hidden,i=t.colStyle,r=Math.min(t.maxCol,u),o=t.minCol;o<=r;o++)D.cme(a,s,o-1,n,e,i)})},D.cme=function(t,n,e,i,r,o){i!==l&&n.setSize(e,i),r&&t.setColumnVisible(e,!1),o!==l&&t.setStyle(-1,e,o)},D.To=function(t,n,e,i){var r,o,a,u,n,a,o,u,n;void 0===e&&(e=2),o=n.from,a=n.to,u=n.pos,n=n.ext,a?D.Ege(t,a,e,i):n&&(o||u)&&(a={x:0,y:0},o?(D.Ege(t,o,e,i),a=D.Gce(t,o)):(a.x=s.ExcelHelper.emuToPixles(parseInt(u.x,10)),a.y=s.ExcelHelper.emuToPixles(parseInt(u.y,10))),a.x+=s.ExcelHelper.emuToPixles(parseInt(n.cx,10)),a.y+=s.ExcelHelper.emuToPixles(parseInt(n.cy,10)),u=(o=x(t,a.x,a.y)).rowIndex,n=o.colIndex,D.So(t,u+e,n+e,i))},D.Ege=function(t,n,e,i){var n=D.Uce(n),r=n.row,n=n.col;D.So(t,r+e,n+e,i)},D.Ao=function(e,t,i,r){t&&t.forEach(function(t){var n,t,n=t.row+(0<t.rowCount?t.rowCount:1),t=t.col+(0<t.colCount?t.colCount:1);i&&(n>=m.XmlConstants.Io||t>=m.XmlConstants.xo)||D.So(e,n,t,r)})},D.Uce=function(t){var n,e,i,r;function o(t,n){var t=parseInt(t.v_||0,10);return n?s.ExcelHelper.emuToPixles(t):t}return{row:n=o(t.row),col:e=o(t.col),rowOff:i=o(t.rowOff,!0),colOff:r=o(t.colOff,!0)}},D.Gce=function(t,n){var n,e,i,n=D.Uce(n),e,i;return{x:v.util.w0(t,0,n.col,!1)+n.colOff,y:v.util.w0(t,0,n.row,!0)+n.rowOff}},D.No=function(t){return t=Math.min(t,m.XmlConstants.xo-1),w.nr(t)},D.ko=function(t){return!t||f(t.fileType)||t.fileType===r.OpenSaveFileType.sjs},D.encodeNameFormula=function(t){if(t)return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},D.Oge=function(t,n){var n,e,i,r,o,a,t,n={n_:"definedName",c_:[D.addXLFNPrefix(D.encodeNameFormula(n))]},e=t.name,i=t.localSheetId,r=t.e,o=t.comment,a=t.isReadOnly,t=t.hidden;return f(e)||(n.name=v.util.vo(e)),f(i)||(n.localSheetId=i),f(r)||(n.e=r),f(o)||(n.comment=v.util.vo(o)),f(a)||(n.isReadOnly=a),f(t)||(n.hidden=t),n},M=D,n.Util=M,n.SJSStylePropsToStyleProps={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow",wholeTableStyle:"wholeTable",headerRowStyle:"headerRow",footerRowStyle:"totalRow",highlightFirstColumnStyle:"firstColumn",highlightLastColumnStyle:"lastColumn",firstRowStripStyle:"firstRowStripe",secondRowStripStyle:"secondRowStripe",firstColumnStripStyle:"firstColumnStripe",secondColumnStripStyle:"secondColumnStripe",firstHeaderCellStyle:"firstHeaderCell",lastHeaderCellStyle:"lastHeaderCell",firstFooterCellStyle:"firstTotalCell",lastFooterCellStyle:"lastTotalCell",reportFilterLabelsStyle:"pageFieldLabels",reportFilterValuesStyle:"pageFieldValues",firstRowStripeStyle:"firstRowStripe",secondRowStripeStyle:"secondRowStripe",firstColumnStripeStyle:"firstColumnStripe",secondColumnStripeStyle:"secondColumnStripe",subtotalColumn1Style:"firstSubtotalColumn",subtotalColumn2Style:"secondSubtotalColumn",subtotalColumn3Style:"thirdSubtotalColumn",subtotalRow1Style:"firstSubtotalRow",subtotalRow2Style:"secondSubtotalRow",subtotalRow3Style:"thirdSubtotalRow",columnSubheading1Style:"firstColumnSubheading",columnSubheading2Style:"secondColumnSubheading",columnSubheading3Style:"thirdColumnSubheading",rowSubheading1Style:"firstRowSubheading",rowSubheading2Style:"secondRowSubheading",rowSubheading3Style:"thirdRowSubheading",blankRowStyle:"blankRow",grandTotalColumnStyle:"lastColumn",grandTotalRowStyle:"totalRow",firstHeaderCellStyleL:"firstHeaderCell",firstColumnStyle:"firstColumn"},n.protectionOptionsMap={allowSelectLockedCells:"selectLockedCells",allowSelectUnlockedCells:"selectUnlockedCells",allowFilter:"autoFilter",allowSort:"sort",allowInsertColumns:"insertColumns",allowInsertRows:"insertRows",allowDeleteColumns:"deleteColumns",allowDeleteRows:"deleteRows",allowEditObjects:"objects"},n.excelSupportProtectionOptions={formatCells:!0,formatColumns:!0,formatRows:!0,insertColumns:!0,insertRows:!0,insertHyperlinks:!0,deleteColumns:!0,deleteRows:!0,sort:!0,autoFilter:!0,pivotTables:!0},j.builtInNumberFormat=function(){return 0===(j.Md=j.Md?j.Md:{count:0}).count&&j.initBuiltNumberFormat(),j.Md},j.languageIndepedentNumberFormat=function(){return 0===(j.Ch=j.Ch?j.Ch:{count:0}).count&&j.initLanguageIndepedentNumberFormat(),j.Ch},j.formatCodeTable=function(){return j.Sh=j.Sh?j.Sh:[]},j.customNumberFormat=function(){return j.Th=j.Th?j.Th:{count:0}},j.getCultureInfo=function(){var t,n,t=M.ro(),n;return t&&t.GC&&t.GC.Spread&&t.GC.Spread.Common&&M.ro().GC.Spread.Common.CultureManager.getCultureInfo()||M.ao()},j.initBuiltNumberFormat=function(){var t,n,n,e,i,r,o,a,t=j.Md;if(t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yyyy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yyyy h:mm",t[37]="#,##0_);(#,##0)",t[38]="#,##0_);[Red](#,##0)",t[39]="#,##0.00_);(#,##0.00)",t[40]="#,##0.00_);[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mm:ss.0",t[48]="##0.0E+0",t[49]="@",t.count=49,M.oo())if("zh-cn"===(n=M.oo()))t[14]="yyyy/m/d",t[17]="mmm-yy",t[22]="yyyy/m/d h:mm",t[27]='yyyy"\u5e74"m"\u6708"',t[28]='m"\u6708"d"\u65e5"',t[29]='m"\u6708"d"\u65e5"',t[30]="m-d-yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u65f6"mm"\u5206"',t[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',t[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[36]='yyyy"\u5e74"m"\u6708"',t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]='yyyy"\u5e74"m"\u6708"',t[51]='m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='m"\u6708"d"\u65e5"',t[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[57]='yyyy"\u5e74"m"\u6708"',t[58]='m"\u6708"d"\u65e5"',t.count=58;else if("ja-jp"===n)t[14]="yyyy/m/d",t[15]="dd-mmm-yy",t[16]="dd-mmm",t[17]="mmm-yy",t[22]="yyyy/mm/dd h:mm",t[27]="[$-411]ge.m.d",t[28]='[$-411]ggge"\u5e74"m"\u6708"d"',t[29]='[$-411]ggge"\u5e74"m"\u6708"d"',t[30]="m/d/yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u6642"mm"\u5206"',t[33]='h"\u6642"mm"\u5206"ss"\u79d2"',t[34]='yyyy"\u5e74"m"\u6708"',t[35]='m"\u6708"d"\u65e5"',t[36]="[$-411]ge.m.d",t[38]="#,##0;[Red]-#,##0",t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]="[$-411]ge.m.d",t[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[55]='yyyy"\u5e74"m"\u6708"',t[56]='m"\u6708"d"\u65e5"',t[57]="[$-411]ge.m.d",t[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t.count=58;else if(e=(n=j.getCultureInfo())&&n.LocalNumberFormat,!f(e)&&!Array.isArray(e)&&"object"==typeof e){for(i in e)isNaN(Number(i))||(r=e[i],M.uo(r)&&(t[i]=e[i]));for(i in o=0,t)isNaN(Number(i))||o<(a=Number(i))&&(o=a);t.count=o}},j.initLanguageIndepedentNumberFormat=function(){var t=j.Ch;t[27]="m/d/yyyy",t[28]="m/d/yyyy",t[29]="m/d/yyyy",t[30]="m/d/yyyy",t[31]="m/d/yyyy",t[32]="h:mm:ss",t[33]="h:mm:ss",t[34]="m/d/yyyy",t[35]="m/d/yyyy",t[36]="m/d/yyyy",t[50]="m/d/yyyy",t[51]="m/d/yyyy",t[52]="m/d/yyyy",t[53]="m/d/yyyy",t[54]="m/d/yyyy",t[55]="m/d/yyyy",t[56]="m/d/yyyy",t[57]="m/d/yyyy",t[58]="m/d/yyyy"},j.getFormatCode=function(t){var n,e,i,r,t,o,t,n=j.builtInNumberFormat(),e=j.customNumberFormat(),i=j.languageIndepedentNumberFormat(),r=t.numberFormatIndex;return t.numberFormat?(o=(t=t.numberFormat).numberFormatId,t=t.numberFormatCode,n[o]&&n[o]!==t?n[o]=t:(e[t]||(e[t]=o,e.count++),t)):n[r]||i[r]||"General"},j.getFormatId=function(t){var n,e,i,r,o,a,u,s,n=j.Ah();if(n[t])return n[t];if(i=j.builtInNumberFormat())for(r in i)if(i[r]===t)return e={isBuiltIn:!0,id:parseInt(r,10)},n[t]=e;if((o=j.customNumberFormat())&&o[t])return e={isBuiltIn:!1,id:o[t]},n[t]=e;if((a=0)<o.count){for(s in u=0,o)o[s]>u&&(u=o[s]);a=u}return j.Ih++,a=Math.max(j.Ih,a)+1,e={isBuiltIn:!1,id:o[t]=a}},j.Ah=function(){return j.xh=j.xh?j.xh:{}},j.resetBuiltInNumberFormat=function(){j.Md={count:0},j.Ch={count:0}},j.Sh=null,j.xh=null,j.Md={count:0},j.Ch={count:0},j.Th={count:0},j.Ih=170,n.ExtendedNumberFormatHelper=j},"./dist/core/excel-io-util/excel-helper.js":function(t,n){"use strict";function e(t,n){var n=Math.pow(10,n);return Math.round(t*n)/n}var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ExcelHelper=void 0,r.pointToPixel=function(t){return e(96*t/72,2)},r.pixelToPoint=function(t){return 72*t/96},r.emuToPixles=function(t,n){return e(96*t/914400,n||2)},r.pixelToEMU=function(t){return Math.round(914400*t/96)},r.getActualColumnWidth=function(t,n,e){for(var i,r,i=0,r=n;r<e;r++)t.getColumnVisible(r)&&(i+=t.Do(r,3));return i},r.getActualRowHeight=function(t,n,e){for(var i,r,i=0,r=n;r<e;r++)t.getRowVisible(r)&&(i+=t._o(r,3));return i},r.getImageContent=function(t,n){var e,i,i,e="png",i=t.lastIndexOf(".");return"svg"===(e=-1!==i?t.substr(i+1):e)&&(e="svg+xml"),(i=n(t,!0))?"data:image/"+e+";base64,"+i:null},n.ExcelHelper=r},"./dist/core/excel-io-util/excel-style.js":function(t,n){"use strict";var e,n;Object.defineProperty(n,"__esModule",{value:!0}),n.ExcelBorderStyle=void 0,(n=e=n.ExcelBorderStyle||(n.ExcelBorderStyle={}))[n.none=0]="none",n[n.thin=1]="thin",n[n.medium=2]="medium",n[n.dashed=3]="dashed",n[n.dotted=4]="dotted",n[n.thick=5]="thick",n[n.double=6]="double",n[n.hair=7]="hair",n[n.mediumDashed=8]="mediumDashed",n[n.dashDot=9]="dashDot",n[n.mediumDashDot=10]="mediumDashDot",n[n.dashDotDot=11]="dashDotDot",n[n.mediumDashDotDot=12]="mediumDashDotDot",n[n.slantDashDot=13]="slantDashDot"},"./dist/core/excel-io-util/excel-types.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WorkSheetNodeOrder=n.WorkbookNodeOrder=n.RelationshipConstants=n.XFileConstants=n.XmlConstants=void 0,n.XmlConstants={xo:16384,Io:1048576},n.XFileConstants={Eo:"_rels",jo:"/xl",Oo:"[Content_Types].xml",Rr:"rId",Ki:"r:id",Dr:"Relationships",Lr:"Relationship",Qi:"legacyDrawing",Ro:"legacyDrawingHF",Bo:"AlternateContent",Lo:"Choice",Fo:"controls",Po:"control",$r:"shape",Go:"bin",Uo:"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings",Ho:"rels",zo:"application/vnd.openxmlformats-package.relationships+xml",Vo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",Yo:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",Zo:"application/vnd.openxmlformats-officedocument.theme+xml",Wo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",Qo:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",Ko:"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml",Jo:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",Xo:"application/vnd.openxmlformats-officedocument.drawing+xml",qo:"application/vnd.openxmlformats-officedocument.drawingml.chart+xml",$o:"application/vnd.ms-office.chartex+xml",ta:"application/vnd.ms-office.chartstyle+xml",na:"application/vnd.ms-office.chartcolorstyle+xml",ia:"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml",ra:"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml",oa:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",aa:"application/vnd.ms-office.drawingml.diagramDrawing+xml",ua:"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml",sa:"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml",ca:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",fa:"application/vnd.ms-excel.threadedcomments+xml",la:"application/vnd.ms-excel.person+xml",ha:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml",da:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml",va:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml",ma:"application/vnd.ms-excel.slicer+xml",ga:"application/vnd.ms-excel.slicerCache+xml",pa:"application/vnd.ms-excel.timeline+xml",ba:"application/vnd.ms-excel.timelineCache+xml",ya:"application/vnd.ms-office.vbaProject",wa:"application/vnd.openxmlformats-officedocument.vmlDrawing",Ma:"application/vnd.ms-excel.controlproperties+xml",SrV:"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml",zge:"application/vnd.ms-excel.rdrichvaluetypes+xml",Yge:"application/vnd.ms-excel.rdrichvaluestructure+xml",Zge:"application/vnd.ms-excel.rdrichvalue+xml",Wge:"application/vnd.ms-excel.rdrichvaluewebimage+xml",gee:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Cr:"xml",Yr:"vml",Ca:"application/xml",Sa:"jpg",Ta:"image/jpg",Aa:"tiff",Ia:"image/tiff",xa:"jpeg",Na:"image/jpeg",ka:"svg",Da:"image/svg+xml",_a:"png",Ea:"image/png",ja:"bmp",Oa:"image/bmp",Ra:"gif",Ba:"image/gif",La:"emf",Fa:"image/x-emf",Pa:"wmf",Ga:"image/x-wmf",Ua:"drawings",zr:"vmlDrawing",Ha:"/xl/charts",za:"/xl/drawings",Va:"/xl/persons",Ya:"/xl/media",Za:"/xl/threadedComments",Wa:"/xl/worksheets",Qa:"/xl/tables",Ka:"/xl/slicers",Ja:"/xl/slicerCaches",Xa:"/xl/timelines",qa:"/xl/timelineCaches",$a:"/xl/ctrlProps",tu:"externalLink",nu:"/xl/externalLinks",eu:"/xl/pivotCache",iu:"/xl/pivotTables",Qge:"/xl/richData",Kge:"rdRichValueTypes.xml",Jge:"rdRichValueWebImage.xml",Xge:"rdrichvalue.xml",qge:"rdrichvaluestructure.xml",mo:"sheets",ru:"sheet",ou:"comments",au:"chart",uu:"chartEx",su:"style",cu:"person",fu:"colors",Wi:"drawing",lu:"ctrlProp",hu:"threadedComment",Jr:"image",du:"table",vu:"slicer",mu:"slicerCache",gu:"timeline",pu:"timelineCache",bu:"pivotCacheDefinition",yu:"pivotCache",wu:"pivotCacheRecords",Mu:"pivotTable",Cu:"External",Su:"sheetPr",Tu:"dimension",Au:"extLst",Iu:"mergeCells",xu:"mergeCell",Nu:"hyperlinks",ku:"hyperlink",Du:"sheetViews",_u:"sheetFormatPr",Eu:"cols",bo:"sheetData",fQt:"sortState",ju:"conditionalFormatting",Ou:"dataValidations",Ru:"dataValidation",Bu:"tableParts",Lu:"/xl/sharedStrings.xml",Fu:"/xl/theme/theme1.xml",Pu:"/xl/worksheets",Gu:"/xl/workbook.xml",Uu:"/docProps/core.xml",Hu:"/docProps/app.xml",zu:"/docProps/custom.xml",Vu:"/xl/styles.xml",Yu:"/xl/theme/theme1.xml",Zu:"metadata.xml",$ge:"calcChain.xml",Wu:"/xl/_rels/workbook.xml.rels",Qu:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",Ju:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",Xu:"http://schemas.openxmlformats.org/drawingml/2006/main",qu:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",$u:"x14ac",ts:"x14ac xr xr2 xr3",ns:"xr",os:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",as:"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2",us:"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",fs:"http://schemas.openxmlformats.org/package/2006/content-types",_r:"http://schemas.openxmlformats.org/package/2006/relationships",ls:"http://schemas.openxmlformats.org/drawingml/2006/main",hs:"http://schemas.microsoft.com/office/drawing/2010/main",vs:"http://schemas.microsoft.com/office/drawing/2016/SVG/main",ms:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ps:"http://schemas.microsoft.com/office/excel/2006/main",bs:"http://schemas.openxmlformats.org/markup-compatibility/2006",ys:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ws:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ms:"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",Cs:"http://schemas.microsoft.com/office/spreadsheetml/2018/calcfeatures",Ss:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Ts:"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray",As:"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata",Is:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",xs:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",ks:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ds:"http://purl.org/dc/elements/1.1/",_s:"http://purl.org/dc/terms/",Es:"http://purl.org/dc/dcmitype/",js:"http://www.w3.org/2001/XMLSchema-instance",Os:"application/vnd.openxmlformats-package.core-properties+xml",Ls:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Fs:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Ps:"application/vnd.openxmlformats-officedocument.extended-properties+xml",Gs:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Us:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Hs:"application/vnd.openxmlformats-officedocument.custom-properties+xml"},n.RelationshipConstants={zs:"rId",_r:"http://schemas.openxmlformats.org/package/2006/relationships",Vs:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Ys:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Zs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",Ws:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",Ks:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Js:"http://purl.oclc.org/ooxml/officeDocument/relationships/styles",fo:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Xs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings",$s:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",tc:"http://purl.oclc.org/ooxml/officeDocument/relationships/theme",ec:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition",ic:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords",oc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable",uc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",fc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",lc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",hc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",Vr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",dc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ctrlProp",vc:"http://purl.oclc.org/ooxml/officeDocument/relationships/extendedProperties",Fr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",gc:"http://purl.oclc.org/ooxml/officeDocument/relationships/drawing",pc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Xr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",bc:"http://purl.oclc.org/ooxml/officeDocument/relationships/image",yc:"http://schemas.microsoft.com/office/2007/relationships/slicer",wc:"http://schemas.microsoft.com/office/2007/relationships/slicerCache",Mc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Cc:"http://schemas.microsoft.com/office/2014/relationships/chartEx",Sc:"http://purl.oclc.org/ooxml/officeDocument/relationships/chart",Tc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes",Ac:"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",Ic:"http://schemas.microsoft.com/office/2011/relationships/chartStyle",xc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",zge:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValueTypes",Yge:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValueStructure",n2e:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValue",Wge:"http://schemas.microsoft.com/office/2020/07/relationships/rdRichValueWebImage",SrV:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",Nc:"http://schemas.microsoft.com/office/2011/relationships/timeline",kc:"http://schemas.microsoft.com/office/2011/relationships/timelineCache"},n.WorkbookNodeOrder=["bookViews",n.XFileConstants.mo,"externalReferences","definedNames","calcPr","pivotCaches","extLst"],n.WorkSheetNodeOrder=[n.XFileConstants.Su,n.XFileConstants.Tu,n.XFileConstants.Du,n.XFileConstants._u,n.XFileConstants.Eu,n.XFileConstants.bo,"sheetProtection","autoFilter",n.XFileConstants.fQt,n.XFileConstants.Iu,n.XFileConstants.ju,n.XFileConstants.Ou,n.XFileConstants.Nu,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing",n.XFileConstants.Qi,n.XFileConstants.Ro,n.XFileConstants.Po,n.XFileConstants.Bo,n.XFileConstants.Bu,n.XFileConstants.Au]},"./dist/core/excel-io-util/range-parser.js":function(t,n,e){"use strict";var i,r,c,u,f,l,o,a;function h(t){return-1===t.col||-1===t.colCount}function d(t){return-1===t.row||-1===t.rowCount}function s(){}Object.defineProperty(n,"__esModule",{value:!0}),n.range_parser=void 0,i=e("Common"),r=e("./dist/core/excel-io-util/excel-types.js"),c=e("./dist/core/excel-io-util/common.js"),u=e("./dist/core/util/common.js"),f=r.XmlConstants.Io,l=r.XmlConstants.xo,o=i.Common.lt.ht,s.Dc=function(t,n){var e,i,e=[];return o(t)||(i=t.replace(/('.+')/g,"").split(" ")).forEach(function(t){var t=s._c(t,n);!t||t.row>f||t.col>l||t.rowCount>f||t.col>l||e.push(t)}),e},s._c=function(t,n){var e,i,i,r,o,i,a,a,t,e=(0,u.Ec)(0,0,0,0),i=t.indexOf("!");if(1===(i=(i=(t=-1<i?t.substr(i+1):t).split("$").join("")).split(":")).length){if(a=i[0],r=c.IndexHelper.qi(a),o=c.IndexHelper.$i(a),-1===r&&-1===o)return null;e.row=r,e.col=o,e.rowCount=1,e.colCount=1}else 2===i.length&&(a=i[0],t=i[1],r=c.IndexHelper.qi(a),o=c.IndexHelper.$i(a),i=c.IndexHelper.qi(t),a=c.IndexHelper.$i(t),e.row=r,e.col=o,e.rowCount=i-r+1,e.colCount=a-o+1,n||0!==r||e.rowCount!==f||(e.row=-1,e.rowCount=-1),n||0!==o||e.colCount!==l||(e.col=-1,e.colCount=-1));return e},s.jc=function(t,n){var n,e,i,r,t,o;if(t)return n=n?"$":"",e=t.row,i=t.col,r=t.rowCount,t=t.colCount,o=c.IndexHelper.nr(i),1===r&&1===t?n+o+n+(e+1):-1===e||-1===r?n+o+n+"1:"+n+c.IndexHelper.nr(i+t-1)+n+f:-1===i||-1===t?n+"A"+n+(e+1)+":"+n+c.IndexHelper.nr(l)+n+(e+r):0===r&&0===t?n+o+n+(e+1):n+o+n+(e+1)+":"+n+c.IndexHelper.nr(i+t-1)+n+(e+r)},s.Oc=function(t,n){var e,i,r,o;if(t){for(e=[],i=0,r=t;i<r.length;i++)o=r[i],e.push(s.jc(o,n));return e.join(" ")}},s.getRangeString=function(t){for(var n,e,i,r,o,a,u,s,u,n=[],e=0,i=t;e<i.length;e++)h(r=i[e])&&(r.col=0,r.colCount=l),d(r)&&(r.row=0,r.rowCount=f),o=r.row,a=r.row+r.rowCount-1,u=r.col,s=r.col+r.colCount-1,u=c.IndexHelper.nr(u)+(o+1),(1<r.rowCount||1<r.colCount)&&(u+=":"+c.IndexHelper.nr(s)+(1+a)),n.push(u);return n.join(" ")},n.range_parser=s},"./dist/core/lc/common.js":function(F,t,n){"use strict";var e,i,o,r,l,r,p,r,u,a,n,r,s,c,v,m,g,b,w,y,M,C,S,T,A,I,x,N,f,h,k;function L(){return k}function _(t,n){for(var e,i,r,o,a,u,i="",a=0,e=0;e<t.length;e++)a=Math.max(a,t[e].length);for(e=0;e<a;e++){for(n&&(r=""),u=0;u<t.length;u++)n?e>=t[u].length?r+="00":r+=t[u].charAt(e)+t[u].charAt(e+1):e<t[u].length&&(i+=t[u].charAt(e));n&&(o=parseInt(r,16),i+=String.fromCharCode(o),e++)}return i}function d(n,e,i){var t,r,o,a,t=_(["Lcnee","iesKy"]),r=k[t],o="QKAU";return u(r,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B1"},function(t){(a=D(t,o)).hl=!!r,a.m=r?a.m:-1,e.call(n,a),P(a,n,r,i)},function(){(a=D()).hl=!!r,a.m=r?a.m:-1,e.call(n,a),P(a,n,r,i)}),a}function D(u,s){var t,c,f,l,h,d,n,t={isVd:function(t){var n=this;return t=1===k.Workbook.lm||t,n.s&&!n.e&&(!n.adr||!!n.adr.dsr==!!t)}},d=Z(),n=function(){var t,n,e,i,r,o,a;if(!u)return!1;if(!(t=u[C])||!t.length)return!1;for(i=0,r=t.length;i<r;i++)if(e=(n=t[i])&&n[T]===s){c=n[S];break}if(!e)return!1;if(u[N]&&(h=u[N]),u[x]){if(o=new Date,a=B(u[x]),l=Math.ceil((a-o)/864e5),f=l<=0)return!1}else l=void 0;return!!(d||!u[A]&&!u[I]||z(u[A],u[I])||Y(u[A],u[I]))};return t[g]=d,t.s=n(),t[v]=u?u[M]?-1:1:0,t[m]=c,(t[w]=f)||(t[b]=l),t[y]=h,t}function B(t){return new Date(j(t.substr(0,4))||0,j(t.substr(4,2))-1||0,j(t.substr(6,2))||0)}function j(t){return parseInt(t,10)}function P(t,n,e,i){var r,r,o,a,u,s,c,f,l,h,d,v;if(O(t)){if(t&&t.adr&&!0!==t.adr.dsr&&(r=t.adr.flg||[],o=t.m,a=t.d,k.Workbook.et(n,"adlc",{flg:r,checkRs:r={},m:o,d:a,fn:G}),void 0!==r.nwm)){if(t.wm=r.wm,t.nwm=r.nwm,r.dis){for(u=t.disL||[],s=0,c=r.dis;s<c.length;s++)f=c[s],u.push(_(["",f],!0));t.disL=u}if(r.state)for(l=0,h=r.state;l<h.length;l++)t[(d=h[l])[0]]=d[1]}e||(r={},o=t.m,a=t.d,(v=1)!==k.Workbook.lm&&k.Workbook.et(n,"adlc",{flg:[],checkRs:r,m:o,d:a,nl:1}),void 0!==r.nwm&&(t.wm=r.wm,t.nwm=r.nwm)),i||n.repaint&&!n.xT&&n.repaint()}else $(n,t)}function G(n,t,e){var i=["rs"];n&&t.forEach(function(t){var t=_(["",t],!0);n[t]&&n[t][e+i]&&n[t][e+i]()})}function U(t,n){var t,e,i,r,o;if(t&&0===t.indexOf("//")&&!((t=t.slice(2).split("/")).length<1))for(e=t[0],i=0,r=n.length;i<r;i++)if((o=n[i])===e)return 1}function H(t,n){for(var e,i,r,o,o,e=0,i=n.length;e<i;e++){if(o=!1,(r=(o=(r=n[e])&&0===r.lastIndexOf("*.",0)?!0:o)?r.slice(2):r)===t)return 1;if(o&&0<(o=t.indexOf("."+r))&&o===t.length-r.length-1)return 1}}function V(t,n){var e,i,r,o;if(t&&4===t.split(".").length)for(e=0,i=n.length;e<i;e++)if((r=n[e])&&0<(o=r.length-2)&&(r===t||".*"===r.substr(o)&&t.substr(0,o)===r.substr(0,o)&&c.test(t)))return 1}function z(t,n){var e,i,e,i;return!!(K()&&(e=a(f),i=a("1agFGc#UHbw5"),e=s[e]&&s[e][i])&&(e=e.toLowerCase(),i=t.split(","),t)&&U(e,i))}function Y(t,n){var e,i,e,i,e=a(f),i=a("Zdg3Ga#UHbw5"),e=s[e]&&s[e][i];return!e||(e=e.toLowerCase(),i=t.split(","),t&&H(e,i))||!(!t||!V(e,i))}function Z(){var t=a(f);return W(s[t])}function W(t){var n,e,n=a("VdgJHc#wJb59"),e=a("Zdg3Ga#UHbw5");return t&&(Q(t[n])||J(t[n])||X(t[e]))}function Q(t){var n=a("MlSZto#Z");return t&&t===n}function J(t){var n=a("yXbog&w");return t&&t===n}function K(){var t,n,e,t,t=a(f),n=a("VdgJHc#wJb59"),e=a("Udg36Y#oUddV"),t=s[t];return t&&t[n]===e}function X(t){var n,e,i,n=a("4LJITMx8UMcA"),e=a("jOxo"),i=a("JYw3Gb4NOb6x");return t&&(t===n||t===e||t===i)}function O(t){return t&&(t.isVd(!1)||t.b&&!t.hl)}function q(e,t){var i,n,r,n,o,n,a,n,u,s,n=(k=t).Workbook.prototype,r=n.Hc;n.Hc=function(){var n=this;if(d(n,function(t){n.ls=t,i=t,n.ul=function(){d(n,function(t){n.ls=t,i=t})}}),!i||O(i))return r.apply(n,arguments)},n.nslc=function(){this.xU=!0},t.PivotTableManager&&(n=t.PivotTableManager.prototype,o=n._Qt,n._Qt=function(){o.apply(this,arguments),i||this.parent||d(this,function(t){i=t})}),n=t.Worksheet.prototype,a=n.Hc,n.Hc=function(){if(i||this.parent||d(this,function(t){i=t}),!i||O(i))return a.apply(this,arguments)},n=t.g7.prototype,u=n.jy,n.jy=function(t,n){u.apply(this,arguments),i&&(-1===i.m||!i.hl&&i.b||i.m&&i.nwm&&(1===i.m||1===i.m&&void 0===i.d))&&e(this.Mf,t,n,i)},s=n.cet,n.cet=function(t,n){s.apply(this,arguments),i&&(-1===i.m||!i.hl&&i.b)&&e(this.Mf,t,n,i)}}function $(t,n){var e,i;function r(){i.width=(0,o.GC$)(e).width(),i.height=(0,o.GC$)(e).height(),rt(i.getContext("2d"),i.width,i.height,n)}t.yoe||(t.yoe=!0,e=t.Ti,t.sheets=[],t.mp=[],t.dse=[],t.L0(),e&&(i=document.createElement("canvas"),e.appendChild(i),r(),(0,o.GC$)(window).bind("resize",function(){setTimeout(r,100)})))}function E(t){var n;return new e.Common.ResourceManager(i.SR).getResource()[t]}function tt(t){return 1===t.m&&!0===t.s}function nt(t,n,e){e&&!tt(e)&&R(t,n,e,!0)}function R(t,n,e,i){var t,r,o,a,u,s,c,t,f,l,h,d,v,m,v,g,n,r,i,t=E(_([t,"s"])),r=1===k.Workbook.lm?E(_(["ld","se"])):E(_(["lr","su"])),o=it(t,n);for(r=it(r,n),o=(o=o.replace("{0}",e.d)).replace("{1}",r).replace("{1}",r),a=[],s=u=0;s<o.length;s++)"\r"!==o[s]&&"\n"!==o[s]||(a.push(o.substring(u,s)),"\r"===o[s]&&s<o.length-1&&"\n"===o[s+1]&&s++,u=s+1);if(u<o.length&&a.push(o.substring(u,o.length)),!0===i)return a;for(t=[],f=[],l=[],h=0,d=(c=e.wm||[]).length;h<d;h++)m=(v=c[h])[0],v=v[1],g=void 0,""!==(g=m instanceof Array?_(m,!0):_(["",m],!0))&&(0===v?l.push(g):1===v&&f.push(g));return(0<f.length||0<l.length)&&(t.push(""),n=_(p().ls11,!0),0<f.length&&(r=(r=p().ls9)instanceof Array?_(r,!0):_(["",r],!0),t.push(r.replace(/\{0\}/,f.join(n)))),0<l.length)&&(i=(i=p().ls10)instanceof Array?_(i,!0):_(["",i],!0),t.push(i.replace(/\{0\}/,l.join(n)))),1===e.m&&e.nwm?[].concat(t):e.wm&&0<e.wm.length?a.concat(t):a}function et(t){return E(_([t,"sa"]))}function it(t,n){var e,i,r,o,a,e=!0,i="";if(t)if("string"==typeof t)(t=t.trim())&&(r=[t]);else if(Array.isArray(t)){for(o=!0,r=[],a=0;a<t.length;a++)i=t[a].trim(),r.push(i),o&&i&&(o=!1);o&&(r=null)}return r||(e=!1,r=n),_(r,e)}function rt(t,n,e,i){var r,o,a,u,s,c,f,r="16pt calibri";if(!i||!i.isVd(!1))for(a=R(o=i.hl?(!i.adr||!i.adr.dsr)&&i.e?"l5":"l4":"l3",h,i),l(t,r),t.fillStyle="black",t.fillRect(0,0,n,e),t.fillStyle="white",u=20,s=30,c=0;c<a.length;c++)f=a[c],t.fillText(f,20,s),s+=25}Object.defineProperty(t,"__esModule",{value:!0}),t.Moe=t.Toe=t.eG=t.Vi=t.Aoe=t.decode=void 0,e=n("Common"),i=n("./dist/core/core.ns.js"),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/util/common.js"),l=r.mt.bt,r=new e.Common.ResourceManager(i.SR),p=r.getResource.bind(r),r=n("./dist/core/lc/lcValidator.js"),u=r.Aoe,a=r.Ioe,n="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,s=n||r||Function("return this")(),c=/^[0-9.]+$/,v="m",m="n",g="b",b="d",w="e",y="adr",M=a("XRsZ"),C=a("HUkJ"),S=a("T&g"),T=a("Q&w"),A=a("GRz1"),I=a("XSzB"),x=a("XRwh"),N=a("WQs5"),f="JYx3Gb#8Pb5R",h=["Ivldlcneky","nai ies e."],t.decode=_,t.Aoe=d,t.Vi=q,t.eG=$,t.Toe=R,t.Moe=et},"./dist/core/lc/lcRegister.js":function(t,n,e){"use strict";var v,n,m,e,i,r;function o(h){if(r=null,i[0])try{var d=i[0].jS;d&&d.Ti&&v.Aoe(d,function(t){var n,e,i,r,o,a,u,s,c,f,l;if(d.ls=t,(n=d.getActiveSheetOrSheetTab())&&(e=n._gi)!==m.SheetType.customSheetTab&&((o=(r=(i="number"==typeof e)?n.Mf:n).l)&&(t=o),h||o||t.b||-1!==t.m||!t.d||(t.s=!1,v.eG(d,t)),t.nwm))for(u=0,s=a=t.disL||[];u<s.length;u++)(f=r[c=s[u]])&&(l=f.adrs)&&l.apply(f),i&&e===m.SheetType[c]&&(l=n.adrs)&&l.apply(n)},!0)}finally{i=[]}}Object.defineProperty(n,"__esModule",{value:!0}),v=e("./dist/core/lc/releaseLc.js"),n=e("./dist/core/util/domUtil.js"),m=e("./dist/core/core.enum.js"),e=n.GC$.sd,i=[],n.GC$[e]=function(t,n){i.push(t),n?o(n):r=r||setTimeout(o,5e3*Math.random()+3e3)}},"./dist/core/lc/lcValidator.js":function(t){var n=(e=[function(t,_){!function(t){"use strict";var i,h,d,o,v,t,n,m,e,r;function a(t){var n,e;if("number"==typeof t)for(n=new Array(t),e=0;e<t;++e)n[e]=0;else n=t.slice(0);return(n.buffer=n).byteLength=n.length,"object"===(void 0===t?"undefined":i(t))&&t.buffer&&(n.buffer=t.buffer),n}function u(t,n,e,i){1!=t.length&&t.splice(e,1,i(t.splice(n,1,i(t[e]))[0]))}function s(t,n){var n,e,n=1<arguments.length&&void 0!==n?n:1,e=t.charCodeAt(0);return 65<=e&&e<=90?t.toLowerCase():97<=e&&e<=122?t.toUpperCase():48<=e&&e<=57?d(48+(e-48+10+n)%10):t}function c(t){for(var n,e,i,n=t.split(""),e=function t(n){return s(n,-1)},i=n.length-5;0<=i;i--)u(n,i+1,i+3,e),u(n,i,i+2,e);return n.join("")}function f(t){return t.split("").reverse().join("")}function l(t){var n,e,i,r,o,a,u,s,c,f,l,h,t,d,c=[],f="",d=v,h=t,l=h.length%3;if(0<l)for(;l++<3;)f+="=",h+="\0";for(l=0;l<h.length;l+=3)a=(r=(n=h.charCodeAt(l))<<16|(e=h.charCodeAt(l+1))<<8|(i=h.charCodeAt(l+2)))>>12&63,u=r>>6&63,s=63&r,c[l/3]=d.charAt(o=r>>18&63)+d.charAt(a)+d.charAt(u)+d.charAt(s);return t=(t=c.join("")).slice(0,t.length-f.length)+f}function g(t){for(var n,e,i,r,n,o,a,r,u,s,c,f,l,u=[],f=v,c=t,l=0;l<c.length;l+=4)r=f.indexOf(c.charAt(l)),n=f.indexOf(c.charAt(l+1)),o=f.indexOf(c.charAt(l+2)),a=f.indexOf(c.charAt(l+3)),u[l/4]=d(n=(r=r<<18|n<<12|o<<6|a)>>>16&255,e=r>>>8&255,i=255&r),64==a&&(u[l/4]=d(n,e)),64==o&&(u[l/4]=d(n));return s=u.join("")}function p(t){return(h&&window.atob||g)(t)}function b(t){return(h&&window.btoa||l)(t)}function w(t){return decodeURIComponent(Array.prototype.map.call(p(t),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function y(t){return b(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,n){return d(parseInt(n,16))}))}function M(t){var t,n;return t?(t=f(t=c(t)),n=Math.ceil(t.length/2),w(t=(t=(t=t.substr(n)+t.substr(0,n)).replace("#","=")).replace("&","=="))):""}function C(t){for(var n,e,i,r,n=p(t),e=n.length,i=new o(e),r=0;r<e;r++)i[r]=n.charCodeAt(r);return i.buffer}function S(t){for(var n,e,i,r,n=new ArrayBuffer(t.length),e=new o(n),i=0,r=t.length;i<r;i++)e[i]=t.charCodeAt(i);return n}function T(t){return d.apply(null,new o(t))}function A(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function I(t){for(var n,e,i,r,o,a,n=0,e=5381,i=0,r=t.length-1;0<=r;r--)n=(o=t.charCodeAt(r))+(n<<6)+(n<<16)-n,e=o+((e<<5)+e),i=o+((i<<5)-i),i&=i;return(a=(a=n^e^i)<0?~a:a).toString(16).toUpperCase()}function x(t){t&&JSON.parse(t)}function N(t,n){try{n="#"+n;var e=t.indexOf(n);if(-1<e)return{prefix:t.substring(0,e),licData:JSON.parse(M(t.substr(e+n.length)))}}catch(t){}return!1}function k(e){return"oncomplete"in e&&(e.then=function(t,n){e.resolve=t,e.reject=n},e.oncomplete=function(t){e.resolve(e.result)},e.onerror=function(){e.reject()}),e}Object.defineProperty(_,"__esModule",{value:!0}),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h="undefined"!=typeof window,d=String.fromCharCode,o=h&&window.Uint8Array||a,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="object"==(void 0===t?"undefined":i(t))&&t&&t.Object===Object&&t,n="object"==("undefined"==typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,m=t||n,e=_.iDe=M,_.attorn=function t(n,e,i,r){var o,n,a,u,s,n,c,n,f,o=h?window.msCrypto||window.crypto:void 0,n=N(n,e.aC);return n?(a=n.licData,u=n.prefix+"#"+e.aC,s=T(C(y(u+JSON.stringify(a.D)))),n=M("JYx3Gb#8Pb5R"),c=M("VdgJHc#wJb59"),(!m[n]||!m[n][c]||location.protocol.match(/^https/i))&&o&&o.subtle?(n={alg:"PS256",e:"AQAB",kty:"RSA",n:A(e.pK)},n=window.msCrypto?S(JSON.stringify(n)):n,void k(o.subtle.importKey("jwk",n,f={name:"RSA-PSS",saltLength:32,hash:{name:"SHA-256"}},!1,["verify"])).then(function(t){k(o.subtle.verify(f,t,C(a.S),S(s))).then(function(t){return t?i(a.D):r()})},l)):l()):r();function l(){return I(u+JSON.stringify(a.D))===a.H?i(a.D):r()}}}.call(_,function(){return this}())}],i={},r.m=e,r.c=i,r.p="dist",r(0)),e,i;function r(t){var n;return(i[t]||(n=i[t]={exports:{},id:t,loaded:!1},e[t].call(n.exports,n,n.exports,r),n.loaded=!0,n)).exports}t.exports={Aoe:n.attorn,Ioe:n.iDe}},"./dist/core/lc/lr.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ls11=n.ls10=n.ls9=n.ls8=n.ls7=n.ls6=n.ls5=n.ls4=n.ls3=n.ls2=n.ls1=n.lsde=n.lsru=void 0,n.lsru=["","6465706c6f796d656e74"],n.lsde=["","64657369676e6572"],n.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],n.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],n.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],n.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],n.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],n.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],n.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],n.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],n.ls9=["","4164642d6f6e7320456e61626c65643a207b307d"],n.ls10=["","4164642d6f6e73204e6f7420456e61626c65643a207b307d"],n.ls11=["","2c20"]},"./dist/core/lc/releaseLc.js":function(t,n,e){"use strict";var M,e,C,S,T;function i(n,t,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,r=n.Fi(),o=203,a=n.parent,u="11pt calibri",s=i.hl&&i.isVd(!1)&&i.d,c=a&&a.xU,f="";for(s?l="l2":i.e?l="l5":i.hl&&!i.d?l="l6":h=M.Moe(l="l1"),r=r||n.Fi(),d=M.Toe(l,S,i),v=0,h&&d.forEach(function(t){v=T(v,n.Qt(t,u))}),n.l=d[0]?i:void 0,m=0;m<d.length&&(203<r.width||203<r.height)&&!c;m++)f=d[m],g=v||n.Qt(f,u),w=r.width-g-(p=10),y=r.height-10-(b=20)*(d.length-m),!t||e&&!e.intersect(w,y,g,20)||(t.save(),t.fillStyle="rgba(0, 0, 0, 0.5)",C(t,u),e&&(t.rect(e.x,e.y,e.width,e.height),t.clip(),t.beginPath()),t.fillText(f,w,20+y),f&&(n.l=i),t.restore())}function r(t){M.Vi(i,t)}function o(t,n){return M.decode(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.eG=n.Aoe=n._pt=n.n1e=n.Vi=void 0,M=e("./dist/core/lc/common.js"),e=e("./dist/core/util/common.js"),C=e.mt.bt,S=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal"],T=Math.max,n.Vi=r,n.n1e=o,n._pt=1,n.Aoe=M.Aoe,n.eG=M.eG},"./dist/core/util/basedialog.js":function(t,n,e){"use strict";var i,r,e,l,a,u,s,h,c,o,f,d,v,m,r,g,p,e,b;function w(t,n,e){this.Bc="gc-popup",this.Lc="gc-overlay",this.Fc=null;var i=this;i.Ti=t,i.Pc=e,i.Gc={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:n=n||0,backgroundColor:"rgba(0,0,0,0)"},i.Uc={position:"absolute",padding:0,margin:0,height:"auto",zIndex:n+1,outline:"none"},i.Hc()}function y(t,n,e){var o=b.call(this,t,n,e)||this;return o.Mse=!1,o.Cse={mouseOriginalX:0,mouseOriginalY:0,domOriginalX:0,domOriginalY:0,domWidth:0,domHeight:0,parentRect:null,screenWidth:0,screenHeight:0},o.Sse=function(t){var n,e,t,e,i,t,r,i,t,n=o;n.Mse&&n.mouseInScreen(t.pageX-window.scrollX,t.pageY-window.scrollY)&&(e=t.pageX,t=t.pageY,i=e-(e=n.Cse).mouseOriginalX,t=t-e.mouseOriginalY,e.parentRect)&&(r=n.Wc[0],i=Math.max(0,e.domOriginalX+Math.min(i,e.screenWidth-e.domOriginalX-e.domWidth+(n.Pc?0:window.scrollX))),t=Math.max(0,e.domOriginalY+Math.min(t,e.screenHeight-e.domOriginalY-e.domHeight+(n.Pc?0:window.scrollY))),r.style.left="".concat(i,"px"),r.style.top="".concat(t,"px"))},o.Ise=function(){window.removeEventListener("mousemove",o.Sse),o.Mse=!1},o}i=this&&this.__extends||(p=function(t,n){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Ase=n.zc=n.DialogFeatureType=void 0,r=e("./dist/core/util/common.js"),e=e("./dist/core/util/domUtil.js"),l=e.GC$,a=r.util.En,u=r.util.Tt,s=r.util.vi,h=document,c=window,o=c.gcGlobal,f="touchstart",d="MSPointerDown",v="pointerdown",(e=m=n.DialogFeatureType||(n.DialogFeatureType={})).contextMenu="context-menu",e.filter="filter",e.touch="touch",e.fill="fill",e.sheetList="sheet-list",w.prototype.Hc=function(){var t=this;t.Yc(t.Zc)?t.Wc=l("#"+t.Zc):(t.Zc=t.Qc(),t.Kc=t.Lc+"-"+t.Zc,t.Jc=t.Bc+"-"+t.Zc,t.Wc=l(a("div")).addClass(t.Jc+" ui-widget").attr({id:t.Zc,tabIndex:-1}).css(t.Uc))},w.prototype.Qc=function(){for(var t,n,t=0,n="gc-dialog";this.Yc(n+t.toString());)t++;return n+t.toString()},w.prototype.Xc=function(){if(this.Wc)return this.Wc},w.prototype.qc=function(){return this.Ti||h.body},w.prototype.$c=function(t){var n=this,e=n.Wc;n.tf()||n.nf(),o.ef(),n.Yc(n.Zc)||(l(n.qc()).append(e),n.if(),e.css("display","none")),n.jTe&&n.Wc.attr("sjs-dialog",n.jTe),e.show(t)},w.prototype.rf=function(){return"block"===this.Wc.css("display")},w.prototype.close=function(){var t=this;t.af(),t.Yc(t.Zc)&&t.Wc.remove(),l("."+t.Jc).isVisible()||t.uf(),o.cf()},w.prototype.uf=function(){l("."+this.Kc).remove(),this.Fc=null},w.prototype.af=function(){var n=this.Zc;[f,d,v].forEach(function(t){l(h).unbind(t+"."+n)})},w.prototype.if=function(){var t,n,n,e,i,r,o,a,u,s,c,s,f,t=this.Wc,n=this.qc();0===t.length||(n=l(n).offset(),e=parseInt(t.css("left"),10)+n.left,i=parseInt(t.css("top"),10)+n.top,r=t.width(),o=t.height(),isNaN(e))||isNaN(i)||isNaN(r)||isNaN(o)||(c=(s=h.documentElement).clientWidth,s=s.clientHeight,(f=t[u=a=0].getBoundingClientRect()).left+r>c&&(u=f.left+r-c),f.top+o>s&&(a=f.top+o-s),(e<0||i<0||0<a||0<u)&&t.css({left:(e=(e-=u)<0?0:e)-n.left+"px",top:(i=(i-=a)<0?0:i)-n.top+"px"}))},w.prototype.Yc=function(t){return 0<l("#"+t).length},w.prototype.nf=function(){var e,n,t,i,r,o,e=this,n=e.Zc,t=l(a("div")).addClass(e.Kc),i=e.Wc;(e.Fc=t).css(e.Gc),l(e.qc()).append(t),(r=u&&u.mozilla)&&(o=(new Date).valueOf()),t.bind("mousedown",function(t){if(!e.Pc){var n;if(r)if((new Date).valueOf()-o<100)return;e.close(),r&&e.ff&&clearTimeout(e.ff)}s(t)}),t.bind("contextmenu",function(t){e.Pc&&s(t)}),i.bind("contextmenu",function(t){s(t)}),[f,d,v].forEach(function(t){l(h).bind(t+"."+n,function(t){var n=t.target;e.Fc&&!e.lf(n)&&(e.Pc||(r?e.ff=c.setTimeout(function(){e.close()},100):e.close()),s(t))})})},w.prototype.hf=function(t,n){for(var e=t;n&&n!==document.body;){if(n===e)return!0;n=n.parentNode}return!1},w.prototype.lf=function(t){return!!this.Wc&&this.hf(this.Wc.get(0),t)},w.prototype.tf=function(){return 0<l("."+this.Kc).length},n.zc=r=w,i(y,b=r),y.prototype.bindMoveEvent=function(t){var i,n,i=this,n=function(t){var n,e,t,t,n=i.Wc[0],e=i.Cse;e.mouseOriginalX=t.pageX,e.mouseOriginalY=t.pageY,t=n.getBoundingClientRect(),e.domOriginalX=t.left+(i.Pc?0:window.scrollX),e.domOriginalY=t.top+(i.Pc?0:window.scrollY),e.domWidth=t.width,e.domHeight=t.height,(t=n.offsetParent)?e.parentRect=t.getBoundingClientRect():"fixed"===n.style.position&&(e.parentRect=n.getBoundingClientRect()),e.screenWidth=window.innerWidth,e.screenHeight=window.innerHeight,i.Mse=!0,window.addEventListener("mousemove",i.Sse)};return t.addEventListener("mousedown",n),document.addEventListener("mouseup",i.Ise),function(){t.removeEventListener("mousedown",n),document.removeEventListener("mouseup",i.Ise)}},y.prototype.mouseInScreen=function(t,n){return 0<=t&&t<=this.Cse.screenWidth&&0<=n&&n<=this.Cse.screenHeight},n.Ase=y},"./dist/core/util/common.js":function(F,f,u){"use strict";var h,t,L,S,n,B,P,G,C,U,H,V,z,d,Y,T,Z,W,Q,t,J,K,l,v,X,q,$,tt,A,I,nt,x,N,m,et,b,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,g,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,w,y,Ot,Et,s,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,L,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,L,t,n,rn,on;function an(t){return t!==A}function un(t){return v.createElement(t)}function sn(t){v.body&&v.body.insertBefore(t,I)}function cn(t,e,i){Object.defineProperty(t,e,{get:function(){return this._ps[e]},set:function(t){var n=this._ps[e];n!==t&&(this._ps[e]=t,i)&&i(e,t,n)},enumerable:!0})}function fn(t,n){var t;return t.style&&t.style.vertAlign?(t=G.W.V(n,1)).fontSize*lt+"px "+t.fontFamily:n}function ln(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function hn(t){var n,e,i,n=!1;if(t)for(e=0;e<t.length;e++)if(11904<=(i=t.charCodeAt(e))&&i<12032||12288<=i&&i<40960||43360<=i&&i<43392||63744<=i&&i<64256){n=!0;break}return n}function dn(t){return Math.random().toString(16).slice(-t)}function vn(e){return function(t,n){return String.fromCharCode(parseInt(n,e))}}function mn(t){if(!t||"string"!=typeof t)return!1;var n;switch((t=t.toLowerCase())[0]){case"b":return 0===t.indexOf("background ");case"t":return 0===t.indexOf("text ");case"a":return 0===t.indexOf("accent ");case"h":return 0===t.indexOf("hyperlink");case"f":return 0===t.indexOf("followedhyperlink");default:return!1}}function gn(t,n,e){var i,r,o,a,i=0,o=t.split(" ");if(3<=o.length&&(i=parseFloat(o[2]),isNaN(i)||(i/=100)),"Background 1"===t.substring(0,12)&&(r=n?243:0),"Text 1"===t.substring(0,6)&&(r=n?241:1),"Background 2"===t.substring(0,12)&&(r=n?244:2),"Text 2"===t.substring(0,6)&&(r=n?242:3),"Accent 1"===t.substring(0,8)&&(r=4),"Accent 2"===t.substring(0,8)&&(r=5),"Accent 3"===t.substring(0,8)&&(r=6),"Accent 4"===t.substring(0,8)&&(r=7),"Accent 5"===t.substring(0,8)&&(r=8),"Accent 6"===t.substring(0,8)&&(r=9),"hyperlink"===t.substring(0,8)&&(r=10),(r="followedHyperlink"===t.substring(0,8)?11:r)!==A)return{n_:a=e||"color",theme:r,tint:i}}function pn(t,n){var e=t.tint?Math.round(100*t.tint):0,t=+t.theme;return 0==t||243==t?"Background 1 "+e:1==t||241==t?"Text 1 "+e:2==t||244==t?"Background 2 "+e:3==t||242==t?"Text 2 "+e:4==t?"Accent 1 "+e:5==t?"Accent 2 "+e:6==t?"Accent 3 "+e:7==t?"Accent 4 "+e:8==t?"Accent 5 "+e:9==t?"Accent 6 "+e:10==t?"hyperlink":11==t?"followedHyperlink":void 0}function c(){}function bn(t){return At.getIndexedColor(+t.indexed)}function wn(t,n){var t,e,t=At.convertColorToHex(t);if(t)return{n_:e=n||"color",rgb:t}}function yn(t,n){var e,i,r,o,a,o,e=0,i,r=document.createElement("canvas").getContext("2d");return r||(o=u("canvas"))&&o.createCanvas&&(r=(a=o.createCanvas(2,2)).getContext("2d")),r&&(r.font=t,e=(o=r.measureText(n)).emHeightAscent+o.emHeightDescent),e}function k(){}function Mn(t){t=t.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:t[1]||"",version:t[2]||"0"}}function Cn(){var n,e,n=I,e=!1;try{new ActiveXObject("")}catch(t){n=t.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return!(e="ReferenceError"===n||!1!==e)}function Sn(){}function Tn(t,n){var e=un("span");return e.className=t,n&&(e.id=n),e.style.display="none",sn(e),e}function An(t,n,e,i){t.addEventListener(n,e,i)}function In(t){var n,e,n=t.currentStyle,e=v.defaultView;return n=e&&e.getComputedStyle?e.getComputedStyle(t,""):n}function xn(t){var n,n,e,i,e,n,r,o,n=l.gcGlobal;0<n.vf||(16!==t.keyCode&&(n.mf=!0),(e=(n=Ot.ai())&&n.gf)&&(i=C(e)).isVisible())||n&&n.rt&&n.rt.pf&&(n.rt.pf(t),n.isEditing()||(e=t.keyCode,n=t.ctrlKey,r=t.altKey,o=t.shiftKey,90!==e&&89!==e||!n||r?86!==e||!n||r||o||t.stopPropagation&&t.stopPropagation():ln(t)))}function Nn(t){var n,n,n=l.gcGlobal;0<n.vf||(n.mf=!1,(n=Ot.ai())&&n.rt&&n.rt.bf&&n.rt.bf(t))}function kn(t){var n,e,n;0<l.gcGlobal.vf||(e=Ot.ai())&&e.rt&&e.rt.yf&&e.rt.yf(t)}function _n(t){var n,n,n=l.gcGlobal;0<n.vf||!0!==n.mf&&(n=Ot.ai())&&n.rt&&n.rt.yf&&n.rt.yf(t)}function Dn(t){return v.all===A&&Ot.ai()&&ln(t),!1}function e(){this.vf=0,this.wf=[],this.mf=!1,this.Hc()}function r(){}function jn(t,n){this.x=t,this.y=n}function p(t,n,e,i){var r=this;r.x=t,r.y=n,r.width=e,r.height=i}function M(t,n,e,i){var r=this;r.row=t,r.rowCount=e,r.col=n,r.colCount=i}function On(t,n,e,i){return new Bt(t,n,e,i)}function En(t,n){var e,i,r,t;if(t&&n){if(e=N(t.row,n.row),i=N(t.col,n.col),r=m(t.row+t.rowCount-1,n.row+n.rowCount-1),t=m(t.col+t.colCount-1,n.col+n.colCount-1),0<=e&&0<=i)return new Bt(e,i,r-e+1,t-i+1);if(0<=e)return new Bt(e,-1,r-e+1,-1);if(0<=i)return new Bt(-1,i,-1,t-i+1)}return new Bt(-1,-1,-1,-1)}function Rn(){}function i(){}function o(t){this.Mf=t}function _(){}function Fn(t){var n=t.Cf||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.Cf=n}function Ln(){}function Bn(t,n){t&&(t.Sf=n)}function Pn(t,n){t&&(t.Tf=n)}function Gn(t,n){t.Af=n}function Un(t,n){t.If=n}function D(){}function j(){var t,t;return Yt.xf||(Yt.xf=un("canvas").getContext("2d")),Yt.xf||(t=u("canvas"))&&t.createCanvas&&(t=t.createCanvas(2,2),Yt.xf=t.getContext("2d")),Yt.xf}function Hn(t){return h.Common.CultureManager.Fe().hse(t)}function O(t){for(var n=t.length-1;" "===t.charAt(n);)n--;return t=n!==t.length-1?t.substring(0,n+1):t}function Vn(t){var n,e,n=t instanceof Array?[]:{};for(e in t)t.hasOwnProperty(e)&&(n[e]="object"==typeof t[e]&&t[e]!==I?Vn(t[e]):t[e]);return n}function zn(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,h,o=[],a=r||j();if(a){for(s=e?(c=t.length*i,x(n/i)):(u=(c=y(a,a.font,t))/t.length,x(n/u));n<c&&t;)for(f=!1,l=s;;){if(t.length<l){o.push(t),t="";break}if(h=t.substring(0,l),d=e?l*i:y(a,a.font,h),(d="-"===h.charAt(h.length-1)?e?l*i:y(a,a.font,h)-y(a,a.font,"-"):d)===n||f&&d<n){o.push(h),t=t.substring(l),c-=d;break}if(n<d){if(1===h.length){(v=t.substring(h.length)).trim()?(o.push(h),t=t.substring(l),c-=d):(o.push(t),t="");break}--l,f=!0}else l+=h=1<=(h=e?(n-d)/i:(n-d)/u)?h:1}t&&-1===t.search(/^[ ]*$/)&&o.push(t)}return o}function Yn(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,a=o||j();if(!a)return[t];for(u=[],c=n,f=[],l=s=0;l<t.length;l++)if(h=t[l].style&&t[l].style.font||r,d=w.vt(h),h=fn(t[l],h),t[l].text&&0<t[l].text.length?s+=i?d*t[l].text.length:y(a,h,t[l].text):s=0,s<c)f.push(t[l]);else for(s-=i?d*t[l].text.length:y(a,h,t[l].text),v=0,m=t[l].text.length;v<m;v++){if(e<(g=i?d:y(a,h,t[l].text.charAt(v)))&&0===v){0<f.length&&(u.push(f),f=[]),f.push({style:t[l].style,text:t[l].text.substring(0,1)}),u.push(f),f=[],(p=t[l].text.substring(1,t[l].text.length)).length&&t.splice(l+1,0,{style:t[l].style,text:p}),s=0,c=e;break}if(c<(s+=g)){f.push({style:t[l].style,text:t[l].text.substring(0,v)}),u.push(f),f=[],(p=t[l].text.substring(v,t[l].text.length)).length&&t.splice(l+1,0,{style:t[l].style,text:p}),s=0,c=e;break}v===m-1&&(f.push({style:t[l].style,text:t[l].text}),u.push(f),f=[],s=0,c=e)}return 0<f.length&&u.push(f),u}function Zn(t,n,e,i,r){var o,a,u,r,r,s,c,f,l,h,d,v,m,m,g,p,b,o=[],a=Hn(t),u=r||j();if(u){for(r=y(u,u.font,t),r=e?i:r/t.length,s=st(n/r+"",10),h=l=f=c=0,v=!(d=[]);h<a.length;){if(!1===v){if(m=a[h],d.push(m),(f+=m.length)<s&&h<a.length-1){h++;continue}l=f,f=0}if(n<(m=e?d.join("").length*i:Yt.Wt(d.join(""),u.font,!0,u)))if(g=d.pop(),0===d.length){for(p=zn(g,n,e,i,u),b=0;b<p.length-1;b++)o[c]=p[b],c++;1===p.length&&(o[c]=p[0],c++),2<=p.length?a[h]=p[p.length-1]:h++,v=!1}else v=!0,h--;else m<n&&!0===v||m===n?(v=!1,o[c]=O(d.join("")),c++,d=[],h++):m<n&&(h++,f=l)}0!==d.length&&(o[c]=O(d.join("")))}return o}function Wn(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,o=[],a=r||j();if(a)if(0===t.length)o.push({textLength:0,text:"",textInfos:[{style:{font:e},text:""}]});else{for(s=[],c=u=0;c<t.length;c++){for(f=t[c],d=h=l=0;d<f.length;d++)v=void 0,v=f[d].style&&f[d].style.font?f[d].style.font:e,i?l+=(h=w.vt(v))*f[d].text.length:T(f[d].text)||(v=fn(f[d],v),l+=y(a,v,f[d].text));if(n<l){for(0<s.length&&(o.push({textLength:u,text:O(Jn(s)),textInfos:Vn(s)}),s=[],u=0),m=Yn(f,n-u,n,i,e,a),s=s.concat(m[0]),T(m[0])||o.push({textLength:u+Qn(m[0],e,i,a),text:O(Jn(s)),textInfos:Vn(s)}),s=[],u=0,g=1;g<m.length-1;g++)T(m[g])||o.push({textLength:Qn(m[g],e,i,a),text:O(Jn(m[g])),textInfos:Vn(m[g])});1<m.length&&(p=m[m.length-1],s=s.concat(p),T(p)||(u+=Qn(p,e,i,a)))}else n<u+l?(o.push({textLength:u,text:O(Jn(s)),textInfos:Vn(s)}),s=(s=[]).concat(f),u=l):(s=s.concat(f),u+=l)}0<s.length&&o.push({textLength:u,text:O(Jn(s)),textInfos:Vn(s)})}return o}function Qn(t,n,e,i){for(var r,o,a,u,s,r=0,o=i||j(),a=0;a<t.length;a++)u=t[a].style&&t[a].style.font||n,s=fn(t[a],u),r+=e?w.vt(u)*t[a].text.length:y(o,s,t[a].text);return r}function Jn(t){for(var n,e,n="",e=0;e<t.length;e++)n+=t[e].text;return n}function Kn(t,n,e,i){for(var r,o,a,u,s,c,c,r=-1,o=!0,a=0;a<n.length;a++)if(!T(n[a].text))for(u=0;u<n[a].text.length;u++)s=n[a].text.charAt(u),c=n[a].style?n[a].style.font:e,w.bt(t,c),c=w.vt(c)," "===s||o?" "!==s&&o&&(r=i?c:y(t,e,s),o=!1):r=N(r,i?c:y(t,e,s));return r}function E(){}function Xn(){this.Nf={}}function qn(){}function $n(t){var n,e,n,i,e,n,e,e,n=t.getRangeAt(0),e=n.startContainer,n=n.startOffset,i;ne(e)&&(e=fe(e,n))&&e.zeroWidthCharNode&&(n=e.zeroWidthCharNode,(e=t.getRangeAt(0)).setStart(n,1),e.deleteContents(),(e=v.createRange()).setStart(n,1),e.setEnd(n,1),t.removeAllRanges(),t.addRange(e),ln(event))}function te(t){return t.textContent&&1===t.textContent.length&&t.textContent.split("")[0]===yt}function ne(t){return t.textContent&&t.textContent.split("")[0]===yt}function ee(t,n,e){if(1===n&&ie(e.firstChild)&&ie(e.firstChild.firstChild)){var n=e.firstChild.firstChild.lastChild,i=void 0;if(t===e)return 1===(i=n.textContent).length&&i[0]!==yt&&re(n.previousSibling);if(n===t||re(n)&&t===n.previousSibling)return 1===(i=t.textContent).length&&i[0]!==yt&&re(t.previousSibling)}}function ie(t){return t&&"SPAN"===t.tagName}function re(t){return t&&"BR"===t.tagName}function oe(t){return t&&"DIV"===t.tagName}function ae(t){return t instanceof Text}function ue(t){var n;return!!t&&(n=t.childNodes,ie(t))&&2===n.length&&re(n[0])&&ce(n[1])}function se(t,n){var e;if(t)return e=t.childNodes,ie(t)&&re(e[n-2])&&ce(e[n-1])}function ce(t){if(t&&ae(t)){var t=t.textContent;if(1===t.length&&ve(t[0]))return!0}return!1}function fe(t,n){var e,i,r,o,i,e,n,e=t.childNodes.length,o;if(!ve((t.innerText||t.textContent)[0])||0!==n&&1!==n)if(0===n)i=(i=me(r=(r=t)===t.parentNode.firstChild?t.parentNode:r,ue))&&i.lastChild;else{if(oe(t))return 1===e&&1===n?i=t.firstChild.firstChild.lastChild:1<e&&n===e&&(i=t.lastChild),ce(i)?{zeroWidthCharNode:i,previousTextNode:i.previousSibling.previousSibling}:ue(i)?{zeroWidthCharNode:i,previousTextNode:me(r,ae)}:I;!ie(t)||n!==e&&n!==e-1||(ue(t)?i=t:ue(t.lastChild)?i=t.lastChild:se(t,n)&&(i=t.childNodes[n-1]))}else i=t;return i?(ie(i)?r=i:ae(i)&&(r=(e=i.previousSibling)===(n=i.parentNode).firstChild?n:e),{zeroWidthCharNode:i,previousTextNode:me(r,ae)}):I}function le(t){var n,t,e,i,r,t,n=t.anchorNode,t=t.anchorOffset,e=n.textContent,i;if(t!==e.length)return 0===t&&ve(e[0])?{node:n,offset:0}:I;if(t=void 0,!(r=ge(n)))return I;if(ie(r)&&ve(r.textContent[0])){for(;ie(r.firstChild);)r=r.firstChild;t=r.childNodes[1]}else re(r)&&ve(r.nextSibling.textContent[0])&&(t=r.nextSibling);return{node:t,offset:1}}function he(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,a="",u=t.childNodes,s=u.length,c=0;c<s;c++)ie(f=u[c])?a+=he(f,n,e,i,r,o):ae(f)?(l=n&&n.startContainer,h=n&&n.endContainer,d=f.textContent,f===l||f===h?l!==h?o=f===l?(a+=de(d,e,d.length,r),!0):(a+=de(d,0,i,""),!1):a+=de(d,e,i,r):o||(a+=d)):re(f)&&!o&&(a+="\n");return a}function de(t,n,e,i){var r,o,r,o;return t.substr(0,n)+i+t.substr(e,t.length-e)}function ve(t){return t===yt}function me(t,n){for(var e=t&&t.previousSibling;e;){if(n(e))return e;e=e.lastChild}return I}function ge(t){for(var n,e,n=t;n;){if(n!==(e=n.parentNode).lastChild)return n.nextSibling;n=e}return I}function pe(t){var n,t;return n=t&&!(n=t.getActiveSheet())&&(t=t.getActiveSheetTab())?t.Mf:n}function be(t,n){var e,i;t&&((e=t._f(n))?t.setActiveSheet(n):(i=t.Ofe(n))&&t.setActiveSheetTab(n))}function we(t,n){var e,t,e=t._f(n);return e||(t=t.Ofe(n))&&(e=t.Mf),e}function ye(t){var n,e,i,r,n=[].concat(t.parent.sheets);for(t&&t.NMi&&n.push(t),e=t.parent.getSheetTabCount(),i=0;i<e;i++)(r=t.parent.getSheetTab(i))&&r.Mf&&n.push(r.Mf);return n}function Me(t){return"="===t||"+"===t||"-"===t}function Ce(t){var t;return 1<t.length&&Me(t[0])&&Me(t[1])||!0===(t=w.Xf(void 0,t,!0))||!1===t?NaN:t}function Se(t){return t&&0<t.length&&Me(t[0])&&!Me(t)&&isNaN(Ce(t))}function Te(){}function Ae(){var t=this;t.rowInfo=[],t.colInfo=[],t.wholeCols={},t.wholeRows={}}function Ie(){this.reset()}function xe(t,n){var n=b(10,n);return Math.round(t*n)/n}function R(){}function Ne(t,n){this.numberFormatId=t,this.numberFormatCode=n}function ke(t){return!1===t}function _e(t){var n,e,i,r,o,a;t&&(n=t.applyFont,e=t.applyFill,i=t.applyBorder,r=t.applyAlignment,o=t.applyNumberFormat,a=t.applyProtection,!1===n&&(delete t.foreColor,delete t.textDecoration,delete t.themeFont,delete t.font),!1===e&&delete t.backColor,!1===i&&(delete t.borderLeft,delete t.borderTop,delete t.borderRight,delete t.borderBottom,delete t.diagonalDown,delete t.diagonalUp),!1===r&&(delete t.textIndent,delete t.wordWrap,delete t.hAlign,delete t.vAlign,delete t.isVerticalText,delete t.shrinkToFit,delete t.textOrientation),!1===o&&delete t.formatter,!1===a)&&delete t.locked}function De(t,n,e,i){var r,n;e&&(r=e.foreColor,r=Rt.m(n,r),i=T(e.opacity)?i:e.opacity,T(i)||((n=H._(r)).a=i,r=H.j(n)),t.fillStyle!==r)&&(t.fillStyle=r||"#000000")}function je(t){return B.Cmt(t.split(""),!1)?t:"'"+t.replace(/'/g,"''")+"'"}function Oe(t,n,e,i,r){if(nn=nn||u("SheetsCalc"))return nn.rangeToFormula(t,n,e,i,r)}function Ee(t,n){var e,i,r,o,e=Array.isArray(t),i="[object Object]"===Object.prototype.toString.call(t);if(e){for(r=[],o=0;o<t.length;o++)r[o]=Ee(t[o],n);return r}if(i){for(o in r=void 0,t)T(t[o])&&!n||((r=void 0===r?{}:r)[o]=Ee(t[o],n));return r}return t}function a(){}function Re(t){t&&t.length&&t.forEach(function(t){var n=t.sheet,e=t.table,i=t.oldRange,t=t.newRange;n.S4t(e,i,t)})}Object.defineProperty(f,"__esModule",{value:!0}),f.RF=f.rangeToFormula=f.i2e=f.resetFillStyle=f.AL=f.ExcelNumerFormat=f.SJSColumnWidthHelper=f.unknownFontMaxDigitWidthMap=f.SharedStrings=f.NUMBER_ARRAY=f.BaseUsedRange=f.UsedRangeUtil=f.kf=f.Df=f.hCe=f._f=f.Ef=f.jf=f.Of=f.di=f.Rf=f.$e=f.q=f.r2e=f.zt=f.Bf=f.Lf=f.Be=f.Ff=f.Events=f.Pf=f.getUnionRange=f.Ec=f.Range=f.Rect=f.Point=f.I=f.hi=f.mt=f.util=f.getFontHeightWithCanvas=f.ColorHelper=f.isThemeColor=f.findControl=f.getTypeFromString=f.CursorResource=f.productInfo=f.isDefined=f.FormulaPrefix=f.FallbackFontFamily=void 0,f.handleRestoredTableResizedArgs=f.oCe=void 0,h=u("Common"),t=u("./dist/core/util/domUtil.js"),L=u("./dist/core/core.ns.js"),S=u("./dist/core/core.enum.js"),n=u("./dist/core/excel-io-util/common.js"),B=u("CalcEngine"),P=u("./dist/core/util/imageLoader.js"),G=u("./dist/core/worksheet/stylehelper.js"),C=t.GC$,U=C.extend,H=h.Common.ft,V=h.Common.st,z=h.Common.Uf.Gf,d=h.Formatter&&h.Formatter.GeneralFormatter,Y=h.Formatter&&h.Formatter.Hf,T=h.Common.lt.ht,Z=n.StringEx.Xi,W=h.Common.zf,Q=!!B,t=new h.Common.ResourceManager(L.SR),J=t.getResource.bind(t),f.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',K=n.Util.addXLFNPrefix,l=window,v=document,X="boolean",q="date",$="undefined",tt="function",A=void 0,I=null,nt=Math.floor,x=Math.ceil,N=Math.min,m=Math.max,et=Math.round,b=Math.pow,it=Math.sqrt,rt=Math.atan2,ot=Math.cos,at=Math.abs,ut=Math.sin,st=parseInt,ct=parseFloat,ft=isNaN,lt=.7,ht="px",dt=" ",vt=".",g="string",mt="number",gt="touch",pt="MSPOINTER_TYPE_TOUCH",bt=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),wt=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),yt="\u200b",f.FormulaPrefix=["=","+","-"],f.isDefined=an,f.productInfo={productVersion:"17.0.10"},f.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},f.getTypeFromString=Mt=function(t){var n,e,i,r,o,n=!1,e=l;if(typeof t==g){for(r=0,o=(i=t.split(".")).length;r<o&&e;r++)e=e[i[r]];e&&r===o&&0<o&&(n=!0)}return n?e:A},f.findControl=Ct=function(t){return typeof t==g&&(t=v.getElementById(t)),C(t).data("workbook")},f.isThemeColor=mn,St=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080,4294967295],Tt={aliceblue:4293982463,antiquewhite:4294634455,aqua:4278255615,aquamarine:4286578644,azure:4293984255,beige:4294309340,bisque:4294960324,black:4278190080,blanchedalmond:4294962125,blue:4278190335,blueviolet:4287245282,brown:4289014314,burlywood:4292786311,cadetblue:4284456608,chartreuse:4286578432,chocolate:4291979550,coral:4294934352,cornflowerblue:4284782061,cornsilk:4294965468,crimson:4292613180,cyan:4278255615,darkblue:4278190219,darkcyan:4278225803,darkgoldenrod:4290283019,darkgray:4289309097,darkgreen:4278215680,darkkhaki:4290623339,darkmagenta:4287299723,darkolivegreen:4283788079,darkorange:4294937600,darkorchid:4288230092,darkred:4287299584,darksalmon:4293498490,darkseagreen:4287609999,darkslateblue:4282924427,darkslategray:4281290575,darkturquoise:4278243025,darkviolet:4287889619,deeppink:4294907027,deepskyblue:4278239231,dimgray:4285098345,dodgerblue:4280193279,feldspar:4291924597,firebrick:4289864226,floralwhite:4294966e3,forestgreen:4280453922,fuchsia:4294902015,gainsboro:4292664540,ghostwhite:4294506751,gold:4294956800,goldenrod:4292519200,gray:4286611584,green:4278222848,greenyellow:4289593135,honeydew:4293984240,hotpink:4294928820,"indianred ":4291648604,"indigo ":4283105410,ivory:4294967280,khaki:4293977740,lavender:4293322490,lavenderblush:4294963445,lawngreen:4286381056,lemonchiffon:4294965965,lightblue:4289583334,lightcoral:4293951616,lightcyan:4292935679,lightgoldenrodyellow:4294638290,lightgrey:4292072403,lightgreen:4287688336,lightpink:4294948545,lightsalmon:4294942842,lightseagreen:4280332970,lightskyblue:4287090426,lightslateblue:4286869759,lightslategray:4286023833,lightsteelblue:4289774814,lightyellow:4294967264,lime:4278255360,limegreen:4281519410,linen:4294635750,magenta:4294902015,maroon:4286578688,mediumaquamarine:4284927402,mediumblue:4278190285,mediumorchid:4290401747,mediumpurple:4287852760,mediumseagreen:4282168177,mediumslateblue:4286277870,mediumspringgreen:4278254234,mediumturquoise:4282962380,mediumvioletred:4291237253,midnightblue:4279834992,mintcream:4294311930,mistyrose:4294960353,moccasin:4294960309,navajowhite:4294958765,navy:4278190208,oldlace:4294833638,olive:4286611456,olivedrab:4285238819,orange:4294944e3,orangered:4294919424,orchid:4292505814,palegoldenrod:4293847210,palegreen:4288215960,paleturquoise:4289720046,palevioletred:4292374675,papayawhip:4294963157,peachpuff:4294957753,peru:4291659071,pink:4294951115,plum:4292714717,powderblue:4289781990,purple:4286578816,red:4294901760,rosybrown:4290547599,royalblue:4282477025,saddlebrown:4287317267,salmon:4294606962,sandybrown:4294222944,seagreen:4281240407,seashell:4294964718,sienna:4288696877,silver:4290822336,skyblue:4287090411,slateblue:4285160141,slategray:4285563024,snow:4294966010,springgreen:4278255487,steelblue:4282811060,tan:4291998860,teal:4278222976,thistle:4292394968,tomato:4294927175,turquoise:4282441936,violet:4293821166,violetred:4291829904,wheat:4294303411,white:4294967295,whitesmoke:4294309365,yellow:4294967040,yellowgreen:4288335154,transparent:16777215},c.hexToARGB=function(t){return{r:(t="string"==typeof t?parseInt(t,16):t)>>16&255,g:t>>8&255,b:255&t,a:t>>24&255}},c.convertRgbToXyz=function(t){var n,e,i,t,e,i,n,r,o,a,n=function(t){return t=.04045<(t/=255)?b((t+.055)/1.055,2.4):t/12.92,t*=100},e=t.r,i=t.g,t=t.b,e=n(e),i=n(i),n=n(t),r,o,a;return{x:.4124564*e+.3575761*i+.1804375*n,y:.2126729*e+.7151522*i+.072175*n,z:.0193339*e+.119192*i+.9503041*n}},c.convertXyzToLab=function(t){var n,e,i,t,r,o,a,n=function(t){return.008856<t?b(t,1/3):7.787*t+16/116},e=t.x,i=t.y,t=t.z;return i/=100,t/=107.304,e=n(e/=94.811),{lightness:r=116*(i=n(i))-16,redGreen:o=500*(e-i),blueYellow:a=200*(i-(t=n(t)))}},c.calculateDeltaE2000=function(t,n){var e,i,t,r,o,n,a,u,s,c,f,l,l,i,o,l,h,d,t,i,a,n,o,i,t,r,e,l,h,v,s,m,g,p,e=t.lightness,i=t.redGreen,t=t.blueYellow,r=n.lightness,o=n.redGreen,n=n.blueYellow,a=function(t){return 360*t/(2*Math.PI)},u=function(t){return 2*Math.PI*t/360},s=(e+r)/2,c,f,l=(it(b(i,2)+b(t,2))+it(b(o,2)+b(n,2)))/2,l=(1-it(b(l,7)/(b(l,7)+b(25,7))))/2,i=i*(1+l),o=o*(1+l),l=it(b(i,2)+b(t,2)),h=it(b(o,2)+b(n,2)),d=(l+h)/2,t=a(rt(t,i));return t<0&&(t+=360),(i=a(rt(n,o)))<0&&(i+=360),a=180<at(t-i)?(t+i+360)/2:(t+i)/2,n=1-.17*ot(u(a-30))+.24*ot(u(2*a))+.32*ot(u(3*a+6))-.2*ot(u(4*a-63)),180<at(o=i-t)&&(i<=t?o+=360:o-=360),i=r-e,t=h-l,o=2*it(l*h)*ut(u(o)/2),r=1+.015*b(s-50,2)/it(20+b(s-50,2)),e=1+.045*d,l=1+.015*d*n,h=30*Math.exp(-b((a-275)/25,2)),s=-(v=2*it(b(d,7)/(b(d,7)+b(25,7))))*ut(2*u(h)),p=g=m=1,it(b(i/r,2)+b(t/e,2)+b(o/l,2)+t/e*s*(o/l))},c.getClosestColorIndex=function(t,n){var e,i,r,o,a,a;for(n===A&&(n=64),e=-1,i=Number.MAX_VALUE,r=c.convertXyzToLab(c.convertRgbToXyz(t)),o=Math.min(c.paletteInLab.length-1,n);0<=o;o--)a=c.paletteInLab[o],(a=c.calculateDeltaE2000(a,r))<i&&(i=a,e=o);return e},c.getHexNumString=function(t){var n,n,n=+t;return isNaN(n)?t+"":(n=(t=n).toString(16),t<16?"0"+n:n)},c.convertColorToHex=function(t){var t,n,e,i,r,o;if(t)return"string"!=typeof t?t:("#"===(t=t.toLowerCase()).substring(0,1)?7===t.length?n="FF"+t.substring(1).toUpperCase():4===t.length&&(n="FF"+(e=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]).toUpperCase()):"rgb("===t.substring(0,4)?(r=t.indexOf("("),o=t.indexOf(")"),i=t.substring(r+1,o).split(","),n="FF"+(e=c.getHexNumString(i[0])+c.getHexNumString(i[1])+c.getHexNumString(i[2])).toUpperCase()):"rgba("===t.substring(0,5)?(r=t.indexOf("("),o=t.indexOf(")"),i=t.substring(r+1,o).split(","),n=(e=c.getHexNumString(i[3])+c.getHexNumString(i[0])+c.getHexNumString(i[1])+c.getHexNumString(i[2])).toUpperCase()):Tt[t]&&(n=Tt[t].toString(16).toUpperCase()),n)},c.convertHexColorToArgb=function(t){return c.hexToARGB(c.convertColorToHex(t))},c.getIndexedColor=function(t){var t,n,e,i;return 32767===t||t<0||St.length<=t?"#000000":St[t]!==A?"rgb("+(n=(t=St[t])>>16&255)+","+(e=t>>8&255)+","+(i=255&t)+")":void 0},c.palette=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080],c.paletteInLab=[{lightness:0,redGreen:0,blueYellow:0},{lightness:100.00000386666655,redGreen:.41450003183252093,blueYellow:-.9762337974368318},{lightness:53.24079414130722,redGreen:80.40628534603033,blueYellow:66.9485076645686},{lightness:87.73472235279792,redGreen:-85.88347705836918,blueYellow:82.71231806483974},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:0,redGreen:0,blueYellow:0},{lightness:100.00000386666655,redGreen:.41450003183252093,blueYellow:-.9762337974368318},{lightness:53.24079414130722,redGreen:80.40628534603033,blueYellow:66.9485076645686},{lightness:87.73472235279792,redGreen:-85.88347705836918,blueYellow:82.71231806483974},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:25.53553096346318,redGreen:48.23338316760745,blueYellow:37.96950789833623},{lightness:46.22743146876261,redGreen:-51.51899057263506,blueYellow:49.61670487243066},{lightness:12.9719668574308,redGreen:47.64519130280251,blueYellow:-65.26181066276018},{lightness:51.86894337734398,redGreen:-12.69765903738712,blueYellow:56.380043157800905},{lightness:29.784666617920195,redGreen:59.1403568405364,blueYellow:-37.05049551887899},{lightness:48.2540934618616,redGreen:-28.64061189579556,blueYellow:-9.059017225814237},{lightness:77.7043667134314,redGreen:.3348315663007084,blueYellow:-.7885979888260453},{lightness:53.585015771669404,redGreen:.2486464680258038,blueYellow:-.5856141545440119},{lightness:67.10642818332406,redGreen:24.661563327250835,blueYellow:-51.70481284997233},{lightness:38.02326868659504,redGreen:47.530276772876526,blueYellow:-7.41000863702892},{lightness:98.88366982816507,redGreen:-7.647377025903346,blueYellow:23.604961406243042},{lightness:96.64610006552223,redGreen:-15.626896975835969,blueYellow:-6.286449794841897},{lightness:22.946593663526578,redGreen:50.30757275587142,blueYellow:-31.51689638909162},{lightness:68.21369400049187,redGreen:48.529707503769,blueYellow:22.097909906924063},{lightness:44.03181574544729,redGreen:15.497390355584283,blueYellow:-60.313393374835414},{lightness:83.56960561788927,redGreen:10.660290354444879,blueYellow:-25.869538462689157},{lightness:12.9719668574308,redGreen:47.64519130280251,blueYellow:-65.26181066276018},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:29.784666617920195,redGreen:59.1403568405364,blueYellow:-37.05049551887899},{lightness:25.53553096346318,redGreen:48.23338316760745,blueYellow:37.96950789833623},{lightness:48.2540934618616,redGreen:-28.64061189579556,blueYellow:-9.059017225814237},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:76.31433784805343,redGreen:-24.045184322556313,blueYellow:-37.63232479221295},{lightness:96.64610006552223,redGreen:-15.626896975835969,blueYellow:-6.286449794841897},{lightness:95.46123799053612,redGreen:-25.20013221308681,blueYellow:18.33180794427749},{lightness:98.0661672083006,redGreen:-13.832882960730986,blueYellow:47.940897645383274},{lightness:80.27790732349922,redGreen:-3.692924875082826,blueYellow:-31.192993832087378},{lightness:75.08051024268852,redGreen:44.9470828980269,blueYellow:-10.53443113754624},{lightness:71.44638619892534,redGreen:38.40169770146873,blueYellow:-44.58196770374543},{lightness:85.37715784474301,redGreen:11.871131967975845,blueYellow:31.5700614950422},{lightness:48.789468602187014,redGreen:37.72886428748323,blueYellow:-81.46151935827358},{lightness:74.97920661167659,redGreen:-37.437024973414836,blueYellow:-12.053212107002897},{lightness:76.04314994204388,redGreen:-38.98270545611504,blueYellow:75.18013610138723},{lightness:84.19958734726818,redGreen:4.040877427542666,blueYellow:84.79018925434798},{lightness:72.2607240884026,redGreen:30.50579205114734,blueYellow:76.85864017596677},{lightness:62.312481453511026,redGreen:55.3256388060856,blueYellow:71.01583749339153},{lightness:45.11897896728884,redGreen:12.741665540704494,blueYellow:-28.39942907333195},{lightness:62.082179778109094,redGreen:.2790091803857031,blueYellow:-.6571246580693746},{lightness:21.3066228635372,redGreen:6.957317762469661,blueYellow:-34.694697216998314},{lightness:56.52959107095738,redGreen:-41.28375003303447,blueYellow:17.929912574393892},{lightness:17.308442495122094,redGreen:-27.576541316135987,blueYellow:24.11521195522933},{lightness:20.328171424265783,redGreen:-6.796668862699029,blueYellow:28.392687041649655},{lightness:36.25649980036505,redGreen:41.047060654411325,blueYellow:47.86323594949912},{lightness:38.02326868659504,redGreen:47.530276772876526,blueYellow:-7.41000863702892},{lightness:27.765685279866425,redGreen:33.339639613412324,blueYellow:-56.37161392120451},{lightness:21.24673253653905,redGreen:.13309285609849897,blueYellow:-.31346136150179893},{lightness:0,redGreen:0,blueYellow:0}],At=c,f.ColorHelper=At,f.getFontHeightWithCanvas=yn,It=/&#(\d+);/g,xt=/&#x([0-9A-F]+);/gi,Nt=/&amp;/g,kt=/&gt;/g,_t=/&lt;/g,Dt=/&quot;/g,jt=/&apos;/g,k.Vf=function(t){for(var n,e,n="";0<t;t=parseInt((t-1)/26+"",10))n=String.fromCharCode(65+(e=(t-1)%26))+n;return n},k.gt=function(t,n,e,i){var r;return 3===t&&(r=C.getType(n),t=!e||"@"!==e&&"@"!==e.formatCached?r===X?1:r===mt||r===q||r===g&&k.Yf(n)?2:0:0,i)&&0!==i&&(0<i?t=0:i<0&&(t=2),-90===i?t=0:90===i&&(t=2)),t},k.Yf=function(t){return k.Zf.test(t)},k.j=function(t){var n,n,n=C.getType(t);return t=t===I||t===A?"":n===X?t.toString().toUpperCase():n===q?(n=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds(),h.Common.ct.Pe(t,n?"M/d/yyyy":"M/d/yyyy h:mm:ss")):t.richText?k.wt(t):t.toString()},k.Wf=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,u=C(t),s=n,c=e,f="background-position",l="background-size",h="auto",d="0%",v="50%",m="100%";switch(o){case 0:a?u.css(f,a.position).css(l,a.size):u.css(f,"0% 0%").css(l,"100% 100%");break;case 1:p=g=v,u.css(f,(g=s<i?d:v)+" "+(p=c<r?d:v)).css(l,"auto auto");break;case 2:y=s,(w=b=0)<(M=c)&&0<r&&i/r<s/c?b=b+s/2-(y=i/r*c)/2:0<s&&0<i&&r/i<c/s&&(w=w+c/2-(M=r/i*s)/2),u.css(f,b+ht+" "+w+ht).css(l,y+ht+" "+M+ht);break;case 3:u.css(f,"0% 0%").css(l,"auto auto")}},k.device=function(){var t,n,e,i,r,o,t=navigator.userAgent,n=t.match(/iPad/i);if(n)(e=n[0])&&(i="ipad"===e.toLowerCase());else if((n=t.match(/Macintosh/i))&&(e=n[0]))try{document.createEvent("TouchEvent"),i="macintosh"===e.toLowerCase()}catch(t){}return{ipad:i,iphone:r=(n=t.match(/iPhone/i))&&(e=n[0])?"iphone"===e.toLowerCase():r,android:o=(n=t.match(/android/i))&&(e=n[0])?"android"===e.toLowerCase():o}},k.Qf=function(){var t=navigator.platform;return t&&-1<t.indexOf("Mac")},k.Kf=function(t){var t,t;return t!==A&&t!==I&&(t=t.toString(),t=V.Jf(t),!ft(Number(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t))},k.Xf=function(t,n,e,i,r){var o,a,u,u,s,t,o,a,o=I,a=!1;if(t&&((u=t.formatter)?(r?o=r:k.St(u)||(o=u,a=!0),typeof o==g&&d&&(o=new d(o))):o=t._autoFormatter),o&&!o.isAuto){u=I;try{if(u=o.parse(n),typeof(u=a&&u instanceof Date&&(s=(new d).getPreferredDisplayFormatter(n,r))?s.parse(n):u)==mt)return u}catch(t){}return u===A||u===I?n:u}if(e){if(t=void 0,t={},o=void 0,a=I,d)try{a=(new d).getPreferredDisplayFormatter(n,t)}catch(t){}return typeof(o=t.value)==mt?n=o:k.Kf(n)&&(o=t.value=n),i&&(i.value=a),o!==A&&o!==I?o:n}return n},k.gi=function(t){for(var n,e,t,i,n=v.body,e=t;e&&e.parentElement&&e.parentElement!==n;)e=e.parentElement;return t=1e3,e&&e.parentElement===n&&(i=st(C(e).css("z-index")),ft(i)||(t+=i)),t},k.ri=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,d;if(!t)return[];if(n=t.indexOf("("),e=t.lastIndexOf(")"),!(i=t.substring(n+1,e)))return[];for(r=[],a="",s=u=o=0;s<i.length;)u=i.indexOf("rgb",o),-1===(s=i.indexOf("rgb",o+1))&&(s=i.length),a=i.substring(u,s),r.push(a),o=s;for(c=[],f=0,l=r.length;f<l;f++)d=(h=r[f]).indexOf(")"),v=h.substring(0,d+1),d=ct(h.substring(d+1,h.length)),ft(d)&&(f===l-1?d=100:f<=1&&(d=0)),!v&&0===f||c.push({color:v,point:d/=100});return c},k.qf=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,d,m,g,g,g,p,p,b,w,y,M,C,w,M,m,o=n.Dn,a=0,u=[e],s=n.zoom();for(i===S.AutoFitType.cellWithHeader&&(e===S.SheetArea.viewport?u.push(1):e===S.SheetArea.rowHeader&&u.push(0)),c=0;c<u.length;c++)for(f=0,l=u[c],h=r||n.getRowCount(l);0<=f&&f<h;)(d=n.Ut.findSpan(f,t,l))&&(d.col<t||1<d.colCount||d.row<f)?f=d.row+d.rowCount:(d=0,(m=(v=n.o2e(f,t,l)).cellType||n.$f(l))&&(g=v.font||o.Nn(),v.font=o._n(g),(g=!(!(g=n.rowFilter&&n.rowFilter())||!g.rn(f,t,l)))||3!==l||(p=n.tables?n.tables.find(f,t):I)&&p.showHeader()&&p.headerIndex()===f&&p.rowFilter()&&p.filterButtonVisible(t-p.range().col)&&(g=!0),p=v.formatter||v._autoFormatter,b={sheet:n,row:f,col:t,sheetArea:l,quotePrefix:v.quotePrefix},w={},y=n.$t(f,t,l,S.ValueType.richText),M=n.t0(f,t,e),C="",y&&y.richText?C=n.getText(f,t,l):T(M)?(C=m.format(y,p,w,b),m.xTe&&m.xTe(w,v.showEllipsis,A,v.hAlign)&&m.NTe&&(C=m.NTe(w.content))):C=M,d=m.Ln(y,C,v,s,b),g)&&(w=N(s,1),M=st((n.defaults.rowHeight*w).toString(),10),(m=3===(m=v.hAlign)?k.gt(m,y,v.formatter||v._autoFormatter,v.textOrientation):m)===S.HorizontalAlign.center?d+=2*M:m===S.HorizontalAlign.left&&(d+=M)),a<d&&(a=d),l===S.SheetArea.viewport?f=k.n0(f,t,n,l):f++);return 0===a?a=n.defaults.colWidth:a+=x(3),x(a)},k.n0=function(t,n,e,i){for(var r,o,a,u,s,r=-1,o=e.getRowCount(i),a=t+1;a<o;a++){if(u=e.$t(a,n,i)){r=a;break}if((s=e.getActualStyle(a,n,i))&&(s.cellType||s.cellButtons&&0<s.cellButtons.length||G.W.Jue(s))){r=a;break}}return r},k.e0=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,v,m,m,s,g,p,b,r=n.Dn,o=0,a=[e],u=n.zoom();for(1===i&&(3===e?a.push(2):1===e&&a.push(0)),f=!1,l=c=0;l<a.length;l++)for(h=0,d=n.getColumnCount(e=a[l]);0<=h&&h<d;)(v=n.Ut.findSpan(t,h,e))&&(v.row<t||1<v.rowCount||v.col<h)?h=v.col+v.colCount:(0<n.getColumnWidth(h,e)&&(m=(v=n.o2e(t,h,e)).font||r.Nn(),v.font=r._n(m),m=0,(s=n.getCellType(t,h,e))&&(g=n.getText(t,h,e),p=n.$t(t,h,e,S.ValueType.richText),m=s.Fn(p,g,v,u,b={sheet:n,row:t,col:h,sheetArea:e})),2===(s=n.Lt(h))?c=c+m+x(3):(c&&(m+=c,c=0),1===s&&(f=!0)),o<(m=c?c:m))&&(o=m),3===e?h=k.i0(t,h,n,e):h++);return 0===(o=f&&o<60?60:o)?o=n.defaults.rowHeight:o+=x(3),x(o)},k.i0=function(t,n,e,i){for(var r,o,a,u,s,r=-1,o=e.getColumnCount(i),a=n+1;a<o;a++){if(u=e.$t(t,a,i)){r=a;break}if((s=e.getActualStyle(t,a,i))&&s.cellType){r=a;break}}return r},k.Eve=function(t){var n,e,i,r;if(t instanceof Date)return t;if("string"!=typeof t)return"number"==typeof t&&!isNaN(t)&&(n=h.Common.ct.Y0(t))||I;if(!(n=h.Common.ct.yU(t)))if(isNaN(t)){if(h.Common.ct.u6t(t))return I;if(n=new Date(t),isNaN(n.valueOf()))return I;try{if(e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,i=W.s6t(W.cJ(t.replace(/[ \n]/g,"")," ")," "),(r=e.exec(i))&&4===r.length&&(-1===r.indexOf(n.getFullYear().toString())||-1===r.indexOf(n.getMonth().toString())||-1===r.indexOf(n.getDate().toString())))return I}catch(t){return I}}else if(!(n=h.Common.ct.Y0(parseFloat(t))))return I;return n},k.mi=function(t,n,e,i,r){var o,a,i,t,r,u,s,c,f,l;if(e&&(o=i.row,a=i.col,i=i.sheetArea,t=t.formatter||t._autoFormatter,r=r||{},d)&&n!==I&&n!==A)if(u=void 0,t&&t.isAuto)u=typeof n==mt,s=k.Kf(n),!u&&s&&(n=V.Jf(n)),n=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(n).format(n):n;else if(t=typeof t!=g||k.St(t)?t:new d(t))try{n instanceof Date?((c=B&&B.Convert.r0(n))&&(n=c),f=h.Common.CultureManager.Fe().DateTimeFormat,l=h.Common.ct.o0(n),t=!Y.a0(t.formatString(),["d","y"])&&0<=l&&l<1?new d(f.longTimePattern):0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?new d(f.shortDatePattern):new d(f.shortDatePattern+" "+f.longTimePattern),e.u0=!0,n=t.format(n),r.formatter=t):typeof n==mt&&(n=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(n).format(n):V.Ge(n.toString()))}catch(t){n=e.getText(o,a,i)}else n=0===n?"0":e.getText(o,a,i);return n=n!==I&&n!==A?k.j(n):n},k.s0=function(t,n,e,i){var e,i,r,o,a,u;if(e&&(e=i||{},d)&&n!==I&&n!==A)if(i=void 0,t&&t.isAuto)i=typeof n==mt,r=k.Kf(n),!i&&r&&(n=V.Jf(n)),n=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(n).format(n):n;else if(t)try{n instanceof Date?(typeof t!=g||k.St(t)||(t=new d(t)),(o=B&&B.Convert.r0(n))&&(n=o),a=h.Common.CultureManager.Fe().DateTimeFormat,u=h.Common.ct.o0(n),n=(t=!Y.a0(t.formatString(),["d","y"])&&0<=u&&u<1?new d(a.longTimePattern):0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?new d(a.shortDatePattern):new d(a.shortDatePattern+" "+a.longTimePattern)).format(n),e.formatter=t):typeof n==mt&&(n=V.Ge(n.toString()))}catch(t){}return n=n!==I&&n!==A?k.j(n):n},k.c0=function(t,n,e,i){return!T(t)&&"string"==typeof t&&!!(n||-1===f.FormulaPrefix.indexOf(t)&&0<t.length&&-1!==f.FormulaPrefix.indexOf(t[0])&&e&&!i)},k.f0=function(t,n,e){var i,r,r,i="";if(t)if((r=t.getFormulaInformation(n,e,3))&&r.hasFormula){if(i="="+r.formulaWithCulture,r.isDynamicArray)return""}else{if(r=t.getValue(n,e),T(r))return r;i=k.s0(t.getFormatter(n,e)||t.l0(n,e,"_autoFormatter"),r,t)||""}return i},k.h0=function(t,n){var e,n,i,r,e=t,n=h.Common.CultureManager.Fe(n).NumberFormat,i;return!!(n&&n.percentSymbol&&t)&&"object"!=typeof(e="object"==typeof t&&t.formatCached?t.formatCached:e)&&"string"==typeof e&&0<(r=V.v0(e)).d0},k.m0=function(t){var n,e,t,n=k.Tt.msie||k.Tt.edge,e=n&&l.MSPointerEvent&&1<(navigator.msMaxTouchPoints||0);return t?e:(t=n&&l.PointerEvent&&1<(navigator.maxTouchPoints||0),e||t)},k.wt=function(t){return t&&t.richText&&0<t.richText.length?(t=t.text?t:k.g0(t)).text:t},k.g0=function(t){var n,e,i;if(t&&(n=t.richText)&&0<n.length){for(e=[],i=0;i<n.length;i++)e.push(n[i].text||"");t.text=e.join("")}return t},k.St=function(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))},k.p0=function(t,n,o,a){var u,s,t,u=t,s=n,t=function(t,n){var e,i,r,e=this;return e.hasOwnProperty("_ps")||(e._ps={}),i=e._ps,0===arguments.length?i[u]!==A?i[u]:s:(!1!==n&&a&&!a.call(e,t)||(r=i[u]!==A?i[u]:s)!==t&&(i[u]=t,!1!==n)&&o&&o.call(e,t,r),e)};return t.isDefault=function(t){return t===s},t},k.b0=function(t,n){var e={_ps:{}};return h.Common.lt.y0(t,function(t){cn(e,t,n)}),e},k.w0=function(t,n,e,i,r,o,a){for(var u,s,c,f,u=N(n,e),s=m(n,e),c=0,f=u;f<s&&(c+=i?o?t.getRowHeight(f,3):t.Gt(f,3,a):o?t.getColumnWidth(f,3):t.nn(f,3,a),!(r&&r<c));f++);return c},k.M0=function(t,n,e,i,r){for(var o,a,u,s,c,o=N(n,e),a=m(n,e),u=0,s=o;s<a&&(i?(c=t.C0(s),t.getViewportTopRow(c)<=s&&t.getViewportBottomRow(c)>=s&&(u+=t.Gt(s,3))):(c=t.S0(s),t.getViewportLeftColumn(c)<=s&&t.getViewportRightColumn(c)>=s&&(u+=t.nn(s,3))),!(r&&r<u));s++);return u},k.T0=function(t,n){var e,i,t,n,e=0,i=0;return t!==n&&(t=C(t).offset(),n=C(n).offset(),e=t.left-n.left,i=t.top-n.top),{A0:i,I0:e}},k.x0=function(t,n,e,i){var r,o,a,u,s,r=i||{};if(!t||"string"!=typeof t)return r.message=J().Exp_SheetNameInvalid,!1;for(a=0;a<t.length;a++)if("*"===(o=t.charAt(a))||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return r.message=J().Exp_SheetNameInvalid,!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return r.message=J().Exp_SheetNameInvalid,!1;if(n)for(u=n.length,a=0;a<u;a++)if(e!==(s=n[a])&&t.toUpperCase()===s.name().toUpperCase())return r.message=J().Exp_SheetNameConflict,!1;return!0},k.yi=function(t,n,e){var i,r,o;if(!t)return t;for(i=0,r=t.length,o=[];i<r;)t[i]===n?o[i]=e:o[i]=t[i],i++;return o.join("")},k.N0=function(){var t,n,e,i,t=k;return t.k0||(i="-10000px",(e=(n=un("span")).style).visibility="hidden",e.top=i,e.left=i,e.position="absolute",n.setAttribute("gcUIElement","gcStringWidthSpan"),v.body.insertBefore(n,I),t.k0=n),t.k0},k.vt=function(t,n,e){var i,r,o,o,i,i=k,r=i.D0;if(!n)if(r){if(o=(r=e?r.CJKFontCache:r)[t])return o}else r=i.D0={CJKFontCache:{}},e&&(r=r.CJKFontCache);return(o=i.N0()).style.font=k.yt(t),k.Tt&&k.Tt.safari&&(o.style.lineHeight="normal"),o.innerHTML=e?String.fromCharCode(20013):"H",i=(i=o.offsetHeight)||yn(t,o.innerHTML),n||(r[t]=i),i},k._0=function(t){var n,e,i,n,n=k,e=n.E0;if(e){if(e[t])return e[t]}else e=n.E0={};return(n=n.N0()).style.font=t,n.innerHTML="H",(i={}).fontFamily=n.style.fontFamily,i.fontSize=n.style.fontSize,i.fontStyle=n.style.fontStyle,i.fontWeight=n.style.fontWeight,e[t]=i},k.bi=function(t,n){var e,i,e=k.N0();return e.style.font=k.yt(n),k.Tt&&k.Tt.safari&&(e.style.lineHeight="normal"),e.innerHTML=W.j0(t||"H"),i=(i=e.offsetHeight)||yn(n,e.innerHTML)},k.O0=function(t){var n,e,n,n=k;return 0<=t.indexOf(f.FallbackFontFamily)?t:(t=t.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(n=(e=n.N0()).style).font=t,n.fontFamily=[].concat(n.fontFamily.split(","),f.FallbackFontFamily.split(",")).join(","),n.font)},k.yt=function(t){var n,e,i,n=k;return t&&n.R0?(i=(e=(e=n.B0)||(n.B0={}))[t])||(e[t]=n.O0(t)):t},k.bt=function(t,n,e){void 0===e&&(e=!1),n&&(n=k.yt(n),t.font===n&&!0!==e||(t.font=n))},k.Mt=function(t,n,e){return!n||T(e)?0:(k.bt(t,n),t.measureText(e).width)},k.L0=function(){var t,n,t=k,n=t.k0;n&&(C(n).remove(),t.k0=A),t.D0=A,t.E0=A,k.F0&&(k.F0=A),t.B0=A},k.oi=function(t){var n,t,n=k.F0;return n=n||(k.F0=un("div")),t=t.innerHTML,n.innerHTML=t,n.innerText},k.P0=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)},k.G0=function(t){t&&(t.U0(!0),t.initExpression(),t.H0())},k.z0=function(t){var n,e,i,r,o,n=0,e=0,i=t.length;for(0<i&&(n=t[0].row,e=t[0].col),r=1;r<i;r++)n>(o=t[r]).row&&(n=o.row),e>o.col&&(e=o.col);return{r:n=n<0?0:n,c:e=e<0?0:e}},k.V0=function(t){var t,t=typeof t==g&&"/"===t.charAt(0)?k.a2e(t):t;return t},k.a2e=function(t){var n,n,n=wt.test(t)?(n=t.match(wt),h.Common.ct.Y0(ct(n[1]))):bt.test(t)?(n=t.match(bt),new Date(ct(n[1]))):t;return n},k.Z0=function(t){var t,t=!T(t)&&h.Common.ct.W0(t)?h.Common.ct.Q0(t):t;return t},k.K0=function(t,n){for(var e,i,r,o,e=t.getImageData(n.x,n.y,n.width,n.height),i=e.data,r=0;r<i.length-4;r+=4)o=nt((30*i[r]+59*i[r+1]+11*i[r+2]+50)/100),i[r]=o,i[r+1]=o,i[r+2]=o;t.putImageData(e,n.x,n.y)},k.J0=function(t,n,e){t.rowCount>n&&(t.rowCount=n),t.colCount>e&&(t.colCount=e)},k.X0=function(t,n,e,i){for(var r=e;r<e+i;r++)if(!T(t.getValue(n,r)))return!0;return!1},k.q0=function(t,n,e,i){for(var r=n;r<n+i;r++)if(!T(t.getValue(r,e)))return!0},k.$0=function(t){return!t||""===t},k.qi=function(t){if(k.$0(t))return 0;for(var n=0,e=0;e<t.length&&isNaN(parseInt(t[e],10));)e++;return(n=e<t.length?parseInt(t.substring(e),10):n)-1},k.$i=function(t){for(var n,e,i,r,o,n=0,e=t.length,i=0;i<e&&!(25<(o=(r=t[i].charCodeAt())-97))&&!((o=o<0?r-65:o)<0);i++)n=26*n+o+1;return--n},k.t1=function(t){var t=""+t;return"="===t.charAt(0)?t.substr(1):t},k.getFormulaString=function(t){return"string"==typeof t?(t="="===t[0]?t.substr(1):t,K(t)):t},k.vo=function(t,n){return!T(t)&&(n=n||/(&)|(<)|(>)|(")|(')/g).test(t)?typeof t==g?t.replace(n,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):""+t:t},k.Nfe=function(t,n){return(n=void 0!==n&&n)?t&&t.replace(/\%/g,"%25").replace(/\ /g,"%20").replace(/\#/g,"%23").replace(/\[/g,"%5b").replace(/\]/g,"%5d").replace(/\^/g,"%5e").replace(/\`/g,"%60").replace(/\{/g,"%7b").replace(/\}/g,"%7d").replace(/\&/g,"&amp;").replace(/\"/g,"&quot;"):t&&t.replace(/\&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;")},k.kfe=function(t,n){return(n=void 0!==n&&n)?t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/%20/g," ").replace(/%23/g,"#").replace(/%5[bB]/g,"[").replace(/%5[cC]/g,"\\").replace(/%5[dD]/g,"]").replace(/%5[eE]/g,"^").replace(/%60/g,"`").replace(/%7[bB]/g,"{").replace(/%7[dD]/g,"}").replace(/%25/g,"%"):t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<")},k.n1=function(t){var n,e;return T(t)?t:!(n=typeof t==g)||-1===t.indexOf("&")?""+t:(e=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,(t=-1!==t.indexOf("&#")?t.replace(It,vn(10)).replace(xt,vn(16)):t).replace(e,function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))},k.e1=function(t,n,e){var i,r;if(t&&typeof t==g)for(i=0;i<e.length;i++)if((r=e[i])!==n&&(-1<t.indexOf(r+"!")||-1<t.indexOf("'"+r+"'!")))return!0;return!1},k.i1=function(t){var n,e,n;return"string"==typeof t&&(n=t.indexOf("/OADate(")+1,e=t.indexOf(")"),0!==n)&&n<e&&(n=parseFloat(t.substring(n+7,e)),isNaN(n)||(t=""+n)),t},k.r1=function(t){var n,e,i;if(!t)return null;if(n=-1!==(n=t).indexOf(e=",")?n.split(",")[0]:n){for(i=n.length-1;0<=i&&"/"!==n[i];)i--;'"'===(n=(n=0<=i?n.substring(i):n)&&"/#"===n.substring(0,2)?n.substring(2):n)[0]&&'"'===n[n.length-1]&&(n=n.substring(1,n.length-1))}return n},k.o1=function(t,n){for(var e,i,r,o,a,o,e=n.split("&"),i=0,r=e.length;i<r;i++){if(a=(o=e[i].split("."))[0],o=o[1],!t)return;t=k.xr(t,a,o)}return t},k.Hue=function(t,n){var e,i,r;if(t&&t.c_){for(i=t.c_,r=0;r<i.length&&!(e=k.xr(i[r],n));r++);return e}},k.xr=function(t,n,e){var i,r,o,a;if(!t||!t.c_)return A;for(e=e?+e:0,r=0,o=(i=t.c_).length;r<o;r++)if((a=i[r])&&a.n_===n){if(0===e)return a;e--}},k.u1=function(t,n){var e,i;if(t)for(e=t.c_||[],i=0;i<e.length;i++)if(e[i][n])return e[i][n]},k.s1=function(t,n){var e,i,r,o,o;if(!t||!t.c_)return A;for(i=0,r=(e=t.c_).length;i<r;i++){if((o=e[i])&&o.n_===n)return o;if(o=k.s1(o,n),!T(o))return o}},k.c1=function(t){return t&&t.c_?t.c_[0]:A},k.go=function(t,n){var e,i,r,o,a;if(!t||!t.c_)return A;for(i=[],r=0,o=(e=t.c_).length;r<o;r++)(a=e[r])&&a.n_===n&&i.push(a);return i},k.Pr=function(t,n){var e,i,r,o,o;if(t&&t.c_){for(e=[],i=0,r=n.length;i<r;i++)o=n[i],(o=k.go(t,o))&&0<o.length&&(e=e.concat(o));t.c_=e}},k.f1=function(t,n,e){var i,r,o;if(t&&n)for(e=e||n.name,i=0,r=t.length;i<r;i++)(o=t[i])&&o.n_===e&&(t[i]=n)},k.l1=function(){var t;return("{"+dn(8)+"-"+dn(4)+"-"+dn(4)+"-"+dn(4)+"-"+dn(12)+"}").toUpperCase()},k.h1=function(t,n,e){if(t)return mn(t)?gn(t,n,e):wn(t,e)},k.d1=function(t,n){var n;if(t)return"1"===t.auto?"#000000":t.theme!==A?pn(t,n):t.rgb?"#"+(n="number"==typeof(n=t.rgb)?n.toString(16):n).substring(2,n.length):t.indexed!==A?bn(t):void 0},k.hueToRGB=function(t,n,e){return e<0&&(e+=255),255<e&&(e-=255),e<42?t+((n-t)*e+21)/42:e<127?n:e<170?t+((n-t)*(170-e)+21)/42:t},k.v1=function(t,n,e){var i,r,o,a,n,i=0,r=0,o=0;return o=0===e?r=i=255*n/255|0:(a=void 0,n=2*n-(a=n<=127?(n*(255+e)+127)/255:n+e-(n*e+127)/255),i=parseInt(((255*k.hueToRGB(n,a,t+85)+127)/255).toString(),10),r=parseInt(((255*k.hueToRGB(n,a,t)+127)/255).toString(),10),parseInt(((255*k.hueToRGB(n,a,t-85)+127)/255).toString(),10)),{r:i=(i=0<i?i:0)<255?i:255,g:r=(r=0<r?r:0)<255?r:255,b:o=255<(o=0<o?o:0)?o:255,a:0}},k.m1=function(t){var t=Tt[t];if(t!==A)return At.hexToARGB(t)},k.g1=function(t){if(!Z(t))return"="===t[0]?t:"="+t},k.p1=function(t){return Z(t)||t.length<=2?t:t.substr(1,t.length-2)},k.b1=function(t){if(!T(t))return"="===t[0]?t.substring(1,t.length):t},k.w1=function(t,n){if(t&&n)for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},k.C1=function(t){var n,e,i,r;if("string"==typeof t){if(n=/\[[^\]]+\]|@/,(e=t.split(/\'|\"/g))&&0<e.length)for(i=0;i<e.length;i++)if(r=e[i],i%2==0&&r.match(n))return!0;return!1}},k.S1=function(t,n){var e,i,r,n,o,t,e=n.row,i=n.col,r=n.rowCount,n=n.colCount,o=t.getRowCount(),t=t.getColumnCount();return-1===e&&(e=0,r=o),-1===i&&(i=0,n=t),On(e,i,r=o<e+r?o-e:r,n=t<i+n?t-i:n)},k.isInfinityNumberString=function(t){return"string"==typeof t&&(parseFloat(t)===Number.POSITIVE_INFINITY||parseFloat(t)===Number.NEGATIVE_INFINITY)},k.repeatString=function(t,n){var e="";if(!(!t||n<1||n>Number.POSITIVE_INFINITY))for(;n%2&&(e+=t),(n=Math.floor(n/2))&&(t+=t),n;);return e},k.toPlainString=function(t){var n,e;return(""+t).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(t,n,e,i,r){return+r<0?n+"0."+k.repeatString("0",1-+r-e.length-1)+e+i:n+e+i+k.repeatString("0",+r-i.length)})},k.jse=function(t){var n=document.createElement("div");return n.innerHTML=t.trim(),n.firstChild},k.rfe=function(t,n){var e,i,r,o;if(t===I||n===I||"object"!=typeof t||"object"!=typeof n)return t===n;if(e=Object.keys(t),i=Object.keys(n),e.length!==i.length)return!1;for(r=0;r<e.length;r++)if(o=e[r],!k.rfe(t[o],n[o]))return!1;return!0},k.bme=function(t,n){for(var e,i,r,o,a,u,e=n.row,i=n.col,r=n.rowCount,o=n.colCount,a=e;a<e+r;a++)for(u=i;u<i+o;u++)if(t.getCell(a,u).locked())return!0;return!1},k.wme=function(t){for(var n,e,i,r,o,a,i,u,n=t.getSelections(),e=0;e<n.length;e++)if(r=-1===(i=n[e]).col?0:i.col,o=-1===i.row?0:i.row,a=-1===i.col?t.getColumnCount():i.colCount,i=-1===i.row?t.getRowCount():i.rowCount,u=k.bme(t,{col:r,row:o,colCount:a,rowCount:i}))return!0;return!1},k.ige=function(t){return 4<t?t=4:t<.25&&(t=.25),this.mge(t)},k.mge=function(t,n){return void 0===n&&(n=12),+parseFloat(t.toPrecision(n))},k.isEnablePasteSpecial=function(t){return!!t&&!t.NMi&&!(!t.ST()._S||t.ST().ES||t.isPasteShapes&&t.isPasteShapes()||t.isPasteFloatingObject&&t.isPasteFloatingObject())},k.sTe=function(t){var n=[];return t.shapeLayers&&t.shapeLayers[0]&&t.shapeLayers[0].shapes.forEach(function(t){t.isSelected&&n.push(t.JVV.name())}),n},k.cTe=function(t){var n=[];return t.WL&&t.WL.QP().forEach(function(t){t.isSelected()&&n.push(t.name())}),n},k.Zf=/[\u0600-\u06FF\u0750-\u077F]/,k.vi=ln,k.pi=k.device,k.Tt=(t=Mn(L=navigator.userAgent),n={version:A,chrome:A,webkit:A,safari:A,mozilla:A,msie:A,metroMode:A,edge:A},t.browser&&(n[t.browser]=!0,n.version=t.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),(rn=0<=L.indexOf("PhantomJS"))&&(n.safari=!1,n.chrome=!0),(on=(t=L.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(t)!==I)&&(n.mozilla=A,n.msie=!0),(t=/Edge\/\d+/.exec(L))!==I&&0<t.length&&(n.webkit=A,n.chrome=A,n.msie=!0,n.edge=!0,n.version=t[0].substr(t[0].indexOf("/")+1)),n.msie&&Cn()&&(n.metroMode=!0),n),k.browser=k.Tt,k.En=un,k.T1=an,k.pt=hn,k.R0=k.Qf(),k.Ct=function(t){return!T(t)&&(typeof t==mt||typeof t==X||t instanceof Date||B&&t instanceof B.CalcError)},w=k,f.util=w,f.mt=w,y=w.Mt,Sn.A1=function(t){return!(Sn.ai()!==t||!t.rt||!t.rt.I1)},Sn.ai=function(){return l&&l.gcGlobal&&l.gcGlobal.activeElement},Sn.N1=function(i){var r,o,a,t,n,t,e,u,s,c,f;function l(t){for(var n,e,n=0;n<=2;n++)(e=t.call(r,n))&&0!==e.width&&0!==e.height&&(i.k1=!0,o.D1(a,e))}if(i&&!Sn.A1(i)&&i.parent&&i.parent.options.hideSelection)if(r=i.Fi(),o=i.Dn,a=o.J(),n=(t=i._1)&&t.isEnable(S.RowColumnStates.selected,!0),t=t&&t.isEnable(S.RowColumnStates.selected,!1),e=i.getSelections(),s=u=void 0,n||t){for(c=void 0,u=0;u<e.length;u++)f=e[u],c=c?c.union(f):f;c&&o.E1(c)}else{for(u=0;u<e.length;u++)f=e[u],0<=(s=i.j1(f)).width&&0<=s.height&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,o.O1(s));s=r.R1(),i.k1=!0,o.D1(a,s),l(r.B1),l(r.L1)}},Sn.F1=function(t,n){var e=Sn.ai();(l.gcGlobal.activeElement=t)===e||n||(e&&(e.endEdit(),Sn.N1(e),e.G1)&&e.G1(),t&&t.Dn.E1())},Ot=Sn,f.hi=Ot,e.prototype.U1=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",n="span."+t.split(" ").join(".");return s.H1?C(v).find(n).length<=0&&sn(s.H1):s.H1=Tn(t),s.H1},e.prototype.z1=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",n="span."+t.split(" ").join(".");return s.V1?C(v).find(n).length<=0&&sn(s.V1):s.V1=Tn(t),s.V1},e.prototype.Y1=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",n="span."+t.split(" ").join(".");return s.Z1?C(v).find(n).length<=0&&sn(s.Z1):s.Z1=Tn(t),s.Z1},e.prototype.W1=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",n="span."+t.split(" ").join(".");return s.K1?C(v).find(n).length<=0&&sn(s.K1):s.K1=Tn(t),s.K1},e.prototype.J1=function(){var t="gc-theme-version",n="gcDummyElement";return s.X1?C(v).find("#"+n).length<=0&&sn(s.X1):s.X1=Tn(t,n),s.X1},e.prototype.nl=function(){s.U1(),s.z1(),s.Y1(),s.W1()},e.prototype.Hc=function(){var r,t,o;function a(t,n){for(var e,i,e=!1,i=t;i;){if("gcSpread"===C(i).attr("gcUIElement")){e=n.qc()!==i;break}i=i.parentElement}return e}function e(t){var n,e,i,i,n=Ot.ai();if(n&&(e=s.el(t.target),i=n.il&&n.il.rl,r.wf.forEach(function(t){t&&t(n,e)}),!e||a(e,n)))if(n.ol(A,A,i))o&&(i=n.rt)&&i.al&&i.al(),Ot.F1(I);else if(t.cancelable)return!1}function n(t){var n=t.pointerType;n!==t[pt]&&n!==gt||e(t)}(r=this).vf=0,An(l,"keydown",xn,!0),An(l,"keyup",Nn,!0),An(l,"compositionstart",kn,!0),An(l,"selectstart",Dn,!0),t=w.pi(),o=t.ipad||t.iphone,w.browser.safari&&!o&&An(l,"textInput",_n,!0),w.m0()?(C(v).bind("MSPointerDown",n),C(v).bind("pointerdown",n)):C(v).bind("touchstart",e),An(v,"mousedown",function(t){var n;!1===e(t)&&ln(t)},!0),C(v).bind("DOMContentLoaded",function(){s.nl()})},e.prototype.el=function(t){for(var n,e,n=t;n&&"BODY"!==n.tagName&&typeof n.getAttribute==tt;){if(e=(e=n.getAttribute("gcUIElement"))||n.gcUIElement)return n;n=n.parentNode}return I},e.prototype.ul=function(t,n){var e,t,i,r,o,a,t,e=s.U1();return t===S.VisualState.highlight||t===S.VisualState.selected?e=s.W1():t===S.VisualState.hover&&(e=s.Y1()),t=e.className,C(e).removeClass(t).addClass(n),o=(i=In(e)).backgroundColor,a=i.backgroundImage,C(e).addClass(t),(t={backgroundColor:(i=In(e)).backgroundColor,backgroundImage:i.backgroundImage,color:i.color,zIndex:i.zIndex}).borderLeftColor=i.borderLeftColor,t.borderRightColor=i.borderRightColor,t.borderBottomColor=i.borderBottomColor,t.borderBottomWidth=i.borderBottomWidth,t.borderTopColor=i.borderTopColor,t.borderRightWidth=i.borderRightWidth,t.backgroundImage===a&&t.backgroundColor!==o&&(t.backgroundImage=A),C(e).removeClass(n),t},e.prototype.sl=function(t){var n,t,n=s.J1();return C(n).removeClass(n.className).addClass("gc-theme-version "+t),t=In(n),U({},t)},e.prototype.cl=function(t){var n,t,n=s.z1();return C(n).removeClass(n.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),t=In(n),U({},t)},e.prototype.ef=function(){var t;l.gcGlobal.vf++},e.prototype.cf=function(){var t=l.gcGlobal;t.vf--,t.vf<0&&(t.vf=0)},s=e.prototype,l.gcGlobal||(l.gcGlobal=new e),r.Ee=function(t){var n;return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},r.He=function(t,n){var e=r.Ee(t)+n,i=r.styleCache;return i[e]||(i[e]=s.ul(t,n)),i[e]},r.fl=function(t){var n=t,e=r.styleCache;return e[n]||(e[n]=s.sl(t)),e[n]},r.ll=function(t){var n="content"+t,e=r.styleCache;return e[n]||(e[n]=s.cl(t)),e[n]},r.m=function(t,n){var t=t.hl;return n=t&&t.getColor?t.getColor(n):n},r.dl=function(){r.styleCache={}},r.styleCache={},Rt=r,f.I=Rt,jn.prototype.clone=function(){return new jn(this.x,this.y)},f.Point=jn,p.prototype.intersect=function(t,n,e,i){var r=this;return t<r.x+r.width&&r.x<t+e&&n<r.y+r.height&&r.y<n+i},p.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},p.prototype.contains=function(t,n,e){var i=this;return e?i.x<=t&&t<=i.x+i.width&&i.y<=n&&n<=i.y+i.height:i.x<t&&t<i.x+i.width&&i.y<n&&n<i.y+i.height},p.prototype.containsRect=function(t,n){return this.contains(t.x,t.y,n)&&this.contains(t.x+t.width,t.y+t.height,n)},p.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},p.prototype.getIntersect=function(t,n,e,i){var r=this,o=r.x,a=r.y,u=r.x+r.width,r=r.y+r.height,s,c=n,e=t+e,n=n+i,i=m(o,t),o=m(a,c),f,l,h,d,t=N(u,e)-i,a=N(r,n)-o;return 0<t&&0<a?new p(i,o,t,a):I},p.prototype.round=function(){var t=this;t.x=nt(t.x),t.y=nt(t.y),t.width=x(t.width),t.height=x(t.height)},p.prototype.clone=function(){var t=this;return new p(t.x,t.y,t.width,t.height)},f.Rect=p,M.prototype.intersect=function(t,n,e,i){var r=this;return(-1===t||-1===r.row||r.row<t+e&&t<r.row+r.rowCount)&&(-1===n||-1===r.col||r.col<n+i&&n<r.col+r.colCount)},M.prototype.getIntersect=function(t,n,e){var i,r,e,o,n,a,r,e,i,u,s,i=this;return t&&i.intersect(t.row,t.col,t.rowCount,t.colCount)?(r=-1===i.col?e-1:i.col+i.colCount-1,e=-1===t.col?e-1:t.col+t.colCount-1,o=-1===i.row?n-1:i.row+i.rowCount-1,n=-1===t.row?n-1:t.row+t.rowCount-1,a=m(i.col,t.col),r=N(r,e),e=m(i.row,t.row),i=N(o,n),new M(e,a,u=-1===e?-1:i-e+1,s=-1===a?-1:r-a+1)):I},M.prototype.contains=function(t,n,e,i){var r=this,o=arguments.length,a=!1;return 2!==o&&4!==o||(2===o&&(i=e=1),a=(-1===r.row||r.row<=t&&t+e<=r.row+r.rowCount)&&(-1===r.col||r.col<=n&&n+i<=r.col+r.colCount)),a},M.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},M.prototype.offset=function(t,n){var e,i,r,e=this,i=e.col,r=e.row;return-1!==i&&(i+=t),-1!==r&&(r+=n),new M(r,i,e.rowCount,e.colCount)},M.prototype.union=function(t){return En(this,t)},M.prototype.equals=function(t){var n=this;return t instanceof M&&n.row===t.row&&n.col===t.col&&n.rowCount===t.rowCount&&n.colCount===t.colCount},M.prototype.toJSON=function(){var t=this;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}},M.prototype.fromJSON=function(t){var n=this;t&&(n.row=t.row,n.col=t.col,n.rowCount=t.rowCount,n.colCount=t.colCount)},Bt=M,f.Range=Bt,f.Ec=On,f.getUnionRange=En,Rn.vl=function(t,n){if(t&&n){var t=t.currentTheme();if(t)return t.getColor(n)}return n},Rn.ml=function(t,n){var t;return t&&n?(t=t.currentTheme())?t.getFont(n):n:I},f.Pf=Rn,i.ValidationError="ValidationError",i.CellClick="CellClick",i.CellDoubleClick="CellDoubleClick",i.ColumnChanging="ColumnChanging",i.RowChanging="RowChanging",i.EnterCell="EnterCell",i.LeaveCell="LeaveCell",i.ValueChanged="ValueChanged",i.TopRowChanged="TopRowChanged",i.SheetChanging="SheetChanging",i.SheetChanged="SheetChanged",i.PivotTableChanged="PivotTableChanged",i.LeftColumnChanged="LeftColumnChanged",i.InvalidOperation="InvalidOperation",i.RangeFiltering="RangeFiltering",i.RangeFiltered="RangeFiltered",i.RangeFilterClearing="RangeFilterClearing",i.TableFilterClearing="TableFilterClearing",i.RangeFilterCleared="RangeFilterCleared",i.TableFilterCleared="TableFilterCleared",i.TableFiltering="TableFiltering",i.TableFiltered="TableFiltered",i.RangeSorting="RangeSorting",i.RangeSorted="RangeSorted",i.ClipboardChanging="ClipboardChanging",i.ClipboardChanged="ClipboardChanged",i.ClipboardPasting="ClipboardPasting",i.ClipboardPasted="ClipboardPasted",i.ColumnWidthChanging="ColumnWidthChanging",i.ColumnWidthChanged="ColumnWidthChanged",i.RowHeightChanging="RowHeightChanging",i.RowHeightChanged="RowHeightChanged",i.DragDropBlock="DragDropBlock",i.DragDropBlockCompleted="DragDropBlockCompleted",i.DragFillBlock="DragFillBlock",i.DragFillBlockCompleted="DragFillBlockCompleted",i.EditStarting="EditStarting",i.EditStarted="EditStarted",i.EditChange="EditChange",i.EditEnding="EditEnding",i.EditEnd="EditEnd",i.EditEnded="EditEnded",i.RangeGroupStateChanging="RangeGroupStateChanging",i.RangeGroupStateChanged="RangeGroupStateChanged",i.InternalSelectionChanging="InternalSelectionChanging",i.SelectionChanging="SelectionChanging",i.SelectionChanged="SelectionChanged",i.SheetTabClick="SheetTabClick",i.SheetTabDoubleClick="SheetTabDoubleClick",i.SheetNameChanging="SheetNameChanging",i.SheetNameChanged="SheetNameChanged",i.ViewZooming="ViewZooming",i.ViewZoomed="ViewZoomed",i.UserZooming="UserZooming",i.UserFormulaEntered="UserFormulaEntered",i.CellChanged="CellChanged",i.ColumnChanged="ColumnChanged",i.RowChanged="RowChanged",i.ActiveSheetChanging="ActiveSheetChanging",i.ActiveSheetChanged="ActiveSheetChanged",i.SparklineChanged="SparklineChanged",i.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",i.RangeChanged="RangeChanged",i.ButtonClicked="ButtonClicked",i.EditorStatusChanged="EditorStatusChanged",i.FloatingObjectChanged="FloatingObjectChanged",i.DrawingElementZIndexChanged="DrawingElementZIndexChanged",i.ProgressChanged="ProgressChanged",i.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",i.ShapeChanged="ShapeChanged",i.ShapeSelectionChanged="ShapeSelectionChanged",i.FormControlButtonClicked="FormControlButtonClicked",i.FormControlValueChanged="FormControlValueChanged",i.PictureChanged="PictureChanged",i.FloatingObjectRemoving="FloatingObjectRemoving",i.ShapeRemoving="ShapeRemoving",i.FloatingObjectRemoved="FloatingObjectRemoved",i.ShapeRemoved="ShapeRemoved",i.PictureSelectionChanged="PictureSelectionChanged",i.FloatingObjectLoaded="FloatingObjectLoaded",i.TouchToolStripOpening="TouchToolStripOpening",i.CommentChanged="CommentChanged",i.CommentRemoving="CommentRemoving",i.CommentRemoved="CommentRemoved",i.SlicerChanged="SlicerChanged",i.BeforeDragDrop="BeforeDragDrop",i.ActiveSheetChangingInternal="ActiveSheetChangingInternal",i.ActiveSheetChangedInternal="ActiveSheetChangedInternal",i.EnterCellInternal="EnterCellInternal",i.SheetOptionsChangedInternal="SheetOptionsChangedInternal",i.WorkbookOptionsChangedInternal="WorkbookOptionsChangedInternal",i.RangeChangedInternal="RangeChangedInternal",i.CustomNameChangedInternal="CustomNameChangedInternal",i.FormulaTextboxEditStarted="FormulaTextboxEditStarted",i.FormulaTextboxEditEnded="FormulaTextboxEditEnded",i.SheetMoving="SheetMoving",i.SheetMoved="SheetMoved",i.DragMerging="DragMerging",i.DragMerged="DragMerged",i.ChartClicked="ChartClicked",i.FloatingElementSelected="FloatingElementSelected",i.BeforePrint="BeforePrint",i.TableResizing="TableResizing",i.TableResized="TableResized",i.TableRowsChanged="TableRowsChanged",i.TableColumnsChanged="TableColumnsChanged",i.DropdownSpreadMouseClick="DropdownSpreadMouseClick",i.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",i.PasteEnd="PasteEnd",i.WorkbookUndo="WorkbookUndo",i.WorkbookRedo="WorkbookRedo",i.SheetTabAllSheetsListContextMenuOpening="SheetTabAllSheetsListContextMenuOpening",i.SheetTabAllSheetsListContextMenuOpened="SheetTabAllSheetsListContextMenuOpened",i.ReportSheetAddRecord="ReportSheetAddRecord",i.ReportSheetDeleteRecord="ReportSheetDeleteRecord",i.ActiveCellChanged="ActiveCellChanged",i.WorksheetDataChanged="WorksheetDataChanged",i.ReportSheetModeChanged="ReportSheetModeChanged",i.ReportPaginationSettingChanged="ReportPaginationSettingChanged",i.ReportPaginationPageChanged="ReportPaginationPageChanged",i.DataFetchCompleted="DataFetchCompleted",f.Events=i,o.prototype.L0=function(){this.Mf=I},o.prototype.gl=function(t,n,e){var i,t,n,i=this.pl,t=t<<4+n;return i?((n=i[t])||(n=e(),i[t]=n),n):e()},o.prototype.yl=function(t,n){var e,e,e=this.wl;return e&&(e=e[t])?e[n]:I},o.prototype.Ml=function(t,n,e,i){var r,o,r=this.wl;r&&(r[t]||(r[t]={}),(o=r[t])[n]={d:e,i:i})},o.prototype.$t=function(t,n,e,i,r){var o,a,u,o=this,a=o.Mf;return u=a.t0(t,n,e=e===A?3:e),T(u)?!T(r)&&w.St(r.formatter)?Ht.Cl(a,r,o.Sl(t,n,e,0),{},{row:t,col:n,sheet:a}):o.Sl(t,n,e,i):u},o.prototype.Sl=function(t,n,e,i){var r,o,r,a,r,a,r=this,o=r.Mf,r=r.Tl;return e===A&&(e=3),r?((a=r[e])||(r[e]=a={}),(r=a[t])||(a[t]=r={}),(a=r[n])===A&&(a=o.$t(t,n,e,i),r[n]=a),a):o.$t(t,n,e,i)},o.prototype.qt=function(t,n,e){var i,r,i,o,i,o,i=this,r=i.Mf,i=i.Al;return e===A&&(e=3),i?((o=i[e])||(i[e]=o={}),(i=o[t])||(o[t]=i={}),(o=i[n])||(o=r.Il(t,n,e,!1,!0),i[n]=o),o.clone(!0)):r.Il(t,n,e,!1,!1)},o.prototype.o2e=function(t,n,e){var i,r,i,o,i,o,i=this,r=i.Mf,i=i.Al;return e===A&&(e=3),i?((o=i[e])||(i[e]=o={}),(i=o[t])||(o[t]=i={}),(o=i[n])||(o=r.o2e(t,n,e,!1,!0),i[n]=o),o.clone(!0)):r.o2e(t,n,e,!1,!1)},o.prototype.Gt=function(t,n){var e,i,e,r,e;return void 0===n&&(n=S.SheetArea.viewport),i=(e=this).Mf,(e=e.xl)?(e=(r=(r=e[n])===A?e[n]={}:r)[t])===A?r[t]=i.Gt(t,n):e:i.Gt(t,n)},o.prototype.Kt=function(t,n){var e,i,e,r,e;return void 0===n&&(n=S.SheetArea.viewport),i=(e=this).Mf,(e=e.Nl)?(e=(r=(r=e[n])===A?e[n]={}:r)[t])===A?r[t]=i.nn(t,n):e:i.nn(t,n)},o.prototype.kl=function(t){var n=this;return n.Tl?(n.Dl||(n.Dl=t()),n.Dl):t()},o.prototype._l=function(t){var n=this;return n.Tl?(n.El||(n.El=t()),n.El):t()},o.prototype.jl=function(){var t=this;t.Ol=!0,t.pl={},t.wl={},t.Tl={},t.Al={},t.xl={},t.Nl={}},o.prototype.Rl=function(){this.Ol=!1},o.prototype.Bl=function(){var t=this;t.Ol=!1,t.pl=I,t.wl=I,t.Tl=I,t.Al=I,t.Nl=I,t.xl=I,t.Dl=I,t.El=I},f.Ff=o,_.Ll=function(t,n,e,i,r){var o,a,u,s;if(_.Fl=!0,(o=t.tables)&&o.Pl(n,e,i-n+1,r-e+1))for(a=-1,u=_.Gl=[],s=0;s<=i;s++)t.getRowVisible(s)?u[s]=++a:u[s]=-1},_.dl=function(){_.Gl=I,_.Fl=!1},_.Ue=function(t){var n=_.Ul;return n[t]||(n[t]=d?new d(t):I),n[t]},_.Re=function(t,n,e){var i,r,i,o,o,a,o,n,i,i=_.Hl,r=t+"_"+typeof t;return d?(i[n]||(i[n]={}),(o=(i=i[n])[r])?(e&&(e.conditionalForeColor=e.value=o.color,e.content=z(o.content)),o.text):((o=_.Ul)[n]||(o[n]=new d(n)),n=(a=o[n]).format(t,o={}),(i=i[r]={}).text=n,i.color=o.conditionalForeColor,i.content=o.content,e&&(e.conditionalForeColor=e.value=o.conditionalForeColor,e.content=z(o.content)),n)):t.toString()},_.Cl=function(t,n,e,i,r){var t,n;return e&&"SparklineExValue"===e.typeName?"":(t=n.cellType||t.$f(),n=n.formatter||n._autoFormatter,t.format(e,n,i,r))},_.zl=function(){_.Ul={},_.Hl={}},_.Fl=!1,_.Ul={},_.Hl={},_.Gl=[],Ht=_,f.Be=Ht,Ln.Vl=function(t,n,e){var i=Fn(t);i.scaleX=n,i.scaleY=e,i.translateX=i.orgTranslateX*n,i.translateY=i.orgTranslateY*e,t.setTransform(i.scaleX,i.skewX,i.skewY,i.scaleY,i.translateX,i.translateY)},Ln.Yl=function(t,n,e){var i=Fn(t);i.orgTranslateX+=n,i.orgTranslateY+=e,i.translateX=i.orgTranslateX*i.scaleX,i.translateY=i.orgTranslateY*i.scaleY,t.setTransform(i.scaleX,i.skewX,i.skewY,i.scaleY,i.translateX,i.translateY)},Ln.d5=function(t){var n=null==t?void 0:t.getContext("2d");n&&(n.clearRect(0,0,t.width,t.height),t.width=1,t.height=1)},f.Lf=L=Ln,Vt=L,D.Zl=function(){var t,n,n,t,e,t=l.screen,n=t.deviceXDPI,n=l.devicePixelRatio||(n?n/t.logicalXDPI:1),t=20*n,e=et(t);return.82<e-t?e/20:et(100*n)/100},D.Wl=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=D;if(Bn(t,1),Pn(t,1),(1!==(r=D.Zl())||1!==i.dpr)&&(i.dpr=r,o=n||e&&e.parent)){for(a=i.Ql,u=void 0,s=0;s<a.length;s++)if(o===a[s].workbook){u=a[s];break}if(u||a.push(u={workbook:o,sheets:[],canvases:[]}),n)u.canvases.push(t);else{for(c=void 0,f=u.sheets,l=0;l<f.length;l++)if(f[l].sheet===e){c=f[l];break}c||f.push(c={sheet:e,canvases:[]}),c.canvases.push(t)}}},D.Kl=function(t){return t&&t.Sf||1},D.Jl=function(t){return t&&t.Tf||1},D.Xl=function(t){return t.Af},D.ql=function(t){return t.If},D.$l=function(t,n,e){var i,r,o,i,a,r,n,i=D,r=i.dpr,o=i.Kl(t),i=i.Jl(t);Gn(t,n),Un(t,e),1===r&&1===o&&1===i?(t.width=n,t.height=e):(a=t.getContext("2d"),Vt.Vl(a,1,1),w.Tt.mozilla?(t.width=x(n*r),t.height=x(e*r)):(t.width=et(n*r),t.height=et(e*r)),t.style.width=n+ht,t.style.height=e+ht,r=t.width/n,n=t.height/e,r===o&&n===i||(Bn(t,r),Pn(t,n)),Vt.Vl(a,r,n))},D.th=function(t,n){for(var e,i,r,o,a,u,s,e=D.Ql,i=t.parent,a=0;a<e.length;a++)if(!i||e[a].workbook===i)for(r=e[a].sheets,u=0;u<r.length;u++)if(r[u].sheet===t){for(o=r[u].canvases,s=0;s<o.length;s++)if(o[s]===n){o.splice(s,1);break}break}},D.nh=function(t,n){for(var e,i,r,o,e=D.Ql,r=0;r<e.length;r++)if(e[r].workbook===t)for(i=e[r].canvases,o=0;o<i.length;o++)if(i[o]===n){i.splice(o,1);break}},D.eh=function(t){for(var n,e,i,r,o,n=D.Ql,e=t.parent,r=0;r<n.length;r++)if(!e||n[r].workbook===e){for(i=n[r].sheets,o=0;o<i.length;o++)i[o].sheet===t&&i.splice(o,1);return}},D.ih=function(t){for(var n,e,n=D.Ql,e=0;e<n.length;e++)if(n[e].workbook===t)return void n.splice(e,1)},D.rh=function(){var t,n,e,i,r,o,a,u,s,c,t=D,n=t.Zl();if(t.dpr!==n)for(e=t.Ql,a=o=r=i=void 0,t.dpr=n,u=0;u<e.length;u++){for(o=(r=e[u]).canvases,i=r.sheets,s=0;s<i.length;s++)o=o.concat(i[s].canvases);for(c=0;c<o.length;c++)a=o[c],t.$l(a,t.Xl(a),t.ql(a))}},D.dpr=1,D.Ql=[],f.Bf=D,f.zt=Hn,f.r2e=O,E.un=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=[];if(t&&0!==t.length&&!isNaN(n)&&(a=r||j())){if(w.bt(a,e),u=w.vt(e),n<=0){for(s=-1,c=!0,f=0;f<t.length;f++)" "===(l=t.charAt(f))||c?" "!==l&&c&&(s=i?u:y(a,a.font,l),c=!1):s=N(s,i?u:y(a,a.font,l));if((n=s)<=0)return[t]}for(h=t.split(/\r\n|\r|\n/),d=0;d<h.length;d++)if(v=Zn(h[d],n,i,u,a))if(0===v.length)o.push("");else for(m=0;m<v.length;m++)o.push(v[m])}return o},E.oh=function(t,n,e,i,r){var o,a,u,s,c,o=[];if(0!==n.length)if(i)o=E.un(n,r,e,!0);else for(a=n.split(/\r\n|\r|\n/),u=0;u<a.length;u++){for(s=[],c=0;c<a[u].length;c++)s.push(a[u][c]);o.push(s)}return o},E.Ht=function(t,n,e,i,r,o){var a,u,s,c,o,f,l,h,a=[];if(0!==t.length&&(u=o||j())){if(n<=0&&(n=Kn(u,i,e,r))<=0){for(c=[],s=0;s<i.length;s++)T(i[s].text)||c.push({textLength:E.ah([i[s]],e,1,r,!1,u),text:i[s].text,textInfos:[i[s]]});return c}for(o=E.uh(t),f=E.Vt(o,E.Yt(i)),s=0;s<f.length;s++)if(l=Wn(f[s],n,e,r,u))if(0===l.length)a.push("");else for(h=0;h<l.length;h++)a.push(l[h])}return a},E.uh=function(t){for(var n,e,i,n=[],e=t.split(/\r\n|\r|\n/),i=0;i<e.length;i++)n.push(Hn(e[i]));return n},E.Vt=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=[],i=0,r=0,o=0;o<t.length;o++){for(a=[],u=0;u<t[o].length&&i<n.length;u++)if((s=t[o][u]).length<=n[i].text.length-r)a.push([{style:n[i].style,text:s}]),r+=s.length;else{for((c=[]).push({style:n[i].style,text:n[i].text.substring(r)}),f=s.length-(n[i].text.length-r),i++;i<n.length;i++){if(f<n[i].text.length){c.push({style:n[i].style,text:s.substring(s.length-f)}),r=f;break}if(f===n[i].text.length){c.push({style:n[i].style,text:s.substring(s.length-f)}),i++,r=0;break}c.push({style:n[i].style,text:n[i].text}),f-=n[i].text.length}a.push(c)}e.push(a)}return e},E.Wt=function(t,n,e,i){var i,n,i=i||j();return i?(n&&w.bt(i,n),n=e?O(t):t,y(i,i.font,n)):0},E.Yt=function(t){for(var n,e,n=[],e=0;e<t.length;e++)n.push({style:t[e].style,text:t[e].text&&t[e].text.replace(/\r\n|\r|\n/g,"")});return n},E.ah=function(t,n,e,i,r,o){var a,u,s,c,f,l,a=o||j();if(!a)return 0;for(s=u=0;s<t.length;s++)c=void 0,c=t[s].style&&t[s].style.font?t[s].style.font:n,w.bt(a,c),f="",f=s===t.length-1&&r?O(t[s].text):t[s].text,l=0,i?l=w.vt(c)*f.length/e:T(t[s].text)||(l=y(a,a.font,t[s].text)/e),t[s].style&&t[s].style.vertAlign&&(l*=lt),u+=l;return u},E.Zt=function(t,n,e,i,r,o,a,u){var s,c,f,r,a,l,h,s=0,c=w.vt(o),f,r=E.un(r,(a-4-c*i)/e,o),a=r.length,l,h=c*e;return s=(a-1)*(c/e),s=(s+=E.Wt(r[0],o)/2*i+h)+(E.Wt(r[a-1],o)/2*i+h)},E.tt=O,E.J=j,E.Gge=function(t){for(var n,e,i,r,o,a,u,n=[],e,i,r=0,o=0,a=h.Common.CultureManager.Fe().tCe(t);o<a.length;o++)" "===(u=a[o])?r++:(n.push({word:u,prefixSpaceCount:r}),r=0);return n},Yt=E,f.q=Yt,f.$e=Zt=function(f,l){(l=void 0===l?!1:l)&&(f.s2e=function(t){var n;f.c2e=null!=(n=f.registerCallBack)?n:[],f.c2e.push(t)},f.f2e=function(t){var n,n;f.c2e=null!=(n=f.registerCallBack)?n:[],-1!==(n=f.c2e.indexOf(t))&&f.c2e.splice(n,1)}),f.ch=function(t,n){var t,e,i;for(f.fh||(f.fh=[]),f.lh={},e=f.fh,n.name=t,n.priority=n.priority||5e3,i=0;;i++)if(i>=e.length||n.priority>e[i].priority){e.splice(i,0,n);break}l&&(null!=(t=f.c2e)?t:[]).forEach(function(t){t()})},f.et=function(t,n,e,i){var r,r,o,a,u,s,c,o=f.fh;if(o){if(t&&!t.lh&&(t.lh={}),!(a=l&&t?null==(r=t.lh)?void 0:r[n]:null==(r=f.lh)?void 0:r[n]))for(a=l&&t?t.lh[n]=[]:f.lh[n]=[],u=0;u<o.length;u++)(s=o[u])[n]&&(c=!s.isValid||s.isValid.call(t,n))&&a.push(s[n]);for(u=0;u<a.length&&(a[u].call(t,e),!i||!i());u++);}}},Xn.prototype.get=function(t,n){var t=this.Nf[t];return t?t[n]:A},Xn.prototype.set=function(t,n,e){var i,i;(i=(i=this.Nf[t])||(this.Nf[t]={}))[n]=e},f.Rf=Xn,qn.processBackspaceAndLeftArrowKeyEvent=function(t,n){var e,i,r,o,a,u,u,o,s,c,u,f,o,s,c,u,i,e=l.getSelection();if(!(e.rangeCount<=0))if(i=e.anchorNode,r=e.anchorOffset,o=t.target,w.browser.msie&&!w.browser.edge&&n&&ee(i,r,o))u=(a=parseFloat(w.browser.version)<10?he(o):o.innerText).slice(0,-1),o.innerHTML=u.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),e.selectAllChildren(o),0<e.rangeCount&&e.collapseToEnd(),ln(t);else if(o=(u=e.getRangeAt(0)).startContainer,s=u.endContainer,c=u.startOffset,u=u.endOffset,f=o===s&&c===u){if((o=fe(i,r))&&o.zeroWidthCharNode){if(s=o.zeroWidthCharNode,c=o.previousTextNode,n)if(ie(s))s.parentNode.removeChild(s);else{if(s.parentNode.removeChild(s.previousSibling),re(c))return void ln(t);(u=e.getRangeAt(0)).setStart(s,0),u.setEnd(s,1),u.deleteContents()}i=v.createRange(),te(c)?(i.setStart(c,1),i.setEnd(c,1)):(i.setStartAfter(c),i.setEndAfter(c)),i.collapse(!1),e.removeAllRanges(),e.addRange(i),ln(t)}}else n&&$n(e)},qn.processDeleteAndRightArrowKeyEvent=function(t,n){var e,i,r,o,a,i,u,r,o,a,i,r,i,s,e=l.getSelection();e.rangeCount<=0||(r=(i=e.getRangeAt(0)).startContainer,o=i.endContainer,a=i.startOffset,i=i.endOffset,(u=r===o&&a===i)?(r=le(e))&&r.node&&(i=fe(o=r.node,a=r.offset),n?(r=e.getRangeAt(0),1===a?(r.setStart(o,0),r.setEnd(o,1),o.parentNode.removeChild(o.previousSibling),r.deleteContents(),i&&i.previousTextNode&&(i=i.previousTextNode,s=v.createRange(),te(i)?(s.setStart(i,1),s.setEnd(i,1)):(s.setStartAfter(i),s.setEndAfter(i)),s.collapse(!1),e.removeAllRanges(),e.addRange(s))):0===a&&(r.setStart(o,1),r.setEnd(o,2),r.deleteContents())):((s=v.createRange()).setStart(o,a),s.setEnd(o,a),s.collapse(!1),e.removeAllRanges(),e.addRange(s)),ln(t)):n&&$n(e))},f.di=qn,f.Of={touch:!1},f.jf=pe,f.Ef=be,f._f=we,f.hCe=ye,f.Df=Me,f.kf=Se,Te.hh=function(t){var n,e,i;if(!T(t))return e=t.row+t.rowCount-1,i=t.col+t.colCount-1,(n={}).minRow=t.row,n.minCol=t.col,n.maxRow=e,n.maxCol=i,n},Te.vh=function(t,n){if(T(n)||T(n.minRow))return t;t.minRow=T(t.minRow)?n.minRow:N(t.minRow,n.minRow),t.minCol=T(t.minCol)?n.minCol:N(t.minCol,n.minCol),t.maxRow=T(t.maxRow)?n.maxRow:m(t.maxRow,n.maxRow),t.maxCol=T(t.maxCol)?n.maxCol:m(t.maxCol,n.maxCol)},Te.updateUsedRangeByData=function(t,n,e,i,r){i===r||!T(i)&&!T(r)||T(t)||(!T(i)&&T(r)&&t.removeRowAndColInfo(n,e),T(i)&&!T(r)&&t.addRowAndColInfo(n,e))},f.UsedRangeUtil=Te,Ae.prototype.getRowUsedRange=function(){var t,n,n,e,i,r,o,t,n=this.wholeRows,n=Object.keys(n);return 0<n.length&&(e=+n[0],r=+n[n.length-1],o=1/(i=0)),{minRow:e,minCol:i,maxRow:r,maxCol:o}},Ae.prototype.getColUsedRange=function(){var t,n,n,e,i,r,o,t,n=this.wholeCols,n=Object.keys(n);return 0<n.length&&(i=+n[0],o=+n[n.length-1],r=1/(e=0)),{minRow:e,minCol:i,maxRow:r,maxCol:o}},Ae.prototype.getUsedRange=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this,n=t.rowInfo,e=t.colInfo,u=n.length-1,s=e.length-1,c=0;c<=u;c++)if(n[c]){i=c;break}for(f=u;0<=f;f--)if(n[f]){o=f;break}for(l=0;l<=s;l++)if(e[l]){r=l;break}for(h=s;0<=h;h--)if(e[h]){a=h;break}return{minRow:i,minCol:r,maxRow:o,maxCol:a}},Ae.prototype.addRowAndColInfo=function(t,n){var e=this,i=e.rowInfo,r=e.colInfo;T(t)||T(n)||-1===t&&-1===n||(-1===t?e.wholeCols[n]=!0:-1===n?e.wholeRows[t]=!0:(T(i[t])?i[t]=1:i[t]++,T(r[n])?r[n]=1:r[n]++))},Ae.prototype.removeRowAndColInfo=function(t,n){var e=this,i=e.rowInfo,r=e.colInfo;-1===t&&-1===n||(-1===t?delete e.wholeCols[n]:-1===n?delete e.wholeRows[t]:i[t]&&r[n]&&(i[t]--,r[n]--))},Ae.prototype.addHeadInfo=function(t,n,e){var i,r,o,n,t,i=this,r=e?i.rowInfo:i.colInfo,o=[];o.length=n,n=r.slice(0,t),t=r.slice(t),r=n.concat(o).concat(t),e?i.rowInfo=r:i.colInfo=r},Ae.prototype.removeHeadInfo=function(t,n,e){var i=this,r;(e?i.rowInfo:i.colInfo).splice(t,n)},Ae.prototype.dispose=function(){var t=this;t.rowInfo=A,t.colInfo=A,t.wholeCols=A,t.wholeRows=A},f.BaseUsedRange=Ae,f.NUMBER_ARRAY=["0","1","2","3","4","5","6","7","8","9"],Ie.prototype.getTextIndex=function(t){var n,e,i,r,o,a,n=this;if(t.richText)if((i=t.text)===A&&(i=t.text=w.g0(t).text),(e=n.mh[i])===A||n.gh[i]===A)e=n.ph.push(t)-1,n.mh[i]=e,n.gh[i]=[],n.gh[i].push({i:e,v:t});else{for(r=void 0,o=0,a=n.gh[i].length;o<a;o++)if(n.gh[i][o]&&n.gh[i][o].v===t){r=o;break}0<=r?e=n.gh[i][r].i:(e=n.ph.push(t)-1,n.gh[i].push({i:e,v:t}))}else(e=n.mh[t])!==A&&!n.gh[t]||(e=n.ph.push(t)-1,n.mh[t]=e);return e},Ie.prototype.getText=function(t){var n=this.ph[t];return T(n)?t:n},Ie.prototype.getCount=function(){return this.bh},Ie.prototype.reset=function(){var t=this;t.ph=[],t.mh={},t.gh={},t.bh=0},Ie.prototype.rebuildSSTDict=function(){var i=this;i.ph.forEach(function(t,n){var e;t.richText?((e=t.text)===A&&(e=t.text=w.g0(t).text),i.mh[e]=n):i.mh[t]=n})},Ie.prototype.yh=function(t){var n;t&&0<t.length&&((n=this).reset(),n.ph=t)},Ie.prototype.wh=function(){return this.ph},f.SharedStrings=Ie,qt={8:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":6,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:4,"Arabic Typesetting":4,Arial:6,"Arial Black":7,"Arial Narrow":5,"Arial Nova":6,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":6,"Arial Rounded MT Bold":7,"Baskerville Old Face":5,Batang:6,BatangChe:6,"Bauhaus 93":6,"Bell MT":6,Bembo:5,"Berlin Sans FB":7,"Berlin Sans FB Demi":7,"Bernard MT Condensed":5,"Blackadder ITC":4,"Bodoni MT":5,"Bodoni MT Black":7,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":8,"Bradley Hand ITC":7,"Britannic Bold":7,Broadway:7,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":5,"Calisto MT":6,Cambria:6,"Cambria Math":6,Candara:6,Castellar:8,Centaur:5,Century:6,"Century Gothic":6,"Century Schoolbook":6,Chiller:5,"Colonna MT":6,"Comic Sans MS":7,Consolas:6,Constantia:6,"Cooper Black":7,"Copperplate Gothic Bold":8,"Copperplate Gothic Light":8,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:3,DokChampa:6,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":5,Elephant:8,"Engravers MT":7,"Eras Bold ITC":7,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":6,EucrosiaUPC:4,Euphemia:6,"Expo M":10,FangSong:6,"Felix Titling":6,"Footlight MT Light":6,Forte:6,"Franklin Gothic Book":6,"Franklin Gothic Demi":6,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":6,"Franklin Gothic Medium":6,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":4,"French Script MT":4,Gabriola:4,Gadugi:6,Garamond:5,Gautami:7,Georgia:8,"Georgia Pro":6,"Georgia Pro Black":8,"Georgia Pro Cond":6,"Georgia Pro Cond Black":7,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":6,"Georgia Pro Light":6,"Georgia Pro Semibold":7,Gigi:5,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":3,"Gill Sans Nova Cond Ultra Bold":6,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":9,"Gill Sans Ultra Bold":9,"Gill Sans Ultra Bold Condensed":6,Gisha:6,"Gloucester MT Extra Condensed":4,"Goudy Old Style":6,"Goudy Stout":9,Grotesque:5,"Grotesque Light":5,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":6,Haettenschweiler:5,"Harlow Solid Italic":5,Harrington:6,"Headline R":8,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:8,HGMinchoB:7,HGMinchoE:7,HGPGothicE:7,HGPGothicM:7,HGPGyoshotai:6,HGPKyokashotai:6,HGPMinchoB:6,HGPMinchoE:7,HGPSoeiKakugothicUB:8,HGPSoeiKakupoptai:8,HGPSoeiPresenceEB:7,HGSeikaishotaiPRO:7,HGSGothicE:6,HGSGothicM:6,HGSGyoshotai:5,HGSKyokashotai:5,HGSMinchoB:6,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:7,HGSSoeiKakupoptai:7,HGSSoeiPresenceEB:6,"High Tower Text":5,"HYGothic-Extra":7,"HYGothic-Medium":6,"HYGraphic-Medium":6,"HYGungSo-Bold":6,"HYHeadLine-Medium":6,"HYMyeongJo-Extra":7,"HYPMokGak-Bold":8,"HYPost-Light":7,"HYPost-Medium":8,"HYShortSamul-Medium":4,"HYSinMyeongJo-Medium":7,Impact:6,"Imprint MT Shadow":6,"Informal Roman":6,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":6,Jokerman:8,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":6,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":7,"Lucida Console":8,"Lucida Fax":7,"Lucida Handwriting":8,"Lucida Sans":7,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":8,"Magic R":7,Magneto:8,"Maiandra GD":7,"Malgun Gothic":6,"Malgun Gothic Semilight":7,Mangal:7,Marlett:12,"Matura MT Script Capitals":8,Meiryo:7,"Meiryo UI":7,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":7,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":7,"Microsoft New Tai Lue":6,"Microsoft PhagsPa":6,"Microsoft Sans Serif":7,"Microsoft Tai Le":6,"Microsoft Uighur":4,"Microsoft YaHei Light":7,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":7,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":7,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":6,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":8,"MS Reference Specialty":14,"MS UI Gothic":7,"MT Extra":12,"MV Boli":9,"Myanmar Text":6,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":7,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":6,"Nirmala UI Semilight":7,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":4,"Palatino Linotype":6,Papyrus:7,Parchment:3,Perpetua:5,"Perpetua Titling MT":7,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:6,"PMingLiU-ExtB":6,"Poor Richard":7,Pristina:6,"Pyunji R":6,Raavi:7,"Rage Italic":7,Ravie:11,Rockwell:6,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":4,"Segoe Print":8,"Segoe Script":8,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":6,"Segoe UI Semilight":6,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":6,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":6,"Sitka Small":8,"Sitka Subheading":6,"Sitka Text":7,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:6,Sylfaen:6,Symbol:6,Tahoma:6,"Tempus Sans ITC":7,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":6,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":5,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:7,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":7,Vivaldi:5,"Vladimir Script":5,Vrinda:6,Webdings:11,"Wide Latin":14,Wingdings:15,"Wingdings 2":12,"Wingdings 3":10,"Yet R":6,"Yu Gothic":6,"Yu Gothic Light":6,"Yu Gothic Medium":6,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":6,"Yu Gothic UI Semilight":6,"Yu Mincho":6,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":5,"\u534e\u6587\u5b8b\u4f53":5,"\u534e\u6587\u5f69\u4e91":6,"\u534e\u6587\u65b0\u9b4f":6,"\u534e\u6587\u6977\u4f53":5,"\u534e\u6587\u7425\u73c0":6,"\u534e\u6587\u7ec6\u9ed1":6,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":6,"\u5fae\u8f6f\u96c5\u9ed1 Light":6,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":6,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":6,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},9:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":8,"Arial Narrow":5,"Arial Nova":7,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":7,"Arial Rounded MT Bold":7,"Baskerville Old Face":6,Batang:6,BatangChe:6,"Bauhaus 93":7,"Bell MT":6,Bembo:6,"Berlin Sans FB":7,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":8,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":9,"Bradley Hand ITC":8,"Britannic Bold":7,Broadway:8,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":7,"Calisto MT":6,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":6,"Comic Sans MS":7,Consolas:7,Constantia:7,"Cooper Black":7,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":6,Elephant:9,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:7,"Expo M":10,FangSong:6,"Felix Titling":7,"Footlight MT Light":7,Forte:6,"Franklin Gothic Book":7,"Franklin Gothic Demi":7,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":7,"Franklin Gothic Medium":7,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":5,"French Script MT":4,Gabriola:5,Gadugi:6,Garamond:6,Gautami:7,Georgia:8,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":6,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":7,Gigi:7,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":7,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":10,"Gill Sans Ultra Bold":10,"Gill Sans Ultra Bold Condensed":7,Gisha:6,"Gloucester MT Extra Condensed":5,"Goudy Old Style":6,"Goudy Stout":10,Grotesque:6,"Grotesque Light":6,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":7,Haettenschweiler:5,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:9,HGMinchoB:7,HGMinchoE:7,HGPGothicE:8,HGPGothicM:8,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:7,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:7,HGSGothicE:7,HGSGothicM:7,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":7,"HYGraphic-Medium":7,"HYGungSo-Bold":7,"HYHeadLine-Medium":7,"HYMyeongJo-Extra":8,"HYPMokGak-Bold":9,"HYPost-Light":8,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":6,"Informal Roman":7,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":7,Jokerman:9,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":7,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":9,"Lucida Console":8,"Lucida Fax":8,"Lucida Handwriting":9,"Lucida Sans":8,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":9,"Magic R":8,Magneto:9,"Maiandra GD":8,"Malgun Gothic":7,"Malgun Gothic Semilight":8,Mangal:7,Marlett:13,"Matura MT Script Capitals":9,Meiryo:8,"Meiryo UI":8,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":8,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":6,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":9,"MS Reference Specialty":15,"MS UI Gothic":7,"MT Extra":13,"MV Boli":9,"Myanmar Text":7,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":8,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":5,"Palatino Linotype":6,Papyrus:8,Parchment:4,Perpetua:6,"Perpetua Titling MT":8,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:6,"Pyunji R":7,Raavi:7,"Rage Italic":7,Ravie:12,Rockwell:7,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":5,"Segoe Print":9,"Segoe Script":9,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":8,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":7,"Sitka Small":8,"Sitka Subheading":7,"Sitka Text":8,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:7,Sylfaen:6,Symbol:6,Tahoma:7,"Tempus Sans ITC":8,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":7,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:8,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":8,Vivaldi:5,"Vladimir Script":6,Vrinda:6,Webdings:12,"Wide Latin":15,Wingdings:16,"Wingdings 2":14,"Wingdings 3":11,"Yet R":6,"Yu Gothic":7,"Yu Gothic Light":6,"Yu Gothic Medium":7,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":7,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":7,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},10:{"Gill Sans MT":7,Abadi:8,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:8,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":9,"Arial Narrow":6,"Arial Nova":7,"Arial Nova Cond":7,"Arial Nova Cond Light":6,"Arial Nova Light":7,"Arial Rounded MT Bold":8,"Baskerville Old Face":6,Batang:7,BatangChe:7,"Bauhaus 93":7,"Bell MT":7,Bembo:6,"Berlin Sans FB":8,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":9,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":5,"Book Antiqua":7,"Bookman Old Style":8,"Bookshelf Symbol 7":10,"Bradley Hand ITC":8,"Britannic Bold":8,Broadway:8,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":7,Calibri:7,"Calibri Light":7,"Californian FB":7,"Calisto MT":7,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":7,"Comic Sans MS":8,Consolas:7,Constantia:7,"Cooper Black":8,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:7,"Cordia New":5,CordiaUPC:5,"Courier New":8,"Curlz MT":7,Dante:6,DaunPenh:4,David:6,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:7,Dubai:7,"Dubai Light":7,"Dubai Medium":7,Ebrima:7,"Edwardian Script ITC":6,Elephant:10,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":8,"Eras Light ITC":7,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:8,"Expo M":11,FangSong:7,"Felix Titling":8,"Footlight MT Light":7,Forte:7,"Franklin Gothic Book":8,"Franklin Gothic Demi":8,"Franklin Gothic Demi Cond":7,"Franklin Gothic Heavy":8,"Franklin Gothic Medium":8,"Franklin Gothic Medium Cond":7,FrankRuehl:5,FreesiaUPC:6,"Freestyle Script":5,"French Script MT":5,Gabriola:5,Gadugi:7,Garamond:6,Gautami:8,Georgia:9,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":7,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":7,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":8,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":7,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":8,"Gill Sans Nova Cond XBd":7,"Gill Sans Nova Light":7,"Gill Sans Nova Ultra Bold":11,"Gill Sans Ultra Bold":11,"Gill Sans Ultra Bold Condensed":8,Gisha:7,"Gloucester MT Extra Condensed":5,"Goudy Old Style":7,"Goudy Stout":11,Grotesque:6,"Grotesque Light":6,Gulim:7,GulimChe:7,Gungsuh:6,GungsuhChe:7,"Hadassah Friedlaender":7,Haettenschweiler:6,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:7,HGGothicM:7,HGGyoshotai:7,HGKyokashotai:7,HGMaruGothicMPRO:10,HGMinchoB:8,HGMinchoE:8,HGPGothicE:8,HGPGothicM:9,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:8,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:8,HGSGothicE:7,HGSGothicM:8,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:8,HGSoeiKakugothicUB:8,HGSoeiKakupoptai:8,HGSoeiPresenceEB:8,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":8,"HYGraphic-Medium":8,"HYGungSo-Bold":8,"HYHeadLine-Medium":8,"HYMyeongJo-Extra":9,"HYPMokGak-Bold":9,"HYPost-Light":9,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":7,"Informal Roman":7,"Ink Free":7,IrisUPC:7,"Iskoola Pota":7,JasmineUPC:7,"Javanese Text":8,Jokerman:9,"Juice ITC":5,KaiTi:7,Kalinga:7,Kartika:7,"Khmer UI":7,KodchiangUPC:4,Kokila:7,"Kristen ITC":8,"Kunstler Script":5,"Lao UI":7,Latha:7,Leelawadee:7,"Leelawadee UI":7,"Leelawadee UI Semilight":7,"Levenim MT":7,LilyUPC:7,"Lucida Bright":8,"Lucida Calligraphy":10,"Lucida Console":9,"Lucida Fax":9,"Lucida Handwriting":10,"Lucida Sans":9,"Lucida Sans Typewriter":8,"Lucida Sans Unicode":9,"Magic R":8,Magneto:10,"Maiandra GD":9,"Malgun Gothic":8,"Malgun Gothic Semilight":8,Mangal:8,Marlett:14,"Matura MT Script Capitals":10,Meiryo:9,"Meiryo UI":9,"Microsoft GothicNeo":8,"Microsoft Himalaya":5,"Microsoft JhengHei":8,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":8,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":8,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":8,MingLiU:8,MingLiU_HKSCS:8,"MingLiU_HKSCS-ExtB":8,"MingLiU-ExtB":8,Miriam:8,"Miriam Fixed":8,Mistral:7,"Modern No. 20":7,"MoeumT R":8,"Mongolian Baiti":8,"Monotype Corsiva":7,MoolBoran:8,"MS Gothic":7,"MS Mincho":8,"MS Outlook":8,"MS PGothic":8,"MS PMincho":8,"MS Reference Sans Serif":9,"MS Reference Specialty":17,"MS UI Gothic":8,"MT Extra":14,"MV Boli":10,"Myanmar Text":7,Narkisim:8,"Neue Haas Grotesk Text Pro":8,"New Gulim":8,"News Gothic MT":8,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:8,"OCR A Extended":9,OCRB:9,"Old English Text MT":8,Onyx:6,"Palace Script MT":5,"Palatino Linotype":7,Papyrus:9,Parchment:4,Perpetua:6,"Perpetua Titling MT":9,"Plantagenet Cherokee":8,Playbill:6,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:8,"Pyunji R":7,Raavi:8,"Rage Italic":8,Ravie:13,Rockwell:7,"Rockwell Condensed":6,"Rockwell Extra Bold":9,"Rockwell Light":8,"Rockwell Nova":8,"Rockwell Nova Cond":8,"Rockwell Nova Cond Light":8,"Rockwell Nova Extra Bold":8,"Rockwell Nova Light":8,Rod:8,"Sakkal Majalla":8,"Sanskrit Text":8,"Script MT Bold":7,"Segoe MDL2 Assets":5,"Segoe Print":10,"Segoe Script":10,"Segoe UI":7,"Segoe UI Black":8,"Segoe UI Emoji":7,"Segoe UI Historic":7,"Segoe UI Light":7,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":7,Selawik:7,"Selawik Light":7,"Selawik Semibold":7,"Shonar Bangla":7,"Showcard Gothic":8,Shruti:7,"Simplified Arabic":7,"Simplified Arabic Fixed":7,"SimSun-ExtB":7,"Sitka Banner":7,"Sitka Display":7,"Sitka Heading":7,"Sitka Small":9,"Sitka Subheading":8,"Sitka Text":8,"Snap ITC":11,"Source Sans Pro":7,"Source Sans Pro Black":7,"Source Sans Pro ExtraLight":7,"Source Sans Pro Light":7,"Source Sans Pro SemiBold":7,Stencil:7,Sylfaen:7,Symbol:7,Tahoma:7,"Tempus Sans ITC":9,"TH SarabunPSK":7,"Times New Roman":6,"Traditional Arabic":7,"Trebuchet MS":7,Tunga:7,"Tw Cen MT":7,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":7,"UD Digi Kyokasho NK-B":7,"UD Digi Kyokasho NK-R":7,"UD Digi Kyokasho NP-B":7,"UD Digi Kyokasho NP-R":7,"UD Digi Kyokasho N-R":7,Univers:7,"Univers Condensed":7,"Univers Condensed Light":7,"Univers Light":7,"Urdu Typesetting":7,Utsaah:7,Vani:7,Verdana:8,"Verdana Pro":8,"Verdana Pro Black":7,"Verdana Pro Cond":7,"Verdana Pro Cond Black":7,"Verdana Pro Cond Light":7,"Verdana Pro Cond SemiBold":7,"Verdana Pro Light":7,"Verdana Pro SemiBold":7,Vijaya:7,"Viner Hand ITC":9,Vivaldi:6,"Vladimir Script":6,Vrinda:7,Webdings:13,"Wide Latin":16,Wingdings:17,"Wingdings 2":15,"Wingdings 3":12,"Yet R":7,"Yu Gothic":7,"Yu Gothic Light":7,"Yu Gothic Medium":7,"Yu Gothic UI":7,"Yu Gothic UI Light":7,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":7,"Yu Mincho Light":7,"\u4eff\u5b8b":7,"\u534e\u6587\u4e2d\u5b8b":8,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":8,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":7,"\u534e\u6587\u96b6\u4e66":6,"\u5b8b\u4f53":7,"\u5e7c\u5706":7,"\u5fae\u8f6f\u96c5\u9ed1":8,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":7,"\u65b9\u6b63\u59da\u4f53":7,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":7,"\u7b49\u7ebf":7,"\u7b49\u7ebf Light":7,"\u96b6\u4e66":7,"\u9ed1\u4f53":7,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":7,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':7,"\u30e1\u30a4\u30ea\u30aa":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":7,"HG\u660e\u671dB":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":7},11:{"Gill Sans MT":8,Abadi:9,"Abadi Extra Light":8,"Agency FB":6,Aharoni:6,Aldhabi:5,Algerian:9,"Ami R":6,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:8,"Arial Black":10,"Arial Narrow":7,"Arial Nova":8,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":8,"Arial Rounded MT Bold":9,"Baskerville Old Face":7,Batang:8,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:7,"Berlin Sans FB":9,"Berlin Sans FB Demi":9,"Bernard MT Condensed":7,"Blackadder ITC":6,"Bodoni MT":7,"Bodoni MT Black":10,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":5,"Book Antiqua":8,"Bookman Old Style":9,"Bookshelf Symbol 7":11,"Bradley Hand ITC":10,"Britannic Bold":9,Broadway:10,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":8,Calibri:7,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:8,"Cambria Math":8,Candara:8,Castellar:11,Centaur:7,Century:8,"Century Gothic":8,"Century Schoolbook":8,Chiller:7,"Colonna MT":8,"Comic Sans MS":9,Consolas:8,Constantia:8,"Cooper Black":9,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":11,Corbel:8,"Cordia New":5,CordiaUPC:5,"Courier New":9,"Curlz MT":8,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:8,Dotum:9,DotumChe:8,Dubai:8,"Dubai Light":8,"Dubai Medium":8,Ebrima:8,"Edwardian Script ITC":7,Elephant:11,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":9,"Eras Light ITC":8,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":13,FangSong:8,"Felix Titling":9,"Footlight MT Light":8,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:6,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":5,Gabriola:6,Gadugi:8,Garamond:7,Gautami:9,Georgia:9,"Georgia Pro":8,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":8,"Georgia Pro Light":8,"Georgia Pro Semibold":9,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":5,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":13,"Gill Sans Ultra Bold":13,"Gill Sans Ultra Bold Condensed":9,Gisha:8,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":12,Grotesque:7,"Grotesque Light":7,Gulim:8,GulimChe:8,Gungsuh:7,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:8,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:11,HGMinchoB:9,HGMinchoE:9,HGPGothicE:9,HGPGothicM:10,HGPGyoshotai:8,HGPKyokashotai:8,HGPMinchoB:8,HGPMinchoE:9,HGPSoeiKakugothicUB:10,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:9,HGSeikaishotaiPRO:9,HGSGothicE:8,HGSGothicM:9,HGSGyoshotai:7,HGSKyokashotai:7,HGSMinchoB:8,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:9,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:8,"High Tower Text":7,"HYGothic-Extra":9,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":10,"HYPMokGak-Bold":11,"HYPost-Light":10,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":9,Impact:8,"Imprint MT Shadow":8,"Informal Roman":8,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:8,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":9,"Kunstler Script":5,"Lao UI":8,Latha:8,Leelawadee:8,"Leelawadee UI":8,"Leelawadee UI Semilight":8,"Levenim MT":9,LilyUPC:8,"Lucida Bright":9,"Lucida Calligraphy":11,"Lucida Console":10,"Lucida Fax":10,"Lucida Handwriting":11,"Lucida Sans":10,"Lucida Sans Typewriter":9,"Lucida Sans Unicode":10,"Magic R":9,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":9,Mangal:9,Marlett:16,"Matura MT Script Capitals":11,Meiryo:9,"Meiryo UI":10,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":9,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":9,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":9,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":9,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":10,Mistral:8,"Modern No. 20":8,"MoeumT R":9,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:9,"MS Gothic":8,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":19,"MS UI Gothic":9,"MT Extra":16,"MV Boli":12,"Myanmar Text":9,Narkisim:7,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":5,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":9,Nyala:9,"OCR A Extended":10,OCRB:10,"Old English Text MT":9,Onyx:6,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":10,"Plantagenet Cherokee":9,Playbill:6,PMingLiU:8,"PMingLiU-ExtB":8,"Poor Richard":9,Pristina:9,"Pyunji R":8,Raavi:9,"Rage Italic":9,Ravie:15,Rockwell:8,"Rockwell Condensed":6,"Rockwell Extra Bold":10,"Rockwell Light":9,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":6,"Segoe Print":11,"Segoe Script":11,"Segoe UI":8,"Segoe UI Black":9,"Segoe UI Emoji":8,"Segoe UI Historic":8,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":8,"Segoe UI Symbol":8,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":8,"Sitka Small":10,"Sitka Subheading":9,"Sitka Text":9,"Snap ITC":13,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:8,"Tempus Sans ITC":10,"TH SarabunPSK":8,"Times New Roman":7,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":8,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":7,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:8,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":10,Vivaldi:6,"Vladimir Script":7,Vrinda:9,Webdings:15,"Wide Latin":19,Wingdings:20,"Wingdings 2":17,"Wingdings 3":13,"Yet R":8,"Yu Gothic":8,"Yu Gothic Light":8,"Yu Gothic Medium":8,"Yu Gothic UI":8,"Yu Gothic UI Light":8,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":8,"Yu Mincho":8,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":9,"\u534e\u6587\u4eff\u5b8b":7,"\u534e\u6587\u5b8b\u4f53":7,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":7,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":8,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":8,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":8,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":9,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},12:{"Gill Sans MT":8,Abadi:10,"Abadi Extra Light":9,"Agency FB":6,Aharoni:7,Aldhabi:5,Algerian:10,"Ami R":7,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:9,"Arial Black":11,"Arial Narrow":7,"Arial Nova":9,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":9,"Arial Rounded MT Bold":10,"Baskerville Old Face":8,Batang:9,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:8,"Berlin Sans FB":10,"Berlin Sans FB Demi":10,"Bernard MT Condensed":8,"Blackadder ITC":6,"Bodoni MT":8,"Bodoni MT Black":11,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":6,"Book Antiqua":8,"Bookman Old Style":10,"Bookshelf Symbol 7":12,"Bradley Hand ITC":10,"Britannic Bold":10,Broadway:10,"Browallia New":6,BrowalliaUPC:6,"Brush Script MT":8,Calibri:8,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:9,"Cambria Math":9,Candara:9,Castellar:12,Centaur:8,Century:9,"Century Gothic":9,"Century Schoolbook":9,Chiller:8,"Colonna MT":8,"Comic Sans MS":10,Consolas:9,Constantia:9,"Cooper Black":10,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":12,Corbel:8,"Cordia New":6,CordiaUPC:6,"Courier New":10,"Curlz MT":9,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:9,Dotum:8,DotumChe:8,Dubai:9,"Dubai Light":9,"Dubai Medium":9,Ebrima:9,"Edwardian Script ITC":8,Elephant:12,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":10,"Eras Light ITC":9,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":14,FangSong:8,"Felix Titling":9,"Footlight MT Light":9,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:7,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":6,Gabriola:6,Gadugi:9,Garamond:8,Gautami:10,Georgia:10,"Georgia Pro":9,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":9,"Georgia Pro Light":9,"Georgia Pro Semibold":10,Gigi:7,"Gill Sans MT Condensed":6,"Gill Sans MT Ext Condensed Bold":6,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":14,"Gill Sans Ultra Bold":14,"Gill Sans Ultra Bold Condensed":9,Gisha:9,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":13,Grotesque:8,"Grotesque Light":8,Gulim:9,GulimChe:8,Gungsuh:9,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:9,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:12,HGMinchoB:9,HGMinchoE:9,HGPGothicE:10,HGPGothicM:10,HGPGyoshotai:9,HGPKyokashotai:8,HGPMinchoB:9,HGPMinchoE:9,HGPSoeiKakugothicUB:11,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:10,HGSeikaishotaiPRO:10,HGSGothicE:9,HGSGothicM:9,HGSGyoshotai:8,HGSKyokashotai:7,HGSMinchoB:9,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:10,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:9,"High Tower Text":8,"HYGothic-Extra":10,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":11,"HYPMokGak-Bold":11,"HYPost-Light":11,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":10,Impact:9,"Imprint MT Shadow":8,"Informal Roman":9,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:9,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":10,"Kunstler Script":6,"Lao UI":8,Latha:8,Leelawadee:9,"Leelawadee UI":9,"Leelawadee UI Semilight":9,"Levenim MT":9,LilyUPC:7,"Lucida Bright":10,"Lucida Calligraphy":12,"Lucida Console":11,"Lucida Fax":11,"Lucida Handwriting":12,"Lucida Sans":11,"Lucida Sans Typewriter":10,"Lucida Sans Unicode":11,"Magic R":10,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":10,Mangal:9,Marlett:17,"Matura MT Script Capitals":12,Meiryo:11,"Meiryo UI":11,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":10,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":10,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":10,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":10,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":11,Mistral:8,"Modern No. 20":8,"MoeumT R":10,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:7,"MS Gothic":8,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":20,"MS UI Gothic":9,"MT Extra":17,"MV Boli":12,"Myanmar Text":9,Narkisim:8,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":6,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":10,Nyala:9,"OCR A Extended":11,OCRB:11,"Old English Text MT":9,Onyx:7,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":11,"Plantagenet Cherokee":9,Playbill:7,PMingLiU:9,"PMingLiU-ExtB":9,"Poor Richard":10,Pristina:9,"Pyunji R":9,Raavi:8,"Rage Italic":9,Ravie:16,Rockwell:9,"Rockwell Condensed":7,"Rockwell Extra Bold":11,"Rockwell Light":10,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":7,"Segoe Print":12,"Segoe Script":12,"Segoe UI":9,"Segoe UI Black":10,"Segoe UI Emoji":9,"Segoe UI Historic":9,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":9,"Segoe UI Symbol":9,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":9,"Sitka Small":11,"Sitka Subheading":9,"Sitka Text":10,"Snap ITC":14,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:9,"Tempus Sans ITC":11,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":9,"Tw Cen MT Condensed":6,"Tw Cen MT Condensed Extra Bold":8,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:6,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":11,Vivaldi:7,"Vladimir Script":7,Vrinda:9,Webdings:16,"Wide Latin":20,Wingdings:22,"Wingdings 2":18,"Wingdings 3":14,"Yet R":9,"Yu Gothic":9,"Yu Gothic Light":9,"Yu Gothic Medium":9,"Yu Gothic UI":9,"Yu Gothic UI Light":9,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":9,"Yu Mincho":9,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":10,"\u534e\u6587\u4eff\u5b8b":8,"\u534e\u6587\u5b8b\u4f53":8,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":8,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":9,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":9,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":9,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},14:{"Gill Sans MT":10,Abadi:11,"Abadi Extra Light":11,"Agency FB":8,Aharoni:8,Aldhabi:6,Algerian:11,"Ami R":8,"Angsana New":6,AngsanaUPC:6,Aparajita:8,"Arabic Typesetting":6,Arial:11,"Arial Black":13,"Arial Narrow":9,"Arial Nova":11,"Arial Nova Cond":10,"Arial Nova Cond Light":9,"Arial Nova Light":11,"Arial Rounded MT Bold":11,"Baskerville Old Face":9,Batang:10,BatangChe:10,"Bauhaus 93":11,"Bell MT":10,Bembo:9,"Berlin Sans FB":11,"Berlin Sans FB Demi":12,"Bernard MT Condensed":9,"Blackadder ITC":8,"Bodoni MT":9,"Bodoni MT Black":12,"Bodoni MT Condensed":6,"Bodoni MT Poster Compressed":6,"Book Antiqua":10,"Bookman Old Style":12,"Bookshelf Symbol 7":14,"Bradley Hand ITC":12,"Britannic Bold":12,Broadway:12,"Browallia New":7,BrowalliaUPC:7,"Brush Script MT":10,Calibri:10,"Calibri Light":10,"Californian FB":11,"Calisto MT":10,Cambria:11,"Cambria Math":11,Candara:10,Castellar:14,Centaur:9,Century:11,"Century Gothic":11,"Century Schoolbook":11,Chiller:9,"Colonna MT":10,"Comic Sans MS":12,Consolas:10,Constantia:10,"Cooper Black":11,"Copperplate Gothic Bold":14,"Copperplate Gothic Light":14,Corbel:10,"Cordia New":7,CordiaUPC:7,"Courier New":11,"Curlz MT":10,Dante:9,DaunPenh:6,David:8,DilleniaUPC:6,DokChampa:11,Dotum:10,DotumChe:10,Dubai:10,"Dubai Light":10,"Dubai Medium":10,Ebrima:10,"Edwardian Script ITC":9,Elephant:14,"Engravers MT":12,"Eras Bold ITC":12,"Eras Demi ITC":12,"Eras Light ITC":10,"Eras Medium ITC":11,EucrosiaUPC:8,Euphemia:11,"Expo M":16,FangSong:10,"Felix Titling":11,"Footlight MT Light":11,Forte:10,"Franklin Gothic Book":11,"Franklin Gothic Demi":11,"Franklin Gothic Demi Cond":10,"Franklin Gothic Heavy":11,"Franklin Gothic Medium":11,"Franklin Gothic Medium Cond":10,FrankRuehl:8,FreesiaUPC:8,"Freestyle Script":7,"French Script MT":7,Gabriola:8,Gadugi:10,Garamond:9,Gautami:11,Georgia:12,"Georgia Pro":11,"Georgia Pro Black":13,"Georgia Pro Cond":10,"Georgia Pro Cond Black":12,"Georgia Pro Cond Light":10,"Georgia Pro Cond Semibold":11,"Georgia Pro Light":10,"Georgia Pro Semibold":12,Gigi:10,"Gill Sans MT Condensed":7,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":10,"Gill Sans Nova Cond":6,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":11,"Gill Sans Nova Cond XBd":10,"Gill Sans Nova Light":10,"Gill Sans Nova Ultra Bold":16,"Gill Sans Ultra Bold":16,"Gill Sans Ultra Bold Condensed":11,Gisha:10,"Gloucester MT Extra Condensed":7,"Goudy Old Style":10,"Goudy Stout":16,Grotesque:9,"Grotesque Light":9,Gulim:10,GulimChe:10,Gungsuh:10,GungsuhChe:10,"Hadassah Friedlaender":11,Haettenschweiler:8,"Harlow Solid Italic":9,Harrington:11,"Headline R":14,HGGothicE:10,HGGothicM:10,HGGyoshotai:10,HGKyokashotai:10,HGMaruGothicMPRO:14,HGMinchoB:11,HGMinchoE:11,HGPGothicE:11,HGPGothicM:12,HGPGyoshotai:10,HGPKyokashotai:10,HGPMinchoB:10,HGPMinchoE:11,HGPSoeiKakugothicUB:13,HGPSoeiKakupoptai:13,HGPSoeiPresenceEB:12,HGSeikaishotaiPRO:11,HGSGothicE:10,HGSGothicM:11,HGSGyoshotai:9,HGSKyokashotai:9,HGSMinchoB:10,HGSMinchoE:11,HGSoeiKakugothicUB:11,HGSoeiKakupoptai:11,HGSoeiPresenceEB:11,HGSSoeiKakugothicUB:12,HGSSoeiKakupoptai:12,HGSSoeiPresenceEB:11,"High Tower Text":9,"HYGothic-Extra":12,"HYGothic-Medium":11,"HYGraphic-Medium":11,"HYGungSo-Bold":11,"HYHeadLine-Medium":11,"HYMyeongJo-Extra":13,"HYPMokGak-Bold":13,"HYPost-Light":13,"HYPost-Medium":13,"HYShortSamul-Medium":7,"HYSinMyeongJo-Medium":12,Impact:10,"Imprint MT Shadow":10,"Informal Roman":10,"Ink Free":10,IrisUPC:10,"Iskoola Pota":10,JasmineUPC:10,"Javanese Text":11,Jokerman:14,"Juice ITC":7,KaiTi:10,Kalinga:11,Kartika:11,"Khmer UI":10,KodchiangUPC:7,Kokila:10,"Kristen ITC":11,"Kunstler Script":7,"Lao UI":10,Latha:10,Leelawadee:10,"Leelawadee UI":10,"Leelawadee UI Semilight":10,"Levenim MT":11,LilyUPC:8,"Lucida Bright":12,"Lucida Calligraphy":14,"Lucida Console":12,"Lucida Fax":13,"Lucida Handwriting":14,"Lucida Sans":13,"Lucida Sans Typewriter":11,"Lucida Sans Unicode":13,"Magic R":12,Magneto:15,"Maiandra GD":12,"Malgun Gothic":11,"Malgun Gothic Semilight":12,Mangal:11,Marlett:20,"Matura MT Script Capitals":13,Meiryo:13,"Meiryo UI":13,"Microsoft GothicNeo":11,"Microsoft Himalaya":7,"Microsoft JhengHei":11,"Microsoft JhengHei Light":12,"Microsoft JhengHei UI":11,"Microsoft JhengHei UI Light":12,"Microsoft New Tai Lue":11,"Microsoft PhagsPa":11,"Microsoft Sans Serif":11,"Microsoft Tai Le":11,"Microsoft Uighur":7,"Microsoft YaHei Light":12,"Microsoft YaHei UI":12,"Microsoft YaHei UI Light":12,"Microsoft Yi Baiti":11,MingLiU:11,MingLiU_HKSCS:11,"MingLiU_HKSCS-ExtB":11,"MingLiU-ExtB":11,Miriam:10,"Miriam Fixed":12,Mistral:10,"Modern No. 20":10,"MoeumT R":11,"Mongolian Baiti":11,"Monotype Corsiva":9,MoolBoran:8,"MS Gothic":10,"MS Mincho":11,"MS Outlook":11,"MS PGothic":11,"MS PMincho":11,"MS Reference Sans Serif":13,"MS Reference Specialty":24,"MS UI Gothic":11,"MT Extra":20,"MV Boli":14,"Myanmar Text":11,Narkisim:9,"Neue Haas Grotesk Text Pro":11,"New Gulim":12,"News Gothic MT":12,"Niagara Engraved":7,"Niagara Solid":7,"Nirmala UI":11,"Nirmala UI Semilight":11,Nyala:11,"OCR A Extended":12,OCRB:12,"Old English Text MT":11,Onyx:7,"Palace Script MT":7,"Palatino Linotype":10,Papyrus:12,Parchment:5,Perpetua:9,"Perpetua Titling MT":13,"Plantagenet Cherokee":11,Playbill:8,PMingLiU:10,"PMingLiU-ExtB":10,"Poor Richard":11,Pristina:10,"Pyunji R":10,Raavi:10,"Rage Italic":11,Ravie:19,Rockwell:10,"Rockwell Condensed":8,"Rockwell Extra Bold":13,"Rockwell Light":11,"Rockwell Nova":11,"Rockwell Nova Cond":11,"Rockwell Nova Cond Light":11,"Rockwell Nova Extra Bold":11,"Rockwell Nova Light":11,Rod:11,"Sakkal Majalla":11,"Sanskrit Text":12,"Script MT Bold":10,"Segoe MDL2 Assets":8,"Segoe Print":14,"Segoe Script":14,"Segoe UI":10,"Segoe UI Black":12,"Segoe UI Emoji":10,"Segoe UI Historic":10,"Segoe UI Light":10,"Segoe UI Semibold":11,"Segoe UI Semilight":10,"Segoe UI Symbol":10,Selawik:10,"Selawik Light":10,"Selawik Semibold":10,"Shonar Bangla":10,"Showcard Gothic":11,Shruti:11,"Simplified Arabic":10,"Simplified Arabic Fixed":11,"SimSun-ExtB":10,"Sitka Banner":10,"Sitka Display":10,"Sitka Heading":11,"Sitka Small":13,"Sitka Subheading":11,"Sitka Text":12,"Snap ITC":16,"Source Sans Pro":9,"Source Sans Pro Black":10,"Source Sans Pro ExtraLight":9,"Source Sans Pro Light":10,"Source Sans Pro SemiBold":10,Stencil:11,Sylfaen:10,Symbol:10,Tahoma:10,"Tempus Sans ITC":13,"TH SarabunPSK":7,"Times New Roman":10,"Traditional Arabic":10,"Trebuchet MS":10,Tunga:10,"Tw Cen MT":10,"Tw Cen MT Condensed":7,"Tw Cen MT Condensed Extra Bold":9,"UD Digi Kyokasho N-B":10,"UD Digi Kyokasho NK-B":10,"UD Digi Kyokasho NK-R":10,"UD Digi Kyokasho NP-B":10,"UD Digi Kyokasho NP-R":10,"UD Digi Kyokasho N-R":10,Univers:10,"Univers Condensed":10,"Univers Condensed Light":8,"Univers Light":10,"Urdu Typesetting":10,Utsaah:8,Vani:11,Verdana:12,"Verdana Pro":12,"Verdana Pro Black":10,"Verdana Pro Cond":10,"Verdana Pro Cond Black":10,"Verdana Pro Cond Light":10,"Verdana Pro Cond SemiBold":10,"Verdana Pro Light":10,"Verdana Pro SemiBold":10,Vijaya:10,"Viner Hand ITC":13,Vivaldi:8,"Vladimir Script":9,Vrinda:11,Webdings:19,"Wide Latin":24,Wingdings:26,"Wingdings 2":22,"Wingdings 3":17,"Yet R":10,"Yu Gothic":11,"Yu Gothic Light":10,"Yu Gothic Medium":11,"Yu Gothic UI":10,"Yu Gothic UI Light":10,"Yu Gothic UI Semibold":11,"Yu Gothic UI Semilight":10,"Yu Mincho":10,"Yu Mincho Demibold":10,"Yu Mincho Light":10,"\u4eff\u5b8b":10,"\u534e\u6587\u4e2d\u5b8b":12,"\u534e\u6587\u4eff\u5b8b":9,"\u534e\u6587\u5b8b\u4f53":9,"\u534e\u6587\u5f69\u4e91":11,"\u534e\u6587\u65b0\u9b4f":11,"\u534e\u6587\u6977\u4f53":9,"\u534e\u6587\u7425\u73c0":11,"\u534e\u6587\u7ec6\u9ed1":11,"\u534e\u6587\u884c\u6977":10,"\u534e\u6587\u96b6\u4e66":8,"\u5b8b\u4f53":10,"\u5e7c\u5706":10,"\u5fae\u8f6f\u96c5\u9ed1":11,"\u5fae\u8f6f\u96c5\u9ed1 Light":11,"\u65b0\u5b8b\u4f53":10,"\u65b9\u6b63\u59da\u4f53":10,"\u65b9\u6b63\u8212\u4f53":10,"\u6977\u4f53":10,"\u7b49\u7ebf":10,"\u7b49\u7ebf Light":10,"\u96b6\u4e66":10,"\u9ed1\u4f53":10,"\u6e38\u30b4\u30b7\u30c3\u30af":11,"\uff2d\uff33 \uff30\u660e\u671d":10,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':10,"\u30e1\u30a4\u30ea\u30aa":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":10,"HG\u660e\u671dB":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":10},16:{"Gill Sans MT":11,Abadi:13,"Abadi Extra Light":12,"Agency FB":9,Aharoni:9,Aldhabi:7,Algerian:13,"Ami R":9,"Angsana New":7,AngsanaUPC:7,Aparajita:8,"Arabic Typesetting":7,Arial:12,"Arial Black":14,"Arial Narrow":10,"Arial Nova":12,"Arial Nova Cond":11,"Arial Nova Cond Light":9,"Arial Nova Light":12,"Arial Rounded MT Bold":12,"Baskerville Old Face":10,Batang:10,BatangChe:11,"Bauhaus 93":12,"Bell MT":11,Bembo:10,"Berlin Sans FB":13,"Berlin Sans FB Demi":13,"Bernard MT Condensed":10,"Blackadder ITC":8,"Bodoni MT":10,"Bodoni MT Black":14,"Bodoni MT Condensed":7,"Bodoni MT Poster Compressed":7,"Book Antiqua":11,"Bookman Old Style":13,"Bookshelf Symbol 7":16,"Bradley Hand ITC":14,"Britannic Bold":13,Broadway:14,"Browallia New":8,BrowalliaUPC:8,"Brush Script MT":11,Calibri:11,"Calibri Light":11,"Californian FB":12,"Calisto MT":11,Cambria:12,"Cambria Math":12,Candara:12,Castellar:15,Centaur:10,Century:12,"Century Gothic":12,"Century Schoolbook":12,Chiller:10,"Colonna MT":11,"Comic Sans MS":13,Consolas:12,Constantia:11,"Cooper Black":13,"Copperplate Gothic Bold":15,"Copperplate Gothic Light":15,Corbel:11,"Cordia New":8,CordiaUPC:8,"Courier New":13,"Curlz MT":11,Dante:9,DaunPenh:7,David:9,DilleniaUPC:7,DokChampa:12,Dotum:11,DotumChe:11,Dubai:11,"Dubai Light":11,"Dubai Medium":11,Ebrima:11,"Edwardian Script ITC":10,Elephant:16,"Engravers MT":14,"Eras Bold ITC":14,"Eras Demi ITC":13,"Eras Light ITC":11,"Eras Medium ITC":12,EucrosiaUPC:9,Euphemia:12,"Expo M":18,FangSong:11,"Felix Titling":12,"Footlight MT Light":12,Forte:11,"Franklin Gothic Book":12,"Franklin Gothic Demi":12,"Franklin Gothic Demi Cond":11,"Franklin Gothic Heavy":12,"Franklin Gothic Medium":12,"Franklin Gothic Medium Cond":11,FrankRuehl:9,FreesiaUPC:9,"Freestyle Script":8,"French Script MT":8,Gabriola:8,Gadugi:11,Garamond:10,Gautami:13,Georgia:13,"Georgia Pro":12,"Georgia Pro Black":15,"Georgia Pro Cond":11,"Georgia Pro Cond Black":13,"Georgia Pro Cond Light":11,"Georgia Pro Cond Semibold":12,"Georgia Pro Light":12,"Georgia Pro Semibold":13,Gigi:12,"Gill Sans MT Condensed":8,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":11,"Gill Sans Nova Cond":7,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":12,"Gill Sans Nova Cond XBd":11,"Gill Sans Nova Light":11,"Gill Sans Nova Ultra Bold":18,"Gill Sans Ultra Bold":18,"Gill Sans Ultra Bold Condensed":12,Gisha:11,"Gloucester MT Extra Condensed":8,"Goudy Old Style":11,"Goudy Stout":17,Grotesque:10,"Grotesque Light":10,Gulim:11,GulimChe:11,Gungsuh:11,GungsuhChe:11,"Hadassah Friedlaender":12,Haettenschweiler:9,"Harlow Solid Italic":10,Harrington:12,"Headline R":15,HGGothicE:11,HGGothicM:11,HGGyoshotai:11,HGKyokashotai:11,HGMaruGothicMPRO:16,HGMinchoB:12,HGMinchoE:12,HGPGothicE:12,HGPGothicM:13,HGPGyoshotai:11,HGPKyokashotai:11,HGPMinchoB:11,HGPMinchoE:12,HGPSoeiKakugothicUB:14,HGPSoeiKakupoptai:15,HGPSoeiPresenceEB:13,HGSeikaishotaiPRO:12,HGSGothicE:11,HGSGothicM:12,HGSGyoshotai:10,HGSKyokashotai:10,HGSMinchoB:11,HGSMinchoE:12,HGSoeiKakugothicUB:12,HGSoeiKakupoptai:12,HGSoeiPresenceEB:12,HGSSoeiKakugothicUB:13,HGSSoeiKakupoptai:14,HGSSoeiPresenceEB:12,"High Tower Text":10,"HYGothic-Extra":13,"HYGothic-Medium":12,"HYGraphic-Medium":12,"HYGungSo-Bold":12,"HYHeadLine-Medium":12,"HYMyeongJo-Extra":14,"HYPMokGak-Bold":15,"HYPost-Light":14,"HYPost-Medium":15,"HYShortSamul-Medium":8,"HYSinMyeongJo-Medium":13,Impact:11,"Imprint MT Shadow":11,"Informal Roman":11,"Ink Free":11,IrisUPC:11,"Iskoola Pota":11,JasmineUPC:10,"Javanese Text":12,Jokerman:15,"Juice ITC":8,KaiTi:11,Kalinga:12,Kartika:12,"Khmer UI":11,KodchiangUPC:7,Kokila:8,"Kristen ITC":13,"Kunstler Script":7,"Lao UI":11,Latha:11,Leelawadee:11,"Leelawadee UI":11,"Leelawadee UI Semilight":12,"Levenim MT":12,LilyUPC:9,"Lucida Bright":13,"Lucida Calligraphy":15,"Lucida Console":14,"Lucida Fax":14,"Lucida Handwriting":15,"Lucida Sans":14,"Lucida Sans Typewriter":13,"Lucida Sans Unicode":14,"Magic R":13,Magneto:16,"Maiandra GD":13,"Malgun Gothic":12,"Malgun Gothic Semilight":13,Mangal:12,Marlett:22,"Matura MT Script Capitals":15,Meiryo:14,"Meiryo UI":14,"Microsoft GothicNeo":12,"Microsoft Himalaya":8,"Microsoft JhengHei":13,"Microsoft JhengHei Light":13,"Microsoft JhengHei UI":13,"Microsoft JhengHei UI Light":13,"Microsoft New Tai Lue":12,"Microsoft PhagsPa":12,"Microsoft Sans Serif":13,"Microsoft Tai Le":12,"Microsoft Uighur":8,"Microsoft YaHei Light":13,"Microsoft YaHei UI":13,"Microsoft YaHei UI Light":13,"Microsoft Yi Baiti":12,MingLiU:12,MingLiU_HKSCS:12,"MingLiU_HKSCS-ExtB":12,"MingLiU-ExtB":12,Miriam:11,"Miriam Fixed":14,Mistral:10,"Modern No. 20":11,"MoeumT R":13,"Mongolian Baiti":12,"Monotype Corsiva":10,MoolBoran:8,"MS Gothic":11,"MS Mincho":12,"MS Outlook":12,"MS PGothic":12,"MS PMincho":12,"MS Reference Sans Serif":14,"MS Reference Specialty":26,"MS UI Gothic":12,"MT Extra":22,"MV Boli":16,"Myanmar Text":12,Narkisim:10,"Neue Haas Grotesk Text Pro":12,"New Gulim":13,"News Gothic MT":14,"Niagara Engraved":8,"Niagara Solid":8,"Nirmala UI":12,"Nirmala UI Semilight":13,Nyala:12,"OCR A Extended":14,OCRB:14,"Old English Text MT":12,Onyx:8,"Palace Script MT":8,"Palatino Linotype":11,Papyrus:14,Parchment:5,Perpetua:10,"Perpetua Titling MT":14,"Plantagenet Cherokee":12,Playbill:8,PMingLiU:11,"PMingLiU-ExtB":11,"Poor Richard":13,Pristina:11,"Pyunji R":11,Raavi:11,"Rage Italic":12,Ravie:21,Rockwell:11,"Rockwell Condensed":9,"Rockwell Extra Bold":14,"Rockwell Light":12,"Rockwell Nova":12,"Rockwell Nova Cond":12,"Rockwell Nova Cond Light":12,"Rockwell Nova Extra Bold":12,"Rockwell Nova Light":12,Rod:12,"Sakkal Majalla":12,"Sanskrit Text":13,"Script MT Bold":11,"Segoe MDL2 Assets":8,"Segoe Print":15,"Segoe Script":15,"Segoe UI":11,"Segoe UI Black":13,"Segoe UI Emoji":11,"Segoe UI Historic":11,"Segoe UI Light":11,"Segoe UI Semibold":12,"Segoe UI Semilight":11,"Segoe UI Symbol":11,Selawik:11,"Selawik Light":11,"Selawik Semibold":12,"Shonar Bangla":11,"Showcard Gothic":12,Shruti:13,"Simplified Arabic":11,"Simplified Arabic Fixed":13,"SimSun-ExtB":11,"Sitka Banner":11,"Sitka Display":11,"Sitka Heading":12,"Sitka Small":14,"Sitka Subheading":12,"Sitka Text":13,"Snap ITC":18,"Source Sans Pro":10,"Source Sans Pro Black":11,"Source Sans Pro ExtraLight":10,"Source Sans Pro Light":11,"Source Sans Pro SemiBold":11,Stencil:12,Sylfaen:11,Symbol:11,Tahoma:11,"Tempus Sans ITC":14,"TH SarabunPSK":8,"Times New Roman":11,"Traditional Arabic":10,"Trebuchet MS":11,Tunga:11,"Tw Cen MT":12,"Tw Cen MT Condensed":8,"Tw Cen MT Condensed Extra Bold":10,"UD Digi Kyokasho N-B":11,"UD Digi Kyokasho NK-B":11,"UD Digi Kyokasho NK-R":11,"UD Digi Kyokasho NP-B":11,"UD Digi Kyokasho NP-R":11,"UD Digi Kyokasho N-R":11,Univers:11,"Univers Condensed":11,"Univers Condensed Light":9,"Univers Light":11,"Urdu Typesetting":11,Utsaah:8,Vani:13,Verdana:13,"Verdana Pro":13,"Verdana Pro Black":11,"Verdana Pro Cond":11,"Verdana Pro Cond Black":11,"Verdana Pro Cond Light":11,"Verdana Pro Cond SemiBold":11,"Verdana Pro Light":11,"Verdana Pro SemiBold":11,Vijaya:11,"Viner Hand ITC":14,Vivaldi:9,"Vladimir Script":10,Vrinda:12,Webdings:21,"Wide Latin":26,Wingdings:28,"Wingdings 2":24,"Wingdings 3":19,"Yet R":11,"Yu Gothic":12,"Yu Gothic Light":11,"Yu Gothic Medium":12,"Yu Gothic UI":11,"Yu Gothic UI Light":11,"Yu Gothic UI Semibold":12,"Yu Gothic UI Semilight":12,"Yu Mincho":11,"Yu Mincho Demibold":11,"Yu Mincho Light":11,"\u4eff\u5b8b":11,"\u534e\u6587\u4e2d\u5b8b":13,"\u534e\u6587\u4eff\u5b8b":10,"\u534e\u6587\u5b8b\u4f53":10,"\u534e\u6587\u5f69\u4e91":12,"\u534e\u6587\u65b0\u9b4f":12,"\u534e\u6587\u6977\u4f53":10,"\u534e\u6587\u7425\u73c0":12,"\u534e\u6587\u7ec6\u9ed1":12,"\u534e\u6587\u884c\u6977":11,"\u534e\u6587\u96b6\u4e66":9,"\u5b8b\u4f53":11,"\u5e7c\u5706":11,"\u5fae\u8f6f\u96c5\u9ed1":12,"\u5fae\u8f6f\u96c5\u9ed1 Light":12,"\u65b0\u5b8b\u4f53":11,"\u65b9\u6b63\u59da\u4f53":11,"\u65b9\u6b63\u8212\u4f53":11,"\u6977\u4f53":11,"\u7b49\u7ebf":11,"\u7b49\u7ebf Light":11,"\u96b6\u4e66":11,"\u9ed1\u4f53":11,"\u6e38\u30b4\u30b7\u30c3\u30af":12,"\uff2d\uff33 \uff30\u660e\u671d":11,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':11,"\u30e1\u30a4\u30ea\u30aa":13,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":11,"HG\u660e\u671dB":11,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":11},18:{"Gill Sans MT":12,Abadi:15,"Abadi Extra Light":13,"Agency FB":10,Aharoni:10,Aldhabi:8,Algerian:14,"Ami R":10,"Angsana New":8,AngsanaUPC:8,Aparajita:10,"Arabic Typesetting":8,Arial:13,"Arial Black":16,"Arial Narrow":11,"Arial Nova":13,"Arial Nova Cond":12,"Arial Nova Cond Light":11,"Arial Nova Light":13,"Arial Rounded MT Bold":14,"Baskerville Old Face":12,Batang:12,BatangChe:12,"Bauhaus 93":14,"Bell MT":12,Bembo:12,"Berlin Sans FB":14,"Berlin Sans FB Demi":15,"Bernard MT Condensed":12,"Blackadder ITC":9,"Bodoni MT":12,"Bodoni MT Black":16,"Bodoni MT Condensed":8,"Bodoni MT Poster Compressed":8,"Book Antiqua":12,"Bookman Old Style":15,"Bookshelf Symbol 7":18,"Bradley Hand ITC":15,"Britannic Bold":15,Broadway:16,"Browallia New":9,BrowalliaUPC:9,"Brush Script MT":12,Calibri:12,"Calibri Light":12,"Californian FB":13,"Calisto MT":12,Cambria:13,"Cambria Math":13,Candara:13,Castellar:17,Centaur:12,Century:13,"Century Gothic":13,"Century Schoolbook":13,Chiller:11,"Colonna MT":12,"Comic Sans MS":15,Consolas:13,Constantia:13,"Cooper Black":14,"Copperplate Gothic Bold":17,"Copperplate Gothic Light":17,Corbel:13,"Cordia New":9,CordiaUPC:9,"Courier New":14,"Curlz MT":13,Dante:11,DaunPenh:8,David:11,DilleniaUPC:7,DokChampa:13,Dotum:13,DotumChe:12,Dubai:13,"Dubai Light":13,"Dubai Medium":13,Ebrima:13,"Edwardian Script ITC":11,Elephant:18,"Engravers MT":16,"Eras Bold ITC":16,"Eras Demi ITC":15,"Eras Light ITC":13,"Eras Medium ITC":14,EucrosiaUPC:10,Euphemia:14,"Expo M":21,FangSong:12,"Felix Titling":14,"Footlight MT Light":13,Forte:13,"Franklin Gothic Book":14,"Franklin Gothic Demi":14,"Franklin Gothic Demi Cond":12,"Franklin Gothic Heavy":14,"Franklin Gothic Medium":14,"Franklin Gothic Medium Cond":12,FrankRuehl:10,FreesiaUPC:11,"Freestyle Script":9,"French Script MT":9,Gabriola:10,Gadugi:13,Garamond:11,Gautami:14,Georgia:15,"Georgia Pro":14,"Georgia Pro Black":17,"Georgia Pro Cond":13,"Georgia Pro Cond Black":15,"Georgia Pro Cond Light":12,"Georgia Pro Cond Semibold":13,"Georgia Pro Light":13,"Georgia Pro Semibold":15,Gigi:12,"Gill Sans MT Condensed":9,"Gill Sans MT Ext Condensed Bold":8,"Gill Sans Nova":12,"Gill Sans Nova Cond":8,"Gill Sans Nova Cond Lt":7,"Gill Sans Nova Cond Ultra Bold":14,"Gill Sans Nova Cond XBd":13,"Gill Sans Nova Light":12,"Gill Sans Nova Ultra Bold":20,"Gill Sans Ultra Bold":21,"Gill Sans Ultra Bold Condensed":14,Gisha:13,"Gloucester MT Extra Condensed":9,"Goudy Old Style":12,"Goudy Stout":20,Grotesque:12,"Grotesque Light":12,Gulim:13,GulimChe:12,Gungsuh:13,GungsuhChe:12,"Hadassah Friedlaender":14,Haettenschweiler:11,"Harlow Solid Italic":11,Harrington:13,"Headline R":17,HGGothicE:12,HGGothicM:12,HGGyoshotai:12,HGKyokashotai:12,HGMaruGothicMPRO:18,HGMinchoB:13,HGMinchoE:13,HGPGothicE:14,HGPGothicM:15,HGPGyoshotai:12,HGPKyokashotai:12,HGPMinchoB:12,HGPMinchoE:13,HGPSoeiKakugothicUB:16,HGPSoeiKakupoptai:17,HGPSoeiPresenceEB:14,HGSeikaishotaiPRO:14,HGSGothicE:13,HGSGothicM:14,HGSGyoshotai:11,HGSKyokashotai:11,HGSMinchoB:12,HGSMinchoE:13,HGSoeiKakugothicUB:13,HGSoeiKakupoptai:13,HGSoeiPresenceEB:13,HGSSoeiKakugothicUB:15,HGSSoeiKakupoptai:16,HGSSoeiPresenceEB:13,"High Tower Text":12,"HYGothic-Extra":15,"HYGothic-Medium":14,"HYGraphic-Medium":14,"HYGungSo-Bold":14,"HYHeadLine-Medium":14,"HYMyeongJo-Extra":16,"HYPMokGak-Bold":17,"HYPost-Light":16,"HYPost-Medium":17,"HYShortSamul-Medium":9,"HYSinMyeongJo-Medium":15,Impact:13,"Imprint MT Shadow":12,"Informal Roman":13,"Ink Free":12,IrisUPC:12,"Iskoola Pota":12,JasmineUPC:11,"Javanese Text":14,Jokerman:17,"Juice ITC":8,KaiTi:12,Kalinga:13,Kartika:14,"Khmer UI":13,KodchiangUPC:8,Kokila:9,"Kristen ITC":14,"Kunstler Script":8,"Lao UI":13,Latha:12,Leelawadee:13,"Leelawadee UI":13,"Leelawadee UI Semilight":13,"Levenim MT":14,LilyUPC:11,"Lucida Bright":15,"Lucida Calligraphy":17,"Lucida Console":15,"Lucida Fax":16,"Lucida Handwriting":17,"Lucida Sans":16,"Lucida Sans Typewriter":14,"Lucida Sans Unicode":16,"Magic R":14,Magneto:19,"Maiandra GD":15,"Malgun Gothic":14,"Malgun Gothic Semilight":14,Mangal:14,Marlett:25,"Matura MT Script Capitals":17,Meiryo:16,"Meiryo UI":16,"Microsoft GothicNeo":13,"Microsoft Himalaya":9,"Microsoft JhengHei":14,"Microsoft JhengHei Light":15,"Microsoft JhengHei UI":14,"Microsoft JhengHei UI Light":15,"Microsoft New Tai Lue":14,"Microsoft PhagsPa":14,"Microsoft Sans Serif":14,"Microsoft Tai Le":14,"Microsoft Uighur":9,"Microsoft YaHei Light":15,"Microsoft YaHei UI":15,"Microsoft YaHei UI Light":15,"Microsoft Yi Baiti":13,MingLiU:13,MingLiU_HKSCS:13,"MingLiU_HKSCS-ExtB":13,"MingLiU-ExtB":13,Miriam:12,"Miriam Fixed":15,Mistral:12,"Modern No. 20":12,"MoeumT R":14,"Mongolian Baiti":13,"Monotype Corsiva":12,MoolBoran:9,"MS Gothic":12,"MS Mincho":13,"MS Outlook":13,"MS PGothic":13,"MS PMincho":13,"MS Reference Sans Serif":16,"MS Reference Specialty":30,"MS UI Gothic":13,"MT Extra":25,"MV Boli":18,"Myanmar Text":14,Narkisim:11,"Neue Haas Grotesk Text Pro":13,"New Gulim":15,"News Gothic MT":16,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":14,"Nirmala UI Semilight":14,Nyala:13,"OCR A Extended":15,OCRB:15,"Old English Text MT":13,Onyx:9,"Palace Script MT":9,"Palatino Linotype":12,Papyrus:15,Parchment:6,Perpetua:11,"Perpetua Titling MT":16,"Plantagenet Cherokee":13,Playbill:10,PMingLiU:12,"PMingLiU-ExtB":12,"Poor Richard":14,Pristina:13,"Pyunji R":13,Raavi:12,"Rage Italic":13,Ravie:24,Rockwell:13,"Rockwell Condensed":10,"Rockwell Extra Bold":17,"Rockwell Light":14,"Rockwell Nova":13,"Rockwell Nova Cond":13,"Rockwell Nova Cond Light":13,"Rockwell Nova Extra Bold":13,"Rockwell Nova Light":13,Rod:15,"Sakkal Majalla":10,"Sanskrit Text":15,"Script MT Bold":13,"Segoe MDL2 Assets":10,"Segoe Print":18,"Segoe Script":18,"Segoe UI":13,"Segoe UI Black":15,"Segoe UI Emoji":13,"Segoe UI Historic":13,"Segoe UI Light":12,"Segoe UI Semibold":14,"Segoe UI Semilight":13,"Segoe UI Symbol":13,Selawik:12,"Selawik Light":13,"Selawik Semibold":14,"Shonar Bangla":12,"Showcard Gothic":14,Shruti:14,"Simplified Arabic":13,"Simplified Arabic Fixed":14,"SimSun-ExtB":12,"Sitka Banner":12,"Sitka Display":13,"Sitka Heading":13,"Sitka Small":16,"Sitka Subheading":14,"Sitka Text":15,"Snap ITC":21,"Source Sans Pro":12,"Source Sans Pro Black":12,"Source Sans Pro ExtraLight":11,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":12,Stencil:14,Sylfaen:12,Symbol:12,Tahoma:13,"Tempus Sans ITC":16,"TH SarabunPSK":9,"Times New Roman":12,"Traditional Arabic":12,"Trebuchet MS":13,Tunga:13,"Tw Cen MT":13,"Tw Cen MT Condensed":9,"Tw Cen MT Condensed Extra Bold":12,"UD Digi Kyokasho N-B":12,"UD Digi Kyokasho NK-B":12,"UD Digi Kyokasho NK-R":12,"UD Digi Kyokasho NP-B":17,"UD Digi Kyokasho NP-R":12,"UD Digi Kyokasho N-R":12,Univers:12,"Univers Condensed":12,"Univers Condensed Light":11,"Univers Light":12,"Urdu Typesetting":12,Utsaah:10,Vani:15,Verdana:15,"Verdana Pro":15,"Verdana Pro Black":12,"Verdana Pro Cond":12,"Verdana Pro Cond Black":12,"Verdana Pro Cond Light":12,"Verdana Pro Cond SemiBold":12,"Verdana Pro Light":12,"Verdana Pro SemiBold":12,Vijaya:12,"Viner Hand ITC":16,Vivaldi:10,"Vladimir Script":11,Vrinda:14,Webdings:24,"Wide Latin":30,Wingdings:32,"Wingdings 2":27,"Wingdings 3":21,"Yet R":13,"Yu Gothic":13,"Yu Gothic Light":13,"Yu Gothic Medium":13,"Yu Gothic UI":13,"Yu Gothic UI Light":13,"Yu Gothic UI Semibold":14,"Yu Gothic UI Semilight":13,"Yu Mincho":13,"Yu Mincho Demibold":13,"Yu Mincho Light":12,"\u4eff\u5b8b":12,"\u534e\u6587\u4e2d\u5b8b":15,"\u534e\u6587\u4eff\u5b8b":11,"\u534e\u6587\u5b8b\u4f53":11,"\u534e\u6587\u5f69\u4e91":14,"\u534e\u6587\u65b0\u9b4f":14,"\u534e\u6587\u6977\u4f53":11,"\u534e\u6587\u7425\u73c0":14,"\u534e\u6587\u7ec6\u9ed1":13,"\u534e\u6587\u884c\u6977":12,"\u534e\u6587\u96b6\u4e66":11,"\u5b8b\u4f53":12,"\u5e7c\u5706":12,"\u5fae\u8f6f\u96c5\u9ed1":14,"\u5fae\u8f6f\u96c5\u9ed1 Light":14,"\u65b0\u5b8b\u4f53":12,"\u65b9\u6b63\u59da\u4f53":12,"\u65b9\u6b63\u8212\u4f53":13,"\u6977\u4f53":12,"\u7b49\u7ebf":13,"\u7b49\u7ebf Light":12,"\u96b6\u4e66":12,"\u9ed1\u4f53":12,"\u6e38\u30b4\u30b7\u30c3\u30af":13,"\uff2d\uff33 \uff30\u660e\u671d":12,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':12,"\u30e1\u30a4\u30ea\u30aa":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":12,"HG\u660e\u671dB":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":12},20:{"Gill Sans MT":14,Abadi:16,"Abadi Extra Light":15,"Agency FB":11,Aharoni:11,Aldhabi:9,Algerian:16,"Ami R":11,"Angsana New":9,AngsanaUPC:9,Aparajita:11,"Arabic Typesetting":9,Arial:15,"Arial Black":18,"Arial Narrow":12,"Arial Nova":15,"Arial Nova Cond":14,"Arial Nova Cond Light":12,"Arial Nova Light":15,"Arial Rounded MT Bold":16,"Baskerville Old Face":13,Batang:16,BatangChe:14,"Bauhaus 93":15,"Bell MT":14,Bembo:13,"Berlin Sans FB":16,"Berlin Sans FB Demi":17,"Bernard MT Condensed":13,"Blackadder ITC":11,"Bodoni MT":13,"Bodoni MT Black":18,"Bodoni MT Condensed":9,"Bodoni MT Poster Compressed":8,"Book Antiqua":14,"Bookman Old Style":17,"Bookshelf Symbol 7":20,"Bradley Hand ITC":17,"Britannic Bold":17,Broadway:17,"Browallia New":10,BrowalliaUPC:10,"Brush Script MT":14,Calibri:14,"Calibri Light":14,"Californian FB":14,"Calisto MT":14,Cambria:15,"Cambria Math":15,Candara:15,Castellar:19,Centaur:13,Century:15,"Century Gothic":15,"Century Schoolbook":15,Chiller:13,"Colonna MT":14,"Comic Sans MS":16,Consolas:15,Constantia:15,"Cooper Black":16,"Copperplate Gothic Bold":19,"Copperplate Gothic Light":19,Corbel:14,"Cordia New":10,CordiaUPC:10,"Courier New":16,"Curlz MT":15,Dante:12,DaunPenh:9,David:12,DilleniaUPC:8,DokChampa:15,Dotum:16,DotumChe:14,Dubai:15,"Dubai Light":15,"Dubai Medium":15,Ebrima:15,"Edwardian Script ITC":13,Elephant:20,"Engravers MT":17,"Eras Bold ITC":18,"Eras Demi ITC":16,"Eras Light ITC":14,"Eras Medium ITC":15,EucrosiaUPC:11,Euphemia:16,"Expo M":23,FangSong:14,"Felix Titling":16,"Footlight MT Light":15,Forte:14,"Franklin Gothic Book":16,"Franklin Gothic Demi":16,"Franklin Gothic Demi Cond":14,"Franklin Gothic Heavy":16,"Franklin Gothic Medium":16,"Franklin Gothic Medium Cond":14,FrankRuehl:11,FreesiaUPC:12,"Freestyle Script":10,"French Script MT":10,Gabriola:11,Gadugi:15,Garamond:13,Gautami:16,Georgia:17,"Georgia Pro":15,"Georgia Pro Black":19,"Georgia Pro Cond":14,"Georgia Pro Cond Black":17,"Georgia Pro Cond Light":14,"Georgia Pro Cond Semibold":15,"Georgia Pro Light":15,"Georgia Pro Semibold":17,Gigi:14,"Gill Sans MT Condensed":10,"Gill Sans MT Ext Condensed Bold":9,"Gill Sans Nova":14,"Gill Sans Nova Cond":9,"Gill Sans Nova Cond Lt":8,"Gill Sans Nova Cond Ultra Bold":16,"Gill Sans Nova Cond XBd":14,"Gill Sans Nova Light":14,"Gill Sans Nova Ultra Bold":23,"Gill Sans Ultra Bold":23,"Gill Sans Ultra Bold Condensed":16,Gisha:15,"Gloucester MT Extra Condensed":10,"Goudy Old Style":14,"Goudy Stout":22,Grotesque:13,"Grotesque Light":13,Gulim:16,GulimChe:14,Gungsuh:16,GungsuhChe:14,"Hadassah Friedlaender":15,Haettenschweiler:12,"Harlow Solid Italic":13,Harrington:15,"Headline R":19,HGGothicE:14,HGGothicM:14,HGGyoshotai:14,HGKyokashotai:14,HGMaruGothicMPRO:20,HGMinchoB:15,HGMinchoE:15,HGPGothicE:16,HGPGothicM:17,HGPGyoshotai:14,HGPKyokashotai:14,HGPMinchoB:14,HGPMinchoE:15,HGPSoeiKakugothicUB:18,HGPSoeiKakupoptai:19,HGPSoeiPresenceEB:16,HGSeikaishotaiPRO:16,HGSGothicE:15,HGSGothicM:16,HGSGyoshotai:13,HGSKyokashotai:13,HGSMinchoB:14,HGSMinchoE:15,HGSoeiKakugothicUB:15,HGSoeiKakupoptai:15,HGSoeiPresenceEB:15,HGSSoeiKakugothicUB:17,HGSSoeiKakupoptai:18,HGSSoeiPresenceEB:15,"High Tower Text":13,"HYGothic-Extra":17,"HYGothic-Medium":16,"HYGraphic-Medium":16,"HYGungSo-Bold":16,"HYHeadLine-Medium":16,"HYMyeongJo-Extra":18,"HYPMokGak-Bold":19,"HYPost-Light":18,"HYPost-Medium":19,"HYShortSamul-Medium":10,"HYSinMyeongJo-Medium":17,Impact:15,"Imprint MT Shadow":14,"Informal Roman":15,"Ink Free":14,IrisUPC:14,"Iskoola Pota":14,JasmineUPC:12,"Javanese Text":16,Jokerman:19,"Juice ITC":10,KaiTi:14,Kalinga:15,Kartika:16,"Khmer UI":15,KodchiangUPC:9,Kokila:10,"Kristen ITC":16,"Kunstler Script":10,"Lao UI":15,Latha:14,Leelawadee:15,"Leelawadee UI":15,"Leelawadee UI Semilight":15,"Levenim MT":15,LilyUPC:12,"Lucida Bright":16,"Lucida Calligraphy":19,"Lucida Console":17,"Lucida Fax":18,"Lucida Handwriting":19,"Lucida Sans":18,"Lucida Sans Typewriter":16,"Lucida Sans Unicode":18,"Magic R":16,Magneto:21,"Maiandra GD":17,"Malgun Gothic":16,"Malgun Gothic Semilight":16,Mangal:16,Marlett:28,"Matura MT Script Capitals":19,Meiryo:18,"Meiryo UI":18,"Microsoft GothicNeo":15,"Microsoft Himalaya":10,"Microsoft JhengHei":16,"Microsoft JhengHei Light":17,"Microsoft JhengHei UI":16,"Microsoft JhengHei UI Light":17,"Microsoft New Tai Lue":16,"Microsoft PhagsPa":16,"Microsoft Sans Serif":16,"Microsoft Tai Le":16,"Microsoft Uighur":10,"Microsoft YaHei Light":16,"Microsoft YaHei UI":17,"Microsoft YaHei UI Light":16,"Microsoft Yi Baiti":15,MingLiU:15,MingLiU_HKSCS:15,"MingLiU_HKSCS-ExtB":15,"MingLiU-ExtB":15,Miriam:14,"Miriam Fixed":17,Mistral:13,"Modern No. 20":13,"MoeumT R":16,"Mongolian Baiti":15,"Monotype Corsiva":13,MoolBoran:10,"MS Gothic":14,"MS Mincho":15,"MS Outlook":15,"MS PGothic":15,"MS PMincho":15,"MS Reference Sans Serif":18,"MS Reference Specialty":33,"MS UI Gothic":15,"MT Extra":29,"MV Boli":20,"Myanmar Text":16,Narkisim:12,"Neue Haas Grotesk Text Pro":15,"New Gulim":17,"News Gothic MT":18,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":16,"Nirmala UI Semilight":16,Nyala:15,"OCR A Extended":17,OCRB:17,"Old English Text MT":15,Onyx:9,"Palace Script MT":9,"Palatino Linotype":14,Papyrus:16,Parchment:7,Perpetua:12,"Perpetua Titling MT":18,"Plantagenet Cherokee":15,Playbill:11,PMingLiU:14,"PMingLiU-ExtB":14,"Poor Richard":16,Pristina:14,"Pyunji R":14,Raavi:14,"Rage Italic":15,Ravie:27,Rockwell:15,"Rockwell Condensed":12,"Rockwell Extra Bold":19,"Rockwell Light":15,"Rockwell Nova":15,"Rockwell Nova Cond":15,"Rockwell Nova Cond Light":15,"Rockwell Nova Extra Bold":15,"Rockwell Nova Light":15,Rod:17,"Sakkal Majalla":11,"Sanskrit Text":17,"Script MT Bold":14,"Segoe MDL2 Assets":11,"Segoe Print":20,"Segoe Script":20,"Segoe UI":15,"Segoe UI Black":17,"Segoe UI Emoji":15,"Segoe UI Historic":15,"Segoe UI Light":14,"Segoe UI Semibold":15,"Segoe UI Semilight":15,"Segoe UI Symbol":15,Selawik:14,"Selawik Light":14,"Selawik Semibold":15,"Shonar Bangla":14,"Showcard Gothic":16,Shruti:16,"Simplified Arabic":14,"Simplified Arabic Fixed":16,"SimSun-ExtB":14,"Sitka Banner":14,"Sitka Display":14,"Sitka Heading":15,"Sitka Small":18,"Sitka Subheading":16,"Sitka Text":17,"Snap ITC":23,"Source Sans Pro":13,"Source Sans Pro Black":14,"Source Sans Pro ExtraLight":12,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":14,Stencil:16,Sylfaen:14,Symbol:14,Tahoma:15,"Tempus Sans ITC":18,"TH SarabunPSK":10,"Times New Roman":14,"Traditional Arabic":13,"Trebuchet MS":14,Tunga:14,"Tw Cen MT":15,"Tw Cen MT Condensed":10,"Tw Cen MT Condensed Extra Bold":13,"UD Digi Kyokasho N-B":14,"UD Digi Kyokasho NK-B":14,"UD Digi Kyokasho NK-R":14,"UD Digi Kyokasho NP-B":19,"UD Digi Kyokasho NP-R":14,"UD Digi Kyokasho N-R":14,Univers:14,"Univers Condensed":14,"Univers Condensed Light":12,"Univers Light":14,"Urdu Typesetting":14,Utsaah:11,Vani:17,Verdana:17,"Verdana Pro":17,"Verdana Pro Black":14,"Verdana Pro Cond":14,"Verdana Pro Cond Black":14,"Verdana Pro Cond Light":14,"Verdana Pro Cond SemiBold":14,"Verdana Pro Light":14,"Verdana Pro SemiBold":14,Vijaya:14,"Viner Hand ITC":18,Vivaldi:12,"Vladimir Script":13,Vrinda:16,Webdings:27,"Wide Latin":33,Wingdings:36,"Wingdings 2":31,"Wingdings 3":24,"Yet R":14,"Yu Gothic":15,"Yu Gothic Light":14,"Yu Gothic Medium":15,"Yu Gothic UI":15,"Yu Gothic UI Light":14,"Yu Gothic UI Semibold":16,"Yu Gothic UI Semilight":15,"Yu Mincho":15,"Yu Mincho Demibold":14,"Yu Mincho Light":14,"\u4eff\u5b8b":14,"\u534e\u6587\u4e2d\u5b8b":17,"\u534e\u6587\u4eff\u5b8b":13,"\u534e\u6587\u5b8b\u4f53":13,"\u534e\u6587\u5f69\u4e91":15,"\u534e\u6587\u65b0\u9b4f":16,"\u534e\u6587\u6977\u4f53":13,"\u534e\u6587\u7425\u73c0":15,"\u534e\u6587\u7ec6\u9ed1":15,"\u534e\u6587\u884c\u6977":14,"\u534e\u6587\u96b6\u4e66":12,"\u5b8b\u4f53":14,"\u5e7c\u5706":14,"\u5fae\u8f6f\u96c5\u9ed1":16,"\u5fae\u8f6f\u96c5\u9ed1 Light":15,"\u65b0\u5b8b\u4f53":14,"\u65b9\u6b63\u59da\u4f53":14,"\u65b9\u6b63\u8212\u4f53":15,"\u6977\u4f53":14,"\u7b49\u7ebf":14,"\u7b49\u7ebf Light":14,"\u96b6\u4e66":14,"\u9ed1\u4f53":14,"\u6e38\u30b4\u30b7\u30c3\u30af":15,"\uff2d\uff33 \uff30\u660e\u671d":14,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':14,"\u30e1\u30a4\u30ea\u30aa":17,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":14,"HG\u660e\u671dB":14,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":14},22:{"Gill Sans MT":15,Abadi:18,"Abadi Extra Light":16,"Agency FB":11,Aharoni:12,Aldhabi:9,Algerian:17,"Ami R":12,"Angsana New":10,AngsanaUPC:10,Aparajita:12,"Arabic Typesetting":10,Arial:16,"Arial Black":19,"Arial Narrow":13,"Arial Nova":16,"Arial Nova Cond":15,"Arial Nova Cond Light":13,"Arial Nova Light":16,"Arial Rounded MT Bold":17,"Baskerville Old Face":14,Batang:17,BatangChe:15,"Bauhaus 93":16,"Bell MT":15,Bembo:14,"Berlin Sans FB":17,"Berlin Sans FB Demi":18,"Bernard MT Condensed":14,"Blackadder ITC":11,"Bodoni MT":14,"Bodoni MT Black":19,"Bodoni MT Condensed":10,"Bodoni MT Poster Compressed":9,"Book Antiqua":15,"Bookman Old Style":18,"Bookshelf Symbol 7":21,"Bradley Hand ITC":19,"Britannic Bold":18,Broadway:19,"Browallia New":11,BrowalliaUPC:11,"Brush Script MT":15,Calibri:15,"Calibri Light":15,"Californian FB":15,"Calisto MT":15,Cambria:16,"Cambria Math":16,Candara:16,Castellar:21,Centaur:14,Century:16,"Century Gothic":16,"Century Schoolbook":16,Chiller:14,"Colonna MT":15,"Comic Sans MS":18,Consolas:16,Constantia:16,"Cooper Black":17,"Copperplate Gothic Bold":21,"Copperplate Gothic Light":21,Corbel:15,"Cordia New":11,CordiaUPC:11,"Courier New":17,"Curlz MT":16,Dante:13,DaunPenh:10,David:13,DilleniaUPC:9,DokChampa:16,Dotum:17,DotumChe:15,Dubai:16,"Dubai Light":16,"Dubai Medium":16,Ebrima:16,"Edwardian Script ITC":14,Elephant:22,"Engravers MT":19,"Eras Bold ITC":19,"Eras Demi ITC":18,"Eras Light ITC":16,"Eras Medium ITC":17,EucrosiaUPC:12,Euphemia:17,"Expo M":25,FangSong:15,"Felix Titling":17,"Footlight MT Light":16,Forte:15,"Franklin Gothic Book":17,"Franklin Gothic Demi":17,"Franklin Gothic Demi Cond":15,"Franklin Gothic Heavy":17,"Franklin Gothic Medium":17,"Franklin Gothic Medium Cond":15,FrankRuehl:12,FreesiaUPC:13,"Freestyle Script":10,"French Script MT":11,Gabriola:12,Gadugi:16,Garamond:14,Gautami:17,Georgia:18,"Georgia Pro":16,"Georgia Pro Black":21,"Georgia Pro Cond":15,"Georgia Pro Cond Black":18,"Georgia Pro Cond Light":15,"Georgia Pro Cond Semibold":16,"Georgia Pro Light":16,"Georgia Pro Semibold":18,Gigi:14,"Gill Sans MT Condensed":11,"Gill Sans MT Ext Condensed Bold":10,"Gill Sans Nova":15,"Gill Sans Nova Cond":10,"Gill Sans Nova Cond Lt":9,"Gill Sans Nova Cond Ultra Bold":17,"Gill Sans Nova Cond XBd":15,"Gill Sans Nova Light":15,"Gill Sans Nova Ultra Bold":25,"Gill Sans Ultra Bold":25,"Gill Sans Ultra Bold Condensed":17,Gisha:16,"Gloucester MT Extra Condensed":11,"Goudy Old Style":15,"Goudy Stout":24,Grotesque:14,"Grotesque Light":14,Gulim:17,GulimChe:15,Gungsuh:17,GungsuhChe:15,"Hadassah Friedlaender":17,Haettenschweiler:13,"Harlow Solid Italic":14,Harrington:16,"Headline R":21,HGGothicE:15,HGGothicM:15,HGGyoshotai:15,HGKyokashotai:15,HGMaruGothicMPRO:22,HGMinchoB:16,HGMinchoE:16,HGPGothicE:17,HGPGothicM:18,HGPGyoshotai:15,HGPKyokashotai:14,HGPMinchoB:15,HGPMinchoE:16,HGPSoeiKakugothicUB:19,HGPSoeiKakupoptai:20,HGPSoeiPresenceEB:17,HGSeikaishotaiPRO:17,HGSGothicE:16,HGSGothicM:17,HGSGyoshotai:14,HGSKyokashotai:13,HGSMinchoB:15,HGSMinchoE:16,HGSoeiKakugothicUB:16,HGSoeiKakupoptai:16,HGSoeiPresenceEB:16,HGSSoeiKakugothicUB:18,HGSSoeiKakupoptai:19,HGSSoeiPresenceEB:16,"High Tower Text":14,"HYGothic-Extra":18,"HYGothic-Medium":17,"HYGraphic-Medium":17,"HYGungSo-Bold":17,"HYHeadLine-Medium":17,"HYMyeongJo-Extra":19,"HYPMokGak-Bold":21,"HYPost-Light":19,"HYPost-Medium":21,"HYShortSamul-Medium":11,"HYSinMyeongJo-Medium":18,Impact:16,"Imprint MT Shadow":15,"Informal Roman":16,"Ink Free":15,IrisUPC:15,"Iskoola Pota":15,JasmineUPC:13,"Javanese Text":17,Jokerman:21,"Juice ITC":11,KaiTi:15,Kalinga:16,Kartika:17,"Khmer UI":16,KodchiangUPC:10,Kokila:11,"Kristen ITC":17,"Kunstler Script":10,"Lao UI":16,Latha:15,Leelawadee:16,"Leelawadee UI":16,"Leelawadee UI Semilight":16,"Levenim MT":17,LilyUPC:13,"Lucida Bright":18,"Lucida Calligraphy":20,"Lucida Console":18,"Lucida Fax":19,"Lucida Handwriting":21,"Lucida Sans":19,"Lucida Sans Typewriter":17,"Lucida Sans Unicode":19,"Magic R":17,Magneto:22,"Maiandra GD":18,"Malgun Gothic":17,"Malgun Gothic Semilight":17,Mangal:17,Marlett:30,"Matura MT Script Capitals":20,Meiryo:20,"Meiryo UI":20,"Microsoft GothicNeo":16,"Microsoft Himalaya":11,"Microsoft JhengHei":17,"Microsoft JhengHei Light":18,"Microsoft JhengHei UI":17,"Microsoft JhengHei UI Light":18,"Microsoft New Tai Lue":17,"Microsoft PhagsPa":17,"Microsoft Sans Serif":17,"Microsoft Tai Le":17,"Microsoft Uighur":11,"Microsoft YaHei Light":18,"Microsoft YaHei UI":18,"Microsoft YaHei UI Light":18,"Microsoft Yi Baiti":16,MingLiU:16,MingLiU_HKSCS:16,"MingLiU_HKSCS-ExtB":16,"MingLiU-ExtB":16,Miriam:15,"Miriam Fixed":18,Mistral:14,"Modern No. 20":14,"MoeumT R":17,"Mongolian Baiti":16,"Monotype Corsiva":14,MoolBoran:11,"MS Gothic":15,"MS Mincho":16,"MS Outlook":16,"MS PGothic":16,"MS PMincho":16,"MS Reference Sans Serif":19,"MS Reference Specialty":36,"MS UI Gothic":16,"MT Extra":31,"MV Boli":21,"Myanmar Text":17,Narkisim:13,"Neue Haas Grotesk Text Pro":16,"New Gulim":18,"News Gothic MT":19,"Niagara Engraved":10,"Niagara Solid":10,"Nirmala UI":17,"Nirmala UI Semilight":17,Nyala:16,"OCR A Extended":19,OCRB:18,"Old English Text MT":16,Onyx:10,"Palace Script MT":10,"Palatino Linotype":15,Papyrus:18,Parchment:7,Perpetua:13,"Perpetua Titling MT":20,"Plantagenet Cherokee":16,Playbill:11,PMingLiU:15,"PMingLiU-ExtB":15,"Poor Richard":17,Pristina:15,"Pyunji R":15,Raavi:15,"Rage Italic":16,Ravie:29,Rockwell:16,"Rockwell Condensed":12,"Rockwell Extra Bold":20,"Rockwell Light":16,"Rockwell Nova":16,"Rockwell Nova Cond":16,"Rockwell Nova Cond Light":16,"Rockwell Nova Extra Bold":16,"Rockwell Nova Light":16,Rod:18,"Sakkal Majalla":12,"Sanskrit Text":18,"Script MT Bold":15,"Segoe MDL2 Assets":12,"Segoe Print":21,"Segoe Script":21,"Segoe UI":16,"Segoe UI Black":18,"Segoe UI Emoji":16,"Segoe UI Historic":16,"Segoe UI Light":15,"Segoe UI Semibold":17,"Segoe UI Semilight":16,"Segoe UI Symbol":16,Selawik:15,"Selawik Light":15,"Selawik Semibold":16,"Shonar Bangla":15,"Showcard Gothic":17,Shruti:17,"Simplified Arabic":15,"Simplified Arabic Fixed":17,"SimSun-ExtB":15,"Sitka Banner":15,"Sitka Display":15,"Sitka Heading":16,"Sitka Small":20,"Sitka Subheading":17,"Sitka Text":18,"Snap ITC":25,"Source Sans Pro":14,"Source Sans Pro Black":15,"Source Sans Pro ExtraLight":13,"Source Sans Pro Light":13,"Source Sans Pro SemiBold":14,Stencil:17,Sylfaen:15,Symbol:15,Tahoma:16,"Tempus Sans ITC":19,"TH SarabunPSK":11,"Times New Roman":15,"Traditional Arabic":14,"Trebuchet MS":15,Tunga:15,"Tw Cen MT":16,"Tw Cen MT Condensed":11,"Tw Cen MT Condensed Extra Bold":14,"UD Digi Kyokasho N-B":15,"UD Digi Kyokasho NK-B":15,"UD Digi Kyokasho NK-R":15,"UD Digi Kyokasho NP-B":21,"UD Digi Kyokasho NP-R":15,"UD Digi Kyokasho N-R":15,Univers:15,"Univers Condensed":15,"Univers Condensed Light":13,"Univers Light":15,"Urdu Typesetting":15,Utsaah:12,Vani:18,Verdana:18,"Verdana Pro":18,"Verdana Pro Black":15,"Verdana Pro Cond":15,"Verdana Pro Cond Black":15,"Verdana Pro Cond Light":15,"Verdana Pro Cond SemiBold":15,"Verdana Pro Light":15,"Verdana Pro SemiBold":15,Vijaya:12,"Viner Hand ITC":20,Vivaldi:12,"Vladimir Script":13,Vrinda:17,Webdings:29,"Wide Latin":36,Wingdings:39,"Wingdings 2":33,"Wingdings 3":26,"Yet R":16,"Yu Gothic":16,"Yu Gothic Light":16,"Yu Gothic Medium":16,"Yu Gothic UI":16,"Yu Gothic UI Light":15,"Yu Gothic UI Semibold":17,"Yu Gothic UI Semilight":16,"Yu Mincho":16,"Yu Mincho Demibold":15,"Yu Mincho Light":15,"\u4eff\u5b8b":15,"\u534e\u6587\u4e2d\u5b8b":18,"\u534e\u6587\u4eff\u5b8b":14,"\u534e\u6587\u5b8b\u4f53":14,"\u534e\u6587\u5f69\u4e91":16,"\u534e\u6587\u65b0\u9b4f":17,"\u534e\u6587\u6977\u4f53":14,"\u534e\u6587\u7425\u73c0":16,"\u534e\u6587\u7ec6\u9ed1":16,"\u534e\u6587\u884c\u6977":15,"\u534e\u6587\u96b6\u4e66":13,"\u5b8b\u4f53":15,"\u5e7c\u5706":15,"\u5fae\u8f6f\u96c5\u9ed1":17,"\u5fae\u8f6f\u96c5\u9ed1 Light":17,"\u65b0\u5b8b\u4f53":15,"\u65b9\u6b63\u59da\u4f53":15,"\u65b9\u6b63\u8212\u4f53":16,"\u6977\u4f53":15,"\u7b49\u7ebf":15,"\u7b49\u7ebf Light":15,"\u96b6\u4e66":15,"\u9ed1\u4f53":15,"\u6e38\u30b4\u30b7\u30c3\u30af":16,"\uff2d\uff33 \uff30\u660e\u671d":15,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':15,"\u30e1\u30a4\u30ea\u30aa":18,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":15,"HG\u660e\u671dB":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":15},24:{"Gill Sans MT":16,Abadi:19,"Abadi Extra Light":18,"Agency FB":14,Aharoni:13,Aldhabi:10,Algerian:19,"Ami R":13,"Angsana New":11,AngsanaUPC:11,Aparajita:13,"Arabic Typesetting":11,Arial:18,"Arial Black":21,"Arial Narrow":15,"Arial Nova":18,"Arial Nova Cond":16,"Arial Nova Cond Light":14,"Arial Nova Light":18,"Arial Rounded MT Bold":19,"Baskerville Old Face":16,Batang:19,BatangChe:16,"Bauhaus 93":18,"Bell MT":16,Bembo:16,"Berlin Sans FB":19,"Berlin Sans FB Demi":20,"Bernard MT Condensed":16,"Blackadder ITC":13,"Bodoni MT":16,"Bodoni MT Black":21,"Bodoni MT Condensed":11,"Bodoni MT Poster Compressed":9,"Book Antiqua":16,"Bookman Old Style":20,"Bookshelf Symbol 7":24,"Bradley Hand ITC":21,"Britannic Bold":20,Broadway:21,"Browallia New":12,BrowalliaUPC:12,"Brush Script MT":16,Calibri:16,"Calibri Light":16,"Californian FB":17,"Calisto MT":16,Cambria:18,"Cambria Math":18,Candara:18,Castellar:23,Centaur:16,Century:18,"Century Gothic":18,"Century Schoolbook":18,Chiller:15,"Colonna MT":16,"Comic Sans MS":20,Consolas:18,Constantia:17,"Cooper Black":19,"Copperplate Gothic Bold":23,"Copperplate Gothic Light":23,Corbel:17,"Cordia New":12,CordiaUPC:12,"Courier New":19,"Curlz MT":17,Dante:14,DaunPenh:11,David:14,DilleniaUPC:10,DokChampa:18,Dotum:19,DotumChe:16,Dubai:17,"Dubai Light":17,"Dubai Medium":17,Ebrima:17,"Edwardian Script ITC":15,Elephant:24,"Engravers MT":21,"Eras Bold ITC":21,"Eras Demi ITC":20,"Eras Light ITC":17,"Eras Medium ITC":18,EucrosiaUPC:13,Euphemia:19,"Expo M":28,FangSong:16,"Felix Titling":19,"Footlight MT Light":18,Forte:17,"Franklin Gothic Book":19,"Franklin Gothic Demi":19,"Franklin Gothic Demi Cond":16,"Franklin Gothic Heavy":19,"Franklin Gothic Medium":19,"Franklin Gothic Medium Cond":16,FrankRuehl:13,FreesiaUPC:14,"Freestyle Script":12,"French Script MT":12,Gabriola:13,Gadugi:17,Garamond:15,Gautami:19,Georgia:20,"Georgia Pro":18,"Georgia Pro Black":23,"Georgia Pro Cond":17,"Georgia Pro Cond Black":20,"Georgia Pro Cond Light":16,"Georgia Pro Cond Semibold":18,"Georgia Pro Light":18,"Georgia Pro Semibold":20,Gigi:17,"Gill Sans MT Condensed":12,"Gill Sans MT Ext Condensed Bold":11,"Gill Sans Nova":16,"Gill Sans Nova Cond":11,"Gill Sans Nova Cond Lt":10,"Gill Sans Nova Cond Ultra Bold":19,"Gill Sans Nova Cond XBd":17,"Gill Sans Nova Light":16,"Gill Sans Nova Ultra Bold":27,"Gill Sans Ultra Bold":27,"Gill Sans Ultra Bold Condensed":19,Gisha:17,"Gloucester MT Extra Condensed":12,"Goudy Old Style":16,"Goudy Stout":26,Grotesque:15,"Grotesque Light":15,Gulim:18,GulimChe:16,Gungsuh:19,GungsuhChe:16,"Hadassah Friedlaender":18,Haettenschweiler:14,"Harlow Solid Italic":15,Harrington:18,"Headline R":23,HGGothicE:16,HGGothicM:16,HGGyoshotai:16,HGKyokashotai:16,HGMaruGothicMPRO:24,HGMinchoB:17,HGMinchoE:17,HGPGothicE:18,HGPGothicM:20,HGPGyoshotai:16,HGPKyokashotai:16,HGPMinchoB:16,HGPMinchoE:18,HGPSoeiKakugothicUB:21,HGPSoeiKakupoptai:22,HGPSoeiPresenceEB:19,HGSeikaishotaiPRO:19,HGSGothicE:17,HGSGothicM:19,HGSGyoshotai:15,HGSKyokashotai:15,HGSMinchoB:16,HGSMinchoE:18,HGSoeiKakugothicUB:17,HGSoeiKakupoptai:17,HGSoeiPresenceEB:17,HGSSoeiKakugothicUB:20,HGSSoeiKakupoptai:21,HGSSoeiPresenceEB:18,"High Tower Text":15,"HYGothic-Extra":20,"HYGothic-Medium":19,"HYGraphic-Medium":19,"HYGungSo-Bold":19,"HYHeadLine-Medium":19,"HYMyeongJo-Extra":21,"HYPMokGak-Bold":23,"HYPost-Light":21,"HYPost-Medium":23,"HYShortSamul-Medium":12,"HYSinMyeongJo-Medium":20,Impact:17,"Imprint MT Shadow":16,"Informal Roman":17,"Ink Free":16,IrisUPC:16,"Iskoola Pota":16,JasmineUPC:15,"Javanese Text":19,Jokerman:23,"Juice ITC":11,KaiTi:16,Kalinga:18,Kartika:18,"Khmer UI":17,KodchiangUPC:11,Kokila:12,"Kristen ITC":19,"Kunstler Script":11,"Lao UI":17,Latha:16,Leelawadee:17,"Leelawadee UI":17,"Leelawadee UI Semilight":18,"Levenim MT":18,LilyUPC:14,"Lucida Bright":19,"Lucida Calligraphy":22,"Lucida Console":20,"Lucida Fax":21,"Lucida Handwriting":23,"Lucida Sans":21,"Lucida Sans Typewriter":19,"Lucida Sans Unicode":21,"Magic R":19,Magneto:25,"Maiandra GD":20,"Malgun Gothic":19,"Malgun Gothic Semilight":19,Mangal:18,Marlett:33,"Matura MT Script Capitals":22,Meiryo:22,"Meiryo UI":22,"Microsoft GothicNeo":17,"Microsoft Himalaya":12,"Microsoft JhengHei":19,"Microsoft JhengHei Light":19,"Microsoft JhengHei UI":19,"Microsoft JhengHei UI Light":19,"Microsoft New Tai Lue":18,"Microsoft PhagsPa":18,"Microsoft Sans Serif":19,"Microsoft Tai Le":18,"Microsoft Uighur":12,"Microsoft YaHei Light":19,"Microsoft YaHei UI":20,"Microsoft YaHei UI Light":19,"Microsoft Yi Baiti":17,MingLiU:17,MingLiU_HKSCS:17,"MingLiU_HKSCS-ExtB":17,"MingLiU-ExtB":17,Miriam:16,"Miriam Fixed":20,Mistral:15,"Modern No. 20":16,"MoeumT R":19,"Mongolian Baiti":17,"Monotype Corsiva":15,MoolBoran:12,"MS Gothic":16,"MS Mincho":17,"MS Outlook":17,"MS PGothic":17,"MS PMincho":17,"MS Reference Sans Serif":21,"MS Reference Specialty":39,"MS UI Gothic":17,"MT Extra":34,"MV Boli":23,"Myanmar Text":18,Narkisim:14,"Neue Haas Grotesk Text Pro":17,"New Gulim":19,"News Gothic MT":21,"Niagara Engraved":11,"Niagara Solid":11,"Nirmala UI":18,"Nirmala UI Semilight":19,Nyala:17,"OCR A Extended":20,OCRB:20,"Old English Text MT":17,Onyx:10,"Palace Script MT":11,"Palatino Linotype":16,Papyrus:20,Parchment:8,Perpetua:15,"Perpetua Titling MT":22,"Plantagenet Cherokee":18,Playbill:12,PMingLiU:16,"PMingLiU-ExtB":16,"Poor Richard":19,Pristina:16,"Pyunji R":17,Raavi:16,"Rage Italic":18,Ravie:31,Rockwell:17,"Rockwell Condensed":14,"Rockwell Extra Bold":22,"Rockwell Light":18,"Rockwell Nova":17,"Rockwell Nova Cond":17,"Rockwell Nova Cond Light":17,"Rockwell Nova Extra Bold":17,"Rockwell Nova Light":17,Rod:20,"Sakkal Majalla":13,"Sanskrit Text":19,"Script MT Bold":17,"Segoe MDL2 Assets":13,"Segoe Print":23,"Segoe Script":23,"Segoe UI":17,"Segoe UI Black":20,"Segoe UI Emoji":17,"Segoe UI Historic":17,"Segoe UI Light":16,"Segoe UI Semibold":18,"Segoe UI Semilight":17,"Segoe UI Symbol":17,Selawik:17,"Selawik Light":17,"Selawik Semibold":18,"Shonar Bangla":13,"Showcard Gothic":19,Shruti:19,"Simplified Arabic":17,"Simplified Arabic Fixed":19,"SimSun-ExtB":16,"Sitka Banner":16,"Sitka Display":17,"Sitka Heading":18,"Sitka Small":22,"Sitka Subheading":19,"Sitka Text":20,"Snap ITC":28,"Source Sans Pro":15,"Source Sans Pro Black":17,"Source Sans Pro ExtraLight":15,"Source Sans Pro Light":15,"Source Sans Pro SemiBold":16,Stencil:18,Sylfaen:16,Symbol:16,Tahoma:17,"Tempus Sans ITC":21,"TH SarabunPSK":12,"Times New Roman":16,"Traditional Arabic":16,"Trebuchet MS":17,Tunga:17,"Tw Cen MT":18,"Tw Cen MT Condensed":12,"Tw Cen MT Condensed Extra Bold":16,"UD Digi Kyokasho N-B":16,"UD Digi Kyokasho NK-B":16,"UD Digi Kyokasho NK-R":16,"UD Digi Kyokasho NP-B":23,"UD Digi Kyokasho NP-R":16,"UD Digi Kyokasho N-R":16,Univers:16,"Univers Condensed":16,"Univers Condensed Light":14,"Univers Light":16,"Urdu Typesetting":16,Utsaah:13,Vani:20,Verdana:20,"Verdana Pro":20,"Verdana Pro Black":16,"Verdana Pro Cond":16,"Verdana Pro Cond Black":16,"Verdana Pro Cond Light":16,"Verdana Pro Cond SemiBold":16,"Verdana Pro Light":16,"Verdana Pro SemiBold":16,Vijaya:13,"Viner Hand ITC":22,Vivaldi:14,"Vladimir Script":15,Vrinda:18,Webdings:32,"Wide Latin":40,Wingdings:43,"Wingdings 2":36,"Wingdings 3":29,"Yet R":17,"Yu Gothic":18,"Yu Gothic Light":17,"Yu Gothic Medium":18,"Yu Gothic UI":17,"Yu Gothic UI Light":17,"Yu Gothic UI Semibold":18,"Yu Gothic UI Semilight":18,"Yu Mincho":17,"Yu Mincho Demibold":17,"Yu Mincho Light":16,"\u4eff\u5b8b":16,"\u534e\u6587\u4e2d\u5b8b":20,"\u534e\u6587\u4eff\u5b8b":15,"\u534e\u6587\u5b8b\u4f53":15,"\u534e\u6587\u5f69\u4e91":18,"\u534e\u6587\u65b0\u9b4f":19,"\u534e\u6587\u6977\u4f53":15,"\u534e\u6587\u7425\u73c0":18,"\u534e\u6587\u7ec6\u9ed1":18,"\u534e\u6587\u884c\u6977":16,"\u534e\u6587\u96b6\u4e66":14,"\u5b8b\u4f53":16,"\u5e7c\u5706":16,"\u5fae\u8f6f\u96c5\u9ed1":19,"\u5fae\u8f6f\u96c5\u9ed1 Light":18,"\u65b0\u5b8b\u4f53":16,"\u65b9\u6b63\u59da\u4f53":16,"\u65b9\u6b63\u8212\u4f53":18,"\u6977\u4f53":16,"\u7b49\u7ebf":17,"\u7b49\u7ebf Light":16,"\u96b6\u4e66":16,"\u9ed1\u4f53":16,"\u6e38\u30b4\u30b7\u30c3\u30af":18,"\uff2d\uff33 \uff30\u660e\u671d":16,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':16,"\u30e1\u30a4\u30ea\u30aa":20,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":16,"HG\u660e\u671dB":16,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":16}},f.unknownFontMaxDigitWidthMap={},R.pixelToPoint=function(t){return 72*t/96},R.pointToPixel=function(t,n){return xe(96*t/72,n=void 0===n?2:n)},R.setMaxDigitWidth=function(t){var n,e,i,r,o,a,u,s,c,n=0;try{if((e=un("span")).style.font=t,i=e.style.fontSize,r=void 0,-1!==i.indexOf("px")?r=Math.round(R.pixelToPoint(parseFloat(i))):-1!==i.indexOf("pt")&&(r=Math.round(parseFloat(i))),!isNaN(r)&&r||(r=Math.round(R.pixelToPoint(parseFloat(t.match(/(\d|\.)+/)+"")))),(o=e.style.fontFamily)||t.split(" ").forEach(function(t){"normal"!==t&&"italic"!==t&&"bold"!==t&&-1===t.indexOf("px")&&-1===t.indexOf("pt")&&isNaN(+t)&&(o=t)}),o&&'"'===o[0]&&(o=o.slice(1,o.length-1)),f.unknownFontMaxDigitWidthMap[r]&&f.unknownFontMaxDigitWidthMap[r][o]?n=f.unknownFontMaxDigitWidthMap[r][o]:qt[r]&&qt[r][o]&&(n=qt[r][o]),0<n)return void(R.maxDigitWidth=n)}catch(t){}for(a="0123456789",u=0,(s=j()).font=t,c=0;c<a.length;c++)n<(u=s.measureText(a.charAt(c)).width)&&(n=u);return R.maxDigitWidth=0<n?n:R.maxDigitWidth},R.defaultColumnWidthToPixel=function(t){var n,t,n=2*Math.ceil(R.maxDigitWidth/4)+1,t=R.columnWidthToPixel(t)+n;return 8*Math.ceil(t/8)},R.columnWidthToPixel=function(t){return 0===t?0:Math.floor(Math.floor(256*t)/256*R.maxDigitWidth+.5)},R.pixelToColumnWidth=function(t){var n,t;return 0===t?0:(n=R.maxDigitWidth,t=Math.floor((t-5)/n*100+.5)/100,Math.floor((t*n+5)/n*256)/256)},R.maxDigitWidth=7,f.SJSColumnWidthHelper=R,Ne.prototype.equals=function(t){var n=this;return n===t||!!t&&n.numberFormatId===t.numberFormatId&&n.numberFormatCode===t.numberFormatCode},Ne.prototype.compose=function(t){var n=this;n.numberFormatId===A&&(n.numberFormatId=t.numberFormatId),n.numberFormatCode===A&&(n.numberFormatCode=t.numberFormatCode)},Ne.prototype.clone=function(){var t=this;return new Ne(t.numberFormatId,t.numberFormatCode)},f.ExcelNumerFormat=Ne,f.AL=_e,f.resetFillStyle=De,f.i2e=je,f.rangeToFormula=Oe,f.RF=Ee,a.isBase64ImageStr=function(t){return"string"==typeof t&&a.BASE64_IMAGE_REGULAR.test(t)},a.isSVGBase64ImageStr=function(t){return"string"==typeof t&&0===t.indexOf(a.SVG_IMAGE_DATA_URL_PREFIX)},a.isVectorBase64ImageStr=function(t){return a.isSVGBase64ImageStr(t)},a.loadImageElement=function(n,e,i){var r=new P.Wh(function(){var t;r.qh(n)&&(t=r.getImage(n))?e(t):i&&i(),r.L0(),r=A});r.addImage(n,"anonymous")},a.loadBase64ImageByUrl=function(t,i,r){a.loadImageElement(t,function(t){var n,e,n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0);try{e=n.toDataURL(),i(e)}catch(t){r&&r()}},r)},a.BASE64_IMAGE_REGULAR=/^data:image\/(.*);base64,(.*)$/,a.SVG_IMAGE_DATA_URL_PREFIX="data:image/svg+xml;base64,",f.oCe=a,f.handleRestoredTableResizedArgs=Re},"./dist/core/util/crypto.js":function(t,n){"use strict";var e,s,c,p,i,f,r,nt,l,o,a,h,u,d,v,m;function g(t,n){this.bits=t,this.init(n)}function b(t,n,e){var i,r,o,a,u,i=this;for(128<t.length&&(t=new l(n,!0).update(t).digest()),r=[],o=[],a=0;a<128;++a)u=t[a]||0,r[a]=92^u,o[a]=54^u;return(i=m.call(this,n,e)||this).update(o),i.oKeyPad=r,i.inner=!0,i.sharedMemory=e,i}for(e=this&&this.__extends||(v=function(t,n){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.e1e=n.i1e=n.Qoe=void 0,s="input is invalid type",c="finalize already called",p="0123456789abcdef".split(""),i=[],f=[24,16,8,0],r=[-2147483648,8388608,32768,128],nt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],g.prototype.init=function(t){t?(i[0]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=i[16]=i[17]=i[18]=i[19]=i[20]=i[21]=i[22]=i[23]=i[24]=i[25]=i[26]=i[27]=i[28]=i[29]=i[30]=i[31]=i[32]=0,this.blocks=i):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var t=this.bits;384===t?(this.h0h=3418070365,this.h0l=3238371032,this.h1h=1654270250,this.h1l=914150663,this.h2h=2438529370,this.h2l=812702999,this.h3h=355462360,this.h3l=4144912697,this.h4h=1731405415,this.h4l=4290775857,this.h5h=2394180231,this.h5l=1750603025,this.h6h=3675008525,this.h6l=1694076839,this.h7h=1203062813,this.h7l=3204075428):256===t?(this.h0h=573645204,this.h0l=4230739756,this.h1h=2673172387,this.h1l=3360449730,this.h2h=596883563,this.h2l=1867755857,this.h3h=2520282905,this.h3l=1497426621,this.h4h=2519219938,this.h4l=2827943907,this.h5h=3193839141,this.h5l=1401305490,this.h6h=721525244,this.h6l=746961066,this.h7h=246885852,this.h7l=2177182882):224===t?(this.h0h=2352822216,this.h0l=424955298,this.h1h=1944164710,this.h1l=2312950998,this.h2h=502970286,this.h2l=855612546,this.h3h=1738396948,this.h3l=1479516111,this.h4h=258812777,this.h4l=2077511080,this.h5h=2011393907,this.h5l=79989058,this.h6h=1067287976,this.h6l=1780299464,this.h7h=286451373,this.h7l=2446758561):(this.h0h=1779033703,this.h0l=4089235720,this.h1h=3144134277,this.h1l=2227873595,this.h2h=1013904242,this.h2l=4271175723,this.h3h=2773480762,this.h3l=1595750129,this.h4h=1359893119,this.h4l=2917565137,this.h5h=2600822924,this.h5l=725511199,this.h6h=528734635,this.h6l=4215389547,this.h7h=1541459225,this.h7l=327033209),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1},g.prototype.update=function(t){var n,e,i,r,o,a,u;if(this.finalized)throw new Error(c);if("string"!=(e=typeof t)){if("object"!=e)throw new Error(s);if(null===t)throw new Error(s);if(!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error(s);n=!0}for(r=0,a=t.length,u=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,u[0]=this.block,u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=u[16]=u[17]=u[18]=u[19]=u[20]=u[21]=u[22]=u[23]=u[24]=u[25]=u[26]=u[27]=u[28]=u[29]=u[30]=u[31]=u[32]=0),n)for(o=this.start;r<a&&o<128;++r)u[o>>2]|=t[r]<<f[3&o++];else for(o=this.start;r<a&&o<128;++r)(i=t.charCodeAt(r))<128?u[o>>2]|=i<<f[3&o++]:(i<2048?u[o>>2]|=(192|i>>6)<<f[3&o++]:(i<55296||57344<=i?u[o>>2]|=(224|i>>12)<<f[3&o++]:(i=65536+((1023&i)<<10|1023&t.charCodeAt(++r)),u[o>>2]|=(240|i>>18)<<f[3&o++],u[o>>2]|=(128|i>>12&63)<<f[3&o++]),u[o>>2]|=(128|i>>6&63)<<f[3&o++]),u[o>>2]|=(128|63&i)<<f[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,128<=o?(this.block=u[32],this.start=o-128,this.hash(),this.hashed=!0):this.start=o}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this},g.prototype.finalize=function(){var t,n;this.finalized||(this.finalized=!0,t=this.blocks,n=this.lastByteIndex,t[32]=this.block,t[n>>2]|=r[3&n],this.block=t[32],112<=n&&(this.hashed||this.hash(),t[0]=this.block,t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=t[16]=t[17]=t[18]=t[19]=t[20]=t[21]=t[22]=t[23]=t[24]=t[25]=t[26]=t[27]=t[28]=t[29]=t[30]=t[31]=t[32]=0),t[30]=this.hBytes<<3|this.bytes>>>29,t[31]=this.bytes<<3,this.hash())},g.prototype.hash=function(){for(var F,L,B,P,G,U,H,V,z,Y,Z,W,Q,J,K,X,t,n,e,i,r,o,a,u,s,c,f,l,q,f,l,q,$,tt,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,E,R,F=this.h0h,L=this.h0l,B=this.h1h,P=this.h1l,G=this.h2h,U=this.h2l,H=this.h3h,V=this.h3l,z=this.h4h,Y=this.h4l,Z=this.h5h,W=this.h5l,Q=this.h6h,J=this.h6l,K=this.h7h,X=this.h7l,t=this.blocks,n=32;n<160;n+=2)e=((v=t[n-30])>>>1|(m=t[n-29])<<31)^(v>>>8|m<<24)^v>>>7,i=(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25),r=((v=t[n-4])>>>19|(m=t[n-3])<<13)^(m>>>29|v<<3)^v>>>6,o=(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26),v=t[n-32],m=t[n-31],g=t[n-14],p=t[n-13],t[n]=(c=(g>>>16)+(v>>>16)+(e>>>16)+(r>>>16)+((s=(65535&g)+(65535&v)+(65535&e)+(65535&r)+((u=(p>>>16)+(m>>>16)+(i>>>16)+(o>>>16)+((a=(65535&p)+(65535&m)+(65535&i)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&s,t[n+1]=u<<16|65535&a;for(y=F,M=L,I=H,x=V,N=z,k=Y,_=Z,D=W,j=Q,O=J,E=K,R=X,$=(C=B)&(T=G),tt=(S=P)&(A=U),n=0;n<160;n+=8)v=t[n],m=t[n+1],v=(c=((g=nt[n])>>>16)+(v>>>16)+((b=N&_^~N&j)>>>16)+((r=(N>>>14|k<<18)^(N>>>18|k<<14)^(k>>>9|N<<23))>>>16)+(E>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&E)+((u=((p=nt[n+1])>>>16)+(m>>>16)+((w=k&D^~k&O)>>>16)+((o=(k>>>14|N<<18)^(k>>>18|N<<14)^(N>>>9|k<<23))>>>16)+(R>>>16)+((a=(65535&p)+(65535&m)+(65535&w)+(65535&o)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=(f=y&C)^y&T^$)>>>16)+((e=(y>>>28|M<<4)^(M>>>2|y<<30)^(M>>>7|y<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(l=M&S)^M&A^tt)>>>16)+((i=(M>>>28|y<<4)^(y>>>2|M<<30)^(y>>>7|M<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,E=(c=(I>>>16)+(v>>>16)+((s=(65535&I)+(65535&v)+((u=(x>>>16)+(m>>>16)+((a=(65535&x)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,R=u<<16|65535&a,I=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,x=u<<16|65535&a,v=t[n+2],m=t[n+3],v=(c=((g=nt[n+2])>>>16)+(v>>>16)+((b=E&N^~E&_)>>>16)+((r=(E>>>14|R<<18)^(E>>>18|R<<14)^(R>>>9|E<<23))>>>16)+(j>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&j)+((u=((p=nt[n+3])>>>16)+(m>>>16)+((w=R&k^~R&D)>>>16)+((o=(R>>>14|E<<18)^(R>>>18|E<<14)^(E>>>9|R<<23))>>>16)+(O>>>16)+((a=(65535&p)+(65535&m)+(65535&w)+(65535&o)+(65535&O))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=(q=I&y)^I&C^f)>>>16)+((e=(I>>>28|x<<4)^(x>>>2|I<<30)^(x>>>7|I<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(f=x&M)^x&S^l)>>>16)+((i=(x>>>28|I<<4)^(I>>>2|x<<30)^(I>>>7|x<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,j=(c=(T>>>16)+(v>>>16)+((s=(65535&T)+(65535&v)+((u=(A>>>16)+(m>>>16)+((a=(65535&A)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,O=u<<16|65535&a,T=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,A=u<<16|65535&a,v=t[n+4],m=t[n+5],v=(c=((g=nt[n+4])>>>16)+(v>>>16)+((b=j&E^~j&N)>>>16)+((r=(j>>>14|O<<18)^(j>>>18|O<<14)^(O>>>9|j<<23))>>>16)+(_>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&_)+((u=((p=nt[n+5])>>>16)+(m>>>16)+((w=O&R^~O&k)>>>16)+((o=(O>>>14|j<<18)^(O>>>18|j<<14)^(j>>>9|O<<23))>>>16)+(D>>>16)+((a=(65535&p)+(65535&m)+(65535&w)+(65535&o)+(65535&D))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=(l=T&I)^T&y^q)>>>16)+((e=(T>>>28|A<<4)^(A>>>2|T<<30)^(A>>>7|T<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(q=A&x)^A&M^f)>>>16)+((i=(A>>>28|T<<4)^(T>>>2|A<<30)^(T>>>7|A<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,_=(c=(C>>>16)+(v>>>16)+((s=(65535&C)+(65535&v)+((u=(S>>>16)+(m>>>16)+((a=(65535&S)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,D=u<<16|65535&a,C=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,S=u<<16|65535&a,v=t[n+6],m=t[n+7],v=(c=((g=nt[n+6])>>>16)+(v>>>16)+((b=_&j^~_&E)>>>16)+((r=(_>>>14|D<<18)^(_>>>18|D<<14)^(D>>>9|_<<23))>>>16)+(N>>>16)+((s=(65535&g)+(65535&v)+(65535&b)+(65535&r)+(65535&N)+((u=((p=nt[n+7])>>>16)+(m>>>16)+((w=D&O^~D&R)>>>16)+((o=(D>>>14|_<<18)^(D>>>18|_<<14)^(_>>>9|D<<23))>>>16)+(k>>>16)+((a=(65535&p)+(65535&m)+(65535&w)+(65535&o)+(65535&k))>>>16))>>>16))>>>16))<<16|65535&s,m=u<<16|65535&a,g=(c=((h=($=C&T)^C&I^l)>>>16)+((e=(C>>>28|S<<4)^(S>>>2|C<<30)^(S>>>7|C<<25))>>>16)+((s=(65535&h)+(65535&e)+((u=((d=(tt=S&A)^S&x^q)>>>16)+((i=(S>>>28|C<<4)^(C>>>2|S<<30)^(C>>>7|S<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,p=u<<16|65535&a,N=(c=(y>>>16)+(v>>>16)+((s=(65535&y)+(65535&v)+((u=(M>>>16)+(m>>>16)+((a=(65535&M)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,k=u<<16|65535&a,y=(c=(g>>>16)+(v>>>16)+((s=(65535&g)+(65535&v)+((u=(p>>>16)+(m>>>16)+((a=(65535&p)+(65535&m))>>>16))>>>16))>>>16))<<16|65535&s,M=u<<16|65535&a;this.h0h=(c=(F>>>16)+(y>>>16)+((s=(65535&F)+(65535&y)+((u=(L>>>16)+(M>>>16)+((a=(65535&L)+(65535&M))>>>16))>>>16))>>>16))<<16|65535&s,this.h0l=u<<16|65535&a,this.h1h=(c=(B>>>16)+(C>>>16)+((s=(65535&B)+(65535&C)+((u=(P>>>16)+(S>>>16)+((a=(65535&P)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,this.h1l=u<<16|65535&a,this.h2h=(c=(G>>>16)+(T>>>16)+((s=(65535&G)+(65535&T)+((u=(U>>>16)+(A>>>16)+((a=(65535&U)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,this.h2l=u<<16|65535&a,this.h3h=(c=(H>>>16)+(I>>>16)+((s=(65535&H)+(65535&I)+((u=(V>>>16)+(x>>>16)+((a=(65535&V)+(65535&x))>>>16))>>>16))>>>16))<<16|65535&s,this.h3l=u<<16|65535&a,this.h4h=(c=(z>>>16)+(N>>>16)+((s=(65535&z)+(65535&N)+((u=(Y>>>16)+(k>>>16)+((a=(65535&Y)+(65535&k))>>>16))>>>16))>>>16))<<16|65535&s,this.h4l=u<<16|65535&a,this.h5h=(c=(Z>>>16)+(_>>>16)+((s=(65535&Z)+(65535&_)+((u=(W>>>16)+(D>>>16)+((a=(65535&W)+(65535&D))>>>16))>>>16))>>>16))<<16|65535&s,this.h5l=u<<16|65535&a,this.h6h=(c=(Q>>>16)+(j>>>16)+((s=(65535&Q)+(65535&j)+((u=(J>>>16)+(O>>>16)+((a=(65535&J)+(65535&O))>>>16))>>>16))>>>16))<<16|65535&s,this.h6l=u<<16|65535&a,this.h7h=(c=(K>>>16)+(E>>>16)+((s=(65535&K)+(65535&E)+((u=(X>>>16)+(R>>>16)+((a=(65535&X)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&s,this.h7l=u<<16|65535&a},g.prototype.hex=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t;return this.finalize(),t=this.h0h,n=this.h0l,e=this.h1h,i=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,u=this.h3l,s=this.h4h,c=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,v=this.h7h,m=this.h7l,g=this.bits,t=p[t>>28&15]+p[t>>24&15]+p[t>>20&15]+p[t>>16&15]+p[t>>12&15]+p[t>>8&15]+p[t>>4&15]+p[15&t]+p[n>>28&15]+p[n>>24&15]+p[n>>20&15]+p[n>>16&15]+p[n>>12&15]+p[n>>8&15]+p[n>>4&15]+p[15&n]+p[e>>28&15]+p[e>>24&15]+p[e>>20&15]+p[e>>16&15]+p[e>>12&15]+p[e>>8&15]+p[e>>4&15]+p[15&e]+p[i>>28&15]+p[i>>24&15]+p[i>>20&15]+p[i>>16&15]+p[i>>12&15]+p[i>>8&15]+p[i>>4&15]+p[15&i]+p[r>>28&15]+p[r>>24&15]+p[r>>20&15]+p[r>>16&15]+p[r>>12&15]+p[r>>8&15]+p[r>>4&15]+p[15&r]+p[o>>28&15]+p[o>>24&15]+p[o>>20&15]+p[o>>16&15]+p[o>>12&15]+p[o>>8&15]+p[o>>4&15]+p[15&o]+p[a>>28&15]+p[a>>24&15]+p[a>>20&15]+p[a>>16&15]+p[a>>12&15]+p[a>>8&15]+p[a>>4&15]+p[15&a],256<=g&&(t+=p[u>>28&15]+p[u>>24&15]+p[u>>20&15]+p[u>>16&15]+p[u>>12&15]+p[u>>8&15]+p[u>>4&15]+p[15&u]),384<=g&&(t+=p[s>>28&15]+p[s>>24&15]+p[s>>20&15]+p[s>>16&15]+p[s>>12&15]+p[s>>8&15]+p[s>>4&15]+p[15&s]+p[c>>28&15]+p[c>>24&15]+p[c>>20&15]+p[c>>16&15]+p[c>>12&15]+p[c>>8&15]+p[c>>4&15]+p[15&c]+p[f>>28&15]+p[f>>24&15]+p[f>>20&15]+p[f>>16&15]+p[f>>12&15]+p[f>>8&15]+p[f>>4&15]+p[15&f]+p[l>>28&15]+p[l>>24&15]+p[l>>20&15]+p[l>>16&15]+p[l>>12&15]+p[l>>8&15]+p[l>>4&15]+p[15&l]),512===g&&(t+=p[h>>28&15]+p[h>>24&15]+p[h>>20&15]+p[h>>16&15]+p[h>>12&15]+p[h>>8&15]+p[h>>4&15]+p[15&h]+p[d>>28&15]+p[d>>24&15]+p[d>>20&15]+p[d>>16&15]+p[d>>12&15]+p[d>>8&15]+p[d>>4&15]+p[15&d]+p[v>>28&15]+p[v>>24&15]+p[v>>20&15]+p[v>>16&15]+p[v>>12&15]+p[v>>8&15]+p[v>>4&15]+p[15&v]+p[m>>28&15]+p[m>>24&15]+p[m>>20&15]+p[m>>16&15]+p[m>>12&15]+p[m>>8&15]+p[m>>4&15]+p[15&m]),t},g.prototype.digest=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n,t;return this.finalize(),t=this.h0h,n=this.h0l,e=this.h1h,i=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,u=this.h3l,s=this.h4h,c=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,v=this.h7h,m=this.h7l,t=[t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24&255,i>>16&255,i>>8&255,255&i,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a],256<=(n=this.bits)&&t.push(u>>24&255,u>>16&255,u>>8&255,255&u),384<=n&&t.push(s>>24&255,s>>16&255,s>>8&255,255&s,c>>24&255,c>>16&255,c>>8&255,255&c,f>>24&255,f>>16&255,f>>8&255,255&f,l>>24&255,l>>16&255,l>>8&255,255&l),512===n&&t.push(h>>24&255,h>>16&255,h>>8&255,255&h,d>>24&255,d>>16&255,d>>8&255,255&d,v>>24&255,v>>16&255,v>>8&255,255&v,m>>24&255,m>>16&255,m>>8&255,255&m),t},g.prototype.arrayBuffer=function(){var t,n,e;return this.finalize(),t=this.bits,n=new ArrayBuffer(t/8),(e=new DataView(n)).setUint32(0,this.h0h),e.setUint32(4,this.h0l),e.setUint32(8,this.h1h),e.setUint32(12,this.h1l),e.setUint32(16,this.h2h),e.setUint32(20,this.h2l),e.setUint32(24,this.h3h),256<=t&&e.setUint32(28,this.h3l),384<=t&&(e.setUint32(32,this.h4h),e.setUint32(36,this.h4l),e.setUint32(40,this.h5h),e.setUint32(44,this.h5l)),512===t&&(e.setUint32(48,this.h6h),e.setUint32(52,this.h6l),e.setUint32(56,this.h7h),e.setUint32(60,this.h7l)),n},g.prototype.clone=function(){var t=new g(this.bits,!1);return this.copyTo(t),t},g.prototype.copyTo=function(t){for(var n,e=["h0h","h0l","h1h","h1l","h2h","h2l","h3h","h3l","h4h","h4l","h5h","h5l","h6h","h6l","h7h","h7l","start","bytes","hBytes","finalized","hashed","lastByteIndex"],n=0;n<e.length;++n)t[e[n]]=this[e[n]];for(n=0;n<this.blocks.length;++n)t.blocks[n]=this.blocks[n]},l=g,n.i1e=l,e(b,m=l),b.prototype.finalize=function(){var t;m.prototype.finalize.call(this),this.inner&&(this.inner=!1,t=this.digest(),this.init(this.sharedMemory),this.update(this.oKeyPad),this.update(t),m.prototype.finalize.call(this))},n.e1e=b,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=new Uint8Array(255),u=0;u<a.length;u++)h[a.charCodeAt(u)]=u;function w(){}w.r1e=function(t){var n=new Uint8Array(4);return n[0]=255&t,n[1]=(65280&t)>>8,n[2]=(16711680&t)>>16,n[3]=(4278190080&t)>>24,n},w.Joe=function(t){var n,e,i,r,o,a,u,s,n,c,n=.75*t.length,e=t.length,r=0;for("="===t[t.length-1]&&(n--,"="===t[t.length-2])&&n--,n=new ArrayBuffer(n),c=new Uint8Array(n),i=0;i<e;i+=4)o=h[t.charCodeAt(i)],a=h[t.charCodeAt(i+1)],u=h[t.charCodeAt(i+2)],s=h[t.charCodeAt(i+3)],c[r++]=o<<2|a>>4,c[r++]=(15&a)<<4|u>>2,c[r++]=(3&u)<<6|63&s;return new Uint8Array(n)},w.Xoe=function(t){for(var n,e=t.length,i="",n=0;n<e;n+=3)i=(i=(i=(i+=a[t[n]>>2])+a[(3&t[n])<<4|t[n+1]>>4])+a[(15&t[n+1])<<2|t[n+2]>>6])+a[63&t[n+2]];return e%3==2?i=i.substring(0,i.length-1)+"=":e%3==1&&(i=i.substring(0,i.length-2)+"=="),i},w.qoe=function(t){for(var n,e,n=new DataView(new ArrayBuffer(2*t.length)),e=0;e<t.length;e++)n.setUint16(2*e,t.charCodeAt(e),!0);return new Uint8Array(n.buffer)},w.$oe=function(t,n){var e,i,e=t.length,i=new Uint8Array(e+n.length);return i.set(t,0),i.set(n,e),i},w.tue=function(t,n,e,i){for(var r,o,a,r,o=i(w.$oe(w.Joe(n),w.qoe(t))),a=0;a<e;a++)o=i(w.$oe(new Uint8Array(o),w.r1e(a)));return o},w.nue=function(t,n,e,i){return w.Xoe(new Uint8Array(w.tue(t,n,e,i)))},w.eue=function(t){var n;return new l(512,!0).update(t).arrayBuffer()},w.o1e=function(t){for(var n,e,n=new Uint8Array(256),e=0;e<=255;e++)n[e]=Date.now()*Math.random()+Date.now()&255;return new Uint8Array(w.eue(n)).slice(0,t)},w.iue=function(){for(var t,n,t=new Uint8Array(256),n=0;n<=255;n++)t[n]=Date.now()*Math.random()+Date.now()&255;return w.Xoe(w.o1e(16))},w.rue=function(t,n,e,i,r){var o;return w.nue(t,e,i,r)===n},w.a1e=function(t,n,e){for(var i,r,i=0,r=e;r<n+e;r++)i+=t[r]*(1<<8*(r-e));return i},w.ETe=function(t){for(var n,e,n=0,e=t.length-1;0<=e;e--)n=n>>14&1|n<<1&32767,n^=t.charCodeAt(e);return(n=(n=n>>14&1|n<<1&32767)^t.length^52811).toString(16).toUpperCase()},n.Qoe=w},"./dist/core/util/dataManager.js":function(t,n){"use strict";function e(t,n){var n,n,e,n=n.workbook.lossless,n=n&&n.dataManager;if(n)return t.N3=null,(e=t.dataManager()).fromJSON(n)}function i(t,n){var n,e,n=n.dataManager;if(n)return t.N3=null,(e=t.dataManager()).fromJSON(n)}function r(t,n){var t=t.N3;t&&(n.dataManager=t.toJSON())}function o(t,n){var t=t.N3;t&&(n.workbook.lossless.dataManager=t.toJSON())}Object.defineProperty(n,"__esModule",{value:!0}),n.l2e=n.h2e=n.d2e=n.v2e=void 0,n.v2e=e,n.d2e=i,n.h2e=r,n.l2e=o},"./dist/core/util/domUtil.js":function(r,t,n){"use strict";var e,L,n,m,h,g,s,f,a,d,c,u,l,v,p,b,w,y,M,C,i,S,T,A,I,B,o,x,N,P,G,k,e,U,_,H;function V(t,n){var e,i;for(Array.call(this),"string"==typeof t?e=(n||f).querySelectorAll(t):t&&(e=k.isArray(t)||t instanceof HTMLCollection?t:[t]),i=0;e&&i<e.length;i++)this.push(e[i])}function z(t){for(var n,e,n=Y(t);t.parentElement;)n<(e=Y(t=t.parentElement))&&(n=e);return n}function Y(t){var t=getComputedStyle(t).zIndex;return"auto"===t||""===t?0:Number(t)}function Z(t){return k.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function W(t,n){var t=t.nodeName;return t&&t.toLowerCase()===n.toLowerCase()}function Q(t,n){return 0<="top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)&&isFinite(n)?(n=0<="width height".split(" ").indexOf(t)&&n<0?0:n)+"px":n}function J(t,n,e){var i,r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return(o=1!==a)&&(r=B[n=I[n]||n]),R(e)?r&&c in r&&(i=r.get(t,n))!==g?i:t[n]:r&&u in r&&!R(i=r.set(t,e,n))?i:t[n]=e}function K(t){var n,e,n,n,n=t.nodeType;return!(n&&1!==n&&9!==n||(n=(n=t.nodeName)&&(e={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0})[n.toLowerCase()])&&(!0===n||t.getAttribute("classid")!==n))}function D(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,n){return n.toUpperCase()})}function j(t,n,e,i){if(K(t)){var t,r,o=N,a=O(n),u=t.nodeType,s=u?x:t,c=u?t[o]:t[o]&&o;if(c&&s[c]&&(i||s[c].data)||!a||!R(e))return c||(u?(t[o]=c=P,P++):c=o),s[c]||(s[c]={},u)||(s[c].toJSON=function(){}),!E(n)&&"function"!=typeof n||(i?s[c]=k.extend(s[c],n):s[c].data=k.extend(s[c].data,n)),t=s[c],i||(t.data||(t.data={}),t=t.data),R(e)||(t[D(n)]=e),a?(r=t[n])!==g&&r!==h||(r=t[D(n)]):r=t,r}}function X(t){var n;for(n in t)if(("data"!==n||!k.isEmptyObject(t[n]))&&"toJSON"!==n)return;return 1}function q(t,n,e){if(K(t)){var i,r,o,a=t.nodeType,u=a?x:t,s=a?t[N]:N;if(u[s]){if(n&&(o=e?u[s]:u[s].data)){r=(n=k.isArray(n)?n.concat(k.map(n,D)):n in o||(n=D(n))in o?[n]:n.split(" ")).length;for(i=0;i<r;i++)delete o[n[i]];if(!(e?X:k.isEmptyObject)(o))return}(e||(delete u[s].data,X(u[s])))&&(a?$([t],!0):u!==u.window?delete u[s]:u[s]=g)}}}function $(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,o=0,a=N,u=x,e=t[o];e!==g&&void 0!==e;){if((n||K(e))&&(r=(i=e[a])&&u[i])){if(s=r.events)for(c in s)if(m(s,c)&&(f=s[c]))for(l in f)if(m(f,l)&&(h=f[l]))for(d=0,v=h.length;d<v;d++)F(e,c,h[d]);u[i]&&(delete u[i],delete e[a])}e=t[++o]}}function O(t){return"string"==typeof t}function E(t){return"object"==typeof t}function R(t){return typeof t==typeof h}function tt(t){var u=t;return function(t){var n,e,i,r,o,a,n=this,e="border-box"===n.css("box-sizing"),r=u?l:v,o=u?p:w,a=u?b:y;return 0===arguments.length?(i=Math.round(s(n.css(r)))||0,e&&(i-=s(n.css("padding-"+o))+s(n.css("padding-"+a))+s(n.css("border-"+o+"-"+l))+s(n.css("border-"+a+"-"+l))),i):(n.css(r,t),n)}}function nt(t){var i=t;return function(){var t,n,e,t=this,n=i?p:w,e=i?b:y;return i?t.width():t.height()+s(t.css("padding-"+n))+s(t.css("padding-"+e))}}function et(t){var o=t;return function(t){var n,e,i,r,n=o?p:w,e=o?b:y,i=this,r=o?i.innerWidth():i.innerHeight();return r+=s(i.css("border-"+n+"-"+l))+s(i.css("border-"+e+"-"+l)),t&&(r+=s(i.css("margin-"+n))+s(i.css("margin-"+e))),r}}function it(t){var e=t;return function(n){return this.forEach(function(t){t.style[A]=e?C:i,n&&n.apply(t)}),this}}function rt(t){var s=t;return function(t){var n,e,i,r,o,a,u,n="scrollLeft",e="scrollTop",i=s?n:e,r=s?"pageXOffset":"pageYOffset",o=this,a=o[0],u=a&&Z(a);return R(t)?u?r in u?u[r]:f.documentElement[i]:a&&a[i]:(u?u.scrollTo(s?t:k(u)[n](),s?k(u)[e]():t):a&&(a[i]=t),o)}}function F(t,n,e){t.removeEventListener(n,e)}function ot(i,r,t){var o,a,u,s,c,f,l,n,h,e,l=0,n=!1,h=!1,e=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function d(t){var n,e,n=o,e=a;return o=a=void 0,l=t,s=i.apply(e,n)}function v(t,n){return setTimeout(t,n)}function m(t){clearTimeout(t)}function g(t){return l=t,c=v(w,r),n?d(t):s}function p(t){var n,e,t,n,e=t-l,t=r-(t-f);return h?Math.min(t,u-e):t}function b(t){var n,e,n=t-f,e;return void 0===f||r<=n||n<0||h&&u<=t-l}function w(){var t=Date.now();if(b(t))return y(t);c=v(w,p(t))}function y(t){return c=void 0,e&&o?d(t):(o=a=void 0,s)}function M(){void 0!==c&&m(c),o=f=a=c=void(l=0)}function C(){return void 0===c?s:y(Date.now())}function S(){return void 0!==c}function T(){for(var t,n,e,i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(i=b(e=Date.now()),o=t,a=this,f=e,i){if(void 0===c)return g(f);if(h)return c=v(w,r),d(f)}return void 0===c&&(c=v(w,r)),s}return r=+r||0,E(t)&&(n=!!t.leading,h="maxWait"in t,u=h?Math.max(+t.maxWait||0,r):u,e="trailing"in t?!!t.trailing:e),T.cancel=M,T.flush=C,T.pending=S,T}function at(t,n,e){var i,r,i=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return E(e)&&(i="leading"in e?!!e.leading:i,r="trailing"in e?!!e.trailing:r),ot(t,n,{leading:i,trailing:r,maxWait:n})}function ut(t,n,e){var i,r,o;if(t){if(i=t,!n||0===n.length)return i=!(i=t[a])&&e?t[a]={}:i;for(r=n.length-1;0<=r;r--){if(!i[o=n[r]]){if(!e)return;i[o]={}}i=i[o]}return i}}function st(t,n){var e,i,r,o;for(e in t)if(m(t,e)&&(i=t[e]))if(k.isArray(i))for(r=i.length,o=0;o<r;o++)F(n,e,i[o]);else st(i,n)}function ct(t,n,e,i,r){var o,a,u,s,c;if(!(!t||2<r||t instanceof Function))for(o in r+=1,t)if(m(t,o)&&(a=t[o])){if((u=a[e])&&k.isArray(u))for(s=0,c=u.length;s<c;s++)u[s].apply(n,[{type:e},i]);ct(a,n,e,i,r)}}function ft(t,n,e){this.zue=t.clientHeight,this.Vue=t.clientWidth,this.sse=L.mt.Tt.safari,this.cse(t,n,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Ose=t.GC$=t.getHostMaxZIndex=void 0,e=n("Common"),L=n("./dist/core/util/common.js"),n=e.Common.lt,m=e.Common.kh,h=void 0,g=null,s=parseFloat,f=document,a="_nonamespace",d="events",c="get",u="set",l="width",v="height",p="left",b="right",w="top",y="bottom",M="hidden",C="block",i="none",S="position",T="visibility",A="display",I={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},B={tabIndex:{get:function(t){var n,e,i,r,n=t.getAttributeNode("tabindex"),e=/^(?:input|select|textarea|button|object)$/i,i=/^(?:a|area)$/i,r=t.nodeName;return n&&n.specified?parseInt(n.value,10):e.test(r)||i.test(r)&&t.href?0:h}}},o={option:{get:function(t){var n=t.attributes.value;return!n||n.specified?t.value:t.text}},select:{get:function(t){var n,n,e=t.options,i=t.selectedIndex,r="select-one"===t.type||i<0,o=r?g:[],a=r?i+1:e.length,u=r?i:0;for(i<0&&(u=a);u<a;u++)if(((n=e[u]).selected||u===i)&&!n.disabled&&(!n.parentNode.disabled||!W(n.parentNode,"optgroup"))){if(n=k(n).val(),r)return n;o.push(n)}return o},set:function(t,n){var e,i,e=k.makeArray(n),i;return k(t).find("option").getAll().forEach(function(t){t.selected=0<=k.inArray(k(t).val(),e)}),e.length||(t.selectedIndex=-1),e}}},x={},N="$"+(""+Math.random()).replace(/\D/g,""),P=1,G={},[v,l].forEach(function(c){G[c]={get:function(t){var n,e,i,r,o,a,n,u,s,n=getComputedStyle(t),e=t.style,i=e[S],r=e[T],o=e[A],a=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(n[A]);if(a&&(e[S]="absolute",e[T]=M,e[A]=C),n=n&&n[c],a&&(e[S]=i,e[T]=r,e[A]=o),""===n){for(u=t.parentElement,s=f.body;u&&u!==s;)u=u.parentElement;u!==s&&(n=e[c])}return n}}}),k=function(t,n){return t instanceof V?t:new V(t,n)},t.GC$=k,e={get:function(t){return this[t]},getAll:function(){return this},bind:function(a,u,s){var t=this;return R(s)&&(s=u,u=h),t.forEach(function(e){var t,n,i,r,t,n,o,t=j(e,d,h,!0);t||j(e,d,t={},!0),i=(n=a.split("."))[0],t=ut(t,r=n.slice(1),!0),(n=function(t){R(u)||(t.data=u);var n=s.apply(e,arguments);!1===(t.result=n)&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))}).original=s,(o=(o=t[i])||(t[i]=[])).push(n),e.addEventListener(i,n)}),t},unbind:function(f,l){var t=this;return t.forEach(function(t){var n,e,i,r,o,a,u,e,s,c,n=j(t,d,h,!0),e=f.split("."),i=e[0],r=e.slice(1),e=ut(n,r);if(e)if(l){if(i&&(o=e[i])&&k.isArray(o))for(u=o.length,a=0;a<u;a++)if(o[a].original===l){F(t,i,o[a]),o.splice(a,1);break}}else if(i){if((o=e[i])&&k.isArray(o))for(u=o.length,a=0;a<u;a++)F(t,i,o[a]);e[i]=h}else{for(st(e,t),s=n,c=r.length-1;0<c&&(s=s[r[c]]);c--);s&&(s[r[0]]=h)}}),t},trigger:function(t,n){var e,i,r,o,a,u,s,e=this;if(t)for(i=0,r=e.length;i<r;i++)(a=j(o=e[i],d,h,!0))&&ct(a,o,s=(u=t.split("."))[0],n,0);return e},css:function(e,i){var t,r,n,o,a,a;function u(n,e){r.forEach(function(t){t.style[n]=Q(n,e)})}if(r=t=this,1===(n=arguments.length)){if(!E(e))return o=t[0],(a=G[e])&&c in a?o?a.get(o):g:(a=o&&getComputedStyle(o))&&a[e];r.forEach(function(t){for(var n in e)m(e,n)&&(t.style[n]=Q(n,e[n]))})}else 2===n&&(k.isArray(e)&&k.isArray(i)&&e.length===i.length?e.forEach(function(t,n){u(t,i[n])}):u(e,i));return t},width:tt(!0),height:tt(),innerWidth:nt(!0),innerHeight:nt(),outerWidth:et(!0),outerHeight:et(),append:function(t){var n,t,e,n=[t];return t instanceof k&&(n=t.getAll()),(e=(t=this)[0])&&n.forEach(function(t){t&&e.appendChild(t)}),t},appendTo:function(t){var n,e,n=t,e=this;return(n=t instanceof k?t[0]:n)&&e.forEach(function(t){n.appendChild(t)}),e},prepend:function(t){var n=this,e=n[0];return e&&e.insertBefore(t,e.firstChild),n},insertBefore:function(n){var t=this,e=n.parentElement;return t.forEach(function(t){e.insertBefore(t,n)}),t},addClass:function(t){for(var n,e,i,r,o,a=0,u=this,s=u.length,c,f=/[\t\r\n]/g,n=(t||"").match(/\S+/g)||[];a<s;a++)if(i=1===(e=u[a]).nodeType&&(e.className?(" "+e.className+" ").replace(f," "):" ")){for(r=n[o=0];r;)i.indexOf(" "+r+" ")<0&&(i+=r+" "),r=n[++o];e.className=k.trim(i)}return this},removeClass:function(t){for(var n,e,i,r,o,a=0,u=this,s=u.length,c,f=/[\t\r\n]/g,n=(t||"").match(/\S+/g)||[];a<s;a++)if(i=1===(e=u[a]).nodeType&&(e.className?(" "+e.className+" ").replace(f," "):"")){for(r=n[o=0];r;){for(;0<=i.indexOf(" "+r+" ");)i=i.replace(" "+r+" "," ");r=n[++o]}e.className=t?k.trim(i):""}return this},hasClass:function(t){var n,e,i,r,o,n=0,e=this,i=e.length,r=/[\t\r\n]/g;for(t=" "+t+" ";n<i;n++)if(1===(o=e[n]).nodeType&&0<=(" "+o.className+" ").replace(r," ").indexOf(t))return!0;return!1},toggle:function(){var t,n,t=this,n=t[0];return n&&n.style[A]===i?t.show():t.hide(),t},show:it(!0),hide:it(),attr:function(e,n){var t,i,r,o,i=this,r=i,o=arguments.length;if(1===o){if(!E(e))return null==(t=i[0])?void 0:t.getAttribute(e);r.forEach(function(t){for(var n in e)m(e,n)&&t.setAttribute(n,e[n])})}else 2===o&&r.forEach(function(t){t.setAttribute(e,n)});return i},removeAttr:function(n){return this.forEach(function(t){t.removeAttribute(n)}),this},prop:function(e,n){var t=this,i=t,r=arguments.length;if(1===r){if(!E(e))return t[0]&&J(t[0],e);i.forEach(function(t){for(var n in e)m(e,n)&&J(t,n,e[n])})}else 2===r&&i.forEach(function(t){J(t,e,n)});return t},removeProp:function(n){n=I[n]||n;var t=this,e;return t.forEach(function(t){try{t[n]=h,delete t[n]}catch(t){}}),t},text:function(n){var t,e,i,e=this,i=e;return 0===arguments.length?null==(t=e[0])?void 0:t.textContent:(i.forEach(function(t){t.textContent=n}),e)},val:function(e){var t,i,t,n,r,t=this;return arguments.length?(r=k.isFunction(e),t.forEach(function(t,n){var n;1!==t.nodeType||((n=r?e.call(t,n,k(t).val()):e)===g||n===h?n="":"number"==typeof n?n+="":k.isArray(n)&&(n=k.map(n,function(t){return t===g||t===h?"":t+""})),(i=o[t.type]||o[t.nodeName.toLowerCase()])&&u in i&&!R(i.set(t,n,"value")))||(t.value=n)}),t):(n=void 0,(t=t[0])?(i=o[t.type]||o[t.nodeName.toLowerCase()])&&c in i&&!R(n=i.get(t,"value"))?n:O(n=t.value)?n.replace(/\r/g,""):n===g||n===h?"":n:void 0)},position:function(){var t,n,e,i,r,t=this[0];if(t){if(n={top:0,left:0},e={top:0,left:0},"fixed"===k(t).css(S))try{n=t.getBoundingClientRect()}catch(t){}else i=this.offsetParent(),n=this.offset(),(r=i[0])&&(W(r,"html")||((e=i.offset()).left-=r.scrollLeft,e.top-=r.scrollTop),e.top+=s(k(r).css("borderTopWidth")),e.left+=s(k(r).css("borderLeftWidth")));return{top:n.top-e.top-s(k(t).css("marginTop")),left:n.left-e.left-s(k(t).css("marginLeft"))}}},offsetParent:function(){var t=k.map(this,function(t){for(var n,e,n=f.documentElement,e=t.offsetParent||n;e&&!W(e,"html")&&"static"===k(e).css(S);)e=e.offsetParent;return e||n});return k(t)},offset:function(){var t,n,e={top:0,left:0},n=this[0],i=n&&n.ownerDocument;if(i){if(t=i.documentElement,!R(n.getBoundingClientRect))try{e=n.getBoundingClientRect()}catch(t){}return n=Z(i),{top:e.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:e.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:rt(!0),scrollTop:rt(),html:function(n){var t,e,i,e=this,i=e;return 0===arguments.length?null==(t=e[0])?void 0:t.innerHTML:(i.forEach(function(t){t.innerHTML=n}),e)},remove:function(){var t;this.forEach(function(t){var n=t.parentElement;n&&(n.removeChild(t),$([t]))})},empty:function(){return this.forEach(function(t){k(t.children).remove()}),this},find:function(n){var e=[];return O(n)&&this.forEach(function(t){var t=t.querySelectorAll(n);k.merge(e,t)}),k(e)},parent:function(){var n=[];return this.forEach(function(t){var t=t.parentElement;t&&n.push(t)}),k(n)},index:function(t){var n=this[0];return t?O(t)?n&&k.inArray(n,k(t).getAll()):k.inArray(t,this):n&&n.parentElement?k.inArray(n,n.parentElement.children):-1},focus:function(){var t=this,n=t[0];return n&&n!==f.activeElement&&n.focus&&n.focus(),t},isVisible:function(){var n=0;return this.forEach(function(t){var t=getComputedStyle(t);t[T]!==M&&t[A]!==i&&n++}),0<n},data:function(e,i){var r,o,r=this,o=R(i);return o&&(r=void 0),k.each(this,function(t,n){var n=j(n,e,i);if(o)return r=n,!1}),r},removeData:function(e){return k.each(this,function(t,n){q(n,e)}),this}},U=V.prototype=[],n.Dh(U,e),k.prototype=U,k.each=n.y0,k.isEmptyObject=n._h,k.isFunction=n.Eh,k.isArray=n.Nh,k.isNumeric=n.jh,k.getType=n.Oh,k.inArray=n.Rh,k.merge=n.Bh,k.map=n.Lh,k.extend=n.Dh,k.inherit=n.Fh,k.isPlainObject=n.Ph,k.isArraylike=n.Gh,k.isWindow=n.Uh,k.makeArray=n.Hh,k.trim=function(t){var n;return t.trim?t.trim():t===g||t===h?"":(t+"").replace(/(^[\s\uFEFF\xA0]+)|([\s\uFEFF\xA0]+$)/g,"")},k.En=function(t,n,e,i,r){var t=k(f.createElement(t));return n&&e&&t.css(n,e),i&&t.addClass(i),r&&(r instanceof k?r:k(r)).append(t),t},t.getHostMaxZIndex=z,_="px",ft.prototype.cse=function(r,o,t){var a=this;this.sse?this.fse=setInterval(function(){var t;r.style.width===a.Vue+_&&r.style.height===a.zue+_||o()},100):(this.Yue=new MutationObserver(at(function(t){for(var n,e,i,n=0;n<t.length;n++)if("attributes"===(e=t[n]).type&&(i=r.style.width!==a.Vue+_||r.style.height!==a.zue+_))return void o()},t)),this.Yue.observe(r,{attributes:!0}))},ft.prototype.disconnect=function(){this.sse?clearInterval(this.fse):(this.Yue.disconnect(),this.Yue=null)},t.Ose=ft},"./dist/core/util/imageLoader.js":function(t,n,e){"use strict";var e,s,c,i;function r(t){var n;this.zh=0,this.Vh=0,this.Yh={},this.Zh=t}Object.defineProperty(n,"__esModule",{value:!0}),n.Wh=void 0,e=e("./dist/core/util/domUtil.js"),s=e.GC$,c=".gcSheet",r.prototype.addImage=function(t,n){var e,i,r,o;function a(){e.Qh(t,!0)}function u(){e.Qh(t,!1)}(r=(i=(e=this).Yh)[t])||(o=s(document.createElement("img")),n&&o.attr("crossOrigin",n),o.bind("load"+c,a),o.bind("error"+c,u),o.bind("abort"+c,u),e.zh++,i[t]={Kh:!1,Jh:o[0],Xh:!1},o[0].src=t)},r.prototype.getState=function(t){var t=this.Yh[t];return!!t&&t.Kh},r.prototype.qh=function(t){var t=this.Yh[t];return!!t&&t.Xh},r.prototype.getImage=function(t){var t=this.Yh[t];return t?t.Jh:null},r.prototype.Qh=function(t,n){var e=this;e.Vh++,e.Yh[t].Kh=!0,e.Yh[t].Xh=n,e.$h()&&e.Zh&&e.Zh()},r.prototype.$h=function(){return this.Vh>=this.zh},r.prototype.L0=function(){var t,n,e,t=this.Yh;if(t)for(n in t)t[n]&&(e=s(t[n].Jh)).unbind(c);this.Zh=null},n.Wh=r},"./dist/core/util/styleManager.js":function(F,t,n){"use strict";var L,B,d,v,s,o,P,a,c,m,g,f,p,r,u,G,e,U,l,h,H,b,w,y,M,V,z,i,n;function C(t,n){var e=this;this.td=[],this.Lh={},t&&(n?t.forEach(function(t,n){e.Lh[t]=""+n,e.td[n]=t}):t.forEach(function(t,n){e.getTextIndex(t)}))}function S(){this.td=[]}function T(t){return t?1:0}function A(t,n){var e,i,e="{";return m(t.style)||"object"!=typeof(i="string"==typeof(i=t.style)?'"'+P.ExcelBorderStyle[i]+'"':i)&&(e+='"s":'+i+","),m(t.color)||(e+='"c":'+n.getTextIndex(t.color)+","),e.substring(0,e.length-1)+"}"}function Y(t,n,e){var i,t;if(t)return i=new v.LineBorder,t=JSON.parse(t),e||0!==t.s?(m(t.s)||(i.style=+t.s),m(t.c)||(i.color=n.getText(+t.c)),i):f}function Z(){var t,n,t=e(),n;t&&t.GC&&t.GC.Spread&&t.GC.Spread.Common&&e().GC.Spread.Common.CultureManager.getCultureInfo()||U()}function I(t,n){var e=this;e.nd=[],e.ed=new h(n),e.rd=t}function x(t,n){var e=this;e.od=[],e.ad=new h,e.ud=new h,e.m2e=new h,e.g2e=new h,e.p2e=new h,e.Pre=new h,e.rd=t,e.cd=n}function N(t){return!t||t.color===g&&t.level===g&&t.style===g}function k(t){var n=this;n.fd=[],n.ld=[],n.hd=new h,n.dd=new h,n.rd=t,n.hd.getTextIndex('{"s":0}'),n.dd.getTextIndex("l:0,r:0,t:0,b:0")}function _(t,n){var e,i,r,e=this;e.vd=[],e.md=new h,e.pd=new h,e.bd={},e.cd=t,e.yd=n,e.wd={},o.ExtendedNumberFormatHelper.resetBuiltInNumberFormat(),i=o.ExtendedNumberFormatHelper.builtInNumberFormat(),Object.keys(i).forEach(function(t){"count"!==t&&(_.Cd[i[t]]=t)}),r=o.ExtendedNumberFormatHelper.languageIndepedentNumberFormat(),Object.keys(r).forEach(function(t){"count"!==t&&(_.Cd[r[t]]=t)})}function D(){var t=this;t.Td=[],t.Ad=new h}function j(){var t=this;t.xd=[],t.Nd=new h}function O(t,n){if(t&&n)for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}function E(t,n,e){var i=this;i.kd=new h,i.Dd=new M(n,e),i._d=new w(t,n),i.Lfe=new w(t,n),i.Ed=new b(t),i.jd=new y(t),i.Vve=new V,i.Yve=new z}function R(){var t=this;t.Od=new h,t.cd=new h,t.yd=new H,t.Dd=new M(t.cd,t.yd),t._d=new w(t.Od,t.cd),t.Ed=new b(t.Od,['{"t":0}','{"t":5}']),t.jd=new y(t.Od),t.Rd=new h,t.Bd=new h,t.Ld=new h,t.kd=new i(t.Od,t.cd,t.yd),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.zd=[],t.Vd={},t.Yd={},t.Zd={},t.originCellXfs=new h,t.originNamedStylesXfs=new h,t.Wd={},t.Qd={},t.Kd={},t.Jd="__builtInStyle",t.Xd="__builtInTableStyle",t.qd=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,t.$d=0}Object.defineProperty(t,"__esModule",{value:!0}),t.StyleManager=t.SharedDxfs=t.SimpleSharedStrings=void 0,L=n("./dist/core/util/common.js"),B=n("./dist/core/celltype/celltype.ns.js"),d=n("./dist/core/util/common.js"),v=n("./dist/core/worksheet/style.js"),s=n("./dist/core/util/common.js"),o=n("./dist/core/excel-io-util/common.js"),P=n("./dist/core/excel-io-util/excel-style.js"),a=n("Common"),c=n("./dist/core/util/domUtil.js"),m=a.Common.lt.ht,g=void 0,f=null,p=o.NodeHelper.ur,r=c.GC$.each,u=a.Common.lt.tv,G=o.Util.oo,e=o.Util.ro,U=o.Util.ao,l=L.mt.St,C.prototype.dispose=function(){this.td=g,this.Lh=g},C.prototype.setTextValue=function(t){var n;this.Lh[t]===g&&(n=this.td.push(t)-1,this.Lh[t]=n)},C.prototype.getTextIndex=function(t){return this.setTextValue(t),this.Lh[t]},C.prototype.getText=function(t){return this.td[t]},C.prototype.setTextIndex=function(t,n){this.td[n]=t,this.Lh[t]=n},C.prototype.replaceText=function(t,n){this.td[t]=n},C.prototype.getCount=function(){return this.td.length},C.prototype.yh=function(t){var n,e,i,r,n=this,e=n.Lh;if(t)for(i=0,r=(n.td=t).length;i<r;i++)e[t[i]]=""+i},C.prototype.wh=function(){return this.td},h=C,t.SimpleSharedStrings=h,S.prototype.dispose=function(){this.td=g},S.prototype.getObjectIndex=function(t){var n,e=this.td,i=0,r=e.length,o;if(t.toJSON?o=t.toJSON():!m(t)&&t instanceof Object&&(o=JSON.stringify(t)),o){for(;i<r;i++)if(e[i]===o)return i;return e[i]=o,i}},S.prototype.getObject=function(t){return this.td[t]},S.prototype.yh=function(t){this.td=t},S.prototype.wh=function(){return this.td},H=S,I.prototype.dispose=function(){var t=this;t.ed&&(t.ed.dispose(),t.ed=g),t.nd=g,t.rd=g},I.prototype.nv=function(t){var n,e,i,t,r,o,a,u,n=this,e=n.rd;return t.backColor===f?n.ed.getTextIndex('{"t":0}'):t.backColor!==g?("object"==typeof(a=o=r=t=t.backColor)?(i="{",o.stops?(i+='"s":[',(u=o.stops).forEach(function(t){i+='{"p":'+t.position+',"c":'+e.getTextIndex(t.color)+"},"}),i=i.substring(0,i.length-1),i+="],","path"===a.type?(i+='"t":"p"',(0,s.isDefined)(a.left)&&(i+=',"l":'+a.left),(0,s.isDefined)(a.right)&&(i+=',"r":'+a.right),(0,s.isDefined)(a.top)&&(i+=',"a":'+a.top),(0,s.isDefined)(a.bottom)&&(i+=',"c":'+a.bottom)):i+='"d":'+(o.degree||0)):r.type!==g&&(i+='"t":'+r.type,(0,s.isDefined)(r.patternColor)&&""!==r.patternColor&&(i+=',"p":'+e.getTextIndex(r.patternColor)),(0,s.isDefined)(r.backgroundColor))&&""!==r.backgroundColor&&(i+=',"b":'+e.getTextIndex(r.backgroundColor)),i+="}"):i=""===t?'{"t":0}':e.getTextIndex(t),n.ed.getTextIndex(i)):void 0},I.prototype.ev=function(t,n){var e,i,r,o,e,a,u,s,u,e=this,i=e.rd,r=e.nd;return r[t]||("string"==typeof(e=e.ed.getText(+t))&&"{"===e[0]?(u=(a=JSON.parse(e)).s,o={},0===a.t?f:(u&&0<u.length?(s=o.stops=[],u.forEach(function(t){var n={};m(t.p)||(n.position=t.p),m(t.c)||(n.color=i.getText(t.c)),s.push(n)}),"p"===a.t?(o.type="path",m(a.l)||(o.left=a.l),m(a.r)||(o.right=a.r),m(a.a)||(o.top=a.a),m(a.c)||(o.bottom=a.c)):m(a.d)||(o.degree=a.d)):m(a.t)?m(a.b)||(o=i.getText(a.b)):1===(u=a.t)?n||m(a.p)?m(a.b)||(o=i.getText(a.b)):o=i.getText(a.p):(o.type=u,m(a.p)||(o.patternColor=i.getText(a.p)),m(a.b)||(o.backgroundColor=i.getText(a.b))),o=c.GC$.isEmptyObject(o)?g:o,r[t]=o)):(o=i.getText(e),o=c.GC$.isEmptyObject(o)?g:o,r[t]=o))},I.prototype.iv=function(t){t.fills=this.ed.wh()},I.prototype.rv=function(t){this.ed.yh(t.fills)},b=I,x.prototype.dispose=function(){var t=this;t.ad&&(t.ad.dispose(),t.ad=g),t.ud&&(t.ud.dispose(),t.ud=g),t.m2e&&(t.m2e.dispose(),t.m2e=g),t.g2e&&(t.g2e.dispose(),t.g2e=g),t.p2e&&(t.p2e.dispose(),t.p2e=g),t.Pre&&(t.Pre.dispose(),t.Pre=g),t.od=g,t.rd=g,t.cd=g},x.prototype.nv=function(t){var n,e,n=this;if(!(m(t.font)&&m(t.vertAlign)&&m(t.textDecoration)&&t.foreColor===g&&m(t.themeFont)))return e="",m(t.font)||(e+="f:"+n.ud.getTextIndex(t.font)+","),t.fontStyle!==g&&(e+="i:"+n.m2e.getTextIndex(t.fontStyle)+","),t.fontWeight!==g&&(e+="b:"+n.g2e.getTextIndex(t.fontWeight)+","),m(t.fontSize)||(e+="s:"+n.p2e.getTextIndex(t.fontSize)+","),m(t.fontFamily)||(e+="n:"+n.Pre.getTextIndex(t.fontFamily)+","),m(t.b2e)||(e+="a:"+n.cd.getTextIndex(t.b2e)+","),m(t.w2e)||(e+="l:"+n.cd.getTextIndex(t.w2e)+","),m(t.y2e)||(e+="r:"+n.cd.getTextIndex(t.y2e)+","),m(t.vertAlign)||(e+="v:"+t.vertAlign+","),m(t.textDecoration)||(e+="d:"+t.textDecoration+","),t.foreColor!==g&&(e+="c:"+n.rd.getTextIndex(t.foreColor)+","),m(t.themeFont)||(e+="t:"+n.cd.getTextIndex(t.themeFont)+","),n.ad.getTextIndex(e.substring(0,e.length-1))},x.prototype.ev=function(t){var i,r,n,e,o,i=this,r=i.rd,n=i.od;return n[t]||((e=i.ad.getText(+t))?(o={},e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],e=t[1];switch(n){case"f":o.font=i.ud.getText(+e);break;case"v":o.vertAlign=+e;break;case"d":o.textDecoration=+e;break;case"c":o.foreColor=r.getText(+e);break;case"t":o.themeFont=i.cd.getText(+e);break;case"i":o.fontStyle=i.m2e.getText(+e);break;case"b":o.fontWeight=i.g2e.getText(+e);break;case"s":o.fontSize=i.p2e.getText(+e);break;case"n":o.fontFamily=i.Pre.getText(+e);break;case"a":o.b2e=i.cd.getText(+e);break;case"l":o.w2e=i.cd.getText(+e);break;case"r":o.y2e=i.cd.getText(+e)}}),n[t]=o):void 0)},x.prototype.iv=function(t){var n=this;t.fonts=n.ad.wh(),t.htmlFonts=n.ud.wh(),t.fontStyles=n.m2e.wh(),t.fontWeights=n.g2e.wh(),t.fontSizes=n.p2e.wh(),t.fontFamilies=n.Pre.wh()},x.prototype.rv=function(t,n){var e=this;n?(e.ad.yh(t.partFonts),e.ud.yh(t.partHtmlFonts)):(e.ad.yh(t.fonts),e.ud.yh(t.htmlFonts),e.m2e.yh(t.fontStyles),e.g2e.yh(t.fontWeights),e.p2e.yh(t.fontSizes),e.Pre.yh(t.fontFamilies))},w=x,k.prototype.dispose=function(){var t=this;t.hd&&(t.hd.dispose(),t.hd=g),t.dd&&(t.dd.dispose(),t.dd=g),t.fd=g,t.ld=g,t.rd=g},k.prototype.nv=function(t){var n,e,i,n=this,e=n.rd;if(!(N(t.borderLeft)&&N(t.borderTop)&&N(t.borderRight)&&N(t.borderBottom)&&N(t.borderVertical)&&N(t.borderHorizontal)&&N(t.diagonalDown)&&N(t.diagonalUp)))return i="",N(t.borderLeft)||(i+="l:"+n.hd.getTextIndex(A(t.borderLeft,e))+","),N(t.borderRight)||(i+="r:"+n.hd.getTextIndex(A(t.borderRight,e))+","),N(t.borderTop)||(i+="t:"+n.hd.getTextIndex(A(t.borderTop,e))+","),N(t.borderBottom)||(i+="b:"+n.hd.getTextIndex(A(t.borderBottom,e))+","),N(t.borderVertical)||(i+="v:"+n.hd.getTextIndex(A(t.borderVertical,e))+","),N(t.borderHorizontal)||(i+="h:"+n.hd.getTextIndex(A(t.borderHorizontal,e))+","),N(t.diagonalUp)||(i+="u:"+n.hd.getTextIndex(A(t.diagonalUp,e))+","),N(t.diagonalDown)||(i+="d:"+n.hd.getTextIndex(A(t.diagonalDown,e))+","),n.dd.getTextIndex(i.substring(0,i.length-1))},k.prototype.ov=function(t,n){var e,i,r,e,o,r,e=this,i=e.ld;return i[t]||(r=e.hd,e=e.rd,r=Y(o=r.getText(+t),e,n),i[t]=r)},k.prototype.ev=function(t,i){var r,n,e,o,r=this,n=r.fd;return n[t]||(e=r.dd.getText(t),o={},e?(e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],e=t[1];switch(n){case"l":o.borderLeft=r.ov(e,i);break;case"r":o.borderRight=r.ov(e,i);break;case"t":o.borderTop=r.ov(e,i);break;case"b":o.borderBottom=r.ov(e,i);break;case"v":o.borderVertical=r.ov(e,i);break;case"h":o.borderHorizontal=r.ov(e,i);break;case"u":o.diagonalUp=r.ov(e,i);break;case"d":o.diagonalDown=r.ov(e,i)}}),n[t]=o):void 0)},k.prototype.iv=function(t){var n=this;t.borderItems=n.hd.wh(),t.borders=n.dd.wh()},k.prototype.rv=function(t){var n=this;n.dd.yh(t.borders),n.hd.yh(t.borderItems)},y=k,_.prototype.dispose=function(){var t=this;t.md&&(t.md.dispose(),t.md=g),t.pd&&(t.pd.dispose(),t.pd=g),t.vd=g,t.bd=g},_.prototype.nv=function(t){var n,e,i,t,r,o,a,n=this,e="",i=t._autoFormatter,t=t.formatter;if(!m(i)){if(r=(o=n.av(i))&&"a"+o.c,!o)return;n.bd[r]!==g?e+="a:"+n.bd[r]+",":(a=n.pd.getTextIndex(JSON.stringify(o)),e+="a:"+(n.bd[r]=a)+",")}if(t!==g&&!l(t)){if(r=(o=n.av(t))&&"f"+o.c,!o)return;n.bd[r]!==g?e+="f:"+n.bd[r]+",":(a=n.pd.getTextIndex(JSON.stringify(o)),e+="f:"+(n.bd[r]=a)+",")}if(e)return n.md.getTextIndex(e.substring(0,e.length-1))},_.prototype.ev=function(t){var r,n,e,o,r=this,n=r.vd;return n[t]||(e=r.md.getText(t),o={},e.split(",").forEach(function(t){var t,n,t,e,i,i,t=t.split(":"),n=t[0],t=t[1];"a"===n?(e=r.fromSJSFormatString(r.pd.getText(+t)),(i=(i=a.Formatter)&&i.GeneralFormatter)&&(o._autoFormatter=new i(e.formatCached,e.customerCultureName),o._autoFormatter.isAuto=!0)):"f"===n&&(o.formatter=r.fromSJSFormatString(r.pd.getText(+t)))}),n[t]=o)},_.prototype.uv=function(t){var n=this,e=n.wd;return e[t]||n.sv(t)},_.prototype.sv=function(t){var n,n;if(t!==g)return(n=o.ExtendedNumberFormatHelper.builtInNumberFormat())[t]!==g?n[t]:(n=o.ExtendedNumberFormatHelper.languageIndepedentNumberFormat())[t]!==g?n[t]:void 0},_.prototype.fromSJSFormatString=function(t){var n,e,t,i,r,t,t,n=this,e=n.wd,t=JSON.parse(t),i=t.n,r=t.c;return m(t.json)||(r=JSON.parse(n.yd.getObject(t.json))),-1===i?null:"string"==typeof r?e[i]=r:r&&!m(r.typeName)&&(t=d.getTypeFromString(r.typeName))?((t=new t).fromJSON(r),e[i]=t):(m(i)||r&&r.formatCached||(r=n.sv(i)),e[i]=r)},_.prototype.av=function(t){var n,t,e,i,n=this,t=t;return t===f?{n:-1,c:null}:("object"==typeof t&&(t.toJSON&&(e=t.toJSON()),t.formatCached?t=t.formatCached:e&&(t=JSON.stringify(e))),t?{n:i=(i=_.Cd[t])===g&&this.bd[t]===g?++o.ExtendedNumberFormatHelper.Ih:i,c:t,json:e&&n.yd.getObjectIndex(e)}:void 0)},_.prototype.iv=function(t){var n=this;t.numFmts=n.md.wh(),t.formatStrings=n.pd.wh()},_.prototype.rv=function(t){var n,e,i,n=this;if(n.md.yh(t.numFmts),n.pd.yh(t.formatStrings),t.numFmts&&0<t.numFmts.length)for(e=0,i=t.numFmts.length;e<i;e++)n.ev(e)},_.Cd={},M=_,D.prototype.dispose=function(){var t=this;t.Ad&&(t.Ad.dispose(),t.Ad=g),t.Td=g},D.prototype.nv=function(t,n){var e,i,i,e="",i=t.hAlign;if(m(i)||(3===n||!n)&&3===i||2===n&&1===i||1===n&&1===i||(e+="h:"+i+","),i=t.vAlign,m(i)||(3===n||!n)&&2===i||2===n&&1===i||1===n&&1===i||(e+="v:"+i+","),m(t.textOrientation)||(e+="x:"+t.textOrientation+","),m(t.textIndent)||(e+="i:"+t.textIndent+","),m(t.shrinkToFit)||(e+="s:"+T(t.shrinkToFit)+","),m(t.wordWrap)||(e+="w:"+T(t.wordWrap)+","),e)return this.Ad.getTextIndex(e.substring(0,e.length-1))},D.prototype.ev=function(t){var n,e,e,i,n=this,e=n.Td;return e[t]||(e=n.Ad.getText(t),i=new v.Style,e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],e=t[1];switch(n){case"h":i.hAlign=+e;break;case"v":i.vAlign=+e;break;case"x":i.textOrientation=+e;break;case"i":i.textIndent=+e;break;case"s":i.shrinkToFit=p(e);break;case"w":i.wordWrap=p(e)}}),i)},D.prototype.iv=function(t){t.alignments=this.Ad.wh()},D.prototype.rv=function(t){this.Ad.yh(t.alignments)},V=D,j.prototype.dispose=function(){var t=this;t.Nd&&(t.Nd.dispose(),t.Nd=g),t.xd=g},j.prototype.nv=function(t){var n;if(!m(t.locked))return n="",n+="l:"+T(t.locked)+",",this.Nd.getTextIndex(n.substring(0,n.length-1))},j.prototype.ev=function(t){var n,e,e,i,n=this,e=n.xd;return e[t]||(e=n.Nd.getText(t),i=new v.Style,e.split(",").forEach(function(t){var t=t.split(":"),n=t[0],t=t[1];"l"===n&&(i.locked=p(t))}),i)},j.prototype.iv=function(t){t.protections=this.Nd.wh()},j.prototype.rv=function(t){this.Nd.yh(t.protections)},z=j,E.prototype.dispose=function(){var t=this;t.kd&&(t.kd.dispose(),t.kd=g),t.Dd&&(t.Dd.dispose(),t.Dd=g),t._d&&(t._d.dispose(),t._d=g),t.Ed&&(t.Ed.dispose(),t.Ed=g),t.jd&&(t.jd.dispose(),t.jd=g),t.Vve&&(t.Vve.dispose(),t.Vve=g),t.Yve&&(t.Yve.dispose(),t.Yve=g)},E.prototype.cv=function(t,n){var e,i,r,r,r,r,r,r,e=this,i="";if(t&&((r=e.Vve.nv(t))!==g&&n&&(i+="a:"+r+","),(r=e.Ed.nv(t))!==g&&(i+="c:"+r+","),(r=e._d.nv(t))!==g&&(i+="f:"+r+","),(r=e.jd.nv(t))!==g&&(i+="b:"+r+","),(r=e.Dd.nv(t))!==g&&(i+="j:"+r+","),(r=e.Yve.nv(t))!==g&&n&&(i+="pr:"+r+","),""!==(i=i.substring(0,i.length-1))))return e.kd.getTextIndex(i)},E.prototype.fv=function(t,o,a,u){var s=this,t=s.kd.getText(t);if(t)return o=o||new v.Style,t.split(",").forEach(function(t){var t,n,e,i,i,r,i,r,i,t=t.split(":"),n=t[0],e=t[1];switch(n){case"a":u&&(i=s.Vve.ev(+e),O(o,i));break;case"c":i=s.Ed.ev(+e,a),o.backColor=i;break;case"f":r=s._d.ev(+e),O(o,r);break;case"pf":r=s.Lfe.ev(+e),O(o,r);break;case"b":i=s.jd.ev(+e),O(o,i);break;case"j":r=s.Dd.ev(+e),O(o,r);break;case"pr":u&&(i=s.Yve.ev(+e),O(o,i))}}),o},E.prototype.iv=function(){var t=this,n={};return n.cellXfs=t.kd.wh(),t.Dd.iv(n),t._d.iv(n),t.Ed.iv(n),t.jd.iv(n),t.Vve.iv(n),t.Yve.iv(n),n},E.prototype.rv=function(t){var n;t&&(n=this,t)&&(n.kd.yh(t.cellXfs),n.Dd.rv(t),n._d.rv(t),n.Lfe.rv(t,!0),n.Ed.rv(t),n.jd.rv(t),n.Vve.rv(t),n.Yve.rv(t))},i=E,t.SharedDxfs=i,R.prototype.dispose=function(){var t=this;t.Od&&(t.Od.dispose(),t.Od=g),t.cd&&(t.cd.dispose(),t.cd=g),t.yd&&(t.yd.dispose(),t.yd=g),t.Dd&&(t.Dd.dispose(),t.Dd=g),t._d&&(t._d.dispose(),t._d=g),t.Ed&&(t.Ed.dispose(),t.Ed=g),t.jd&&(t.jd.dispose(),t.jd=g),t.Rd&&(t.Rd.dispose(),t.Rd=g),t.Bd&&(t.Bd.dispose(),t.Bd=g),t.Ld&&(t.Ld.dispose(),t.Ld=g),t.kd&&(t.kd.dispose(),t.kd=g),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.Vd={},t.zd.length=0,t.Yd={},t.Zd={},t.originCellXfs&&(t.originCellXfs.dispose(),t.originCellXfs=g),t.originNamedStylesXfs&&(t.originNamedStylesXfs.dispose(),t.originNamedStylesXfs=g),t.Wd={},t.Qd={},t.Kd={}},R.prototype.lv=function(t,n,e,i){var r,o,a,u,e,e,e,e,n,i,e,n,i,e,n,s,i,r=this,o=r.cd,a=r.yd,u="";return e!==g&&(u+="t:"+e+","),(e=r.Ed.nv(t))!==g&&(u+="c:"+e+","),(e=r._d.nv(t))!==g&&(u+="f:"+e+","),e=t.hAlign,m(e)||!i&&((3===n||!n)&&3===e||2===n&&1===e||1===n&&1===e)||(u+="h:"+e+","),e=t.vAlign,2===n&&1===e||1===n&&1===e||(m(e)?i||(u+="v:0,"):u+="v:"+e+","),(n=r.jd.nv(t))!==g&&(u+="b:"+n+","),m(t.locked)||(u+="l:"+T(t.locked)+","),m(t.wordWrap)||(u+="w:"+T(t.wordWrap)+","),m(t.showEllipsis)||(u+="se:"+T(t.showEllipsis)+","),m(t.hv)||(u+="st:"+T(t.hv)+","),m(t.shrinkToFit)||(u+="s:"+T(t.shrinkToFit)+","),m(t.tabStop)||(u+="ts:"+T(t.tabStop)+","),m(t.quotePrefix)||(u+="q:"+T(t.quotePrefix)+","),m(t.isVerticalText)||(u+="va:"+T(t.isVerticalText)+","),m(t.applyFont)||(u+="y:"+T(t.applyFont)+","),m(t.applyFill)||(u+="z:"+T(t.applyFill)+","),m(t.applyAlignment)||(u+="r:"+T(t.applyAlignment)+","),m(t.applyBorder)||(u+="e:"+T(t.applyBorder)+","),m(t.applyProtection)||(u+="u:"+T(t.applyProtection)+","),m(t.applyNumberFormat)||(u+="g:"+T(t.applyNumberFormat)+","),m(t.textIndent)||(u+="i:"+t.textIndent+","),i=t.imeMode,m(i)||1===i||(u+="im:"+i+","),m(t.opacity)||(u+="o:"+t.opacity+","),m(t.backgroundImageLayout)||(u+="bl:"+t.backgroundImageLayout+","),m(t.textOrientation)||(u+="x:"+t.textOrientation+","),m(t.backgroundImage)||(u+="bi:"+o.getTextIndex(t.backgroundImage)+","),m(t.watermark)||(u+="k:"+o.getTextIndex(t.watermark)+","),m(t.cellPadding)||(u+="p:"+o.getTextIndex(t.cellPadding)+","),m(t.textBaseline)||(u+="tb:"+o.getTextIndex(t.textBaseline)+","),m(t.labelOptions)||(u+="lo:"+o.getTextIndex(JSON.stringify(t.labelOptions))+","),m(t.cellType)||(e=a.getObjectIndex(t.cellType),m(e))||(u+="ct:"+e+","),m(t.cellButtons)||(n=a.getObjectIndex(t.cellButtons),m(n))||(u+="cb:"+n+","),m(t.dropDowns)||(i=a.getObjectIndex(t.dropDowns),m(i))||(u+="dd:"+i+","),m(t.decoration)||(e=a.getObjectIndex(t.decoration),m(e))||(u+="dc:"+e+","),m(t.mask)||(n=a.getObjectIndex(t.mask),m(n))||(u+="ma:"+n+","),!m(t.formatter)&&l(t.formatter)&&(u+="fs:"+(s=o.getTextIndex(t.formatter))+","),(i=r.Dd.nv(t))!==g&&(u+="j:"+i+","),u.substring(0,u.length-1)},R.prototype.vv=function(t,u){var s,c,f,l,h;if(t)return s=new v.Style,f=(c=this).cd,l=c.yd,h=c.Hd,t.split(",").forEach(function(t){var t,n,e,i,i,i,i,r,o,a,i,o,t=t.split(":"),n=t[0],e=t[1];switch(n){case"t":s.sheetId=+e;break;case"c":i=c.Ed.ev(+e),s.backColor=i;break;case"f":i=c._d.ev(+e),O(s,i);break;case"h":s.hAlign=+e;break;case"v":s.vAlign=+e;break;case"b":i=c.jd.ev(+e,u),O(s,i);break;case"l":s.locked=p(e);break;case"w":s.wordWrap=p(e);break;case"se":s.showEllipsis=p(e);break;case"st":s.hv=p(e);break;case"s":s.shrinkToFit=p(e);break;case"ts":s.tabStop=p(e);break;case"q":s.quotePrefix=p(e);break;case"va":s.isVerticalText=p(e);break;case"y":s.applyFont=p(e);break;case"z":s.applyFill=p(e);break;case"r":s.applyAlignment=p(e);break;case"e":s.applyBorder=p(e);break;case"u":s.applyProtection=p(e);break;case"g":s.applyNumberFormat=p(e);break;case"i":s.textIndent=+e;break;case"im":s.imeMode=+e;break;case"o":s.opacity=+e;break;case"bl":s.backgroundImageLayout=+e;break;case"x":s.textOrientation=+e;break;case"bi":s.backgroundImage=f.getText(+e);break;case"n":s.parentName=m(e)||!u&&0==+e?g:h[e];break;case"k":s.watermark=f.getText(+e);break;case"p":s.cellPadding=f.getText(+e);break;case"tb":s.textBaseline=f.getText(+e);break;case"lo":s.labelOptions=JSON.parse(f.getText(+e));break;case"ct":i=B.ti,(r=l.getObject(+e))&&(o=r.typeName,a=void 0,(i=i[r.type]||i[o]||d.getTypeFromString(o))&&(a=new i).fromJSON(r,!0),s.cellType=a);break;case"cb":s.cellButtons=JSON.parse(l.getObject(+e));break;case"dd":s.dropDowns=JSON.parse(l.getObject(+e));break;case"dc":s.decoration=JSON.parse(l.getObject(+e));break;case"ma":s.mask=JSON.parse(l.getObject(+e));break;case"fs":s.formatter=f.getText(+e);break;case"j":o=c.Dd.ev(+e),O(s,o)}}),s},R.prototype.mv=function(t,n){var e=this;if(!m(t))return t=n&&e.gv&&e.gv[t]&&e.gv[t][n]?e.gv[t][n]:t},R.prototype.getNamedStyle=function(t,n,e){var i,r,o,o,i=this,r,o=i.Rd.getText(t);if(o!==g)return(o=o?i.vv(o,e):new v.Style).name=n,i.Hd[t]=n,o},R.prototype.getNamedStyleIndex=function(t,n,e,i,r){var o,a,u,s,c,f,l,e;if(t)return a=(o=this).Rd,u=o.Pd,s=o.qd,f=o.Kd,l=t.name,l=o.mv(l,e),e=o.lv(t,n,i,!0),r&&(!l||s.test(l))||(c=a.getTextIndex(e),f[u[l]=c]={parentName:t.parentName,name:l}),c},R.prototype.updateNamedStylesParentName=function(){var t=this,i=t.Rd,r=t.Pd,o=t.Kd;Object.keys(o).forEach(function(t){var n,e,n,t,t,n=o[t],e=n.parentName,n=n.name;m(e)||m(r[e])||(t=i.getText(+t),t=i.getTextIndex(t+(0<t.length?",n:":"n")+r[e]),r[n]=+t)})},R.prototype.addStyleParent=function(t,n,e){var e,i,r,o,a,u;if(n)for(r=(i=this).originNamedStylesXfs,o=e?t:null==(e=n.u8(t))?void 0:e.parentName;o&&a!==o;)r.setTextValue(o),o=null==(u=n.u8(o))?void 0:u.parentName,a=null==u?void 0:u.name},R.prototype.getStyle=function(t){var n,e,i,i,r,o,o,n=this,e,i=n.Yd[t];return i!==g?i:(r=(i=n.Ud)[t])!==g?r:(o=(o=n.Bd)&&o.getText(t))!==g?(r=n.vv(o,!1),i[t]=r):void 0},R.prototype.getStyleIndex=function(t,n,e){var i,r,o,a,u,s,c,f,a,f,l;if(t)return o=(i=this).Pd,a=i.Rd,u=i.Bd,s=i.qd,"string"==typeof t?(f=o[t=i.mv(t,e)],(c=a.getText(f))?(c.length&&","!==c[c.length-1]&&(c+=","),+u.getTextIndex(c+="d:"+f)):void 0):(a=t._id,f=i.Fd,a!==g&&(r=f[a])!==g?r:((l=t.name)!==g&&!s.test(l)||(l=t.parentName),l=i.mv(l,e),(c=i.lv(t,n))?(c.length&&","!==c[c.length-1]&&(c+=","),l!==g&&o[l]!==g?c+="n:"+o[l]:c+="n:0",r=u.getTextIndex(c),f[a]=r):void 0))},R.prototype.getOriginNamedStyleIndex=function(t,n){var e=this,i=e.originNamedStylesXfs;return e.addStyleParent(t,n),+i.getTextIndex(t)},R.prototype.getOriginStyleIndex=function(t,n,e){var i,r,o,r,a,a,r,e,i=this,r=i.Wd,o=i.originCellXfs;return t?(a=t._id)!==g&&(r=r[a])!==g?r:(a=i.Pd,r=i.lv(t,e,void 0,!0),t.name&&!m(a[t.name])&&(r.length&&","!==r[r.length-1]&&(r+=","),r+="d:"+a[t.name]),(e=t.parentName)&&!m(a[e])&&(i.addStyleParent(e,n,!0),r.length&&","!==r[r.length-1]&&(r+=","),r+="n:"+a[e]),+o.getTextIndex(r)):+o.getTextIndex(f)},R.prototype.getOriginStyle=function(t){var n,e,i,e,n,n=this,e=n.originCellXfs,i=n.Qd;return i[t]!==g?i[t]:(e=e.getText(t))?(n=n.vv(e,!0),i[t]=n):f},R.prototype.getOriginNamedStyle=function(t){var n,e;return this.originNamedStylesXfs.getText(t)},R.prototype.getDxf=function(t,n,e,i){var r,o;return this.kd.fv(t,n,e,i)},R.prototype.getDxfIndex=function(t,n){var e,i=this.kd;return t?i.cv(t,n):g},R.prototype.addTableStyle=function(n){0<this.zd.filter(function(t){return t.name===n.name}).length||this.zd.push(n)},R.prototype.addDefaultStyleName=function(t,n){this.Vd[t]=n},R.prototype.getDefaultStyleName=function(t){return this.Vd[t]},R.prototype.getFormatCodeByNumFmtId=function(t){return this.Dd.uv(t)},R.prototype.buildDummyNamedStyles=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=this,e=n.Bd,i=n.Jd,r=e.td.length,o=n.Yd,a=0,u=n.Hd,s=n.Xd,c=n.$d;if(u&&(Object.keys(u).forEach(function(t){var t,n,e,n,t=u[t],n=t&&t.indexOf(i);0<=n&&(e=parseInt(t.substring(n+14),10),a<e)&&(a=e),0<=(n=t&&t.indexOf(s))&&(e=parseInt(t.substring(n+19),10),c<e)&&(c=e)}),n.$d=c),0<r)for(f=0;f<r;f++)l=n.getStyle(f),h=i+(f+a),l.name=h,t.addNamedStyle(l),o[f]=h},R.prototype.yh=function(e,t){var i=this;e&&(e.sharedColors&&i.Od.yh(e.sharedColors),e.commonSharedStrings&&i.cd.yh(e.commonSharedStrings),e.cellXfs&&i.Bd.yh(e.cellXfs),e.cellStyleXfs&&i.Rd.yh(e.cellStyleXfs),e.sharedObjects&&i.yd.yh(e.sharedObjects),e.originCellXfs&&i.originCellXfs.yh(e.originCellXfs),e.originNamedStylesXfs&&i.originNamedStylesXfs.yh(e.originNamedStylesXfs),i.Ed.rv(e),i.Dd.rv(e),i._d.rv(e),i.jd.rv(e),i.kd.rv(e.dxfs),i.Vd=u(e.defaultStyleNames)||{},R.fh)&&r(R.fh,function(t,n){n.yh&&n.yh.call(i,e)})},R.prototype.wh=function(t){var e=this,i={sharedColors:e.Od.wh(),commonSharedStrings:e.cd.wh(),cellXfs:e.Bd.wh(),cellStyleXfs:e.Rd.wh(),sharedObjects:e.yd.wh(),namedStylesMap:e.Pd,defaultStyleNames:u(e.Vd),originCellXfs:e.originCellXfs.wh(),originNamedStylesXfs:e.originNamedStylesXfs.wh()};return e.Dd.iv(i),e._d.iv(i),e.Ed.iv(i),e.jd.iv(i),i.dxfs=e.kd.iv(),0<e.zd.length&&(i.tableStyles={n_:"tableStyles",c_:[].concat(e.zd),defaultPivotStyle:e.getDefaultStyleName("defaultPivotStyle")||"PivotStyleLight16",defaultTableStyle:e.getDefaultStyleName("defaultTableStyle")||"TableStyleMedium2",count:e.zd.length}),R.fh&&r(R.fh,function(t,n){n.wh&&n.wh.call(e,i)}),i},R.prototype.bv=function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},t.StyleManager=n=R,(0,s.$e)(n)},"./dist/core/util/tasks.js":function(t,n){"use strict";var e,i,r,o,a,u,s,c,f,l;function h(t,n){this.fn=t,this.args=n}function d(t,n){var e=this;e.tasks=[],e.nextTaskFunc=t.bind(e),e.isBusyFunc=n.bind(e)}function v(t,n,e,i,r){var t=f.call(this,t,n)||this;return t.description=e,t.progress=i,t.sheetName=r,t}function m(t,n,e){void 0===e&&(e=function(t){});var t=l.call(this,t,n)||this;return t.progress=e,t}e=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.LoadTasks=n.LoadTask=n.Tasks=n.Task=void 0,i=100,r=10,h.prototype.dispose=function(){this.fn=void 0,this.args=void 0},h.prototype.run=function(){this.fn.apply(null,this.args)},o=h,n.Task=o,d.prototype.addTask=function(t,n,e){this.tasks.splice(0,0,new o(t,n))},d.prototype.pushTask=function(t,n,e){this.tasks.push(new o(t,n))},d.prototype.runNextTask=function(){var t,n,e,t=this,n=t.tasks;t.isTerminated||(n.length<1?t.endingCallback&&t.endingCallback():t.isBusyFunc()?setTimeout(function(){t.runNextTask()},100):((e=t.nextTaskFunc()).run(),setTimeout(function(){t.runNextTask()},10)))},d.prototype.start=function(){var t;this.runNextTask()},d.prototype.terminate=function(){var t=this;t.tasks&&(t.tasks.forEach(function(t){t.dispose()}),t.tasks=[]),t.endingCallback=void 0,t.isTerminated=!0},n.Tasks=a=d,e(v,f=o),v.prototype.dispose=function(){this.description=void 0,this.progress=void 0,this.sheetName=void 0,f.prototype.dispose.call(this)},u=v,n.LoadTask=u,e(m,l=a),m.prototype.runNextTask=function(){var t,n,e,n,t=this,n=t.tasks,e=t.progress;t.isTerminated||(n.length<1?t.endingCallback&&t.endingCallback():t.isBusyFunc()?setTimeout(function(){t.runNextTask()},100):((n=t.nextTaskFunc()).description&&e({progress:n.progress&&n.progress(),step:n.description,sheetName:n.sheetName}),n.run(),n.dispose(),setTimeout(function(){t.runNextTask()},0)))},m.prototype.addTask=function(t,n,e,i,r){this.tasks.splice(0,0,new u(t,n,e,i,r))},m.prototype.pushTask=function(t,n,e,i,r){this.tasks.push(new u(t,n,e,i,r))},m.prototype.terminate=function(){this.progress=void 0,l.prototype.terminate.call(this)},n.LoadTasks=m},"./dist/core/util/theme.js":function(F,t,n){"use strict";var e,i,a,p,o,v,u,s,r,c,n,e,i,f,l,h,d,m,L,B,P,G,U,H,V,g,b,w,y,M,C,S,S,C,T,M;function A(n){var e=n;return function(t){return 0===arguments.length?this.yv[e]:(this.yv[n]=v(t),this)}}function I(t){return t<=0?0:t<=.0031308?255*t*12.92+.5:t<1?255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5:255}function z(t){var n,e,i,i,r,i,r,o,i,r,o,n=t.n_.split(":").pop(),e=t.val;return"sysClr"===n?void 0!==(i=g[e.toUpperCase()])?a.ColorHelper.hexToARGB(i):(i=t.lastClr)?(r=4278190080+(16777215&parseInt(i,16)),a.ColorHelper.hexToARGB(r)):void 0:"srgbClr"===n&&e?(r=4278190080+(16777215&parseInt(e,16)),a.ColorHelper.hexToARGB(r)):"scrgbClr"===n?(i=parseFloat(t._r),r=parseFloat(t.g),o=parseFloat(t.b),{a:255,r:I(i),g:I(r),b:I(o)}):"hslClr"===n?(i=parseFloat(t.wv),r=parseFloat(t.sat),o=parseFloat(t.lum),a.util.v1(i,o,r)):"prstClr"===n&&e?a.util.m1(e):void 0}function x(t){var t=t.toString(16).toUpperCase();return t=1===t.length?"0"+t:t}function N(t,n){return{n_:t,c_:[{n_:"srgbClr",val:x(n.r)+x(n.g)+x(n.b)}]}}function k(t,n,e,i,r,o,a,u,s,c,f,l,h){this.background1=A(0),this.background2=A(1),this.textColor1=A(2),this.textColor2=A(3),this.accent1=A(4),this.accent2=A(5),this.accent3=A(6),this.accent4=A(7),this.accent5=A(8),this.accent6=A(9),this.hyperlink=A(10),this.followedHyperlink=A(11),this.Zc=t,this.yv=[];for(var d=1;d<13;d++)this.yv.push(v(arguments[d]))}function _(t){return t=t&&"'"===t[0]?t.slice(1,t.length-1):t}function D(t,n,e){this.Zc=t,this.Ide=n,this.See=e}function j(t,n,e,i){var r,o,r=this;this.name=s("name"),this.colors=s("colors"),this.fmtTheme=s("fmtTheme",void 0,function(){r.Mv={}}),(o=this).name(t),o.colors(n||new w(t)),"string"!=typeof e&&e instanceof y?this.font(e):this._font=new y(void 0,e,i)}function O(){}function E(){}function R(){}Object.defineProperty(t,"__esModule",{value:!0}),t.Themes=t.ThemeFonts=t.ThemeColors=t.Theme=t.ThemeFont=t.ColorScheme=void 0,e=n("Common"),i=n("./dist/core/util/common.js"),a=n("./dist/core/util/common.js"),p=e.Common.lt.ht,o=e.Common.ft,v=o._,u=parseInt,s=i.util.p0,r=a.util.xr,c=a.util.o1,n="Gill Sans MT",e="Franklin Gothic Book",i="Trebuchet MS",l=1,h=2,d=3,m=4,L=5,B=6,P=7,G=8,U=9,H=10,V=11,g={"3DDKSHADOW":4288716960,"3DLIGHT":4293125091,ACTIVEBORDER:4290032820,ACTIVECAPTION:4288263377,APPWORKSPACE:4289440683,BACKGROUND:1044480,BTNFACE:4293980400,BTNHIGHLIGHT:4294967295,BTNSHADOW:4288716960,BTNTEXT:1044480,CAPTIONTEXT:1044480,GRAYTEXT:4285361517,HIGHLIGHT:4281571839,HIGHLIGHTTEXT:4294967295,INACTIVEBORDER:4294244348,INACTIVECAPTION:4290760155,INACTIVECAPTIONTEXT:4282601044,INFOBK:4294967265,INFOTEXT:1044480,MENU:4293980400,GRADIENTACTIVECAPTION:4290367978,HOTLIGHT:267413196,GRADIENTINACTIVECAPTION:4292338930,MENUBAR:4293980400,MENUHIGHLIGHT:4281571839,MENUTEXT:1044480,SCROLLBAR:4291348680,WINDOW:4294967295,WINDOWFRAME:4284769380,WINDOWTEXT:4278190080},(M=b=b||{})[M.lt1=f=0]="lt1",M[M.lt2=1]="lt2",M[M.dk1=2]="dk1",M[M.dk2=3]="dk2",M[M.accent1=4]="accent1",M[M.accent2=5]="accent2",M[M.accent3=6]="accent3",M[M.accent4=7]="accent4",M[M.accent5=8]="accent5",M[M.accent6=9]="accent6",M[M.hlink=10]="hlink",M[M.folHlink=11]="folHlink",k.prototype.name=function(t){return 0===arguments.length?this.Zc:(this.Zc=t,this)},k.prototype.getColor=function(t){var n,e,i,r,e;if(t&&"string"==typeof t&&(e=void 0,n=t.split(" "))){if(i=-1,1<(r=n.length)){if(!n[0])return t;"background"===(e=n[0].toLowerCase())?i=u(n[1],10)-1:"text"===e?i=u(n[1],10)+1:"accent"===e&&(i=u(n[1],10)+3)}else 1===r&&("hyperlink"===(e=n[0].toLowerCase())?i=10:"followedhyperlink"===e&&(i=11));if(0<=i&&i<=11)return 2<r?(e=u(n[2],10)/100,o.j(o.Cv(this.yv[i],e))):o.j(this.yv[i])}return t},k.prototype.toJSON=function(){var t=this,n=t.yv;return{name:t.Zc,background1:n[0],background2:n[1],text1:n[2],text2:n[3],accent1:n[4],accent2:n[5],accent3:n[6],accent4:n[7],accent5:n[8],accent6:n[9],hyperlink:n[10],followedHyperlink:n[11]}},k.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,i,n,n;function g(t,n){p(n)||(e.yv[t]={a:n.a,r:n.r,g:n.g,b:n.b})}t&&(e=this,i="_colorList",i=n?(n=t.name||t[r="_name"],p(n)||(e.Zc=n),o=(n=t.colorList||t[i])[0],a=n[1],u=n[2],s=n[3],c=n[4],f=n[5],l=n[6],h=n[7],d=n[8],v=n[9],m=n[10],n[11]):(p(t.name)||(e.Zc=t.name),o=t.background1,a=t.background2,u=t.text1,s=t.text2,c=t.accent1,f=t.accent2,l=t.accent3,h=t.accent4,d=t.accent5,v=t.accent6,m=t.hyperlink,t.followedHyperlink),g(0,o),g(1,a),g(2,u),g(3,s),g(4,c),g(5,f),g(6,l),g(7,h),g(8,d),g(9,v),g(10,m),g(11,i))},k.prototype.yh=function(t){var n,e,i,r,o,a,o;if(t)for(e=t.c_,(n=this).Zc=t.name,i=0,r=e.length;i<r;i++)(o=e[i])&&(a=o.n_.split(":").pop(),o=o.c_[0],n.yv[b[a]]=z(o))},k.prototype.wh=function(){for(var t,n,e,i,r,o,a,t=this,n={n_:"clrScheme",name:t.name()},e=[],i=t.yv,r=0,o=i.length;r<o;r++)a=i[r],2===r?e[0]=a.r+a.g+a.b===0?{n_:"dk1",c_:[{n_:"sysClr",val:"windowText",lastClr:x(a.r)+x(a.g)+x(a.b)}]}:N("dk1",a):0===r?e[1]=a.r+a.g+a.b===765?{n_:"lt1",c_:[{n_:"sysClr",val:"window",lastClr:x(a.r)+x(a.g)+x(a.b)}]}:N("lt1",a):3===r?e[2]=N("dk2",a):1===r?e[3]=N("lt2",a):e.push(N(""+b[r],a));return n.c_=e,n},k.prototype.Sv=function(t){var n,e,i,r;if(this.name()!==t.name())return!1;for(e=0,i=(n=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;e<i;e++)if(!o.Tv(this[r=n[e]](),t[r]()))return!1;return!0},w=k,t.ColorScheme=w,Object.defineProperty(D.prototype,"name",{get:function(){return this.Zc},set:function(t){this.Zc=t},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"headerFont",{get:function(){return this.Ide},set:function(t){this.Ide=t},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"bodyFont",{get:function(){return this.See},set:function(t){this.See=t},enumerable:!1,configurable:!0}),D.prototype.toJSON=function(){return{name:this.Zc,headerFont:this.Ide,bodyFont:this.See}},D.prototype.fromJSON=function(t){this.Zc=t.name,this.Ide=t.headerFont,this.See=t.bodyFont},y=D,t.ThemeFont=y,j.prototype.headerFont=function(t){if(0===arguments.length)return this._font.headerFont;this._font.headerFont=t},j.prototype.bodyFont=function(t){if(0===arguments.length)return this._font.bodyFont;this._font.bodyFont=t},j.prototype.font=function(t){if(0===arguments.length)return this._font;this._font=new y,this._font.fromJSON(t.toJSON())},j.prototype.getColor=function(t){return this.colors().getColor(t)},j.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headerFont():t},j.prototype.toJSON=function(){var t=this,n=t.name();return j.Av(t)?n:{name:n,themeColor:t.colors()?t.colors().toJSON():void 0,headingFont:t.headerFont(),bodyFont:t.bodyFont(),font:t._font.toJSON()}},j.prototype.fromJSON=function(t){var n;"string"==typeof t?(n=T[t],this.name(n.name()),this.colors(n.colors()),this.headerFont(n.headerFont()),this.bodyFont(n.bodyFont()),this.font(n.font())):(this.name(t.name),this.bodyFont(t.bodyFont),this.headerFont(t.headingFont),this.colors().fromJSON(t.themeColor),t.font&&this._font.fromJSON(t.font))},j.prototype.wh=function(t){var n,e,i,r,t,n=this,e=n.name();return!1!==t&&j.Av(n)?e:(t={n_:"themeElements",c_:[]},(r=(i=n.colors())?i.wh():r)&&t.c_.push(r),t.c_.push({n_:"fontScheme",c_:[{n_:"majorFont",c_:[{n_:"latin",typeface:_(n.headerFont())}]},{n_:"minorFont",c_:[{n_:"latin",typeface:_(n.bodyFont())}]}],name:n._font.name}),{n_:"theme",name:e,c_:[t]})},j.prototype.yh=function(t){var n,t,e,i,e,i,n=this;"string"==typeof t?n.Iv(t):(n.Iv(t.name),t=r(t,"themeElements"),e=r(t,"clrScheme"),(i=new w("")).yh(e),n.colors(i),(e=r(t,"fontScheme"))&&(n.headerFont(c(e,"majorFont&latin").typeface),n.bodyFont(c(e,"minorFont&latin").typeface),e.name)&&(n._font.name=e.name),(i=r(t,"fmtScheme"))&&n.fmtTheme(i))},j.prototype.Iv=function(t){var n,t,n=this;t&&"OFFICE"===t.toUpperCase().substring(0,6)&&(t="Office"),n.name(t),(t=T[t])&&(n.colors(t.colors()),n.font(t.font()))},j.Av=function(t){var n,n,n=t.name();return!!T[n]&&(n=T[n],t.bodyFont()===n.bodyFont())&&t.headerFont()===n.headerFont()&&t.font().name===n.font().name&&t.colors().Sv(n.colors())},M=j,t.Theme=M,O.Default=new w("Default",S="#FFFFFF","#EEECE1",C="#000000","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),O.Office2007=new w("Office2007",S,"#EEECE1",C,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),O.Office=new w("Office",S,"#E7E6E6",C,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),O.Apex=new w("Apex",S,"#C9C2D1",C,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),O.Aspect=new w("Aspect",S,"#E3DED1",C,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),O.Concourse=new w("Concourse",S,"#DEF5FA",C,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),O.Civic=new w("Civic",S,"#C5D1D7",C,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),O.Oriel=new w("Oriel",S,"#FFF39D",C,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),O.Origin=new w("Origin",S,"#DDE9EC",C,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),O.Paper=new w("Paper",S,"#FEFAC9",C,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),O.Solstice=new w("Solstice",S,"#E7DEC9",C,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),O.Technic=new w("Technic",S,"#D4D2D0",C,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),O.Trek=new w("Trek",S,"#FBEEC9",C,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),O.Urban=new w("Urban",S,"#DEDEDE",C,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),O.Verve=new w("Verve",S,"#D2D2D2",C,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),O.Equity=new w("Equity",S,"#E9E5DC",C,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),O.Flow=new w("Flow",S,"#DBF5F9",C,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),O.Foundry=new w("Foundry",S,"#EAEBDE",C,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),O.Median=new w("Median",S,"#EBDDC3",C,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),O.Metro=new w("Metro",S,"#D6ECFF",C,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),O.Module=new w("Module",S,"#D4D4D6",C,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),O.Opulent=new w("Opulent",S,"#F4E7ED",C,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),t.ThemeColors=S=O,E.Office=new y("Office","Calibri Light","Calibri"),E.Office2007=new y("Office2007","Cambria","Calibri"),E.LucidaBook=new y("LucidaBook","Lucida Sans","Book Antiqua"),E.Verdana=new y("Verdana","Verdana","Verdana"),E.LucidaSansUnicode=new y("LucidaSansUnicode","Lucida Sans Unicode","Lucida Sans Unicode"),E.Georgia=new y("Georgia","Georgia","Georgia"),E.CenturySchoolbook=new y("CenturySchoolbook","Century Schoolbook","Century Schoolbook"),E.BookmanGillSansMT=new y("BookmanGillSansMT","Bookman Old Style",n),E.Constantia=new y("Constantia","Constantia","Constantia"),E.GillSansMT=new y("GillSansMT",n,n),E.FranklinGothicArial=new y("FranklinGothicArial",e,"Arial"),E.FranklinGothic=new y("FranklinGothic","Franklin Gothic Medium",e),E.TrebuchetGeorgia=new y("TrebuchetGeorgia",i,"Georgia"),E.CenturyGothic=new y("CenturyGothic","Century Gothic","Century Gothic"),E.FranklinGothicPerpetua=new y("FranklinGothicPerpetua",e,"Perpetua"),E.CalibriConstantia=new y("CalibriConstantia","Calibri","Constantia"),E.Rockwell=new y("Rockwell","Rockwell","Rockwell"),E.TwCenMT=new y("TwCenMT","Tw Cen MT","Tw Cen MT"),E.ConsolasCorbel=new y("ConsolasCorbel","Consolas","Corbel"),E.Corbel=new y("Corbel","Corbel","Corbel"),E.TrebuchetMS=new y("TrebuchetMS",i,i),t.ThemeFonts=C=E,R.Default=new M("Default",S.Default,"Cambria","Calibri"),R.Office=new M("Office",S.Office,C.Office),R.Office2007=new M("Office2007",S.Office2007,C.Office2007),R.Apex=new M("Apex",S.Apex,C.LucidaBook),R.Aspect=new M("Aspect",S.Aspect,C.Verdana),R.Concourse=new M("Concourse",S.Concourse,C.LucidaSansUnicode),R.Civic=new M("Civic",S.Civic,C.Georgia),R.Oriel=new M("Oriel",S.Oriel,C.CenturySchoolbook),R.Origin=new M("Origin",S.Origin,C.BookmanGillSansMT),R.Paper=new M("Paper",S.Paper,C.Constantia),R.Solstice=new M("Solstice",S.Solstice,C.GillSansMT),R.Technic=new M("Technic",S.Technic,C.FranklinGothicArial),R.Trek=new M("Trek",S.Trek,C.FranklinGothic),R.Urban=new M("Urban",S.Urban,C.TrebuchetGeorgia),R.Verve=new M("Verve",S.Verve,C.CenturyGothic),R.Equity=new M("Equity",S.Equity,C.FranklinGothicPerpetua),R.Flow=new M("Flow",S.Flow,C.CalibriConstantia),R.Foundry=new M("Foundry",S.Foundry,C.Rockwell),R.Median=new M("Median",S.Median,C.TwCenMT),R.Metro=new M("Metro",S.Metro,C.ConsolasCorbel),R.Module=new M("Module",S.Module,C.Corbel),R.Opulent=new M("Opulent",S.Opulent,C.TrebuchetMS),T=R,t.Themes=T},"./dist/core/workbook/sheettab.js":function(t,n,e){"use strict";var i,y,r,m,g,p,o,a,u,S,f,s,c,l,h,d;function v(t){var t,n,t=d.call(this,t)||this;return t.xv=4,t.Nv="white",(n=t).kv=13,n.Dv=12,n._v=0,n.Ev=30,n.jv=28,n.Ov=28,n.Rv=g.NEW_TAB_SIZE_ASIDE,n.Bv=15,n.Lv=28,n.Fv=0,n._font="10pt Segoe UI",t}i=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),y=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.Gv=void 0,r=e("Common"),m=e("./dist/core/util/common.js"),g=e("./dist/core/workbook/sheettabbase.js"),p=e("./dist/core/core.enum.js"),o=r.Common.ft,a=o.Uv,u=o._,S=m.mt.Tt,f=null,s="blank",c="nextButton",d=g.Hv,i(v,d),v.prototype.zv=function(){var t=this.Vv,t=t&&t.options;return t&&t.tabNavigationVisible?this.jv*(t.useTouchLayout?1.5:1):0},v.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Zv():0},v.prototype.Wv=function(){return this.Ov},v.prototype.Qv=function(){return this.Ov},v.prototype.Jv=function(){return this.Vv.options.newTabVisible?this.Rv:0},v.prototype.Xv=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.Vv.qv(),e=t.$v,i=t.M2e,r=t.tm();for(t.nm()&&(r-=t.em()),o=t.im(),a=t.ot(),u=o?a.x+a.width-t.rm()-t.Jv()-t.Qv():a.y+a.height-t.Yv(),s=t.om,c=n.length;s<c;s++)if(n[s].visible()===p.SheetTabVisible.visible&&(r+=(o?e:i)[s]),u<r){r=u;break}return r},v.prototype.tm=function(){var t,n,e,n,e,n,t=this,n=t.Vv.options,e=t.im(),n=n.tabNavigationVisible;return e?(e=2*t.em(),n&&(e-=t.em()),2*t.zv()+t.Wv()+t.um()+e):(n=t.cm(),t.nm()&&(n=0),Math.max(t.Jv(),n))},v.prototype.um=function(){var t=this,n=t.Vv;return n&&n.options.tabNavigationVisible?t.rm()/2:0},v.prototype.getResizeBarBounds=function(){var t,n,t=this,n=t.ot();return{x:n.x+n.width-t.rm(),y:f,width:t.rm(),height:f}},v.prototype.getNavButtonBounds=function(){var t,n,e,i,r,o,a,u,o,s,t,t=this,n,o=t.im()?(e=t.rm()/2,i=f,r=t.zv(),f):(o=t.ot(),s=t.Yv(),t=t.zv(),e=o.width/2-t,i=o.height-s,r=t,s),a=1,u=3;return{x:e,y:i,width:r,height:o,startIndex:1,endIndex:3}},v.prototype.getSheetTabBounds=function(){var t,n,e,i,t=this,n=t.ot(),e=t.Qv(),i=t.tm();return t.nm()&&(i-=t.em()),{x:i,y:f,height:f,secondMoreTabWidth:t.Qv(),moreTabPos:n.x+n.width-t.rm()-t.Jv()-e}},v.prototype.getPreMoreTabBounds=function(){var t,n,t=this,n=t.tm();return t.nm()&&(n-=t.em()),{x:n-t.Wv(),width:t.Wv()}},v.prototype.getAllSheetsBounds=function(){var t,n,e,i,r,o,a,u,s,c,f,r,n,n,a,i,t=this,n=t.im(),e=t.Vv.options.newTabVisible,i=t.Vv.options.tabNavigationVisible,r=t.Vv.options.useTouchLayout,o=t.ot(),a=t.getNavButtonBounds(),u=t.em(),s=t.cm(),n=(r=n?(c=a.x+2*a.width,c+=t.em()-t.rm()/2,0===t.rm()&&i&&(c-=t.em()),f=o.y,u):r?(n=o.x,a=o.width,e&&(n=o.x+o.width/2,a=o.width/2),c=n,f=o.y,a):(i=e?0:t.Bv/-2,c=(o.x+o.width)/2+i,f=5,u+4),s);return{x:c,y:f,width:r,height:n}},v.prototype.fm=function(){var t,n,t=this,n;return t.im()?t.lm+t.$v[t.hm]>t.dm():t.lm+2*t.M2e[t.hm]>t.dm()},v.prototype.dm=function(){var t,n,t=this,n;return t.im()?t.ot().width-t.rm()-t.Jv()-t.Qv():t.ot().height-t.Yv()},v.prototype.vm=function(){return 6},v.prototype.mm=function(){return[s,c]},v.prototype.gm=function(){return this.tm()},v.prototype.pm=function(t,n){var e,i,e=this;t.save(),t.beginPath(),i=m.I.He(0,"gc-tabStripBackground").backgroundColor,e.bm=u(i),t.fillStyle=i,t.fillRect(n.x,n.y,n.width,n.height),t.restore()},v.prototype.ym=function(t,n){var e,i,i,r,o,a,u,s,e,i=this.Vv,i=i&&i.options.tabStripPosition,r=m.I.He(0,"gc-tabStripBackground").borderTopColor;t.save(),t.beginPath(),t.strokeStyle=r,i===p.TabStripPosition.bottom?(o=n.x,a=n.y,u=n.x+n.width,s=n.y+.5):i===p.TabStripPosition.top?(o=n.x,a=n.height-.5,u=n.x+n.width,s=n.y+n.height-.5):i===p.TabStripPosition.left?(o=n.x+n.width-.5,a=n.y,u=n.x+n.width-.5,s=n.y+n.height):i===p.TabStripPosition.right&&(o=n.x+.5,a=n.y,u=n.x+.5,s=n.y+n.height),t.moveTo(o,a),t.lineTo(u,s),t.stroke(),t.restore()},v.prototype.wm=function(t,n){var e=this;e.pm(t,n),e.ym(t,n)},v.prototype.Mm=function(t,n,e){var i,r,o,a,u,s,e,c,f,l,a,l,l,s,i=this,r,o=i.Vv.options.newTabVisible,a=i.im(),u=i.tm(),s=i.jv,e=e,c=0,f=s;a?(i.nm()&&(u-=i.em()),e+=a=i.Qv(),(l=n.x+n.width-i.rm()-i.Jv())<e&&((l=(e=l)-a)<u&&(e=(l=u)+s),i.Cm(t,l,0,a,n.height)),l=n.height):(s=i.em(),i.nm()&&(s=0),e=(n.width-u)/2-s,f=l=u),o&&i.Sm(t,e,0,f,l,-2===i.Tm)},v.prototype.Am=function(t,n,e,i){var r=this.Wv();this.Cm(t,i-r,0,r,n.height)},v.prototype.Im=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.im(),r=e.xm,o=e.zv(),a=e.Yv(),u=e.Nm;i?(s=e.rm()/2+o/2,e.km(t,s,c=a/2,s+r,c+r,s+r,c-r,g.NavButtonDirection.left,f,1===u),e.km(t,s+=o,c,s-r,c+r,s-r,c-r,g.NavButtonDirection.right,f,2===u)):(s=(n.width-o)/2,c=n.height-a/2,e.km(t,s,c,s+r,c+r,s-r,c+r,g.NavButtonDirection.top,f,1===u),e.km(t,s+=o,c,s-r,c+r,s-r,c-r,g.NavButtonDirection.bottom,f,2===u))},v.prototype.Dm=function(t,n){var e,i,r,o,i,a,u,s,c,a,e=this,i=e.Vv.options,r=i.allSheetsListVisible,o=i.newTabVisible,i=i.tabNavigationVisible,a=e.im(),u=e.tm();e.nm()&&(u-=e.em()),s=0,c=10,a?(s=2*e.zv()+e.em(),0===e.rm()&&i&&(s-=e.em())):(a=o?e.em():e.em()/2,s=(n.width-u)/2+a),r!==p.AllSheetsListVisibility.hide&&e._m(t,s,10,-3===e.Tm)},v.prototype.Em=function(t,n){var e,e,i,i,r,e=this,i=e.rm(),r=m.I.He(0,"gc-tabStripResizeBarInner");e.Vv.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(n.x+n.width-i,0,i,n.height),t.clip(),e=n.x+n.width-i/2,i=n.y+n.height/2,t.fillStyle=r.color,t.fillRect(e,i,2,2),t.fillRect(e,i-4,2,2),t.fillRect(e,i+4,2,2))},v.prototype.jm=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,u,s,a,v,m,u=this,s=u.Vv,c=s.options.tabStripPosition,f=u.Om,l=u.Nv,h=u.xv,d=u.Rm,u=u.im(),s=s.sheetTabStyles.C2e(a),a=s&p.SheetTabState.active,v=s&p.SheetTabState.selected;t.save(),a&&v&&(t.fillStyle=l,c===p.TabStripPosition.bottom?t.fillRect(n,e,i,r-h):c===p.TabStripPosition.top?t.fillRect(n,e+h,i,r):c===p.TabStripPosition.left?t.fillRect(n+f,e,i-f,r):t.fillRect(n,e,i-f,r)),s&p.SheetTabState.selected?(t.fillStyle=l,c===p.TabStripPosition.bottom?t.fillRect(n,e+1,i,r-h):c===p.TabStripPosition.top?t.fillRect(n,e+h-1,i,r):s&p.SheetTabState.active?c===p.TabStripPosition.left?t.fillRect(n+f,e,i-f,r+1):t.fillRect(n,e,i-f,r+1):t.fillRect(n+f,e,i-2*f,r+1)):s&p.SheetTabState.active&&(t.fillStyle=l,c===p.TabStripPosition.bottom?t.fillRect(n,e,i,1):c===p.TabStripPosition.top?t.fillRect(n,e+r,i,1):c===p.TabStripPosition.left?t.fillRect(n+f,e,i-f,r+1):t.fillRect(n,e,i-f,r+1)),t.fillStyle=o,u?c===p.TabStripPosition.bottom?t.fillRect(n+d,e+(m=a?d-1:d),i-2*d+1,r-2*d):t.fillRect(n+d,e+(m=a?d+1:d),i-2*d+1,r-2*d):s&p.SheetTabState.active?c===p.TabStripPosition.left?t.fillRect(n+f,e,i-f,r+1):t.fillRect(n,e,i-f,r+1):t.fillRect(n+f,e,i-2*f,r+1),t.restore()},v.prototype.Bm=function(t,n,e,i,r,o,a){var u,s,c,f,l,u,s,u=this,s=u.Vv,c=s.options.tabStripPosition,f=u.xv,l=u.Om,u=u.im(),s=s.sheetTabStyles.C2e(a);t.save(),u?(t.beginPath(),t.lineWidth=1,t.strokeStyle=o,s&p.SheetTabState.active?c===p.TabStripPosition.bottom?(t.moveTo(n+.5,e),t.lineTo(n+.5,e+r-f),t.moveTo(n+i+.5,e),t.lineTo(n+i+.5,e+r-f)):c===p.TabStripPosition.top&&(t.moveTo(n+.5,e+f),t.lineTo(n+.5,e+r),t.moveTo(n+i+.5,e+f),t.lineTo(n+i+.5,e+r)):(t.moveTo(n+.5,e+f),t.lineTo(n+.5,e+r-f),t.moveTo(n+i+.5,e+f),t.lineTo(n+i+.5,e+r-f))):(t.beginPath(),t.lineWidth=1,t.strokeStyle=o,s&p.SheetTabState.active?c===p.TabStripPosition.left?(t.moveTo(n+l,e+.5),t.lineTo(n+l+i,e+.5),t.moveTo(n+l,e+r+.5),t.lineTo(n+l+i,e+r+.5)):(t.moveTo(n,e+.5),t.lineTo(n+i-l,e+.5),t.moveTo(n,e+r+.5),t.lineTo(n+i-l,e+r+.5)):(t.moveTo(n+l,e+.5),t.lineTo(n-l+i,e+.5),t.moveTo(n+l,e+r+.5),t.lineTo(n-l+i,e+r+.5))),t.stroke(),t.restore()},v.prototype.Lm=function(t,n,e,i,r,o,a){var u,s,c,f,u,l,u=this,s=u.Vv,c=s.options.tabStripPosition,f=u.xv,u=u.Om,l;s.sheetTabStyles.C2e(a)&p.SheetTabState.selected&&(t.save(),t.beginPath(),t.strokeStyle=o,t.lineWidth=2,c===p.TabStripPosition.bottom?(t.moveTo(n,e+r-f),t.lineTo(n+i+1,e+r-f)):c===p.TabStripPosition.top?(t.moveTo(n,e+f),t.lineTo(n+i+1,e+f)):c===p.TabStripPosition.left?(t.moveTo(n+u,e),t.lineTo(n+u,e+r+1)):(t.moveTo(i-u,e),t.lineTo(i-u,e+r+1)),t.stroke(),t.restore())},v.prototype.S2e=function(t,n,u,e){var i,s,c,f,r,l,o,n,r,e,h,a,d,v,e,m,g,p,b,w,w,i=this;if(i.im())return{text:u,leftIcons:null==e?void 0:e.leftIcons,rightIcons:null==e?void 0:e.rightIcons};if(s=0,c={text:u},f={text:""},r=i.Rm+i.Om,l=n-2*r-2-1,o=e.font,n=e.leftIcons,r=e.rightIcons,e=i.T2e,h=e.iconSpace,a=e.iconTextSpace,d=e.defaultSize,v=i.Mt(t,i.A2e,o),e=function(t,n){for(var e,i,r,o,a,e,e,i=[],r=0;r<t.length;r++){if(e=(null!=(e=(o=t[r]).width)?e:d)+((a=0===r)?0:h),l<(e=s+e))return 0!==r||n||(f.hasEllipsis=!0),!0;i.push(o),e+v<=l?(f.hasEllipsis||(f.hasEllipsis=!0),n?(f.rightIcons=y([],i,!0),f.text=u):(f.leftIcons=y([],i,!0),f.text="")):n||0!==r||(f.hasEllipsis=!0),s=e}return n?c.rightIcons=i:c.leftIcons=i,!1},n&&0<n.length){if(m=e(n))return f;s+=a}else f.text=i.A2e;for(g="",p=0;p<u.length;p++){if(b=u[p],w=i.Mt(t,b,o),l<(w=s+w))return f;g+=b,w+v<=l&&(f.text=g+i.A2e,f.hasEllipsis)&&(f.hasEllipsis=!1),s=w}return r&&0<r.length&&(s+=a,m=e(r,!0))?f:c},v.prototype.x2e=function(t){var n,e,i,n=this,e=0;return n.im()?(i=n.Vv.options.tabStripPosition)===p.TabStripPosition.bottom?e-=t?2:1:e+=t?-1:1:e+=2,e},v.prototype.I2e=function(h,d,v,m,t,g){var p,b,w,t,y,M,C,p=this,b=t,w=p.BO(),t=p.T2e,y=t.defaultSize,M=t.iconSpace,C=p.im();return g.forEach(function(t,n){var e,t,i,r,o,a,u,e,t,s,c,f,l;w.getState(t.src)&&w.qh(t.src)&&(i=w.getImage(t.src),o=r=0,a=d,u=v,e=null!=(e=t.width)?e:y,t=null!=(t=t.height)?t:y,s=(m-t)/2+(C?p.x2e(!0):0),c=void 0,S.msie&&((c=document.createElement("div")).appendChild(i),document.body.appendChild(c)),f=i.width,l=i.height,S.msie&&(c.removeChild(i),document.body.removeChild(c)),h.drawImage(i,0,0,f,l,a+b,u+s,e,t),b=b+e+(n===g.length-1?0:M))}),b},v.prototype.N2e=function(t,n,e,i,r,o,a){var u,o,s,c,f,o,l,a,h,d,v,m,i,v,d,u=this,o=u.S2e(t,i,o,a),s=o.leftIcons,c=o.rightIcons,f=o.text,o=o.hasEllipsis,l=a.font,a=a.foreColor,h=u.T2e.iconTextSpace,d=u.im(),v=d?u.kv:u.Rm+u.Om,m,i=i-v-(d?u.Dv:u.Rm+u.Om)-(d?0:3),v=v+(d?0:2),d=r/2+u.x2e();t.save(),t.beginPath(),t.rect(n+v,e,i,r),t.clip(),s&&(v=u.I2e(t,n,e,r,v,s)),t.font=null!=l?l:t.font,t.fillStyle=a,t.textBaseline="middle",0<f.length&&(s&&0<s.length&&(v+=h),t.fillText(f,n+v,e+d),v+=t.measureText(f).width),c&&(0<f.length&&(v+=h),v=u.I2e(t,n,e,r,v,c)),o&&t.fillText(u.A2e,n+v,e+d),t.restore()},v.prototype.Hm=function(t,n,e,i,r,o,a){var u,s,c,a,u=this,s=a.composedStyle,c=a.borderLeftColor,a=a.borderBottomColor;u.jm(t,n,e,i,r,s.backColor,o),u.Bm(t,n,e,i,r,c,o),u.Lm(t,n,e,i,r,a,o),u.N2e(t,n,e,i,r,o,s)},v.prototype.km=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,c,f;t.save(),f=this,l=u===g.NavButtonDirection.left||u===g.NavButtonDirection.top,h=p.VisualState.highlight,c&&(h=p.VisualState.hover),l?(u===g.NavButtonDirection.left?n-=2:e-=2,-1===(d=f.Vm(f.om))&&(h=p.VisualState.normal)):(u===g.NavButtonDirection.right?n+=2:e+=2,-1===(v=f.Ym(f.Zm()))&&(h=p.VisualState.normal)),c=m.I.He(h,"gc-navButton-"+m.I.Ee(h)),t.strokeStyle=this.Wm(c.borderTopColor),t.beginPath(),f=l?1:-1,u===g.NavButtonDirection.left||u===g.NavButtonDirection.right?(t.moveTo(n-.5,e),t.lineTo(n-.5,e+1),t.moveTo(n+f-.5,e-1),t.lineTo(n+f-.5,e+2),t.moveTo(n+2*f-.5,e-2),t.lineTo(n+2*f-.5,e+3),t.moveTo(n+3*f-.5,e-3),t.lineTo(n+3*f-.5,e+4)):u!==g.NavButtonDirection.top&&u!==g.NavButtonDirection.bottom||(t.moveTo(n,e-.5),t.lineTo(n+1,e-.5),t.moveTo(n-1,e+f-.5),t.lineTo(n+2,e+f-.5),t.moveTo(n-2,e+2*f-.5),t.lineTo(n+3,e+2*f-.5),t.moveTo(n-3,e+3*f-.5),t.lineTo(n+4,e+3*f-.5)),t.stroke(),t.restore()},v.prototype.Sm=function(t,n,e,i,r,o){var a,u,s,o,a=this;t.save(),t.beginPath(),u=(r-2*a.Qm)/2,s=p.VisualState.highlight,o&&(s=p.VisualState.hover),o=m.I.He(s,"gc-tabStripNewTab-"+m.I.Ee(s)),t.lineWidth=1.5,t.strokeStyle=a.Wm(o.borderTopColor),t.arc(n+i/2,e+r/2,u,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(n+i/2-4,e+r/2),t.lineTo(n+i/2+4,e+r/2),t.moveTo(n+i/2,e+r/2-4),t.lineTo(n+i/2,e+r/2+4),t.stroke(),t.restore()},v.prototype._m=function(t,n,e,i){var r,o,a,u,i,r=this,o=15,a=5;r.nm()&&(o=0),t.save(),t.beginPath(),u=p.VisualState.highlight,i&&(u=p.VisualState.hover),i=m.I.He(u,"gc-tab-strip-all-sheets-"+m.I.Ee(u)),t.strokeStyle=r.Wm(i.borderTopColor),t.lineWidth=2,t.moveTo(n,e),t.lineTo(n+o,e),t.moveTo(n,e+5),t.lineTo(n+o,e+5),t.moveTo(n,e+10),t.lineTo(n+o,e+10),t.stroke(),t.restore()},v.prototype.Cm=function(t,n,e,i,r){var o,a,a;t.save(),t.beginPath(),o=p.VisualState.highlight,5!==(a=this.Nm)&&6!==a||(o=p.VisualState.hover),a=m.I.He(o,"gc-navMoreButton-"+m.I.Ee(o)),t.fillStyle=this.Wm(a.borderTopColor),t.fillRect(n+i/2,e+r/2,2,2),t.fillRect(n+i/2-4,e+r/2,2,2),t.fillRect(n+i/2+4,e+r/2,2,2),t.restore()},v.prototype.Wm=function(t){var n=u(t),e=this.bm;return n.a<=.01?a(e):o.Km(e,n)?a(n):t},n.Gv=v},"./dist/core/workbook/sheettab2007.js":function(t,n,e){"use strict";var i,y,r,o,S,T,M,s,A,C,I,x,N,v,a,k,e,h,u,c,f;function l(t){var t,n,t=f.call(this,t)||this,n=t;return n.kv=12,n.Dv=8,n._v=3,n.Ev=12,n.Rv=48,n.Bv=15,n.Lv=28,n.Fv=5,n._font="10pt Arial",t}i=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),y=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.Jm=void 0,r=e("./dist/core/core.ns.js"),o=e("Common"),S=e("./dist/core/util/common.js"),T=e("./dist/core/workbook/sheettabbase.js"),M=e("./dist/core/core.enum.js"),s=e("./dist/core/worksheet/stylehelper.js"),A=S.mt.ri,C=S.mt.Tt,I=null,x=Math.min,N=Math.max,v="#92A5C7",a="newSheet",k="linear-gradient",e=new o.Common.ResourceManager(r.SR,"Sheets"),h=e.getResource.bind(e),f=T.Hv,i(l,f),l.prototype.zv=function(){var t,n,e,t=this.Vv,n=t&&t.options,e=0;return e=n&&n.tabNavigationVisible?t.Xm()*(n.useTouchLayout?2:1):e},l.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Xm():0},l.prototype.tm=function(){var t,n,e,t=this,n;return t.im()?4*t.zv()+t.qm()+t.em():(e=t.cm(),t.nm()&&(e=0),Math.max(t.Jv(),e))},l.prototype.qm=function(){var t,n=this.Vv;return n&&n.options.tabNavigationVisible?2:0},l.prototype.getResizeBarBounds=function(){var t,n,t=this,n=t.ot();return{x:n.x+n.width-t.rm(),y:I,width:t.rm(),height:I}},l.prototype.getNavButtonBounds=function(){var t,n,e,i,r,o,a,u,o,s,t,t=this,n,o=t.im()?(e=0,i=I,r=t.zv(),I):(o=t.ot(),s=t.Yv(),t=t.zv(),e=o.width/2-2*t,i=o.height-s,r=t,s),a=0,u=4;return{x:e,y:i,width:r,height:o,startIndex:0,endIndex:4}},l.prototype.getSheetTabBounds=function(){var t,n,t=this,n=t.tm();return t.nm()&&(n-=t.em()),{x:n,y:I,height:I,secondMoreTabWidth:0,moreTabPos:0}},l.prototype.getPreMoreTabBounds=function(){var t,n,t=this,n=t.tm();return t.nm()&&(n-=t.em()),{x:n,width:t._v+t.Fv}},l.prototype.getAllSheetsBounds=function(){var t,n,e,i,r,o,a,u,s,c,f,r,n,n,a,i,t=this,n=t.im(),e=t.Vv.options.newTabVisible,i=t.Vv.options.tabNavigationVisible,r=t.Vv.options.useTouchLayout,o=t.ot(),a=t.getNavButtonBounds(),u=t.em(),s=t.cm(),n=(r=n?(c=a.x+4*a.width,c+=t.em()/2-t.rm()/2,0===t.rm()&&i&&(c-=t.em()/2),f=o.y,u):r?(n=o.x,a=o.width,e&&(n=o.x+o.width/2,a=o.width/2),c=n,f=o.y,a):(i=e?0:t.Bv/-2,c=(o.x+o.width)/2+i,f=5,u+4),s);return{x:c,y:f,width:r,height:n}},l.prototype.fm=function(){var t,n,t=this,n;return t.im()?t.lm+t.$v[t.hm]+t.Jv()>t.dm():t.lm+2*t.M2e[t.hm]>t.dm()},l.prototype.dm=function(){var t,n,t=this,n;return t.im()?t.ot().width-t.rm():t.ot().height-t.Yv()},l.prototype.vm=function(){var t;return this.im()?1:4},l.prototype.mm=function(){return[a]},l.prototype.gm=function(){var t,n,e,t=this,n=t.im(),e=t.tm();return e=n&&(e+=t.ot().height,t.Vv.options.newTabVisible)?(e+=t.Jv())+t._v:e},l.prototype.wm=function(t,n){var e,i,r,i,o,a,u,s;if(t.save(),t.beginPath(),e=t.createLinearGradient(n.x,n.y,n.width,n.height),r=(i=S.I.He(0,"gc-tabStripBackground"))&&i.backgroundImage,i=i&&i.backgroundColor,r&&-1!==r.indexOf(k))for(a=0,u=(o=A(r)).length;a<u;a++)s=o[a],e.addColorStop(s.point,s.color);else i&&(e.addColorStop(0,"#DDDDDD"),e.addColorStop(1,i));t.fillStyle=e,t.fillRect(n.x,n.y,n.width,n.height),t.restore()},l.prototype.k2e=function(t,n,e,i){var r,o,r,a,o,t,u,s,c,f,r=this,o=r.im(),r=r.ot(),a=o?t.createLinearGradient(r.x+.7*r.height,r.y+0,.7*r.height,r.height):t.createLinearGradient(r.x+.7*e,n,.7*e,n+e),o=i.backgroundImage,t=i.backgroundColor;if(o&&-1!==o.indexOf("linear-gradient"))for(s=0,c=(u=A(o)).length;s<c;s++)f=u[s],a.addColorStop(f.point,f.color);else t&&a.addColorStop(0,t);return a},l.prototype._2e=function(t,n,e){var i,r,o,o,a,t,n,u,i=this,r=-2===i.Tm,o=r?M.VisualState.hover:M.VisualState.normal,o=S.I.He(o,"gc-tab-"+S.I.Ee(o)),a=S.I.He(M.VisualState.normal,"gc-tab-"+S.I.Ee(M.VisualState.normal)),t=i.k2e(t,n,e,o),n=i._font;return{composedStyle:{backColor:t,font:n=r?s.W.ii(n,"bold"):n,foreColor:u=i.Um(o.color)},borderLeftColor:null==a?void 0:a.borderLeftColor,borderBottomColor:null==a?void 0:a.borderBottomColor}},l.prototype.Mm=function(t,n,e){var i,r,o,a,u,r,s,c,f,l,a,o,e,i=this,r=i.Vv,o=h().NewTab,a=i.im(),u;r.options.newTabVisible&&(f=c=void(s=r=0),l=-2===i.Tm,a?(t.font=i._font,i.Rv=t.measureText(o).width+i.kv,r=e,c=i.Jv(),f=n.height,a=i._2e(t,0,f),i.Hm(t,r,0,c,f,void 0,a)):(o=i.em(),i.nm()&&(o=0),e=T.NEW_TAB_SIZE_ASIDE,i.Rv=e,r=(n.width-e)/2-o,i.$m(t,r,0,c=e,f=e,l)))},l.prototype.$m=function(t,n,e,i,r,o){var a,a,u,u,o,s,c,f,l,h,a=this;if(t.save(),t.beginPath(),a=(r-2*a.Qm)/2,u=M.VisualState.normal,o&&(u=M.VisualState.hover),u=S.I.He(u,"gc-tab-"+S.I.Ee(u)),(o=o?u.backgroundColor:u.backgroundImage)&&-1!==o.indexOf(k))for(s=t.createLinearGradient(n+.7*r,e+0,.7*r,r),f=0,l=(c=A(o)).length;f<l;f++)h=c[f],s.addColorStop(h.point,h.color);else s=o;t.lineWidth=1.5,t.strokeStyle=s,t.arc(n+i/2,e+r/2,a,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(n+i/2-4,e+r/2),t.lineTo(n+i/2+4,e+r/2),t.moveTo(n+i/2,e+r/2-4),t.lineTo(n+i/2,e+r/2+4),t.stroke(),t.restore()},l.prototype.Am=function(t,n,e,i){var r,r,o,o,r,a,o,e,u,s,e,r,o,o,a=this,o=a.Vv,e=e-1,u="",s=a.D2e(t,0,"",e),e=a.Vv.e2(e);e&&(r=null==(r=null==(r=o.sheetTabStyles.all()[e.name()])?void 0:r[M.SheetTabState.normal])?void 0:r.backColor,o=null==(o=null==(o=o.options.defaultSheetTabStyles)?void 0:o[M.SheetTabState.normal])?void 0:o.backColor,o=e?S.Pf.vl(e,null!=(r=null!=r?r:o)?r:e.R2e()):void 0)&&(s.composedStyle.backColor=o),a.Hm(t,i,0,a.Fv,n.height,"",s)},l.prototype.Im=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.im(),r=e.tm(),o=e.xm,a=e.zv(),u=e.Yv(),s=e.Nm;t.fillStyle=v,i?t.fillRect(n.x,n.y,r-e.em()-2,n.height):t.fillRect(n.x,n.height-u,n.width,u),i?(e.km(t,c=a/2,f=u/2,c+o,f+o,c+o,f-o,T.NavButtonDirection.left,c-o,0===s),e.km(t,c+=a,f,c+o,f+o,c+o,f-o,T.NavButtonDirection.left,I,1===s),e.km(t,c+=a,f,c-o,f+o,c-o,f-o,T.NavButtonDirection.right,I,2===s),e.km(t,c+=a,f,c-o,f+o,c-o,f-o,T.NavButtonDirection.right,c+4,3===s)):(c=n.width/2-1.5*a,f=n.height-u/2,e.km(t,c,f,c+o,f+o,c-o,f+o,T.NavButtonDirection.top,f-o,0===s),e.km(t,c+=a,f,c+o,f+o,c-o,f+o,T.NavButtonDirection.top,I,1===s),e.km(t,c+=a,f,c+o,f-o,c-o,f-o,T.NavButtonDirection.bottom,I,2===s),e.km(t,c+=a,f,c+o,f-o,c-o,f-o,T.NavButtonDirection.bottom,f+o,3===s))},l.prototype.Dm=function(t,n){var e,i,r,i,o,a,u,s,o,e=this,i=e.Vv.options,r=i.allSheetsListVisible,i=i.newTabVisible,o=e.im(),a=e.tm();e.nm()&&(a-=e.em()),s=u=0,s=o?(u=4*e.zv()+1,5):(o=i?e.em():e.em()/2,u=(n.width-a)/2+o,10),r!==M.AllSheetsListVisibility.hide&&e._m(t,u,s,-3===e.Tm)},l.prototype._m=function(t,n,e,i){var r,o,a,u,s,c,s,f,l,h,d,v,m,g,l,f,u,a,p,b,w,c;if(t.save(),t.beginPath(),o=(r=this).im(),a=r.ot(),u=r.em(),c=(s=S.I.He)(4,"gc-all-sheets-button-hover"),f=(s=s(0,"gc-all-sheets-button-normal"))&&s.backgroundColor,(l=s&&s.backgroundImage)&&-1!==l.indexOf(k))for(h=t.createLinearGradient(a.x+.7*a.height,a.y+0,.7*a.height,a.height),v=0,m=(d=A(l)).length;v<m;v++)g=d[v],h.addColorStop(g.point,g.color);if(o&&(i?(t.fillStyle=c.backgroundColor,t.fillRect(n+2,a.y+2,u-4,a.height-4)):(h?t.fillStyle=h:f&&(t.fillStyle=f),t.fillRect(n-u/2,a.y+1,r.cm(),a.height-2))),o)t.strokeStyle=(i?c:s).color;else{if(l=M.VisualState.normal,i&&(l=M.VisualState.hover),g=void 0,f=S.I.He(l,"gc-all-sheets-button-"+S.I.Ee(l)),(u=i?f.backgroundColor:f.backgroundImage)&&-1!==u.indexOf(k))for(a=r.em(),g=t.createLinearGradient(n+.7*a,e+0,.7*a,a),v=0,m=(d=A(u)).length;v<m;v++)p=d[v],g.addColorStop(p.point,p.color);else g=u;t.strokeStyle=g}c=o?(b=3,w=12,4):(b=0,w=15,5),r.nm()&&(b=c=w=0),t.stroke(),t.lineWidth=1,t.moveTo(n+b,e),t.lineTo(n+w,e),t.moveTo(n+b,e+c),t.lineTo(n+w,e+c),t.moveTo(n+b,e+2*c),t.lineTo(n+w,e+2*c),t.stroke(),t.fill(),t.restore()},l.prototype.Em=function(t,n){var e,i,i,e,r,o,r,e=this,i=e.Vv,e=e.rm(),r=S.I.He,o=r(4,"gc-tabStripResizeBarInner"),r=r(0,"gc-tabStripResizeBarOuter");i.options.showHorizontalScrollbar&&(i=n.x+n.width-e,t.fillStyle=r.backgroundColor,t.fillRect(i,n.y,e,n.height),t.fillStyle=o.backgroundColor,t.fillRect(1+i,n.y+1,e-2,n.height-2),t.fillStyle=o.color,t.fillRect(i+e/2-1,n.y+4,2,n.height-8))},l.prototype.S2e=function(t,n,u,e){var i,s,c,f,r,r,l,o,n,r,e,h,a,d,v,e,m,g,p,b,w,w,i=this;if(i.im())return{text:u,leftIcons:null==e?void 0:e.leftIcons,rightIcons:null==e?void 0:e.rightIcons};if(s=0,c={text:u},f={text:""},r=i.Om*(i.Vv.options.tabStripPosition===M.TabStripPosition.right?1:2),r=i.Rm+r,l=n-2*r,o=e.font,n=e.leftIcons,r=e.rightIcons,e=i.T2e,h=e.iconSpace,a=e.iconTextSpace,d=e.defaultSize,v=i.Mt(t,i.A2e,o),e=function(t,n){for(var e,i,r,o,a,e,e,i=[],r=0;r<t.length;r++){if(e=(null!=(e=(o=t[r]).width)?e:d)+((a=0===r)?0:h),l<(e=s+e))return 0!==r||n||(f.hasEllipsis=!0),!0;i.push(o),e+v<=l?(f.hasEllipsis||(f.hasEllipsis=!0),n?(f.rightIcons=y([],i,!0),f.text=u):(f.leftIcons=y([],i,!0),f.text="")):n||0!==r||(f.hasEllipsis=!0),s=e}return n?c.rightIcons=i:c.leftIcons=i,!1},n&&0<n.length){if(m=e(n))return f;s+=a}for(g="",p=0;p<u.length;p++){if(b=u[p],w=i.Mt(t,b,o),l<(w=s+w))return f;g+=b,w+v<=l&&(f.text=g+i.A2e,f.hasEllipsis)&&(f.hasEllipsis=!1),s=w}return r&&0<r.length&&(s+=a,m=e(r,!0))?f:c},l.prototype.j2e=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,s,a,l,d,u,u=this,s=u.Vv,c=s.sheetTabStyles.C2e(a),f=s.options.tabStripPosition,l=s.sheets,h,s=s.getSheetPosition(a)===l.length-1,a=u.eg,l=u.Om,d=u.xm,u=u.im();t.save(),t.beginPath(),u?f===M.TabStripPosition.bottom?(t.moveTo(n,e),t.lineTo(n,e+r-a),t.arcTo(n,e+r,n+i,e+r,a),t.lineTo(n+i,e+r),t.lineTo(n+i+r,e),c&M.SheetTabState.active||t.lineTo(n,e)):(t.moveTo(n,e+r),t.lineTo(n,e-a),t.arcTo(n,e,n+i,e,a),t.lineTo(n+i,e),t.lineTo(n+i+r,e+r),c&M.SheetTabState.active||t.lineTo(n,e+r)):f===M.TabStripPosition.left?(t.moveTo((n+=l)+(i-=l),e),t.lineTo(n+a,e),t.arcTo(n,e,n,e+a,a),t.lineTo(n,e+r-a),t.arcTo(n,e+r,n+a,e+r,a),s?t.lineTo(n+i,e+r):(t.lineTo(n+i-d,e+r),t.lineTo(n+i,e+r+d)),c&M.SheetTabState.active||t.lineTo(n+i,e)):(i-=l,t.moveTo(n,e),t.lineTo(n+i-a,e),t.arcTo(n+i,e,n+i,e+a,a),t.lineTo(n+i,e+r-a),t.arcTo(n+i,e+r,n+i-a,e+r,a),s?t.lineTo(n,e+r):(t.lineTo(n+d,e+r),t.lineTo(n,e+r+d)),c&M.SheetTabState.active||t.lineTo(n,e)),t.fillStyle=o,t.fill(),t.strokeStyle=v,t.stroke(),t.restore()},l.prototype.I2e=function(h,d,v,m,t,g){var n,p,b,t,w,y,n=this,p=t,b=n.BO(),t=n.T2e,w=t.defaultSize,y=t.iconSpace;return g.forEach(function(t,n){var e,t,i,r,o,a,u,e,t,s,c,f,l;b.getState(t.src)&&b.qh(t.src)&&(i=b.getImage(t.src),a=d,u=v,e=null!=(e=t.width)?e:w,t=null!=(t=t.height)?t:w,s=(m-t)/2,c=void(o=r=0),C.msie&&((c=document.createElement("div")).appendChild(i),document.body.appendChild(c)),f=i.width,l=i.height,C.msie&&(c.removeChild(i),document.body.removeChild(c)),h.drawImage(i,0,0,f,l,a+p,u+s,e,t),p=p+e+(n===g.length-1?0:y))}),p},l.prototype.N2e=function(t,n,e,i,r,o,a,u){var s,o,c,f,l,o,h,a,d,v,m,m,g,i,u,g,s=this,o=s.S2e(t,i,o,a),c=o.leftIcons,f=o.rightIcons,l=o.text,o=o.hasEllipsis,h=a.font,a=a.foreColor,d=s.T2e.iconTextSpace,v=s.im(),m=s.Om*(s.Vv.options.tabStripPosition===M.TabStripPosition.right?1:2),m=v?s.kv:s.Rm+m,g=v?s.Dv:s.Rm+s.Om,i=i-m-(u?0:g),u=m,g=r/2+(v?0:2);t.save(),t.beginPath(),t.rect(n+u,e,i,r),t.clip(),c&&(u=s.I2e(t,n,e,r,u,c)),t.font=null!=h?h:t.font,t.fillStyle=a,t.textBaseline="middle",0<l.length&&(c&&0<c.length&&(u+=d),t.fillText(l,n+u,e+g),u+=t.measureText(l).width),f&&(0<l.length&&(u+=d),u=s.I2e(t,n,e,r,u,f)),o&&t.fillText(s.A2e,n+u,e+g),t.restore()},l.prototype.Hm=function(t,n,e,i,r,o,a){var u,s,c,s=this,c=null!=o?o:h().NewTab;s.j2e(t,n,e,i,r,null==(u=null==a?void 0:a.composedStyle)?void 0:u.backColor,c),s.N2e(t,n,e,i,r,c,null==a?void 0:a.composedStyle,!o)},l.prototype.km=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,f,v,m,v,g,p,b,w,y,M,C;if(t.save(),l=(f=this).im(),h=u===T.NavButtonDirection.left||u===T.NavButtonDirection.top,d=f.ot(),f=f.zv(),m=(v=S.I.He)(4,"gc-navButton-hover"),g=(v=v(0,"gc-navButton-normal"))&&v.backgroundColor,(p=v&&v.backgroundImage)&&-1!==p.indexOf(k))for(b=t.createLinearGradient(d.x+.7*d.height,d.y+0,.7*d.height,d.height),y=0,M=(w=A(p)).length;y<M;y++)C=w[y],b.addColorStop(C.point,C.color);l&&(c?(t.fillStyle=m.backgroundColor,t.fillRect(n-f/2+2,d.y+2,f-4,d.height-4)):(b?t.fillStyle=b:g&&(t.fillStyle=g),t.fillRect(n-f/2,d.y+1,f,d.height-2))),t.fillStyle=l?(c?m:v).color:!c&&b||g,void 0!==s&&s!==I&&(u===T.NavButtonDirection.left||u===T.NavButtonDirection.right?t.fillRect(s,x(r,a),1,N(r,a)-x(r,a)):t.fillRect(x(i,o),s,N(i,o)-x(i,o),1)),h?u===T.NavButtonDirection.left?(n-=2,i-=2,o-=2):(e-=2,r-=2,a-=2):u===T.NavButtonDirection.right?(n+=2,i+=2,o+=2):(e+=2,r+=2,a+=2),t.beginPath(),t.moveTo(n,e),t.lineTo(i,r),t.lineTo(o,a),t.lineTo(n,e),t.fill(),t.restore()},n.Jm=l},"./dist/core/workbook/sheettabStyleManager.js":function(t,n,e){"use strict";var s,c,i,f,l,r,o;function a(t){this.Vv=t,this.O2e={}}s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},c=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),i=e("Common"),f=e("./dist/core/core.enum.js"),l=e("./dist/core/worksheet/stylehelper.js"),r=i.Common.lt.ht,a.prototype.C2e=function(t){var n,e,t,i,n,n=this.Vv,e=n.getSheetPosition(t),t=n.Gm(t),i=f.SheetTabState.normal;return!r(t)&&(t.b2()&&(i|=f.SheetTabState.selected),n.w2.Tm===e&&(i|=f.SheetTabState.hover),n.ep()===e&&(i|=f.SheetTabState.active),n=t._gi,r(n)&&t.options.isProtected||n===f.SheetType.reportSheet&&t.Y3i())&&(i|=f.SheetTabState.protected),i},a.prototype.E2e=function(t){var n,e,e,e,n,e,n,e,n,e,n,e,i,r,o,e,i,a,n,u,t,r={},o,e=this.Vv.Gm(t);return e._gi!==f.SheetType.customSheetTab&&(i=this.C2e(t),a=null!=(n=this.Vv.options.defaultSheetTabStyles)?n:{},n=e.R2e(),u=null!=(e=this.O2e[t])?e:a,t=function(t){var n,n,e,i,t,e=r.icons,i,t=(null==(n=u[t])?void 0:n.icons)&&0<u[t].icons.length?u[t].icons:null==(n=a[t])?void 0:n.icons;return t&&0<t.length?c(c([],null!=e?e:[],!0),t,!0):e},i&f.SheetTabState.normal&&(r=s(s(s({},null!=(e=a[f.SheetTabState.normal])?e:{}),u[f.SheetTabState.normal]),{icons:t(f.SheetTabState.normal)}),n)&&!r.backColor&&(r.backColor=n),i&f.SheetTabState.protected&&(r=s(s(s(s({},r),null!=(e=a[f.SheetTabState.protected])?e:{}),u[f.SheetTabState.protected]),{icons:t(f.SheetTabState.protected)})),i&f.SheetTabState.selected&&(null!=(n=a[f.SheetTabState.selected])&&n.font||null!=(e=u[f.SheetTabState.selected])&&e.font||!r.font||(r.font=l.W.ii(r.font,"bold")),r=s(s(s(s({},r),null!=(n=a[f.SheetTabState.selected])?n:{}),u[f.SheetTabState.selected]),{icons:t(f.SheetTabState.selected)})),i&f.SheetTabState.active&&(null!=(e=a[f.SheetTabState.active])&&e.font||null!=(n=u[f.SheetTabState.active])&&n.font||!r.font||(r.font=l.W.ii(r.font,"bold")),r=s(s(s(s({},r),null!=(e=a[f.SheetTabState.active])?e:{}),u[f.SheetTabState.active]),{icons:t(f.SheetTabState.active)})),i&f.SheetTabState.hover)&&(null!=(n=a[f.SheetTabState.hover])&&n.font||null!=(e=u[f.SheetTabState.hover])&&e.font||!r.font||(r.font=l.W.ii(r.font,"bold")),r=s(s(s(s({},r),null!=(i=a[f.SheetTabState.hover])?i:{}),u[f.SheetTabState.hover]),{icons:t(f.SheetTabState.hover)})),r},a.prototype.L2e=function(t){delete this.O2e[t],this.F2e()},a.prototype.all=function(t){var n,e,n=this;return t&&0!==t.length&&0!==Object.keys(this.O2e).length?(e={},t.forEach(function(t){e[t]=n.O2e[t]}),e):this.O2e},a.prototype.B2e=function(t){var n=t;return n=t&&0!==t.length?n:this.Vv.qv().map(function(t){return t.name()})},a.prototype.add=function(n,e,t){var i,r,i=this,r;this.B2e(t).forEach(function(t){i.O2e[t]||(i.O2e[t]={}),i.O2e[t][n]=e}),this.F2e()},a.prototype.remove=function(e,t){var i,n,i=this,n;this.B2e(t).forEach(function(t){var n,n,n,n;null!=(n=null==(n=i.O2e)?void 0:n[t])&&delete n[e],0===Object.keys(null!=(n=null==(n=i.O2e)?void 0:n[t])?n:{}).length&&delete i.O2e[t]}),this.F2e()},a.prototype.clear=function(t){var n,e,n=this,e;this.B2e(t).forEach(function(t){delete n.O2e[t]}),this.F2e()},a.prototype.F2e=function(){this.Vv.w2.Cg()},a.prototype.L0=function(){this.Vv=null,this.O2e=null},n.default=a},"./dist/core/workbook/sheettabbase.js":function(h,t,n){"use strict";var m,e,i,M,C,d,g,S,r,v,B,p,T,P,G,U,b,a,A,w,y,f,H,I,x,n,o,u,s,c,V,z,n,Y,Z,n,W,Q,J,K,N,k,_,D,j,O,E,X,R,q,$,F,L,n,tt,nt,e,i;function et(t,n,e){t.ki(C.Events.SheetTabClick,{sheet:n,sheetName:n?n.name():A,sheetTabIndex:p(e)?-1:e})}function l(t){this.Zc=t,this.Fv=0,this._v=0,this.Om=6,this.ig=3,this.eg=5,this.xm=5,this.Rm=3,this.Qm=7,this.A2e="...",this.buffer=null,this.T2e={defaultSize:16,iconSpace:2,iconTextSpace:4},this.nCe={};var t=this;t.Vv=A,t.hm=0,t.om=0,t.lm=70,t.Nm=-1,t.Tm=-1,t._font="",t.$v=[],t.M2e=[],t.rg=-1,t.og=-1,t.ag=A,t.ug=A,t.sg=0,t.cg(new C.Rect(0,0,200,28))}m=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.Hv=t.NavButtonDirection=t.NEW_TAB_SIZE_ASIDE=void 0,e=n("./dist/core/core.ns.js"),i=n("Common"),M=n("./dist/core/util/domUtil.js"),C=n("./dist/core/util/common.js"),d=n("./dist/core/util/imageLoader.js"),g=n("./dist/core/worksheet/stylehelper.js"),S=n("./dist/core/core.enum.js"),r=i.Common.ft,v=C.mt.ri,B=C.mt.x0,p=i.Common.lt.ht,T=C.mt.En,P=C.mt.vt,G=C.mt.bt,U=parseInt,b=window,a=document,A=null,w=Math.max,y=Math.min,f=Math.pow,H=Math.round,I="px",x="none",o="mousedown"+(n=".gcTab"),u="mousemove"+n,s="mouseup"+n,c="mouseout"+n,V="dblclick"+n,z="mousewheel"+n,Y="mousemove"+(n=".spliter"),Z="mouseup"+n,W="keydown"+(n=".tabNameEditor"),Q="focus"+n,J="blur"+n,K="canvas",N="2d",k="resize",D="tab",j="newSheet",O="blank",E="allSheets",X="black",R="white",q=7,$=10,F=_="navButton",L="sheetTab",t.NEW_TAB_SIZE_ASIDE=28,n=new i.Common.ResourceManager(e.SR,"Sheets"),tt=n.getResource.bind(n),(i=nt=t.NavButtonDirection||(t.NavButtonDirection={}))[i.left=0]="left",i[i.right=1]="right",i[i.top=2]="top",i[i.bottom=3]="bottom",l.prototype.getNewTabBounds=function(){var t,n,e,i,r,o,a,u,t,n,n,t=this,n=t.Vv.options.useTouchLayout,e=t.ot(),i=t.Jv(),r=(i-2*t.Qm)/2,t=n?(n=e.width,t.nm()||(n/=2),o=e.x,a=e.y,u=n,i):(n=(e.x+e.width-2*r)/2,t.nm()||(n-=t.em()),o=n,a=(e.y+i-2*r)/2,u=2*r);return{x:o,y:a,width:u,height:t}},l.prototype.getCanvas=function(){return this.fg},l.prototype.im=function(){var t,n,t,n=this.Vv.options.tabStripPosition;return n===S.TabStripPosition.bottom||n===S.TabStripPosition.top},l.prototype.hg=function(t){var n,e,i;t&&((e=(n=this).fg)&&n.L0(!0),i=T(K),C.Bf.Wl(i,n.Vv),i.setAttribute("id",n.Zc),n.dg=n.vg(),n.mg(),t.appendChild(n.dg[0]),t.appendChild(i),n.fg=i,(0,M.GC$)(i).bind(o,function(t){return n.gg(t)}).bind(u,function(t){return n.pg(t)}).bind(s,function(t){return n.bg(t)}).bind(c,function(t){return n.yg(t)}).bind(V,function(t){return n.wg(t)}).bind(z,function(t){return n.Mg(t)}),n.Cg(),l.et(n,"setHost"))},l.prototype.Sg=function(t){var n,t,n=this;(n.Vv=t)&&((t=t.options.font)&&0<t.length&&(n._font=t),n.mg())},l.prototype.Tg=function(t){var n=this.Vv;n.suspendPaint(),this.Ag(t),n.resumePaint()},l.prototype.Ag=function(t){var n,e,i,r,n=this,e=-1,i=n.Zm();if(!(i.length<=0))for(;;){if(e===(r=n.Ig().tabsInfo)[0].index)return;if(e=r[0].index,r[0].index>t)n.xg(i);else{if(!(r[r.length-1].index<t||r[r.length-1].index===t&&1<r.length))return;n.Ng(i)}}},l.prototype.ot=function(){var t=this.kg;return new C.Rect(t.x,t.y,t.width,t.height)},l.prototype.cg=function(t){var n=this.kg=new C.Rect(0,0,0,0);n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height},l.prototype.Jv=function(){var t,n,t,n;return this.Vv.options.newTabVisible?this.Rv:0},l.prototype.em=function(){var t,n,e,t,n,e;return this.Vv.options.allSheetsListVisible!==S.AllSheetsListVisibility.hide?this.Bv:0},l.prototype.cm=function(){var t,n,e,t,n,e;return this.Vv.options.allSheetsListVisible!==S.AllSheetsListVisibility.hide?this.Lv:0},l.prototype.Xv=function(){var t,n,e,t=this,n=t.ot(),e;return t.im()?n.x+n.width-t.rm():n.y+n.height-t.Yv()},l.prototype.tm=function(){return 0},l.prototype.rm=function(){var t,n,e,t=this,n=S.TabStripPosition.bottom,e=t.Vv;return(n=e?e.options.tabStripPosition:n)===S.TabStripPosition.bottom?t.Ev:0},l.prototype.Cg=function(){var t,n,e,i,e,r,t=this,n=t.Dg();n&&n.parentNode&&0!==(e=(0,M.GC$)(n.parentNode)).width()&&0!==e.height()&&(i=w(e.width(),0),e=w(e.height(),0),n.style.display=x,n.width=i,n.height=e,n.style.display="",n.style.width=i+I,n.style.height=e+I,i=n.clientWidth||n.width,e=n.clientHeight||n.height,r=t.ot(),t.cg(new C.Rect(r.x,r.y,i,e)),C.Bf.$l(n,i,e),t.repaint())},l.prototype.fm=function(){return!1},l.prototype.Yv=function(){return 0},l.prototype.dm=function(){return 0},l.prototype.vm=function(){return 0},l.prototype.mm=function(){return[]},l.prototype.gm=function(){return 0},l.prototype.vg=function(){return this.dg||(0,M.GC$)(T("div"))},l.prototype.mg=function(){var t,n,t,t,e,t=this,n=t.dg;n&&(e=void 0,(t=(t=t.Vv)?t.options.tabStripPosition:S.TabStripPosition.bottom)===S.TabStripPosition.bottom?e="gc-tab-indicator-bottom":t===S.TabStripPosition.top?e="gc-tab-indicator-top":t===S.TabStripPosition.left?e="gc-tab-indicator-left":t===S.TabStripPosition.right&&(e="gc-tab-indicator-right"),n.removeClass(),n.addClass(e))},l.prototype.L0=function(t){var n,e,i,n=this,e=n.fg;e&&(i=e.parentNode,(0,M.GC$)(e).unbind(o).unbind(u).unbind(s).unbind(V).unbind(c).unbind(z),i)&&i.removeChild(e),(0,M.GC$)(n.dg).remove(),l.et(n,"dispose"),t||(n.Vv=A),n.MC&&(n.MC.L0(),n.MC=A)},l.prototype._g=function(t,n){var e,i,r,o,a,o,u,s,r,c,f,l,h,o,a,r,a,o,d,v,m,g,p,b,e=this,i=e.Vv,r=i.options.scrollbarAppearance===S.ScrollbarAppearance.mobile,o=i.options.showHorizontalScrollbar,a=e.ot();if(o&&!r&&(o=e.getResizeBarBounds(),i.options.showHorizontalScrollbar)&&t>o.x&&t<a.x+a.width)return{type:"resize",element:k};for(s=-1,r=(u=e.getNavButtonBounds()).startIndex,c=u.x,f=u.endIndex,l=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],h=r;h<f;h++){if(c<t&&t<c+u.width){_=l[s=h];break}c+=u.width}if(-1!==s)return{type:F,element:_,index:h};if(c=(o=e.getAllSheetsBounds()).x,a=i.options.allSheetsListVisible,r=!0,e.nm()&&(r=!1),a!==S.AllSheetsListVisibility.hide&&c<=t&&t<c+o.width&&r)return{type:L,element:E,position:c,index:-1};if(c=(a=e.getPreMoreTabBounds()).x,o=0,-1!==(d=e.Vm(e.om))){if(c<=t&&t<c+a.width)return{type:F,element:_=l[5],index:5,position:c};o=e.Fv}if(v=e.getSheetTabBounds(),m=i.qv(),g=e.$v,p=e._v,b=0,c=v.x+o,-1<e.om)for(h=e.om;h<m.length&&h<g.length;h++)if(m[h].visible()===S.SheetTabVisible.visible){if(b=g[h],c<t&&t<c+b+p&&(0<v.moreTabPos&&t<v.moreTabPos||0===v.moreTabPos))return{type:L,element:D,index:h,position:c};c+=b+p}if(c>v.moreTabPos&&0<v.moreTabPos&&(c=v.moreTabPos),-1!==e.Ym(e.Zm())){if(c<t&&t<c+v.secondMoreTabWidth)return{type:F,element:_=l[6],index:6,position:c}}else if(c<t&&t<c+v.secondMoreTabWidth)return{element:O,position:c};return c+=v.secondMoreTabWidth,i.options.newTabVisible&&c<t&&t<c+e.Jv()?{type:L,element:j,position:c,index:-1}:{element:O}},l.prototype.Eg=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,c,h,d,v,m,g,c,d,e=this,i=e.Vv,o=e.getNavButtonBounds(),a=-1,u=o.x,s=o.y,c=o.startIndex,f=o.endIndex,l=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],r=c;r<f;r++){if(u<t&&t<u+o.width&&s<n&&n<s+o.height){_=l[a=r];break}u+=o.width}if(-1!==a)return{type:F,element:_,index:r};if(c=e.Jv(),h=i.options.allSheetsListVisible,d=e.cm(),v=!0,e.nm()&&(d=0,v=!1),s=w(c,d),m=i.qv(),g=e.M2e,-1<e.om)for(r=e.om;r<m.length&&r<g.length;r++)if(m[r].visible()===S.SheetTabVisible.visible){if(s<n&&n<s+g[r])return{type:L,element:D,index:r,position:s};s+=g[r]}return c=e.getNewTabBounds(),i.options.newTabVisible&&c.x<t&&t<c.x+c.width&&c.y<n&&n<c.y+c.height?{type:L,element:j,position:s,index:-1}:(d=e.getAllSheetsBounds(),h!==S.AllSheetsListVisibility.hide&&d.x<t&&t<d.x+d.width&&d.y<n&&n<d.y+d.height&&v?{type:L,element:E,position:s,index:-1}:s<n&&n<s+o.y?-1!==e.Ym(e.Zm())?{type:F,element:_=l[6],index:6,position:s}:{element:O,position:s}:{element:O})},l.prototype.hitTest=function(t,n){var e,i,e,e=this,i,e=e.im()?e._g(t,n):e.Eg(t,n);return e},l.prototype.gg=function(t){var n,e,e,i,r,i,o,o,r,n=this,e={e:t,r:A};return l.et(n,"preProcessMouseDown",e),p(e=e.r)?(i=(0,M.GC$)(n.Dg()).offset(),r=t.pageX-i.left,i=t.pageY-i.top,o=n.Vv.jg(),n.Og&&n.Rg(o,!1),r=(o=n.hitTest(r,i)).element,0===t.button&&(r===k?(n.Bg=!0,n.Lg=t.pageX,n.Fg()):r===_?n.Pg(o.index):r===D?(n.Gg(o.index,o.position,t),n.Ug(t,o)):r===j?n.Hg(o.position):r===E&&n.zg(t),n.Vg()),!(n.Yg=!0)):e},l.prototype.Vg=function(){var t,n,t,n=this.Vv.jg();n&&!n.isEditing()&&n.Zg()},l.prototype.zg=function(t){var n,e,n,e;return this.Vv.commandManager().execute({cmd:"showAllSheetsDialog",mouseEvent:t})},l.prototype.pg=function(t){var n,e,i,r,r,r,o,a,u,s,i,i,s,c,s,i,e,t,s,i,n=this,e=n.Vv,i=(0,C.jf)(e),r={e:t,r:A};if(l.et(n,"preProcessMouseMove",r),!p(r=r.r))return r;if(r=n.fg.style,o="default",a="w-resize",n.Wg&&!n.Qg&&10<(u=Math.sqrt(f(n.Wg.x-t.pageX,2)+f(n.Wg.y-t.pageY,2)))&&(n.Qg=!0),n.Bg)r.cursor=a,s=t.pageX-n.Lg,i=i.getHDockScrollbarWidth(),i=n.Vv.Kg.clientWidth-i,e.options.tabStripRatio=e.Jg()+s/i,s=n.rm()/i,c=1,e.Jg()<s?(e.options.tabStripRatio=s,n.Lg=n.rm()):1<=e.Jg()?(e.options.tabStripRatio=1,n.Lg=i):n.Lg=t.pageX,e.Xg();else if(n.Qg)n.qg(t.pageX,t.pageY),n.$g(t);else{if(n.Nm=-1,n.Tm=-1,s=(0,M.GC$)(n.Dg()).offset(),i=t.pageX-s.left,e=t.pageY-s.top,s=(t=n.hitTest(i,e)).element,n.Vv&&n.Vv.options.enableAccessibility&&(i=n.t2(t),n.Vv.n2(i)),""===s)return r.cursor=o,n.repaint(),!1;s===k?r.cursor=a:(r.cursor=o,s===_?n.Nm=t.index:s===D?n.Tm=t.index:s===j?n.Tm=-2:s===E&&(n.Tm=-3)),n.repaint()}return!1},l.prototype.t2=function(t){var n,e,i,r,t,n=tt(),e="",i=t.element;return i===k?e=n.ARIA_Resize:i===_?e=(r={first:n.ARIA_First,prevArrow:n.ARIA_PreviousArrow,nextArrow:n.ARIA_NextArrow,last:n.ARIA_Last,prevButton:n.ARIA_PreviousButton,nextButton:n.ARIA_NextButton})[_]||"":i===D?(t=this.Vv.e2(t.index).name(),e=n.ARIA_SheetTab+" "+t.replace(/([0-9]+)/," $1 ")):i===j?e=n.ARIA_NewSheet:i===O&&(e=n.ARIA_Blank),e},l.prototype.bg=function(t){var n,t,t,n=this,t={e:t,r:A};return l.et(n,"preProcessMouseUp",t),p(t=t.r)?(n.Bg&&(n.Bg=!1,n.Vv.Xg()),n.i2(),n.Qg&&(n.Qg=!1,n.r2.remove(),n.o2(),n.dg.hide()),n.Wg=A,n.a2(),n.u2(),!n.Yg||(n.Yg=!1)):t},l.prototype.yg=function(t){var n,t,t,e,i,n=this,t={e:t,r:A};return l.et(n,"preProcessMouseOut",t),p(t=t.r)?(n.a2(),e=n.Nm,n.Nm=-1,i=n.Tm,n.Tm=-1,n.Nm===e&&n.Tm===i||n.repaint(),!1):t},l.prototype.Fg=function(){var n=this;n.s2||((0,M.GC$)(a).bind(Y,function(t){n.pg(t)}).bind(Z,function(t){n.bg(t)}),n.c2(!0),n.s2=!0)},l.prototype.c2=function(t){var n,e,n,e=this.Vv.getActiveSheet();e&&(e.f2=t)},l.prototype.u2=function(){var t;this.s2&&((this.s2=!1,M.GC$)(a).unbind(Y).unbind(Z),t=this.Vv.getActiveSheet())&&delete t.f2},l.prototype.Pg=function(t,n){var e,i,r,e=this;e.a2(),(i=e.Zm()).length<=0||(r=200,0===(t%=4)?e.l2(i):1===t?(n||(e.h2=b.setTimeout(function(){e.Pg(1)},200)),e.xg(i)):2===t?(n||(e.h2=b.setTimeout(function(){e.Pg(2)},200)),e.Ng(i)):3===t&&e.d2(i))},l.prototype.Gg=function(t,n,e){var i,r,o,r,o,i=this,r=i.Vv,o=r.v2,r=r.e2(t),o=o&&o.sheetsState;o&&0===o[r.name()]?(i.ug!==A&&clearTimeout(i.ug),i.ug=window.setTimeout(function(){i.m2(t,n,e),i.c2(!0),i.ug=A,i.Vg()})):i.m2(t,n,e)},l.prototype.m2=function(t,n,e){var i,r,n,o,n,i=this,r=i.Vv;i.hm=t,i.lm=n,r.suspendPaint(),n=r.getActiveSheet(),(o=r.e2(t))&&o.isEditing()&&o!==n&&(n=n&&n.il&&n.il.rl,!o.ol(void 0,void 0,n,void 0,!1))||(et(r,o,t),i.g2(t,e),r.resumePaint(),i.repaint())},l.prototype.p2=function(t,n,e,i,r,o){var e={oldValue:e,newValue:i,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:o,sheetPosition:t.getSheetPosition(r)};t.ki(C.Events.SheetChanging,e),e.cancel||(n.b2(i),t&&t.w2&&t.w2.repaint(),delete e.cancel,t.ki(C.Events.SheetChanged,e))},l.prototype.Hg=function(t){var n,e,i,r,r,o,a,r,u,n=this,e=n.Vv,i=n.im(),r=e.getActiveSheet();if((!n.C2||n.C2(r))&&(et(e,A,A),r=e.qv(),o=e.getSheetCount(),a=e.S2(e.T2(o)),r.forEach(function(t){t.b2(!1,!0)}),u={sheetName:r=a.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:o,sheetPosition:e.getSheetPosition(r)},n.p2(e,a,!1,!0,r,o),e.ki(C.Events.SheetChanging,u),!u.cancel)){for(e.A2(o,1,a),e.ki(C.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:o,sheetPosition:e.getSheetPosition(a.name())}),n.hm=o,n.lm=t,e.I2(e.qv().length-1,1,!1,!0);n.hm>n.om&&(n.fm()||n.om<n.N2(-1));)n.k2(n.om)&&(n.lm-=(i?n.$v:n.M2e)[n.om]),n.om++;n.repaint()}},l.prototype.g2=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,n,c,d,a,n,c,e=this,i=e.Vv,r=i.qv(),o=e.im(),a=i.getActiveSheet();e.D2&&!e.D2(a)||(u=!1,a&&a.il&&a.il.rl&&(u=!0),(s=!!n)&&(c=(l=C.mt.Qf())?n.metaKey:n.ctrlKey,f=n.shiftKey),t!==i.ep()?(c?(h=r[t]).b2()?h.b2(!1,!0):(h.b2(!0,!0),a&&!a.b2()&&a.b2(!0,!0)):f?(c=(n=i.jg())?i.getSheetPosition(n.name()):-1,d=r.slice(y(c,t),w(c,t)+1),r.forEach(function(t){t.visible()===S.SheetTabVisible.visible&&(-1!==d.indexOf(t)?t.b2()||t.b2(!0,!0):t.b2()&&t.b2(!1,!0))})):(a=r.every(function(t){return t.visible()!==S.SheetTabVisible.visible||t.b2()}),r[t].b2()&&!a||r.forEach(function(t){t.b2(!1,!0)}),(h=r[t]).b2()||h.b2(!0,!0),i.I2(t,1,u,!0)),n=e.N2(e.om),c=!1,c=o?e.lm+e.$v[e.hm]>e.dm():e.lm+e.M2e[e.hm]>=e.dm(),e.hm>e.om&&c&&-1!==n&&(e.om=n)):f&&r.forEach(function(t){var n,e,n=t.name(),e;i.getSheetPosition(n)!==i.ep()&&t.b2()&&t.visible()===S.SheetTabVisible.visible&&t.b2(!1,!0)}),e.hm<e.om&&(e.om=e.Vm(e.om)))},l.prototype.E2=function(t,n){var e,i,r,o,a,t,n,u,t,n,t,i,s,c,f,l,h,d,v,m,g,p,b,g,w,r,y,b,e=this,i=e.Vv,r=e.im(),o=i.options.tabStripPosition,a=U(C.I.fl("").zIndex),t=e.hitTest(t,n);if(t.element===D){if(n=e.hm,u=i.e2(n),t.index!==n)return;if(i.ki(C.Events.SheetTabDoubleClick,{sheet:u,sheetName:u.name(),sheetTabIndex:n}),!i.options.tabEditable)return!1;if((t=C.hi.ai())&&t.endEdit&&!t.endEdit())return;C.hi.F1(A),n=(0,M.GC$)(e.Dg()).offset(),t=i.j2(),i=(0,M.GC$)(t).offset(),s=(0,M.GC$)(t).width(),f=(c=T("input")).style,c.type="text",c.value=u.name(),c.setAttribute("contentEditable","true"),c.setAttribute("autocomplete","off"),f.position="absolute",f.margin="0px",f.padding="0px",v=d=h=l=void 0,m=u.name(),p=(g=e.nCe[m].composedStyle).font,b=g.leftIcons,g=g.foreColor,w=e.Mt(this.Dg().getContext(N),m,p),r?((r=0)<b.length&&(r=(y=b.reduce(function(t,n){var t;return null!==(t=t+n.width)?t:e.T2e.defaultSize},0)+(b.length-1)*e.T2e.iconSpace)+e.T2e.iconTextSpace),v=w+2,d=n.top-i.top+e.vm()-e.ig-1,l=n.left-i.left+e.lm+e.kv+r,f.height="20px"):(b=e.ot(),v=w+2,d=n.top-i.top+e.lm+e.vm()-e.ig-1,l=n.left-i.left+b.x+e.Om+e.Rm,o===S.TabStripPosition.left&&2007===a&&(l+=e.Om),o===S.TabStripPosition.right&&s<l+v&&(h=n.left+b.width-s+e.Om+e.Rm),f.height=(0,C.getFontHeightWithCanvas)(p,m)+I),h?f.right=h+I:l&&(f.left=l+I),f.top=d+I,f.width=v+I,f.backgroundColor=R,f.borderWidth="0px",f.outline=x,f.zIndex="1",f.font=p,f.color=g,(0,M.GC$)(c).appendTo(t),e.Og=c,(0,M.GC$)(c).addClass("gc-sheetTabEditor").bind(W,function(t){return 13===t.keyCode?(e.Rg(u,!1),!1):27===t.keyCode?(e.Rg(u,!0),!1):void 0}).bind(Q,function(){c.selectionStart=0,c.selectionEnd=c.value.length}).bind(J,function(){e.Rg(u,!1)}),c.focus()}return!1},l.prototype.wg=function(t){var n,e,e,i,r,t,n=this,e={e:t,r:A};return l.et(n,"preProcessMouseDbClick",e),p(e=e.r)?(i=(0,M.GC$)(n.Dg()).offset(),r=t.pageX-i.left,t=t.pageY-i.top,n.E2(r,t)):e},l.prototype.Mg=function(t){var n,e,i,e,i,n=this,e=n.im(),i=!p(n.Og);return e||i||(p(t.wheelDelta)&&p(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail||t.wheelDelta,i=n.Zm(),0<e?n.xg(i):n.Ng(i)),!1},l.prototype.Rg=function(t,n){var e,i,r,n,o,e=this,i=e.Og;i&&((0,M.GC$)(i).unbind(W).unbind(Q).unbind(J),r=i.value,!1===n&&r!==(n=t.name())&&(o={message:""},B(r,e.Vv.qv(),t,o)&&!p(r)&&""!==r?t.getParent().commandManager().execute({cmd:"renameSheet",sheetName:n,name:r}):t.ki(C.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:o.message})),i.parentNode.removeChild(i),delete e.Og)},l.prototype.O2=function(){return this.Vv.options.allowSheetReorder},l.prototype.Ug=function(t,n){var e=this;e.O2()?(e.og=n.index,e.r2=e.R2(e.og),e.Wg=new C.Point(t.pageX,t.pageY),e.Fg()):e.Qg=!1},l.prototype.R2=function(t){var n,e,e,n,n=this.Vv.qv(),e=n.length;if(!(e<=t||t<0))return e=(e=n[t].name())||"sheet",(n=(0,M.GC$)(T("span")).text(e).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),n},l.prototype.a2=function(){var t=this.h2;t&&(clearTimeout(t),this.h2=A)},l.prototype.qg=function(t,n){var e,i,r,o,e,i=this.r2;i&&0===(0,M.GC$)(".gc-tab-tip-span").length&&(i.appendTo(a.body),i.hide()),r=i.width(),o=i.height(),i.css({left:t-r/2,top:n-o/2}),i.show()},l.prototype.$g=function(t){var n,e,i,r,i,o,t,i,a,u,s,c,f,l,e,h,d,o,t,v,m,e,t,o,n=this,e=n.Vv,i=(0,M.GC$)(n.Dg()),r=i.position(),i=i.offset(),o=t.pageX-i.left,t=t.pageY-i.top,i=n.hitTest(o,t),a=i.element,u=n.ot(),s=n.tm(),c=n.Vv.qv().length,f=100,l=e.options.tabStripPosition,e=n.im(),h=n.Jv(),d=n.dg,o=e?o:t,t=e?u.x+n.dm():u.y+n.dm()+h;t<o?n.ag===A&&n.rg<c&&(n.ag=b.setInterval(function(){n.Ng(n.Zm()),n.rg===c?(n.i2(),l===S.TabStripPosition.bottom?(v=r.left+n.B2()-3.5,m=r.top-3.5):l===S.TabStripPosition.top?(v=r.left+n.B2()-3.5,m=r.top+u.height):l===S.TabStripPosition.left?(v=r.left+u.width,m=r.top+n.B2()-3.5):l===S.TabStripPosition.right&&(v=r.left-3.5,m=r.top+n.B2()-3.5),d.show()):(n.rg++,d.hide()),d.css({left:v,top:m})},100)):o<s?n.ag===A&&0<n.rg&&(n.ag=b.setInterval(function(){n.xg(n.Zm()),0===n.rg?(n.i2(),l===S.TabStripPosition.bottom?(v=r.left+s-3.5,m=r.top-3.5):l===S.TabStripPosition.top?(v=r.left+s-3.5,m=r.top+u.height):l===S.TabStripPosition.left?(v=r.left+u.width,m=r.top+h-3.5):l===S.TabStripPosition.right&&(v=r.left-7,m=r.top+h-3.5),d.show()):(n.rg--,d.hide()),d.css({left:v,top:m})},100)):(n.i2(),a!==D&&-1===n.mm().indexOf(a)||(e=i.index,a===O&&(e=n.rg),t=e=a===D&&!p(e)?e:c,o=i.position,n.rg=t,l===S.TabStripPosition.bottom?(v=r.left+o-3.5,m=r.top-7):l===S.TabStripPosition.top?(v=r.left+o-3.5,m=r.top+u.height):l===S.TabStripPosition.left?(v=r.left+u.width,m=r.top+o-3.5):l===S.TabStripPosition.right&&(v=r.left-7,m=r.top+o-3.5),d.css({left:v,top:m}),d.show()))},l.prototype.B2=function(){for(var t,n,e,i,r,o,a,u,s,c,t=this,n=t.im(),e=t.$v,i=t.Zm(),r=t.L2(t.om,i),o=0,a=t.tm(),u=t.M2e,s=n?a+t.Fv:a,c=r;c<i.length;c++)o=i[c],n?s=(s+=e[o])+t._v:s+=u[o];return s},l.prototype.i2=function(){var t=this.ag;t&&(clearInterval(t),this.ag=A)},l.prototype.o2=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Vv,e=t.rg,i=t.og,r=n.qv();if(n.suspendPaint(),this.F2(r)){for(o=[],a=0;a<r.length;a++)r[a].b2()&&(r[a].b2(!1),o.push(r[a]));for(a=o.length-1;0<=a&&!(n.getSheetPosition(o[a].name())<=e);a--)n.commandManager().execute({cmd:"moveSheet",sheetName:o[a].name(),targetIndex:e});for(e-=1,a=0;a<o.length&&!(n.getSheetPosition(o[a].name())>e);a++)n.commandManager().execute({cmd:"moveSheet",sheetName:o[a].name(),targetIndex:e})}else u=n.e2(i),-1!==e&&-1!==i&&i!==e&&i!==e-1&&t.dg.isVisible()&&(i<e-1&&(e-=1),n.commandManager().execute({cmd:"moveSheet",sheetName:u.name(),targetIndex:e}));n.resumePaint()},l.prototype.F2=function(t){for(var n,e,n=[],e=0;e<t.length;e++)if(t[e].b2()&&(n.push(t[e]),1<n.length))return!0;return!1},l.prototype.scrollTabToActive=function(t,n){var e,i,r,o,a,e=this,i=e.Vv,r=e.Zm(),o;n===i.getSheetCount()+i.getSheetTabCount()-1?(e.d2(r),e.Cg()):0===n?(e.l2(r),e.Cg()):(a=e.U2(t,n))&&(t<n&&n++,e.Tg(n))},l.prototype.U2=function(t,n){for(var e,i,r,o,a,e=this,i=e.Ig().tabsInfo,r=!1,o=!1,a=0;a<i.length-2;a++)if(t===i[a].index&&(r=!0),n===i[a].index&&(o=!0),r&&o)return e.Cg(),!1;return!0},l.prototype.Zm=function(){for(var t,n,e,t=[],e=this.Vv.qv(),n=0;n<e.length;n++)this.k2(n)&&t.push(n);return t},l.prototype.l2=function(t){0<t.length&&this.om!==t[0]&&this.Vv.startSheetIndex(t[0])},l.prototype.xg=function(t){var n,t;0<t.length&&(n=this).om>t[0]&&-1!==(t=n.Vm(n.om))&&n.Vv.startSheetIndex(t)},l.prototype.Ng=function(t){var n,e;0<t.length&&(n=this).om<t[t.length-1]&&-1!==(e=n.Ym(t))&&n.Vv.startSheetIndex(n.N2(n.om))},l.prototype.d2=function(t){var t;0<t.length&&this.om<t[t.length-1]&&-1!==(t=this.Ym(t))&&this.Vv.startSheetIndex(t)},l.prototype.Ym=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,h;if(0<t.length)for(e=(n=this).im(),i=n.M2e,r=n.dm(),a=n.$v,s=u=void(o=0),c=n.gm(),-1===(f=n.L2(n.om,t))&&(f=0),u=t.length-1;f<=u;u--)if(o+=l=(e?a:i)[s=t[u]],u!==t.length-1&&(o+=e?n._v:0),h=c+o,0!==u&&(h+=e?n.Fv:i[s]),r<h)return h=void 0,h=u+1<t.length?t[u+1]:t[t.length-1],n.om<h?h:-1;return-1},l.prototype.Vm=function(t){for(var n,n=t-1;0<=n;n--)if(this.k2(n))return n;return-1},l.prototype.N2=function(t){for(var n,e,n=this.Vv.qv().length,e=t+1;e<n;e++)if(this.k2(e))return e;return-1},l.prototype.L2=function(t,n){for(var e,e=0;e<=n.length-1;e++)if(t===n[e])return e;return-1},l.prototype.k2=function(t){var t=this.Vv.e2(t);return!(!t||t.visible()!==S.SheetTabVisible.visible)},l.prototype.H2=function(){var e,t,n,i,r,o,a,e=this,t=e.Vm(e.om),n=e.Zm().reduce(function(t,n){return t+e.M2e[n]},0),i=e.Lv,r=e.Yv()/2,o,a;return e.ot().height<n+i+r||-1!==t},l.prototype.z2=function(){var t,n,t,t=this,n=t.Vm(t.om),t=t.Ym(t.Zm());return-1!==n||-1!==t},l.prototype.nm=function(){var t,n,e,i,t=this,n,e=t.Vv.options.allSheetsListVisible,i;if(t.im()){if(!t.z2()&&e===S.AllSheetsListVisibility.auto)return!0}else if(!t.H2()&&e===S.AllSheetsListVisibility.auto)return!0},l.prototype.V2=function(){this.sg++},l.prototype.Y2=function(){var t=this;t.sg--,t.sg<=0&&(t.sg=0,t.repaint())},l.prototype.repaint=function(t){var n=this.Dg();n&&n.getContext&&this._e(n.getContext(N),t)},l.prototype._e=function(t,n){var e,i,r,o,o,a,u,s,c,f,l,h,d,v,e=this;if(!(0<e.sg)){if(i=e.ot(),r=e.fg,n){if(n.x>=i.x+i.width)return;if(n.y>=i.y+i.height)return;if(n.x+n.width>i.width&&(n.width=i.width-n.x,n.width<=0))return;if(n.y+n.height>i.height&&(n.height=i.height-n.y,n.height<=0))return;if(n.width<=0||n.height<=0)return}if((o=e.buffer)&&o.width===r.width&&o.height===r.height&&(o||o.width===i.width&&o.height===i.height)||(o&&C.Bf.nh(e.Vv,o),e.buffer=o=T(K),C.Bf.Wl(o,e.Vv),C.Bf.$l(o,i.width,i.height)),!(i.width<=0||i.height<=0||n&&(n.width<=0||n.height<=0))){(o=e.buffer.getContext(N)).clearRect(0,0,i.width,i.height),C.Lf.Yl(o,-i.x,-i.y),e.Z2(o,n),C.Lf.Yl(o,i.x,i.y),s=a=0<=i.x?0:-i.x,c=u=0<=i.y?0:-i.y,n&&(s=i.x+n.x,c=i.y+n.y,i=new C.Rect(s,c,n.width,n.height)),a=0<=i.x?i.x:0,u=0<=i.y?i.y:0,h=A,d=C.Bf.Kl(r),v=C.Bf.Jl(r),r&&1!==d&&(s*=d,c*=v,i.x*=d,i.y*=v,i.width*=d,i.height*=v);try{l=r?n?(f=w(i.width-s,0),w(i.height-c,0)):(f=y(i.width-s,w(r.width-i.x,3)),y(i.height-c,w(r.height-i.y,3))):(s=n.x,c=n.y,f=n.width,n.height),r?(C.Lf.Vl(t,1,1),t.clearRect(a,u,f,l),t.drawImage(e.buffer,s,c,f,l,a,u,f,l),C.Lf.Vl(t,d,v)):h=(o=e.buffer.getContext(N)).getImageData(s,c,f,l)}catch(t){return}!r&&h&&0<i.width&&0<i.height&&t.putImageData(h,a,u)}}},l.prototype.W2=function(t,n){var e,i,e,i=this.ot();n?t.rect(n.x,n.y,n.width,n.height):t.rect(i.x,i.y,i.width,i.height),t.clip()},l.prototype.P2e=function(t){var n,e,n,e=this.BO();t&&t.forEach(function(t){var t=t.src;t&&!e.getImage(t)&&e.addImage(t,"anonymous")})},l.prototype.G2e=function(u,s){var c,t,f,n,l,h,d,v,e,c=this,t=c.Vv,f=c.im(),n=c.T2e,l=n.iconSpace,h=n.iconTextSpace,d=n.defaultSize;u.save(),c.$v=[],c.M2e=[],v=u.font,(e=t.qv()).forEach(function(t){var n,e,i,n,t,n,e,i,n,r,e,o,i,n,o,a,e,n=null==(n=s[t.name()])?void 0:n.composedStyle,e=null!=(e=null==n?void 0:n.font)?e:v,i=null!=(i=null==n?void 0:n.leftIcons)?i:[],n=null!=(n=null==n?void 0:n.rightIcons)?n:[],r=m(m([],i,!0),n,!0);u.font=g.W.ii(e,"bold"),e=c.Dv+c.kv,(o=0)<r.length&&(c.P2e(r),o=r.reduce(function(t,n){var t;return t+(null!=(t=n.width)?t:d)},0),e=(e=(e+=l*(r.length-1))+(0<i.length?h:0))+(0<n.length?h:0)),i=Math.round(u.measureText(t.name()).width)+o+e,c.$v.push(i),f||(n=P(u.font),o=null!=(t=null==r?void 0:r.reduce(function(t,n){var t;return Math.max(t,null!=(t=n.height)?t:d)},0))?t:0,e=(a=Math.max(n,o))+2*c.ig,c.M2e.push(e))}),u.restore()},l.prototype.Ig=function(t,n){var e,i,r,o,a,u,s,s,c,f,l,s,h,d,e=this,i,r=e.Vv.qv(),o=e.im(),a=e.ot(),u=[];for(n&&o&&(s=e.aTe().width,a.width=s),s=n?0:e.tm(),!n&&e.nm()&&o&&(s-=e.em()),c=s,s=n?e.N2(-1):e.om,o&&0<s&&0<=e.Vm(s)&&(c+=e.Fv),h=s=s<0?e.om=0:s;h<r.length;h++){if(d=r[h].visible(),f=e.$v[h],l=e.M2e[h],o){if(c>a.x+a.width)break}else if(c>a.y+a.height)break;u.push({index:h,position:c,width:f,height:l,text:r[h].name(),visible:d,style:t&&t[r[h].name()]}),d===S.SheetTabVisible.visible&&(c+=o?f+e._v:l)}return{tabsInfo:u,newTabStartPosition:c}},l.prototype.U2e=function(t){var n,e,i,n,e=S.VisualState.normal,i;return 2007<this.Vv.SC?(t&S.SheetTabState.hover&&(e=S.VisualState.hover),t&S.SheetTabState.selected&&(e=S.VisualState.selected),t&S.SheetTabState.active&&(e=S.VisualState.active),t&S.SheetTabState.active&&!(t&S.SheetTabState.selected)&&(e=S.VisualState.activeNotSelected)):(t&S.SheetTabState.selected||t&S.SheetTabState.hover)&&(e=S.VisualState.hover),e},l.prototype.H2e=function(n,e){var i;return n&&0!==Object.keys(n).length?(i={},Object.keys(e.composedStyle).forEach(function(t){void 0===n[t]||0===n[t].length?i[t]=e.composedStyle[t]:i[t]=n[t]}),{composedStyle:i,borderLeftColor:e.borderLeftColor,borderBottomColor:e.borderBottomColor}):e},l.prototype.D2e=function(t,n,e,i){var r,o,o,o,a,i,u,s,c,r=this,o=this.Vv.sheetTabStyles.C2e(e),o=r.U2e(o),o=C.I.He(o,"gc-tab-"+C.I.Ee(o)),a=C.I.He(S.VisualState.normal,"gc-tab-"+C.I.Ee(S.VisualState.normal)),i=r.V2e(t,i,2007<this.Vv.SC?a:o,n),u,s,c;return{composedStyle:{backColor:i,foreColor:r.Um(o.color,"string"==typeof i?i:void 0),font:r.z2e(t,e),leftIcons:[],rightIcons:[]},borderLeftColor:null==a?void 0:a.borderLeftColor,borderBottomColor:o.borderBottomColor}},l.prototype.Y2e=function(t,n,e,i,r){var o,o,a,u,s,c,c,c,o,t;if(r&&0!==Object.keys(r).length)return u={},s=(a=this).Vv.e2(i),c=this.Vv.sheetTabStyles.C2e(e),c=a.U2e(c),c=C.I.He(c,"gc-tab-"+C.I.Ee(c)),r.icons&&(u.leftIcons=null==(o=null==r?void 0:r.icons)?void 0:o.filter(function(t){return!t.position}),u.rightIcons=null==(o=null==r?void 0:r.icons)?void 0:o.filter(function(t){return t.position===S.IconPosition.right})),r.backColor&&(o=C.Pf.vl(s,r.backColor),u.backColor=a.zm(t,e,i,n,o)),r.foreColor?u.foreColor=C.Pf.vl(s,r.foreColor):r.backColor&&(t="string"==typeof u.backColor?C.Pf.vl(s,u.backColor):void 0,u.foreColor=a.Um(c.color,t)),r.font&&(u.font=r.font),u},l.prototype.Z2e=function(i,r){var o,a,t,u,o=this,a=o.Vv,t=a.qv(),u={};return t.forEach(function(t){var t,n,e,e,n,e,t=t.name(),n=a.getSheetPosition(t),e=a.sheetTabStyles.E2e(t),e=o.Y2e(i,r,t,n,e),n=o.D2e(i,r,t,n),e=o.H2e(e,n);u[t]=e}),u},l.prototype.W2e=function(o,a,u){var s,t,c,f,n,l,h,s=this,c=this,f=c.Vv,n=f.qv(),l=c.im(),h=null!=(t=f.SC)?t:0;return n.forEach(function(t,n){var n,n,e,i,t,t,t,r,n,r,t,i,e=t.name(),i=f.getSheetPosition(e),t=s.Vv.sheetTabStyles.C2e(t.name()),t=c.U2e(t),t=C.I.He(t,"gc-tab-"+C.I.Ee(t)),r=C.I.He(S.VisualState.normal,"gc-tab-"+C.I.Ee(S.VisualState.normal)),n=!l&&null!=(n=null==(n=u[n])?void 0:n.position)?n:0,r=c.V2e(o,i,2007<h?r:t,n),t=c.Vv.sheetTabStyles.E2e(e),i=c.zm(o,e,i,n,null==t?void 0:t.backColor);a[e].composedStyle.backColor=null!=i?i:r}),a},l.prototype.aTe=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n,e=t.Vv.qv(),i=t.im(),r=0,o=0,a=t.N2(-1);for(a<0&&(t.om=0),i&&0<a&&0<=t.Vm(a)&&(r+=t.Fv),u=a;u<e.length;u++)s=e[u].visible(),c=t.$v[u],f=t.M2e[u],s===S.SheetTabVisible.visible&&(i?r+=c+t._v:o+=f);return{width:r,height:o}},l.prototype.Z2=function(t,n,e){var i,r,o,a,u,r,s,n,i=this,r=i.Vv,o=r.options.scrollbarAppearance===S.ScrollbarAppearance.mobile,a=r.options.tabStripPosition,u=r.options.showHorizontalScrollbar;t&&r&&(r=i.ot(),s=i.Z2e(t,r.y),t.save(),e||i.W2(t,n),t.beginPath(),i.G2e(t,s),n=i.Ig(void 0,e),s=i.W2e(t,s,n.tabsInfo),i.wm(t,r),e||(i.Mm(t,r,n.newTabStartPosition,s),i.Dm(t,r)),n=i.Ig(s,e),i.nCe=s,i.J2(t,r,n.tabsInfo,e),e||(i.Vv&&i.Vv.options.tabNavigationVisible&&i.Im(t,r),u&&!o&&a===S.TabStripPosition.bottom&&i.Em(t,r)),t.beginPath(),t.restore())},l.prototype.wm=function(t,n){},l.prototype.Mm=function(t,n,e,i){},l.prototype.X2=function(t,n){var e,i,r,i,i,e=this,i=e.im(),r=e.tm();e.nm()&&(r-=e.em()),i?(i=n.x+e.dm(),t.rect(r,0,i-r,n.height)):(i=e.Yv(),t.rect(0,r,n.width,n.height-r-i)),t.clip()},l.prototype.np=function(t,n){var e,i,r,o,e=this,i=e.om,r=e.im(),o=e.tm();0<i&&0<=e.Vm(i)&&r&&e.Am(t,n,i,o)},l.prototype.Q2e=function(t,n,e){var i,r,i=this,r;i.im()?i.Hm(t,e.position,0,e.width,n.height,e.text,e.style):i.Hm(t,0,e.position,n.width,e.height,e.text,e.style)},l.prototype.J2=function(t,n,e,i){var r,o,a,u,s,r=this,o=r.Vv;if(r.hm=o.ep(),0<e.length){for(t.save(),t.beginPath(),i||r.X2(t,n),a=void 0,u=e.length-1;-1<u;u--)(s=e[u]).index===r.hm?a=s:s.visible===S.SheetTabVisible.visible&&r.Q2e(t,n,s);a&&a.visible===S.SheetTabVisible.visible&&r.Q2e(t,n,a),t.restore(),t.save(),t.beginPath(),i||r.np(t,n),t.restore()}},l.prototype.Am=function(t,n,e,i){},l.prototype.Im=function(t,n){},l.prototype.Dm=function(t,n){},l.prototype.Em=function(t,n){},l.prototype.km=function(t,n,e,i,r,o,a,u,s,c){},l.prototype.Hm=function(t,n,e,i,r,o,a){},l.prototype.Dg=function(){return this.fg},l.prototype.ip=function(t,n){var e,t,n,t,i,r,o,a,e=t.createLinearGradient(n.x,n.y,n.width,n.height),t=C.I.He(S.VisualState.normal,"gc-tabStripBackground"),n=t&&t.backgroundImage,t=t&&t.backgroundColor;if(n&&-1!==n.indexOf("linear-gradient"))for(r=0,o=(i=v(n)).length;r<o;r++)a=i[r],e.addColorStop(a.point,a.color);else t&&(e.addColorStop(0,"#DDDDDD"),e.addColorStop(1,t));return e},l.prototype.K2e=function(t){var n,e,n=this,e=n.Vv.Gm(t);return e=""===t&&0<n.om?n.Vv.e2(n.om-1):e},l.prototype.zm=function(t,n,e,i,r){var i,o,a,u,s,n,c,f,n,e,s,l,h,i,a;if(r)return a=(o=this).ot(),u=o.K2e(n),s=o.im(),c=(n=o.Vv.sheetTabStyles.C2e(n))&S.SheetTabState.active,f=n&S.SheetTabState.selected,n=n&S.SheetTabState.hover,e=s?t.createLinearGradient(a.x+.7*a.height,a.y+0,.7*a.height,a.height):(s=a.y,(l=0)<=i&&(s=i,l=null!=(i=o.M2e[e])?i:0),t.createLinearGradient(a.x+.7*l,s,.7*l,s+l)),t.fillStyle=h="rgba(0, 0, 0, 0)",i=t.fillStyle,t.fillStyle=C.Pf.vl(u,r),(a=t.fillStyle)!==i&&((2007<o.Vv.SC?c:f||n)?(e.addColorStop(0,R),e.addColorStop(.45,"#F1F6FD"),e.addColorStop(.9,a),e.addColorStop(1,R)):e=a),e},l.prototype.V2e=function(t,n,e,i){var i,r,o,a,u,s,c,r,n,f,l,h,d,r=this,o=r.ot(),a,u=r.im()?t.createLinearGradient(o.x+.7*o.height,o.y+0,.7*o.height,o.height):(s=o.y,(c=0)<=i&&(s=i,c=null!=(i=r.M2e[n])?i:0),t.createLinearGradient(o.x+.7*c,s,.7*c,s+c));if(e)if(r=e.backgroundImage,n=e.backgroundColor,r&&-1!==r.indexOf("linear-gradient"))for(l=0,h=(f=v(r)).length;l<h;l++)d=f[l],u.addColorStop(d.point,d.color);else n&&u.addColorStop(0,n);return u},l.prototype.Um=function(t,n){var n=n?r._(n):null;return n&&r.rp(n)<127.5?R:t||X},l.prototype.z2e=function(t,n){var e,e,i,n,e,e=this,i,n=e.Vv.sheetTabStyles.C2e(n),e=null!=(e=e._font)?e:t.font;return e=n&S.SheetTabState.selected||n&S.SheetTabState.hover||n&S.SheetTabState.active?g.W.ii(e,"bold"):e},l.prototype.BO=function(){var t=this;return t.MC||(t.MC=new d.Wh(function(){t.MC&&t.repaint()})),t.MC},l.prototype.Mt=function(t,n,e){var i,e,i=t.font;return t.font=null!=e?e:t.font,t.textBaseline="middle",e=t.measureText(n).width,t.font=i,e},t.Hv=e=l,(0,C.$e)(e)},"./dist/core/workbook/workbook-json.js":function(i,t,n){"use strict";var o,K,F,J,Ct,X,q,e,$,tt,St,Tt,nt,r,et,it,rt,P,L,ot,at,At,a,ut,It,h,d,st,ct,xt,Nt,kt,_t,u,s,ft,lt,ht,v,dt,Dt,vt,mt,n,gt,c,pt,bt,f;function B(t,n){return t.hasOwnProperty(n)}function G(t){var t,n,e,n;if(t&&"string"==typeof t){if(3<(n=(t=t.split(".")).length))return 3;if(e=f(t[0]),n<=2)return isNaN(e)?1:e;if(n=f(t[1]),10<=e)return e;if(3<=e){if(20143<=n)return 3;if(20142<=n)return 2}}return 1}function jt(t){var n,e,i,t,r,o,a,u,s,n=this,e=t&&t.frozenColumnsAsRowHeaders,i=t&&t.frozenRowsAsColumnHeaders;if(e||i)for(rt&&(t=n.op()).isAdjustSuspended()&&t.resumeAdjust(),o=(r=n.sheets).length,a=0;a<o;a++)s=(u=r[a]).Ut,i&&bt(s.ap)&&(u.cp=!0,u.deleteRows(0,s.ap)),e&&bt(s.fp)&&u.deleteColumns(0,s.fp)}function U(t,n){var e,i,r,o,a,u,s,c,a,e=this,i=n&&n.frozenColumnsAsRowHeaders,r=n&&n.frozenRowsAsColumnHeaders,o=0,u=t.sheets;if(r||i)for(s in u)"string"==typeof s&&(c=u[s],a=bt(c.index)?c.index:c.lp,a=e.sheets[bt(a)?a:o],r&&bt(c.frozenRowCount)&&(a.cp=!0,a.deleteRows(0,c.frozenRowCount)),i&&bt(c.frozenColCount)&&a.deleteColumns(0,c.frozenColCount),o++)}function H(t,n){t.hp(n,0)}function m(p,b,w){return function(){for(var e,e,g,t,n,i,r,g=b.dataManager(),t=function(t){var n,d,v,m;if(null==(e=t[0])||!e.getParent())return"continue";n=null==(e=t[1])?void 0:e.dataView,(d=g.tables[n&&n.tableName])&&(v=d.views[n.name])&&((m=v).dp=function(){w(t),delete m.dp},v.vp=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,h,t=function(t){if(!t[0].getParent())return"continue";var n=t[1].dataView;(d=g.tables[n&&n.tableName])&&(v=d.views[n.name])&&m!==v&&v.fetch().then(function(){w(t)})},n=0,e=p;n<e.length;n++)t(i=e[n]);for(o in r=g.tables)if(r.hasOwnProperty(o))for(s in u=(a=r[o]).views)u.hasOwnProperty(s)&&delete(c=u[s]).vp;for(f=0,l=p;f<l.length;f++)if((i=l[f])[0].getParent()&&(h=i[1].dataView,d=g.tables[h&&h.tableName])&&(v=d.views[h.name],m===v)){h=i[0],b.suspendPaint(),h.Mf.recalcAll(!0),b.resumePaint();break}})},n=0,i=p;n<i.length;n++)t(r=i[n])}}function Ot(o,a,u,i){var s,t,c,n,f,l,h;if(0<o.length){for(s=a.dataManager(),t=void 0,n=0;n<o.length;n++)if(t=o[n][1]&&o[n][1].dataView){c=n;break}(f=s.tables[t&&t.tableName])&&(l=f.views[t.name])&&(h=function(t){var n=t[0],e=t[1],t=t[2];n.getParent()&&(n.ANi(e,i),t)&&g(a,t,n)},l.fetch().then(function(){var e,t,n,i,r;if(o[c][0].getParent()){for(h(o[c]),e=[],t=function(t){var n=t[1]&&t[1].dataView;n&&(f=s.tables[n.tableName])&&(l=f.views[n.name])&&e.push(l.fetch().then(function(){h(t)}))},n=0,i=o.slice(1);n<i.length;n++)t(r=i[n]);Promise.all(e).then(function(){a.suspendPaint(),u&&a.calculate(1),a.resumePaint()})}}).catch(m(o,a,h)))}}function l(t,n,e){var i,e,e,i=null==n?void 0:n.dataView;return i&&(e=e.tables[i&&i.tableName])&&(e=e.views[i.name])?e.fetch().then(function(){t.ANi(n,!0)}):void 0}function V(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,r=0,o=n.sheetTabs,a=[],u=i&&i.gp,s=t.mp,c=[],f=n.sheetCount,l=0,h=Object.keys(o);l<h.length;l++)(v=o[d=h[l]])&&(m=v.index-f,c.splice(m,0,v));if(s&&s.length&&c){for(g=0,p=c;g<p.length;g++)if("string"==typeof(b=(v=p[g]).name)&&(w=t.mp[r])){if(w.fromJSON(v,!1,e,i,!0),vt(v.order)||(w.E0i=v.order),!u&&(w._gi===nt.SheetType.tableSheet||w._gi===nt.SheetType.ganttSheet||w._gi===mt)){for(y=n.formatStringNames,M=[],C=0;y&&C<y.length;C++)(S=y[C]).sheetTabName===w.name()&&M.push(S);a.push([w,v.addition,M])}r++}Ot(a,t,!(i&&i.doNotRecalculateAfterLoad),!0)}}function g(t,n,e){var i,r;if(n)for(i=0;i<n.length;i++)r=n[i],t.pp(t.bp,r.name,r.formula,r.row,r.col,!0,r.comment,e)}function z(t,n){var e,n,e=t.getActiveSheetTab(),n=n.activeSheetTabIndex;bt(n)?(t.yp(n,0),t.u3(e)):(t.f3(),e&&e.b2(!1,!1))}function Et(t,n,e,i,r){var o;return e===mt&&i===mt&&t===mt&&n===mt?mt:(o="",e!==mt&&(o+="$"+a(e)),t!==mt&&(o+="$"+(t+1)),o+=":",i!==mt&&(o+="$"+a(i)),n!==mt&&(o+="$"+(n+1)),r?(0,$.i2e)(r)+"!"+o:o)}function Y(e,i,r){K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){var n=n[i];n&&n.call.apply(n,o([e],r,!1))})}function Rt(t,n){for(var e,i,r,o,a,u,s,c,f,l,l,l,l,f,e=wt(t),i=[],r=0,o=0,a=0,u=0,s=0,c=0;c<e;c++)(f=yt(t,c))&&(f.wp=c+1,(l=f.tables)&&0<l.all().length&&l.all().forEach(function(t){++r,t._id=r+""}),(l=f.charts)&&0<l.all().length&&l.all().forEach(function(t){++o,t.wp=o}),(l=f.pictures)&&0<l.all().length&&l.all().forEach(function(t){++a,t.wp=a}),(l=f.pivotTables)&&0<l.all().length&&l.all().forEach(function(t){++s,t.Mp=s}),f=h(n),i.push(f),n.c_.push({n_:v,Id:ht+f,Type:q.RelationshipConstants.fo,Target:d("worksheets/"+ft+f)}));return p(n),t.Cp={slicer:0,timeline:0,drawing:0,vmlDrawing:0},i}function p(t){var n=ht+h(t);t.c_.push({n_:v,Id:n,Type:q.RelationshipConstants.Xs,Target:d("sharedStrings")}),n=ht+h(t),t.c_.push({n_:v,Id:n,Type:q.RelationshipConstants.Ks,Target:d("styles")}),n=ht+h(t),t.c_.push({n_:v,Id:n,Type:q.RelationshipConstants.$s,Target:d("theme/theme1")})}function wt(t){return t.getSheetCount()+t.getSheetTabCount()}function yt(t,n){var t=t.e2(n);return t instanceof et.Worksheet?t:t&&t.Mf}function Ft(t,n){for(var e,i,r,o,e=0,i=t.getSheetCount();e<i;e++)if(r=t.getSheet(e),n===(o=t.getSheetPosition(r.name())))return null;for(e=0,i=t.getSheetTabCount();e<i;e++)if(r=t.getSheetTab(e),n===(o=t.getSheetPosition(r.name())))return r}function Lt(t){return t.substring(0,19)===s}function Bt(t){return t.substring(0,23)===u}function Pt(t,n){var e=t;return 255<e.length?e=e.slice(-240):250<(e=n+" "+e).length&&(e=t+" "+Math.random().toString(36).slice(-6)),e}function b(t){for(var n,e,i,n=wt(t),e=0;e<n;e++)if(i=yt(t,e).hl)return i}function Gt(t,n,e,i){var r,o,a,u,e,a=t.themeFont;return"Body"===a?o=e||(u=b(n))&&u.bodyFont():"Headings"===a&&(o=i||(u=b(n))&&u.headerFont()),r=o&&t.font?(e=$.util._0(t.font)).fontWeight+" "+e.fontStyle+" "+e.fontSize+" "+o:t.font||c}function Ut(){return{fileVer:"1.0",proName:"sjs",proVer:$.productInfo.productVersion}}function Ht(){var t=new F.Style;return t.font="14.67px Calibri",t.foreColor="Text 1",t.borderLeft=new F.LineBorder,t.borderRight=new F.LineBorder,t.borderTop=new F.LineBorder,t.borderBottom=new F.LineBorder,t.name="Normal",t.backColor=null,t}function Vt(t,n){var e,i,e,r,o,a,e=n&&n.rowHeadersAsFrozenColumns,i=n&&n.columnHeadersAsFrozenRows;if(e||i)return 1;if((e=t.mp)&&e.length&&(n&&n.fileType)===nt.OpenSaveFileType.excel)for(r=0,o=e;r<o.length;r++)if((a=o[r])._gi!==nt.SheetType.reportSheet)return 1}function zt(t,n){n&&(t.options.colHeaderAutoText=nt.HeaderAutoText.numbers)}function Yt(t,n){var n=n.state;"hidden"===n?t.visible(nt.SheetTabVisible.hidden):"veryHidden"===n&&t.visible(nt.SheetTabVisible.veryHidden)}function Zt(t,n,e,i,r,o){var a,u,t,e,e,a=yt(t,e),u=r.loadStatus,t=Ft(t,e);a.loading=!0,e=(e=ut(n,"sheetData"))&&e.rowCount||200,u.total+=e,t?(t.yh(n,i,r),vt(n.order)||(t.E0i=n.order)):(a.yh(n,i,r,o),vt(n.order)||(a.E0i=n.order))}function Mt(t){var n,t,n=t.getActiveSheet();return n||(t=t.getActiveSheetTab())&&(n=t.Mf),n}function Wt(t){for(var n,e,i,n=0,e=wt(t);n<e;n++)delete(i=yt(t,n)).loading,et.Worksheet.et(i,"onSheetLoaded")}function Qt(t,n,e,i){var t=t;ot.culture(n),t.Bp=!1,e&&i&&i.Zg(),t.resumeEvent(),t.Cg(),t.resumePaint()}function Jt(t){for(var n,e,i,r,o,a,n={},e=[],i=0,r=t;i<r.length;i++)a=(o=r[i]).f,n.hasOwnProperty(a)||e.push(n[a]=o);return e}o=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.Sp=t.Tp=t.Ap=t.getAbsoluteRangeText=t.Ip=void 0,K=n("./dist/core/workbook/workbook.js"),F=n("./dist/core/worksheet/style.js"),J=n("./dist/core/util/domUtil.js"),Ct=n("./dist/core/util/tasks.js"),X=n("./dist/core/excel-io-util/common.js"),q=n("./dist/core/excel-io-util/excel-types.js"),e=n("Common"),$=n("./dist/core/util/common.js"),tt=n("CalcEngine"),St=n("./dist/core/util/styleManager.js"),Tt=n("./dist/core/util/theme.js"),nt=n("./dist/core/core.enum.js"),r=n("./dist/core/core.ns.js"),et=n("./dist/core/worksheet/worksheet.js"),it=n("./dist/core/util/dataManager.js"),rt=!!tt,P=F.Style.xp,L=e.Commands.UndoManager,ot=e.Common.CultureManager,at=e.Common.lt.tv,At=X.Util.Kr,a=X.IndexHelper.nr,ut=$.util.xr,It=$.util.o1,h=X.Util.wr,d=X.Util.Mr,st=X.Util.Sr,ct=X.Util.Oge,xt=$.util.Pr,Nt=$.mt.n1,kt=$.mt.vo,_t=X.Util.io,u="__builtInValidatorStyle",s="__builtInTableStyle",ft=q.XFileConstants.ru,lt=q.XFileConstants.mo,ht=q.XFileConstants.Rr,v=q.XFileConstants.Lr,dt=q.XFileConstants.Ki,Dt=q.XFileConstants.ou,vt=e.Common.lt.ht,mt=void 0,n=new e.Common.ResourceManager(r.SR,"Sheets"),gt=n.getResource.bind(n),c="normal normal normal 11pt/normal Calibri",pt=J.GC$.each,bt=$.mt.T1,f=parseFloat,t.Ip=l,t.getAbsoluteRangeText=Et,K.Workbook.prototype.toJSON=function(t){return this.Np(t)},K.Workbook.prototype.Np=function(i,t){var r,e,n,o,a,u,s,c,f,l,h,d,v,m,g,p,l,f,l,b,w,y,y,M,C,S,T,A,I,x,N,k,_,D,f,l,r=this,e={version:$.productInfo.productVersion,name:r.name},a=i&&i.rowHeadersAsFrozenColumns,u=i&&i.columnHeadersAsFrozenRows,s=a||u;if(s&&(i.kp=!0),r.Dp&&(e.docProps=at(r.Dp)),rt&&(n=tt.Functions.setLanguagepackage)&&(o=n(),n("en")),this._p&&this._p.Ep(this),c=r.getSheetCount(),e.sheetCount=c,s)for(f=new K.Workbook,l=i&&i.includeAutoMergedCells,f.fromJSON(r.toJSON({includeBindingSource:!0,includeAutoMergedCells:l,convertReportSheetToWorksheet:i&&i.convertReportSheetToWorksheet}),{gp:!0}),r=f,h=0;h<c;h++)v=(d=r.getSheet(h)).getRowCount(1),m=d.getColumnCount(2),p=u&&0<v,(g=a&&0<m)&&d.addColumns(0,m),p&&d.ffe(0,v,3,p),g&&d.jp(m,p?v:0),p&&d.Op(v,g?m:0);for(r.Bp=!0,r.suspendPaint(),r.suspendEvent(),rt&&((l=r.Lp).calcOnDemand&&(l.calcOnDemand=!1,r.Fp(),l.suspend(!0),l.resume(!0),l.calcOnDemand=!0),l.forceR1C1Formula=i&&i.forceR1C1Formula,l.suspend(!0)),(f=r.startSheetIndex())&&(e.startSheetIndex=f),pt(r.options,function(t,n){"_ps"!==t&&K.Workbook.Pp[t]!==n&&(e[t]=n)}),(l=r.getActiveSheetIndex())!==K.Workbook.Gp&&(e.activeSheetIndex=l),b={},w=0;w<c;w++)d=r.getSheet(w),y=i,vt(t)||w===t||(y={}),(y=d.toJSON(y)).index=w,y.order=d.E0i,b[d.name()]=y;for(J.GC$.isEmptyObject(b)||(e.sheets=b),M={},C=r.getSheetTabCount(),S=r.getActiveSheetTabIndex(),x=function(e){var t,n,t=r.Ofe(e),n=t.toJSON(i);Array.isArray(n)?(n.forEach(function(t,n){t.index=c+e+n-T+1,M[t.sheet.name]=t,A++}),I=n.length-1):n?(n.sheetType=n.sheetType||t._gi,n.index=c+e+I-T,n.order=t.E0i,M[t.name()]=n,A++):(T++,e<=S&&S--)},N=I=A=T=0;N<C;N++)x(N);if(e.sheetTabCount=A,-1!==S&&(e.activeSheetTabIndex=S),J.GC$.isEmptyObject(M)||(e.sheetTabs=M),k=[],_=r.Hp){for(D in _)B(_,D)&&k.push(_[D]);0<k.length&&(e.namedStyles=k)}return(f=r.sheetTabStyles)&&(l=f.all(),J.GC$.isEmptyObject(l)||(e.sheetTabStylesMap=l)),K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){n.toJson&&n.toJson.call(r,e,i)}),(0,it.h2e)(r,e),rt&&n&&n(o),r.Bp=!1,rt&&(delete r.Lp.forceR1C1Formula,r.Lp.resume(!1)),r.resumeEvent(),r.resumePaint(),s&&delete i.kp,e},K.Workbook.prototype.fromJSON=function(e,i){var t,n,r,o,a,u,o,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,E,R,n=[],r=this;if(r.zp(),e){if(r.Vp&&r.Vp.terminate(),i&&i.incrementalLoading)return!0===i.incrementalLoading&&(i.incrementalLoading={}),r.Yp(e,i);o=G(e.version),u={noSchema:a=o<3,version:o},o=$.hi.ai(),r.Bp=!0,r.suspendPaint(),r.suspendEvent(),s=ot.culture(),ot.culture("");try{for(v in r.Zp(),r.Wp=new L(r,-1,r.options.allowUndo),rt&&(r.Qp(!0),r.Lp.suspendAdjust(),r.Lp.forceR1C1Formula=i&&i.forceR1C1Formula),r.Kp=-1,r.clearSheets(),r.clearSheetTabs(),c=e.name,bt(c)&&(r.name=c),f=r.options,l=e.canUserEditFormula,bt(l)&&(f.allowUserEditFormula=l),h=e.allowDragDrop,bt(h)&&(f.allowUserDragDrop=h),d=e.allowDragFill,bt(d)&&(f.allowUserDragFill=d),f)B(f,v)&&(m=e[v],bt(m))&&(f[v]=m);if(r.Dp=at(e.docProps),Y(r,"preFromJson",[e,a,i]),n.push((0,it.d2e)(r,e)),g=e.sheetCount,bt(g)||(g=K.Workbook.Jp),r.Xp(e.sheets||g,0),r.Hp={},r.qp={},p=e.namedStyles)for(b=0,w=p;b<w.length;b++)y=w[b],M=new F.Style,P(y,r),M.fromJSON(y,a,r),r.$p(M);if(S=void(C=0),T=e.sheets,I=A=void 0,N=!(x=!1),T)for(k in T)"string"==typeof k&&(_=T[k],D=bt(_.index)?_.index:_.lp,S=r.sheets[bt(D)?D:C])&&(_.isApplyRefilter=i&&i.isApplyRefilter,S.fromJSON(_,!1,u,i,!0),vt(_.order)||(S.E0i=_.order),C++,I=_.allowUndo,x?N=N&&I===A:(A=I,x=!0));bt(A)&&N&&(f.allowUndo=A),H(r,e),0<r.mp.length?(V(r,e,u,i),z(r,e)):0<=e.activeSheetTabIndex&&(e.activeSheetIndex=0),j=e.activeSheetIndex,bt(j)||(j=K.Workbook.Gp),r.tb(j,0,mt,mt,!0),(O=r.sheets[j])&&O.b2(!0,!1),r.dse=r.vse(r.sheets,r.mp),E=e.startSheetIndex,bt(E)&&r.startSheetIndex(E),R=e.backgroundImage,bt(R)&&r.nb(),r.sheetTabStyles.O2e=null!=(t=e.sheetTabStylesMap)?t:{},K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){var n=n.fromJson;n&&n.call(r,e,a,i)}),rt&&r.Lp.resumeAdjust(),U.call(r,e,i),K.Workbook.et(r,"initCustomName")}finally{rt&&(r.Lp.resumeAdjust(),delete r.Lp.forceR1C1Formula),ot.culture(s),r.Bp=!1,O=r.getActiveSheet(),o&&O&&O.Zg(),r.resumeEvent(),r.Cg(),r.resumePaint(),O&&r.ki($.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:O}),rt&&r.Lp.processDynamicRef()}return Promise.all(n)}},K.Workbook.prototype.Yp=function(e,i){var t,o,n,a,r,n,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,t=[],o=this;o.Vp=new Ct.Tasks(function(){var t,n,e,e,t=o.getActiveSheet();if(t&&!t.loaded)for(n=this.tasks.length-1;0<=n;n--)if((e=this.tasks[n].args[0])&&e.Ut&&e.name&&e.name()===t.name())return e=this.tasks[n],this.tasks.splice(n,1),e;return this.tasks.pop()},function(){var t=o.getActiveSheet();return t&&(o.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)}),n=G(e.version),r={noSchema:a=n<3,version:n},n=$.hi.ai(),o.Bp=!0,o.suspendPaint(),o.suspendEvent(),u=ot.culture(),ot.culture("");try{for(d in o.Zp(),o.Wp=new L(o,-1,o.options.allowUndo),rt&&(o.Qp(!0),o.Lp.suspendAdjust()),o.Kp=-1,o.clearSheets(),o.clearSheetTabs(),s=e.name,bt(s)&&(o.name=s),c=o.options,f=e.canUserEditFormula,bt(f)&&(c.allowUserEditFormula=f),l=e.allowDragDrop,bt(l)&&(c.allowUserDragDrop=l),h=e.allowDragFill,bt(h)&&(c.allowUserDragFill=h),c)B(c,d)&&(v=e[d],bt(v))&&(c[d]=v);if(o.Dp=at(e.docProps),Y(o,"preFromJson",[e,a,i]),t.push((0,it.d2e)(o,e)),m=e.sheetCount,bt(m)||(m=K.Workbook.Jp),o.Xp(e.sheets||m,0),o.Hp={},g=e.namedStyles)for(p=0;p<g.length;p++)b=g[p],w=new F.Style,P(b,o),w.fromJSON(b,a,o),o.$p(w);if(y=0,C=e.sheets,T=S=void 0,I=!(A=!1),C)for(N in x={total:0,valuesLoad:0,formulaLoad:0},i.incrementLoadTask=o.Vp,i.incrementalLoading.loadStatus=x,C)"string"==typeof N&&(k=C[N],_=bt(k.index)?k.index:k.lp,(M=o.sheets[bt(_)?_:y]).loading=!0,M.ub(k.name+"",!0),M.b2(k.isSelected),M.setRowCount(k.rowCount),M.setColumnCount(k.columnCount),bt(k.visible)&&M.visible(k.visible),x.total+=M.getRowCount(),o.Vp.addTask(function(t,n){n.isApplyRefilter=i&&i.isApplyRefilter,t.Yp(n,!1,r,i,!0),vt(n.order)||(t.E0i=n.order)},[M,k]),y++,T=k.allowUndo,A?I=I&&T===S:(S=T,A=!0));bt(S)&&I&&(c.allowUndo=S),H(o,e),0<o.mp.length?(V(o,e,r,i),z(o,e)):0<=e.activeSheetTabIndex&&(e.activeSheetIndex=0),D=e.activeSheetIndex,bt(D)||(D=K.Workbook.Gp),o.tb(D,0,mt,mt,!0),(j=o.sheets[D])&&j.b2(!0,!1),O=e.startSheetIndex,bt(O)&&o.startSheetIndex(O),o.Vp.endingCallback=function(){K.Workbook.fh&&pt(K.Workbook.fh,function(t,r){r.Yp?o.Vp.addTask(function(t,n,e,i){r.Yp.call(t,n,e,i)},[o,e,a,i]):r.fromJson&&r.fromJson.call(o,e,a,i)}),o.Vp.endingCallback=function(){var t,n,n;for(o.dse=o.vse(o.sheets,o.mp),rt&&o.Lp.resumeAdjust(),U.call(o,e,i),K.Workbook.et(o,"initCustomName"),rt&&o.Lp.processDynamicRef(),t=0;t<o.sheets.length;t++)delete o.sheets[t].loading;(M=o.getActiveSheet())&&o.ki($.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:M}),i&&i.incrementalLoading&&(n=i.incrementalLoading,o.ki($.Events.ProgressChanged,{loadStatus:n.loadStatus,progress:1,sheet:M}),n.loading)&&n.loading(1,{sheet:M}),(n=i&&i.incrementalLoading&&i.incrementalLoading.loaded)&&n(),M&&M.repaint(),o.w2.repaint(),o.Vp.endingCallback=void 0},o.Vp.start()},o.Vp.start()}finally{ot.culture(u),o.Bp=!1,j=o.getActiveSheet(),n&&j&&j.Zg(),o.resumeEvent(),o.Cg(),o.resumePaint()}return Promise.all(t)},K.Workbook.prototype.getSheetRelsName=function(t){var t,n,t=t.split("/").pop(),n=t.lastIndexOf(".xml");return t.substring(0,n)},K.Workbook.prototype.getSheetRelsDir=function(t){var t,t,t=t.split("/"),t=t[t.length-2];return"worksheets"!==t?t:"sheets"},t.Ap=wt,t.Tp=yt,K.Workbook.prototype.wh=function(e){var i,t,n,r,r,o,F,n,a,u,s,c,f,u,l,L,h,B,d,v,u,m,g,p,b,w,P,G,y,M,C,U,n,H,V,a,z,Y,Z,S,T,A,I,A,x,N,k,_,D,j,O,_,D,j,O,E,R,W,j,_,D,O,E,W,R,j,Q,n,a,i=this;if(i._p&&i._p.Ep(i),t=!e||!1!==e.includeStyles,Vt(this,e)&&(n=new K.Workbook,r=e&&e.includeAutoMergedCells,n.fromJSON(i.toJSON({includeBindingSource:!0,includeAutoMergedCells:r,convertReportSheetToWorksheet:e&&e.fileType===nt.OpenSaveFileType.excel}),{sb:!0,cb:e&&e.fileType}),i=n),r=i.options,(F=(o={}).workbook={n_:"workbook",c_:[],lossless:{version:Ut(),renamedStylesMap:{},richValueDataArray:[],customData:e&&e.customData},rels:{}}).c_.push(n={n_:"bookViews",c_:[]}),!(a={n_:"workbookView"})===r.showHorizontalScrollbar&&(a.showHorizontalScroll="0"),!1===r.showVerticalScrollbar&&(a.showVerticalScroll="0"),!1===r.tabStripVisible&&(a.showSheetTabs="0"),(u=i.startSheetIndex())&&(a.firstSheet=u),-1!==(s=i.ep()))for(c=s;0<=c;c--)2===(f=i.e2(c))._gi&&s--;for(s!==K.Workbook.Gp&&(a.activeTab=s),"number"==typeof(u=r.tabStripRatio)&&.6!==u&&(a.tabRatio=1e3*u),n.c_.push(a),i.Dp&&(o.docProps=at(i.Dp)),pt(i.options,function(t,n){"_ps"!==t&&K.Workbook.Pp[t]!==n&&(F.lossless[t]=n)}),rt&&(l=tt.Functions.setLanguagepackage)&&(L=l(),l("en")),h={},B=wt(i),d=i.getNamedStyles(),v=new St.StyleManager,u=new $.SharedStrings,g=!(m={styleManager:v,sharedStrings:u}),p=[{style:null}],b={},w={},P=F.lossless.renamedStylesMap,Object.keys(d).forEach(function(t){var n=d[t].name;n!==gt().NORMAL?p.push({style:d[t]}):(p[0].style=d[t],g=!0),b[n]=1}),G=function(r){var o,t,a,o=yt(i,r);if(!o)return"continue";t={sheet:o},et.Worksheet.et(o,"getActualToSJSFormatSheet",t),a=(o=t.sheet).getNamedStyles(),Object.keys(a).forEach(function(t){var n,e,i,n=a[t].name;if(!Bt(n)&&!Lt(n)){for(e=n,i=at(a[t]);b[e]||255<e.length;)e=Pt(e,o.name());i.name=e,g||i.name!==gt().NORMAL?p.push({sheetId:r,style:i}):(p[0]={sheetId:r,style:a[t]},g=!0),b[e]=1,n!==e&&(w[n]=w[n]||{},w[n][o.name()]=e,P[e]=n)}})},c=0;c<B;c++)G(c);for(v.gv=w,(y=X.Util.ko(e))||t&&p[0]&&p[0].style?!y||p[0]&&p[0].style||p.shift():(C=yt(i,0),M=t&&C&&!C.NMi?C.getDefaultStyle():{},U=Ht(),Object.keys(M).forEach(function(t){"_id"!==t&&"name"!==t&&(U[t]=M[t])}),p[0]={style:U},g=!0),p.forEach(function(t){v.getNamedStyleIndex(t.style,3,mt,t.sheetId,!y)}),y||(n=p[0].style.clone(!0),(0,$.AL)(n),v.getStyleIndex(n)),v.updateNamedStylesParentName(),M=g?p[0]&&p[0].style:(C=yt(i,0),t&&C&&!C.NMi?C.getDefaultStyle():Ht()),m.defaultStyle=M,$.SJSColumnWidthHelper.setMaxDigitWidth(Gt(M,i)),K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){n.preToSJSFormat&&n.preToSJSFormat.call(i,o,m,e)}),V={n_:lt,c_:[]},a={n_:q.XFileConstants.Dr,xmlns:q.RelationshipConstants._r},z=Rt(i,a),Y=0,o.workbook.rels=a,S=Z=0;S<B;S++)if(C=yt(i,S)){if(T=z[Y],f=Ft(i,S),Y++,A=ft+T,(I=(f||C).wh(o,m,e)).order=(f||C).E0i-Z,h[A]=I,A=C.name(),t&&C.hl&&!H&&(o.theme=H=I&&I.lossless&&I.lossless.theme),(x=I.lossless.definedNames||[])&&x.length)for(c=0;c<x.length;c++)N=x[c],x[c]=ct({name:N.name,localSheetId:S,e:N.e,comment:N.comment,isReadOnly:N.isReadOnly},N.formula);I.richValueDataArray&&0<I.richValueDataArray.length&&(I.richValueDataArray.forEach(function(t){t.imgFileName=At(t.imageBase64Data,mt,o)}),o.workbook.lossless.richValueDataArray=o.workbook.lossless.richValueDataArray.concat(I.richValueDataArray),delete I.richValueDataArray),(k=I.printInfo)&&(_=k.rowStart,D=k.rowEnd,j=k.columnStart,O=k.columnEnd,-1===_&&-1===D&&-1===j&&-1===O||(_=C.getCalcService(),D=C.Uw(),_&&D&&(j=C.getCustomName("Print_Area"))&&(O=j.getExpression(),E=j.getRow(),R=j.getColumn(),W=j.getComment(),j=j.isReadOnly(),_=_.unparse(D,O,E,R,!1,!0,1),x.push(ct({name:"_xlnm.Print_Area",localSheetId:S,comment:W,isReadOnly:j},_)))),D=Et(k.repeatRowStart,k.repeatRowEnd,mt,mt,A),O=Et(mt,mt,k.repeatColumnStart,k.repeatColumnEnd,A),E=void 0,D&&O?E=O+","+D:D?E=D:O&&(E=O),E&&x.push(ct({name:"_xlnm.Print_Titles",localSheetId:S},E)),delete I.printInfo),I.lossless.definedNames=x,R=void 0,(W=C.visible())===nt.SheetTabVisible.hidden?R="hidden":W===nt.SheetTabVisible.veryHidden&&(R="veryHidden"),j={n_:ft,"r:id":ht+T,name:kt(A),sheetId:T,state:R,lossless:{tabSelected:C.b2()?"1":mt}},V.c_.push(j)}else Z++;return o.workbook.c_.push(V),o.workbook.lossless.richValueDataArray=Jt(o.workbook.lossless.richValueDataArray),J.GC$.isEmptyObject(h)||(o.sheets=h),o.styles={},K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){n.wh&&n.wh.call(i,o,m,e)}),(0,it.l2e)(i,o),o.styles=v.bv(o.styles,v.wh(e)),o.sharedStrings=u.wh(),(Q=i.sheetTabStyles)&&(n=i.sheetTabStyles.all(),J.GC$.isEmptyObject(n)||(o.workbook.lossless.sheetTabStylesMap=n)),v.dispose(),1!==r.referenceStyle&&vt(r.iterativeCalculation)&&vt(r.iterativeCalculationMaximumIterations)&&vt(r.iterativeCalculationMaximumChange)||(a={n_:"calcPr",calcId:0},1===r.referenceStyle&&(a.refMode="R1C1"),r.calculationMode===nt.CalculationMode.manual&&(a.calcMode="manual"),!0===r.iterativeCalculation&&(a.iterate=1),vt(r.iterativeCalculationMaximumIterations)||(a.iterateCount=r.iterativeCalculationMaximumIterations),vt(r.iterativeCalculationMaximumChange)||(a.iterateDelta=r.iterativeCalculationMaximumChange),o.workbook.c_.push(a)),xt(o.workbook,q.WorkbookNodeOrder),rt&&l&&l(L),o},K.Workbook.prototype.fb=function(t,n){var e,t,e=this;ot.culture(""),e.Zp(),n&&n.calcOnDemand&&(e.options.calcOnDemand=!0),n&&!1===n.dynamicReferences&&(e.options.dynamicReferences=!1),!0===t&&(e.options.allowDynamicArray=!0),e.Wp=new L(e,-1,e.options.allowUndo),rt&&(e.Qp(!0),(t=e.Lp).suspendAdjust(),t.suspend(),t.lb=n&&!n.fullRecalc),e.Kp=-1,e.clearSheets(),e.clearSheetTabs()},K.Workbook.prototype.hb=function(t){var n,e,i,r,r,r,o,a,r,r,n,e=this.options,i=t.workbook.lossless;if(i)for(o in r=i.canUserEditFormula,bt(r)&&(e.allowUserEditFormula=r),r=i.allowDragDrop,bt(r)&&(e.allowUserDragDrop=r),r=i.allowDragFill,bt(r)&&(e.allowUserDragFill=r),e)B(e,o)&&(a=i[o],bt(a))&&(e[o]=a);(r=ut(t.workbook,"extLst"))&&r.c_&&r.c_[0]&&r.c_[0]["xmlns:xcalcf"]===q.XFileConstants.Cs&&(e.allowDynamicArray=!0),(r=ut(t.workbook,"calcPr"))&&("R1C1"===r.refMode&&(e.referenceStyle=1),"manual"===r.calcMode&&(e.calculationMode=nt.CalculationMode.manual),e.iterativeCalculation=1===parseInt(r.iterate,10),e.iterativeCalculationMaximumIterations=vt(r.iterateCount)?100:parseInt(r.iterateCount,10),e.iterativeCalculationMaximumChange=vt(r.iterateDelta)?.001:parseFloat(r.iterateDelta))},K.Workbook.prototype.db=function(t){var n,n,e,i,r,r,o,a,u,s,c,f,l,l,l,h,h,h,i,d,v,r,i,m,e=this,i=e.options,r=ut(t.workbook,"bookViews"),r=ut(r,"workbookView");if(r){if(r.showHorizontalScroll&&(i.showHorizontalScrollbar="0"!==r.showHorizontalScroll),r.showVerticalScroll&&(i.showVerticalScrollbar="0"!==r.showVerticalScroll),r.showSheetTabs&&(i.tabStripVisible="0"!==r.showSheetTabs),i.tabStripRatio=vt(r.tabRatio)?.6:r.tabRatio/1e3,r.firstSheet&&e.startSheetIndex(+r.firstSheet),o=0,r.activeTab!==mt)o=+r.activeTab;else if(t.sheets){if(a=ut(t.workbook,lt).c_,u=t.workbook.rels&&t.workbook.rels.c_,a&&u){for(s=[],c=0;c<a.length;c++)l=(f=a[c])[dt],(l=(l=st(u,l))&&l.Target)&&s.push(e.getSheetRelsName(l));for(c=0;c<s.length;c++)if((h=t.sheets[s[c]])&&(h=ut(h,"sheetViews"))&&(h=ut(h,"sheetView"))&&"1"===h.tabSelected){o=c;break}}}else if((d=null==(i=ut(t.workbook,"sheets"))?void 0:i.c_)&&0<d.length)for(v=0;v<d.length;v++)if("1"===(null==(n=null==(n=null==d?void 0:d[v])?void 0:n.lossless)?void 0:n.tabSelected)){o=v;break}i=(r=e.getActiveSheetOrSheetTab())&&r.b2(),e.I2(o,2),null!=(m=e.getActiveSheet())&&m.b2(!0,!1),r&&i&&e.getActiveSheetOrSheetTab()!==r&&r.b2(!0,!1)}},K.Workbook.prototype.mb=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,p,b,p,y,b,p,p,u=this,s=r.sheetNamedStyles;for(d in o=o||{},c=!(u.Hp={})!==a.includeUnusedStyles,f=n.styles&&n.styles.namedStylesMap,l=X.Util.ko(a),h=!0,f)f.hasOwnProperty(d)&&(v=h&&(d===gt().NORMAL||!l&&0===f[d]),l&&!c&&!v&&vt(t.originNamedStylesXfs.Lh[d])||(m=t.getNamedStyle(f[d],d,l),vt(m)&&(m={foreColor:"Text 1 0",themeFont:"Body",font:"normal normal 14.7px Calibri",locked:!0,textIndent:0,wordWrap:!1,vAlign:2,hAlign:3}),l||m.formatter!==gt().GENERAL||delete m.formatter,v&&(h=!1,m.name="Normal",m.font=Gt(m,u,i,e),$.SJSColumnWidthHelper.setMaxDigitWidth(m.font),delete(g=m.clone()).name,r.defaultStyle=g),m.name=o[m.name]||m.name,m.sheetId!==mt?(s[m.sheetId]||(s[m.sheetId]=[]),s[m.sheetId].push(m)):u.$p(m)));!1!==h&&(p=ut(n.workbook,lt).c_,b=n.workbook.rels&&n.workbook.rels.c_,p=(w=p[0])[dt],g=y=void 0,g=(g=(y=(p=(b=st(b,p))&&b.Target)?(b=u.getSheetRelsName(p),n[p=u.getSheetRelsDir(p)]&&n[p][b]):n.sheets.sheet1)?y.lossless&&y.lossless.defaultStyle:g)||{hAlign:3,imeMode:1,themeFont:"Body",vAlign:0},(p=new F.Style).fromJSON(g,mt,mt),p.font=Gt(p,u,i,e),$.SJSColumnWidthHelper.setMaxDigitWidth(p.font),r.defaultStyle=p),a&&a.fileType===nt.OpenSaveFileType.excel&&t.buildDummyNamedStyles(u)},t.Sp=Mt,K.Workbook.prototype.yh=function(r,o,e){var t,n,i,a,F,L,B,P,G,u,s,c,f,l,h,d,U,v,m,g,p,b,H,w,y,M,C,S,T,A,I,V,x,z,Y,Z,N,W,Q,k,_,D,j,O,E,J,R,G=[],u=this;if(u.zp(),r){e=e||function(){},s=X.Util.Mo(o),(o=o||{}).progress||(o.progress=function(t){}),o.loadStatus={total:0,valuesLoad:0,formulaLoad:0},c=function(t){u.pb($.Events.ProgressChanged,{loadStatus:o.loadStatus,progress:t.progress,sheetName:t.sheetName}),o.progress({step:t.step,sheetName:t.sheetName,progress:t.progress})},u.Vp&&u.Vp.terminate(),u.Vp=new Ct.LoadTasks(function(){var t,n,e,e,t=Mt(u);if(t&&!t.loaded)for(n=this.tasks.length-1;0<=n;n--)if((e=this.tasks[n].args[0])&&e.Ut&&e.name&&e.name()===t.name())return e=this.tasks[n],this.tasks.splice(n,1),e;return this.tasks.pop()},function(){var t=Mt(u);return s&&t&&(u.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)},c),u.suspendPaint(),u.suspendEvent(),f=$.hi.ai(),u.Bp=!0,l=ot.culture(),h=!1;try{if(u.fb(r.workbook.lossless&&r.workbook.lossless.allowDynamicArray,o),u.hb(r),u.Dp=at(r.docProps),(d=new St.StyleManager).yh(r.styles),(U=new $.SharedStrings).yh(r.sharedStrings),v={},Object.keys(r).forEach(function(t){-1<t.indexOf(Dt)&&(v[t]=r[t])}),m=void 0,m=(r.sheets&&r.sheets.sheet1&&r.sheets.sheet1.lossless&&r.sheets.sheet1.lossless.theme?r.sheets.sheet1.lossless:r).theme,p=g=void 0,m&&"string"!=typeof m?m&&(H=ut(m,"themeElements"),w=ut(H,"fontScheme"),g=It(w,"majorFont&latin").typeface,p=It(w,"minorFont&latin").typeface):((b=new Tt.Theme(mt)).yh("string"==typeof m?m:"Office"),g=b.headerFont(),p=b.bodyFont()),y={drawings:r.drawings,tables:r.tables,charts:r.charts,media:r.media,ctrlProps:r.ctrlProps,comments:v,pivotTables:r.pivotTables,slicers:r.slicers,slicerCaches:r.slicerCaches,timelineCaches:r.timelineCaches,timelines:r.timelines,styleManager:d,sharedStrings:U,theme:r.theme,sheetNamedStyles:{},dataEffectByInflate:{}},u.mb(d,r,g,p,y,r.workbook.lossless&&r.workbook.lossless.renamedStylesMap,o),K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){var n=n.preFromSJSFormat;n&&n.call(u,r,y,o)}),G.push((0,it.v2e)(u,r)),M=ut(r.workbook,"definedNames"),y.workbookNames=M&&M.c_,S=(C=ut(r.workbook,lt).c_||[]).length,bt(S)||(S=K.Workbook.Jp),T=r.workbook.rels&&r.workbook.rels.c_,o&&(o.incrementLoadTask=u.Vp),T){for(A=[],I=[],V=1===u.options.referenceStyle,x=0;x<S;x++)Y=(z=C[x])[dt],N=(Z=st(T,Y))&&Z.Target||"",W=u.getSheetRelsName(N),Q=u.getSheetRelsDir(N),k=null==(t=null==r?void 0:r[Q])?void 0:t[W],_=_t(Nt(z.name)),D=!0,j=null==(n=null==k?void 0:k.lossless)?void 0:n.addition,O=(null==k?void 0:k.sheetType)||(null==(i=null==k?void 0:k.lossless)?void 0:i.sheetType),j||O?(E=u.bb(_,O||0))?(u.yb(x-u.sheets.length,0,E),A.push([E,j])):D=!1:(J=u.S2(_),u.A2(x,0,J)),D&&(I[x]=k);for(x=0;x<S;x++)(k=I[x])&&Zt(u,k,x,y,o,!X.Util.wo(o,u.v2)),Yt(yt(u,x),C[x]),zt(yt(u,x),V);Ot(A,u,o&&o.fullRecalc,!0)}u.db(r),R={},null!=(F=null==(a=r.workbook)?void 0:a.lossless)&&F.customData&&(R.customData=r.workbook.lossless.customData),u.sheetTabStyles.O2e=null!=(P=null==(B=null==(L=r.workbook)?void 0:L.lossless)?void 0:B.sheetTabStylesMap)?P:{},u.Vp.endingCallback=function(){u.UCe(),K.Workbook.fh&&pt(K.Workbook.fh,function(t,n){var i=s&&n.Mb||n.yh;i&&u.Vp.addTask(function(t,n,e){i.call(u,r,y,o)},[u,r,o])}),u.Vp.endingCallback=function(){var t,n,n;d.dispose(),X.Util.wo(o,u.v2)||jt.call(u,o),t=!1,rt&&((n=u.Lp).resumeAdjust(),o.fullRecalc?(Wt(u),n.resume(!(t=!0),!1,!n.calcOnDemand)):(n.resumeWithoutCalc(),delete n.lb,u.Lp.processDynamicRef())),K.Workbook.et(u,"initCustomName"),t||Wt(u),u.options.backgroundImage&&u.nb(),n=Mt(u),c({progress:1,step:"whole workbook loaded.",sheetName:n&&n.name()}),s?n&&n.repaint():Qt(u,l,f,n),n&&u.ki($.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:n}),e(R)},u.Vp.start()},u.Vp.start(),Promise.all(G).then(function(){u.ki($.Events.DataFetchCompleted,{spread:u})})}catch(t){throw h=!0,t}finally{(s||h)&&Qt(u,l,f,Mt(u))}}}},"./dist/core/workbook/workbook.js":function(_,D,t){"use strict";var u,n,o,y,O,j,P,G,U,H,V,v,z,Y,M,Z,W,Q,J,K,X,q,w,E,c,t,$,tt,nt,et,C,R,f,F,it,L,rt,B,ot,at,ut,st,a,s,ct,ft,lt,m,ht,e,dt,l,vt,d,mt,h,g,p,gt,pt,bt,wt,yt,Mt,b,Ct,St,Tt,S,T,A,At,I,x,It,xt,Nt,kt,_t,Dt,n,N,jt,Ot,Et,r,Rt,n;function Ft(t){t.getActiveSheet()}function Lt(t,n){return O.Bf.Zl()%1!=0||t.zoom()%1!=0||t.parent&&t.parent.options.scrollByPixel&&n&&t.Cb&&t.Cb.Sb((0,O.Ec)(t.Tb,t.Ab,1,1))}function Bt(n,e){return R.setTimeout(function(){n.invalidateLayout(),n.repaint(),e.Ib=F;var t=n.ot();e.xb(n,t.x,t.width),e.Nb(n,t.y,t.height)},200)}function Pt(t,n,e){t.ki(O.Events.ActiveSheetChanged,{oldSheet:n,newSheet:e})}function Gt(t,n){t.ki(O.Events.ActiveSheetChanging,n)}function Ut(t,n){t.ki(O.Events.ActiveSheetChangingInternal,n)}function Ht(t,n,e){t.ki(O.Events.ActiveSheetChangedInternal,{oldSheet:n,newSheet:e})}function i(t){this.kb=t}function Vt(t,n){n?(0,y.GC$)(t).removeClass(S):(0,y.GC$)(t).addClass(S)}function zt(t,n,e){var i,r,n,o,n,i=O.I.fl("gc-vertical-scrollbar"+Mt),o=2007<C(i.zIndex)?1:0,n=n-e,n=n%2==0?(r=n/2)-o:r=(n-o)/2;(0,y.GC$)(t).css({"box-sizing":wt,border:p,"border-color":p,"border-left-style":yt,"border-left-width":o+d,"border-left-color":i.borderLeftColor,"background-color":i.backgroundColor,width:e,padding:"0px "+r+"px 0px "+n+d,margin:0})}function Yt(t,n,e){var i,r,n,o,n,i=O.I.fl("gc-horizontal-scrollbar"+Mt),o=2007<C(i.zIndex)?1:0,n=n-e,n=n%2==0?(r=n/2)-o:r=(n-o)/2;(0,y.GC$)(t).css({"box-sizing":wt,border:p,"border-color":p,"border-top-style":yt,"border-top-width":o+d,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:e,padding:n+"px 0px "+r+"px 0px",margin:0})}function Zt(t){var n=O.I.fl("gc-footer-corner"+Mt);(0,y.GC$)(t).css({border:p,padding:0,margin:0,"background-color":n.backgroundColor})}function Wt(t,n,e,i,r){var o,a,n,o=t._b(),a=n.left-e.left,n=n.top-e.top;if(a<i&&i<o.width+a&&n<r&&r<o.height+n)return{horizontalScrollBarHitInfo:{element:t.hitTest(i-a,r-n).element},x:i,y:r}}function Qt(t,n,e,i,r){var o,a,n,o=t._b(),a=n.left-e.left,n=n.top-e.top;if(a<i&&i<o.width+a&&n<r&&r<o.height+n)return{verticalScrollBarHitInfo:{element:t.hitTest(i-a,r-n).element},x:i,y:r}}function Jt(t){var t=(0,y.GC$)(t);return{top:Kt(t,"borderTopWidth"),right:Kt(t,"borderRightWidth"),bottom:Kt(t,"borderBottomWidth"),left:Kt(t,"borderLeftWidth")}}function Kt(t,n){var e=t.css(n);switch(e){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(e)}}function Xt(t){var t=(0,y.GC$)(t);return{top:parseFloat(t.css("paddingTop")),right:parseFloat(t.css("paddingRight")),bottom:parseFloat(t.css("paddingBottom")),left:parseFloat(t.css("paddingLeft"))}}function qt(t){var n,e,i,e,t,r,o,n=t.getBoundingClientRect().width,e=Jt(t),i=e.left,e=e.right,t=Xt(t),r,o;return n-i-e-t.left-t.right}function $t(t){return M.SheetType[t]}function tn(t){var n,e,i,r,o,n=t.getSheetCount(),e=t.getSheetTabCount();if(0!==n&&0!==e)for(i=t.qv(),r=0;r<i.length;r++)if(o=i[r],r<n&&o.NMi||n<=r&&!o.NMi)return;return 1}function nn(t){var n={calcSources:[]};return v.Worksheet.et(t,"getRelatedCalcSources",n),n.calcSources}function k(t,n){var i,e,n,i=this;i.name="",i.sheetTabStyles=new W.default(i),i.Eb=!1,i.Kp=-1,i._2=0,i.jb=-1,i.Bp=!1,i.options=$(Rt,function(t,n,e){i.Ob(t,n,e)}),i.Zp(n),n&&"white"===n.backColor?i.Rb=!0:i.Rb=!1,e=1,n&&typeof(n=n.sheetCount)==ot&&(e=n),"string"==typeof t&&(t=f.getElementById(t)),i.Ti=t,i.Hc(e,t)}Object.defineProperty(D,"__esModule",{value:!0}),D.Workbook=void 0,u=t("./dist/core/workbook/workbookpanelex.js"),n=t("./dist/core/core.ns.js"),o=t("Common"),y=t("./dist/core/util/domUtil.js"),O=t("./dist/core/util/common.js"),j=t("./dist/core/util/imageLoader.js"),P=t("./dist/core/worksheet/worksheet-actions.js"),G=t("./dist/core/workbook/sheettab.js"),U=t("./dist/core/workbook/sheettab2007.js"),H=t("./dist/core/worksheet/stylehelper.js"),V=t("./dist/core/worksheet/clipboardhelper.js"),v=t("./dist/core/worksheet/worksheet.js"),z=t("CalcEngine"),Y=!!z,M=t("./dist/core/core.enum.js"),Z=t("DataManager"),W=t("./dist/core/workbook/sheettabStyleManager.js"),Q=o.Common.zf,J=o.Commands.UndoManager,K=o.Commands.CommandManager,X=y.GC$.each,q=y.GC$.extend,w=Y,E=o.Common.lt.ht,c=O.mt.En,t=O.mt.p0,$=O.mt.b0,tt=O.mt.yt,nt=O.mt.T1,et=o.Common.CultureManager,C=parseInt,R=window,f=document,F=null,it=Math.round,L=Math.min,rt=Math.floor,B=Math.abs,ot="number",at="mousedown",ut="mousemove",st="mouseup",a="mouseenter",s="mouseleave",ct="scroll",ft="resize",lt="focus",m=".gcSpread",ht=".gcSpreadInternal",e=".gcScrollbar",dt="span",l="div",vt="table",d="px",mt="100%",h="gc-scroll-handle",g="gc-scroll-bar",p="none",gt="display",pt="block",bt="absolute",wt="content-box",yt="solid",Mt=" ui-widget-header ui-state-default btn btn-default",b="gc-scroll-mobile-container",Ct="gc-scroll-mobile-container-horizontal",St="gc-scroll-mobile-container-vertical",Tt="gc-scroll-mobile-spread-hovering",S="gc-scroll-mobile-state-hide",T="gc-scroll-mobile-state-hover",A=R.jQuery,At="cultureChanged",I="workbook",x="gcUIElement",It="gc-no-user-select",xt="visible",Nt="overflow",kt="en-US",_t=80,Dt=1,n=new o.Common.ResourceManager(n.SR,"Sheets"),N=n.getResource.bind(n),jt=100,Ot=30,Et=40,i.Bb=function(t,n){var t,e,e,t=t.data,e=t.ib;e.Lb&&(R.clearTimeout(e.Lb),e.Lb=F),(e=t.jg())&&n&&e.Fb(t,n)},i.Pb=function(t){var t,n,t=t.data,n=t.jg();n&&n.Gb(t)},i.Ub=function(t,n){var e,i,r,r,i,r,i,e=t.data;e&&((i=e.getActiveSheet())?((r=e.zb.Hb)&&r.Vb&&(i.Oi=!0),i.Zg()):(r=e.getActiveSheetTab())&&r.Zg(),1===(i=e.options.showScrollTip)||3===i)&&(i=(r=(0,y.GC$)(t.srcElement||t.target)).parent(),r&&(r.hasClass(h)||r.hasClass(g))||i&&(i.hasClass(h)||i.hasClass(g)))&&e.ib.Yb(!1,t,n)},i.Zb=function(t,n){var t,e,e,t=t.data,e=t.ib;e.Lb&&(R.clearTimeout(e.Lb),e.Lb=F),(e=t.jg())&&n&&e.Wb(t,n)},i.Qb=function(t){var t,n,t=t.data,n=t.jg();n&&n.Kb(t)},i.Jb=function(t){var n,e,i,i,e,i,e,n=t.data;n&&((e=n.getActiveSheet())?((i=n.Xb.Hb)&&i.Vb&&(e.Oi=!0),e.Zg()):(i=n.getActiveSheetTab())&&i.Zg(),2!==(e=n.options.showScrollTip)&&3!==e||(i=(0,y.GC$)(t.srcElement||t.target))&&(e=i.parent(),i.hasClass(h)||e&&e.hasClass(h)||i.hasClass(g)||e&&e.hasClass(g))&&n.ib.Yb(!0,t))},i.qb=function(t,n){var t,e,e,e,n,t=t.data,e=t.ib;e.Lb&&(R.clearTimeout(e.Lb),e.Lb=F),(e=t.jg())&&n&&(e.onHorizontalDockScroll(t,n),1!==(e=t.options.showScrollTip)&&3!==e||(n=t.ib.$b(!1,!0),t.ny(n)))},i.ey=function(t){var t=t.data;t&&t.iy()},i.ry=function(t){var n,e,i,r,i,o,t,n=N(),e=t.data,i=t.scrollbar;e.options.enableAccessibility&&(r=(0,y.GC$)(i.oy()).offset(),i=i.hitTest(t.x-r.left,t.y-r.top),t=(o={thumbButton:n.ARIA_Scrollbar_Thumb_Button,trackButton:n.ARIA_Scrollbar_TRACK_Button,leftButton:n.ARIA_Scrollbar_Left_Button,rightButton:n.ARIA_Scrollbar_Right_Button,upButton:n.ARIA_Scrollbar_Top_Button,downButton:n.ARIA_Scrollbar_Bottom_Button})[i.element],e.n2(t))},i.prototype.L0=function(){this.kb=F},i.prototype.ay=function(t,n,e,i){var r=this;t&&(r.eb=!0,r.uy=i?t.Tb:n,r.fy=i?t.ly:e,r.hy=i?n:t.Ab,r.vy=i?e:t.my,R.setTimeout(function(){r.gy(t)},0))},i.prototype.gy=function(t){var n=this;t&&n.eb&&(n.eb=!1,n.py(t))},i.prototype.py=function(t){var n,e,i,r,o,a,u,n=this;n.by||(n.by=!0,e=n.kb,t&&(i=e.options.showScrollTip,r=n.uy,o=n.fy,a=n.hy,u=n.vy,r!==t.Tb||o!==t.ly?(n.yy(t,r,o),2!==i&&3!==i||e.ny(n.$b(!0))):a===t.Ab&&u===t.my||(n.wy(t,a,u),1!==i&&3!==i)||e.ny(n.$b(!1))),n.by=!1)},i.prototype.yy=function(t,n,e,i){var r,o,a,u,s,c,c,i,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,I,x,N,k,I,_,D,l,i,I,d,j,h,b,r=this;if(r.Ib&&(R.clearTimeout(r.Ib),r.Ib=F),t&&(o=t.Tb,a=t.ly,u=t.zoom(),s=t.parent.options.scrollByPixel,(c=!E(i))||n!==o||e!==a))if(c&&(o=i),t.Tb=n,t.ly=e,0<t.My)(o!==n||s&&a!==e)&&t.ki(O.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:o,newTopRow:n,oldOffset:B(a/u),newOffset:B(e/u)});else{if(c=!1,l=(f=(i=t.options).sheetAreaOffset.top)+2,h=t.kg,v=(d=t.Fi()).Cy,m=t.Sy(d),g=d.Ty,p=d.Ay,b=d.Iy,w=d.width+i.sheetAreaOffset.left,C=M=y=void 0,T=(S=t.Dn).J(),A=t.Ny,t.tables&&0===t.frozenRowCount()&&(I=t.tables.Dy())&&(I.x=I.x-2,I.width=I.width+4,I.y=f,I.height=v,t.k1=!0,S.D1(T,I)),o<n||n===o&&B(e)>B(a)){if(x=I=void 0,I=(N=t._y(1))&&0<N.length?N.findRow(n):I){for(x=N[k=N.length-1];x&&x.y+x.height>v+m;)x=N[k-=1];x&&x.row>n&&(c=!0,M=(h||d).x,C=I.y+B(e),y=x.y+x.height-C-l,S.Ey(M,C,w,y,M,v),i.colHeaderVisible||(t.invalidateLayout(),S.D1(T,new O.Rect(M,0,w,f+1))),t.invalidateLayout(),S.D1(T,new O.Rect(M,v+y,w,(I=A?m:m+b+g)-y)),S.jy(T,new O.Rect(M,v-2,w,2+(I-=A?0:g))),this.xb(t,M,w))}}else{for(_=0,D=n;D<o&&_<m;D++)_+=t.Gt(D);(_+=B(a)-B(e))<m&&(c=!0,M=(h||d).x,C=v,y=m-_,0<t.frozenTrailingRowCount()&&--y,l=0,!A&&0<g&&(i=L(h.height-(l=b)-1,p-1+_),S.Ey(M,p-1,w,l+1,M,i)),I=A?0:L(_,g)-1,S.Ey(M,C,w,y+I,M,C+_),t.invalidateLayout(),d=t.rowOutlines&&!t.rowOutlines.Oy()?t.rowOutlines.Ry()+f+1:0,S.D1(T,new O.Rect(M,C-f,w,_+f+d+5)),S.jy(T,new O.Rect(M,C-2,w,j=m+I+l+2)),this.xb(t,M,w))}c||(t.invalidateLayout(),t.repaint()),(o!==n||s&&a!==e)&&t.ki(O.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:o,newTopRow:n,oldOffset:B(a/u),newOffset:B(e/u)}),(h=t.rt)&&h.By(),b=o===t.Tb&&a!==t.ly,c&&Lt(t,b)&&(r.Ib=Bt(t,r))}},i.prototype.xb=function(t,n,e){var i=t.Dn,r=i.J();this.Ly(t).concat(this.Fy(t)).forEach(function(t){var t=t.layout,t=new O.Rect(n,t.y,e,t.height);i.O1(t),i.jy(r,t)})},i.prototype.Ly=function(t){var n,e,n,i,r,o,e,a,e,n=this,e=t.getSelections();return!(1===e.length&&0<t.frozenRowCount())||(n=n.kb.options.scrollByPixel,i=t.Tb,r=t.ly,o=e[0].row,e=e[0].row+e[0].rowCount-1,n&&e==i-1)?[]:(a=[],(o===i+1||o<i&&i<=e||e==i-1||n&&o===i&&0!==r)&&(e=t._y(0))&&0<e.length&&a.push({layout:e[e.length-1]}),a)},i.prototype.Fy=function(t){var n,e,n,i,r,e,o,a,u,a,t,s,t,s,n=this,e=t.getSelections();return 1===e.length&&0<t.frozenTrailingRowCount()?(n=n.kb.options.scrollByPixel,i=t.getViewportBottomRow(1),r=e[0].row,e=e[0].row+e[0].rowCount-1,o=[],a=(u=(a=t._y(2))&&0<a.length)?a[0]:F,t=(s=(t=t._y(1))&&0<t.length)?t.findRow(i):F,s=u&&s&&a.y!==t.y+t.height,(e==i-1||r<=i&&i<e||r===i+1||n&&e===i&&s)&&u&&o.push({layout:a}),o):[]},i.prototype.wy=function(t,n,e,i){var r,o,a,u,s,c,s,i,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,I,_,D,l,i,I,d,j,h,b,r=this;if(r.Ib&&(R.clearTimeout(r.Ib),r.Ib=F),t&&(o=t.Ab,a=t.my,u=t.zoom(),(s=!E(i))||n!==o||e!==a))if(c=t.parent.options.scrollByPixel,s&&(o=i),t.Ab=n,t.my=e,0<t.My)(o!==n||c&&e!==a)&&t.ki(O.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:n,oldOffset:B(a/u),newOffset:B(e/u)});else{if(s=!1,l=(f=(i=t.options).sheetAreaOffset.left)+2,h=t.kg,v=(d=t.Fi()).Py,m=t.Gy(d),g=d.Uy,p=d.Hy,b=d.zy,w=d.height+i.sheetAreaOffset.top,C=M=y=void 0,T=(S=t.Dn).J(),A=t.Vy,o<n||n===o&&B(e)>B(a)){if(x=I=void 0,I=(N=t.Yy(1))&&0<N.length?N.findCol(n):I){for(x=N[k=N.length-1];x&&x.x+x.width>v+m;)x=N[k-=1];x&&x.col>n&&(s=!0,y=I.x+B(e),M=(h||d).y,C=x.x+x.width-y-l,S.Ey(y,M,C,w,v,M),i.rowHeaderVisible||(t.invalidateLayout(),S.D1(T,new O.Rect(0,M,f+1,w))),t.invalidateLayout(),S.D1(T,new O.Rect(v+C,M,(I=A?m:m+b+g)-C,w)),S.jy(T,new O.Rect(v-2,M,2+(I-=A?0:g),w)),this.Nb(t,M,w))}}else{for(_=0,D=n;D<o&&_<m;D++)_+=t.nn(D);(_+=B(a)-B(e))<m&&(s=!0,y=v,M=(h||d).y,C=m-_,0<t.frozenTrailingColumnCount()&&--C,l=0,!A&&0<g&&(i=L(h.width-(l=b)-1,p-1+_),S.Ey(p-1,M,l+1,w,i,M)),I=A?0:L(_,g)-1,S.Ey(y,M,C+I,w,y+_,M),t.invalidateLayout(),d=t.columnOutlines&&!t.columnOutlines.Oy()?t.columnOutlines.Ry()+f+1:0,S.D1(T,new O.Rect(y-f,M,_+f+d+5,w)),S.jy(T,new O.Rect(v-2,M,j=m+I+l+2,w)),this.Nb(t,M,w))}s||(t.invalidateLayout(),t.repaint()),(o!==n||c&&a!==e)&&t.ki(O.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:n,oldOffset:B(a/u),newOffset:B(e/u)}),(h=t.rt)&&h.By(),b=o===t.Ab&&a!==t.my,s&&Lt(t,b)&&(r.Ib=Bt(t,r))}},i.prototype.Nb=function(t,n,e){var i=t.Dn,r=i.J();this.Zy(t).concat(this.Wy(t)).forEach(function(t){var t=t.layout,t=new O.Rect(t.x,n,t.width,e);i.O1(t),i.jy(r,t)})},i.prototype.Zy=function(t){var n,e,n,i,r,o,e,a,e,n=this,e=t.getSelections();return!(1===e.length&&0<t.frozenColumnCount())||(n=n.kb.options.scrollByPixel,i=t.Ab,r=t.my,o=e[0].col,e=e[0].col+e[0].colCount-1,n&&e==i-1)?[]:(a=[],(o===i+1||o<i&&i<=e||e==i-1||n&&o===i&&0!==r)&&(e=t.Yy(0))&&0<e.length&&a.push({layout:e[e.length-1]}),a)},i.prototype.Wy=function(t){var n,e,n,i,r,e,o,a,u,a,t,s,t,s,n=this,e=t.getSelections();return 1===e.length&&0<t.frozenTrailingColumnCount()?(n=n.kb.options.scrollByPixel,i=t.getViewportRightColumn(1),r=e[0].col,e=e[0].col+e[0].colCount-1,o=[],a=(u=(a=t.Yy(2))&&0<a.length)?a[0]:F,t=(s=(t=t.Yy(1))&&0<t.length)?t.findCol(i):F,s=u&&s&&a.x!==t.x+t.width,(e==i-1||r<=i&&i<e||r===i+1||n&&e===i&&s)&&u&&o.push({layout:a}),o):[]},i.prototype.Mg=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,o,d,d,h,o,d,h,e,h,o,d,s,e,h,s,o,d,l,c,r=this,o=r.kb,a=!1,u=!1,s=o.Xb,c=o.zb,f=o.options.scrollbarShowMax,l=o.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;if(t){if(h=t.name(),n.ctrlKey){if(!o.options.allowUserZoom)return!0;if(o=t.zoom(),d=O.mt.ige(o-.05*e),t.isEditing()&&!t.endEdit())return;if(d={sheet:t,sheetName:t.name(),oldZoomFactor:o,newZoomFactor:d,cancel:!1},t.ki(O.Events.ViewZooming,d),!0===d.cancel)return!1;h={cmd:"zoom",sheetName:h,oldZoomFactor:o,zoomFactor:d.newZoomFactor},t.Qy().execute(h)}else i=i||0,o=t.Tb,d=t.ly,e=(h=r.Jy(t,e)).Ky,h=h.Xy,o!==e||d!==h?(l&&(s.qy(M.ScrollbarState.show),r.$y(!0)),r.yy(t,e,h),t.tw(),f||t.ew()):a=!0,o=t.Ab,d=t.my,e=(s=r.rw(t,i)).iw,h=s.Xy,o===e&&d===h||(l&&(c.qy(M.ScrollbarState.show),r.$y(!1)),r.wy(t,e,h),t.ow(),f)||t.aw();s=t.uw(),o=t.hitTest(n.pageX-s.left,n.pageY-s.top),(l=(d=t.sw)&&d.cellTypeHitInfo)&&(l.cellRect=t.getCellRect(d.row,d.col)),(c=t.rt).cw(o),c.fw(o)}return a&&0===i},i.prototype.hw=function(t,n){var e,i,r,o,a,u,s,c,n,o,o,n,r,f,n,r,e=t.Tb,i=t.ly,r=t.parent,o=t.zoom(),a=it(n*r.options.scrollPixel*o),u=0,n=t.Fi().Cy,o=t.dw(1).findRow(e);if(o)if(a<0){for(s=t.vw(-1),u=-(n-o.y);s<e&&a<=u;)u-=t.Gt(--e);i=u-a,e===s&&0<i&&(i=0)}else if(0<a){for(c=t.mw().Ky,u=o.y+o.height-n;e<c&&u<=a;)u+=t.Gt(++e);i=u-a-(o=t.Gt(e)),r.options.scrollbarMaxAlign?(n=t.Fi(),r=t.frozenRowCount(),f=t.getRowCount()-t.frozenTrailingRowCount()-1,c=(n=t.gw(t.Sy(n),r,f)).Ky,r=n.Xy,c<e?(e=c,i=r):e===c&&B(i)>B(r)&&(i=r)):e<c&&u-a==0?(e++,i=0):e===c&&u-a<0&&(i=-o)}return{Ky:e,Xy:i}},i.prototype.Jy=function(t,n){var e,i,r,r,o,o,n,e=t.Tb,i=t.ly,r=t.parent;return r&&r.options.scrollByPixel?r.ib.hw(t,n):(0<(r=t.frozenRowCount())&&(0===e&&0<n?e=r:n<0&&e===r-n&&(e=0)),-1!==(o=t.vw(e+n,n<0))?e=o:e+=n,o=t.pw(),n=t.mw().Ky,t.getRowCount()-r-t.frozenTrailingRowCount()<=0||o===F?e=t.Tb:(e<o?e=o:n<e&&(e=n),e===F&&(e=-1)),{Ky:e,Xy:i})},i.prototype.bw=function(t,n){var e,i,r,o,a,u,s,c,n,o,o,n,r,f,n,r,e=t.Ab,i=t.my,r=t.parent,o=t.zoom(),a=it(n*r.options.scrollPixel*o),u=0,n=t.Fi().Py,o=t.yw(1).findCol(e);if(o)if(a<0){for(s=t.ww(-1),u=-(n-o.x);s<e&&a<=u;)u-=t.nn(--e);i=u-a,e===s&&0<i&&(i=0)}else if(0<a){for(c=t.Mw().iw,u=o.x+o.width-n;e<c&&u<=a;)u+=t.nn(++e);i=u-a-(o=t.nn(e)),r.options.scrollbarMaxAlign?(n=t.Fi(),r=t.frozenColumnCount(),f=t.getColumnCount()-t.frozenTrailingColumnCount()-1,c=(n=t.Cw(t.Gy(n),r,f)).iw,r=n.Xy,c<e?(e=c,i=r):e===c&&B(i)>B(r)&&(i=r)):e<c&&u-a==0?(e++,i=0):e===c&&u-a<0&&(i=-o)}return{iw:e,Xy:i}},i.prototype.rw=function(t,n){var e,i,r,r,o,o,n,e=t.Ab,i=t.my,r=t.parent;return r&&r.options.scrollByPixel?r.ib.bw(t,n):(0<(r=t.frozenColumnCount())&&(0===e&&0<n?e=r:n<0&&e===r-n&&(e=0)),-1!==(o=t.ww(e+n,n<0))?e=o:e+=n,o=t.Sw(),n=t.Mw().iw,t.getColumnCount()-r-t.frozenTrailingColumnCount()<=0||o===F?e=t.Ab:(e<o?e=o:n<e&&(e=n),e===F&&(e=-1)),{iw:e,Xy:i})},i.prototype.Yb=function(t,n,e){var i,r,o,e,a,i,i=this,r=i.kb,a;(0,O.jf)(r)&&(i=i.$b(t,e),e=t?(o=n.pageY,n.pageX-100):(o=n.pageY-40,n.pageX-30),r.Tw(Q.j0(i),e,o,!0))},i.prototype.$b=function(t,n){var e,i,e=(0,O.jf)(this.kb);return i=e?e.getScrollTooltipContent(t,n):i},i.prototype.Aw=function(t){(0,y.GC$)(t).addClass(S)},i.prototype.Iw=function(t){(0,y.GC$)(t).removeClass(S)},i.prototype.xw=function(t){(0,y.GC$)(t).addClass(T)},i.prototype.Nw=function(t){(0,y.GC$)(t).removeClass(T)},i.prototype.$y=function(t,n){var e,i,r,o,a;void 0===n&&(n=1e3),i=(e=this).kb,r=t?i.kw:i.Dw,a=function(){e.Nw(r),e.Aw(r)},(o=i.options.scrollbarAppearance=M.ScrollbarAppearance.mobile)&&(e._w(t),t?e.Ew=setTimeout(a,n):e.jw=setTimeout(a,n))},i.prototype._w=function(t){var n=this;t&&n.Ew?(clearTimeout(n.Ew),n.Ew=null):!t&&n.jw&&(clearTimeout(n.jw),n.jw=null)},r=i,Rt={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:M.TabStripPosition.bottom,tabStripWidth:80,tabEditable:!0,newTabVisible:!0,allSheetsListVisible:M.AllSheetsListVisibility.auto,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:F,backgroundImageLayout:0,showResizeTip:M.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:M.ShowScrollTip.none,grayAreaBackColor:F,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:M.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,pivotAreaReference:1,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,dynamicReferences:!0,autoFitType:M.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:M.CopyPasteHeaderOptions.allHeaders,calculationMode:M.CalculationMode.auto,allowUserDragMerge:!1,rowResizeMode:M.ResizeMode.normal,columnResizeMode:M.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:M.ScrollbarAppearance.skin,font:F,customList:[],numbersFitMode:M.NumbersFitMode.mask,pasteSkipInvisibleRange:!1,allowAutoExtendFilterRange:!1,allowInvalidFormula:!1,formulaFormatHint:!0,defaultSheetTabStyles:{}},k.prototype.commandManager=function(){return this.Qy},k.prototype.undoManager=function(){return this.Wp},k.prototype.Ow=function(){var t=this.Rw(),n=this.Bw;return n instanceof Array?n.concat(t):t},k.prototype.Rw=function(){var t=et.culture(),n=[],e=[],i=et.Fe(kt).DateTimeFormat,r=et.Fe(t).DateTimeFormat,n=this.Lw(i);return t!==kt&&(e=this.Lw(r)),n.concat(e)},k.prototype.Lw=function(n){var e=[],i,r;return this.Fw=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Fw.forEach(function(t){(i=n[t])instanceof Array&&0<i.length&&(r=-1<t.indexOf("month")||-1<t.indexOf("Month"),i=r?i.slice(0,12):i,e.push(i))}),e},k.prototype.Fp=function(){var t,n,t,n=w&&this.op();n&&n.clearDirties(),this.sheets.forEach(function(t){var n;t.Uw().Gw()})},k.prototype.Ob=function(t,n,e){var i,r,o,a,i=this,r=(0,O.jf)(i),o=i.w2,a=w&&i.op();switch(t){case"allowUndo":i.Wp&&(i.Wp.Hw=n);break;case"backColor":i.Rb=!0,r&&r.zw();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":r&&r.zw();break;case"backgroundImage":case"backgroundImageLayout":i.nb(),r&&r.zw();break;case"newTabVisible":case"allSheetsListVisible":case"tabNavigationVisible":case"tabStripPosition":n!==e&&i.Vw(n);break;case"tabStripWidth":n!==e&&i.Yw(n);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":i.Cg();break;case"tabStripRatio":i.Xg();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":r&&(r.Zw=!0,r.Ww=!0,r.zw());break;case"scrollByPixel":r&&(r.Zw=!0,r.Ww=!0,r.ly=0,r.my=0,r.zw());break;case"scrollPixel":n<=0&&(i.options.scrollPixel=e);break;case"scrollbarAppearance":i.ib&&n!==e&&i.Qw(n);break;case"calcOnDemand":a&&(!n&&a.calcOnDemand&&i.Fp(),a.calcOnDemand=n);break;case"dynamicReferences":a&&(a.dynamicReferences=n);break;case"customList":i.Bw=n;break;case"referenceStyle":case"allowDynamicArray":case"calculationMode":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":i.Kw(t,n),r&&r.zw();break;case"defaultSheetTabStyles":o&&o.repaint()}i.ki(O.Events.WorkbookOptionsChangedInternal,{propertyName:t,value:n})},k.prototype.Qw=function(t){var n,e,e=(t=E(t)?M.ScrollbarAppearance.skin:t)===M.ScrollbarAppearance.mobile;(n=this).Xb.Jw(t),n.zb.Jw(t),n.Xw.Jw(t),n.qw(),e?n.$w():n.tM(),n.refresh()},k.prototype.Vw=function(t){var n=this;E(t)&&(t=M.TabStripPosition.bottom,n.options.tabStripPosition=t),n.nM&&(n.eM(),n.iM(),n.Cg())},k.prototype.Yw=function(t){var n=this;E(t)?n.options.tabStripWidth=t=80:t<80&&(n.options.tabStripWidth=80),n.nM&&(n.iM(),n.Cg())},k.prototype.Kw=function(t,n){var e,i,e,i=w&&this.op();if(i)switch(t){case"referenceStyle":i.useR1C1=1===n;break;case"allowDynamicArray":case"calculationMode":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":i[t]=n}},k.prototype.Hc=function(t,n){var r,e,i,o,e,r=this;for(w&&r.Qp(),r.rM=[],r.oM=c("input"),r.vf=0,r.sg=0,r.aM={fromSheet:F,isCutting:!1},r.uM={fromSheet:F,isCutting:!1},r.sM=F,r.sheets=[],r.mp=[],r.dse=[],r.Hp={},r.Bw=r.options.customList,r.Wp=new J(r,-1,r.options.allowUndo),(e=r.Qy=new K(r)).cM("beforeWorkbookExecute",function(t){r.fM(t)}),e.addListener("workbookUndo",function(t){var n,e,i,i,n=t.command,e=P.Commands.lM(n),i=r.Qy[n.cmd];i&&i.canUndo()&&!e&&!n.hM&&((i=r.getSheetFromName(n.sheetName))&&(n.sheetId=i._id),r.undoManager().dM(n,t.vM)),1!==t.vM&&2!==t.vM||r.mM(t)}),P.Commands.gM(e),k.et(r,"init"),i=0;i<t;i++)o=r.S2(r.T2(i)),r.sheets.push(o),r.dse.push(o),o.E0i=i,o.pM(r);(e=r.sheets[r._2])&&e.isSelected(!0),r.suspendPaint(),n&&r.hg(n),r.bM=new V.yM(r),r.resumePaint()},k.prototype.hitTest=function(t,n,e){var i,r,o,a,u,s,c,s,f,l,c,h,c,c,d,v,c,d,r,v,c,m,g,p,e,b,w,d,r,o,v,c,e,d,r,a,o,v,c,e,i=this,r=i.jg(),o=i.w2,a=i.zb,u=i.Xb,s=(0,y.GC$)(i.getHost()).width(),c=(0,y.GC$)(i.getHost()).height();if(t<0||s<t||n<0||c<n)return F;if(s=i.wM(),f=i.options.scrollbarAppearance===M.ScrollbarAppearance.mobile){if(c=Wt(a,l=(0,y.GC$)(i.Dw).offset(),s,t,n))return c;if(c=Qt(u,h=(0,y.GC$)(i.kw).offset(),s,t,n))return c}if(r&&(c=r.uw(),d=r.ot(),v=c.left-s.left,c=c.top-s.top,v<t)&&t<d.width+v&&c<n&&n<d.height+c)return{worksheetHitInfo:r.hitTest(t-v,n-c,!1,e),x:t,y:n};if(d=(0,y.GC$)(o.Dg()).offset(),r=o.ot(),v=d.left-s.left,c=d.top-s.top,v<t&&t<r.width+v&&c<n&&n<r.height+c){switch(g={},p=(m=o.hitTest(t-v,n-c)).index,b=(e=i.e2(p))&&e.name(),w=F,e&&$t(e._gi)&&(w=e._gi),m.type){case"navButton":g={navButton:m.element};break;case"sheetTab":g={sheetTab:{sheetName:b||m.element,sheetIndex:p}},w!==F&&(g.sheetTab.sheetType=w);break;case"resize":g={resize:!0};break;default:g={blank:!0}}return{tabStripHitInfo:g,x:t,y:n}}return d=(0,y.GC$)(a.oy()).offset(),r=a._b(),o=d.left-s.left,v=d.top-s.top,o<t&&t<r.width+o&&v<n&&n<r.height+v?{horizontalScrollBarHitInfo:{element:a.hitTest(t-o,n-v).element},x:t,y:n}:(c=(0,y.GC$)(u.oy()).offset(),e=u._b(),d=c.left-s.left,r=c.top-s.top,d<t&&t<e.width+d&&r<n&&n<e.height+r?{verticalScrollBarHitInfo:{element:u.hitTest(t-d,n-r).element},x:t,y:n}:(a=(0,y.GC$)(i.MM).offset(),o=parseInt(i.MM.style.width.substr(0,i.MM.style.width.indexOf("px")),10),v=parseInt(i.MM.style.height.substr(0,i.MM.style.height.indexOf("px")),10),c=a.left-s.left,e=a.top-s.top,c<t&&t<o+c&&e<n&&n<v+e?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:n}:void 0))},k.prototype.wM=function(){var t=this,t,t=(A||y.GC$)(t.Ti).offset();return t?(t.top+=f.body.clientTop||0,t.left+=f.body.clientLeft||0):t={top:0,left:0},t},k.prototype.Zp=function(t){var e,t,e=this.options,t=t||{};t=q(!0,{},Rt,t),X(t,function(t,n){e.hasOwnProperty(t)&&(e[t]=n)})},k.prototype.j2=function(){var t=this;return!t.sM&&t.Ti&&(t.sM=c(l),(0,y.GC$)(t.sM).css({position:"relative",left:0,top:0,height:0}).attr(x,"gcLayerContainer"),(0,y.GC$)(t.Ti).prepend(t.sM)),t.sM},k.prototype.T2=function(t){var n,e,i,r,o,a,u,s,n=this,e=n.getSheetCount();n.Kp<e?n.Kp=e:n.Kp++,(E(t)||t<n.Kp)&&(t=n.Kp),i=!1,o=n.qv();do{for(r=(N().SHEET_NAME||"Sheet")+(t+1),a=o.length,u=0;u<a;u++)if(s=o[u]){if(s.name().toUpperCase()===r.toUpperCase()){t++,i=!0;break}i=i&&!1}}while(i);return r},k.prototype.S2=function(t,n){var e={name:t,type:n,sheet:null};return k.et(this,"createSheet",e,function(){return e.sheet!==F}),e.sheet||new v.Worksheet(t)},k.prototype.setHost=function(t){this.hg(t)},k.prototype.hg=function(t){var n=this;t&&(n.Ti=t,n.CM(),n.nl(),n.SM(),n.TM(),n.AM(),n.IM(),n.xM(),n.NM(),n.kM(),n.DM(),n._M(),n.$w(),n.EM(),n.jM(),n.OM(),n.BM(),n.iM(),n.Cg(),n.LM(t),k.et(n,"setHost",t))},k.prototype.CM=function(){var t,n,t=this,n=t.Ti;A&&A(n).data(I,t),(0,y.GC$)(n).data(I,t).attr(x,"gcSpread").addClass(It).css(Nt,xt)},k.prototype.nl=function(){R.gcGlobal.nl()},k.prototype.SM=function(){var t=this;t.cultureChangedHandler=function(){t.FM()},f.addEventListener(At,t.cultureChangedHandler)},k.prototype.TM=function(){var t=this;t.PM(),t.GM(),t.HM()},k.prototype.GM=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Ti,e=c(vt),i=e.style;for(e.cellSpacing="0px",e.cellPadding="0px",e.border="0",i.width=mt,i.height=mt,i.border="0",i.margin="0",i.borderCollapse="collapse",i.float="left",r=0;r<3;r++){for(o=c("tr"),a=0;a<2;a++)(s=(u=c("td")).style).padding="0",s.border="0",o.appendChild(u);e.appendChild(o)}n.appendChild(e),t.nM=e},k.prototype.PM=function(){var t,n,e,i,t=this,n=t.Ti,e=c(l),i=e.style;i.width="0",i.height="0",i.float="left",n.appendChild(e),t.zM=e},k.prototype.HM=function(){var t,n,e,i,t=this,n=t.Ti,e=c(l),i=e.style;i.width="0",i.height="0",i.float="left",n.appendChild(e),t.VM=e},k.prototype.AM=function(){var t,n,e,i,r,t=this,n=t.Ti,e,i=t.nM.rows[1].cells[0],r=c(l);r.id=n.id+"vp",(0,y.GC$)(i).append(r),t.Kg=r},k.prototype.IM=function(){var t,n,e,i,r,i,r,r,i,o,t=this,n,e=t.nM.rows[1].cells[1],i=t.options,r=i.scrollByPixel,i=i.scrollbarAppearance,r=r?M.ScrollType.pixels:M.ScrollType.continuous,r=new u.YM(!1,F,F,F,F,F,r,i,function(){t.ZM(!0)}),i=c(l),o=r.oy();(0,y.GC$)(i).append(o),t.Xb=r,t.kw=i,t.WM=e},k.prototype.QM=function(){var i,t,i=this,t=i.Xb.oy();(0,y.GC$)(t).bind(ct+e,function(t,n){var e=n.scrollEventType;t.data=i,n.scrollOrientation===u.ScrollOrientation.verticalScroll&&(e===M.Zi.smallDecrement||e===M.Zi.smallIncrement||e===M.Zi.largeDecrement||e===M.Zi.largeIncrement||e===M.Zi.thumbTrack?r.Zb(t,n):e===M.Zi.thumbPosition&&r.Qb(t))}).bind(at+e,function(t){t.data=i,r.Jb(t)}).bind(st+e,function(t){t.data=i,r.ey(t)}).bind(ut+e,function(t){t.data=i,t.scrollbar=i.Xb,r.ry(t)})},k.prototype.xM=function(){var t,n,e,i,r,o,a,u,s,t=this,n,e=t.nM.rows[2].cells[0],i=c(vt),r=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",r.border="0",r.margin="0",(0,y.GC$)(i).css("user-select",p),o=c("tr"),a=0;a<2;a++)(s=(u=c("td")).style).padding="0",s.border="0",o.appendChild(u);i.appendChild(o),(0,y.GC$)(e).append(i),t.JM=i},k.prototype.NM=function(){var t,n,e,i,t=this,n=t.Ti,e=c(l),i=e.style;i.width=t.Jg()*(0,y.GC$)(n).width()+d,i.height=t.Zv()+d,i.fontSize="10pt",i.fontFamily="Arial",t.XM=e},k.prototype.kM=function(){var t,n,e,i,r,i,r,r,o,a,o,r,t=this,n,e=t.JM.rows[0].cells[1],i=t.options,r=i.scrollByPixel,i=i.scrollbarAppearance,r=r?M.ScrollType.pixels:M.ScrollType.continuous,r=new u.YM(!0,F,F,F,F,F,r,i,function(){t.ZM(!1)}),o=r.oy(),a=c(l);(0,y.GC$)(a).append(o),t.zb=r,r=(o=new u.YM(!0,F,F,F,F,F,M.ScrollType.pixels,i,function(){t.ZM(!1)})).oy(),(0,y.GC$)(a).append(r),t.Xw=o,t.Dw=a,t.qM=e},k.prototype.$M=function(){var i,t,i=this,t=i.zb.oy();(0,y.GC$)(t).bind(ct+e,function(t,n){var e=n.scrollEventType;t.data=i,n.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(e===M.Zi.smallDecrement||e===M.Zi.smallIncrement||e===M.Zi.largeDecrement||e===M.Zi.largeIncrement||e===M.Zi.thumbTrack?r.Bb(t,n):e===M.Zi.thumbPosition&&i.iy())}).bind(at+e,function(t){t.data=i,r.Ub(t)}).bind(st+e,function(t){t.data=i,r.ey(t)}).bind(ut+e,function(t){t.data=i,t.scrollbar=i.zb,r.ry(t)})},k.prototype.tC=function(){var i,t,i=this,t=i.Xw.oy();(0,y.GC$)(t).bind(ct+e,function(t,n){var e=n.scrollEventType;t.data=i,n.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(e===M.Zi.smallDecrement||e===M.Zi.smallIncrement||e===M.Zi.largeDecrement||e===M.Zi.largeIncrement||e===M.Zi.thumbTrack?r.qb(t,n):e===M.Zi.thumbPosition&&r.Pb(t))}).bind(at+e,function(t){t.data=i,r.Ub(t,!0)}).bind(st+e,function(t){t.data=i,r.ey(t)}).bind(ut+e,function(t){t.data=i,t.scrollbar=i.Xw,r.ry(t)})},k.prototype.DM=function(){var t=this;t.nC(),t.eC()},k.prototype.nC=function(){var t,n,e,i,t=this,n,e=t.nM.rows[0].cells[1],i=c(l);(0,y.GC$)(e).append(i),t.iC=i},k.prototype.eC=function(){var t,n,e,i,t=this,n,e=t.nM.rows[2].cells[1],i=c(l);(0,y.GC$)(e).append(i),t.MM=i},k.prototype.EM=function(){var t=this;t.ib=new r(t)},k.prototype._M=function(){var t=this;t.QM(),t.$M(),t.tC()},k.prototype.$w=function(){var t,n,e,i,r,o,t=this,n,e;t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile&&(i=t.Ti,r=t.kw,o=t.Dw,(0,y.GC$)(r).bind(a,function(){t.Xb.qy(M.ScrollbarState.active)}).bind(s,function(){t.Xb.qy(M.ScrollbarState.inactive)}),(0,y.GC$)(o).bind(a,function(){t.zb.qy(M.ScrollbarState.active),t.Xw.qy(M.ScrollbarState.active)}).bind(s,function(){t.zb.qy(M.ScrollbarState.inactive),t.Xw.qy(M.ScrollbarState.inactive)}),(0,y.GC$)(i).bind(a,t.oC).bind(s,t.aC))},k.prototype.tM=function(){var t,n,e,t=this,n=t.kw,e=t.Dw;n&&((0,y.GC$)(n).unbind(a).unbind(s),t.ib._w(!0)),e&&((0,y.GC$)(e).unbind(a).unbind(s),t.ib._w(!1)),(0,y.GC$)(t.Ti).unbind(a,t.oC).bind(s,t.aC)},k.prototype.oC=function(){(0,y.GC$)(this).find("."+b).addClass(Tt)},k.prototype.aC=function(){(0,y.GC$)(this).find("."+b).removeClass(Tt)},k.prototype.jM=function(){var t=this;t.eM(),t.qw()},k.prototype.uC=function(){var t,n,e,t,i,r,t,t=this,n=t.w2,e=t.options.tabStripPosition,t=t.options.tabStripVisible,i=0,r=0;return n&&t&&(t=n.ot(),e===M.TabStripPosition.top?r=t.height:e===M.TabStripPosition.left&&(i=t.width)),{left:i,top:r}},k.prototype.sC=function(){var t,n,t,t=this,n=t.j2(),t=t.uC();(0,y.GC$)(n).css({left:t.left,top:t.top})},k.prototype.qw=function(){var t,n,e,i,r,o,a,e,t=this,n=t.Ti;t.ib&&(e=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,i=t.WM,r=t.qM,o=t.kw,a=t.Dw,(0,y.GC$)(o).removeAttr("style"),(0,y.GC$)(a).removeAttr("style"),(0,y.GC$)(a).addClass("gc-clear-float"),e?(e=t.j2(),o.style.position="absolute",o.style.top="0px",o.style.left="0px",(0,y.GC$)(o).addClass(b+" "+St),(0,y.GC$)(e).append(o),a.style.position="absolute",a.style.top="0px",a.style.left="0px",(0,y.GC$)(a).addClass(b+" "+Ct),(0,y.GC$)(e).append(a)):((0,y.GC$)(i).append(o),(0,y.GC$)(r).append(a),(0,y.GC$)(o).removeClass(b+" "+S+" "+St+" "+T),(0,y.GC$)(a).removeClass(b+" "+S+" "+Ct+" "+T),(0,y.GC$)(n).css("position","auto")))},k.prototype.eM=function(){var t,n,e,i,r,o,a,t,u,t=this,n=t.nM,e=t.zM,i=t.VM,r=t.JM,o=t.XM,a=t.options.tabStripPosition,t=t.options.tabStripVisible;a===M.TabStripPosition.bottom?u=r.rows[0].cells[0]:a===M.TabStripPosition.top?u=n.rows[0].cells[0]:a===M.TabStripPosition.left?u=e:a===M.TabStripPosition.right&&(u=i),a!==M.TabStripPosition.bottom&&a!==M.TabStripPosition.top&&t?n.style.tableLayout="fixed":n.style.tableLayout="",(0,y.GC$)(u).append(o)},k.prototype.LM=function(t){var n,e,i,r,n=this,e="tabindex",i=C((0,y.GC$)(t).attr(e),10)||0,r=c(l);(0,y.GC$)(r).css({position:bt,overflow:"hidden"}).attr(x,"gcSheetFocusElementForTab").attr(e,i).bind(lt,function(){n.fC||(0,O.jf)(n).Zg(),n.fC=!1}),t.insertBefore(r,F),n.lC=r},k.prototype.OM=function(){var t,n,t=this,n=function(){t.hC()};(0,y.GC$)(R).bind(ft+m,n),t.dC=n},k.prototype.BM=function(){var t,n,t=this,n=(0,O.jf)(t);n&&n.hg(t.Kg)},k.prototype.vC=function(){var t=this,n=t.lC;n&&(t.fC=!0,n.focus())},k.prototype.mC=function(){var t,n,e,i,r,o,t=this.getActiveSheet();if(t)if(O.hi.A1(t)){if(e=this.Ti)for(i=document.activeElement,r=document.body,o=i;o;){if(o===e){n=i;break}if(o===r)break;o=o.parentElement}}else t.fg&&(n=t.fg);return n},k.prototype.n2=function(r){var o=this;o.Q1e(),o.gC=R.setTimeout(function(){var t,n,e,i,t=o.mC();t&&(n=t.getAttribute(x),E(r)||"gcWorksheetCanvas"===n||"gcSheetClipboard"===n||t.setAttribute("aria-label",r),e=(0,O.jf)(o),i=!(e&&e.rt&&e.rt.w_(e)),O.mt.Qf())&&i&&(e&&!e.isEditing()&&(t.textContent=""),o.vC(),setTimeout(function(){e=(0,O.jf)(o),(i=!(e&&e.rt&&e.rt.w_(e)))&&t.focus()},50)),R.clearTimeout(o.gC),o.gC=F},50)},k.prototype.Q1e=function(){var t=this;t.gC&&(R.clearTimeout(t.gC),t.gC=F)},k.prototype.L0=function(){var t,n,e,i,r,o,a,u,n,n,s,e,i,t=this,n=t.zb,e=t.Xb,i=t.Xw,o=t.sheets,a=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;for(t.zp(),O.Bf.ih(t),O.mt.L0(),t.dC&&(0,y.GC$)(R).unbind(ft+m,t.dC),t.dC=F,t.pC&&clearTimeout(t.pC),n&&n.dispose(),e&&e.dispose(),i&&i.dispose(),t.bC(),t.iy(),O.hi.ai()===t.getActiveSheet()&&O.hi.F1(F),r=0;r<o.length;r++)o[r].L0(!0);for(o.splice(0,o.length),u=t.mp,r=0;r<u.length;r++)u[r].L0(!0);u.splice(0,u.length),t.dse.splice(0,t.dse.length),(n=t.bM)&&(n.L0(),t.bM=F),e="class",i="unselectable",(n=t.Ti)&&(s=(0,y.GC$)(n),f.removeEventListener(At,t.cultureChangedHandler),s.html("").removeAttr(x).removeClass(It),s.attr(e)||s.removeAttr(e),s.attr(i)||s.removeAttr(i),s.data(I)&&s.data(I,F),A)&&A(n).data(I)&&A(n).data(I,F),a&&t.tM(),t.Dw=F,t.kw=F,t.Wp&&(t.Wp.L0(),t.Wp=F),t.sheetTabStyles&&(t.sheetTabStyles.L0(),t.sheetTabStyles=F),t.w2&&(t.w2.L0(),t.w2=F),k.et(t,"dispose"),t.lC&&((0,y.GC$)(t.lC).unbind(lt),t.lC=F),t.Lp&&(t.Lp.dispose(),t.Lp=F,t.yC=F,t.wC=F),t.MC&&(t.MC.L0(),t.MC=F),H.W.L0(),t.Qy&&(t.Qy.L0(),t.Qy=F),t.ib&&(t.ib.L0(),t.ib=F),t.v2&&(t.v2.dispose(),t.v2=F)},k.prototype.bC=function(){var t,n,e,i,r,o,a,u,t=this,n=t.sheets;for((0,y.GC$)(t.oM).unbind(m),e=0;e<n.length;e++)(i=n[e]).bC();for(o=0,a=r=t.mp;o<a.length;o++)(u=a[o]).bC();t.rM&&(t.rM.length=0)},k.prototype.zp=function(){var t,n,e,i,r,t=this,n=t.CC;if(n)for(e=0,i=n;e<i.length;e++)(r=i[e]).close&&r.close();t.CC=[]},k.prototype.iM=function(){var t,n,e,t=this,n=C(O.I.fl("").zIndex),e=n!==t.SC;e&&t.TC(n),t.AC(e),t.IC(),t.xC()},k.prototype.TC=function(t){this.SC=t},k.prototype.AC=function(t){var n,e,i,e,r,n=this,e=n.Ti,i=n.SC,e=e.getAttribute("id")+"_tabStrip",r=n.w2;r&&!t?(r.mg(),r.repaint()):(r&&r.L0(),r=new(2007<i?G.Gv:U.Jm)(e),(n.w2=r).Sg(n),r.hg(n.XM))},k.prototype.IC=function(){var t,n,e,i,r,t=this,n=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,e=t.Zv(),i=t.Xm(),r=t.NC();n?t.kC():(zt(t.kw,r,i),Yt(t.Dw,e,i))},k.prototype.xC=function(){var t=this;Zt(t.MM),Zt(t.iC)},k.prototype.hC=function(){var t=this,n=t.pC;n&&clearTimeout(n),t.pC=R.setTimeout(function(){O.Bf.rh(),t.Cg(),t.pC=F},100)},k.prototype.Cg=function(){var t=this;t.Eb||(t.Eb=!0,t.DC(),t.Eb=!1)},k.prototype.DC=function(){var t,n,t=this,n;t.Ti&&(t._C(),t.EC(),t.jC(),t.OC(),t.RC(),t.BC(),t.LC(),t.PC(),t.GC(),t.UC(),t.HC(),t.sC(),t.zC())},k.prototype._C=function(){var t,n,n,e,i,r,i,e,t,o,e,t=this,n=t.zM;n&&(n=n.style,i=(e=t.options).tabStripVisible,r=e.tabStripPosition,i=i?e.tabStripWidth:0,e=t.Ti,t=(0,y.GC$)(e).height(),e=r===M.TabStripPosition.left?(o=i,t):o=0,n.width=o+d,n.height=e+d)},k.prototype.EC=function(){var t,n,n,e,i,r,e,o,i,a,t=this,n=t.nM;n&&(n=n.style,i=(e=t.options).tabStripVisible,r=e.tabStripPosition,e=e.tabStripWidth,o=(0,y.GC$)(t.Ti).width(),i=!i||r!==M.TabStripPosition.left&&r!==M.TabStripPosition.right?o+d:(a=rt(qt(t.Ti)))-e+d,n.width=i)},k.prototype.OC=function(){var t,n,n,e,i,r,i,e,t,o,e,t=this,n=t.VM;n&&(n=n.style,i=(e=t.options).tabStripVisible,r=e.tabStripPosition,i=i?e.tabStripWidth:0,e=t.Ti,t=(0,y.GC$)(e).height(),e=r===M.TabStripPosition.right?(o=i,t):o=0,n.width=o+d,n.height=e+d)},k.prototype.jC=function(){var t,n,e,i,i,r,e,o,a,t,u,s,c,f,l,t,c,h,n,r,t=this,n=t.Ti,e=(0,y.GC$)(n),i=t.Kg;i&&(i=i.style,r=e.width(),e=e.height(),o=t.NC(),a=t.Zv(),u=(t=t.options).showVerticalScrollbar,s=t.showHorizontalScrollbar,c=t.scrollbarAppearance,f=t.tabStripVisible,l=t.tabStripPosition,t=f?t.tabStripWidth:0,c=c===M.ScrollbarAppearance.mobile,n=(h=l===M.TabStripPosition.left||l===M.TabStripPosition.right)?rt(qt(n)):r,u&&!c&&(n-=o),h&&(n-=t),r=e,l===M.TabStripPosition.top?(s&&!c&&(r-=a),f&&(r-=a)):(s&&!c||f&&l===M.TabStripPosition.bottom)&&(r-=a),r<2&&(r=2),i.width=n+d,i.height=r+d)},k.prototype.RC=function(t){var n,e,e,i,e,i,r,o,a,u,s,c,f,l,a,c,h,d,v,m,m,g,n,e,o,n=this,e=n.Ti,e=(0,y.GC$)(e),i=n.Kg;i&&(E(t)&&(t=e.width()),e=(0,y.GC$)(i).height(),i=n.zb,r=n.Xw,o=n.Xb,u=(a=n.options).showVerticalScrollbar,s=a.showHorizontalScrollbar,c=a.scrollbarAppearance,f=a.tabStripVisible,l=a.tabStripPosition,a=f?a.tabStripWidth:0,c=c===M.ScrollbarAppearance.mobile,h=n.Xm(),d=n.NC(),v=n.VC(),m=(m=(0,O.jf)(n))?m.getHDockScrollbarWidth():0,u?((0,y.GC$)(n.kw).show(),(0,y.GC$)(o.oy()).show()):((0,y.GC$)(n.kw).hide(),(0,y.GC$)(o.oy()).hide()),s?((0,y.GC$)(n.Dw).show(),(0,y.GC$)(i.oy()).show(),(0,y.GC$)(r.oy()).show()):((0,y.GC$)(n.Dw).hide(),(0,y.GC$)(i.oy()).hide(),(0,y.GC$)(r.oy()).hide()),0===m?(0,y.GC$)(r.oy()).hide():(0,y.GC$)(r.oy()).show(),n=e,o.YC(h),o.ZC(n),e=t-m,l!==M.TabStripPosition.left&&l!==M.TabStripPosition.right||(e-=a),f&&!c&&l===M.TabStripPosition.bottom&&(e-=v),u&&!c&&(e-=d),o=h,s||f||l!==M.TabStripPosition.bottom||(o=0),i.YC(e=e<=0?1:e),i.ZC(o),r.YC(m),r.ZC(o))},k.prototype.VC=function(){var t,n,e,i,r,e,o,n,a,u,t=this,n=t.Kg,e=t.options,i=e.tabStripPosition,r=e.tabStripWidth,e=e.scrollbarAppearance,o=(0,O.jf)(t),n=(0,y.GC$)(n).width();return i===M.TabStripPosition.bottom||i===M.TabStripPosition.top?(o&&i===M.TabStripPosition.bottom&&e===M.ScrollbarAppearance.skin&&(n-=u=o.getHDockScrollbarWidth()),a=it(t.Jg()*n),i===M.TabStripPosition.bottom&&a===n&&(a=n-1)):a=r,a},k.prototype.BC=function(){var t,n,n,e,e,i,r,i,o,t,i,t=this,n=t.Ti,n=(0,y.GC$)(n).height(),e=t.XM;e&&(e=e.style,r=(i=t.options).tabStripVisible,i=i.tabStripPosition,o=t.Zv(),t=t.VC(),i=i===M.TabStripPosition.bottom||i===M.TabStripPosition.top?o:n,r||(i=0),e.width=t+d,e.height=i+d)},k.prototype.LC=function(){var t,n,e,i,r,o,a,u,i,s,t,c,f,c,l,t=this,n=t.iC,e=t.MM,i=t.options,r=i.showVerticalScrollbar,o=i.showHorizontalScrollbar,a=i.tabStripVisible,u=i.tabStripPosition,i=i.scrollbarAppearance===M.ScrollbarAppearance.mobile,s=t.NC(),t=t.Zv(),f=u===M.TabStripPosition.top?(c=r&&!i?s:0,a?t:0):c=0;(0,y.GC$)(n).css("width",c+d),(0,y.GC$)(n).css("height",f+d),c=r&&!i?s:0,(o||a&&u===M.TabStripPosition.bottom)&&(l=t,!i||a&&u===M.TabStripPosition.bottom)||(l=0),(0,y.GC$)(e).css("width",c+d),(0,y.GC$)(e).css("height",l+d)},k.prototype.PC=function(){var t,n,e,i,e,t,t=this;t.Kg&&(n=t.nM,i=(e=t.options).scrollbarAppearance===M.ScrollbarAppearance.mobile,e=e.showVerticalScrollbar,t=[(0,y.GC$)(t.Kg).width(),t.NC()],!i&&e||(t[1]=0),n.rows[0].cells[0].style.width=t[0]+d,n.rows[0].cells[1].style.width=t[1]+d)},k.prototype.UC=function(){var t,n,e,t=this,n,e=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;e&&t.kC(),t.WC(),t.QC(),e&&(t.Xb.qy(M.ScrollbarState.hide),t.zb.qy(M.ScrollbarState.hide))},k.prototype.HC=function(){var t,n,e,t=this,n,e;t.options.tabStripVisible?(0,y.GC$)(t.XM).show():(0,y.GC$)(t.XM).hide(),t.w2&&t.w2.Cg()},k.prototype.GC=function(t){var n,e,t;void 0===t&&(t=!0),(e=(0,O.jf)(n=this))?(0===e.Tb&&(e.Tb=e.pw()),0===e.Ab&&(e.Ab=e.Sw()),t&&e.Cg()):(t=n.getActiveSheetTab())&&t.Cg()},k.prototype.zC=function(){var t,n,e,t=this,n=(0,O.jf)(t);n&&(n.invalidateLayout(),n.repaint()),(e=t.KC())&&!t.JC&&(t.JC=!0,setTimeout(function(){delete t.JC,t.DC()},1))},k.prototype.KC=function(){var t,n,e,i,n,e,r,o,a,u,o,a,u,u,o,a,n,s,c,t=this,n=(0,y.GC$)(t.Ti),e=n.width(),i=2,n=n.width(),e=e!==n&&2<B(e-n),r=!1,o=t.zM,a=t.VM,u=t.nM;return o&&a&&u&&(o=(0,y.GC$)(o).width(),a=(0,y.GC$)(a).width(),u=(0,y.GC$)(u).width(),r=2<B(o+u+a-n)),o=t.Xw,a=(u=!1,O.jf)(t),o&&a&&(n=a.getDockScrollbarAttachedIndex(),E(n)||(s=o.YC())!==(c=a.getHDockScrollbarWidth())&&(u=!0)),e||r||u},k.prototype.kC=function(){var t,n,e,i,r,o,a,n,u,s,c,f,l,s,c,e,h,o,f,n,c,o,d,v,m,a,l,s,h,g,p,b,t=this;!E(t.Ti)&&(n=(0,y.GC$)(t.Ti),e=(0,O.jf)(t))&&(i=(0,y.GC$)(t.kw),r=(0,y.GC$)(t.Dw),o=e.Fi(),a=n.width(),n=n.height(),u=2,c=(s=t.options).tabStripVisible,f=s.showVerticalScrollbar,l=s.tabStripPosition,s=c?s.tabStripWidth:0,c=c?t.Zv():0,e=e.getHDockScrollbarWidth(),h=o.x+o.XC,o=o.y+o.qC,f=f?i.width():0,n=n-o,l!==M.TabStripPosition.bottom&&l!==M.TabStripPosition.top||(n-=c),c=0,l!==M.TabStripPosition.right&&l!==M.TabStripPosition.left||(c+=s),o=o,m=n-(d=C(i.css("padding-top")))-(v=C(i.css("padding-bottom"))),a=a-h,0===e&&(a-=f),l!==M.TabStripPosition.left&&l!==M.TabStripPosition.right||(a-=s),l=r.height(),s=-(n+o),h=h,b=a-(g=C(r.css("padding-left")))-(p=C(r.css("padding-right")))-e,0===e?b-=2:e-=f+p+2,t.Xb.YC(f),t.Xb.ZC(m),t.zb.YC(b),t.zb.ZC(l),t.Xw.YC(e),t.Xw.ZC(l),i.css(["height","left","right","top"],[n,"auto",c,o]),r.css(["width","top","bottom","left"],[a,"auto",s,h]))},k.prototype.WC=function(){var t=this,n=t.jg(),e=t.options;n?(n.WC(e.scrollbarMaxAlign,e.scrollbarShowMax,t.zb),n.$C(t.Xw)):t.zb&&t.zb.w4()},k.prototype.QC=function(){var t=this,n=t.jg(),e=t.options;n&&n.QC(e.scrollbarMaxAlign,e.scrollbarShowMax,t.Xb)},k.prototype.Xg=function(){var t,n,e,t=this,n;t.Ti&&(e=t.t3(),t.BC(),t.RC(e),t.GC(!1),t.UC(),t.HC())},k.prototype.t3=function(){var t,n,e,i,t=this.Ti,n=t.parentNode;return e=n&&"flex"===(i=n.style.display||getComputedStyle(n).display)?(0,y.GC$)(t).width():e},k.prototype.suspendPaint=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.w2,e=t.sheets,i=t.mp;for(t.sg++,r=0,o=e;r<o.length;r++)(a=o[r]).suspendPaint();for(u=0,s=i;u<s.length;u++)(c=s[u]).suspendPaint();n&&n.V2()},k.prototype.resumePaint=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.w2,e=t.sheets,i=t.mp;for(t.sg-=0<t.sg?1:0,r=0,o=e;r<o.length;r++)(a=o[r]).resumePaint();for(u=0,s=i;u<s.length;u++)(c=s[u]).resumePaint();n&&n.Y2()},k.prototype.UCe=function(){var t=this,n=t.getActiveSheet();try{n&&(n.My--,n.n3(),n.repaint(),n.My++),t.w2&&(t.w2.sg--,t.w2.repaint(),t.w2.sg++)}catch(t){}},k.prototype.isPaintSuspended=function(){return 0<this.sg},k.prototype.nb=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.options.backgroundImage,e=t.options.backgroundImageLayout,i=(0,O.jf)(t);if(i&&n&&((r=(o=void 0,y.GC$)(i.Dg())).css({"background-image":"url('"+n+"')","background-repeat":"no-repeat"}),!E(e))){o=(o=t.MC)||(t.MC=new j.Wh(function(){t.MC&&t.nb()}));try{o.getState(n)?(a=o.getImage(n),s=(u=i.ot()).width,c=u.height,O.mt.Wf(i.Dg(),s,c,a.width,a.height,e)):o.addImage(n)}catch(t){}}},k.prototype.e3=function(t){var n,t,t,n=this,t=t.name(),t=n.getSheetPosition(t);n.w2.g2(t)},k.prototype.startSheetIndex=function(t){var n=this,e=n.w2;return 0===arguments.length?e?e.om:0:(e&&(e.k2(t)||-1===(t=e.N2(t))&&(t=e.Vm(t)),e.om=t),n.Xg(),n)},k.prototype.Jg=function(){var t,n,e,i,e,i,n,t,n,t=this,n=t.options,e=t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,i=n.tabStripPosition;return n.showHorizontalScrollbar&&!e&&i===M.TabStripPosition.bottom?(e=n.tabStripRatio,isNaN(e)?.5:(i=0,n=t.Kg,t=t.w2,n&&t&&(n=(0,y.GC$)(n).width(),i=t.rm()/n),e<i?e=i:1<e&&(e=1),e)):1},k.prototype.destroy=function(){this.dC&&(0,y.GC$)(R).unbind(ft+m,this.dC),this.L0()},k.prototype.repaint=function(){var t,n,n,t=this,n=t.w2;n&&n.repaint(),(n=(0,O.jf)(t))&&n.repaint()},k.prototype.refresh=function(){var t=this;t.Ti&&(O.I.dl(),t.r3(),t.iM(),t.Cg(),t.repaint())},k.prototype.getHost=function(){return this.Ti},k.prototype.invalidateLayout=function(){var t=(0,O.jf)(this);t&&t.invalidateLayout()},k.prototype.addNamedStyle=function(t){this.$p(t);var t=(0,O.jf)(this);t&&t.zw()},k.prototype.$p=function(t){if(t){if(!t.name)throw new Error(N().Exp_EmptyNamedStyle);var n=t.name.toUpperCase();this.Hp[n]=t,this.r3()}},k.prototype.getNamedStyle=function(t){return this.i3(t,!0)},k.prototype.i3=function(t,n){var e,e,e=this.Hp;return e&&t?((e=e[t=t.toUpperCase()])&&n&&this.r3(),e):F},k.prototype.r3=function(){for(var t,n,e,i,t,n=0,e=this.sheets;n<e.length;n++)(i=e[n]).r3()},k.prototype.removeNamedStyle=function(t){var n,e,e,n=this.Hp;n&&t&&(t=t.toUpperCase(),n.hasOwnProperty(t))&&((e=n[t].formatter)&&"string"==typeof e&&this.bp[e]&&this.o3(e),delete n[t],this.r3(),e=(0,O.jf)(this))&&e.zw()},k.prototype.getNamedStyles=function(){var e=[],t=this.Hp;return t&&X(t,function(t,n){e.push(n)}),e},k.prototype.getActiveSheet=function(){return this.sheets&&0<this.sheets.length?this.sheets[this._2]:F},k.prototype.getActiveSheetTab=function(){return this.mp&&0<this.mp.length?this.mp[this.jb]:F},k.prototype.setActiveSheet=function(t){var n,e,n=this.getActiveSheet(),e=this.getActiveSheetTab();this.vb(t,2),this.a3(n),this.u3(e)},k.prototype.setActiveSheetTab=function(t){var n,e,n=this.getActiveSheet(),e=this.getActiveSheetTab();"number"==typeof t?this.yp(t,2):"string"==typeof t&&this.s3(t,2),this.a3(n),this.u3(e)},k.prototype.vb=function(t,n,e,i){for(var r,o,r=this.sheets,o=0;o<r.length;o++)if(r[o].name()===t){this.tb(o,n,e,i);break}},k.prototype.s3=function(t,n,e,i){for(var r,o,r=this.mp,o=0;o<r.length;o++)if(r[o].name()===t){this.yp(o,n,e,i);break}},k.prototype.getActiveSheetIndex=function(){return this._2},k.prototype.getActiveSheetTabIndex=function(){return this.jb},k.prototype.setActiveSheetIndex=function(t){var n,e,e,i,n=this,e=n.getSheetCount();(t=e<=t?e-1:t)<0&&(t=0),e=n.getActiveSheet(),i=n.getActiveSheetTab(),n.tb(t,2),n.a3(e),n.u3(i)},k.prototype.tb=function(t,n,e,i,r){var o,a,r,u,u,s,c,c,f,c;typeof t==ot&&t!==(o=this)._2&&((a=o.sheets[t])&&a.visible()===M.SheetTabVisible.visible||r)&&!(((r=O.mt.pi()).ipad||r.iphone)&&(u=o.c3)&&(new Date).valueOf()-u<300)&&(s=(s=u=o.getActiveSheet())||(c=o.getActiveSheetTab())&&c.Mf,Ut(o,c={oldSheet:s,newSheet:a,needTriggerSheetChange:!0}),f={oldSheet:s,newSheet:a,cancel:!1},(c=c.needTriggerSheetChange&&i)&&Gt(o,f),!1===f.cancel&&(o._2=t,o.f3(),a!==u&&(u&&(u.L0(!1),u.charts)&&u.charts.all().forEach(function(t){t.clearflexDVs()}),a)&&o.l3(a,n,!1,c,e),o.Cg(),Ht(o,s,a),c)&&Pt(o,s,a),r.ipad||r.iphone)&&(o.c3=(new Date).valueOf())},k.prototype.yp=function(t,n,e,i){var r,o,a,u,s,s,c,f,l,f;typeof t==ot&&t!==(r=this).jb&&(o=r.mp[t])&&o.visible()===M.SheetTabVisible.visible&&(a=o.Mf,((u=O.mt.pi()).ipad||u.iphone)&&(s=r.c3)&&(new Date).valueOf()-s<300||(c=(s=r.getActiveSheetTab())?s.Mf:r.getActiveSheet(),Ut(r,f={oldSheet:c,newSheet:a,needTriggerSheetChange:!0}),l={oldSheet:c,newSheet:a,cancel:!1},(f=f.needTriggerSheetChange&&i)&&Gt(r,l),!1===l.cancel&&(r.f3(),r.jb=t,r.h3(),o!==s&&(s&&s.L0(!1),r.d3(o,n,!1,f,e),o.b2(!0)),r.Cg(),Ht(r,c,a),f)&&Pt(r,c,a),(u.ipad||u.iphone)&&(r.c3=(new Date).valueOf())))},k.prototype.l3=function(t,n,e,i,r){var e,e,e;e||t.hg(this.Kg),e=(e=O.hi.ai())&&e.parent===this,e=2===n?e:1===n,O.hi.F1(F),!this.Bp&&e&&t.Zg(r),t.aw(),t.tw()},k.prototype.d3=function(t,n,e,i,r){var e,e,e;e||t.hg(this.Kg),e=(e=O.hi.ai())&&e.parent===this,e=2===n?e:1===n,O.hi.F1(F),!this.Bp&&e&&t.Zg(r),t.aw(),t.tw()},k.prototype.a3=function(t){var n=this.getActiveSheet();t&&t.b2(!1,!1),n&&n.b2(!0,!1)},k.prototype.u3=function(t){var n=this.getActiveSheetTab();t&&t.b2(!1,!1),n&&n.b2(!0,!1)},k.prototype.addSheet=function(t,n){var e,i,e=this.getActiveSheet(),i=this.getActiveSheetTab();this.A2(t,2,n),this.a3(e),this.u3(i)},k.prototype.addSheetTab=function(t,n,e){var i,r,n,i=this.getActiveSheet(),r=this.getActiveSheetTab(),n=this.bb(n,e);if(n)return this.suspendPaint(),this.yb(t,2,n),this.a3(i),this.u3(r),this.resumePaint(),n},k.prototype.J2e=function(t,n){var e,i,e=this.getActiveSheet(),i=this.getActiveSheetTab();if(n)return this.suspendPaint(),this.yb(t,2,n),this.a3(e),this.u3(i),this.resumePaint(),n},k.prototype.gse=function(t,n,e){for(var i,r,o,i=t.length,r=[],o=0;o<e&&0<i;o++)r.push(t.pop());for(t.push(n);0<r.length;)t.push(r.pop())},k.prototype.pse=function(t,n,e){for(var i,r,o,a,u,s,i=t.length,r=[],o=0,a=n instanceof v.Worksheet;o<e&&0<i;)u=t[t.length-1]instanceof v.Worksheet,(a&&u||!a&&!u)&&o++,r.push(t.pop());for(t.push(n),n.E0i=t.length-1;0<r.length;)s=r.pop(),t.push(s),s.E0i=t.length-1},k.prototype.bse=function(t,n){for(var e,i,r,e=0;e<t.length;e++)if(t[e].name()===n){for(i=e;i<t.length-1;i++)(r=t[i+1]).E0i--,t[i]=r;t.length=t.length-1;break}},k.prototype.A2=function(t,n,e,i){var r,o,i,a,u,s,c,t,r=this;if(e=e||r.S2(r.T2(t),i),a=(i=r.sheets).length,e.name()){for(u=r.qv(),o=0;o<u.length;o++)if(u[o].name()===e.name())throw N().Exp_NotSupported}else e.ub(r.T2(t));r.v3(e),s=r.getActiveSheet(),c=r._2,r.gse(i,e,a-t),e.pM(r),r.pse(r.dse,e,a-t),r.f3(),1===(a=i.length)?(r.Kg&&e.hg(r.Kg),r._2=0):(c<0&&r.w2&&(c=r.w2.N2(c)),r._2=c),(t=r.getActiveSheet())!==s&&(s&&s.L0(!1),t&&r.l3(t,n,1===a,!0),r.Cg()),r.w2&&(r.w2.om<0&&(r.w2.om=r._2),r.w2.repaint())},k.prototype.yb=function(t,n,e){var i,r,o,a,u,s,c,o;if(e){for(a=(o=(i=this).mp).length,u=i.qv(),r=0;r<u.length;r++)if(u[r].name()===e.name())throw N().Exp_NotSupported;i.v3(e),s=i.getActiveSheetTab(),c=i.jb,i.gse(o,e,a-t),e.pM(i),i.pse(i.dse,e,a-t),1===(a=o.length)?(i.Kg&&e.hg(i.Kg),i.jb=0):(c<0&&i.w2&&(c=i.w2.N2(c)),i.jb=t<=c?c+1:c),i.h3(),(o=i.getActiveSheetTab())!==s&&(s&&s.L0(!1),o&&i.d3(o,n,1===a,!0),i.Cg()),i.w2&&(i.w2.om<0&&(i.w2.om=i.jb),i.w2.repaint())}},k.prototype.removeSheet=function(t){var n,t,n=this.getActiveSheet();this.m3(t,2),(t=this.getActiveSheet())&&t!==n&&t.b2(!0,!1)},k.prototype.removeSheetTab=function(t){var n,t;"string"==typeof t&&(t=this.getSheetTabIndex(t)),n=this.getActiveSheetTab(),this.g3(t,2),(t=this.getActiveSheet())&&t!==n&&t.b2(!0,!1)},k.prototype.m3=function(t,n){var t,e,i,r,o,a,u,s,c,f,l,s,u,h,d,v,m,g,p,b,n,c,s,n,e=this,i=e.sheets,r=e.Lp,o=e.w2,a=i.length;if(isNaN(t)||t<0||a<=t)throw new Error(N().Exp_IndexOutOfRange);if(u=e._2,s=t<=e._2||t===a-1,c=e.getActiveSheet(),t<e._2&&e._2--,(f=i[t]).bC(),i.splice(t,1),e.bse(e.dse,f.name()),0===(a=i.length))e._2=-1;else if(e._2>=a&&o)e._2=o.Vm(a);else{for(l=void 0,l=Math.max(0,e._2);l<a;l++)if(i[l].visible()===M.SheetTabVisible.visible){e._2=l;break}a<=l&&o&&(e._2=o.Vm(a))}if(e.f3(),(s||u!==e._2)&&c!==(s=i[e._2])&&(c&&c.L0(!1),s)&&(Ut(e,c),e.l3(s,n,!1,!0),Ht(e,c,s)),r){if(r.suspend(),f.b3().p3(),h=(u=nn(f)).map(function(t){return t.id}),d={},v=r.y3)for(g in m=f.b3().getSource().id,v)if(v.hasOwnProperty(g))for(d[g]=[],p=v[g];p;)m!==(b=p.w3&&p.w3.getSource().id)&&-1===h.indexOf(b)&&d[g].push(p),p=p.C3;for(g in(n=f.Uw()).S3=t,r.removeSource(n),c=f.T3,r.removeSource(c),s=f.A3,r.removeSource(s),u.forEach(function(t){r.removeSource(t)}),d)if(d.hasOwnProperty(g))for(p=d[g],l=0;l<p.length;l++)r.I3(p[l],parseInt(g,10));r.resume(!1)}null!=(t=e.sheetTabStyles)&&t.O2e[f.name()]&&e.sheetTabStyles.L2e(f.name()),f.L0(!0,-1!==e._2),w&&!r.x3&&e.sheets&&0<e.sheets.length&&(n=e.sheets[0],r.initParserContext(n.Uw())),o&&(o.om>=a?e.startSheetIndex(o.Vm(a)):o.om<0?e.startSheetIndex(o.N2(-1)):e.Cg())},k.prototype.g3=function(t,n){var e,i,r,o,a,u,s,c,f,l,s,u,c,e=this,i=e.mp,r=e.Lp,o=e.w2,a=i.length;if(isNaN(t)||t<0||a<=t)throw new Error(N().Exp_IndexOutOfRange);if(u=e.jb,s=t<=e.jb||t===a-1,c=e.getActiveSheetTab(),t<e.jb&&e.jb--,(f=i[t]).bC(),i.splice(t,1),e.bse(e.dse,f.name()),0===(a=i.length))e.jb=-1;else if(e.jb>=a)e.jb=o.Vm(a);else{for(l=void 0,l=Math.max(0,e.jb);l<a;l++)if(i[l].visible()===M.SheetTabVisible.visible){e.jb=l;break}a<=l&&(e.jb=o.Vm(a))}e.h3(),(s||u!==e.jb)&&c!==(s=i[e.jb])&&(c&&c.L0(!1),s)&&e.d3(s,n,!1,!0),r&&(r.suspend(),(c=(u=f.Mf).Uw())&&(c.S3=t),[c,u.T3,u.A3,u.Dnn].forEach(function(t){t&&r.removeSource(t)}),r.resume(!1)),e.sheetTabStyles&&e.sheetTabStyles[f.name()]&&e.sheetTabStyles.L2e(f.name()),f.L0(!0,-1!==e.jb),o&&(o.om>=a?e.startSheetIndex(o.Vm(a)):o.om<0?e.startSheetIndex(o.N2(-1)):e.Cg())},k.prototype.clearSheets=function(){for(var t,n,e,i,r,o,a,t=this,n=t.sheets,e=t.Lp,i=t.w2,r=0,o=n;r<o.length;r++)(a=o[r]).bC(),a.L0(!0);n.splice(0,n.length),t.dse=t.yse(t.mp),e&&e.clearSource(),t._2=-1,i&&(i.om=-1,i.repaint())},k.prototype.clearSheetTabs=function(){for(var t,n,e,i,r,o,t=this,n=t.mp,e=t.w2,i=0,r=n;i<r.length;i++)(o=r[i]).bC(),o.L0(!0);n.splice(0,n.length),t.dse=t.yse(t.sheets),t.jb=-1,e&&(e.om=-1,e.repaint())},k.prototype.getSheet=function(t){var n=this.sheets;return 0<=t&&t<n.length?n[t]:F},k.prototype.getSheetTab=function(t){return this.Ofe(t)},k.prototype.Ofe=function(t){var n,e,i,r,n=this.mp;if("number"==typeof t)return 0<=t&&t<n.length?n[t]:F;if("string"==typeof t)for(e=0,i=n;e<i.length;e++)if((r=i[e]).name()===t)return r;return F},k.prototype.getSheetFromName=function(t){return this._f(t)},k.prototype._f=function(t){for(var n,e,i,r,n,e=0,i=this.sheets;e<i.length;e++)if((r=i[e]).name()===t)return r;return F},k.prototype.getSheetIndex=function(t){for(var n,e,n=this.sheets,e=0;e<n.length;e++)if(n[e].name()===t)return e;return F},k.prototype.getSheetTabIndex=function(t){for(var n,e,n=this.mp,e=0;e<n.length;e++)if(n[e].name()===t)return e;return F},k.prototype.getSheetPosition=function(t){for(var n,e,n=this.dse,e=0;e<n.length;e++)if(n[e].name()===t)return e;return-1},k.prototype.getSheetCount=function(){return this.sheets.length},k.prototype.getSheetTabCount=function(){return this.mp.length},k.prototype.setSheetCount=function(t){var n,e,i,n=this,e=n.getActiveSheet(),i=n.getActiveSheetTab();n.Xp(t,2),n.a3(e),n.u3(i)},k.prototype.Xp=function(t,n){var e,i,r,o,a,u,s,e=this,i="object"==typeof t,r=i?Object.keys(t).length:t,o=i?Object.keys(t):null;if(r<0)throw N().Exp_ArgumentOutOfRange;if(0===r&&e.clearSheets(),r<(a=e.sheets.length))for(u=a-1;r<=u;u--)e.m3(u,n);else if(a<r)for(u=a;u<r;u++)s=i?t[o[u]].type:F,e.A2(u,n,null,s)},k.prototype.hp=function(t,n){var e,i,r,o,t,a,u,s,c,f,l,h,d,v,m,g,e=this,i=t.sheetTabCount;if(nt(i)){if(i<0)throw N().Exp_ArgumentOutOfRange;if(0===i)e.clearSheetTabs();else{for(r=t.sheetTabs,o=t.sheetCount,t=e.mp.length,a=[],u=0,s=Object.keys(r);u<s.length;u++)(f=r[c=s[u]])&&(l=f.index-o,a.splice(l,0,f));if(i<t)for(h=t-1;i<=h;h--)e.g3(h,n);for(h=0;h<a.length;h++)d=e.mp[h],v="number"==typeof(f=a[h]).sheetType?f.sheetType:M.SheetType.tableSheet,m=o+h,d?(g=d._gi)!==v&&(e.g3(m,n),d=e.bb(F,v),e.yb(m,n,d)):(d=e.bb(F,v),e.yb(m,n,d))}}},k.prototype.bb=function(t,n){var e={name:t,type:n,sheetTab:F};return k.et(this,"createSheetTab",e,function(){return e.sheetTab!==F}),e.sheetTab},k.prototype.dataManager=function(){var t=this,n=t.N3;return n=!n&&Z.DataManager?t.N3=new Z.DataManager(F,t.Lp):n},k.prototype.setDataManager=function(t){this.N3=t},k.prototype.bind=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.sheets;for(i.rM&&i.rM.push({type:t,data:n,fn:e}),(0,y.GC$)(i.oM).bind(t+m,n,e),o=0,a=r;o<a.length;o++)(u=a[o]).bind(t,n,e);for(c=0,f=s=i.mp;c<f.length;c++)(l=f[c]).bind(t,n,e)},k.prototype.unbind=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.sheets,r=e.rM;if(r)for(o=r.length-1;0<=o;o--)(a=r[o]).type!==t&&!e.k3(a.type,t)||r.splice(o,1);for((0,y.GC$)(e.oM).unbind(t+m,n),u=0,s=i;u<s.length;u++)(c=s[u]).unbind(t,n);for(l=0,h=f=e.mp;l<h.length;l++)(d=h[l]).unbind(t,n)},k.prototype.k3=function(t,n){return 0===n.indexOf(".")&&t.substring(t.length-n.length)===n},k.prototype.unbindAll=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for((t.rM.length=0,y.GC$)(t.oM).unbind(m),e=0,i=n;e<i.length;e++)(r=i[e]).unbindAll();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).unbindAll()},k.prototype.D3=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.sheets;for(i.rM.push({type:t,data:n,fn:e}),(0,y.GC$)(i.oM).bind(t+ht,n,e),o=0,a=r;o<a.length;o++)(u=a[o]).D3(t,n,e);for(c=0,f=s=i.mp;c<f.length;c++)(l=f[c]).D3(t,n,e)},k.prototype._3=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.sheets,r=e.rM,o=0;o<r.length;o++)(a=r[o]).type!==t&&!e.k3(a.type,t)||r.splice(o,1);for((0,y.GC$)(e.oM).unbind(t+ht,n),u=0,s=i;u<s.length;u++)(c=s[u])._3(t,n);for(l=0,h=f=e.mp;l<h.length;l++)(d=h[l])._3(t,n)},k.prototype.E3=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for((t.rM.length=0,y.GC$)(t.oM).unbind(ht),e=0,i=n;e<i.length;e++)(r=i[e]).E3();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).E3()},k.prototype.ki=function(t,n){0===this.vf&&(0,y.GC$)(this.oM).trigger(t,n)},k.prototype.pb=function(t,n){(0,y.GC$)(this.oM).trigger(t,n)},k.prototype.j3=function(t,n,e,i){this.ki(O.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:n,col:e,sheetArea:i})},k.prototype.v3=function(t){for(var n,e,i,r,n,e=0,i=this.rM;e<i.length;e++)r=i[e],t.bind(r.type,r.data,r.fn)},k.prototype.suspendEvent=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for(t.vf++,e=0,i=n;e<i.length;e++)(r=i[e]).suspendEvent();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).suspendEvent()},k.prototype.resumeEvent=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.sheets;for(t.vf--,t.vf<0&&(t.vf=0),e=0,i=n;e<i.length;e++)(r=i[e]).resumeEvent();for(a=0,u=o=t.mp;a<u.length;a++)(s=u[a]).resumeEvent()},k.prototype.focus=function(t){var t,t;!1===t?O.hi.F1(F):(t=this.getActiveSheet())?t.Zg():(t=this.getActiveSheetTab())&&t.Zg()},k.prototype.Xm=function(){return 2007<this.SC?15:18},k.prototype.NC=function(){return 2007<this.SC?22:this.Xm()},k.prototype.ZM=function(t){var n,e,i,r,o,a,n=this,e=t?n.kw:n.Dw,i=t?n.Xb:n.zb,r=n.options.scrollbarAppearance===M.ScrollbarAppearance.mobile;if(e&&i&&r)switch(o=n.ib,a=i.O3){case M.ScrollbarState.hide:o.$y(t);break;case M.ScrollbarState.show:o.Iw(e),o._w(t);break;case M.ScrollbarState.active:o.Iw(e),o._w(t),o.xw(e);break;case M.ScrollbarState.inactive:o.Nw(e),o.$y(t)}},k.prototype.Zv=function(){return 2007<this.SC?28:this.Xm()},k.prototype.Tw=function(t,n,e,i,r){var o,a,u,s,o="auto",a=this;a.R3||(u=(0,y.getHostMaxZIndex)(a.Ti)+1,s=c(l),r?(0,y.GC$)(s).addClass(r):(0,y.GC$)(s).addClass("gc-spread-toolTip"),(0,y.GC$)(s).addClass("ui-state-default ui-widget-content btn-default").css({position:bt,padding:"0px 3px 0px 3px",font:tt("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":u,top:0}).width(o).height(o).appendTo(f.body),a.R3=s),a.ny(t,n,e,i)},k.prototype.ny=function(t,n,e,i){var r,o,r,r,t,i,o,i,r=this,o=r.jg();o&&(r=r.R3)&&(r=(0,y.GC$)(r),t?(r.html(t),r.show()):r.hide(),t=o.uw(),i&&(e-=t.top,n-=t.left),o=(i=o.ot()).x+i.width-r.outerWidth(),i=i.y+i.height-r.outerHeight(),o<0?n=0:i<0?e=0:(e=L(e,i),n=L(n,o)),E(e)||r.css("top",e+t.top),E(n)||r.css("left",n+t.left))},k.prototype.iy=function(){var t=this,n=t.R3;n&&((0,y.GC$)(n).remove(),t.R3=F)},k.prototype.FM=function(){var t,n,e,i,r,t=this,n=t.qv();for(O.Be.zl(),t.invalidateLayout(),e=0,i=n.length;e<i;e++)(r=n[e]).FM();N(),o.Common.B3(),Y&&z.sR(),t.repaint(),k.et(t,"onCultureChanged")},k.prototype.getTab=function(){return this.w2},k.prototype.changeSheetIndex=function(t,n){var e,i,r,o,o,t,e=this,i=e.getSheetPosition(t),r=e.getTab(),o=e.getSheetCount()+e.getSheetTabCount();return!("number"!=typeof n||-1===i||i===n||n<0||o<=n||n%1!=0||e.L3(t)||((o=e.jg().name())!==t?(e.suspendPaint(),e.setActiveSheetOrSheetTabIndex(i,2),e.o2(i,n),t=e.getSheetPosition(o),e.setActiveSheetOrSheetTabIndex(t,2),e.resumePaint()):(e.o2(i,n),r.scrollTabToActive(i,n)),0))},k.prototype.changeSheetPosition=function(t,n){var e,i,r,o,o,t,e=this,i=e.getSheetPosition(t),r=e.getTab(),o=e.getSheetCount()+e.getSheetTabCount();return!("number"!=typeof n||-1===i||i===n||n<0||o<=n||n%1!=0||e.L3(t)||((o=e.jg().name())!==t?(e.suspendPaint(),e.setActiveSheetOrSheetTabIndex(i,2),e._se(i,n),t=e.getSheetPosition(o),e.setActiveSheetOrSheetTabIndex(t,2),e.resumePaint()):(e._se(i,n),r.scrollTabToActive(i,n)),0))},k.prototype.L3=function(t){for(var n,e,i,r,o,a,u,s,c,n=this,e,i=0,r=n.sheets;i<r.length;i++)if((o=r[i]).name()===t)return!1;for(u=0,s=a=n.mp;u<s.length;u++)if((c=s[u]).name()===t)return!1;return!0},k.prototype.o2=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=-1,r=e.qv(),a=r[t],u=e.sheets.length;if(tn(e)){if(n<t)if(u<=t&&n<u)r.splice(t,1),r.splice(u,0,a),i=u;else{for(o=t;n<o;o--)r[o]=r[o-1];r[n]=a,i=n}else if(t<n)if(t<u&&u<=n)r.splice(u,0,a),r.splice(t,1),i=u-1;else{for(o=t;o<n;o++)r[o]=r[o+1];r[n]=a,i=n}}else if(s=e.getSheetTabCount(),l=void(f=c=0),h=E(a._gi),0<=t&&t<u&&0<=n&&n<u||u<=t&&t<u+s&&u<=n&&n<u+s){for(o=0;o<r.length;o++)if(d=r[o],E(d._gi)?c++:f++,h&&c-1===n||!h&&f-1===n){l=o;break}if(l<t){for(o=t;l<o;o--)r[o]=r[o-1];r[l]=a,i=l}else if(t<l){for(o=t;o<l;o++)r[o]=r[o+1];r[l]=a,i=l}}e.P3(r),e.setActiveSheetOrSheetTabIndex(i,2)},k.prototype._se=function(t,n){var e,i,r,o,a,e=this,i=-1,r=e.qv(),a=r[t];if(n<t){for(o=t;n<o;o--)r[o]=r[o-1];r[n]=a,i=n}else if(t<n){for(o=t;o<n;o++)r[o]=r[o+1];r[n]=a,i=n}e.P3(r),e.setActiveSheetOrSheetTabIndex(i,2)},k.prototype.F3=function(t,n){t?this.setActiveSheetTab(n):this.setActiveSheet(n)},k.prototype.setActiveSheetOrSheetTab=function(t){var n=this.getSheetIndex(t),e=!1;E(n)&&(n=this.getSheetTabIndex(t),e=!0),E(n)||this.F3(e,t)},k.prototype.isFocus=function(){var t=O.hi.ai();return t&&t.getParent&&t.getParent()===this},k.prototype.clone=function(t,n,e,i){var r,t,o,a,u,s,c,f,l,h,d,r=this,t=r.Gm(t);if(E(i)&&(i=!0),!(E(t)||E(e)||r.Gm(e))&&(o=t instanceof v.Worksheet,r.suspendPaint(),r.suspendCalcService(),t.canClone)){if(a=JSON.stringify(t.toJSON({newWorkSheetName:e})),n<0&&(n=0),o?((u=r.S2(e)).Uw().G3=!0,r.addSheet(n,u)):((u=r.bb(e,t._gi)).Mf&&(u.Mf.Uw().G3=!0),r.yb(n,2,u)),r.getSheetPosition(e)!==n&&r.changeSheetPosition(e,n),u.fromJSON(JSON.parse(a)),r.setActiveSheetOrSheetTab(u.name()),o){for(c=t.tables.U3,f=u.tables.U3,l=void 0,h=0;h<c.length;h++)c[h].H3&&i&&(s=c[h].z3(),f[h].V3(s)),l=f[h].range(),u.Q1i&&u.Q1i(l.row,l.col,l.rowCount,l.colCount,M.SheetArea.viewport);(s=t.H3._dataSource)&&i&&(d=u.H3).bind(s)}else(s=t.Mf&&t.Mf.H3._dataSource)&&i&&(d=u.Mf.H3).bind(s);return r.resumeCalcService(!1),r.resumePaint(),u}},k.prototype.fM=function(t){var n,e,t,n,i,t,n=this,e=t.command;0!==t.vM&&e.hM||(t=e.sheetName?(0,O._f)(n,e.sheetName):(0,O.jf)(n))&&(n=t.getActiveRowIndex(),i=t.getActiveColumnIndex(),t=t.getSelections(),e.Z3={W3:t,K3:{row:n,col:i}})},k.prototype.mM=function(t){var n,t,e,i,r,t,o,a,e,u,s,c,f,l,h,n=this,t=t.command,e=t.Z3,i=(0,O.jf)(n),r;if((i&&i.name())!==t.sheetName&&((0,O.Ef)(n,t.sheetName),i=(0,O.jf)(n)),!E(e)&&i){if(i.suspendPaint(),t=e.K3,o=e.W3,a=e.J3,e=e.X3,E(t)||i.t4(t.row,t.col),!E(o))if(1===(u=o.length))i.setSelection(o[0].row,o[0].col,o[0].rowCount,o[0].colCount);else for(s=0;s<u;s++)c=o[s].row,f=o[s].col,l=o[s].rowCount,h=o[s].colCount,i.n4(c,f,l,h);if(k.et(n,"onCommandExecuting",i),!E(a)){for(s=0;s<a.length;s++)a[s].isSelected&&a[s].isSelected(!0);e||i.e4()}i.showCell(t.row,t.col,3,3),i.resumePaint()}},k.prototype.changeSelectionInCommandExecuting=function(t,n,e,i,r){var t,o;t&&t.Z3&&(o=(t=t.Z3).K3,E(o)||(E(n)||(o.row=n),E(e))||(o.col=e),E(i)||(t.W3=i),E(r)||(t.J3=r))},k.prototype.h3=function(){var t=this.getActiveSheet();t&&(t.L0(!1),t.b2(!1,!1)),this._2=-1},k.prototype.f3=function(){var t=this.getActiveSheetTab();t&&(t.L0(!1),t.b2(!1,!1)),this.jb=-1},k.prototype.yse=function(t){for(var n,e,i,n=[],e=0;e<t.length;e++)n[(i=t[e]).E0i=e]=i;return n},k.prototype.vse=function(t,n){for(var e,i,e=[],i=0;i<t.length;i++)e.push(t[i]);for(i=0;i<n.length;i++)e.push(n[i]);for(e.sort(function(t,n){return t.E0i-n.E0i}),i=0;i<e.length;i++)e[i].E0i=i;return e},k.prototype.qv=function(){var t=this;return t.sheets.length+t.mp.length!==t.dse.length&&(t.dse=[].concat(t.sheets).concat(t.mp)),t.dse},k.prototype.P3=function(t){var n,e,i,r,o,a,u,s,c,n=this,r=n.getActiveSheet(),o=n.getActiveSheetTab();for(r?e=r.name():o&&(i=o.name()),n.sheets.length=0,n.mp.length=0,a=n.sheets,u=n.mp,s=0;s<t.length;s++)(c=t[s]).E0i=s,(c instanceof v.Worksheet?a:u).push(c);e?n._2=n.getSheetIndex(e):i&&(n.jb=n.getSheetTabIndex(i)),n.dse=t},k.prototype.Gm=function(t){return this._f(t)||this.Ofe(t)},k.prototype.e2=function(t){return this.qv()[t]},k.prototype.getActiveSheetOrSheetTab=function(){return this.jg()},k.prototype.jg=function(){return this.getActiveSheet()||this.getActiveSheetTab()},k.prototype.I2=function(t,n,e,i){var t=this.e2(t);t&&(t instanceof v.Worksheet?this.vb(t.name(),n,e,i):this.s3(t.name(),n,e,i))},k.prototype.setActiveSheetOrSheetTabIndex=function(t,n,e,i){var r,o,r=this.getActiveSheet(),o=this.getActiveSheetTab();this.I2(t,E(n)?2:n,e,i),this.a3(r),this.u3(o)},k.prototype.getActiveSheetOrSheetTabIndex=function(){return this.ep()},k.prototype.ep=function(){var t=this.jg();return t?t.E0i:-1},k.prototype.i4=function(){var n=[].concat(this.sheets);return this.mp.forEach(function(t){t.Mf&&n.push(t.Mf)}),n},k.prototype.r4=function(){for(var t,n,e,i,r,o,t,n=this.sheets,e=n.length,i=[],r=0;r<e;r++)(o=n[r])&&i.push(o.name());return i},k.prototype.Ese=function(t){var n=this.getSheetIndex(t);return n=E(n)?this.getSheetTabIndex(t):n},k.Pp=Rt,k.Jp=1,k.Gp=0,D.Workbook=n=k,(0,O.$e)(n),n.prototype.nextControl=t("nextControl",F),n.prototype.previousControl=t("previousControl",F)},"./dist/core/workbook/workbookpanelex.js":function(g,t,n){"use strict";var O,e,i,E,n,f,p,w,y,X,i,a,M,R,C,q,$,tt,nt,et,it,rt,ot,at,ut,st,S,ct,ft,lt,F,L,s,ht,B,dt,P,vt,mt,G,U,H,V,gt,z,pt,Y,bt,Z,W,Q,wt,r,T,o,A,I,x,u,J,K,c,b,N,l,k,h,_,e,h;function d(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function v(t,n,e,i,r,o,a,u,s){this.updateStateFn=s;var s=this;s.o4=u,s.a4=!1,s.u4=!1,s.s4=p,s.c4=p,s.f4=300,s.l4=70,s.h4=t,s.qy(E.ScrollbarState.show),s.YC("number"==typeof n?n:0),s.ZC("number"==typeof e?e:0),s.d4("number"==typeof i?i:0),s.v4("number"==typeof r?r:0),s.m4("number"==typeof o?o:0),s.g4="number"==typeof a?a:1,s.p4=!1,s.b4=0,s.y4=s.m4(),s.w4()}function yt(t,n){var t=t.get(0);t&&(t.style[n]="")}function m(t,n){var e=this;e.C4=!0,e.S4=!0,e.T4=18,e.A4=t&&(0,O.GC$)(t),e.I4=n&&(0,O.GC$)(n),e.w4(!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.x4=t.YM=t.ScrollOrientation=void 0,O=n("./dist/core/util/domUtil.js"),e=n("./dist/core/util/common.js"),i=n("Common"),E=n("./dist/core/core.enum.js"),n=n("./dist/core/workbook/sheettabbase.js"),f=i.Common.lt.ht,p=null,w=e.mt.Tt,y=e.mt.vi,X=e.mt.En,i=e.mt.p0,a=document,M=window,R=Math.round,C=Math.ceil,q="gc-scroll-container",$="gc-scroll-corner-all",tt="gc-scroll-arrow",nt="gc-scrollbar-wrapper",et="gc-scroll-bar",it="gc-scroll-arrowUp",rt="gc-scroll-arrowDown",ot="gc-scroll-arrowLeft",at="gc-scroll-arrowRight",ut="gc-scroll-mobile-track",st="gc-scroll-mobile-thumb",S="gc-scroll-mobile-state-active",ct="gc-scrollbar-vertical",ft="gc-scrollbar-horizontal",lt="gc-no-user-select",F="width",L="height",s="gc-scrollbar-stateActive ui-state-active",ht="float",B="left",dt="right",P="top",vt="bottom",mt="margin-left",G="position",U="border",H="padding",V="margin",gt="overflow",z="display",pt="outline",Y="100%",bt="borderWidth",Z="boxSizing",W="absolute",Q="relative",wt="margin-top",T="mousedown"+(r=".gcScrollbar"),o="mouseup"+r,A="mousemove"+r,I="mouseover"+r,x="mouseout"+r,u="mousewheel",J="inline-block",K="content-box",c="DOMMouseScroll",b="scroll"+r,N="scrollbar",(h=l=t.ScrollOrientation||(t.ScrollOrientation={}))[h.horizontalScroll=0]="horizontalScroll",h[h.verticalScroll=1]="verticalScroll",v.prototype.oy=function(){return this.N4},v.prototype.qy=function(t){t===E.ScrollbarState.inactive&&this.a4||(this.O3=t,this.updateStateFn&&this.updateStateFn())},v.prototype.value=function(t){var n,t,n=this;return 0===arguments.length?n.y4:("number"==typeof t&&t<=n.v4()&&t>=n.m4()&&(t=((n.y4=t)-n.m4())*n.k4,n.scrollTo(t,!0)),n)},v.prototype.w4=function(){var n,t,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x;function N(){n.N4=X("div"),n.D4=(0,O.GC$)(n.N4),n.D4.css([G,B,P,gt,pt,H,V],[Q,0,0,"hidden","none",0,0]).addClass(q+" "+$+" "+u+" "),n.h4&&n.D4.css(ht,B)}function k(t){n._4=O.GC$.En("div",[G,z,bt,H,V,Z],[W,J,"1px",0,0,K],tt+" "+w,t),n.E4=O.GC$.En("span",[z,U,H,V],["block","none",0,0],m+" "+y,n._4)}function _(t){n.j4=O.GC$.En("div",[G,z,Z,U,H,V],[W,J,K,"none",0,0],nt+" "+nt,t)}function D(t){n.O4=O.GC$.En("div",[],[],lt+" "+M+" "+et,t),n.R4=O.GC$.En("span",[z,U,H,V],["block","none",0,0],p+" "+C,n.O4)}function j(t){n.B4=O.GC$.En("div",[G,z,bt,H,V,Z],[W,J,"1px",0,0,K],tt+" "+S,t),n.L4=O.GC$.En("span",[z,U,H,V],["block","none",0,0],g+" "+T,n.B4)}e=t=0,i=!1,a=(o=(r=(n=this).o4)===E.ScrollbarAppearance.mobile)?0:2,u="ui-widget ui-corner-all",s=n.ZC(),c=n.YC(),h=f=o?0:s,d=B,v=dt,m=ot,g=at,p=ft,b=mt,w="ui-button ui-state-default ui-corner-bl btn btn-default",y="ui-icon ui-icon-triangle-1-w",M="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",C="ui-icon ui-icon-grip-solid-vertical",S="ui-button ui-state-default ui-corner-br btn btn-default",T="ui-icon ui-icon-triangle-1-e",n.F4=l=c-2*f,n.h4||(l=f=o?0:c,d=P,v=vt,m=it,g=rt,p=ct,b=wt,w="ui-button ui-state-default ui-corner-tr btn btn-default",y="ui-icon ui-icon-triangle-1-n",M="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",C="ui-icon ui-icon-grip-solid-horizontal",S="ui-button ui-state-default ui-corner-br btn btn-default",T="ui-icon ui-icon-triangle-1-s",n.F4=h=s-2*f),A=n.F4,I=n.v4()-n.m4(),n.P4=n.d4()*A/(I+n.d4()),n.P4>A&&(n.P4=A),n.P4<10&&(n.P4=10),x=n.P4,n.k4=0==I?1:(A-x)/I,e=n.h4?(t=x,f):(t=f,x),n.D4||(i=!0,N()),o?n.D4.addClass(ut):n.D4.removeClass(ut),n._4||k(n.D4),n.j4||_(n.D4),n.O4?n.O4.removeAttr("style"):D(n.j4),o?n.O4.css(G,W).addClass(st):n.O4.css([G,bt,H,V,Z],[W,"1px",0,0,K]).removeClass(st),n.B4||j(n.D4),o?(yt(n.D4,U),yt(n.D4,V),n.h4?(n.D4.css([F,L],[c,Y]),n.j4.css([d,F,L],[f,Y,Y]),n.O4.css([d,F,L],[n.b4,R(t-a),Y])):(n.D4.css([F,L,V],[Y,Y,0]),n.j4.css([d,F,L],[f,Y,Y]),n.O4.css([d,F,L],[n.b4,Y,R(e-a)])),n.R4.remove(),n._4.remove(),n.B4.remove()):(n.D4.css([F,L,U],[c,s,"none"]),n.j4.css([d,F,L],[f,l,h]),n.O4.css([d,F,L],[n.b4,R(t-a),R(e-a)]),n._4.css([d,F,L],[0,f-a,f-a]),n.E4.css([F,L],[Y,Y]),n.B4.css([v,F,L],[0,f-a,f-a]),n.L4.css([F,L],[Y,Y]),n.R4.css([F,L,b],[f-a,f-a,Math.floor((n.P4-f)/2)]),n.O4.append(n.R4),n.D4.append(n._4),n.D4.append(n.B4)),i&&n.G4()},v.prototype.G4=function(){var r=this;function t(t,n){t.bind(T,function(t){r.U4(t,n)}).bind(o,function(t){r.H4(t,n)}).bind(I,function(t){r.z4(t,n)}).bind(x,function(t){r.V4(t,n)})}t(r._4,!0),t(r.B4,!1),r.O4.bind(T,function(t){r.Y4(t)}).bind(A,function(t){r.Z4(t)}).bind(o,function(t){r.W4(t)}).bind(I,function(t){r.K4(t)}).bind(x,function(t){r.J4(t)}),r.j4.bind(T,function(t){var n,e,i,n;w&&w.mozilla&&(e=(new Date).valueOf(),i=r.X4,r.X4=e,i)&&e-i<100||r.q4(t)}).bind(o,function(t){r.tS(t)}),r.nS=function(t){r.eS(t)},r.D4.bind(u,r.nS),r.D4.bind(c,r.nS),v.et(r,"initEvents",r.N4)},v.prototype.Jw=function(t){this.o4=t},v.prototype.dispose=function(){var t=this;function n(t){t&&t.unbind(r)}n(t.B4),n(t.O4),n(t._4),n(t.j4),t.D4&&(t.nS&&(t.D4.unbind(u,t.nS),t.D4.unbind(c,t.nS)),v.et(t,"dispose",t.N4),t.D4.unbind(r).remove())},v.prototype.Fg=function(){var n=this;n.p4||((0,O.GC$)(a).bind(A,function(t){n.Z4(t)}).bind(o,function(t){n.W4(t)}),n.p4=!0)},v.prototype.u2=function(){this.p4&&(this.p4=!1,O.GC$)(a).unbind(A).unbind(o)},v.prototype.U4=function(t,n){var e,i,r,o,e=0,i=this,r=!0;i.u4=!0,null===i.s4&&(n?(i._4.addClass(s),e=0-i.iS(),i.rS=E.Zi.smallDecrement):(i.B4.addClass(s),e=i.iS(),i.rS=1),(o=function(){i.scrollTo(i.b4+e*i.k4,!1),i.s4=M.setTimeout(o,r?i.f4:i.l4),r=!1})(),d(t))},v.prototype.H4=function(t,n){var e,i,e=this,i;(n?e._4:e.B4).removeClass(s),e.oS(),d(t)},v.prototype.z4=function(t,n){var e,i,e=this,i;(n?e._4:e.B4).addClass("gc-scroll-arrow-hover ui-state-hover"),d(t)},v.prototype.V4=function(t,n){var e,i,e=this,i;(n?e._4:e.B4).removeClass("gc-scroll-arrow-hover ui-state-hover "+s),e.oS(),d(t)},v.prototype.Y4=function(t){var n,e,i,r,o,a,u,n=this;0===t.button&&(n.a4=!0,n.Z3={x:t.pageX,y:t.pageY},n.qy(E.ScrollbarState.show),n.Fg(),n.D4.addClass(S),n.O4.addClass(s),e=n.O4.offset(),i=n.O4.outerWidth(!0),r=n.O4.outerHeight(!0),o=n.j4.offset(),a=n.j4.outerWidth(!0),u=n.j4.outerHeight(!0),n.aS={isBeyondEdge:!1,startEdgePosition:{x:o.left+t.pageX-e.left,y:o.top+t.pageY-e.top},endEdgePosition:{x:o.left+a-(i-t.pageX+e.left),y:o.top+u-(r-t.pageY+e.top)}}),d(t)},v.prototype.Z4=function(t){var n=this;n.a4&&(n.qy(E.ScrollbarState.active),n.uS={x:t.pageX,y:t.pageY},n.sS(),n.Z3=n.uS,(0,O.GC$)(a.body).attr("unselectable","on").addClass(lt)),d(t)},v.prototype.W4=function(t){var n,e,i,r,o,o,n=this;n.a4=!1,n.rS=E.Zi.thumbPosition,n.aS=null,n.D4.trigger(b,{newValue:n.y4,oldValue:n.y4,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS}),i=((e=n.y4)-n.m4())*n.k4,r="left",o=(o=t.target.classList)&&o.contains(st),n.h4||(r="top"),o?n.qy(E.ScrollbarState.hide):n.qy(E.ScrollbarState.inactive),n.b4=i,n.O4.css(r,R(i)),n.u2(),(0,O.GC$)(a.body).removeClass(lt),(0,O.GC$)(a.body).attr("unselectable")&&(0,O.GC$)(a.body).removeAttr("unselectable"),n.O4.removeClass(s),n.D4.removeClass(S),n.rS=6,n.D4.trigger(b,{newValue:n.y4,oldValue:n.y4,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS}),d(t)},v.prototype.K4=function(t){this.O4.addClass("gc-scrollbar-stateHover ui-state-hover"),d(t)},v.prototype.J4=function(t){this.O4.removeClass("gc-scrollbar-stateHover ui-state-hover"),d(t)},v.prototype.eS=function(t){var n,e,i,i,n=this;f(t.wheelDelta)&&f(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=(e=t.detail||t.wheelDelta/-40)/3*n.iS()*n.k4,n.rS=0<=i?1:0,n.scrollTo(n.b4+i,!1),n.rS=6,i={newValue:n.y4,oldValue:n.y4,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS},n.D4.trigger(b,i),d(t)},v.prototype.q4=function(t){var e,i,r,o,a,u,s,c,e=this,i=!0,r=t.pageX,o=t.pageY,a=0,u=e.j4.offset(),s=e.cS();null===e.c4&&(a=e.h4?r-u.left-e.b4:o-u.top-e.b4,(c=function(){var t=0,n=e.b4,t;if((t=e.h4?r-u.left-n:o-u.top-n)*a<0||0<=t&&t<e.P4)e.fS();else{if(a<0)e.rS=E.Zi.largeDecrement,e.scrollTo(n-s*e.k4,!1);else{if(!(0<a))return void e.fS();e.rS=E.Zi.largeIncrement,e.scrollTo(n+s*e.k4,!1)}e.c4=M.setTimeout(c,i?e.f4:e.l4),i=!1}})(),d(t))},v.prototype.tS=function(t){this.fS(),d(t)},v.prototype.fS=function(){var t,n,t=this;t.c4&&clearTimeout(t.c4),t.c4=p,t.rS=E.Zi.endScroll,n={newValue:t.y4,oldValue:t.y4,scrollOrientation:t.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:t.rS},t.D4.trigger(b,n)},v.prototype.oS=function(){var t,n,t=this;t.u4&&(t.u4=!1,t.s4&&clearTimeout(t.s4),t.s4=p,t.rS=6,n={newValue:t.y4,oldValue:t.y4,scrollOrientation:t.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:t.rS},t.D4.trigger(b,n))},v.prototype.sS=function(){var e,t,n,i,r,o,n,a,u,i,s,u;function c(t){return e.h4?t.x:t.y}function f(t,n){e.h4?t.x=n:t.y=n}if(t=(e=this).b4,n=e.uS,i=e.aS,n=c(n),a=c(e.Z3),i&&i.isBeyondEdge){if(u=c(i.startEdgePosition),i=c(i.endEdgePosition),(r=n<u)||(o=i<n))return;a<u&&f(e.Z3,u),i<a&&f(e.Z3,i)}(u=t+(s=n-a))!==t&&(e.rS=5,e.scrollTo(u,!1))},v.prototype.scrollTo=function(t,n){var e,i,r,o,a,u,r,u,s,c,n,e=this,i=P,r=e.F4-e.P4;e.h4&&(i=B),u=a=o=!1,r<t&&(t=r,a=u=!0),t<0&&(o=u=!(t=0)),e.aS&&(e.aS.isBeyondEdge=u),r=e.g4===E.ScrollType.continuous?R(t/e.k4)+e.m4():t/e.k4+e.m4(),u=e.y4,s=!1,n||(n={newValue:r,oldValue:u,scrollOrientation:e.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:e.rS,isBeyondMaxEdge:a,isBeyondMinEdge:o},e.D4.trigger(b,n),s=n.ignoreUpdatePosition,n.newValue>e.v4()&&(n.newValue=e.v4()),r=n.newValue,c=n.newValueWithOffset),f(c)&&(c=r),e.y4=r,5!==e.rS&&(t=(c-e.m4())*e.k4),e.b4=t,s||e.O4.css(i,R(t))},v.prototype.hitTest=function(t,n){var e,i,r,o,a,u,s,c,f,u,o,f,a,e=this,i=0,r=0,o=e.O4.outerWidth(),a=e._4.outerWidth(),u=e.j4.outerWidth(),s=e.O4.offset(),c=(0,O.GC$)(e.oy()).offset(),f=s.left-c.left-18;return e.h4?t<0+u+a&&0+a<t?t<f+o+a&&f<t?{element:E.Yi.ThumbButton,x:t,y:n}:{element:E.Yi.TrackButton}:t<=0+a&&0<t?{element:E.Yi.LeftButton,x:t,y:n}:{element:E.Yi.RightButton,x:t,y:n}:(u=e.O4.outerHeight(),o=e._4.outerHeight(),f=e.j4.outerHeight(),a=s.top-c.top-18,n<0+f+o&&0+o<n?n<a+u+o&&a<n?{element:E.Yi.ThumbButton,x:t,y:n}:{element:E.Yi.TrackButton}:n<=0+o&&0<n?{element:E.Yi.UpButton,x:t,y:n}:{element:E.Yi.DownButton,x:t,y:n})},v.prototype._b=function(){var t=this;return{x:0,y:0,width:t.YC(),height:t.ZC()}},v.prototype.show=function(){this.j4.show()},v.prototype.hide=function(){this.j4.hide()},v.prototype.lS=function(t){var n,n,n=this,n=n.D4.parent()&&n.D4.parent().parent();return n?t?n.height():n.width():p},k=v,t.YM=k,(0,e.$e)(k),(h=k.prototype).iS=i("smallChange",1),h.cS=i("largeChange",10),h.d4=i("pageValue",10,function(t){t<=0&&this.d4(1)}),h.v4=i("maximum",100,function(t){t<=0&&this.v4(0)}),h.m4=i("minimum",0,function(t){t<=0&&this.m4(0)}),h.YC=i("width",0),h.ZC=i("height",0),m.prototype.w4=function(t){var a,n,e,i,r,o,u,s,c,t,r,o,f,l;function h(t){return t===W?O.GC$.En("div",[G,B,P,U,H,V],[W,0,0,"none",0,0]):t===Q?O.GC$.En("div",[G,B,P,U,H,V],[Q,0,0,"none",0,0]):p}function d(t,n){var e,e,i,n,e=n?a.hS:a.dS;return e||(e=new k(n),i=O.GC$.En("div"),n?(a.vS=i,a.hS=e,i.css([G,B,vt,U,H,V],[W,0,0,"none",0,0])):(a.mS=i,a.dS=e,i.css([G,dt,P,U,H,V],[W,0,0,"none",0,0])),n=(n?a.hS:a.dS).oy(),i.append(n),t.append(i),e)}function v(t,n,e,i,r,o){o?(a.vS.css([F,L],[n,i]),t.YC(n),t.ZC(i)):(a.mS.css([F,L],[i,n]),t.YC(i),t.ZC(n)),t.m4(0),t.v4(r-n),t.d4(n),t.iS(o?a.gS():a.pS()),t.cS(n),t.w4(),(0,O.GC$)(t.oy()).bind(b,function(t,n){e.css(o?B:P,0-n.newValue)}),(o?a.vS:a.mS).show()}function m(t){a.bS||(a.bS=h(Q),a.bS.css([gt,z,F],["hidden",J,Y]),t.append(a.bS))}function g(t){a.yS||(a.yS=O.GC$.En("div",G,Q,p,t))}(a=this).A4&&a.I4&&(n=a.T4,e=a.I4.width(),i=a.I4.height(),u=(r=a.A4.width())-n,s=(o=a.A4.height())-n,c=!1,a.wS||(a.wS=h(Q),a.wS.css([G,gt],[Q,"hidden"]),c=!0),a.wS.css(L,o),m(a.wS),g(a.bS),t&&a.yS.append(a.I4).css([P,B],[0,0]),w.chrome&&(e=R(e),i=R(i),r=C(r),o=C(o)),r=(t=a.CS(e,i,r,o)).MS,(o=t.SS)?(r||(u+=n),v(f=d(a.wS,!0),u,a.yS,n,e,!0)):a.vS&&a.vS.hide(),r?(o||(s+=n),v(l=d(a.wS,!1),s,a.yS,n,i,!1)):a.mS&&a.mS.hide(),o||r||(u+=n,s+=n),a.C4=o,a.S4=r,a.TS=u,a.AS=s,a.bS.css(L,s),c)&&(a.A4.append(a.wS),a.IS())},m.prototype.xS=function(t){var n,t,e,t,n=this,t=n.NS(t),e=t.I0,t=t.A0;!f(e)&&n.hS&&n.wy(e),!f(t)&&n.dS&&n.yy(t)},m.prototype.wy=function(t){var n,e,i,n=this;n.hS.value(t),e=n.TS,i=n.I4.width(),0<=t&&t<=i-e&&n.yS.css(B,0-t)},m.prototype.yy=function(t){var n,e,i,n=this;n.dS.value(t),e=n.AS,i=n.I4.height(),0<=t&&t<=i-e&&n.yS.css(P,0-t)},m.prototype.CS=function(t,n,e,i){var r,o=e,a=i-this.T4,u={SS:!1,MS:!1};return e<t&&(u.SS=!0,u.MS=a<n),i<n&&(u.MS=!0,u.SS=o<t),u},m.prototype.NS=function(t){var n=(0,O.GC$)(t),e=this.bS,i=this.yS,t,i,r,n,o,n,o,a={I0:p,A0:p};return t&&(t=n.offset(),i=i.offset(),r=e.offset(),t.leftWidth=t.left+n.outerWidth(),t.topHeight=t.top+n.outerHeight(),r.leftWidth=r.left+e.outerWidth(),r.topHeight=r.top+e.outerHeight(),n=t.left-i.left,t.left<r.left?a.I0=n:t.leftWidth>r.leftWidth&&(o=t.leftWidth-i.left-e.innerWidth(),a.I0=n<o?n:o),n=t.top-i.top,t.top<r.top?a.A0=n:t.topHeight>r.topHeight&&(o=t.topHeight-i.top-e.innerHeight(),a.A0=n<o?n:o)),a},m.prototype.IS=function(){var n=this;this.yS&&(n.nS=function(t){n.kS(t)},n.yS.bind(u,n.nS),n.yS.bind(c,n.nS))},m.prototype.kS=function(t){var n,e,i,r,o,a,u,i,n=this;f(t.wheelDelta)&&f(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=e=t.detail||t.wheelDelta/-40,r=n.dS,o=parseInt(n.yS.css(P),10),a=n.AS,(u=n.I4.height())<a&&(u=a),(i=(i=0<=(i=(o=isNaN(o)?0:o)-i*n.pS())?0:i)<0&&u-a<0-i?0-(u-a):i)!==o&&(n.yS.css(P,i),n.S4)&&r.value(0-i),y(t)},m.prototype.dispose=function(){var t=this;t.wS&&(t.hS&&t.hS.dispose(),t.dS&&t.dS.dispose(),t.yS&&t.nS&&(t.yS.unbind(u,t.nS),t.yS.unbind(c,t.nS)),(0,O.GC$)(t.wS).remove())},(e=(t.x4=_=m).prototype).gS=i("horizontalSmallChange",10),e.pS=i("verticalSmallChange",10),n.Hv.ch(N,{preProcessMouseMove:function(t){var n=this.Vv,e;(n.Xb.a4||n.zb.a4)&&(t.r=!0)}})},"./dist/core/worksheet/actionbase.js":function(t,n){"use strict";function i(t,n){t.suspendPaint(),n||t.suspendEvent()}function r(t,n){n||t.resumeEvent(),t.resumePaint()}var e;function o(t,n){this.X5=i,this.q5=r;var e=this;e.Mf=t,e.tT=n}Object.defineProperty(n,"__esModule",{value:!0}),n.ActionBase=void 0,o.prototype.execute=function(){},o.prototype.canExecute=function(){return!0},o.prototype.canUndo=function(){return!0},o.prototype.undo=function(){return!0},n.ActionBase=o},"./dist/core/worksheet/clipboardhelper.js":function(t,n,e){"use strict";var B,i,f,l,I,P,c,G,h,U,H,r,x,o;function a(t){return t&&t.options.allowCopyPasteExcelStyle}function d(t,n){var e,i;if(G.msie){for(e=[],i=0;i<t.length;i++)n&&""===t[i].trim()||e.push(t[i]);return e.join("")}return t.join("")}function u(t){for(var n,e,i,n="picture",e=1,i=n+e.toString();t.get(i);)i=n+(++e).toString();return i}function N(t,n,e,i){for(var r,o,a,r=[],o=0,a=e;o<a;o++)r[n+o]=t.getRowHeight(n+o,i);return r}function k(t,n,e,i){for(var r,o,a,r=[],o=0,a=e;o<a;o++)r[n+o]=t.getColumnWidth(n+o,i);return r}function w(t,n,e){var i,r;if(n=n||"\x3c!--",e=e||"--\x3e",t)for(;;){if((i=t.indexOf(n))<0)break;if((r=t.indexOf(e))<0)break;t=t.substring(0,i)+t.substring(r+e.length)}return t}function v(t,n,e){var i,r,i=-1;if(e)for(r=i=0;r<n;r++)i+=e[t+r]||0;return i}function m(t,n,e){var i,r,i=-1;if(e)for(r=i=0;r<n;r++)i+=e[t+r]||0;return i}function g(t){for(var n,e,e=0;e<t.length&&(0!==t[e].type.indexOf("image")||!(n=t[e].getAsFile()));e++);return n}function s(t){this.Nf=[],this.Zc=t}function p(t){this.Nf={},this.Doe=t,this.joe=t.map(function(t){return new r(t)}),this.Lre=1}function V(t){var n=this;n.DS=H,n._S=H,n.ES=!1,n.jS=t,n.En()}Object.defineProperty(n,"__esModule",{value:!0}),n.yM=n.Ooe=n.Boe=void 0,B=e("./dist/core/util/common.js"),i=e("Common"),f=e("./dist/core/worksheet/stylehelper.js"),l=e("./dist/core/worksheet/style.js"),I=e("./dist/core/core.enum.js"),P=i.Common.zf,c=/<img[^>]+>/g,G=B.mt.Tt,h=i.Common.lt.ht,U=i.Common.Uf.OS,H=null,s.prototype.add=function(t){var n=this.Nf,e=n.indexOf(t);return-1===e&&(n.push(t),e=n.length-1),e},s.prototype.toString=function(t){var t=this.Nf[t];return h(t)?"":this.Zc+":"+t},r=s,n.Boe=r,p.prototype.Loe=function(e){var i=this.joe;return this.Doe.map(function(t,n){return i[n].add(e[t])}).join("_")},p.prototype.add=function(t){var n=this.Nf,t=this.Loe(t);return n[t]||(n[t]="sjs"+this.Lre,this.Lre++),n[t]},p.prototype.toString=function(){var t,n,e,i,r,o,a,u,s,t=this.joe,n=[],e=this.Nf;for(i in e)if(e.hasOwnProperty(i)){for(r=i.split("_"),o=[],a=0;a<this.Doe.length;a++)(u=t[a].toString(+r[a]))&&o.push(u);s="."+e[i]+"{\r\n"+o.join(";\r\n")+"\r\n}\r\n",n.push(s)}return n.join("")},x=p,n.Ooe=x,V.prototype.En=function(){var s,t,n,e,i,s=this,t=document.createElement("div");t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.width="0px",t.style.height="0px",t.style.overflow="hidden",(n=document.createElement("div")).setAttribute("contenteditable","true"),n.setAttribute("gcUIElement","gcSheetClipboard"),n.setAttribute("tabindex","-1"),n.style.position="absolute",n.style.overflow="hidden",n.style.background="white",n.style.webkitUserSelect="text",t.appendChild(n),s.RS=n,(e=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),s.jS&&s.jS.options.enableAccessibility&&(e.setAttribute("aria-hidden","true"),e.setAttribute("role","none"),e.setAttribute("title","")),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",t.appendChild(e),s.BS=e,(i=s.jS.getHost())&&i.appendChild(t),G.msie||G.edge||(s.qfe=function(t){var n,e,i,r,o,o,n=t.clipboardData;n&&(0<(i=(e=s.DS)?B.mt.sTe(e):[]).length||0<(r=e?B.mt.cTe(e):[]).length?n.setData("text/plain",""):(o=e?e.bT(s._S):"",n.setData("text/plain",o),o=e?e.MT(s._S):"",n.setData("text/html",o)),t.preventDefault())},s.FS=function(t){var e,n,i,r,o,r,n,n,r,a,u,a,e=(0,B.jf)(s.jS),n=t.clipboardData;n&&(i=(i=n.getData("text/html")).replace(c,""),(r=s.PS()).innerHTML=i,o=i?s.GS(r,!1):V.formatClipboardData(n.getData("text/plain")),r.innerHTML="",(r=!o&&!i&&g(n.items))?((n=new FileReader).onload=function(t){var n=new Image;n.src=t.target.result,n.onload=function(){e.US(o,i,n.src)}},n.readAsDataURL(r),s.oA=!0):(n=s.jS.commandManager(),r=o||i&&0<=i.indexOf("<table"),a=s._S,u=e.wT(a),a=!e._T(s.DS,e.yT(a),e,o,u.rows,u.cols,!1),r&&a?e.US(o,i):e.isPasteShapes&&e.isPasteShapes()?(n.execute({cmd:"pasteShapes",sheetName:e.name()}),s.oA=!0):e.isPasteFloatingObject&&e.isPasteFloatingObject()?(n.execute({cmd:"pasteFloatingObjects",sheetName:e.name()}),s.oA=!0):r&&e.US(o,i))),t.preventDefault()},n.addEventListener("cut",s.qfe),n.addEventListener("copy",s.qfe),n.addEventListener("paste",s.FS),s.HS=function(t){var n,e,i,e,r,e,r,o,a,o,n=(0,B.jf)(s.jS),e=t.clipboardData;e&&((i=V.formatClipboardData(e.getData("text/plain")))||(e=e.getData("text/html"))&&((r=s.PS()).innerHTML=e,i=s.GS(r,!1),r.innerHTML=""),e=s.jS.commandManager(),r=i,o=s._S,a=n.wT(o),o=!n._T(s.DS,n.yT(o),n,i,a.rows,a.cols,!1),r&&o?n.US(i,""):n.isPasteShapes&&n.isPasteShapes()?(e.execute({cmd:"pasteShapes",sheetName:n.name()}),s.oA=!0):n.isPasteFloatingObject&&n.isPasteFloatingObject()?(e.execute({cmd:"pasteFloatingObjects",sheetName:n.name()}),s.oA=!0):r&&n.US(i,"")),t.preventDefault()},e.addEventListener("paste",s.HS))},V.prototype.L0=function(){var t,n,n,e,e,n,n,e,t=this,n=t.RS;n&&(G.msie||G.edge||(n.removeEventListener("cut",t.qfe),n.removeEventListener("copy",t.qfe),n.removeEventListener("paste",t.FS),t.BS.removeEventListener("paste",t.HS)),(n=n.parentElement)&&(e=n.parentElement)&&e.removeChild(n),t.RS=H,t.BS=H),(e=t.zS)&&((n=e.parentElement)&&n.removeChild(e),t.zS=H),(n=t.VS)&&((e=n.parentElement)&&e.removeChild(n),t.VS=H),t.jS=H},V.prototype.YS=function(t){a(this.jS)?this.RS.innerHTML=t:this.BS.value=t},V.prototype.ZS=function(){(a(this.jS)?this.RS:this.BS).focus({preventScroll:!0})},V.prototype.WS=function(){a(this.jS)?document.execCommand("selectAll"):this.BS.select()},V.prototype.QS=function(){var t,n,e,i,r,r,t="",n="",e="";return n=a(this.jS)?((i=this.RS)&&(0<(r=i.getElementsByTagName("table")).length?t=r[0].outerHTML:0<(r=i.getElementsByTagName("img")).length&&(e=r[0].src)),this.GS(this.RS,!0)):V.formatClipboardData(this.BS.value),{html:t,text:n,image:e}},V.KS=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,b,n,f,w,y,M,C,C,S,T,A,n,b,b;return d||!G.chrome&&!G.edge||(V.Foe=new x(["background-color","color","font","white-space","vertical-align","text-align","border-left","border-right","border-top","border-bottom"])),v=t.JS((0,B.Ec)(e,r,i,o),a),m=new RegExp(String.fromCharCode(32),"g"),b=p=!(g="&nbsp;"),a===I.SheetArea.viewport&&(e<0&&2==(2&n)&&(p=!0),r<0)&&1==(1&n)&&(b=!0),e=v.row,r=v.col,i=v.rowCount,o=v.colCount,n=f?t.options.gridline:H,f=f?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:H,w=h?N(t,e,i,a):H,y=h?k(t,r,o,a):H,M=!d&&4e3<i*o&&(G.safari||G.mozilla||B.mt.Qf()&&G.chrome),a===I.SheetArea.viewport?(S=C=void 0,A=T=H,n=V.XS(t,e,i,r,o,3,s,c,u,v,m,g,n,l,w,y,d),b&&(C=h?k(t,r,o,2):H,b=t.getColumnCount(2),T=V.XS(t,e,i,0,b,2,s,[],u,v,m,g,f,l,w,C,d)),p&&(S=h?N(t,e,i,1):H,b=t.getRowCount(1),A=V.XS(t,0,b,r,o,1,[],c,u,v,m,g,f,l,S,y,d)),C=V.qS(n,T,A,d,M)):a===I.SheetArea.rowHeader?(T=V.XS(t,e,i,r,o,2,s,c,u,v,m,g,f,l,w,y,d),C=V.qS(T,H,H,d,M)):a===I.SheetArea.colHeader&&(A=V.XS(t,e,i,r,o,1,s,c,u,v,m,g,f,l,w,y,d),C=V.qS(A,H,H,d,M)),V.Foe&&(V.Foe=H),C},V.qS=function(t,n,e,i,r){var o,a,u,n,s,o=t,a=0,u=function(t,n){for(var e,i,r,e=[],i=t.length,r=0;r<i;r++)e.push(t[r].concat(n[r]));return e};return n&&(a=n[0].length,o=u(n,t)),e&&(n=e.length,o=(e=a?u(s=V.XS(H,0,n,0,a,H,[],[],!1,H,H,H,H,!1,[],[],i),e):e).concat(o)),r&&V.$S(o),V.t5(o,i)},V.$S=function(t){for(var n,e,n=t.length,e=t.length-1;0<=e&&-1===t[e].join("").search(/>\S+</);e--)n=e;t.length=n},V.t5=function(t,n){var e,i,r,o,a,e="",i=!!V.Foe;for(i&&(e=(e+="<html>\r\n<head>\r\n<style>\r\n")+V.Foe.toString()+"</style>\r\n</head>\r\n<body>\r\n"),r=t.length,e+=n?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true" style="min-width:1px;min-height:1px;">',o=0;o<r;o++){for(e+="<tr>",a=0;a<t[o].length;a++)e+=t[o][a];e+="</tr>"}return e+="</table>",i&&(e+="\r\n</body>\r\n</html>"),e},V.n5=function(t){return t&&0<=t.indexOf('gc-sjs-clipboard="true"')},V.vI=function(t,n,e,i,r,o,a){var u,s,c,i,r,f,l,l,l,o,l,u,o,s,a,n,l,u,l,u,l,u=V.convertVAlign,s=V.convertHAlign,c=V.convertLineBorder,i=i,r=r,f={},l=t.backColor;return l&&(f["background-color"]=l,r=i=!1),(l=t.foreColor)&&(f.color=l),(l=t.font)&&(o&&(l=l+", "+B.FallbackFontFamily),f.font=l.replace(/"/g,"'").replace(/([\.\d]+px)/,function(t){return(3*parseFloat(t.substring(0,t.length-2))/4).toFixed(2)+"pt"})),f["white-space"]=t.wordWrap?a?"pre":"normal":"nowrap",o=t.vAlign,h(o)||(f["vertical-align"]=u(o)),l=t.hAlign,h(l)||(u=s(l=a?B.mt.gt(l,n):l))&&(f["text-align"]=u),o="border-left",s="border-right",a="border-top",n="border-bottom",(l=t.borderLeft)&&(f[o]=c(l),r=!1),(u=t.borderRight)&&(f[s]=c(u),r=!1),(l=t.borderTop)&&(f[a]=c(l),i=!1),(u=t.borderBottom)&&(f[n]=c(u),i=!1),l="1px solid "+e,i&&(f[a]=l,f[n]=l),r&&(f[o]=l,f[s]=l),f},V.dge=function(t,n,e,i,r){var o,a,u,s,c,o=t.row===n&&t.col===e;if(i&&r){for(u=t.row;u<t.row+t.rowCount;u++)if(0<i[u]){a=u;break}for(s=void 0,c=t.col;c<t.col+t.colCount;c++)if(0<r[c]){s=c;break}o=a===n&&s===e}return o},V.hge=function(t,n,e){var i,r,i=n;if(e)for(r=t;r<t+n;r++)e[r]<=0&&i--;return i},V.XS=function(t,n,e,i,r,o,a,u,s,c,f,l,h,F,d,v,m){var g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,j,O,E,L,R,N,I,k,_,D;for(h&&(g=h.color,p=h.showHorizontalGridline,b=h.showVerticalGridline),w=[],y=0;y<e;y++)if(!(U(a,M=n+y)||m&&d&&d[M]<=0)){for(C=[],S=0;S<r;S++)if(!(U(u,T=i+S)||m&&v&&v[T]<=0)){if(A="",x=I=void 0,D=_=k=N=1,s&&t&&(I=(I=t.getSpan(M,T,o))&&V.isPartSpan(I,c,a,u)?H:I)){if(I.row!==M||I.col!==T){if(!V.dge(I,M,T,d,v))continue;M=I.row,T=I.col}x=t.getActualStyle(M,T,o),j=t.getActualStyle(I.row+I.rowCount-1,I.col+I.colCount-1,o),!x.borderRight&&j.borderRight&&(x.borderRight=j.borderRight),!x.borderBottom&&j.borderBottom&&(x.borderBottom=j.borderBottom)}if(A+="<td",j=t&&t.getValue(M,T,o),s&&t){if(I&&(N=V.hge(I.row,I.rowCount,d),_=I.rowCount,1<N&&(A+=" rowSpan="+N),k=V.hge(I.col,I.colCount,v),D=I.colCount,1<k)&&(A+=" colSpan="+k),x=x||t.getActualStyle(M,T,o),O=m?"padding: 0; ":"",E=V.vI(x,j,g,p,b,F,m),V.Foe)A+=' class="'+(L=V.Foe.add(E))+'"';else for(R in E)E.hasOwnProperty(R)&&(O+=R+": "+E[R]+"; ");N=E.font?B.mt.vt(E.font):0,(O+=V.e5(M,T,_,D,d,v,N))&&(A+=' style="'+O+'"')}A+=">",k=I=void 0,s&&t&&((I=2==(2&(_=x.textDecoration)))&&(A+="<s>"),k=(k=1==(1&_))||8==(8&_))&&(A+="<u>"),(D=t?t.getText(M,T,o):"")?(" "!==D[0]&&" "!==D[D.length-1]||"number"!=typeof j||(D=D.trim()),"number"!=typeof j&&(D=P.j0(D).replace(f,l))):G.chrome?D="":G.safari&&(D="&nbsp;"),A+=D=m?D:D.replace(/\n/g,'<br style="mso-data-placement:same-cell;"/>'),s&&(k&&(A+="</u>"),I)&&(A+="</s>"),C.push(A+="</td>")}w.push(C)}return w},V.e5=function(t,n,e,i,r,o,a){var u,t,e,s,u="",t=v(t,e,r);return 0<t&&(t-=1),0<(e=m(n,i,o))&&(e-=1),u=0<=t&&0<=e?"overflow: hidden;height: "+t+"px;line-height: "+(s=Math.min(a,t))+"px; width: "+e+"px;max-width: "+e+"px;min-width: "+e+"px;":u},V.prototype.PS=function(){var t,n,e,t=this;return t.zS||((n=document.createElement("div")).style.display="none",(e=t.jS.getHost())&&e.appendChild(n),t.zS=n),t.zS},V.prototype.i5=function(){var t,n,e,t=this;return t.VS||((n=document.createElement("div")).style.display="none",(e=t.jS.getHost())&&e.appendChild(n),t.VS=n),t.VS},V.prototype.r5=function(t,n,e,i){var r,t,o,a,u,s,c,f,l,h,d,h,v,r=this.PS();if(r.innerHTML=t,t=r.getElementsByTagName("table"),o=n.o5(),0<t.length)for(a=this.a5(t[0],!0),s=e+(u=0);u<a.length;u++,s++){if(c=a[u],o)for(;0===n.getRowHeight(s);)s++;for(l=i+(f=0);f<c.length;f++,l++)if(h=c[f]){if(o)for(;0===n.getColumnWidth(l);)l++;n.u5(s,l,h.style),d=h.rowSpan,h=h.colSpan,(1<d||1<h)&&((v=n.getSpan(s,l))?(v.row=s,v.col=l,v.rowCount=d,v.colCount=h):n.addSpan(s,l,d,h))}}r.innerHTML=""},V.prototype.s5=function(t,n,e,i){var r,r,n,r;n.shapes?((r=n.shapes.addPictureShape("",t,0,0)).startRow(e),r.startColumn(i)):n.pictures&&(n=u(r=n.pictures),(r=r.add(n,t,0,0)).startRow(e),r.startColumn(i))},V.prototype.a5=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,v,g,p,b,e=this.i5(),i=[],r=/ +/g,o=/\n /g,a=0;a<t.rows.length;a++)for(u=t.rows[a],i[a]||(i[a]=[]),s=i[a],f=c=0;c<u.cells.length;c++){for(l=u.cells[c];s[f];)f++;for(h=s[f]={},d=void 0,n&&(d=V.getStyleFromDOM(l),h.style=d),v=(v=(v=(v=w(v=l.innerHTML,"\x3c!--[if","[endif]--\x3e")).replace(r," ")).replace(o,"\n")).replace(/(<br[^<]*>)/g,function(t,n,e,i){return"\n"!==i[e+t.length]?n+"\n":n}),e.innerHTML=v,m=e.innerText,0<=v.indexOf("<table")&&(m=m.trim()),h.text=m,h.rowSpan=l.rowSpan,(v=l.getAttribute("style"))&&0<=v.search(/mso-ignore:\s*colspan/)?h.colSpan=1:h.colSpan=l.colSpan,g=0;g<l.rowSpan;g++)for(p=0;p<l.colSpan;p++)0===g&&0===p||(i[a+g]||(i[a+g]=[]),(b=i[a+g])[f+p]={style:d,text:"",rowSpan:1,colSpan:1});f+=l.colSpan}return e.innerHTML="",i},V.prototype.GS=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=[];if(t)if(0<(i=t.getElementsByTagName("table")).length)for(r=this.a5(i[0],!1),o=new RegExp(String.fromCharCode(160),"g"),a=String.fromCharCode(32),u=0,s=r.length;u<s;u++){for(f=0,l=(c=r[u]).length;f<l;f++)0<=(h=0<=(h=c[f]?c[f].text:"").indexOf("\n")?n?(0<=h.indexOf("\r\n")&&(h=d(h.split("\r\n"),!0)),d(h.split("\n"),!0)):'"'+h+'"':h).indexOf("\t")&&(h=d(h.split("\t"),!0)),e.push(h.replace(o,a)),f<l-1&&e.push("\t");u<s-1&&e.push("\r\n")}else e.push(w(t.innerText||t.innerHTML).trim());return e.join("")},V.prototype.c5=function(t){var n,e,n=this,e=n.QS();n.DS&&n.DS.ki(B.Events.ClipboardChanging,{sheet:n.DS,sheetName:n.DS.name(),copyData:{text:e.text,html:e.html},ranges:n._S,cancel:!1,action:I.ClipboardActionType.reset},!0),n.DS=H,n._S=H,n.ES=!1,n.TT=!1,n.jS.ki("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},V.isPartSpan=function(t,n,e,i){var r,o,a,u,s,c;if(!n.containsRange(t))return!0;for(r=0,o=e;r<o.length;r++)if(a=o[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(u=0,s=i;u<s.length;u++)if(c=s[u],t.col<=c&&c<t.col+t.colCount)return!0;return!1},V.formatClipboardData=function(t){var n,e,i,r,o,a,n=[];if(t){for(i=!(e='"'),r=0;r<t.length;r++)o=0<r?t[r-1]:"",'"'===(a=t[r])?(i=!i,n.push('"')):n.push(i||"\n"!==a||"\r"===o?a:"\r\n");return n.join("")}return""},V.convertHAlign=function(t){var n;return{0:"left",1:"center",2:"right"}[t]},V.convertVAlign=function(t){var n;return{0:"top",1:"middle",2:"bottom"}[t]},V.convertLineBorder=function(t){var n,e,n,e;return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[t.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[t.style]+" "+t.color},V.convertToHAlign=function(t){var n;return{left:0,center:1,right:2}[t]},V.convertToVAlign=function(t){var n;return{top:0,middle:1,bottom:2}[t]},V.convertToLineBorder=function(t,n,e){var i={none:0,solid:1,dashed:3,dotted:4,double:6};return(G.msie||G.edge)&&"2px"===e?i.solid=5:(e=Math.round(10*parseFloat(e)*3/4)/10)<=.8?i.solid=1:e<=1?(i.solid=2,i.dashed=8):e<=1.5&&(i.solid=5),new l.LineBorder(t,i[n])},V.convertToTextDecoration=function(t){var n;return{underline:1,"line-through":2,"underline line-through":3,none:0}[t]},V.isTransparent=function(t){return 0===i.Common.ft._(t).a},V.isBlack=function(t){var t=i.Common.ft._(t);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b},V.getStyleFromDOM=function(t){var n,e,i,r,o,o,o,a,n,u,o,s,c,n,i,n,o,i,n,o,n=t.getElementsByTagName("font")[0],e=getComputedStyle(t),i=t.style,r=new l.Style,o=e.backgroundColor;return o&&!V.isTransparent(o)&&(r.backColor=o),o=e.color,(o=n?n.color:o)&&!V.isBlack(o)&&(r.foreColor=o),n?r.font=f.W.f5(getComputedStyle(n)):(o=f.W.f5(e))&&(o=o.replace(/\/.+?\s/gi," "),r.font=o),"normal"===(a=e.whiteSpace)&&(r.wordWrap=!0),n=e.verticalAlign,o=V.convertToHAlign,s=V.convertToLineBorder,c=V.convertToTextDecoration,n&&(r.vAlign=(u=V.convertToVAlign)(n)),n=i.textAlign,i=e.textAlign,G.msie||G.edge?r.hAlign=o(""!==n?n:"general"):i&&(r.hAlign=o(i)),"none"!==(n=e.borderLeftStyle)&&(r.borderLeft=s(e.borderLeftColor,n,e.borderLeftWidth)),"none"!==(o=e.borderRightStyle)&&(r.borderRight=s(e.borderRightColor,o,e.borderRightWidth)),"none"!==(i=e.borderTopStyle)&&(r.borderTop=s(e.borderTopColor,i,e.borderTopWidth)),"none"!==(n=e.borderBottomStyle)&&(r.borderBottom=s(e.borderBottomColor,n,e.borderBottomWidth)),o=c(e.textDecorationLine||e.textDecoration),0<t.getElementsByTagName("u").length&&(o|=c("underline")),0<t.getElementsByTagName("s").length&&(o|=c("line-through")),0!==o&&(r.textDecoration=o),r},n.yM=V},"./dist/core/worksheet/helpers/visible-row-col-cache.js":function(t,n){"use strict";var e;function i(t){this.rTe=!1,this.Mf=t,this.Hc()}Object.defineProperty(n,"__esModule",{value:!0}),n.VisibleRowColCache=void 0,i.prototype.Hc=function(){this.lTe={},this.hTe={}},i.prototype.oTe=function(t){this.rTe=t},i.prototype.sD=function(t,n){var e,i;return this.rTe||void 0===n?t+1:(void 0===(i=(e=this.dTe(n))[t])&&(i=this.QCe(t,n),e[t]=i),i)},i.prototype.QCe=function(t,n){for(var e,i,r,e=this.Mf.getRowCount(n),i=this.Mf,r=t+1;r<e;r++)if(i.getRowVisible(r,n))return r;return e},i.prototype.dTe=function(t){var n=this.lTe[t];return n||(this.lTe[t]={},this.lTe[t])},i.prototype.KCe=function(t,n){var e,i;return this.rTe||void 0===n?t+1:(void 0===(i=(e=this.vTe(n))[t])&&(i=this.YCe(t,n),e[t]=i),i)},i.prototype.YCe=function(t,n){for(var e,i,r,e=this.Mf.getColumnCount(n),i=this.Mf,r=t+1;r<e;r++)if(i.getColumnVisible(r,n))return r;return e},i.prototype.vTe=function(t){var n=this.hTe[t];return n||(this.hTe[t]={},this.hTe[t])},n.VisibleRowColCache=i},"./dist/core/worksheet/paste-special-dialog.js":function(t,n,i){"use strict";var e,r,o,a,u,s,u,c,f,l,h,d,v,m,g,p,b,w,y;function M(n,i,r){for(var o,t,e,o="",t=function(e){var t=n.slice(e,e+i);o+='<div class="gc-sjs-vertical-container gc-sjs-column-container">',t.forEach(function(t,n){o+=h(t,r,r+(n+e))}),o+="</div>"},e=0;e<n.length;e+=i)t(e);return o}function C(t,n,e){var t,n,t=y.call(this,t,n,e)||this;return t.data={pasteOptions:a.ClipboardPasteOptions.all,operationOptions:a.PasteOperationOptions.none,skipBlanks:!1,transpose:!1,pasteLink:!1},t.X2e=!1,n=i("SheetsCalc"),t.X2e=!!n,t}e=this&&this.__extends||(w=function(t,n){return(w=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}w(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.PasteSpecialDialog=void 0,o=i("./dist/core/util/basedialog.js"),a=i("./dist/core/core.enum.js"),u=i("Common"),s=i("./dist/core/core.ns.js"),u=new u.Common.ResourceManager(s.SR,"Sheets"),c=u.getResource.bind(u),f=function(){return[{value:a.ClipboardPasteOptions.all,text:c().pasteSpecialOptionDialog.pasteOptions.all},{value:a.ClipboardPasteOptions.formulas,text:c().pasteSpecialOptionDialog.pasteOptions.formulas},{value:a.ClipboardPasteOptions.values,text:c().pasteSpecialOptionDialog.pasteOptions.values},{value:a.ClipboardPasteOptions.formatting,text:c().pasteSpecialOptionDialog.pasteOptions.formats},{value:a.ClipboardPasteOptions.comments,text:c().pasteSpecialOptionDialog.pasteOptions.comments},{value:a.ClipboardPasteOptions.validation,text:c().pasteSpecialOptionDialog.pasteOptions.validation},{value:a.ClipboardPasteOptions.usingSourceTheme,text:c().pasteSpecialOptionDialog.pasteOptions.usingSourceTheme},{value:a.ClipboardPasteOptions.noBorder,text:c().pasteSpecialOptionDialog.pasteOptions.noBorders},{value:a.ClipboardPasteOptions.columnWidths,text:c().pasteSpecialOptionDialog.pasteOptions.columnWidth},{value:a.ClipboardPasteOptions.formulasAndNumberFormatting,text:c().pasteSpecialOptionDialog.pasteOptions.formulasAndNumberFormats},{value:a.ClipboardPasteOptions.valuesAndNumberFormatting,text:c().pasteSpecialOptionDialog.pasteOptions.valueAndNumberFormats}]},l=function(){return[{value:a.PasteOperationOptions.none,text:c().pasteSpecialOptionDialog.operationOptions.none},{value:a.PasteOperationOptions.add,text:c().pasteSpecialOptionDialog.operationOptions.add},{value:a.PasteOperationOptions.subtract,text:c().pasteSpecialOptionDialog.operationOptions.subtract},{value:a.PasteOperationOptions.multiply,text:c().pasteSpecialOptionDialog.operationOptions.multiply},{value:a.PasteOperationOptions.divide,text:c().pasteSpecialOptionDialog.operationOptions.divide}]},h=function(t,n,e){return'<div><input type="radio" value="'.concat(t.value,'" name="').concat(n,'" id="').concat(e,'"/><label for="').concat(e,'">').concat(t.text,"</label></div>")},d="pasteOptions",v="operationOptions",m="skipBlanks",g="transpose",p="pasteLink",y=o.Ase,e(C,y),C.prototype.$c=function(t){this.Dn(),y.prototype.$c.call(this,t),this.q2e(),this.$2e()},C.prototype.rQ=function(t){this.submitCallback=t,this.$c()},C.prototype.npe=function(t,n){return this.Wc[0].querySelector('input[name="'.concat(t,'"][value="').concat(n,'"]'))},C.prototype.Dn=function(){this.Wc.html(this.ipe),this.npe(d,this.data.pasteOptions).checked=!0,this.X2e&&(this.npe(v,this.data.operationOptions).checked=!0)},C.prototype.$2e=function(){var t=this.Wc.width(),n=this.Wc.height(),e=this.Fc.width(),i=this.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-t)/2+"px",(i-n)/2+"px"])},Object.defineProperty(C.prototype,"ipe",{get:function(){return'\n<div class="gc-sjs-paste-special-dialog-container">\n    <div class="gc-sjs-paste-special-dialog-title gc-sjs-horzation-container">\n        <span class="gc-sjs-paste-special-dialog-title-text">'.concat(c().pasteSpecialOptionDialog.title,'</span>\n        <span class="cancel-icon" data-cmd="close">\xd7</span>\n    </div>\n    <div class="gc-sjs-paste-special-dialog-content">\n        <div class="gc-sjs-horzation-container">\n            <span>').concat(c().pasteSpecialOptionDialog.paste,'</span>\n            <div class="gc-sjs-separator"></div>\n        </div>\n        <div class="gc-sjs-paste-special-dialog-paste-options gc-sjs-horzation-container">\n            ').concat(M(f(),6,d),"\n        </div>\n        ").concat(this.X2e?'\n            <div class="gc-sjs-horzation-container">\n                <span>'.concat(c().pasteSpecialOptionDialog.operation,'</span>\n                <div class="gc-sjs-separator"></div>\n            </div>\n            <div class="gc-sjs-paste-special-dialog-operation-options gc-sjs-horzation-container">\n                ').concat(M(l(),3,v),"\n            </div>\n         "):"",'\n        <div class="gc-sjs-separator"></div>\n        <div class="gc-sjs-horzation-container">\n            <div class="gc-sjs-column-container">\n                <input type="checkbox" id="').concat(m,'"/><label for="').concat(m,'">').concat(c().pasteSpecialOptionDialog.skipBlanks,'</label>\n            </div>\n            <div class="gc-sjs-column-container">\n                <input type="checkbox" id="').concat(g,'"/><label for="').concat(g,'">').concat(c().pasteSpecialOptionDialog.transpose,'</label>\n            </div>\n        </div>\n    </div>\n    <div class="gc-sjs-paste-special-dialog-footer gc-sjs-horzation-container">\n        ').concat(this.X2e?'<span class="gc-sjs-dialog-button" data-cmd="'.concat(p,'">').concat(c().pasteSpecialOptionDialog.pasteLink,"</span>"):"<span></span>",'\n        <div>\n            <span class="gc-sjs-dialog-button" data-cmd="submit">').concat(c().ok,'</span>\n            <span class="gc-sjs-dialog-button" data-cmd="close">').concat(c().cancel,"</span>\n        </div>\n    </div>\n</div>\n        ")},enumerable:!1,configurable:!0}),C.prototype.submit=function(t){var t=t||this.data;this.submitCallback&&this.submitCallback(t),this.close()},C.prototype.rpe=function(t){var n,t,n,t=t.target.dataset.cmd;if(t)switch(t){case"close":this.close();break;case"submit":this.submit();break;case p:this.submit(r(r({},this.data),{pasteLink:!0}))}},C.prototype.ope=function(t){var t=t.target;t.name?(t.name===d&&t.checked&&(this.data.pasteOptions=+t.value),t.name===v&&t.checked&&(this.data.operationOptions=+t.value)):(t.id===m&&(this.data.skipBlanks=t.checked),t.id===g&&(this.data.transpose=t.checked)),this.ape()},C.prototype.q2e=function(){var n,t,e,i,r,n=this,t=function(t){n.rpe(t)},e=function(t){n.ope(t)},i=function(t){"Escape"!==t.key&&27!==t.keyCode||n.close(),"Enter"!==t.key&&13!==t.keyCode||n.submit()};this.Wc.bind("click",t),this.Wc.bind("change",e),document.addEventListener("keyup",i),r=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-paste-special-dialog-title")),this.wpt=function(){n.Wc.unbind("click",t),n.Wc.unbind("change",e),document.removeEventListener("keyup",i),r()}},C.prototype.close=function(){this.wpt&&this.wpt(),y.prototype.close.call(this)},C.prototype.ape=function(){var t,n,t,e,n;this.X2e&&(n=[(t=a.ClipboardPasteOptions).formatting,t.comments,t.validation],t=[t.all,t.noBorder],e=this.Wc[0].querySelectorAll("[name=".concat(v,"]")),n.includes(this.data.pasteOptions)?e.forEach(function(t){return t.disabled=!0}):e.forEach(function(t){return t.disabled=!1}),n=this.Wc[0].querySelector('[data-cmd="'.concat(p,'"]')),!t.includes(this.data.pasteOptions)||this.data.operationOptions!==a.PasteOperationOptions.none||this.data.skipBlanks||this.data.transpose?n.classList.add("disable"):n.classList.remove("disable"))},n.PasteSpecialDialog=C},"./dist/core/worksheet/style.js":function(F,t,n){"use strict";var a,o,u,s,b,c,r,i,n,f,w,l,y,M,h,d,n,v,m,g,p,C,S,T,e,A,L,B,P,G,U,H,V,I,x,N,k,k,k;function z(t){var n,e,n={};return t&&t.option&&t.option.dataSource?(e=t.option.dataSource,t.option.dataSource=M,(n=w(t)).option.dataSource=e,t.option.dataSource=e):n=w(t),n}function _(t,n,e){this.color=t||"black",this.style=n||0,this.level=e}function Y(t){return!(!t||"object"!=typeof t||t.patternColor||t.stops)}function Z(t){return(!t||!t.stops)&&t&&t.type?{type:E(r.PatternType,t.type,M),patternColor:t.patternColor,backgroundColor:t.backgroundColor}:t}function D(t){return t?new I(t.color,E(H,t.style,M)):M}function W(t){var n,e,e,e;if(t){if(!(e=(n={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12"})[t.type]))return rt(t,!0,void 0);if(e=c.ti[e])return(e=new e).Je(t),e}return t}function Q(t){return t?{alignment:E(r.LabelAlignment,t.alignment,M),visibility:E(r.LabelVisibility,t.visibility,M),font:t.font,foreColor:t.foreColor,margin:t.margin}:M}function J(t){return t?{cornerFold:t.cornerFold,icons:t.icons&&0<t.icons.length?t.icons.map(function(t){return{src:t.src,width:t.width,height:t.height,position:E(r.IconPosition,t.position,M)}}):M}:M}function K(t){return t?t.map(function(t){return{position:E(r.ButtonPosition,t.position,M),useButtonStyle:t.useButtonStyle,enabled:t.enabled,width:t.width,caption:t.caption,imageSrc:t.imageSrc,imageSize:t.imageSize,captionAlign:E(r.CaptionAlignment,t.captionAlign,M),command:t.command,imageType:E(r.ButtonImageType,t.imageType,M),visibility:E(r.ButtonVisibility,t.visibility,M),hoverBackColor:t.hoverBackColor,buttonBackColor:t.buttonBackColor}}):M}function X(t){var n,e,e,e,i,i,e,i;if(t)return n=u.GC$.extend(!0,{},t),e=t.calendarPage,l(e)||(n.calendarPage=E(r.CalendarPage,e)),e=t.startDay,l(e)||(n.startDay=r.CalendarStartDay[e]),(e=t.layout)&&(i=e.direction,l(i)||(n.layout.direction=r.LayoutDirection[i]),i=e.displayAs,l(i)||(n.layout.displayAs=r.LayoutDisplayAs[i])),e=t.valueType,l(e)||(n.valueType=r.DropdownListValue[e]),i=t.direction,l(i)||(n.direction=r.LayoutDirection[i]),n}function q(t){return t?t.map(function(t){return{type:E(r.DropDownType,t.type,M),option:X(t.option),submitCommand:t.submitCommand}}):M}function $(t){var t,t="lineThroughUnderline"===t?r.TextDecorationType.lineThrough|r.TextDecorationType.underline:"lineThroughDoubleUnderline"===t?r.TextDecorationType.lineThrough|r.TextDecorationType.doubleUnderline:E(r.TextDecorationType,t,r.TextDecorationType.none);return t}function tt(t){var n,e,i,r,n=w(t.decoration);if(!l(n)&&!l(n.icons))for(n.icons=[],e=t.decoration.icons,i=0;i<e.length;i++)r=e[i],n.icons.push(w(r));return n}function nt(t,n){var e,i,r,o;for(l(t.decoration)&&(t.decoration={}),l(t.decoration.icons)&&(t.decoration.icons=[]),e=t.decoration.icons,i=n.decoration.icons,r=0;r<i.length;r++)o=i[r],e.push(w(o))}function j(e){var i;return e&&e instanceof Object?(i={},Object.keys(e).forEach(function(t){var n=e[t];l(n)||(n instanceof Array?i[t]=JSON.parse(JSON.stringify(n)):n instanceof Object?i[t]=j(n):i[t]=n)}),i):e}function O(){for(var t,n,e,i,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if((e=this)._id=O.l5,O.l5++,0!==t.length)if(i=t[0],1===t.length&&Y(i))e.Je(i);else for(r=0;r<x.length&&r<t.length;r++)e[x[r]]=t[r]}function et(t,n){l(t.applyFill)||(n.applyFill=t.applyFill),l(t.applyFont)||(n.applyFont=t.applyFont),l(t.applyAlignment)||(n.applyAlignment=t.applyAlignment),l(t.applyBorder)||(n.applyBorder=t.applyBorder),l(t.applyProtection)||(n.applyProtection=t.applyProtection),l(t.applyNumberFormat)||(n.applyNumberFormat=t.applyNumberFormat)}function E(t,n,e){var i;if(e=e||M,!l(n)){if(!isNaN(n))return parseInt(n,10);i=t[n]}return l(i)?e:i}function it(t,n,e,i){var n=rt(n,e,i);t.cellType=n}function rt(t,n,e){var i,r,n,o,n,i=t;if(n&&t){if(r=t.Ke&&t.Ke())return i;t.toJSON&&(t=t.toJSON()),n=c.ti,o=t.typeName,(n=n[t.type]||n[o]||s.getTypeFromString(o))?(i=new n).fromJSON(t,e):i=M}return i}function ot(t,n,e,i){var r,o;if(n===h&&(t.cellButtons=n),n){if(r=n,e)for(r=[],o=0;o<n.length;o++)r.push(w(n[o]));t.cellButtons=r}}function at(t,n,e,i){var r;n===h&&(t.decoration=n),n&&(r=n,e&&(r=w(n),n.icons)&&0<n.icons.length&&(r.icons=n.icons.map(function(t){return w(t)})),t.decoration=r)}function ut(t,n,e,i){var r,o;if(n===h&&(t.dropDowns=n),n){if(r=a([],n,!0),e)for(r=[],o=0;o<n.length;o++)r.push(w(n[o]));t.dropDowns=r}}function st(t,n,e){var i,e,e,r,r,i=n;e&&n&&"object"==typeof n&&(n.toJSON&&(n=n.toJSON()),e=(e=o.Formatter)&&e.GeneralFormatter)&&((r=n.typeName)?(r=s.getTypeFromString(r))&&(i=new r).fromJSON(n):i=new e(n.formatCached,n.customerCultureName)),t.formatter=i}function ct(t,n,e){var i,e,e,i=n;e&&n&&(n.toJSON&&(n=n.toJSON()),e=(e=o.Formatter)&&e.GeneralFormatter)&&((i=new e(n.formatCached,n.customerCultureName)).isAuto=!0),t._autoFormatter=i}function R(t,n,e){(n=n&&t.getColor(n))&&e(n)}function ft(t,n,e){return t===m?2===e||1===e?1===n:3===n:t===g?2===e||1===e?1===n:0===n:t===p?1===n:t===d&&n===M}function lt(t,n,e,i,r,o){for(var a,u,s,a=t.parentName;a&&a!==u&&(s=e.u8(a));)n.h5(s,i,r,o),a=s.parentName,u=s.name}a=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.composeParentStyle=t.Style=t.LineBorder=t.LineBorderComposeLevel=t.LineStyle=void 0,o=n("Common"),u=n("./dist/core/util/domUtil.js"),s=n("./dist/core/util/common.js"),b=n("./dist/core/worksheet/stylehelper.js"),c=n("./dist/core/celltype/celltype.ns.js"),r=n("./dist/core/core.enum.js"),i=u.GC$.each,n=s.mt,f=n.T1,w=o.Common.lt.tv,l=o.Common.lt.ht,y=b.W.upe,d="autoFormatter",n="formatter",v="cellType",m="hAlign",g="vAlign",p="imeMode",C="labelOptions",S="cellButtons",T="dropDowns",e="applyFont",A="applyFill",L="applyAlignment",B="applyBorder",P="applyNumberFormat",G="applyProtection",U={borderLeft:!(h=null),borderRight:!(M=void 0),borderTop:!0,borderBottom:!0,borderHorizontal:!0,borderVertical:!0,diagonalDown:!0,diagonalUp:!0},(k=H=t.LineStyle||(t.LineStyle={}))[k.empty=0]="empty",k[k.thin=1]="thin",k[k.medium=2]="medium",k[k.dashed=3]="dashed",k[k.dotted=4]="dotted",k[k.thick=5]="thick",k[k.double=6]="double",k[k.hair=7]="hair",k[k.mediumDashed=8]="mediumDashed",k[k.dashDot=9]="dashDot",k[k.mediumDashDot=10]="mediumDashDot",k[k.dashDotDot=11]="dashDotDot",k[k.mediumDashDotDot=12]="mediumDashDotDot",k[k.slantedDashDot=13]="slantedDashDot",(k=V=t.LineBorderComposeLevel||(t.LineBorderComposeLevel={}))[k.conditionalFormat=1]="conditionalFormat",k[k.cell=10]="cell",k[k.table=20]="table",k[k.row=30]="row",k[k.column=40]="column",k[k.sheet=50]="sheet",_.prototype.Gf=function(){return new _(this.color,this.style,this.level)},_.prototype.toJSON=function(){var t,n,e,n,t={},n=this,e=n.color,n=n.style;return"black"!==e&&(t.color=e),t.style=n,t},_.prototype.fromJSON=function(t,n){var e,i,t;t&&(e=this,i=t.color,t=t.style,f(i)&&(e.color=i),f(t))&&(e.style=t)},_.YC=function(t){var n,e,n,e;return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[t&&t.style]||0},I=_,t.LineBorder=I,x=["backColor","foreColor",m,g,"font","themeFont",n,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",v,"backgroundImageLayout","tabStop","textDecoration",p,"name","parentName","watermark","cellPadding",C,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",S,T,"textOrientation","decoration","mask","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"],N=[e,A,L,B,P,G],O.xp=function(t,n){var e=t.parentName;e&&!n.getNamedStyle(e)&&delete t.parentName},O.prototype.compose=function(t,n,e,i,r){this.h5(t,n,e,i,r)},O.prototype.h5=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,n,o=this,v=t.labelOptions,m=t.cellButtons;if(t.cellButtons&&0<t.cellButtons.length)for(m=[],g=0;g<t.cellButtons.length;g++)m.push(w(t.cellButtons[g]));if(p=t.dropDowns,t.dropDowns&&0<t.dropDowns.length)for(p=[],g=0;g<t.dropDowns.length;g++)p.push(z(t.dropDowns[g]));n?(o._autoFormatter=t._autoFormatter,o.backgroundImage=t.backgroundImage,o.backgroundImageLayout=t.backgroundImageLayout,o.backColor=j(t.backColor),o.foreColor=t.foreColor,o.hAlign=t.hAlign,o.vAlign=t.vAlign,o.spe=t.spe,o.cpe=t.cpe,o.lre=t.lre,o.Uge=t.Uge,o.fpe=t.fpe,o.lpe=t.lpe,o.b2e=t.b2e,o.y2e=t.y2e,o.w2e=t.w2e,o._font=y(o.spe,o.cpe,o.lre,o.lpe,o.b2e,o.y2e,o.w2e),o.themeFont=t.themeFont,o.formatter=t.formatter,o.mask=j(t.mask),o.showEllipsis=t.showEllipsis,o.hv=t.hv,a=t.borderLeft,o.borderLeft=a&&a.Gf&&a.Gf()||a,o.borderLeft&&e&&(o.borderLeft.level=e),u=t.borderTop,o.borderTop=u&&u.Gf&&u.Gf()||u,o.borderTop&&e&&(o.borderTop.level=e),s=t.borderRight,o.borderRight=s&&s.Gf&&s.Gf()||s,o.borderRight&&e&&(o.borderRight.level=e),c=t.borderBottom,o.borderBottom=c&&c.Gf&&c.Gf()||c,o.borderBottom&&e&&(o.borderBottom.level=e),h=t.borderHorizontal,o.borderHorizontal=h&&h.Gf&&h.Gf()||h,o.borderHorizontal&&e&&(o.borderHorizontal.level=e),d=t.borderVertical,o.borderVertical=d&&d.Gf&&d.Gf()||d,o.borderVertical&&e&&(o.borderVertical.level=e),f=t.diagonalDown,o.diagonalDown=f&&f.Gf&&f.Gf()||f,o.diagonalDown&&e&&(o.diagonalDown.level=e),l=t.diagonalUp,o.diagonalUp=l&&l.Gf&&l.Gf()||l,o.diagonalUp&&e&&(o.diagonalUp.level=e),o.locked=t.locked,o.textIndent=t.textIndent,o.wordWrap=t.wordWrap,o.shrinkToFit=t.shrinkToFit,o.cellType=t.cellType,o.name=t.name,o.parentName=t.parentName,o.tabStop=t.tabStop,o.textDecoration=t.textDecoration,o.imeMode=t.imeMode,o.watermark=t.watermark,o.cellPadding=t.cellPadding,o.isVerticalText=t.isVerticalText,o.textOrientation=t.textOrientation,v&&(o.labelOptions={alignment:v.alignment,font:v.font,foreColor:v.foreColor,visibility:v.visibility,margin:v.margin}),o.quotePrefix=t.quotePrefix,o.cellButtons=m,o.dropDowns=p,o.decoration=tt(t)):(o.backgroundImage===M&&(o.backgroundImage=t.backgroundImage),o.backgroundImageLayout===M&&(o.backgroundImageLayout=t.backgroundImageLayout),o.backColor===M&&(o.backColor=j(t.backColor)),o.foreColor===M&&(o.foreColor=t.foreColor),o.hAlign===M&&(o.hAlign=t.hAlign),o.vAlign===M&&(o.vAlign=t.vAlign),o.themeFont===M&&o.font===M&&(o.themeFont=t.themeFont),o.spe===M&&(o.spe=t.spe),o.cpe===M&&(o.cpe=t.cpe),o.lre===M&&(o.lre=t.lre,o.Uge=t.Uge,o.fpe=t.fpe),o.lpe===M&&(o.lpe=t.lpe),o.b2e===M&&(o.b2e=t.b2e),o.y2e===M&&(o.y2e=t.y2e),o.w2e===M&&(o.w2e=t.w2e),o._font=y(o.spe,o.cpe,o.lre,o.lpe,o.b2e,o.y2e,o.w2e),o.formatter===M&&(o.formatter=t.formatter),o.showEllipsis===M&&(o.showEllipsis=t.showEllipsis),o.hv===M&&(o.hv=t.hv),o._autoFormatter===M&&(o._autoFormatter=t._autoFormatter),o.mask===M&&(o.mask=j(t.mask)),o.borderLeft===M&&(a=t.borderLeft,o.borderLeft=a&&a.Gf&&a.Gf()||a,o.borderLeft)&&e&&(o.borderLeft.level=e),o.borderTop===M&&(u=t.borderTop,o.borderTop=u&&u.Gf&&u.Gf()||u,o.borderTop)&&e&&(o.borderTop.level=e),o.borderRight===M&&(s=t.borderRight,o.borderRight=s&&s.Gf&&s.Gf()||s,o.borderRight)&&e&&(o.borderRight.level=e),o.borderBottom===M&&(c=t.borderBottom,o.borderBottom=c&&c.Gf&&c.Gf()||c,o.borderBottom)&&e&&(o.borderBottom.level=e),o.borderHorizontal===M&&(h=t.borderHorizontal,o.borderHorizontal=h&&h.Gf&&h.Gf()||h,o.borderHorizontal)&&e&&(o.borderHorizontal.level=e),o.borderVertical===M&&(d=t.borderVertical,o.borderVertical=d&&d.Gf&&d.Gf()||d,o.borderVertical)&&e&&(o.borderVertical.level=e),o.diagonalDown===M&&(f=t.diagonalDown,o.diagonalDown=f&&f.Gf&&f.Gf()||f,o.diagonalDown)&&e&&(o.diagonalDown.level=e),o.diagonalUp===M&&(l=t.diagonalUp,o.diagonalUp=l&&l.Gf&&l.Gf()||l,o.diagonalUp)&&e&&(o.diagonalUp.level=e),o.locked===M&&(o.locked=t.locked),o.textIndent===M&&(o.textIndent=t.textIndent),o.wordWrap===M&&(o.wordWrap=t.wordWrap),o.shrinkToFit===M&&(o.shrinkToFit=t.shrinkToFit),o.cellType===M&&(o.cellType=t.cellType),o.tabStop===M&&(o.tabStop=t.tabStop),o.textDecoration===M&&(o.textDecoration=t.textDecoration),o.imeMode===M&&(o.imeMode=t.imeMode),o.name===M&&(o.name=t.name),o.parentName===M&&(o.parentName=t.parentName),o.watermark===M&&(o.watermark=t.watermark),o.cellPadding===M&&(o.cellPadding=t.cellPadding),!o.labelOptions&&v&&(o.labelOptions={}),(n=o.labelOptions)&&v&&(n.alignment===M&&(n.alignment=v.alignment),n.font===M&&(n.font=v.font),n.foreColor===M&&(n.foreColor=v.foreColor),n.visibility===M&&(n.visibility=v.visibility),n.margin===M)&&(n.margin=v.margin),i||o.quotePrefix!==M||(o.quotePrefix=t.quotePrefix),o.isVerticalText===M&&(o.isVerticalText=t.isVerticalText),o.textOrientation===M&&(o.textOrientation=t.textOrientation),o.cellButtons===M&&(o.cellButtons=m),o.dropDowns===M&&(o.dropDowns=p),o.decoration===M?o.decoration=tt(t):r&&b.W.Xue(t)&&nt(o,t))},O.prototype.d5=function(t){var e=this;0===arguments.length?(i(x,function(t,n){e[n]=M}),i(N,function(t,n){f(e[n])&&(e[n]=M)})):e[t]=M},O.prototype.clone=function(t){var n,e,i,r,o,a,u,s,c,f,n=this,e=n.borderLeft,i=n.borderTop,r=n.borderRight,o=n.borderBottom,a=n.diagonalDown,u=n.diagonalUp,s=n.borderHorizontal,c=n.borderVertical,f=new O;return f.backColor=j(n.backColor),f.foreColor=n.foreColor,f.hAlign=n.hAlign,f.vAlign=n.vAlign,f.spe=n.spe,f.cpe=n.cpe,f.lre=n.lre,f.Uge=n.Uge,f.fpe=n.fpe,f.lpe=n.lpe,f.b2e=n.b2e,f.y2e=n.y2e,f.w2e=n.w2e,f._font=y(f.spe,f.cpe,f.lre,f.lpe,n.b2e,n.y2e,n.w2e),f.themeFont=n.themeFont,f.formatter=M,f.mask=j(n.mask),f.borderLeft=e&&!t&&e.Gf&&e.Gf()||e,f.borderTop=i&&!t&&i.Gf&&i.Gf()||i,f.borderRight=r&&!t&&r.Gf&&r.Gf()||r,f.borderBottom=o&&!t&&o.Gf&&o.Gf()||o,f.borderHorizontal=s&&!t&&s.Gf&&s.Gf()||s,f.borderVertical=c&&!t&&c.Gf&&c.Gf()||c,f.locked=n.locked,f.textIndent=n.textIndent,f.wordWrap=n.wordWrap,f.shrinkToFit=n.shrinkToFit,f.backgroundImage=n.backgroundImage,f.cellType=M,f.backgroundImageLayout=n.backgroundImageLayout,f.tabStop=n.tabStop,f.textDecoration=n.textDecoration,f.imeMode=n.imeMode,f.name=n.name,f.parentName=n.parentName,f.watermark=n.watermark,f.cellPadding=n.cellPadding,f.labelOptions=n.labelOptions,f.quotePrefix=n.quotePrefix,f.diagonalDown=a&&!t&&a.Gf()||a,f.diagonalUp=u&&!t&&u.Gf()||u,f.isVerticalText=n.isVerticalText,f.showEllipsis=n.showEllipsis,f.hv=n.hv,f.textOrientation=n.textOrientation,at(f,n.decoration,!t,!0),et(n,f),st(f,n.formatter,!t),ct(f,n._autoFormatter,!t),it(f,n.cellType,!t,!0),ot(f,n.cellButtons,!t,!0),ut(f,n.dropDowns,!t,!0),f},O.prototype.v5=function(i){var n,e,t,r,o,a,u,s,c,n=this;if(i&&i.getColor){if(R(i,n.foreColor,function(t){n.foreColor=t}),"string"==typeof(e=n.backColor))R(i,e,function(t){n.backColor=t});else if(e&&(e.backgroundColor&&R(i,e.backgroundColor,function(t){e.backgroundColor=t}),e.patternColor&&R(i,e.patternColor,function(t){e.patternColor=t}),e.stops))for(t=function(n){R(i,e.stops[n].color,function(t){e.stops[n].color=t})},r=0;r<e.stops.length;r++)t(r);for(a=function(t,n){var e=o[t];e&&e.color&&R(i,e.color,function(t){e.color=t})},r=0,u=(o=[n.borderLeft,n.borderTop,n.borderRight,n.borderBottom,n.borderHorizontal,n.borderVertical,n.diagonalDown,n.diagonalUp]).length;r<u;r++)a(r,u)}if(s=n.themeFont,i&&i.getFont){if(c=void 0,!(c=s?i.getFont(s):n.lpe||i.bodyFont()))return n;n.lpe=c,n.lre||(n.lre=b.hpe),n._font=y(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)}return n},O.prototype.g5=function(t){var n,e,e,n=this,e=n._autoFormatter;e&&t!==h&&((e=e.getPreferredEditingFormatter(t)).isAuto=!0,n._autoFormatter=e)},O.prototype.toJSON=function(t,n){var e,i,r,o,a,e=this,i={},r=e._autoFormatter;for(!f(r)||n&&ft(d,r,t)||(r.toJSON&&(r=r.toJSON()),u.GC$.isEmptyObject(r))||(i[d]=r),o=0;o<x.length;o++)r=e[a=x[o]],a!==C||u.GC$.isEmptyObject(r)?a!==T&&a!==S||u.GC$.isEmptyObject(r)?!f(r)||n&&ft(a,r,t)||(i[a]=r&&r.toJSON?r.toJSON():r):i[a]=r:i[C]=r;for(o=0;o<N.length;o++)r=e[a=N[o]],f(r)&&(i[a]=r);return u.GC$.isEmptyObject(i)?M:i},O.prototype.fromJSON=function(t,n,e){var i,r,o,a,a;if(t)for(r in i=this,t)t.hasOwnProperty(r)&&(o=t[r],f(o))&&((a={p:r,v:o,r:!1}).noSchema=n,a.context=e,O.et(i,"fromJson",a),a.r||("formatter"===r?st(i,o,!0):"autoFormatter"===r?ct(i,o,!0):r===v?it(i,o,!0,n):U[r]?o===h?i[r]=null:((a=new I).fromJSON(o,n),i[r]=a):i[r]=o))},O.prototype.Je=function(t){var n=this;n.backColor=Z(t.backColor),n.foreColor=t.foreColor,n.hAlign=E(r.HorizontalAlign,t.hAlign,M),n.vAlign=E(r.VerticalAlign,t.vAlign,M),t.font?n.font=t.font:(n.spe=t.fontStyle,n.cpe=t.fontWeight,n.lre=t.fontSize,n.lpe=t.fontFamily,n.b2e=t.fontVariant,n.y2e=t.fontStretch,n.w2e=t.lineHeight,n._font=y(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)),n.themeFont=t.themeFont,n.formatter=t.formatter,n.borderLeft=D(t.borderLeft),n.borderTop=D(t.borderTop),n.borderRight=D(t.borderRight),n.borderBottom=D(t.borderBottom),n.borderHorizontal=D(t.borderHorizontal),n.borderVertical=D(t.borderVertical),n.diagonalDown=D(t.diagonalDown),n.diagonalUp=D(t.diagonalUp),n.locked=t.locked,n.textIndent=t.textIndent,n.wordWrap=t.wordWrap,n.shrinkToFit=t.shrinkToFit,n.backgroundImage=t.backgroundImage,n.cellType=W(t.cellType),n.backgroundImageLayout=E(r.ImageLayout,t.backgroundImageLayout,M),n.tabStop=t.tabStop,n.textDecoration=$(t.textDecoration),n.imeMode=E(r.ImeMode,t.imeMode,M),n.name=t.name,n.parentName=t.parentName,n.watermark=t.watermark,n.cellPadding=t.cellPadding,n.labelOptions=Q(t.labelOptions),n.isVerticalText=t.isVerticalText,n.textOrientation=t.textOrientation,n.showEllipsis=t.showEllipsis,n.cellButtons=K(t.cellButtons),n.dropDowns=q(t.dropDowns),n.decoration=J(t.decoration),et(t,n)},Object.defineProperty(O.prototype,"font",{get:function(){return this._font},set:function(t){b.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"fontSize",{get:function(){return this.lre},set:function(t){b.W.dpe(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"fontStyle",{get:function(){return this.spe},set:function(t){var n=this,e;n.spe!==t&&(n.spe=t,n._font=y(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e))},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"fontWeight",{get:function(){return this.cpe},set:function(t){var n=this,e;n.cpe!==t&&(n.cpe=t,n._font=y(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e))},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"fontFamily",{get:function(){return this.lpe},set:function(t){var n=this,e;n.lpe!==t&&(n.lpe=t,n._font=y(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e))},enumerable:!1,configurable:!0}),k=O,t.Style=k,t.composeParentStyle=lt,s.$e(k),k.l5=0},"./dist/core/worksheet/stylehelper.js":function(t,o,n){"use strict";var a,h,i,d,v,e,y,M,m,g,C,r,p,b,w,S,T,A,I,x,u;function s(t){return t=v(t=t||0,0),t=e(t,1)}function N(t){var n,e;return t===y?y:null!==t&&(t=(e=(n=t.split(" ")).filter(function(t){return t&&t!==C})).join(" "))||C}function k(){}Object.defineProperty(o,"__esModule",{value:!0}),o.W=o.hpe=o.p5=void 0,a=n("./dist/core/util/domUtil.js"),h=n("./dist/core/util/common.js"),i=n("./dist/core/core.enum.js"),d=document,v=Math.max,e=Math.min,y=void 0,M=null,m="#FFFFFF",g="#000000",C="normal",r=" ",p=Math.abs,b=Math.PI,w=Math.cos,S=Math.sin,T=Math.atan,A=Math.tan,I=/^(small-caps|all-small-caps|all-petite-caps|petite-caps|unicase|titling-caps|historical-forms|common-ligatures|no-common-ligatures|discretionary-ligatures|no-discretionary-ligatures|historical-ligatures|no-historical-ligatures|contextual|no-contextual|lining-nums|oldstyle-nums|proportional-nums|tabular-nums|diagonal-fractions|stacked-fractions|jis78|jis83|jis90|jis04|simplified|traditional|full-width|proportional-width|stylistic\([\d\.]+\)|styleset\([\d\.]+\)|character-variant\([\d\.]+\)|swash\([\d\.]+\)|ornaments\([\d\.]+\)|annotation\([\d\.]+\)|ruby|sub|super|text|emoji|unicode|ordinal|slashed-zero)$/i,o.p5="11pt",o.hpe="14.6667px",x={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},k.vpe=function(t){var n,n,i,r,o,a,u,s,c,f,l,h,d,v,e,m,g,p,b,w,n;if(k.mpe[t])return k.mpe[t];if((n=k.y5()).style.font=t,n=n.style,d=h=l=f=c=s=u=a=o=r=i=y,""===n.fontStyle||""===n.fontWeight||n.fontStyle===C||n.fontWeight===C){for(v=0,m=(t=t.replace(/"/g,"'")).length,g=!(e=[]),p="",b=0;b<m;b++)"'"===(w=t[b])?(p+=w,!1===(g=!g)&&(e.push(p),p="")):!g&&" "===w?(e.push(p),p=""):p+=w;0!==p.length&&e.push(p),e.forEach(function(t,n){var e;/^(italic|oblique)$/i.test(t)?(i=t,f=n):/^[\d\.]+deg$/i.test(t)&&"oblique"===i?(i+=" "+t,f=n):I.test(t)?s===y?s=t:s+=" "+t:/(condensed|expanded)$/i.test(t)||/^[\d\.]+%$/i.test(t)?c=t:/^(bold|bolder|lighter|[1-9]00)$/i.test(t)?(r=t,l=n):/^[\d\.]+(px|em|rem|%|pt)\/([\d\.]+(px|em|rem|%|pt)|normal)$/.test(t)?(e=t.split("/"),o=e[0],u=e[1],h=n):/^[\d\.]+(px|em|rem|%|pt)$/.test(t)?(o=t,h=n):t===C?v++:t&&(a===y?a=t:a+=" "+t,d=n)}),i!==y&&(h<=f||d<=f)&&(i=y),r!==y&&(h<=l||d<=l)&&(r=y),1<=v&&(i===y&&(i=M),r===y)&&(r=M)}else i=n.fontStyle,r=n.fontWeight;return n={fontStyle:i,fontWeight:r,fontSize:n.fontSize||o,fontFamily:n.fontFamily?n.fontFamily.replace(/"/g,"'"):a,lineHeight:(n.lineHeight===C?y:n.lineHeight)||u,fontVariant:(N(n.fontVariant)===C?y:n.fontVariant)||N(s),fontStretch:(n.fontStretch===C?y:n.fontStretch)||c},k.mpe[t]=n},k.gpe=function(t){var n,e,n;return t&&(k.aCe[t]||(n=t.split(","),e=[],n.forEach(function(t){t&&("'"!==(t=t.trim())[0]&&'"'!==t[0]&&0<t.indexOf(" ")?e.push("'"+t+"'"):e.push(t))}),n=e.join(", "),k.aCe[t]=n))},k.upe=function(t,n,e,i,r,o,a){var u,s,t,u=t+","+r+","+n+","+o+","+e+","+a+","+i;return k.ppe[u]||(s="",t===y&&n===y&&e===y&&i===y?k.ppe[u]=y:t===M&&n===M&&e===M&&i===M?k.ppe[u]=M:(t===M?s+=C:t!==y&&(s+=t),t=s[s.length-1]&&" "!==s[s.length-1]?" ":"",r!==y&&(s+=t+r),t=s[s.length-1]&&" "!==s[s.length-1]?" ":"",n===M?s+=t+C:n!==y&&(s+=t+n),t=s[s.length-1]&&" "!==s[s.length-1]?" ":"",o!==y&&(s+=t+o),t=s[s.length-1]&&" "!==s[s.length-1]?" ":"",e!==y&&(s+=t+e),t=s[s.length-1]&&" "!==s[s.length-1]?" ":"",a!==y&&(s+=t+"/"+t+a),t=s[s.length-1]&&" "!==s[s.length-1]?" ":"",i!==y&&(s+=t+(i=k.gpe(i))),k.ppe[u]=s))},k.oce=function(t,n){var t,e,i,r,t=t,e;t._font!==n&&(n?(i=k.vpe(n),t.spe=i.fontStyle===C?M:i.fontStyle,t.cpe=i.fontWeight===C?M:i.fontWeight,t.lre=i.fontSize,i.fontSize?(r=i.fontSize.match(/^([\d\.]+)(px|em|rem|%|pt)$/),t.Uge=r&&+r[1],t.fpe=r&&r[2]):(t.Uge=y,t.fpe=y),t.lpe=i.fontFamily,t.b2e=i.fontVariant,t.y2e=i.fontStretch,t.w2e=i.lineHeight,t._font=k.upe(t.spe,t.cpe,t.lre,t.lpe,t.b2e,t.y2e,t.w2e)):(t.spe=n,t.cpe=n,t.lre=n,t.Uge=y,t.fpe=y,t.lpe=n,t.b2e=y,t.y2e=y,t.w2e=y,t._font=n))},k.dpe=function(t,n){var t,e,i,t=t,e;t.lre!==n&&(i=void 0,(i=n?n.match(/^([\d\.]+)(px|em|rem|%|pt)$/):i)?(t.Uge=+i[1],t.fpe=i[2]):(t.Uge=y,t.fpe=y),t.lre=n,t._font=k.upe(t.spe,t.cpe,t.lre,t.lpe,t.b2e,t.y2e,t.w2e))},k.m5=function(t,n){return n?k.b5(t,n):t},k.Ne=function(t){var n,n;return t?((n=k.y5()).style.font=t,n=n.style,"object"==typeof global&&(0<=t.indexOf("italic")&&(n.fontStyle="italic"),""===n.fontStyle&&(n.fontStyle=C),""===n.fontWeight)&&(n.fontWeight=C),{fontFamily:n.fontFamily,fontSize:n.fontSize,fontStyle:n.fontStyle,fontWeight:n.fontWeight}):{}},k.f5=function(t){var n,e,i,r,o,a,u,s,c,t;return h.mt.Tt.safari?t.font:(n="",e="400",i="11pt",r="Calibri",o=t.fontStyle,a=N(t.fontVariant),u=t.fontWeight,s=t.lineHeight,c=t.fontSize,t=t.fontFamily,o&&o!==C&&(n=o),a&&a!==C&&(n+=(n?" ":"")+a),u&&u!==C&&u!==e&&(n+=(n?" ":"")+u),n+=(n?" ":"")+(c=c||i),s&&s!==C&&(n+="/"+s),n+(" "+(t=t||r)))},k.b5=function(t,n){var e,i,r,t,n;if(!t&&!n)return t;if(t){if(r=k.w5[i=n?t+"+"+n:t])return r;e=k.y5(),(0,a.GC$)(e).css("font",t)}else{if(r=k.w5[i=n])return r;e=k.y5(),(0,a.GC$)(e).css("fontSize",o.p5)}return n&&(0,a.GC$)(e).css("fontFamily",n),t=e.currentStyle,(n=d.defaultView)&&n.getComputedStyle&&(t=n.getComputedStyle(e,"")),r=k.f5(t),k.w5[i]=r,k.w5[r]=r},k.V=function(t,n,e,i){var r,o,a,u,s,s,c,f,e,l,r=k.C5[n];if(!i)if(r){if(o=r[t])return o}else r=k.C5[n]={};return(a=k.y5()).style.font=t,u=a.currentStyle,-1!==(s=(u=(s=d.defaultView)&&s.getComputedStyle?s.getComputedStyle(a,""):u).fontSize||a.style.fontSize).indexOf(c="px")?(f=v(1,parseFloat(s.replace(c,""))*n),e&&1===f&&(e.value=!0),s=f+c):-1!==s.indexOf("pt")&&(f=h.SJSColumnWidthHelper.pointToPixel(v(1,parseFloat(s.replace("pt",""))*n),4),e&&1===f&&(e.value=!0),s=f+c),-1!==(e=u.lineHeight).indexOf(c)&&(e=(l=v(1,parseFloat(e.replace(c,""))*n))+c),o=1===n?{font:t,fontFamily:a.style.fontFamily,fontSize:f}:(a.style.fontSize=s,a.style.lineHeight=e,{font:a.style.font,fontFamily:a.style.fontFamily,fontSize:f}),i||(r[t]=o),o},k.mpe={},k.ppe={},k.aCe={},k.Lge=function(t,n,e,i){var r,o,a,u,u,s;if(t){if(r=k.C5[n],a=t.font,!i)if(r){if(o=r[a])return o}else r=k.C5[n]={};return o=(u=t.Uge)?(u=v(1,u*n),e&&1===u&&(e.value=!0),s=t.fpe,"pt"===t.fpe&&(u=h.SJSColumnWidthHelper.pointToPixel(u,4),s="px"),{font:k.upe(t.fontStyle,t.fontWeight,u+s,t.fontFamily,t.b2e,t.y2e,t.w2e),fontFamily:t.fontFamily,fontSize:u}):k.V(a,n,e,!0),i||(r[a]=o),o}},k.y5=function(){var t,n,e;if(k.S5)k.S5.style.cssText=k.T5;else{if(t="-10000px",(e=(n=h.mt.En("span")).style).visibility="hidden",e.top=t,e.left=t,e.lineHeight=C,e.position="absolute",e.fontWeight=C,e.fontStretch=C,e.fontVariant=C,e.fontStyle=C,!d.body)return n;d.body.insertBefore(n,null),k.S5=n,k.T5=e.cssText}return k.S5},k.L0=function(){var t=k.S5;t&&((0,a.GC$)(t).remove(),k.S5=y,k.T5=y)},k.stringFontCatch={},k.ii=function(t,n){var e,i,r,o,e=t+","+n,i=k.stringFontCatch,r=i[e];return r||((o=k.y5()).style.font=t,n&&(o.style.fontWeight=n),r=i[e]=o.style.font),r},k.w5={},k.C5={},k.A5=function(t){var n;return t<=0?"none":(n="",(1|t)===t&&(n+="underline "),(2|t)===t&&(n+="line-through "),(4|t)===t&&(n+="overline "),n.trim())},k.setFillStyle=function(t,n,e,i,r,o,a){"string"==typeof n?(t.fillStyle!==n&&(t.fillStyle=n),a()):"path"===n.type?k.setFillStylePath(t,n,e,i,r,o,a):n.stops?k.setFillStyleGradient(t,n,e,i,r,o,a):n.type&&k.setFillStylepatternFill(t,n,e,i,r,o,a)},k.setFillStylepatternFill=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,n,u=x[n.type],s=u.length,c=u[0].length,f=document.createElement("canvas");for(f.width=c,f.height=s,(l=f.getContext("2d")).fillStyle=n.backgroundColor||m,l.fillRect(0,0,c,s),l.fillStyle=n.patternColor||g,h=0;h<s;h++)for(d=0;d<c;d++)(v=u[h][d])&&l.fillRect(d,h,1,1);t.createPattern(f,"repeat"),n=t.createPattern(f,"repeat"),t.fillStyle=n,a()},k.processStops=function(t){var n,e;if(t.stops||"path"===t.type){if(n=t.stops)if(0===n.length)n=[{position:0,color:g},{position:1,color:g}];else{for((n=n.filter(function(t,n,e){return t.position<=1&&0<=t.position})).sort(function(t,n){return t.position-n.position}),e=0;e<n.length;e++)n[e].color=n[e].color||g;0!==n[0].position&&n.splice(0,0,{position:0,color:g}),1!==n[n.length-1].position&&n.push({position:1,color:g})}else n=[{position:0,color:m},{position:1,color:m}];t.stops=n}"path"===t.type?(t.left=s(t.left),t.right=s(t.right),t.top=s(t.top),t.bottom=s(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},k.setFillStyleGradient=function(t,n,e,i,r,o,a){var u,s,c,f,u,l,h,d,u=n.degree||0;for(u%90==0?(c=u/180*b,f=p(u%180/180*b)-T(o/r)):(c=T(r/o*A(u/180*b)),f=p(c)-T(o/r),c=Math.round(u/180)*b+c),u=Math.sqrt(r*r+o*o)/2,s=t.createLinearGradient(e+r/2-u*w(f)*w(c),i+o/2-u*w(f)*S(c),e+r/2+u*w(f)*w(c),i+o/2+u*w(f)*S(c)),h=0,d=(l=n.stops).length;h<d;h++)s.addColorStop(l[h].position,l[h].color||m);t.fillStyle=s,a()},k.setFillStylePath=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,u=n.left||0,s=n.right||0,c=n.top||0,f=n.bottom||0,l=n.stops;if(s<u&&(s=u),f<c&&(f=c),0<u){for(t.save(),t.beginPath(),h=t.createLinearGradient(e+r*u,0,e,0),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e,i-1),t.lineTo(e+r*u+1,i+o*c),t.lineTo(e+r*u+1,i+o*f),t.lineTo(e,i+o+1),t.clip(),a(),t.restore()}if(s<1){for(t.save(),t.beginPath(),h=t.createLinearGradient(e+r*s,0,e+r,0),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e+r,i-1),t.lineTo(e+r,i+o+1),t.lineTo(e+r*s-1,i+o*f),t.lineTo(e+r*s-1,i+o*c),t.clip(),a(),t.restore()}if(0<c){for(t.save(),t.beginPath(),h=t.createLinearGradient(0,i+o*c,0,i),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e,i),t.lineTo(e+r,i),t.lineTo(e+r*s,i+o*c+1),t.lineTo(e+r*u,i+o*c+1),t.clip(),a(),t.restore()}if(f<1){for(t.save(),t.beginPath(),h=t.createLinearGradient(0,i+o*f,0,i+o),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||m);t.fillStyle=h,t.moveTo(e+r,i+o),t.lineTo(e,i+o),t.lineTo(e+r*u,i+o*f-1),t.lineTo(e+r*s,i+o*f-1),t.clip(),a(),t.restore()}u<s&&c<f&&(t.save(),t.beginPath(),t.fillStyle=l[0].color,t.rect(e+r*u,i+o*c,r*(s-u),o*(f-c)),t.clip(),a(),t.restore())},k.Xue=function(t){var n;return(null==(n=null==t?void 0:t.decoration)?void 0:n.icons)&&0<t.decoration.icons.length},k.bpe=function(t){return(null==t?void 0:t.cellButtons)&&0<t.cellButtons.length},k.Hge=function(t){return k.gfe(t,i.IconPosition.leftOfText)||k.gfe(t,i.IconPosition.rightOfText)},k.gfe=function(t,n){var e=n===i.IconPosition.left;return k.Xue(t)&&t.decoration.icons.some(function(t){return e?t.position===i.IconPosition.left||t.position===M||t.position===y:t.position===n})},k.Vge=function(t){return k.wpe(t,i.IconPosition.leftOfText)||k.wpe(t,i.IconPosition.rightOfText)},k.wpe=function(t,n){var e=n===i.ButtonPosition.left;return k.bpe(t)&&t.cellButtons.some(function(t){return e?t.position===i.ButtonPosition.left||t.position===M||t.position===y:t.position===n})},k.Jue=function(t){return k.Xue(t)&&t.decoration.icons.some(function(t){return k.Kue(t)})},k.Kue=function(t){return t.position===M||t.position===y||t.position===i.IconPosition.left||t.position===i.IconPosition.leftOfText||t.position===i.IconPosition.right||t.position===i.IconPosition.rightOfText},o.W=k},"./dist/core/worksheet/worksheet-actions.js":function(p,t,n){"use strict";var e,b,i,d,B,P,T,r,A,w,G,s,U,H,r,I,x,V,z,Y,Z,y,M,C,S,N,W,n,k,_,Q,J,K,X,i,q,D,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,u,fn,ln,hn,dn,vn,mn,gn,pn,i,bn,wn,yn,Mn,Cn,Sn,Tn,An,In,xn,Nn,kn,_n,Dn,jn,On,En,Rn,Fn,Ln;function j(t,n){return t.getRowCount(n)}function O(t,n){return t.getColumnCount(n)}function E(t){return t.rowCount}function R(t){return t.colCount}function Bn(t){var t=t.parent;return t&&t.options.allowCopyPasteExcelStyle}function Pn(t){var t=t.parent;return t&&t.options.copyPasteHeaderOptions}function Gn(t,n,e,i){throw new Error(z.I5(q().Exp_InvalidAndSpace,[t,n,e,i]))}function Un(t){t.suspendPaint()}function F(t){t.resumePaint()}function Hn(t){t.suspendEvent()}function L(t){t.resumeEvent()}function Vn(t,n){t&&I&&t.suspendCalcService(n)}function zn(t,n){t&&I&&t.resumeCalcService(n)}function Yn(t,n,e,i,r){var i=t.getSpan(n,e,i);return!(!(i&&r&&t.getRowVisible(i.row)&&t.getColumnVisible(i.col))||i.row===n&&i.col===e)}function Zn(t){var n=this;n.x5=1==(1&t),n.N5=2==(2&t),n.k5=8==(8&t),n.D5=I&&16==(16&t),n._5=!0,n.E5=!0}function Wn(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,r,r;if(x(t)||""===t)return k;for(!x(n)&&""!==n||(n="\r\n"),a="\n",!x(e)&&""!==e||(e="\t"),!x(i)&&""!==i||(i='"'),Y(t,n)||(t+=n),u=!r,s=[],f="",h=!(c=[]),d=i.length,v=n.length,m=a.length,g=e.length,p=t.length,b=0;b<p;b++)l=(f+=t[b]).length,u&&(l===d&&i===f||d<l&&i===f.substr(l-d,d))?h&&b+1+d<=p&&i===t.substr(b+1,d)?b+=d:h?(f=f.substr(0,l-d),h=!1):0===f.indexOf(i)&&(f=f.substr(0,l-d),h=!0):!h&&(l===g&&e===f||g<l&&e===f.substr(l-g,g))?(f=f.substr(0,l-g),c.push(f),f=""):!h&&(l===v&&n===f||v<l&&n===f.substr(l-v,v))?(f=f.substr(0,l-v),c.push(f),s.push(c),c=[],f=""):!h&&(l===m&&a===f||m<l&&a===f.substr(l-m,m))?(f=f.substr(0,l-m),c.push(f),s.push(c),c=[],f=""):h&&b+1+g<=p&&e===t.substr(b+1,g)&&","!==e&&(b+=d);if(h){if(0<c.length){for(y=void 0,y=0;y<s.length&&s[y]!==c;y++);s.length<=y&&s.push(c)}(r=f.toString())&&(r=r.replace(new RegExp(e,"g"),""),Y(r,n)&&(r=r.substr(0,r.length-v)),0===s.length)&&s.push([r])}return 0===s.length&&(Y(r=t,n)&&(r=r.substr(0,r.length-v)),s.push([r])),o&&Qn(s)&&/^(\s)*$/.test(t)&&t.substr(t.length-m,m)===a&&s.push([""]),s}function Qn(t){var n,e;if(t){for(n=0;n<t.length&&((e=t[n])&&1===e.length);n++);if(n===t.length)return 1}}function Jn(t,n,e,i,r){var o,a,u,s,c,r,f,l,h,d,v,o=i.length,a=qn(i);if(0!==o&&0!==a)for(u=new Zn(r),t&&(O(t,2)<=0&&(u.x5=!1),j(t,1)<=0)&&(u.N5=!1),(a-=s=u.x5?O(t,2):0)<=(r=0)&&(a=0),(o=(o-=c=u.N5?j(t,1):0)-(r=o<=0?0:r))<=0&&(o=0),u._5&&n+o>j(t)&&t.setRowCount(n+o),u.E5&&e+a>O(t)&&t.setColumnCount(e+a),f={},h=l=0;l<i.length;l++,h++)d=i[l],v=t.o5(),d.length<=0||(0<c&&l<c?Kn(t,d,h,e,a,1,u,f):0<o&&h<j(t)&&(Kn(t,d,h=l===c?n:h,0,s,2,u,f),d.splice(0,s),v&&(h=t.j5(h-1,3)),Kn(t,d,h,e,a,3,u,f,v)))}function Kn(t,n,e,i,r,o,a,u,s){for(var c,f,l,c=O(t,o),f=0,l=i;f<n.length;f++,l++)0<r&&l<c&&(s&&(l=t.O5(l-1,3)),Xn(t,o,e,l,n[f],a,u))}function Xn(n,e,i,r,o,t,a){var u,s,c,f,l,l,a,f,t,h,c,u=o,s=k;if(!1===t.k5&&(c={value:k},l=a[f=o.toString()],!x(o)&&l?(u=l.setValue,s=l.formatter):o&&!isNaN(o)&&0<=o.indexOf("\t")?u=o:(u=T.mt.Xf(k,o,!t.k5,c),s=c.value,x(o)||(a[f]={setValue:u,formatter:s}))),x(u))n.setValue(i,r,u,e);else if(""!==o)if(t.D5&&"="===o[0]&&1<o.length)try{n.setFormula(i,r,o.substr(1))}catch(t){n.setText(i,r,o,e)}else l=n.l0(i,r,"formatter",e),!1===t.k5&&s?l?(c=(l="string"==typeof l&&d.Formatter?new d.Formatter.GeneralFormatter(l):l).parse&&l.parse(o),u=x(c)?u:c):(s.isAuto=!0,n.getCell(i,r,e).R5("_autoFormatter",s),a=void 0,f=n.getCellType(i,r,e),t=s.formatString(),f&&"7"===f.typeName&&(a=f.parse(o,t,h={sheet:n,row:i,col:r,sheetArea:e}),u=x(a)?o:a)):l&&n.getCell(i,r,e).formatter(k),n.setValue(i,r,u,e);else n.setValue(i,r,k,e)}function qn(t){for(var n,e,i,n=0,e=0;e<(t&&t.length);e++)i=t[e],n=Q(i.length,n);return n}function $n(t,n,e,i,r,o,a,u,s,c){if(!t)throw new Error(q().Exp_SheetIsNull);var i;(n<-1||n>=j(t))&&Gn("row",n,"-1",j(t)-1),(e<-1||e>=O(t))&&Gn("column",e,"-1",O(t)-1),x(i)||""===i||(-1===n&&(n=0),-1===e&&(e=0),(i=Wn(i,r,o,a,s,c))&&0<i.length&&Jn(t,n,e,i,u))}function te(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,v,m,g,p,b,w,y,M,p,n,C;if(t)return v=j(t),m=O(t),(n<-1||v<=n)&&Gn("row",n,"-1",v-1),(e<-1||v<n+e)&&Gn("rowCount",e,"-1",v-n),(i<-1||m<=i)&&Gn("column",i,"-1",m-1),(r<-1||m<i+r)&&Gn("columnCount",r,"-1",m-i),p=g=!(m=v=-1),m=-1===n&&-1===i&&-1===e&&-1===r?(i=n=0,v=(e=j(t))-1,(r=O(t))-1):(-1===n&&(n=0,2==(2&Pn(t)))&&(g=!0),-1===i&&(i=0,1==(1&Pn(t)))&&(p=!0),v=n+(e=-1===e?j(t)-n:e)-1,i+(r=-1===r?O(t)-i:r)-1),y=w=null,M=re(t,n,v,i,m,3,c,f,o=!x(o)&&""!==o?o:"\r\n",a=!x(a)&&""!==a?a:"\t",u=!x(u)&&""!==u?u:'"',b=new RegExp(u,"g"),s,l,h,d),p&&(p=t.getColumnCount(2),w=re(t,n,v,0,p-1,2,c,f,o,a,u,b,s,l,h,d)),g&&(n=t.getRowCount(1),y=re(t,0,n-1,i,m,1,c,f,o,a,u,b,s,l,h,d)),ne(M,w,y,o,a,C=l&&4e3<e*r&&(N.safari||N.mozilla||T.mt.Qf()&&N.chrome));throw new Error(q().Exp_SheetIsNull)}function ne(t,n,e,i,r,o){var a,u,s,n,c,a=t,u=0,s=function(t,n){for(var e,i,r,e=[],i=t.length,r=0;r<i;r++)e.push(t[r].concat(n[r]));return e};return n&&(u=n[0].length,a=s(n,t)),e&&(n=e.length,c=null,a=(e=u?s(c=re(null,0,n-1,0,u-1,null,[],[],i,r,null,null,null,!1,!1),e):e).concat(a)),o&&ee(a),ie(a,i,r)}function ee(t){for(var n,e,n=t.length,e=t.length-1;0<=e&&-1===t[e].join("").search(/\S+/);e--)n=e;t.length=n}function ie(t,n,e){for(var i,r,o,a,u,o="",a=t.length,u=T.mt.Qf(),i=0;i<a;i++){for(r=0;r<t[i].length;r++)0!==r&&(o+=e),o+=t[i][r];(!u||i<a-1)&&(o+=n)}return o}function re(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m){for(var g,p,b,w,y,M,g=[],w=t&&Bn(t),p=n;p<=e;p++)if(!a||!V(a,p)){for(y=[],b=i;b<=r;b++)u&&V(u,b)||(M="",M=oe(M=t&&!Yn(t,p,b,o,d)&&(M=t.getText(p,b,o),m)&&w?M&&(" "!==M[0]&&" "!==M[M.length-1]||"number"!=typeof t.getValue(p,b,o)?M.replace(/[\r\n]+/g,"\n"):M.trim()):M,d,w,l,f,v,h,c,s),y.push(M));g.push(y)}return g}function oe(t,n,e,i,r,o,a,u,s){var c="";return x(t)||(c=t,n&&e)||(c=c.replace(i,r+r)),o&&!c&&(c=" "),c=!a&&-1===c.indexOf(r)&&-1===c.indexOf(u)&&-1===c.indexOf(s)&&-1===c.indexOf("\n")?c:r+c+r}function c(t,n){if(t.sheets){var n=(0,T._f)(t,n.sheetName);if(n)return n}return t}function o(t,n,e,i){var t,n,t=c(t,e),n=new n(t,e,i);return i?n.undo(t):n.execute(t)}function ae(t){var e=t;return function(t,n){var t=c(t,n);return D.B5(t,e)}}function a(t,n){var e,i,e=t,i=n;return function(t,n){var t=c(t,n);return D.L5(t,e,i)}}function ue(t,n){var t,e,i,r,n,t=t.parent;t&&(e=t.getSheetCount(),r=i=void 0,i=r=t.getActiveSheetIndex(),n?r<e-1&&r++:0<r&&r--,i!==r)&&(n=t.getActiveSheet(),t.tb(r,1),t.a3(n),t.repaint())}function se(t,n,e,i){t.F5=!0,ce(t)?t.P5(n):t.G5(n,e,void 0,void 0,i),t.F5=!1}function ce(t){var n,e,n=t.Ut.getSelections().length;return 1<n||!(!((e=t.U5())&&0<n)||t.ui===e.row&&t.ci===e.col&&t.H5>=E(e)&&t.z5>=R(e))}function fe(t,n){var e,e,t,n;return!!t.endEdit()&&((e=t.rt).V5(),e.Y5(),T.hi.F1(k),e=!1,(t=t.parent)&&((n=n.call(t))&&n.focus?(n.focus(),e=!0):t.vC()),{ignoreCancelDefault:!e})}function f(t,n,e){var i=this;i.Mf=t,i.Z5=n,i.W5=e,i.Q5=[],i.K5=[],i.J5()}function le(n,t){var e,i,e=[];return"string"==typeof t?(i=(0,T._f)(n,t))&&e.push(i):Array.isArray(t)&&t.forEach(function(t){var t=(0,T._f)(n,t);t&&e.push(t)}),e}function he(t){return t instanceof P.Worksheet?t:t.Mf instanceof P.Worksheet?t.Mf:void 0}function de(t,n){x(t.Tb)&&(t.Tb=n.Tb,t.Ab=n.Ab)}function ve(t,n){var n=t.vw(n);-1!==n&&n<t.Tb&&(t.Tb=n,t.invalidateLayout())}function me(t,n){var n=t.ww(n);-1!==n&&n<t.Ab&&(t.Ab=n,t.invalidateLayout())}function ge(t,n){var e=An.call(this,t,n)||this;return de(n,t),e}function pe(t,n){var e=In.call(this,t,n)||this;return de(n,t),e}function be(t,n){var e,i,e=xn.call(this)||this,i=e;return i.Mf=t,i.tT=n,e}function we(t,n){var e,i,e=Nn.call(this)||this,i=e;return i.Mf=t,i.tT=n,e}function l(t,n){var e,i,t,e=kn.call(this,t,n)||this,i=e,t=t.parent;return i.nT=n.rowHeader?2:3,W(n.autoFitType)||(n.autoFitType=t?t.options.autoFitType:0),e}function h(t,n){var e,i,t,e=_n.call(this,t,n)||this,i=e,t=t.parent;return i.nT=n.columnHeader?1:3,W(n.autoFitType)||(n.autoFitType=t?t.options.autoFitType:0),e}function ye(t,n){"value"===n.propertyName&&t.eT(n.row,n.col,n.oldValue,n.newValue)}function v(){return null!==Dn&&Dn.apply(this,arguments)||this}function m(t,n){var e,i,t,e=jn.call(this,t,n)||this;return I&&n.ranges&&1===n.endEditType&&(i=t.JS(n.ranges[0]),1===E(n.ranges[0]=i))&&1===R(i)&&(t=t.iT(i.row,i.col,1,1))&&t.ranges&&0<t.ranges.length&&(n.ranges=[t.ranges[0]]),e}function Me(){return null!==On&&On.apply(this,arguments)||this}function Ce(t){var t=t.parent,t=t&&t.w2;t&&t.repaint()}function Se(t,i){t&&t.forEach(function(t){var n,e,n=t.w3.getFormula(t.row,t.column),e=t.w3.sT(t.row,t.column);t.w3.rT.setFormula(t.row,t.column,n,e,i)})}function Te(t,n){return En.call(this,t,n)||this}function Ae(t,n){return Rn.call(this,t,n)||this}function Ie(t,n){return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),t.zoom(n),t.resumePaint(),0))}function g(t,n){return Fn.call(this,t,n)||this}function xe(t,n,e){var i,r,o,i=Ln.call(this,t,n)||this;if(!e&&(n.cachedActions=[],r=n.ranges)&&0<r.length)for(o=0;o<r.length;o++)n.cachedActions[o]=new Cn(t,{clearRange:r[o]});return i}e=this&&this.__extends||(Tn=function(t,n){return(Tn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Tn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),b=this&&this.__assign||function(){return(b=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.ChangedCells=t.Commands=t.getRangeText=t.getMaxLength=t.parseText=void 0,i=n("./dist/core/core.ns.js"),d=n("Common"),B=n("./dist/core/worksheet/style.js"),P=n("./dist/core/worksheet/worksheet.js"),T=n("./dist/core/util/common.js"),r=n("./dist/core/util/domUtil.js"),A=n("./dist/core/core.enum.js"),w=r.GC$,G=n("CalcEngine"),s=n("./dist/core/util/crypto.js"),U=n("./dist/core/worksheet/worksheet-formatter.js"),H=n("./dist/core/worksheet/worksheet-clipboard.js"),r=n("./dist/core/worksheet/actionbase.js"),I=!!G,x=d.Common.lt.ht,V=d.Common.Uf.OS,z=d.Common.zf,Y=z.dT,Z=T.Events.CellChanged,y=T.Events.ColumnWidthChanging,M=T.Events.ColumnWidthChanged,C=T.Events.RowHeightChanging,S=T.Events.RowHeightChanged,N=T.mt.Tt,W=T.mt.T1,n=w.extend,k=null,_=void 0,Q=Math.max,J=Math.ceil,K=1e5,X="SHA-512",i=new d.Common.ResourceManager(i.SR,"Sheets"),q=i.getResource.bind(i),t.parseText=Wn,t.getMaxLength=qn,t.getRangeText=te,n(P.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<O(this)&&this.Qy().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<j(this)&&this.Qy().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,n,e,i,r,o,a,u){var s=this;Un(s),Hn(s),Vn(s),$n(s,t,n,e,i,r,'"',o,a,u),zn(s,!1),L(s),F(s)},setDataToCell:function(t,n,e,i){Jn(t,n,e,i,0)},getCsv:function(t,n,e,i,r,o){return te(this,t,e,n,i,r,o,'"',!0)},getRangeTextHasIgnore:function(t,n,e,i,r,o){return te(this,t,e,n,i,"\r\n","\t",'"',!0,r,o)},findSpecialNonNullCellInRange:function(t,n){for(var e,t,i,r,o,a,u,s,e=this.Ut.sheetModels[3],t=T.mt.S1(this,t),i=t.row,r=t.row+t.rowCount,o=t.col,a=t.col+t.colCount,u=e.gT(i-1);-1!==u&&u<=r;){for(s=e.pT(u,o-1);-1!==s&&s<=a;){if(n(this,u,s))return{row:u,col:s};s=e.pT(u,s)}u=e.gT(u)}return _},nA:function(t){var n,e,i,r,o,a,u,n=this,e=t.length;if(n.isActualProtected())for(i=0;i<e;i++)for(o=(r=t[i]).row;o<r.row+r.rowCount;o++)for(a=r.col;a<r.col+r.colCount;a++)if(!1!==(u=n.getActualStyle(o,a)).locked)return!0;return!1},ET:function(t){for(var n=0;n<t.length;n++)if(this.dA(t[n],_,A.SheetArea.viewport))return!0;return!1},G5:function(t,n,e,i,r){var o,a,a,a,u,o=this,a=o.vA&&1===o.vA.sheetArea;o.endEdit&&!o.endEdit()||a||(a={sheet:o,sheetName:o.name(),row:o.ui,col:o.ci,cancel:!1},o.ki(T.Events.LeaveCell,a),!0!==a.cancel&&(a=o.ui,u=o.ci,x(e)&&(e=o.ui),x(i)&&(i=o.ci),3===t?o.mA(e,i,n):4===t?o.gA(e,i,n):1===t?o.pA(e,i,n,r):2===t?o.bA(e,i,n):5===t?o.yA():6===t&&o.wA(),o.MA(t,a,u,!1)))},P5:function(t){var n,e,e,i,n=this;n.endEdit()&&(e={sheet:n,sheetName:n.name(),row:n.ui,col:n.ci,cancel:!1},n.ki(T.Events.LeaveCell,e),!0!==e.cancel)&&(e=n.ui,i=n.ci,3===t?n.CA(n.ui,n.ci):4===t?n.SA(n.ui,n.ci):1===t?n.TA(n.ui,n.ci):2===t&&n.AA(n.ui,n.ci),n.MA(t,e,i,!0))},MA:function(t,n,e,i){var r,o,a,u,s,s,c,f,f,l,h,l,h,f,l,h,u,d,v,d,h,u,m,g,l,v,d,h,u,r=this,o=r.rt,a=r.Ut.getSelections(),u=!1;if(i||(s=r.JS(r.U5()),!(u=1<a.length||1<E(s)||1<R(s)?!0:u)&&r.Cb&&r.Cb.Sb(s)&&(u=!0),r.IA()),s=r.ui,c=r.ci,f=r.Ut.getSpan(s,c),r.H5=E(f),r.z5=R(f),i||(f=r.xA(s,c),l=r.selectionPolicy(),h=r.selectionUnit(),0!==l&&1!==l||r.Ut.do("clearSelection"),1===h?(f.col=-1,f.colCount=-1):2===h&&(f.row=-1,f.rowCount=-1),r.kA(f.row,f.col,E(f),R(f),!1),l=r.Ut.getSelections(),o._A(a,l)&&(r.EA(a,l),r.jA(a))),r.OA(s,c),n!==s&&(h=r.H3)&&h.RA(),f=r.Dn,u){if(h=(l=r.Fi()).BA,u=l.LA,d=l.width-h,v=l.height-u,f.FA(h,u,d,v),f.repaint(new T.Rect(h,u,d,l.qC)),f.repaint(new T.Rect(h,u,l.XC,v)),h=(d=r._1)&&d.isEnable(A.RowColumnStates.selected,!0),u=d&&d.isEnable(A.RowColumnStates.selected,!1),h||u){for(m=a[0],g=1;g<a.length;g++)m=m.union(a[g]);m&&(l=new T.Range(s,c,r.H5,r.z5),f.E1(l.union(m),null,null,null,null,i))}f.jy(f.J())}else d=E(v=r.Ut.getSpan(n,e)),h=R(v),f.E1(new T.Range(s,c,r.H5,r.z5).union(new T.Range(n,e,d,h)),null,null,null,null,i);u={sheet:r,sheetName:r.name(),row:s,col:c},r.ki(T.Events.EnterCell,u),r.ki(T.Events.EnterCellInternal,u),o.PA&&o.PA(s,c)},GA:function(t,n,e){var i,r,t,i=this,r=i.getDataValidator&&i.getDataValidator(t,n),t={sheet:i,sheetName:i.name(),row:t,col:n,editingValue:e,validator:r,validationResult:0};return i.ki(T.Events.ValidationError,t),t.validationResult},protect:function(t){this.aue(t)},aue:function(t){var n,e,e,i,t,n=this,e="string"==typeof t;!0!==n.options.isProtected&&(x(t)||e&&0===t.length?n.options.isProtected=!0:e&&(e=s.Qoe.iue(),t=s.Qoe.nue(t,e,i=1e5,s.Qoe.eue),n.oue={algorithmName:X,hashValue:t,saltValue:e,spinCount:1e5},n.options.isProtected=!0))},unprotect:function(t){return this.uue(t)},uue:function(t){var n,e,e,i,r,o,a,e,u,n=this,e=n.sue();if(n.options.isProtected){if(!e)return!(n.options.isProtected=!1);if(x(t)||"string"!=typeof t||0===t.length)return!1;if(i=(e=n.oue).hashValue,r=e.saltValue,o=e.spinCount,a=e.algorithmName,e=e.legacyPassword,u=!1,[i,r,o,a].some(x)){if(x(e))return!1;u=s.Qoe.ETe(t)===e}else{if(a!==X)throw new Error(q().EXP_UNSUPPORT_CRYPTO_ALGORITHM);u=s.Qoe.rue(t,i,r,o,s.Qoe.eue)}if(!u)return!1;n.options.isProtected=!1,n.oue=_}return!0},hasPassword:function(){return this.sue()},sue:function(){return!x(this.oue)}}),D={},(t.Commands=D).B5=function(t,n){return!!t&&2!==t.Di&&(t.G5(n,!1),!0)},D.UA=function(t,n,e,i){return!!t&&2!==t.Di&&(t.G5(n,!1,e,i),!0)},D.L5=function(t,n,e){return!!t&&2!==t.Di&&!(t.endEdit&&!t.endEdit()||(t.HA(n,e),0))},$="navigationLeft",tt="navigationRight",nt="navigationUp",et="navigationDown",it="navigationHome2",rt="navigationEnd2",ot="navigationTop",at="navigationBottom",ut="navigationHome",st="navigationFirst",ct="navigationEnd",ft="navigationLast",lt="moveToNextCell",ht="moveToPreviousCell",dt="navigationPageUp",vt="navigationPageDown",mt="navigationPreviousSheet",gt="navigationNextSheet",pt="clear",bt="clearAndEditing",wt="commitInputNavigationDown",yt="commitInputNavigationUp",Mt="cancelInput",Ct="commitArrayFormula",St="selectionLeft",Tt="selectionRight",At="selectionUp",It="selectionDown",xt="selectionHome",Nt="selectionEnd",kt="selectionPageUp",_t="selectionPageDown",Dt="selectionTop",jt="selectionBottom",Ot="selectionFirst",Et="selectionLast",Rt="copy",Ft="superCopy",Lt="cut",Bt="superCut",Pt="paste",Gt="undo",Ut="redo",Ht="resizeColumn",Vt="resizeRow",zt="splitResizeRow",Yt="splitResizeColumn",Zt="autoFitColumn",Wt="autoFitRow",Qt="editCell",Jt="setCellDefaultValue",Kt="renameSheet",Xt="zoom",qt="clearValues",$t="clipboardPaste",tn="selectNextControl",nn="selectPreviousControl",en="moveToNextCellThenControl",rn="moveToPreviousCellThenControl",on="changeFormulaReference",an="moveSheet",un="copySheet",sn="showAllSheetsDialog",cn="openPasteSpecialDialog",D.Tp=c,D.zA=o,D.gM=function(t){var n=T.mt.Qf(),e=!n,i=n;t.register($,D[$],37,!1,!1,!1,!1),t.register(tt,D[tt],39,!1,!1,!1,!1),t.register(nt,D[nt],38,!1,!1,!1,!1),t.register(et,D[et],40,!1,!1,!1,!1),t.register(it,D[it],37,e,!1,!1,i),t.register(rt,D[rt],39,e,!1,!1,i),t.register(ot,D[ot],38,e,!1,!1,i),t.register(at,D[at],40,e,!1,!1,i),t.register(ut,D[ut],36,!1,!1,!1,!1),t.register(st,D[st],36,!0,!1,!1,!1),t.register(ct,D[ct],35,!1,!1,!1,!1),t.register(ft,D[ft],35,!0,!1,!1,!1),t.register(lt,D[lt],9,!1,!1,!1,!1),t.register(ht,D[ht],9,!1,!0,!1,!1),t.register(dt,D[dt],33,!1,!1,!1,!1),t.register(vt,D[vt],34,!1,!1,!1,!1),t.register(mt,D[mt],33,e,!1,!1,i),t.register(gt,D[gt],34,e,!1,!1,i),t.register(pt,D[pt],46,!1,!1,!1,!1),t.register(bt,D[bt],8,!1,!1,!1,!1),t.register(wt,D[wt],13,!1,!1,!1,!1),t.register(yt,D[yt],13,!1,!0,!1,!1),t.register(Mt,D[Mt],27,!1,!1,!1,!1),t.register(Ct,D[Ct],13,!0,!0,!1,!1),t.register(St,D[St],37,!1,!0,!1,!1),t.register(Tt,D[Tt],39,!1,!0,!1,!1),t.register(At,D[At],38,!1,!0,!1,!1),t.register(It,D[It],40,!1,!0,!1,!1),t.register(xt,D[xt],36,!1,!0,!1,!1),t.register(Nt,D[Nt],35,!1,!0,!1,!1),t.register(kt,D[kt],33,!1,!0,!1,!1),t.register(_t,D[_t],34,!1,!0,!1,!1),t.register(xt,D[xt],37,e,!0,!1,i),t.register(Nt,D[Nt],39,e,!0,!1,i),t.register(Dt,D[Dt],38,e,!0,!1,i),t.register(jt,D[jt],40,e,!0,!1,i),t.register(Ot,D[Ot],36,!0,!0,!1,!1),t.register(Et,D[Et],35,!0,!0,!1,!1),N.msie||N.edge?t.register(Rt,D.copy,67,e,!1,!1,i):(t.register(Rt,D.copy),t.register(Ft,D[Ft],67,e,!1,!1,i)),N.msie||N.edge?t.register(Lt,D.cut,88,e,!1,!1,i):(t.register(Lt,D.cut),t.register(Bt,D[Bt],88,e,!1,!1,i)),t.register(Pt,D[Pt],86,e,!1,!1,i),t.register(Gt,D.undo,90,e,!1,!1,i),t.register(Ut,D.redo,89,e,!1,!1,i),n&&t.register(Ut,D.redo,90,e,!0,!1,i),t.register(tn,D[tn]),t.register(nn,D[nn]),t.register(en,D[en]),t.register(rn,D[rn]),t.register(on,D[on]),t.register(Ht,D[Ht]),t.register(Vt,D[Vt]),t.register(Yt,D[Yt]),t.register(zt,D[zt]),t.register(Zt,D[Zt]),t.register(Wt,D[Wt]),t.register(Qt,D[Qt]),t.register(Jt,D[Jt]),t.register(Kt,D[Kt]),t.register(Xt,D.zoom),t.register(qt,D[qt]),t.register($t,D[$t]),t.register(an,D[an]),t.register(un,D[un]),t.register(sn,D[sn]),t.register(cn,D[cn],86,!0,!1,!0,!1)},u={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",2048:"defaultValue",4096:"altText",1:"value"},D[$]={canUndo:!(fn=".cellEditAction"),execute:ae(3)},D[tt]={canUndo:!1,execute:ae(4)},D[nt]={canUndo:!1,execute:ae(1)},D[et]={canUndo:!1,execute:ae(2)},D[Ct]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n),n=D.VA;return(t=n?n.YA(t):t).YA&&t.YA(),!0}},D[wt]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n),n=D.VA;return se(t=n?n.ZA(t):t,2,!1),!0}},D[yt]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n),n=D.VA;return se(t=n?n.WA(t):t,1,!1,!0),!0}},D[ut]={canUndo:!1,execute:function(t,n){var t=c(t,n);return D.UA(t,4,k,t.frozenColumnCount()-1)}},D[it]={canUndo:!1,execute:function(t,n){var t,e,t=c(t,n);return!!(t&&0<(e=t.getSelections()).length)&&D.UA(t,4,k,-1)}},D[ct]={canUndo:!1,execute:function(t,n){var t=c(t,n);return D.UA(t,3,k,O(t)-t.frozenTrailingColumnCount())}},D[rt]={canUndo:!1,execute:function(t,n){var t,e,t=c(t,n);return!!(t&&0<(e=t.getSelections()).length)&&D.UA(t,3,k,O(t))}},D[ot]={canUndo:!1,execute:function(t,n){var t=c(t,n);return D.UA(t,2,-1,k)}},D[at]={canUndo:!1,execute:function(t,n){var t=c(t,n);return D.UA(t,1,j(t),k)}},D[dt]={canUndo:!1,execute:function(t,n){var t,n,e,e,i,i,t=c(t,n);if(!t||2===t.Di)return!1;if((n=t.QA())!==k&&n!==t.Tb){if(e=t._y(1,3),(e=t.j5(t.ui-e.length))<n&&(e=n),i=D.VA){if((i=i.KA(t,e,n)).r)return!0;t=i.sheet}if(!t.endEdit())return!1;t.JA(e,t.getActiveColumnIndex())&&(t.XA(e,k),t.qA=e,t.G5()),t.$A(n,0)}return!0}},D[vt]={canUndo:!1,execute:function(t,n){var t,n,e,e,i,i,t=c(t,n);if(!t||2===t.Di)return!1;if((n=t.tI())!==k&&n!==t.Tb){if(e=t._y(1,3),(e=t.nI(t.ui+e.length))<n&&(e=n),i=D.VA){if((i=i.eI(t,e,n)).r)return!0;t=i.sheet}if(!t.endEdit())return!1;t.JA(e,t.getActiveColumnIndex())&&(t.XA(e,k),t.qA=e,t.G5()),t.$A(n,0)}return!0}},D[gt]={canUndo:!1,execute:function(t,n){var e;ue(c(t,n),!0)}},D[mt]={canUndo:!1,execute:function(t,n){var e;ue(c(t,n),!1)}},D[st]={canUndo:!1,execute:function(t,n){var t,n,n,t=c(t,n);if(!t||2===t.Di)return!1;if(n=D.VA){if((n=n.iI(t)).r)return!0;t=n.sheet}return t.G5(5,!1,t.ui,t.ci),!0}},D[ft]={canUndo:!1,execute:function(t,n){var t,n,n,t=c(t,n);if(!t||2===t.Di)return!1;if(n=D.VA){if((n=n.rI(t)).r)return!0;t=n.sheet}return t.G5(6,!1,t.ui,t.ci),!0}},D[tn]={canUndo:!1,execute:function(t,n){var t=c(t,n);return!!t.parent&&fe(t,t.parent.nextControl)}},D[nn]={canUndo:!1,execute:function(t,n){var t=c(t,n);return!!t.parent&&fe(t,t.parent.previousControl)}},D[lt]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n),n=D.VA;return se(t=n?n.oI(t):t,4,!0),!0}},D[ht]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n),n=D.VA;return se(t=n?n.aI(t):t,3,!0),!0}},D[en]={canUndo:!1,execute:function(t,n){var e,i,r,o,a,e=c(t,n),i=e.qA,r=e.getActiveColumnIndex();return e.F5=!0,o=e.uI(e.getActiveRowIndex(),r,!0,i),e.F5=!1,((a=!o||o.leadingCellRow<i||o.leadingCellRow===i&&r>o.col)?D[tn]:D[lt]).execute(t,n)}},D[rn]={canUndo:!1,execute:function(t,n){var e,i,r,o,a,e=c(t,n),i=e.qA,r=e.getActiveColumnIndex();return e.F5=!0,o=e.sI(e.getActiveRowIndex(),r,!0,i),e.F5=!1,((a=!o||o.leadingCellRow>i||o.leadingCellRow===i&&r<o.col)?D[nn]:D[ht]).execute(t,n)}},D[Mt]={canUndo:!1,execute:function(t,n){var t,n,e,n,t=c(t,n),n=D.VA;return n&&(e=n.cI(t)),t.isEditing()?!!t.endEdit(!0):x(e)?(D.fI(t.parent),t.bM=k,t.parent.bM.c5(),(n=t).AT&&n.AT(),void(n.ieV&&n.ieV())):e}},D.fI=function(t){var n,t,e,i,r,o;if(t&&(n=t.sheets,t=t.mp.map(function(t){return t.Mf}),e=n.concat(t)))for(i=0,r=e.length;i<r;i++)(o=e[i])&&o.lA&&o.lA.lI()},D[pt]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n);return!t.isEditing()&&(n=t.getSelections(),t.Qy().execute({cmd:qt,sheetName:t.name(),ranges:n}))}},D[bt]={canUndo:!1,execute:function(t,n){var e=c(t,n);return!e.isEditing()&&(T.mt.Qf()?D[pt].execute(t,n):(e.Ai=!0,e.startEdit(!0,""),e.Ai=!1),!0)}},D.copy={canUndo:!1,execute:function(t,n){var e,t,e,t,t=c(t,n),e=!n.vge&&(null==(e=n.ignoreClipboard)||e),t=n.copyData=t.eA(e);return n.callback&&n.callback(),!t||_}},D[Ft]={canUndo:!1,execute:function(t,n){var e,t,e,i,r,t=c(t,n),e=null==(e=t.parent)?void 0:e.commandManager(),i;return 0<T.mt.sTe(t).length?(t.fTe(),e.execute({cmd:"copyShapes",sheetName:t.name()})):0<(r=T.mt.cTe(t)).length?(t.fTe(),e.execute({cmd:"copyFloatingObjects",sheetName:t.name()})):e.execute(b({cmd:Rt},n))}},D.cut={canUndo:!1,execute:function(t,n){var e,t,e,t,t=c(t,n),e=!n.vge&&(null==(e=n.ignoreClipboard)||e),t=n.cutData=t.tA(e);return n.callback&&n.callback(),!t||_}},D[Bt]={canUndo:!1,execute:function(t,n){var e,t,e,i,r,t=c(t,n),e=null==(e=t.parent)?void 0:e.commandManager(),i;return 0<T.mt.sTe(t).length?(t.fTe(),e.execute({cmd:"cutShapes",sheetName:t.name()})):0<(r=T.mt.cTe(t)).length?(t.fTe(),e.execute({cmd:"cutFloatingObjects",sheetName:t.name()})):e.execute(b({cmd:Lt},n))}},D[Pt]={canUndo:!1,execute:function(t,n){var e,e,i,e=null!=(e=n.vge)&&e,i;c(t,n).rA(n,e)}},D[St]={canUndo:!1,execute:a(37)},D[Tt]={canUndo:!1,execute:a(39)},D[At]={canUndo:!1,execute:a(38)},D[It]={canUndo:!1,execute:a(40)},D[xt]={canUndo:!1,execute:a(37,!0)},D[Nt]={canUndo:!1,execute:a(39,!0)},D[kt]={canUndo:!1,execute:a(33)},D[_t]={canUndo:!1,execute:a(34)},D[Dt]={canUndo:!1,execute:a(38,!0)},D[jt]={canUndo:!1,execute:a(40,!0)},D[Ot]={canUndo:!1,execute:a(36,!0)},D[Et]={canUndo:!1,execute:a(35,!0)},D[on]={canUndo:!1,execute:function(t,n){var t,n,t=c(t,n),n=t&&t.rt;if(n){Un(t);try{n.hI&&n.hI()}finally{F(t)}}}},D.undo={canUndo:!1,execute:function(t){var t,n,t=t;return t&&(n=t.undoManager())&&n.canUndo()&&(n.undo(),t.ki(T.Events.WorkbookUndo,{spread:t})),!0}},D.redo={canUndo:!1,execute:function(t){var t,n,t=t;return t&&(n=t.undoManager())&&n.canRedo()&&(n.redo(),t.ki(T.Events.WorkbookRedo,{spread:t})),!0}},D[Ht]={canUndo:!0,execute:function(t,n,e){return o(t,hn,n,e)}},D[Vt]={canUndo:!0,execute:function(t,n,e){return o(t,dn,n,e)}},D[Yt]={canUndo:!0,execute:function(t,n,e){return o(t,vn,n,e)}},D[zt]={canUndo:!0,execute:function(t,n,e){return o(t,mn,n,e)}},D[Zt]={canUndo:!0,execute:function(t,n,e){return o(t,gn,n,e)}},D[Wt]={canUndo:!0,execute:function(t,n,e){return o(t,pn,n,e)}},D[Qt]={canUndo:!0,execute:function(t,n,e){return o(t,bn,n,e)}},D[Jt]={canUndo:!1,execute:function(t,n,e){return o(t,wn,n,e)}},D[Kt]={canUndo:!0,execute:function(t,n,e){return o(t,yn,n,e)}},D.zoom={canUndo:!0,execute:function(t,n,e){return o(t,Mn,n,e)}},D[qt]={canUndo:!0,execute:function(t,n,e){var i,r,i=c(t,n),r=i.getSelections();return i.isActualProtected()&&i.ET(r)?(i.jT(13,i.FT()),!1):o(t,Sn,n,e)}},D[$t]={canUndo:!0,execute:function(t,n,e){return o(t,H.ClipboardPasteUndoAction,n,e)}},D[an]={canUndo:!1,execute:function(t,n){var e,n,i,r,i,o,a,a,e=n.sheetName,n=n.targetIndex,i=t.getSheetPosition(e),r=t.jg(),i=i,o=n,a={sheet:r,sheetName:r.name(),oldIndex:i,newIndex:o,cancel:!1};return t.ki(T.Events.SheetMoving,a),!a.cancel&&(a=t.changeSheetPosition(e,n),t.ki(T.Events.SheetMoved,{sheet:r,sheetName:r?r.name():k,oldIndex:i,newIndex:o}),a)}},D[un]={canUndo:!1,execute:function(t,n){var e,i,r,e,n,o,a,i=n.sheetName,r=n.targetIndex,e=n.newName,n=n.includeBindingSource,o=t.Gm(i);return t.ki(T.Events.SheetChanging,{sheetName:e,propertyName:"insertSheet",cancel:!1,sheetIndex:r,sheetPosition:t.getSheetPosition(e)}),t.ki(T.Events.ActiveSheetChanging,{oldSheet:o,newSheet:a,cancel:!1}),a=t.clone(i,r,e,n),!x(a)&&(t.ki(T.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:r,sheetPosition:t.getSheetPosition(a.name())}),t.ki(T.Events.ActiveSheetChanged,{oldSheet:o,newSheet:a}),t.sheetTabStyles.all()[i]&&(t.sheetTabStyles.O2e[a.name()]=t.sheetTabStyles.all()[i],null!=(e=t.w2))&&e.Cg(),!0)}},D[sn]={canUndo:!1,execute:function(t,n){for(var t,e,i,r,o,a,u,s,c,c,f,l,h,t=t,e="gc.spread.",i="gc.spread.contextMenu.allSheets",r="sheetTab",o=[],a=t.qv(),s=0;s<a.length;s++)a[s].visible()===A.SheetTabVisible.visible&&(c=21<a[s].name().length?a[s].name().substr(0,18)+"...":a[s].name(),c={text:c=z.dI(c),name:e+a[s].name(),command:i,workArea:r,itemClass:"",title:a[s].name()},a[s].b2()&&(u=s,c.itemClass="gc-ui-contextmenu-menuitem-all-sheets-select-sheets-background-color"),o.push(c));return f=(0,T.jf)(t),t.ki(T.Events.ActiveSheetChangingInternal,l={oldSheet:f,newSheet:f,needTriggerSheetChange:!0}),h={items:o,mouseEvent:n.mouseEvent,cancel:!1},t.ki(T.Events.SheetTabAllSheetsListContextMenuOpening,h),!h.cancel&&(t.contextMenu.openAllSheetsListContextMenu(o,t,n.mouseEvent,u),t.ki(T.Events.SheetTabAllSheetsListContextMenuOpened,h),t.ki(T.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:f}),!0)}},D[cn]={canUndo:!1,execute:function(t,n,e){return o(t,H.OpenPasteSpecialDialogActive,n,e)}},f.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf.name(),range:t.Z5,dataType:t.W5,cellsData:t.Q5}},f.prototype.fromJSON=function(t,n){var e,i,e=t.sheetName,i=n;"Workbook"===n.constructor.name&&(i=n.getSheetFromName(e)),this.Mf=i,this.Z5=t.range,this.W5=t.dataType,this.Q5=t.cellsData},f.prototype.J5=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,h,T,T,A,A,t=this,n=t.Z5,e=t.Mf;if(e&&n){if(i=t.W5,r=n.row,o=n.col,a=E(n),u=R(n),s=t.Q5,c=!1,-1===r&&(c=!0,r=0,a=j(e)),-1===o&&(c=!0,o=0,u=O(e)),l=[],0<(64&i))for(d=0;d<u;d++)l[d]=e.vI(-1,d)||k;for(v=0;v<a;v++)for(m=r+v,0<(64&i)&&(f=e.vI(m,-1)||k),g=0;g<u;g++){if(p=void 0,b=o+g,I&&0<(2&i)&&e.getFormulaInformation&&(p=e.getFormulaInformation(m,b,3)).hasFormula)if(p.isArrayFormula){if((w=p.baseRange).row===m&&w.col===b)for(y=w.row,M=w.row+E(w);y<M;y++)for(C=w.col,S=w.col+R(w);C<S;C++)t.mI(s,y-r,C-o,p,2)}else t.mI(s,v,g,p.formula,2);!(0<(1&i))||p&&p.hasFormula||t.mI(s,v,g,e.getValue(m,b,3),1),0<(16&i)&&e.getSparkline&&(h=e.getSparkline(m,b),T=k,h&&(x(h.data())&&h.data(h.gI),T=h.data()),h)&&T&&t.mI(s,v,g,h,16),0<(64&i)&&(T=void 0,T=c?e.getActualStyle(m,b,3):(h=e.vI(m,b)||k,e.getCompositeStyle(m,b,3,h,f,l[g])),A=_,T&&T.toJSON&&(A=JSON.stringify(T.toJSON(3,!0))),t.mI(s,v,g,A,64)),A=e.Ut.pI,0<(4&i)&&A&&t.mI(s,v,g,A.get(m,b),4),0<(128&i)&&t.mI(s,v,g,e.getTag(m,b,3),128),0<(256&i)&&t.mI(s,v,g,e.getBindingPath&&e.getBindingPath(m,b,3),256),0<(1024&i)&&t.mI(s,v,g,e.getHyperlink&&e.getHyperlink(v,g,3),1024),0<(2048&i)&&t.mI(s,v,g,e.getDefaultValue(m,b,3),2048),0<(4096&i)&&t.mI(s,v,g,e.getAltText(v,g,3),4096)}}},f.prototype.bI=function(){return this.Q5},f.prototype.mI=function(t,n,e,i,r){!x(i)&&t&&(t[n]===_&&(t[n]=[]),t[n][e]===_&&(t[n][e]={}),t[n][e][u[r]]=i)},f.prototype.yI=function(t){var n,e,i,r,o,a,u,s,c;if(t)for(e=(n=this).Q5,i=0,r=t.length;i<r;i++)if(o=t[i])for(a=0,u=o.length;a<u;a++)(s=o[a])&&(e[i]||(e[i]=[]),(c=e[i][a])?n.wI(s,c)&&(e[i][a]=_):e[i][a]=s)},f.prototype.wI=function(t,n){var e,i,r,o,a,e=this.W5,i=[];for(256&e&&i.push(u[256]),4&e&&i.push(u[4]),2&e&&i.push(u[2]),16&e&&i.push(u[16]),64&e&&i.push(u[64]),128&e&&i.push(u[128]),1024&e&&i.push(u[1024]),2048&e&&i.push(u[2048]),4096&e&&i.push(u[4096]),1&e&&i.push(u[1]),r=0,o=i.length;r<o;r++)if(t[a=i[r]]!==n[a])return!1;return!0},f.prototype.MI=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.Z5.row,e=t.Z5.col,i=t.Q5,r=t.K5;if(!(r&&0<r.length)){for(r=[],n=-1===n?0:n,e=-1===e?0:e,o=0,a=i.length;o<a;o++)if(u=i[o])for(s=0,c=u.length;s<c;s++)u[s]&&r.push({row:o+n,col:s+e});t.K5=r}return r},ln=f,t.ChangedCells=ln,D.CI=ln,D.SI=function(t,n,e,i,r,o,a,u,s,c){t&&(n<0&&(n=0,i=j(t)),e<0&&(e=0,r=O(t)),t.SI(n,e,i,r,o,a,_,_,u,s,c))},D.TI=function(t){return"changes"+t},D.AI=function(t){return t&&(0!==t.length||!w.isEmptyObject(t))},D.lM=function(n){var t,e,e=n.sheetName;return"string"==typeof e?t=[e]:Array.isArray(e)&&(t=e),!!t&&t.every(function(t){var t,t,t=D.TI(t),t=n[t];return t&&0===t.length&&w.isEmptyObject(t)})},D.startTransaction=function(t,n){le(t,n.sheetName).forEach(function(t){t.Ut.startTransaction()})},D.endTransaction=function(t,e){le(t,e.sheetName).forEach(function(t){var n=D.TI(t.name());e[n]=t.Ut.endTransaction()})},D.undoTransaction=function(t,e){le(t,e.sheetNames||e.sheetName).forEach(function(t){var n=D.TI(t.name());t.Ut.undo(e[n]),t.zw()})},D.II=function(t){t.forEach(function(t){var t=he(t);t&&t.Ut.startTransaction()})},D.startTransactionAll=function(t){D.II(t)},D.xI=function(t,i){var r=[];t.forEach(function(t){var t,n,e,t,t=he(t);t&&(n=t.name(),e=D.TI(n),t=t.Ut.endTransaction())&&(i[e]=t,r.push(n))}),i.sheetNames=r},D.endTransactionAll=function(t,n){D.xI(t,n)},D.NI=function(t,e){t.forEach(function(t){var t,n,t=he(t);t&&(t.Nj=!0,n=D.TI(t.name()),t.Ut.undo(e[n]),t.Nj=!1)})},D.ActionBase=r.ActionBase,An=r.ActionBase,e(ge,An),ge.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,t=this,n=!1;if(t.canExecute()&&(e=t.tT,i=t.Mf,r=e.columns,o=e.rowHeader,a=r&&r.length,i)&&0<a){if(u=t.kI(r),s={sheet:i,sheetName:i.name(),colList:u,header:o,cancel:!1},i.ki(y,s),!0===s.cancel)return n;e.DI=!0,i.Ut.startTransaction(),t.X5(i);try{for(c=2,f=3,l=O(i,o?2:3),i.Ab=e.Ab,h=e.size,d=0;d<a;d++)for(m=(v=r[d]).firstCol,g=v.lastCol,p=m;p<=g;p++)0<=p&&p<l&&(o&&i.getColumnResizable(p,2)&&h!==i.Do(p,2)?(i.setColumnWidth(p,h,2),n=!0):!o&&i.getColumnResizable(p,3)&&h!==i.Do(p,3)&&(i.setColumnWidth(p,h,3),n=!0))}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(M,{sheet:i,sheetName:i.name(),colList:u,header:e.rowHeader}),me(i,r[0].firstCol),i.ow(),F(i),e[b=D.TI(i.name())]=i.Ut.endTransaction()}}return n},ge.prototype.undo=function(){var t,n,e,i,r,o,a,a,r,u,t=this,n=!1;if(t.canUndo()&&(e=t.tT,i=t.Mf,r=e.columns,o=e.rowHeader,a=r&&r.length,i)&&0<a){if(a=t.kI(r),r={sheet:i,sheetName:i.name(),colList:a,header:o,cancel:!1},i.ki(y,r),!0===r.cancel)return n;t.X5(i);try{u=D.TI(i.name()),i.Ut.undo(e[u]),i.Zw=!0,i.showCell(i.getActiveRowIndex(),i.getActiveColumnIndex(),1,1),i.Ab=e.Ab,n=!0}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(M,{sheet:i,sheetName:i.name(),colList:a,header:e.rowHeader}),F(i)}}return n},ge.prototype.kI=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstCol,a=r.lastCol,u=o;u<=a;u++)n.push(u);return n},ge.prototype.canUndo=function(){return this.tT.DI},hn=ge,In=r.ActionBase,e(pe,In),pe.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,t=this,n=!1;if(t.canExecute()&&(e=t.Mf,o=(r=(i=t.tT).rows)&&r.length,e)&&0<o){if(a=t._I(r),u={sheet:e,sheetName:e.name(),rowList:a,header:i.columnHeader,cancel:!1},e.ki(C,u),!0===u.cancel)return n;i.DI=!0,e.Ut.startTransaction(),t.X5(e);try{for(s=3,c=1,l=j(e,(f=i.columnHeader)?1:3),e.Tb=i.Tb,h=i.size,d=0;d<o;d++)for(m=(v=r[d]).firstRow,g=v.lastRow,p=m;p<=g;p++)0<=p&&p<l&&(f&&e.getRowResizable(p,1)&&h!==e._o(p,1)?(e.setRowHeight(p,h,1),n=!0):!f&&e.getRowResizable(p,3)&&h!==e._o(p,3)&&(e.setRowHeight(p,h,3),n=!0))}finally{L(e),w[w.sd]({jS:e.parent}),e.ki(S,{sheet:e,sheetName:e.name(),rowList:a,header:i.columnHeader}),ve(e,r[0].firstRow),e.tw(),F(e),i[b=D.TI(e.name())]=e.Ut.endTransaction()}}return n},pe.prototype.undo=function(){var t,n,e,i,r,o,o,r,a,t=this,n=!1;if(t.canUndo()&&(e=t.Mf,o=(r=(i=t.tT).rows)&&r.length,e)&&0<o){if(o=t._I(r),r={sheet:e,sheetName:e.name(),rowList:o,header:i.columnHeader,cancel:!1},e.ki(C,r),!0===r.cancel)return n;t.X5(e);try{a=D.TI(e.name()),e.Ut.undo(i[a]),e.Ww=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),e.Tb=i.Tb,n=!0}finally{L(e),w[w.sd]({jS:e.parent}),e.ki(S,{sheet:e,sheetName:e.name(),rowList:o,header:i.columnHeader}),F(e)}}return n},pe.prototype._I=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstRow,a=r.lastRow,u=o;u<=a;u++)n.push(u);return n},pe.prototype.canUndo=function(){return this.tT.DI},dn=pe,xn=r.ActionBase,e(be,xn),be.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=!1,e=t.tT,i=t.Mf,r=e.columns,o=e.rowHeader,a=t.kI(r);if(i&&r&&0<r.length){if(u={sheet:i,sheetName:i.Zc,colList:a,header:o,cancel:!1},i.ki(y,u),!0===u.cancel)return n;i.Ut.startTransaction(),t.X5(i);try{s=J(e.size),c=o?2:3,f=r[0].firstCol,d=h=l=void 0,s!==(l=i.Do(f,c))&&(h=s-l,d=i.O5(f,c),i.setColumnWidth(f,s,c),i.setColumnWidth(d,i.Do(d,c)-h,c)),n=!0}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(M,{sheet:i,sheetName:i.Zc,colList:a,header:e.rowHeader}),F(i),e[v=D.TI(i.name())]=i.Ut.endTransaction()}}return n},be.prototype.undo=function(){var t,n,e,i,r,n,r,o,t=this.Mf,n=this.tT.columns,e=!1,i=this.tT,r=this.tT.rowHeader,n=this.kI(n),r={sheet:t,sheetName:t.Zc,colList:n,header:r,cancel:!1};if(t.ki(y,r),!0!==r.cancel){this.X5(t);try{o=D.TI(t.name()),t.Ut.undo(i[o]),e=!0}finally{L(t),w[w.sd]({jS:t.parent}),t.ki(M,{sheet:t,sheetName:t.Zc,colList:n,header:i.rowHeader}),F(t)}}return e},be.prototype.kI=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstCol,a=r.lastCol,u=o;u<=a;u++)n.push(u);return n},vn=be,Nn=r.ActionBase,e(we,Nn),we.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=!1,e=t.tT,i=t.Mf,r=e.rows,o=e.columnHeader,a=t._I(r);if(i&&r&&0<r.length){if(u={sheet:i,sheetName:i.Zc,rowList:a,header:o,cancel:!1},i.ki(C,u),!0===u.cancel)return n;i.Ut.startTransaction(),t.X5(i);try{s=J(e.size),c=o?1:3,f=r[0].firstRow,d=h=l=void 0,s!==(l=i._o(f,c))&&(h=s-l,d=i.j5(f,c),i.setRowHeight(f,s,c),i.setRowHeight(d,i._o(d,c)-h,c)),n=!0}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(S,{sheet:i,sheetName:i.Zc,rowList:a,header:e.columnHeader}),F(i),e[v=D.TI(i.name())]=i.Ut.endTransaction()}}return n},we.prototype.undo=function(){var t,n,e,i,r,n,r,o,t=this.Mf,n=this.tT.rows,e=!1,i=this.tT,r=this.tT.columnHeader,n=this._I(n),r={sheet:t,sheetName:t.Zc,rowList:n,header:r,cancel:!1};if(t.ki(C,r),!0!==r.cancel){this.X5(t);try{o=D.TI(t.name()),t.Ut.undo(i[o]),e=!0}finally{L(t),w[w.sd]({jS:t.parent}),t.ki(S,{sheet:t,sheetName:t.Zc,rowList:n,header:i.columnHeader}),F(t)}}return e},we.prototype._I=function(t){for(var n,e,i,r,o,a,u,n=[],e=0,i=t.length;e<i;e++)for(o=(r=t[e]).firstRow,a=r.lastRow,u=o;u<=a;u++)n.push(u);return n},mn=we,kn=r.ActionBase,e(l,kn),l.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.columns&&0<t.columns.length},l.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t=this,n=!1;if(t.canExecute()){if(e=t.tT,i=t.Mf,r=t.nT,o=t.kI(e.columns),a=2===r,u={sheet:i,sheetName:i.name(),colList:o,header:a,cancel:!1},i.ki(y,u),!0===u.cancel)return n;for(e.DI=!0,c=(s=O(i,r))-1,l=void(f=0),h=0,d=e.columns.length;h<d;h++)c=(l=e.columns[h].col)<c?l:c,f=f<l?l:f;T.Be.Ll(i,0,c,j(i)-1,f),i.Ut.startTransaction(),t.X5(i);try{for(v=void 0,h=0,d=e.columns.length;h<d;h++)0<=(m=e.columns[h].col)&&m<s&&i.getColumnResizable(m,r)&&((v=t.qf(m))===i.getColumnWidth(m,r)&&x(i.getColumnWidth(m,r,!0))||(i.setColumnWidth(m,v,r),n=!0))}finally{T.Be.dl(),L(i),w[w.sd]({jS:i.parent}),i.ki(M,{sheet:i,sheetName:i.name(),colList:o,header:a}),F(i),e[g=D.TI(i.name())]=i.Ut.endTransaction()}}return n},l.prototype.undo=function(){var t,n,e,i,r,o,r,a,u,t=this,n=!1;if(t.canUndo()){if(e=t.tT,i=t.Mf,r=t.nT,o=t.kI(e.columns),r=2===r,a={sheet:i,sheetName:i.name(),colList:o,header:r,cancel:!1},i.ki(y,a),!0===a.cancel)return n;t.X5(i);try{u=D.TI(i.name()),i.Ut.undo(e[u]),n=!0}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(M,{sheet:i,sheetName:i.name(),colList:o,header:r}),F(i)}}return n},l.prototype.kI=function(t){for(var n,e,i,n=[],e=0;e<t.length;e++)i=t[e],n.push(i.col);return n},l.prototype.qf=function(t){return T.mt.qf(t,this.Mf,this.nT,this.tT.autoFitType)},l.prototype.canUndo=function(){return this.tT.DI},gn=l,_n=r.ActionBase,e(h,_n),h.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.rows&&0<t.rows.length},h.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,t=this,n=!1;if(t.canExecute()){if(e=t.tT,i=t.Mf,r=t._I(e.rows),o=t.nT,a=1===t.nT,u={sheet:i,sheetName:i.name(),rowList:r,header:a,cancel:!1},i.ki(C,u),!0===u.cancel)return n;e.DI=!0,i.Ut.startTransaction(),t.X5(i);try{for(s=j(i,o),c=void 0,f=0,l=e.rows.length;f<l;f++)0<=(h=e.rows[f].row)&&h<s&&i.getRowResizable(h,o)&&((c=t.e0(h))===i.getRowHeight(h,o)&&x(i.getRowHeight(h,o,!0))||(i.setRowHeight(h,c,o),n=!0))}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(S,{sheet:i,sheetName:i.name(),rowList:r,header:a}),F(i),e[d=D.TI(i.name())]=i.Ut.endTransaction()}}return n},h.prototype.undo=function(){var t,n,e,i,r,o,a,u,t=this,n=!1;if(t.canUndo()){if(e=t.tT,i=t.Mf,r=t._I(e.rows),o=1===t.nT,a={sheet:i,sheetName:i.name(),rowList:r,header:o,cancel:!1},i.ki(C,a),!0===a.cancel)return n;t.X5(i);try{u=D.TI(i.name()),i.Ut.undo(e[u]),n=!0}finally{L(i),w[w.sd]({jS:i.parent}),i.ki(S,{sheet:i,sheetName:i.name(),rowList:r,header:o}),F(i)}}return n},h.prototype._I=function(t){for(var n,e,i,r,n=[],e=0,i=t.length;e<i;e++)r=t[e],n.push(r.row);return n},h.prototype.e0=function(t){return T.mt.e0(t,this.Mf,this.nT,this.tT.autoFitType)},h.prototype.canUndo=function(){return this.tT.DI},pn=h,Dn=r.ActionBase,e(v,Dn),v.prototype.canExecute=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=t.tT,i=e.ranges,r=e.row,o=e.col,a={lockErrorMsg:t.kTe(),sheetArea:e.sheetArea,invalidType:13};if(i){for(u=0;u<i.length;u++)if(s=i[u],!n.PT(s.row,s.col,E(s),R(s),a))return!1}else if(!n.PT(r,o,1,1,a))return!1;return!0},v.prototype.kTe=function(){return k},v.prototype.EI=function(t){var n,e,i,r,o,a,u,n,e=this.tT,i=e.ranges;if(i)for(r=0;r<i.length;r++)for(a=(o=i[r]).row;a<o.row+E(o);a++)for(u=o.col;u<o.col+R(o);u++)t(a,u);else t(e.row,e.col)},v.prototype.execute=function(){var t,n,e,i,t=this,n=!1;if(t.canExecute()){e=t.Mf,t.X5(e,!0),i=void 0;try{i=t._Te(),t.tT.applyResult=t.jI(),n=!0}catch(t){n=!1}finally{t.DTe(i),t.q5(e,!0)}}return n},v.prototype._Te=function(){return[]},v.prototype.DTe=function(t){},v.prototype.jI=function(){return 0},v.prototype.LI=function(t,n,e,i,r){var o,a,o,u,a,t,n,u,e,o=this,a=o.Mf,o=o.tT,u=o.ignoreFormatting,a=a.getActualStyle(t,n),t={},n="string"!=typeof e||u?e:e&&"'"===e[0]?e.substring(1):T.mt.Xf(a,e,i,t,o.editingFormatter);return r.quotePrefix?(r._autoFormatter=_,r.GI=!0):(u=t.value,i&&u&&((n===(e=k)||"General"===u.formatString())&&a._autoFormatter||(u.isAuto=!0,e=u),e)&&(r.GI=!0,r._autoFormatter=e)),n},v.prototype.HI=function(t,n,e,i){var r,o,t,n,a,r,o,t=this.Mf.vI(t,n),n="string"==typeof t;t&&!n||(a=new B.Style,n&&(a.parentName=t),t=a),t.quotePrefix!==e&&(i.UI=!0,i.quotePrefix=e)},e(m,jn=i=v),m.prototype.kTe=function(){return this.Mf.FT()},m.prototype.undo=function(){var t,e,n,i,t=this;if(t.canUndo()){e=t.Mf,n=t.tT,t.X5(e,!0);try{e.D3(Z+fn,function(t,n){ye(e,n)}),i=D.TI(e.name()),e.Ut.undo(n[i])}catch(t){return!1}finally{e._3(Z+fn),t.q5(e,!0)}return!0}return!1},m.prototype._Te=function(){var e,t,e=this.Mf,t=e.parent.i4();return D.II(t),e.D3(Z+fn,function(t,n){ye(e,n)}),t},m.prototype.DTe=function(t){var n=this,e;n.Mf._3(Z+fn),D.xI(t,n.tT)},m.prototype.RI=function(t){var n,e,i,r,o,a,u,s,c,r,u,f,r,u,l,n=this,e=0,i=n.Mf,r=n.tT,o=r.row,a=r.col,u=r.sheetArea,s=r.newValue,c=!r.hasOwnProperty("autoFormat")||r.autoFormat;if(I&&!0!==r.ignoreFormula&&(0,T.kf)(s)){if(i.getDataValidator&&i.getDataValidator(o,a,u)&&""!==(r="="===s[0]?s.substring(1):s)&&r!==i.getFormula(o,a,u)&&(u=i.op())){f=void 0;try{f=u.parse(i.Uw(),r,0<=o?o:0,0<=a?a:0,!0)}catch(t){e=i.GA(o,a,s)}f&&(r=u.evaluateParsedFormula(i.Uw(),f,{row:o,col:a}),i.isValid)&&!i.isValid(o,a,r,!1)&&(e=i.GA(o,a,r))}}else u=n.LI(o,a,s,c,t),(l=!i.isValid||i.isValid(o,a,u,!1))||(e=i.GA(o,a,u),i.rt.FI=!0);return e},m.prototype.jI=function(){var t,i,n,r,o,e,a,u,s,e,c,f,l,h,d,v,m,g,l,p,b,w,w,l,b,n,d,t=this,i=t.Mf,n=t.tT,r=n.sheetArea,o=n.newValue,e=n.ignoreValidate,a={GI:!1,UI:!1,_autoFormatter:_,quotePrefix:_},u=0;if(!0===e||1!==(u=t.RI(a))&&2!==u){if(e=!n.hasOwnProperty("autoFormat")||n.autoFormat,c=0<=(c=n.row)?c:0,f=0<=(f=n.col)?f:0,l=I&&G&&G.Parser,m=i.parent,!(g=i.NMi&&3===r)&&l)if(v=i.op(),l=m&&m.options.allowUserEditFormula,b=!1,"@"!==(p=i.getFormatter(c,f,r))&&l&&v&&!0!==n.ignoreFormula&&(0,T.kf)(o)){"="===o[0]&&(o=o.substring(1),b=!0);try{if(w={row:c,col:f,sheetArea:r,text:o,isAllow:!0},P.Worksheet.et(i,"applyEditingSetFormula",w),w.isAllow){if(n.ranges&&1===n.endEditType)return d=n.ranges[0],i.setArrayFormula(d.row,d.col,E(d),R(d),o,r),u;h=v.parse(i.Uw(),o,c,f,!0)}}catch(t){if(!m||!m.options.allowInvalidFormula)throw i.jT(0,"string"==typeof t?t:t.message),t;o=b?"="+o:o}}else n.ranges&&1===n.endEditType&&(d=n.ranges[0],i.getRange(d.row,d.col,E(d),R(d),r).clear(1));h||(o&&"'"===o[0]?t.HI(c,f,!0,a):t.HI(c,f,_,a),s=t.LI(c,f,o,e,a)),t.EI(function(n,e){if(h)try{var t=v.unparse(i.Uw(r),h,n,e);i.zI(n,e,t,h,_,r),i.ki(T.Events.UserFormulaEntered,{sheet:i,sheetName:i.name(),row:n,col:e,isCircularReference:i.VI(n,e),formula:t}),m&&m.options.formulaFormatHint&&(0,U.Fue)(i,m,h,c,f)}catch(t){throw i.jT(0,"string"==typeof t?t:t.message),t}else{try{i.hasFormula&&i.hasFormula(n,e,r)&&i.setFormula(n,e,k,r)}catch(t){throw i.jT(0,"string"==typeof t?t:t.message),t}try{i.YI(n,e,s,r),"string"!=typeof s&&null!==s||P.Worksheet.et(i,"setHyperlinkWhenEditing",{url:s,row:n,col:e,sheetArea:r})}catch(t){i.setValue(n,e,o,r)}}}),l=a.UI,((w=a.GI)||l)&&(n="string"==typeof(b=i.vI(c,f,r)),b&&!n||(d=new B.Style,n&&(d.parentName=b),b=d),w&&!g&&(b._autoFormatter=a._autoFormatter),l&&(b.quotePrefix=a.quotePrefix),i.setStyle(c,f,b,r))}return u},m.prototype.canUndo=function(){return 0===this.tT.applyResult},bn=m,e(Me,On=i),Me.prototype.jI=function(){var t,i,n,r,o,e,a,u,s,c,f,l,h,d,v,l,m,g,p,b,w,y,M,C,S,n,l,v,g,s,t=this,i=t.Mf,n=t.tT,r=n.sheetArea,o=n.newValue,e={GI:!1,UI:!1,_autoFormatter:_,quotePrefix:_},a=0,s=!n.hasOwnProperty("autoFormat")||n.autoFormat,c=n.row;if(c=0<=c?c:0,f=0<=(f=n.col)?f:0,l=I&&G&&G.Parser,v=i.parent,l&&(d=i.op(),l=v&&v.options.allowUserEditFormula,g=!1,"@"!==(m=i.getFormatter(c,f,r)))&&l&&d&&!0!==n.ignoreFormula&&(0,T.kf)(o)){"="===o[0]&&(o=o.substring(1),g=!0);try{b=c,w=f,y=r,M=o,(C=!0)&&(h=d.parse(i.Uw(),o,c,f,!0))}catch(t){v&&v.options.allowInvalidFormula&&(o=g?"="+o:o)}}return h||(o&&"'"===o[0]?t.HI(c,f,!0,e):t.HI(c,f,_,e),u=t.LI(c,f,o,s,e)),S=i.Ut,t.EI(function(n,e){if(h)try{var t=d.unparse(i.Uw(r),h,n,e);S.setDefaultValue(n,e,t,r,A.DefaultChangeValueType.Expression)}catch(t){}else try{S.setDefaultValue(n,e,u,r,A.DefaultChangeValueType.Value)}catch(t){S.setDefaultValue(n,e,o,r,A.DefaultChangeValueType.Value)}}),l=e.UI,((n=e.GI)||l)&&(g="string"==typeof(v=i.vI(c,f,r)),v&&!g||(s=new B.Style,g&&(s.parentName=v),v=s),n&&(v._autoFormatter=e._autoFormatter),l&&(v.quotePrefix=e.quotePrefix),i.setStyle(c,f,v,r)),0},wn=Me,En=r.ActionBase,e(Te,En),Te.prototype.canUndo=function(){return!!this.tT.oldName},Te.prototype.canExecute=function(){var t,n,t=this,n=t.tT;return t.Mf&&n.name&&n.name!==n.oldName},Te.prototype.execute=function(){var t,n,e,i,r,o,a,u,u,s,c,t=this,n=t.Mf,e=t.tT,i=e.name,r=!1;return t.canExecute()&&(o=n.name(),n.ki(T.Events.SheetNameChanging,u={sheet:n,oldValue:o,newValue:a=i,cancel:!1}),!1===u.cancel)&&(u=n.parent.sheets,D.II(u),s=null,n.parent.options&&n.parent.options.saveChangesForSheet&&Se(s=n.getCrossSheetReferences(),!0),e.oldName=o,t.X5(n,!0),Vn(n),n.ub(i),Ce(n),s&&Se(s,!1),D.xI(u,e),r=!0,e.sheetName=i,zn(n,!1),t.q5(n,!0),n.ki(T.Events.SheetNameChanged,c={sheet:n,oldValue:o,newValue:a})),r},Te.prototype.undo=function(){var t,n,e,i,r,o,o,a,t=this;return!(!t.canUndo()||(n=t.Mf,i=(e=t.tT).name,r=e.oldName,n.ki(T.Events.SheetNameChanging,o={sheet:n,oldValue:i,newValue:r,cancel:!1}),!1!==o.cancel)||(t.X5(n,!0),Vn(n),o=D.TI(n.name()),n.Ut.undo(e[o]),Ce(n),e.sheetName=e.oldName,zn(n,!1),t.q5(n,!0),n.ki(T.Events.SheetNameChanged,a={sheet:n,oldValue:i,newValue:r}),0))},yn=Te,Rn=r.ActionBase,e(Ae,Rn),Ae.prototype.canExecute=function(){var t,n,t=this,n=T.mt.ige(t.tT.zoomFactor);return t.Mf&&t.Mf.parent.options.allowUserZoom&&t.Mf.zoom()!==n},Ae.prototype.execute=function(){var t,n,e,t,i,r,o,a,t=this,n=t.tT,e=!1;return t.canExecute()&&(i=(t=t.Mf).Ut,r=n.zoomFactor,o=n.oldZoomFactor,i.startTransaction(),e=Ie(t,r),t.Oj(r,o),i.ZI(["zoomChanged",o,r]),n[a=D.TI(t.name())]=t.Ut.endTransaction()),e},Ae.prototype.undo=function(){var t,n,t=this.Mf;if(this.canUndo())return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),n=D.TI(t.name()),t.Ut.undo(this.tT[n]),t.resumePaint(),0))},Mn=Ae,Fn=r.ActionBase,e(g,Fn),g.prototype.execute=function(){var t,n,e,i,r,o,o,e,a,u,o,r,r,r,t=this,n=t.Mf;t.canExecute()&&n&&(e=t.tT.clearRange,i=n.tables&&n.tables.WI&&n.tables.WI(e.row,e.col,e.rowCount,e.colCount),r=!!n.isReportTemplateSheet,n.isDirtySuspended()||(o=1027|(r?256:0),t.tT.K5=new ln(n,n.JS(e),o)),i&&0<i.length&&(t.tT.tableNames=i),e=(o=n.JS(e)).row,a=o.col,u=E(o),0<(o=R(o)))&&0<u&&(n.Ut.startTransaction(),t.X5(n),n.QI=!0,r=A.StorageType.data|A.StorageType.hyperlink|(r?A.StorageType.bindingPath:0),n.KI(e,a,u,o,3,r,!0),t.q5(n),n.QI=!1,r=D.TI(n.name()),t.tT[r]=n.Ut.endTransaction(),r=t.tT.K5,D.SI(n,e,a,u,o,r?r.MI():[],2,i))},g.prototype.canExecute=function(){var t=this.tT.clearRange;return this.Mf&&this.Mf.PT(t.row,t.col,E(t),R(t),{sheetArea:A.SheetArea.viewport})},g.prototype.canUndo=function(){var t,t;if(this.Mf)return t=D.TI(this.Mf.name()),t=this.tT[t],D.AI(t)},g.prototype.undo=function(){var t,n,e,i,i,t=this,n=t.Mf;if(t.canUndo()&&n&&0<R(e=n.JS(t.tT.clearRange))&&0<E(e)){t.X5(n),n.QI=!0;try{i=D.TI(n.name()),n.Ut.undo(t.tT[i])}finally{t.q5(n),n.QI=!1}return i=t.tT.K5,D.SI(n,e.row,e.col,E(e),R(e),i?i.MI():[],2,t.tT.tableNames,!0),!0}return!1},g.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},g.prototype.fromJSON=function(t){var n,e,i,n=this,e=t.sheetName;n.Mf&&!x(e)&&(i=n.Mf.parent,n.Mf=i.getSheetFromName(e)),n.tT=t.command},Cn=g,D.ClearRangeValueUndoAction=Cn,Ln=r.ActionBase,e(xe,Ln),xe.prototype.canExecute=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canExecute())return!1;return!0}return!1},xe.prototype.execute=function(){var t,n,e,i,r,t=this;if(t.canExecute()&&(n=t.tT.cachedActions,e=t.Mf,n)){for(t.X5(e,!0),i=0;i<n.length;i++)(r=n[i]).execute();return t.q5(e,!0),!0}return!1},xe.prototype.canUndo=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canUndo())return!1;return!0}return!1},xe.prototype.undo=function(){var t,n,e,i,r,r,t=this,n=t.tT.cachedActions;if(t.canUndo()){for(e=t.Mf,i=n.length-1;0<=i;i--)if(r=n[i],t.X5(e,!0),r=r.undo(),t.q5(e,!0),!r)return!1;return!0}return!1},Sn=xe,D.JI=Sn},"./dist/core/worksheet/worksheet-border.js":function(x,t,n){"use strict";var e,N,i,V,k,_,z,Y,j,v,O,Z,W,h,Q,E,o,J,R,w,y,M,C,L,m,g,p,b,S,T,A,B,n,f,c,P,l,G,F,U,H,K,X,q,$,tt;function r(){}function nt(t,n,e,i,r,o,a,u){var s,o,c,f,s=K.call(this)||this,o=J(u)||1===u?o:h(o*u),c;return o%2||(t!==e?(n-=.5,i-=.5):(t-=.5,e-=.5)),(f=s).Ix=t,f.xx=n,f.Nx=e,f.Dx=i,f._x=r,f.Ex=o,f.jx=a,f._zoomFactor=u,s}function a(t,n,e,i,r,o,a,u,s){var c,o,f,l,c=X.call(this)||this,o=J(s)||1===s?o:h(o*s),f;return o%2||(t!==e?(n-=.5,i-=.5):(t-=.5,e-=.5)),(l=c).Ix=t,l.xx=n,l.Nx=e,l.Dx=i,l._x=r,l.Ex=o,l.Ox=a,l.jx=u,l._zoomFactor=s,c}function et(t,n,e,i,r,o,a,u,s){var c,f,c=q.call(this)||this;return o?(--t,--e):(--n,--i),(f=c).Ix=t,f.xx=n,f.Nx=e,f.Dx=i,f._x=r,f.Rx=o,f.Ex=1,f.Bx=a,f.Lx=u,f.jx=s,c}function u(t,n,e,i,r,o,a){var u,s,u=$.call(this)||this,s=u;return s.Ix=t,s.xx=n,s.Nx=e,s.Dx=i,s._x=r,s.Fx=o,s.jx=a,s.Px=new f(s.Ix,s.xx,s.Nx,s.Dx,r,1,a),s.Gx=null,u}function s(t,n,e,i,r,o){var a,u,s,c,a=tt.call(this)||this,u=a,s=0,c=0;return t===e&&(s=1),n===i&&(c=1),t!==e&&n!==i?o?(u.Px=new f(t-(s=2),n,e-s,i,r,1,o),u.Gx=new f(t+s,n,e+s,i,r,1,o)):(c=s=2,e<t?(u.Px=new l(t-s,n,e,i-c,r,!1,o),u.Gx=new l(t,n+c,e+s,i,r,!1,o)):(u.Px=new l(t,n+c,e-s,i,r,!0,o),u.Gx=new l(t+s,n,e,i-c,r,!0,o))):(u.Px=new f(t-s,n-c,e-s,i-c,r,1,o),u.Gx=new f(t+s,n+c,e+s,i+c,r,1,o)),u.jx=o,u._x=r,u.Ex=1,a}function D(t,n,e,i,r,o,a,u,s){switch(void 0===u&&(u=1),s&&(s.x>t&&(t=s.x),s.y>n)&&(n=s.y),o=o!==z&&o!==Y?o:1){case 1:return new f(t,n,e,i,r,1,a);case 2:return new f(t,n,e,i,r,2,a,u);case 5:return new f(t,n,e,i,r,3,a,u);case 3:return new c(t,n,e,i,r,1,[3,1],a);case 9:return new c(t,n,e,i,r,1,[8,2,2,2],a);case 4:return new c(t,n,e,i,r,1,[2,2],a);case 11:return new c(t,n,e,i,r,1,[9,3,3,3,3,3],a);case 13:return new P(t,n,e,i,r,t!==e,[11,1,5,1],[10,2,4,2],a);case 10:return new c(t,n,e,i,r,2,[9,3,3,3],a,u);case 12:return new c(t,n,e,i,r,2,[9,3,3,3,3,3],a,u);case 8:return new c(t,n,e,i,r,2,[9,3],a,u);case 7:return new c(t,n,e,i,r,1,[1],a);case 6:return new G(t,n,e,i,r,a)}return Y}function I(){}function d(t,n,e,i){var r=this;r.Ux=!1,r.Hx=!1,r.Mf=t,r.nT=i,r.zx=n,r.Vx=e,r.JCe=new _.VisibleRowColCache(t)}e=this&&this.__extends||(H=function(t,n){return(H=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}H(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Yx=t.Zx=void 0,N=n("./dist/core/worksheet/style.js"),i=n("./dist/core/util/domUtil.js"),V=n("./dist/core/core.enum.js"),k=n("Common"),_=n("./dist/core/worksheet/helpers/visible-row-col-cache.js"),z=void 0,Y=null,j=Math.sqrt,v=Math.pow,O=Math.min,Z=Math.abs,W=Math.tan,h=Math.ceil,Q=Math.PI,E=i.GC$.inherit,o=i.GC$.isEmptyObject,J=k.Common.lt.ht,m=w=0,g=y=1,p=M=2,b=C=3,S=4,T=5,A=6,B=7,r.prototype.Wx=function(t){var n=this;0===t._orientation?(t.Kx&&(n.Nx+=t.Kx),t.Jx&&(n.Ix+=t.Jx)):(t.Kx&&(n.Dx+=t.Kx),t.Jx&&(n.xx+=t.Jx))},r.prototype._e=function(t){var n=this._x||"#9eb6ce",e=this.Ex,i=t.lineWidth,r=t.strokeStyle;i===e&&r===n||(i!==e&&(t.lineWidth=e),r!==n&&(t.strokeStyle=n)),this.Xx(t)},r.prototype.Xx=function(t){var n,e,i,e,i,n=this,e=n.Ix===n.Nx,i=n.xx===n.Dx;e&&i||(e||i?(t.beginPath(),n.qx(t),t.stroke()):(t.save(),e=Math.min(n.Ix,n.Nx),i=Math.min(n.xx,n.Dx),t.rect(e,i,Math.abs(n.Nx-n.Ix),Math.abs(n.Dx-n.xx)),t.clip(),t.beginPath(),n.qx(t),t.stroke(),t.beginPath(),t.restore()))},r.prototype.qx=function(t){var n=this;t.moveTo(n.Ix,n.xx),t.lineTo(n.Nx,n.Dx)},e(nt,K=n=r),f=nt,e(a,X=n),a.prototype.qx=function(t){var n=this;a.Dn(t,n.Ix,n.xx,n.Nx,n.Dx,n.Ox)},a.Dn=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,a=j(v(i-n,2)+v(r-e,2)),s=(i-n)/a,c=(r-e)/a,f=0,l=0;for(o=o&&o.length?o:[4,4];f<a;)f+=h=O(o[l%o.length],a-f),(d=++l%2)&&t.moveTo(n,e),n+=h*s,e+=h*c,d&&t.lineTo(n,e)},c=a,e(et,q=n),et.prototype.qx=function(t){var n,e,i,n=this,e=n.Rx?0:1,i=n.Rx?1:0;c.Dn(t,n.Ix-e,n.xx-i,n.Nx-e,n.Dx-i,n.Bx),c.Dn(t,n.Ix,n.xx,n.Nx,n.Dx,n.Lx)},P=et,e(u,$=n),u.prototype.Xx=function(t){this.Px&&this.Px.Xx(t),this.Gx&&this.Gx.Xx(t)},u.prototype.Wx=function(t){var n=this;n.Gx?(t.Jx&&n.Px&&n.Px.Wx(t),t.Kx&&n.Gx.Wx(t)):n.Px&&n.Px.Wx(t)},u.prototype.$x=function(t){var n,e,t,i,r,o,a,u,s,n=this;t&&t.severX&&t.severY?(e=t.severX||0,t=t.severY||0,e=n.Fx?e:-e,u=(i=parseInt(n.Ix+(n.Nx-n.Ix)/2,10))+e,s=(r=parseInt(n.xx+(n.Dx-n.xx)/2,10))+t,n.Px=new f(n.Ix,n.xx,o=i-e,a=r-t,n._x,1,n.jx),n.Gx=new f(u,s,n.Nx,n.Dx,n._x,1,n.jx)):(n.Px=new f(n.Ix,n.xx,n.Nx,n.Dx,n._x,1,n.jx),n.Gx=null)},l=u,e(s,tt=n),s.prototype.Xx=function(t){this.Px.Xx(t),this.Gx.Xx(t)},s.prototype.Wx=function(t){var n=this;t.tN?1===t.tN?n.Px.Wx(t):2===t.tN&&n.Gx.Wx(t):(n.Px.Wx(t),n.Gx.Wx(t))},s.prototype.$x=function(){var t,n,e,t,t=this,n={severX:1,severY:1},e=t.Px,t=t.Gx;e.$x(n),t.$x(n)},G=s,t.Zx=D,I.nN=function(t,n,e){var i,i;return t?n?0!=(i=(i=I.eN)[t.style]-i[n.style])||e?i:(n.level||0)-(t.level||0):1:n?-1:0},I.iN=function(t){var t,n,t;if(t){if(t.isGridLine)return 1;if(t.style)return n=N.LineBorder.YC(t.style),t=null==(t=t.line)?void 0:t._zoomFactor,J(t)?n:h(n*t)}return 0},I.rN=function(t){return t&&6===t.style},I.oN=function(t){return t&&13===t.style},I.aN=function(t,n){return t&&(!n||0<=I.nN(t.style,n.style))?t:n},I.uN=function(t,n){t&&t.line?t.line.Wx(n):t.Wx&&t.Wx(n)},I.sN=function(t,n,e){return t===n?0:t?n?t.isGridLine?n.isGridLine?0:-1:n.isGridLine?1:I.nN(t.style,n.style,e):1:-1},I.cN=function(t){return t&&t.style&&6===t.style.style},I.fN=function(t,n,e,i){var t;return!(!t.style||6!==t.style.style)||(t=0,(t=(t=(t+=n&&n.style&&6===n.style.style?1:0)+(e&&e.style&&6===e.style.style?1:0))+(i&&i.style&&6===i.style.style?1:0))<2)},I.lN=function(t,n,e,i,r,o){var o,e,i,o={_orientation:o?1:0,Jx:0,Kx:0},e=this.sN(t,e),i=this.sN(t,i);0<=e&&0<=i?0===e&&0===i?-1!==r&&1===r&&(o.Kx-=r):-1===r?o.Jx-=r:1===r&&(o.Kx-=2*r):0<=i?(o.tN=2,o.Jx+=r):0<=e&&(o.tN=1,o.Jx+=r),this.uN(t,o)},I.hN=function(t,n,e,i,r,o,a,u,s){var c,u,s,f,l,h,d,d,h,v,o,d,h,i,c={_orientation:u?1:0,tN:s?2:1,Jx:0,Kx:0},u={_orientation:u?1:0,tN:s?1:2,Jx:0,Kx:0},s=1===o?i:r,f=1===a?e:n,l;this.cN(f)?0===(h=this.sN(t,s))?0===(d=this.sN(t,f))?1===a&&(u.Kx-=a):0<d&&(-1===a?u.Jx-=2*a:1===a&&(u.Kx-=2*a)):0<h?0===(d=this.sN(t,f))?1===a&&(u.Kx-=a):0<d&&(-1===a?u.Jx-=2*a:1===a&&(u.Kx-=2*a)):0===(h=this.sN(t,f))?-1===a?c.Jx+=2*a:1===a&&(c.Kx+=2*a):0<h&&(-1===a?c.Jx-=3*a:1===a&&(c.Kx-=3*a)):0<=this.sN(t,s)?-1===a?u.Jx-=2*a:1===a&&(u.Kx-=2*a):-1===a?c.Jx+=2*a:1===a&&(c.Kx+=2*a),d=!1,h=0,this.cN(o=1==(v=1===o?2:1)?i:r)&&0<this.sN(o,t)&&(d=!0,i=I.iN(o),0<this.sN(o,s)?0<i&&(h=1===a&&this.cN(e)?2<=i?2:1:-1===a&&this.cN(n)?3<=i?2:1:3===i?3:2):h=3===i?3:2),d||this.cN(f)||!(f&&!f.isGridLine||o&&!o.isGridLine)||(d=!0,h=-1===a?2:1),d&&(-1===a?(c.Jx+=a*h,u.Jx+=a*h):1===a&&(c.Kx+=a*h,u.Kx+=a*h)),(c.Jx||c.Kx)&&this.uN(t,c),(u.Jx||u.Kx)&&this.uN(t,u)},I.dN=function(t,n,e,i,r,o){var e;0<=this.sN(t,e)&&0<=this.sN(t,i)&&(e={_orientation:o?1:0,Jx:0,Kx:0},-1===r?(e.Jx-=2*r,this.cN(t)&&0<this.sN(n,t)&&--e.Jx):1===r&&(e.Kx-=2*r,this.cN(t))&&0<this.sN(n,t)&&(e.Kx+=1),this.uN(t,e))},I.vN=function(t,n,e,i,r,o){var e,i,e;this.cN(t)&&(e=this.aN(e,i))&&!e.isGridLine&&0<(i=I.iN(e))&&(e={_orientation:o?1:0,Jx:0,Kx:0},-1===r?e.Jx+=i*r:e.Kx+=i*r,e.Jx||e.Kx)&&this.uN(t,e)},I.mN=function(t,n,e,i,r,o,a){var u,s,c,f,e,c=I;(n||e||i)&&(f=c.aN(e,i),c.fN(t,n,e,i)?0<(s=c.sN(f,t,!0))?(u=c.iN(f),c.cN(t)&&(c.cN(e)||c.cN(i)||c.cN(n))||3===u&&c.uN(t,{_orientation:0,Jx:1})):f&&s<0?0<(s=c.sN(t,n,!0))?3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:0,Jx:-2}):1===u&&c.uN(t,{_orientation:0,Jx:-1}):0!==s&&0<c.sN(n,f,!0)&&3===(u=c.iN(f))&&c.uN(t,{_orientation:0,Jx:1}):0===s&&(!n||0<c.sN(t,n,!0))&&(3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:0,Jx:-2}):1===u&&c.uN(t,{_orientation:0,Jx:-1})):c.uN(t,{_orientation:0,Jx:1})),(r||o||a)&&(e=c.aN(o,a),c.fN(t,r,o,a)?0<(s=c.sN(e,t,!0))?(u=c.iN(e),c.cN(t)&&(c.cN(o)||c.cN(a)||c.cN(r))||(3===u?c.uN(t,{_orientation:0,Kx:-2}):2!==u&&1!==u||c.uN(t,{_orientation:0,Kx:-1}))):s<=0&&(0<(s=c.sN(t,r,!0))?3===(u=c.iN(e))&&c.uN(t,{_orientation:0,Kx:1}):0!==s&&c.uN(t,{_orientation:0,Kx:-1})):c.uN(t,{_orientation:0,Kx:-2}))},I.gN=function(t,n,e,i,r,o,a){var u,s,c,f,e,c=I;(n||e||i)&&(f=c.aN(e,i),s=c.sN(f,t,!0),c.fN(t,n,e,i)?0<s?(u=c.iN(f),c.cN(t)&&(c.cN(e)||c.cN(i)||c.cN(n))||3===u&&c.uN(t,{_orientation:1,Jx:1})):s<0?0<(s=c.sN(t,n,!0))?3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:1,Jx:-2}):1===u&&c.uN(t,{_orientation:1,Jx:-1}):0!==s&&0<c.sN(n,f,!0)&&3===(u=c.iN(f))&&c.uN(t,{_orientation:1,Jx:1}):0===s&&0<c.sN(t,n,!0)&&(3===(u=c.iN(f))||2===u?c.uN(t,{_orientation:1,Jx:-2}):1===u&&c.uN(t,{_orientation:1,Jx:-1})):c.uN(t,{_orientation:1,Jx:1})),(r||o||a)&&(e=c.aN(o,a),s=c.sN(t,e,!0),c.fN(t,r,o,a)?s<0?(u=c.iN(e),c.cN(t)&&(c.cN(o)||c.cN(a)||c.cN(r))||(3===u||2===u?c.uN(t,{_orientation:1,Kx:-2}):1===u&&c.uN(t,{_orientation:1,Kx:-1}))):e!==Y&&0<=s&&(0<(s=c.sN(t,r,!0))?3===(u=c.iN(e))&&c.uN(t,{_orientation:1,Kx:1}):0!==s&&c.uN(t,{_orientation:1,Kx:-1})):c.uN(t,{_orientation:1,Kx:-2}))},I.pN=function(t,n,e,i,r,o,a,u){var s,c,f,l,l,s=I;u?this.gN(t,n,e,i,r,o,a):this.mN(t,n,e,i,r,o,a),c=s.cN(e),f=s.cN(i),l=s.cN(n),c&&f&&l?s.lN(t,n,e,i,-1,u):c&&!f?s.hN(t,n,r,e,i,1,-1,u,!0):!c&&f?s.hN(t,n,r,e,i,2,-1,u,!1):c&&f&&!l?s.dN(t,n,e,i,-1,u):l&&s.vN(t,n,e,i,-1,u),c=s.cN(o),f=s.cN(a),l=s.cN(r),c&&f&&l?s.lN(t,r,o,a,1,u):c&&!f?s.hN(t,n,r,o,a,1,1,u,!0):!c&&f?s.hN(t,n,r,o,a,2,1,u,!1):c&&f&&!l?s.dN(t,r,o,a,1,u):l&&s.vN(t,r,o,a,1,u)},I.eN=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],I.bN=function(t,n){return!(!t||!n||t.color!==n.color||t.level!==n.level||t.style!==n.style)},F=I,d.prototype.yN=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this;if(t.wN=[],t.MN=[],t.CN=[],t.SN=[],t.TN=[],t.AN={},t.IN={},t.xN={},t.NN={},t.kN={},t.DN={},t._N={},t.JCe.Hc(),n=t.zx,e=t.Vx,n&&0<n.length&&e&&0<e.length){for(i=t.MN,r=n.length,o=void 0,a=0;a<r;a++)0<(o=n[a]).height&&i.push(o.row);for(i.push(i[i.length-1]+1),u=t.CN,s=e.length,c=void 0,f=0;f<s;f++)0<(c=e[f]).width&&u.push(c.col);u.push(u[u.length-1]+1)}t.Ux=!0},d.prototype.EN=function(t,n,e,i,r,o,a,u){var t;e&&(t={Ky:t,iw:n,jN:e.startColumn,ON:e.endColumn,RN:i,_x:r,_y:o,YC:a,ZC:u},this.SN.push(t))},d.prototype.PN=function(t,n,e,i,r,o,a,u,s,c,f){var l,u,h,d,v,m,g,p,b,w,y,l=this;l.Ux||l.yN(),u?l.wN.push(u):(y=w=b=p=g=m=v=d=h=u=void 0,a&&(u=a.borderLeft,h=a.borderTop,d=a.borderRight,v=a.borderBottom,y=a.backColor,f&&2===f.columnHeaderFitMode||(m=a.diagonalDown,g=a.diagonalUp),f&&f.sheetArea!==z&&3!==f.sheetArea||(p=a.textOrientation),b=a.isVerticalText,w=a.textIndent),!y||u||d||h||v||l.TN.push({r:t,c:n,rc:1,cc:1}),l.GN(t,n,e,i,r,o,u,h,d,v,m,g,y,!1,!1,s,c,p,b,w&&0!==w,f))},d.prototype.GN=function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,F,L,m,g,p,b){var w,y,M,C,S,B,P,T,A,I,x,M,m,N,k,_,D,j,O,E,R,M,g,G,p,I,_,T,E,U,H,w=this,y=w.Mf,M=y.Jt,C=!1,S=!1,B=!1,P=!1,T=function(t){return t!==z&&t&&-90<=t&&t<=90},A=T(m),I=a||u||s||c,_=0,D=0,j=e,O=r;n+1<y.getColumnCount()&&(E=M.qt(t,n+1)),0<=n-1&&(R=M.qt(t,n-1)),M=A&&!g&&!p&&b&&b.data,g=J(b&&b.printZoomFactor)?1:b.printZoomFactor,p=!(G=I&&M&&m%90!=0),I&&(M&&(N=Z(m*Q/180),k=W(N),_=Math.floor(o/k),-90<m&&m<0&&(j=e-_),0<m)&&m<90&&(j=e+_),A||(E&&T(E.textOrientation)&&(N=Z(E.textOrientation*Q/180),k=W(N),D=Math.floor(o/k),0<E.textOrientation&&E.textOrientation<90&&(O=r+D),E.textOrientation<0)&&-90<E.textOrientation&&(O=r-D),R&&T(R.textOrientation)&&(N=Z(R.textOrientation*Q/180),k=W(N),D=Math.floor(o/k),-90<R.textOrientation&&R.textOrientation<0&&(O+=D,j=e-D),0<R.textOrientation)&&R.textOrientation<90&&(O-=D,j=e+D))),f&&p&&w.UN(t,n,e-1,i-1,e+r,i+o,f,w.kN,Y,{printZoomFactor:g}),l&&p&&w.UN(t,n,e+r,i-1,e-1,i+o,l,w.DN,Y,{printZoomFactor:g}),u&&0<o&&(C=w.UN(t,n,j,i-.5,j+O,i-.5,u,w.xN,A,{printZoomFactor:g})),a&&0<O&&(S=w.UN(t,n,j-.5,i,e-.5,i+o,a,w.NN,A,{printZoomFactor:g})),s&&0<O&&(I=w.JCe.KCe(n,null==b?void 0:b.sheetArea),P=b&&b.columnHeaderFitMode===V.ColumnHeaderFitMode.stack&&!J(b.cornerX)?(x=b.cornerX,M=b.cornerY,w.UN(t,I,j+O-.5,i,e+r-.5,i+(m=M-i),s,w.NN,A,{isMultiLine:!0,multiLinePart:"topVertical",printZoomFactor:g}),w.UN(t,I,x,i+m-.5,e+r-.5,i+m-.5,s,w.xN,A,{isMultiLine:!0,multiLinePart:"horizontal",printZoomFactor:g}),w.UN(t,I,x-.5,M,x-.5,i+o,s,w.NN,A,{isMultiLine:!0,multiLinePart:"bottomVertical",printZoomFactor:g})):w.UN(t,I,j+O-.5,i,e+r-.5,i+o,s,w.NN,A,{printZoomFactor:g})),c&&0<o&&(_=w.JCe.sD(t,null==b?void 0:b.sheetArea),B=b&&b.columnHeaderFitMode===V.ColumnHeaderFitMode.stack&&!J(b.cornerX)?(x=b.cornerX,w.UN(_,n,e,i+o-.5,x,i+o-.5,c,w.xN,A,{printZoomFactor:g})):w.UN(_,n,e,i+o-.5,e+r,i+o-.5,c,w.xN,A,{printZoomFactor:g})),h&&0!==y.Jt.Gt(t)&&0!==y.Jt.Kt(n)||(E=!P&&!v,((T=!B&&!d)||E||(U=!C&&!d)||(H=!S&&!v))&&w.HN(t,n,e,i,r,o,T,E,F,L,b&&b.clipRect)),!C&&!h||A||w.zN(t-1,n,w.AN),(S||h)&&w.zN(t,n-1,w.IN),!h||a||s||u||c||(w.VN(t-1,n-1,w.IN,!1),w.VN(t-1,n-1,w.AN,!0))},d.prototype.UN=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,c,d,d;return!!a&&(h=l=f=void 0,c&&(f=c.isMultiLine,l=c.multiLinePart,h=c.printZoomFactor),(c=this.YN(t,n,u,!0))?f?((d=D(e,i,r,o,a.color,a.style,s,h)).multiLinePart=l,c.splitLines||(c.splitLines=[]),"horizontal"===l&&(c.line=d),c.splitLines.push(d)):s||6!==c.style.style&&(6===a.style||0<F.nN(a,c.style))?(c.line=D(e,i,r,o,a.color,a.style,s,h),c.style=a):c.line&&!c.splitLines&&o-i!=c.line.Dx-c.line.xx&&(c.line.Dx=o,c.line.xx=i):(d=D(e,i,r,o,a.color,a.style,s,h))&&((c=this.YN(t,n,u)).line=d,c.style=a,f)&&(c.line.multiLinePart=l,c.splitLines=[c.line]),c)&&c.line!==Y},d.prototype.HN=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,h,a,a,s,a,l=this,h=3===l.nT,d=l.Mf.options.gridline;h&&d&&(h=d.color,d.showHorizontalGridline&&(a&&((a=l.YN(t,n,l.AN)).isGridLine=!0,a.line=D(e,i+o-.5,e+r,i+o-.5,h,z,z,z,f)),s)&&((a=l.YN(-1,n,l.AN,!1,!0)).isGridLine=!0,a.line=D(e,i-.5,e+r,i-.5,h,z,z,z,f)),d.showVerticalGridline)&&(u&&((s=l.YN(t,n,l.IN)).isGridLine=!0,s.line=D(e+r-.5,i,e+r-.5,i+o,h,z,z,z,f)),c)&&((a=l.YN(t,-1,l.IN,!1,!0)).isGridLine=!0,a.line=D(e-.5,i,e-.5,i+o,h,z,z,z,f))},d.prototype.VN=function(t,n,e,i){var t,r,t=this.YN(t,n,e,!0);t&&t.line&&t.line.Wx({_orientation:i?0:1,Kx:-1})},d.prototype.zN=function(t,n,e){var e,i;(0<=t&&0<=n||0===t&&-1===n||-1===t&&0===n)&&(e=e[t])&&(i=e[n])&&delete e[n]},d.prototype.YN=function(t,n,e,i,r){var r,e;if(!r&&(-1===t||-1===n))return Y;if(!(r=e[t])){if(i)return Y;e[t]=r={}}if(!(e=r[n])){if(i)return Y;r[n]=e={}}return e},d.prototype.ZN=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,s,p,b,w,h,y,M,y,f,C,S,T,A,I,x,N,k,_,t=this,n=t.SN,e=n.length,i=t.NN,r=t.xN,o=t.IN,a=t.AN,u=0;u<e;u++)if(c=(s=n[u]).Ky,f=s.iw,l=s.jN,h=s.RN,d=s.ON,m=s._x,g=s.YC,s=s.ZC,p=m,b=v=void 0,w=h.textOrientation,h=h.borderTop,!(y=n[u-1])||y.Ky!==c||y.jN!==l||y.ON!==d){for(M=l;M<d;M++)(v=t.YN(c,M+1,i,!0))&&!w?t.zN(c,M+1,i):(v=t.YN(c,M,o,!0))&&t.zN(c,M,o);if(y=t.YN(c,f,r,!0),w&&h&&!y)for(f=void 0,f=s/Math.tan(Math.abs(w*Math.PI/180)),-90<w&&w<0&&(p=m-f),b=(p=0<w&&w<90?m+f:p)+g,C=l;C<d+1;C++)if(T=(S=t.YN(c-1,C,a,!0))&&S.line)for(S.splitLines||(S.splitLines=[],S.splitLines.push(T)),A=0;A<S.splitLines.length;A++)if(x=(I=S.splitLines[A]).Ix,N=I.Nx,k=I.xx,_=I.Dx,x<p&&N<b&&p<N)I.Nx=p;else if(p<x&&N<b)t.zN(c-1,C,t.AN);else if(p<x&&b<N&&x<b)I.Ix=b;else if(x<p&&b<N){S.splitLines.splice(A,1,D(x,k,p,k,I.color),D(b,_,N,_,I.color));break}}},d.prototype.WN=function(t,n){var e,i,r,o,e=this.wN,i=e.length;if(0<i)for(o=0;o<i;o++)r=e[o],this.QN(r,t,n)},d.prototype.KN=function(){var t,n,e,i,r,o,a,u;if(this._N={},0<(n=(t=this.wN).length))for(i=0;i<n;i++)for(e=t[i],r=0;r<e.rowCount;r++)for(o=r+e.row,this._N[o]=this._N[o]||{},a=0;a<e.colCount;a++)u=a+e.col,this._N[o][u]=e},d.prototype.QN=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,d,u,j,O,E,d,E,O,d,u,R,i=this,r=t.row,o=t.col,a=t.x,u=t.y,s=t.spanSizeInfo,d=s.styleList[0][0],v=d?d.backColor:Y,A=a,I=u,x=null,N=!0,k=null,_=!0,d=i.Mf,u=d.N9(3),j=d.k9(3),O=d.Fi(),E=d.options.sheetAreaOffset,d=d.gj&&d.gj()||{x:E.left,y:E.top,width:0,height:0},E=0===O.qC&&0===d.height,O=0===O.XC&&0===d.width,d=r===u&&E||e&&0===t.vIndex,u=o===j&&O||e&&0===t.hIndex;if(1===t.rowCount)for(g=r,b=s.rowSizes[0],m=0;m<t.colCount;m++)y=0===m,C=m===t.colCount-1,p=o+m,w=s.colSizes[m],T=s.styleList[0][m],g===t.row&&p===t.col&&(x=(D=T)&&D.diagonalDown,k=D&&D.diagonalUp),T?(c=T.borderLeft,f=T.borderTop,l=T.borderRight,h=T.borderBottom,N=N&&F.bN(x,T.diagonalDown),_=_&&F.bN(k,T.diagonalUp)):c=f=l=h=Y,y?i.GN(g,p,A,I,w,b,c,f,Y,h,Y,Y,v,!1,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}):C?i.GN(g,p,A,I,w,b,Y,f,l,h,Y,Y,v,!1,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}):i.GN(g,p,A,I,w,b,Y,f,Y,h,Y,Y,v,!1,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}),A+=w;else if(1===t.colCount)for(p=o,w=s.colSizes[0],m=0;m<t.rowCount;m++)M=0===m,S=m===t.rowCount-1,b=s.rowSizes[m],T=s.styleList[m][0],(g=r+m)===t.row&&p===t.col&&(x=(D=T)&&D.diagonalDown,k=D&&D.diagonalUp),T?(c=T.borderLeft,f=T.borderTop,l=T.borderRight,h=T.borderBottom,N=N&&F.bN(x,T.diagonalDown),_=_&&F.bN(k,T.diagonalUp)):c=f=l=h=Y,M?i.GN(g,p,A,I,w,b,c,f,l,Y,Y,Y,v,!0,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}):S?i.GN(g,p,A,I,w,b,c,Y,l,h,Y,Y,v,!1,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}):i.GN(g,p,A,I,w,b,c,Y,l,Y,Y,Y,v,!0,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}),I+=b;else for(m=0;m<t.rowCount;m++){for(g=r+m,M=0===m,S=m===t.rowCount-1,b=s.rowSizes[m],R=0;R<t.colCount;R++)p=o+R,y=0===R,C=R===t.colCount-1,w=s.colSizes[R],T=s.styleList[m][R],g===t.row&&p===t.col&&(x=(D=T)&&D.diagonalDown,k=D&&D.diagonalUp),T?(c=T.borderLeft,f=T.borderTop,l=T.borderRight,h=T.borderBottom,N=N&&F.bN(x,T.diagonalDown),_=_&&F.bN(k,T.diagonalUp)):c=f=l=h=Y,M?y?i.GN(g,p,A,I,w,b,c,f,Y,Y,Y,Y,v,!0,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}):C?i.GN(g,p,A,I,w,b,Y,f,l,Y,Y,Y,v,!0,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}):i.GN(g,p,A,I,w,b,Y,f,Y,Y,Y,Y,v,!0,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}):S?y?i.GN(g,p,A,I,w,b,c,Y,Y,h,Y,Y,v,!1,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}):C?i.GN(g,p,A,I,w,b,Y,Y,l,h,Y,Y,v,!1,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}):i.GN(g,p,A,I,w,b,Y,Y,Y,h,Y,Y,v,!1,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}):y?i.GN(g,p,A,I,w,b,c,Y,Y,Y,Y,Y,v,!0,!0,Y,Y,Y,Y,Y,{printZoomFactor:n}):C&&i.GN(g,p,A,I,w,b,Y,Y,l,Y,Y,Y,v,!0,!1,Y,Y,Y,Y,Y,{printZoomFactor:n}),A+=w;A=a,I+=b}i.GN(t.row,t.col,t.x,t.y,t.width,t.height,Y,Y,Y,Y,x=N?x:null,k=_?k:null,v,!d,!u,d,u,Y,Y,Y,{printZoomFactor:n}),!v||c||l||f||h||i.TN.push({r:r,c:o,rc:t.rowCount,cc:t.colCount})},d.prototype.Wx=function(){var t,n,e,i,r,t=this,n=!1,e=!1,i=!1,r=!1;o(t.NN)||(n=!0),o(t.xN)||(e=!0),(n||e)&&(t.JN(),t.XN()),o(t.kN)||(i=!0),o(t.DN)||(r=!0),(i||r)&&t.qN(),0<t.TN.length&&t.$N()},d.prototype.t6=function(t,n,e,i,r){var o,a,o=this,a=this._N[t]?this._N[t][n]:null;if(a)switch(r){case m:return o.n6(t,n,e,i);case g:case p:return o.n6(t,n+a.colCount-1,e,i);case b:case S:return o.n6(t+a.rowCount-1,n+a.colCount-1,e,i);case T:case A:return o.n6(t+a.rowCount-1,n,e,i);case B:return o.n6(t,n,e,i)}return o.n6(t,n,e,i)},d.prototype.qN=function(){for(var t,n,e,i,r,o,a,u,s,c,c,c,c,f,l,c,c,c,c,h,d,v,t=this,n=t.MN,e=t.CN,i=n.length,r=e.length,f={},l={},o=0;o<i;o++)for(u=n[o],a=0;a<r;a++)s=e[a],h=t.YN(u,s,t.kN,!1),d=t.YN(u,s,t.DN,!1),(h||d)&&(F.cN(h)&&F.cN(d)&&(h.line.$x(),d.line.$x()),(c=t.t6(u,s,!(v=[]),f,m))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,h,!0,1),(c=t.t6(u,s,!1,f,g))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,d,!0,1),(c=t.t6(u,s,!0,l,B))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,h,!0,0),(c=t.t6(u,s,!0,l,A))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,d,!1,0),(c=t.t6(u+1,s,!1,f,T))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,d,!1,1),(c=t.t6(u+1,s,!1,f,S))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,h,!1,1),(c=t.t6(u,s+1,!0,l,p))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,d,!0,0),c=t.t6(u,s+1,!0,l,b))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,h,!1,0)},d.prototype.e6=function(t,n,e,i,r){var o,a,n,o,t,o=F.cN(n),a=F.oN(n),n=n.line.Ex;o&&(n=3),o=t[(n=a?2:n)-1],e&&e.line&&(t={_orientation:r},i?t.Jx=o:t.Kx=o,e.line.Wx(t))},d.prototype.$N=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=t.TN,e=n.length,i=0;i<e;i++){for(s=(u=o=(r=n[i]).r)-1,c=(a=r.c)-1,f=a,1<r.rc&&(u+=r.rc-1),1<r.cc&&(f+=r.cc-1),h=l=!1,d=i+1;d<e&&((v=n[d]).c===f+1&&v.r===o&&(h=!0),!(l=v.r===u+1&&v.c===a?!0:l)||!h)&&!(v.r>o+1&&v.c>a+1);d++);l||t.VN(u,c,t.AN,!0),h||t.VN(s,f,t.IN,!1)}},d.prototype.JN=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,y,t=this,n=t.Mf,e=n.Ut,i=t.MN,r=t.CN,o=i.length,a=r.length,l={},h={},u=0;u<o;u++)for(c=i[u],s=0;s<a;s++){if(f=r[s],A=t.YN(c,f,t.NN,!(T=S=0))){if(A.line&&A.line.jx)continue;S++}else A=t.YN(c,f-1,t.IN,!0);if((I=t.YN(c,f,t.xN,!0))?T++:I=t.YN(c-1,f,t.AN,!0),A||I){if((d=0===u?Y:t.n6(i[u-1],f,!0,h))&&d.line&&!d.isGridLine&&(S++,T++),(v=0===s?Y:t.n6(c,r[s-1],!1,l))&&v.line&&!v.isGridLine&&(S++,T++),A)for(x=[A],A.splitLines&&0<A.splitLines.length&&(x=A.splitLines),N=0;N<x.length;N++)(k=x[N]).style=A.style,(m=t.n6(c,f,!1,l))&&m.line&&!m.isGridLine&&S++,u!==o-1&&(p=t.n6(i[u+1],f,!0,h))&&p.line&&!p.isGridLine&&S++,0!==s&&u!==o-1&&(b=t.n6(i[u+1],r[s-1],!1,l))&&b.line&&!b.isGridLine&&S++,u!==o-1&&(w=t.n6(i[u+1],f,!1,l))&&w.line&&!w.isGridLine&&S++,0<S&&("topVertical"===k.multiLinePart?(_=e.i6(f,0),D=n.r6(_),2===n.Lt(D)&&(_=n.O5(_)),j=n.O5(f),m=t.n6(c,_,!1,l),p=t.n6(c,j,!0,h),b=k,w=Y):"bottomVertical"===k.multiLinePart&&(m=k,p=v=d=Y,b=t.n6(i[u+1],r[s-1],!1,l),w=t.n6(i[u+1],r[s],!1,l)),F.rN(A.style)?F.pN(k,d,v,m,p,b,w,!0):F.oN(A.style)||F.gN(k,d,v,m,p,b,w));I&&((g=t.n6(c,f,!0,h))&&g.line&&!g.isGridLine&&T++,s!==a-1&&(y=r[s+1],2===n.Lt(y)&&(y=e.i6(y,0),y=n.O5(y)),y=t.n6(c,y,!1,l))&&y.line&&!y.isGridLine&&T++,0!==u&&s!==a-1&&(M=t.n6(i[u-1],r[s+1],!0,h))&&M.line&&!M.isGridLine&&T++,s!==a-1&&(C=t.n6(c,r[s+1],!0,h))&&C.line&&!C.isGridLine&&T++,0<T)&&(I.line&&"horizontal"===I.line.multiLinePart&&(_=e.i6(f,0),D=n.r6(_),2===n.Lt(D)&&(_=n.O5(_)),y=d=v=Y,M=g=I,C=t.n6(c,_,!0,h)),F.rN(I.style)?F.pN(I,v,d,g,y,M,C,!1):F.oN(I.style)||F.mN(I,v,d,g,y,M,C))}}},d.prototype.o6=function(t,n,e,i){var r,o,e,r=this,o=this._N[t]?this._N[t][n]:null,e=e?r.DN:r.kN;return o?t===o.row&&n===o.col&&i===w||t===o.row&&n===o.col+o.colCount-1&&i===y||t===o.row+o.rowCount-1&&n===o.col+o.colCount-1&&i===M||t===o.row+o.rowCount-1&&n===o.col&&i===C?r.YN(o.row,o.col,e,!1):void 0:r.YN(t,n,e,!1)},d.prototype.XN=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,b,t=this,n=t.MN,e=t.CN,i=n.length,r=e.length,o=0;o<i;o++)for(u=n[o],a=0;a<r;a++)s=e[a],(b=t.YN(u,s,t.NN,!0))&&b.line&&b.line._noNeedAdjust||(b&&b.line&&F.cN(b)&&(c=t.o6(u,s,!1,w),f=t.o6(u,s,!0,C),l=F.cN(c),h=F.cN(f),d=t.o6(u,s-1,!1,M),v=t.o6(u,s-1,!0,y),m=F.cN(d),g=F.cN(v),c&&l&&b.line.Wx(p={tN:2,_orientation:1,Jx:2}),f&&h&&b.line.Wx(p={tN:2,_orientation:1,Kx:-2}),d&&m&&b.line.Wx(p={tN:1,_orientation:1,Kx:-2}),v)&&g&&b.line.Wx(p={tN:1,_orientation:1,Jx:2}),(b=t.YN(u,s,t.xN,!0))&&b.line&&F.cN(b)&&(c=t.o6(u,s,!1,w),f=t.o6(u,s,!0,y),l=F.cN(c),h=F.cN(f),d=t.o6(u-1,s,!1,M),v=t.o6(u-1,s,!0,C),m=F.cN(d),g=F.cN(v),c&&l&&b.line.Wx(p={tN:2,_orientation:0,Jx:2}),f&&h&&b.line.Wx(p={tN:2,_orientation:0,Kx:-2}),d&&m&&b.line.Wx(p={tN:1,_orientation:0,Kx:-2}),v)&&g&&b.line.Wx(p={tN:1,_orientation:0,Jx:2}))},d.prototype.n6=function(t,n,e,i){var r,i,r=i[t];return i=(i=(r=r||(i[t]={}))[n])===z?r[n]=this.a6(t,n,e):i},d.prototype.a6=function(t,n,e){var i,r,o;if(t===z||t<0||n===z||n<0)return Y;if(i=this,r=e?i.NN:i.xN,o=i.YN(t,n,r,!0))return o;if(r=e?i.IN:i.AN,e){if(--n<0)return Y}else if(--t<0)return Y;return(o=i.YN(t,n,r,!0))||Y},d.prototype.paint=function(t,n,e){var i=this;i.Ux&&(i.Hx||(i.KN(),i.WN(n,e),i.ZN(),i.Wx(),i.Hx=!0),t.save(),i._e(t),t.restore())},d.prototype._e=function(t){this.u6(t),this.s6(t)},d.prototype.u6=function(t){var n=this;n.c6(t,n.AN),n.c6(t,n.IN)},d.prototype.s6=function(t){var n=this;n.c6(t,n.xN),n.c6(t,n.NN),n.c6(t,n.kN),n.c6(t,n.DN)},d.prototype.c6=function(t,n){var e,i,r,o,a,u;for(e in n)if(n[e])for(i in r=n[e])if(r[i])if(o=r[i].line,(a=r[i].splitLines)&&0<a.length)for(u=0;u<a.length;u++)a[u]&&a[u]._e(t);else o&&o._e(t)},t.Yx=d},"./dist/core/worksheet/worksheet-clipboard.js":function(a,t,n){"use strict";var e,u,nt,et,K,s,f,p,x,g,l,i,r,h,y,X,it,d,R,c,F,M,n,rt,ot,w,S,N,v,m,i,T,A,I,D,j;function C(t){var t=t.parent;return t&&t.options.allowCopyPasteExcelStyle}function ht(t){var t=t.parent;return t&&t.options.allowExtendPasteRange}function k(t){var t=t.parent;return t&&t.options.copyPasteHeaderOptions}function O(t,n,e,i,r,o){var a,u,s,c,f,l,h,a=X,u=(0,K.parseText)(t,n,e,i,r,o);if(u){for(s=u.length,c=(0,K.getMaxLength)(u),f=[],l=0;l<s;l++)for(f[l]=[],h=0;h<c;h++)h<u[l].length?f[l][h]=u[l][h]:f[l][h]=X;a=f}return a}function at(t,n){return t.tables&&t.tables.Uue(n)}function Y(t,n){for(var e,i,e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(!ot(t.getValue(e,i)))return;return 1}function ut(t,n){return-1!==t.col&&-1!==t.colCount&&t.colCount!==n}function st(t,n){return-1===t.row||-1===t.rowCount||t.rowCount===n}function b(t,n,e,i,r){if(!(t<=r.row&&n<=r.col&&t+e>=r.row+r.rowCount&&n+i>=r.col+r.colCount||r.col>n+i||r.col+r.colCount-1<n||r.col>n+i-1||r.col+r.colCount-1<n||r.row+r.rowCount-1<t||n===r.col&&i===r.colCount&&t>r.row))return!0}function ct(t,n){return t.tables&&t.tables.Uue(n)}function dt(t,n,e,i,r){return t.tables&&t.tables.oSt(n,e,i,r)}function ft(t,n,e,i,r){var o,n,a,o=n.rowCount,n=n.colCount,a=!1;return r===nt.InsertShiftCell.right?(n=1,i===t.col&&(a=!0)):(o=1,e===t.row&&(a=!0)),(-1===t.row||-1===t.col)&&t.intersect(e,i,o,n)&&!t.equals(new et.Range(e,i,o,n))&&!a}function _(t){return(t&nt.CopyToOptions.style)<=0}function E(t,n){var e,i,r,t,o,a,u,n,s,e,o,i,a,e=t.row,i=t.col,r=t.row+t.rowCount,t=t.col+t.colCount,o=n.row,a=n.col,u=n.row+n.rowCount,n=n.col+n.colCount,s;return R(e,o)<=c(r,u)&&R(i,a)<=c(t,n)&&(e=R(e,o),o=R(i,a),i=c(r,u)-e,a=c(t,n)-o,new et.Range(e,o,i,a))}function B(n,t){var e=[];return t.forEach(function(t){var t=E(n,t);t&&e.push(t)}),e}function P(t,n){t&&y&&t.suspendCalcService(n)}function G(t,n){t&&y&&t.resumeCalcService(n)}function L(t,n){return n===nt.ClipboardPasteOptions.formatting&&t.options.protectionOptions.formatCells}function z(t,n,e,i,r){t.ki("shiftCellsDown",{row:i,col:r,changedRowCount:i-n,changedColCount:r-e,srcRow:n,srcColumn:e},!0)}function q(t,n,e,i){var e,i,r,o,a;n&&e&&i!==it&&(e=n.Ky,i=n.iw,r=n.Sx,o=n.Tx,a={showHeader:n.showHeader(),showFooter:n.showFooter(),useFooterDropDownList:n.useFooterDropDownList(),showResizeHandle:n.showResizeHandle()},t.tables._Qt(n.name(),e,i,r,o,n.style(),a,!0),n.L0())}function vt(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,m,a=t.Ut.getSpans(),u=t.tables&&t.tables.U3,s=t.pivotTables&&t.pivotTables.all(),c=0;c<a.length;c++)if(!(n<=(f=a[c]).row&&e<=f.col&&n+i>=f.row+f.rowCount&&e+r>=f.col+f.colCount||f.row>n+i||f.row+f.rowCount-1<n||f.row>n+i-1||f.row+f.rowCount-1<n||f.col+f.colCount-1<e))return 1;if(u)for(c=0;c<u.length;c++)if(l=u[c],(ot(o)||l.name()!==o)&&!(n<=l.Ky&&e<=l.iw&&n+i>=l.Ky+l.Sx&&e+r>=l.iw+l.Tx||l.Ky>n+i||l.Ky+l.Sx-1<n||l.Ky>n+i-1||l.Ky+l.Sx-1<n||l.iw+l.Tx-1<e))return 1;if(s)for(c=0;c<s.length;c++)if(v=(d=(h=s[c]).getRange()).content,d=d.page,m=void 0,m=!(m=v?b(n,e,i,r,v):m)&&d?b(n,e,i,r,d):m)return 1}function U(t,n){var e,t,i,n,r,o,a;return!t||(e=t.row,t=t.col,i=n.row,n=n.col,-1!==e&&-1!==t)||(r=-1===e&&-1!==t)&&i<=0||(o=-1===t&&-1!==e)&&n<=0||(a=-1===e&&-1===t)&&i<=0&&n<=0}function mt(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,m,a=t.Ut.getSpans(),u=t.tables&&t.tables.U3,s=t.pivotTables&&t.pivotTables.all(),c=0;c<a.length;c++)if(!(n<=(f=a[c]).row&&e<=f.col&&n+i>=f.row+f.rowCount&&e+r>=f.col+f.colCount||f.col>e+r||f.col+f.colCount-1<e||f.col>e+r-1||f.col+f.colCount-1<e||f.row+f.rowCount-1<n))return 1;if(u)for(c=0;c<u.length;c++)if(l=u[c],(ot(o)||l.name()!==o)&&!(n<=l.Ky&&e<=l.iw&&n+i>=l.Ky+l.Sx&&e+r>=l.iw+l.Tx||l.iw>e+r||l.iw+l.Tx-1<e||l.iw>e+r-1||l.iw+l.Tx-1<e||l.Ky+l.Sx-1<n||e===l.iw&&r===l.Tx&&n>l.Ky))return 1;if(s)for(c=0;c<s.length;c++)if(v=(d=(h=s[c]).getRange()).content,d=d.page,m=void 0,m=!(m=v?b(n,e,i,r,v):m)&&d?b(n,e,i,r,d):m)return 1}function lt(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,o=t.Ut.getSpans(),a=t.tables.U3,u=n;u<n+i;u++)for(s=e;s<e+r;s++){if(c=t.getCell(u,s),!ot(c.value())||c.backColor()||c.comment()||c.tag())return!0;for(f=0;f<o.length;f++)if(u>=(l=o[f]).row&&u<=l.row+l.rowCount-1&&s>=l.col&&s<=l.col+l.colCount-1)return!0;for(h=0;h<a.length;h++)if(u>=(d=a[h]).Ky&&u<=d.Ky+d.Sx-1&&s>=d.iw&&s<=d.iw+d.Tx-1)return!0}return!1}function H(t,n){var t;return null!=(t=t.getSpan(n.row,n.col))&&t.equals(n)}function V(t,n){var e,i,r,o,a,u,s;if(t&&1<(e=t.length)){for(i=void 0,i=0;i<e;i++)for(r=t[i],o=i+1;o<e;o++)if(a=t[o],r.intersect(a.row,a.col,a.rowCount,a.colCount))return;for(u=t[0],s=void 0,i=1;i<e&&(s=t[i],u.row===s.row&&u.rowCount===s.rowCount);i++);if(e<=i)return n&&(n.inSameRow=!0),1;for(i=1;i<e&&(s=t[i],u.col===s.col&&u.colCount===s.colCount);i++);if(e<=i)return n&&(n.inSameCol=!0),1}}function $(t,n){return I.call(this,t,n)||this}function o(t,n,e){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,e,p,r,b,w,y,M,C,S,T,A,S,I,x,i=this;if(i=D.call(this,t,n)||this,!e){if(a=n.fromSheet,!(o=t))throw new Error(rt().Exp_DestSheetIsNull);if(s=(u=n).pastedRanges,c=o.o5(),s&&!(s.length<=0))if(n.cachedActions=[],l=(f=u.fromRanges||[u.fromRange]).length,h=u.isCutting,d=u.clipboardText,v=u.clipboardHtml,m=u.clipboardImage,g=u.pasteOption,e={},p=s[0],r=null==(r=u.pasteSpecialOptions)?void 0:r.transpose,!h&&a&&V(f,e)&&p.equals(a.fT(f,p,r))){for(b=e.inSameRow,w=e.inSameCol,r&&(b=(e=[w,b])[0],w=e[1]),b?f.sort(function(t,n){return t.col-n.col}):w&&f.sort(function(t,n){return t.row-n.row}),y=p.row,M=p.col,C=0;C<l;C++)T=(S=f[C]).rowCount,A=S.colCount,c&&(T+=t.lT(y,T,!0),A+=t.lT(M,A)),S={sourceRange:S,targetRange:(0,et.Ec)(y,M,T,A),isCutting:h,clipboardText:d,clipboardHtml:v,clipboardImage:m,includeFilteredOutRow:!0,pasteSpecialOptions:u.pasteSpecialOptions},n.cachedActions[C]=new N(t,{fromSheet:a,toSheet:o,pasteExtent:S,pasteOption:g}),b?M+=A:w&&(y+=T);n.hT=!0}else for(I=0;I<s.length;I++)x={sourceRange:f[0],targetRange:s[I],isCutting:h,clipboardText:d,clipboardHtml:v,clipboardImage:m,pasteSpecialOptions:u.pasteSpecialOptions},n.cachedActions[I]=new N(t,{fromSheet:a,toSheet:o,pasteExtent:x,pasteOption:g})}return i}function Z(t,n){return j.call(this,t,n)||this}function W(t,n,e,i,r,o,a){var u,s,c,f,n,l,h,d,e,v,m,i,u=n.row,s=n.col,c=n.rowCount,f=n.colCount,n=0===e||2===e||4===e||5===e;if(r&&n)for(d=(h=(l=t.Ut).getSpans((0,et.Ec)(u,s,c,f))).length-1;0<=d;d--)l.do("removeSpan",h[d]);if(y&&0<(1&i)&&t.clearFormula(u,s,c,f,function(t,n){return!t.XT||!t.XT(n)}),e=t.ST(),r&&""!==r||a&&""!==a)t.parent&&t.parent.options.allowAutoCreateHyperlink&&1===c&&1===f&&(g.Common.$T.qT(w).test(r)||g.Common.$T.qT(S).test(r))&&t.setHyperlink&&t.setHyperlink(u,s,{url:r,tooltip:r}),0<(i&nt.CopyToOptions.value)&&(i=t.parent&&t.parent.options.allowUserEditFormula?16:0,t.OTe=!0,t.setCsv(u,s,r,"\r\n","\t",i,!1,p.yM.n5(a)),delete t.OTe),e&&n&&a&&e.r5(a,t,u,s);else if(e&&n&&o)e.s5(o,t,u,s);else for(v=0;v<c;v++)for(m=0;m<f;m++)t.setValue(u+v,s+m,X)}function Q(t,e,i,n,r,o,a){var u,s,r,c,f,l,h,d,v,u,m,g,p,b,w,y,M,C,S,T,A,I,s=N.WT(r),r=n.row<0?e.getRowCount():n.rowCount,c=n.col<0?e.getColumnCount():n.colCount,f=i.row<0?t.getRowCount():i.rowCount,l=i.col<0?t.getColumnCount():i.colCount,h=n.row,d=n.col;for(n.row<0&&f<e.getRowCount()&&(h=0),n.col<0&&l<e.getColumnCount()&&(d=0),(v=(null==(u=t.getSpan(i.row,i.col))?void 0:u.equals(i))&&1===n.rowCount&&1===n.colCount)&&(r=(u=t.getSpan(i.row,i.col)).rowCount,c=u.colCount),m=F(r/f),g=F(c/l),p=0;p<m&&m&&g;p++)for(b=0;b<g;b++)x.staticMembers.copyTo(t,i.row,i.col,e,h+f*p,d+l*b,f,l,s,o,k(t),it,_(s),a);for(T=-33&s,w=h+f*m,y=d,M=r-f*m,C=l,S=B(new et.Range(i.row,i.col,M,C),t.getSpans(i)),A=function(n){S.forEach(function(t){e.addSpan(w+t.row-i.row,y+l*n+t.col-i.col,t.rowCount,t.colCount)}),x.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,e,w,y+l*n,M,C,T,o,k(t),it,_(T),a)},b=0;b<g&&M&&C;b++)A(b);for(w=h,y=d+l*g,M=f,C=c-l*g,S=B(new et.Range(i.row,i.col,M,C),t.getSpans(i)),I=function(n){S.forEach(function(t){e.addSpan(w+f*n+t.row-i.row,y+t.col-i.col,t.rowCount,t.colCount)}),x.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,e,w+f*n,y,M,C,T,o,k(t),it,_(T),a)},p=0;p<m&&M&&C;p++)I(p);w=h+f*m,y=d+l*g,M=r-f*m,C=c-l*g,S=B(new et.Range(i.row,i.col,M,C),t.getSpans(i)),M&&C&&(S.forEach(function(t){e.addSpan(w+t.row-i.row,y+t.col-i.col,t.rowCount,t.colCount)}),x.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,e,w,y,M,C,T,o,k(t),it,_(T),a))}function J(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,s=i.row<0?e.getRowCount():i.rowCount,c=i.col<0?e.getColumnCount():i.colCount,f=n.row<0?t.getRowCount():n.rowCount,l=n.col<0?t.getColumnCount():n.colCount,h=e.o5();if(h&&(s=(s-=e.ix(i.row,R(s,f),!0))<1?1:s,c=(c-=e.ix(i.col,R(c,l)))<1?1:c),f<s||l<c)for(d=i.row,v=i.col,i.row<0&&f<e.getRowCount()&&(d=0),i.col<0&&l<e.getColumnCount()&&(v=0),s%f==0&&1===c?c=l:1===s&&c%l==0?s=f:s%f==0&&c%l==0||(s=f,c=l),m=F(s/f),g=F(c/l),p=f,b=l,C=M=y=w=void 0,S=0;S<m;S++){for(w=ot(M)?d<0?-1:d+S*f:M,T=0;T<g;T++)y=ot(C)?v<0?-1:v+T*l:C,f=d<0?-1:p,l=v<0?-1:b,h&&(f=d<0?-1:f+e.lT(w,p,!0),l=v<0?-1:l+e.lT(y,b)),x.staticMembers.copyTo(t,n.row,n.col,e,w,y,p,b,r,o,k(t),a,_(r),u),C=y+(l<0?0:l);M=w+(f<0?0:f),C=null}else x.staticMembers.copyTo(t,n.row,n.col,e,i.row,i.col,n.rowCount,n.colCount,r,o,k(t),a,_(r),u)}function tt(t,n,e,i,r){var o,a,u,s,c,f,l,o=r.isCutting,a=r.clipboardPasteOptions,u=r.ignoreFilteredOutRow,s=r.ignorePasteSkipInvisibleRange,c=r.pasteSpecialOptions;if(t&&e.name()===t.name()&&e.parent&&!t.NMi&&!d(e.parent.sheets,t)&&e.parent!==t.parent)t.YT();else{f=N.WT(a),P(t),P(e);try{if(t&&n){if(0!=(2&f)&&o&&y&&t.KT(n.row,n.col,n.rowCount,n.colCount||e.KT(i.row,i.col,i.rowCount,i.colCount)))throw rt().Exp_ChangePartOfArray;l=a===nt.ClipboardPasteOptions.formatting,o?(x.staticMembers.moveTo(t,n.row,n.col,e,i.row,i.col,n.rowCount,n.colCount,f,t.JT,s),t.YT()):l?Q(t,e,n,i,a,u,c):J(t,n,e,i,f,u,s,c)}else W(e,i,a,f,r.clipboardText,r.clipboardImage,r.clipboardHtml)}finally{G(t,!1),G(e,!1)}}}e=this&&this.__extends||(A=function(t,n){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.OpenPasteSpecialDialogActive=t.ClipboardPasteUndoAction=t.ClipboardPasteRangeUndoAction=void 0,nt=n("./dist/core/core.enum.js"),et=n("./dist/core/util/common.js"),K=n("./dist/core/worksheet/worksheet-actions.js"),s=n("./dist/core/worksheet/worksheet.js"),f=n("./dist/core/util/domUtil.js"),p=n("./dist/core/worksheet/clipboardhelper.js"),x=n("./dist/core/worksheet/worksheet-static.js"),g=n("Common"),l=n("./dist/core/core.ns.js"),i=n("CalcEngine"),r=n("./dist/core/worksheet/actionbase.js"),h=n("./dist/core/worksheet/paste-special-dialog.js"),y=!!i,X=null,it=void 0,d=g.Common.Uf.OS,R=Math.max,c=Math.min,F=Math.floor,M=et.mt.Tt,n=new g.Common.ResourceManager(l.SR,"Sheets"),rt=n.getResource.bind(n),ot=g.Common.lt.ht,w="^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$",S="^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$",I=r.ActionBase,e($,I),$.WT=function(t){var n,e,n=0,e=[nt.ClipboardPasteOptions.all,nt.ClipboardPasteOptions.usingSourceTheme,nt.ClipboardPasteOptions.noBorder,nt.ClipboardPasteOptions.allAndColumnWidth].includes(t);return!e&&1!==t&&t!==nt.ClipboardPasteOptions.valuesAndNumberFormatting&&t!==nt.ClipboardPasteOptions.valuesAndSourceFormatting||(n|=1),!e&&2!==t&&t!==nt.ClipboardPasteOptions.valuesAndSourceFormatting||(n|=608),!e&&3!==t&&t!==nt.ClipboardPasteOptions.formulasAndNumberFormatting||(n|=2),!e&&4!==t||(n|=609),!e&&5!==t||(n|=610),e&&(n|=8116),t===nt.ClipboardPasteOptions.comments&&(n|=nt.CopyToOptions.comment),n},$.prototype.canExecute=function(){var t,n,e,i,r,i,e,t=this,n=t.tT,e=n.pasteExtent,i=e.targetRange,r=e.sourceRange,i=n.toSheet.PT(i.row,i.col,i.rowCount,i.colCount,{sheetArea:nt.SheetArea.viewport})||L(n.toSheet,t.tT.pasteOption),e=!e.isCutting||n.fromSheet.PT(r.row,r.col,r.rowCount,r.colCount,{sheetArea:nt.SheetArea.viewport})||L(n.fromSheet,t.tT.pasteOption);return i&&e},$.prototype.XI=function(){var t,n,e,i,r,o,n,a,t,t=this,n=t.tT.pasteExtent,e=t.tT.Kh={},i=n.isCutting,r=$.WT(t.tT.pasteOption),o=n.sourceRange,n=n.targetRange,a=t.tT.fromSheet,t=t.tT.toSheet;a&&o&&i&&!a.isDirtySuspended()&&(e.qI=new K.ChangedCells(a,o,r)),t.isDirtySuspended()||(e.$I=new K.ChangedCells(t,n,r))},$.prototype.nx=function(){return this.tT.pasteExtent.targetRange},$.prototype.ex=function(t,n,e,i,r,o){var F,a,u,s,c,o,L,B,P,G,U,H,f,l,h,d,v,m,g,p,V,z,Y,Z,W,b,w,y,M,C,S,T,A,I,Q,J,x,N,k,_,D,K,X,j,q,O,$,tt,E,D,R,M,b,w,E,b,h,v,D,w,M,T,b,F=!1,a=n.row,u=n.col,s=n.rowCount,c=n.colCount,o=r!==o,L=!1,B=!1,P=!1,G=!1,U=ht(r),H=!1,f=r.o5(),m=r.getRowCount(),g=r.getColumnCount(),p=s,V=c,z=0,Y=0,Z=0,W=0;if(f&&(p-=r.ix(a,p,!0),V-=r.ix(u,V)),b=r.tables&&r.tables.AB(a,u,s,c),y=ut(e,g),M=st(e,m),A=this.bx,I=this.kse,Q=i===nt.InsertShiftCell.right,J=i===nt.InsertShiftCell.down,D=w=!1,-1===(x=e.row)&&(D=!(x=0)),-1===(N=e.col)&&(N=0),-1===(k=e.rowCount)&&(k=m),-1===(_=e.colCount)&&(_=g),K=!1,-1===u&&(K=!(u=0)),-1===a&&(K=!(a=0)),I){if(1<b.length)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(1===b.length){if(C=b[0])if(S=C.Tx,T=C.Sx,Q){if(!o&&(T+C.Ky!==k&&(u!==C.iw||k<C.Ky+T)&&!(k<=C.Ky||!t&&u===C.iw&&p%k==0)||!A&&t&&at(r,e)))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};u===C.iw&&p%k==0||(w=!0),u===C.iw&&(C=it)}else if(J){if(!o&&y&&a<=x&&_>C.iw&&_<C.iw+C.Tx&&(t||V%_!=0))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};_===S&&0===C.iw&&a!==C.Ky&&(w=!0),a===C.Ky&&(C=it)}}else if(t&&(!y||M)&&r.tables&&r.tables.Uue(e))return r.jT(1,rt().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0}}if(I&&C&&(X=C.name()),w||t||C&&!y||!(Q&&p%k==0||J&&V%_==0)){if(Q){if(b=void 0,l=a,d=M=k,w=!C||!I||A||!st(n,m),E=C&&k<=C.Ky,j=w||E,f&&(M+=b=r.lT(a,M),d+=b),b=!1,!o){if(v=(h=x)+k,j&&a!==h&&(0!==x||-1!==a||!D)&&e.intersect(a,u,M,r.getColumnCount()-u))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!C&&I&&ft(e,n,a,u,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(N<u&&u<=N+_-1&&h<a&&a<=v-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(vt(r,a,u,M,r.getColumnCount()-u,X)||!j&&C&&u<N&&h>=C.Ky&&h<C.Ky+T&&v>C.Ky+T)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!A&&t&&N<u&&!ct(r,e)&&dt(r,x,N+_,k,u-N-_+(C?C.Tx-(u-C.iw):0)))return r.jT(1,rt().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};if(!w&&C)if(E)$=k;else{if(0!==C.Ky&&u!==C.iw)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};u===C.iw&&(b=!0),u<N&&h>=C.Ky&&v<=C.Ky+T&&k===C.Sx&&(O=_),$=b?k:C.Sx}}if(o||(a!==x&&-1!==a||!(u<=N)||C&&!b&&!E)&&ot(O)||(f?(e.col+=e.colCount,e.col=r.O5(e.col-1),Y=r.lT(e.col,e.colCount),e.colCount+=Y):e.col=e.col+(ot(O)?e.colCount:O),L=!0),h=r.getColumnCount()-e.colCount,v=e.colCount,f&&(W=r.lT(u,e.colCount),h=g-(v=(D=e.colCount+W)+r.ox(g-1,D)),L)&&(e.col+=W),(H=lt(r,l,h,d,v))&&!U)return r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(J){if(M=void 0,h=u,v=w=_,j=!C||!I||A||ut(n,g)||_<=C.iw,f&&(w+=M=r.lT(u,w),v+=M),!j&&C&&y&&(_<S||_<C.iw+S||(!C.showHeader||C.Ky!==a)&&_!==C.iw+S))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!o){if(C&&y&&C.iw<w&&C.iw+C.Tx!==w&&e.intersect(a,u,r.getRowCount()-a,w))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(!C&&I&&ft(e,n,a,u,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(y&&j&&u!==N&&e.intersect(a,u,r.getRowCount()-a,w))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(y&&u!==N&&e.intersect(a,u,r.getRowCount()-a,e.colCount))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(x<a&&a<=x+k-1&&N<u&&u<=N+w-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(mt(r,a,u,r.getRowCount()-a,w,X))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!A&&t&&x<a&&!ct(r,e)&&dt(r,x+k,N,a-x-k+(C?C.Sx-(a-C.Ky):0),w))return r.jT(1,rt().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};!j&&C&&(T=k,t&&(!y&&e.intersect(C.Ky,0,C.Sx,C.endColumn()+1)||new et.Range(C.Ky,0,C.Sx,C.endColumn()+1).containsRange(e))&&(T=x+k-1-C.endRow()),r.getColumnCount()%w==0)&&(0<T?!y&&a<x?q=T:w===S&&(tt=S):t&&T<0&&(u===N||-1===u)&&a<=x&&(q=k))}if(o||ot(q)&&(u!==N&&-1!==u||!(a<=x)||C&&!y)||(f?(e.row=e.row+e.rowCount,e.row=r.j5(e.row-1),z=r.lT(e.row,e.rowCount,!0),e.rowCount+=z):e.row=e.row+(ot(q)?e.rowCount:q),B=!0),l=m-e.rowCount,d=e.rowCount,f&&(Z=r.lT(a,e.rowCount,!0),l=m-(d=(b=e.rowCount+Z)+r.ox(m-1,b,!0)),B)&&(e.row+=Z),(H=lt(r,l,h,d,v))&&!U)return r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}}else if(p%k==(D=E=0)&&V%_!=0?(c=n.colCount=_,f&&(E=r.lT(u,c),n.colCount=c+=E)):p%k!=0&&V%_==0&&(s=n.rowCount=k,f)&&(D=r.lT(a,s,!0),n.rowCount=s+=D),F=!0,Q){if(R=!1,j=!C||!I||A||!st(n,m),!o){if((a<=e.row&&a+s>=e.row+e.rowCount||K&&-1===e.row)&&(R=!0),!C&&I&&ft(e,n,a,u,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(N<u&&u<=N+_-1&&x<a&&a<=x+k-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!R&&e.intersect(a,u,s,g-u))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(vt(r,a,u,s,g-u,X))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!j&&C&&k===C.Sx){if(0!==C.Ky)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};u<N&&(O=c),$=C.Sx}(R&&u<=N&&(!C||y)||!ot(O))&&(f?(e.col+=c,e.col=r.O5(e.col-1),Y=r.lT(e.col,c),e.colCount+=Y):e.col+=ot(O)?c:O,P=!0)}if(l=a,d=s,h=g-c,v=c,f&&(h=g-(v=c+(W=r.ox(g-1,c))+E)),(H=lt(r,l,h,d,v))&&!U)return r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(J){if(R=!1,j=!C||!I||A||ut(n,g),!o){if(u<=N&&N+_<=u+c&&(R=!0),!C&&I&&ft(e,n,a,u,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(x<a&&a<=x+k-1&&N<u&&u<=N+_-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!R&&e.intersect(a,u,r.getRowCount()-a,c))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(mt(r,a,u,r.getRowCount()-a,c,X))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(x<a&&a<x+k||ut(n,g)&&C&&_>C.iw&&C.iw+S>_&&e.intersect(a,u,r.getRowCount()-a,c))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};!j&&C&&0<s&&r.getColumnCount()%_==0&&_===S&&0===C.iw&&(tt=S),(!C||y)&&R&&a<=x&&(f?(e.row+=s,e.row=r.j5(e.row-1),z=r.lT(e.row,s,!0),e.rowCount+=z):e.row+=s,G=!0)}if(l=r.getRowCount()-s,d=s,h=u,v=c,f&&(l=m-(d=s+(Z=r.ox(m-1,s,!0))+D)),(H=lt(r,l,h,d,v))&&!U)return r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}return{changePasteDataRangeCol:L,changePasteDataRangeRow:B,changePasteDataRangeCols:P,changePasteDataRangeRows:G,moveRangeHaveValue:H,returnFunc:!1,selectRange:F,adjustedTableRowCount:$,adjustedTableColCount:tt,changePasteDataRangeRowInvisibleCount:z,changePasteDataRangeColInvisibleCount:Y,invisibleRowCountInAcRange:Z,invisibleColCountInAcRange:W}},$.prototype.fx=function(F,t,n,e,L,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,t,b,B,w,n,y,M,P,C,S,T,A,I,x,N,k,G,U,_,D,j,O,H,E,V,R,f=!1,l=!1,h=this.kse,d=e.o5(),v=e.getColumnCount(),m=-1!==i.col&&i.colCount!==v,g=!1,p=t===nt.InsertShiftCell.right,t=t===nt.InsertShiftCell.down,b=at(e,new et.Range(r,o,t?1:a,p?1:u)),B=0,w=!1,n=e!==n;if(h&&b&&(-1===r&&(r=0),-1===o)&&(o=0),b&&(p&&o===b.iw||t&&r===b.Ky)&&(b=it),F){if(p)if(e.mT(r,o+u,a,e.getColumnCount()-o-u,!0))if(y=b&&i.rowCount>b.Ky&&b.showHeader(),o+u<e.getColumnCount()){if(M=b&&o===b.iw,d)if(P=a,C=u+e.ox(e.getColumnCount()-1,u),-1===r)-1!==i.row||n?e.moveTo(r,o,r,o+u,a,e.getColumnCount()-o-u,nt.CopyToOptions.all,!0):(e.addColumns(o,u),e.deleteColumns(e.getColumnCount()-u,u));else for(S=r;S<r+P&&S<e.getRowCount();S++)0!==e.getRowHeight(S)&&e.moveTo(S,o,S,o+u,1,e.getColumnCount()-o-C,nt.CopyToOptions.all,!0);else h&&b&&!M&&(b.showFooter()||y)?(T=b.endRow(),b.showFooter()&&(B=T),i.rowCount>T+1&&e.moveTo(T+1,o,T+1,o+i.colCount,i.rowCount-T-1,e.getColumnCount()-o-i.colCount,nt.CopyToOptions.all,!0)):-1!==r||-1!==i.row||n?e.moveTo(r,o,r,o+u,a,e.getColumnCount()-o-u,nt.CopyToOptions.all,!0):(e.addColumns(o,u),e.deleteColumns(e.getColumnCount()-u,u));z(e,r,o,r,o+u),(I=(A=e.rowFilter())&&A.range)&&-1===r&&1<I.colCount&&o>I.col&&o<=I.col+I.colCount-1&&(I.colCount=I.colCount+i.colCount),h&&b&&(M||i.rowCount!==b.Sx&&!st(i,e.getRowCount())||(b.showFooter()||y?(b.insertColumns(o-b.iw,i.colCount),g=!0):b.K5t(new et.Range(b.Ky,b.iw,b.Sx,b.Tx+u))))}else o+u>e.getColumnCount()&&(l=f=!0);else l=f=!0;else if(t)if(e.mT(r+a,o,e.getRowCount()-r-a,u,!0))if(r+a<e.getRowCount()){if(x=0,h&&b&&(k=(N=b.dataRange()).col+N.colCount,(G=r===b.Ky)||(x=a,0<(x=c&&i.row>=b.startRow()&&i.row<=b.endRow()?i.row+i.rowCount-1-b.endRow():x)&&(s=b.footerIndex())),!c&&m&&v%i.colCount==0||!m&&!Y(e,{row:i.row,col:k,rowCount:i.rowCount,colCount:i.colCount-k})||(g=!0)),d)if(U=u,_=a+e.ox(e.getRowCount()-1,a,!0),-1===o)-1!==i.col||n?e.moveTo(r,o,r+a,o,e.getRowCount()-r-_,i.colCount,nt.CopyToOptions.all,!0):(e.addRows(r,a),e.deleteRows(e.getRowCount()-a,a));else for(D=o;D<o+U&&D<e.getColumnCount();D++)0!==e.getColumnWidth(D)&&e.moveTo(r,D,r+a,D,e.getRowCount()-r-_,1,nt.CopyToOptions.all,!0);else j=0<x,ot(s)||-1===s?(j&&b.K5t(new et.Range(b.Ky,b.iw,b.Sx+x,b.Tx)),-1!==o||-1!==i.col||n?e.moveTo(r,o,r+a,o,e.getRowCount()-r-a,u,nt.CopyToOptions.all,!0):(e.addRows(r,a),e.deleteRows(e.getRowCount()-a,a))):(e.moveTo(s+1,o,s+1+a,o,e.getRowCount()-s-1-a,u,nt.CopyToOptions.all,!0),j&&b.K5t(new et.Range(b.Ky,b.iw,b.Sx+x,b.Tx)),0<(O=s+x-r-a)&&e.moveTo(r,o,r+a,o,O,u,nt.CopyToOptions.all,!0));z(e,r,o,r+a,o)}else r+a>e.getRowCount()&&(l=f=!0);else l=f=!0}else if(p)if(e.mT(r,o+i.colCount,i.rowCount,e.getColumnCount()-o-i.colCount,!0))if(o+i.colCount<e.getColumnCount()){if(M=b&&o===b.iw,y=b&&i.rowCount>b.Ky&&b.showHeader(),d)if(H=i.rowCount,C=(E=i.colCount+e.lT(o,i.colCount))+e.ox(e.getColumnCount()-1,E),-1===r)-1!==i.row||n?e.moveTo(r,o,r,o+E,i.rowCount,e.getColumnCount()-o-C,nt.CopyToOptions.all,!0):(e.addColumns(o,i.colCount),w=!0);else for(S=r;S<r+H&&S<e.getRowCount();S++)0===e.getRowHeight(S)?H++:e.moveTo(S,o,S,o+E,1,e.getColumnCount()-o-C,nt.CopyToOptions.all,!0);else h&&!c&&b&&!M&&(b.showFooter()||y)?(T=b.endRow(),b.showFooter()&&(B=T),i.rowCount>T+1&&e.moveTo(T+1,o,T+1,o+i.colCount,i.rowCount-T-1,e.getColumnCount()-o-i.colCount,nt.CopyToOptions.all,!0)):-1!==r||-1!==i.row||n?e.moveTo(r,o,r,o+i.colCount,i.rowCount,e.getColumnCount()-o-i.colCount,nt.CopyToOptions.all,!0):(e.addColumns(o,i.colCount),w=!0);z(e,r,o,r,o+i.colCount),(I=(A=e.rowFilter())&&A.range)&&-1===r&&1<I.colCount&&o>I.col&&o<=I.col+I.colCount-1&&(I.colCount=I.colCount+i.colCount),h&&b&&i.rowCount>b.Ky&&(M||i.rowCount!==b.Sx&&!st(i,e.getRowCount())||(c||!b.showFooter()&&!y?b.K5t(new et.Range(b.Ky,b.iw,b.Sx,b.Tx+i.colCount)):(b.insertColumns(o-b.iw,i.colCount),g=!0)))}else o+i.colCount>e.getColumnCount()&&(l=f=!0);else l=f=!0;else if(t)if(e.mT(r+i.rowCount,o,e.getRowCount()-r-i.rowCount,i.colCount,!0))if(r+i.rowCount<e.getRowCount()){if(x=0,h&&b&&i.colCount>b.iw&&(k=(N=b.dataRange()).col+N.colCount,(G=r===b.Ky)||(x=i.rowCount,0<(x=c&&(!m&&i.intersect(b.Ky,0,b.Sx,b.endColumn()+1)||new et.Range(b.Ky,0,b.Sx,b.endColumn()+1).containsRange(i))?i.row+i.rowCount-1-b.endRow():x)&&(s=b.footerIndex())),!c&&m&&v%i.colCount==0||!m&&!Y(e,{row:i.row,col:k,rowCount:i.rowCount,colCount:i.colCount-k})||(g=!0)),d)if(V=i.colCount,_=(R=i.rowCount+e.lT(r,i.rowCount,!0))+e.ox(e.getRowCount()-1,R,!0),-1===o)-1!==i.col||n?e.moveTo(r,o,r+R,o,e.getRowCount()-r-_,i.colCount,nt.CopyToOptions.all,!0):(e.addRows(r,i.rowCount),w=!0);else for(D=o;D<o+V&&D<e.getColumnCount();D++)0===e.getColumnWidth(D)?V++:e.moveTo(r,D,r+R,D,e.getRowCount()-r-_,1,nt.CopyToOptions.all,!0);else j=0<x,ot(s)||-1===s?(j&&b.K5t(new et.Range(b.Ky,b.iw,b.Sx+x,b.Tx)),-1!==o||-1!==i.col||n?e.moveTo(r,o,r+i.rowCount,o,e.getRowCount()-r-i.rowCount,i.colCount,nt.CopyToOptions.all,!0):(e.addRows(r,i.rowCount),w=!0)):(e.moveTo(s+1,o,s+1+i.rowCount,o,e.getRowCount()-s-1-i.rowCount,i.colCount,nt.CopyToOptions.all,!0),j&&b.K5t(new et.Range(b.Ky,b.iw,b.Sx+x,b.Tx)),0<(O=s+x-r-i.rowCount)&&e.moveTo(r,o,r+i.rowCount,o,O,i.colCount,nt.CopyToOptions.all,!0));z(e,r,o,r+i.rowCount,o)}else r+i.rowCount>e.getRowCount()&&(l=f=!0);else l=f=!0;return{ignoreTableExpand:g,ignoreTableFooterIndex:B,raiseInvalidOperation:f,returnFunc:l,isInsert:w}},$.prototype.hx=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,s=u.changePasteDataRangeRowInvisibleCount,c=u.changePasteDataRangeColInvisibleCount,f=u.invisibleRowCountInAcRange,l=u.invisibleColCountInAcRange,h=this.tT.pasteExtent.targetRange;t&&(n.colCount-=c,n.col-=n.colCount,n.col-=l,h.colCount-=c),e&&(n.rowCount-=s,n.row-=n.rowCount,n.row-=f,h.rowCount-=s),i&&(n.colCount-=c,n.col-=o,n.col-=l,h.colCount-=c),r&&(n.rowCount-=s,n.row-=a,n.row-=f,h.rowCount-=s),u.changePasteDataRangeRowInvisibleCount=0,u.changePasteDataRangeColInvisibleCount=0,u.invisibleRowCountInAcRange=0,u.invisibleColCountInAcRange=0},$.prototype.vx=function(t,n){var e=[].concat(n.parent.sheets);return t&&(t.NMi||t.isReportTemplateSheet)&&e.push(t),n&&n!==t&&(n.NMi||n.isReportTemplateSheet)&&e.push(n),e},$.prototype.execute=function(){var t,t,n,e,i,r,o,a,u,s,c,f,F,l,l,t,h,d,h,d,h,v,m,g,p,b,d,t,w,L,B,P,G,h,y,M,C,U,H,S,S,T,S,T,S,A,I,V,x,N,z,Y,k,_,D,Z,W,j,O,E,R,Q,J,h,y,x,b,l,v,m,k,_,n=this;if(n.canExecute()&&(e=n.tT.fromSheet,i=n.tT.toSheet,r=n.tT.pasteExtent,o=n.tT.pasteOption,a=r.sourceRange,u=r.targetRange,s=r.isCutting,!e||!a||e.zT(a.row,a.col,a.rowCount,a.colCount,e.getRowCount(),e.getColumnCount()))&&i&&u&&i.HT(u.row,u.col,u.rowCount,u.colCount,!0)&&!(i.tables&&i.tables.mx(e,a,i,u,s)||i.pivotTables&&i.pivotTables.KYt(a,u,i))){if(e&&(F=e.ST(),c=n.sA,f=n.fA)&&(l=f.row,t=f.col,h=f.rowCount,d=f.colCount,l=new et.Range(l,t,h,d),null!=(t=r.pasteSpecialOptions)&&t.transpose&&(h=f.row<0?0:f.row,d=f.col<0?0:f.col,f=new et.Range(h,d,f.colCount,f.rowCount)),null!=(t=r.pasteSpecialOptions))&&t.pasteLink&&(f=new et.Range(f.row,f.col,u.rowCount,u.colCount),h=e.getSpan(f.row,f.col))&&h.rowCount===a.rowCount&&h.colCount===a.colCount&&(f=new et.Range(f.row,f.col,1,1)),n.cA&&(v=n.cA.row,m=n.cA.col,g=n.cA.rowCount,p=n.cA.colCount),d=n.kse,t=i===e,h=ht(i),y=G=P=B=L=!1,H=U=C=M=0,c!==it&&f){if(t&&s&&c===nt.InsertShiftCell.right&&st(f,i.getRowCount())&&(w=at(i,f))&&(S=at(i,new et.Range(v,m,g,p)))&&S.name()===w.name()&&(n.tT.Hfe=w,i.tables.remove(w,1)),(S=this.ex(s,n.cA,f,c,i,e)).returnFunc)return void q(i,w,s,c);L=S.changePasteDataRangeCol,B=S.changePasteDataRangeRow,M=S.changePasteDataRangeRowInvisibleCount,C=S.changePasteDataRangeColInvisibleCount,U=S.invisibleRowCountInAcRange,H=S.invisibleColCountInAcRange,P=S.changePasteDataRangeCols,G=S.changePasteDataRangeRows,y=S.moveRangeHaveValue,b=S.selectRange,g=n.cA.rowCount,p=n.cA.colCount,u.rowCount+=M,u.colCount+=C,T=S.adjustedTableRowCount,S=S.adjustedTableColCount,ot(T)||(u.row=0,u.rowCount=T),ot(S)||(u.col=0,u.colCount=S)}n.XI(),T=n.vx(e,i),K.Commands.II(T),i.suspendPaint(),i.suspendEvent(),S=!(i.QI=!0),e&&(e.suspendEvent(),e.QI=!0);try{if(h&&!(V=this.ype(e,i,a,u,v,m,c,y,l,w,s)))S=!0,A=1,I=rt().Exp_InvalidCopyPasteSize,x=i.U5(),u.colCount=x.colCount,u.rowCount=x.rowCount;else if((S=(N=c!==it&&this.fx(b,c,e,i,n.cA,l,v,m,g,p,n.px,s)).raiseInvalidOperation)&&(A=1,I=rt().Exp_InsertCopiedCutCellsNoRange),N.returnFunc)q(i,w,s,c);else{if(a&&et.Be.Ll(e,a.row,a.col,a.row+a.rowCount-1,a.col+a.colCount-1),!N&&(!a||-1!==a.col&&-1!==a.row)||N&&!N.ignoreTableExpand)try{z={shiftCells:n.bx&&c===nt.InsertShiftCell.down,isCopy:!s,isFirst:!1,isHeaderPaste:n.kse},Y=[],k=ot(N.ignoreTableFooterIndex)?0:N.ignoreTableFooterIndex,_=new et.Range(u.row,u.col,u.rowCount-k,u.colCount),i.tables&&i.tables.yx(e,_,a,X,X,X,{shiftInfo:z,backupTableResizedArgs:Y}),this.tT.Kh.lCe=Y}catch(t){return S=!0,A=6,I=t.message,void q(i,w,s,c)}D=f||a,Z=s&&c!==it&&(c===nt.InsertShiftCell.right&&(-1===D.row||D.row===u.row)||c===nt.InsertShiftCell.down&&(-1===D.col||D.col===u.col)),tt(e,f||a,i,u,W={isCutting:s,clipboardText:r.clipboardText,clipboardHtml:r.clipboardHtml,clipboardImage:r.clipboardImage,clipboardPasteOptions:o,ignoreFilteredOutRow:!r.includeFilteredOutRow,ignorePasteSkipInvisibleRange:!0===Z,pasteSpecialOptions:r.pasteSpecialOptions}),s&&c!==it&&(j=D.row,O=D.col,E=D.rowCount,R=D.colCount,Q=u.row,J=u.col,c!==nt.InsertShiftCell.right||-1!==D.row&&D.row!==u.row||(t&&d&&O<J&&ct(i,u)&&(u.col-=R),-1===j&&N.isInsert&&t?e.deleteColumns(O,R):e.moveTo(j,O+R,Q,O,E,i.getColumnCount()-O-R,nt.CopyToOptions.all,!0)),c!==nt.InsertShiftCell.down||-1!==D.col&&D.col!==u.col||(t&&d&&j<Q&&ct(i,u)&&(u.row-=E),-1===O&&N.isInsert&&t?e.deleteRows(j,E):e.moveTo(j+E,O,j,J,i.getRowCount()-j-E,R,nt.CopyToOptions.all,!0)))}}finally{q(i,w,s,c),a&&et.Be.dl(),i.resumeEvent(),i.QI=!1,e&&(e.resumeEvent(),e.QI=!1),i.resumePaint(),K.Commands.xI(T,n.tT),h=n.tT.Kh,y=$.WT(o),r.isCutting&&e&&(x=[],e.isDirtySuspended()||((b=new K.ChangedCells(e,a,y)).yI(h.qI.bI()),x=(h.wx=b).MI()),K.Commands.SI(e,a.row,a.col,a.rowCount,a.colCount,x,3,it,it,c)),i&&(l=[],i.isDirtySuspended()||((v=new K.ChangedCells(i,u,y)).yI(h.$I.bI()),l=(h.Mx=v).MI()),m=i.tables&&i.tables.WI&&i.tables.WI(u.row,u.col,u.rowCount,u.colCount),k=u.rowCount,_=u.colCount,K.Commands.SI(i,u.row,u.col,k,_,l,3,m,it,c),n.tableNamesObj={r:u.row,c:u.col,rc:k,cc:_,tableNames:m}),n.Cx={changePasteDataRangeCol:L,changePasteDataRangeRow:B,changePasteDataRangeCols:P,changePasteDataRangeRows:G,acColCount:p,acRowCount:g,changePasteDataRangeRowInvisibleCount:M,changePasteDataRangeColInvisibleCount:C,invisibleRowCountInAcRange:U,invisibleColCountInAcRange:H},F&&delete F.TT,S&&i.jT(A,I)}}},$.prototype.ype=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,l,l,d,l=-1,h=-1;if(-1!==i.row?l=i.row+i.rowCount:-1===e.row&&(l=t.getRowCount()),v=l-(d=n.getRowCount()),(l=d<l)&&U(e,i))a===nt.InsertShiftCell.down&&u?n.addRows(d,d-r+v):n.addRows(d,v);else if(u||r+i.rowCount!==d||a!==nt.InsertShiftCell.down){if(u&&a===nt.InsertShiftCell.down)n.addRows(d,d-r+v);else if(l)return q(n,c,f,a),!1}else n.addRows(d,d-r+v-s.rowCount);if(-1!==i.col?h=i.col+i.colCount:-1===e.col&&(h=t.getColumnCount()),(d=(l=n.getColumnCount())<h)&&U(e,i))a===nt.InsertShiftCell.right&&u?n.setColumnCount(h+l-o):n.setColumnCount(h);else if(u||o+i.colCount!==l||a!==nt.InsertShiftCell.right){if(u&&a===nt.InsertShiftCell.right)n.setColumnCount(h+l-o);else if(d)return q(n,c,f,a),!1}else n.setColumnCount(h+l-o-s.colCount);return!0},$.prototype.undo=function(){var t,n,e,i,r,o,a,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,t=this;if(t.canUndo()){if(n=t.tT.fromSheet,e=t.tT.toSheet,r=(i=t.tT.pasteExtent).sourceRange,o=i.targetRange,!e||!o)return!1;if(t.Cx&&(a=t.Cx,this.hx(a.changePasteDataRangeCol,r,a.changePasteDataRangeRow,a.changePasteDataRangeCols,a.changePasteDataRangeRows,a.acColCount,a.acRowCount,a)),!e.zT(o.row,o.col,o.rowCount,o.colCount,e.getRowCount(),e.getColumnCount()))return!1;if(n&&r){if(!n.zT(r.row,r.col,r.rowCount,r.colCount,n.getRowCount(),n.getColumnCount()))return!1;if(n.name()===e.name()&&e.parent&&!n.NMi&&e.parent!==n.parent)return!1}a=t.tT.Kh,e.suspendPaint();try{u=o.row<0?0:o.row,s=o.col<0?0:o.col,c=o.row<0?e.getRowCount():o.rowCount,f=o.col<0?e.getColumnCount():o.colCount,l=t.vx(n,e),K.Commands.NI(l,t.tT),(d=(h=e.rowFilter())&&h.range)&&-1===o.row&&d.col<o.col&&d.col+d.colCount>=o.col+o.colCount&&(d.colCount=d.colCount-o.colCount),p=g=m=v=0,n&&r&&(v=r.row<0?0:r.row,m=r.col<0?0:r.col,g=r.row<0?n.getRowCount():r.rowCount,p=r.col<0?n.getColumnCount():r.colCount),b=[],w=[],(y=t.tableNamesObj)&&(e&&y.r===u&&y.c===s&&y.rc===c&&y.cc===f&&(w=y.tableNames),n)&&y.r===v&&y.c===m&&y.rc===g&&y.cc===p&&(b=y.tableNames),M=t.sA,e&&(C=a.Mx,K.Commands.SI(e,u,s,c,f,C?C.MI():[],3,b,!0,M)),i.isCutting&&n&&(S=a.wx,K.Commands.SI(n,v,m,g,p,S?S.MI():[],3,w,!0,M)),(T=t.tT.Hfe)&&q(e,T,i.isCutting,M),(0,et.handleRestoredTableResizedArgs)(a.lCe)}finally{e.resumePaint()}}return!0},$.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},N=$,t.ClipboardPasteRangeUndoAction=N,D=r.ActionBase,e(o,D),o.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,t=this,n=t.tT,e=n.cachedActions,i=!1;if(t.canExecute()&&e){o=(r=t.Mf).parent.jg(),t.X5(o,!0);try{for(a=!1,u=n.fA&&(Array.isArray(n.fA)?n.fA:[n.fA]),s=0;s<e.length;s++)(c=e[s]).sA=n.sA,c.kse=n.kse,c.cA=n.cA,c.fA=u&&(n.hT?u[s]:u[0]),c.bx=n.bx,c.px=n.px,r?(f=c.tT.pasteExtent,h=(l=t.tT).fromSheet,d=l.fromRanges&&l.fromRanges[s],v=f.clipboardText,(m=f.clipboardHtml)&&(g="<html>\r\n<body>\r\n\x3c!--StartFragment--\x3e",p="\x3c!--EndFragment--\x3e\r\n</body>\r\n</html>",m.substr(0,g.length)===g&&m.substr(m.length-p.length,p.length)===p&&(m=m.substring(g.length,m.length-p.length)),et.mt.Qf())&&(b="<meta charset='utf-8'>",m.substr(0,b.length)===b)&&(m=m.substring(b.length,m.length)),!v&&h&&d&&(v=h.bT([d])),!m&&h&&d&&C(r)&&(m=h.MT([d])),w={sheet:r,sheetName:r.name(),cellRange:c.nx(),pasteOption:c.tT.pasteOption,pasteData:{text:v,html:m},shiftCells:n.sA,fromSheet:h,fromRange:d,isCutting:!!l.isCutting,cancel:!1,action:l.isCutting?nt.ClipboardActionType.cut:nt.ClipboardActionType.copy},(y=f.clipboardImage)&&(w.pasteData.image=y),r.ki(et.Events.ClipboardPasting,w),w.cancel||(i=c.execute(),delete w.cancel,a=!0,r.ki(et.Events.ClipboardPasted,w))):i=c.execute();a&&t.Ax()}finally{t.q5(o,!0)}}return i},o.prototype.Ax=function(){var t,n,e,i,t,r,o,a,u,s,c,a,t=this,n=t.tT,e=n.cachedActions,i=t.Mf;if(i&&e){if(t=i.getSelections(),r=[],o=i.parent,i.IA(),n.hT)a=n.pastedRanges[0],i.n4(a.row,a.col,a.rowCount,a.colCount);else if(1<e.length)for(u=0;u<e.length;u++)c=(s=e[u]).nx(),i.n4(c.row,c.col,c.rowCount,c.colCount);else 0<e.length&&(a=e[0].nx(),i.n4(a.row,a.col,a.rowCount,a.colCount),a.contains(i.ui,i.ci)||i.XA(a.row,a.col));r=i.getSelections(),i.EA(t,r)&&i.jA(t),o&&n.Z3&&o.changeSelectionInCommandExecuting(n,null,null,r)}},o.prototype.canExecute=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canExecute())return!1;return!0}return!1},o.prototype.canUndo=function(){var t,n,e,t=this.tT.cachedActions;if(t){for(n=0;n<t.length;n++)if(!(e=t[n]).canUndo())return!1;return!0}return!1},o.prototype.undo=function(){var t,n,e,i,r,o,t=this,n=t.tT.cachedActions;if(t.canUndo()&&n){e=!0,i=t.Mf.parent.jg(),t.X5(i,!0);try{for(r=n.length-1;0<=r;r--)o=n[r],e=e&&o.undo()}finally{t.q5(i,!0)}return e}return!1},t.ClipboardPasteUndoAction=o,j=r.ActionBase,e(Z,j),Z.prototype.canExecute=function(){return et.mt.isEnablePasteSpecial(this.Mf)},Z.prototype.execute=function(){var n,e,t,n=this;return!!this.canExecute()&&(e=this.Mf.parent,(t=new h.PasteSpecialDialog(document.body,2e3,!0)).rQ(function(t){e.commandManager().execute({cmd:"paste",sheetName:n.tT.sheetName,pasteOption:t.pasteOptions,pasteSpecialOptions:t})}),!0)},t.OpenPasteSpecialDialogActive=Z,i=f.GC$,T=function(t,n){var t=u({},t);return[nt.ClipboardPasteOptions.formatting,nt.ClipboardPasteOptions.comments,nt.ClipboardPasteOptions.validation,nt.ClipboardPasteOptions.columnWidths].includes(n)&&(t.operationOptions=nt.PasteOperationOptions.none),(n!==nt.ClipboardPasteOptions.all&&n!==nt.ClipboardPasteOptions.noBorder||t.operationOptions)&&(t.pasteLink=!1),t.advancedPasteOptions={},n===nt.ClipboardPasteOptions.validation?t.advancedPasteOptions.validator=!0:n===nt.ClipboardPasteOptions.usingSourceTheme||n===nt.ClipboardPasteOptions.valuesAndSourceFormatting?t.advancedPasteOptions.usingSourceTheme=!0:n===nt.ClipboardPasteOptions.noBorder?t.advancedPasteOptions.noBorder=!0:n===nt.ClipboardPasteOptions.columnWidths||n===nt.ClipboardPasteOptions.allAndColumnWidth?t.advancedPasteOptions.columnWidth=!0:n!==nt.ClipboardPasteOptions.valuesAndNumberFormatting&&n!==nt.ClipboardPasteOptions.formulasAndNumberFormatting||(t.advancedPasteOptions.numberFormats=!0),t},i.extend(s.Worksheet.prototype,{copyTo:function(t,n,e,i,r,o,a){this.vT(t,n,e,i,r,o,a)},vT:function(t,n,e,i,r,o,a,u,s,c,f){var l=this;l.suspendPaint(),l.suspendEvent(),x.staticMembers.copyTo(l,t,n,c||l,e,i,r,o,a,u,0,s,void 0,void 0,f),l.resumeEvent(),l.resumePaint()},moveTo:function(t,n,e,i,r,o,a,u){var s=this;if(!(y&&a&nt.CopyToOptions.formula)||s.mT(t,n,r,o,!0)&&s.mT(e,i,r,o,!0))try{s.suspendPaint(),s.suspendEvent(),x.staticMembers.moveTo(s,t,n,s,e,i,r,o,a,u)}finally{s.resumeEvent(),s.resumePaint()}},bT:function(t){var n,e,i,r,o,t,n=this,e=n.yT(t);if(e)return i="\t",r="\r\n",o='"',t=n.wT(t),(0,K.getRangeText)(n,e.row,e.rowCount,e.col,e.colCount,r,i,'"',!1,t.rows,t.cols,!0)},MT:function(t){var n,e,t,i,n=this,e=n.yT(t);if(e)return t=n.wT(t),i=k(n),p.yM.KS(n,i,e.row,e.rowCount,e.col,e.colCount,nt.SheetArea.viewport,C(n),t.rows,t.cols,!1,!1,!1,!1)},CT:function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i.rt,o=i.bT(t);if(o){(a=i.ST()).DS=i,a._S=t,n&&i.NMi&&1===t.length&&-1===t[0].row&&-1===t[0].col&&(n=!1),a.ES=n,(u=i.ST()).TT=!0,s=i.MT(t),i.AT&&i.AT(),i.ieV&&i.ieV();try{if(c={sheet:i,sheetName:i.name(),copyData:{text:o,html:s},ranges:t,isCutting:n,cancel:!1,action:n?nt.ClipboardActionType.cut:nt.ClipboardActionType.copy},i.ki(et.Events.ClipboardChanging,c),!1===c.cancel)return r&&!e&&r.IT(C(i)?s:o),i.ki(et.Events.ClipboardChanged,{sheet:i,sheetName:i.name(),copyData:{text:o,html:s}}),setTimeout(function(){!r||e||i.xT||r.NT()},100),{copyText:o,copyHtml:s};a.c5()}catch(t){}}},kT:function(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,h,v,m,g,g,c,d=rt().Exp_PasteSourceCellsLocked;if(a.pastedInternal=!1,a.pastedRange=X,h=!o&&!s&&!h,!t&&h)return!1;if(g=(m=v=this).wT(n),v._T(t,v.yT(n),m,o,g.rows,g.cols,c)||h){if(a.pastedInternal=!0,r&&t.isActualProtected()&&t.ET(n)&&!L(t,i))return v.jT(1,d),!1;a.pastedRange=v.OT(t,n,m,e,i,r,u,l)}else g=v.RT(m,e,o,p.yM.n5(s)),c=v.BT(m,e,s),a.pastedRange=g.union(c);return v.LT(t,n,e,i,r,a,u,f,l)},LT:function(t,n,e,i,r,o,a,u,s){var c,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,c,h,A,I,v,x,N,k,_,D,j,O,E,f=this,l=rt().Exp_InvalidCopyPasteSize,h=f.FT(),d=rt().Exp_PasteChangeMergeCell,v=rt().Exp_ChangePartOfArray,m=f,g=o.pastedRange,p=m.o5(),b=null==s?void 0:s.pasteLink;if(!g)return f.jT(1,l),!1;if(!L(m,i)&&!m.PT(g.row,g.col,g.rowCount,g.colCount,{lockErrorMsg:h,arrayFormulaErrorMsg:v,shiftCells:a,sheetArea:nt.SheetArea.viewport}))return!1;if(o.pastedInternal){if(1===(w=n.length)){if(y=n[0],M=g.rowCount,C=g.colCount,S=y.rowCount,T=y.colCount,null!=s&&s.transpose&&(M=(c=[C,M])[0],C=c[1],S=(c=[T,S])[0],T=c[1]),r&&!t.PT(y.row,y.col,y.rowCount,y.colCount,{lockErrorMsg:h,arrayFormulaErrorMsg:v,sheetArea:nt.SheetArea.viewport}))return!1;if(!b&&t.GT(y.row,y.col,S,T))return f.jT(1,d),!1;if(c=g.row<0?m.getRowCount():g.rowCount,h=g.col<0?m.getColumnCount():g.colCount,A=y.row<0?t.getRowCount():y.rowCount,I=y.col<0?t.getColumnCount():y.colCount,p&&(c=(c-=m.ix(e.row,R(c,A),!0))<1?1:c,h=(h-=m.ix(e.col,R(h,I)))<1?1:h),v=2===i||(null==s?void 0:s.pasteLink),(A<c||I<h)&&!v){if(x=e.row,N=e.col,e.row<0&&A<m.getRowCount()&&(x=0),e.col<0&&I<m.getColumnCount()&&(N=0),c%A==0&&1===h?(h=I,p||(g=o.pastedRange=new et.Range(x,N,c,h))):1===c&&h%I==0?(c=A,p||(g=o.pastedRange=new et.Range(x,N,c,h))):c%A==0&&h%I==0||(g=o.pastedRange=new et.Range(x,N,c=A,h=I)),k=F(c/A),_=F(h/I),a===it||r&&(!u||!at(m,new et.Range(x,N,c,h))))for(D=0;D<k;D++)for(j=0;j<_;j++)if(!f.UT(y,g)&&m.GT(x<0?-1:x+D*A,N<0?-1:N+j*I,x<0?-1:A,N<0?-1:I))return f.jT(1,d),!1}else if(a===it&&!f.UT(y,g)&&m.GT(g.row,g.col,M,C))return f.jT(1,d),!1}else if(1<w){for(O=0;O<w;O++)if(E=n[O],t.GT(E.row,E.col,E.rowCount,E.colCount))return f.jT(1,d),!1;if(m.GT(g.row,g.col,g.rowCount,g.colCount))return f.jT(1,d),!1}}else{if(m.GT(g.row,g.col,g.rowCount,g.colCount))return f.jT(1,d),!1;if(!m.HT(g.row,g.col,g.rowCount,g.colCount))return f.jT(1,l),!1}return!0},UT:function(t,n){if(t&&1===t.rowCount&&1===t.colCount){var t=this.getSpan(n.row,n.col);if(t&&t.equals(n))return!0}return!1},_T:function(t,n,e,i,r,o,a){var u,s,c,f;if(t&&n&&e)try{return(s=(s=(u=(0,K.getRangeText)(t,n.row,n.rowCount,n.col,n.colCount,"\r\n","\t",'"',!1,r,o,!0,M.safari,!0))===i)||((s=!(s=u===i+"\r\n")&&M.chrome?u===i+"\t\r\n":s)||!(M.safari||M.mozilla||a)&&C(e)?s:u.replace(/\s/g,"")===i.replace(/\s/g,"")))||(c=new RegExp(String.fromCharCode(160),"g"),f=String.fromCharCode(32),s=(u=u.replace(c,f)).replace(/\s+$/,"")===i.replace(/\s+$/,"")),s}catch(t){}return!1},OT:function(t,n,e,i,r,o,a,u){var s,s,c,f,l,c,n,h,d,v,m,g,p,b,w,y,r,u,c,r,s=this,c=null==n?void 0:n.length,f=e.o5(),l=null==u?void 0:u.transpose;if(1!==c)return 1<c?s.fT(n,i,l):X;if(n=(c=n[0]).row<0?0:c.row,h=c.col<0?0:c.col,d=c.row<0?t.getRowCount():c.rowCount,v=c.col<0?t.getColumnCount():c.colCount,m=i.row<0?0:i.row,g=i.col<0?0:i.col,p=i.row<0?e.getRowCount():i.rowCount,b=i.col<0?e.getColumnCount():i.colCount,y=w=void 0,f&&(p=(p-=w=e.ix(m,R(p,d),!0))<1?1:p,b=(b-=y=e.ix(g,R(b,v)))<1?1:b),r=2===r||(null==u?void 0:u.pasteLink),o||1===p&&1===b&&!H(s,c))p=d,b=v;else if(!r&&(p%d==0&&1===b?b=v:1===p&&b%v==0?p=d:p%d==0&&b%v==0||(p=d,b=v),!s.zT(n,h,d,v,t.getRowCount(),t.getColumnCount())))return X;if(!o&&t.name()===e.name()&&ot(a))if(u=new et.Range(m,g,p,b),c=d,r=v,l&&(c=(s=[r,c])[0],r=s[1]),u.contains(n,h,c,r)){if((n-m)%c!=0||(h-g)%r!=0)return X}else if(u.intersect(n,h,c,r)&&(c<p||r<b))return X;return f&&(p+=e.lT(m,p,!0),b+=e.lT(g,b)),e.HT(m,g,p,b)?(-1===i.row&&(p=m=-1),-1===i.col&&(b=g=-1),new et.Range(m,g,p,b)):X},fT:function(t,n,e){var i,r,o,n,a,u,s,c,f,a,l,u,h,s,i=this,r=i.o5();if(1<t.length){if(o=-1===n.row?0:n.row,n=n.col<0?0:n.col,a=t[0],u=t[1],s=a.rowCount,c=a.colCount,f=a.row===u.row&&s===u.rowCount,a=a.col===u.col&&c===u.colCount,f&&!e||a&&e)return l=0,u=s,t.forEach(function(t){l+=t.colCount}),r&&(u+=i.lT(o,u,!0),l+=i.lT(n,l)),(0,et.Ec)(o,n,u,l);if(a&&!e||f&&e)return h=0,s=c,t.forEach(function(t){h+=t.rowCount}),r&&(h+=i.lT(o,h,!0),s+=i.lT(n,s)),(0,et.Ec)(o,n,h,s)}return X},RT:function(t,n,e,i){var r,n,o,e,i,e,r=n.row<0?0:n.row,n=n.col<0?0:n.col,o=new et.Range(r,n,1,1),e=O(e,"\r\n","\t",'"',!1,i);return e&&(i=e.length,e=(0,K.getMaxLength)(e),0<i)&&0<e&&(t.o5()&&(i+=t.lT(r,i,!0),e+=t.lT(n,e)),o=new et.Range(r,n,i,e)),o},BT:function(t,n,e){var i,n,r,o,a,a,e,a,e,a,i=n.row<0?0:n.row,n=n.col<0?0:n.col,r=1,o=1,a=t.ST();return a&&((a=a.i5()).innerHTML=e,a=(e=a.getElementsByTagName("table"))&&e[0])&&((e=a.rows)&&(r=e.length,a=e[0]&&e[0].cells)&&(o=a.length),0<r)&&0<o&&t.o5()&&(r+=t.lT(i,r,!0),o+=t.lT(n,o)),new et.Range(i,n,r,o)},YT:function(){var t=this.ST();t&&t.c5()},fTe:function(){var t=this,n=t.rt;n.IT(M.safari?"test":""),document.execCommand("copy"),setTimeout(function(){n&&!t.xT&&n.NT()},100)},tA:function(t){if(!this.isEditing()){var n=this.getSelections();if(n&&1===n.length)return this.isActualProtected()&&this.ET(n)?(this.jT(14,this.FT()),X):this.CT(n,!0,t)}return X},yT:function(t){var n,e,i,r,o;if(t){if(1===(n=t.length))return t[0];if(1<n){if(e=t[0],i=t[n-1],o=r=void 0,e.row===i.row&&e.rowCount===i.rowCount){for(r=0;r<n;r++)(o=t[r]).col<e.col&&(e=o),o.col>i.col&&(i=o);return(0,et.Ec)(e.row,e.col,e.rowCount,i.col+i.colCount-e.col)}if(e.col===i.col&&e.colCount===i.colCount){for(r=0;r<n;r++)(o=t[r]).row<e.row&&(e=o),o.row>i.row&&(i=o);return(0,et.Ec)(e.row,e.col,i.row+i.rowCount-e.row,e.colCount)}}}return X},wT:function(t){var n,e,i,r,o,a,r,u,s,c,s,f,l,h,n=[],e=[];if(t&&1<(i=t.length)&&(r=t[0],o=t[i-1],a=r.row===o.row&&r.rowCount===o.rowCount,r=r.col===o.col&&r.colCount===o.colCount,a||r))for(t.sort(a?function(t,n){return t.col-n.col}:function(t,n){return t.row-n.row}),u=1;u<i;u++)for(s=t[u-1],c=t[u],s=a?s.col+s.colCount:s.row+s.rowCount,f=a?c.col:c.row,l=a?e:n,h=s;h<f;h++)l.push(h);return{rows:n,cols:e}},eA:function(t){var n,e,i,r,o,a,u,s,c,n=this;if(!n.isEditing()){if((e=n.getSelections())&&1===e.length){if((i=n.ST()).TT=!0,r=e[0],n.iA&&n.iA()){for(o=[],u=(a=-1)===r.row?1:0,s=0;s<r.rowCount;s++)c=r.row+u+s,n.XT(c)?-1!==a&&(o.push((0,et.Ec)(a,r.col,c-a,r.colCount)),a=-1):-1===a&&(a=c);-1!==a&&o.push((0,et.Ec)(a,r.col,r.row+u+r.rowCount-a,r.colCount)),e=o}return n.CT(e,!1,t)}if(V(e))return n.CT(e,!1,t);n.jT(1,rt().Exp_MultipleSelections)}return X},rA:function(s,c){var f,l,h,d,v,m,g,p,b,w,f=this,l=f.rt;f.isEditing()||(s&&(h=s.pasteText,d=s.pasteHtml,v=void 0===s.pasteOption?f.options.clipBoardOptions:s.pasteOption,m=s.shiftCells,b=s.isHeaderPaste,p=s.isFromDesigner,g=f.getSelections()[0],!y)&&s.pasteSpecialOptions&&(s.pasteSpecialOptions.operationOptions=0,s.pasteSpecialOptions.pasteLink=!1),l&&!h&&c&&l.IT(""),(w=f.ST())&&(w.oA=!1),setTimeout(function(){var t,n,e,i,i,r,o,a,u;if(!f.xT){if(t=h||"",n=d||"",l&&!h){if(w&&(i=w.QS(),r=w.DS,t=i.text,n=i.html,i=i.image,e=w._S,r)&&e)for(o=0,a=e;o<a.length;o++)u=a[o],et.mt.J0(u,r.getRowCount(),r.getColumnCount());c&&l.NT()}(M.msie||M.edge||h||!t&&!n&&!w.oA)&&f.US(t,n,i,v,m,g,e,p,b,null==s?void 0:s.pasteSpecialOptions),f.rt.aA(),f.ki(et.Events.PasteEnd)}},100))},US:function(t,n,e,i,r,o,a,u,s,c){var f,l,l,f=this,l=f.ST();if(l&&(l.oA=!0),!(l=f.uA(t,i,r,n,u,s,c,e))){if(!e)return;l={pasteOption:void 0===i?f.options.clipBoardOptions:i,pastedRanges:[(0,et.Ec)(f.getActiveRowIndex(),f.getActiveColumnIndex(),1,1)],clipboardText:""}}r!==it&&(l.sA=r),ot(s)||(l.kse=s),o&&(l.cA=o),a&&(l.fA=a),l.cmd="clipboardPaste",l.sheetName=f.name(),l.pasteSpecialOptions=T(c,l.pasteOption),C(f)&&(l.clipboardHtml=n,l.clipboardImage=e),f.Qy().execute(l)},uA:function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,e,e,A,s=this,c=rt().Exp_InvalidPastedArea,f=s.ST(),l=f.DS,h=f._S,d=f.ES;if(f._S&&null!=a&&a.transpose){for(h=[],v=0;v<f._S.length;v++)g=(m=f._S[v]).row<0?0:m.row,p=m.col<0?0:m.col,b=m.row<0?l.getRowCount():m.rowCount,w=m.col<0?l.getColumnCount():m.colCount,h.push(new et.Range(g,p,b,w));for(v=0;v<h.length;v++)h[v]=new et.Range(h[v].row,h[v].col,h[v].colCount,h[v].rowCount)}if(d&&l&&h&&l.isActualProtected()&&l.ET(h)&&(d=!1),y={pastedRange:X,pastedInternal:!1},M=[],1<(C=s.getSelections()).length)for(T=2===n,v=0;v<C.length;v++){if(S=C[v],!s.kT(l,h,S,n,d,t,y,it,i,r,o,a,u))return;if(S.containsRange(y.pastedRange)&&!S.equals(y.pastedRange)&&!T)return void s.jT(1,c);M.push(y.pastedRange)}else{if(S=0<C.length?C[0]:s.Ut.getSpan(s.ui,s.ci),!s.kT(l,h,S,n,d,t,y,e,i,r,o,a,u))return;M.push(y.pastedRange)}if((e=s.lA)&&e._T(y.pastedInternal),y.pastedInternal||(h=l=X,d=!1),e=void 0===n?s.options.clipBoardOptions:n,d&&(e=s.hA),h&&1===h.length)for(A=0;A<M.length;A++)s.UT(h[0],m=M[A])&&(m.rowCount=1,m.colCount=1);if(!((!h||1<h.length)&&1<M.length))return{fromSheet:l,fromRanges:h,isCutting:d,pasteOption:e,pastedRanges:M,clipboardText:t};s.jT(1,rt().Exp_MultipleSelections)},HT:function(t,n,e,i,r){var o,a,u,o=this,a=o.getRowCount(),u=o.getColumnCount();return ht(o)?-1<=t&&(r||t<a)&&-1<=n&&(r||n<u):o.zT(t,n,e,i,a,u)}})},"./dist/core/worksheet/worksheet-edit.js":function(t,n,e){"use strict";var n,x,N,i,k,i,_,e,D,j,O,E,r,R,F,S,o,m,e,a,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n=e("./dist/core/core.ns.js"),x=e("./dist/core/worksheet/worksheet.js"),N=e("./dist/core/util/common.js"),i=e("./dist/core/util/domUtil.js"),k=i.GC$,i=e("Common"),_=e("./dist/core/core.enum.js"),e=e("CalcEngine"),D=!!e,j=N.mt.Tt,O=N.mt.pi(),E=i.Common.lt.ht,r=i.Common.zf,R=i.Common.CultureManager,F=null,S=void 0,o="string",m=N.mt.wt,a=(e=new i.Common.ResourceManager(n.SR,"Sheets")).getResource.bind(e),u="=",k.extend(x.Worksheet.prototype,s={startEdit:function(t,n){var e=this;e.f6(e.Dg(),e.ui,e.ci,F,F,t,n)},editorStatus:function(){return this.Di||0},isEditing:function(){var t=this.Di;return 1===t||2===t},endEdit:function(t,n){return this.ol(t,void 0,void 0,void 0,n)},ol:function(t,n,e,i,r){var o,a,u,s,c,o=this;if(!o.isEditing())return!0;o.suspendPaint();try{return a=o.ui,u=o.ci,s=_.SheetArea.viewport,(c=o.vA)&&(a=c.row,u=c.col,s=c.sheetArea,o.vA=S),o.l6(a,u,s,t,n,e,i,r)}finally{o.resumePaint()}},l6:function(t,n,e,i,r,o,a,u){var s,c,f,l,t,n,h,d,v,m,g,g,g,p,b,g,w,p,y,b,g,M,C,r,p,b;if(void 0===e&&(e=_.SheetArea.viewport),c=(s=this).rt,f=s.li,l=s.name(),(v=s.getCellType(t=t,n=n,e)).isImeAware(m={sheet:s,row:t,col:n,sheetArea:e})||c.aA(),f&&f.parentNode){if(d=v.getEditorValue(f,m),s.ki(N.Events.EditEnd,g={sheet:s,sheetName:l,row:t,col:n,editor:f,editingText:d,cancel:!1,committed:!i}),g.cancel&&!a)return;if(s.ki(N.Events.EditEnding,g),g.cancel&&!a)return;if(g=(g=s.parent)&&g.h6,document.activeElement===(g&&g.Ti)&&c.aA(),0<=t&&0<=n&&(p=f.d6,b=s.getFormulaInformation&&s.getFormulaInformation(t,n,3),v.isEditingValueChanged(p,d,m)||1===r||b&&b.isArrayFormula&&1!==r))if(i)v.setEditorValue(f,p,m),v.selectAll(f,m);else if(g=v.v6,E(g)&&(g=!0),p={cmd:"editCell",sheetName:l,row:t,col:n,sheetArea:e,newValue:d=(w=s.getActualStyle(t,n)).mask&&b&&!b.hasFormula&&d&&-1<N.FormulaPrefix.indexOf(d[0])?"'"+d:d,autoFormat:g,editingFormatter:f.Ii},1===r&&(p.ranges=[s.U5()],p.endEditType=r),null!==d&&(y=s.tables&&s.tables.find&&(s.tables.find(t-1,n)||s.tables.find(t,n-1)))&&s.tables.yx(F,new N.Range(t,n,1,1),null,d,!0),s.Qy().execute(p),2===(h=p.applyResult)&&(v.focus(f,m),!a))return!1;if(s.k1=!0,b=e===_.SheetArea.colHeader?-1:S,g=e===_.SheetArea.rowHeader?-1:S,v.Sn(f,m,s.getCellRect(t,n,b,g)),v.isImeAware(m))j.msie&&9===parseFloat(j.version)?c.aA():k(f.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(M=s.qc(),C=f;C;)C.parentNode===M?M.removeChild(C):C=C.parentNode}return s.u0=!1,p=k.extend({},r={sheet:s,sheetName:l,row:t,col:n,editingText:d,ignoreValueChange:i,sheetArea:e,committed:!i}),!1!==u&&s.ki(N.Events.EditEnded,r),s.ki(N.Events.FormulaTextboxEditEnded,p),!(!0!==o&&p.ignore&&!a)&&(0!==s.Di&&(b=s.Di,s.Di=0,s._i(b,0)),s.Ut.setCellState(t,n,_.CellStatesType.edit,!1,e),x.Worksheet.et(s,"endEdit"),s.li=F,1!==h)},m6:function(t,n,e){var i,r,o,a,u,t,u,r,s,n,i=this,r=i.hitTest(n,e);!r||r.cellTypeHitInfo&&(r.cellTypeHitInfo.outlineColumnHitInfo||r.cellTypeHitInfo.cellButtonHitInfo)||(o=r.row,a=r.col,0<=o&&0<=a&&0<=r.rowViewportIndex&&0<=r.colViewportIndex&&!r.resizeInfo&&!r.dragInfo&&o===i.ui&&a===i.ci&&(u=i.isEditing(),i.f6(t,o,a),!u)&&i.isEditing()&&(t=r.hitTestType,(u=i.getCellType(o,a)).j3)&&(r=i.getCellRect(o,a,1===t?-1:S,2===t?-1:S),s=i.getActualStyle(o,a,t),n=u.Bn(n,e,s,r,{sheet:i,row:o,col:a,sheetArea:t}))&&n.isReservedLocation&&u.j3(i,o,a,3))},inputFormulaAndSelectFormulaRange:function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,c,r=this,o=r.options,a=r.getCellRect(t,n),u=r.getActualStyle(t,n),s=r.getCellType(t,n),c=r.rt;c.Zg(),f={sheet:r,row:t,col:n,sheetArea:3},(h=(l=c.g6)&&l.firstChild?l.firstChild.firstChild:h)&&(r.li=h,d=r.Fi(),s.isImeAware(f)&&c.p6(),s.On(l,u,a,f),r.Ri(s,h,t,n,u,S,S,S,S,3),s.Rn(l,u,a,f),o.allowCellOverflow&&((c=a.clone()).y-=2,c.height+=4,c.x=d.b6,c.width=r.Gy(d),r.repaint(c)),x.Worksheet.et(r,"startEdit",{element:s.getEditingElement(),row:t,col:n,sheetArea:3}),r.Di=2,r.il.text(i),r.il.caret(i.length-1),e&&r.il.y6(3,4),r.il.w6(),N.hi.F1(r))},f6:function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,p,b,w,y,M,C,S,T,M,T,M,T,T,s,T,M,s,T,M,s,i,A,I,r,p;k[k.sd]({jS:this.parent}),n<0||e<0||(f=(c=this).name(),l=c.options,c.isEditing())||(h=c.C6(i,r),E(h)&&(h=3),(d=c.Ut).setCellState(n,e,_.CellStatesType.edit,!0,h),v=c.getActualStyle(n,e,h),c.isActualProtected()&&!1!==v.locked?(d.setCellState(n,e,_.CellStatesType.edit,!1,h),c.jT(13,c.FT())):(m=c.getCellType(n,e,h))&&(x.Worksheet.et(c,"allowStartEdit",p={row:n,col:e,sheetArea:h,isAllow:g=!0}),p.isAllow)&&((p=c.rt).Zg(),y=(w=m.isImeAware(b={sheet:c,row:n,col:e,sheetArea:h})?p.g6:m.jn(b))&&w.firstChild?w.firstChild.firstChild:y)?(M=v,C=!1,T=R.culture(),(M.formatter&&N.util.h0(M.formatter,T)||!M.formatter&&M._autoFormatter&&M._autoFormatter.formatCached&&N.util.h0(M._autoFormatter,T))&&(s&&s.key&&(M=s.key,T=s.code,M&&-1!==N.NUMBER_ARRAY.indexOf(M)&&(C=!0),"+"!==M&&"-"!==M||(m.probabilityAddPercent=!0),"process"===M.toLowerCase())&&(!s.shiftKey&&0<T.length-T.replace(/[0-9]/,"").length&&(C=!0),!s.shiftKey&&(0<T.length-T.replace("Minus","").length||0<T.length-T.replace("Subtract","").length||0<T.length-T.replace("Add","").length)&&(m.probabilityAddPercentSpec=!0),s.shiftKey)&&0<T.length-T.replace("Equal","").length&&(m.probabilityAddPercentSpec=!0),M=w.innerText,j.msie&&(M=M.replace("\r\n","")),T=R.Fe(R.culture()).NumberFormat.numberDecimalSeparator,T=new RegExp("^[-]?[0-9]+(\\"+T+"[0-9]+)?$"),!s)&&M&&T.test(M)&&(S=!0),c.li=y,c.ki(N.Events.EditStarting,s={sheet:c,sheetName:f,row:n,col:e,cancel:!1}),s.cancel?(O.ipad&&p.aA(),d.setCellState(n,e,_.CellStatesType.edit,!1,h)):(c.vA={row:n,col:e,sheetArea:h},3===h&&c.showCell(n,e,3,3),c.S6=!0,T=c.getValue(n,e,h),M=D&&c.getFormula(n,e,h),s=c.Di,c.Ai||E(T)&&E(M)?c.Di=1:c.Di=2,c._i(s,c.Di),c.isPaintSuspended()&&c.n3(),T=c.Fi(),!(M=c.getCellRect(n,e,i,r))||E(M.width)||E(M.height)||E(M.x)||E(M.y)||M.width<=0||M.height<=0||(m.isImeAware(b)&&p.p6(),m.On(w,v,M,b),c.Ri(m,y,n,e,v,a,u,C,S,h),s=c.qc(),m.isImeAware(b)||s.insertBefore(w,F),delete c.S6,m.Rn(w,v,M,b),m.isImeAware(b)&&o||m.focus(y,b),l.allowCellOverflow&&((i=M.clone()).y-=2,i.height+=4,c._1&&c._1.isEnable(_.RowColumnStates.edit,!1)&&(i.y=T.T6,i.height=T.A6),i.x=T.b6,i.width=c.Gy(T),c.repaint(i)),x.Worksheet.et(c,"startEdit",{element:m.getEditingElement(),row:n,col:e,sheetArea:h,preventFormulaTextBox:!!v.mask}),C||!o||v.mask||m.selectAll(y,b),C&&(A=window.getSelection(),(I=document.createRange()).setStart(y,0),A.removeAllRanges(),A.addRange(I)),S&&(A=window.getSelection(),(r=document.createElement("span")).innerText="%",I=document.createRange(),c.parent.options.enableFormulaTextbox&&c.parent.options.allowUserEditFormula&&!v.mask?(y.firstChild.appendChild(r),I.setStart(y.firstChild,1),c.il&&c.il.I6()):(y.appendChild(r),I.setStart(y,1)),A.removeAllRanges(),A.addRange(I)),N.hi.F1(c),c.ki(N.Events.EditStarted,p={sheet:c,sheetName:f,row:n,col:e,sheetArea:h}),c.ki(N.Events.FormulaTextboxEditStarted,p)))):d.setCellState(n,e,_.CellStatesType.edit,!1,h))},Ri:function(t,n,e,i,r,o,a,u,s,c){var f,l,h,a,d,v,d,f=this,l=D&&f.getFormula(e,i,c,!0),a={sheet:f,row:e,col:i,sheetArea:c,isImeInput:a,cellStyle:r};(h=l=l&&"="+l)&&0!==l.length||((l=f.getValue(e,i,c,1))&&l.richText&&(l=m(l)),d=f.parent,v=D&&d&&d.options.allowUserEditFormula,d=D&&d&&d.options.allowInvalidFormula,N.util.c0(l,r.quotePrefix,v,d)?h=l="'"+l:(h=l,l=t.je(n,r,l,a))),n.d6=l,E(o)||(l=o),s&&(l=l&&this.x6(l,r)),r.mask&&r.mask.pattern&&"'"!==r.mask.pattern[0]&&l&&"'"===l[0]&&-1<N.FormulaPrefix.indexOf(l[1])&&(l=l.substring(1,l.length)),t.setEditorValue(n,l,a,u,s),f.parent&&f.parent.options.enableAccessibility&&(f.parent.Q1e(),f.K1e(n,l,e,i,c)),n.Li=h},K1e:function(t,n,e,i,r){var o,a,u,a,n,e,o=this,a=n&&"="===n[0],u=o.getText(e,i,r),a=a?n:o.getFormula(e,i,r),n=3===r&&o.comments&&o.comments.get(e,i),e=o.N6(e,i,r,u,a,n&&n.text());t.setAttribute("aria-label",e),o.setAccessibilityPrefixSuffixContent&&o.setAccessibilityPrefixSuffixContent()},k6:function(t){var n="",t=t&&(t.formatter||t._autoFormatter);return n=t?typeof t==o?t:t.formatCached:n},x6:function(t,n){var e,i,e,n,r,o,n,r,n,r,n,n,a,u,e=R.Fe(R.culture()).NumberFormat,i=e.negativeSign,e=e.numberDecimalSeparator,n=this.k6(n),r="%"===n[0],n=n.split(";");if(r?o=n[0].split("%")[1].split(".")[1]:-1<n[0].indexOf("%")&&(o="00"),void 0===o&&(o=""),1<t.split("e").length)return r=t.split("e")[0],n=t.split("e")[1],r+"e+"+(parseInt(n.split("+")[1],10)+2);if(1<t.split(e).length){for(r=!1,t.charAt(0)===i&&(t=t.substr(1,t.length-1),r=!0),n=(t+=o).indexOf(e),a=(n=(t=(t=t.split(e).join("")).substr(0,n+2)+e+t.substr(n+2,t.length-1)).split(e))[0],u=n[1];a&&"0"===a.charAt(0);)a=a.substr(1,a.length-1);for(;u&&"0"===u.charAt(u.length-1);)u=u.substr(0,u.length-1);return(a=r?a&&i+a:a)&&u?a+e+u:!a&&u?(r?i+"0"+e:"0"+e)+u:a&&!u?a:"0"}return"0"===t?t:t+o}})},"./dist/core/worksheet/worksheet-event.js":function(r,o,t){"use strict";var a,p,y,s,h,b,d,t,v,H,c,m,g,V,z,Y,f,Z,w,W,n,Q,J,K,X,q,$,tt,nt,M,C,S,et,T,u,A,I,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,x,N,k,yt,Mt,Ct,n,St,Tt,At,It;function xt(t,n){var e,n,e=[n,n];return e=t<3*n?2===t?[1,0]:1===t?[0,0]:[n=u(t/3),n]:e}function Nt(t,n){var e=3;return E(n)<0&&(e=1),!(3===(e=R(n)<0?2:e)||!t.ni(n.row,n.col,e,!0))}function kt(t,n,e){var i,r,o,a,u,s,u,s,c,s,c,i=!1,r=t.Fi();return n&&(o=E(n),u=(a=R(n))<0&&n.col>=t.getFreeAreaColumnCount(d.SheetArea.rowHeader),s=o<0&&n.row>=t.getFreeAreaRowCount(d.SheetArea.colHeader),u||s)&&(u=t.getCellRect(n.row,n.col,o,a,!0))&&0<u.width&&0<u.height&&(s=r.x,c=r.y,u.x<r.XC+s||u.y<r.qC+c||u.y>=r.height-r.D6)&&(s=new b.Rect(u.x-2,u.y-2,u.width+4,u.height+4),c=void 0,c=o<0&&a<0?r.R1():o<0?r.L1(a):r.B1(o),s=s.getIntersectRect(c),e._6(s.x,s.y,s.width,s.height),i=Nt(t,n)),i}function _(t){return t.isEditing()}function D(t){return t.endEdit()}function _t(t){return t.frozenRowCount()}function Dt(t){return t.frozenColumnCount()}function j(t,n){return t.getRowCount(n)}function O(t,n){return t.getColumnCount(n)}function E(t){return t.rowViewportIndex}function R(t){return t.colViewportIndex}function F(t){return t.hitTestType}function jt(t){return t.getActiveRowIndex()}function Ot(t){return t.getActiveColumnIndex()}function l(t){return t.keyCode}function L(t){return t.ctrlKey}function B(t){return t.shiftKey}function Et(t){return t.altKey}function Rt(t){return t.metaKey}function P(t){return t.colCount}function Ft(t){return t.rowCount}function G(t,n,e){return{action:t,index:n,sheetArea:e}}function Lt(t,n,e){return M===n.O5(t,e,!0)}function Bt(t,n,e){return M===n.j5(t,e,!0)}function Pt(t,n){return n?t.E6?t.startY-t.movingY:t.movingY-t.startY:t.j6?t.startX-t.movingX:t.movingX-t.startX}function U(t,n,e,i,r,o,a){var n,r,n={sheet:t,sheetName:n,sheetArea:r,row:e,col:i},r=t.getCellType(e,i);return r&&(n=r.lfe(n,a)),o&&(n.cancel=!1),n}function Gt(t,n,e,i,r,o){var a,u,a=t.Mf,u=U(a,a.name(),a.ui,a.ci,C,!0);if(a.ki(b.Events.LeaveCell,u),u&&!0===u.cancel)return!0;a.O6(n,e,i,r,o),a.ki(b.Events.EnterCell,U(a,a.name(),n,e)),a.ki(b.Events.EnterCellInternal,U(a,a.name(),n,e,C,C,b.Events.EnterCellInternal)),t.PA&&t.PA(n,e)}function Ut(t,n,e,i,r,o,a){var u,n,s,u=t.Mf,n=n.call(u,o.sheetArea);return(a&&!u.getRowVisible(o.index,o.sheetArea)||!a&&!u.getColumnVisible(o.index,o.sheetArea))&&(o.index=e.call(t,o.index,o.sheetArea)),s=(s=i.call(n,o.index))||i.call(n,r)}function Ht(t,n,e,i,r){var o,a,u,n,e,o=i?"movingY":"movingX",a=i?"startY":"startX";t[o]=n,(u=t.j6||t.E6?t[o]>t[a]:t[o]<t[a])&&(t[o]=t[a]),n=i?e.y+e.height:e.x+e.width,e=i?t.R6:t.B6,t[o]>n&&!e&&(t[o]=n),r!==M&&t[o]>t[a]+r&&(t[o]=t[a]+r)}function Vt(t,n){var e=t.Fi();return 0<_t(t)&&n<e.T6+e.L6?0:0<t.frozenTrailingRowCount()&&n>e.Ay?2:1}function zt(t,n){var e=t.Fi();return 0<Dt(t)&&n<e.b6+e.F6?0:0<t.frozenTrailingColumnCount()&&n>e.Hy?2:1}function Yt(t,n,e){var t=t._y(n);return t?t.findNearY(e):M}function Zt(t,n){var t=t._y(-1,d.SheetArea.colHeader);return t?t.findNearY(n):M}function Wt(t,n,e){var t=t.Yy(n);return t?t.findNearX(e):M}function Qt(t,n){var t=t.Yy(-1,d.SheetArea.rowHeader);return t?t.findNearX(n):M}function Jt(t){return!t.isActualProtected()||t.options.protectionOptions.allowResizeRows}function Kt(t){return!t.isActualProtected()||t.options.protectionOptions.allowResizeColumns}function Xt(t,n){var e,i,r,n,o,t,e=n.row,i=n.rowCount,r=n.col,n=n.colCount,o=t.getColumnCount(),t=t.getRowCount();return{row:e,col:r,rowCount:i=t<i+e?t-e:i,colCount:n=o<n+r?o-r:n}}function qt(t,n){var e,i,e=t.getViewportBottomRow(t.C0(n));if(n<(e=-1===e?t.P6():e))for(i=e;n<i;i--)if(0!==t.getRowHeight(i))return;return 1}function $t(r){var t,o,a,t=r.Ut.getSelections();if(0<t.length)return o=0,a=r.getRowCount(),t.every(function(t){var t,n,e,i,t=Xt(r,t),n=!1;return 1===t.rowCount&&(n=(o+=1)<=1),e=t.row<a,(i=-1!==t.col)||n&&e})}function tn(t,n,e){var i,r,i,r=t.parent.options.rowResizeMode;return e&&0===r&&(r=1),n.action!==x&&1===r&&!qt(t,n.index)&&!(!t.getRowResizable(n.index,n.sheetArea)||!t.getRowResizable(n.index+1,n.sheetArea))&&$t(t)}function nn(t,n,e,i){return tn(t,n,i)&&1===e.length&&e[0].firstRow===e[0].lastRow}function en(t,n){var e,i,e=t.getViewportRightColumn(t.S0(n));if(n<(e=-1===e?t.G6():e))for(i=e;n<i;i--)if(0!==t.getColumnWidth(i))return;return 1}function rn(r){var t,o,a,t=r.Ut.getSelections();if(0<t.length)return o=0,a=r.getColumnCount(),t.every(function(t){var t,n,e,i,t=Xt(r,t),n=!1;return 1===t.colCount&&(n=(o+=1)<=1),e=t.col<a,(i=-1!==t.row)||n&&e})}function on(t,n,e){var i,r,i,r=t.parent.options.columnResizeMode;return e&&0===r&&(r=1),n.action!==yt&&1===r&&!en(t,n.index)&&!(!t.getColumnResizable(n.index,n.sheetArea)||!t.getColumnResizable(n.index+1,n.sheetArea))&&rn(t)}function an(t,n,e,i){return on(t,n,i)&&1===e.length&&e[0].firstColumn===e[0].lastColumn}function un(t,n,e,i,r){var o,a,r,u,o=n.index,a=t.Fi();tn(t,n,r)?(r=t.j5(o,e),Ht(n,i,a,!0,u=t.Gt(o,e)+t.Gt(r,e))):Ht(n,i,a,!0)}function sn(t,n,e,i,r){var o,a,r,u,o=n.index,a=t.Fi();on(t,n,r)?(r=t.O5(o,e),Ht(n,i,a,!1,u=t.nn(o,e)+t.nn(r,e))):Ht(n,i,a,!1)}function cn(t,n,e){var i,r,o,a,u,s,c,f,i=e?t.frozenRowCount():t.frozenColumnCount(),r=e?t.Tb:t.Ab,o=!1,u=r-1;if(0<i&&i<r)for(s=r-1;i<=s;){if(a=e?t.getRowVisible(s):t.getColumnVisible(s)){if(c=e?t.getRowHeight(s):t.getColumnWidth(s),s===u&&0===c)break;if(0<c){o=!0;break}}else u--;s--}for(f=o?i:n,f--;0<=f;){if(a=e?t.getRowVisible(f):t.getColumnVisible(f))return f;f--}return-1}function fn(t){var t=t.il;return t&&t.U6}function ln(t){for(;t!==H.body;){var n;if(getComputedStyle(t).transform.match(/matrix\([^\)]+\)/))return 1;if(!t.parentNode)break;t=t.parentNode}}function e(t){var n=this;n.Ti=t,n.H6=M,n.z6=M,n.V6=M,n.Y6=M,n.Z6=!1,n.W6=!1}function i(t){this.Q6=0;var n=this;n.K6=0,n.J6=!1,n.X6=!1,n.q6={},n.Mf=t,n.tk="gcEvent"+t._id}Object.defineProperty(o,"__esModule",{value:!0}),o.nk=void 0,a=t("./dist/core/core.ns.js"),p=t("./dist/core/worksheet/worksheet.js"),y=t("Common"),s=t("./dist/core/worksheet/worksheet-model.js"),h=t("./dist/core/util/domUtil.js"),b=t("./dist/core/util/common.js"),d=t("./dist/core/core.enum.js"),t=t("./dist/core/workbook/sheettabbase.js"),v=window,H=document,c=h.GC$.each,m=b.mt.Tt,g=b.mt.pi(),V=b.mt.vi,z=b.mt.En,Y=y.Common.zf,f=y.Common.zf.I5,Z=b.Ec,w=y.Common.lt.ht,Q="mousedown"+(n=".handler"),J="mouseup"+n,K="mousemove"+n,X="mousewheel"+n,q="DOMMouseScroll"+n,$="wheel"+n,tt="mouseout"+n,nt="dblclick"+n,M=null,C=void 0,S=isNaN,et=parseInt,T=Math.max,u=Math.floor,A=Math.min,I=Math.abs,it=Math.ceil,rt="function",ot="position",at="absolute",ut="border",st="overflow",ct="top",ft="left",lt="width",ht="height",dt="resize",vt="hidden",mt="visible",gt="none",pt="tabindex",bt="gcUIElement",wt="corner",x="sizeHiddenRow",N="sizeRow",k="sizeCol",yt="sizeHiddenCol",Mt="default",Ct=g.iphone||g.ipad||g.android,n=new y.Common.ResourceManager(a.SR,"Sheets"),St=n.getResource.bind(n),Tt=30,e.prototype.ek=function(t){typeof t==rt&&(this.z6=t)},e.prototype.ik=function(t){var n,e,n=this;S(t)||0===t?n.rk():(n.W6=0<t,t=I(t),(e=n.H6)!==(n.H6=t)&&n.ak())},e.prototype.ak=function(){var t=this;t.d5(),S(t.H6)||(t.V6=v.setInterval(function(){t.uk()},t.H6))},e.prototype.uk=function(){var t=this,n=t.z6;t.Z6=!0,typeof n==rt&&(t.Y6=n.call(t.Ti,t.W6))},e.prototype.rk=function(){var t=this;t.d5(),t.H6=M,t.V6=M,t.Y6=M,t.Z6=!1},e.prototype.d5=function(){var t=this.V6;t&&clearInterval(t)},e.prototype.L0=function(){this.rk()},At=e,i.prototype.L0=function(){var t=this;t.sk&&t.sk.L0(),t.ck&&t.ck.L0(),t.fk=M},i.prototype.lk=function(){var t=this;return t.sk||(t.sk=new At(t)),t.sk},i.prototype.hk=function(){var t=this;return t.ck||(t.ck=new At(t)),t.ck},i.prototype.uw=function(){return this.Mf.uw()},i.prototype.it=function(){var t,t;return t=(t=(0,h.GC$)(this.Mf.Dg()).position())||{top:0,left:0}},i.prototype.gg=function(t){var n,e,n,e,n,i,r,o,a,a,i,r,o,n=b.mt.Qf(),e=L(t),n=n&&!0===e&&0===t.button;return!(2!==t.button&&!n&&(n=(e=this).Mf,e.Fg(),m&&m.msie&&t.offsetX!==C&&t.offsetY!==C&&(r=i=0,o=n.fg,t.target!==o&&(i=(a=b.mt.T0(t.target,o)).I0,r=a.A0),o)&&(a=t.pageX-(t.offsetX+i),i=t.pageY-(t.offsetY+r),o.canvasOffset={top:i,left:a}),r=n.uw(),o=e.dk(t,t.pageX-r.left,t.pageY-r.top),_(n)||o||e.Zg(),n.vk=!0))},i.prototype.Fg=function(){var n=this;n.p4||((0,h.GC$)(H).bind("mousemove.gcSheet."+n.tk,function(t){n.pg(t)}).bind("mouseup.gcSheet."+n.tk,function(t){n.bg(t)}),n.p4=!0)},i.prototype.u2=function(){this.p4&&(this.p4=!1,h.GC$)(H).unbind("mousemove.gcSheet."+this.tk).unbind("mouseup.gcSheet."+this.tk)},i.prototype.dk=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,n,e,n,h,s,c,l,d,v,m,g,i=this,r=i.Mf,o=r.hitTest(n,e),a=o.row,u=o.col,s=o.dragInfo,c=o.formulaRangeHitInfo,f=o.cellTypeHitInfo,l=o.resizeTableHitInfo,h={hitInfo:o,e:t,r:M};if(p.Worksheet.et(r,"processMouseDown",h),n>=(n=r.Fi()).x&&e>=n.y&&(r.sw=o,!h.r))if(i.ab=!0,o.tableSelectInfo&&!r.Nde)i.mk(o,r);else if(o.resizeInfo)(fn(r)||D(r))&&i.gk(o);else if(o.dragMergeInfo)D(r)&&i.pk&&i.pk(o);else if(s&&s.side&&s.side!==wt)D(r)&&(i.bk&&i.bk(o),i.yk(t));else if(s&&s.side===wt)D(r)&&i.wk&&i.wk(o);else if(o.filterButtonHitInfo)D(r);else{if(c)return c.inBorder?(i.Mk(o),!0):c.inTopLeft||c.inTopRight||c.inBottomLeft||c.inBottomRight?(i.Ck(o),!0):void 0;if(l)i.Sk&&i.Sk(o);else if(r.JA(E(o)<0?-1:a,R(o)<0?-1:u)){if(e=r.Nde,o.tableSelectInfo&&e?(n=this.Tk(o,r),o.tableSelectInfo.tableSelection=n,e.Ak(n)):e&&e.Hce(),i.Ik&&i.Ik(r,o))return!0;if(h=jt(r),s=Ot(r),f){if(c=r.getCellType(f.row,f.col,F(o)),f.sheet||(f.sheet=r),i.xk(c,f)&&(l=f.sheetArea,w(l)||3===l)&&(a!==h||u!==s)){r.suspendPaint();try{if(!D(r))return;if(d=U(r,r.name(),h,s,C,!0),r.ki(b.Events.LeaveCell,d),d&&!0===d.cancel)return;v=r.Ut.getSelections(),m=r.Ut.getSpan(a,u),g=[new b.Range(m.row,m.col,m.rowCount,m.colCount)],r.ki(b.Events.FloatingElementSelected,{type:"worksheet"}),r.EA(v,g),r.t4(a,u,C,C,1),r.ki(b.Events.EnterCell,U(r,r.name(),a,u)),r.ki(b.Events.EnterCellInternal,U(r,r.name(),a,u)),r.jA(v),r.Nk=!0,i.PA&&i.PA(a,u)}finally{r.resumePaint()}}c.processCellAndPaddingMouseDown(f)}if(f&&f.isReservedLocation)return!0;i.yk(t),i.kk(r,o,a,u)}}},i.prototype.kk=function(t,n,e,i){var r,e,i,r=this;try{if(r.Dk=n,_(t)&&!D(t))return}finally{r.Dk=M}w(e)||w(i)||(3===F(n)&&r.PA&&r.PA(e,i),t.ki(b.Events.FloatingElementSelected,{type:"worksheet"}),e=t.Ut.getSelections(),r._k(n,e),i=t.Ut.getSelections(),t.EA(e,i))},i.prototype.xk=function(t,n){return t&&n&&n.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},i.prototype.Ek=function(t){var n,e,n=this.Mf;return!n||(e=n.Fi(),w(t.x))||w(t.y)||w(t.width)||w(t.height)||t.x+t.width>e.Py+n.Gy(e)+e.zy||t.y+t.height>e.Cy+n.Sy(e)+e.Iy},i.prototype.jk=function(t,n,e,i,r){for(var o,a,u,s,c,f,r,r,l,o=this.Mf,u=0,s=t.options,c=s.length;u<c;u++)if((f=s[u]).selected){a=i[u].value;break}r={cmd:"editCell",sheetName:o.name(),row:n,col:e,newValue:a,autoFormat:!0,ignoreFormatting:r,ignoreFormula:!0},r=o.Qy().execute(r),!w(a)&&r&&(l=o.tables&&o.tables.find&&(o.tables.find(n-1,e)||o.tables.find(n,e-1)))&&o.tables.yx(M,new b.Range(n,e,1,1),null,a,!0),(0,h.GC$)(t).hide()},i.prototype.Ok=function(){var t,n,t=this;t.Rk&&(3!==(n=t.Rk.Bk)&&2!==n||t.hk().ek(t.Lk),3!==n&&1!==n||t.lk().ek(t.Fk))},i.prototype.Pk=function(){var t=this;t.ob&&t.Gk(),t.Uk&&t.Hk&&t.Hk(),t.zk&&t.Vk&&t.Vk(),t.Yk&&t.Zk&&t.Zk(),t.Wk&&t.Qk(),t.Kk&&t.Jk(),t.Xk&&t.qk(),t.$k&&t.t9&&t.t9()},i.prototype.Lk=function(t){var n,e,i,r,i,o,a,u,s,t,a,i,n=this,e;n.n9()||(i=n.Rk,r=n.Mf,i=i.e9,o=r.getViewportTopRow(i),a=r.getViewportBottomRow(i),s=(u=r.pge())===o?o:r.j5(o),t?(a<j(r)-r.frozenTrailingRowCount()-1||(t=r._y(i))&&0<t.length&&(a=r.Fi(),(i=t[t.length-1]).y+i.height>=a.Cy+r.Sy(a)))&&r.$A(s):o>_t(r)&&r.$A(r.nI(o))),n.Pk()},i.prototype.Fk=function(t){var n,e,i,r,o,a,u,s,c,t,u,o,n=this,e;n.i9()||(i=n.Mf,o=(r=n.Rk).r9,a=i.getViewportLeftColumn(o),u=i.getViewportRightColumn(o),c=(s=i.bge())===a?a:i.O5(a),t?(u<O(i)-i.frozenTrailingColumnCount()-1||(t=i.Yy(o))&&0<t.length&&(u=i.Fi(),(o=t[t.length-1]).x+o.width>=u.Py+i.Gy(u)))&&i.o9(c):a>Dt(i)&&i.o9(i.r6(a))),n.Pk()},i.prototype.n9=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this.Mf,n=t.Fi(),e=_t(t),i=t.frozenTrailingRowCount(),r=this.fk,o=this.Rk,a=o.e9;if(0===a){if(r.y>n.Cy)return t.$A(t.pw()),o.e9=1,!0}else if(1===a){if((u=t._y(1))&&0<u.length){if(s=u[0],0<e&&r.y<n.Cy&&s.row<=t.pw())return!(o.e9=0);if(s=u[u.length-1],0<i&&r.y>n.Ay&&s.row>=t.P6()&&s.y+s.height<=n.Ay)return o.e9=2,!0}}else if(2===a&&(u=t._y(1))&&0<u.length&&r.y<n.Ay){if((s=u[u.length-1]).y+s.height>n.Ay){for(c=t.Sy(n),l=0,h=f=j(t)-i-1;e<=h;h--)if(c<(l+=t.Gt(h))){f=A(h+1,f);break}t.$A(t.j5(f-1))}return o.e9=1,!0}return!1},i.prototype.i9=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this.Mf,n=t.frozenTrailingColumnCount(),e=Dt(t),i=t.Fi(),r=this.fk,o=this.Rk,a=o.r9;if(0===a){if(r.x>i.Py)return t.o9(t.Sw()),o.r9=1,!0}else if(1===a){if((u=t.Yy(1))&&0<u.length){if(s=u[0],0<e&&r.x<i.Py&&s.col<=t.Sw())return!(o.r9=0);if(s=u[u.length-1],0<n&&r.x>i.Hy&&s.col>=t.G6()&&s.x+s.width<=i.Hy)return o.r9=2,!0}}else if(2===a&&(u=t.Yy(1))&&0<u.length&&r.x<i.Hy){if((s=u[u.length-1]).x+s.width>i.Hy){for(c=t.Gy(i),l=0,h=f=O(t)-n-1;e<=h;h--)if(c<(l+=t.nn(h))){f=A(h+1,f);break}t.o9(t.O5(f-1))}return o.r9=1,!0}return!1},i.prototype.a9=function(){var t,n,e,i,r,i,o,a,u,u,r,e,i,n,s,t=this;(t.rb||t.u9||t.s9)&&(e=(n=t.Mf).Fi(),i=t.Rk,w(i)||(r=i.e9,i=i.r9,o=t.fk,a=M,0<=r&&0<=i?(a=e.c9(r,i),0===r&&n.Tb===n.frozenRowCount()&&(u=e.c9(1,i),a.height+=u.height),0===i&&n.Ab===n.frozenColumnCount()&&(u=e.c9(r,1),a.width+=u.width)):0<=r?a=e.B1(r):0<=i&&(a=e.L1(i)),a&&(r=(u=n.parent)&&u.options.scrollbarAppearance===d.ScrollbarAppearance.mobile,i=e=0,s=n=!1,o.x<=a.x?(e=o.x-a.x,r&&(s=!0)):o.x>=a.x+a.width?(0===(e=o.x-(a.x+a.width))&&(e=50),r&&(s=!0)):r&&o.x===a.x+a.width-1&&(e=50,s=!0),o.y<=a.y?(i=o.y-a.y,r&&(n=!0)):o.y>=a.y+a.height&&(i=o.y-(a.y+a.height),r)&&(n=!0),u&&r&&(n&&(u.Xb.qy(d.ScrollbarState.show),u.ib.$y(!0)),s)&&(u.zb.qy(d.ScrollbarState.show),u.ib.$y(!1)),t.lk().ik(t.f9(e)),t.hk().ik(t.f9(i)))))},i.prototype.l9=function(){this.lk().rk(),this.hk().rk()},i.prototype.gk=function(t){var n,e,i,r,o,o,e,o,i,t,n=this,e=s.h9.prototype,i=n.Mf,r=t.resizeInfo;r.action===N||r.action===x?(o=Ut(n,i.d9,n.v9,e.findRow,t.row,r,!0),r.startY=o.y+(r.E6?o.height:0)):(o=Ut(n,i.m9,n.g9,e.findCol,t.col,r,!1),r.startX=o.x+(r.j6?o.width:0)),e=i.parent,o=t.x,i=t.y,!e||(1!==(t=e.options.showResizeTip)||r.action!==k&&r.action!==yt)&&(2!==t||r.action!==N&&r.action!==x)&&3!==t||(i-30<0?i+=15:i-=30,e.Tw(Y.j0(n.p9()),o,i)),n.isResizing=!0,n.rb=!0,n.ctrl&&(n.b9=!0)},i.prototype.y9=function(){var t,n,e,i,r,o,r,a,u,s,e,r,s,t=this,n=t.Mf,e=n.sw,i=e.resizeInfo,r=t.fk,o=r.x,r=r.y,a=n.Fi(),u=n.parent,s=i.sheetArea;i&&t.rb&&t.isResizing&&(e.x===o&&e.y===r||(i.action===N||i.action===x?un(n,i,s,r,t.b9):sn(n,i,s,o,t.b9),r=(e=n.Dn).J(),e.FA(a.x,a.y,a.width,a.height),e.jy(r),!u)||(1!==(s=u.options.showResizeTip)||i.action!==k&&i.action!==yt)&&(2!==s||i.action!==N&&i.action!==x)&&3!==s||u.ny(t.w9(i)))},i.prototype.C9=function(){var t,n,e,i,r,o,a,i,u,s,i,u,i,t=this;t.isResizing=!1,n=!(t.rb=!1),i=(e=t.Mf).sw,(r=i.resizeInfo)&&(t.iy(),r.action===N||r.action===x?w(r.movingY)?n=!1:(o=T(0,Pt(r,!0)/e.zoom()),a=[],i="resizeRow",e.S9(r.index)?h.GC$.each(e.Ut.getSelections(),function(t,n){var n;-1===n.col&&(1===r.sheetArea?a.push({firstRow:r.index,lastRow:r.index}):(n=e.JS(n),a.push({firstRow:n.row,lastRow:n.row+Ft(n)-1})))}):a.push({firstRow:r.index,lastRow:r.index}),nn(e,r,a,t.b9)&&(i="splitResizeRow"),u=1===r.sheetArea,e.Qy().execute({cmd:i,sheetName:e.name(),rows:a,size:o,columnHeader:u})):w(r.movingX)?n=!1:(o=T(0,Pt(r)/e.zoom()),s=[],i="resizeColumn",e.T9(r.index)?h.GC$.each(e.Ut.getSelections(),function(t,n){var n;-1===n.row&&(n=e.JS(n),2===r.sheetArea?s.push({firstCol:r.index,lastCol:r.index}):s.push({firstCol:n.col,lastCol:n.col+P(n)-1}))}):s.push({firstCol:r.index,lastCol:r.index}),an(e,r,s,t.b9)&&(i="splitResizeColumn"),u=2===r.sheetArea,e.Qy().execute({cmd:i,sheetName:e.name(),columns:s,size:o,rowHeader:u})),(i=e.hitTest(t.fk.x,t.fk.y))&&t.cw(i),n||e.repaint(),t.b9=!1)},i.prototype.A9=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,d,c,e=0,i=0,r=0,o=0,a=this,u=a.Mf,s=u.H3,c=_t(u),f=Dt(u),h=F(t),d=1===h&&u.NMi&&u.NMi.options.isDesignMode&&t.row<u.Ut.getFreeAreaRowCount(h);if(a.I9=a.x9=u.Ut.getSelections(h),u.isCtrlPressed(h)||a.shift||(d?u.IA(h):u.IA()),0===h)!a.shift&&(l=Gt(a,v=c?u.N9():u.Tb,p=f?u.k9():u.Ab,1,1,n))||(u.isCtrlPressed(h)||u.IA(),a.wse(u)?(u.IA(),u.D9(0,0,1,1,!0)):u.D9(-1,-1,j(u),O(u),!0));else if(1===h)d?(b=u.Ut.getSpan(t.row,t.col,1),u.Ut._9(b.row,b.col,b.rowCount,b.colCount),u.D9(b.row,b.col,b.rowCount,b.colCount,!0,1),a.E9=!0):!a.shift&&(v=c?u.N9():u.Tb,m=a.j9(v,t.col,!1),l=Gt(a,m.row,m.col,1,R(t),n))||(a.shift||u.O9?(e=A(u.ci,t.col),o=I(u.ci-t.col)+1,u.kA(-1,e,j(u),o,!0)):u.D9(-1,u.ci,j(u),1,!0));else if(2===h){if(!a.shift){if(d=f?u.k9():u.Ab,m=a.j9(t.row,d,!0),g=u.ui!==m.row,l=Gt(a,m.row,m.col,E(t),1,n))return;g&&s&&s.RA()}a.shift||u.O9?(i=A(u.ui,t.row),r=I(u.ui-t.row)+1,u.kA(i,-1,r,O(u),!0)):u.D9(u.ui,-1,1,O(u),!0)}else if(3===h)if(S(t.row)||S(t.col))_(u)&&(c=u.getCellRect(u.ui,u.ci,u.R9,u.B9),u.Dn._6(c.x,c.y,c.width,c.height));else{if(!a.shift&&(u.ui!==t.row||u.ci!==t.col)){if(g=u.ui!==t.row,l=Gt(a,t.row,t.col,E(t),R(t),n))return;g&&s&&s.RA()}a.shift?u.L9(t.row,t.col,!0):(b=u.Ut.getSpan(t.row,t.col),u.O9||u.D9(b.row,b.col,Ft(b),P(b),!0))}},i.prototype.wse=function(t){for(var n,e,i,r,o,a,n,e=0,i=t.getSelections();e<i.length;e++)if(r=i[e],o=j(t),a=O(t),-1===r.row&&-1===r.col&&r.colCount===a&&r.rowCount===o)return!0;return!1},i.prototype.F9=function(t){var n;!t||3===F(t)&&(S(t.row)||S(t.col))||((n=this).rb=!0,n.ob=!0,n.Rk={e9:E(t),r9:R(t),Bk:F(t)},n.Ok())},i.prototype.P9=function(t,n){var e,i,r,o,t,n,a,u,i,s,e,i=this.Mf,o=i.getSpan(t,n),t=t,n=n,a=1,u=1,i=i.selectionUnit(),s=!1;return 1===i?(u=n=-1,t=o?o.row:t,a=o?o.rowCount:a):2===i?(a=t=-1,n=o?o.col:n,u=o?o.colCount:u):s=!0,r=o&&s?o:new b.Range(t,n,a,u)},i.prototype._k=function(t,n){var e=this,i=e.Mf,r=t.row,o=t.col;i.O9=e.G9(r,o,n,F(t))&&i.parent.options.allowUserDeselect,i.O9&&(i.U9=i.ui,i.H9=i.ci,i.z9=e.P9(r,o)),e.A9(t),e.F9(t)},i.prototype.G9=function(t,n,e,i){var r,o,a,r=this,o=r.Mf,a;return r.V9(t,n,e,i)&&2===o.selectionPolicy()},i.prototype.V9=function(t,n,e,i){var r,o,a,u,s,c,r=this.Mf,o=r.getRowCount(),a=r.getColumnCount();if(!r.isCtrlPressed(i))return!1;for(u=!1,s=e.length,c=0;c<s;c++)if(3===i){if(e[c].contains(t,n,1,1)){u=!0;break}}else if(2===i){if(e[c].contains(t,-1,1,a)||e[c].contains(t,0,1,a)){u=!0;break}}else if(1===i&&(e[c].contains(-1,n,o,1)||e[c].contains(0,n,o,1))){u=!0;break}return u},i.prototype.Gk=function(){var t,n,t=this;t.Rk&&t.rb&&!0!==t.FI&&(3===(n=t.Rk.Bk)?t.Y9():2===n?t.Z9():1===n&&t.W9())},i.prototype.Y9=function(){var t,n,e,i,t,r,o,o,t=this,n=t.Mf,e=t.Q9(),i=t.K9();0<=e&&0<=i&&n.JA(e,i)&&(t.a9(),t=n.Ut.getSelections(),r=n.xA(e,i,n.ui,n.ci),1===t.length&&(o=t[0],!n.O9)&&r.equals(o)||(n.L9(e,i,!0),o=n.Ut.getSelections(),n.O9?n.ki(b.Events.InternalSelectionChanging,{sheet:this,sheetName:n.name(),oldSelections:t,newSelections:r}):n.EA(t,o)))},i.prototype.Z9=function(){var t,n,e,i,e,r,o,a,u,s,i,t=this,n=t.Mf,e=t.Q9(!0);if(0<=e&&n.JA(e,-1)){if(i=A(n.ui,e),e=T(n.ui,e)-i+1,r=-1,o=O(n),0===(a=n.selectionPolicy()))return;2===(u=n.selectionUnit())&&(e=i=-1),s=n.Ut.getSelections(),n.kA(i,-1,e,o,!0),i=n.Ut.getSelections(),n.EA(s,i)}t.a9()},i.prototype.W9=function(){var t,n,e,i,r,e,i,e,i,o,r,a,u,s,e,t=this,n=t.Mf,e=t.Rk.Bk,i=t.Q9(!0,e),r=t.K9(!0,e);if(t.E9&&i<n.Ut.getFreeAreaRowCount(e))e=n.Ut.J9(),i=n.xA(i,r,e.row,e.col,C,1),n.D9(i.row,i.col,i.rowCount,i.colCount,!0,1);else if(t.E9=!1,0<=r&&n.JA(-1,r)){if(e=A(n.ci,r),i=T(n.ci,r)-e+1,o=-1,r=j(n),0===(a=n.selectionPolicy()))return;1===(u=n.selectionUnit())&&(i=e=-1),s=n.Ut.getSelections(),n.kA(-1,e,r,i,!0),e=n.Ut.getSelections(),n.EA(s,e)}t.a9()},i.prototype.X9=function(){var t,n,e,e,i,t=this;t.Rk=M,t.l9(),t.FI=M,t.rb=!1,t.ob=!1,t.q9=t.E9,t.E9=!1,0!==(n=t.Mf).Ut.getSelections().length&&(n.O9&&(n.O9=!1,e=n.z9,n.z9=null,n.tD(n.Ut.getSelections(),e),delete n.U9,delete n.H9),n.Nk?delete n.Nk:((e=!t.x9)||(i=n.Ut.getSelections(),e=t._A(t.x9,i)),e&&n.jA(t.I9,t.shift)),t.x9=n.Ut.getSelections())},i.prototype.nD=function(){var t,n,e,i,t=this.Mf,n=Vt(t,this.fk.y),e=this.Rk.e9,i=t._y(1);return n=0===n&&0<e&&0<i.length&&i[0].row>t.pw()||2===n&&e<2&&0<i.length&&i[i.length-1].row<t.P6()?1:n},i.prototype.eD=function(){var t,n,e,i,t=this.Mf,n=zt(t,this.fk.x),e=this.Rk.r9,i=t.Yy(1);return n=0===n&&0<e&&0<i.length&&i[0].col>t.Sw()||2===n&&e<2&&0<i.length&&i[i.length-1].col<t.G6()?1:n},i.prototype.Q9=function(t,n,e){var i,r,o,a,r,n,e,r,a;if(void 0===n&&(n=d.SheetArea.viewport),r=(i=this.Mf).Ut,o=this.fk.y,n===d.SheetArea.colHeader){if(a=Zt(i,o))return r=r.getFreeAreaRowCount(n),e&&0<r&&a.row>=r?r-1:a.row}else if(a=Yt(i,n=this.nD(),o)){if(e=i.Fi(),r=a.row,1===n&&o<e.Cy){if((a=i.pw())<r)return i.j5(r-1)||r;if(r===a&&t)return 0}else if(0===n&&o<e.T6&&t)return 0;return 1===n&&o>e.Ay&&r>i.getLastFullyVisibleRow()?i.nI(r)||r:r}return-1},i.prototype.K9=function(t,n,e){var i,r,o,a,r,n,e,r,a;if(void 0===n&&(n=d.SheetArea.viewport),r=(i=this.Mf).Ut,o=this.fk.x,n===d.SheetArea.rowHeader){if(a=Qt(i,o))return r=r.getFreeAreaColumnCount(n),e&&0<r&&a.col>=r?r-1:a.col}else if(a=Wt(i,n=this.eD(),o)){if(e=i.Fi(),r=a.col,1===n&&o<e.Py){if((a=i.Sw())<r)return i.O5(r-1)||r;if(r===a&&t)return 0}else if(0===n&&o<e.b6&&t)return 0;return 1===n&&o>e.Hy&&r>i.getLastFullyVisibleColumn()?i.r6(r)||r:r}return-1},i.prototype.f9=function(t){var n,e,n=0;return S(t)||0===t||(e=t<0,n=it(500/I(t)),200<(n=T(20,10*n))&&(n=200),e&&(n=-n)),n},i.prototype.v9=function(t,n){var e,n=this.Mf.nI(t,n);return n!==M?n:t},i.prototype.g9=function(t,n){var e,n=this.Mf.r6(t,n);return n!==M?n:t},i.prototype.oD=function(t,n,e){for(var i=this.Mf;n<t;)if(i.getRowVisible(--t,e))return t;return t},i.prototype.aD=function(t,n,e){for(var i=this.Mf;n<t;)if(i.getColumnVisible(--t,e))return t;return t},i.prototype.uD=function(t,n,e){for(var i=this.Mf;t<n;)if(i.getColumnVisible(++t,e))return t;return t},i.prototype.sD=function(t,n,e){for(var i=this.Mf;t<n;)if(i.getRowVisible(++t,e))return t;return t},i.prototype.cD=function(t,n,e,i,r){var o,a,u,s,c,f,u,s,l,h,d,v,d,m,m,g,g,d,m,c,g,p,b,o=M;if(Jt(t)){if(a=this,u=t.options.reversalTrailingResizeOrder,s=t.Ny,c=2===E(n),u=u&&(f=c&&s),s=c&&!s||u,!(l=t._y(E(n),i))||S(n.row)||S(n.col)){if(S(n.row)&&1===E(n))for(p=3,b=0;b<3&&(o=a.fD(t,b,e,i,r))===M;b++);}else t.getRowVisible(n.row,i)||(n.row=this.v9(n.row,i)),(h=l.findRow(n.row))&&(v=(d=xt(h.height,e))[0],d=d[1],m=!(u&&l[l.length-1].row===h.row),h.y+h.height-d<=r&&r<=h.y+h.height+d&&m?(o=G(N,n.row,i),0<=(m=l[l.length-1].row)&&(g=t.P6(i),o.index===g)&&o.index!==m&&h.y+h.height-d/2<=r&&(o=G(a.lD(t,m,i),m,i)),c&&Bt(o.index,t,i)&&(o.R6=!0),u&&(g=a.sD(o.index,l[l.length-1].row,i),(o=G(a.lD(t,g,i),g,i)).E6=u)):h.y-v<=r&&r<h.y+v&&(0<y.Common.Uf.hD(l,h)||s)&&(d=a.oD(n.row,0,i),o=G(a.lD(t,d,i),d,i),u)&&(o=G(N,n.row,i),(o=0<=(m=l[0].row)&&(c=t.j5(m-1,i,!0),o.index===c)&&o.index!==m&&r<h.y+v/2?G(a.lD(t,m,i),m,i):o).E6=u)),!o&&1===E(n)&&0<l.length&&(h=l[0],T(0,h.y-e)<=r)&&r<=h.y+e&&0<=(g=cn(t,n.row,!0))&&(o=G(a.lD(t,g,i),g,i));o&&!t.getRowResizable(o.index,i)&&(o=M)}return o},i.prototype.fD=function(t,n,e,i,r){var o=this,a=M,u=2===n,n=t._y(n,i),n=n[u?0:n.length-1],s,n;return w(n)||0!==n.height||(s=u?n.y:n.y+n.height,n=n.row,T(0,s-e)<=r&&r<=s+e&&(a=G(o.lD(t,n,i),n,i),u)&&(a.E6=!0)),a},i.prototype.lD=function(t,n,e){var i=t.parent;return i&&1===i.options.resizeZeroIndicator&&t.getRowVisible(n)&&0===t._o(n,e)?x:N},i.prototype.dD=function(t,n,e,i,r){var o,a,u,s,c,f,u,s,l,h,d,v,d,m,g,p,g,p,p,m,d,g,c,b,w,o=M;if(Kt(t)){if(a=this,u=t.options.reversalTrailingResizeOrder,s=t.Vy,c=2===R(n),u=u&&(f=c&&s),s=c&&!s||u,!(l=t.Yy(R(n),i))||S(n.col)||S(n.row)){if(S(n.col)&&1===R(n))for(b=3,w=0;w<3&&(o=a.vD(t,w,e,i,r))===M;w++);}else t.getColumnVisible(n.col,i)||(n.col=this.g9(n.col,i)),(h=l.findCol(n.col))&&(v=(d=xt(h.width,e))[0],d=d[1],m=t.getColumnWidth(n.col,i),g=t.zoom(),p=!(u&&l[l.length-1].col===h.col),h.x+(m*=g)-d<=r&&r<=h.x+m+d&&p?(o=G(k,n.col,i),0<=(g=l[l.length-1].col)&&(p=t.G6(i),o.index===p)&&o.index!==g&&h.x+m-d/2<=r&&(o=G(a.mD(t,g,i),g,i)),c&&Lt(o.index,t,i)&&(o.B6=!0),u&&(p=a.uD(o.index,l[l.length-1].col,i),(o=G(a.mD(t,p,i),p,i)).j6=u)):h.x-v<=r&&r<h.x+v&&(0<y.Common.Uf.hD(l,h)||s)&&(m=a.aD(n.col,0,i),o=G(a.mD(t,m,i),m,i),u)&&(o=G(k,n.col,i),(o=0<=(d=l[0].col)&&(g=t.O5(d-1,i,!0),o.index===g)&&o.index!==d&&r<h.x+v/2?G(a.mD(t,d,i),d,i):o).j6=u)),!o&&1===R(n)&&0<l.length&&(h=l[0],T(0,h.x-e)<=r)&&r<=h.x+e&&0<=(c=cn(t,n.col,!1))&&(o=G(a.mD(t,c,i),c,i));(o=o&&t.gD&&t.pD(n,o.index)?M:o)&&!t.getColumnResizable(o.index,i)&&(o=M)}return o},i.prototype.vD=function(t,n,e,i,r){var o=this,a=M,u=2===n,n=t.Yy(n,i),n=n[u?0:n.length-1],s,n;return w(n)||0!==n.width||(s=u?n.x:n.x+n.width,n=n.col,T(0,s-e)<=r&&r<=s+e&&(a=G(o.mD(t,n,i),n,i),u)&&(a.j6=!0)),a},i.prototype.mD=function(t,n,e){var i=t.parent;return i&&1===i.options.resizeZeroIndicator&&t.getColumnVisible(n)&&0===t.Do(n,e)?yt:k},i.prototype.bD=function(t,n,e,i){var r,o,a,u,s,u,c,f,l,a,h,h,h,t,r=this,o=r.Mf,a=o.parent,u=o.options,s=u.colHeaderVisible,u=u.rowHeaderVisible,c=M;return a&&!a.options.allowUserResize||(a=o.Fi(),E(t)<0&&0<=R(t)&&s&&t.row>=o.getFreeAreaRowCount(d.SheetArea.colHeader)?c=(c=r.dD(o,t,i,1,n))||r.cD(o,t,i,1,e):0<=E(t)&&R(t)<0&&u&&t.col>=o.getFreeAreaRowCount(d.SheetArea.rowHeader)?c=(c=r.cD(o,t,i,2,e))||r.dD(o,t,i,2,n):E(t)<0&&R(t)<0?o.P6(2)===M&&I(e-a.qC)<=i?(h=o._y(1))&&0<h.length&&0<=(f=h[h.length-1].row)&&o.getRowResizable(f,2)&&(c=G(r.lD(o,f,2),f,2)):o.G6(1)===M&&I(n-a.XC)<=i&&(h=o.Yy(1))&&0<h.length&&0<=(l=h[h.length-1].col)&&o.getColumnResizable(l,1)&&(c=G(r.mD(o,l,1),l,1)):0<=E(t)&&0<=R(t)&&(f=j(o,1)-1,l=O(o,2)-1,h=o.options.sheetAreaOffset.top,t=o.options.sheetAreaOffset.left,0<=f&&0===a.qC&&h<=e&&e<=i+h&&s?c=G(r.lD(o,f,1),f,1):0<=l&&0===a.XC&&t<=n&&n<=i+t&&u&&(c=G(r.mD(o,l,2),l,2)))),c},i.prototype.yD=function(t,n,e,i){var r,o,a,n,n,n,r,r=this.Mf,o,a=r.Fi().c9(1,1);if(1===n)if((n=r.Yy(n))&&0<n.length){if((n=n[n.length-1]).x+n.width<=e&&e<a.x+a.width)return!0}else if(a.contains(e,i))return!0;if(1===t)if((n=r._y(t))&&0<n.length){if((r=n[n.length-1]).y+r.height<=i&&i<a.y+a.height)return!0}else if(a.contains(e,i))return!0;return!1},i.prototype.pg=function(t){var n=this.uw();this.wD(t,t.pageX-n.left,t.pageY-n.top)},i.prototype.yg=function(){var t,n,e,i,e,e,n,e,t=this.Mf,n=t.sw;n&&(e=n.cellTypeHitInfo)&&(i=t.getCellType(e.row,e.col,F(n))).Ye(e),this.rb||(t.Nk=C,e={x:-1e4,y:-1e4,rowViewportIndex:M,colViewportIndex:M,row:-1,col:-1,resizeInfo:M,hitTestType:M},this.fw(e),n&&(e=n.row,n=n.col,e=t.getActualStyle(e,n),t.MD&&(clearTimeout(t.MD),delete t.MD),t.Mpe&&(clearTimeout(t.Mpe),delete t.Mpe),t.parent)&&e&&e.showEllipsis&&t.parent.iy())},i.prototype.wD=function(t,n,e){var i,t,n,r,e,o,a,u,s,c,f,l,h,d,v,m,g,f,i=this;i.fk={e:t,x:n,y:e},t=i.Mf,i.ab&&!b.hi.A1(t)&&b.hi.F1(t),i.ab&&i.rb?i.isResizing?i.y9():i.Uk?i.Hk&&i.Hk():i.zk?i.Vk&&i.Vk():i.Yk?i.Zk&&i.Zk():i.Wk?i.Qk():i.Kk?i.Jk():i.Xk?i.qk():i.$k?i.t9&&i.t9():i.ob&&i.Gk():(n=t.hitTest(n,e),i.CD(t,n,i),n&&(0===i.Q6&&n.tableSelectInfo&&i.ab&&i.SD(t,i,n),r=t.parent,e=n.row,o=n.col,a=t.C6(n.rowViewportIndex,n.colViewportIndex),c=n.pivotTableInfo,f=!w(c)&&c.options.showToolTip,l=t.isReportTemplateSheet&&t.showToolTip(),r?(s=t.getActualStyle(e,o,a),h=t.getCellRect(e,o,n.rowViewportIndex,n.colViewportIndex),!f||t.isEditing&&t.isEditing()?!l||t.isEditing&&t.isEditing()?(clearTimeout(t.MD),delete t.MD,(u=t.Ci(e,o,a))&&!1!==s.hv&&a?r.Tw(Y.j0(u),h.x+h.width+5,h.y+h.height+5,!1):(m=r.options.showScrollTip&&(r.Xb.a4||r.zb.a4||r.Xw.a4))||r.iy()):(u=t.getCellTipContent(e,o),v="gc-spread-template-sheet-toolTip",clearTimeout(t.Mpe),delete t.Mpe,r.iy(),u&&!1!==s.hv&&(t.Mpe=setTimeout(function(t,n){r.Tw(u,t,n+15,!1,v)}.bind(void 0,n.x,n.y),300))):(u=c.sJt(e,o),d="gc-spread-pivot-toolTip",clearTimeout(t.MD),delete t.MD,r.iy(),u&&!1!==s.hv&&(t.MD=setTimeout(function(t,n){r.Tw(u,t,n+15,!1,d)}.bind(void 0,n.x,n.y),700)))):(clearTimeout(t.MD),delete t.MD),i.cw(n),g=i.fw(n))&&r&&r.options.enableAccessibility&&(f=t.t2(n),r.n2(f)))},i.prototype.CD=function(t,n,e){var i,r,o,a,o;1===e.Q6?(i=e.TD.row,r=e.TD.col,o=n.col,a=t.getSelections()[0],t.kA(i,o<r?o:r,a.rowCount,0<r-o?r-o+1:o-r+1,!0)):2===e.Q6&&(i=e.TD.row,r=e.TD.col,o=n.row,a=t.getSelections()[0],t.kA(o<i?o:i,r,0<i-o?i-o+1:o-i+1,a.colCount,!0))},i.prototype.SD=function(t,n,e){var i,t,i,i=t.getActiveRowIndex(),t=t.getActiveColumnIndex();n.TD={row:i,col:t},"tableColSelect"===(i=e.tableSelectInfo.action)?n.Q6=1:"tableRowSelect"===i&&(n.Q6=2)},i.prototype.cw=function(t){var n,e,i,r,o,a,u,r,u,s,c,f,l,h,d,d,r,u,s,n=this,e=n.Mf,i=e.Dg();i&&(a=!(r=e.sw)||t.row!==r.row||t.col!==r.col||F(t)!==F(r)||t.resizeInfo&&!r.resizeInfo||!t.resizeInfo&&r.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==r.resizeInfo.action||t.dragInfo&&!r.dragInfo||!t.dragInfo&&r.dragInfo||t.dragInfo&&t.dragInfo.action!==r.dragInfo.action||t.resizeTableHitInfo&&!r.resizeTableHitInfo||!t.cellTypeHitInfo&&r.cellTypeHitInfo,r&&a&&(u=r.cellTypeHitInfo)&&(o=e.getCellType(u.row,u.col,F(r))).Ye(u),r=t.resizeInfo,u=t.dragMergeInfo,s=t.dragInfo,c=t.formulaRangeHitInfo,f=t.cellTypeHitInfo,l=e.Dn,h=t.resizeTableHitInfo,(d=t.tableSelectInfo)?"tableRowSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTURRVFpSbFpBQUFBUzBsRVFWUUkxMlhOc1ExQVVBQkYwZU9qVWxFYXdTNFM0Mmh0d0JCS0kyQXVJcUhReUhmcW0vZDQKNVZxbGo5eGlWSkRwSlFnYW5jdVF1RC9kYVE0aXFjTm10YXRWSnYxdlZIejdBRU5GRE9OV3daY3lBQUFBSlhSRldIUmtZWFJsT21OeQpaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalE0T2pVeUt6QXdPakF3VkVsRUpBQUFBQ1YwUlZoMFpHRjBaVHB0YjJScFpua0FNakF5Ck1pMHdNeTB5T1ZRd05qbzBPRG8xTWlzd01Eb3dNQ1VVL0pnQUFBQUFTVVZPUks1Q1lJST0iIC8+Cjwvc3ZnPgo=) 8 4,auto":"tableColSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTlRobnBLRTNBQUFBVGtsRVFWUUkxMlhJTVFwQVVBQUEwUGQ5UlprZHdlNFFWanVUZ3pBN25LTllETCtVb3V5ODhRR1QKMjIyQ0hBUVJBVElmdjRocXZVNkxRMm5QSkkwQmpCb0pDb3ZUYVZZUThkaFVOcXVMRjkwZUQzQ2dxdzV5QUFBQUpYUkZXSFJrWVhSbApPbU55WldGMFpRQXlNREl5TFRBekxUSTVWREEyT2pVek9qVTJLekF3T2pBd21XaEVBQUFBQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBCk1qQXlNaTB3TXkweU9WUXdOam8xTXpvMU5pc3dNRG93TU9nMS9Md0FBQUFBU1VWT1JLNUNZSUk9IiAvPgo8L3N2Zz4K) 8 4,auto":"tableCornerSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxMHB4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxMCAxMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAgMTAiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgeD0iMCIgeT0iMCIKICAgIGhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQW9BQUFBS0NBUUFBQUFuT3djMkFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOCkFBQjZKZ0FBZ0lRQUFQb0FBQUNBNkFBQWRUQUFBT3BnQUFBNm1BQUFGM0NjdWxFOEFBQUFBbUpMUjBRQS80ZVB6TDhBQUFBSGRFbE4KUlFmbUF4MEdOd1BrbVNxUkFBQUFZRWxFUVZRSTExM01zUTJETUJRRTBDZTZVRUxDQnBHeUhOUFEyeVVNeFFRWkFjVXhCV0FCZDkzVAovMGVsTitsYzB2djZDNW96anBJc2lZVnJYc0tGbndab3hKMkR0eWh0RHdjdlpvdDhMTGVDbjd5MzVHTytZeXZlTHg4R3FWQmVBYnlQCk1QNG1OSW4zQUFBQUpYUkZXSFJrWVhSbE9tTnlaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalUxT2pBekt6QXdPakF3anE0VmhBQUEKQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBTWpBeU1pMHdNeTB5T1ZRd05qbzFOVG93TXlzd01Eb3dNUC96clRnQUFBQUFTVVZPUks1QwpZSUk9IiAvPgo8L3N2Zz4K) 10 5,auto":"tableSelect"===d.action?i.style.cursor="move":"default"===d.action&&(i.style.cursor=""):r?r.action===k?i.style.cursor=b.CursorResource.ResizeCol:r.action===N?i.style.cursor=b.CursorResource.ResizeRow:r.action===yt?i.style.cursor=b.CursorResource.ResizeHiddenCol:r.action===x?i.style.cursor=b.CursorResource.ResizeHiddenRow:i.style.cursor=Mt:u?u.left||u.right?i.style.cursor="w-resize":(u.top||u.bottom)&&(i.style.cursor="n-resize"):s&&"drag"===s.action?s.side===wt?i.style.cursor="crosshair":s.side?i.style.cursor="move":i.style.cursor=Mt:c?(c.inBorder?i.style.cursor="move":c.inTopLeft?i.style.cursor="nw-resize":c.inTopRight?i.style.cursor="ne-resize":c.inBottomLeft?i.style.cursor="sw-resize":c.inBottomRight&&(i.style.cursor="se-resize"),d=n.isFormulaRangeHovering,u=(r=n.AD)&&r.paramRange,s=c.paramRange,n.isFormulaRangeHovering=!0,n.AD={paramRange:s},d&&s.index===u.index||l.kde()):h?i.style.cursor="se-resize":(f&&(o=e.getCellType(f.row,f.col,F(t)),f.sheet=e,a&&o.processMouseEnter(f),o.ze(f)),!a&&f&&f.isReservedLocation||(i.style.cursor=Mt),n.isFormulaRangeHovering&&(n.isFormulaRangeHovering=!1,n.AD=M,l.kde())))},i.prototype.bg=function(t){var n,e,n=this,e=n.Mf;return n.u2(),!e.vk||(e.vk=!1,n.xD(t),!1)},i.prototype.xD=function(t){var n,e,i,i,r,o,n=this,e=n.Mf,i=b.hi.ai();n.ab=!1,n.Q6=0,i&&i!==e&&i.endEdit&&(i.il&&i.il.rl||(i.endEdit(),i.repaint())),b.hi.F1(e),n.isResizing?n.C9():n.Uk?n.ND&&n.ND():n.zk?n.kD&&n.kD(t):n.Yk?n.DD&&n.DD():n.Wk?n._D():n.Kk?n.ED():n.Xk?n.jD():n.$k?n.OD&&n.OD():e.sw&&(r=(i=e.sw).cellTypeHitInfo,!i.filterButtonHitInfo)&&!i.resizeInfo&&0<=i.row&&0<=i.col&&(r&&(o=e.getCellType(r.row,r.col,F(i)),r.sheet||(r.sheet=e),o.Ve(r)),r&&r.isReservedLocation||e.ki(b.Events.CellClick,U(e,e.name(),i.row,i.col,F(i))),n.X9(),e.RD)&&e.BD&&e.BD(),n.LD=!1,n.yk(t)},i.prototype.FD=function(t,n,e){var i,r,i=this.Mf;!i.isEditing||i!==b.hi.ai()||(r=i.Dg(),B(t))||L(t)||i.m6(r,n,e)},i.prototype.pf=function(t){var n,e,i,r,o,a,i,r,o,u,i,s,a,n=this,e=n.Mf;if(e){if(i=jt(e),r=Ot(e),o=e.getCellType(i,r),a={isEditing:_(e),sheet:e,row:i,col:r,sheetArea:3},i={sheet:e,row:i,col:r,sheetArea:3},o&&o.isReservedKey(t,a))return void(_(e)||o.processKeyDown(t,i));if(r={e:t,r:M,c:a},p.Worksheet.et(e,"preProcessKeyDown",r),r.r)return}o=!(_(e)||L(t)||Rt(t)||34!==l(t)&&33!==l(t)&&37!==l(t)&&39!==l(t)&&9!==l(t)&&13!==l(t)&&38!==l(t)&&40!==l(t)),e.Oi&&(e.Oi=!1,e.Dn.PD()),a=27===(i=l(t)),e.RD&&e.GD&&((s=13===i)||a)?e.GD(a):u=o?n.UD?n.HD:n.HD=n.zD(t):n.zD(t),o&&u&&b.hi.A1(e)&&(n.VD=new Date,n.UD?(n.YD<25&&n.YD++,V(t)):(n.UD=!0,n.YD=1,n.ZD(t,!0)))},i.prototype.p9=function(){var t,n,e,i,i,t=this.Mf,n,e=t.sw.resizeInfo;return e.action===N||e.action===x?(i=t.getRowHeight(e.index),f(St().Tip_Height,[i])):(i=t.getColumnWidth(e.index),f(St().Tip_Width,[i]))},i.prototype.w9=function(t){var n=this.Mf;return t.action===N||t.action===x?f(St().Tip_Height,[T(0,u((t.movingY-t.startY)/n.zoom()))]):f(St().Tip_Width,[T(0,u((t.movingX-t.startX)/n.zoom()))])},i.prototype.ZD=function(t,n){var e=this;e.UD&&(new Date-e.VD>(1<e.YD?100:600)?e.V5():(n||(e.HD=e.zD(t)),e.UD&&(e.K6=v.setTimeout(function(){e.ZD(t)},n?500:20))))},i.prototype.WD=function(t,n){var e,i,r,o,i,e=this.Mf,i=e.Dg();if(i){e.Ai=!0;try{r=_(e),e.f6&&e.f6(i,e.ui,e.ci,M,M,!0,M,n,t),!r&&_(e)&&(!(o=e.getCellType(e.ui,e.ci)).j3||32!==l(t)||L(t)||B(t)||Et(t)||o.j3(e,e.ui,e.ci,3),o.QD)&&o.QD(t)}finally{e.Ai=!1,(i=e.ST()).TT&&delete i.TT}}},i.prototype.zD=function(t){var n,e,i,i,r,o,a,u,s,i,r,c,i,f,n=this,e=n.Mf;if(n.yk(t),_(e)||27!==l(t)||Et(t)||L(t)||B(t)||!e.KD||((0,h.GC$)(e.KD).remove(),e.KD=M),i=e.ST(),_(e)||27!==l(t)||Et(t)||L(t)||B(t)||!i.TT||delete i.TT,_(e)||34!==l(t)&&33!==l(t)&&35!==l(t)&&36!==l(t)&&38!==l(t)&&40!==l(t)||V(t),_(e)||37!==l(t)&&39!==l(t)||V(t),_(e)&&L(t)&&(89===l(t)||90===l(t)))V(t);else{if(r=(i=e.Qy()).getShortcutKey(l(t),L(t),B(t),Et(t),Rt(t)),o=i.getCommands(r))for(a=0;a<o.length;a++)if(u={sheetName:e.name(),vge:!0},(s=o[a].execute(e.parent,u))||u.JD)return s.ignoreCancelDefault||V(t),!0;if(i={e:t,r:M},p.Worksheet.et(e,"processKeyDown",i),i.r)return!0;n.Pi(t)&&((r=e.il)&&r.XD&&r.qD(),(c=_(e))||(f=(i=v.gcGlobal.el(t.target))&&"gcAttachedFormulaTextBox"===i.getAttribute(bt))||n.WD(t))}return!1},i.prototype.V5=function(){var t=this;t.UD=!1,t.HD=C,(t.YD=0)<t.K6&&(clearTimeout(t.K6),t.K6=0)},i.prototype.bf=function(t){var n,e,i,r,o,a,i,r,a,o,n=this;if(n.V5(),e=n.Mf){if(i=jt(e),r=Ot(e),o=e.getCellType(i,r),a={isEditing:_(e),sheet:e,row:i,col:r,sheetArea:3},i={sheet:e,row:i,col:r,sheetArea:3},o&&o.isReservedKey(t,a))return void(_(e)||o.processKeyUp(t,i));if((r=e.il)&&r.$D(t))return;if((a=e.parent&&e.parent.h6)&&a.$D(t))return;e.parent&&e.parent.options.enableAccessibility&&b.mt.Qf()&&(34!==(o=l(t))&&33!==o&&35!==o&&36!==o&&37!==o&&39!==o&&9!==o&&13!==o&&38!==o&&40!==o||e.parent.n2(C))}n.yk(t)},i.prototype.yf=function(t){var n,e,i,n,e=this.Mf,i={e:t,r:M};p.Worksheet.et(e,"processCompositionStart",i),i.r||this.WD(t,!0)},i.prototype.Pi=function(t){return!(L(t)||Et(t)||Rt(t))&&(65<=l(t)&&l(t)<=90||48<=l(t)&&l(t)<=59||96<=l(t)&&l(t)<=105||186<=l(t)&&l(t)<=192||220<=l(t)&&l(t)<=222||219===l(t)||106<=l(t)&&l(t)<=111||32===l(t)||61===l(t)||173===l(t)||229===l(t)||0===l(t)||8===l(t))},i.prototype.yk=function(t){var n,e,i,r,o,n=this,e=n.Mf,i,r=(b.mt.Qf()?Rt:L)(t);n.ctrl=r&&!B(t),n.shift=B(t)&&!r,n.isPressShiftKey=B(t),!0===n.zk&&(n.t_=r,o=B(t),n.e_&&(o=!B(t)),n.i_=o,e.Dn.o_)&&e.Dn.o_(),n.a_=r},i.prototype.Y5=function(){var t=this;t.shift=!1,t.ctrl=!1,t.zk=!1,t.i_=!1,t.t_=!1,t.a_=!1},i.prototype.By=function(t){var n,e,i,r,o,a,u,t,s,s,c,f,a,u,e,l,c;t&&t.sheet?(n=t.sheet,e=t.editor,i=t.canvasOffset):e=(n=this.Mf).li,_(n)&&(t=d.SheetArea.viewport,(s=n.vA)?(r=s.row,o=s.col,w(s.sheetArea)||(t=s.sheetArea)):(r=n.ui,o=n.ci),t===d.SheetArea.rowHeader?u=-1:t===d.SheetArea.colHeader&&(a=-1),s=n.getCellType(r,o,t),c=n.Fi(),f=n.getActualStyle(r,o,t),a=n.getCellRect(r,o,a,u),e&&e.parentNode&&(u=e.parentNode.parentNode,e=!1,t===d.SheetArea.rowHeader?e=a.x>=c.x&&a.y>=c.y+c.qC&&a.x+a.width<=c.Py&&a.y+a.height<=c.Ay+c.Iy:t===d.SheetArea.colHeader?e=a.x>=c.x+c.XC&&a.y>=c.y&&a.x+a.width<=c.Hy+c.zy&&a.y+a.height<=c.Cy:t===d.SheetArea.viewport&&(e=a.x>=c.b6&&a.y>=c.T6&&a.x+a.width<=c.Hy+c.zy&&a.y+a.height<=c.Ay+c.Iy),a&&0<a.width&&0<a.height&&e?s.Rn(u,f,a,l={sheet:n,row:r,col:o,sheetArea:t,canvasOffset:i}):(0,h.GC$)(u).css({top:-1e4,left:-1e4})),c=n.il)&&c.u_()},i.prototype.s_=function(t,n){var e,i;if(t)for(e=t.firstChild;e;){if(e.id===n||e.name===n)return e;if(i=this.s_(e,n))return i;e=e.nextSibling}return M},i.prototype._A=function(t,n){var e,i,r,o,e=!0;if(t.length===n.length)for(i=0;i<t.length;i++){if(r=t[i],o=n[i],r.row!==o.row||r.col!==o.col||Ft(r)!==Ft(o)||P(r)!==P(o)){e=!0;break}e=!1}return e},i.prototype.f_=function(t,n,e,i){var r,o,a,u,s,c,f,i,i,l,l,t,i,a,r=this,o=r.Mf,a={sheet:o,row:n,col:e,sheetArea:3},u=o.qc(),s=t.isImeAware(a),f=Ct?at:"fixed";return i&&!o.isEditing()&&r.l_(),s&&!r.g6&&(i=(c=t.jn(a)).style,r.h_||(r.h_={overflow:mt,border:gt,position:at}),r.h_.overflow=i.overflow,r.h_.border=i.border,r.h_.position=i.position,(0,h.GC$)(c).css([ot,st,ct,ft,lt,ht,ut],[f,vt,"0px","0px","0px","0px",gt]),o.Ri&&c.firstChild&&(i=c.firstChild.firstChild,o.Ri(t,i,n,e,o.getActualStyle(n,e),C,C,C,C,3),l=t.getEditorValue(i,a),m.safari)&&(""===l||w(l))&&t.setEditorValue(i," ",a),u&&u.insertBefore(c,M),r.g6=c),r.d_||(c=z("div"),(0,h.GC$)(c).css([ot,st,ct,ft,lt,ht],[f,vt,"0px","0px","0px","0px"]),r.d_=c,l=z("textarea"),(0,h.GC$)(l).attr(bt,"gcSheetFocusInput").attr(pt,-1).css([ot,st,ut,dt],[at,vt,gt,gt]),l.value=" ",c.insertBefore(l,M),r.I1=l,t=z("div"),(0,h.GC$)(t).css(ot,at).css(st,vt).attr(bt,"gcSheetFocusInput").attr("aria-hidden","true").attr("title","").attr(pt,-1),c.insertBefore(t,M),r.m_=t,u&&u.insertBefore(c,M)),!s&&o.parent&&o.parent.options.enableAccessibility&&(o.parent.Q1e(),o.K1e(r.I1,"",n,e,3)),i=v.location!==v.parent.location,a=0<v.scrollX||0<v.scrollY,(Ct||(m.mozilla||m.chrome||m.safari)&&i||a)&&(r.g6&&r.g_(o,r.g6),r.g_(o,r.d_)),s?r.g6:r.I1},i.prototype.ATe=function(t,n,e,i){var r,o,r,r,r=this,o=r.Mf,r=r.g6;o.Ri&&r&&r.firstChild&&(r=r.firstChild.firstChild,o.Ri(t,r,n,e,o.getActualStyle(n,e),i,C,C,C,3))},i.prototype.p6=function(){var t=this;t.g6&&t.h_&&(0,h.GC$)(t.g6).css(st,t.h_.overflow).css(ut,t.h_.border).css(ot,t.h_.position)},i.prototype.l_=function(){var t=this;t.g6&&(t.g6.parentElement&&t.g6.parentElement.removeChild(t.g6),t.g6.comboBox&&(t.g6.comboBox=M),t.g6=M)},i.prototype.Zg=function(t){b.hi.A1(this.Mf)||this.p_(!0,!0,t)},i.prototype.al=function(){var t=this.m_;t&&t.focus()},i.prototype.aA=function(){this.p_(!0,!0)},i.prototype.b_=function(){this.y_&&(clearTimeout(this.y_),this.y_=M)},i.prototype.p_=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,t;0===arguments.length&&(t=!0),(i=this).X6||(i.J6=!1,i.b_(),r=i.Mf,o=jt(r),a=Ot(r),u=r.getCellType(o,a),i.f_(u,o,a,n),s={sheet:r,row:o,col:a,sheetArea:3},c=u.isImeAware(s)&&i.g6.firstChild?i.g6.firstChild.firstChild:i.I1,f=c,n&&!m.msie&&u.setImeMode(f,r.getActualStyle(o,a).imeMode,s),H.body.focus(),l=function(){var t=function(){try{u.isImeAware(s)?(u.focus(f,s),r.isEditing()||u.selectAll(f,s)):(c.focus(),r.isEditing()||c.select())}catch(t){}};n&&m.msie&&u.setImeMode(f,r.getActualStyle(o,a).imeMode,s),t()},d=m.metroMode||g.ipad||g.iphone||g.android,!r.Oi&&!d||!t&&u.isImeAware(s)?!1===r._enhanceIme||e||i.w_(r)||l():!_(r)&&d?n&&(t=i.g6&&i.g6.firstChild&&i.g6.firstChild.firstChild,u.setImeMode(t,r.getActualStyle(o,a).imeMode,s)):i.y_=v.setTimeout(function(){i.w_(r)||(i.b_(),_(r))||!1===r._enhanceIme||e||l()},200),b.hi.A1(r)||i.w_(r)||b.hi.F1(r),i.M_(r))||i.PA&&i.PA(r.ui,r.ci)},i.prototype.g_=function(t,n){var t,e,e,i,r,o,e,i,r,o,t,i,a,t,u,s,c,u,i,c,s,e=jt(t),i=Ot(t),r=t.R9,o=t.B9,e=t.getCellRect(e,i,r,o),i=this,r=t.uw(),o=i.it(),t=i.g6,i=0,a=0;t&&(t=(0,h.GC$)(t),i=parseInt(t.css(ht),10),a=parseInt(t.css(lt),10)),t=e.y+o.top-2,e=e.x+o.left-2,u=v.pageYOffset,s=v.pageXOffset,(c="fixed"===n.style.position&&!ln(n))&&(t-=u,e-=s),u=c?0:u-r.top+o.top,i=v.innerHeight+u-i,c=c?0:s-r.left+o.left,s=v.innerWidth+c-a,(S(t)||t<u||i<t)&&(t=u),(S(e)||e<c||s<e)&&(e=c),(0,h.GC$)(n).css(ct,t).css(ft,e)},i.prototype.C_=function(t){var n,e,i,t,e,n=this;n.b_(),_(n.Mf)||n.J6&&H.activeElement===n.m_||(e=n.Mf,t=t?(i=t.row,t.col):(i=e.ui,e.ci),e=e.getCellType(i,t),n.f_(e,i,t,!1),n.m_.focus(),n.J6=!0)},i.prototype.S_=function(t,n){var e=this;e.J6&&(e.J6=!1,n||e.p_(t))},i.prototype.IT=function(t){var n,e,n,e=this.Mf.ST();e&&(e.YS(t),e.ZS(),this.X6=!0,t)&&e.WS()},i.prototype.NT=function(){var t,n,t=this,n=t.Mf.ST();n&&n.YS(""),t.X6=!1,t.p_(!0,!1)},i.prototype.T_=function(){var t,n,t=this;t.b_(),(n=t.g6)&&((0,h.GC$)(n).remove(),t.g6=C),(n=t.d_)&&((0,h.GC$)(n).remove(),t.I1=C,t.d_=M,t.m_=M)},i.prototype.Tw=function(t,n,e,i){var r=this.Mf.parent;r&&r.Tw(Y.j0(t),n,e,i)},i.prototype.ny=function(t,n,e,i){var r=this.Mf.parent;r&&r.ny(t,n,e,i)},i.prototype.iy=function(){var t=this.Mf.parent;t&&t.iy()},i.prototype.fw=function(t){var n,e,i,r,o,a,u,s,u,c,i,r,i,s;function f(t,n){var e=!1;return t||n?t&&n&&(e=t.action===n.action&&t.index===n.index&&t.sheetArea===n.sheetArea):e=!0,e}return i=(e=(n=this).Mf).A_,r=e.I_,a=(a=(a=(o=e.sw)?!1:!0)||t?a:!0)||t.col!==o.col||t.row!==o.row||R(t)!==R(o)||E(t)!==E(o)||F(t)!==F(o)||!f(t.resizeInfo,o.resizeInfo),e.sw=t,a&&(s=(u=e._1)&&u.isEnable(d.RowColumnStates.hover,!0),u=u&&u.isEnable(d.RowColumnStates.hover,!1),c=t.hitTestType,o&&!w(o.hitTestType)&&(e.A_=null,e.I_=null,e.Ut.setCellState(i,r,d.CellStatesType.hover,!1,o.hitTestType),s&&e.x_(i,o.rowViewportIndex,o.colViewportIndex),u&&e.N_(r,o.rowViewportIndex,o.colViewportIndex),s||u||e.k_&&e.k_(d.CellStatesType.hover,i,r,o.hitTestType,o.rowViewportIndex,o.colViewportIndex)),t&&!w(c)&&(i=void 0!==t.row&&void 0!==t.col&&c===d.SheetArea.viewport,e.A_=t.row,e.I_=t.col,t.resizeInfo||(e.Ut.setCellState(t.row,t.col,d.CellStatesType.hover,!0,c),s&&i&&e.x_(t.row,t.rowViewportIndex,t.colViewportIndex),u&&i&&e.N_(t.col,t.rowViewportIndex,t.colViewportIndex),s)||u||e.k_&&e.k_(d.CellStatesType.hover,t.row,t.col,c,t.rowViewportIndex,t.colViewportIndex)),e.D_=!0,i=kt(e,o,r=e.Dn),s=kt(e,t,r),i=i||s,e.D_=!1,(i||e.gD)&&r.E1(),e.NMi)&&e.NMi.options.isDesignMode&&1===c&&r.E1(C,C,C,C,1),a},i.prototype.j9=function(t,n,e){var t=this.__(t,n,e);return this.E_(t)},i.prototype.__=function(t,n,e){var i,r,o,i=this.Mf.Ut.getSpan(t,n),r=Ft(i),o=P(i);return 1===r&&1===o||e&&1===r||!e&&1===o?i:(e?n++:t++,this.__(t,n,e))},i.prototype.E_=function(t){for(var n,e,i,r,o,a,n=this.Mf,e=t.row,r=j(n),i=e;i<r&&!0!==n.getRowVisible(i);i++);for(i<r&&(e=i),o=t.col,a=O(n),i=o;i<a&&!0!==n.getColumnVisible(i);i++);return Z(e,o=i<a?i:o,Ft(t),P(t))},i.prototype.M_=function(t){var n,e,i,r,n=t.floatingObjects&&t.floatingObjects.all(),e=t.shapes&&t.shapes.all();if(!w(n))for(i=0;i<n.length;i++)if(n[i].isSelected())return!0;if(!w(e))for(r=0;r<e.length;r++)if(e[r].isSelected())return!0},i.prototype.w_=function(t){return"function"==typeof t.isShapeTextEditorOpened&&t.isShapeTextEditorOpened()},i.prototype.j_=function(t){var r,n,e,o,a,e,n,i,u,u,i,r=this.Mf,n=t.resizeInfo;return n?(e=r.Ut.getSelections(),n.action===N||n.action===x?(o=[],r.S9(n.index)?c(e,function(t,n){var e,i;if(-1===n.col)for(e=r.JS(n),i=0;i<Ft(e);i++)o.push({row:e.row+i})}):o.push({row:n.index}),r.Qy().execute({cmd:"autoFitRow",sheetName:r.name(),rows:o,columnHeader:1===n.sheetArea})):(a=[],r.T9(n.index)?c(e,function(t,n){var e,i;if(-1===n.row)for(e=r.JS(n),i=0;i<P(e);i++)a.push({col:e.col+i})}):a.push({col:n.index}),r.Qy().execute({cmd:"autoFitColumn",sheetName:r.name(),columns:a,rowHeader:2===n.sheetArea})),!0):(e=t.row,n=t.col,i=t.hitTestType,(u=r.O_(t.rowViewportIndex,t.colViewportIndex,t.hitTestType,t.row,t.col))&&(e=u.row,n=u.col),u=void 0,i=r.getFormula&&r.getFormula(e,n,i,!0),r.f6(r.fg,e,n,t.rowViewportIndex,t.colViewportIndex,!1,u=i?"="+i:u,!1),!1)},It=i,o.nk=It,p.Worksheet.ch("eventHandler",{beforeSetHost:function(){var t=this;t.rt=new It(t)},dispose:function(t){var n,e,i,r,r,i,n=this,e=n.rt;e&&(e.u2(),i=e.tk,(0,h.GC$)(n.Dg()).unbind(Q+"."+i).unbind(J+"."+i).unbind(K+"."+i).unbind(X+"."+i).unbind(tt+"."+i).unbind(nt+"."+i),m.mozilla&&(r="onwheel"in document?$:q,(0,h.GC$)(n.Dg()).unbind(r+"."+i)),e.L0(),e.T_()),(r=n.li)&&(0,h.GC$)(r).remove(),(i=n.R_)&&(i.close(),n.R_=null),!1!==t.clearCache&&(n.B_=M,n.L_=M,n.F_=M,n.P_=M,n.G_=M,n.U_=M,n.rt=M)},setHost:function(t){var f,i,n,e;function r(t,n){var e,i,e,r,o,e=f.uw(),i=n.pageX-e.left,e=n.pageY-e.top,r=f.hitTest(i,e),o=r.dragInfo;r.tableSelectInfo||(o&&t.H_&&"corner"===o.side?t.H_():t.FD(n,i,e))}t&&(i=(f=this).rt,f.B_=function(t){var n={e:t,r:M};if(p.Worksheet.et(f,"preProcessMouseDown",n),!n.r)return i.gg(t)},f.L_=function(t){var n={e:t,r:M};p.Worksheet.et(f,"preProcessMouseMove",n),n.r||i.p4||i.pg(t)},f.F_=function(t){var n={e:t,r:M};return p.Worksheet.et(f,"preProcessMouseUp",n),n.r||f.f2||i.p4?void 0:i.bg(t)},f.wge=function(t,n,e){var i,r,o,a,i=(new Date).valueOf(),a=!f.z_||200<i-f.z_;return w(t)||(a?(r=(0<=(r=t/e)?1:-1)*u(I(r)),f.V_=0):(f.V_+=r=t/e,r=(0<=r?1:-1)*u(I(f.V_)),f.V_-=r)),w(n)||(a?(o=(0<=(o=n/e)?1:-1)*u(I(o)),f.Y_=0):(f.Y_+=o=n/e,o=(0<=o?1:-1)*u(I(f.Y_)),f.Y_-=o)),f.z_=i,{detailY:r,detailX:o}},f.P_=function(t){var n,n,e,i,r,o,a,u,s,a,c,e,n={e:t=t||v.event,r:M};if(p.Worksheet.et(f,"preProcessMouseWheel",n),!n.r)return e=(n=f.parent)&&n.options.scrollByPixel,i=t.detail||t.wheelDelta/-40,r=0,"wheel"===t.type?(o=17,a=t.wheelDeltaY&&Math.abs(t.wheelDeltaY- -3*t.deltaY)<1,u=m.mozilla&&88<=+m.version&&!a?17:1,i=t.deltaY/u,r=t.deltaX/u,e||(I(i)>=I(r)?r=0:i=0),a&&(i=(s=f.wge(i,r,1)).detailY,r=s.detailX)):(a=t.wheelDeltaY,c=t.wheelDeltaX,e||(I(a)>=I(c)?c=0:a=0),(m.safari||m.chrome)&&(u=m.safari?-4:-40,i=(s=f.wge(a,c,u)).detailY,r=s.detailX)),(0!==i||0!==r)&&(e=f.parent.ib.Mg(f,t,et(i,10)||0,et(r,10)||0),n.iy(),!!e)&&void 0},f.G_=function(t){var n={e:t,r:M};if(p.Worksheet.et(f,"preProcessMouseOut",n),!n.r)return i.yg(t)},f.U_=function(t){var n,n,e,n={e:t,r:M};p.Worksheet.et(f,"preProcessMouseDbClick",n),n.r||(n=f.sw)&&(e=!1,3===F(n)?r(i,t):e=i.j_(n),e||f.ki(b.Events.CellDoubleClick,U(f,f.name(),n.row,n.col,F(n))))},n=i.tk,t.bind(Q+"."+n,function(t){return f.B_(t)}).bind(J+"."+n,function(t){return f.F_(t)}).bind(K+"."+n,function(t){return f.L_(t)}).bind(X+"."+n,function(t){return f.P_(t)}).bind(tt+"."+n,function(t){return f.G_(t)}).bind(nt+"."+n,function(t){return f.U_(t)}),m.mozilla)&&(e="onwheel"in document?$:q,t.bind(e+"."+n,function(t){return f.P_(t)}))}}),t.Hv.ch("worksheet-event",{preProcessMouseMove:function(t){var n,n,n=this.Vv.getActiveSheet();n&&(n=n.rt)&&n.ab&&n.rb&&n.isResizing&&(n.pg(t.e),t.r=!1)}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,n,u){"use strict";var e,i,r,o,a,l,s,h,c,d,v,m;function f(t,n,e,i,r){var o,n,a,o=n.getRange(e,i);if(n.source&&(t=n.source.Mf),n=o.row,a=o.col,r)if(1===o.rowCount)a=i;else{if(1!==o.colCount)return d;n=e}return g(t,n,a)}function g(t,n,e){var i,r,o,r,t,r;return t&&t.getFormatter?(i=t.getFormatter(n,e))&&"General"!==i?y(i,function(t,n){return a.Be.Re(t,n)}):(r=t.getStyle(n,e),(o=r&&r._autoFormatter)?y(o.formatCached,function(t,n){return o.format(t)}):(t=(r=t.pivotTables)&&r.findPivotTable(n,e))&&(i=(r=t.hqt(n,e))&&r.formatter)?y(i,function(t,n){return a.Be.Re(t,n)}):d):d}function p(t,n){var n=s(t,"E")&&n(1,t);return n&&s(n,"E")}function b(t,n){var n=n(123,t);return s(n,"123")&&0<(n=n.replace(/[1230. ]+/g,"")).length}function w(t,n){var n;if(t=t.replace("DBNum",""),e.Common.$T.qT("[mMdDyYhHseg]").test(t))return n=n(123,t),!s(n,"123")}function y(t,n){var e,i,r,o;if("string"!=typeof t||"="===t[0])return d;if(e={f:t},w(t,n)){if(i=n(44955,t),r=n(44955.11,t),o=n(45323,t),i!==r)return e.t=i===o?6:8,e;if(i!==o)return e.t=7,e}if(s(t,"%"))e.t=0;else if(s(t,"/"))e.t=4;else if(p(t,n))e.t=3;else if(b(t,n))e.t=5;else if(s(t,"0")||s(t,"DBNum",!0))e.t=2;else if(s(t,"GENERAL",!0))e.t=1;else{if(!s(t,"@"))return d;e.t=9}return e}function M(t,n,e,i,r){var e,t,e=e.value;if(e&&2===e.type)return{f:"0.00%",t:0};if(e&&9===e.type)if(0===e.operatorType||1===e.operatorType){if(e.value&&2===e.value.type)return{f:"0.00%",t:0}}else if(2===e.operatorType)return(t=M(t,n,e,i,r))&&0===t.t&&(t.f=t.f.replace("%","00%")),t;return d}function C(t,n,e,i,r){var o,t,o=A(t,n,e.value,i,r),t=A(t,n,e.value2,i,r);if(7===o.t||8===o.t){if(7===t.t||8===t.t)return d;if(6===t.t)return 8===o.t?o:{f:o.f+" "+t.f,t:8}}else if(6===o.t){if(8===t.t)return t;if(7===t.t)return{f:t.f+" "+o.f,t:8}}return 0===o.t&&0===t.t?{f:(t.f.length>o.f.length?t:o).f,t:0}:1!==o.t?o:t}function S(t,n,e,i,r){var o,t,o=A(t,n,e.value,i,r),t=A(t,n,e.value2,i,r);return 9===o.t?o:9===t.t?t:5<=o.t?5<=t.t?d:o:5<=t.t?t:3===o.t?o:3===t.t?t:4===o.t?o:4===t.t?t:2!==o.t&&1!==o.t&&2!==t.t&&1!==t.t&&0===o.t&&0===t.t?{f:(t.f.length>o.f.length?t:o).f,t:0}:d}function T(t,n,e,i,r){var o,a,u,s,c,f,o=e.functionName&&e.functionName.toUpperCase(),a=m[o];if(l(v[o]))return"number"==typeof a?A(t,n,f=e.arguments[a],i,r):a?a(t,n,e,i,r):d;switch(v[o]){case 6:u="H:mm:ss";break;case 7:u=h.Fe().DateTimeFormat.shortDatePattern||"M/d/yyyy";break;case 8:u=h.Fe().DateTimeFormat.defaultDatePattern||"M/d/yyyy H:mm:ss";break;case 0:u="0.00%";break;case 5:s=h.Fe().NumberFormat.currencySymbol||"$",u=(c=h.Fe().predefinedFormats.Currency)&&c[c.length-1]||"".concat(s,"#,##0.00_);[Red](").concat(s,"#,##0.00)")}return{f:u,t:v[o]}}function A(t,n,e,i,r){if(e)if(9===e.type){if(2===e.operatorType)return M(t,n,e,i,r);if(3===e.operatorType||4===e.operatorType)return C(t,n,e,i,r);if(5===e.operatorType||6===e.operatorType||7===e.operatorType)return S(t,n,e,i,r);if(0===e.operatorType||1===e.operatorType)return A(t,n,e.value,i,r)}else{if(1===e.type||13===e.type||22===e.type)return f(t,e,i,r);if(7===e.type)return T(t,n,e,i,r);if(10===e.type)return A(t,n,e.value,i,r)}return d}function I(t,n,e,i,r){var o=t.getFormatter(i,r);(!o||o.toUpperCase&&"GENERAL"===o.toUpperCase())&&(e=t.oMt.Fyt(i,r)||e,x(t,i,r,A(t,n,e,i,r)))}function x(t,n,e,i){var r=t.Z_(n,e)||new o.Style;(i="string"==typeof i?y(i,function(t,n){return a.Be.Re(t,n)}):i)&&1!==i.t?r._autoFormatter=new c(i.f):delete r._autoFormatter,delete r.formatter,t.setStyle(n,e,r)}Object.defineProperty(n,"__esModule",{value:!0}),n.Ffe=n.Fue=n.Pue=void 0,e=u("Common"),i=u("./dist/core/util/domUtil.js"),r=u("./dist/core/worksheet/worksheet.js"),o=u("./dist/core/worksheet/style.js"),a=u("./dist/core/util/common.js"),l=e.Common.lt.ht,s=e.Common.zf.OS,h=e.Common.CultureManager,c=e.Formatter&&e.Formatter.GeneralFormatter,d={t:1},i.GC$.extend(r.Worksheet.prototype,{getFormatter:function(t,n,e){return this.l0(t,n,"formatter",e)},setFormatter:function(t,n,e,i){var r=this.Z_(t,n,i),r;(r=r||new o.Style).formatter=e,this.setStyle(t,n,r,i)}}),r.Worksheet.ch("formatter",{settingText:function(t){var n,n,n=a.util.Kf(t.value);c&&n&&(n={},(new c).getPreferredDisplayFormatter(t.value,n),"number"==typeof n.value)&&(t.value=n.value)}}),v={NOW:8,TODAY:7,TIME:6,DATE:7,IRR:0,XIRR:0,MIRR:0,RATE:0,YIELD:0,INTRATE:0,NPV:5,XNPV:5},(m={SUM:0,MAX:0,MIN:0,AVEDEV:0,FLOOR:0,ROUND:0,ROUNDUP:0,ROUNDDOWN:0,INT:0,TRUNC:0}).SINGLE=m["@"]=function(t,n,e,i,r){var e=e.arguments[0];return!e||1!==e.type&&13!==e.type?d:f(t,e,i,r,!0)},m.INDIRECT=m.OFFSET=m.INDEX=function(i,t,n,r,o){var e,a,e=u("SheetsCalc"),a=d;return e&&(n.Gue=function(t,n,e){a=l(n)?f(i,t,r,o):g(e&&e.Mf||i,t,n)},e.evaluateExpression(i,n,r,o)),a},n.Pue=A,n.Fue=I,n.Ffe=x},"./dist/core/worksheet/worksheet-json.js":function(r,t,n){"use strict";var t,z,Y,Z,at,W,e,M,ut,o,st,i,ct,p,n,ft,n,a,x,u,pt,l,Q,J,lt,K,ht,N,X,dt,bt,h,d,s,v,wt,C,k,_,c,m,yt,S,D,vt,g,b,y,j,T,f,Mt,Ct,St,w,O,Tt,At,It,E,et,q,$,mt,A,R,F,L,gt,n;function I(t,n){return dt(t)?n:dt(n)?t:Math.max(t,n)}function B(t,n,e,i){var t,t;t.dataTable&&(n.dataTable||(n.dataTable={}),t=t.dataTable[e])&&(n.dataTable[e]||(n.dataTable[e]={}),t=t[i])&&(n.dataTable[e][i]||(n.dataTable[e][i]={}),t.formula)&&(n.dataTable[e][i].formula=t.formula)}function it(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=t.Ut,a=o.W_(),u=o.W_(ut.SheetArea.colHeader),s=o.Q_(!0),c=o.Q_(!0,ut.SheetArea.colHeader),f=o.K_(),l=o.K_(ut.SheetArea.colHeader),h=a.getColumnCount();for(!r&&dt(n.colHeaderData)?n.colHeaderData={}:o.ap=e,u.setRowCount(e),d=0;d<e;d++)for(u.setNode(d,-1,a.J_(d,-1)),c.X_(d,s.q_(d)),v=i;v<h;v++)u.setNode(d,v,a.J_(d,v)),r||B(n.data,n.colHeaderData,d,v);(m=f.getSpans((0,at.Ec)(0,0,e,h))).forEach(function(t){l.add(t)}),t.frozenRowCount(0)}function rt(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=t.Ut,a=o.W_(),u=o.W_(ut.SheetArea.rowHeader),s=o.Q_(!1),c=o.Q_(!1,ut.SheetArea.rowHeader),f=o.K_(),l=o.K_(ut.SheetArea.rowHeader),h=a.getRowCount();for(!r&&dt(n.rowHeaderData)?n.rowHeaderData={}:o.fp=e,u.setColumnCount(e),d=0;d<e;d++)for(u.setNode(-1,d,a.J_(-1,d)),c.X_(d,s.q_(d)),v=i;v<h;v++)u.setNode(v,d,a.J_(v,d)),r||B(n.data,n.rowHeaderData,v,d);(m=f.getSpans((0,at.Ec)(0,0,h,e))).forEach(function(t){l.add(t)}),t.frozenColumnCount(0)}function P(t,n){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":case"frozenTopRow":case"frozenLeftCol":return 0===n;case"rowCount":return 200===n;case"columnCount":return 20===n;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===n;case"visible":case"frozenTrailingRowStickToEdge":case"frozenTrailingColumnStickToEdge":return!0===n}}function tt(t,n){return K(t)?t:n}function nt(t,n,e,i){K(e)&&n.call(t,e,!!K(i)&&i)}function ot(e,i,r,o,a,u){lt&&ht(lt,function(t,n){var n=n.fromJson;n&&n.call(e,i,r,o,!K(a)||a,u)})}function G(t,i){var t=t.Uw&&t.Uw(3).t8.jme(-1,-1,-1,-1);t&&t.forEach(function(t){var n,e;t.isValid||(n=i[t.minX]&&i[t.minX][t.minY])&&(e={row:t.minX,rowCount:t.maxX-t.minX+1,col:t.minY,colCount:t.maxY-t.minY+1,isDynamicArray:!0},t.isValid||(e.isInvalid=!0),n.arrayInfo=e)})}function U(t,n){var n=k(n,Mt+"&tabColor");n&&(t.sheetTabColor=m(n))}function H(t,n,e){Lt(t,n,e),st.Util.wo(e,t.parent&&t.parent.v2)&&V(t,e)}function V(t,n){Q&&t.Lp.resumeAdjust(),Ht(t,n)}function xt(t,n,e){t.showCell(n,e,ut.VerticalPosition.top,ut.HorizontalPosition.left)}function Nt(t){var t,n,e,t,t=C(t,Ct);return t&&t.ref&&(t=S(t.ref,!0))&&(n=t.row+t.rowCount,e=t.col+t.colCount),{rowCount:n=dt(n)||n<-1?z.Worksheet.n8:n,colCount:e=dt(e)||e<-1?z.Worksheet.e8:e}}function kt(t,n){var t,n,e,t=t.defaults,n=C(n,At);n&&(e=n.defaultColWidth,isNaN(e)?(t.colWidth=at.SJSColumnWidthHelper.defaultColumnWidthToPixel(8),t._isExcelDefaultColumnWidth=!0):t.colWidth=at.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(e)),t.rowHeight=at.SJSColumnWidthHelper.pointToPixel(n.defaultRowHeight))}function _t(r,o,a,t){var n,e,i,u,s,c,f,l,h,d,v,m,g,p,b,w,y,y,M,M,C,y,i,M,d,n=k(o,"sheetViews&sheetView"),e=r.Ut,i=r.options,d=!a||!1!==a.includeStyles,v=st.Util.Co(a),m=r.getRowCount(),g=r.getColumnCount(),p=o.lossless,b=0,w=0;return n&&((y=n.topLeftCell)&&(f=S(y),b=f?f.row:0,w=f?f.col:0),n.zoomScale&&r.zoom(n.zoomScale/100),y=i.gridline,(M=o.lossless&&o.lossless.gridline)?(y.showHorizontalGridline=!!dt(M.showHorizontalGridline)||M.showHorizontalGridline,y.showVerticalGridline=!!dt(M.showVerticalGridline)||M.showVerticalGridline):"0"===n.showGridLines&&(y.showHorizontalGridline=!1,y.showVerticalGridline=!1),M&&!dt(M.color)?y.color=M.color:n.colorId&&64!=+n.colorId&&(y.color=at.ColorHelper.getIndexedColor(n.colorId)),T(n.showRowColHeaders,!0)||(i.rowHeaderVisible=!1,i.colHeaderVisible=!1),T(n.showFormulas)&&(i.showFormulas=!0),i.showZeros=T(n.showZeros,!0),T(n.tabSelected)&&r.b2(!0,!1),M=_(n,"pane"),C=3,d&&M&&0<M.length&&M.forEach(function(t){var n,n,t,e,i,n=t.state;"frozen"!==n&&"frozenSplit"!==n||(t.topLeftCell&&(c=t.topLeftCell),n=t.xSplit,t=t.ySplit,e=b,i=w,t&&m<=(l=+t+e)&&(m=I(m,l)),n&&g<=(h=+n+i)&&(g=I(g,h)),Rt(r,o,a,l,h,b,w),t&&n?(f=S(c),b=f.row||0,w=f.col||0):t&&!n?(f=S(c),b=f.row||0,w=i):!t&&n&&(f=S(c),b=e,w=f.col),m<b&&(m=b+1),g<w&&(g=w+1))}),d&&Ft(r,o),d&&(p&&p.defaultStyle?((y=new Y.Style).fromJSON(p.defaultStyle,mt,r),r.setDefaultStyle(y)):t.defaultStyle&&r.setDefaultStyle(t.defaultStyle)),(i=_(n,"selection"))&&0<i.length&&i.forEach(function(t){var n,n,n,t,n,n=t.activeCell;n&&(n=S(n),u=n.row,s=n.col,m=I(m,n.row+1),g=I(g,n.col+1)),n=t.panel,!(t=t.sqref)||n&&3!==n||(n=D(t),e.selectionModel.selections=n,v&&n&&n.forEach(function(t){var n=t.row+(0<t.rowCount?t.rowCount:1),t=t.col+(0<t.colCount?t.colCount:1);m=I(m,n),g=I(g,t)}))}),v)&&st.Util.So(r,m,g,t),M=p?tt(p.rowHeaderColCount,z.Worksheet.r8):z.Worksheet.r8,d=p?tt(p.colHeaderRowCount,z.Worksheet.o8):z.Worksheet.o8,r.setColumnCount(M,ut.SheetArea.rowHeader),r.setRowCount(d,ut.SheetArea.colHeader),r.O6(u||0,s||0,mt,mt,!0),{showCellRow:b,showCellCol:w}}function Dt(l,t,h,d,n,v){var m,e,g,i,i,p,b,w,e,n,y,M,i,m=!n||!1!==n.includeStyles,e=l.Ut,g=e.Q_(!1,3),i=C(t,It),i=i&&i.c_,p=e.W_(3),b=p.a8,w=j(n);i&&0<i.length&&(e=l.name(),n=(n=v.sheetColumnInfos)||(v.sheetColumnInfos={}),y=[],M=l.getColumnCount(),i.forEach(function(t,n){var e,r,i,o,a,a,u,s,c,e,i,f,e=t.width,r=T(t.hidden,!1),i=t.outlineLevel,a=p.J_(-1,n,!0),a=a&&a.style,u=+t.min,s=+t.max,c=A;for(dt(e)||(c=at.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(e)),r&&0===c&&(c=mt)),r=r&&dt(i)?r:A,w?t.t!==mt?o=h.getOriginNamedStyle(t.t):t.e!==mt&&(o=L(h.getOriginStyle(t.e))):o=h.getStyle(t.style),b&&x(b.style,-1,n,a,o),o=m&&o?o:A,1==u&&s===z.MAX_COLUMN_COUNT&&(v.dataEffectByInflate[l.name()]||(v.dataEffectByInflate[l.name()]={}),v.dataEffectByInflate[l.name()].setColumnInfo=function(t){var n,e,i;if(!(t.col<0||t.colCount<=0))for(n=t.col,e=0,i=t.colCount;e<i;e++)st.Util.cme(l,g,n+e,c,r,o)}),e=s===z.MAX_COLUMN_COUNT,i=+t.max,s=e?I(u,d):i,f=u;f<=s;f++)st.Util.cme(l,g,f-1,c,r,o);M<i&&y.push({minCol:+t.min,maxCol:i,columnSize:c,hidden:r,colStyle:o})}),n[e]=y),(i=t.lossless&&t.lossless.colInfos)&&i.forEach(function(t,n){dt(t)||(dt(t.colTag)||(l.setTag(-1,n,t.colTag),delete t.colTag),g.X_(n,t))})}function jt(t,n){var n,e,i,n=C(n,w);n&&(e=t.spanModels[3],(i=n.c_).forEach(function(t){var t=S(t.ref);e.find(t.row,t.col)||e.add(t)}))}function Ot(t,o,a){var n,u;if(0<t.length)return n={n_:O},u=[],t.forEach(function(t){var n,e,e,e,i,r,r,i,r,n={n_:ct.XFileConstants.ku,lossless:{}},e=o[t.row+","+t.col],e=vt(e||(0,at.Ec)(t.row,t.col,1,1));n.ref=e,(i=(e=t.hyperlink).url)&&(i.substring(0,(r="sjs://").length)===r?n.location=c(i.replace(r,"")):(r=ct.XFileConstants.Rr+st.Util.wr(a),a.c_.push({n_:ct.XFileConstants.Lr,Id:r,Target:c(i),Type:ct.RelationshipConstants.pc,TargetMode:ct.XFileConstants.Cu}),n[f]=r),"string"==typeof(i=t.value))&&(n.display=c(i)),e.tooltip&&(n.tooltip=c(e.tooltip)),r=n.lossless,dt(e.drawUnderline)||(r.drawUnderline=e.drawUnderline),dt(e.command)||(r.command=e.command),dt(e.target)||(r.target=e.target),e.visitedLinkColor!==mt&&(r.visitedLinkColor=e.visitedLinkColor),e.linkColor!==mt&&(r.linkColor=e.linkColor),u.push(n)}),n.c_=u,n}function Et(a,t){var n,n,u,n=C(t,O);n&&(n=n.c_)&&(u=t.rels&&t.rels.c_||[],n.forEach(function(t){var n,e,n,i,r,r,o,o,n=t.ref.split(":"),e=d(n[0]),n=h(n[0]),i=s(t.tooltip);t[f]&&(r=v(u,t[f]),r=s(r&&r.Target)),(o=s(t.location))&&(r=r?r+"#"+o:"sjs://"+(o="#"===o[0]?o.substr(1):o)),o=t.lossless||{},a.setHyperlink(e,n,{url:r,tooltip:i,linkColor:o.linkColor,visitedLinkColor:o.visitedLinkColor,drawUnderline:!!dt(o.drawUnderline)||o.drawUnderline,command:o.command,target:o.target||0},3)}))}function Rt(t,n,e,i,r,o,a){t.ome(i,o,!0),t.ame(r,a,!0)}function Ft(t,n){var n=n.lossless;n&&(nt(t,t.frozenTrailingRowCount,n.frozenTrailingRowCount),nt(t,t.frozenTrailingColumnCount,n.frozenTrailingColCount),t.Ny=!K(n.frozenTrailingRowStickToEdge)||n.frozenTrailingRowStickToEdge,t.Vy=!K(n.frozenTrailingColumnStickToEdge)||n.frozenTrailingColumnStickToEdge,dt(n.frozenlineColor)||(t.options.frozenlineColor=n.frozenlineColor))}function Lt(t,n,e){var i=e&&e.frozenColumnsAsRowHeaders,e=e&&e.frozenRowsAsColumnHeaders,r=t.frozenRowCount(),o=t.frozenColumnCount();0<r&&e&&it(t,mt,r,o,!0),0<o&&i&&rt(t,mt,o,r,!0)}function Bt(t,n,e){var i,r,o,a,u,s,i=t.options,r=C(n,"sheetProtection"),o=i.protectionOptions;if(r)for(a in r.algorithmName&&r.hashValue&&r.saltValue&&r.spinCount?t.oue={algorithmName:r.algorithmName,hashValue:r.hashValue,saltValue:r.saltValue,spinCount:+r.spinCount}:r.password&&(t.oue={legacyPassword:r.password}),delete r.algorithmName,delete r.hashValue,delete r.saltValue,delete r.spinCount,delete r.password,r)if(r.hasOwnProperty(a))switch(s="0"===(u=r[a]),a){case ct.XFileConstants.ru:i.isProtected="1"===u;break;case"selectLockedCells":o.allowSelectLockedCells=s;break;case"selectUnlockedCells":o.allowSelectUnlockedCells=s;break;case"autoFilter":o.allowFilter=s;break;case"sort":o.allowSort=s;break;case"insertColumns":o.allowInsertColumns=s;break;case"insertRows":o.allowInsertRows=s;break;case"deleteColumns":o.allowDeleteColumns=s;break;case"deleteRows":o.allowDeleteRows=s;break;case"objects":o.allowEditObjects=s;break;default:"1"===r[a]||"0"===r[a]?o[a]="0"===r[a]:"n_"!==a&&"c_"!==a&&(o[a]=r[a])}t.isActualProtected()&&!0!==o.allowEditObjects&&r.objects===mt&&(o.allowEditObjects=!0),"formatColumns"in o&&!0===o.formatColumns&&(o.allowOutlineColumns=!0,e)&&(o.allowResizeColumns=!0),"formatRows"in o&&!0===o.formatRows&&(o.allowOutlineRows=!0,e)&&(o.allowResizeRows=!0)}function Pt(n,e){var i={sheetAreaOffset:function(t){dt(t.left)||(n.sheetAreaOffset.left=t.left),dt(t.top)||(n.sheetAreaOffset.top=t.top)}};e&&e.sheetOptions&&Object.keys(e.sheetOptions).forEach(function(t){dt(e.sheetOptions[t])||(i[t]&&"function"==typeof i[t]?i[t](e.sheetOptions[t]):n[t]=e.sheetOptions[t])})}function Gt(t,n){t&&n&&(t.ghe=n.parameter)}function Ut(t,n){var e={rowHeaderAutoText:t.rowHeaderAutoText,colHeaderAutoText:t.colHeaderAutoText,rowHeaderAutoTextIndex:t.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:t.colHeaderAutoTextIndex,allowCellOverflow:t.allowCellOverflow,clipBoardOptions:t.clipBoardOptions,selectionBackColor:t.selectionBackColor,selectionBorderColor:t.selectionBorderColor,sheetAreaOffset:{left:t.sheetAreaOffset.left,top:t.sheetAreaOffset.top}};return n&&(e.rowHeaderVisible=t.rowHeaderVisible,e.colHeaderVisible=t.colHeaderVisible),e}function Ht(t,n){var e,n,i,e=n&&n.frozenColumnsAsRowHeaders,n=n&&n.frozenRowsAsColumnHeaders;(e||n)&&(i=t.Ut,n&&K(i.ap)&&(t.cp=!0,t.deleteRows(0,i.ap)),e)&&K(i.fp)&&t.deleteColumns(0,i.fp)}function Vt(t,n,e,i,r,o){var a,u,s,c,f,l;if(t){if(e.col=Math.max(t.getActiveColumnIndex(),0),e.row=Math.max(t.getActiveRowIndex(),0),a=0<r,u=0<o,0===i){if(!a||!u)return}else if(1===i){if(!u)return;a&&(e.col=o,e.row=0)}else if(2===i){if(!a)return;u&&(e.col=0,e.row=r)}if(e.col=Math.min(ct.XmlConstants.xo,e.col),e.row=Math.min(ct.XmlConstants.Io,e.row),n)if(s=void 0,c=t.getSelections())for(f=0;f<c.length;f++)"object"==typeof(l=c[f])&&(s=new at.Range(0<l.row?l.row:0,0<l.col?l.col:0,0<l.rowCount?l.rowCount:ct.XmlConstants.Io,0<l.colCount?l.colCount:ct.XmlConstants.xo),n.push(s));else n.push(new at.Range(e.row,e.col,1,1));return 1}}function zt(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,p,g,b,w,i=t.getSelections();if(i&&0!==i.length)for(r=e?t.frozenRowCount():0,o=e?t.frozenColumnCount():0,a=[],u=new at.Range(0,0,1,1),s=0,f=-(c=1),l=3;0<=l;l--)if(a.length=0,Vt(t,a,u,l,r,o)){for(c=a.length,s=0;s<c;s++)-1!==(h=-1!==(h=a[s]).col&&-1!==h.colCount?h:new at.Range(h.row,0,h.rowCount,ct.XmlConstants.xo)).row&&-1!==h.rowCount||(h=new at.Range(0,h.col,ct.XmlConstants.Io,h.colCount)),u.col>=h.col&&u.col<=h.col+h.colCount-1&&u.row>=h.row&&u.row<=h.row+h.rowCount-1&&(f=s);if(f<0&&0<c&&(u.row=a[0].row,u.col=a[0].col),d=""+y(u.col)+(u.row+1),v="",0<o&&0<r&&(1===l||2===l))v=d;else{for(s=0;s<c;s++)m=a[s],g=Math.min(ct.XmlConstants.Io,m.row+1),p=Math.min(m.col,ct.XmlConstants.xo),v+=""+y(p)+g,(1<m.colCount||1<m.rowCount)&&(p=Math.min(p+m.colCount-1,ct.XmlConstants.xo),g=Math.min(g+m.rowCount-1,ct.XmlConstants.Io),v+=":"+(b=""+y(p)+g)),v+=" ";v=v.trim()}st.StringEx.Xi(v)||3===l&&(0<o||0<r||3!==l)||(w={n_:"selection"},3!==l&&(w.pane=gt[l]),w.activeCell=d,0!==f&&0===l&&(w.activeCellId=f.toString()),w.sqref=v,n.c_.push(w))}}function Yt(t,n,e,i){var n,i,n=(n&&n.theme?n:i).theme,i=new W.Theme(void 0);e&&n?n&&i.yh(n):i.yh("Office"),t.currentTheme(i)}function Zt(t,n){t&&(t[n]=2)}function Wt(t,n){var e,i,r,o,a,u,u,e=t.options.protectionOptions,i,r={n_:"sheetProtection"};for(a in t.isActualProtected()&&(r.sheet="1"),o=function(t){return t?"0":"1"},e)e.hasOwnProperty(a)&&(u=e[a],["allowSelectLockedCells","allowSelectUnlockedCells","allowEditObjects"].includes(a)&&u||(u=st.protectionOptionsMap[a]||a,(n||st.excelSupportProtectionOptions[u])&&(r[u]=o(e[a]))));if(t.oue&&(at.util.w1(r,t.oue),r.spinCount=!dt(r.spinCount)&&""+r.spinCount,r.legacyPassword)&&(r.password=r.legacyPassword,delete r.legacyPassword),1<Object.keys(r).length)return r}function Qt(t,n){var t,e,e=function(t){var t=t.range();return n.intersect(t.row,t.col,t.rowCount,t.colCount)};return null==(t=t.tables)?void 0:t.all().some(e)}function Jt(t,n,e){for(var i,r,o,a,u,s,c,i=[],r=t.getSpans(),o={},a=0;a<r.length;a++)u=r[a],s=!n&&Qt(t,u),u&&!s&&(i.push({n_:ct.XFileConstants.xu,ref:vt(u)}),o[u.row+","+u.col]=u);return{spanRowColInfos:o,sjsMergeCells:c=e&&0<i.length?{n_:w,c_:i}:c}}Object.defineProperty(t,"__esModule",{value:!0}),t=n("Common"),z=n("./dist/core/worksheet/worksheet.js"),Y=n("./dist/core/worksheet/style.js"),Z=Y.Style.xp,at=n("./dist/core/util/common.js"),W=n("./dist/core/util/theme.js"),e=n("./dist/core/util/domUtil.js"),M=n("./dist/core/worksheet/stylehelper.js"),ut=n("./dist/core/core.enum.js"),o=n("CalcEngine"),st=n("./dist/core/excel-io-util/common.js"),i=n("./dist/core/excel-io-util/range-parser.js"),ct=n("./dist/core/excel-io-util/excel-types.js"),p=n("./dist/core/worksheet/worksheet-model.js"),n=n("./dist/core/core.ns.js"),ft=void 0,n=new t.Common.ResourceManager(n.SR,"Sheets"),a=n.getResource.bind(n),x=at.UsedRangeUtil.updateUsedRangeByData,pt=16384,l=1048576,Q=!!o,J=t.Common.CultureManager,lt=z.Worksheet.fh,K=at.util.T1,ht=e.GC$.each,N=e.GC$.isEmptyObject,X=t.Common.kh,dt=t.Common.lt.ht,bt=st.IndexHelper.nr,h=st.IndexHelper.$i,d=st.IndexHelper.qi,s=at.util.n1,v=st.Util.Sr,wt=at.util.Pr,C=at.util.xr,k=at.util.o1,_=at.util.go,c=at.util.vo,m=at.util.d1,yt=at.util.h1,S=i.range_parser._c,D=i.range_parser.Dc,vt=i.range_parser.jc,g=i.range_parser.Oc,b=t.Common.zf,y=st.Util.No,j=st.Util.ko,T=st.NodeHelper.ur,f=ct.XFileConstants.Ki,Mt=ct.XFileConstants.Su,Ct=ct.XFileConstants.Tu,St=ct.XFileConstants.Au,w=ct.XFileConstants.Iu,O=ct.XFileConstants.Nu,Tt=ct.XFileConstants.Du,At=ct.XFileConstants._u,It=ct.XFileConstants.Eu,E=ct.XFileConstants.bo,et="string",q=parseInt,$=isNaN,mt=void 0,A=null,R="1",F="0",L=t.Common.lt.tv,(n=gt=gt||{})[n.bottomRight=0]="bottomRight",n[n.topRight=1]="topRight",n[n.bottomLeft=2]="bottomLeft",n[n.topLeft=3]="topLeft",e.GC$.extend(z.Worksheet.prototype,{s8:function(t,n,e,i,r,o){var t,n;t[n]||(t[n]={}),(t=t[n])[e]||(t[e]={}),n=t[e],r&&!dt(n.value)||(n.value=i),dt(o)||(n.style=o)},c8:function(t,n,e,i,r,o){var t,a,u,s,c,f,c,t=C(t,E),a=t[n],u=(u=(a=a||(t[n]={}))[e])||(a[e]={});switch(s=typeof i){case"boolean":u.b=i?1:0;break;case"string":f=(c=(0,p.getOADateNumber)(i,r)).OADateNumber,c=c.valueIndex,u.o=f,u.v=c;break;case"object":i&&i.richText?u.v=r.getTextIndex(i):u.v=i;break;default:u.n=i}dt(o)||(u.s=o)},Op:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,g,e=this,i=e.Ut,r=i.W_(),o=i.W_(ut.SheetArea.colHeader),a=i.Q_(!0),u=i.Q_(!0,ut.SheetArea.colHeader),s=i.K_(),c=i.K_(ut.SheetArea.colHeader),f=e.rowFilter(),l=r.getColumnCount(),h=0;h<t;h++)for(r.setNode(h,-1,o.J_(h,-1)),d=u.q_(h),e.NMi&&(v=e.defaults.colHeaderRowHeight)!==p.DEFAULT_COL_HEADER_ROW_HEIGHT&&(d?dt(d.size)&&(d.size=v):d={size:v}),a.X_(h,d),m=n;m<l;m++)(g=(g=o.J_(h,m))||{}).style=e.getActualStyle(h,m,ut.SheetArea.colHeader),r.setNode(h,m,g),(g=e.getFormula(h,m,ut.SheetArea.colHeader))&&e.setFormula(h,m,g,ut.SheetArea.viewport);c.getSpans().forEach(function(t){s.add(t)}),f&&f.range&&-1===f.range.row&&(f.f8=!0),e.frozenRowCount(t),i.l8(z.Worksheet.o8,l,ut.SheetArea.colHeader),i.h8(!1,ut.SheetArea.colHeader),i.d8(ut.SheetArea.colHeader),e.b3(ut.SheetArea.colHeader).clearAll()},jp:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,d,e=this,i=e.Ut,r=i.W_(),o=i.W_(ut.SheetArea.rowHeader),a=i.Q_(!1),u=i.Q_(!1,ut.SheetArea.rowHeader),s=i.K_(),c=i.K_(ut.SheetArea.rowHeader),f=r.getRowCount(),l=0;l<t;l++)for(r.setNode(-1,l,o.J_(-1,l)),a.X_(l,u.q_(l)),h=n;h<f;h++)(d=(d=o.J_(h,l))||{}).style=e.getActualStyle(h,l,ut.SheetArea.rowHeader),r.setNode(h,l,d),(d=e.getFormula(h,l,ut.SheetArea.rowHeader))&&e.setFormula(h,l,d,ut.SheetArea.viewport);c.getSpans().forEach(function(t){s.add(t)}),e.frozenColumnCount(t),i.l8(f,z.Worksheet.r8,ut.SheetArea.rowHeader),i.h8(!1,ut.SheetArea.rowHeader),i.d8(ut.SheetArea.rowHeader),e.b3(ut.SheetArea.rowHeader).clearAll()},toJSON:function(e){var a,t,n,i,r,o,r,u,u,n,r,i,s,u,c,f,l,h,d,v,m,g,p,b,w,b,a=this,t=e&&e.ignoreStyle;for(l in!e||e.kp||a.NMi||(n=a.getRowCount(ut.SheetArea.colHeader),i=a.getColumnCount(ut.SheetArea.rowHeader),r=e.rowHeadersAsFrozenColumns,u=(o=e.columnHeadersAsFrozenRows)&&0<n,(r=r&&0<i)&&a.addColumns(0,i),u&&a.ffe(0,n,3,u),r&&a.jp(i,u?n:0),u&&a.Op(n,r?i:0)),u=a.getRowCount(),n=a.getColumnCount(),r=a.getRowCount(ut.SheetArea.colHeader),i=a.getColumnCount(ut.SheetArea.rowHeader),s={name:e&&e.newWorkSheetName||a.name(),isSelected:a.b2(),rowCount:u,columnCount:n,activeRow:a.ui,activeCol:a.ci,zoomFactor:a.zoom(),rowHeaderColCount:i,colHeaderRowCount:r,visible:a.visible(),parameter:a.ghe},u=a.getDockScrollbarAttachedIndex(),dt(u)||(s.dockScrollbarAttachedIndex=u),t||(s.frozenRowCount=a.frozenRowCount(),s.frozenColCount=a.frozenColumnCount(),s.frozenTopRow=a.bve,s.frozenLeftCol=a.yve,s.frozenTrailingRowCount=a.frozenTrailingRowCount(),s.frozenTrailingColCount=a.frozenTrailingColumnCount(),s.frozenTrailingRowStickToEdge=a.Ny,s.frozenTrailingColumnStickToEdge=a.Vy,s.theme=a.hl.toJSON()),f=(c=a.Ut).toJSON(e))s[l]=f[l];for(d in lt&&ht(lt,function(t,n){n.toJson&&n.toJson.call(a,s,e)}),h={},s)!X(s,d)||dt(v=s[d])||P(d,v)||(h[d]=v);if(G(a,s.data.dataTable),ht(a.options,function(t,n){var e,i,r,o,e=n;"gridline"===t&&(e={},i=n.color,r=n.showHorizontalGridline,o=n.showVerticalGridline,i&&i!==at.I.fl("gc-gridlineColor").borderTopColor&&(e.color=i),!1===r&&(e.showHorizontalGridline=r),!1===o)&&(e.showVerticalGridline=o),"sheetAreaOffset"===t&&(e={},n.left&&(e.left=n.left),n.top)&&(e.top=n.top),"protectionOptions"===t&&a.oue&&at.util.w1(e,a.oue),"_ps"===t||dt(e)||z.Worksheet.Pp[t]===e||"object"==typeof e&&N(e)||(h[t]=e)}),m=[],g=a.Hp){for(p in g)X(g,p)&&(b=g[p])&&(w=b.toJSON(),b=b.font,N(w)||(b&&(w.font=M.W.b5(b)),m.push(w)));0<m.length&&(h.namedStyles=m)}return h},fromJSON:function(t,F,n,e,i){var r,o,a,n,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,L,N,B,k,P,_,G,U,D,H,j,V,O,E,R;if(n&&(r=n.noSchema,o=n.version),t){n=(a=this).Ut,u=e&&e.ignoreStyle,a.Zp(),(s=a.Uw&&a.Uw())&&!s.G3&&(c=s.G3=!0),z.Worksheet.et(a,"preFromJson"),a.suspendPaint(),n.v8(),n.m8(),f=J.culture(),J.culture(""),l=tt(t.rowCount,z.Worksheet.n8),h=tt(t.columnCount,z.Worksheet.e8);try{if(a.ub(t.name+"",!0),a.b2(t.isSelected),a.setRowCount(l),a.setColumnCount(h),a.ghe=t.parameter,a.Hp={},d=t.namedStyles)for(v=0;v<d.length;v++)m=d[v],g=new Y.Style,Z(m,a),g.fromJSON(m,r,a),a.$p(g);for(b in p=a.options)if(X(p,b)&&(w=t[b],"protectionOptions"===b?(w=w||t.protectionOption)&&(w.algorithmName&&w.hashValue&&w.saltValue&&w.spinCount&&(a.oue={algorithmName:w.algorithmName,hashValue:w.hashValue,saltValue:w.saltValue,spinCount:w.spinCount}),delete w.algorithmName,delete w.hashValue,delete w.saltValue,delete w.spinCount):"allowCellOverflow"===b&&(w=K(t[b])?t[b]:!o||11<=o),K(w)))if("object"==typeof w)for(y in w)X(w,y)&&(p[b][y]=w[y]);else"borderWidth"===b?(p.sheetAreaOffset.left=w,p.sheetAreaOffset.top=w):p[b]=w;if(M=tt(t.activeRow,a.ui),C=tt(t.activeCol,a.ci),a.O6(M,C,mt,mt,!0),u||(nt(a,a.frozenRowCount,t.frozenRowCount,t.frozenTopRow||0),nt(a,a.frozenColumnCount,t.frozenColCount,t.frozenLeftCol||0),nt(a,a.frozenTrailingRowCount,t.frozenTrailingRowCount),nt(a,a.frozenTrailingColumnCount,t.frozenTrailingColCount),a.Ny=!K(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,a.Vy=!K(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!u){if(S=t.colStyles)for(T in S)$(T)||a.setStyle(-1,q(T,10),S[T],ut.SheetArea.viewport);if(A=t.rowStyles)for(I in A)$(I)||a.setStyle(q(I,10),-1,A[I],ut.SheetArea.viewport)}x=tt(t.rowHeaderColCount,z.Worksheet.r8),L=tt(t.colHeaderRowCount,z.Worksheet.o8),a.setColumnCount(x,ut.SheetArea.rowHeader),a.setRowCount(L,ut.SheetArea.colHeader),a.g8(tt(t._zoomFactor||t.zoomFactor,a.zoom())),!1===t.visible?t.visible=ut.SheetTabVisible.hidden:!0===t.visible&&(t.visible=ut.SheetTabVisible.visible),nt(a,a.visible,t.visible),N=a.b8,B={sheet:a,setValidator:function(t,n,e){N&&N.y8(t,n,e)},ignoreStyle:u},a.w8(t),n.fromJSON(t,r,B,a.Lp&&a.Lp.allowDynamicArray),a.defaults=n.defaults,N&&N.C8(!0),k=t.dockScrollbarAttachedIndex,dt(k)||a.setDockScrollbarAttachedIndex(k),(P=t.theme)&&!u&&(typeof(_=P)!=et&&K(_)&&(G="_themeColor",U="_name",D=_.themeColor||_[G],(H=new W.ColorScheme(D.name||D[U])).fromJSON(D,r),_=new W.Theme(_.name||_.Zc,H,_.headingFont||_.Aee,_.bodyFont||_.See)),a.currentTheme(_)),ot(a,t,r,e,F,i),j=e&&e.frozenColumnsAsRowHeaders&&!a.NMi,O=(V=e&&e.frozenRowsAsColumnHeaders&&!a.NMi)&&t.frozenRowCount||0,E=j&&t.frozenColCount||0,V&&0<O&&it(a,t,O,E),j&&0<E&&rt(a,t,E,O),Q&&(R=a.Uw(),0<O&&(R.S8=O),0<E)&&(R.T8=E),i||(0<O&&a.deleteRows(0,O),0<E&&a.deleteColumns(0,E)),a.clearPendingChanges()}finally{c&&delete s.G3,J.culture(f),n.A8(),a.resumePaint()}}},Yp:function(a,u,t,s,c){var f,n,l,h,d,v,e,i,r,o,m,g,p,b,t,w,y,M,C,S,t,w,T,t;if(t&&(f=t.noSchema,n=t.version),a){if(h=(l=this).Ut,d=s.ignoreStyle,l.Zp(),z.Worksheet.et(l,"preFromJson"),h.v8(),h.m8(),v=J.culture(),J.culture(""),l.Hp={},e=a.namedStyles)for(i=0;i<e.length;i++)r=e[i],o=new Y.Style,Z(r,l),o.fromJSON(r,f,l),l.$p(o);for(g in m=l.options)if(X(m,g)&&(p=a[g],"protectionOptions"===g?p=p||a.protectionOption:"allowCellOverflow"===g&&(p=K(a[g])?a[g]:!n||11<=n),K(p)))if("object"==typeof p)for(b in p)X(p,b)&&(m[g][b]=p[b]);else"borderWidth"===g?(m.sheetAreaOffset.left=p,m.sheetAreaOffset.top=p):m[g]=p;if(t=tt(a.activeRow,l.ui),w=tt(a.activeCol,l.ci),l.O6(t,w,mt,mt,!0),d||(nt(l,l.frozenRowCount,a.frozenRowCount),nt(l,l.frozenColumnCount,a.frozenColCount),nt(l,l.frozenTrailingRowCount,a.frozenTrailingRowCount),nt(l,l.frozenTrailingColumnCount,a.frozenTrailingColCount),l.Ny=!K(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,l.Vy=!K(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!d){if(y=a.colStyles)for(M in y)$(M)||l.setStyle(-1,q(M,10),y[M],ut.SheetArea.viewport);if(C=a.rowStyles)for(S in C)$(S)||l.setStyle(q(S,10),-1,C[S],ut.SheetArea.viewport)}t=tt(a.rowHeaderColCount,z.Worksheet.r8),w=tt(a.colHeaderRowCount,z.Worksheet.o8),l.setColumnCount(t,ut.SheetArea.rowHeader),l.setRowCount(w,ut.SheetArea.colHeader),l.g8(tt(a._zoomFactor||a.zoomFactor,l.zoom())),T=l.b8,t={sheet:l,setValidator:function(t,n,e){T&&T.y8(t,n,e)},ignoreStyle:d,incrementalLoading:s.incrementalLoading,incrementLoadTask:s.incrementLoadTask},l.w8(a),h.fromJSON(a,f,t,l.Lp&&l.Lp.allowDynamicArray,function(){var t,t,n,e,i,r,i,r,t,o,r;l.defaults=h.defaults,T&&T.C8(!0),(t=a.theme)&&!d&&(typeof(t=t)!=et&&K(t)&&(i=t.themeColor||t[n="_themeColor"],(r=new W.ColorScheme(i.name||i[e="_name"])).fromJSON(i,f),t=new W.Theme(t.name||t.Zc,r,t.headingFont||t.Aee,t.bodyFont||t.See)),l.currentTheme(t)),ot(l,a,f,s,u,c),i=s&&s.frozenColumnsAsRowHeaders&&!l.NMi,t=(r=s&&s.frozenRowsAsColumnHeaders&&!l.NMi)&&a.frozenRowCount||0,o=i&&a.frozenColCount||0,r&&0<t&&it(l,a,t,o),i&&0<o&&rt(l,a,o,t),Q&&(r=l.Uw(),0<t&&(r.S8=t),0<o)&&(r.T8=o),c||(0<t&&l.deleteRows(0,t),0<o&&l.deleteColumns(0,o)),l.clearPendingChanges(),J.culture(v),h.A8(),l.loaded=!0})}},wh:function(F,L,e){var i,t,n,r,B,o,a,u,s,c,u,c,s,c,u,f,l,h,d,v,m,g,p,s,s,g,u,b,w,y,v,M,m,l,d,C,f,h,g,u,y,w,b,v,m,P,S,G,d,T,U,H,h,g,u,y,w,A,b,I,S,o,a,p,c,V,z,v,m,x,Y,Z,N,k,k,_,W,D,Q,J,K,X,q,$,P,T,t,G,d,tt,g,u,y,w,nt,et,j,it,O,rt,E,ot,R,i=this,t=i.options,n=st.Util.ko(e),r=!e||!1!==e.includeStyles;for(t.sheetTabColor&&(B={n_:Mt,c_:[yt(t.sheetTabColor,mt,"tabColor")]}),o=i.getRowCount(ut.SheetArea.colHeader)||1,a=i.getColumnCount(ut.SheetArea.rowHeader)||1,u=i.NMi&&(e&&e.fileType)===ut.OpenSaveFileType.excel,s=e&&e.rowHeadersAsFrozenColumns,c=e&&e.columnHeadersAsFrozenRows,(s||c||u)&&(c=(c||u)&&0<o,(u=s&&0<a)&&i.addColumns(0,a),c&&i.ffe(0,o,3,c),u&&i.jp(a,c?o:0),c)&&i.Op(o,u?a:0),s=t.gridline,c=t.frozenlineColor,u=i.zoom(),f=i.frozenRowCount(),l=i.frozenColumnCount(),h=i.bve||0,d=i.yve||0,v=i.getViewportLeftColumn(1),m=i.getViewportTopRow(1),i.NMi?g="A1":h||d?g=vt((0,at.Ec)(h,d,1,1)):v!==mt&&m!==mt&&(f||l?l&&!f?g="A"+(m+1):!l&&f&&(g=vt((0,at.Ec)(0,v,1,1))):g=vt((0,at.Ec)(m,v,1,1))),s=(s=(p=s?{color:s.color,showVerticalGridline:s.showVerticalGridline,showHorizontalGridline:s.showHorizontalGridline}:p)&&p.color&&p.color!==at.I.fl("gc-gridlineColor").borderTopColor?p&&p.color:mt)&&at.ColorHelper.getClosestColorIndex(at.ColorHelper.convertHexColorToArgb(s)),s={n_:"sheetView",showGridLines:!p||!1!==p.showVerticalGridline&&!1!==p.showHorizontalGridline?mt:"0",showRowColHeaders:!1===t.rowHeaderVisible&&!1===t.colHeaderVisible?"0":mt,defaultGridColor:s?0:mt,colorId:s,showFormulas:t.showFormulas?"1":mt,showZeros:t.showZeros?mt:"0",topLeftCell:g||mt,zoomScale:1===u?mt:Math.round(100*u),workbookViewId:0,tabSelected:i.b2()?"1":mt,c_:[]},u=g=0,b=3,w="1",y="A",r&&(0<l||0<f)&&(0<l&&(g=l,y=bt(v)),0<f&&(u=f,w=m+1+""),0<l&&0===f?b=1:0===l&&0<f?b=2:0<l&&0<f&&(b=0),v={n_:"pane",xSplit:0<l?l-d:mt,ySplit:0<f?f-h:mt,topLeftCell:y+w==="A1"?vt((0,at.Ec)(g,u,1,1)):y+w,activePane:gt[b],state:"frozen"},s.c_.push(v)),zt(i,s,r),M=L.styleManager,m=L.sharedStrings,C=(d=(l=i.Ut).wh(M,m,e)).sheetData,f=d.hyperlinks,h=d.rowHeaderData,g=d.colHeaderData,u=d.rowHeaderColInfos,y=d.colHeaderRowInfos,w=d.rowHeaderSpan,b=d.colHeaderSpan,v=d.defaults,m=d.selectionPolicy,P=d.selectionUnit,S=d.rowInfos,G=d.defaultData,d=d.tag,T=!i.NMi&&i.getDefaultStyle(),h={rowHeaderData:h,colHeaderData:g,rowHeaderColInfos:u,colHeaderRowInfos:y,rowHeaderSpan:w,colHeaderSpan:b,rowInfos:S,colHeaderRowCount:o,rowHeaderColCount:a,gridline:p,frozenlineColor:c,defaults:v,selectionPolicy:m,selectionUnit:P,defaultStyle:U=r&&T&&T.toJSON(),sheetOptions:H=Ut(t,n),defaultData:G,tag:d,parameter:i.ghe},r&&(w=y=u=g=void 0,g=i.frozenTrailingRowCount(),u=i.frozenTrailingColumnCount(),y=i.Ny,w=i.Vy,0!==g&&(h.frozenTrailingRowCount=g),0!==u&&(h.frozenTrailingColCount=u),!0!==y&&(h.frozenTrailingRowStickToEdge=y),!0!==w)&&(h.frozenTrailingColumnStickToEdge=w),r&&(h.theme=i.hl.wh(n)),A=l.Q_(!1,3).wh(e),I=(b=l.defaults).colWidth,S=b.rowHeight,o={n_:At,defaultRowHeight:at.SJSColumnWidthHelper.pixelToPoint(S),defaultColWidth:at.SJSColumnWidthHelper.pixelToColumnWidth(I),customHeight:2<=Math.abs(76-S)?"1":mt},a=e&&!1===e.includeEmptyRegionCells,c=p=0,V=i.getRowCount(),z=i.getColumnCount(),a&&(v=ut.UsedRangeType.all-ut.UsedRangeType.colStyle-ut.UsedRangeType.rowStyle-ut.UsedRangeType.style-ut.UsedRangeType.axis,m=i.getUsedRange(v))&&(p=m.row,c=m.col,V=m.row+m.rowCount,z=m.col+m.colCount),x=[],Y=h.colInfos=[],Z=l.W_(3),N=c;N<z;N++)k=(k=Z.J_(-1,N))&&k.style,_=A[N],W=i.getTag(-1,N),!_&&!k&&dt(W)||(D=_&&_.size,Q=_&&_.visible,X=K=J=void 0,r&&k&&(n?"string"==typeof k?J=M.getOriginNamedStyleIndex(k,i):k!==mt&&(K=M.getOriginStyleIndex(k,i)):("string"==typeof k&&0===k.indexOf(M.Jd)&&(q=k,k=(k=i.i3(q,!1))||($=i.parent)&&$.i3(q,!1)),X=M.getStyleIndex(k))),(!dt(D)&&D!==I||!1===Q||k||J!==mt||K!==mt)&&(x[N]={width:dt(D)?at.SJSColumnWidthHelper.pixelToColumnWidth(I):at.SJSColumnWidthHelper.pixelToColumnWidth(D),hidden:!1===Q?"1":mt,customWidth:dt(D)||D===I?mt:1,style:X,t:J,e:K}),dt(W)||(A[N]=A[N]||{},A[N].colTag=W),Y[N]=A[N]);for(T=(P=Jt(i,n,r)).spanRowColInfos,t=P.sjsMergeCells,d=Ot(f,T,G={n_:ct.XFileConstants.Dr,xmlns:ct.RelationshipConstants._r,c_:[]}),N=p;N<V;N++)tt=i.getTag(N,-1),!C[N]&&dt(tt)&&!1!==i.getRowVisible(N)||(C[N]||(C[N]={r:N+1}),!1===i.getRowVisible(N)&&(C[N].v="1"),dt(tt))||(C[N].lossless={tag:tt});for(g=Wt(i,n),u=i.getRowCount()||1,y=i.getColumnCount()||1,w={n_:Ct,ref:vt((0,at.Ec)(0,0,u,y))},j={n_:"worksheet",c_:[B,w,nt={n_:Tt,c_:[s]},o,C,g,t,d,et={n_:St,c_:[]}],rels:G,tempCols:x,lossless:h},lt&&ht(lt,function(t,n){n.wh&&n.wh.call(i,j,L,e)}),it=[],N=0;N<x.length;N++)if(O=x[N]){if(pt<=(rt=N))break;for(E=N+1,ot=rt;E<x.length&&(R=x[E])&&E===ot+1&&E<pt&&R.style===O.style&&R.hidden===O.hidden&&R.outlineLevel===O.outlineLevel&&R.collapsed===O.collapsed&&Math.abs(R.width-O.width)<=1e-4&&R.t===O.t&&R.e===O.e;)N=ot=E,E++;_={n_:"col",min:rt+1+"",max:ot+1+""},O.style!==ft&&(_.style=O.style+""),O.t!==ft&&(_.t=O.t+""),O.e!==ft&&(_.e=O.e+""),isNaN(O.width)||O.width===ft||(_.width=O.width+""),_.hidden=O.hidden,O.collapsed&&(_.collapsed="1"),!isNaN(O.width)&&1e-4<Math.abs(O.width-i.defaults.colWidth)&&(_.customWidth="1"),"number"==typeof O.outlineLevel&&0!==O.outlineLevel&&(_.outlineLevel=O.outlineLevel+""),it.push(_)}return 0<it.length&&j.c_.push({n_:It,c_:it}),delete j.tempCols,wt(j,ct.WorkSheetNodeOrder),j},rv:function(e,i,r,o){var a,t,n,u,s,c,s,f,c,l,h,l,d,v,m,c,a=this,t=a.options,n=C(e,E),u=e.lossless;U(t,e),c=(s=Nt(e)).rowCount,s=s.colCount,n&&(r.fileType===ut.OpenSaveFileType.excel?(dt(n.rowCount)||(c=Math.max(n.rowCount,c||0)),dt(n.colCount)||(s=Math.max(n.colCount,s||0))):(dt(n.rowCount)||(c=n.rowCount),dt(n.colCount)||(s=n.colCount))),a.setRowCount(c),a.setColumnCount(s),c=(f=a.parent)&&f.getSheetPosition(a.name()),(l=i.sheetNamedStyles)[c]&&l[c].forEach(function(t){delete t.sheetId,a.addNamedStyle(t)}),kt(h=a.Ut,e),l=_t(a,e,r,i),d=l.showCellRow,v=l.showCellCol,m=!r||!1!==r.includeStyles,Yt(a,u,m,i),c=i.styleManager,Dt(a,e,c,s,r,i),Pt(t,u),Gt(a,u),h.yh(n,i,r,u,function(){m&&jt(h,e),Et(a,e),Bt(a,e,r.fileType===ut.OpenSaveFileType.excel),lt&&ht(lt,function(t,n){n.yh&&n.yh.call(a,e,i,r,o)}),st.Util.ume(a,i);var t=f&&f.v2,t=t&&t.sheetsState;o?(Zt(t,a.name()),H(a,e,r),xt(a,d,v)):r.incrementLoadTask.addTask(function(t,n,e,i){Zt(i,t.name()),H(t,n,e),xt(a,d,v)},[a,e,r,t])},o,a.Lp&&a.Lp.allowDynamicArray)},yh:function(t,n,e,i){var r,o,i,r=this;i?r.rv(t,n,e,i):((e=e||{}).progress||(e.progress=function(t){}),e.loadStatus||(e.loadStatus={total:0,valuesLoad:0,formulaLoad:0}),o=st.Util.wo(e,r.parent&&r.parent.v2),i=e.incrementLoadTask&&e.incrementLoadTask.tasks&&0===e.incrementLoadTask.tasks.length,e.incrementLoadTask.addTask(function(t,n,e){r.rv(t,n,e)},[t,n,e],b.I5(a().STEP.loadSheetData,[r.name()]),function(){var t=e.loadStatus.valuesLoad/e.loadStatus.total;return o?.2:e.fullRecalc?t*st.STEP_RATE.loadSheetDataWithCalc+ +st.STEP_RATE.parseFile+st.STEP_RATE.loadFileData:t*st.STEP_RATE.loadSheetData+st.STEP_RATE.parseFile+st.STEP_RATE.loadFileData},r.name()),i&&e.incrementLoadTask.start())}})},"./dist/core/worksheet/worksheet-model.js":function(u,m,h){"use strict";var c,l,v,_,O,tt,S,E,R,F,nt,t,et,L,B,st,P,D,G,it,U,H,rt,ot,g,T,V,p,I,z,Y,Z,b,w,W,s,y,at,Q,J,K,ct,X,ut,q,$,ft,lt,ht,d,dt,j,M,C,vt,mt,gt,pt,t,bt,wt,P,yt,Mt,Ct,St,Tt,At,It,f,xt,Nt,kt,_t,Dt,jt,Ot,Et,Rt,Ft,Lt;function Bt(t,n){return at(t)?n:t}function N(t,n){return t.hasOwnProperty(n)}function Pt(t){return"number"==typeof t}function x(t){return t.rowCount}function k(t){return t.colCount}function Gt(t,e,n,i){var r=n;Object.defineProperty(t,e,{get:function(){return r},set:function(t){var n=r;i(this,r=t,e,n)}})}function Ut(n,t){n.cache={},t&&t.forEach(function(t){Ht(n,t)})}function Ht(t,n){var e,i;if(t.I8=p(t.I8,n.row+x(n)-1),t.x8=p(t.x8,n.col+k(n)-1),!t.suspendUpdatingCache)for(e=0;e<n.rowCount;e++)for(i=0;i<n.colCount;i++)t.cache[n.row+e+"_"+(n.col+i)]=n}function Vt(t,n){var e,i;if(!t.suspendUpdatingCache)for(e=0;e<n.rowCount;e++)for(i=0;i<n.colCount;i++)t.cache[n.row+e+"_"+(n.col+i)]=ot}function zt(t,n){var e,i,e,e=t.indexOf("/OADate(")+1,i=t.indexOf(")");return 0!==e&&e<i&&(e=parseFloat(t.substring(e+7,i)),!isNaN(e))?{OADateNumber:e,valueIndex:ot}:{OADateNumber:ot,valueIndex:n.getTextIndex(t)}}function n(){Gt(this,"spans",[],Ut),this.x8=-1,this.I8=-1,this.cache={},this.suspendUpdatingCache=!1}function Yt(){Array.apply(this,arguments)}function Zt(){var t=Ft.call(this)||this;return t.headingOverflowLayouts=rt,t.trailingOverflowLayouts=rt,t}function Wt(t,n,e,i,r,o,a,u,s){var c=this;c.column=t,c.startColumn=n,c.endColumn=e,c.valueWidth=i,c.columnWidth=r,c.backgroundWidth=o,c.backgroundLeftWidth=a,c.backgroundRightWidth=u,c.expandedWidth=s}function Qt(t,n,e){var i,r,o,a,u,i=(0,nt.Ec)(-1,-1,-1,-1);return t&&(r=t.col,o=t.row,u=-1===r,i.row=(a=-1===o)?0:o,i.rowCount=a?n:x(t),i.col=u?0:r,i.colCount=u?e:k(t)),i}function e(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}function Jt(t,n,e,i,r,o){for(var a,u,s,c,f,a=t.length,s=!1,c=[],f=0;f<a;f++)if(u=t[f],s=at(n)||at(e)?at(n)?at(e)?at(i)?u.containsY(r):u.containsX(i):u.col===e:u.row===n:u.contains(n,e)){if(!o)return u;c.push(u)}return o&&0<c.length?c:rt}function Kt(t,n,e){var i=rt,r=t.length,o=!at(n);return i=0<r?(i=o?t.findX(n):t.findY(e))||(o&&n<t[0].x||!o&&e<t[0].y?t[0]:t[r-1]):i}function i(){return Lt.call(this)||this}function Xt(t,n,e,i,r,o,a,u,s,c){var f=this;f.rowCount=a,f.colCount=u,f.row=t,f.col=n,f.x=e,f.y=i,f.width=r,f.height=o,f.isAutoMerge=s,f.offsetX=c}function qt(t,n){var t=t.valuesLoad/t.total;return n?.4*t+.1:.3*t+.1}function $t(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,w,y,M,C,l,a,l=r&&r.incrementLoadTask;if(l&&!l.isTerminated){for(h=l.isBusyFunc,d=a=a||0,v=!1,m=30,g=new Date;d<e;){if(p=n[d])for(b=0;b<i;b++)(w=p[b])&&cn(w,t.J_(d,b,v=!0),o,d,b,r,s,c,f);if(d++,h&&h())break;if(30<(y=new Date)-g)break}if(v){if(M=r&&r.sheet,0!==a&&M.parent.getActiveSheet()===M)for(C=a;C<d;C++)if(M.N8.viewport[1].findRow(C)){M.repaint();break}(l=r&&r.incrementalLoading)&&(l.loadStatus.valuesLoad+=d-a,a=qt(l.loadStatus,r.doNotRecalculateAfterLoad),M.parent&&M.parent.ki(nt.Events.ProgressChanged,{loadStatus:l.loadStatus,progress:a,sheet:M}),l.loading)&&l.loading(a,{sheet:M})}d<e?r.incrementLoadTask.pushTask($t,[t,n,e,i,r,o,d,u,s]):u&&r.incrementLoadTask.pushTask(u,[])}}function tn(t,n,e,i,r,o,a,u,s){for(var c,f,l,h,c=0;c<e;c++)if(f=n[c])for(l=0;l<i;l++)(h=f[l])&&cn(h,t.J_(c,l,!0),o,c,l,r,a,u,s)}function nn(a,t,n,u,e,i,r,o,s,c,f){var l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,I,_,i,i,l=B.Util.Mo(e);if(n){for(h=a.a8,d=e&&!1===e.includeStyles,v=X(e),m=u.styleManager,p=(g=e&&e.incrementLoadTask).isBusyFunc,b=!1,w=30,l&&(y=new Date),M=i=i||0,C=n.rowCount,S=n.colCount;M<C;)if(T=n[M]){for(I=(A=a.J_(M,-1,!0))&&A.style,x=void 0,A&&!d&&(v?T.t!==ot?x=m.getOriginNamedStyle(T.t):T.e!==ot&&(x=ut(m.getOriginStyle(T.e))):x=m.getStyle(T.s),A.style=x),A&&T.lossless&&!at(T.lossless.tag)&&(A.tag=T.lossless.tag),h&&j(h.style,M,-1,I,A&&A.style),N=function(t){var n,e,i,r,n,n,o,n=T[t];if(n===ot)return"continue";b=!0,e=a.J_(M,t,!0),r=void 0,i=(r=n).v!==ot?"number"==typeof(n=r.v)?u.sharedStrings.getText(n):n&&(n._calcError||n._error&&!at(n._code)||n.error&&!at(n.code))?D&&R.CalcError.parse(n._calcError||n._error||n.error):n:r.b!==ot?!!r.b:r.o!==ot?"/OADate("+r.o+")/":r.n,at(r.f)&&h&&j(h.data,M,t,e.value,i),at(i)||("object"==typeof i&&0<Object.keys(i).length&&("SparklineExValue"===i.typeName&&"IMAGE"===i.name?i.toString=function(){return i.value.altText+""}:i=Rn(i)),e.value=i),n=e.style,v||(at(r.s)&&(x||f[t])?r.s=0:0!==r.s||x||f[t]||(r.s=ot)),d||(o=void 0,v?r.t!==ot?o=m.getOriginNamedStyle(r.t):r.e!==ot&&(o=ut(m.getOriginStyle(r.e))):o=m.getStyle(r.s),e.style=o),h&&j(h.style,M,t,n,e.style),r.lossless&&(at(r.lossless.bindingPath)||(e.bindingPath=r.lossless.bindingPath),at(r.lossless.tag)||(e.tag=r.lossless.tag),at(r.lossless.altText)||(e.altText=r.lossless.altText)),-1<M&&An(e,i,!!r.f||!!r.g||!!r.si,e.style,s,ot,c)},k=0;k<S;k++)N(k);if(M++,!o&&p&&p())break;if(l&&(I=new Date,!o)&&30<I-y)break}else M++;if(b){if(0!==i&&t.parent.getActiveSheet()===t)for(_=i;_<M;_++)if(t.N8.viewport[1].findRow(_)){t.repaint();break}e.loadStatus.valuesLoad+=M-i,!o&&l&&(i=e.loadStatus.valuesLoad/e.loadStatus.total,i=+(e.fullRecalc?.3*i+.2:.4*i+.2).toFixed(5),e.incrementLoadTask.progress)&&e.incrementLoadTask.progress({progress:i,sheetName:t.name(),step:Q.I5(bt().STEP.loadSheetData,[t.name()])})}M<C?e.incrementLoadTask.pushTask(nn,[a,t,n,u,e,M,r,ot,s,c,f]):o?r():r&&e.incrementLoadTask.pushTask(r,[])}else r&&setTimeout(r,0)}function en(t,n,e,i,r){var i,o,i,e;0<=t&&0<=n&&(i[t]||(i[t]={}),o=(i=i[t])[n],i=null==(i[n]=e)?void 0:e.value,e=null==e?void 0:e.expr,r)&&(j(r,t,n,o&&o.value,i),j(r,t,n,o&&o.expr,e))}function rn(t,n,e,i,r,o,a,u,s){var o,c,o;0<=e&&0<=i?(o[e]||(o[e]={}),c=(o=o[e])[i],o=(o[i]=r)&&r.value,s.a8&&(o&&"SparklineExValue"===o.typeName&&(o=rt),j(s.a8.data,e,i,c&&c.value,o),j(s.a8.style,e,i,c&&c.style,r&&r.style))):0<=e&&-1===i&&0<=t&&-1===n?a[e]=r:0<=i&&-1===e&&0<=n&&-1===t&&(u[i]=r)}function on(t,n,e,i,r,o,a){var o;0<=e&&0<=i&&(o[e]||(o[e]={}),o[e].rs="e",(o=o[e]).originalItem=a,o[i]=r)}function an(t,n,e){var i,r,o,a,u,s,i={};for(r in t)t[r]&&(o=V(r),!isNaN(o))&&n<=o&&(a=t[o],u=t[o+e],s=i[o],u&&(i[o+e]=u),s?t[o+e]=s:(delete t[o],t[o+e]=a))}function un(t,n,e){var i,r,o;for(i in t)t[i]&&(r=Math.floor(i),!isNaN(r))&&n<=r&&(o=t[r],delete t[r],n+e<=r)&&(t[r-e]=o)}function sn(t,n,e,i,r){var o=t.op(),t=t.Uw(),a=n.Uw(),u;o&&t&&a&&r&&(u=o.unparse(a,r,e,i)),n.Ut.setDefaultValue(e,i,u,rt,et.DefaultChangeValueType.Expression,rt,!0)}function r(t,n,e){var i=this;i.Mf=t,i.Sx=n,i.Tx=e,i.defaultCellData={},i.Gve=new nt.BaseUsedRange,i.I8=-1,i.x8=-1}function o(t,n,e,i){var r=this;r.Sx=t,r.Tx=n,at(e)||(r.j8=e),at(i)||(r.O8=i),r.Hc()}function a(){this.infos=[],this.R8=[]}function cn(t,n,e,i,r,o,a,u,s){var c,f,l,l,h,d,v,h,e,a,v,o,d,h;t&&(c=t.value,f=t.formula,c!==ot&&(c!==rt&&(c._calcError||c._error&&!at(c._code))&&(l=D&&R.CalcError.parse(c._calcError||c._error))!==ot&&(c=l=K(l)),at(f)&&a&&j(a.data,i,r,n.value,c),!at(c)&&"object"==typeof c&&0<Object.keys(c).length&&(c=Rn(c)),n.value=c),l=t.style,h=o&&o.sheet,l!==ot&&o&&!o.ignoreStyle&&(d=rt,v=n.style,typeof l===g?(n.style=l,d=h&&(h.i3(l,!1)||h.parent&&h.parent.i3(l,!1))):l&&((d=new tt.Style).fromJSON(l,e),d.name=ot,n.style=d),a&&j(a.style,i,r,v,n.style),d)&&d.validator&&o.setValidator&&o.setValidator(i,r,d.validator),(h=t.visualState)!==ot&&(n.visualState=h),(e=t.bindingPath)!==ot&&(n.bindingPath=e),(a=t.tag)!==ot&&a!==rt&&(typeof(v=a.typeName)===g&&(o=F.getTypeFromString(v))&&(a=new o).fromJSON&&a.fromJSON(t.tag),n.tag=a),(d=t.altText)!==ot&&d!==rt&&(n.altText=d),(h=t.hyperlink)!==ot&&(n.hyperlink=ut(h)),-1<i)&&-1<r&&An(n,c,!!f,l,u,ot,s)}function fn(t,n,e){var i=0<t.P8?[["selectionModel"],ot]:ot;t.selectionModel.setProperty(n,e,i),i&&t.G8.push(i)}function ln(t,n){[t,n].join(",")}function hn(t){return t[0].slice(0,3)}function dn(t){return t[0].slice(3).filter(function(t){return"style"!==t}).join("-")}function vn(t,e){return t.find(function(t){if(t.path.length!==e.length)return!1;for(var n=0;n<=e.length;n++)if(t.path[n]!==e[n])return!1;return!0})}function mn(t,n,e){var i;if(t)return(i=t.caches)||(t.caches=i=E.createMap(),t.forEach(function(t){void 0===t[2]&&i.set(t[0]+","+t[1],1)})),i.has(n+","+e)}function gn(t,n,e,i){var r=t[n];r&&delete r[e],i&&it(r)&&delete t[n]}function pn(t){return t&&t.filter(function(t){return!t.isAutoMerge})}function A(t,n,e,i,r,o){var a,u,u,u,s,u;function c(t,n,e,i){0<a.P8&&a.G8.push([["defaults",e],i,n]),a.Mf.zw()}this.lh={},(a=this).Cpe=this.Spe.bind(this),A.s2e(a.Cpe),a.Mf=t,u=new It(n,e,n,e),a.sheetModels=[ot,new It(i,e,0,0),new It(n,r,0,0),u],u.z8(),(u=a.rowInfos=[])[0]=u[1]=new f,u[2]=u[3]=new f,(u=a.colInfos=[])[0]=u[2]=new f,u[1]=u[3]=new f,a.spanModels=[ot,new wt,new wt,new wt],a.defaultValueModels=[ot,new At(t,i,e),new At(t,n,r),new At(t,n,e)],a.selectionModel=new Ct,(s=a.colHeaderSelectionModel=new Ct).selectionPolicy=1,a.name=o||"",a.isSelected=!1,a.zoomFactor=1,Gt(u=a.defaults={},"rowHeight",20,c),Gt(u,"colWidth",62,c),Gt(u,"rowHeaderColWidth",40,c),Gt(u,"colHeaderRowHeight",m.DEFAULT_COL_HEADER_ROW_HEIGHT,c),Gt(u,"_isExcelDefaultColumnWidth",!1,c),a.P8=0,A.et(this,"init"),a.V8(n,e),a.F8={}}function bn(n,t,e){var i,r,o,a,u,s,i,c,f,l,f,h,r,d,v,m,m,d,r,v,t,m;if(t[0]===mt)wn(t,function(t){bn(n,t,e)});else if("selectionModel"!==(o=(r=-1!==(i=t.indexOf("style"))&&!Array.isArray(t[0]))?t.slice(0,i+1):t[0])[0]){for(a=n,u=0;u<o.length-1;u++)s=o[u],a=s===z?a.B8:(a[s]||(a[s]={}),a[s]);c=o[(i=o.length)-1],f=n.sheetModels[3],l=n.defaultValueModels[3],f=f.a8,h=a[o[u]],r?yn(t,a,e):(r=o[0],d=t[1],v=null,2<t.length&&(v=t[2]),v=e?v:d,r===M||"colInfos"===r||"rowInfos"===r||r===C?e&&v!==a[o[u]]?a[o[u]]=v:e||("bindingPath"===o[u]&&n.Mf.setTemplateCell?(m={row:o[u-2],col:o[u-1],value:d},Dt.et(n,"undoBindingPath",m)):a[o[u]]=d):"spanModels"===r?(a.cache={},a.spans=[],v.forEach(function(t){a.add((0,nt.Ec)(t.row,t.col,t.rowCount,t.colCount))})):(a[o[u]]=t[1],m=void 0,d=o[i-2],r=o[1],"size"===c?m=o[0]===b?et.AxisInfoChangeType.setRowHeight:et.AxisInfoChangeType.setColumnWidth:"visible"===c&&(m=o[0]===b?et.AxisInfoChangeType.setRowVisible:et.AxisInfoChangeType.setColumnVisible),at(m)||n.L8({type:m,index:d,sheetArea:r}))),"style"===c?((v=f&&f.style)&&j(v,o[i-3],o[i-2],h,a[o[u]]),a&&(h&&h.quotePrefix||a.style&&a.style.quotePrefix)&&(h&&h.quotePrefix)!==(a.style&&a.style.quotePrefix)&&An(a,a.value,!!a.formula,a.style,n.F8)):"value"===c?((t=f&&f.data)&&j(t,o[i-3],o[i-2],h,a[o[u]]),a&&h!==a.value&&An(a,a.value,!!a.formula,a.style,n.F8)):c===vt&&(m=l.Gve)&&j(m,o[i-3],o[i-2],h,a[o[u]])}}function wn(t,e){var n,i,r,a,n;t[0]===mt&&(i=t[1],r=t[2],a=function(t,n){"number"==typeof n?t.push(r[n]):(t.push(n.old),t.push(n.new)),e(t)},i.forEach(function(t){var r,o,n,r=t.path,o=t.change,n;Object.keys(o).forEach(function(t){var n,e,i,n=_(_(_([],r,!0),t.split("-").map(function(t){return+t}),!0),["style"],!1),e=o[t];if(Array.isArray(e))for(i=e.length-1;0<=i;i--)a(_([],n,!0),e[i]);else a(n,e)})}))}function yn(t,n,e){var i,r,t,o,i=t.indexOf("style");t.length-i==3?n.style=e?t[i+2]:t[i+1]:(r=t[i+1],t=Object.keys(r),(o=n.style)&&t.forEach(function(t){var n=e?r[t].new:r[t].old;o[t]!==n&&(o[t]=n)}))}function Mn(t,n){return!n&&!at(t)&&"string"==typeof t}function Cn(t,n,e,i){var n;return(!n||!n.quotePrefix)&&(e&&e[t]||(-1!==jt.indexOf(t[0])&&1<t.length&&(Dt.et(ot,"isInvalidFormula",n={value:t,isInvalid:!1,allowDynamicArray:i}),n.isInvalid)?(e&&(e[t]=!0),1):void 0))}function Sn(t){at(t.cellState)||(t.cellState&=~et.CellStatesType.invalidFormula)}function Tn(t){at(t.cellState)&&(t.cellState=0),t.cellState|=et.CellStatesType.invalidFormula}function An(t,n,e,i,r,o,a){at(t)||(Mn(n,e)&&Cn(n,i=o&&i&&"string"==typeof i?xn(i,o):i,r,a=o&&at(a)?o.options.allowDynamicArray:a)?Tn:Sn)(t)}function In(t,n,e){return!(at(t)&&at(n)||("string"==typeof t&&(t=xn(t,e)),"string"==typeof n&&(n=xn(n,e)),(t&&t.quotePrefix)===(n&&n.quotePrefix)))}function xn(t,n){var e,i,r,o,a;if(n){if(e=n.getNamedStyle(t))return e;for(i=0,r=n.sheets;i<r.length;i++)if(a=(o=r[i]).getNamedStyle(t))return a;return rt}}function Nn(t,n){var e,i,t;if("string"==typeof t&&"/OADate"===t.substring(0,7)&&!n.formatter){if((n=at(n)?new tt.Style:n)._autoFormatter)return n.formatter=n._autoFormatter.formatCached,n;e=t.indexOf("("),i=t.indexOf(")"),-1!==e&&-1!==i&&((t=parseInt(t.substring(e+1,i),10))<1?n.formatter="h:mm:ss":1<t&&(n.formatter="M/d/yyyy"))}return n}function kn(t,n){return n=t.renamedStyles&&t.renamedStyles[n]?t.renamedStyles[n]:n}function _n(t,n){var e,i,r;return"object"==typeof n?n:"string"==typeof n?(Ot.test(e=n)&&(i=n.indexOf(Et),e=kn(t,n.substring(i))),(r=t.u8(e))||new tt.Style):void 0}function Dn(t,n,e){e&&jn(n,e=_n(t,e))}function jn(t,n){t.backColor===ot&&n.backColor!==ot&&!1!==n.applyFill&&(t.backColor=n.backColor),!1!==n.applyFont&&(t.foreColor===ot&&n.foreColor!==ot&&(t.foreColor=n.foreColor),t.themeFont===ot&&t.font===ot&&(t.themeFont=n.themeFont),t.spe===ot&&(t.spe=n.spe),t.cpe===ot&&(t.cpe=n.cpe),t.lre===ot&&(t.lre=n.lre),t.lpe===ot&&(t.lpe=n.lpe),t.b2e===ot&&(t.b2e=n.b2e),t.y2e===ot&&(t.y2e=n.y2e),t.w2e===ot&&(t.w2e=n.w2e),t._font=ht(t.spe,t.cpe,t.lre,t.lpe,t.b2e,t.y2e,t.w2e),t.textDecoration===ot)&&n.textDecoration!==ot&&(t.textDecoration=n.textDecoration),!1!==n.applyAlignment&&(t.hAlign===ot&&n.hAlign!==ot&&(t.hAlign=n.hAlign),t.vAlign===ot&&n.vAlign!==ot&&(t.vAlign=n.vAlign),t.textIndent===ot&&n.textIndent!==ot&&(t.textIndent=n.textIndent),t.wordWrap===ot&&n.wordWrap!==ot&&(t.wordWrap=n.wordWrap),t.isVerticalText===ot&&n.isVerticalText!==ot&&(t.isVerticalText=n.isVerticalText),t.shrinkToFit===ot&&n.shrinkToFit!==ot&&(t.shrinkToFit=n.shrinkToFit),t.textOrientation===ot)&&n.textOrientation!==ot&&(t.textOrientation=n.textOrientation),t.formatter===ot&&n.formatter!==ot&&!1!==n.applyNumberFormat&&(t.formatter=n.formatter),!1!==n.applyBorder&&(t.borderLeft===ot&&n.borderLeft!==ot&&(t.borderLeft=On(n.borderLeft)),t.borderTop===ot&&n.borderTop!==ot&&(t.borderTop=On(n.borderTop)),t.borderRight===ot&&n.borderRight!==ot&&(t.borderRight=On(n.borderRight)),t.borderBottom===ot&&n.borderBottom!==ot&&(t.borderBottom=On(n.borderBottom)),t.diagonalUp===ot&&n.diagonalUp!==ot&&(t.diagonalUp=On(n.diagonalUp)),t.diagonalDown===ot)&&n.diagonalDown!==ot&&(t.diagonalDown=On(n.diagonalDown)),t.locked===ot&&!1!==n.applyProtection&&(t.locked=n.locked),t.quotePrefix===ot&&n.quotePrefix!==ot&&(t.quotePrefix=n.quotePrefix)}function On(t){var n;return t&&(n={},at(t.color)||(n.color=t.color),at(t.style)||(n.style=t.style),at(t.level)||(n.level=t.level),n)}function En(t){var n,e,i,n=ut(t);for(e in n)n.hasOwnProperty(e)&&(i=n[e],!at(i)&&"object"==typeof i&&0<Object.keys(i).length?En(i):S.Common.ct.W0(i)&&(n[e]=S.Common.ct.Q0(i)));return n}function Rn(t){var n,e,i,n=ut(t);for(e in n)n.hasOwnProperty(e)&&(i=n[e],!at(i)&&"object"==typeof i&&0<Object.keys(i).length?Rn(i):typeof i===g&&"/"===i.charAt(0)&&(n[e]=nt.util.a2e(i)));return n}c=this&&this.__extends||(Rt=function(t,n){return(Rt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Rt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},v=this&&this.__rest||function(t,n){var e,i,r,e={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},_=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(m,"__esModule",{value:!0}),m.Y8=m.DEFAULT_COL_HEADER_ROW_HEIGHT=m.copyDefaultFormula=m.W8=m.h9=m.Q8=m.K8=m.getOADateNumber=void 0,O=h("./dist/core/core.ns.js"),tt=h("./dist/core/worksheet/style.js"),S=h("Common"),E=h("CalcEngine"),R=h("CalcEngine"),F=h("./dist/core/util/common.js"),nt=h("./dist/core/util/common.js"),t=h("./dist/core/util/domUtil.js"),et=h("./dist/core/core.enum.js"),L=h("./dist/core/celltype/celltype.ns.js"),B=h("./dist/core/excel-io-util/common.js"),st=h("./dist/core/excel-io-util/excel-types.js"),P=h("./dist/core/worksheet/stylehelper.js"),D=!!E,G=t.GC$.each,it=t.GC$.isEmptyObject,U=t.GC$.extend,H=new RegExp("^\\d*(\\.\\d+)?\\*$"),rt=null,ot=void 0,g="string",T=Math.min,V=Math.floor,p=Math.max,I=Math.ceil,z="dirtyNodes",Y="vc",Z="undo",b="rowInfos",w="colInfos",W="default_size",s=S.Common.J8,y=S.Common.X8,at=S.Common.lt.ht,Q=S.Common.zf,J=nt.util.wt,K=nt.util.g0,ct=nt.util.St,X=B.Util.ko,ut=S.Common.lt.tv,q=S.Common.lt.q8,$=200,ft=20,lt="bindingPath",ht=P.W.upe,d=nt.UsedRangeUtil.vh,dt=nt.UsedRangeUtil.hh,j=nt.UsedRangeUtil.updateUsedRangeByData,M="sheetModels",C="defaultValueModels",vt="defaultCellData",mt="style-changes",gt=["borderLeft","borderTop","borderRight","borderBottom","borderHorizontal","borderVertical","diagonalDown","diagonalUp"],pt=["cellButtons","dropDowns"],t=new S.Common.ResourceManager(O.SR,"Sheets"),bt=t.getResource.bind(t),m.getOADateNumber=zt,n.prototype.find=function(t,n){return this.cache[t+"_"+n]||rt},n.prototype.get=function(t,n){return this.find(t,n)||(0,nt.Ec)(t,n,1,1)},n.prototype.remove=function(t,n){var t=this.spans.indexOf(t);0<=t?(n&&(n[0].push("spans"),n[1]=[].concat(this.spans)),this.removeSpan(t,1),n&&(n[2]=[].concat(this.spans))):n&&(n.length=0)},n.prototype.removeSpan=function(t,n){for(var e=0;e<n;e++)Vt(this,this.spans[t+e]);this.spans.splice(t,n)},n.prototype.update=function(t,n){var e=this;Vt(e,e.spans[t]),e.spans[t]=n,Ht(e,n)},n.prototype.add=function(t,n){n&&(n[0].push("spans"),n[1]=[].concat(this.spans)),Ht(this,t),this.spans.push(t),n&&(n[2]=[].concat(this.spans))},n.prototype.tE=function(t,n,e,i,r,o,a,u){var s,s,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,c=this,f=!1;for(a&&(l=[].concat(c.spans)),h=c.spans.length,v=[],d=0;d<h;d++)g=(m=c.spans[d]).col,b=(p=m.row)-t,w=g-n,y=x(m),M=k(m),C=r,S=o,u&&(y=(s=[M,y])[0],M=s[1],b=(s=[w,b])[0],w=s[1],C=(s=[o,r])[0],S=s[1]),(-1===t||t<=p&&p<t+C)&&(-1===n||n<=g&&g<n+S)?(v.push((0,nt.Ec)(T=-1===t?p:e+b,A=-1===n?g:i+w,y,M)),f=!0):(-1===t||e<=p&&p<e+r)&&(-1===n||i<=g&&g<i+o)&&(c.removeSpan(d,1),d--,h--,f=!0);for(d=0;d<v.length;d++){if(!c.nE(c.spans,0,c.spans.length,m=v[d]))throw new Error(bt().Exp_OverlappingSpans);c.add(m)}a&&(f?(a[0].push("spans"),a[1]=l,a[2]=[].concat(c.spans)):a.length=0)},n.prototype.nE=function(t,n,e,i){for(var r=n;r<e&&r<t.length;r++)if(t[r].intersect(i.row,i.col,x(i),k(i)))return!1;return!0},n.prototype.getSpans=function(t){var n,e,i,r,n=this.spans;if(!t)return[].concat(n);for(e=[],i=0;i<n.length;i++)(r=n[i]).intersect(t.row,t.col,x(t),k(t))&&e.push(r);return e},n.prototype.GT=function(t,n,e,i){for(var r,o,a,r=this.spans,o=0;o<r.length;o++)if((a=r[o]).intersect(t,n,e,i)&&(-1!==t&&(a.row<t||a.row+x(a)>t+e)||-1!==n&&(a.col<n||a.col+k(a)>n+i)))return!0;return!1},n.prototype.eE=function(t,n,e,i){for(var r,o,a,u,r=!1,o=this.spans,a=0,u=o.length;a<u;a++){if(0<=t||0<=n)for(;a<u&&!o[a].intersect(t,n,e,i);)a++;if(a<u){r=!0;break}}return r},n.prototype.d5=function(t,n,e,i,r){var o,a,u,s,c,f,c,o=this.spans,a=!1;for(r&&(u=[].concat(o)),s=0;s<o.length;s++)f=(c=o[s]).row,c=c.col,(-1===t||t<=f&&f<t+e)&&(-1===n||n<=c&&c<n+i)&&(this.removeSpan(s,1),s--,a=!0);r&&(a?(r[0].push("spans"),r[1]=u,r[2]=[].concat(this.spans)):r.length=0)},n.prototype.iE=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,u=this,s=!1;for(a&&(c=[].concat(u.spans)),f=[],l=[],h=u.spans.length,g=0;g<h;g++)v=(d=u.spans[g]).row,m=d.col,(-1===t||t<=v&&v<t+r)&&(-1===n||n<=m&&m<n+o)?(p=(0,nt.Ec)(-1===t?v:e+v-t,-1===n?m:i+m-n,x(d),k(d)),l.push(p),s=!0):(-1===t||e<=v&&v<e+r)&&(-1===n||i<=m&&m<i+o)?s=!0:f.push(d);if(s){if(0<l.length)for(g=0;g<l.length;g++){if(!u.nE(f,0,f.length,p=l[g]))throw new Error(bt().Exp_OverlappingSpans);f.push(p)}for(u.spans.length=0,u.cache={},g=0;g<f.length;g++)u.add(f[g]);a&&(a[0].push("spans"),a[1]=c,a[2]=[].concat(u.spans))}else a&&(a.length=0)},n.prototype.rE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,c,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=r.length,s=0;s<u;s++)f=(c=r[s]).row,l=c.col,h=x(c),c=k(c),t<=f?(i.update(s,(0,nt.Ec)(f+n,l,h,c)),o=!0):t<f+h&&(i.update(s,(0,nt.Ec)(f,l,h+n,c)),o=!0);i.suspendUpdatingCache=!1,o&&Ut(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},n.prototype.oE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,c,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=r.length,s=0;s<u;s++)f=(c=r[s]).row,l=c.col,h=x(c),c=k(c),t<=l?(i.update(s,(0,nt.Ec)(f,l+n,h,c)),o=!0):t<l+c&&(i.update(s,(0,nt.Ec)(f,l,h,c+n)),o=!0);i.suspendUpdatingCache=!1,o&&Ut(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},n.prototype.aE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,f,h,v,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=[],s=r.length,c=0;c<s;c++)l=(f=r[c]).row,h=f.col,d=x(f),f=k(f),t<=l?o=(l<t+n?l+d<=t+n?u.push(c):i.update(c,(0,nt.Ec)(t,h,l+d-(t+n),f)):i.update(c,(0,nt.Ec)(l-n,h,d,f)),!0):t<l+d&&(h=(0,nt.Ec)(l,h,d-T(l+d-t,n),f),i.update(c,h),1===h.rowCount&&1===h.colCount&&u.push(c),o=!0);for(c=u.length-1;0<=c;c--)i.removeSpan(v=u[c],1);i.suspendUpdatingCache=!1,o&&Ut(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},n.prototype.uE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,f,l,v,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(e&&(a=[].concat(r)),u=[],s=r.length,c=0;c<s;c++)l=(f=r[c]).row,h=f.col,d=x(f),f=k(f),t<=h?o=(h<t+n?h+f<=t+n?u.push(c):i.update(c,(0,nt.Ec)(l,t,d,h+f-(t+n))):i.update(c,(0,nt.Ec)(l,h-n,d,f)),!0):t<h+f&&(l=(0,nt.Ec)(l,h,d,f-T(h+f-t,n)),i.update(c,l),1===l.rowCount&&1===l.colCount&&u.push(c),o=!0);for(c=u.length-1;0<=c;c--)i.removeSpan(v=u[c],1);i.suspendUpdatingCache=!1,o&&Ut(i,r),e&&(o?(e[0].push("spans"),e[1]=a,e[2]=[].concat(i.spans)):e.length=0)},n.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?ot:t},n.prototype.fromJSON=function(t,n,e){var i,r,o,a,u,a,u;if(t)for(this.spans=[],i=t,r=0;r<i.length;r++)a=x(o=i[r]),u=k(o),a=at(n)?a:T(a,n),u=at(e)?u:T(u,e),this.add((0,nt.Ec)(o.row,o.col,a,u))},wt=n,Yt.prototype.pop=function(){return rt},Yt.prototype.push=function(t){return 0},Yt.prototype.splice=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];return rt},Yt.prototype.slice=function(t,n){return null},(P=Yt).prototype=[],c(Zt,Ft=P),Zt.prototype.find=function(t){for(var n,e,i,r,o,n=this,e=n.length,r=[],o=0;o<e;o++)(i=n[o]).contains(t)&&r.push(i);return r},m.K8=Zt,Wt.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},m.Q8=Wt,e.prototype.getProperty=function(t){return this[t]},e.prototype.setProperty=function(t,n,e){e&&(e[0].push(t),e[1]=this[t],e[2]=n),this[t]=n},e.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},e.prototype.add=function(t,n,e,i,r,o){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var r=this,a=r.selectionPolicy,u=r.selectionUnit;0===a?(e=T(e,1),i=T(i,1),r.clear()):1===a&&r.clear(),1===u?i=n=-1:2===u&&(e=t=-1),r.selections.push((0,nt.Ec)(t,n,e,i)),!1!==o&&(r.activeSelectedRangeIndex=r.selections.length-1)},e.prototype.get=function(){return[].concat(this.selections)},e.prototype.set=function(t,n){n&&(n.push(["selections",this.get()]),n.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},e.prototype.toJSON=function(){var t,n,e,i,r,o,a,t=this,n={},e=t.selectionPolicy,i=t.selectionUnit,r=t.activeSelectedRangeIndex,o=t.selections.length;for(2!==e&&(n.selectionPolicy=e),0!==i&&(n.selectionUnit=i),0!==r&&(n.activeSelectedRangeIndex=r),n.length=o,a=0;a<o;a++)n[a]=t.selections[a];return it(n)?ot:n},e.prototype.fromJSON=function(t,n,e){var i,r,o,a,u,n,e,s,c,f,i=n||200,r=e||20;if(t){for((u=this).clear(),n=t.selectionPolicy,e=t.selectionUnit,s=t.length,at(s)&&(s=1),c=0;c<s;c++)f=t[c],o=T(f?x(f):1,i),a=T(f?k(f):1,r),u.selections.push((0,nt.Ec)(f?f.row:0,f?f.col:0,o,a));u.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,at(n)||(u.selectionPolicy=n),at(e)||(u.selectionUnit=e)}},e.prototype.T9=function(t){for(var n,e,i,r,n=this.selections,e=0;e<n.length;e++)if(r=-1===(i=n[e]).col?0:i.col,-1===i.row&&r<=t&&t<r+k(i))return!0;return!1},e.prototype.S9=function(t){for(var n,e,i,r,n=this.selections,e=0;e<n.length;e++)if(r=-1===(i=n[e]).row?0:i.row,-1===i.col&&r<=t&&t<r+x(i))return!0;return!1},e.prototype.ni=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,v,a=!1,u=this.selections,s=o?1:0,c=0,f=u.length;c<f&&(d=(h=Qt(l=u[c],i,r)).row,v=h.col,d=d-s<=t&&t<d+x(h)+s,v=v-s<=n&&n<v+k(h)+s,3===e||at(e)?a=d&&v:2===e?a=d:1===e?a=v:0===e&&(a=-1===l.row&&-1===l.col),!a);c++);return a},e.prototype.ei=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,s,h,d,c,c,o=this.selections,a=!1,u=0;u<o.length&&(c=(s=o[u]).row,f=s.col,l=x(s),s=k(s),h=-1===f,d=-1===c,at(e)||3===e||(2===e?(c=d?0:c,a=h&&c<=t&&t<c+l):1===e?(c=h?0:f,a=d&&c<=n&&n<c+s):0===e&&(a=d&&h&&l===i&&s===r),!a));u++);return a},Ct=e,c(i,Lt=P),i.prototype.findCell=function(t,n){for(var e,i,r,e=this.length,r=0;r<e;r++)if((i=this[r]).contains(t,n))return i;return rt},i.prototype.sE=function(){this.cE={}},i.prototype.fE=function(t,n){this.cE[t]=n},i.prototype.findRow=function(t){var n,e,i,r,n=this.cE;if(n)return n[t];for(e=this.length,r=0;r<e;r++)if((i=this[r]).row===t)return i;return rt},i.prototype.findCol=function(t){for(var n,e,i,n=this.length,i=0;i<n;i++)if((e=this[i]).col===t)return e;return rt},i.prototype.findLargestRow=function(t){var n,e,i,r,o,n=this.length;if(0===n)return rt;for(r=e=0;r<n;r++)(o=this[r]).row===t&&o.height>e&&(e=o.height,i=r);return q(i)&&this[i]},i.prototype.findLargestCol=function(t){var n,e,i,r,o,n=this.length;if(0===n)return rt;for(r=e=0;r<n;r++)(o=this[r]).col===t&&o.width>e&&(e=o.width,i=r);return q(i)&&this[i]},i.prototype.findLargestRange=function(t,n){var e,i,r,o,a,u,s,c,f,l,e=this.length;if(0===e)return rt;for(i=t.row,r=t.col,o=t.rowCount,a=t.colCount,c=s=0;c<e;c++)if(n)for(f=t.row;f<i+o;f++)(l=this[c]).row===f&&l.height>s&&(s=l.height,u=c);else for(f=t.col;f<r+a;f++)(l=this[c]).col===f&&l.width>s&&(s=l.width,u=c);return q(u)&&this[u]},i.prototype.findX=function(t,n){return Jt(this,ot,ot,t,ot,n)},i.prototype.findY=function(t){return Jt(this,ot,ot,ot,t)},i.prototype.findNearX=function(t){return Kt(this,t)},i.prototype.findNearY=function(t){return Kt(this,ot,t)},i.prototype.findXByExactY=function(t,n,e){var i,t,r,o,a,u,i=this.findX(t,!0);if(!Array.isArray(i))return i;for(t=i.length,r=e.y,o=e.height,a=t-1;0<=a;a--)if(n>r+(u=i[a]).y*o)return u},m.h9=i,Xt.prototype.contains=function(t,n){var e=this;return t<e.row+x(e)&&e.row<=t&&n<e.col+k(e)&&e.col<=n},Xt.prototype.intersect=function(t){var n=this;return(n.x<0||t.x<n.x+n.width&&n.x<t.x+t.width)&&(n.y<0||t.y<n.y+n.height&&n.y<t.y+t.height)},Xt.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},Xt.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},m.W8=Xt,m.copyDefaultFormula=sn,r.prototype.dispose=function(){this.Mf=rt,this.defaultCellData=rt},r.prototype.getRowCount=function(){return this.Sx},r.prototype.setRowCount=function(t){this.Sx=t},r.prototype.getColumnCount=function(){return this.Tx},r.prototype.setColumnCount=function(t){this.Tx=t},r.prototype.X1e=function(t,n,e,i,r,o){var a;n&&(a=void 0,t&&(a=o===et.DefaultChangeValueType.Expression?t.expr:t.value),n[0].push(vt,e,i,o),n[1]=at(a)?rt:a,n[2]=r)},r.prototype.Uve=function(t,n){var e=this;e.x8<n&&(e.x8=n),e.I8<t&&(e.I8=t)},r.prototype.q1e=function(t,n){var e,t=this.defaultCellData[t],i;return i=at(t)?i:t[n]},r.prototype.getValue=function(t,n){var e=this,i;return t<e.Sx&&n<e.Tx&&(i=0<=t&&0<=n?e.q1e(t,n):i)&&!at(i.value)?i.value:rt},r.prototype.setValue=function(t,n,e,i,r){var o,a,o,u,r,a=this;t<a.Sx&&n<a.Tx&&0<=t&&0<=n&&(u=(o=a.defaultCellData)[t],at(u)&&(u=o[t]={}),e=nt.util.Z0(e),a.X1e(u[n],r,t,n,e,et.DefaultChangeValueType.Value),i?(u[n]||(u[n]={}),u[n].value=e):(r=null==(o=u[n])?void 0:o.value,u[n]&&u[n].expr&&a.$1e(t,n,rt),u[n]={value:e},a.Uve(t,n),a.Gve&&j(a.Gve,t,n,r,e)))},r.prototype.getFormulaFromExpression=function(t,n,e){var t,i,r,o,i,i=this;if(t)return o=void 0,(r=h("SheetsCalc"))&&((i=i.Mf).vle=!0,o=r.expressionToFormula(i,t,n,e,(null==(t=i.parent)?void 0:t.options.referenceStyle)===r.ReferenceStyle.r1c1),delete i.vle),nt.util.g1(o)},r.prototype.getFormula=function(t,n){var e,i,i,e=this;return t<e.Sx&&n<e.Tx&&(i=0<=t&&0<=n?e.q1e(t,n):i)&&i.expr?(i=i.expr,e.getFormulaFromExpression(i,t,n)):rt},r.prototype.getExpression=function(t,n){var e=this,i;return t<e.Sx&&n<e.Tx?(i=0<=t&&0<=n?e.q1e(t,n):i)&&i.expr:rt},r.prototype.$1e=function(t,n,e,i,r,o){var a,u,s,a,c,a=this,u,s=a.defaultCellData[t];if(s&&s[n]&&s[n].expr&&(c=(a=a.Mf).op()))try{a.vle=!0,o&&(s[n].value=rt,i=s[n].expr),a.zI(t,n,e,i,!1,r,!0,!0)}finally{delete a.vle}},r.prototype.setFormula=function(t,n,e,i,r,o){var a,u,s,c,f,s,l,a,s,u=this;t<u.Sx&&n<u.Tx&&0<=t&&0<=n&&(c=(s=u.defaultCellData)[t],f=void 0,(c=at(c)?s[t]={}:c)[n]||(c[n]={}),e&&((s=h("SheetsCalc"))&&(a=(null==(a=(l=u.Mf).parent)?void 0:a.options.referenceStyle)===s.ReferenceStyle.r1c1,f=s.formulaToExpression(l,e,t,n,a,!0),e=s.expressionToFormula(l,f,t,n,a)),e=nt.util.g1(e)),u.X1e(c[n],o,t,n,f,et.DefaultChangeValueType.Expression),s=c[n].expr,c[n].expr=f,u.Uve(t,n),u.Gve&&j(u.Gve,t,n,s,f),D?r||u.$1e(t,n,e,f,i):(u.X1e(c[n],o,t,n,e,et.DefaultChangeValueType.Value),c[n].value=e))},r.prototype.resetFormulaToCalc=function(t,n,e,i,r){var o=this,a=o.Sx,u=o.Tx,s,c;if(0<=t&&0<=n&&(e=T(e,a-t),i=T(i,u-n),0<e)&&0<i)for(c=t;c<t+e;c++)for(s=n;s<n+i;s++)o.$1e(c,s,rt,rt,r,!0)},r.prototype.gle=function(){return this.defaultCellData},r.prototype.ble=function(t){var n,e,i,r;if(t)for(n in t)if(t.hasOwnProperty(n)&&(e=t[n]))for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&r.expr&&(r.oldRow=n,r.oldCol=i)},r.prototype.hE=function(t){var n,e=this.Gve,i={};if(!at(e))return t&et.UsedRangeType.data&&d(i,e.getUsedRange()),i},r.prototype.rE=function(t,n){var e,i,r,e=this,i=e.Sx;0<=t&&t<=i&&0<=n&&(r=e.defaultCellData,e.ble(r),s(r,i,t,n),e.Sx+=n,e.Gve)&&this.Gve.addHeadInfo(t,n,!0)},r.prototype.yE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=this,r=i.Sx;if(0<=t&&t<r&&0<n){if(r<t+n&&(n=r-t),o=i.defaultCellData,e)for(a=0;a<n;a++)e.push([[vt,u=t+a],o[u]]);if(i.Gve){for(c=(s=t)+n,f=i.defaultCellData,l=void 0;s<c;s++)if(f[s])for(h=0;h<i.Tx;h++)!(l=f[s]&&f[s][h])||at(l.value)&&!l.expr||i.Gve.removeRowAndColInfo(s,h);i.Gve.removeHeadInfo(t,n,!0)}i.ble(o),y(o,r,t,n),i.Sx-=n}},r.prototype.oE=function(t,n){var e,i,r,o,a,e=this,i=e.Tx;if(0<=t&&t<=i&&0<=n){for(r=e.defaultCellData,e.ble(r),o=0;o<e.Sx;o++)(a=r[o])&&t<i&&s(a,i,t,n);e.Tx+=n,e.Gve&&e.Gve.addHeadInfo(t,n,!1)}},r.prototype.wE=function(t,n,e){var i,r,o,a,u,s,c,f,i=this,r=i.Tx;if(0<=t&&t<r&&0<n){for(o=i.defaultCellData,a=void 0,i.ble(o),u=0;u<i.Sx;u++)if(s=o[u]){if(e)for(c=0;c<n;c++)a=s[f=t+c],e.push([[vt,u,f],a]),a&&i.Gve&&(at(a.value)&&!a.expr||i.Gve.removeRowAndColInfo(u,f));y(s,r,t,n)}i.Tx-=n=r<t+n?r-t:n,i.Gve&&i.Gve.removeHeadInfo(t,n,!1)}},r.prototype.SE=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,r;r&&(o=[[C,3],ot],a=[[C,3],ot],u=[[C,3],ot],s=[[C,3],ot],r.push(o,a,u,s)),f=(c=this).defaultCellData,l=c.q1e(t,n),h=c.q1e(e,i),r&&(c.X1e(l,o,t,n,h.value,et.DefaultChangeValueType.Value),c.X1e(h,a,e,i,l.value,et.DefaultChangeValueType.Value),c.X1e(l,u,t,n,h.expr,et.DefaultChangeValueType.Expression),c.X1e(h,s,e,i,l.expr,et.DefaultChangeValueType.Expression)),r=c.Gve,l?en(e,i,l,f,r):h&&en(e,i,rt,f,r),h?en(t,n,h,f,r):l&&en(t,n,rt,f,r)},r.prototype.fromJSON=function(t){var o,a,u,n,e;if(t)for(a in(o=this).defaultCellData={},t)if(t.hasOwnProperty(a)&&(u=t[a]))for(e in n=function(t){var n,e,i,r;if(!u.hasOwnProperty(t)||!u[t])return"continue";try{n=u[t],e=+a,i=+t,n.f&&o.setFormula(e,i,nt.util.n1(n.f),ot,!0),r=n.v,at(r)||(r.error&&!at(r.code)||r._calcError&&!at(r._code)?r=D&&R.CalcError.parse(r.error||r._calcError):"SparklineExValue"===r.typeName&&(r.toString=function(){return r.value&&!at(r.value.altText)?r.value.altText+"":""}),o.setValue(e,i,r,!!n.f))}catch(t){}},u)n(e)},r.prototype.toJSON=function(t){var n,e,i,r,o,a,u,s,c,s,c,n=this,e=n.defaultCellData,i={};if(e)for(r in e)if(e.hasOwnProperty(r)&&(o=e[r]))for(a in i[r]||(i[r]={}),o)o.hasOwnProperty(a)&&(u=o[a])&&(at(u.value)||(c=s=u.value,t&&(s&&s instanceof Date?c=s.toISOString():at(s._error)&&at(s._code)||(c={error:s._error,code:s._code})),i[r][a]={v:c}),s=u.expr)&&(i[r][a]||(i[r][a]={}),c=n.getFormulaFromExpression(s,+r,+a),i[r][a].f=nt.util.vo(c));return i},r.prototype.yh=function(t){this.fromJSON(t)},r.prototype.wh=function(t){var n;if(X(t))return this.toJSON(!0)},At=r,o.prototype.Hc=function(){var t=this;t.dataTable={},t.rowDataArray=[],t.columnDataArray=[],t.defaultDataNode=rt,t.B8={},t.lE=0,t.x8=-1,t.I8=-1},o.prototype.z8=function(){var t;this.a8={data:new nt.BaseUsedRange,style:new nt.BaseUsedRange}},o.prototype.hE=function(t){var n,e=this.a8,i={};if(!at(e))return t&et.UsedRangeType.data&&d(i,e.data.getUsedRange()),t&et.UsedRangeType.style&&d(i,e.style.getUsedRange()),t&et.UsedRangeType.rowStyle&&d(i,e.style.getRowUsedRange()),t&et.UsedRangeType.colStyle&&d(i,e.style.getColUsedRange()),i},o.prototype.getRowCount=function(){return this.Sx},o.prototype.getColumnCount=function(){return this.Tx},o.prototype.setRowCount=function(t){this.Sx=t},o.prototype.setColumnCount=function(t){this.Tx=t},o.prototype.getFreeAreaRowCount=function(){return this.j8},o.prototype.getFreeAreaColumnCount=function(){return this.O8},o.prototype.setFreeAreaRowCount=function(t){this.j8=t},o.prototype.setFreeAreaColumnCount=function(t){this.O8=t},o.prototype.dE=function(t,n,e,i,r){var o,a,u,o,u,o,a,t,o=this,a=o.B8;if(!(0<o.lE)){if(o=t+"_"+n,(u=this.B8.vE)&&u[o]){if(u[o].oldCalcValue===e.mE)return;delete u[o]}0<=t&&0<=n&&(i&&(i.type="updateDirty",i.row=t,i.col=n,i.skipUndo=r,a[t]?a[t][n]||(i.isEmptyCol=!0):i.isEmptyRow=!0),a[t]||(a[t]={}),(u=a[t])[n]||(u[n]={}),o=u[n],"n"!==u.rs&&(u.rs="e"),a=e.gE,t=e.d6,at(a)||(i&&(i.originalItem=u.originalItem),u.originalItem=a),at(t)||(i&&(i.oldValue=o.oldValue,r)&&(i.oldCalcValue=t),o.oldValue=t))}},o.prototype.pE=function(t){var n,e,i,n=this.B8,e=t.row,i=t.col;t.skipUndo&&(this.B8.vE=this.B8.vE||{},this.B8.vE[e+"_"+i]=t),t.isEmptyRow&&n?delete n[e]:t.isEmptyCol&&n[e]?delete n[e][i]:(t.hasOwnProperty("originalItem")&&(at(t.originalItem)&&!at(n[e].originalItem)?delete n[e].originalItem:n[e].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&n[e]&&(at(t.oldValue)&&!at(n[e][i].oldValue)?delete n[e][i].oldValue:n[e][i].oldValue=t.oldValue))},o.prototype.getValue=function(t,n,e){var t=this.J_(t,n);return t&&!at(t.value)?1!==e?J(t.value):at(t.value.richText)?t.value:U(!0,{},t.value):rt},o.prototype.setValue=function(t,n,e,i,r,o){var a,u,a=this.J_(t,n,!0,i?i[0]:ot);!a||at(a.value)&&at(e)||a.value===e?i&&(i.length=0):(u=a.value,a.value=e,this.dE(t,n,{d6:u,mE:e},r,o),i&&(i[0].push("value"),i[1]=u,i[2]=e),this.a8&&(e&&"SparklineExValue"===e.typeName&&("IMAGE"===e.name&&(a.altText=e.value&&e.value.altText),e=rt),j(this.a8.data,t,n,u,e)))},o.prototype.getStyle=function(t,n,e){var t,n,t=this.J_(t,n),n=t&&t.style;return n=n&&e&&n.clone?n.clone(!0):n},o.prototype.setStyle=function(t,n,e,i,r,o){var a,u,a,r,a=this.J_(t,n,!0,i?i[0]:ot);a&&a.style!==e?(u=a.style,a.style=e,i&&(i[0].push("style"),a=function(){i.push(u),i.push(e)},r&&o&&u&&e&&"object"==typeof u&&"object"==typeof e&&this.HCe(u)&&this.HCe(e)&&-1!==(r=this.LCe(i,u,e,r,o))?i.push(r):a()),this.a8&&j(this.a8.style,t,n,u,e)):i&&(i.length=0)},o.prototype.HCe=function(t){return!(t.cellButtons&&t.cellButtons.some(function(t){return t.command&&"function"==typeof t.command})||t.dropDowns&&t.dropDowns.some(function(t){return t.submitCommand&&"function"==typeof t.submitCommand}))},o.prototype.FCe=function(t,n){var e,n,t,e,n=vn(n,hn(t)),t=dn(t);return n&&n.change[t]!==ot?n.change[t]:null},o.prototype.LCe=function(t,n,e,i,r){var t,o,a,i,u,s,i,t=this.FCe(t,i);return t!==rt&&"number"!=typeof t?-1:(o=function(t,n,e){var i,r;return gt.includes(e)&&t&&n?t.color===n.color&&t.style===n.style&&t.level===n.level:pt.includes(e)&&t&&n?JSON.stringify(t)===JSON.stringify(n):t===n},a=Object.keys(n),i=Object.keys(e).filter(function(t){return!a.includes(t)}),u={},a.forEach(function(t){"_id"===t||o(n[t],e[t],t)||(u[t]={old:n[t],new:e[t]})}),i.forEach(function(t){u[t]={old:void 0,new:e[t]}}),t!==rt&&"number"==typeof t&&r[t]&&this.BCe(r[t],u),s=Object.keys(u),-1!==(i=r.findIndex(function(n){return s.every(function(t){return n[t]&&o(n[t].old,u[t].old,t)&&o(n[t].new,u[t].new,t)})}))?i:(r.push(u),r.length-1))},o.prototype.BCe=function(n,e){var t;Object.keys(n).forEach(function(t){e[t]?e[t].old=n[t].old:e[t]=n[t]})},o.prototype.getCellState=function(t,n){var t=this.J_(t,n);return t?t.cellState:rt},o.prototype.setCellState=function(t,n,e,i){var i,r,o=this.getCellState(t,n)||0,i=i?o|e:o&~e;0!==i?(r=this.J_(t,n,!0,ot,!0))&&(r.cellState=i):((r=this.J_(t,n))&&delete r.cellState,it(r)&&(gn(this.dataTable,t,n),it(this.dataTable[t]))&&delete this.dataTable[t])},o.prototype.getValueForKey=function(t,n,e){var t=this.J_(t,n);return t&&t[e]},o.prototype.setValueForKey=function(t,n,e,i,r){var o,a,o=this.J_(t,n,!0,r?r[0]:ot);o&&o[e]!==i?(a=o[e],o[e]=i,r&&(r[0].push(e),r[1]=a,r[2]=i),this.bE(t,n,e,a,i)):r&&(r.length=0)},o.prototype.bE=function(t,n,e,i,r){var o,a=this.a8;e===lt&&a&&j(a.data,t,n,i,r)},o.prototype.rE=function(t,n,e){var i,r,o,a,u,i=this,r=i.Sx,o=i.dataTable,a=i.B8;if(0<=t&&t<=r&&0<=n){if(s(o,r,t,n),s(i.rowDataArray,r,t,n),s(a,r,t,n),i.Sx+=n,!e)for(u=0;u<n;u++)o[t+u]={rs:"n"},a[t+u]={rs:"n"};this.a8&&(this.a8.data.addHeadInfo(t,n,!0),this.a8.style.addHeadInfo(t,n,!0))}},o.prototype.yE=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.Sx;if(0<=t&&t<r&&0<n){if(r<t+n&&(n=r-t),e)for(o=0;o<n;o++)e.push([["dataTable",a=t+o],i.dataTable[a]]),e.push([["rowDataArray",a],i.rowDataArray[a]]),e.push([[z,a],i.B8[a]]);if(this.a8){for(s=(u=t)+n,c=i.dataTable,f=void 0;u<s;u++)if(c[u])for(l=0;l<i.Tx;l++)(f=c[u]&&c[u][l])&&(at(f.value)&&at(f.bindingPath)||this.a8.data.removeRowAndColInfo(u,l),f.style)&&this.a8.style.removeRowAndColInfo(u,l);this.a8.data.removeHeadInfo(t,n,!0),this.a8.style.removeHeadInfo(t,n,!0)}y(i.dataTable,r,t,n),y(i.rowDataArray,r,t,n),y(i.B8,r,t,n),i.Sx-=n}},o.prototype.oE=function(t,n){var e,i,r,o,a,a,e=this,i=e.Tx,r=e.B8;if(0<=t&&t<=i&&0<=n){for(o=0;o<e.Sx;o++)(a=e.dataTable[o])&&t<i&&(s(a,i,t,n),a=r[o])&&an(a,t,n);s(e.columnDataArray,i,t,n),e.Tx+=n,this.a8&&(this.a8.data.addHeadInfo(t,n,!1),this.a8.style.addHeadInfo(t,n,!1))}},o.prototype.wE=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,i=this,r=i.Tx,o=i.B8,a=i.dataTable;if(0<=t&&t<r&&0<n){for(s=0;s<i.Sx;s++)if(c=i.dataTable[s]){if(e)for(f=0;f<n;f++)e.push([["dataTable",s,l=t+f],c[l]]),i.B8[s]&&e.push([[z,s,l],i.B8[s][l]]),(u=a[s]&&a[s][l])&&this.a8&&(at(u.value)&&at(u.bindingPath)||this.a8.data.removeRowAndColInfo(s,l),u.style)&&this.a8.style.removeRowAndColInfo(s,l);y(c,r,t,n),un(h=o[s],t,n)}if(e)for(d=0;d<n;d++)e.push([["columnDataArray",v=t+d],i.columnDataArray[v]]);y(i.columnDataArray,r,t,n),i.Tx-=n=r<t+n?r-t:n,this.a8&&(this.a8.data.removeHeadInfo(t,n,!1),this.a8.style.removeHeadInfo(t,n,!1))}},o.prototype.ME=function(t,n,e,i){var r=this,o=t[n];return e&&(o=o||(t[n]={}),!i)&&n>r.I8&&(r.I8=n),o},o.prototype.CE=function(t,n,e,i){var r,o;if(t)return r=this,o=t[n],e&&(o=o||(t[n]={}),!i)&&r.x8<n&&(r.x8=n),o},o.prototype.J_=function(t,n,e,i,r){var o,a,u,s,c,a,o=this,a=o.dataTable,u=o.columnDataArray,s=o.rowDataArray,c=rt;return t<o.Sx&&n<o.Tx&&(0<=t&&0<=n?(a=o.ME(a,t,e,r),c=o.CE(a,n,e,r),i&&i.push("dataTable",t,n)):-1===t&&0<=n?(c=u[n],e&&(c=c||(u[n]={}),!r)&&o.x8<n&&(o.x8=n),i&&i.push("columnDataArray",n)):0<=t&&-1===n?(c=s[t],e&&(c=c||(s[t]={}),!r)&&o.I8<t&&(o.I8=t),i&&i.push("rowDataArray",t)):-1===t&&-1===n&&(c=o.defaultDataNode,e&&!c&&(c=o.defaultDataNode={}),i)&&i.push("defaultDataNode")),c},o.prototype.setNode=function(t,n,e){var i,r,o,a,u,i=this,r=i.dataTable,o=i.columnDataArray,a=i.rowDataArray;t<i.Sx&&n<i.Tx&&(0<=t&&0<=n?(u=(u=r[t])||(r[t]={}))[n]=e:-1===t&&0<=n?o[n]=e:-1===n&&0<=t&&(a[t]=e))},o.prototype.SE=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p;r&&(o=[],a=[]),s=(u=this).dataTable,c=u.rowDataArray,f=u.columnDataArray,l=u.B8,h=u.J_(t,n,ot,o),d=l[t]&&l[t][n],v=l[t]&&l[t].originalItem,m=u.J_(e,i,ot,a),g=l[e]&&l[e][i],p=l[e]&&l[e].originalItem,r&&(r.push([o,h]),r.push([a,m])),h?rn(t,n,e,i,h,s,c,f,u):m&&rn(t,n,e,i,rt,s,c,f,u),m?rn(e,i,t,n,m,s,c,f,u):h&&rn(e,i,t,n,rt,s,c,f,u),d?on(t,n,e,i,d,l,v):g&&on(t,n,e,i,rt,l,v),g?on(e,i,t,n,g,l,p):d&&on(e,i,t,n,rt,l,p)},o.prototype.gT=function(t){t++;for(var n=this.Sx,e=this.dataTable;0<=t&&t<n&&!e[t];)t++;return t<n?t:-1},o.prototype.pT=function(t,n){var e,i,r,e=this,i=rt,r=e.Tx;if(i=0<=t&&t<e.Sx?e.dataTable[t]:i){for(n++;0<=n&&n<r&&!i[n];)n++;if(n<r)return n}return-1},o.prototype.TE=function(t,n,e){var e=e&&e.getFormatter(t,n);return!!ct(e)&&e},o.prototype.clear=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,u=this,s=u.Sx,c=u.Tx,f=[],l=[],m=!!a,g=[];if(0<=t&&0<=n){if(e=T(e,s-t),i=T(i,c-n),0<e&&0<i)for(v=t;v<t+e;v++)if(!o||S.Common.Uf.hD(o,v)<0)for(d=n;d<n+i;d++)m&&(p=[]),(h=u.J_(v,d,ot,p))&&(f.push(h),l.push({r:v,c:d}),m&&g.push(p),0<(1&r))&&!at(h.value)&&(b=m?{}:void 0,u.dE(v,d,{d6:h.value},b),b)&&a.push(b)}else if(0<=t&&-1===n){if(0<(e=T(e,s-t)))for(v=t;v<t+e;v++)m&&(p=[]),(h=u.J_(v,-1,ot,p))&&(f.push(h),l.push({r:v,c:d}),m)&&g.push(p)}else if(-1===t&&0<=n){if(0<(i=T(i,c-n)))for(d=n;d<n+i;d++)m&&(p=[]),(h=u.J_(-1,d,ot,p))&&(f.push(h),l.push({r:v,c:d}),m)&&g.push(p)}else-1===t&&-1===n&&(m&&(p=[]),h=u.J_(-1,-1,ot,p))&&(f.push(h),l.push({r:v,c:d}),m)&&g.push(p);for(u.a8&&(w=u.a8.style,y=u.a8.data),M=function(e){var t;(h=f[e])&&(t=m?[]:ot,0<(8&r)&&(t&&t.push(["tag",h.tag]),h.tag=rt),0<(2&r)&&(t&&t.push(["style",h.style]),w&&j(w,l[e].r,l[e].c,h.style,rt),h.style=rt),0<(1&r)&&(t&&t.push(["value",h.value]),y&&j(y,l[e].r,l[e].c,h.value,rt),h.value=rt),0<(16&r)&&(t&&t.push(["sparkline",h.sparkline]),h.sparkline=rt),0<(64&r)&&(t&&t.push(["bindingPath",h.bindingPath]),y&&j(y,l[e].r,l[e].c,h.bindingPath,rt),h.bindingPath=rt),0<(256&r)&&(t&&t.push(["hyperlink",h.hyperlink]),h.hyperlink=rt),0<(4&r)&&(t&&t.push(["comment",h.comment]),h.comment=rt),0<(512&r)&&(t&&t.push(["altText",h.altText]),h.altText=rt),m)&&t.forEach(function(t){var n=[].concat(g[e]);n.push(t[0]),t[0]=n,a.push(t)})},C=0;C<f.length;C++)M(C)},o.prototype.toJSON=function(t,f,l){var h,n,e,i,r,o,a,u,s,c,d,v,m,g,p,b,w,y,M,C,S,T,A,I,t;function x(t,n,e,i,r,o){var a,u,s,s,o,t,c,n,s,o,t,i,r;return e&&(u=!(a={}),s=e.value,at(s)||(a.value=s,u=!0),f&&f.saveAsView&&(s=void 0,o?s=o:h&&(s=l&&l.getFormatter(t,n)),s)&&ct(s)&&(o=l.Oe(t,n,i,s),at(o)||(a.value=o,u=!0)),!at(t=a.value)&&"object"==typeof t&&0<Object.keys(t).length&&(a.value=En(t)),(c=f&&f.ignoreStyle)||(n=e.style)&&!it(n)&&("string"==typeof n?(a.style=n,u=!0):(s=n.toJSON(i,r))&&(s.name=ot,s.fontForColumnWidth=n.fontForColumnWidth,a.style=s,u=!0)),o=e.bindingPath,at(o)||(a.bindingPath=o,u=!0),t=e.tag,at(t)||(a.tag=t,u=!0),i=e.altText,at(i)||(a.altText=i,u=!0),r=e.hyperlink,at(r)||(a.hyperlink=ut(r),delete a.hyperlink.isVisited,u=!0),!0===u)?a:rt}if(h=l&&l.parent&&!it(l.parent.bp),e={},i={},r=(n=this).Sx,o=n.Tx,a=n.dataTable,u=n.rowDataArray,s=n.columnDataArray,f&&f.saveAsView)for(v=0,m=3===t&&h;v<r;){if((g=a[v])||m){for(b=!(p={}),w=0;w<o;)y=void 0,g&&g[w]?y=x(v,w,g[w]):m&&(M=this.TE(v,w,l))&&(g=g||n.ME(a,v,!0),y=x(v,w,n.CE(g,w,!0),3,!1,M)),at(y)||(p[w]=y,b=!0),w++;b&&(i[v]=p)}v++}else for(c=n.gT(-1);0<=c;){for(b=!(p={}),d=n.pT(c,-1);0<=d;)(C=n.J_(c,d))&&(y=x(c,d,C),it(y)||(p[d]=y,b=!0)),d=n.pT(c,d);b&&(i[c]=p),c=n.gT(c)}for(it(i)||(e.dataTable=i),S=[],c=0;c<r;c++)N(u,c)&&u[c]&&(T=x(c,-1,u[c]),it(T)||(S[c]=T));for(0<S.length&&(e.rowDataArray=S),A=[],d=0;d<o;d++)N(s,d)&&s[d]&&(I=x(-1,d,s[d]),it(I)||(A[d]=I));return 0<A.length&&(e.columnDataArray=A),t=x(-1,-1,n.defaultDataNode,t,!0),it(t)||(e.defaultDataNode=t),e},o.prototype.fromJSON=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,o,u=e&&e.incrementalLoading;if(t){if((s=this).Hc(),s.lE++,c=t.dataTable,h=s.Sx,d=s.Tx,c?u&&3===o?$t(s,c,h,d,e,n,ot,a,s.a8,i,r):tn(s,c,h,d,e,n,s.a8,i,r):u&&a&&setTimeout(a,0),g=t.rowDataArray||t.AE)for(f=0;f<h;f++)N(g,f)&&g[f]&&cn(g[f],s.J_(f,-1,!0),n,f,-1,e,s.a8);if(p=t.columnDataArray||t.IE)for(l=0;l<d;l++)N(p,l)&&p[l]&&cn(p[l],s.J_(-1,l,!0),n,-1,l,e,s.a8);(o=t.defaultDataNode||t.xE)&&cn(o,s.J_(-1,-1,!0),n,-1,-1,e,s.a8),s.lE--}else u&&a&&setTimeout(a,0)},o.prototype.wh=function(t,F,n,L,e,i){var r,B,P,G,U,H,V,o,z,a,Y,u,i,a,s,i,c,Z,f,l,h,d,v,m,g,m,W,p,b,w,y,y,M,C,S,T,Q,A,I,x,N,k,_,D,j,O,J,K,X,q,j,E,R,E,$,D,r=this,B=0,P=0,G=r.Sx,U=r.Tx,H=r.dataTable,V=[],o=i&&!1===i.includeStyles,z=i&&i.saveAsView,a=i&&!1===i.includeEmptyRegionCells,Y=t&&t.parent&&!it(t.parent.bp),u=i&&i.fileType===et.OpenSaveFileType.excel;for(a&&(i=et.UsedRangeType.all-et.UsedRangeType.colStyle-et.UsedRangeType.rowStyle-et.UsedRangeType.style-et.UsedRangeType.axis,a=t.getUsedRange(i))&&(B=a.row,P=a.col,-1!==a.rowCount&&(G=a.row+a.rowCount),-1!==a.colCount)&&(U=a.col+a.colCount),i={sheetData:s={n_:st.XFileConstants.bo,rowCount:r.Sx,colCount:r.Tx},hyperlinks:V},c=!t.NMi&&t.getDefaultStyle(3),Object.keys(F).forEach(function(t){var n,e,i,n,t,n=F[t],e=n&&n.size,i=!at(e)&&e!==L,n=n&&!1===n.visible?1:ot;!0!=i&&!n||((t=s[t]={}).h=i&&e!==ot?+nt.SJSColumnWidthHelper.pixelToPoint(e).toFixed(2):ot,t.v=n)}),Z=u?t.Ut.yle().gle():{},f=B;f<G;f++){if(l=s[f]||{r:f+1},h=H[f],d=Z[f],v=void 0,g=(m=r.J_(f,-1))&&m.style,at(g)||o||(u?("string"==typeof g&&0===g.indexOf(n.Jd)&&(m=g,g=(g=t.i3(m,!1))||(W=t.parent)&&W.i3(m,!1)),l.s=n.getStyleIndex(g)):"string"==typeof g?l.t=n.getOriginNamedStyleIndex(g,t):g!==ot&&(l.e=n.getOriginStyleIndex(g,t)),v=!0),h||d){for(p=P;p<U;p++){if(w={},!(b=h&&h[p]))if(d&&d[p])b=d[p];else if(!u||!t.tables.find(f,p))continue;if(b&&(at(b.tag)||(w.tag=b.tag),at(b.altText)||(w.altText=b.altText),y=b.bindingPath,at(y)||(w.bindingPath=y)),y=r.getStyle(-1,p,!0),M=rt,N=null==b?void 0:b.value,k=r.getStyle(f,p,!(x=I=A=Q=T=S=C=void 0)),_=null==b?void 0:b.hyperlink,at(N)&&d&&d[p]&&(N=d[p].value),D=!1,z&&(!(j=r.TE(f,p,t))&&Y&&(j=t.getFormatter(f,p)),ct(j))&&(O=t.Oe(f,p,3,j),!at(O))){switch(J=typeof O){case"boolean":T=O?1:0;break;case"string":x=X=(K=zt(O,e)).OADateNumber,C=q=K.valueIndex;break;case"object":C=O instanceof Date?(O=nt.util.Z0(O),k.formatter="M/d/yyyy",e.getTextIndex(O)):O;break;default:S=isFinite(O)?O:ot}D=!0}if(!o)if(u){if(j=_||"string"==typeof N&&"/OADate"===N.substring(0,7)||N!==rt&&void 0!==N&&(y||g),k?M=_n(t,k):j?M=new tt.Style:(y||g)&&(E=t.getValue(f,p),at(E)||(M=new tt.Style)),M){if(M.parentName)for((R=_n(t,M.parentName))&&Dn(t,M,R);R&&R.parentName;)(R=_n(t,R.parentName))&&Dn(t,M,R);g&&Dn(t,M,g),y&&Dn(t,M,y),c&&Dn(t,M,c),M=Nn(N,M)}}else"string"==typeof k?A=n.getOriginNamedStyleIndex(k,t):k!==ot&&(I=n.getOriginStyleIndex(k,t));if(at(N)&&(A===ot&&I===ot&&at(M)||o)&&at(_))it(w)||(l[p]={lossless:w},v=!0);else{if(v=!0,!D&&!at(N))switch("object"==(E=typeof N)&&0<Object.keys(N).length&&(N=En(N)),E){case"boolean":T=N?1:0;break;case"string":x=X=($=zt(N,e)).OADateNumber,C=q=$.valueIndex;break;case"object":C=N&&N.richText?e.getTextIndex(N):N&&N instanceof Date?e.getTextIndex(N.toISOString()):at(N._error)&&at(N._code)?N:{error:N._error,code:N._code};break;default:S=isFinite(N)?N:ot}at(_)||(u&&(M?"string"==typeof M&&(M=t.u8(M)):M=new tt.Style,at(_.linkColor)?_.linkColor===ot&&(M.foreColor||M.foreColor===rt)||(M.foreColor="hyperlink"):M.foreColor=_.linkColor,_.drawUnderline&&at(M.textDecoration)?M.textDecoration=1:2!==M.textDecoration&&4!==M.textDecoration||(M.textDecoration+=1)),V.push({row:f,col:p,value:b.value,hyperlink:ut(_)})),D={s:Q=M?n.getStyleIndex(M,3,t.name()):Q,v:C,n:S,b:T,t:A,e:I,o:x},it(w)||(D.lossless=w),l[p]=D}}}v&&(s[f]=l)}return i},o.prototype.yh=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,c=this,f={};if(n)for(l=n.colCount,h=0;h<l;h++)(d=c.J_(-1,h))&&d.style&&(f[h]=1);nn(this,t,n,e,i,r,o,a,u,s,f)},It=o,a.prototype.NE=function(t,n){var e,i,e=this.infos,i=e[t];return i=!i&&n?e[t]={}:i},a.prototype.kE=function(t,n){var e=this.infos,i=e.length;0<=t&&t<=i&&0<n&&s(e,i,t,n)},a.prototype.DE=function(t,n,e){var i,r,o,a,i=this.infos,r=i.length;if(0<=t&&t<r&&0<n){if(n=T(n,r-t),e)for(o=0;o<n;o++)e.push([["infos",a=t+o],i[a]]);y(i,r,t,n)}},a.prototype._E=function(){return this.infos.length},a.prototype.EE=function(){return this.infos},a.prototype.q_=function(t){return this.infos[t]},a.prototype.X_=function(t,n,e){var i=this.infos[t];this.infos[t]=n,e&&(e[0].push("infos",t),e[1]=i,e[2]=n)},a.prototype.getSize=function(t){var t=this.infos[t],n=rt;return t&&(!1===t.visible?n=0:Pt(t.size)&&(n=V(t.size))),n},a.prototype.getColumnHeaderFitMode=function(t){var t=this.infos[t],n=et.ColumnHeaderFitMode.normal;return n=t?t.columnHeaderFitMode||n:n},a.prototype.setColumnHeaderFitMode=function(t,n,e){var i,r,i=this.NE(t,!0),r=i.columnHeaderFitMode;r!==n&&(i.columnHeaderFitMode=n),e&&(e[0].push("infos",t,"columnHeaderFitMode"),e[1]=r)},a.prototype.getActualSize=function(t){var t=this.infos[t];return t?V(t.size):rt},a.prototype.setSize=function(t,n,e){var i,r,i=this.NE(t,!0),r=i.size;r!==n&&(i.size=n),e&&(e[0].push("infos",t,"size"),e[1]=r,e[2]=n)},a.prototype.getStarSize=function(t){var t=this.infos[t];return t?t.starSize:ot},a.prototype.setStarSize=function(t,n,e){var i,r,i=this.NE(t,!0),r=i.starSize;at(n)&&at(r)||(r!==n&&(at(n)?delete i.starSize:i.starSize=n),e&&(e[0].push("infos",t,"starSize"),e[1]=r,e[2]=n))},a.prototype.getScrollOffsetX=function(t){var t,n,t=this.q_(t),n=0;return n=t&&Pt(t.scrollOffsetX)?t.scrollOffsetX:n},a.prototype.setScrollOffsetX=function(t,n,e){var t=this.NE(t,!0);e&&(n+=t.scrollOffsetX||0),t.scrollOffsetX=n},a.prototype.getScrollContentWidth=function(t){var n,t,e,n=this.q_(t),t=this.getSize(t),e=t;return n&&Pt(n.scrollContentWidth)&&(e=n.scrollContentWidth),p(e,t)},a.prototype.setScrollContentWidth=function(t,n){var e,t,e=this.NE(t,!0),t=this.getSize(t);e.scrollContentWidth=n=n<t?t:n},a.prototype.getHiddenRows=function(){return this.R8},a.prototype.wh=function(t){return this.infos},a.prototype.yh=function(t,n){var e,i,r,o,a,u,s,e=this,i=t;if(i)for(r=t.rowCount,o=0;o<r;o++)(a=i[o])&&(s=u=void 0,a.h!==ot&&(u=Math.round(nt.SJSColumnWidthHelper.pointToPixel(a.h))),a.v&&(at(a.l)||0===a.l)&&(s=!1,e.R8.push(o)),at(u=!1===s&&0===u?ot:u)||e.setSize(+o,u),at(s)||e.setVisible(+o,s))},a.prototype.toJSON=function(t){var n,e,i,r,o,r,r,a,r,a,n=this.infos,e=[];if(t&&t.ignoreStarSize)for(i=0;i<n.length;i++)at(n[i])||(o=(r=n[i]).cellType,r=v(r,["cellType"]),e[i]=ut(r),o&&(o.toJSON&&(o=o.toJSON()),r=L.ti,a=o.typeName,r=r[o.type]||r[a]||F.getTypeFromString(a))&&((a=new r).fromJSON(o,t),e[i].cellType=a),delete e[i].starSize);else for(i=0;i<n.length;i++)at(n[i])||(e[i]=n[i]);return 0<e.length?e:ot},a.prototype.fromJSON=function(t){t&&(this.infos=t)},xt=(f=a).prototype,G({visible:!0,resizable:!0,pageBreak:!1},function(o,e){var t=o[0].toUpperCase()+o.substr(1);xt["get"+t]=function(t){var n,t,n=e,t=this.infos[t];return n=t&&!at(t[o])?t[o]:n},xt["set"+t]=function(t,n,e){var i,r,i=this.NE(t,!0),r=i[o];r!==n&&(i[o]=n),e&&(e[0].push("infos",t,o),e[1]=r,e[2]=n)}}),kt=62,_t=40,m.DEFAULT_COL_HEADER_ROW_HEIGHT=Nt=20,A.prototype.Spe=function(){this.lh={}},A.prototype.getUsedRange=function(t){var n=this,e={};return d(e,n.ZE(t)),d(e,n.sheetModels[3].hE(t)),d(e,n.defaultValueModels[3].hE(t)),d(e,n.WE(t)),d(e,n.QE(t)),e},A.prototype.ZE=function(t){var n,e,t,i,r,o,a;if(t&et.UsedRangeType.span&&(t=(e=(n=this).spanModels[et.SheetArea.viewport]).spans,!at(t))&&0<t.length){for(i={},r=0,o=t;r<o.length;r++)a=o[r],d(i,dt(a));return i}},A.prototype.WE=function(t){var n,e,i,r,t,o,n,a,u,s,c,f,l,n=!(t&et.UsedRangeType.axis);if(t&et.UsedRangeType.data||!n){if(e=n?function(t){return!at(t)&&!at(t.name)}:function(t){return!at(t)},r=(i=this).colInfos[3].infos,t={},0<(n=(o=Object.keys(r)).length)){for(s=0,c=o;s<c.length;s++)if(e(r[f=c[s]])){a=+f;break}for(l=n-1;0<=l;l--)if(e(r[o[l]])){u=+o[l];break}at(a)||at(u)||d(t,{minRow:0,minCol:a,maxRow:1/0,maxCol:u})}return t}},A.prototype.QE=function(t){var n,e,t,i,r,o,a,u,s,c,f;if(t&et.UsedRangeType.axis){if(e=(n=this).rowInfos[3].infos,t={},0<(a=(o=Object.keys(e)).length)){for(u=0,s=o;u<s.length;u++)if(c=s[u],!at(e[c])){i=+c;break}for(f=a-1;0<=f;f--)if(!at(e[o[f]])){r=+o[f];break}at(i)||at(r)||d(t,{minRow:i,minCol:0,maxRow:r,maxCol:1/0})}return t}},A.prototype.KE=function(t,n,e,i,r){var r;3!==e||t<0||n<0||!this.Mf||this.Mf.hasFormula===ot||An(r=this.W_(3).J_(t,n,!!r),i,this.Mf.hasFormula(t,n,e),r&&r.style,this.F8,this.Mf.parent)},A.prototype.JE=function(t,n,e){var e;3!==e||t<0||n<0||(e=this.W_(3).J_(t,n))&&Sn(e)},A.prototype.V8=function(t,n){var e=this;e.L8({type:et.AxisInfoChangeType.setRowCount,count:t}),e.L8({type:et.AxisInfoChangeType.setColumnCount,count:n})},A.prototype.L8=function(t){var n,e,i,r,r,o,a,u,s,c,f,l,h,d,n=this,e=n.Mf,i=t.type,r=t.sheetArea,r=void 0===r?et.SheetArea.viewport:r;if(r===et.SheetArea.viewport)if(at(n.XE)&&(n.XE=[]),at(n.qE)&&(n.qE=[]),n.$E)n.tj(t);else switch(o=n.XE,a=n.qE,i){case et.AxisInfoChangeType.deleteRows:u=t.index,s=t.count,o.splice(u,s);break;case et.AxisInfoChangeType.deleteColumns:u=t.index,s=t.count,a.splice(u,s);break;case et.AxisInfoChangeType.setRowHeight:case et.AxisInfoChangeType.setRowVisible:u=t.index,c=t.value,o[u]=c;break;case et.AxisInfoChangeType.setColumnWidth:case et.AxisInfoChangeType.setColumnVisible:u=t.index,c=t.value,a[u]=c;break;case et.AxisInfoChangeType.filterRows:for(l=0,h=f=t.index;l<h.length;l++)u=h[l],c=e.getRowHeight(u),o[u]=c;break;case et.AxisInfoChangeType.outlineExpandRows:for(f=t.index,d=0;d<f.length;d++)u=f[d],c=e.getRowHeight(u),o[u]=c;break;case et.AxisInfoChangeType.outlineExpandColumns:for(f=t.index,d=0;d<f.length;d++)u=f[d],c=e.getColumnWidth(u),a[u]=c}},A.prototype.nj=function(t){var t;if(this.XE)return t=this.XE[t],at(t)?this.defaults.rowHeight:t},A.prototype.ej=function(t){var t;if(this.qE)return t=this.qE[t],at(t)?this.defaults.colWidth:t},A.prototype.v8=function(){this.$E=[]},A.prototype.A8=function(){var t,n,e,i,r,t=this,n=t.$E;if(t.$E=rt,n)for(e=0,i=n;e<i.length;e++)r=i[e],t.L8(r)},A.prototype.tj=function(t){this.$E&&this.$E.push(t)},A.prototype.m8=function(){var t=this;t.XE=rt,t.qE=rt},A.prototype.ij=function(){this.F8=rt},A.prototype.L0=function(t){var n;!1!==t&&((n=this).Mf=rt,n.sheetModels=rt,n.defaultValueModels&&(n.defaultValueModels.forEach(function(t){null!=t&&t.dispose()}),n.defaultValueModels=rt),n.m8(),n.ij(),A.f2e(this.Cpe)),A.et(this,"dispose",{clearCache:t})},A.prototype.addRows=function(t,n,e,i,r){var o,a;void 0===r&&(r=et.SheetArea.viewport),0<(o=this).P8&&o.G8.push(a={row:t,rowCount:n,type:"addRows",sheetArea:r}),1===r?(o.W_(1).rE(t,n,i),o.yle(1).rE(t,n),o.K_(1).rE(t,n),o.Q_(!0,1).kE(t,n)):(o.W_(3).rE(t,n,i),o.W_(2).rE(t,n,i),o.yle(3).rE(t,n),o.yle(2).rE(t,n),o.K_(3).rE(t,n),o.K_(2).rE(t,n),o.Q_(!0,3).kE(t,n),!i&&D&&o.Mf.Uw(3).t8.rE(t,n)),e||A.et(o,"addRows",{row:t,rowCount:n,sheetArea:r,changes:o.G8}),o.L8({type:et.AxisInfoChangeType.addRows,index:t,count:n,sheetArea:r})},A.prototype.rj=function(t,n){var e,i,r,t,e=this,i=t.row,r=t.rowCount,t=t.sheetArea;n?e.addRows(i,r,!0,!n,t):e.deleteRows(i,r,!0,t),A.et(e,"undoAddRows",{row:i,rowCount:r,sheetArea:t})},A.prototype.deleteRows=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,o=(i=void 0===i?et.SheetArea.viewport:i)===et.SheetArea.colHeader;if(0<(r=this).P8&&(u=[],s=[],c=o?[]:[["spanModels",3],ot],f=o?[]:[["spanModels",2],ot],l=[],h=[],a={row:t,rowCount:n,type:"deleteRows",sheetArea:i}),o?(r.W_(1).yE(t,n),r.yle(1).yE(t,n),r.K_(1).aE(t,n),r.Q_(!0,1).DE(t,n)):(D&&r.Mf.Uw(3).t8.aE(t,n,!0),r.W_(3).yE(t,n,u),r.W_(2).yE(t,n,s),r.yle(3).yE(t,n,h),r.yle(2).yE(t,n),r.K_(3).aE(t,n,c),r.K_(2).aE(t,n,f),r.Q_(!0,3).DE(t,n,l)),e||A.et(r,"deleteRows",{row:t,rowCount:n,changes:r.G8,sheetArea:i}),a){for(r.G8.push(a),d=a.changes=[],v=[M,3],m=0;m<u.length;m++)u[m][0]=v.concat(u[m][0]),d.push(u[m]);for(v=[M,2],m=0;m<s.length;m++)s[m][0]=v.concat(s[m][0]),d.push(s[m]);for(0<c.length&&d.push(c),0<f.length&&d.push(f),v=[b,3],m=0;m<l.length;m++)l[m][0]=v.concat(l[m][0]),d.push(l[m]);for(v=[C,3],m=0;m<h.length;m++)h[m][0]=v.concat(h[m][0]),d.push(h[m])}r.L8({type:et.AxisInfoChangeType.deleteRows,index:t,count:n,sheetArea:i})},A.prototype.oj=function(t,n){var e,i,r,o,a,u,n,e=this,i=t.row,r=t.rowCount,o=t.sheetArea;if(n)e.deleteRows(i,r,!0,o);else{for(e.addRows(i,r,!0,!0,o),u=(a=t.changes).length-1;0<=u;u--)bn(e,a[u]);D&&e.Mf.Uw(3).t8.Eme(i,r)}(n=e.Mf&&e.Mf.aj)&&n.splice(n.length-r,r)},A.prototype.addColumns=function(t,n,e,i,r){var o,a;void 0===i&&(i=et.SheetArea.viewport),0<(o=this).P8&&o.G8.push(a={col:t,colCount:n,type:"addColumns",sheetArea:i}),2===i?(o.W_(2).oE(t,n),o.yle(2).oE(t,n),o.K_(2).oE(t,n),o.Q_(!1,2).kE(t,n)):(o.W_(3).oE(t,n),o.W_(1).oE(t,n),o.yle(3).oE(t,n),o.yle(1).oE(t,n),o.K_(3).oE(t,n),o.K_(1).oE(t,n),o.Q_(!1,3).kE(t,n),!r&&D&&o.Mf.Uw(3).t8.oE(t,n)),e||A.et(o,"addColumns",{col:t,colCount:n,changes:o.G8,sheetArea:i}),o.L8({type:et.AxisInfoChangeType.addColumns,index:t,count:n,sheetArea:i})},A.prototype.uj=function(t,n){var e,i,r,t,e=this,i=t.col,r=t.colCount,t=t.sheetArea;n?e.addColumns(i,r,!0,t):e.deleteColumns(i,r,!0,t)},A.prototype.deleteColumns=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,o=(i=void 0===i?et.SheetArea.viewport:i)===et.SheetArea.rowHeader;if(0<(r=this).P8&&(u=[],s=[],c=o?[]:[["spanModels",3],ot],f=o?[]:[["spanModels",1],ot],l=[],h=[],a={col:t,colCount:n,type:"deleteColumns",sheetArea:i}),o?(r.W_(2).wE(t,n),r.yle(2).wE(t,n),r.K_(2).uE(t,n),r.Q_(!1,2).DE(t,n)):(D&&r.Mf.Uw(3).t8.uE(t,n,!0),r.W_(3).wE(t,n,u),r.W_(1).wE(t,n,s),r.yle(3).wE(t,n,h),r.yle(1).wE(t,n),r.K_(3).uE(t,n,c),r.K_(1).uE(t,n,f),r.Q_(!1,3).DE(t,n,l)),e||A.et(r,"deleteColumns",{col:t,colCount:n,changes:r.G8,sheetArea:i}),a){for(r.G8.push(a),d=a.changes=[],v=[M,3],m=0;m<u.length;m++)u[m][0]=v.concat(u[m][0]),d.push(u[m]);for(v=[M,1],m=0;m<s.length;m++)s[m][0]=v.concat(s[m][0]),d.push(s[m]);for(0<c.length&&d.push(c),0<f.length&&d.push(f),v=[w,3],m=0;m<l.length;m++)l[m][0]=v.concat(l[m][0]),d.push(l[m]);for(v=[C,3],m=0;m<h.length;m++)h[m][0]=v.concat(h[m][0]),d.push(h[m])}r.L8({type:et.AxisInfoChangeType.deleteColumns,index:t,count:n,sheetArea:i})},A.prototype.sj=function(t,n){var e,i,r,o,a,u,e=this,i=t.col,r=t.colCount,o=t.sheetArea;if(n)e.deleteColumns(i,r,!0,o);else{for(e.addColumns(i,r,!0,o,!0),u=(a=t.changes).length-1;0<=u;u--)bn(e,a[u]);D&&e.Mf.Uw().t8.Ome(i,r)}},A.prototype.getRowCount=function(t){return this.W_(t).getRowCount()},A.prototype.setRowCount=function(t,n,e){var i,r,i=this,r=i.getRowCount(n);0<i.P8&&i.G8.push({oldRowCount:r,sheetArea:n,type:"setRowCount"}),3===n||2===n?(t<r&&i.deleteRows(t,r-t,e),i.W_(3).setRowCount(t),i.W_(2).setRowCount(t),i.yle(3).setRowCount(t),i.Mf.ki(nt.Events.WorksheetDataChanged,{type:"count"})):1===n&&(t<r&&i.Q_(!0,n).DE(t,r-t),i.W_(n).setRowCount(t)),i.L8({type:et.AxisInfoChangeType.setRowCount,count:t,sheetArea:n})},A.prototype.cj=function(t){var n=this;n.W_(3).setRowCount(t),n.W_(2).setRowCount(t),n.yle(3).setRowCount(t),n.L8({type:et.AxisInfoChangeType.setRowCount,count:t,sheetArea:3})},A.prototype.fj=function(t,n){n?this.setRowCount(t.rowCount,t.sheetArea,!0):this.setRowCount(t.oldRowCount,t.sheetArea,!0)},A.prototype.getColumnCount=function(t){return this.W_(t).getColumnCount()},A.prototype.setColumnCount=function(t,n,e){var i,r,i=this,r=i.getColumnCount(n);0<i.P8&&i.G8.push({oldColCount:r,sheetArea:n,type:"setColumnCount"}),3===n||1===n?(t<r&&i.deleteColumns(t,r-t,e),i.W_(3).setColumnCount(t),i.W_(1).setColumnCount(t),i.yle(3).setColumnCount(t),i.Mf.ki(nt.Events.WorksheetDataChanged,{type:"count"})):2===n&&(t<r&&i.Q_(!1,n).DE(t,r-t),i.W_(n).setColumnCount(t)),i.L8({type:et.AxisInfoChangeType.setColumnCount,count:t,sheetArea:n})},A.prototype.lj=function(t,n){n?this.setColumnCount(t.colCount,t.sheetArea,!0):this.setColumnCount(t.oldColCount,t.sheetArea,!0)},A.prototype.getLastNonNullRow=function(t,n){var e,e;return e={isRow:!0,sheetArea:t=at(t)?3:t,index:ot,isIndexGet:!1},A.et(this,"getLastNonNullRowOrCol",e),e.isIndexGet?e.index:(e=n?0:this.Q_(!0,t)._E()-1,p(this.W_(t).I8,this.K_(t).I8,this.yle(t).I8,e))},A.prototype.getLastNonNullCol=function(t,n){var e,e;return e={isRow:!1,sheetArea:t=at(t)?3:t,index:ot,isIndexGet:!1},A.et(this,"getLastNonNullRowOrCol",e),e.isIndexGet?e.index:(e=n?0:this.Q_(!1,t)._E()-1,p(this.W_(t).x8,this.K_(t).x8,this.yle(t).x8,e))},A.prototype.getFreeAreaRowCount=function(t){var t=this.W_(t);return t&&t.getFreeAreaRowCount()},A.prototype.getFreeAreaColumnCount=function(t){var t=this.W_(t);return t&&t.getFreeAreaColumnCount()},A.prototype.setFreeAreaRowCount=function(t,n){this.W_(n).setFreeAreaRowCount(t)},A.prototype.setFreeAreaColumnCount=function(t,n){this.W_(n).setFreeAreaColumnCount(t)},A.prototype.hj=function(){var t,u,n,t;function e(t,n){for(var e,i,r,o,a,e=n.length,i=0;i<e;i++)r=n[i][0],o=n[i][1],(a=n[i][2])!==o&&(t?u.dj(r,3,"height",o,a):u.vj(r,3,"width",o,a))}n=0!==(u=(t=this).Mf).ot().height&&t.mj(!0,u.defaults.rowHeight),t=0!==u.ot().width&&t.mj(!1,u.defaults.colWidth),n&&e(!0,n),t&&e(!1,t)},A.prototype.mj=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,f,T,A,A,e=this,i=e.Mf,r=[],o=i.zoom(),a=t?i.getRowCount():i.getColumnCount(),u=e.Q_(t,3),s=0,f=0;if(i.gj&&(f=t?i.gj().height:i.gj().width),t){if(i.options.colHeaderVisible)for(l=0;l<i.getRowCount(1);l++)s+=I(o*i.getRowHeight(l,1));c=i.ot().height-i.options.sheetAreaOffset.top-f-s}else{if(i.options.rowHeaderVisible)for(l=0;l<i.getColumnCount(2);l++)s+=I(o*i.getColumnWidth(l,2));c=i.ot().width-i.options.sheetAreaOffset.left-f-s}for(h=[],d=[],v=[],g=t?i.getRowVisible:i.getColumnVisible,l=m=0;l<a;l++)if(p=g.call(i,l),b=i.Ut.getSize(t,3,l),w=i.Ut.getStarSize(t,3,l),H.test(w))y="*"===w?1:parseFloat(w.replace("*","")),p&&0<y?(m+=y,h.push(l),d.push(y),v.push(b)):r.push([l,0,b]);else if(b=Pt(b)?Math.floor(b):n,p&&(c-=I(o*b))<1)return;if(!(m+r.length===0||c<1)){for(M=h.length,l=0;l<M-1;l++)if(b=V((C=c/m/o)*(y=d[l])),S=I(o*b),r.push([h[l],b,v[l]]),c-=S,m-=y,S<1||c<1)return;for(f=I((c-1e-4)/o),r.push([h[M-1],f,v[M-1]]),l=0;l<r.length;l++)T=r[l][0],A=r[l][1],u.setSize(T,A),A=t?et.AxisInfoChangeType.setRowHeight:et.AxisInfoChangeType.setColumnWidth,e.L8({type:A,index:T});return r}},A.prototype.setCellState=function(t,n,e,i,r){var r=this.W_(r);r&&r.setCellState(t,n,e,i)},A.prototype.toJSON=function(t){var n,e,i,r,i,t,o,n=this,e={},i=n.Mf;return e.data=n.W_(3).toJSON(3,t,n.Mf),e.rowHeaderData=n.W_(2).toJSON(2,t),e.colHeaderData=n.W_(1).toJSON(1,t),e.rows=n.Q_(!0,3).toJSON(t),e.columns=n.Q_(!1,3).toJSON(t),e.rowHeaderColInfos=n.Q_(!1,2).toJSON(t),e.colHeaderRowInfos=n.Q_(!0,1).toJSON(t),e.defaultData=n.yle(3).toJSON(),i.filterRowsVisibleInfo&&!i.filterRowsVisibleInfo.empty&&n.updateToJsonRowInfo(i.filterRowsVisibleInfo.rowsVisibleInfo,e,i),e.leftCellIndex=i.getViewportLeftColumn(1),e.topCellIndex=i.getViewportTopRow(1),(r=t&&t.ignoreStyle)||(e.spans=pn(n.K_(3).toJSON()),e.rowHeaderSpan=pn(n.K_(2).toJSON()),e.colHeaderSpan=pn(n.K_(1).toJSON())),e.selections=n.selectionModel.toJSON(),(o=20===(t={colHeaderRowHeight:(i=n.defaults).colHeaderRowHeight,colWidth:i.colWidth,rowHeaderColWidth:i.rowHeaderColWidth,rowHeight:i.rowHeight,_isExcelDefaultColumnWidth:i._isExcelDefaultColumnWidth}).rowHeight&&62===t.colWidth&&40===t.rowHeaderColWidth&&t.colHeaderRowHeight===m.DEFAULT_COL_HEADER_ROW_HEIGHT)||(e.defaults=t),e},A.prototype.updateToJsonRowInfo=function(t,n,e){var i,r,o,a;for(at(n.rows)&&(n.rows=[]),i=n.rows,r=e.getRowCount(),o=0;o<r;o++)(a=!1===t[o])&&(at(i[o])?i[o]={}:i[o]=l({},i[o]),i[o].visible=!1,i[o].isFilter=!0)},A.prototype.fromJSON=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,i,r,o=this,a=o.F8;if(o.W_(3).fromJSON(t.data,n,e,a,i,3,r),o.W_(2).fromJSON(t.rowHeaderData,n,e,a),o.W_(1).fromJSON(t.colHeaderData,n,e,a),o.Mf.showCell(t.topCellIndex||0,t.leftCellIndex||0,et.VerticalPosition.top,et.HorizontalPosition.left),o.Q_(!0,3).fromJSON(t.rows),o.Q_(!1,3).fromJSON(t.columns),o.Q_(!1,2).fromJSON(t.rowHeaderColInfos),o.Q_(!0,1).fromJSON(t.colHeaderRowInfos),o.yle(3).fromJSON(t.defaultData),t&&t.rows)for(s=0,c=u=Object.keys(t.rows);s<c.length;s++)f=c[s],l=t.rows[f],at(l)||o.L8({type:et.AxisInfoChangeType.setRowHeight,index:+f});if(t&&t.columns)for(h=0,d=u=Object.keys(t.columns);h<d.length;h++)f=d[h],l=t.columns[f],at(l)||o.L8({type:et.AxisInfoChangeType.setColumnWidth,index:+f});(v=e&&e.ignoreStyle)||(o.K_(3).fromJSON(t.spans,o.getRowCount(),o.getColumnCount()),o.K_(2).fromJSON(t.rowHeaderSpan),o.K_(1).fromJSON(t.colHeaderSpan)),o.selectionModel.fromJSON(t.selections,t.rowCount,t.columnCount),o.Rue(t.tag),(i=t.defaults)!==ot&&((r=o.defaults).colHeaderRowHeight=Bt(i.colHeaderRowHeight,m.DEFAULT_COL_HEADER_ROW_HEIGHT),r.colWidth=Bt(i.colWidth,62),r.rowHeaderColWidth=Bt(i.rowHeaderColWidth,40),r.rowHeight=Bt(i.rowHeight,20),r._isExcelDefaultColumnWidth=i._isExcelDefaultColumnWidth)},A.prototype.Rue=function(t){var n,e,e,e;t!==ot&&t!==rt&&(n=this,typeof(e=t.typeName)===g&&(e=F.getTypeFromString(e))&&((e=new e).fromJSON&&e.fromJSON(t),t=e),n.do("setValueForKey",-1,-1,"tag",t,3))},A.prototype.wh=function(t,n,e){var i,r,o,t,r,n,t,a,u,s,t,c,f,l,h,e,e,d,o,i,v,i=this,r=i.defaults.rowHeight,o=i.Q_(!0,3).wh(e),t=i.W_(3).wh(i.Mf,o,t,r,n,e),r=t.sheetData,n=t.hyperlinks,t={};return e&&(t.saveAsView=e.saveAsView,t.ignoreStyle=!1===e.includeStyles),a=i.W_(2).toJSON(2,t),u=i.W_(1).toJSON(1,t),s=i.Q_(!1,2).toJSON(t),t=i.Q_(!0,1).toJSON(t),c=i.yle(3).wh(e),f=i.getValueForKey(-1,-1,"tag",3),e&&!1===e.includeStyles||(l=pn(i.K_(2).toJSON()),h=pn(i.K_(1).toJSON())),e={colHeaderRowHeight:(e=i.defaults).colHeaderRowHeight,rowHeaderColWidth:e.rowHeaderColWidth},d=[],o.forEach(function(t,n){t&&t.starSize&&(d[n]={starSize:t.starSize})}),o=i.selectionModel.selectionPolicy,i=i.selectionModel.selectionUnit,v=40===e.rowHeaderColWidth&&e.colHeaderRowHeight===m.DEFAULT_COL_HEADER_ROW_HEIGHT,{sheetData:r,hyperlinks:n,rowHeaderData:a,colHeaderData:u,rowHeaderColInfos:s,colHeaderRowInfos:t,rowHeaderSpan:l,colHeaderSpan:h,rowInfos:d,defaultData:c,tag:f,defaults:v?void 0:e,selectionPolicy:o,selectionUnit:i}},A.prototype.yh=function(t,n,e,i,r,o,a){var u,t,s,c,n,r,o,a,u=this;u.Q_(!0,3).yh(t,e),u.W_(3).yh(u.Mf,t,n,e,ot,r,o,u.F8,a),i&&(t={},e&&(t.ignoreStyle=!1===e.includeStyles,B.Util.Mo(e))&&(t.incrementalLoading=!0),u.W_(2).fromJSON(i.rowHeaderData,ot,t),u.W_(1).fromJSON(i.colHeaderData,ot,t),u.Q_(!1,2).fromJSON(i.rowHeaderColInfos),u.Q_(!0,1).fromJSON(i.colHeaderRowInfos),u.yle(3).yh(i.defaultData),e&&!1===e.includeStyles||(u.K_(2).fromJSON(i.rowHeaderSpan),u.K_(1).fromJSON(i.colHeaderSpan)),s=u.Q_(!0,3),(c=i.rowInfos||[]).forEach(function(t,n){at(t&&t.starSize)||s.setStarSize(n,t.starSize)}),(n=i.defaults)!==ot&&((r=u.defaults).colHeaderRowHeight=Bt(n.colHeaderRowHeight,m.DEFAULT_COL_HEADER_ROW_HEIGHT),r.rowHeaderColWidth=Bt(n.rowHeaderColWidth,40)),(o=i.selectionPolicy)!==ot&&(u.selectionModel.selectionPolicy=+o),(a=i.selectionUnit)!==ot&&(u.selectionModel.selectionUnit=+a),u.Rue(i.tag))},A.prototype.startTransaction=function(){var t,n;0===this.P8&&(this.G8=[],this.Mf.isEventSuspended()||(this.G8.events=[]),A.et(this,"startTransaction")),this.P8++},A.prototype.endTransaction=function(){var t,n;return this.P8--,0===this.P8?(A.et(this,"endTransaction"),t=this.G8,this.G8=ot,(n=t.events)&&0===n.length&&delete t.events,delete t.diffCache,delete t.styleChanges,t):(this.P8<0&&(this.P8=0),[])},A.prototype.pj=function(){var t=this.G8;if(t)return t.calc||(t.calc=[]),t.calc},A.prototype.applyChange=function(t,n,e){var i,r,o,a,u,o,a,s,i=this,r=t.type;!r&&0<t.length?(bn(i,t,n),a=(o=Array.isArray(t[0])?t[0]:t)[1],u=o[3],o=o[4],0<a&&0<=u&&0<=o&&(s=(a=i.W_(a)).J_(u,o))&&cn(s,s,!1,u,o,{},a.a8)):"addRows"===r?i.rj(t,n):"addColumns"===r?i.uj(t,n):"deleteRows"===r?i.oj(t,n):"deleteColumns"===r?i.sj(t,n):"setRowCount"===r?i.fj(t,n):"setColumnCount"===r?i.lj(t,n):"setZoomFactor"===r?i.wj(n?t.newValue:t.value):"updateDirty"===r?e.push(t):"setName"===r?n?i.Mj(t.newValue):i.Mj(t.value):"sortRange"===r?i.Cj(t,n):"sheetProperty"===r&&i.Mf[t.pname](n?t.value:t.oldValue)},A.prototype.applyChanges=function(t,n,s){var e,i,r,o,a;function c(t,n,e,i,r){r?t.setArrayFormula(n,e,r.rowCount,r.colCount,i):t.setFormula(n,e,i)}function u(t,n){var e,i,r,o,a,u;if(n)for(e in n)if(!isNaN(e))for(o in i=parseInt(e,10),r=n[e])isNaN(o)||(a=parseInt(o,10),s?c(t,i,a,u=r[o].formula!==r[o].oldFormula?r[o].formula:null,u?r[o].arrayInfo:null):c(t,i,a,r[o].oldFormula,r[o].oldArrayInfo))}if(e=this,i=[],n)if(r=function(t){t[0]===mt?wn(t,function(t){e.applyChange(t,s,i)}):e.applyChange(t,s,i)},s)for(o=0;o<n.length;o++)r(n[o]);else for(o=n.length-1;0<=o;o--)r(n[o]);(a=e.Mf).Sj={},a.r3(),u(a,n&&n.formulas),A.et(e,"applyChanges",{command:t,changes:n,isUndo:!s}),0<i.length&&a.Tj()},A.prototype.undo=function(t){var n,e,i,r,o,a,u,s,c,f,f,n=[],e=t&&t.events;if(e&&this.Aj(e,!0),t)for(i=t.length-1;0<=i;i--)(o=(r=t[i]).type)?"addRows"===o?this.rj(r):"addColumns"===o?this.uj(r):"deleteRows"===o?this.oj(r):"deleteColumns"===o?this.sj(r):"setRowCount"===o?this.fj(r):"setColumnCount"===o?this.lj(r):"setZoomFactor"===o?this.wj(r.value):"updateDirty"===o?(this.pE(r),n.push(r)):"setName"===o?this.Mj(r.value):"sortRange"===o&&this.Cj(r):r.skipUndo||bn(this,r);(a=this.Mf).Sj={},a.r3(),u=t&&t.calc,(s=0<n.length||u&&0<u.length)&&(c=a.Lp)&&c.suspend(),0<n.length&&n.forEach(function(t){a.Ij(t.row,t.col,3,!1)}),(f=t&&t.tableChanges)&&0<f.length&&(A.et(this,Z,{tableChanges:f}),t.tableChanges.isRestored=!0),(f=t&&t.pivotTableChanges)&&0<f.length&&(A.et(this,Z,{pivotTableChanges:f}),t.pivotTableChanges.isRestored=!0),u&&u.length&&a.xj(u),A.et(this,"undoValue",t),s&&(c&&c.resume(!1),a.Tj()),delete this.W_(3).B8.vE,t&&A.et(this,Z,t),e&&this.Aj(e,!1)},A.prototype.do=function(t){for(var n,e,i,t,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];i=this,t&&(t=i[t])&&t.apply(i,n)},A.prototype.W_=function(t){return at(t)&&(t=3),this.sheetModels[t]},A.prototype.l8=function(t,n,e){var i=0,r=0;at(e)&&(e=3,i=t,r=n),this.sheetModels[e]=new It(t,n,i,r)},A.prototype.yle=function(t){return at(t)&&(t=3),this.defaultValueModels[t]},A.prototype.ZI=function(t){var n,e=this.G8,e=e&&e.events;e&&e.push(t)},A.prototype.Aj=function(t,n){var e,i,r,o,a,e=this.Mf;for(e.Nj=!0,i=t.length-1;0<=i;i--)a=void 0,"cellChanged"!==(o=(r=t[i])[0])||n?"rowChanged"!==o||n?"columnChanged"!==o||n?"zoomChanged"!==o||n?"rowChanging"===o&&n?a=e.kj:"columnChanging"===o&&n?a=e.Dj:"tableRowsChanged"!==o||n?"tableColumnsChanged"!==o||n?"rangeChanged"!==o||n||(a=e._j):a=e.Ej:a=e.jj:a=e.Oj:a=e.vj:a=e.dj:a=e.Rj,a&&([].splice.call(t,i,1),a.apply(e,[].slice.call(r,1)));e.Nj=!1},A.prototype.Rve=function(t,n,e){var e=this.yle(e);if(e)return e.getValue(t,n)},A.prototype.gge=function(t,n,e,i){var r=this,o=r.Mf;o.hasFormula&&!o.hasFormula(t,n,i,!0)&&r.yle(i).$1e(t,n,rt,rt,i,e)},A.prototype.yge=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=this,o=r.Mf;if(o.hasFormula)for(a=r.yle(),u=T(e,a.getRowCount()),s=T(i,a.getColumnCount()),c=0;c<u;c++)for(f=t+c,l=0;l<s;l++)a.getExpression(f,h=n+l)&&!o.hasFormula(f,h,3,!0)&&r.gge(f,h)},A.prototype.getValue=function(t,n,e,i,r){var o,a,r;return at(e)&&(e=3),!i&&(o={row:t,col:n,sheetArea:e,isValueGet:!1,value:ot,valueType:r},A.et(this,"getValue",o,function(){return o.isValueGet}),o.isValueGet)?this.wle||!at(o.value)||(a=this.Rve(t,n,e),at(a))?o.value:a:(r=this.W_(e).getValue(t,n,r),this.wle||i||!at(r)||(a=this.Rve(t,n,e),at(a))?r:a)},A.prototype.setValue=function(t,n,e,i,r,o,a,u,s){var c,f,l,o,s,h,r,s,a,u,r;at(i)&&(i=3),l=(f=this).Mf,(o=!o&&!l.isEventSuspended())&&(c=l.getValue(t,n,i,1)),s||f.KE(t,n,i,e,!0),s=!1,r||(h={row:t,col:n,value:e,sheetArea:i,isValueSet:!1,changes:f.G8},A.et(f,"setValue",h,function(){return h.isValueSet}),s=h.isValueSet),s||(s=r=void 0,0<f.P8&&(!a||l.parent&&l.parent.options.saveChangesForSheet)&&(r=[[M,i],ot],s={sheetArea:i}),l.vle?(f.setDefaultValue(t,n,e,i,rt,!0,rt),f.W_(i).setValue(t,n,rt,r,s,u)):(f.gge(t,n,at(e),i),f.W_(i).setValue(t,n,e,r,s,u),f.W_(i).setValueForKey(t,n,Y,!0)),u&&r&&!mn(this.pj(),t,n)&&(r.skipUndo=!0),r&&0<r.length&&f.G8.push(r),s&&s.type&&f.G8.push(s),l.Tj()),o?(a=c!==e,u=!1,r=void 0,(a=typeof e===g&&((r=nt.util.V0(e))instanceof Date&&(u=!0),c instanceof Date)?c.valueOf()!==r.valueOf():a)&&l.Rj("value",t,n,i,c,u&&r?r:e)):l.Lj(l,[{row:t,col:n}],0)},A.prototype.Mle=function(t,n,e){at(e)&&(e=3);var e=this.yle(e);if(e)return e.q1e(t,n)},A.prototype.getDefaultValue=function(t,n,e,i){var e=this.yle(e);if(e)return i===et.DefaultChangeValueType.Expression?e.getFormula(t,n):i!==et.DefaultChangeValueType.Value&&e.getFormula(t,n)||e.getValue(t,n)},A.prototype.setDefaultValue=function(t,n,e,i,r,o,a){var u,s,c;at(i)&&(i=3),(s=(u=this).yle(i))&&(c=void 0,0<u.P8&&(c=[[C,i],ot]),at(a)&&(u.wle=!0,a=!at(u.getValue(t,n,i))||u.Mf.hasFormula(t,n,i,!0),delete u.wle),!r&&F.kf(e)||r===et.DefaultChangeValueType.Expression?s.setFormula(t,n,e,i,a,c):s.setValue(t,n,e,o,c),c)&&0<c.length&&u.G8.push(c)},A.prototype.getStyle=function(t,n,e){var i={row:t,col:n,sheetArea:e=at(e)?3:e,isStyleGet:!1,style:ot};return A.et(this,"getStyle",i),i.isStyleGet?i.style:this.W_(e).getStyle(t,n,0<this.P8)},A.prototype.setStyle=function(t,n,e,i){var r,r,o,a,r;at(i)&&(i=3),e&&e.cellType&&e.cellType.qe(this.Mf,t,n,e,i),o=0<this.P8?[[M,i]]:ot,a=this.W_(i).getStyle(t,n,!1),this.G8&&this.G8.diffCache===ot&&(this.G8.diffCache=[]),this.G8&&this.G8.styleChanges===ot&&(this.G8.styleChanges=[]),this.W_(i).setStyle(t,n,e,o,null==(r=this.G8)?void 0:r.styleChanges,null==(r=this.G8)?void 0:r.diffCache),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"style"}),o&&0<o.length&&this.PCe(o),r=this.Mf.parent,i===et.SheetArea.viewport&&In(a,e,r)&&this.KE(t,n,i,this.getValue(t,n,i,!0),!1)},A.prototype.PCe=function(t){var n,n,e,n,i,r;0===(null==(n=this.G8)?void 0:n.styleChanges.length)&&this.G8.push([mt,this.G8.styleChanges,this.G8.diffCache]),n=hn(t),(e=vn(this.G8.styleChanges,n))||this.G8.styleChanges.push(e={path:n,change:{}}),n=dn(t),i=e.change[n],r=3===t.length?{old:t[1],new:t[2]}:t[1],i!==ot&&Array.isArray(i)?"object"==typeof i[i.length-1]?i[i.length-1].new=t[2]:i.push(r):3===t.length&&i!==ot?"object"==typeof i?i.new=t[2]:e.change[n]=[i,r]:e.change[n]=r},A.prototype.getValueForKey=function(t,n,e,i){return this.W_(i).getValueForKey(t,n,e)},A.prototype.setValueForKey=function(t,n,e,i,r){at(r)&&(r=3);var o=0<this.P8?[[M,r],ot]:ot;this.W_(r).setValueForKey(t,n,e,i,o),o&&0<o.length&&this.G8.push(o)},A.prototype.RCe=function(t,n,e,i,r,o){this.W_(o).clear(t,n,e,i,r)},A.prototype.clear=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p;if(at(a)&&(a=3),u=0<this.P8?[]:ot,D&&3===a&&(s=this).Mf.Uw(3).t8.Fgt(t,n,e,i),(c=this.W_(a)).clear(t,n,e,i,r,o,u),this.yle(a).resetFormulaToCalc(t,n,e,i,a),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:et.StorageType[r]}),A.et(this,"clear",{row:t,col:n,rowCount:e,colCount:i,type:r,ignoredRowList:o,sheetArea:a,changes:this.G8}),u)for(f=[M,a],l=0,h=u.length;l<h;l++)(d=u[l])[0]=f.concat(d[0]),this.G8.push(d);for(v=0;v<e;v++)for(m=0;m<i;m++)this.KE(g=t+v,p=n+m,a,rt,!1),c.setValueForKey(g,p,Y,!0)},A.prototype.swapNode=function(t,n,e,i,r){var o,a,u,s,c;if(at(r)&&(r=3),o=0<this.P8?[]:ot,this.W_(r).SE(t,n,e,i,o),this.yle(r).SE(t,n,e,i,o),o)for(a=[M,r],u=0,s=o.length;u<s;u++)(c=o[u])[0]=a.concat(c[0]),this.G8.push(c)},A.prototype.dE=function(t,n,e,i){var r;0<this.P8&&(r={sheetArea:i},at(i))&&(r.sheetArea=3),this.W_(i).dE(t,n,e,r),r&&this.G8.push(r)},A.prototype.pE=function(t){this.W_(t.sheetArea).pE(t)},A.prototype.Fj=function(t){return this.W_(t).B8},A.prototype.Pj=function(t,n,e){var i,e,r,i,e=this.Fj(e)[t];return!(!e||!(r=e[n]))},A.prototype.Gj=function(t,n,e){for(var i,r,o,i=this.W_(e).B8,r=0;r<n;r++)(o=t+r)in i&&delete i[o]},A.prototype.Uj=function(t,n){var e,i,r,o,e,i=this.Mf.aj;if(i)for(r=i.length-1;0<=r;r--)t<=(o=i[r].row)&&o<t+n&&i.splice(r)},A.prototype.Hj=function(t){this.W_(t).B8={}},A.prototype.zj=function(t,n,e,i){var r=this.Fj(),o,a,u;if(r)for(o in r)N(r,o)&&(a=r[o],u=parseInt(o,10),a)&&"n"===a.rs&&(t||n&&e<=u&&u<e+i)&&(r[o]={})},A.prototype.Vj=function(o,t,a,n,u){var e,s,c,f,i,r,l,e,h,d,v,e=this,s=e.Fj(),c=e.Mf,f=c.tables;if(!it(s)){if(i=[],0<=t)for(r=t;r<t+n;r++)i.push(r);else for(l in s)N(s,l)&&i.push(parseInt(l,10));e=[],h=[],f&&(e=f.Yj(t,a,n,u),h=f.Zj(t,a,n,u),0<e.length)&&A.et(this,"clearPendingChanges",{tableList:e}),G(i,function(t,n){var e,i,r;if((d=s[n])&&"e"===d.rs)if(e=h.length,o)if(f&&0!==e&&f.Wj(h,n,-1))for(i=c.getColumnCount(),r=0;r<i;r++)f&&0!==e&&f.Wj(h,n,r)||(v=d[r])&&delete d[r];else s[n]={};else for(r=a;r<a+u;r++)f&&0!==e&&f.Wj(h,n,r)||(v=d[r])&&delete d[r]})}},A.prototype.Qj=function(){var t,n,e,t,n=this.Fj();for(e in n)N(n,e)&&n[e]&&"e"===n[e].rs&&(n[e]={})},A.prototype.Kj=function(t){this.W_(t).lE++},A.prototype.Jj=function(t){var t,n,t=this.W_(t);t.lE--,(n=t.lE)<0&&(t.lE=0)},A.prototype.getName=function(){return this.name||""},A.prototype.setName=function(t){var n,e,n=this,e=n.name;e!==t&&(0<n.P8&&n.G8.push({type:"setName",value:e}),n.name=t)},A.prototype.Xj=function(){return this.isSelected},A.prototype.qj=function(t){this.isSelected=t},A.prototype.Mj=function(t){this.Mf.name(t)},A.prototype.Cj=function(t,n){var e,i,n,e=t.byRows?t.row:t.column;n||(i=[],t.array.map(function(t,n){i[t-e]=n+e})),this.Mf.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,rt,i),(n=t.sortState)?this.Mf.Tpe(n.row,n.col,n.rowCount,n.colCount,n.byRow,n.sortConditions):this.Mf.Ape()},A.prototype.getZoomFactor=function(){return this.zoomFactor},A.prototype.setZoomFactor=function(t){var n=this;0<n.P8&&n.G8.push({type:"setZoomFactor",value:n.zoomFactor}),n.zoomFactor=t},A.prototype.wj=function(t){this.Mf.zoom(t)},A.prototype.K_=function(t){return at(t)&&(t=3),this.spanModels[t]},A.prototype.d8=function(t){at(t)&&(t=3),this.spanModels[t]=new wt},A.prototype.getSpans=function(t,n,e){var i,r,o,a,r,i;return at(n)&&(n=3),t&&(i=t.row,r=t.col,o=t.rowCount,a=t.colCount),A.et(this,"getSpans",i={row:i,col:r,rowCount:o,colCount:a,isAll:!t,sheetArea:n,isSpansGet:!1,spans:[]}),r=i.isSpansGet?i.spans:this.K_(n).getSpans(t),r=e?r.filter(function(t){return!t.isAutoMerge}):r},A.prototype.getSpan=function(t,n,e){var i={row:t,col:n,sheetArea:e=at(e)?3:e,isSpansGet:!1,spans:[]};return A.et(this,"getSpans",i),i.isSpansGet?i.spans[0]||(0,nt.Ec)(t,n,1,1):this.K_(e).get(t,n)},A.prototype.Ci=function(t,n,e){var e,e;return at(e)&&(e=3),(e=this.W_(e))&&e.J_&&(e=e.J_(t,n))&&e.tipContent?e.tipContent:null},A.prototype.$n=function(t,n,e,i){at(i)&&(i=3);var r=this.W_(i).J_(t,n);!e&&r?delete r.tipContent:e&&r?r.tipContent=e:e&&!r&&((r=this.W_(i).J_(t,n,!0)).tipContent=e)},A.prototype.eE=function(t,n,e,i,r){return this.K_(r).eE(t,n,e,i)},A.prototype.GT=function(t,n,e,i,r){return this.K_(r).GT(t,n,e,i)},A.prototype.findSpan=function(t,n,e){var i={row:t,col:n,sheetArea:e=at(e)?3:e,isSpansGet:!1,spans:[]};return A.et(this,"getSpans",i),i.isSpansGet?i.spans[0]:this.K_(e).find(t,n)},A.prototype.removeSpan=function(t,n){at(n)&&(n=3);var e=0<this.P8?[["spanModels",n],ot]:ot;this.K_(n).remove(t,e),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"span",isClear:!0,sheet:this.Mf}),e&&0<e.length&&this.G8.push(e)},A.prototype.addSpan=function(t,n){at(n)&&(n=3);var e=0<this.P8?[["spanModels",n],ot]:ot;this.K_(n).add(t,e),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"span",range:t,isAdd:!0,sheet:this.Mf}),e&&0<e.length&&this.G8.push(e)},A.prototype.clearSpan=function(t,n,e,i,r){at(r)&&(r=3);var o=0<this.P8?[["spanModels",r],ot]:ot;this.K_(r).d5(t,n,e,i,o),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"span",isClear:!0,sheet:this.Mf}),o&&0<o.length&&this.G8.push(o)},A.prototype.moveSpan=function(t,n,e,i,r,o,a){at(a)&&(a=3);var u=0<this.P8?[["spanModels",a],ot]:ot;this.K_(a).iE(t,n,e,i,r,o,u),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"span"}),u&&0<u.length&&this.G8.push(u)},A.prototype.copySpan=function(t,n,e,i,r,o,a,u){at(a)&&(a=3);var s=0<this.P8?[["spanModels",a],ot]:ot;this.K_(a).tE(t,n,e,i,r,o,s,u),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"span"}),s&&0<s.length&&this.G8.push(s)},A.prototype._9=function(t,n,e,i){this.colHeaderSelectionModel.$j=new nt.Range(t,n,e,i)},A.prototype.J9=function(){return this.colHeaderSelectionModel.$j},A.prototype.addSelection=function(t,n,e,i,r,o){var a,u,s;if(1===o)this.colHeaderSelectionModel.add(t,n,e,i,ot);else if(a=0<this.P8?[]:ot,this.selectionModel.add(t,n,e,i,a,r),a)for(u=0;u<a.length;u++)(s=a[u])[0]=["selectionModel"].concat(s[0]),this.G8.push(s)},A.prototype.getSelections=function(t){return(1===t?this.colHeaderSelectionModel:this.selectionModel).get()},A.prototype.setSelections=function(t,n){var e,i,r;if(1===n)this.colHeaderSelectionModel.set(t,ot);else if(e=0<this.P8?[]:ot,this.selectionModel.set(t,e),e)for(i=0;i<e.length;i++)(r=e[i])[0]=["selectionModel"].concat(r[0]),this.G8.push(r)},A.prototype.clearSelection=function(t){var n,e,i;if(1===t)this.colHeaderSelectionModel.clear(ot);else if(n=0<this.P8?[]:ot,this.selectionModel.clear(n),n)for(e=0;e<n.length;e++)(i=n[e])[0]=["selectionModel"].concat(i[0]),this.G8.push(i)},A.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},A.prototype.setActiveSelectedRangeIndex=function(t){var n=0<this.P8?[["selectionModel"],ot]:ot;this.selectionModel.setProperty("activeSelectedRangeIndex",t,n),n&&this.G8.push(n)},A.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},A.prototype.setSelectionPolicy=function(t){fn(this,"selectionPolicy",t)},A.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},A.prototype.setSelectionUnit=function(t){fn(this,"selectionUnit",t)},A.prototype.T9=function(t){return this.selectionModel.T9(t)},A.prototype.S9=function(t){return this.selectionModel.S9(t)},A.prototype.ni=function(t,n,e,i,r,o){return this.selectionModel.ni(t,n,e,i,r,o)},A.prototype.ei=function(t,n,e,i,r){return this.selectionModel.ei(t,n,e,i,r)},A.prototype.Q_=function(t,n){var e;return at(n)&&(n=3),(t?this.rowInfos:this.colInfos)[n]},A.prototype.h8=function(t,n){var e;at(n)&&(n=3),(t?this.rowInfos:this.colInfos)[n]=new f},A.prototype.getPageBreak=function(t,n,e){var i;return this.Q_(t,n).getPageBreak(e)},A.prototype.setPageBreak=function(t,n,e,i){var r,o;at(n)&&(n=3),r=0<this.P8?[[t?b:w,n],ot]:ot,(o=this.Q_(t,n)).setPageBreak(e,i,r),r&&this.G8.push(r)},A.prototype.getVisible=function(t,n,e){var i;return this.Q_(t,n).getVisible(e)},A.prototype.setVisible=function(t,n,e,i){var r,o,a,i,r=this;at(n)&&(n=3),o=0<r.P8?[[t?b:w,n],ot]:ot,(a=r.Q_(t,n)).setVisible(e,i,o),o&&r.G8.push(o),i=t?et.AxisInfoChangeType.setRowVisible:et.AxisInfoChangeType.setColumnVisible,r.L8({type:i,index:e,sheetArea:n})},A.prototype.getResizable=function(t,n,e){var i;return this.Q_(t,n).getResizable(e)},A.prototype.setResizable=function(t,n,e,i){var r,o;at(n)&&(n=3),r=0<this.P8?[[t?b:w,n],ot]:ot,(o=this.Q_(t,n)).setResizable(e,i,r),r&&this.G8.push(r)},A.prototype.getSize=function(t,n,e){var i,r;return i={index:e,isRow:t,isSizeGet:!1,sheetArea:n=at(n)?3:n,size:ot},A.et(this,"getSize",i),i.isSizeGet?i.size:(r=this.Q_(t,n)).getSize(e)},A.prototype.getColumnHeaderFitMode=function(t,n,e){var i;return this.Q_(t,n).getColumnHeaderFitMode(e)},A.prototype.setColumnHeaderFitMode=function(t,n,e,i){var r,o,a,u,s,c,f,t,l,h,d,v,m,r=this,o=60,s=r.Mf,c=s.getRowCount(1);if(at(n)&&(n=3),r.P8&&(a=[[w,n],ot],u=[[b,n],ot]),l=(t=r.Q_(t,n)).getColumnHeaderFitMode(e),t.setColumnHeaderFitMode(e,i,a),d=!1,i===et.ColumnHeaderFitMode.vertical?(h=60,s.gD&&2===l&&s.gD--):i===et.ColumnHeaderFitMode.stack?(r.t7(e,n),s.gD||(s.gD=0),2!==l&&s.gD++):i===et.ColumnHeaderFitMode.normal&&(h=s.defaults.colHeaderRowHeight,s.gD)&&2===l&&s.gD--,h){for(v=r.Q_(!0,n),m=0;m<c;m++)f=s.getRowHeight(m,n),(h=p(h,f))!==f&&(v.setSize(m,W,u),u)&&(r.G8.push(u),u=[[b,n],ot]);s.defaults.colHeaderRowHeight=h}a&&r.G8.push(a)},A.prototype.t7=function(t,n){var e,i,r,o,a,u,s,c,f,l,e=this,o=e.Mf,a=e.Q_(!0,n);if(e.P8&&(i=[[b,n],ot]),u=e.Mf.defaults.rowHeight||m.DEFAULT_COL_HEADER_ROW_HEIGHT,c=e.getRowCount(et.SheetArea.colHeader),f=e.n7(t),!e.e7(t)){for(l=0;l<c;l++)r=u*f,s=o.getRowHeight(l,n),(r=p(r,s))!==s&&(a.setSize(l,W,i),i)&&(e.G8.push(i),i=[[b,n],ot]);o.defaults.colHeaderRowHeight=r}},A.prototype.e7=function(t){var n,e,i,e,n,n=this,e=n.Mf,i=e.frozenColumnCount()-1,e=e.frozenTrailingColumnCount(),n=n.getColumnCount()-1;return t===i||t===n||t===n-e},A.prototype.i7=function(t){var n,e,i,e,n,r,o,n=this,e=n.Mf,i=e.frozenColumnCount(),e=e.frozenTrailingColumnCount(),n=n.getColumnCount();return e&&(o=t===n-e),(r=i?t===i:r)||o},A.prototype.n7=function(t,n){for(var e,i,r,t,o,a,u,s,c,f,t,l,h,e=this,o=et.SheetArea.colHeader,a={},u=e.Mf,s=u.getColumnCount(),i=r=t=(n=n||e.Q_(!1,o).infos)[t]&&n[t].columnHeaderFitMode===et.ColumnHeaderFitMode.stack?t:t-1,c=t;0<=c;c--)if(u.getColumnWidth(c,o)){if(!n[c]||n[c].columnHeaderFitMode!==et.ColumnHeaderFitMode.stack||e.eE(-1,c,-1,1,et.SheetArea.colHeader))break;if(e.i7(c)){i=c;break}i=c}else a[i=c]=!0;for(c=t;c<s;c++)if(u.getColumnWidth(c,o)){if(!n[c]||n[c].columnHeaderFitMode!==et.ColumnHeaderFitMode.stack||e.eE(-1,c,-1,1,et.SheetArea.colHeader))break;if(e.e7(c))break;r=c}else if(a[r=c]=!0,e.e7(c))break;return t=r-i-(f=Object.keys(a).length)+1,l=1,!(h=u.O5(r,o,!0))||e.e7(r)||e.eE(-1,h,-1,1,et.SheetArea.colHeader)?t:1+t},A.prototype.r7=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=0,o=i.Mf,a=o.Ut;for(n=n||i.Q_(!1,et.SheetArea.colHeader).infos,u=i.o7(t),s=t-1;u<=s;s--)if(c=o.getColumnWidth(s))if(n[s]&&n[s].columnHeaderFitMode===et.ColumnHeaderFitMode.stack&&!a.eE(-1,s,-1,1,et.SheetArea.colHeader))r++;else if(!e||!n[s]||n[s].columnHeaderFitMode!==et.ColumnHeaderFitMode.vertical||a.eE(-1,s,-1,1,et.SheetArea.colHeader))return r;return r},A.prototype.i6=function(t,n){for(var e,i,r,o,a,e=this,i,r=e.Mf.getColumnCount(),a=t+1;a<r;a++)if((o=e.getColumnHeaderFitMode(!1,1,a))===n)return a;return rt},A.prototype.o7=function(t){var n,e,i,e,n,n=this,e=n.Mf,i=e.frozenColumnCount(),e=e.frozenTrailingColumnCount(),n=n.getColumnCount();return t<i?0:t<n-e?i:n-e},A.prototype.getStarSize=function(t,n,e){var i;return this.Q_(t,n).getStarSize(e)},A.prototype.getActualSize=function(t,n,e){var i;return this.Q_(t,n).getActualSize(e)},A.prototype.setSize=function(t,n,e,i){var r,o,a,o,r=this;at(n)&&(n=3),o=0<r.P8?[[t?b:w,n],ot]:ot,(a=r.Q_(t,n)).setSize(e,i,o),this.Mf.ki(nt.Events.WorksheetDataChanged,{type:"size"}),o&&r.G8.push(o),r.setStarSize(t,n,e,rt),o=t?et.AxisInfoChangeType.setRowHeight:et.AxisInfoChangeType.setColumnWidth,r.L8({type:o,index:e,value:i,sheetArea:n})},A.prototype.setStarSize=function(t,n,e,i){var r,o;at(n)&&(n=3),r=0<this.P8?[[t?b:w,n],ot]:ot,(o=this.Q_(t,n)).setStarSize(e,i,r),r&&!at(r[1])&&this.G8.push(r)},A.prototype._E=function(t,n){var e;return this.Q_(t,n)._E()},A.prototype.EE=function(t,n){var e;return this.Q_(t,n).EE()},A.prototype.q_=function(t,n,e){var i;return this.Q_(t,n).q_(e)},A.prototype.setItem=function(t,n,e,i){var r,o,a,u,r=this;at(n)&&(n=3),o=0<r.P8?[[t?b:w,n],ot]:ot,(a=r.Q_(t,n)).X_(e,i,o),i&&(at(i.size)||(u=t?et.AxisInfoChangeType.setRowHeight:et.AxisInfoChangeType.setColumnWidth,r.L8({type:u,index:e,value:i.size,sheetArea:n})),at(i.visible)||(u=t?et.AxisInfoChangeType.setRowVisible:et.AxisInfoChangeType.setColumnVisible,r.L8({type:u,index:e,sheetArea:n}))),o&&r.G8.push(o)},Dt=A,m.Y8=Dt,(0,nt.$e)(Dt,!0),jt=["=","+","-"],Ot=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,Et="__builtInStyle"},"./dist/core/worksheet/worksheet-render.js":function(o,t,ht){"use strict";var dt,vt,q,n,s,mt,gt,pt,d,bt,wt,Tt,C,$,tt,At,ot,yt,p,N,c,nt,et,it,A,j,O,w,y,M,f,l,Mt,k,rt,a,v,m,h,at,S,g,It,b,u,T,I,x,D,E,R,F,L,B,P,G;function Ct(t){return t.height}function St(t){return t.width}function U(t,n,e,i,r,o,a){t.beginPath(),t.lineWidth=n,t.strokeStyle=e,t.moveTo(i,r),t.lineTo(o,a),t.stroke()}function H(t,n){var e,t,i,e=0;return"string"==typeof t&&(1===(i=(t=t.split(" ",4)).length)?e=2*k(t[0]):2===i||3===i?e=2*k(t[1]):4===i&&(e=k(t[1])+k(t[3]))),e*n}function _(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,u,t,m,i,p,b,d,v,s=r.zoom(),c=s||1,f=e.font,l=e.textIndent,h=e.textOrientation,d=e.isVerticalText,v=e.textIndent&&0!==e.textIndent,m=0!==h&&!yt(h);return f=f?et(e,s).font:i,typeof u===at&&1!==u&&(f=nt(f,u).font,c=s*u),i=0,i=t&&t.richText?z(t.richText,f,s):t&&m&&!d&&!v?(u=w(h*Math.PI/180),t=y(u),m=M(u),e.wordWrap?(d=(b=r.Jt).Gt(o),q.q.Zt(o,a,t,m,n,f,d)):(v=$(f),q.q.Wt(n,f)*m+v*t)):q.q.Wt(n,f),g=(i+=Z(r,l,o,a,c)+S)+H(e.cellPadding,s)}function V(t,n,e){var i;if(t&&-90<=t&&t<=90)return l(e/f(w(t*Math.PI/180)))+n+4}function z(t,n,e){var t=s.GC$.extend(!0,[],t);return Y(t,n,e),q.q.ah(t,n,1)}function Y(t,n,e){for(var i,r,o,a,o,i=0,r=t;i<r.length;i++)a=void 0,(o=r[i]).style=o.style||{},a=(o=o.style).font?nt(o.font,e).font:n,o.font=a}function Z(t,n,e,i,r){if(!yt(e)&&!yt(i)&&t.outlineColumn){var t=t.outlineColumn.a7(e,i);if(t)return t}return n?8*n*r:0}function W(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,w,y,M,C,e,S,S,T,A,I;if(N(r.data)&&t.parent&&t.parent.options.numbersFitMode!==pt.NumbersFitMode.overflow)return it;if(c=t.Jt,f=St(r),l=St(r),d=r.style,m=r.text,g=r.printZoomFactor,p=d.watermark,b=d.wordWrap,w=d.textOrientation,C=t.options.allowCellOverflow,n.findCell(o,a))return it;if(d.cellButtons&&0<d.cellButtons.length)return it;if(bt.W.Xue(d))return it;if(e=d.cellType||e,S=(S=t.parent&&t.parent.options.numbersFitMode)===pt.NumbersFitMode.mask||S===pt.NumbersFitMode.overflow&&!N(r.data),!e.allowOverflow||!m&&!p||!w&&b&&S)return it;if(!C&&!w)return it;if((y=_(r.data,m=m||p,d,i,t,o,a,g))<=l)return it;if(90===Math.abs(w)&&b)return it;for(v=(A=T=a)+(s?1:-1);(s?v<=u:u<=v)&&!n.findCell(o,v)&&(M=c.qt(o,v),h=c.$t(o,v,3,1,M),I=M.textOrientation,yt(h)||I&&w)&&!M.watermark&&!(M.cellType&&"1"!==M.cellType.typeName||M.cellButtons&&0<M.cellButtons.length||bt.W.Xue(M))&&(s?A=v:T=v,!(y<=(l+=c.Kt(v))));v+=s?1:-1);return s&&A===a||!s&&T===a?it:new mt.Q8(a,T,A,y,f,l,s?-1:l,s?l:-1)}function e(t,n,e){var i=this;i.Mf=t,i.Vx=t.Yy(e),i.u7=t.s7(n,e,pt.SheetArea.viewport,!0),i.c7=nt(t.Dn.Nn(),t.zoom()).font,i.f7=t.$f(),i.l7={}}function Q(t){var n,e,n=t.parent,e={nps:!0};return vt.Worksheet.et(t,"needPaintSelection",e),(q.hi.A1(t)||n&&!n.options.hideSelection)&&e.nps}function ut(t){var t=t.parent;return t&&t.options.backColor||h}function i(t){this.Mf=t}function r(t){var n=this;n.h7=!1,n.d7=!1,n.Mf=t,n.v7()}Object.defineProperty(t,"__esModule",{value:!0}),t.m7=t.g7=t.needPaintSelection=t.p7=void 0,dt=ht("Common"),vt=ht("./dist/core/worksheet/worksheet.js"),q=ht("./dist/core/util/common.js"),n=ht("./dist/core/worksheet/stylehelper.js"),s=ht("./dist/core/util/domUtil.js"),mt=ht("./dist/core/worksheet/worksheet-model.js"),gt=ht("./dist/core/worksheet/worksheet-border.js"),pt=ht("./dist/core/core.enum.js"),d=ht("./dist/core/celltype/basecelltype.js"),bt=ht("./dist/core/worksheet/stylehelper.js"),wt=function(t){return t.getSparkline},Tt=dt.Common.Uf,C=q.mt.gt,$=q.mt.vt,tt=q.mt.bt,At=q.mt.St,ot=q.mt.Tt.safari,yt=dt.Common.lt.ht,p=dt.Common.lt.q8,N=q.mt.Ct,c=n.p5,nt=n.W.V,et=n.W.Lge,it=null,A=void 0,j=Math.min,O=Math.max,w=Math.abs,y=Math.sin,M=Math.cos,f=Math.tan,l=Math.floor,Mt=Math.round,k=parseInt,rt="black",a="transparent",v="rowHeader",m="columnHeader",h="white",at="number",S=2,g=100,e.prototype.b7=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i.l7[t];if(r)return r;if(a=(o=i.Vx).length,u=new mt.K8,n=n||q.q.J(),0<a){for(u.headingOverflowLayouts=i.y7(t,n),c=0;c<a;c++)(s=this.w7(t,c,n,e))&&u.push(s);u.trailingOverflowLayouts=i.C7(t,n)}return i.l7[t]=u},e.prototype.w7=function(t,n,e,i){var r,o,a,u,s,c,f,l,u,h,d,v,u,n,a,m,g,p,s,b,n,u,n,u,n,a,w,r=this,o=r.Mf,a=o.Jt,u=r.Vx,s=u.length;if(0!==s&&(p=u[0].col,s=u[s-1].col,e=e||q.q.J(),!(St(u=u[n])<=0))&&(h=u.col,d=a.o2e(t,h),v=a.$t(t,h,3,1),c=d.textOrientation,f=d.isVerticalText,l=d.textIndent&&0!==d.textIndent,b=d&&(d.borderLeft||d.borderTop||d.borderRight||d.borderBottom),!yt(v)||d.watermark||d.cellType)&&(n=o.parent&&o.parent.options.numbersFitMode,!((d.shrinkToFit||!c&&d.wordWrap&&(n===pt.NumbersFitMode.mask||n===pt.NumbersFitMode.overflow&&!N(v))||f)&&4!==d.hAlign||4!==d.hAlign&&!1===o.options.allowCellOverflow||(u=o.conditionalFormats)&&(u=(n=u.U(o,t,h,v,3))&&n.dataBar,n=n&&n.iconSet,u&&u.showBarOnly||n&&n.showIconOnly))))return u=a.Kt(h),n=a.Gt(t),a=d.cellType||r.f7,m=q.Be.Cl(o,d,v,w={},{row:t,col:h,sheet:o}),w.content&&0<w.content.length&&!d.shrinkToFit&&c&&(m=a.de(e,w.content,n-4,d.font)),3===(a=d.hAlign)&&(a=C(a,v,d.formatter||d._autoFormatter,c)),!b||!c||f&&4!==a||l?0===a?g=r.S7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,s):2===a?g=r.T7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,p):1===a?g=r.A7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,p,s):4===a&&(g=r.I7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,0,o.getColumnCount()-1)):c<0&&-90<c?g=r.x7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,p):0<c&&c<90&&(g=r.x7({data:v,style:d,width:u,text:m,printZoomFactor:i},t,h,s,!0)),g},e.prototype.N7=function(t){for(var n,e,i,r,o,a,u,s,c,f,n=this,e=n.Vx,i=e.length,r,o=n.Mf.Jt,f=i-1;0<=f;f--)if(c=(a=e[f]).col,u=o.qt(t,c),(s=o.$t(t,c,3,1))||u.watermarks)return this.w7(t,f)},e.prototype.S7=function(t,n,e,i){var r=this;return W(r.Mf,r.u7,r.f7,r.c7,t,n,e,i,!0)},e.prototype.T7=function(t,n,e,i){var r=this;return W(r.Mf,r.u7,r.f7,r.c7,t,n,e,i)},e.prototype.x7=function(t,n,e,i,r){var o,a,u,s,o,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,o=this,a=o.Mf,u=o.u7,s=o.f7,o=o.c7,c=a.Jt,f=St(t),l=St(t),h=t.style,v=t.text,m=t.printZoomFactor,g=h.watermark,p=h.wordWrap,b=h.textOrientation,M=h&&(h.borderLeft||h.borderTop||h.borderRight||h.borderBottom),C=h.isVerticalText,S=h.textIndent&&0!==h.textIndent,T=a.options.allowCellOverflow;if(u.findCell(n,e))return it;if(h.cellButtons&&0<h.cellButtons.length)return it;if(bt.W.Xue(h))return it;if(!(A=h.cellType||s).allowOverflow||!v&&!g||!b&&p)return it;if(v=v||g,!T&&!b)return it;if((w=!M||C||S?_(t.data,v,h,o,a,n,e,m):V(b,c.Kt(e),c.Gt(n)))<=l)return it;for(d=(x=I=e)+(r?1:-1);(r?d<=i:i<=d)&&!u.findCell(n,d)&&!(y=c.qt(n,d)).watermark&&!(y.cellType&&"1"!==y.cellType.typeName||y.cellButtons&&0<y.cellButtons.length||bt.W.Xue(y))&&(r?x=d:I=d,!(w<=(l+=c.Kt(d))));d+=r?1:-1);return r&&x===e||!r&&I===e?it:new mt.Q8(e,I,x,w,f,l,r?-1:l,r?l:-1)},e.prototype.A7=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x;if(N(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==pt.NumbersFitMode.overflow)return it;if(u=(a=(o=this).Mf).Jt,s=o.u7,c=St(t),f=St(t),h=t.style,v=t.text,m=t.printZoomFactor,g=h.textOrientation,p=h.watermark,b=h.wordWrap,M=a.options.allowCellOverflow,s.findCell(n,e))return it;if(h.cellButtons&&0<h.cellButtons.length)return it;if(bt.W.Xue(h))return it;if(!(C=h.cellType||o.f7).allowOverflow||!v&&!p||!g&&b&&a.parent&&a.parent.options.numbersFitMode!==pt.NumbersFitMode.overflow)return it;if(!M&&!g)return it;if((w=_(t.data,v=v||p,h,o.c7,a,n,e,m))<=f)return it;if(90===Math.abs(g)&&b)return it;for(T=f/2,d=(S=e)-1;i<=d&&!s.findCell(n,d)&&(y=u.qt(n,d),l=u.$t(n,d,3,1,y),A=y.textOrientation,yt(l)||A&&g)&&!y.watermark&&!(y.cellType&&"1"!==y.cellType.typeName||y.cellButtons&&0<y.cellButtons.length||bt.W.Xue(y))&&(S=d,!(w/2<=(T+=u.Kt(d))));d--);for(x=f/2,d=(I=e)+1;d<=r&&!s.findCell(n,d)&&(y=u.qt(n,d),l=u.$t(n,d,3,1,y),A=y.textOrientation,yt(l)||A&&g)&&!y.watermark&&!(y.cellType&&"1"!==y.cellType.typeName||y.cellButtons&&0<y.cellButtons.length||bt.W.Xue(y))&&(I=d,!(w/2<=(x+=u.Kt(d))));d++);return S===I?it:new mt.Q8(e,S,I,w,c,T+x,T,x)},e.prototype.k7=function(t,n,e){var i,t,i=t.qt(n,e),t=t.$t(n,e,3,1,i);return!(!i.textOrientation&&!yt(t)||i.watermark||i.cellType&&"1"!==i.cellType.typeName||i.cellButtons&&0<i.cellButtons.length||bt.W.Xue(i))},e.prototype.I7=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,g,b,v,w,y,M,C,S,T,A,I,o=this,a=o.Mf,u=a.Jt,s=o.u7,c=St(t),l=t.style,h=l.shrinkToFit,v=t.text,m=t.printZoomFactor,g=l.watermark,p=l.wordWrap;if(s.findCell(n,e))return it;if(l.cellButtons&&0<l.cellButtons.length)return it;if(bt.W.Xue(l))return it;for(g=_(t.data,v=v||g,l,o.c7,a,n,e,m),y=u.Kt(w=v=e),M=v+1;M<=r&&(b=u.qt(n,M),f=u.$t(n,M,3,1,b),yt(f)&&4===b.hAlign&&yt(a.getSpan(n,M)))&&!b.watermark&&!(b.cellType&&"1"!==b.cellType.typeName||b.cellButtons&&0<b.cellButtons.length||bt.W.Xue(b));M++)w=M,y+=u.Kt(M);if(C=(g-y)/2,N(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==pt.NumbersFitMode.overflow&&(C=0),S=v,A=w,I=T=y/2,!h&&!p&&!1!==a.options.allowCellOverflow){for(d=e-1;i<=d&&0<C&&(this.k7(u,n,d)&&!s.findCell(n,d))&&(S=d,!(C<=(T+=u.Kt(d))-y/2));d--);for(d=w+1;d<=r&&0<C&&(this.k7(u,n,d)&&!s.findCell(n,d))&&(A=d,!(C<=(I+=u.Kt(d))-y/2));d++);}return new mt.Q8(e,S,A,g,c,T+I,T,I,y)},e.prototype.y7=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,f,p,b,w,y,e=this,i=e.Mf,r=i.Jt,o=e.Vx;if(0===o.length)return[];for(a=o[0].col,u=o[o.length-1].col,s=i.Ut,w=[],n=n||q.q.J(),y=1;y<100;y++){if((v=a-y)<0)return w;if(s.findSpan(t,v)||i.Cb&&i.Cb.D7(t,v,pt.SheetArea.viewport))return w;f=r.$t(t,v,3,1),0<(l=r.Kt(v))&&!yt(f)&&(4!==(d=(c=r.qt(t,v)).hAlign)&&!1===i.options.allowCellOverflow||(3===d&&(d=C(d,f,A,c.textOrientation)),h=r.Gt(t),p=c.cellType||e.f7,g=q.Be.Cl(i,c,f,b={},{row:t,col:v,sheet:i}),f={data:f,style:c,width:l,text:g=b.content&&0<b.content.length&&!c.shrinkToFit&&c.textOrientation?p.de(n,b.content,h-4,c.font):g},0<c.textOrientation&&c.textOrientation<90?m=e.x7(f,t,v,u,!0):0===d?m=e.S7(f,t,v,u):1===d?m=e.A7(f,t,v,a,u):4===d&&(m=e.I7(f,t,v,a,u)),m&&m.endColumn>=a&&w.push(m)))}return w},e.prototype.C7=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,f,y,M,e=this,i=e.Mf,r=i.Jt,o=e.Vx;if(0===o.length)return[];for(a=o[0].col,u=o[o.length-1].col,s=i.Ut,g=i.getColumnCount(),y=[],n=n||q.q.J(),M=1;M<100;M++){if(g<=(p=u+M))return y;if(s.findSpan(t,p)||i.Cb&&i.Cb.D7(t,p,pt.SheetArea.viewport))return y;f=r.$t(t,p,3,1),0<(l=r.Kt(p))&&!yt(f)&&(4!==(d=(c=r.o2e(t,p)).hAlign)&&!1===i.options.allowCellOverflow||(3===d&&(d=C(d,f,A,c.textOrientation)),h=r.Gt(t),v=c.cellType||e.f7,w=q.Be.Cl(i,c,f,m={},{row:t,col:p,sheet:i}),f={data:f,style:c,width:l,text:w=m.content&&0<m.content.length&&!c.shrinkToFit&&c.textOrientation?v.de(n,m.content,h-4,c.font):w},c.textOrientation<0&&-90<c.textOrientation?b=e.x7(f,t,p,a,!1):2===d?b=e.T7(f,t,p,a):1===d?b=e.A7(f,t,p,a,u):4===d&&(b=e.I7(f,t,p,0,u+100)),b&&b.startColumn<=u&&y.push(b)))}return y},It=e,t.p7=It,t.needPaintSelection=Q,i.prototype.xpe=function(t,n){var e,i,n,e=this.Mf,i=e.getParent(),n={sheetArea:t,isPrinting:n,isNeedHighlightInvalid:!n&&3===t&&i&&i.options.highlightInvalidData};return vt.Worksheet.et(e,"sheetHighlightInvalid",n),n.isNeedHighlightInvalid},i.prototype.J=function(){var t,n,t,t=this.Mf,n=it,t=t.Dg();return n=t&&t.getContext?t.getContext("2d"):n},i.prototype._7=function(){var t,n,e,i,r,i,o,r,t=this,n=t.Mf,e=n.ot(),i=n.fg,r=St(i),i=Ct(i),o=t.E7;return o&&St(o)===r&&Ct(o)===i||(o&&q.Bf.th(n,o),t.E7=o=q.mt.En("canvas"),o.getContext&&(t.j7=o.getContext("2d"),q.Bf.Wl(o,it,n),q.Bf.$l(o,St(e),Ct(e)))),(r=t.j7)&&(r.beginPath(),tt(r,t._n(t.Nn())),r.name="bufferContext"),r},i.prototype.Nn=function(){return this.c7||(this.c7=c+" "+this.Mf.currentTheme().bodyFont()),this.c7},i.prototype.O7=function(){this.c7=it},i.prototype.R7=function(t){var n,e,i,n,r,n=this.Mf,e=n.parent,i=e?e.options.grayAreaBackColor||q.I.ll("gc-grayArea").backgroundColor:"gray",n=q.Pf.vl(n,i);return n=t&&(r=e?e.options.backgroundImage:it)?a:n},i.prototype._n=function(t){var n,e=this.Mf.zoom();return 1===e?t:nt(t,e).font},i.prototype.FA=function(t,n,e,i,r){var o,a,u,o,s,r,r,r,o=this,a=o.E7,u=o.J();!(e<=0||i<=0)&&a&&u&&(r=r||o.Mf.ot(),o=q.Bf.Kl(a),s=q.Bf.Jl(a),1!==o&&(t*=o,n*=s,e*=o,i*=s,r=new q.Rect(r.x*o,r.y*s,St(r)*o,Ct(r)*s)),r=r.getIntersect(t,n,e,i))&&(r.round(),t=r.x,n=r.y,e=St(r),i=Ct(r),(r=St(a))&&r<t+e&&(t=r-e)<0&&(e+=t,t=0),(r=Ct(a))&&r<n+i&&(n=r-i)<0&&(i+=n,n=0),q.Lf.Vl(u,1,1),u.clearRect(t,n,e,i),u.drawImage(a,t,n,e,i,t,n,e,i),q.Lf.Vl(u,o,s))},i.prototype.O1=function(t,n){t&&this.FA(t.x,t.y,St(t),Ct(t),n)},i.prototype.Ey=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M;if(0<e&&0<i)try{u=(a=this).Mf,s=a.J(),c=u.Dg(),f=a._7(),l=a.E7,v=r,m=o,g=e,p=i,b=q.Bf.Kl(c),w=q.Bf.Jl(c),t=Mt(t*b),n=Mt(n*w),e=Mt(e*b),i=Mt(i*w),v=Mt(v*b),m=Mt(m*w),g=Mt(g*b),p=Mt(p*w),y=St(l),M=Ct(l),y&&y<t+e&&(t=y-e)<0&&(e+=t,t=0),M&&M<n+i&&(n=M-i)<0&&(i+=n,n=0),y&&y<v+g&&(v=y-g)<0&&(g+=v,v=0),M&&M<m+p&&(m=M-p)<0&&(p+=m,m=0),q.Lf.Vl(s,1,1),q.Lf.Vl(f,1,1),s.clearRect(v,m,g,p),s.drawImage(l,t,n,e,i,v,m,g,p),f.clearRect(v,m,g,p),f.drawImage(c,v,m,g,p,v,m,g,p),q.Lf.Vl(s,b,w),q.Lf.Vl(f,b,w)}catch(t){}},i.prototype.E1=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,s,M,C,M,S,T,A,I,I,x,I,T,A,S,S,t,S,x,T,N,k,_,D,A,a=this,u=a.Mf,s=yt(r)||3===r;if(e=e||a.J(),f=(c=!1,q.Ec)(-1,-1,-1,-1),l=u.Ut,t&&(f=u.options.allowCellOverflow||u.gD?(0,q.Ec)(t.row,0,t.rowCount,u.getColumnCount(r)):(0,q.Ec)(t.row,t.col,t.rowCount,t.colCount),s)&&!o){if(0<=f.col){for(d=f.col,v=f.col+f.colCount-1,m=u.getRowCount(1),g=0;g<m;g++)(h=l.findSpan(g,f.col,1))?d=j(h.col,d):u.z9&&(d=j(u.z9.col,d)),(h=l.findSpan(g,f.col+f.colCount-1,1))?v=O(h.col+h.colCount-1,v):u.z9&&(v=O(u.z9.col+u.z9.colCount-1,v));f.col=d,f.colCount=v-d+1}if(0<=f.row){for(p=f.row,b=f.row+f.rowCount-1,w=u.getColumnCount(2),y=0;y<w;y++)(h=l.findSpan(f.row,y,2))?p=j(h.row,p):u.z9&&(p=j(u.z9.row,p)),(h=l.findSpan(f.row+f.rowCount-1,y,2))?b=O(h.row+h.rowCount-1,b):u.z9&&(b=O(u.z9.row+u.z9.rowCount-1,b));f.row=p,f.rowCount=b-p+1}}if(s=u.j1(f,r),u.cellStates&&u.cellStates.hasIntersectInSelectionState(f.row,f.col,f.rowCount,f.colCount)&&u.repaint(s),C=(M=u._1)&&M.isEnable(pt.RowColumnStates.selected,!0),M=M&&M.isEnable(pt.RowColumnStates.selected,!1),t&&(S=void 0,(C||M)&&(S=u.s7(u.C0(t.row),u.S0(t.col),pt.SheetArea.viewport,!1)),C&&(T=t.row,A=t.rowCount,S&&0<S.length&&(I=S.findLargestRange(t,!0))&&(I=(0,q.Ec)(I.row,I.col,I.rowCount,I.colCount),T=(x=t.union(I)).row,A=x.rowCount),I=u.j1((0,q.Ec)(T,-1,A,-1),r),s.x=j(s.x,I.x),s.y=j(s.y,I.y),s.width=O(s.width,I.width),s.height=O(s.height,I.height)),M)&&(T=t.col,A=t.colCount,S&&0<S.length&&(S=S.findLargestRange(t,!1))&&(S=(0,q.Ec)(S.row,S.col,S.rowCount,S.colCount),T=(x=t.union(S)).col,A=x.colCount),I=u.j1((0,q.Ec)(-1,T,-1,A),r),s.x=j(s.x,I.x),s.y=j(s.y,I.y),s.width=O(s.width,I.width),s.height=O(s.height,I.height)),t=St(s),S=Ct(s),x=s.x,T=s.y,0<=t||0<=S){if(_=18,D=30,s.x+=k=N=-9,s.y+=-9,s.width+=18,s.height+=30,n&&!(s=s.getIntersectRect(n)))return;A=u.Fi(),0<S&&!o&&(u.k1=!0,a._e(e,new q.Rect(A.x,O(A.T6,T),A.XC,S),i)),0<t&&!o&&(u.k1=!0,a._e(e,new q.Rect(O(A.b6,x),A.y,t,A.qC),i)),-1!==f.row||-1!==f.col||o||(u.k1=!0,a._e(e,A.R1(),i)),0<t&&0<S&&((C||M)&&(u.k1=!0),a._e(e,s,i)),c=!0}return c},i.prototype._6=function(t,n,e,i,r){var o,a,u,o=this,a=o.Mf;a.My<=0&&(u=o.J())&&(r||(a.k1=!0),o._e(u,new q.Rect(t,n,e,i)))},i.prototype.repaint=function(t){var n,e,i,n=this,e=n.Mf;0<e.My||(i=n.J())&&(e.k1=!0,n._e(i,t))},i.prototype._e=function(t,n,e){var i=this;t&&i.Mf.My<=0&&(e||i.D1(t,n),i.jy(t,n))},i.prototype.D1=function(t,n,e){var i,r,o,t,a,i=this,r=i.Mf;t&&r.My<=0&&(t=(o=i._7())||t,a=r.ot(),(n=n||a)&&n.round(),e&&e.round(),r.k1&&(r.k1=!1,o&&(o.clearRect(n.x,n.y,St(n),Ct(n)),e&&o.clearRect(e.x,e.y,St(e),Ct(e)),q.Lf.Yl(o,-a.x,-a.y)),i.B7(t,n),e&&i.B7(t,e),o)&&q.Lf.Yl(o,a.x,a.y),o)&&(i.O1(n),e)&&i.O1(e)},i.prototype.jy=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.Mf,r=i.Oi;if(t&&!(0<i.My)&&(n&&n.round(),o=i.Fi(),vt.Worksheet.et(i,"beforePaintAdornment",{ctx:t,clipRect:n}),!i.D_)){if(r){for(a=o.R1(),e.O1(a),s=0;s<=2;s++)(a=o.B1(s))&&0!==St(a)&&0!==Ct(a)&&e.O1(a);for(c=0;c<=2;c++)(a=o.L1(c))&&0!==St(a)&&0!==Ct(a)&&e.O1(a)}else if(i.NMi&&i.NMi.options.isDesignMode)for(c=0;c<=2;c++)!(a=o.L1(c))||0===St(a)||0===Ct(a)||(u=n)&&!a.intersectRect(u)||e.L7(t,-1,c,u,1);for(s=0;s<=2;s++)for(c=0;c<=2;c++)(a=o.c9(s,c))&&0!==St(a)&&0!==Ct(a)&&(u=n,(r&&(1!==s||1!==c)||i.parent&&i.parent.options.allowUserDragMerge)&&(e.O1(a),u=a),u&&!a.intersectRect(u)||e.L7(t,s,c,u));e.F7(t),vt.Worksheet.et(i,"paintAdornment",{ctx:t,clipRect:n})}},i.prototype.wm=function(t,n){var e,i,i,r,e,o,e=this.Mf,i=e.parent,i=i?i.options:{},r=ut(e),e=q.Pf.vl(e,r),o;i.backgroundImage&&(e=a),t.save(),t.fillStyle=e,t.fillRect(n.x,n.y,St(n),Ct(n)),t.restore()},i.prototype.P7=function(t,n){var e,i,r,e=this.Mf,i=e.Fi(),r=0<e.frozenRowCount()?0:1;return 0===i.qC&&(t===e.getViewportTopRow(r)||n)},i.prototype.G7=function(t,n){var e,i,r,e=this.Mf,i=e.Fi(),r=0<e.frozenColumnCount()?0:1;return 0===i.XC&&(t===e.getViewportLeftColumn(r)||n)},i.prototype.U7=function(t,n,e,i,r){var o,a,u,i,s,c,s,e,o=this,a=o.Mf,u=0===i.width,i=0===i.height,s=a.options,c=s.sheetAreaOffset.top,s=s.sheetAreaOffset.left,e=e.c9(t,n);return e&&(i&&o.P7(a.H7(t),r)&&(e.y=e.y-c,e.height=e.height+c),u)&&o.G7(a.z7(n),r)&&(e.x=e.x-s,e.width=e.width+s),e},i.prototype.V7=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,o,r=this,o=r.Mf,a=o.options,u=o.Fi(),s=a.sheetAreaOffset.top,c=a.sheetAreaOffset.left,f=0!==u.qC,l=0!==u.XC,h=o.gj&&o.gj()||{x:a.sheetAreaOffset.left,y:a.sheetAreaOffset.top,width:0,height:0},d=0===h.width,v=0===h.height,g=0;g<=2;g++)(b=u.L1(g))&&(f&&v&&(b.y=b.y-s,b.height=b.height+s,!l)&&d&&(b.x=b.x-c,b.width=b.width+c),p=n?b.getIntersectRect(n):b)&&r.Y7(t,g,p,e,i);for(m=0;m<=2;m++)for((w=u.B1(m))&&(l&&d&&(w.x=w.x-c,w.width=w.width+c,!f)&&v&&(w.y=w.y-s,w.height=w.height+s),p=n?w.getIntersectRect(n):w)&&r.Z7(t,m,p,e,i),g=0;g<=2;g++)(y=r.U7(m,g,u,h,e))&&(p=n?y.getIntersectRect(n):y)&&r.W7(t,m,g,p,e,i);(o=u.R1())&&(p=n?o.getIntersectRect(n):o)&&r.Q7(t,p,e,i)},i.prototype.K7=function(t){var n,e,i,r,o,a,u,s,c,f,l,i,h,n=this,e=n.Mf,i=e.Fi(),r=i.BA,o=i.LA,a=St(i),u=i.Ay,s=i.Iy,c=i.J7,f=i.Uy,l=i.X7,i=i.Ty;0<i&&(t.fillStyle=n.R7(!1),t.fillRect(r,l,a,i)),0<f&&(t.fillStyle=n.R7(!1),t.fillRect(c,o,f,l),h=e.Ny)&&t.fillRect(c,u,f,s)},i.prototype.q7=function(t,n){var e,i,r,i,o,i,a,u,s,n,e=this,i=e.Mf,r=e.R7(!1),i=i.options,o=i.sheetAreaOffset.left,i=i.sheetAreaOffset.top,a=n.x,u=n.y,s=St(n),n=Ct(n);t.save(),0<o&&U(t,o,r,a+o/2,0<i?u+i:u,a+o/2,u+O(0,n)),0<i&&U(t,i,r,0<o?a+o:a,u+i/2,a+O(0,s),u+i/2),0<o&&0<i&&(t.fillStyle=e.R7(!1),t.fillRect(a,u,o,i)),t.beginPath(),t.restore()},i.prototype.B7=function(t,n){var e,i,r,e=this,i=e.Mf;!t||0<i.My||(r=i.ot(),t.save(),n?t.rect(n.x,n.y,St(n),Ct(n)):t.rect(r.x,r.y,St(r),Ct(r)),t.clip(),t.beginPath(),e.wm(t,r),vt.Worksheet.et(i,"paint",{ctx:t,clipRect:n}),e.q7(t,r),e.V7(t,n,!1),e.K7(t),e.tO(t),vt.Worksheet.et(i,"paintSheetEnd",{ctx:t,clipRect:n}),t.beginPath(),t.restore())},i.prototype.nO=function(t,n,e){var i,r,r,n,i=this,r=i.Mf;t&&(r=r.ot(),t.save(),n=n||new q.Rect(r.x,r.y,St(r),Ct(r)),t.rect(n.x,n.y,St(n),Ct(n)),t.clip(),t.beginPath(),i.wm(t,r),i.V7(t,n,!0,e),t.beginPath(),t.restore())},i.prototype.F7=function(t){var n,e,i,r,o,a,u,s,c,s,c,u,u=this.Mf,s=u.rt,c=u.sw;if(s&&s.isResizing&&c&&(s=c.resizeInfo)){if(c=u.Fi(),u=rt,t.save(),t.strokeStyle!==u&&(t.strokeStyle=u),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(e=O(0,s.startY-.5),r=s.movingY-.5,o=c.x+St(c),n=c.x;n<o;n+=2)t.moveTo(n,e),t.lineTo(n+1,e),t.moveTo(n,r),t.lineTo(n+1,r);else for(n=O(0,s.startX-.5),i=s.movingX-.5,a=c.y+Ct(c),e=c.y;e<a;e+=2)t.moveTo(n,e),t.lineTo(n,e+1),t.moveTo(i,e),t.lineTo(i,e+1);t.stroke(),t.beginPath(),t.restore()}},i.prototype.TCe=function(){q.Lf.d5(this.E7),this.E7=null,this.j7=null},i.prototype.Q7=function(t,n,e,i){var r,o,a,u,s,o,c,c,r=this.Mf;t.beginPath(),a=(o=r.Fi().R1()).x,u=o.y,s=St(o),o=Ct(o),c=r.getActualStyle(-1,-1,0),this.eO(t,[{data:it,row:-1,col:-1,x:a,y:u,width:s,height:o,style:c.clone()}],0,e,i),(c=new gt.Yx(r,r._y(0,0),r.Yy(0,0),0)).PN(0,0,a,u,s,o,it,it,it,it,{printZoomFactor:i}),c.paint(t,i)},i.prototype.tO=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,a,n=this.Mf,e=n.frozenRowCount(),i=n.frozenColumnCount(),r=n.frozenTrailingRowCount(),o=n.frozenTrailingColumnCount();(e||i||r||o)&&(u=(a=n.Fi()).Py,s=a.Cy,c=a.Hy,f=a.Ay,l=a.x,h=a.y,d=St(a),a=Ct(a),t.save(),t.strokeStyle=q.Pf.vl(n,n.options.frozenlineColor),t.lineWidth=1,t.beginPath(),i&&(t.moveTo(u-.5,h),t.lineTo(u-.5,h+a)),e&&(t.moveTo(l,s-.5),t.lineTo(l+d,s-.5)),o&&(t.moveTo(c-.5,h),t.lineTo(c-.5,h+a)),r&&(t.moveTo(l,f-.5),t.lineTo(l+d,f-.5)),t.stroke(),t.restore())},i.prototype.Y7=function(t,n,e,i,r){this.iO(t,-1,n,1,e,i,r)},i.prototype.Z7=function(t,n,e,i,r){this.iO(t,n,-1,2,e,i,r)},i.prototype.W7=function(t,n,e,i,r,o){var a,a,u,s,c,r,a=this.Mf,a=a.getCalcService&&a.getCalcService(),u=a&&a.rO;for(s in u)u[s].getSource().startCalculation();if(this.iO(t,n,e,3,i,r,o),u)for(s in c=!a.calcOnDemand,u)u[s].getSource().endCalculation(c);(r=this.Mf.lA)&&r.oO(t,i,n,e)},i.prototype.aO=function(t,n,e,i,r){var o,a,u,a,n,e,o,a=this.Mf,u=a.getRangeRect(n,e,(0,q.Ec)(r.row,r.col,r.rowCount,r.colCount));(u=u.getIntersectRect(a.Fi().c9(n,e)))&&(u.round(),a=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",a||t.setLineDash([6,2]),n=u.x+.5,e=u.y+.5,t.strokeRect(n,e,St(u),Ct(u)),t.beginPath(),t.restore())},i.prototype.L7=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,p,b,w,y,p,M,C,S,T,l,S,l,A,I,x,T,S,l,A,o=yt(r)||3===r,a=this,u=a.Mf;if(Q(u)&&u.addSelection&&(l=u.Ut,h=u.rt,v=(d=l.getSelections(r)).length,i=a.uO(n,e,i))&&(m=q.I.fl("gc-selection"),g=k(m.zIndex),o&&(2007<g&&a.sO(t,n,e,i),p=u.Uw&&u.Uw(3),p=l.cO=p&&p.t8.getAnchorInfo(u.getActiveRowIndex(),u.getActiveColumnIndex()))&&a.aO(t,n,e,i,p),y=void 0,!((w=(b=a.fO(n,e,d,i)).length)<=0))){for(p=o&&a.fO(n,e,[u.z9],i)[0],M=!1,C=void 0,C=0;C<w;C++)if(y=b[C],!i.containsRect(y)){M=!0;break}if(p&&!i.containsRect(p)&&(M=!0),t.save(),M&&(t.rect(i.x,i.y,St(i),Ct(i)),t.clip()),t.beginPath(),0<w)for(f=q.Pf.vl(u,u.getSelectionBackColor()),t.fillStyle!==f&&(t.fillStyle=f),c=s=0,2007<g&&(s=1,c=-3),C=0;C<w;C++)y=b[C],t.fillRect(y.x+s,y.y+s,St(y)+c,Ct(y)+c);u.RD||(S=u.ui,T=u.ci,1===r?(S=(l=l.J9()||d[0]).row,T=l.col):p&&(S=u.U9,T=u.H9),x=I=A=l=void 0,(S=u.getCellRect(S,T,n,e))&&S.intersectRect(i)&&(l=S.x,A=S.y,I=St(S),x=Ct(S),s=1,c=-2,2007<g&&(c=s=0),a.FA(l+s,A+s,I+c,x+c),1<v)&&(t.strokeStyle=q.Pf.vl(u,u.getSelectionBorderColor()),t.lineWidth=1,t.strokeRect(l+1.5,A+1.5,I-4,x-4))),t.restore(),t.save(),t.beginPath(),1===v&&(o&&h&&h.Yk&&h.lO&&h.lO()&&!h.hO&&(T=h.dO&&h.dO(),l=St(S=u.getRangeRect(n,e,T)),A=Ct(S),S)&&0<l&&0<A&&(t.fillStyle=m&&m.color,t.fillRect(S.x,S.y,l,A)),y)&&0<=St(y)&&0<=Ct(y)&&(a.vO(i,u,n,e,g),a.mO(t,n,e,y,i,d[0],r)),p&&(t.save(),M&&(t.rect(i.x,i.y,St(i),Ct(i)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(p.x+s,p.y+s,St(p)+c,Ct(p)+c),t.fillStyle=f,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(p.x-.5,p.y-.5,St(p),Ct(p)),t.restore()),t.beginPath(),t.restore()}},i.prototype.vO=function(t,n,e,i,r){var o,a,u,s,o,a,c,f,r,l,u,h,d,v,u,r,l,f,c,o=n.frozenTrailingRowCount(),a=n.frozenTrailingColumnCount(),u=n.getSelections(),s=n.Fi(),o=n.getRowCount()-o-1,a=n.getColumnCount()-a-1,c=n.Yy(1,3),f=n._y(1,3);1===u.length&&2007<r&&(r=n.frozenRowCount(),l=n.frozenColumnCount(),h=(u=u[0]).row,d=u.col,v=u.rowCount,u=u.colCount,0<r&&(r<=h&&n.nI(h)<r?(t.y-=2,t.height+=2):h+v<=r&&n.j5(h+v-1)===n.Tb&&(t.height+=2)),0<l&&(l<=d&&n.r6(d)<l?(t.x-=2,t.width+=2):d+u<=l&&n.O5(d+u-1)===n.Ab&&(t.width+=2)),0===h&&0===d&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===h&&(h=0,v=n.getRowCount()),-1===d&&(d=0,u=n.getColumnCount()),l=r=!1,f=f.findRow(o),c=c.findCol(a),f&&f.y+Ct(f)<s.Cy+n.Sy(s)&&(r=!0),c&&c.x+St(c)<s.Py+n.Gy(s)&&(l=!0),r&&h+v-1==o&&(t.height+=2),l)&&d+u-1==a&&(t.width+=2)},i.prototype.sO=function(t,n,e,i){var r,o,a,u,s,c,f,F,u,a,l,h,d,a,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,E,R,r=this,o=r.Mf,a=o.Ut.getSelections(),u=o.Fi(),s=u.b6,c=u.T6,f=a.length,F=0!==u.qC,u=0!==u.XC;if(!(f<=0)){if(l=(a=a[0]).row,h=a.rowCount,d=a.col,a=a.colCount,-1===l&&(l=0),-1===d&&(d=0),-1===h&&(h=o.getRowCount()),-1===a&&(a=o.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=o.getSelectionBorderColor(),v=i.x,m=i.y,g=St(i),p=Ct(i),b=o.frozenRowCount(),F&&(1!==f||0!==b||o.Tb<=l||o.Tb>=l+h))for(y=0,M=(w=r.gO(e)).length;y<M;y++)T=S=0,A=(C=w[y]).x,I=C.x+St(C),C.x<v+g&&v<C.x+St(C)&&(1===f&&(0===b&&o.Tb===l||0<b&&0===l)&&(S=-1,T=1),C.x<v&&(S=0,A=v),C.x+St(C)>v+g&&(T=0,I=v+g),t.moveTo(A+S-1,c-1),t.lineTo(I+T,c-1),t.stroke());if(x=o.frozenColumnCount(),u&&(1!==f||0!==x||o.Ab<=d||o.Ab>=d+a))for(k=0,_=(N=r.pO(n)).length;k<_;k++)O=j=0,E=(D=N[k]).y,R=D.y+Ct(D),D.y<m+p&&m<D.y+Ct(D)&&(1===f&&(0===x&&o.Ab===d||0<x&&0===d)&&(j=-1,O=1),D.y<m&&(j=0,E=m),D.y+Ct(D)>m+p&&(O=0,R=m+p),t.moveTo(s-1,E+j-1),t.lineTo(s-1,R+O),t.stroke());t.beginPath(),t.restore()}},i.prototype.gO=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,u,v,l,h,d,n=this.Mf,e=n.Ut.getSelections(),i=e.length,r=n.Yy(t),o=[],a={},s=0;s<i;s++)(c=e[s])&&(-1===(f=c.col)?(l=n.Yy(0,3),h=n.Yy(1,3),d=n.Yy(2,3),v=u=-1,0<l.length&&(u=l[0].x,v=l[l.length-1].x+l[l.length-1].width-u,o.push(new q.Rect(u,-1,v,-1))),0<h.length&&(u=h[0].x,v=h[h.length-1].x+h[h.length-1].width-u,o.push(new q.Rect(u,-1,v,-1))),0<d.length&&(u=d[0].x,v=d[d.length-1].x+d[d.length-1].width-u,o.push(new q.Rect(u,-1,v,-1)))):r&&(l=r.findCol(f),h=r.findCol(f+c.colCount-1),l||h)&&((d=new q.Rect(-1,-1,-1,-1)).x=(l||r[0]).x,d.width=h?h.x+St(h)-d.x:r[r.length-1].x+r[r.length-1].width-d.x,a[u=[d.x,d.width].join("_")]||(a[u]=!0,o.push(d))));return o},i.prototype.pO=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,u,v,l,h,d,n=this.Mf,e=n.Ut.getSelections(),i=e.length,r=n._y(t),o=[],a={},s=0;s<i;s++)(c=e[s])&&(-1===(f=c.row)?(l=n._y(0,3),h=n._y(1,3),d=n._y(2,3),v=u=-1,0<l.length&&(u=l[0].y,v=l[l.length-1].y+l[l.length-1].height-u,o.push(new q.Rect(-1,u,-1,v))),0<h.length&&(u=h[0].y,v=h[h.length-1].y+h[h.length-1].height-u,o.push(new q.Rect(-1,u,-1,v))),0<d.length&&(u=d[0].y,v=d[d.length-1].y+d[d.length-1].height-u,o.push(new q.Rect(-1,u,-1,v)))):r&&(l=r.findRow(f),h=r.findRow(f+c.rowCount-1),l||h)&&((d=new q.Rect(-1,-1,-1,-1)).y=(l||r[0]).y,d.height=h?h.y+Ct(h)-d.y:r[r.length-1].y+r[r.length-1].height-d.y,a[u=[d.y,d.height].join("_")]||(a[u]=!0,o.push(d))));return o},i.prototype.mO=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,M,T,u=this,s=u.Mf,c=s.parent,f=s.rt,l=i.x,h=i.y,d=St(i),v=Ct(i),m=s.getViewportTopRow(n),g=s.getViewportLeftColumn(e),p=s.getViewportBottomRow(n),b=s.getViewportRightColumn(e),w=0,y=0,M=s.Fi(),C=0!==M.qC,S;0!==M.XC||o.col!==g&&-1!==o.col||(w=2),C||o.row!==m&&-1!==o.row||(y=2),o.row+o.rowCount===p+1&&(r.height=r.height+1),o.col+o.colCount===b+1&&(r.width=r.width+1),0<=d&&0<=v&&(!r||i.intersect(r.x-1,r.y-1,St(r)+2,Ct(r)+2))&&(t.save(),r&&!r.containsRect(i)&&(t.rect(r.x-w,r.y-y,St(r),Ct(r)),t.clip()),t.beginPath(),t.strokeStyle=q.Pf.vl(s,s.getSelectionBorderColor()),t.lineWidth=2,0<d&&0<v?(f&&f.Yk?2===(M=f.bO)?(t.moveTo(l+.5,h-.5),t.lineTo(l+d-1,h-.5)):3===M?(t.moveTo(l+.5,h+v-.5),t.lineTo(l+d-1,h+v-.5)):0===M?(t.moveTo(l-.5,h+.5),t.lineTo(l-.5,h+v-1)):1===M&&(t.moveTo(l+d-.5,h+.5),t.lineTo(l+d-.5,h+v-1)):2007<(T=c&&c.SC)?t.rect(l-1,h-1,d+1,v+1):t.rect(l-.5,h-.5,d,v),t.stroke(),(yt(a)||3===a)&&c&&c.options.allowUserDragFill&&u.yO&&u.yO(t,n,e,i,r)):0!==d&&0!==v||t.strokeRect(l-1,h-1,d+1,v+1),t.beginPath(),t.restore())},i.prototype.uO=function(t,n,e){var i,r,o,n,n,n,i,i=this.Mf,r=i.Fi();return 0<=t&&0<=n?o=r.c9(t,n):-1===t?o=r.L1(n):-1===n&&(o=r.B1(t)),1===n&&(n=0<(n=i.Yy(n)).length?n[n.length-1]:it)&&(o.width=j(St(o),n.x+St(n)-r.Py)),1===t&&(i=0<(n=i._y(t)).length?n[n.length-1]:it)&&(o.height=j(Ct(o),i.y+Ct(i)-r.Cy)),e=e?e.getIntersect(o.x,o.y,St(o),Ct(o)):o},i.prototype.fO=function(t,n,e,i){for(var r,o,a,u,s,c,a,f,l,r=this.Mf,o=r.Ut,u=e.length,c=[],f=r.C6(t,n),l=0;l<u;l++)(s=e[l])&&((a=o.findSpan(s.row,s.col,f))&&a.containsRange(s)&&(s=a),a=r.getRangeRect(t,n,s))&&a.x<=i.x+St(i)&&a.y<=i.y+Ct(i)&&i.x<=a.x+St(a)&&i.y<=a.y+Ct(a)&&c.push(a);return c},i.prototype.wO=function(t,n,e){var i,r,o,n,a,u,s,c,f,l,h;if(t.save(),i=n.x,r=n.y,o=St(n),n=Ct(n),a=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=e,t.setLineDash(a),t.rect(i,r,o-1,n-1);else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=e,u=a[0],s=a[1],h=l=f=c=void 0,c=i,f=r,l=o;0<l;)if(u+s<=l)t.moveTo(c,f),t.lineTo(c+u,f),c=c+u+s,l=l-u-s;else{if(u<=l){t.moveTo(c,f),t.lineTo(c+u,f),l=l-u-s;break}if(0<l){t.moveTo(c,f),t.lineTo(c+l,f),l=l-u-s;break}}for(c=i+o-1,f=r+1,h=n-1,l<0&&(s<(l=w(l))&&(t.moveTo(c,f-2),t.lineTo(c,f+(l-s))),f+=l,h-=l);0<h;)u+s<=h?(t.moveTo(c,f),t.lineTo(c,f+u),f=f+u+s,h=h-u-s):u<=h?(t.moveTo(c,f),t.lineTo(c,f+u),h=h-u-s):0<h&&(t.moveTo(c,f),t.lineTo(c,f+h),h=h-u-s);for(c=i+o-2,f=r+n-1,l=o-1,h<0&&(s<(h=w(h))&&(t.moveTo(c+2,f),t.lineTo(c-(h-s),f)),c-=h,l-=h);0<l;)if(u+s<=l)t.moveTo(c,f),t.lineTo(c-u,f),c=c-u-s,l=l-u-s;else{if(u<=l){t.moveTo(c,f),t.lineTo(c-u,f),l=l-u-s;break}if(0<l){t.moveTo(c,f),t.lineTo(c-l,f),l=l-u-s;break}}for(c=i,f=r+n-2,h=n-1,l<0&&(s<(l=w(l))&&(t.moveTo(c,f+2),t.lineTo(c,f-(l-s))),f-=l,h-=l);0<h;)u+s<=h?(t.moveTo(c,f),t.lineTo(c,f-u),f=f-u-s,h=h-u-s):u<=h?(t.moveTo(c,f),f-u===r?t.lineTo(c,f-u-1):t.lineTo(c,f-u),h=h-u-s):0<h&&(r<f&&(t.moveTo(c,f),t.lineTo(c,f-h)),h=h-u-s)}t.stroke(),t.beginPath(),t.restore()},i.prototype.mfe=function(t,n,e,i,r,o){var i,a,u,s,c,f,l,h,d,v,m,g,m;if(!i&&0!==n.length){for(i=e.row,h=l=f=c=s=u=a=void 0,d=n.length-1;0<=d&&(v=n[d]).isOutside;d--)h=d;for(f=(p(h)?(a=(m=n[h]).col,u=m.x,s=m.width,2!==m.columnHeaderFitMode?(c=n[h].y,n[h]):(c=n[h+1].y,n[h+1])):(a=n[n.length-1].col+1,u=n[n.length-1].x+n[n.length-1].width,s=r.Jt.Kt(a,o),c=e.y,e)).height,a<r.getColumnCount(o)&&(l=r.Jt.qt(i,a,o)),bt.W.gfe(l,4)&&0<s&&r.getColumnVisible(a,o)&&t.push({style:l,x:u,y:c,width:s,height:f}),g=void 0,d=0;d<n.length&&(v=n[d]).isOutside;d++)g=d;f=(p(g)?(a=(m=n[g]).col,u=m.x,s=m.width,2!==m.columnHeaderFitMode?(c=n[g].y,n[g]):(c=n[g+1].y,n[g+1])):(a=n[0].col-1,s=r.Jt.Kt(a,o),u=n[0].x-s,c=e.y,e)).height,a<0||(l=r.Jt.qt(i,a,o),bt.W.gfe(l,5)&&0<s&&r.getColumnVisible(a,o)&&t.push({style:l,x:u,y:c,width:s,height:f}))}},i.prototype.MO=function(t,n,e,i,r,o,a){var r,u,s,s,r;r&&0!==n.length&&(r=n[0].col-1,u=n[n.length-1].col+1,s=e.Sl(i.row,r,a,1),0<=r&&o.isValid&&!o.isValid(i.row,r,s)&&t.push({style:o.getDataValidator(i.row,r).highlightStyle(),x:n[0].x-o.getColumnWidth(r),y:i.y,width:o.getColumnWidth(r),height:i.height}),s=e.Sl(i.row,u,a,1),o.isValid)&&!o.isValid(i.row,u,s)&&(r=n[n.length-1],t.push({style:o.getDataValidator(i.row,u).highlightStyle(),x:r.x+r.width,y:i.y,width:o.getColumnWidth(u),height:i.height}))},i.prototype.CO=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,i=n.Jt,r=t.row,o=t.col,a={},u={},s=[],c=t.rowCount,f=t.colCount,l=0;l<f;l++)u[l]=n.nn(l+o,e);for(h=0;h<c;h++){if(a[h]=n.Gt(h+r,e),d=[],0<a[h])for(v=0;v<f;v++)d.push(0<u[v]?i.qt(r+h,o+v,e):A);s.push(d)}return{rowSizes:a,colSizes:u,styleList:s}},i.prototype.iO=function(t,l,h,d,v,m,g){var p,b,n,G,u,w,n,n,e,y,s,M,i,C,U,c,H,S,T,A,I,x,N,k,_,D,j,O,E,R,V,F,f,O,z,Y,Z,W,Q,J,K,r,X,q,$,tt,nt,r,n,L,et,B,P,it,rt,ot,r,at,ut,o,st,ct,ft,lt,lt,n,a;if(yt(d)&&(d=3),n=(b=(p=this).Mf).parent,G=n&&n.options.resizeZeroIndicator,u=b._y(l,d),w=b.yfe(h,d),n=b.options.sheetAreaOffset,n=b.gj&&b.gj()||{x:n.left,y:n.top,width:0,height:0},e=p.U7(l,h,b.Fi(),n,m),y=!1,s=u.length,M=w.length,!(s<0||M<0)){for(i=new mt.h9,C=0;C<M;C++)w[C].isOutside||i.push(w[C]);for(U=p.xpe(d,m),c=b.s7(l,h,d,!0),H=0<c.length,I=b.Jt,j=D=_=k=0,R=new gt.Yx(b,u,i,d),V=[],F=[],f=[],z=[],Y=[],t.save(),t.beginPath(),Z=[],Q=W=-1,J=b.N9(3),K=b.k9(3),r=b.Fi(),X=0===r.qC&&0===n.height,q=0===r.XC&&0===n.width,$=!!wt(this.Mf),tt=!1,nt=ht("SheetsCalc"),r=b.getActiveRowIndex(),n=b.getActiveColumnIndex(),L=this.SO(d,b,r,n),B={},H&&(et=new dt.Common.rbush,c.forEach(function(t){et.insert({minX:t.row,minY:t.col,maxX:t.row+t.rowCount-1,maxY:t.col+t.colCount-1,item:t})})),C=0;C<s;C++){for(S=u[C],p.MO(z,i,I,S,U,b,d),P=[],it=function(e){var t,t,t,n,n,i,r,o,a,u,s,c,s,f,a,u,s,a,s,u;if(T=w[e],H&&(B.minX=S.row,B.minY=T.col,B.maxX=S.row,B.maxY=T.col,t=et.search(B)[0],A=t&&t.item),A?(x=A.row,N=A.col,k=A.x,_=A.y,D=St(A),j=Ct(A),A.isAutoMerge&&(t=p.TO(A,l,h,d),k=t.x,_=t.y,D=t.width,j=t.height),A.spanSizeInfo||(A.spanSizeInfo=p.CO(A,b,d))):(x=S.row,N=T.col,k=T.x,D=St(T),-1===T.y?_=S.y:(_=Mt(T.y*S.height+S.y),y=!0),-1===Ct(T)?j=Ct(S):(j=S.height+S.y-_,y=!0)),1===G&&(-1===l&&b.getColumnVisible(N)&&0===b.Do(N)&&((Q<0||Q!==N-1)&&Z.push({x1:k,y1:_,x2:k,y2:_+j,horizontal:!1}),Q=N),-1===h)&&b.getRowVisible(x)&&0===b._o(x)&&((W<0||W!==x-1)&&Z.push({x1:k,y1:_,x2:k+D,y2:_,horizontal:!0}),W=x),v&&(k+D<=v.x||k>=v.x+St(v)||_+j<=v.y||_>=v.y+Ct(v))&&(!y||k>v.x+St(v))&&!T.isOutside)return"continue";if(0===D||0===j)return"continue";if(1===d&&e<M-1&&w[e+1].x-k==0)return"continue";if(P.push({col:N,x:k,y:_,width:D,height:j}),t=function(t){var n,n;t.columnHeaderFitMode!==pt.ColumnHeaderFitMode.normal&&e<M-1&&(n=b.O5(T.col,d,!0))&&(n=w.findCol(n))&&-1!==n.y&&(t.cornerX=n.x,t.columnHeaderFitMode===pt.ColumnHeaderFitMode.stack?t.cornerY=Mt(n.y*S.height)+S.y:t.cornerY=S.height+S.y)},T.isOutside)return(n=P[P.length-1]).isOutside=!0,n.columnHeaderFitMode=1===d&&b.Lt(N),t(n),n.columnHeaderFitMode===pt.ColumnHeaderFitMode.stack&&(n.width=I.Kt(N,d)),"continue";if(n=!1,!A||!Tt.OS(V,A)){if(i=!1,O=I.$t(x,N,d,1),r=b.AO&&b.AO(),o=b.getRowCount(pt.SheetArea.colHeader)-1,a=b.frozenRowCount(),u=b.getViewportTopRow(0),s=b.getViewportTopRow(1),!m&&L&&x===o&&N>=L.iw&&(0===a&&L.Ky+L.Sx>s||0<a&&0<u&&L.Ky+L.Sx>u)&&N<L.iw+L.Tx){if(O=b.getCell(L.Ky,N).text()+"",n=!0,i=L.filterButtonVisible(),r)for(c=0;c<r.length;c++)if(r[c].col===N&&r[c].rowFilter.nM===L){rt.IO(r[c],1,o,!0);break}}else if(r&&0<r.length&&(f=r[s=r.length-1].rowFilter&&r[s].rowFilter.nM))for(c=r.length-1;0<=c;c--)if(r[c].tableColumnHeaderFilter&&r[c].col===N){rt.IO(r[c],3,f.Ky,!1);break}E=I.qt(x,N,d),U&&(a=I.Sl(x,N,d,1),b.isValid)&&!b.isValid(x,N,a)&&z.push({style:b.getDataValidator(x,N).highlightStyle(),x:k,y:_,width:D,height:j}),3===d&&(u=E.formatter,nt)&&u&&At(u)&&(!m||b.pivotTables&&b.pivotTables.findPivotTable(x,N))&&(s=b.parent&&b.parent.xO(u))&&(a=s.getExpression(),O=b.NO(u,a,x,N)),n&&(E.hAlign=0),O={data:O,row:x,col:N,x:k,y:_,width:D,sparkline:$&&b.getSparkline(x,N),height:j,style:E,colStyle:b.Z_(-1,N,d),cellLayout:A,tableFilter:i,columnHeaderFitMode:1===d&&b.Lt(N),offsetX:T.offsetX,printZoomFactor:g,sheetArea:d},b.getParent().options.scrollByPixel&&(O.clipRect=v),t(O),F.push(O),bt.W.Xue(E)&&Y.push({style:E,x:k,y:_,width:O.columnHeaderFitMode===pt.ColumnHeaderFitMode.stack?b.getColumnWidth(N,d):D,height:j,columnHeaderFitMode:O.columnHeaderFitMode,cornerY:O.cornerY,cornerX:O.cornerX}),A&&V.push(A),O.style&&4===O.style.hAlign&&(tt=!0),s=(x===J||m&&0===C)&&X,u=(N===K||m&&0===e)&&q,A&&(A.vIndex=C,A.hIndex=e),R.PN(x,N,k,_,D,j,E,A,s,u,O)}},rt=this,ot=0;ot<M;ot++)it(ot);0<P.length&&p.mfe(Y,P,S,m,b,d)}if(0<F.length){if(3===d&&(b.options.allowCellOverflow||tt)&&(r=I.gl(l,h,function(){return new It(b,l,h)}),0<(f=p.kO(t,r,F,R,g)).length)){for(at=v.x,ut=v.x+v.width,C=0;C<f.length;C++)(o=f[C])&&(st=o.row,ct=o.col,(ft=o.cellOverflowLayout&&o.cellOverflowLayout.layout)&&((lt=ft.x)<at&&(at=lt),ut<(lt=lt+ft.width))&&(ut=lt),o.printZoomFactor=g,R.PN(st,ct,o.x,o.y,o.width,o.height,o.style,o.cellLayout,st===J&&X,ct===K&&q,o));F=F.concat(f),m||(v.x=at,v.width=ut-at,e&&(v=v?e.getIntersectRect(v):e))}1===d&&y&&p.DO(F,i,R,v,m,e,J,K,X,q,g),v&&(n=b.printInfo&&b.printInfo(),m&&n&&(0<n.columnStart()||0<n.rowStart())&&!n.showBorder()?t.rect(v.x-(0<n.columnStart()?2:0),v.y-(0<n.rowStart()?2:0),St(v)+(0<n.columnStart()?4:0),Ct(v)+(0<n.rowStart()?4:0)):t.rect(v.x,v.y,St(v),Ct(v)),t.clip()),p.eO(t,F,d,m,g)}vt.Worksheet.et(b,"paintViewport",{ctx:t,rowViewportIndex:l,colViewportIndex:h,sheetArea:d,clipRect:v,isPrinting:m}),R.paint(t,g),0<Z.length&&p._O(t,Z,1,3),0<z.length&&(a=e.getIntersectRect(v),t.rect(a.x,a.y,St(a),Ct(a)),t.clip(),p.EO(t,z)),0<Y.length&&(a=e?e.getIntersectRect(v):v,t.rect(a.x,a.y,St(a),Ct(a)),t.clip(),p.que(t,Y,{isPrinting:m,printZoomFactor:g,sheet:b})),t.restore()}},i.prototype.IO=function(t,n,e,i){t.sheetArea=n,t.row=e,t.tableColumnHeaderFilter=i},i.prototype.SO=function(t,n,e,i){if(n.tables&&1===t){var t=n.tables.find(e,i),e=n.frozenRowCount(),i=n.getViewportTopRow(0),n=n.getViewportTopRow(1);if(t&&t.jO&&(0===e&&t.Ky<n||0<e&&0<i&&t.Ky<i))return t}return null},i.prototype.TO=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,n,d,v,m,n,r,d,v,r=t.row,o=t.col,a=t.x,u=t.y,s=t.width,c=t.height,f=this.Mf,l=f.Fi();return 1!==n||3!==i&&2!==i||(h=l.B1(n),n=f.frozenRowCount(),d=f.getRowCount(i)-f.frozenTrailingRowCount()-1,u<(v=h.y)&&n<=r&&r<=d&&(c-=v-u,u=v),v+(m=h.height)<u+c&&n<=r+t.rowCount-1&&r+t.rowCount-1<=d&&(c-=u+c-(v+m))),1!==e||3!==i&&1!==i||(h=l.L1(e),n=f.frozenColumnCount(),r=f.getColumnCount(i)-f.frozenTrailingColumnCount()-1,a<(d=h.x)&&n<=o&&o<=r&&(s-=d-a,a=d),d+(v=h.width)<a+s&&n<=o+t.colCount-1&&o+t.colCount-1<=r&&(s-=a+s-(d+v))),new q.Rect(a,u,s,c)},i.prototype._O=function(t,n,e,i){var r,o,a,u,s,c,f,a,l,h,d,v,m,g,p,b;if(0!==n.length)for(r=0,o=n.length;r<o;r++)u=(a=n[r]).x1,s=a.y1,c=a.x2,f=a.y2,a=a.horizontal,t.beginPath(),t.save(),t.lineWidth=e,t.strokeStyle=this.OO(t,a,u,s,c,f),t.fillStyle=this.RO(t,a,u,s,c,f),a?(d=-(h=1),v=-2,t.fillRect(u,s+(l=-3),c-u-1,i+2*e),f+=.5,t.moveTo(u+-1,(s+=.5)+-3),t.lineTo(c+-2,f+-3),t.moveTo(u+-1,s+1),t.lineTo(c+-2,f+1)):(b=-(g=1),t.fillRect(u+(m=-3),s+(p=0),i+2*e,f-s-1),c+=.5,t.moveTo((u+=.5)+-3,s+0),t.lineTo(c+-3,f+-1),t.moveTo(u+1,s+0),t.lineTo(c+1,f+-1)),t.stroke(),t.restore()},i.prototype.RO=function(t,n,e,i,r,o){var a,u,s,c,s,f,l,h,d,u,s=q.I.He(0,"gc-"+(n?v:m)+"-normal"),c=s&&s.backgroundColor,s=s&&s.backgroundImage;if(!n&&s&&-1!==s.indexOf("linear-gradient"))for(f=q.mt.ri(s),a=t.createLinearGradient(e,i,r,o),l=0,h=f.length;l<h;l++)d=f[l],a.addColorStop(d.point,d.color);else c&&(a=c);return a},i.prototype.OO=function(t,n,e,i,r,o){var t,a,e,t=t.createLinearGradient(e,i,r,o),a,e=q.I.He(0,"gc-"+(n?v:m)+"-normal");return n?(t.addColorStop(0,e.borderTopColor),t.addColorStop(1,e.borderBottomColor)):(t.addColorStop(0,e.borderLeftColor),t.addColorStop(1,e.borderRightColor)),t},i.prototype.que=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,o,i=n.length,r=0;r<i;r++)a=(o=n[r]).x,u=o.y,s=o.width,c=o.height,f=o.style,l=o.columnHeaderFitMode,h=o.cornerY,o=o.cornerX,e.columnHeaderFitMode=l,e.cornerY=h,e.cornerX=o,(0,d.paintStyleDecorationOutSideIcons)(t,new q.Rect(a,u,s,c),f.decoration.icons,f.vAlign,e)},i.prototype.EO=function(t,n){var e,i,r,o,a,u,s,c,f,l,u,h,e,i,r=this.Mf.BO();if(n)for(o=n.length,a=0;a<o;a++)s=(u=n[a]).x,c=u.y,f=u.width,l=u.height,0===(h=(u=u.style).type)&&this.LO(t,s,c,f,l,u),1===h&&this.FO(t,s,c,f,l,u),2===h&&this.PO(t,s,c,f,l,u,r)},i.prototype.LO=function(t,n,e,i,r,o){var o,n,e,i,r,a,u,a,s,c,i,r,o=o.color,n=n-4,e=e-4,i=i+8,r=r+8,a=.5522848,u=i/2*a,a=r/2*a,s=n+i,c=e+r,i=n+i/2,r=e+r/2;t.save(),t.lineWidth=2,t.strokeStyle=o,t.beginPath(),t.moveTo(n,r),t.bezierCurveTo(n,r-a,i-u,e,i,e),t.bezierCurveTo(i+u,e,s,r-a,s,r),t.bezierCurveTo(s,r+a,i+u,c,i,c),t.bezierCurveTo(i-u,c,n,r+a,n,r),t.closePath(),t.stroke(),t.restore()},i.prototype.FO=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,o;n-=.5,e-=.5,h=Math.min(i/2,r/2),d=o.color,o=o.position,t.save(),t.lineWidth=2,t.strokeStyle=d,t.beginPath(),t.rect(n,e,i,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===o?(s=a=n,c=(u=e)+h,f=a+h,l=u):2===o?(c=(u=e+r)-h,f=(s=a=n+i)-h,l=u):3===o?(s=a=n,c=(u=e+r)-h,f=a+h,l=u):1===o&&(c=(u=e)+h,f=(s=a=n+i)-h,l=u),t.moveTo(a,u),t.lineTo(s,c),t.lineTo(f,l),t.fillStyle=d,t.fill(),t.closePath(),t.restore()},i.prototype.PO=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,o,g;if(n-=.5,e-=.5,s=(u=this.Mf).zoom(),h=l=15,d=o.image,v=o.position,m=3,o=o.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(n,e,i,r),t.stroke(),d&&"none"!==d&&a){4===v?c=n-18:5===v&&(c=n+i+3);try{a.getState(d)?(g=a.getImage(d),f=e+r/2-7.5,t.drawImage(g,c,f,15,15)):a.addImage(d)}catch(t){}}else 4===v?c=n-18*s:5===v&&(c=n+i+3*s),t.translate(c,f=e+r/2-15*s/2),t.scale(.015*s,.015*s),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=o,t.fill(),t.stroke();t.restore()},i.prototype.eO=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,s,F,L,v,B,P,G,o,m,g,p,b,w,y,M,C,S,T,A,I,x,U,N,H,V,z,k,Y,_,D,_,Z,j,W,O,E,R,R,N,Q,J,K,X;for(void 0===a&&(a=0),void 0===u&&(u=0),void 0===s&&(s=1),f=(c=this).Mf,l=3===e,h=(o||f).zoom()*s,d=nt(c.Nn(),h),s=f.getDefaultStyle(e),F=f.$f(e),L=c.Mf.conditionalFormats,v=ut(f),B=f.k9(2),P=f.N9(1),G=(o||f).BO(),t.save(),t.beginPath(),o=rt,s&&s.foreColor?(0,q.resetFillStyle)(t,f,s):t.fillStyle=o,tt(t,d.font),t.textAlign=l?"right":"center",p=n.length,j=[],O={sheet:f,row:-1,col:-1,fontInfo:it,lineHeight:-1,imageLoader:G,conditionalFormats:L,sheetArea:e,parentBackColor:v},E=[],m=0;m<p;m++)y=(b=n[m]).data,U=b.tableFilter,M=b.row,C=b.col,S=b.x,T=b.y,A=St(b),I=Ct(b),1!==e||E[M]||(E[M]=f.getRowHeight(M,e)),x=b.style,k=b.cellOverflowLayout,N=b.columnHeaderFitMode,H=b.cornerX,V=b.cornerY,Z=b.offsetX,z=b.colStyle,D=x.font?et(x,h):d,i&&typeof r===at&&1!==r&&(D=nt(D.font,r)),x.font=D.font,0<A&&0<I&&(w=x.cellType||F,S--,T--,A++,I++,l?O.sparkline=b.sparkline:(_=i?0:c.GO(M,C,e),O.visualState=_),ot&&tt(t,x.font,!0),_=$(D.font),O.lineHeight=_,O.row=M+a,O.col=C+u,O.fontInfo=D,O.cellOverflowLayout=k,R=E.length&&I!==E[M]+1,O.needTopGridline=1===e&&M===P||0===e||R,O.needLeftGridline=2===e&&C===B||0===e||R,O.isPrinting=i,O.printZoomFactor=r,O.clipRect=b.clipRect,O.columnHeaderFitMode=N,O.cornerX=H,O.cornerY=V,O.offsetX=Z,O.colStyle=z,O.isFormula=!yt(f.t0(b.row,b.col,e)),w._e(t,y,S,T,A,I,x,O,U),k)&&!O.showBarIconOnly&&(R=new q.Rect(S,T,A,I),N=w.In?w.In(t,R,x,O):R,j.push({cellType:w,data:y,x:N.x,y:N.y,width:N.width,height:N.height,style:x,richText:Y,options:{sheet:f,row:M,col:C,fontInfo:D,lineHeight:_,cellOverflowLayout:k,parentBackColor:v,imageLoader:G}}));if(0<(p=j.length))for(Q=f.isEditing(),J=f.ui,K=f.ci,g=0;g<p;g++)y=(W=j[g]).data,O=W.options,Q&&f.li&&O.row===J&&O.col===K||(X=wt(this.Mf))&&y&&"SparklineExValue"===y.typeName||c.UO(t,W);for(t.restore(),p=n.length,m=0;m<p;m++)b=n[m],vt.Worksheet.et(f,"paintCell",{ctx:t,sheetArea:e,cell:b,isPrinting:i})},i.prototype.UO=function(t,n){var e,i,r,o,a,u,s,n,c,c,c,e=n.cellType,i=n.data,r=n.x,o=n.y,a=St(n),u=Ct(n),s=n.style,n=n.options,c=n.cellOverflowLayout;c&&e.pn&&(c=c.layout,c=new q.Rect(c?c.x:r,c?c.y:o,c?c.width:a,c?c.height:u),e.pn(t,c,n,i)),e.paintValue&&e.paintValue(t,i,r,o,a,u,s,n)},i.prototype.GO=function(t,n,e){var i,r,i=this.Mf,r=0;return Q(i)&&(3===e||yt(e)?!i.isEditing()&&i.HO(t,n)?r=3:i.ni(t,n,e)&&(r=2):(i.ni(t,n,e)&&(r=1,i.ei(t,n,e))&&(r=2),i.zO(t,n,e)&&(r=4))),r},i.prototype.kO=function(g,p,b,w,y){for(var M,C,t,S,T,A,I,x,N,k,_,D,j,O,E,R,F,L,B,P,G,U,n,e,i,M=this.Mf,C=M.Jt,t=b.length,x=[],G={},U=[],n=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m;if(S=b[t],I=S.row,N=S.col,k=S.y,D=Ct(S),F=p.b7(I,g,y),L=F.headingOverflowLayouts,B=F.trailingOverflowLayouts,!G[I]){for(n={},e=0,i=F;e<i.length;e++)r=i[e],n[r.column]=!1;L&&L.forEach(function(t){n[t.column]=!1}),B&&B.forEach(function(t){n[t.column]=!1}),G[I]=n}for(o=G[I],P=F.find(N),a=0;a<P.length;a++)if(u=P[a]){if(s=M.getCellRect(I,u.column,it,it,!0),!o[u.column]){if(c=u.column,(A=C.o2e(I,c)).showEllipsis)continue;T=C.$t(I,c,3,1,A),_=u.columnWidth,j=u.backgroundWidth,O=u.backgroundLeftWidth<0?s.x:u.backgroundRightWidth<0?s.x+St(s)-j:4===A.hAlign?s.x+u.expandedWidth/2-u.backgroundLeftWidth:s.x+St(s)/2-u.backgroundLeftWidth,R={data:T,row:I,col:c,x:s.x,y:k,width:_,height:D,cellOverflowLayout:u,style:A},x.push(R),u.layout=new q.Rect(O,k,j,D),A=C.o2e(I,c),w.EN(I,c,u,A,s.x,k,_,D),o[u.column]=!0}u.column===N&&o[u.column]&&U.push(t)}if(L)for(f=0;f<L.length;f++)(l=L[f])&&!o[l.column]&&l.contains(S.col)&&(N=l.column,(A=C.o2e(I,N)).showEllipsis||(T=C.$t(I,N,3,1,A),_=l.columnWidth,j=l.backgroundWidth,h=M.getCellRect(I,l.endColumn,it,it,!0),O=h.x+St(h)-j,R={data:T,row:I,col:N,x:O,y:k,width:_,height:D,style:A,cellOverflowLayout:l},x.push(R),l.layout=new q.Rect(O,k,j,D),o[l.column]=!0,w.EN(I,N,l,A,O,k,_,D)));if(B)for(d=0;d<B.length;d++)(v=B[d])&&!o[v.column]&&v.contains(S.col)&&(N=v.column,(A=C.o2e(I,N)).showEllipsis||(T=C.$t(I,N,3,1,A),_=v.columnWidth,j=v.backgroundWidth,m=M.getCellRect(I,v.startColumn,it,it,!0),O=m.x,E=m.x+j-_,R={data:T,row:I,col:N,x:E,y:k,width:_,height:D,style:A,cellOverflowLayout:v},x.push(R),v.layout=new q.Rect(O,k,j,D),w.EN(I,N,v,A,O,k,_,D),o[v.column]=!0))},e=0;e<t;e++)n(e);if(0<U.length)for(i=U.length-1;0<=i;i--)b.splice(U[i],1);function r(t,n){var e,i,t,n,e=t.row,i=n.row,t=t.col,n=n.col;return e!==i?e-i:t!==n?t-n:void 0}return 0<x.length&&x.sort(r),x},i.prototype.DO=function(t,n,e,i,r,o,a,u,s,c,f){for(var l,h,d,v,m,g,p,b,w,y,M,C,S,T,T,l=this,h=[],d=l.VO(t[0].col,t[0].x),v=[],m=0;m<d.length;m++)v.push(d[m]);for(m=0;m<n.length;m++)v.push(n[m]);for(e.Vx=v,g=[],p=e.Vx.length,w=0;w<p;w++)0<(b=e.Vx[w]).width&&g.push(b.col);if(g.push(g[g.length-1]+1),e.CN=g,0<(h=l.YO(d,t)).length){for(y=i.x,M=i.x+i.width,m=h.length-1;0<=m;m--)(C=h[m])&&((S=C.overflowLayout)&&((T=S.x)<y&&(y=T),M<(T=T+S.width))&&(M=T),t.unshift(C),C.printZoomFactor=f,e.PN(C.row,C.col,C.x,C.y,C.width,C.height,C.style,A,C.row===a&&s,C.col===u&&c,C));r||(i.width=M-y,o&&i&&o.getIntersectRect(i))}},i.prototype.VO=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,e=new mt.h9,i,r=this.Mf,o=r.Jt,a=r.Ut,u=t,s=[],c=[],f=[],l=[],d=u,m=n,g=r.getColumnCount()-r.frozenTrailingColumnCount(),p=r.frozenColumnCount()-1,b=u-1;p<b;b--)if(s[b]=h=o.Kt(b),h){if(c[b]=a.getColumnHeaderFitMode(!1,pt.SheetArea.colHeader,b),f[b]=a.eE(-1,b,-1,1,pt.SheetArea.colHeader),l[b]=r.ZO(b,m,g,d,s,c,f,l),c[b]===pt.ColumnHeaderFitMode.normal)break;d=b,m-=h}for(w=d;w<u;w++)s[w]||(s[w]=o.Kt(w)),yt(c[w])&&(c[w]=a.getColumnHeaderFitMode(!1,pt.SheetArea.colHeader,w)),v=s[w],y=r.ZO(w,m,g,d,s,c,f,l),e.push(l[w]=y),m+=v;return e},i.prototype.YO=function(r,o){for(var t,a,u,s,e,c,f,l,h,d,v,m,g,p,b,v,n,w,i,y,t,a=this.Mf,u=a.Ut,s=a.Jt,e=a._y(1,1),f=[],n=e.length,w=r.length,i=function(i){var t,n;for(c=e[i],t=function(t){var n,e,n,t,n,n=r[t];if(n){if(l=c.row,h=n.col,p=n.x,b=-1===n.y?c.y:Mt(n.y*c.height+c.y),m=St(n),g=-1===Ct(n)?Ct(c):c.height+c.y-b,v=s.$t(l,h,1,1,d),d=s.qt(l,h,1),v={data:v,row:l,col:h,x:p,y:b,width:m,height:g,style:d,overflowLayout:n,columnHeaderFitMode:u.getColumnHeaderFitMode(!1,pt.SheetArea.colHeader,h),SheetArea:1},d.showEllipsis&&v.columnHeaderFitMode!==pt.ColumnHeaderFitMode.stack)return"continue";v.columnHeaderFitMode===pt.ColumnHeaderFitMode.stack&&(t===w-1?(e=o[0].col,n=o.filter(function(t){return t.row===i&&t.col===e})[0],v.cornerX=n&&n.x,v.cornerY=n&&n.y):(t=a.O5(h,1,!0))&&(n=r.findCol(t))&&-1!==n.y&&(v.cornerX=n.x,v.cornerY=Mt(n.y*c.height)+c.y)),f.push(v)}},n=0;n<w;n++)t(n)},y=0;y<n;y++)i(y);return f},b=i,t.g7=b,u=".cutCopyIndicator",T=q.Events.CellChanged,I=q.Events.ClipboardChanged,x=q.Events.ValueChanged,D=q.Events.ColumnChanged,E=q.Events.RowChanged,R=q.Events.RangeChanged,F=q.Events.ClipboardPasting,L=q.Events.ClipboardPasted,B=q.Events.DragMerging,P=q.Events.FloatingElementSelected,r.prototype._T=function(t){var n=this;if(0===arguments.length)return n.d7;n.d7=t},r.prototype.WO=function(t,n){var e,i,e=this;if(0===arguments.length)return e.h7;(e.h7!==t||t||n)&&(e.h7=t,i=e.Mf)&&(i.zw(),yt(e.QO)||clearTimeout(e.QO),e.QO=window.setTimeout(function(){var t;e.h7||(t=i.ST())&&t.c5(n),e.QO=it}))},r.prototype.v7=function(){var c,e,f,i,r;function o(){c.h7&&c.WO(!1)}function a(t,n,e){t||n===i||n===e||n===r||o()}e=(c=this).Mf,f=!1,i="resizable",r="isVisible",e.D3(I+u,function(){c.WO(!0)}),e.D3(x+u,o),e.D3(T+u,function(t,n){n.isUndo||"tag"===n.propertyName||n.KO||o()}),e.D3(D+u,function(t,n){a(n.isUndo,n.propertyName,"width")}),e.D3(E+u,function(t,n){a(n.isUndo,n.propertyName,"height")}),e.D3(R+u,function(t,n){n.isUndo||6===n.action||3===n.action||o()}),e.D3(F+u,function(){f=c.WO()}),e.D3(L+u,function(t,n){var e,n,i,r,o,a,u,s,e=n.cellRange,n=n.sheet.ST(),i=n._S,r=f;if(e&&i&&n.DS){if(c._T()){for(a=0,u=i;a<u.length;a++)if((s=u[a]).intersect(e.row,e.col,e.rowCount,e.colCount)&&!s.equals(e)){r=!1;break}}else o=!(r=!1);c.WO(r,o)}}),e.D3(B+u,o),e.D3(P+u,function(t,n){"worksheet"!==n.type&&(e.endEdit(),q.hi.N1(e))})},r.prototype.oO=function(t,n,e,i){var r,r,o,a,a,u,s,c,f,a,c,l,h,d,r=this;if(r.h7&&(o=(r=r.Mf).Dn,a=(a=r.parent)?a.options:{},s=(u=r.ST())._S,c=a.cutCopyIndicatorVisible,yt(c)&&(c=!0),f=q.Pf.vl(r,a.cutCopyIndicatorBorderColor||"blue"),c)&&u.DS===r&&s&&(a=o.uO(e,i,it),c=o.fO(e,i,s,n))&&a){for(t.save(),t.rect(a.x,a.y,St(a),Ct(a)),t.clip(),l=0,h=c;l<h.length;l++)d=h[l],o.wO(t,d,f);t.beginPath(),t.restore()}},r.prototype.JO=function(){this.WO(!1)},r.prototype.XO=function(){this.WO(!1)},r.prototype.qO=function(){this.WO(!1)},r.prototype.$O=function(){this.WO(!1)},r.prototype.lI=function(){this.WO(!1)},r.prototype.L0=function(){var t=this.Mf;t._3(T+u),t._3(I+u),t._3(x+u),t._3(D+u),t._3(E+u),t._3(R+u),t._3(F+u),t._3(L+u),t._3(B+u),t._3(P+u)},G=r,t.m7=G,vt.Worksheet.ch("render",{init:function(){var t=this;t.Dn=new b(t),t.lA&&t.lA.L0(),t.lA=new G(t)},dispose:function(t){var n,t,n=this;n.Dn&&n.Dn.TCe(),!1!==t.clearCache&&(n.Dn&&(n.Dn.Mf=it,n.Dn=it),t=n.lA)&&(t.L0(),n.lA=it)},onLayoutChanged:function(t){var n,e,t,n,e=this.lA;e&&("addRows"===(t=t.changeType)?e.JO():"deleteRows"===t?e.XO():"addColumns"===t?e.qO():"deleteColumns"===t&&e.$O())}})},"./dist/core/worksheet/worksheet-selection.js":function(t,n,e){"use strict";var i,y,n,r,o,d,p,M,C,S,a;function T(t,n){return t.getColumnCount(n)}function A(t,n){return t.getRowCount(n)}function I(t){return t.rowCount}function x(t){return t.colCount}function f(t,n,e){for(var i,r,o,a,i=[],r=t.length,a=0;a<r;a++)o=t[a],a===n?i=i.concat(e):i.push(o);return i}function N(t,n,e){for(var i=e-1;0<=i;i--)if(t.getColumnVisible(n+i)&&0<t.getColumnWidth(n+i))return n+i;return n+e-1}function k(t,n,e){for(var i=e-1;0<=i;i--)if(t.getRowVisible(n+i)&&0<t.getRowHeight(n+i))return n+i;return n+e-1}Object.defineProperty(n,"__esModule",{value:!0}),i=e("./dist/core/worksheet/worksheet.js"),y=e("./dist/core/util/common.js"),n=e("Common"),r=e("./dist/core/util/domUtil.js"),o=e("./dist/core/core.enum.js"),d=n.Common.lt.ht,p=n.Common.Uf.tR,M=null,C=Math.max,S=Math.min,a="gc-selection",r.GC$.extend(i.Worksheet.prototype,{addSelection:function(t,n,e,i){this.n4(t,n,e,i,!1)},n4:function(t,n,e,i,r){var o,a,u,s,c,f,f,o=this,a=t,u=n,s=e,c=i;-1!==a&&-1!==u&&(f=o.Ut.getSpans())&&0<p(f)&&(a=(f=o.nR(f,(0,y.Ec)(t,n,e,i))).row,u=f.col,s=I(f),c=x(f)),o.Ut.do("addSelection",a,u,s,c,r),o.zw()},setSelection:function(t,n,e,i){this.eR(t,n,e,i,2)},eR:function(t,n,e,i,r){var o,a,u,u,a,r,o=this,a=A(o),u=T(o);u<=n&&(n=u-1),u=C(0,t=a<=t?a-1:t),a=C(0,n),o.IA(),r=2===r?y.hi.A1(o):1===r,o.O6(u,a,o.C0(u),o.S0(a),!r),o.n4(t,n,e,i)},getSelections:function(){return this.Ut.getSelections()},clearSelection:function(t){var n,t;void 0===t&&(t=1),(n=this).IA(),t=2===t?y.hi.A1(n):1===t,n.O6(0,0,n.C0(0),n.S0(0),!t),i.Worksheet.et(n,"clearSelection"),n.zw()},IA:function(t){this.Ut.do("clearSelection",t)},JA:function(t,n,e){var i,r,o,a,o,u,s,c,f,l,h,d,v,m,i=this,r,o=i.options.protectionOptions,a=!1!==o.allowSelectLockedCells,o=!1!==o.allowSelectUnlockedCells;if(!i.isActualProtected()||a&&o)return!0;if(!a&&!o)return!1;if(u=e?e.locked:i.l0(t,n,"locked"),s=n<0,f=(c=t<0)?A(i):1,t=c?0:t,l=s?T(i):1,n=s?0:n,o&&(c||s))return!y.util.bme(i,{row:t,col:n,rowCount:f,colCount:l});if(a===u&&(c||s)){for(h=t+f-1,d=n+l-1,m=v=void 0,v=t;v<=h;v++)for(m=n;m<=d;m++)if((e=i.getCompositeStyle(v,m))&&a!==e.locked)return!1;if(c)for(v=t;v<=h;v++)if((e=i.getCompositeStyle(v,-1))&&a!==e.locked)return!1;if(s)for(m=n;m<=d;m++)if((e=i.getCompositeStyle(-1,m))&&a!==e.locked)return!1}return a===u},iR:function(t,n,e,i){var r,o,a,r=this;for(n=n<0?0:n,o=t=t<0?0:t;o<t+e;o++)for(a=n;a<n+i;a++)if(r.l0(o,a,"locked"))return!0},rR:function(){for(var t,n,t=this.getSelections(),n=0;n<t.length;n++)if(-1!==t[n].col)return!1;return!0},oR:function(){for(var t,n,t=this.getSelections(),n=0;n<t.length;n++)if(-1!==t[n].row)return!1;return!0},selectionPolicy:function(t){var n=this,e=n.Ut;return 0===arguments.length?e.getSelectionPolicy():(e.do("setSelectionPolicy",t),n)},selectionUnit:function(t){var n=this,e=n.Ut;return 0===arguments.length?e.getSelectionUnit():(e.do("setSelectionUnit",t),n)},getSelectionBackColor:function(){return this.options.selectionBackColor||y.I.fl(a).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||y.I.fl(a).borderTopColor},aR:function(t){if(!t)return this.options.aR;this.options.aR=t},e4:function(){var t,n,n,e,t=this,n=t.Ut.getSelections();0<p(n)&&(n={selections:n},0!==(e=t.Ut.getActiveSelectedRangeIndex())&&(n.activeSelectedRangeIndex=e),t.uR=n,t.IA(),t.Dn.E1())},cR:function(){var t=this,n=t.uR,e=n&&n.selections;e&&(t.Ut.do("setSelections",e),t.Ut.do("setActiveSelectedRangeIndex",n.activeSelectedRangeIndex||0))},pA:function(t,n,e,i){var r,o,a,i,a,t,r=this,a=r.tables,o=(e||i)&&(o=a&&a.fR(t,n))||r.lR(t,n,e,r.hR||0);o&&(i=o.row,a=o.col,t=o.leadingCellCol,r.dR(i,a))&&(r.qA=i,r.hR=t,r.XA(i,a))},lR:function(t,n,e,i){var r,o,a,u,s,c,r=this,o=A(r),a=T(r),u=t;return 0===u&&!e||0===o||0===a||(c=r.vR(u,i),e||r.mR(c),u=c.r,s=c.c,u<0&&e&&(i=s=(s=r.r6(s))<0||d(s)?r.r6(a):s,u=(c=r.vR(o,s)).r,(s=c.c)===n)&&u<=t)?M:{row:u,col:s,leadingCellCol:i}},bA:function(t,n,e){var i,e,t,n,e,i=this,e=i.gR(t,n,e,i.hR||0);!e||e.row===t&&e.col===n||(t=e.row,n=e.col,e=e.leadingCellCol,i.dR(t,n)&&(i.qA=t,i.hR=e,i.XA(t,n)))},gR:function(t,n,e,i){var r,o,a,u,s,c,r=this,o=A(r),a=T(r),u=t;if((u!==o-1||e)&&0!==o&&0!==a&&(c=r.pR(u,i),e||r.mR(c),u=c.r,s=c.c,!(u===o&&e&&(i=s=a<=(s=r.O5(s))||d(s)?r.O5(-1):s,u=(c=r.pR(-1,s)).r,(s=c.c)===n)&&t<=u)))return{row:u,col:s,leadingCellCol:i}},wA:function(){var t,n,e,n,t=this,n=t.bR();n&&(e=n.row,n=n.col,t.qA=e,t.hR=n,t.XA(e,n))},bR:function(){var t,n,e,i,r,o,a,o,u,t=this,n=t.P6(),e=t.G6(),i=e;if(n||i){if(a=!1!==(o=(r=t.options).protectionOptions).allowSelectLockedCells,o=!1!==o.allowSelectUnlockedCells,!t.isActualProtected()||a&&o)return{row:n,col:i};if(a||o)for(;n!==M&&0<=n;n=t.nI(n))for(i=e;i!==M&&0<=i;i=t.r6(i))if(a===(u=t.l0(n,i,"locked")))return{row:n,col:i}}return M},yA:function(){var t,n,e,n,t=this,n=t.yR();n&&(e=n.row,n=n.col,t.qA=e,t.hR=n,t.XA(e,n))},yR:function(){var t,n,e,i,r,o,a,u,s,u,c,t=this,n=t.j5(t.frozenRowCount()-1),e=t.O5(t.frozenColumnCount()-1),i=e,r=t.P6(),o=t.G6();if(n!==M&&i!==M){if(s=!1!==(u=(a=t.options).protectionOptions).allowSelectLockedCells,u=!1!==u.allowSelectUnlockedCells,!t.isActualProtected()||s&&u)return{row:n,col:i};if(s||u)for(;n!==M&&n<=r;n=t.j5(n))for(i=e;i!==M&&i<=o;i=t.O5(i))if(s===(c=t.l0(n,i,"locked")))return{row:n,col:i}}return M},mA:function(t,n,e){var i,r,o,o,t,n,i=this,o=i.tables,r=e&&(r=o&&o.wR(t,n))||i.sI(t,n,e,i.qA||0);r&&(o=r.row,t=r.col,n=r.leadingCellRow,i.dR(o,t))&&(i.qA=n,i.hR=t,i.XA(o,t))},sI:function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=A(r),a=T(r),s=n;if(0===s&&!e||0===o||0===a)return M;for(c=r.MR(i,s),f=i,e||r.mR(c),u=c.r,s=c.c;s<0&&e;){if(i=u=(u=r.nI(u,3,!0))<0||d(u)?r.nI(o,3,!0):u,u=(c=r.MR(i,a)).r,s=c.c,u===t&&s<n)return M;if(u===t&&s===n){if(i===f)return M;u=(c=r.MR(i,s)).r,s=c.c}}return{row:u,col:s,leadingCellRow:i}},mR:function(t){var n,e,e,n=this,e=!1;t.r<0?t.r=n.N9():t.r>=A(n)&&(t.r=n.P6(),e=!0),t.c<0?t.c=n.k9():t.c>=T(n)&&(t.c=n.G6(),e=!0),e&&((e=n.Ut.getSpan(t.r,t.c)).row!==t.r&&(t.r=e.row),e.col!==t.c)&&(t.c=e.col)},CA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.row,s=a.col,c=a.col+x(a)-1,f=t,l=n;f=(h=e.CR(f,l)).r,!(s<=(l=h.c));){if(o===r&&f===t&&l<=n)return;l=u<=--f?c+1:(h=e.JS(e.U5(3)),o=i.getActiveSelectedRangeIndex(),u=h.row,s=h.col,c=h.col+x(h)-1,f=h.row+I(h)-1,h.col+x(h))}0<=f&&(e.XA(f,l),e.qA=f,e.hR=l)},SA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.col,s=a.row+I(a)-1,c=a.col+x(a)-1,f=t,l=n;f=(h=e.TR(f,l)).r,!((l=h.c)<=c);){if(o===r&&f===t&&n<=l)return;l=++f<=s?u-1:(h=e.JS(e.U5(4)),o=i.getActiveSelectedRangeIndex(),u=h.col,s=h.row+I(h)-1,c=h.col+x(h)-1,f=h.row,h.col-1)}0<=f&&(e.XA(f,l),e.qA=f,e.hR=l)},TA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.row,s=a.row+I(a)-1,c=a.col,f=t,l=n;f=(h=e.AR(f,l)).r,l=h.c,!(u<=f);){if(o===r&&l===n&&f<=t)return;c<=--l?f=s+1:(h=e.JS(e.U5(1)),o=i.getActiveSelectedRangeIndex(),u=h.row,s=h.row+I(h)-1,c=h.col,f=h.row+I(h),l=h.col+x(h)-1)}0<=l&&(e.XA(f,l),e.qA=f,e.hR=l)},AA:function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=this,i=e.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=e.JS(e.U5()),u=a.row,s=a.row+I(a)-1,c=a.col+x(a)-1,f=t,l=n;f=(h=e.IR(f,l)).r,l=h.c,!(f<=s);){if(o===r&&l===n&&t<=f)return;++l<=c?f=u-1:(h=e.JS(e.U5(2)),o=i.getActiveSelectedRangeIndex(),s=h.row+I(h)-1,c=h.col+x(h)-1,f=h.row-1,l=h.col)}0<=l&&(e.XA(f,l),e.qA=f,e.hR=l)},gA:function(t,n,e){var i,r,o,o,e,t,i=this,o=i.tables,r=e&&(r=o&&o.xR(t,n))||i.uI(t,n,e,i.qA||0);!r||r.row===t&&r.col===n||(o=r.row,e=r.col,t=r.leadingCellRow,i.dR(o,e)&&(i.qA=t,i.hR=e,i.XA(o,e)))},uI:function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=A(r),a=T(r),s=n;if(s===a-1&&!e||0===o||0===a)return M;for(c=r.NR(i,s),f=i,e||r.mR(c),u=c.r,s=c.c;s===a&&e;){if(t===o-1&&t===u&&(!r.getRowVisible(u,3)||r.Gt(u,3)<=0))return M;if(i=u=o<=(u=r.j5(u,3,!0))||d(u)?r.j5(-1,3,!0):u,u=(c=r.NR(i,-1)).r,s=c.c,u===t&&n<s)return M;if(u===t&&s===n){if(i===f)return M;u=(c=r.NR(i,s)).r,s=c.c}}return{row:u,col:s,leadingCellRow:i}},MR:function(t,n){for(var e,i,r,o,o,e=this,r=n;0<=r&&(i=t,!(--r<0));)if(e.getColumnVisible(r)&&((o=e.Ut.getSpans((0,y.Ec)(i,r,1,1)))&&0<p(o)&&r>=(o=o[0]).col&&(r=o.col,i=o.row),e.dR(i,r)))return{r:i,c:r};return{r:i,c:r}},CR:function(t,n){for(var e,i,r,e=this;0<=n&&!(--n<0);){if(i=e.Ut.findSpan(t,n)){if(!((r=e.U5()).row<=i.row&&i.row+I(i)<=r.row+I(r)&&r.col<=i.col&&i.col+x(i)<=r.col+x(r)))continue;if(i.row!==t||i.col!==n)continue;n>=i.col&&(n=i.col,t=i.row)}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},NR:function(t,n){for(var e,i,r,o,a,a,u,e=this,i=T(e),o=n;o<i&&!(i<=(o=(a=e.Ut.getSpan(r=t,o)).col+x(a)));)if(e.getColumnVisible(o)&&((a=e.Ut.getSpans((0,y.Ec)(r,o,1,1)))&&0<p(a)&&(o>(u=a[0]).col?o=C(o,u.col+x(u)):r=u.row),e.dR(r,o)))return{r:r,c:o};return{r:r,c:o}},TR:function(t,n){for(var e,i,r,o,o,a,e=this,i=e.Ut,r=T(e);n<r&&!(r<=(n=(o=i.getSpan(t,n)).col+x(o)));){if(o=i.findSpan(t,n)){if(!((a=e.U5()).row<=o.row&&o.row+I(o)<=a.row+I(a)&&a.col<=o.col&&o.col+x(o)<=a.col+x(a)))continue;if(o.row!==t||o.col!==n)continue;n>o.col?n=C(n,o.col+x(o)):t=o.row}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},dR:function(t,n){var e,i,r,o,e=this;return!!e.JA(t,n)&&(i=0<=t&&t<A(e)&&0<=n&&n<T(e)&&e.getRowVisible(t)&&e.getColumnVisible(n)&&0<e.Gt(t)&&0<e.nn(n),r=!!e.F5,!0!==i||!0!=r||!1!==(o=e.l0(t,n,"tabStop")))&&i},vR:function(t,n){for(var e,i,i,e=this;0<=t&&!(--t<0);)if(e.getRowVisible(t)&&((i=e.Ut.getSpans((0,y.Ec)(t,n,1,1)))&&0<p(i)&&t>=(i=i[0]).row&&(t=i.row,n=i.col),e.dR(t,n)))return{r:t,c:n};return{r:t,c:n}},AR:function(t,n){for(var e,i,r,e=this;0<=t&&!(--t<0);){if(i=e.Ut.findSpan(t,n)){if(!((r=e.U5()).row<=i.row&&i.row+I(i)<=r.row+I(r)&&r.col<=i.col&&i.col+x(i)<=r.col+x(r)))continue;if(i.row!==t||i.col!==n)continue;t>=i.row&&(n=i.col,t=i.row)}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},pR:function(t,n){for(var e,i,r,r,o,e=this,i=A(e);t<i&&!(i<=(t=(r=e.Ut.getSpan(t,n)).row+I(r)));)if(r=e.Ut.getSpans((0,y.Ec)(t,n,1,1)),e.getRowVisible(t)&&(r&&0<p(r)&&(t>(o=r[0]).row?t=C(t,o.row+I(o)):n=o.col),e.dR(t,n)))return{r:t,c:n};return{r:t,c:n}},IR:function(t,n){for(var e,i,r,o,o,a,e=this,i=e.Ut,r=A(e);t<r&&!(r<=(t=(o=i.getSpan(t,n)).row+I(o)));){if(o=i.findSpan(t,n)){if(!((a=e.U5()).row<=o.row&&o.row+I(o)<=a.row+I(a)&&a.col<=o.col&&o.col+x(o)<=a.col+x(a)))continue;if(o.col!==n||o.row!==t)continue;t>o.row?t=C(t,o.row+I(o)):n=o.col}if(e.dR(t,n))return{r:t,c:n}}return{r:t,c:n}},D9:function(t,n,e,i,r,o){var a=this;a.Ut.do("addSelection",t,n,e,i,M,o),r&&a.My<=0&&a.Dn.E1(M,M,M,M,o)},L9:function(t,n,e){var i,t,n,r,o,t,a,u,i=this,t=i.xA(t,n,i.ui,i.ci),n=t.row,r=t.col,o=I(t),t=x(t),a=i.selectionPolicy(),u=i.selectionUnit();0!==a&&(1===a&&i.Ut.do("clearSelection"),1===u?t=r=-1:2===u&&(o=n=-1),i.kA(n,r,o,t,e))},xA:function(t,n,e,i,r,o){var a,u,e,i,u,t,a=this;return d(e)&&(e=a.ui),d(i)&&(i=a.ci),e=(u=a.Ut).getSpan(e,i,o),i=u.getSpan(t,n,o),r&&e.equals(i)?new y.Range(e.row,e.col,1,1):(u=e.union(i),(t=a.Ut.getSpans(M,o))&&0<p(t)?a.kR(t,u):u)},kA:function(t,n,e,i,r){var o,a,u,s,c,f,c,f,a,o=this,a=o.Ut,u=o.U5();0<p(a.getSelections())?(c=(0,y.Ec)(t,n,e,i),o.O9?(s=o.z9,o.z9=c):((f=a.getSelections())[a.getActiveSelectedRangeIndex()]=c,a.do("setSelections",f))):o.O9||a.do("addSelection",t,n,e,i),r&&o.My<=0&&(c=o.U5(),!o.O9&&c.row===u.row&&c.col===u.col&&I(c)===I(u)&&x(c)===x(u)||(f=o.Dn,o.O9&&(a=o.z9,s&&s.containsRange(a)?a=s:s&&(a=s.union(a)),u=(a=a.union((0,y.Ec)(o.getActiveRowIndex(),o.getActiveColumnIndex(),1,1))).union(u),c=a.union(c)),u.containsRange(c)?f.E1(u):c.containsRange(u)?f.E1(c):(f.E1(u),f.E1(c),f.E1(o.z9))))},DR:function(t){var n=[];return n=t?this.Ut.getSpans(t):n},_R:function(t,n){var e=t.row,i=t.col,r=t.rowCount,o=t.colCount,a=n.row,u=n.col,s=n.rowCount,c=n.colCount,r=e+r,o=i+o,f=a+s,l=u+c,h=!1,d=!1,v;return t.intersect(a,u,s,c)&&(d=!(h=v=a<e||u<i||r<f||o<l)),n.ER=n.ER||d,h},jR:function(t,n,e,i){for(var r,o,a,r=[],o=[],a=0;a<t.length;a++)o=this.RR(t[a],n,e,i),r=r.concat(o);return r},RR:function(t,n,e,i){var r,o,a,u,a,s,c,r=[],o=n.length;for(r.push(t),s=o-1;0<=s;s--)for(u=n[s],c=0;c<r.length;)a=r[c],this._R(a,u)?(r=f(r,c,a=this.BR(a,u,e,i)),c+=a.length):c++;return r},LR:function(t,n){var e=n.row,i=n.col,r=n.rowCount,n=n.colCount;return t.intersect(e,i,r,n)},FR:function(t,n){for(var e,i,r,o,e,i=[],o=t.length-1;0<=o;o--)r=t[o],this.LR(r,n)||i.push(r);return i},PR:function(t){var n=!1,e=this.Ut.getSpans(t);return n=1===e.length?t.equals(e[0]):n},GR:function(t,n){for(var e,t,i,r,o,a,u,s,e=t,t=n.length,i=e.length,r=!0,u=t-1;0<=u;u--){for(a=n[u],s=i-1;0<=s;s--)if((o=e[s]).equals(a)){r=!1;break}r&&e.push(a)}return e},UR:function(t){for(var n,e,i,r,o,a,n,e=[],r=t.length-1;0<=r;r--)(i=t[r]).ER&&(delete i.ER,e.push(r));for(o=e.length,a=0;a<o;a++)t.splice(e[a],1)},BR:function(t,n,e,i){var r,n,e,i,o,a,u,s,c,f,o,l,h,n;return n=this.JS(n),r=[],n=t.getIntersect(n,e,i),t&&n?(e=0<=t.row?t.row:0,i=0<=t.col?t.col:0,o=t.rowCount,a=t.colCount,u=n.row,s=n.col,c=n.rowCount,l=i+a,n=s+(f=n.colCount),0<(o=e+o)-(h=u+c)&&r.push((0,y.Ec)(h,i,o-h,a)),0<l-n&&r.push((0,y.Ec)(u,n,c,l-n)),0<s-i&&r.push((0,y.Ec)(u,i,c,s-i)),0<u-e&&r.push((0,y.Ec)(e,i,u-e,a))):r.push(t),r},tD:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,e=[],i=this.getRowCount(3),r=this.getColumnCount(3),o=this.deselectIgnoreSpan();if(t&&0<t.length){for(s=[],c=[],h=l=void 0,a=!(f=[]),d=(u=t.length)-1;0<=d;d--)l=t[d],o||!this.PR(l)||this.LR(l,n)?(s=this.BR(l,n,i,r),o||0<(h=this.DR(l)).length&&(s=this.jR(s,h,i,r),f=this.FR(h,n),c=this.GR(c,f),this.UR(c)),v=p(s),!a&&0<v&&(this.setSelection(s[v-1].row,s[v-1].col,1,1),a=!0),e=s.concat(e)):c=this.GR(c,[l]);o||(e=c.concat(e))}for(this.IA(),m=e.length,this.suspendPaint(),g=0;g<m;g++)this.n4(e[g].row,e[g].col,e[g].rowCount,e[g].colCount);a||this.setActiveCell(this.ui,this.ci),this.resumePaint()},HA:function(t,n){var e,i,r,r,t,n,o,r,a,u,a,e=this,i=e.Ut.getSelections();p(i)<=0||(r=e.U5(),(r=e.HR(r,t,n))&&(t=r.row,n=r.col,o=I(r),r=x(r),a=e.selectionPolicy(),u=e.selectionUnit(),0!==a)&&(1===a&&e.Ut.do("clearSelection"),1===u?r=n=-1:2===u&&(o=t=-1),e.kA(t,n,o,r,!0),a=e.Ut.getSelections(),e.rt._A(i,a))&&(e.EA(i,a),e.jA(i)))},HR:function(t,n,e,i,r){var o,a,u,o=this,a=o.JS(t),u=M;return 37===n?u=e?o.zR(a,!1,i,r):o.VR(a,i,r):39===n?u=e?o.YR(a,!1,i,r):o.ZR(a,i,r):38===n?u=e?o.WR(a,!1,i,r):o.QR(a,i,r):40===n?u=e?o.KR(a,!1,i,r):o.JR(a,i,r):36===n?u=e?o.XR(a,i,r):o.qR(a,i,r):35===n?u=e?o.$R(a,i,r):o.tB(a,i,r):33===n?u=o.nB(a,i,r):34===n&&(u=o.eB(a,i,r)),u&&(t.row<0&&(u.row=-1,u.rowCount=o.getRowCount()),t.col<0)&&(u.col=-1,u.colCount=o.getColumnCount()),u},VR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,l,m,g,p,b,w,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=o+u-1,c=0,f=k(i,r,a);0<s;)if(i.dR(f,--s)&&(l=i.xA(f,s,n,e),h=S(r,l.row),d=S(o,l.col),m=(v=C(r+a-1,l.row+I(l)-1))-h+1,g=(l=S(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||m!==a||g!==u))return p=i.Ab,o<(b=i.ci)?d<=p&&i.o9(d):o===b&&l<=p&&i.o9(l),(w=i.parent&&i.parent.options.scrollByPixel)&&d===p&&0!==i.my&&i.o9(d,0),(0,y.Ec)(h,d,m,g);return M},zR:function(t,n,e,i){var r,o,a,u,s,s,u,n,r,s,e,c,f,r=this,o=t.row,a=t.col,u=r.frozenColumnCount(),s=u?r.O5(u-1):r.k9(),s=n?s:r.k9();if(!d(s))return(u<=0||n)&&r.o9(s),u=r.xA(o,s,e,i),n=S(o,u.row),r=S(a,u.col),s=C(o+I(t)-1,u.row+I(u)-1),e=S(a+x(t)-1,u.col+x(u)-1),(0,y.Ec)(n,r,c=s-n+1,f=e-r+1)},iB:function(t){var n,e,i,r,o,i,a,n=this,e;if(n.parent&&n.parent.options.scrollByPixel){for(o=n.Jt,i=n.S0(t),a=n.getViewportWidth(i);0<=t&&!((a-=o.Kt(t))<0);t--);i=t,r=a}else i=n.rB(t,2).col,r=0;return{iw:i,Xy:r}},ZR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,l,m,g,p,b,w,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=o,c=T(i)-1,f=k(i,r,a);s<c;)if(i.dR(f,++s)&&(l=i.xA(f,s,n,e),h=S(r,l.row),d=C(o,l.col),m=(v=C(r+a-1,l.row+I(l)-1))-h+1,g=(l=C(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||m!==a||g!==u))return p=i.oB(),o<(b=i.ci)?p<=d&&(w=i.iB(d),i.o9(w.iw,w.Xy)):o===b&&p<=l&&(w=i.iB(l),i.o9(w.iw,w.Xy)),(0,y.Ec)(h,d,m,g);return M},YR:function(t,n,e,i){var r,o,a,u,u,n,r,u,e,i,s,c,r=this,o=t.row,a=t.col,u=r.aB();if(!d(u))return r.o9(u),u=r.G6(),n||(u+=r.frozenTrailingColumnCount()),n=r.xA(o,u,e,i),r=S(o,n.row),u=C(a,n.col),e=C(o+I(t)-1,n.row+I(n)-1),i=C(a+x(t)-1,n.col+x(n)-1),(0,y.Ec)(r,u,s=e-r+1,c=i-u+1)},QR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,w,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=r+a-1,c=0,f=N(i,o,u);0<s;)if(i.dR(--s,f)&&(l=i.xA(s,f,n,e),h=S(r,l.row),d=S(o,l.col),g=(v=S(r+a-1,l.row+I(l)-1))-h+1,l=(m=C(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||g!==a||l!==u))return p=i.Tb,r<(b=i.ui)?h<=p&&i.$A(h):r===b&&v<=p&&i.$A(v),(w=i.parent&&i.parent.options.scrollByPixel)&&h===p&&0!==i.ly&&i.$A(h,0),(0,y.Ec)(h,d,g,l);return M},WR:function(t,n,e,i){var r,o,a,u,s,s,u,n,r,s,e,c,f,r=this,o=t.row,a=t.col,u=r.frozenRowCount(),s=u?r.j5(u-1):r.N9(),s=n?s:r.N9();if(!d(s))return(u<=0||n)&&r.$A(s),u=r.xA(s,a,e,i),n=S(o,u.row),r=S(a,u.col),s=S(o+I(t)-1,u.row+I(u)-1),e=C(a+x(t)-1,u.col+x(u)-1),(0,y.Ec)(n,r,c=s-n+1,f=e-r+1)},uB:function(t){var n,e,i,r,o,i,a,n=this,e;if(n.parent&&n.parent.options.scrollByPixel){for(o=n.Jt,i=n.C0(t),a=n.getViewportHeight(i);0<=t&&!((a-=o.Gt(t))<0);t--);i=t,r=a}else i=n.Jy(t,2),r=0;return{Ky:i,Xy:r}},JR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,w,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=r,c=A(i)-1,f=N(i,o,u);s<c;)if(i.dR(++s,f)&&(l=i.xA(s,f,n,e),h=C(r,l.row),d=S(o,l.col),g=(v=C(r+a-1,l.row+I(l)-1))-h+1,l=(m=C(o+u-1,l.col+x(l)-1))-d+1,h!==r||d!==o||g!==a||l!==u))return p=i.sB(),r<(b=i.ui)?p<=h&&(w=i.uB(h),i.$A(w.Ky,w.Xy)):r===b&&p<=v&&(w=i.uB(v),i.$A(w.Ky,w.Xy)),(0,y.Ec)(h,d,g,l);return M},KR:function(t,n,e,i){var r,o,a,u,u,n,r,u,e,i,s,c,r=this,o=t.row,a=t.col,u=r.cB();if(!d(u))return r.$A(u),u=r.P6(),n||(u+=r.frozenTrailingRowCount()),n=r.xA(u,a,e,i),r=C(o,n.row),u=S(a,n.col),e=C(o+I(t)-1,n.row+I(n)-1),i=C(a+x(t)-1,n.col+x(n)-1),(0,y.Ec)(r,u,s=e-r+1,c=i-u+1)},qR:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=i.frozenColumnCount()-1,c=i.ci,f=r+a-1;s<c;)if(i.dR(f,++s)){if(o<=s&&o+u-1===i.ci)break;return l=i.xA(f,s,n,e),h=S(r,l.row),d=S(o,l.col),g=(v=C(r+a-1,l.row+I(l)-1))-h+1,l=(m=S(o+u-1,l.col+x(l)-1))-d+1,i.o9(i.k9()),(0,y.Ec)(h,d,g,l)}return M},XR:function(t,n,e){return t=this.zR(t,!0,n,e),t=this.WR(t,!0,n,e)},tB:function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,i=this,r=t.row,o=t.col,a=I(t),u=x(t),s=T(i),c=i.ci,f=r+a-1;c<s;)if(i.dR(f,--s)){if(s<=o+u-1&&o===i.ci)break;return l=i.xA(f,s,n,e),h=S(r,l.row),d=C(o,l.col),g=(v=C(r+a-1,l.row+I(l)-1))-h+1,l=(m=C(o+u-1,l.col+x(l)-1))-d+1,i.o9(i.aB()),(0,y.Ec)(h,d,g,l)}return M},$R:function(t,n,e){return t=this.YR(t,!0,n,e),t=this.KR(t,!0,n,e)},nB:function(t,n,e){var i,r,o,a,u,s,c,f,u,s,i,f,n,l,h,i=this,r=t.row,o=t.col,a=I(t),u=i.QA();return d(u)?M:(s=i._y(1),f=-1,(c=i.$A(u))?f=i.j5(r+a-1-p(s)):i.frozenRowCount()<=0&&(f=i.N9()),f<i.Tb?f=i.Tb:f>=i.sB()&&(f=i.nI(i.sB())),u=i.xA(f,o,n,e),s=S(r,u.row),i=S(o,u.col),f=S(r+a-1,u.row+I(u)-1),n=C(o+x(t)-1,u.col+x(u)-1),(0,y.Ec)(s,i,l=f-s+1,h=n-i+1))},eB:function(t,n,e){var i,r,o,a,u,s,u,s,i,u,n,e,c,f,i=this,r=t.row,o=t.col,a=I(t),u=i.tI();return d(u)?M:(s=i._y(1),i.$A(u),(u=i.nI(r+a-1+p(s)))<i.Tb?u=i.Tb:u>=i.sB()&&(u=i.Tb>=i.cB()?i.sB():i.nI(i.sB())),s=i.xA(u,o,n,e),i=C(r,s.row),u=S(o,s.col),n=C(r+a-1,s.row+I(s)-1),e=C(o+x(t)-1,s.col+x(s)-1),(0,y.Ec)(i,u,c=n-i+1,f=e-u+1))},QA:function(){var t,n,n,e,i,r,o,t=this,n=t._y(1);if(!n||p(n)<=0)return M;for(e=(n=t.frozenRowCount())?t.j5(n-1):t.N9(),i=0,r=t.Tb,o=t.Fi();e<r&&!((i+=t.Gt(--r))>t.Sy(o)););return r},fB:function(){var t,n,n,e,i,r,o,t=this,n=t.Yy(1);if(!n||p(n)<=0)return M;for(e=(n=t.frozenColumnCount())?t.O5(n-1):t.k9(),i=0,r=t.Ab,o=t.Fi();e<r&&!((i+=t.nn(--r))>t.Gy(o)););return r},tI:function(){var t,n,t,t=this._y(1),n=p(t);return t&&0<n?(t=t[n-1].row,this.P6()<=t?this.Tb:t):M},cB:function(){var t,n,e,i,e,i,r,t=this;if(t.P6()===t.sB()&&(n=t.Fi(),e=t._y(1),i=p(e),e)&&1<=i&&(e=e[i-1]).y+e.height<=n.Cy+t.Sy(n))return t.Tb;i=t.Tb;try{return t.Tb=t.P6(),r=t.QA(),r=t.j5(r)}catch(t){}finally{t.Tb=i}},aB:function(){var t,n,e,i,e,r,o,t=this;if(t.G6()===t.oB()&&(n=t.Fi(),e=t.Yy(1),i=p(e),e)&&1<=i&&(e=e[i-1]).x+e.width<=n.Py+n.width)return t.Ab;for(n=t.Fi(),r=0,o=t.G6();0<o&&!((r+=t.nn(o))>t.Gy(n));)o--;return o=0<o?t.O5(o):o},sB:function(){var t=this._y(1),n=p(t);return t&&0<n?t[n-1].row:M},oB:function(){var t=this.Yy(1),n=p(t);return t&&0<n?t[n-1].col:M},getLastFullyVisibleRow:function(){var t,n,e,i,e,t=this,n=t._y(1),e=p(n);return n&&0<e?(i=t.Fi(),(n[e=e-1].y+n[e].height<=i.Cy+t.Sy(i)?n[e]:n[C(e-1,0)]).row):M},getLastFullyVisibleColumn:function(){var t,n,e,i,e,t=this,n=t.Yy(1),e=p(n);return n&&0<e?(i=t.Fi(),(n[e=e-1].x+n[e].width<=i.Py+t.Gy(i)?n[e]:n[C(e-1,0)]).col):M},P6:function(t){var n=A(this,t=d(t)?3:t);return 3!==t&&2!==t||(n-=this.frozenTrailingRowCount()),this.nI(n,t)},G6:function(t){var n=T(this,t=d(t)?3:t);return 3!==t&&1!==t||(n-=this.frozenTrailingColumnCount()),this.r6(n,t)},kR:function(t,n){var e,i,r;if(t)for(e=0,i=p(t);e<i;e++)if(r=t[e],n.intersect(r.row,r.col,I(r),x(r)))return t.splice(e,1),e--,this.kR(t,n.union(r));return n},U5:function(t){var n,e,i,r,o,n,e=this.Ut,i=p(e.getSelections()),r=(0,y.Ec)(-1,-1,0,0);return i<=0||(o=e.getActiveSelectedRangeIndex(),3===t||1===t?e.do("setActiveSelectedRangeIndex",o=--o<0?i-1:o):4!==t&&2!==t||e.do("setActiveSelectedRangeIndex",o=i<=++o?0:o),0<=(o=e.getActiveSelectedRangeIndex())&&(r=e.getSelections()[o])),r}}),i.Worksheet.ch("selection",{init:function(){this.Ut.do("addSelection",0,0,1,1),this.Ut.setCellState(0,0,o.CellStatesType.active,!0,o.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(r,t,o){"use strict";var e,t,y,w,n,M,n,C,S,n,b,u,h,T,s,c,A,f,l,I,i;function _(t,n,e){for(var i=t[e-n];i<e;)i=t[i-n];return i}function d(t,n){return"object"==typeof t?JSON.stringify(t):(t=n.getColor(t),e.Common.ft.j(e.Common.ft._(t)))}function x(t,n){return t instanceof Date&&n instanceof Date?u(t)===u(n):typeof t==c&&typeof n==c?t.toLowerCase()===n.toLowerCase():t===n}function N(t,n,e,i,r){var o,a,u,t,t=t.currentTheme();return o=(a=(a=T(n)||(a=r?n.backColor:n.foreColor,T(a))?a:d(a,t))||"")===(u=(u=T(e)||(u=r?e.backColor:e.foreColor,T(u))?u:d(u,t))||"")?0:a===i?1:u===i?-1:0}function k(t,n){var e,i,r,o,a;return t instanceof Date&&(t=u(t)),n instanceof Date&&(n=u(n)),r=(e=typeof t)==c,o=(i=typeof n)==c,a=i==A,e==i||e!=A&&!a?e==s&&o||(!r||i!=s)&&(r&&o?t.toLowerCase()>n.toLowerCase():n<t):a}function v(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,h,b,w,b,w,u=r,s=t,c=n;if(u)for(f=0;f<u.length&&(u[f]&&(l=u[f].ascending,0<=(h=u[f].index))&&(v=d=void 0,m=i?s:h,g=i?h:s,p=i?c:h,h=i?h:c,v=o?(d=o[m][g],o[p][h]):(d=e.getValue(m,g),e.getValue(p,h)),u[f].compareFunction?(a=u[f].compareFunction(d,v),l||(a*=-1)):T(u[f].color)?(b=T(d)||""===d||typeof d==A&&isNaN(d),w=T(v)||""===v||typeof v==A&&isNaN(v),b||w?b&&w?a=0:b&&!w?a=1:!b&&w&&(a=-1):a=x(d,v)?0:k(d,v)?l?1:-1:l?-1:1):(b=e.getActualStyle(m,g,3,!1,!1,!(w=b=void 0)),w=e.getActualStyle(p,h,3,!1,!1,!0),a=N(e,b,w,u[f].color,u[f].isBackColor),l||(a*=-1))),0===a);f++);return a}function g(t,n,e,i,r){var o,a,u,s,c,f,l,h,o=t.length;if(o<=1)return t;for(u=t[a=Math.floor(o/2)],s=[],c=[],f=[],l=0;l<o;l++)(a===l?f:(h=v(t[l],u,n,e,i,r))<0?s:0<h?c:f).push(t[l]);return g(s,n,e,i,r).concat(f,g(c,n,e,i,r))}function p(t,n,e){var i,r,o,i=[];if(n)for(r=e.length-1;0<=r;r--)o=e[r],0===t.getRowHeight(o)&&(e.splice(r,1),i.push({lp:r,y4:o}));else for(r=e.length-1;0<=r;r--)o=e[r],0===t.getColumnWidth(o)&&(e.splice(r,1),i.push({lp:r,y4:o}));return i}function D(t,n){for(var e,i,e=t.length-1;0<=e;e--)i=t[e],n.splice(i.lp,0,i.y4)}function j(t,n,e,i,r,o,a,u,s){for(var c,f,l,h,i,d,v,m,c=o?i:r,f=o?n:e,l=[],h=0;h<c;h++)l[h]=f+h;for(i=u.ignoreHidden?p(t,o,l):[],d=l.concat([]),v=!1,l=g(l,t,o,a,s),m=0;m<l.length;m++)if(l[m]!==d[m]){v=!0;break}return D(i,l),{array:l,isChanged:v}}function O(t,n,e,i,r,o,a,u,s){var c,f,i,r,l,h,d,n,e,c=o?i:r,f=o?n:e,i=o?t.rowOutlines:t.columnOutlines,r=i.lB(f,c),l=i.hB(r,u.groupSort);if(!l){for(h=[],d=0;d<c;d++)h.push(f+d);l=[h]}for(d=0;d<l.length;d++)l[d]=g(l[d],t,o,a,s);return e=(n=i.dB(l,r,u.groupSort)).array,n.isChanged&&m(t,o,n,e,r,f,c),{array:e,isChanged:n.isChanged}}function m(t,n,e,i,r,o,a){var u,s,c,f,l,u=n?t.rowOutlines:t.columnOutlines,s=[],c=[];if(n){for(f=o;f<o+a;f++)t.XT(f)||t.rowOutlines&&t.rowOutlines.isCollapsed(f)||(t.getRowVisible(f,3,!0)?0===t.getRowHeight(f)&&(s.push(f),t.setRowHeight(f,t.defaults.rowHeight)):(c.push(f),t.setRowVisible(f,!0)));for(u.vB(e.groupSwap,e.array,r.start),f=0;f<c.length;f++)l=h.hD(i,c[f])+o,t.setRowVisible(l,!1);for(f=0;f<s.length;f++)l=h.hD(i,s[f])+o,t.setRowHeight(l,0)}else{for(f=o;f<o+a;f++)t.columnOutlines&&t.columnOutlines.isCollapsed(f)||(t.getColumnVisible(f,3)?0===t.getColumnWidth(f)&&(s.push(f),t.setColumnWidth(f,t.defaults.colWidth)):(c.push(f),t.setColumnVisible(f,!0)));for(u.vB(e.groupSwap,e.array,r.start),f=0;f<c.length;f++)l=h.hD(i,c[f])+o,t.setColumnVisible(l,!1);for(f=0;f<s.length;f++)l=h.hD(i,s[f])+o,t.setColumnWidth(l,0)}}function E(t,n,e){var t=t.oT(n,e,!1);t&&t.hasListeners()&&t.mB()}function R(t,n,e,i){var r,r,i,r=o("SheetsCalc");r&&(r=r.CalcOperatorAdjustor.gB(t.rT,t.rT,t.pB(n,e),n,e,0,0),t.bB(n,e,r,i),i=t.oT(n,e,!!r))&&(t.Ile(n,e)&&i.isDefault(!0),i.yB())}function B(t,n,e,i,r,o,a,u,s,c,f,l){for(var h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,y=t.Ut,M=y.pI,S=M&&0<M.wB.length,A=o?n:e,I=o?n+i:e+r,N=o?e:n,k=o?e+r:n+i,T=A;T<I;T++)if(T!==(C=_(u,A,T)))for(o?(h=T,v=C):(d=T,m=C),x=N;x<k;x++)o?m=d=x:v=h=x,a&&(g=s[h][d],p=s[v][m]),S&&(b=M.get(h,d),w=M.get(v,m)),f&&l&&(E(f,h,d),E(f,v,m),f.SE(h,d,v,m),R(f,h,d),R(f,v,m)),y.do("swapNode",h,d,v,m),t.b8&&t.MB(h,d,v,m),S&&M.CB(b,h,d,w,v,m),a&&(s[h][d]=p,s[v][m]=g),c.push({row:h,col:d}),c.push({row:v,col:m})}function P(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,n,v,m,g,p,b,l=[],h=t.Ut.P8;if(0<h&&(n&&(t.Ut.P8=0),[].push.apply(t.Ut.G8,[{row:e,column:i,rowCount:r,columnCount:o,byRows:a,sortInfo:u,type:"sortRange",array:c.concat([]),sortState:t.getSortState()}])),d=M&&t.b3(),n=M&&t.Uw(),B(t,e,i,r,o,a,s,c,f,l,d,n),s)for(v=e;v<e+r;v++)for(m=i;m<i+o;m++)t.setValue(v,m,f[v][m]);if(d){for(g=e;g<e+r;g++)for(p=i;p<i+o;p++)(b=d.pB(g,p))&&d.SB(g,p,b,I);t.getCalcService().recalcRange(n,e,i,r,o)}return w.Worksheet.et(t,"sortRangeChanged",{column:i,columnCount:o}),0<h&&(t.Ut.P8=h),l}function G(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m;t.suspendPaint(),t.suspendEvent(),M&&t.suspendCalcService();try{if(c)for(l=[],h=n;h<n+i;h++)for(l[h]=[],d=e;d<e+r;d++)l[h][d]=t.getValue(h,d);return m=v=void 0,(v=s||(m=(0===u.groupSort?j:O)(t,n,e,i,r,o,a,u,l)).array)?(f=P(t,m&&m.isChanged,n,e,i,r,o,a,c,v,l),!0):!1}finally{M&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.SI(n,e,i,r,f,4,I,I,I,!!s)}}function F(t,n){for(var e,i,r,o,a,u,s,e=[],i=0,r=n;i<r.length;i++)(o=r[i]).compareFunction?(a=o,e.push({index:a.index,ascending:a.ascending,compareFunction:a.compareFunction})):o.order&&o.hasOwnProperty(f)?(u="top"!==(a=o).order,s=T(a.backColor)?"":d(a.backColor,t.currentTheme()),e.push({index:a.index,ascending:u,color:s,isBackColor:!0})):o.order&&o.hasOwnProperty(l)?(u="top"!==(a=o).order,s=T(a.fontColor)?"":d(a.fontColor,t.currentTheme()),e.push({index:a.index,ascending:u,color:s,isBackColor:!1})):(o.color&&(o.color=d(o.color,t.currentTheme())),e.push(o));return e}function U(t,n){var e,i,r;if(n){for(e=t[0],i=1;i<t.length;i++)if((r=t[i]).row!==e.row||r.rowCount!==e.rowCount)return;return 1}}function H(t,n){for(var e,i,r,o,a,u,e=t[0],i=e.row,r=1;r<t.length;r++)(o=t[r])&&o.row<i&&(i=o.row,e=o);if(i===n.row-1)return a=n.row,u=e.row+e.rowCount,n.row=u,n.rowCount=n.rowCount-(u-a),n}function L(t,n,e,i){var r,o;if(t.sortConditions)for(r in t.sortConditions)t.sortConditions&&t.sortConditions.hasOwnProperty(r)&&((o=t.sortConditions[r]).index>=n&&o.index<n+e?i.push(o.index):o.index>=n+e&&(o.index-=e))}Object.defineProperty(t,"__esModule",{value:!0}),e=o("Common"),t=o("./dist/core/util/domUtil.js"),y=o("./dist/core/util/common.js"),w=o("./dist/core/worksheet/worksheet.js"),n=o("CalcEngine"),M=!!n,n=o("./dist/core/core.ns.js"),C=o("./dist/core/core.enum.js"),S=o("./dist/core/excel-io-util/range-parser.js"),n=new e.Common.ResourceManager(n.SR,"Sheets"),b=n.getResource.bind(n),u=e.Common.ct.o0,h=e.Common.Uf,T=e.Common.lt.ht,s="boolean",c="string",A="number",f="backColor",l="fontColor",I=void 0,t.GC$.extend(w.Worksheet.prototype,{sortRange:function(t,n,e,i,r,o,a,u,s){var c,f,f,l,h,d,v,l,h,l,h,m,h,l,g,p,h,m,l,c=!1;if(0===arguments.length){if(!(f=this.getSortState()))return!1;t=f.row,n=f.col,e=f.rowCount,i=f.colCount,o=f.sortConditions,r=f.byRow,c=!0}if(l=(f=this).getRowCount(),h=f.getColumnCount(),-1===e&&(e=l),-1===n&&(n=0),-1===i&&(i=h),(t=-1===t?0:t)<0||l<=t||n<0||h<=n||e<0||l<t+e||i<0||h<n+i||!o)return!1;if(a=f.TB(y.Ec(t,n,e,i),r,a),l=r?f.rowOutlines:f.columnOutlines,!u&&0<a.groupSort){if(!l)return!1;h=l.lB(v=r?t:n,d=r?e:i),r?(e=h.count,t=h.start):(i=h.count,n=h.start)}return M&&!f.mT(t,n,e,i,!1)?(s&&f.jT(7,b().Exp_InvalidSortArrayFormulaInRange),!1):(l=y.Ec(t,n,e,i),(h=f.Ut.getSpans(l))&&0<h.length&&(m=!0,U(h,r)&&(h=H(h,l))&&(t=h.row,e=h.rowCount,m=!1),m)?(s&&f.jT(7,b().Exp_InvalidSortSpanInRange),!1):!(l=f.tables)||(p=1===(g=l.AB(t,n,e,i)).length&&g[0].dataRange().equals(y.Ec(t,n,e,i)),g.length<=0)||p?(h=f.H3,m=(!f.NMi||f.NMi._gi!==C.SheetType.ganttSheet)&&h&&h._dataSource||p&&g[0]&&g[0].z3(),(l=G(f,t,n,e,i,r,F(f,o),a,u,m))&&0!==a.groupSort&&f.IB&&f.IB.reFilter(),c||u||this.Tpe(t,n,e,i,r,o),l):(s&&f.jT(7,b().Exp_InvalidSortPartTableOrMultiTableInRange),!1))},TB:function(t,n,e){var i,t,r,o,a,n,i=this,t=i.JS(t),r=n?t.rowCount:t.colCount,o=n?t.row:t.col,a=n?i.rowOutlines:i.columnOutlines;return T(e)&&(e={}),i.outlineColumn&&i.outlineColumn.xB()&&n&&(n=i.outlineColumn.NB.columnIndex,t.col<=n&&n<=t.col+t.colCount||(e.groupSort=0)),T(e.groupSort)&&(T(e.ignoreHidden)?e.groupSort=a&&a.kB(o,r)?1:0:e.groupSort=0),0===e.groupSort?e.ignoreHidden=!!T(e.ignoreHidden)||e.ignoreHidden:e.ignoreHidden=!1,e},_B:function(){var t=this.options;return!this.isActualProtected()||t.protectionOptions.allowSort},MB:function(t,n,e,i){var r=this,o=r.getDataValidator(t,n),a=r.getDataValidator(e,i);r.setDataValidator(t,n,a),r.setDataValidator(e,i,o)},Tpe:function(t,n,e,i,r,o){var a,u,a,a,s,u=this,a=null==(a=u.rowFilter())?void 0:a.Ipe;if(!a){if(o.length<1)return u.Ape();(a={row:t,col:n,rowCount:e,colCount:i,byRow:r}).sortConditions=o,u.fQt=a}},Ape:function(){var t;this.fQt=void 0},getSortState:function(){var t,n,t=this;return t.fQt&&((n=y.RF(t.fQt,!0)).sortConditions=n.sortConditions.map(function(t){return(Object.hasOwnProperty.call(t,"backColor")||Object.hasOwnProperty.call(t,"fontColor"))&&(t.ascending=void 0,delete t.ascending),t}),n)},Npe:function(t,n){var e,i,r,o,a,e=this.getSortState();if(e&&!(t>=e.row+e.rowCount))if(t<=e.row){if(e.row=e.row+n,!e.byRow)for(i=0,r=e.sortConditions;i<r.length;i++)(o=r[i]).index=o.index+n}else if(e.rowCount=e.rowCount+n,!e.byRow&&e.sortConditions)for(a in e.sortConditions)e.sortConditions.hasOwnProperty(a)&&(o=e.sortConditions[a]).index>=t&&(o.index+=n)},kpe:function(t,n){var e,i,r,o,a,e=this.getSortState();if(e&&!(t>=e.col+e.colCount))if(t<=e.col){if(e.col=e.col+n,e.byRow)for(i=0,r=e.sortConditions;i<r.length;i++)(o=r[i]).index=o.index+n}else if(e.colCount=e.colCount+n,e.byRow&&e.sortConditions)for(a in e.sortConditions)e.sortConditions.hasOwnProperty(a)&&(o=e.sortConditions[a]).index>=t&&(o.index+=n)},_pe:function(t,n){var e,i,r,o,a,u,e=this.getSortState();if(e&&(i=[],!(t>=e.row+e.rowCount))){if(t+n<=e.row){if(e.row=e.row-n,!e.byRow)for(r=0,o=e.sortConditions;r<o.length;r++)(a=o[r]).index=a.index-n}else if(t>=e.row&&t+n<e.row+e.rowCount){if(e.rowCount=e.rowCount-n,!e.byRow&&e.sortConditions)for(u in e.sortConditions)e.sortConditions.hasOwnProperty(u)&&((a=e.sortConditions[u]).index>=t&&a.index<t+n?i.push(a.index):a.index>=t+n&&(a.index-=n))}else t<e.row?(e.rowCount-=t+n-e.row,e.row=t):e.rowCount-=e.row+e.rowCount-t,e.byRow||L(e,t,n,i);return 0<i.length&&(e.sortConditions=e.sortConditions.filter(function(t){return-1===i.indexOf(t.index)})),0===e.sortConditions.length||e.rowCount<=0?this.Ape():void 0}},Dpe:function(t,n){var e,i,r,o,a,u,e=this.getSortState();if(e&&(i=[],!(t>=e.col+e.colCount))){if(t+n<=e.col){if(e.col=e.col-n,e.byRow)for(r=0,o=e.sortConditions;r<o.length;r++)(a=o[r]).index=a.index-n}else if(t>=e.col&&t+n<e.col+e.colCount){if(e.colCount=e.colCount-n,e.byRow&&e.sortConditions)for(u in e.sortConditions)e.sortConditions.hasOwnProperty(u)&&((a=e.sortConditions[u]).index>=t&&a.index<t+n?i.push(a.index):a.index>=t+n&&(a.index-=n))}else t<e.col?(e.colCount-=t+n-e.col,e.col=t):e.colCount-=e.col+e.colCount-t,e.byRow&&L(e,t,n,i);return 0<i.length&&(e.sortConditions=e.sortConditions.filter(function(t){return-1===i.indexOf(t.index)})),0===e.sortConditions.length||e.colCount<=0?this.Ape():void 0}}}),w.Worksheet.ch("Sort",i={yh:function(t,n,e){var i,r,o,t,a,u,s,c,f,l,h,d,v,m,m,g,p,h,h,b,w,i=this,r=y.util.go,o,t=(0,y.util.xr)(t,"sortState");if(t&&(a="1"!==t.columnSort,u=S.range_parser._c(t.ref),t)){for(c=[],f=0,l=s=r(t,"sortCondition");f<l.length;f++)if(d=(h=l[f]).sortBy,v=!h.descending,m=S.range_parser._c(h.ref),m=a?m.col:m.row,p=g=void 0,"icon"!==d){for(w in d!==C.SortBy.fontColor&&d!==C.SortBy.cellColor||(h=Number.parseInt(h.dxfId,10),h=n.styleManager.getDxf(h),p=d===C.SortBy.cellColor,h&&(g=p?h.backColor:h.foreColor)),b={index:m,ascending:v},d===C.SortBy.cellColor?(b.backColor=g,b.order=v?"top":"bottom"):d===C.SortBy.fontColor&&(b.fontColor=g,b.order=v?"top":"bottom"),b)void 0===b[w]&&delete b[w];c.push(b)}i.Tpe(u.row,u.col,u.rowCount,u.colCount,a,c)}},wh:function(t,n,e){var i,r,t,o,a,u,s,c,f,l,h,d,v,v,i=this,t=t.c_,o=this.getSortState();if(o){for(r={n_:"sortState",ref:a=S.range_parser.getRangeString([new y.Range(o.row,o.col,o.rowCount,o.colCount)]),c_:[]},o.byRow||(r.columnSort=1),s=0,c=u=F(i,o.sortConditions);s<c.length;s++)f=c[s],l=void 0,h={n_:"sortCondition",ref:l=o.byRow?S.range_parser.jc(new y.Range(o.row,f.index,o.rowCount,1)):S.range_parser.jc(new y.Range(f.index,o.col,1,o.colCount))},d=f.isBackColor,v=f.color,T(v)?f.ascending||(h.descending=1):("{"===v[0]&&(v=JSON.parse(v)),v=d?{backColor:v}:{foreColor:v},h.sortBy=d?C.SortBy.cellColor:C.SortBy.fontColor,h.dxfId=n.styleManager.getDxfIndex(v),f.ascending?h.descending=1:(h.descending=null,delete h.descending)),r.c_.push(h);r&&t.push(r)}},toJson:function(t,n){var e=this.getSortState();e&&(t.sortState=e)},fromJson:function(t,n,e){var i,t,r,o,a,u,s,t,i,t=t.sortState;t&&(r=t.row,o=t.col,a=t.rowCount,u=t.colCount,s=t.byRow,t=t.sortConditions,this.Tpe(r,o,a,u,s,t))},onLayoutChanged:function(t){var n,e,i,r,o,a,t,t,n;this.getSortState()&&(e=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,t=t.sheetArea,t=T(t)||t===C.SheetArea.viewport,"addRows"===e&&t?this.Npe(i,r):"deleteRows"===e&&t?this._pe(i,r):"addColumns"===e&&t?this.kpe(o,a):"deleteColumns"===e&&t&&this.Dpe(o,a))}})},"./dist/core/worksheet/worksheet-static.js":function(u,t,H){"use strict";var F,p,n,L,r,V,e,z,b,w,$,Y,B,y,Z,N,W,Q,e,f,J,P,tt;function K(t,n){return t.getRowCount(n)}function X(t,n){return t.getColumnCount(n)}function O(t,n,e){return t.Do(n,e)}function E(t,n,e){return t._o(n,e)}function k(t,n,e,i){t.setColumnWidth(n,e,i)}function _(t,n,e,i){t.setRowHeight(n,e,i)}function D(t,n,e,i,r){return t.getActualStyle(n,e,i,N,N,N,r)}function o(t,n){return t.getDefaultStyle(n)}function a(t,n,e){t.setDefaultStyle(n,e)}function j(t,n,e,i,r){t.u5(n,e,i,r)}function l(t,n,e,i){throw new Error(r.Common.zf.I5(f().Exp_InvalidAndSpace,[t,n,e,i]))}function q(t,n,e){return n&&e.XT&&e.XT(t)}function M(t,n,e){return e?[n,t]:[t,n]}function nt(t,n,e,i,r,o,a,u){var s,t,c,i,e,o,u,t;if(!t)throw new Error(f().Exp_SrcIsNull);if(!i)throw new Error(f().Exp_DestIsNull);s=K(t),t=X(t),c=K(i),i=X(i),(n<-1||s<=n)&&l("from row index",n,"-1",s-1),(e<-1||t<=e)&&l("from column index",e,"-1",t-1),(r<-1||c<=r)&&l("to row index",r,"-1",c-1),(o<-1||i<=o)&&l("to column index",o,"-1",i-1),(e=e)<0&&(e=0,u=t),o=o<0?0:o,(u<1||t<e+u||i<o+u)&&l("column count",u,"1",W(t-e,i-o)),(u=n)<0&&(u=0,a=s),t=r<0?0:r,(a<1||s<u+a||c<t+a)&&l("row count",a,"1",W(s-u,c-t))}function G(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||B(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var n,e,i,n=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(e in t)t.hasOwnProperty(e)&&(i=t[e],t.hasOwnProperty(e))&&n[e]!==i&&(n[e]="object"==typeof i?G(i):i);return n.toString=t.toString,n.valueOf=t.valueOf,n}function d(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,b,w,y,M,M,f=t.getSpans(N,s),l=i.getSpans(N,s),h=[];if(f)for(d=0;d<f.length;d++)m=(v=f[d]).row,g=v.col,p=v.rowCount,b=v.colCount,-1===n?e<=g&&g+b<=e+u&&h.push(J(m,o+g-e,p,b,c)):-1===e?n<=m&&m+p<=n+a&&h.push(J(r+m-n,g,p,b,c)):n<=m&&m<n+a&&e<=g&&g<e+u&&h.push(J(r+m-n,o+g-e,p,b,c));if(l)for(d=0;d<l.length;d++)m=(v=l[d]).row,w=void 0,y=o<=(g=v.col)&&g<o+u,M=r<=m&&m<r+a,(w=-1===n?y:-1===e?M:M&&y)&&(M=i.findSpan(m,g,s))&&M.row===m&&M.col===g&&i.do("removeSpan",M,s);for(d=0;d<h.length;d++)i.do("addSpan",h[d],s)}function et(t){t.forEach(function(t){var n=t.sheet,e=t.r,i=t.c,t=t.value;n.setTemplateCell?n.setTemplateCell(e,i,t):n.setBindingPath&&n.setBindingPath(e,i,t)})}function C(t,n,e){for(var t,i,r,o,a,u,s,c,t=t.JS(n),i=t.row,r=t.col,o=t.rowCount,a=t.colCount,u=0;u<o;u++)for(s=e[i+u]=e[i+u]||{},c=0;c<a;c++)s[r+c]=!0}function v(t,n){return t===n&&t.name()===n.name()}function S(t){var n=p([],t.sheets,!0);return t.mp&&0<t.mp.length&&t.mp.forEach(function(t){t.Mf&&n.push(t.Mf)}),n}function it(r,o,a,u,s,c,f,l){var t,h,d,v,m,t,g,t,n,e,t=H("SheetsCalc");if(t)if(h=t.QB,m=r.Ut.pj(),r.parent&&r.parent.sheets)for(g=S(r.parent),(t=r.parent.getCustomNames())&&y(t,function(t,n){d=n.getExpression(),(v=h(null,r,o,a,u,s,c,f,l,d))!==d&&n.SB(v,m)}),n=function(e){var t,i,t=g[e].getCustomNames();t&&(i=[],y(t,function(t,n){d=n.getExpression(),(v=h(g[e],r,o,a,u,s,c,f,l,d))!==d&&(n.SB(v,m),i.push({nameInfo:n,oldExpr:d,newExpr:v}))}),0<i.length)&&"function"==typeof g[e].onCustomNameFormulaChanged&&g[e].onCustomNameFormulaChanged(i)},e=0;e<g.length;e++)n(e);else(t=r.getCustomNames())&&y(t,function(t,n){d=n.getExpression(),(v=h(r,r,o,a,u,s,c,f,l,d))!==d&&n.SB(v,m)})}function T(t,n,e,i,r,o,a,u,s){var t;e&&r&&(r=t.adjustFormulaOnMoveSwap(i,o,a,r,u,!0,{crossSheetMoved:s}),t=e.unparse(i,r,o,a),n.setDefaultValue(o,a,t,Z,V.DefaultChangeValueType.Expression,Z,!0))}function m(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y;if(t)for(l in a=e!==i,u=e.Ut,s=i.Ut,c=e.Uw(),f=e.op(),t)if(t.hasOwnProperty(l)&&(h=t[l]))for(d in h)h.hasOwnProperty(d)&&(v=h[d])&&v.expr&&(o?T(n,s,f,c,b=v.expr,w=v.destRow,y=v.destCol,r,a):B(e.getValueIgnoreDefault(m=+l,g=+d))||T(n,u,f,c,v.expr,m,g,r,a))}function rt(t,n,e,i,r,o,a,u,s){var c,f,l,h,f,l,n,d,c=H("SheetsCalc");c&&(f=t.op(),l=t.Uw(),h=i.Uw(),f)&&l&&h&&(f=new c.MoveSwapInfo(l,n,e,h,r,o,a,u),m(d=(n=(l=t.Ut)&&l.yle())&&n.gle(),c,t,i,f),m(s,c,t,i,f,!0))}function h(t,n,e,i,r,o,a,u,s,c,f){var l,t,h,l=!(t===i&&t.name()===i.name()),t=t.Ut,h=t.K_(c);l?(d(t,n,e,i.Ut,r,o,a,u,c,f),s&&h&&t.do("clearSpan",n,e,a,u,c)):s?t.do("moveSpan",n,e,r,o,a,u,c):t.do("copySpan",n,e,r,o,a,u,c,f)}function A(t,n,a,u,s,c,f,l){var h,e,i,d,r,o,v,m,h={},e=J(a,u,s,c),i=t.Uw(3).t8,d=n.Uw(3).t8,r=i&&i.jme(a,u,s,c),o=d&&d.jme(f,l,s,c),v=d&&d.b3();return t===n&&e.intersect(f,l,s,c)?(m=[],r&&r.forEach(function(t){i.Rme(t),t.minX>=a&&t.minY>=u&&m.push(t)}),o&&o.forEach(function(t){i.Rme(t),v.gF(t.minX,t.minY,1,1),t.minX>=f&&t.minY>=l&&d.Lme(t,!0)}),m.forEach(function(t){var t={minX:t.minX+f-a,minY:t.minY+l-u,maxX:t.maxX+f-a,maxY:t.maxY+l-u,isValid:t.isValid};d.Bme(t,!0)})):(o&&o.forEach(function(t){t.minX>=f&&t.minY>=l?d.Rme(t,!0,!0):(d.Rme(t),v.gF(t.minX,t.minY,1,1))}),r&&r.forEach(function(t){var n,e,i,r,o;if(t.minX>=a&&t.minY>=u)(n={minX:t.minX+f-a,minY:t.minY+l-u,maxX:W(t.maxX+f-a,f+s-1),maxY:W(t.maxY+l-u,l+c-1),isValid:t.isValid}).isValid||(n.maxX=n.minX,n.maxY=n.minY),d&&d.Bme(n,!0);else if(t.isValid)for(e=W(t.maxX,a+s-1),i=W(t.maxY,u+c-1),r=Q(t.minX,a);r<=e;r++)for(h[r]=h[r]||{},o=Q(t.minY,u);o<=i;o++)h[r][o]=1})),h}function ot(t,n,e,i,r,o,a,u){var s=H("SheetsCalc");s&&s.CalcOperatorAdjustor.moveFormula(t,n,e,i,r,o,a,u)}function at(t,n,e,i,r,o,a,u,s){var c,f,l,n,h,d,v,m,g,c={};if(t===n&&t.tables)for(f=J(e,i,r,o),l=J(a,u,r,o),h=(n=t.tables).all(),d=void 0,v=0,m=(h=n.zB?h.concat(n.zB):h).length;v<m;v++)(d=(g=h[v]).VB||g.range()).containsRange(f)&&d.containsRange(l)?C(t,f,c):(d.intersect(l.row,l.col,l.rowCount,l.colCount)||s&&f.containsRange(d))&&C(t,d,c);return c}function i(t,n,e,i,r,o,a,u,s,c){var t;this.src=t,this.dest=n,this.srcRow=e,this.srcColumn=i,this.destRow=r,this.destColumn=o,this.copyRowCount=a,this.copyColumnCount=u,this.isMove=s,null!=(t=(this.options=c).pasteSpecialOptions)&&t.skipBlanks&&(this.jpe=new L.Rf)}function g(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,d,p,b,w,y,M,l,c,h,d,C,S,T,A,I,x,F,L,B,N,S,l,k,f,S,f,_,P,D,G,j,O,E,R,U;if(nt(t,n,e,i,r,o,a,u),v=c.copyToOption,m=c.ignoreFilteredOutRow,g=c.ignorePasteSkipInvisibleRange,y=null==(d=c.pasteSpecialOptions)?void 0:d.pasteLink,(null!=d&&d.operationOptions||null!=d&&d.transpose)&&(M={operationOptions:null!=d&&d.operationOptions?{option:null==d?void 0:d.operationOptions,useValue:0<(1&v)&&(2&v)<=0}:void 0,transpose:d.transpose}),l=null==(l=null==d?void 0:d.advancedPasteOptions)?void 0:l.validator,c=new tt(t,i,n,e,r,o,a,u,s,c),h=null==(h=null==d?void 0:d.advancedPasteOptions)?void 0:h.columnWidth,d=null==(d=null==d?void 0:d.advancedPasteOptions)?void 0:d.numberFormats,y&&(v=0),0<(1&(v=null!=M&&M.operationOptions?(v&=~V.CopyToOptions.value)|V.CopyToOptions.formula:v))&&0<(2&v)&&(S=t.pivotTables)&&(C=S.KB(J(Q(0,n),Q(0,e),n<0?W(K(t),K(i)):a,e<0?W(X(t),X(i)):u),s)),s&&i.UB&&n<0)for(w=u,(b=e)<0&&(b=0,w=W(X(t),X(i))),(T=o)<0&&(T=0),p=!0,A=0;A<w;A++)I=t.Ut.q_(!1,3,b+A),x=t.Ut.q_(!1,3,T+A),F=I&&I.name,L=x&&x.name,I&&x&&F&&L||(p=!1),(x=z.GC$.extend(!0,{},i.Ut.q_(!1,3,T+A)||{})).displayName=I&&I.displayName,x.name=I&&I.name,i.Ut.do("setItem",!1,3,T+A,x);!(0<(64&v)||l)||null!=f&&f.ignoreValidator||(c.copyMoveMultiColumnPrecedents(),t.EB)||t.b8&&c.copyMoveValidator(),0<(64&v)&&(B=at(t,i,n,e,a,u,r,o,s)),0<(512&v)&&c.copyOrMoveConditionalFormat(),0<(1&v)&&0<(2&v)&&(S=t.tables)&&(N=S.KB(J(Q(0,n),Q(0,e),n<0?W(K(t),K(i)):a,e<0?W(X(t),X(i)):u),s)),(l=Y)&&(t.suspendCalcService(),i.suspendCalcService()),k=[],f=Z,S=[],0<(256&v)&&(k=(f=c.copyMoveBindingPath()).savedValues,S=f.bindingPathInfos),0<(2048&v)&&(f=c.copyMoveDefaultValue(),s)&&f&&rt(t,n,e,i,r,o,a,u,f);try{if(y&&c.copyCellLink(),_=i.pivotTables,0<(1&v)&&0<(2&v)&&_&&_.JB(C,t,Q(0,n),Q(0,e),i,Q(0,r),Q(0,o),a,u,s),0<(1&v)&&!p){if(Y&&0==(2&v)&&i.clearFormula(r,o,a,u,function(t,n){return!m||!t.XT||!t.XT(n)}),s?c.moveValue():c.copyValue(),0<(256&v))for(et(S),P=k.length,D=r<0?0:r,G=o<0?0:o,j=0;j<P;j++)O=k[j],!s&&q(D+O.row,m,i)||i.setValue(D+O.row,G+O.col,O.value)}else 0<(256&v)&&et(S);(0<(64&v)||d)&&c.copyMoveStyle(B),E=i.tables,0<(1&v)&&0<(2&v)&&E&&E.JB(N,Q(0,n),Q(0,e),Q(0,r),Q(0,o),s),Y&&(s?(R={needAdjustCustomNameOnMove:!0},$.Worksheet.et(t,"adjustCustomNameOnMove",R),!t.EB&&R.needAdjustCustomNameOnMove&&it(t,n,e,i,r,o,a,u),0<(2&v)&&ot(t,n,e,i,r,o,a,u)):0<(2&v)&&(U=H("SheetsCalc"))&&U.XB(t,n,e,i,r,o,a,u,m,g,!0,M),0<(1&v))&&0<(2&v)&&E&&E.qB(N),0<(4&v)&&c.copyMoveComment(),0<(128&v)&&c.copyMoveTag(),0<(1024&v)&&c.copyMoveHyperlink(),0<(4096&v)&&c.copyMoveAltText()}finally{l&&(t.resumeCalcService(!1),i.resumeCalcService(!1))}if(0<(16&v)&&c.copyOrMoveSparkline(),0<(8&v)&&(n<0&&c.copyOrMoveColumnRangeGroup(),e<0)&&c.copyOrMoveRowRangeGroup(),0<(32&v)&&(!s&&1===a&&1===u||c.copyOrMoveSpan()),n<0&&r<=0&&c.copyOrMoveColumnAxis(),e<0&&o<=0&&c.copyOrMoveRowAxis(),n<0&&r<=0&&e<0&&o<=0&&c.copyOrMoveSheetInfo(),h&&c.copyColumnWidth(),s&&t.UB&&n<0)for(w=u,(b=e)<0&&(b=0,w=W(X(t),X(i))),A=0;A<w;A++)t.getDataColumnName&&t.getDataColumnName(b+A)&&t.Ut.do("setItem",!1,3,b+A,Z)}F=this&&this.__assign||function(){return(F=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},p=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.staticMembers=void 0,n=H("./dist/core/core.ns.js"),L=H("./dist/core/util/common.js"),r=H("Common"),V=H("./dist/core/core.enum.js"),e=H("CalcEngine"),z=H("./dist/core/util/domUtil.js"),b=H("./dist/core/worksheet/worksheet-model.js"),w=H("./dist/core/worksheet/style.js"),$=H("./dist/core/worksheet/worksheet.js"),Y=!!e,B=r.Common.lt.ht,y=z.GC$.each,Z=null,N=void 0,W=Math.min,Q=Math.max,e=new r.Common.ResourceManager(n.SR,"Sheets"),f=e.getResource.bind(e),J=function(t,n,e,i,r){return new L.Range(t,n,r?i:e,r?e:i)},P=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,w,y,l=f.pasteSkipInvisibleRange,h=f.sheetArea,d=u,v;if(!(t===n&&t.name()===n.name()))for(g=m=0;m<a&&m<K(n,h);m++)if(l&&0===n.getRowHeight(i+m,h))a++;else{for(u=d,b=p=0;p<u&&p<X(n,h);p++)l&&0===n.getColumnWidth(o+p,h)?u++:(c(n,i+m,o+p,G(w=s(t,e+g,r+b,h)),h),b++);g++}else{for(y=new L.Rf,m=0;m<a;m++)for(p=0;p<u;p++)w=s(t,e+m,r+p,h),B(w)||y.set(m,p,G(w));for(g=m=0;m<a&&m<K(n,h);m++)if(l&&0===n.getRowHeight(i+m,1))a++;else{for(u=d,b=p=0;p<u&&p<X(n,1);p++)l&&0===n.getColumnWidth(o+p,1)?u++:(c(n,i+m,o+p,y.get(g,b),h),b++);g++}}},i.prototype.Ope=function(t,n,e){var i,r,o,a,u,s,c,f,l,r,e,h,d,i,v,m,g,e,i,p,b,e,i,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,E,R,r=this,o=r.src,a=r.srcRow,u=r.srcColumn,s=r.dest,c=r.destRow,f=r.destColumn,l=r.copyRowCount,r=r.copyColumnCount,e=F(F({},this.options),e),h=e.ignoreFilteredOutRow,d=e.copyPasteHeaders,i=e.ignorePasteSkipInvisibleRange,v=!(o===s&&o.name()===s.name()),m=!i&&s.o5(),g=null==(i=e.pasteSpecialOptions)?void 0:i.transpose;if(2==(2&d)&&a<0&&(e=u,i=f,p=W(K(o,1),K(s,1)),b=r,u<0&&(e=0,b=X(o)),P(o,s,0,0,e,i=f<0?0:i,p,b,t,n,{pasteSkipInvisibleRange:m,sheetArea:1})),1==(1&d)&&u<0&&(e=a,i=c,p=l,b=W(X(o,2),X(s,2)),a<0&&(e=0,p=K(o)),P(o,s,e,i=c<0?0:i,0,0,p,b,t,n,{pasteSkipInvisibleRange:m,sheetArea:2})),w=a,y=u,M=c,C=f,S=l,T=r,A=K(s),I=X(s),a<0&&(w=0,S=W(K(o),A)),u<0&&(y=0,T=W(X(o),I)),c<0&&(M=0),f<0&&(C=0),x=T,v)for(k=N=0;k<S&&M+k<A;k++)if(m&&0===s.getRowHeight(M+k))S++;else{if(!q(M+k,h,s))for(T=x,D=_=0;D<T&&C+D<I;D++)m&&0===s.getColumnWidth(C+D)?T++:(n(s,M+k,C+D,G(E=t(o,j=w+(g?_:N),O=y+(g?N:_),3)),3),_++);N++}else{R=new L.Rf;try{for(k=0;k<S;k++)for(D=0;D<T;D++)E=t(o,j=w+(g?D:k),O=y+(g?k:D),3),B(E)||R.set(k,D,G(E));for(k=N=0;k<S&&M+k<A;k++)if(m&&0===s.getRowHeight(M+k))S++;else{if(!q(M+k,h,s))for(T=x,D=_=0;D<T&&C+D<I;D++)m&&0===s.getColumnWidth(C+D)?T++:(n(s,M+k,C+D,R.get(N,_),3),_++);N++}}catch(t){}}},i.prototype.copyOrMoveConditionalFormat=function(){var t,n,e,i,r,o,a,u,s,c,n,f,t,l,h,i,e,n=this,e=n.src,i=n.dest,r=n.srcRow,o=n.srcColumn,a=n.destRow,u=n.destColumn,s=n.copyRowCount,c=n.copyColumnCount,n=n.isMove,f=this.options.ignorePasteSkipInvisibleRange,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.transpose,l=e.conditionalFormats,h=i.conditionalFormats,i=v(e,i);l&&h&&!e.EB&&(e=l.jB(r,o,h,a,u,s,c,i,f,t),n)&&l.OB(r,o,s,c,e,i)},i.prototype.copyOrMoveSparkline=function(){var t,n,e,i,r,o,a,u,s,t,c,f,l,t=this,n=t.src,e=t.dest,i=t.srcRow,r=t.srcColumn,o=t.destRow,a=t.destColumn,u=t.copyRowCount,s=t.copyColumnCount,t=t.isMove,c=this.options.ignorePasteSkipInvisibleRange;i<0&&(i=0,u=W(K(n),K(e))),o<0&&(o=0),r<0&&(r=0,s=W(X(n),X(e))),a<0&&(a=0),(f=!(n===e&&n.name()===e.name()))?(l=e.RB)&&(t?0<n.RB.count()&&l.BB(n,i,r,o,a,u,s):l.LB(n,i,r,o,a,u,s,N,c)):(l=n.RB)&&(t?0<l.count()&&l.iE(i,r,o,a,u,s):l.tE(i,r,o,a,u,s,N,c))},i.prototype.copyOrMoveColumnRangeGroup=function(){var t,n,e,i,r,o,t,a,u,s,t=this,n=t.src,e=t.srcColumn,i=t.dest,r=t.destColumn,o=t.copyColumnCount,t=t.isMove;e<0&&(e=0,o=W(X(n),X(i))),r<0&&(r=0),a=n.columnOutlines,u=i.columnOutlines,(s=!(n===i&&n.name()===i.name()))?a&&u&&u.FB(a,e,r,o,t):a&&a.PB(e,r,o,t)},i.prototype.copyOrMoveRowRangeGroup=function(){var t,n,e,i,r,o,t,a,n,i,t=this,n=t.src,e=t.srcRow,i=t.dest,r=t.destRow,o=t.copyRowCount,t=t.isMove;e<0&&(e=0,o=W(K(n),K(i))),r<0&&(r=0),a=!(n===i&&n.name()===i.name()),n=n.rowOutlines,i=i.rowOutlines,a?n&&i&&i.FB(n,e,r,o,t):n&&n.PB(e,r,o,t)},i.prototype.copyOrMoveSpan=function(){var t,n,e,i,r,o,a,u,s,c,n,t,f,l,n=this,e=n.src,i=n.srcRow,r=n.srcColumn,o=n.dest,a=n.destRow,u=n.destColumn,s=n.copyRowCount,c=n.copyColumnCount,n=n.isMove,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.transpose,f=i,l=r;f<0&&(f=0,s=W(K(e),K(o))),a<0&&(a=0),l<0&&(l=0,c=W(X(e),X(o))),u<0&&(u=0),i<0&&h(e,-1,l,o,-1,u,-1,c,n,1,t),r<0&&h(e,f,-1,o,a,-1,s,-1,n,2,t),h(e,f,l,o,a,u,s,c,n,V.SheetArea.viewport,t)},i.prototype.copyOrMoveColumnAxis=function(){var t,n,e,i,r,o,a,t,u,s,c,t,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,t=this,n=t.src,e=t.srcColumn,i=t.dest,r=t.destColumn,o=t.copyColumnCount,a=t.isMove,t=this.options,u=t.copyToOption,s=t.ignorePasteSkipInvisibleRange,c=t.ignoreSheet;for(e<0&&(e=0,o=W(X(n),X(i))),t=o,r<0&&(r=0),f=!s&&i.o5(),l=1,h=[],v=d=0;d<o&&d<X(i,1);d++)f&&0===i.getColumnWidth(r+d)?o++:(m={},0<(64&u)&&(g=O(n,v+e),B(g)||(m.size=g,a&&k(n,d+e,n.defaults.colWidth)),p=n.getColumnVisible(v+e),B(p)||(m.visible=p,a&&n.setColumnVisible(d+e,!0)),b=D(n,-1,v+e,N,c),m.style=b,a&&j(n,-1,d+e,Z),b=D(n,-1,v+e,1,c),m.headerStyle=b,a&&j(n,-1,d+e,Z,1),w=n.Lt(v+e),B(w)||(m.columnHeaderFitMode=w,a&&n.GB(d+e,V.ColumnHeaderFitMode.normal))),0<(128&u)&&(y=n.getTag(-1,v+e),B(y)||(m.tag=y,a&&n.setTag(-1,d+e,N))),h[v+e]=m,v++);for(o=t,v=d=0;d<o&&d<X(i,1);d++)f&&0===i.getColumnWidth(r+d)?o++:(m=h[v+e],0<(64&u)&&(g=m.size,B(g)||k(i,d+r,g),p=m.visible,B(p)||i.setColumnVisible(d+r,p),j(i,-1,d+r,(b=m.style)?b.clone():Z),j(i,-1,d+r,(b=m.headerStyle)?b.clone():Z,1),w=m.columnHeaderFitMode,B(w)||i.GB(d+r,w)),0<(128&u)&&(y=m.tag,B(y)||i.setTag(-1,d+r,y)),v++);for(M=K(i,1),C=W(K(n,1),M),T=S=0;S<C&&S<M;S++)f&&0===i.getRowHeight(S,1)?C++:(A=E(n,T,1),B(A)||(a&&_(n,S,n.defaults.colHeaderRowHeight,1),_(i,S,A,1)),T++)},i.prototype.copyOrMoveRowAxis=function(){var t,n,e,i,r,o,a,t,u,s,c,f,t,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,t=this,n=t.src,e=t.srcRow,i=t.dest,r=t.destRow,o=t.copyRowCount,a=t.isMove,t=this.options,u=t.copyToOption,s=t.ignoreFilteredOutRow,c=t.ignorePasteSkipInvisibleRange,f=t.ignoreSheet;for(e<0&&(e=0,o=W(K(n),K(i))),t=o,r<0&&(r=0),l=!c&&i.o5(),h=2,d=[],m=v=0;v<o&&r+v<K(i,2);v++)l&&0===i.getRowHeight(r+v)?o++:(!a&&q(r+v,s,i)||(g={},0<(64&u)&&(p=E(n,m+e),B(p)||(g.size=p,a&&_(n,v+e,n.defaults.rowHeight)),b=n.getRowVisible(m+e),B(b)||(g.visible=b,a&&n.setRowVisible(v+e,!0)),w=D(n,m+e,-1,N,f),g.style=w,a&&j(n,v+e,-1,Z),w=D(n,m+e,-1,2,f),g.headerStyle=w,a)&&j(n,v+e,-1,Z,2),0<(128&u)&&(y=n.getTag(m+e,-1),B(y)||(g.tag=y,a&&n.setTag(v+e,-1,N))),d[m+e]=g),m++);for(o=t,M=i.rowFilter&&i.rowFilter()&&i.rowFilter().extendedRange,m=v=0;v<o&&r+v<K(i,2);v++)C=r+v,l&&0===i.getRowHeight(C)?o++:(!a&&q(C,s,i)||(g=d[m+e],0<(64&u)&&(p=g.size,B(p)||_(i,C,p),b=g.visible,B(b)||(M&&M.intersect(C,-1,1,0)?i.filterRowsVisibleInfo.rowsVisibleInfo[C]=!!b:i.setRowVisible(C,b)),j(i,C,-1,(w=g.style)?w.clone():Z),j(i,C,-1,(w=g.headerStyle)?w.clone():Z,2)),0<(128&u)&&(y=g.tag,B(y)||i.setTag(C,-1,y))),m++);for(S=X(i,2),T=W(X(n,2),S),I=A=0;A<T&&A<S;A++)l&&0===i.getColumnWidth(A,2)?T++:(x=O(n,I,2),B(x)||(a&&k(n,A,n.defaults.rowHeaderColWidth,2),k(i,A,x,2)),I++)},i.prototype.copyOrMoveSheetInfo=function(){var t,n,e,t,i,i,i,e,t=this,n=t.src,e=t.dest,t=t.isMove,i=this.options.copyToOption;n===e&&n.name()===e.name()||(0<(64&i)&&(i=o(n),a(e,t?i:i.clone()),i=o(n,1),a(e,t?i:i.clone(),1),i=o(n,2),a(e,t?i:i.clone(),2),t)&&(a(n,Z),a(n,Z,1),a(n,Z,2)),i=e.defaults,e=n.defaults,i.colWidth=e.colWidth,i.rowHeight=e.rowHeight,i.rowHeaderColWidth=e.rowHeaderColWidth,i.colHeaderRowHeight=e.colHeaderRowHeight,t&&(e.colWidth=62,e.rowHeight=20,e.rowHeaderColWidth=40,e.colHeaderRowHeight=20))},i.prototype.copyValue=function(){var o,t,t,n,e,i,r,s,a,u,c,n,t,f,l,h,t,d,v,m,g,o=this,n=this,e=n.src,i=n.srcRow,r=n.srcColumn,s=n.dest,a=n.destRow,u=n.destColumn,c=n.copyRowCount,n=n.copyColumnCount,t=this.options,f=t.copyToOption,l=t.treatRichTextAsNormal,h=null==(t=this.options.pasteSpecialOptions)?void 0:t.skipBlanks,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.transpose,d;0<(2&f)&&Y&&(v=A.apply(void 0,p(p([e,s,i,r],M(c,n,t),!1),[a,u],!1))),this.Ope(m=function(t,n,e,i){var r,o,a,u,a,a,u,r,a=l?0:1,u=t.Ut;return 3===i?o=v&&v[n]&&v[n][e]?N:t.getValueIgnoreDefault(n,e,i,a):(o=u.getValue(n,e,i,!0,a),1===i&&B(o)&&s.UB&&(a=t.H3)&&a._dataSource&&(a=u.q_(!1,3,e),u=t.options.colHeaderAutoTextIndex,a)&&(0<=u&&n===u||-1===u&&n===K(t,i)-1)&&(o=a.displayName||a.name)),o},g=function(t,n,e,i,r){B(i)?h?o.jpe.set(n,e,!0):t.YI(n,e,Z,r,!!t.HB,!0):B(i)||t.YI(n,e,i,r,!!t.HB,!0)})},i.prototype.moveValue=function(){var t,u,s,c,f,o,a,l,h,t,n,d,e,v,m,g,p,b,i,r,w,y,t=this,u=t.src,s=t.srcRow,c=t.srcColumn,f=t.dest,o=t.destRow,a=t.destColumn,l=t.copyRowCount,h=t.copyColumnCount,t=this.options,n=t.copyToOption,d=t.treatRichTextAsNormal,e,v={},m={},g=[];0<(2&n)&&Y&&(p=u.Uw(3).t8,b=f.Uw(3).t8,(i=p&&p.jme(s,c,l,h)).forEach(function(t){var n,e,i,r,o,a;if(t.minX>=s&&t.minY>=c)if(!t.isValid||t.maxX<s+l&&t.maxY<c+h)g.push(t);else{for(n=[],e=t.minX;e<=t.maxX;e++)for(n.push(i=[]),r=t.minY;r<=t.maxY;r++)i.push(u.getValueIgnoreDefault(e,r,3));g.push(t),t._v=n,p.Rme(t,!1,!0)}else if(t.isValid)for(o=W(t.maxX,s+l-1),a=W(t.maxY,c+h-1),e=Q(t.minX,s);e<=o;e++)for(v[e]=v[e]||{},r=Q(t.minY,c);r<=a;r++)v[e][r]=1;else p.b3().gF(t.minX,t.minY,1,1)}),(r=b&&b.jme(o,a,l,h)).forEach(function(t){var n,e,i,r;if(!(0<=g.indexOf(t)))if(t.minX>=o&&t.minY>=a)b.Rme(t,!0,!0,!0);else if(t.isValid)for(n=W(t.maxX,o+l-1),e=W(t.maxY,a+h-1),i=Q(t.minX,o);i<=n;i++)for(m[i]=m[i]||{},r=Q(t.minY,a);r<=e;r++)m[i][r]=t})),this.Ope(w=function(t,n,e,i){var r,o,a,u,a,a,s,r=3===i,a=d?0:1,u=t.Ut;return r?o=v&&v[n]&&v[n][e]?N:t.getValueIgnoreDefault(n,e,i,a):(o=u.getValue(n,e,i,!0,a),1===i&&B(o)&&f.UB&&(a=t.H3)&&a._dataSource&&(a=u.q_(!1,3,e),s=t.options.colHeaderAutoTextIndex,a)&&(0<=s&&n===s||-1===s&&n===K(t,i)-1)&&(o=a.displayName||a.name)),B(o)||(r?t.YI(n,e,Z,i,!1,!0):u.do("setValue",n,e,Z,i,!0,!0)),o},y=function(t,n,e,i,r){var o=m&&m[n]&&m[n][e];B(i)?o&&o.isValid||t.YI(n,e,Z,r,!!t.HB,!0):(o&&o.isValid&&b.Rme(o,!0,u.Ut.G8),t.YI(n,e,i,r,!!t.HB,!0))}),(g=g.map(function(t){p.Lme(t,!0);var n={minX:t.minX+o-s,minY:t.minY+a-c,maxX:t.maxX+o-s,maxY:t.maxY+a-c,_v:t._v,isValid:t.isValid};return t._v=null,n})).forEach(function(t){t._v?b.setArray(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1,t._v,!1,!0):b.Bme(t,!0)})},i.prototype.copyMoveStyle=function(a){var d,t,t,u,s,v,t,c,m,g,n,e,d=this,u=this.isMove,s=this.options.ignoreSheet,v=null==(t=this.options.pasteSpecialOptions)?void 0:t.skipBlanks,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.advancedPasteOptions,c=null==t?void 0:t.usingSourceTheme,m=null==t?void 0:t.noBorder,g=null==t?void 0:t.numberFormats,n,e;this.Ope(function(t,n,e,i){var r,o,r=(3===i||B(i))&&a&&a[n]&&a[n][e];return c?(o=t.getActualStyle(n,e,i,N,N,N,s))&&(delete o.themeFont,delete o.parentName):(o=t.getCompositeStyle(n,e,i,N,N,N,N,r,N,N,s))&&delete o.parentName,u&&o&&j(t,n,e,Z,i),o},function(t,n,e,i,r){var o,o,a,u,s,c,f,l,h,o;v&&d.jpe.get(n,e)||(g&&(o=i.formatter,(i=(i=t.getStyle(n,e))||new w.Style).formatter=o),m&&(a=(o=t.getCompositeStyle(n,e)).diagonalUp,u=o.diagonalDown,s=o.borderTop,c=o.borderBottom,f=o.borderLeft,l=o.borderRight,h=o.borderHorizontal,o=o.borderVertical,Object.assign(i,{diagonalUp:a,diagonalDown:u,borderTop:s,borderBottom:c,borderLeft:f,borderRight:l,borderHorizontal:h,borderVertical:o})),j(t,n,e,i,r))})},i.prototype.copyMoveValidator=function(){var t,r,n,e,o,i,a,u,s,c,f,l,l,l,h,d,t=this,r=t.src,n=t.srcRow,e=t.srcColumn,o=t.dest,i=t.copyRowCount,a=t.copyColumnCount,u=t.isMove,s=r.b8.YB;for(c in s)(f=s[c])&&(l=f._S,u&&r===o&&l&&(l=l.some(function(t){return t.contains(n,e,i,a)&&!t.equals(new L.Range(n,e,i,a))}),f.Epe=l),l=f.condition())&&l.initExpression();this.Ope(h=function(t,n,e){var i=t.getDataValidator(n,e,3);return i&&(u&&t.setDataValidator(n,e,Z),v(r,o))&&(i.ZB=!0),i},d=function(t,n,e,i){t.setDataValidator(n,e,i),v(r,o)&&i&&delete i.ZB},{copyPasteHeaders:0})},i.prototype.copyMoveComment=function(){var t,r,o,n,e,r=this.isMove,o=null==(t=this.options.pasteSpecialOptions)?void 0:t.skipBlanks,n,e;this.Ope(function(t,n,e){var t,i,t=t.Ut.pI,i=t&&t.get(n,e);return i&&r&&t.remove(n,e),i},function(t,n,e,i){var t;o&&!i||(t=t.Ut.pI)&&t.WB(n,e,i)},{copyPasteHeaders:0})},i.prototype.copyMoveMultiColumnPrecedents=function(){var h,t,n,h=this.isMove,t,n;this.Ope(function(t,n,e){var i,r,o,a,u,s,c,f,l,l,i=t.Rpe&&t.Rpe(),r=[],o=t.name();if(i)for(a=0,u=i.length;a<u;a++)if(s=i[a])for(c=0,f=s.length;c<f;c++)(l=s[c])&&(h&&(s[c]=l.filter(function(t){return t.row!==n||t.col!==e||t.targetSheetName!==o})),l=l.filter(function(t){return t.row===n&&t.col===e&&t.targetSheetName===o})[0])&&r.push({row:a,col:c,dataSource:l.dataSource,dependSheetName:l.dependSheetName});return r},function(i,r,o,t){var a;t&&t.length&&(a=i.Rpe&&i.Rpe(),t.forEach(function(n){var t=n.row,e=n.col;void 0===a[t]&&(a[t]=[]),void 0===a[t][e]&&(a[t][e]=[]),a[t][e].some(function(t){return t.row===r&&t.col===o&&t.dataSource===n.dataSource&&t.targetSheetName===n.targetSheetName})||a[t][e].push({row:r,col:o,dataSource:n.dataSource,dependSheetName:n.dependSheetName,targetSheetName:i.name()})}))},{copyPasteHeaders:0})},i.prototype.copyMoveTag=function(){var r,t,n,r=this.isMove,t,n;this.Ope(function(t,n,e,i){var i=t.getTag(n,e,i);return!B(i)&&r&&t.setTag(n,e,N),i},function(t,n,e,i,r){t.setTag(n,e,i,r)})},i.prototype.copyMoveBindingPath=function(){var t,a,u,s,n,e,i,r,o,c,t,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,t=this,a=t.src,u=t.srcRow,s=t.srcColumn,n=t.dest,e=t.destRow,i=t.destColumn,r=t.copyRowCount,o=t.copyColumnCount,c=t.isMove,t=this.options.ignorePasteSkipInvisibleRange,f=[],l=[],h={},d={},v=!t&&n.o5();if(v){for(m=r,g=o,m+=n.lT(e,m,!0),g+=n.lT(i,g),p=n.getRowCount(),b=n.getColumnCount(),y=w=0;w<m&&w+e<p;w++)0!==n.getRowHeight(e+w)&&(h[y]=w,y++);for(C=M=0;M<g&&M+i<b;M++)0!==n.getColumnWidth(i+M)&&(d[C]=M,C++)}return this.Ope(S=function(t,n,e){var i,r,o,i=t.getBindingPath&&t.getBindingPath(n,e);return i&&(r=n-Q(0,u),o=e-Q(0,s),v&&(r=h[r],o=d[o]),f.push({row:r,col:o,value:t.getValue(n,e)}),c)&&(a.setTemplateCell?a.setTemplateCell(n,e,Z):a.setBindingPath&&a.setBindingPath(n,e,Z)),i},T=function(t,n,e,i){B(i)&&(!t.getBindingPath||B(t.getBindingPath(n,e)))||(t.setTemplateCell?t.setTemplateCell(n,e,N):t.setBindingPath&&t.setBindingPath(n,e,N),l.push({sheet:t,r:n,c:e,value:i}))},{copyPasteHeaders:0}),{savedValues:f,bindingPathInfos:l}},i.prototype.copyMoveDefaultValue=function(){var t,s,c,f,l,h,d,v,m,g,n,e,t=this,s=t.src,c=t.srcRow,f=t.srcColumn,l=t.dest,h=t.destRow,d=t.destColumn,v=t.isMove,m={},g={},n,e;return this.Ope(function(t,n,e,i){var r,o,a,o,u,s,r,r=t.Ut,o=r.yle(i),a=o.getValue(n,e),o=o.getExpression(n,e),u=n-c,s=e-f;return m[u]||(m[u]={}),v&&!g[u]&&(g[u]={}),v&&(B(a)||r.setDefaultValue(n,e,Z,i,V.DefaultChangeValueType.Value,!0),B(o)||r.setDefaultValue(n,e,Z,i,V.DefaultChangeValueType.Expression,Z,!0)),o?(r=t.getValueIgnoreDefault(n,e,i),B(r)?Z:(m[u][s]=1,v&&(g[u][s]={expr:o}),o)):(m[u][s]=0,a)},function(t,n,e,i,r){var t,o,a,u,o,o,t=t.Ut,o=t.yle(r),a=n-h,u=e-d;B(i)&&B(o.getValue(n,e))||(o=m[a][u],Y&&1===o?v?(o=g[a][u])&&(o.destRow=n,o.destCol=e):(0,b.copyDefaultFormula)(s,l,n,e,i):t.setDefaultValue(n,e,i,r,V.DefaultChangeValueType.Value))}),g},i.prototype.copyMoveHyperlink=function(){var r,t,n,r=this.isMove,t,n;this.Ope(function(t,n,e,i){var i=t.getHyperlink&&t.getHyperlink(n,e,i);return!B(i)&&r&&t.setHyperlink&&t.setHyperlink(n,e,N),i},function(t,n,e,i,r){t.setHyperlink&&t.setHyperlink(n,e,i,r)})},i.prototype.copyMoveAltText=function(){var r,t,n,r=this.isMove,t,n;this.Ope(function(t,n,e,i){var i=t.getAltText(n,e,i);return!B(i)&&r&&t.setAltText(n,e,N),i},function(t,n,e,i,r){t.setAltText(n,e,i,r)})},i.prototype.copyCellLink=function(){var t,n,i,r,o,a,u,e,s,n,i=!(this.src===this.dest&&this.src.name()===this.dest.name())?(0,L.i2e)(this.src.name())+"!":"",r=1===(null==(t=this.src.parent)?void 0:t.options.referenceStyle),o=(0,L.rangeToFormula)(new L.Range(this.srcRow,this.srcColumn,1,1),this.destRow,this.destColumn,15,!0),a=1===this.copyRowCount&&1===this.copyColumnCount,u=(0,L.rangeToFormula)(new L.Range(this.srcRow,this.srcColumn,1,1),0,0,0,r),e,s;this.Ope(function(t,n,e){return a?i+u:r?i+o:i+(0,L.rangeToFormula)(new L.Range(n,e,1,1),0,0,15)},function(t,n,e,i){t.setFormula(n,e,i)})},i.prototype.copyColumnWidth=function(){var t,n,t,n;this.Ope(function(t,n,e){return t.getColumnWidth(e)},function(t,n,e,i){t.setColumnWidth(e,i)})},tt=i,t.staticMembers={copyTo:function(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v){var m;g(t,n,e,i,r,o,a,u,!1,{copyPasteHeaders:f,ignorePasteSkipInvisibleRange:l,treatRichTextAsNormal:h,ignoreFilteredOutRow:c,copyToOption:s,pasteSpecialOptions:d},v)},moveTo:function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,h=3;g(t,n,e,i,r,o,a,u,!0,d={copyToOption:s,ignorePasteSkipInvisibleRange:f,treatRichTextAsNormal:l,ignoreSheet:c,copyPasteHeaders:h=t===i&&t.NMi?0:h})}}},"./dist/core/worksheet/worksheet-ui.js":function(t,n,c){"use strict";var e,s,i,g,r,o,a,u,f,l,h,d,m,v,a,p;function b(t){return"number"==typeof t}function w(t){return"string"==typeof t}function y(t){return parseInt(t,10)}function M(t){return Math.abs(t)}function C(t,n){var s=t,c=n;return function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0===arguments.length)return s.call(e,i,r,o);if(0<=i&&0<=r)for(a=i;a<i+n.rowCount;a++)for(u=r;u<r+n.colCount;u++)S(e,a,u,o)&&c.call(e,a,u,t,o);return n}}function S(t,n,e,i){var r,t,r=t.getRowCount(i),t=t.getColumnCount(i);return e<0&&0<=n&&n<r||n<0&&0<=e&&e<t||0<=n&&n<r&&0<=e&&e<t||-1===n&&-1===e}function T(t,n,e,i,r,o){var a,u;S(t,n,e,o)&&("string"==typeof(a=(a=t.vI(n,e,o))||new s.Style)&&(u=a,(a=new s.Style).parentName=u),"font"!==i&&"fontFamily"!==i||A(t,a,i,r),a[i]=r,t.setStyle(n,e,a,o))}function A(t,n,e,i){var r,o;v(n.themeFont)||(r=null==n?void 0:n.fontFamily,o=i,(o="font"===e?f.W.vpe(i).fontFamily:o)!==r&&(n.themeFont=d))}function I(t,n,e,i,r,o){var a=this;n<0&&(n=i=-1),e<0&&(e=r=-1),a.sheet=t,a.row=n,a.rowCount=v(i)?1:i,a.col=e,a.colCount=v(r)?1:r,a.sheetArea=v(o)?3:o}function x(t){return t=(t=t.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}function N(t){var t,n,t,e,i,r,r,o,a,u,n,s,e,c,f,l,h,d,v,t=t.split(":"),n=t[0],t=t[1],e=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(Number(n))){if(o=(r=n.match(e))[3])return m;i=r[1],r=r[2]}else r=n;if(n&&!t){if(i&&r)return[a=k(r),u=_(i),1,1]}else if(n&&t){if(s=n=void 0,isNaN(Number(t))){if(o=(e=t.match(e))[3])return m;n=e[1],s=e[2]}else s=t;if(!i&&r&&!n&&s)return c=k(r),f=k(s),[a=Math.min(c,f),-1,l=M(c-f)+1,-1];if(i&&!r&&n&&!s)return h=_(i),d=_(n),[-1,u=Math.min(h,d),-1,v=M(h-d)+1];if(i&&r&&n&&s)return c=k(r),f=k(s),h=_(i),d=_(n),a=Math.min(c,f),l=M(c-f)+1,[a,u=Math.min(h,d),l,v=M(h-d)+1]}return m}function k(t){return y(t)-1}function _(t){for(var n,e,i,r,o,a,n=64,e=26,i=0,r=t.length,o=0;o<r;o++)a=t[o].charCodeAt(0)-64,i+=Math.pow(26,r-o-1)*a;return i-1}Object.defineProperty(n,"__esModule",{value:!0}),n.$B=n.tL=n.CellRange=void 0,e=c("./dist/core/worksheet/worksheet.js"),s=c("./dist/core/worksheet/style.js"),i=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),r=c("Common"),o=c("./dist/core/core.enum.js"),a=c("CalcEngine"),u=c("./dist/core/worksheet/clipboardhelper.js"),f=c("./dist/core/worksheet/stylehelper.js"),l=!!a,h=g.util.N0,d=void 0,m=null,v=r.Common.lt.ht,a=e.Worksheet.prototype,I.prototype.tag=function(t){var n=this,e=n.sheet,i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=n.sheetArea,s,c;if(0===arguments.length)return e.getTag(i,r,u);if(0<=i&&0<=r)for(s=i;s<i+o;s++)for(c=r;c<r+a;c++)e.setTag(s,c,t,u);else if(0<=i)for(s=i;s<i+o;s++)e.setTag(s,-1,t,u);else if(0<=r)for(c=r;c<r+a;c++)e.setTag(-1,c,t,u);return n},I.prototype.altText=function(t){var n=this,e=n.sheet,i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=n.sheetArea,s,c;if(0===arguments.length)return e.getAltText(i,r,u);if(0<=i&&0<=r)for(s=i;s<i+o;s++)for(c=r;c<r+a;c++)e.setAltText(s,c,t,u);return n},I.prototype.width=function(t){var n,e,i,r,o,a,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0!==arguments.length){if(i<0)for(a=0;a<n.colCount;a++)e.setColumnWidth(a+r,t,o);return n}if(i<0)return e.getColumnWidth(r,o)},I.prototype.height=function(t){var n,e,i,r,o,a,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0!==arguments.length){if(r<0)for(a=0;a<n.rowCount;a++)e.setRowHeight(a+i,t,o);return n}if(r<0)return e.getRowHeight(i,o)},I.prototype.visible=function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0===arguments.length)return r<0&&0<=i?e.getRowVisible(i,o):0<=r&&i<0?e.getColumnVisible(r,o):void 0;if(r<0&&0<=i)for(a=0;a<n.rowCount;a++)e.setRowVisible(a+i,t,o);else if(0<=r&&i<0)for(u=0;u<n.colCount;u++)e.setColumnVisible(u+r,t,o);return n},I.prototype.resizable=function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.row,r=n.col,o=n.sheetArea;if(0===arguments.length)return r<0&&0<=i?e.getRowResizable(i,o):0<=r&&i<0?e.getColumnResizable(r,o):void 0;if(r<0&&0<=i)for(a=0;a<n.rowCount;a++)e.setRowResizable(a+i,t,o);else if(0<=r&&i<0)for(u=0;u<n.colCount;u++)e.setColumnResizable(u+r,t,o);return n},I.prototype.l0=function(t){var n=this;return n.sheet.l0(n.row,n.col,t,n.sheetArea)},I.prototype.R5=function(e,i){var t=this,r=t.sheet,o=t.sheetArea;return t.nL(function(t,n){T(r,t,n,e,i,o)}),t},I.prototype.nL=function(t){var n,e,i,r,o,a,n=this,e=n.sheet,i=n.row+n.rowCount,r=n.col+n.colCount;if(e.suspendPaint(),0<=n.row&&0<=n.col)for(o=n.row;o<i;o++)for(a=n.col;a<r;a++)t.call(n,o,a);else if(0<=n.row)for(o=n.row;o<i;o++)t.call(n,o,-1);else if(0<=n.col)for(a=n.col;a<r;a++)t.call(n,-1,a);else-1===n.row&&-1===n.col&&-1===n.rowCount&&-1===n.colCount&&t.call(n,-1,-1);e.resumePaint()},I.prototype.setStyleName=function(e){var i=this;i.nL(function(t,n){i.sheet.setStyleName(t,n,e,i.sheetArea)})},I.prototype.setStyle=function(e){var i=this;i.nL(function(t,n){i.sheet.setStyle(t,n,e.clone(),i.sheetArea)})},I.prototype.clear=function(t){var n=this;n.sheet.clear(n.row,n.col,n.rowCount,n.colCount,n.sheetArea,t)},I.prototype.setBorder=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,e=this,i=e.sheet,r=e.sheetArea;i.suspendPaint();try{if(o=new g.Range(e.row,e.col,e.rowCount,e.colCount),u=(a=i.JS(o,r)).row,s=a.col,c=a.rowCount,f=a.colCount,h=l=void 0,d=n.all,v=n.outline,m=n.inside,n.left||d||v)for(l=0;l<c;l++)i.getCell(u+l,s,r).borderLeft(t);if(n.top||d||v)for(h=0;h<f;h++)i.getCell(u,s+h,r).borderTop(t);if(n.right||d||v)for(l=0;l<c;l++)i.getCell(u+l,s+f-1,r).borderRight(t);if(n.bottom||d||v)for(h=0;h<f;h++)i.getCell(u+c-1,s+h,r).borderBottom(t);if(n.diagonalUp)for(l=0;l<c;l++)for(h=0;h<f;h++)i.getCell(u+l,s+h,r).diagonalUp(t);if(n.diagonalDown)for(l=0;l<c;l++)for(h=0;h<f;h++)i.getCell(u+l,s+h,r).diagonalDown(t);if(n.innerHorizontal||d||m)for(l=0;l<c-1;l++)for(h=0;h<f;h++)i.getCell(u+l,s+h,r).borderBottom(t),i.getCell(u+l+1,s+h,r).borderTop(t);if(n.innerVertical||d||m)for(h=0;h<f-1;h++)for(l=0;l<c;l++)i.getCell(u+l,s+h,r).borderRight(t),i.getCell(u+l,s+h+1,r).borderLeft(t)}finally{i.resumePaint()}},I.prototype.toHtml=function(t,n){void 0===t&&(t=o.HeaderOptions.noHeaders),void 0===n&&(n=!0);var e=this;return e.sheetArea===o.SheetArea.corner?"":u.yM.KS(e.sheet,t,e.row,e.rowCount,e.col,e.colCount,e.sheetArea,n,[],[],!0,!0,n,!0)},I.p0=C,p=I,(n.CellRange=p).prototype.value=C(a.getValue,a.setValue),p.prototype.text=C(a.getText,a.setText),p.prototype.D5=C(function(t,n){return l&&this.getFormula(t,n)},function(t,n,e,i){l&&this.setFormula(t,n,e,i)}),p.prototype.formula=function(t,n){if(!n)return 0===arguments.length?this.D5():this.D5(t);l&&this.sheet.eL(this.row,this.col,this.rowCount,this.colCount,t)},p.prototype.defaultValue=C(a.getDefaultValue,a.setDefaultValue),p.prototype.styleName=C(a.getStyleName,a.setStyleName),i.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation","mask","fontStyle","fontWeight","fontSize","fontFamily"],function(t,n){p.prototype[n]=function(t){return 0===arguments.length?this.l0(n):this.R5(n,t)}}),n.tL=N,n.$B=_,i.GC$.extend(a,{getRange:function(){var t,n,e,i,r,o,a,u,s,r,a,t=arguments[0];if(w(t)){if(a=t.toUpperCase(),u=this.parent&&1===this.parent.options.referenceStyle)return m;if(o=arguments[1],1<(a=x(a)).split(",").length)return m;if(l){if(!(r=(s=c("SheetsCalc")).formulaToRange(this,a,d,d,o)))return m;n=r.row,e=r.col,i=r.rowCount,r=r.colCount}else{if(!(a=N(a)))return m;n=a[0],e=a[1],i=a[2],r=a[3]}}else b(t)&&(n=t,e=arguments[1],i=arguments[2],r=arguments[3],o=arguments[4]);return new p(this,n,e,i,r,o)},getCell:function(t,n,e){return v(n)&&(n=-1),new p(this,t,n,1,1,e)}})},"./dist/core/worksheet/worksheet.js":function(e,t,o){"use strict";var n,A,i,r,I,j,l,a,u,_,b,p,x,c,f,M,Y,Z,D,W,Q,J,K,h,X,q,$,d,tt,nt,v,et,C,it,m,N,O,E,k,y,rt,S,T,ot,w,at,ut,st,s,ct,R,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,n,g,yt,Mt,Ct,St,Tt,At,n,n;function It(t,n){var e,i,r,o,a,u,s,e=[],i=t.Ut.Fj();if(i)for(r in i)if(q(i,r)&&(o=i[r])&&(n||"n"!==o.rs||(a={row:+r,item:t.getDataItem&&t.getDataItem(+r)},e.push(a)),n)&&"e"===o.rs)for(u in o)if(!m(u)&&(s=o[u])){(a={row:+r,item:t.getDataItem&&t.getDataItem(+r)}).originalItem=o.originalItem,e.push(a);break}return e}function F(t,n,e,i){for(var r,o,r=0,o=n;o<=e;o++)r+=t.Kt(o,i);return r}function L(t,n,e,i){for(var r,o,r=0,o=n;o<=e;o++)r+=t.Gt(o,i);return r}function B(t,n){return t.getColumnCount(n)}function P(t,n){return t.getRowCount(n)}function G(t){return t.frozenTrailingColumnCount()}function U(t){return t.frozenTrailingRowCount()}function xt(t){return t.Ny}function Nt(t){return t.Vy}function H(t){return t.frozenColumnCount()}function V(t){return t.frozenRowCount()}function kt(t){return t.yve}function _t(t){return t.bve}function Dt(t){return D(t)||t===_.SheetArea.viewport||t===_.SheetArea.rowHeader?_.SheetArea.viewport:t===_.SheetArea.colHeader?t:_.SheetArea.corner}function jt(t){return D(t)||t===_.SheetArea.viewport||t===_.SheetArea.colHeader?_.SheetArea.viewport:t===_.SheetArea.rowHeader?t:_.SheetArea.corner}function Ot(t,n){var t,n,t=A.util._0(t.font),n=A.util._0(n.font);return t.fontStyle+" "+t.fontWeight+" "+n.fontSize+" "+n.fontFamily}function Et(t,e,i){Object.defineProperty(t,e,{get:function(){return this["_"+e]},set:function(t){var n=this["_"+e];n!==t&&(this["_"+e]=t,i)&&i(e,t,n)}})}function Rt(t,n,e,i){return{row:n,col:e,newValue:t.getValue(n,e),oldValue:i}}function Ft(t){var n,e,i,r;if(t)for(e=(n=t.sheets).length,r=0;r<e;r++)!0===(i=n[r]).iL&&delete i.iL}function Lt(t){if(!X(t))for(var n in t)if(!D(t[n])&&!X(t[n]))return;return 1}function z(t){this.canClone=!0;var i=this;i._id=z.rL,z.rL++,i.options=J(St,function(t,n,e){i.Ob(t,n,e)}),i.Hc(t),i.Vp=new r.Tasks(function(){return this.tasks.pop()},function(){var t=i.parent;return t&&t.ib.eb||i.rt.rb||i.rt.ob||i.rt.ab})}function Bt(t,n,e,i,r){var r;-1===n&&-1===e||3===(r=D(r)?3:r)&&(r=t.tables&&t.tables.find(n,e))&&r.oL&&n===r.footerIndex()&&Tt.et(t,"composeTableFooterList",{table:r,row:n,col:e,style:i})}function Pt(t,n){var e,t;try{(e=b.Formatter&&b.Formatter.GeneralFormatter)&&typeof t==w&&(t=A.Be.Ue(t))}catch(t){}if((null!=t&&t.hasFormattedColor&&t.hasFormattedColor()||b.Formatter&&t instanceof b.Formatter.FormatterBase)&&(t.format(n,t={conditionalForeColor:N}),t.conditionalForeColor))return t.conditionalForeColor}Object.defineProperty(t,"__esModule",{value:!0}),t.Worksheet=t.InvalidType=t.ClearPendingChangeType=t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=void 0,n=o("./dist/core/core.ns.js"),A=o("./dist/core/util/common.js"),i=o("./dist/core/util/imageLoader.js"),r=o("./dist/core/util/tasks.js"),I=o("./dist/core/worksheet/style.js"),j=o("./dist/core/worksheet/worksheet-model.js"),l=o("./dist/core/util/domUtil.js"),a=o("./dist/core/celltype/textcelltype.js"),u=o("./dist/core/celltype/headercelltype.js"),_=o("./dist/core/core.enum.js"),b=o("Common"),p=o("CalcEngine"),x=!!p,f=o("./dist/core/util/theme.js"),M=o("./dist/core/worksheet/stylehelper.js"),Y=A.util.g0,Z=A.util.St,D=b.Common.lt.ht,W=A.util.En,Q=A.util.p0,J=A.util.b0,K=A.util.x0,h=l.GC$.each,X=l.GC$.isEmptyObject,q=b.Common.kh,$=A.util.Z0,d=A.util.V0,tt=new RegExp("^\\d*(\\.\\d+)?\\*$"),nt=new Date(1899,11,30).getTime(),v=b.Common.zf,et=document,C=parseInt,it=parseFloat,m=isNaN,N=null,O=void 0,E=Math.min,k=Math.max,y=Math.floor,rt=Math.ceil,S=Math.abs,T=Math.round,ot="undefined",w="string",at="width",ut="height",st="black",s="tag",ct="altText",R="onLayoutChanged",ft="beforeLayoutChanged",lt="onPaintSuspend",ht="isVisible",dt="starSize",vt="resizable",mt="canAddingSpan",gt=".gcSheet",pt=".gcSheetInternal",bt="columnHeaderFitMode",t.MAX_ROW_COUNT=1048576,t.MAX_COLUMN_COUNT=16384,wt={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},n=new b.Common.ResourceManager(n.SR,"Sheets"),g=n.getResource.bind(n),yt=A.UsedRangeUtil.vh,(n=Mt=t.ClearPendingChangeType||(t.ClearPendingChangeType={}))[n.dirty=1]="dirty",n[n.insert=2]="insert",n[n.delete=4]="delete",(n=Ct=t.InvalidType||(t.InvalidType={}))[n.setFormula=0]="setFormula",n[n.copyPaste=1]="copyPaste",n[n.dragFill=2]="dragFill",n[n.dragDrop=3]="dragDrop",n[n.changePartOfArrayFormula=4]="changePartOfArrayFormula",n[n.changeSheetName=5]="changeSheetName",n[n.table=6]="table",n[n.hideSheet=7]="hideSheet",n[n.pivotTable=8]="pivotTable",n[n.PTOverlapPT=9]="PTOverlapPT",St={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:st,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:N,selectionBackColor:N,selectionBorderColor:N,allowCellOverflow:!0,showFormulas:!1,showZeros:!0,isProtected:!1,protectionOptions:{},gridline:{},reversalTrailingResizeOrder:!1,keepUnknownFormulas:!1,sheetAreaOffset:{left:0,top:0}},z.prototype.sortRange=function(t,n,e,i,r,o,a,u,s){return!1},z.prototype.Ob=function(t,e,n){var i,r,o,a,u,s,i=this,r=i.parent;switch(t){case"allowCellOverflow":case"showFormulas":case"showZeros":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":case"reversalTrailingResizeOrder":i.zw();break;case"sheetAreaOffset":o=function(t,n){n<0&&(i.options.sheetAreaOffset[t]=0),i.zw()},a=i.options.sheetAreaOffset,["left","top"].forEach(function(t){var n=e[t];Et(a,t,o),a[t]=n});break;case"gridline":u=function(){i.zw()},s=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(t){var n=e[t];Et(s,t,u),s[t]=n});break;case"isProtected":e&&r&&r.undoManager().aL(function(t){return t.sheetId!==i._id}),i.uL(),z.et(i,"onProtectChanged"),i.zw();break;case"protectionOptions":i.uL(),z.et(i,"onProtectChanged");break;case"sheetTabColor":r&&r.Xg();break;case"keepUnknownFormulas":i.options.keepUnknownFormulas=e}i.ki(A.Events.SheetOptionsChangedInternal,{propertyName:t,value:e})},z.prototype.getUsedRange=function(t){var n,n,e,i,r,o,a,u,n,n,n,e;return!D(t)&&(r=(i=(e=this).Ut).getUsedRange(t)||{},o=e.getRowCount(),a=e.getColumnCount(),t&_.UsedRangeType.formula&&x&&(n=(u=e.b3()).usedRange,D(n)||yt(r,n.getUsedRange()),n=e.Uw&&e.Uw(3))&&n.t8&&yt(r,n.t8.Fme()),yt(r,null==(n=e.rowOutlines)?void 0:n.getUsedRange(t)),yt(r,null==(n=e.columnOutlines)?void 0:n.getUsedRange(t)),z.et(e,"getUsedRange",{type:t,range:r}),r)&&0<Object.keys(r).length?(r.minRow<0&&(r.minRow=0,r.maxRow=o-1),r.minCol<0&&(r.minCol=0,r.maxCol=a-1),r.maxRow>=o&&r.maxRow!==1/0&&(r.maxRow=o-1),r.maxCol>=a&&r.maxCol!==1/0&&(r.maxCol=a-1),n=r.maxRow===1/0?-1:r.maxRow-r.minRow+1,e=r.maxCol===1/0?-1:r.maxCol-r.minCol+1,new A.Range(r.minRow,r.minCol,n,e)):N},z.prototype.name=function(t){var n=this,e=n.parent;if(0===arguments.length)return n.Ut?n.Ut.getName():"";if(K(t,e?e.sheets:null,n))return n.ub(t),e&&e.Xg(),n;throw g().Exp_NotSupported},z.prototype.isSelected=function(t){return this.b2(t)},z.prototype.b2=function(t,n){var e,i,r,o,a,u,e=this,i=e.parent,r=!!e.Ut&&e.Ut.Xj();return D(t)?r:(t!==r&&(o=e.name(),a=i&&i.Ese(o),u=void 0,n&&(u={oldValue:r,newValue:t,sheetName:o,propertyName:"isSelected",cancel:!1,sheetIndex:a,sheetPosition:i&&i.getSheetPosition(o)},i)&&i.ki(A.Events.SheetChanging,u),!n||u&&!1===u.cancel)&&(e.Ut.qj(t),i&&i.w2&&i.w2.repaint(),n)&&i&&i.ki(A.Events.SheetChanged,{oldValue:r,newValue:t,sheetName:o,propertyName:"isSelected",sheetIndex:a,sheetPosition:i&&i.getSheetPosition(o)}),e)},z.prototype.ub=function(t,n){var e,i,r,o,e=this,i=e.name(),r=e.parent;n||z.et(e,"beforeSetName",{oldName:i,newName:t}),e.Ut.do("setName",t),r&&(o=r.sheetTabStyles.O2e[i],i!==t)&&o&&(r.sheetTabStyles.O2e[t]=o,r.sheetTabStyles.clear([i])),n||z.et(e,"setName",{oldName:i,newName:t})},z.prototype.addRows=function(t,n,e){this.ffe(t,n,e)},z.prototype.ffe=function(t,n,e,i){var r,o,a,u,s;if((e=Dt(r=e=void 0===e?_.SheetArea.viewport:e))!==_.SheetArea.corner&&!(n<=0)){a=P(o=this,e),(t<0||a<t)&&(t=a),o.suspendPaint();try{u="addRows",o.kj(t,r,u,n,a)&&(0===o.Ut.P8&&o.parent&&o.parent.Wp.clear(),o.sL(!1,e),s={changeType:"addingRows",row:t,rowCount:n,canAdd:!0,sheetArea:e},z.et(o,R,s),s.canAdd)&&(D(s.newRow)||(t=s.newRow),this.Ut.do("addRows",t,n,O,O,e),o.Ww=!0,z.et(o,R,{changeType:u,row:t,oldValue:a,rowCount:n,rowExpand:i,sheetArea:e}),z.et(o,R,{changeType:"addRows2",row:t,oldValue:a,rowCount:n,sheetArea:e}),e===_.SheetArea.viewport&&o.tables&&o.tables.cL(!0,t),o.dj(t,r,u,n,a))}finally{o.sL(!0,e),o.resumePaint()}}},z.prototype.sL=function(t,n){var e,i,r;(n=void 0===n?_.SheetArea.viewport:n)===_.SheetArea.viewport&&(i=(e=this).ui,r=e.ci,e.Ut.setCellState(i,r,_.CellStatesType.active,t,n))},z.prototype.deleteRows=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m;if((e=Dt(i=e=void 0===e?_.SheetArea.viewport:e))!==_.SheetArea.corner&&(o=P(r=this,e),!(t<0||o<=t||n<=0))){r.suspendPaint();try{if(a="deleteRows",r.kj(t,i,a,n,o)&&(0===r.Ut.P8&&r.parent&&r.parent.Wp.clear(),r.sL(!1,e),u={changeType:"deletingRows",row:t,rowCount:n,canDelete:!0,sheetArea:e},z.et(r,R,u),u.canDelete)){if(e===_.SheetArea.viewport&&r._j(t,n,0,this.getColumnCount()),r.Ut.do("deleteRows",t,n,O,e),0<=(s=r.Tb)){for(c=-1,f=V(r),l=s;f<=l;l--)if(r.getRowVisible(l)&&0<r.Gt(l)){c=l;break}s!==(c=-1===c?0:c)&&r.$A(c)}h=P(r),r.getActiveRowIndex()>=h&&(d=h-1,v=r.getActiveColumnIndex(),(m=r.getSpan(d,v))&&(d=m.row,v=m.col),r.setActiveCell(d,v)),r.Ww=!0,z.et(r,R,{changeType:a,row:t,oldValue:o,rowCount:n,sheetArea:e}),e===_.SheetArea.viewport&&r.tables&&r.tables.cL(!0,t),r.dj(t,i,a,n,o)}}finally{r.sL(!0,e),r.resumePaint()}}},z.prototype.addColumns=function(t,n,e){var i,r,o,a,u;(e=jt(i=e=void 0===e?_.SheetArea.viewport:e))===_.SheetArea.corner||n<=0||(o=B(r=this,e),r.Dj(t=t<0||o<t?o:t,i,a="addColumns",n,o)&&(0===r.Ut.P8&&r.parent&&r.parent.Wp.clear(),z.et(r,R,u={changeType:"addingColumns",col:t,colCount:n,canAdd:!0,sheetArea:e}),u.canAdd)&&(r.sL(!1,e),r.Ut.do("addColumns",t,n,O,e),r.Zw=!0,z.et(r,R,{changeType:a,col:t,oldValue:o,colCount:n,sheetArea:e}),z.et(r,R,{changeType:"addColumns2",col:t,oldValue:o,colCount:n,sheetArea:e}),e===_.SheetArea.viewport&&r.tables&&r.tables.cL(!1,t),r.vj(t,i,a,n,o),r.sL(!0,e),r.zw()))},z.prototype.deleteColumns=function(t,n,e){var i,r,o,a,u,u,s,c,f,u,l,u,h;if((e=jt(i=e=void 0===e?_.SheetArea.viewport:e))!==_.SheetArea.corner&&(o=B(r=this,e),!(t<0||o<=t||n<=0))&&r.Dj(t,i,a="deleteColumns",n,o)&&(0===r.Ut.P8&&r.parent&&r.parent.Wp.clear(),z.et(r,R,u={changeType:"deletingColumns",col:t,colCount:n,canDelete:!0,sheetArea:e}),u.canDelete)){if(r.sL(!1,e),e===_.SheetArea.viewport&&r._j(0,this.getRowCount(),t,n),r.Ut.do("deleteColumns",t,n,O,e),0<=(u=r.Ab)){for(s=-1,c=H(r),f=u;c<=f;f--)if(r.getColumnVisible(f)&&0<r.nn(f)){s=f;break}u!==(s=-1===s?0:s)&&r.o9(s)}u=B(r),r.getActiveColumnIndex()>=u&&(l=r.getActiveRowIndex(),(h=r.getSpan(l,u=u-1))&&(l=h.row,u=h.col),r.setActiveCell(l,u)),r.Zw=!0,z.et(r,R,{changeType:a,col:t,oldValue:o,colCount:n,sheetArea:e}),z.et(r,R,{changeType:"deleteColumns2",col:t,oldValue:o,colCount:n,sheetArea:e}),e===_.SheetArea.viewport&&r.tables&&r.tables.cL(!1,t),r.vj(t,i,a,n,o),r.sL(!0,e),r.zw()}},z.prototype.frozenColumnCount=function(t,n){var e=this;if(0===arguments.length)return e.fp;e.ame(t,n)},z.prototype.ame=function(t,n,e){var i,r,o,i=this;0<=t&&(!D(n)&&"number"==typeof n||(n=0),r=i.yve,i.fp=t,0<n?(o=i.getColumnCount(),e||E(n,t)<o?i.yve=n<t-1?n:t-1:i.yve=o-1):i.yve=0,i.Ab<t?i.Ab=t:""!==t&&0!==t&&null!==t||(i.Ab=r||0),i.Zw=!0,i.zw())},z.prototype.frozenRowCount=function(t,n){var e=this;if(0===arguments.length)return e.ap;e.ome(t,n)},z.prototype.ome=function(t,n,e){var i,r,o,i=this;0<=t&&(!D(n)&&"number"==typeof n||(n=0),r=i.bve,i.ap=t,0<n?(o=i.getRowCount(),e||E(n,t)<o?i.bve=n<t-1?n:t-1:i.bve=o-1):i.bve=0,i.Tb<t?i.Tb=t:""!==t&&0!==t&&null!==t||(i.Tb=r||0),i.Ww=!0,i.zw())},z.prototype.wve=function(t){void 0===t&&(t=0);var n,e=kt(this),i;return 0<e?e:t},z.prototype.Mve=function(t){void 0===t&&(t=0);var n,e=_t(this),i;return 0<e?e:t},z.prototype.frozenTrailingRowCount=function(t,n){var e=this;return 0===arguments.length?e.fL:(0<=t&&(D(n)&&(n=!0),e.fL=t,e.Ny=n,e.Ww=!0,e.zw()),e)},z.prototype.frozenTrailingColumnCount=function(t,n){var e=this;return 0===arguments.length?e.lL:(0<=t&&(D(n)&&(n=!0),e.lL=t,e.Vy=n,e.Zw=!0,e.zw()),e)},z.prototype.getFrozenTrailingState=function(t){var n=this;return t?n.Ny:n.Vy},z.prototype.getFrozenTopLeftIndex=function(t){var n=this;return t?n.bve:n.yve},z.prototype.Gy=function(t){var n,e,n=Nt(this),e=t.hL;return n?e+t.Uy:e},z.prototype.Sy=function(t){var n,e,n=xt(this),e=t.A6;return n?e+t.Ty:e},z.prototype.getRowCount=function(t){return 0===t?0:this.Ut.getRowCount(t)},z.prototype.getColumnCount=function(t){return 0===t?0:this.Ut.getColumnCount(t)},z.prototype.setRowCount=function(t,n,e){var i,e,e;D(n)&&(n=3),i=this,D(e)||(e=i.getUsedRange(e),D(e))||(-1===e.rowCount&&(e.rowCount=i.getRowCount(n)),t=Math.max(t,e.row+e.rowCount)),z.et(i,R,e={changeType:"settingRowCount",rowCount:t,sheetArea:n,canSet:!0}),e.canSet&&i.setRowCountCore(t,n)},z.prototype.setRowCountCore=function(t,n){var e,i;t=C(t,10),m(t)||(D(n)&&(n=3),i=(e=this).getRowCount(n),t<0)||t===i||(3===n||2===n?(e.Ut.do("setRowCount",t,n),V(e)>t&&e.frozenRowCount(t)):1===n&&e.Ut.do("setRowCount",t,n),z.et(e,R,{changeType:"setRowCount",row:i,rowCount:t,sheetArea:n}),e.Ww=!0,e.ui>=t&&(3===n||2===n)&&e.setActiveCell(t-1,e.getActiveColumnIndex()),e.zw(),e.clearPendingChanges())},z.prototype.setColumnCount=function(t,n,e){var i,r,e;t=C(t,10),m(t)||(r=(i=this).getColumnCount(n),t<0)||t===r||(D(n)&&(n=3),D(e)||(e=i.getUsedRange(e),D(e))||(-1===e.colCount&&(e.colCount=i.getColumnCount(n)),t=Math.max(t,e.col+e.colCount)),3===n||1===n?(i.Ut.do("setColumnCount",t,n),H(i)>t&&i.frozenColumnCount(t)):2===n&&i.Ut.do("setColumnCount",t,n),z.et(i,R,{changeType:"setColumnCount",col:r,colCount:t,sheetArea:n}),i.Zw=!0,i.ci>=t&&(3===n||1===n)&&i.setActiveCell(i.getActiveRowIndex(),t-1),i.zw(),i.clearPendingChanges())},z.prototype.getFreeAreaRowCount=function(t){var n;return this.Ut.getFreeAreaRowCount(t)},z.prototype.getFreeAreaColumnCount=function(t){var n;return this.Ut.getFreeAreaColumnCount(t)},z.prototype.setFreeAreaRowCount=function(t,n){var e;this.Ut.setFreeAreaRowCount(t,n)},z.prototype.setFreeAreaColumnCount=function(t,n){var e;this.Ut.setFreeAreaColumnCount(t,n)},z.prototype.w8=function(t){var n,e,i,r,o;if(!D(t)&&(n=t.rows,i=!1,this.filterRowsVisibleInfo)){if(r=this.filterRowsVisibleInfo.rowsVisibleInfo||{},n&&0<n.length)for(o=0;o<n.length;o++)(e=n[o])&&e.isFilter&&(e.visible=!0,delete e.isFilter,i=!(r[o]=!1));i&&(this.filterRowsVisibleInfo.rowsVisibleInfo=r,this.filterRowsVisibleInfo.empty=!1)}},z.prototype.Oe=function(t,n,e,i){var r=this;return(c=c||o("SheetsCalc"))?r.dL(t,n,e,i):O},z.prototype.t0=function(t,n,e){var i,r,r,o,e,r,e,i=this;if(3===e)return i.options.showFormulas?(r=i.getFormula(t,n,3,!0))?"="!==r[0]?"="+r:r:(r=i.Uw&&i.Uw(e))&&r.t8.getAnchorInfo(t,n)?"":void 0:i.options.showZeros||!(0===(e=i.getValue(t,n,3))||e instanceof Date&&e.getTime()===nt)||(r=(r=i.getFormatter(t,n))||(e=i.getStyle(t,n))&&e._autoFormatter&&e._autoFormatter.formatCached)&&("="===r[0]||3<=r.split(";").length)?void 0:""},z.prototype.getText=function(t,n,e){var i,r,o;return D(e)&&(e=3),r=(i=this).t0(t,n,e),D(r)?(o=i.getValue(t,n,e),i.vL(t,n,o,e,!0)):r},z.prototype.setText=function(t,n,e,i){var r,o,a,a,u,s,c,r=this;D(i)&&(i=3),o=e,z.et(r,"settingText",a={value:e}),a=e=a.value,u=r.getCellType(t,n,i),s=r.getFormatter&&r.getFormatter(t,n,i),u&&s&&!Z(s)&&(a=u.parse(o,s,c={sheet:r,row:t,col:n,sheetArea:i}),a=D(a)?e:a),r.YI(t,n,a,i),r.zw()},z.prototype.getValue=function(t,n,e,i){return this.mL(t,n,e,i)},z.prototype.setValue=function(t,n,e,i,r){this.YI(t,n,e,i,r),this.Cle()},z.prototype.Ij=function(t,n,e,i){var r=this;!i&&x&&r.gL(t,n,e),r.Q1i&&r.Q1i(t,n,1,1,e),r.Lpe&&r.Lpe(t,n,e)},z.prototype.Tj=function(){var t=this.conditionalFormats;t&&t.dl()},z.prototype.Lj=function(t,a,u){var n,s;t&&t.parent&&t.parent.sheets&&(n=t.parent.sheets,s=t._id,n.forEach(function(o){var t=o.cameraShapes;t&&0<t.length&&t.forEach(function(t){var n,e,i,r;if(t.cameraImageCache&&(e=(n=t.JVV).ytV.AnV)&&(o._id===s||e.sheet&&e.sheet._id===s))for(i=0;i<a.length;i++){if(r=e.cellRange,void 0!==a[i].row&&void 0===a[i].col&&2===u&&a[i].row>=r.row&&a[i].row<r.row+r.rowCount){t.cameraImageCache=null,n.ytV.rtV&&n.mtV();break}if(void 0===a[i].row&&void 0!==a[i].col&&1===u&&a[i].col>=r.col&&a[i].col<r.col+r.colCount){t.cameraImageCache=null,n.ytV.rtV&&n.mtV();break}if(0===u){if(void 0===a[i].rowCount&&void 0===a[i].colCount&&r.contains(a[i].row,a[i].col)){t.cameraImageCache=null;break}if(void 0!==a[i].rowCount&&void 0!==a[i].colCount&&r.intersect(a[i].row,a[i].col,a[i].rowCount,a[i].colCount)){t.cameraImageCache=null;break}}}})}))},z.prototype.Sle=function(t,n,e,i){var r=this;r.Ij(t,n,e,i),r.Tj()},z.prototype.YI=function(t,n,e,i,r,o){var a,u,s,c,s;0===i||(D(i)&&(i=3),s=(u=(a=this).Ut).getRowCount(i),c=u.getColumnCount(i),t<0)||s<=t||n<0||c<=n||(e=$(e),e=Y(e),s=a.Uw&&a.Uw(i),!o&&s&&s.t8.Fgt(t,n),u.do("setValue",t,n,e,i),a.Sle(t,n,i,r))},z.prototype.Cle=function(){var t=this.parent,n=t&&t.getActiveSheet();(n&&!0===n.iL?n:this).zw(),Ft(t)},z.prototype.getValueIgnoreDefault=function(t,n,e,i,r){var o,t,o=this.Ut;return o.wle=!0,t=this.mL(t,n,e,i,r),delete o.wle,t},z.prototype.getDefaultValue=function(t,n){return d(this.Ut.getDefaultValue(t,n))},z.prototype.getDefaultValueByType=function(t,n,e,i){return d(this.Ut.getDefaultValue(t,n,e,i))},z.prototype.setDefaultValue=function(t,n,e){var i=this;i.Ut.setDefaultValue(t,n,e),i.Sle(t,n,3,!0),i.Cle()},z.prototype.Il=function(t,n,e,i,r,o){var a=this,i,i=a.getActualStyle(t,n,e,i,r,o);return Bt(a,t,n,i,e),i},z.prototype.getActualStyle=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,d,v,m,g,p,v,b,w,p,w,h,y,M,C,S,S,p,T,A,d,b;if(0===(e=D(e)?3:e))return new I.Style;if(-1===t&&-1===n)return this.getDefaultStyle(e);if(d=(u=this).pL,p="__spreadJSDefault",w="__undefined",h=this.Ut,3===e&&u.pivotTables&&(M=(y=u.pivotTables.findPivotTable(t,n)||N)&&y.hqt(t,n)),f=h.getStyle(t,n,e),l=h.getStyle(t,-1,e),h=h.getStyle(-1,n,e),l=l||N,h=h||N,a&&(-1===t&&(l=N),-1===n)&&(h=N),v=w,C=u.parent&&u.parent.Gie,(f=f||N)&&(v=f.charAt?f:p+f._id),b=w,l&&(b=l.charAt?l:p+l._id),w=w,h&&(w=h.charAt?h:p+h._id),d=(p=d[e])[v],S=u.tables,(S=3===e&&S&&!o?S.find(t,n):N)||y||u.NMi||((m=(d=d||(p[v]={}))[b])?g=m[w]:m=d[b]={}),g||(c=u.getCompositeStyle(t,n,e,f,l,h,S,O,o,M,a,y)),(3===e||t<u.getFreeAreaRowCount(e)||1===e&&u.NMi)&&!i&&(p=u.conditionalFormats)&&(s=p.bL(s,t,n,e)),!(3===e||t<u.getFreeAreaRowCount(e))||i||!D(s)&&!D(s.foreColor)||!(T=s&&s.formatter||g&&g.formatter||c&&c.formatter||f&&f._autoFormatter)||o||Z(T)||(A=Pt(T,u.getValue(t,n,e)))&&((s=D(s)?new I.Style:s).foreColor=A),s)s.h5(v=g||c),s.font&&v&&v.font&&s.font!==v.font&&(s.font=Ot(s,v)),c=s;else if(g)return!u.cellStates||i||C||(d=u.cellStates.getStyle(t,n,e,N,g.locked))&&(d.h5(g),(g=d).v5(u.hl)),r?g:g.clone(!0);return a||(D(c.locked)&&(c.locked=!0),c=c.v5(u.hl)),s||S||y||u.NMi||(m[w]=c.clone(!0)),!u.cellStates||i||C||(b=u.cellStates.getStyle(t,n,e,N,c.locked))&&(!(T=b.formatter)||o||Z(T)||(A=Pt(T,u.getValue(t,n,e)))&&(b.foreColor=A),b.h5(c),c=(c=b).v5(u.hl)),c},z.prototype.l0=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,h,v,m,g,g,p;if(0===i)return O;if(D(i)&&(i=3),s=(r=this).Ut,f=!1,3===i){if("foreColor"===e){h=r.l0(t,n,"formatter",i);try{(d=b.Formatter&&b.Formatter.GeneralFormatter)&&typeof h==w&&(h=A.Be.Ue(h))}catch(t){}h&&(h.hasFormattedColor&&h.hasFormattedColor()||b.Formatter&&h instanceof b.Formatter.FormatterBase)&&(v={conditionalForeColor:N},h.format(r.getValue(t,n),v),v.conditionalForeColor)&&(c=v.conditionalForeColor,f=!0)}(h=r.conditionalFormats)&&0<h.count(i)&&(f=(v=h.wL(t,n,e,i)).yL,c=v.Y6)}for(m=0;!f&&m<=4;)if(0===m?o=s.getStyle(t,n,i):1===m?(g=r.tables,(g=3===i&&g?g.find(t,n):N)&&wt[e]&&(o=g.ML(t,n,e))):o=2===m?s.getStyle(t,-1,i):3===m?s.getStyle(-1,n,i):r.getDefaultStyle(i),m++,o=o&&o.charAt&&typeof o==w?r.u8(o):o){if("font"!==e&&"fontStyle"!==e&&"fontWeight"!==e&&"fontSize"!==e&&"fontFamily"!==e||!o.themeFont||(l=l||o.themeFont),o[e]!==O){c=o[e],f=!0;break}for(a=o.parentName,p=void 0;a&&p!==a&&(u=r.u8(a));){if(u[e]!==O){c=u[e],f=!0;break}a=u.parentName,p=u.name}}return"locked"===e?!!D(c)||c:f||l?("foreColor"!==e&&"backColor"!==e&&"font"!==e&&"fontStyle"!==e&&"fontWeight"!==e&&"fontSize"!==e&&"fontFamily"!==e&&"borderLeft"!==e&&"borderTop"!==e&&"borderRight"!==e&&"borderBottom"!==e||((o=new I.Style)[e]=c,"font"===e&&l&&(o.themeFont=l),o.v5(r.hl),c=o[e]),c):O},z.prototype.getStyle=function(t,n,e){return this.Z_(t,n,e,!0)},z.prototype.Z_=function(t,n,e,i){var r,t,n,e;if(0!==(e=D(e)?3:e)){if((t=(r=this.Ut).getStyle(t,n,e))instanceof I.Style)return i&&this.r3(),t;if(typeof t==w&&(n=this.u8(t))!==N&&n!==O)return(e=new I.Style).h5(n,!1),i&&this.r3(),e}return N},z.prototype.addNamedStyle=function(t){this.$p(t),this.zw()},z.prototype.$p=function(t){if(t){if(!t.name)throw new Error(g().Exp_EmptyNamedStyle);var n=t.name.toUpperCase();this.Hp[n]=t}},z.prototype.getNamedStyle=function(t){return this.i3(t,!0)},z.prototype.i3=function(t,n){var e,e,e=this.Hp;return e&&t?((e=e[t=t.toUpperCase()])&&n&&this.r3(),e):N},z.prototype.r3=function(){this.pL=[{},{},{},{}]},z.prototype.removeNamedStyle=function(t){var n,e,n=this.Hp;n&&t&&(t=t.toUpperCase(),q(n,t))&&((e=n[t].formatter)&&"string"==typeof e&&this.parent.bp[e]&&this.parent.o3(e),delete n[t],this.r3(),this.zw())},z.prototype.getNamedStyles=function(){var e=[],t=this.Hp;return t&&h(t,function(t,n){e.push(n)}),this.r3(),e},z.prototype.setStyle=function(t,n,e,i){var r,i;D(i)&&(i=3),e&&e.backColor&&"object"==typeof e.backColor&&M.W.processStops(e.backColor),(r=this).CL(t,n,e,i),-1===t&&-1===n&&(r.Sj[i]=N),-1!==t&&-1!==n||(i=e&&e.validator)&&i.condition()&&4===i.condition().conType()&&i.condition().getExpected(this,t<0?0:t,n<0?0:n),r.r3(),r.zw()},z.prototype.u5=function(t,n,e,i){var r,o,a,r=this;r.isActualProtected()?(o=r.Z_(t,n,i),a=void 0,e?(a=o?o.locked:O,e.locked!==a&&(e.locked=a),r.setStyle(t,n,e,i)):o&&((a=o.locked)!==O&&((e=new I.Style).locked=a),r.setStyle(t,n,e,i))):r.setStyle(t,n,e,i)},z.prototype.getStyleName=function(t,n,e){var t=this.vI(t,n,e);return t instanceof I.Style?t.name:t},z.prototype.setStyleName=function(t,n,e,i){var r;typeof e==w&&(D(i)&&(i=3),(r=this).CL(t,n,e,i),-1===t&&-1===n&&(r.Sj[i]=N),r.r3(),r.zw())},z.prototype.vI=function(t,n,e){var i;return(i=0!==(e=D(e)?3:e)?this.Ut.getStyle(t,n,e):i)||N},z.prototype.getNamedStyleName=function(t,n,e){var t=this.vI(t,n,e);return"string"==typeof t?t:O},z.prototype.CL=function(t,n,e,i){var r,o,a,u,s,u,s,a,s,o;0!==(i=D(i)?3:i)&&(o=(r=this).vI(t,n,i),u=(a=r.Ut).getRowCount(i),s=a.getColumnCount(i),t<-1||u<=t||n<-1||s<=n||(u=a.getStyle(t,n,i),a.do("setStyle",t,n,e,i),(s=r.l0(t,n,"formatter",i))&&Z(s)&&r.SL(t,n,s),a=o&&o.cellType&&o.cellType.typeName||N,s=e&&e.cellType&&e.cellType.typeName||N,t===r.ui&&n===r.ci&&a!==s&&A.hi.A1(r)&&r.rt.aA(),o="[styleinfo]",-1!==t&&-1!==n?r.Rj(o,t,n,i,u,e):-1!==t&&-1===n?r.dj(t,i,o,e,u):-1===t&&-1!==n&&r.vj(n,i,o,e,u)))},z.prototype.SL=function(t,n,e){var i=this;(c=c||o("SheetsCalc"))&&i.TL(t,n,e)},z.prototype.getDefaultStyle=function(t){var n,e,i,i,r,n,i;return D(t)&&(t=3),(i=(e=(n=this).Sj)[t])||(0!==t?((r=typeof(r=(i=n.Ut).getStyle(-1,-1,t))==w?n.u8(r):r)||(r=new I.Style,i.do("setStyle",-1,-1,r,t)),n=1===t||2===t,typeof r.hAlign==ot&&(r.hAlign=n?1:3),typeof r.vAlign==ot&&(r.vAlign=n?1:0),typeof r.imeMode==ot&&(r.imeMode=1),r.font||typeof r.themeFont!=ot||(r.themeFont="Body"),e[t]=r):((i=new I.Style).locked=!0,e[t]=i))},z.prototype.setDefaultStyle=function(t,n){var e=this;0!==(n=D(n)?3:n)&&e.Ut.do("setStyle",-1,-1,t,n),e.Sj[n]=N,e.r3(),e.zw()},z.prototype.u8=function(t){var n,e,e,n=this.i3(t,!1);return n=n||(e=this.parent)&&e.i3(t,!1),e=N,n&&(e=n.clone(!0),(0,A.AL)(e)),e},z.prototype.getCompositeStyle=function(t,n,e,i,r,o,a,u,s,c,f,l){var u,h,d,v;if(D(e)&&(e=3),h=this,d=new I.Style,v=!1,0!==e){if(v=h.IL(t,n,e,d,v,i),u)return v?d:i;v=h.xL(t,n,e,d,v,a,s),v=(u=h.NL(t,n,e,d,v,l,s,c)).changed,d=u.destInfo,v=h.kL(t,e,d,v,r),v=h.DL(n,e,d,v,o)}return h._L(e,d,v,f),d},z.prototype.IL=function(t,n,e,i,r,o){var a,u,s,c,f,f,l,a=this,u=a.Ut,f=u.getRowCount(e),l=u.getColumnCount(e);return 0<=t&&t<f&&0<=n&&n<l&&(f=(f=o!==O?o:u.getStyle(t,n,e))&&f.charAt?a.u8(f):f)&&(i.h5(f,!0,10),(0,I.composeParentStyle)(f,i,a,!(r=!0),10,!0)),r},z.prototype.xL=function(t,n,e,i,r,o,a){var u,s=this.tables;return(o=o!==O||a?o:3===e&&s?s.find(t,n):N)&&!a&&(o.h5(t,n,i),r=!0),r},z.prototype.NL=function(t,n,e,i,r,o,a,u){var s,c,a,s=this,c=s.pivotTables;return(u=o!==O||a?u:(o=3===e&&c?c.findPivotTable(t,n):N)&&o.hqt(t,n))&&(u.parentName&&(a=s.u8(u.parentName))&&u.h5(a),u.h5(i),i=u,r=!0),o&&(o.wqt(t,n,i),r=!0),{changed:r,destInfo:i}},z.prototype.kL=function(t,n,e,i,r){var o=this,a=o.Ut,u=a.getRowCount(n),u,s,c;return 0<=t&&t<u&&(u=(u=r!==O?r:a.getStyle(t,-1,n))&&u.charAt?o.u8(u):u)&&(e.h5(u,!i,30),(0,I.composeParentStyle)(u,e,o,!(i=!0),30,!0)),i},z.prototype.DL=function(t,n,e,i,r){var o=this,a=o.Ut,u=a.getColumnCount(n),u,s,c;return 0<=t&&t<u&&(u=(u=r!==O?r:a.getStyle(-1,t,n))&&u.charAt?o.u8(u):u)&&(e.h5(u,!i,40),(0,I.composeParentStyle)(u,e,o,!(i=!0),40,!0)),i},z.prototype._L=function(t,n,e,i){var r,o,a,t,r=this,t=r.getDefaultStyle(t);return t&&t.charAt?t=r.u8(t):t&&t.clone&&(t=t.clone(!0),(0,A.AL)(t)),t&&!i&&(n.h5(t,!e,50),(0,I.composeParentStyle)(t,n,r,!1,50,!0)),e},z.prototype.getCellType=function(t,n,e){return this.l0(t,n,"cellType",e)||this.$f(e)},z.prototype.$f=function(t){D(t)&&(t=3);var n,n=(n=this.f7)||(this.f7=new a.Text);return 3===t?n:1===t?new u.ColumnHeader:2===t?new u.RowHeader:0===t?new u.Corner:n},z.prototype.setCellType=function(t,n,e,i){var r=this.Z_(t,n,i),r;(r=r||new I.Style).cellType=e,this.setStyle(t,n,r,i)},z.prototype.EL=function(t,n,e,i,r,o){var a,u,s,o,o,c,f,a=this;if(D(r)&&(r=3),u=a.Ut,o||u.do("clearSpan",t,n,e,i,r),s=(0,A.Ec)(t,n,e,i),o=a.JS(s,r),o=a.jL(o,r),u.do("addSpan",o,r),3===r){for(c=a.getSelections(),f=0;f<c.length;f++)c[f].intersect(t,n,e,i)&&(c[f]=c[f].union(s));u.do("setSelections",c)}a.zw()},z.prototype.jL=function(t,n){var e,n,i,r,o,t,e=this.getRowCount(n),n=this.getColumnCount(n),i=t.row,r=t.col,o=t.rowCount,t=t.colCount;return(0,A.Ec)(i,r,o=e<i+o?e-i:o,t=n<r+t?n-r:t)},z.prototype.addSpan=function(t,n,e,i,r){this.TTe(t,n,e,i,r)},z.prototype.addSpans=function(t,n){var e=this;t.forEach(function(t){e.TTe(t.row,t.col,t.rowCount,t.colCount,n,!0)})},z.prototype.TTe=function(t,n,e,i,r,o){var a,u,s,u,c,s,a=this;if((1!==e||1!==i)&&0!==r&&(u=a.getRowCount(r),s=a.getColumnCount(r),!(u<=t||s<=n||t<-1||n<-1))&&(u={row:t,col:n,rowCount:e,colCount:i,sheetName:a.name(),sheetArea:r,isAllow:!0},z.et(a,mt,u),u.isAllow)){if(!o&&(c=a.Ut).GT(t,n,e,i,r))throw new Error(g().Exp_InvalidRange);a.OL&&a.OL(t,n,e,i),a.EL(t,n,e,i,r,o),z.et(a,R,s={sheet:a,row:t,col:n,rowCount:e,colCount:i,sheetArea:r,changeType:"addSpan"}),a.ki("spanChanged",s)}},z.prototype.removeSpan=function(t,n,e){var i,r,o,r,i=this;D(e)&&(e=3),(o=(r=i.Ut).findSpan(t,n,e))&&o.row===t&&o.col===n&&r.do("removeSpan",o,e),z.et(i,R,r={sheet:i,row:t,col:n,sheetArea:e,changeType:"removeSpan"}),i.ki("spanChanged",r),i.zw()},z.prototype.getSpans=function(t,n){return 0===n?[]:this.Ut.getSpans(t,n,!0)},z.prototype.getSpan=function(t,n,e){return 0===e?N:this.Ut.findSpan(t,n,e)},z.prototype.repaint=function(t){this.My<=0&&this.Dn&&this.Dn.repaint(t)},z.prototype.x_=function(t,n,e,i){var r,o,t,n,r=t,o=1,t=this.RL(t,n,e,i);t&&(r=t.row,o=t.rowCount),(n=this.j1(new A.Range(r,-1,o,-1))).y-=2,n.height+=4,this.repaint(n)},z.prototype.N_=function(t,n,e,i){var r,o,t,n,r=t,o=1,t=this.BL(t,n,e,i);t&&(r=t.col,o=t.colCount),(n=this.j1(new A.Range(-1,r,-1,o))).x-=2,n.width+=4,this.repaint(n)},z.prototype.LL=function(t,n){var e,i,t,e=this,i=e.Fi(),t=e.j1(new A.Range(-1,t,-1,1));t.y=i.y,t.height=i.height,n&&(t.x-=2,t.width+=4),e.repaint(t)},z.prototype.RL=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.yw(e),a=o.length;if(0!==a&&(u=r.s7(n,e,_.SheetArea.viewport,i))){if(u.length>a)for(u=new j.h9,c=s=o[0].col;c<a;c++)(f=r.O_(n,e,_.SheetArea.viewport,t,o[c].col))&&u.push(f);return u.findLargestRow(t)}return N},z.prototype.BL=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.dw(n),a=o.length;if(0!==a&&(u=r.s7(n,e,_.SheetArea.viewport,i))){if(u.length>a)for(u=new j.h9,c=s=o[0].row;c<a;c++)(f=r.O_(n,e,_.SheetArea.viewport,o[c].row,t))&&u.push(f);return u.findLargestCol(t)}return N},z.prototype.OA=function(t,n){var e,i,r,o,a,u,s,c,c,s,f,l,c,h,c,c,d,v,m,g,c,d,p,s,t,b,c,d,s,t,e=this,i=e.parent,r=i&&i.options.scrollbarAppearance===_.ScrollbarAppearance.mobile,o=!1,a=!1,u=i&&i.options.scrollByPixel,s=V(e),c=H(e),c=c?e.O5(c-1):e.k9(),s=s?e.j5(s-1):e.N9();if(n<e.Ab&&c<=n?(o=!0,e.o9(e.r6(n+1),0)):u&&n===e.Ab&&0!==e.my&&(o=!0,e.o9(n,0)),n>e.getLastFullyVisibleColumn()&&n<=e.G6()){for(f=0,l=n,c=e.Fi(),h=e.Gy(c),(c=e.Ut.findSpan(t,l))&&(l=c.col+c.colCount-1);l>e.Ab&&!(h<(f+=e.nn(l)));)l--;d=c=void 0,d=u?(l===e.Ab&&f<h&&(f+=e.nn(l)),c=l,h-f):(c=(v=e.bge())===l?l:e.O5(l),0),o=!0,e.o9(c,d)}if(t<e.Tb&&s<=t?(a=!0,e.$A(e.nI(t+1),0)):u&&t===e.Tb&&0!==e.ly&&(a=!0,e.$A(t,0)),t>e.getLastFullyVisibleRow()&&t<=e.P6()){for(m=0,(c=e.Ut.findSpan(g=t,n))&&(g=c.row+c.rowCount-1),d=e.Fi(),p=e.Sy(d);g>e.Tb&&!(p<(m+=e.Gt(g)));)g--;t=s=void 0,t=u?(g===e.Tb&&m<p&&(m+=e.Gt(g)),s=g,p-m):(s=(b=e.pge())===g?g:e.j5(g),0),a=!0,e.$A(s,t)}c=e.aB(),!u&&n===e.G6()&&c&&e.o9(c,0),r&&(d=i.Xb,s=i.zb,t=i.ib,a&&(d.qy(_.ScrollbarState.show),t.$y(!0)),o)&&(s.qy(_.ScrollbarState.show),t.$y(!1))},z.prototype.hitTest=function(t,n,e,i){var r,o,a,u,s,a,u,s,e,s,s,c,f,a,a,c,a,c,a,u,a,c,u,a,c,u,i,r=this;if(r.Fi(),o={x:t,y:n},a=r.rowOutlines,u=r.columnOutlines,s=!(s=a?a.hitTest(r,t,n):s)&&u?u.hitTest(r,t,n):s)o.outlineHitInfo=s;else{if(a=r.FL(n),u=r.PL(t),o.rowViewportIndex=a,o.colViewportIndex=u,o.row=r.GL(n,a),o.col=r.UL(t,u,n,a,o.row),o.hitTestType=r.C6(a,u),0<=a&&a<=2&&0<=u&&!0!==e&&(s=r.O_(a,u,o.hitTestType,o.row,o.col))&&(o.row=s.row,o.col=s.col),e=r.rt,s=(s=r.IB)&&s.hitTest(o,t,n),f=void 0,!(c=r.tables)||-1===a&&-1===u||(f=-1===a?c.find(r.getActiveRowIndex(),r.getActiveColumnIndex()):c.find(o.row,o.col)),s=s||(a=f&&f.IB)&&a.hitTest(o,t,n),a=c&&!s&&c.HL(t,n,o))return(o.tableSelectInfo=a).table&&a.table.IB&&(o.filterButtonHitInfo=s),o;(c=e.zL&&e.zL(o,t,n))?o.dragMergeInfo=c:(a=e.VL&&e.VL(o,t,n))?o.dragInfo=a:(c=o.col,o.col=r.UL(t,u),o.YL=c,(a=e.bD(o,t,n,5))?o.resizeInfo=a:(o.col=c,delete o.YL,(u=e.ZL?e.ZL(o,t,n):N)?o.formulaRangeHitInfo=u:(c=(a=r.Ut.pI)&&a.hitTest(t,n))?o.commentHitInfo=c:(a=(u=r.WL)&&u.hitTest(t,n,i),c=void 0,(c=r.shapes?r.shapes.hitTest(t,n):c)?o.shapeHitInfo=c:a?o.floatingObjectHitInfo=a:s?o.filterButtonHitInfo=s:(u=f&&!f.QL()&&e.KL&&e.KL(o,f))?o.resizeTableHitInfo=u:o.cellTypeHitInfo=r.JL(o,t,n))))}return i=r.pivotTables&&r.pivotTables.findPivotTable(o.row,o.col),D(i)||(o.pivotTableInfo=i),o},z.prototype.getCellRect=function(t,n,e,i,r){var o,a,u,u,s,c,a,e,i,o,r,o=3;return-1===e?o=1:-1===i&&(o=2),u=(a=this).Fi(),-1===e&&-1===i?new A.Rect(u.BA,u.LA,u.XC,u.qC):(u=a.ot(),D(e)&&(e=a.C0(t)),D(i)&&(i=a.S0(n)),s=a._y(e,o).findRow(t),c=a.Yy(i,o).findCol(n),(a=a.s7(e,i,o,r).findCell(t,n))?new A.Rect(a.x-u.x,a.y-u.y,a.width,a.height):s&&c?(e=c.x-u.x,i=s.y-u.y,o=c.width,r=s.height,-1!==c.height&&-1!==c.y&&(r=s.height*c.height,i=s.height*c.y),new A.Rect(e,i,o,r)):new A.Rect)},z.prototype.XA=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,l,c,f,h,l,e,i=this,r=i.rt,o=!1,a=!1,c=i.ui,f=i.ci;D(t)||(i.ui!==t&&(a=!0),u=i.ui,i.ui=t,o=!0),D(n)||(i.ci!==n&&(a=!0),s=i.ci,i.ci=n,o=!0),h=(l=i._1)&&l.isEnable(_.RowColumnStates.active,!0),l=l&&l.isEnable(_.RowColumnStates.active,!1),h&&(i.x_(c,i.R9,i.B9),i.x_(t,i.R9,i.B9)),l&&(i.N_(f,i.R9,i.B9),i.N_(n,i.R9,i.B9)),i.Ut.setCellState(c,f,_.CellStatesType.active,!1,_.SheetArea.viewport),h||l||i.k_&&i.k_(_.CellStatesType.active,c,f,_.SheetArea.viewport),i.Ut.setCellState(t,n,_.CellStatesType.active,!0,_.SheetArea.viewport),h||l||i.k_&&i.k_(_.CellStatesType.active,t,n,_.SheetArea.viewport),!e&&r&&o&&(a&&i.ki(A.Events.ActiveCellChanged,{oldRow:u,oldCol:s,row:i.ui,col:i.ci}),r.aA(),c=i.Ut,(h=(f=i.Uw&&i.Uw(_.SheetArea.viewport))&&f.t8.getAnchorInfo(t,n))!==(l=c.cO))&&(c.cO=h,i.My<=0)&&(e=void 0,e=h&&l?(0,A.getUnionRange)(h,l):(0,A.Ec)((h=h||l).row,h.col,h.rowCount,h.colCount),i.Dn.E1(e))},z.prototype.XL=function(t,n,e,i,r){var t,n,e,i,r,t=t.getCellRect(n,e,i,r),n=t.x,e=t.y,i=t.width,r=t.height;return t.x=n-2,t.y=e-2,t.width=i+4,t.height=r+4,t},z.prototype.O6=function(t,n,e,i,r){var o,a,u,s,c,c,o=this,a=o.ui,u=o.ci,s=o.Ut,c=s.getSpan(t,n);o.H5=c.rowCount,o.z5=c.colCount,o.My<=0&&(c=s.getSpan(a,u),o.Dn.E1((0,A.Ec)(a,u,c.rowCount,c.colCount))),o.R9=e,o.B9=i,o.XA(t,n,r),o.qA=t,o.hR=n},z.prototype.setActiveCell=function(t,n,e,i){this.t4(t,n,e,i,2)},z.prototype.t4=function(t,n,e,i,r){var o,a,u,a,u,r,o=this,a=P(o),u=B(o);t<0?t=0:a<=t&&(t=k(0,a-1)),n<0?n=0:u<=n&&(n=k(0,u-1)),o.IA(),a=2===r?A.hi.A1(o):1===r,o.O6(t,n,e,i,!a),u={sheet:o,sheetName:o.name(),row:t,col:n},r=o.Ut.getSpan(t,n),o.D9(r.row,r.col,r.rowCount,r.colCount),o.zw(),o.ki(A.Events.EnterCellInternal,u)},z.prototype.getActiveRowIndex=function(){return this.ui},z.prototype.getActiveColumnIndex=function(){return this.ci},z.prototype.getRowResizable=function(t,n){return this.Ut.getResizable(!0,n,t)},z.prototype.setRowResizable=function(t,n,e){this.qL(t,n,vt,!0,e)},z.prototype.qL=function(t,n,e,i,r){var o,a,u,s;switch(D(r)&&(r=3),e!==ut&&e!==at||!tt.test(n)||(e=dt),a=(o=this).Ut,e){case vt:u=a.getResizable(i,r,t);break;case"pageBreak":u=a.getPageBreak(i,r,t);break;case ht:u=a.getVisible(i,r,t);break;case ut:case at:u=a.getSize(i,r,t);break;case bt:u=a.getColumnHeaderFitMode(i,r,t)}if(s=!0,!(s=i?o.kj(t,r,e,n,u):o.Dj(t,r,e,n,u)))return s;switch(e){case vt:a.do("setResizable",i,r,t,n);break;case"pageBreak":a.do("setPageBreak",i,r,t,n);break;case ht:a.do("setVisible",i,r,t,n),i&&x&&3===r&&u!==n&&(o.Lp.Vct=4,o.recalcRows([t]),delete o.Lp.Vct);break;case ut:a.do("setSize",i,r,t,n),!x||3!==r||u===n||0!==u&&0!==n||(o.Lp.Vct=4,o.recalcRows([t]),delete o.Lp.Vct);break;case at:a.do("setSize",i,r,t,n);break;case dt:a.do("setStarSize",i,r,t,n);break;case bt:a.do("setColumnHeaderFitMode",i,r,t,n)}return i?o.dj(t,r,e,n,u):o.vj(t,r,e,n,u),!0},z.prototype.getColumnResizable=function(t,n){return this.Ut.getResizable(!1,n,t)},z.prototype.setColumnResizable=function(t,n,e){this.qL(t,n,vt,!1,e)},z.prototype.getRowHeight=function(t,n,e){var i,e,r,o,a,e,u,e,i=this;if(D(n)&&(n=3),e)return i.Ut.getStarSize(!0,n,t);if(3===n||2===n){if(e=i.getRowCount(n),t<0||e<=t)return 0;for(r=i.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return 0}return u=(e=i.defaults).rowHeight,1===n&&(u=e.colHeaderRowHeight),(e=i.Ut.getSize(!0,n,t))||0===e?e:y(u)},z.prototype._o=function(t,n){var e,i,r,i;return D(n)&&(n=3),r=(i=(e=this).defaults).rowHeight,1===n&&(r=i.colHeaderRowHeight),(i=e.Ut.getActualSize(!0,n,t))||0===i?i:y(r)},z.prototype.setRowHeight=function(t,n,e){this.qL(t,n,ut,!0,e)&&(this.Ww=!0,this.zw())},z.prototype.getRowVisible=function(t,n,e){var i,r,o,a,i=this;if(D(n)&&(n=3),!e&&(3===n||2===n))for(r=i.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return!1;return this.Ut.getVisible(!0,n,t)},z.prototype.setRowVisible=function(t,n,e){var i=this;i.qL(t,n,ht,!0,e)&&(i.Ww=!0,i.zw())},z.prototype.getColumnWidth=function(t,n,e){var i,e,r,e,o,a,u,e,i=this;if(D(n)&&(n=3),e)return i.Ut.getStarSize(!1,n,t);if(r=(e=i.defaults).colWidth,2===n&&(r=e.rowHeaderColWidth),3===n||1===n){if(e=i.getColumnCount(n),t<0||e<=t)return 0;for(o=i.nF,a=0;a<o.length;a++)if(!(u=o[a]).tF(t))return 0}return(e=this.Ut.getSize(!1,n,t))||0===e?e:y(r)},z.prototype.Do=function(t,n){var e,i,r,i;return D(n)&&(n=3),r=(i=(e=this).defaults).colWidth,2===n&&(r=i.rowHeaderColWidth),(i=e.Ut.getActualSize(!1,n,t))||0===i?i:y(r)},z.prototype.setColumnWidth=function(t,n,e){this.qL(t,n,at,!1,e)&&(this.Zw=!0,this.zw())},z.prototype.getColumnVisible=function(t,n){var e,i,r,o,e=this;if(3===(n=D(n)?3:n)||1===n)for(i=e.nF,r=0;r<i.length;r++)if(!(o=i[r]).tF(t))return!1;return e.Ut.getVisible(!1,n,t)},z.prototype.setColumnVisible=function(t,n,e){var i=this;i.qL(t,n,ht,!1,e)&&(i.Zw=!0,i.zw())},z.prototype.zoom=function(t){var n,e,n=this;return 0===arguments.length?n.Ut.getZoomFactor():(t=it(t),!m(t)&&isFinite(t)&&(t=A.util.ige(t),e=n.Ut.getZoomFactor(),n.g8(t),n.my=n.my/e*t,n.ly=n.ly/e*t,n.Zw=!0,n.Ww=!0,n.zw()),n)},z.prototype.g8=function(t){this.Ut.do("setZoomFactor",t),z.et(this,R,{changeType:"zoomSheet"})},z.prototype.n3=function(){var t=this;t.eF=N,t.N8={colHeader:N,viewport:N},t.iF={rowHeader:N,viewport:N,colHeader:N}},z.prototype.invalidateLayout=function(){var t,n,n,t,t=this,n=t.rt;t.Ut.hj(),t.n3(),z.et(t,ft,{changeType:"invalidateLayout"}),t.Zw&&(t.aw(),t.Zw=!1),t.Ww&&(t.ew(),t.Ww=!1),t.n3(),z.et(t,R,{changeType:"invalidateLayout"}),n&&n.PA&&A.hi.A1(t)&&!n.M_(t)&&n.PA(t.ui,t.ci),t.k1=!0,(n=t.parent)&&n.options.enableAccessibility&&(t=t.t2(),n.n2(t))},z.prototype.zw=function(){var t=this;t.My<=0&&(t.invalidateLayout(),t.repaint())},z.prototype.getViewportHeight=function(t){var n=this,e=n.Fi();return 0===t?e.L6:1===t?n.Sy(e):2===t?e.Iy:0},z.prototype.getViewportWidth=function(t){var n=this.Fi();return 0===t?n.F6:1===t?this.Gy(n):2===t?n.zy:0},z.prototype.getViewportTopRow=function(t){var n,e,n=this,e=V(n);return 0===t?n.bve||0:1===t?k(e,n.Tb):2===t?k(e,P(n)-U(n)):-1},z.prototype.getViewportTopRowOffset=function(){return this.ly},z.prototype.getViewportBottomRow=function(t){var n,e,i,r,o,a,u,n=this;if(2===t)return P(n)-1;for(e=n.getViewportTopRow(t),i=n.getViewportHeight(t),r=1===t?n.ly:0,o=0,a=P(n)-U(n),0===t&&(a=E(V(n),a)),u=e;u<a&&r<i;u++,o++)r+=n.Gt(u);return e+o-1},z.prototype.H7=function(t){for(var n,e,i,r,n,e=this.dw(t),i=0;i<e.length;i++)if(0<(r=e[i]).height)return r.row;return-1},z.prototype.getViewportLeftColumn=function(t){var n,e,n=this,e=H(n);return 0===t?n.yve||0:1===t?k(e,n.Ab):2===t?k(e,B(n)-G(n)):-1},z.prototype.getViewportLeftColumnOffset=function(){return this.my},z.prototype.getViewportRightColumn=function(t){var n,e,i,r,o,a,u,n=this;if(2===t)return B(n)-1;for(e=n.getViewportLeftColumn(t),i=n.getViewportWidth(t),r=0,o=1===t?n.my:0,a=B(n)-G(n),0===t&&(a=E(H(n),a)),u=e;u<a&&o<i;u++,r++)o+=n.nn(u);return e+r-1},z.prototype.z7=function(t){for(var n,e,i,r,n=this,e=n.getViewportLeftColumn(t),i=n.getViewportRightColumn(t),r=e;r<i+1;r++)if(-1<r&&n.getColumnVisible(r,3)&&0<n.nn(r,3))return r;return-1},z.prototype.showCell=function(t,n,e,i){this.rF(t,n,e,i)},z.prototype.rF=function(t,n,e,i,r,o){var i,i,a,u,s,c,f,l,h,d,v,e,u,s,i,a=this;t<0||t>=P(a)||n<0||n>=B(a)||(u=a.parent&&a.parent.options.scrollByPixel,s=a.parent&&a.parent.options.scrollbarMaxAlign,c=a.S0(n),f=a.C0(t),l=a.getViewportTopRow(f),h=a.ly,d=a.getViewportLeftColumn(c),v=a.my,1===c&&D(o)&&(n=(i=a.rB(n,i,u,s)).col,o=i.offset),1===f&&D(r)&&(t=(i=a.oF(t,e,u,s)).row,r=i.offset),u=e=!1,1!==f||t===l&&r===h||(t=E(t,a.mw().Ky),a.Tb=t,a.ly=r,a.tw(),e=!0),1!==c||n===d&&o===v||(n=E(n,a.Mw().iw),a.Ab=n,a.my=o,a.ow(),u=!0),(e||u)&&((s=a.parent)&&!s.options.scrollbarShowMax&&(a.Zw=!0,a.Ww=!0),a.zw(),i=a.zoom(),e&&a.ki(A.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:l,newTopRow:t,oldOffset:S(h/i),newOffset:S(r/i)}),u)&&a.ki(A.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:d,newLeftCol:n,oldOffset:S(v/i),newOffset:S(o/i)}))},z.prototype.C0=function(t){var n=this;return t<V(n)?0:t>=P(n)-U(n)?2:1},z.prototype.S0=function(t){var n=this;return t<H(n)?0:t>=B(n)-G(n)?2:1},z.prototype.oF=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,i,n,g,p,i,r=this,o=r.Jt,a=r.C0(t),u=r.getViewportTopRow(a),s=r.ly,c=V(r),l=r.P6();if(0===n)if(i){for(h=l,f=r.getViewportHeight(a);c<=h;h--)if((f-=o.Gt(h))<0){t<=h?e||(s=0):(t=h,s=f);break}}else s=0;else if(1===n){if(v=d=!1,i){for(h=l,f=m=y(r.getViewportHeight(a)/2);c<=h;h--)if((f-=o.Gt(h))<0){h<=t&&(h--,f+=m,v=!0);break}if(v)for(;c<=h;h--)if((f-=o.Gt(h))<0){t=h,s=f,d=!0;break}}if(!d){for(f=y((r.getViewportHeight(a)-o.Gt(t))/2);c<t;t--)if((f-=o.Gt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}}else if(2===n){for(f=r.getViewportHeight(a)-o.Gt(t);c<t;t--)if((f-=o.Gt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}else if(3===n)if(u<t){if(i=r.Fi(),n=r.getCellRect(t,r.ci),g=i.c9(1,1),p=i.c9(1,0),i=i.c9(1,2),g.containsRect(n,!0)||p.containsRect(n,!0)||i.containsRect(n,!0))t=u;else for(f=r.getViewportHeight(a)-o.Gt(t);u<t;t--)if((f-=o.Gt(t-1))<0){t-=1,s=f;break}}else s=0;return!e&&s<0&&(s=0,t<l)&&(t+=1),{row:t,offset:s}},z.prototype.rB=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,i,n,g,p,i,b,w,r=this,o=r.Jt,a=r.S0(t),u=r.getViewportLeftColumn(a),s=r.my,c=H(r),l=r.G6();if(0===n)if(i){for(f=r.getViewportWidth(a),h=l;c<=h;h--)if((f-=o.Kt(h))<0){t<=h?e||(s=0):(t=h,s=f);break}}else s=0;else if(1===n){if(v=d=!1,i){for(f=m=y(r.getViewportWidth(a)/2),h=l;c<=h;h--)if((f-=o.Kt(h))<0){h<=t&&(h--,f+=m,v=!0);break}if(v)for(;c<=h;h--)if((f-=o.Kt(h))<0){t=h,s=f,d=!0;break}}if(!d){for(f=y((r.getViewportWidth(a)-o.Kt(t))/2);c<t;t--)if((f-=o.Kt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}}else if(2===n){for(f=r.getViewportWidth(a)-o.Kt(t);c<t;t--)if((f-=o.Kt(t-1))<0){t-=1,s=f;break}0<f&&t===c&&(s=0)}else if(3===n)if(u<t){if(n=(i=r.Fi()).Py,g=i.Cy,p=i.hL,i=i.A6,b=r.getCellRect(r.ui,t),(w=new A.Rect(n,g,p,i)).containsRect(b,!0))t=u;else for(f=r.getViewportWidth(a)-o.Kt(t);u<t;t--)if((f-=o.Kt(t-1))<0){t-=1,s=f;break}}else s=0;return!e&&s<0&&(s=0,t<l)&&(t+=1),{col:t,offset:s}},z.prototype.Jy=function(t,n){var e=this,i=e.Jt,r=e.C0(t),o=e.getViewportTopRow(r),a;if(0!==n)if(1===n)for(a=y((e.getViewportHeight(r)-i.Gt(t))/2);0<t&&!((a-=i.Gt(t-1))<0);t--);else if(2===n)for(a=e.getViewportHeight(r)-i.Gt(t);0<t&&!((a-=i.Gt(t-1))<0);t--);else if(3===n&&!(t<o||-1===o))for(a=e.getViewportHeight(r)-i.Gt(t);o<t&&!((a-=i.Gt(t-1))<0);t--);return t},z.prototype.showColumn=function(t,n){this.showCell(this.Tb,t,0,n)},z.prototype.showRow=function(t,n){this.showCell(t,this.Ab,n,0)},z.prototype.suspendEvent=function(){this.vf++},z.prototype.resumeEvent=function(){this.vf--,this.vf<0&&(this.vf=0)},z.prototype.isEventSuspended=function(){return 0<this.vf},z.prototype.currentTheme=function(t){var n=this;return 0===arguments.length?(n.hl||n.aF(),n.hl):(typeof t==w&&(t=f.Themes[t]||new f.Theme(t)),n.hl=t,n.Dn.O7(),n.r3(),z.et(n,"onThemeChanged",{value:t}),n.zw(),n)},z.prototype.uF=function(){var t=A.I.fl(""),t=C(t.zIndex),n=f.Themes.Office2007;return n=2007<t?f.Themes.Office:n},z.prototype.aF=function(){this.hl=this.uF(),this.r3()},z.prototype.reset=function(){var t=this;t.sF(),t.zw()},z.prototype.sF=function(){var t,n,e,i,r,t=this,n=t.b2();t.cF(),t.R9=0,t.B9=0,t.Zp(),t.eF=N,t.N8={colHeader:N,viewport:N},t.iF={rowHeader:N,viewport:N,colHeader:N},t.Tb=0,t.ly=0,t.Ab=0,t.my=0,t.frozenRowCount(0),t.frozenColumnCount(0),t.frozenTrailingRowCount(0),t.frozenTrailingColumnCount(0),z.et(t,"beforeSetHost"),(e=t.parent)&&(i=e.getActiveSheet(),r=e.getActiveSheetTab(),i&&t.name()===i.name()||r&&t.name()===r.name())&&t.hg(e.Kg),t.r3(),t.Jt=new A.Ff(t),t.Sj={},x&&t.resetCalc(),t.Ut&&t.Ut.L0(!0),t.Ut=new j.Y8(t,z.n8,z.e8,z.o8,z.r8,t.name()),t.defaults=t.Ut.defaults,t.b2(n),t.aF(),t.Hp={},t.Zw=!0,t.Ww=!0,t.parent&&t.parent.sg?t.My=t.parent.sg:t.My=0,t.parent&&t.parent.vf?t.vf=t.parent.vf:t.vf=0,t.lE=0,t.xT=!1,t.fF=N,t.$L=[],t.nF=[],t.Nj=!1,t.hA=_.ClipboardPasteOptions.all,t.lF=_.CopyToOptions.all,t.JT=!0,t.UB=!0,z.et(t,"init")},z.prototype.Zp=function(){var i=this;h(St,function(t,n){var e;D(n)||(e=n,"gridline"===t?e={color:A.I.fl("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof e&&(e=l.GC$.extend({},n)),i.options[t]=e)})},z.prototype.pM=function(t){var n,e,n=this;for(n.parent=t,e=n.My;e<t.sg;e++)n.suspendPaint();n.vf=t.vf,z.et(n,"attach",t)},z.prototype.hF=function(t,n){return t.row===n.row&&t.col===n.col&&t.rowCount===n.rowCount&&t.colCount===n.colCount},z.prototype.dF=function(t,n,e,i,r){for(var o,a,u,o=this.iT(n,e,i,r).ranges,a=0;a<o.length;a++)for(u=0;u<t.length;u++)if(this.hF(t[a],o[u]))return!0;return!1},z.prototype.vF=function(t,n,e,i,r){var o,a,o=!1;return void 0!==r?0===r?0<(a=this.iT(t,n,e,this.getColumnCount()-n).ranges).length&&(o=(o=(o=0<t-1?this.dF(a,t-1,n,1,this.getColumnCount()-n):o)||this.dF(a,t+e,n,1,this.getColumnCount()-n))||this.dF(a,t,n,e,1)):0<(a=this.iT(t,n,this.getRowCount()-t,i).ranges).length&&(o=(o=(o=0<t-1?this.dF(a,t-1,n,this.getRowCount()-t,1):o)||this.dF(a,t+e,n,this.getRowCount()-t,1))||this.dF(a,t,n,1,i)):o=!0,o},z.prototype.PT=function(t,n,e,i,r){var o,a,u,s,c,f,r,l,s,o=r.invalidType,a=r.lockErrorMsg,u=r.arrayFormulaErrorMsg,s=r.isAllowDragInsert,c=r.shiftCells,f=r.isIgnoreFilterOutRow,r=r.sheetArea,l=this;return D(o)&&(o=1),!s&&l.isActualProtected()&&l.dA((0,A.Ec)(t,n,e,i),f,r)?(a&&l.jT(o,a),!1):(s=this.vF(t,n,e,i,c),!(x&&s&&!l.mT(t,n,e,i)&&(u&&l.jT(o,u),1)))},z.prototype.clear=function(t,n,e,i,r,o,a,u,s){0!==r&&this.KI(t,n,e,i,r,o,a,u,s)},z.prototype.KI=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,f=this,l=x;try{if(l&&f.suspendCalcService(),f.suspendPaint(),h=f.defaults,p=3,b={changeType:"clear",row:t,col:n,rowCount:e,colCount:i,sheetArea:r,type:o,ignoreTable:u,ignorePivotTable:s,canClear:!(g=m=v=d=void 0)},z.et(f,R,b),b.canClear){if(D(r)||3===r){if(l&&!f.mT(t,n,e,i))return!1;if(1&o&&f.getDataSource&&f.getDataSource()){for(f.suspendEvent(),d=t;d<t+e;d++)if(!(a&&f.XT&&f.XT(d)))for(v=n;v<n+i;v++)f.setValue(d,v,N,r);f.resumeEvent()}}if(w=f.Ut,y=l&&f.b3(),d=-1===t?0:t,M=-1===t?w.getRowCount(r):e,v=-1===n?0:n,C=-1===n?w.getColumnCount(r):i,S=[],a&&f.XT)for(T=d;T<M+d;T++)f.XT(T)&&S.push(T);if(w.do("clear",d,v,M,C,o,S,r),y&&1&o&&!c&&(y.mF(d,v,M,C,!0),y.clear(d,v,M,C,w.pj(),!0)),8&o&&!(0<=t&&0<=n))if(0<=n)for(g=0;g<C;g++)f.setTag(-1,v+g,N,r);else if(0<=t)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||f.setTag(d+m,-1,N,r);else f.setTag(-1,-1,N,r);if(256&o&&!(0<=t&&0<=n))if(0<=n)for(g=0;g<C;g++)f.setHyperlink(-1,v+g,N,r);else if(0<=t)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||f.setHyperlink(-1,-1,N);if(2&o&&!(0<=t&&0<=n))if(0<=n)for(g=0;g<C;g++)f.setStyle(-1,v+g,N,r);else if(0<=t)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||f.setStyle(d+m,-1,N,r);else f.setStyle(-1,-1,N,r);if(32&o){if(t<0)for(g=0;g<C;g++)f.setColumnVisible(v+g,!0,r),f.setColumnResizable(v+g,!0,r),f.setColumnWidth(v+g,2===r?h.rowHeaderColWidth:h.colWidth,r);if(n<0)for(m=0;m<M;m++)a&&f.XT&&f.XT(d+m)||(f.setRowVisible(d+m,!0,r),f.setRowResizable(d+m,!0,r),f.setRowHeight(d+m,1===r?h.colHeaderRowHeight:h.rowHeight,r))}for((D(r)||3===r)&&l&&1==(1&o)&&(A=f.b3())&&A.gF(t,n,e,i),I=[],m=0;m<M;m++)for(g=0;g<C;g++)I.push({row:d+m,col:v+g});f.SI(t,n,M,C,I,2,r)}}finally{f.resumePaint(),l&&f.resumeCalcService(!1)}},z.prototype.uL=function(){var t,n,e,i,e,i,e,t=this,n,e=t.options.protectionOptions;t.isActualProtected()&&e&&(i=e.allowSelectLockedCells,e=e.allowSelectUnlockedCells,!1===i&&!1!==e||!1!==i&&!1===e)&&(i=t.ui,e=t.ci,t.JA(i,e)||(t.IA(),t.gA(i,e,!0),t.MA(4,i,e)))},z.prototype.setArray=function(i,r,t,o){var a,n,u,s,c,f,a=this,n=x;if(o=n&&o,u=P(a),s=B(a),t&&0<=i&&i<u&&0<=r&&r<s){n&&a.suspendCalcService(),a.suspendPaint();try{h(t,function(e,t){l.GC$.isArray(t)?h(t,function(t,n){f=r+t,(c=i+e)<u&&f<s&&(o?a.setFormula(c,f,n):a.setValue(c,f,n,3))}):(f=r,(c=i+e)<u&&f<s&&(o?a.setFormula(c,f,t):a.setValue(c,f,t,3)))})}finally{n&&a.resumeCalcService(!1),a.resumePaint()}}},z.prototype.getArray=function(t,n,e,i,r){var o,a,u,s,c,f,o=this,a=[],u=P(o),s=B(o);if(r=r&&x,0<=t&&t<u&&0<=n&&n<s)for(u<t+e&&(e=u-t),s<n+i&&(i=s-n),c=0;c<e;c++)for(a[c]=[],f=0;f<i;f++)a[c][f]=r?o.getFormula(t+c,n+f):o.getValue(t+c,n+f);return a},z.prototype.setTag=function(t,n,e,i){var r,o,a,u,a,u,r=this;0!==(i=D(i)?3:i)&&(a=(o=r.Ut).getRowCount(i),u=o.getColumnCount(i),t<-1||a<=t||n<-1||u<=n||(e=$(e),a=void 0,(u=0<r.vf)||(a=r.getTag(t,n,i)),o.do("setValueForKey",t,n,s,e,i),a!==e&&(-1!==t&&-1!==n?u?r.Lj(r,[{row:t,col:n}],0):r.Rj(s,t,n,i,a,e):-1!==t&&-1===n?r.dj(t,i,s,e,a):-1===t&&-1!==n&&r.vj(n,i,s,e,a))))},z.prototype.getTag=function(t,n,e){var i,i,i=this;return 0!==(e=D(e)?3:e)?(i=i.Ut.getValueForKey(t,n,s,e),d(i)):N},z.prototype.tag=function(t){var n,e,n=this;return 0===arguments.length?(e=n.Ut.getValueForKey(-1,-1,s,3),d(e)):(n.Ut.do("setValueForKey",-1,-1,s,$(t),3),n)},z.prototype.setAltText=function(t,n,e,i){var r,o,a,u,a,u,r=this;0!==(i=D(i)?3:i)&&(a=(o=r.Ut).getRowCount(i),u=o.getColumnCount(i),t<-1||a<=t||n<-1||u<=n||(a=void 0,(u=0<r.vf)||(a=r.getAltText(t,n,i)),o.do("setValueForKey",t,n,ct,e,i),a!==e&&-1!==t&&-1!==n&&(u?r.Lj(r,[{row:t,col:n}],0):r.Rj(ct,t,n,i,a,e))))},z.prototype.getAltText=function(t,n,e){var i=this;return 0!==(e=D(e)?3:e)?i.Ut.getValueForKey(t,n,ct,e):N},z.prototype.getParent=function(){return this.parent},z.prototype.getDirtyRows=function(){return It(this,!0)},z.prototype.getInsertRows=function(){return It(this,!1)},z.prototype.getDeletedRows=function(){var e=[],t=this.aj;return t&&h(t,function(t,n){n&&!l.GC$.isFunction(n)&&e.push({row:n.row,originalItem:n.data})}),e},z.prototype.hasPendingChanges=function(){var t,n,e,t=this,n=t.aj;return!!(n&&0<n.length)||!Lt(e=t.Ut.Fj())},z.prototype.clearPendingChanges=function(t){var n,e,i,r,o,t,n=this;D(t)||X(t)?(n.Ut.Hj(),n.aj=[],z.et(n,"clearPendingChanges")):(e=t.row,i=t.col,r=t.rowCount,o=t.colCount,(1&(t=(t=t.clearType)||Mt.dirty))===Mt.dirty&&n.pF(e,i,r,o),(2&t)===Mt.insert&&n.bF(e,i,r,o),(4&t)===Mt.delete&&n.yF(e,i,r,o))},z.prototype.pF=function(t,n,e,i){var r=this,o=r.Ut,a=r.wF(t,n,e,i),u=r.MF(n,i);a?(o.Qj(),z.et(r,"clearPendingChanges")):o.Vj(u,t,n,e,i)},z.prototype.bF=function(t,n,e,i){var r=this,o=r.Ut,a=r.wF(t,n,e,i),r=r.MF(n,i);o.zj(a,r,t,e)},z.prototype.yF=function(e,t,i,n){var r,t,o,a,u,r=this;if(r.wF(e,t,i,n))r.aj=[];else if(r.MF(t,n)&&(t=r.aj))for(o=[],h(t,function(t,n){var n;n&&(n=n.row,e<=n)&&n<e+i&&o.push(t)}),u=(a=o.length)-1;0<=u;u--)r.aj.splice(o[u],1)},z.prototype.MF=function(t,n){return D(t)||-1===t||0===t&&this.getColumnCount()===n},z.prototype.SF=function(t,n){return D(t)||-1===t||0===t&&n===this.getRowCount()},z.prototype.wF=function(t,n,e,i){return this.MF(t,e)&&this.MF(n,i)},z.prototype.getDirtyCells=function(t,r,n,o){var a,u,s,e,i,c,f,l,a=this;if(D(t)&&(t=-1),D(r)&&(r=-1),(D(n)||n<=0)&&(n=1),(D(o)||o<=0)&&(o=1),u=[],s=a.Ut.Fj(),!X(s)){if(e=[],0<=t)for(i=t;i<t+n;i++)e.push(i);else for(c in s)q(s,c)&&e.push(C(c));h(e,function(t,n){var e,i;if((f=s[n])&&"e"===f.rs)if(0<=r)for(e=r;e<r+o;e++)(l=f[e])&&u.push(Rt(a,n,e,l.oldValue));else for(i in f)m(i)||(l=f[i])&&u.push(Rt(a,n,C(i),l.oldValue))})}return u},z.prototype.suspendDirty=function(){this.lE++,this.Ut.Kj()},z.prototype.resumeDirty=function(){var t=this;t.lE--,t.lE<0&&(t.lE=0),t.Ut.Jj()},z.prototype.isDirtySuspended=function(){return 0<this.lE},z.prototype.Hc=function(t){this.cg(new A.Rect(0,0,0,0)),this.sF(),this.ub(t)},z.prototype.TF=function(){return this},z.prototype.uw=function(){var t,n,e,n,t,n=this.Dg(),e={top:0,left:0};return n&&n.parentElement&&(e=(0,l.GC$)(n).offset())&&(e.top+=et.body.clientTop||0,e.left+=et.body.clientLeft||0),e=(n=n&&n.canvasOffset)?n:e},z.prototype.hg=function(t){var n,e,i,r,o;t&&((n=this).xT=!1,(e=n.fg)&&n.L0(!1),i=W("canvas"),o=(r=n.parent&&n.parent.options.enableAccessibility)?"":g().NeedCanvasSupport,(0,l.GC$)(i).attr("id",t.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(o).appendTo(t),A.Bf.Wl(i,N,n),n.fg=i,n.Cg(),n.repaint(),n.parent&&n.parent.nb(),z.et(n,"setHost",(0,l.GC$)(i)))},z.prototype.AF=function(t,e,n,i,r,o,a,u,s){for(var c,f,l,h,d,v,c=this,f=c.getActiveRowIndex(),l=c.getActiveColumnIndex(),h=function(t,n){return f===e&&n===l?c._ue(t):t},d=n;d<i;d++)v=h(c.getText(e,d,s),d),t.push('"'+v+'"');for(d=r;d<o;d++)v=h(c.getText(e,d,s),d),t.push('"'+v+'"');for(d=a;d<u;d++)v=h(c.getText(e,d,s),d),t.push('"'+v+'"')},z.prototype.t2=function(t){var n,e,i,r,t,o,a,u,s,n=this,e=n.ui,i=n.ci,r=_.SheetArea.viewport;return!t||D(t.row)||D(t.col)||(e=t.row,i=t.col,r=t.hitTestType),t=g(),o="",a=n.getText(e,i,r),r===_.SheetArea.rowHeader?o=t.ARIA_RowHeader+" ":r===_.SheetArea.colHeader?o=t.ARIA_ColumnHeader+" ":!D(r)&&r!==_.SheetArea.viewport||(u=n.getFormula(e,i),s=n.comments&&n.comments.get(e,i)),o+n.N6(e,i,r,a,u,s&&s.text())},z.prototype.N6=function(t,n,e,i,r,o){var a,u,s,c,f,l,f,i,s,a=g(),u=a.ARIA_Cell+" "+A.util.Vf(n+1)+(t+1)+" ",s=this.getAltText(t,n,e);return s?(0<=s.indexOf(c="{value}")&&((f=this.getValue(t,n,e))instanceof Date&&(f=f.toLocaleString()),s=s.replace(/\{value\}/g,f)),u+=s=0<=s.indexOf(l="{formatted}")?s.replace(/\{formatted\}/g,i):s):(f="",D(i)||""===i||(f=v.I5(a.ARIA_HasValue,[i])+", "),s=void 0,(i=this.l0(t,n,"cellType",e))&&("5"===i.typeName?(s=i.SG(this.getValue(t,n,e)),f=v.I5(a.ARIA_HasCheckbox,[s])+", "):"6"===i.typeName?(s=i.text(),f=v.I5(a.ARIA_HasButton,[s])+", "):"8"===i.typeName&&(s=i.text(),f=v.I5(a.ARIA_HasHyperlink,[s])+", ")),u+=f,D(r)||(u+=v.I5(a.ARIA_HasFormula,[r])+", "),D(o)||(u+=v.I5(a.ARIA_HasComment,[o]))),this._ue(u)},z.prototype._ue=function(t){return this.Eue&&(t=this.Eue+" "+t),t=this.jue?t+" "+this.jue:t},z.prototype.setAccessibilityPrefixSuffixContent=function(t,n){this.Eue=t,this.jue=n},z.prototype.Cg=function(){var t,n,e,i,e,r,r,i,e,r,t=this,n=t.Dg();n&&n.parentNode&&(i=(e=getComputedStyle(n.parentNode)).width,e=e.height,0<(r=i.indexOf("px"))&&(i=i.substring(0,r)),0<(r=e.indexOf("px"))&&(e=e.substring(0,r)),r=C(i),i=C(e),m(r)&&(r=(0,l.GC$)(n.parentNode).width()),m(i)&&(i=(0,l.GC$)(n.parentNode).height()),0!==r)&&0!==i&&(e=k(r,0),r=k(i,0),n.style.display="none",n.style.display="",n.width=e,n.height=r,n.style.width=e+"px",n.style.height=r+"px",e=n.clientWidth||n.width,r=n.clientHeight||n.height,t.kg.width=e,t.kg.height=r,A.Bf.$l(n,e,r),t.invalidateLayout())},z.prototype.destroy=function(){this.L0(!0)},z.prototype.L0=function(t,n){var e,n,i,i,e=this;!0!==e.xT&&(A.Bf.eh(e),e.isEditing&&e.isEditing()&&e.l6(e.ui,e.ci,_.SheetArea.viewport,void 0,void 0,void 0,void 0,!1),z.et(e,"dispose",{clearCache:t,isSheetDestroy:!0,hasActiveSheet:n}),(n=e.fg)&&((i=n.parentNode)&&i.removeChild(n),A.Lf.d5(n),e.fg=N),e.NF(),e.Ut&&e.Ut.L0(t),!1!==t)&&(e.xT=!0,(i=e.lA)&&i.L0(),e.parent=N,e.Ut=N,e.Jt&&(e.Jt.L0(),e.Jt=N),e.MC&&(e.MC.L0(),e.MC=N),A.hi.A1(e)&&A.hi.F1(N,!0),e.bM&&(e.bM.c5(),e.bM=N),e.$L=N,e.nF=N)},z.prototype.NF=function(){var t=this.kF;t&&((0,l.GC$)(t).remove(),this.kF=O)},z.prototype.mL=function(t,n,e,i,r){var o,a,u,s,s,s,c,f,c,l,s,f,i,f,o,f,i,o=this,a=o.options,u=o.Ut;return 0===e||3===(e=D(e)?3:e)&&this.S6&&(s=(s=this.Uw&&this.Uw(e))&&s.t8.getAnchorInfo(t,n))&&s.isValid&&(t!==s.row||n!==s.col)?N:(this.loading||(s=x&&this.b3(e))&&(c=s.getCalcService()).calcOnDemand&&!c.IsSuspended()&&0===c.calculationMode&&(f=s.oT(t,n))&&!0===f.k1&&(c.b_t(f,0),s.recalculateCell(f),this.Uw()._F()),c=u.getValue(t,n,e,this.loading,i),c=d(c),1===e?(s=u.getRowCount(e),D(c)&&((f=o.H3)&&f._dataSource&&(i=o.Ut.q_(!1,3,n),f=a.colHeaderAutoTextIndex,i)&&(0<=f&&t===f||-1===f&&t===s-1)&&(c=i.displayName||i.name),D(c))&&t===(l=(l=a.colHeaderAutoTextIndex)<0||s<=l?s-1:l)&&(2===(o=a.colHeaderAutoText)?c=A.util.Vf(n+1):1===o&&(c=n+1))):2===e&&D(c)&&(f=u.getColumnCount(e),n===(l=(l=a.rowHeaderAutoTextIndex)<0||f<=l?f-1:l))&&(2===(i=a.rowHeaderAutoText)?c=A.util.Vf(t+1):1===i&&(c=t+1)),!r&&"number"==typeof c&&p&&p.ExcelCompatibleCalcMode?b.Common.st.E8(c,15):c)},z.prototype.JS=function(t,n){var e,i,r,o,a,t,u,i;return D(n)&&(n=3),e=(0,A.Ec)(-1,-1,-1,-1),t&&(r=t.row,o=t.col,a=t.rowCount,t=t.colCount,u=(i=this).getRowCount(n),i=i.getColumnCount(n),-1===o&&(o=0,t=i),-1===r&&(r=0,a=u),e.col=o,e.row=r,e.colCount=E(k(i-o,0),t),e.rowCount=E(k(u-r,0),a)),e},z.prototype.getRangeRect=function(t,n,e){var i,r,o,a,u,s,e,c,f,l,h,e,d,v,m,g,p,b,w,y,i=new A.Rect(-1,-1,-1,-1),r=this,o=r.Fi(),a=r.C6(t,n);return 0!==o.width&&0!==o.height&&(u=r._y(t,a),(s=r.Yy(n,a))&&0!==s.length&&u&&0!==u.length)&&(e=r.JS(e),c=r.Jt,f=e.row,l=e.row+e.rowCount-1,h=e.col,e=e.col+e.colCount-1,d=V(r),v=P(r)-U(r)-1,m=H(r),g=B(r)-G(r)-1,p=s[0].col,b=s[s.length-1].col,w=u[0].row,y=u[u.length-1].row,h<p&&(h=M(p,h)),b<e&&(e=C(b,e)),f<w&&(f=S(w,f)),y<l&&(l=T(y,l)),e<h||l<f||(0===n?h<m&&(i.x=o.b6+F(c,r.wve(),h-1),i.width=F(c,h,e)):1===n||-1===n?h<=g&&m<=e&&(i.x=h<p?s[0].x-F(c,h,p-1,a):s[0].x+F(c,p,h-1,a),i.width=F(c,h,e,a)):2===n&&g<e&&(i.x=h<p?o.Hy-F(c,h,p-1):o.Hy+F(c,p,h-1),i.width=F(c,h,e)),0===t?f<d&&(i.y=o.T6+L(c,r.Mve(),f-1),i.height=L(c,f,l)):1===t||-1===t?f<=v&&d<=l&&(i.y=f<w?u[0].y-L(c,f,w-1,a):u[0].y+L(c,w,f-1,a),i.height=L(c,f,l,a)):2===t&&v<l&&(i.y=f<w?o.Ay-L(c,f,w-1):o.Ay+L(c,w,f-1),i.height=L(c,f,l)))),i;function M(t,n){for(;n<t;)if(r.getColumnVisible(--t))return t;return t}function C(t,n){for(;t<n;)if(r.getColumnVisible(++t))return t;return t}function S(t,n){for(;n<t;)if(r.getRowVisible(--t))return t;return t}function T(t,n){for(;t<n;)if(r.getRowVisible(++t))return t;return t}},z.prototype.isIntersectWithArrayFormula=function(t){var n,e,i,n=x&&this.b3();if(n)for(e=t.row;e<t.row+t.rowCount;e++)for(i=t.col;i<t.col+t.colCount;i++)if(n.EF(e,i,1,1))return!0;return!1},z.prototype.setRangeActiveCells=function(t,n){this.XA(t,n),this.repaint()},z.prototype.j1=function(t,n){var e,i,r,t,o,a,u,s,c,f,l,h,t,d,v,m,g,e=this,i=new A.Rect(-1,-1,-1,-1),r=e.Fi();if(0!==r.width&&0!==r.height){if(t=e.JS(t,n),o=H(e),a=V(e),u=G(e),s=U(e),c=e.Jt,f=t.row,l=t.row+t.rowCount-1,h=t.col,t=t.col+t.colCount-1,d=P(e,n),v=B(e,n),h<o)i.x=r.b6+F(c,e.wve(),h-1,n),i.width=F(c,h,E(t,o-1),n),o<=t&&t<v-u?(m=e.yw(1))&&0<m.length&&(i.width+=F(c,m[0].col,E(t,m[m.length-1].col),n)+e.my):v-u<=t&&(m=e.yw(2))&&0<m.length&&(i.width=m[0].x-i.x,i.width+=F(c,v-u,E(t,v-1),n));else if(h<v-u){if(!(m=e.yw(1))||0===m.length||h>m[m.length-1].col||t<m[0].col)return i;i.x=r.Py+F(c,m[0].col,h-1,n)+e.my,o<=t&&t<v-u?i.width=F(c,k(h,m[0].col),E(t,m[m.length-1].col),n):v-u<=t&&(m=e.yw(2))&&0<m.length&&(i.width=m[0].x-i.x,i.width+=F(c,v-u,E(t,v-1),n))}else h<v&&(m=e.yw(2))&&0<m.length&&(i.x=r.Hy+F(c,m[0].col,h-1,n),i.width=F(c,h,E(t,v-1),n));if(f<a)i.y=r.T6+L(c,e.Mve(),f-1,n),i.height=L(c,f,E(l,a-1),n),a<=l&&l<d-s?(g=e.dw(1))&&0<g.length&&(i.height+=L(c,g[0].row,E(l,g[g.length-1].row),n)+e.ly):d-s<=l&&(g=e.dw(2))&&0<g.length&&(i.height=g[0].y-i.y,i.height+=L(c,d-s,E(l,d-1),n));else if(f<d-s){if(!(g=e.dw(1))||0===g.length||f>g[g.length-1].row||l<g[0].row)return i;i.y=r.Cy+L(c,g[0].row,f-1,n)+e.ly,a<=l&&l<d-s?i.height=L(c,k(f,g[0].row),E(l,g[g.length-1].row),n):d-s<=l&&(g=e.dw(2))&&0<g.length&&(i.height=g[0].y-i.y,i.height+=L(c,d-s,E(l,d-1),n))}else f<d&&(g=e.dw(2))&&0<g.length&&(i.y=r.Ay+L(c,g[0].row,f-1,n),i.height+=L(c,f,E(l,d-1),n))}return i},z.prototype.Dg=function(){return this.fg},z.prototype.Gi=function(t,n){return this.Qt(t,n)+1},z.prototype.Qt=function(t,n){var e="",i=this.Dn,e=n||i._n(i.Nn());return A.q.Wt(t,e)},z.prototype.PL=function(t){var n,e,i,r,n,o,a,n=this,e=n.Fi(),i=N,r=e.Py,n=n.Gy(e),o=e.Hy,a=e.zy;return e.BA<t&&t<e.BA+e.XC?i=-1:e.b6<t&&t<e.b6+e.F6?i=0:r<t&&t<r+n?i=1:o<t&&t<o+a&&(i=2),i},z.prototype.FL=function(t){var n,e,i,r,n,o,a,n=this,e=n.Fi(),i=N,r=e.Cy,n=n.Sy(e),o=e.Ay,a=e.Iy;return e.LA<t&&t<e.LA+e.qC?i=-1:e.T6<t&&t<e.T6+e.L6?i=0:r<t&&t<r+n?i=1:o<t&&t<o+a&&(i=2),i},z.prototype.GL=function(t,n){var n,n,n=-1===n?this.jF():this.dw(n);if(n&&(n=n.findY(t)))return n.row},z.prototype.UL=function(t,n,e,i,r){var n,o,a,n=-1===n?this.OF():-1===i?this.BF(n):this.yw(n);if(n)return a=void 0,(a=-1!==i||D(r)?n.findX(t):(o=this.jF().findRow(r),n.findXByExactY(t,e,o)))||n[0]&&(a=(n=this.Dn.VO(n[0].col,n[0].x))?-1!==i||D(r)?n.findX(t):n.findXByExactY(t,e,o):a)?a.col:void 0},z.prototype.pD=function(t,n){var e,i,t,r,r,o,t,n,e=t.YL;return e!==t.col||(r=t.colViewportIndex,o=t.y,t=t.row,r=(i=this).BF(r),t=this.jF().findRow(t),n===e&&(e=i.O5(e,1)),(n=r.findCol(e))&&o<n.y*t.height+t.y)},z.prototype.HO=function(t,n){var e=this;return e.ui<=t&&t<e.ui+e.H5&&e.ci<=n&&n<e.ci+e.z5},z.prototype.T9=function(t){return this.Ut.T9(t)},z.prototype.S9=function(t){return this.Ut.S9(t)},z.prototype.ni=function(t,n,e,i){var r,o,r,r=this,o=P(r),r=B(r);return this.Ut.ni(t,n,e,o,r,i)},z.prototype.ei=function(t,n,e){var i,r,i,i=this,r=P(i),i=B(i);return this.Ut.ei(t,n,e,r,i)},z.prototype.zO=function(t,n,e){var i,r,o,a,u,s,c,u,i=this,u=i.sw;if(u&&!u.resizeInfo&&!D(e)){if(s=u.hitTestType,c=u.row,u=u.col,1===e)return r=!1,(o=!(o=i.Ut.findSpan(c,u,1))&&i.Cb?i.Cb.D7(c,u,1):o)&&(r=o.contains(t,n,1,1)),a=t===c&&n===u||r,s===e&&a;if(2===e)return r=!1,(o=!(o=i.Ut.findSpan(c,u,2))&&i.Cb?i.Cb.D7(c,u,2):o)&&(r=o.contains(t,n,1,1)),a=t===c&&n===u||r,s===e&&a;if(3===e)return s===e&&t===c&&n===u;if(0===e)return s===e}return!1},z.prototype.C6=function(t,n){return 0<=t&&t<=2&&0<=n?3:0<=t&&t<=2&&n<0?2:t<0&&0<=n?1:t<0&&n<0?0:N},z.prototype.Zg=function(t){var n=this.rt;n&&n.Zg(t)},z.prototype.qc=function(){var t,n,n,t,t=this,n=t.parent,n=n&&n.Ti;return n=n||(t=t.fg)&&t.parentElement},z.prototype.cF=function(){var t,n,e,i,r,t=this,n=0,e=0,i=1,r=1;t.ui=0,t.ci=0,t.H5=1,t.z5=1,t.qA=0,t.hR=0},z.prototype.Gt=function(t,n,e){!D(n)&&isNaN(n)&&(n=O);var i=this,t=i.getRowHeight(t,n),n=i.zoom();return 1!==n&&(t*=n),e?t:rt(t)},z.prototype.nn=function(t,n,e){!D(n)&&isNaN(n)&&(n=O);var i=this,t=i.getColumnWidth(t,n),n=i.zoom();return 1!==n&&(t*=n),e?t:rt(t)},z.prototype.LF=function(){var i,t,n,e,r,e,o,a,t,r,u,e,s,c,f,l,h,d,v,e,n,m,g,e,p,b,n,i=this,t=i.ot(),n=i.options,e=n.sheetAreaOffset.left,r=n.sheetAreaOffset.top,e=new A.Rect(t.x+e,t.y+r,k(0,t.width-e),k(0,t.height-r)),o=e.width,a=e.height,t=xt(i),r=Nt(i),u={x:e.x,y:e.y,width:e.width,height:e.height,XC:0,qC:0,F6:0,L6:0,zy:0,Iy:0,D6:0,FF:0,PF:0,GF:0,b6:0,T6:0,Hy:0,Ay:0,Py:0,Cy:0,A6:0,hL:0,J7:0,X7:0,Ty:0,Uy:0,BA:0,LA:0,R1:function(){var t=this;return new A.Rect(t.x,t.y,t.XC,t.qC)},L1:function(t){var n=this;return 0===t?new A.Rect(n.b6,n.y,n.F6,n.qC):1===t?new A.Rect(n.Py,n.y,i.Gy(n),n.qC):2===t?new A.Rect(n.Hy,n.y,n.zy,n.qC):N},B1:function(t){var n=this;return 0===t?new A.Rect(n.x,n.T6,n.XC,n.L6):1===t?new A.Rect(n.x,n.Cy,n.XC,i.Sy(n)):2===t?new A.Rect(n.x,n.Ay,n.XC,n.Iy):N},c9:function(t,n){var e=this;if(0===t){if(0===n)return new A.Rect(e.b6,e.T6,e.F6,e.L6);if(1===n)return new A.Rect(e.Py,e.T6,i.Gy(e),e.L6);if(2===n)return new A.Rect(e.Hy,e.T6,e.zy,e.L6)}else if(1===t){if(0===n)return new A.Rect(e.b6,e.Cy,e.F6,i.Sy(e));if(1===n)return new A.Rect(e.Py,e.Cy,i.Gy(e),i.Sy(e));if(2===n)return new A.Rect(e.Hy,e.Cy,e.zy,i.Sy(e))}else if(2===t){if(0===n)return new A.Rect(e.b6,e.Ay,e.F6,e.Iy);if(1===n)return new A.Rect(e.Py,e.Ay,i.Gy(e),e.Iy);if(2===n)return new A.Rect(e.Hy,e.Ay,e.zy,e.Iy)}return N}};if(i.gj&&((s=0)<(e=i.gj()).width&&(u.x+=e.width+0,o-=e.width+0),0<e.height)&&(u.y+=e.height+0,a-=e.height+0),n.rowHeaderVisible)for(h=i.getColumnCount(2),l=0;l<h;l++)u.XC+=i.nn(l,2);if(n.colHeaderVisible)for(f=i.getRowCount(1),c=0;c<f;c++)u.qC+=i.Gt(c,1);if(0<(d=H(i)))for(h=B(i),l=i.wve();l<d&&l<h;l++)i.getColumnVisible(l)&&(u.F6+=i.nn(l));if(0<(v=V(i)))for(f=P(i),c=i.Mve();c<v&&c<f;c++)i.getRowVisible(c)&&(u.L6+=i.Gt(c));if(0<(e=G(i)))for(h=B(i),l=k(d,h-e);l<h;l++)u.zy+=i.nn(l);if(0<(n=U(i)))for(f=P(i),c=k(v,f-n);c<f;c++)u.Iy+=i.Gt(c);if(u.BA=u.x,u.LA=u.y,u.b6=u.BA+u.XC,u.T6=u.LA+u.qC,u.Py=u.b6+u.F6,u.Cy=u.T6+u.L6,o=(o=o-u.XC-u.F6)-u.zy-u.Uy,a=(a=(a-=u.qC)-u.L6-u.Iy)-u.Ty-u.D6,f=P(i),(m=0)<(g=(h=B(i))-e))for(m+=i.my,l=k(d,i.Ab);l<g&&m<o;l++)m+=i.nn(l);if(m<(e=k(0,o))?(u.Uy=e-m,e=u.hL=m):u.hL=e,(p=0)<(b=f-n))for(p+=i.ly,c=k(v,i.Tb);c<b&&p<a;c++)p+=i.Gt(c);return p<(n=k(0,a))?(u.Ty=n-p,n=u.A6=p):u.A6=n,u.Hy=u.Py+e,u.Ay=u.Cy+n,r?(u.J7=u.Py+u.hL,u.Hy+=u.Uy):u.J7=u.Hy+u.zy,t?(u.X7=u.Cy+u.A6,u.Ay+=u.Ty):u.X7=u.Ay+u.Iy,u.PF=u.BA,u.GF=u.y+u.height-u.D6,u},z.prototype.Fi=function(){var t=this;return t.eF||(t.eF=t.LF()),t.eF},z.prototype.Yy=function(t,n){return D(n)||3===n?this.yw(t):2===n?this.OF():1===n?1!==this.getRowCount(_.SheetArea.colHeader)?this.yw(t):this.BF(t):N},z.prototype.yfe=function(t,n){return D(n)||3===n?this.yw(t):2===n?this.OF():1===n?1!==this.getRowCount(_.SheetArea.colHeader)?this.yw(t):this.wfe(t):N},z.prototype.OF=function(){var t=this;return t.iF.rowHeader||(t.iF.rowHeader=t.UF()),t.iF.rowHeader},z.prototype.yw=function(t){var n=this;return n.iF.viewport||(n.iF.viewport={}),n.iF.viewport[t]||(n.iF.viewport[t]=n.HF(t)),n.iF.viewport[t]},z.prototype.BF=function(t){var n=this;return n.iF.colHeader||(n.iF.colHeader={}),n.iF.colHeader[t]||(n.iF.colHeader[t]=n.zF(t)),n.iF.colHeader[t]},z.prototype.wfe=function(t){var n=this;return n.iF.colHeaderWithStack||(n.iF.colHeaderWithStack={}),n.iF.colHeaderWithStack[t]||(n.iF.colHeaderWithStack[t]=n.Mfe(t)),n.iF.colHeaderWithStack[t]},z.prototype.UF=function(){for(var t,n,e,i,r,o,t=new j.h9,n,e=this.Fi().BA,r=this.getColumnCount(2),o=0;o<r;o++)i=this.nn(o,2),t.push(new j.W8(-1,o,e,-1,i,-1)),e+=i;return t},z.prototype.HF=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=this,e=new j.h9,i=n.Fi(),r=B(n),s=n.Jt,c=H(n),f=G(n);if(0===t)for(a=i.b6,r=E(c,r),o=n.wve();o<r;o++)u=s.Kt(o),(l=new j.W8(-1,o,a,-1,u,-1)).offsetX=n.getColumnScrollOffsetX(o),e.push(l),a+=u;else if(1===t)for(h=Nt(n),d=n.my,a=i.Py+d,r=h?r-f:r+f,v=n.Gy(i)-d,o=m=k(c,n.Ab);0<v&&o<r;o++)u=s.Kt(o),(l=new j.W8(-1,o,a,-1,u,-1)).offsetX=n.getColumnScrollOffsetX(o),e.push(l),a+=u,v-=u;else if(2===t)for(a=i.Hy,o=k(c,r-f);o<r;o++)u=s.Kt(o),(l=new j.W8(-1,o,a,-1,u,-1)).offsetX=n.getColumnScrollOffsetX(o),e.push(l),a+=u;return e},z.prototype.zF=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,p,n=this,e=new j.h9,i=n.Fi(),r=B(n),s=n.Jt,c=H(n),f=G(n),l=n.Ut,h=[],d=[],v=[],m=[];if(0===t)for(a=i.b6,r=E(c,r),o=n.wve();o<r;o++)h[o]=u=s.Kt(o),d[o]=l.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,o),v[o]=l.eE(-1,o,-1,1,_.SheetArea.colHeader),g=n.ZO(o,a,r,0,h,d,v,m),m[o]=g,e.push(g),a+=u;else if(1===t){for(p=Nt(n),b=n.my,a=i.Py+b,r=p?r-f:r+f,w=n.Gy(i)-b,C=void 0,S=(M=y=k(c,n.Ab))-1;0<=S;S--)if(h[S]=C=s.Kt(S),C){if(d[S]=l.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,S),d[S]===_.ColumnHeaderFitMode.normal)break;M=S}for(o=M;0<w&&o<r;o++)h[o]||(h[o]=s.Kt(o)),D(d[o])&&(d[o]=l.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,o)),u=h[o],v[o]=l.eE(-1,o,-1,1,_.SheetArea.colHeader),g=n.ZO(o,a,r,y,h,d,v,m),m[o]=g,y<=o&&(e.push(g),a+=u,w-=u);w<=0&&o<r&&2===l.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,o-1)&&(p=n.ZO(o,a,r,y,h,d,v,m),m[o]=p,e.push(p))}else if(2===t)for(a=i.Hy,o=y=k(c,r-f);o<r;o++)h[o]=u=s.Kt(o),d[o]=l.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,o),v[o]=l.eE(-1,o,-1,1,_.SheetArea.colHeader),g=n.ZO(o,a,r,y,h,d,v,m),m[o]=g,e.push(g),a+=u;return e},z.prototype.Mfe=function(t){var o,n,e,i,r,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,M,A,I,x,C,M,N,o=this,n=new j.h9,e=o.Fi(),i=B(o),u=o.Jt,s=H(o),c=G(o),f=o.Ut,l=[],h=[],d=[],v=[],m=function(t){for(var n,e,i,r,i,o,n=0,e=t,r=t-1;0<=r;r--)if(l[r]=i=u.Kt(r),i){if(h[r]=f.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,r),(i=h[r]!==_.ColumnHeaderFitMode.normal)||(h[o=r-1]=f.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,o),i=h[o]!==_.ColumnHeaderFitMode.normal),!i)break;n+=l[e=r]}return{leftOutsideWidth:n,Cfe:e}},g=function(t,n,e,i){var r,e;return l[n]||(l[n]=u.Kt(n)),r=l[n],d[n]=f.eE(-1,n,-1,1,_.SheetArea.colHeader),e=o.ZO(n,e,i,t,l,h,d,v),{colLayout:v[n]=e,colWidth:r}};if(0===t)for(a=e.b6,p=E(s,i),r=o.wve();r<i&&(h[r]=f.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,r),!(p<=r&&2!==h[r]&&2!==h[r-1]));r++)w=(b=g(0,r,a,i)).colLayout,y=b.colWidth,r<p||(w.isOutside=!0),n.push(w),a+=y;else if(1===t){for(M=Nt(o),C=o.my,a=e.Py+C,p=M?i-c:i,S=o.Gy(e)-C,a-=A=(M=m(T=k(s,o.Ab))).leftOutsideWidth,r=I=M.Cfe;r<i&&(D(h[r])&&(h[r]=f.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,r)),!(S<=0||p<=r)||2===h[r]||2===h[r-1]);r++)w=(x=g(T,r,a,i)).colLayout,y=x.colWidth,T<=r&&0<S?(n.push(w),a+=y,S-=y):(w.isOutside=!0,n.push(w),a+=y);S<=0&&r<i&&2===f.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,r-1)&&(C=o.ZO(r,a,i,T,l,h,d,v),v[r]=C,n.push(C))}else if(2===t)for(a=e.Hy,a-=A=(M=m(T=k(s,i-c))).leftOutsideWidth,r=I=M.Cfe;r<i;r++)h[r]=f.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,r),w=(N=g(T,r,a,i)).colLayout,y=N.colWidth,T<=r||(w.isOutside=!0),n.push(w),a+=y;return n},z.prototype.ZO=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,p,b,w,y,y,M,C,g,S,T,A,T,I,x,N,k,o,s=this,c=s.Ut,f=s.Jt,l=t,h=-1,d=-1,v=o[t],m=r[t],g=a[t],p=s.NMi,p=p&&p.options&&p.options.defaultStackRowHeight;if(v!==_.ColumnHeaderFitMode.normal&&!c.e7(t)&&!g&&!c.eE(-1,t+1,-1,1,_.SheetArea.colHeader))for(v===_.ColumnHeaderFitMode.stack&&(m+=f.Kt(l=t+1));(c.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,l)!==_.ColumnHeaderFitMode.normal||!f.Kt(l))&&l<e-1&&!c.eE(-1,l+1,-1,1,_.SheetArea.colHeader);){if((b=c.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,l))===_.ColumnHeaderFitMode.vertical&&f.Kt(l)){if(v===_.ColumnHeaderFitMode.vertical)break;if(w=s.O5(l,_.SheetArea.viewport),y=s.r6(l,_.SheetArea.viewport,!0),y=c.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,y),M=c.getColumnHeaderFitMode(!1,_.SheetArea.colHeader,w),!(y!==_.ColumnHeaderFitMode.normal&&M!==_.ColumnHeaderFitMode.normal&&w<e)||c.eE(-1,w+1,-1,1,_.SheetArea.colHeader))break}l++,m+=f.Kt(l)}for(l=t-1;i<=l&&!r[l]&&!a[l];)l--;return C=s.Ut.o7(t),(g=o[l])!==_.ColumnHeaderFitMode.normal&&r[l]&&!a[l]&&!a[t]&&C<=l?((S=u[l])===O&&(T=n-s.nn(l),S=u[l]=s.ZO(l,T,e,i,r,o,a,u)),g===_.ColumnHeaderFitMode.stack?(T=(A=function(t){for(var n=s.r6(t,_.SheetArea.viewport,!0);C<=n&&s.Lt(n)===_.ColumnHeaderFitMode.stack;)n=s.r6(n,_.SheetArea.viewport,!0);return!!(C<=n&&s.Lt(n)!==_.ColumnHeaderFitMode.normal&&u[n||0]&&-1!==u[n||0].y)&&u[n||0]})(t),h=D(p)?(x=c.r7(t))/(N=c.n7(t)):(h=p*(I=c.r7(t,O,!0))/s.defaults.colHeaderRowHeight,E(h,1)),T&&D(p)?h=1-(d=(1-h)*(k=0<T.height?T.height:1)):d=1-h):g===_.ColumnHeaderFitMode.vertical&&(v!==_.ColumnHeaderFitMode.normal?(h=S.y,d=S.height):h=d=-1)):h=d=-1,(o=new j.W8(-1,t,n,h,m,d)).offsetX=s.getColumnScrollOffsetX(t),o},z.prototype._y=function(t,n){return D(n)||3===n||2===n?this.dw(t):1===n?this.jF():N},z.prototype.d9=function(t){for(var n,e,i,n=new j.h9,e=0;e<3;e++)(i=this._y(e,t))&&0<i.length&&(n=l.GC$.merge(n,i));return n},z.prototype.m9=function(t){for(var n,e,i,n=new j.h9,e=0;e<3;e++)(i=this.Yy(e,t))&&0<i.length&&(n=l.GC$.merge(n,i));return n},z.prototype.jF=function(){var t=this;return t.N8.colHeader||(t.N8.colHeader=t.VF()),t.N8.colHeader},z.prototype.dw=function(t){var n=this;return n.N8.viewport||(n.N8.viewport={}),n.N8.viewport[t]||(n.N8.viewport[t]=n.YF(t)),n.N8.viewport[t]},z.prototype.VF=function(){for(var t,n,e,i,r,o,t=new j.h9,n,e=this.Fi().LA,r=this.getRowCount(1),o=0;o<r;o++)i=this.Gt(o,1),t.push(new j.W8(o,-1,-1,e,-1,i)),e+=i;return t},z.prototype.YF=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=this,e=new j.h9;if(e.sE(),i=V(n),r=U(n),o=n.Fi(),a=P(n),f=n.Jt,0===t)for(s=o.T6,a=E(i,a),u=n.Mve();u<a;u++)c=f.Gt(u),l=new j.W8(u,-1,-1,s,-1,c),e.push(l),e.fE(u,l),s+=c;else if(1===t)for(h=xt(n),d=n.ly,s=o.Cy+d,a=h?a-r:a+r,v=n.Sy(o)-d,u=m=k(i,n.Tb);0<v&&u<a;u++)c=f.Gt(u),l=new j.W8(u,-1,-1,s,-1,c),e.push(l),e.fE(u,l),s+=c,v-=c;else if(2===t)for(s=o.Ay,u=k(i,a-r);u<a;u++)c=f.Gt(u),l=new j.W8(u,-1,-1,s,-1,c),e.push(l),e.fE(u,l),s+=c;return e},z.prototype.s7=function(t,n,e,i){var r,o,a,t,n,u,s,c,f,l,h,i,r=this,o=r.getRowCount(e),a=r.getColumnCount(e),t=r._y(t,e),n=r.Yy(n,e),u=new j.h9;return t&&0<t.length&&n&&0<n.length&&(s=t[0].row,c=n[0].col,f=t[t.length-1].row,l=n[n.length-1].col,h=r.Ut.getSpans((0,A.Ec)(s,c,f-s+1,l-c+1),e),i&&r.Cb&&(i=r.Cb.ZF(e),h=h.concat(i)),0<h.length)&&r.WF(h,s,c,f,l,u,o,a,e,t,n),u},z.prototype.O_=function(t,n,e,i,r){var o,a,u,t,n,s,c,f,i,r,o=this,a=o.getRowCount(e),u=o.getColumnCount(e),t=o._y(t,e),n=o.Yy(n,e),s=new j.h9;return t&&0<t.length&&n&&0<n.length&&(c=t[0].row,f=n[0].col,(i=o.getSpan(i,r,e))&&((r=[]).push(i),o.WF(r,c,f,i.row+i.rowCount,i.col+i.colCount,s,a,u,e,t,n)),0<s.length)?s[0]:N},z.prototype.WF=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,l=t.length;if(!(l<=0)){for(h=this,v=i+1,m=r+1,g=[],p=[],b=[],w=[],M=y=0,d=n-1;0<=d;d--)g[d]=h.Gt(d,s),w[d]=M-=g[d];for(M=0,d=n;d<v;d++)w[d]=M,g[d]=h.Gt(d,s),M+=g[d];for(d=e-1;0<=d;d--)p[d]=h.nn(d,s),b[d]=y-=p[d];for(y=0,d=e;d<m;d++)b[d]=y,p[d]=h.nn(d,s),y+=p[d];for(C=0;C<l;C++)if((S=t[C]).intersect(n,e,i-n+1,r-e+1)){if(v<(T=S.row+S.rowCount)){for(d=v;d<T;d++)g.push(h.Gt(d,s)),w.push(w[d-1]+g[d]);v=T}if(m<(A=S.col+S.colCount)){for(d=m;d<A;d++)p.push(h.nn(d,s)),b.push(b[d-1]+p[d]);m=A}for(I=b[S.col],x=w[S.row],D=_=void(k=N=0),D=S.col;D<S.col+S.colCount&&D<u;D++)N+=p[D];for(_=S.row;_<S.row+S.rowCount&&_<a;_++)k+=g[_];o.push(new j.W8(S.row,S.col,f[0].x+I,c[0].y+x,N,k,S.rowCount,S.colCount,S.isAutoMerge))}}},z.prototype.ow=function(){var t,n,e,i,n,r,i,t=this,n=t.parent,e=t.ww(t.Ab),i=t.my;-1!==e&&e!==t.Ab&&(t.Ab=e),(n=n&&n.zb)&&(i=(r=n.g4===_.ScrollType.pixels)?t.QF(e)-i:t.KF(e),n.value(i))},z.prototype.JF=function(){var t,n,n,e,e,t,n=this.parent,n=n&&n.Xw;n&&(e=this.getDockScrollbarAttachedIndex(),D(e)||(e=-this.getColumnScrollOffsetX(e),n.value(e)))},z.prototype.tw=function(){var t,n,e,i,n,r,i,t=this,n=t.parent,e=t.vw(t.Tb),i=t.ly;-1!==e&&e!==t.Tb&&(t.Tb=e),(n=n&&n.Xb)&&(i=(r=n.g4===_.ScrollType.pixels)?t.XF(e)-i:t.qF(e),n.value(i))},z.prototype.aw=function(){var t,n,e,t=this,n=t.parent;n&&n.zb&&(e=n.options.scrollByPixel,n.zb.g4=e?_.ScrollType.pixels:_.ScrollType.continuous),n&&n.Xg&&(n.options.scrollbarAppearance===_.ScrollbarAppearance.mobile&&n.kC(),n.options.scrollIgnoreHidden&&(t.$F=t.tP(!0)),n.Xg())},z.prototype.ew=function(){var t,n,e,t=this,n=t.parent;n&&n.Xb&&(e=n.options.scrollByPixel,n.Xb.g4=e?_.ScrollType.pixels:_.ScrollType.continuous),n&&n.QC&&(n.options.scrollbarAppearance===_.ScrollbarAppearance.mobile&&n.kC(),n.options.scrollIgnoreHidden&&(t.nP=t.eP(!0)),n.QC())},z.prototype.Sw=function(){var t,n,e,t=this,n=0,e=H(t);return n=0<e?t.O5(e-1):t.k9()},z.prototype.pw=function(){var t,n,e,t=this,n=0,e=V(t);return n=0<e?t.j5(e-1):t.N9()},z.prototype.k9=function(t){return this.O5(-1,t)},z.prototype.bge=function(t,n){var e,t,e=this,t=e.getColumnCount(t);return n?t-1:t-1-G(e)},z.prototype.O5=function(t,n,e){for(var i,r,i=this,r=i.bge(n,e);t<r;)if(i.getColumnVisible(++t,n)&&0<i.nn(t,n))return t;return N},z.prototype.r6=function(t,n,e){for(var i=this,r=e?0:H(i);r<t;)if(i.getColumnVisible(--t,n)&&0<i.nn(t,n))return t;return N},z.prototype.N9=function(t){return this.j5(-1,t)},z.prototype.pge=function(t,n){var e,t,e=this,t=e.getRowCount(t);return n?t-1:t-1-U(e)},z.prototype.j5=function(t,n,e){for(var i,r,i=this,r=i.pge(n,e);t<r;)if(i.getRowVisible(++t,n)&&0<i.Gt(t,n))return t;return N},z.prototype.nI=function(t,n,e){for(var i=this,r=e?0:V(i);r<t;)if(i.getRowVisible(--t,n)&&0<i.Gt(t,n))return t;return N},z.prototype.iP=function(){this.Ww=!0,this.tw()},z.prototype.rP=function(){this.Zw=!0,this.ow()},z.prototype.XF=function(t){var n,e,i,r,e,o,a,u,n=this,e=V(n),i,r=e,e=r+(P(n)-U(n)-e)-1,o=0;if(!(t<=r))for(e<t&&(t=e),a=r;a<t;a++)o+=u=n.Gt(a);return o},z.prototype.QF=function(t){var n,e,i,r,e,o,a,u,n=this,e=H(n),i,r=e,e=r+(B(n)-G(n)-e)-1,o=0;if(!(t<=r))for(e<t&&(t=e),a=r;a<t;a++)o+=u=n.nn(a);return o},z.prototype.qF=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.eP().visibleIndex)[t]:t},z.prototype.oP=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.eP().originalIndex)[t]:t},z.prototype.KF=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.tP().visibleIndex)[t]:t},z.prototype.aP=function(t){var n,e,n=this.parent;return n&&n.options.scrollIgnoreHidden?(e=this.tP().originalIndex)[t]:t},z.prototype.tP=function(t){var n,t,e,i,r,o,a,u,s,n=this;if(n.$F&&!t)return n.$F;if(t=H(n),e=B(n)-G(n)-t,o=n.Jt,a={visibleIndex:{},originalIndex:{}},!((r=(i=t)+e-1)-i+1<=0)){for(u=0,s=i;s<=r;s++)a.originalIndex[u]=s,a.visibleIndex[s]=u,0<o.Kt(s)&&u++;for(s--,u--;o.Kt(s)<=0&&i<=s;)a.originalIndex[u]=s,a.visibleIndex[s]=u,s--}return a},z.prototype.eP=function(t){var n,t,e,i,r,o,a,u,s,n=this;if(n.nP&&!t)return n.nP;if(t=V(n),e=P(n)-U(n)-t,o=n.Jt,a={visibleIndex:{},originalIndex:{}},!((r=(i=t)+e-1)-i+1<=0)){for(u=0,s=i;s<=r;s++)a.originalIndex[u]=s,a.visibleIndex[s]=u,0<o.Gt(s)&&u++;for(s--,u--;o.Gt(s)<=0&&i<=s;)a.originalIndex[u]=s,a.visibleIndex[s]=u,s--}return a},z.prototype.vw=function(t,n){var e,i,r,o,e=this,r=V(e),o=P(e)-U(e)-1;if(n){if((i=e.nI((t=o<t?o:t)+1))!==N&&r<=i)return i}else if((i=e.j5((t=t<r?r:t)-1))!==N&&i<=o)return i;return-1},z.prototype.ww=function(t,n){var e,i,r,o,e=this,r=H(e),o=B(e)-G(e)-1;if(n){if((i=e.r6((t=o<t?o:t)+1))!==N&&r<=i)return i}else if((i=e.O5((t=t<r?r:t)-1))!==N&&i<=o)return i;return-1},z.prototype.uP=function(t,n,e){var i,r,o,a,u;if(e<n)return e;for(i=0,r=this.Jt,a=o=e;n<=a;a--)if(!((u=r.Gt(a))<=0)){if(t<(i+=u))break;o=a}return o},z.prototype.gw=function(t,n,e){for(var i,r,o,a,u,i=0,r=e,o=0,a=e;n<=a;a--)if(!((u=this.Gt(a))<=0)&&(r=a,t<=(i+=u))){o=t-i;break}return{Ky:r,Xy:o}},z.prototype.sP=function(t,n,e){var i,r,o,a,u;if(e<n)return e;for(i=0,r=this.Jt,a=o=e;n<=a;a--)if(!((u=r.Kt(a))<=0)){if(t<(i+=u))break;o=a}return o},z.prototype.Cw=function(t,n,e){for(var i,r,o,a,u,i=0,r=e,o=0,a=e;n<=a;a--)if(!((u=this.nn(a))<=0)&&(r=a,t<=(i+=u))){o=t-i;break}return{iw:r,Xy:o}},z.prototype.cP=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Fi(),e=t.Yy(1,3),i=0,r=0;if(e)for(o=0;o<e.length;o++)i+=a=e[o].width,0<a&&r++;return 0==(u=i/(r=0===r?1:r))?1:y(t.Gy(n)/u)},z.prototype.fP=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Fi(),e=t._y(1,3),i=0,r=0;if(e)for(o=0;o<e.length;o++)i+=a=e[o].height,0<a&&r++;return 0==(u=i/(r=0===r?1:r))?1:y(t.Sy(n)/u)},z.prototype.mw=function(t){var n,e,i,r,o,a,e,o;return D(t)&&(t=3),e=(n=this).parent,i=V(n),r=U(n),e&&e.options.scrollbarMaxAlign?(o=n.Fi(),e.options.scrollByPixel?n.gw(n.Sy(o),i,P(n)-r-1):{Ky:a=n.uP(n.Sy(o),i,P(n)-r-1),Xy:0}):(e=n.getRowCount(t),3!==t&&2!==t||(e-=r),{Ky:o=(o=n.nI(e,t))===N?i:o,Xy:0})},z.prototype.Mw=function(t){var n,e,i,r,o,e,r;return D(t)&&(t=3),e=(n=this).parent,i=H(n),e&&e.options.scrollbarMaxAlign?(r=n.Fi(),e.options.scrollByPixel?n.Cw(n.Gy(r),i,B(n)-G(n)-1):{iw:o=n.sP(n.Gy(r),i,B(n)-G(n)-1),Xy:0}):(e=n.getColumnCount(t),3!==t&&1!==t||(e-=G(n)),{iw:r=(r=n.r6(e,t))===N?i:r,Xy:0})},z.prototype.lP=function(){var e,i,r,t,n,o,a,a,a,a,o,e=this,i=V(e),r=H(e),t=P(e)-U(e)-1,n=B(e)-G(e)-1,o=e.Ut,a=o.getLastNonNullRow(3);return i<a&&(i=a),a=o.getLastNonNullCol(3),r<a&&(r=a),a=o.getLastNonNullRow(2),i<a&&(i=a),a=o.getLastNonNullCol(1),r<a&&(r=a),(o=z.fh)&&h(o,function(t,n){var n,n,n=n.lastNonNullRowAndCol;n&&(n=n.call(e),i=k(i,n.lastNonNullRow),r=k(r,n.lastNonNullCol))}),{lastNonNullRow:i=t<i?t:i,lastNonNullCol:r=n<r?n:r}},z.prototype.getLastNonNullRow=function(){return this.lP().lastNonNullRow},z.prototype.getLastNonNullColumn=function(){return this.lP().lastNonNullCol},z.prototype.$A=function(t,n,e){var i,r,o,a,u,a,s,s,i=this,r=i.Tb,o=i.ly,a=i.mw(),u=a.Ky,a=a.Xy,s=!D(e);(t=r>=i.getRowCount()&&u<t?u:t)>=i.pw()&&t<=u&&(s||t!==r||n!==o)&&((s=i.parent)&&(n||t!==u||(n=a),s.ib&&s.ib.yy(i,t,n||0,e),i.tw()),s&&!s.options.scrollbarShowMax&&i.ew(),i.invalidateLayout())},z.prototype.o9=function(t,n,e){var i,r,o,a,u,a,s,s,i=this,r=i.Ab,o=i.my,a=i.Mw(),u=a.iw,a=a.Xy,s=!D(e);(t=r>=i.getColumnCount()&&u<t?u:t)>=i.Sw()&&t<=u&&(s||t!==r||n!==o)&&((s=i.parent)&&(n||t!==u||(n=a),s.ib&&s.ib.wy(i,t,n||0,e),i.ow()),s&&!s.options.scrollbarShowMax&&i.aw(),i.invalidateLayout())},z.prototype.JL=function(t,n,e){var i,r,o,t,a,a,a,u,s,c,r,f,i=this,r=t.row,o=t.col,t=t.hitTestType;return D(r)||D(o)?N:((a=i.getSpan(r,o,t))&&(r=a.row,o=a.col),i.Cb&&(a=i.Cb.D7(r,o,t))&&(r=a.row,o=a.col),a=i.Il(r,o,t),c=i.getCellRect(r,o,u=1===t?-1:O,s=2===t?-1:O,!0),r={sheet:i,row:r,col:o,sheetArea:t},(f=a.cellType||i.$f(t)).Bn(n,e,a,c,r))},z.prototype.bC=function(){this.unbindAll(),this.E3()},z.prototype.dA=function(t,n,e){for(var t,i,r,o,a,u,s,c,f,u,f,f,t=this.JS(t),i=t.row,r=t.col,o=i+t.rowCount,a=r+t.colCount,s=i;s<o;s++)for(c=r;c<a;c++)if(u=(f=this.getSpan(s,c,e))?f.row:s,f=f?f.col:c,u=this.getActualStyle(u,f,e),f=n&&this.XT(s,e),!0===u.locked&&!f)return!0;return!1},z.prototype.zT=function(t,n,e,i,r,o){if(-1<=t&&t<r&&-1<=n&&n<o){if(-1===t&&-1===n)return!0;if(-1===t){if(0!==i&&n+i<=o)return!0}else if(-1===n){if(0!==e&&t+e<=r)return!0}else if(0!==i&&n+i<=o&&0!==e&&t+e<=r)return!0}return!1},z.prototype.GT=function(t,n,e,i){var r,o,o,o,r=this;return!(t<0&&n<0)&&(t<0&&(o=r.Ut.K_(1))&&o.spans&&0<o.spans.length?r.Ut.GT(-1,n,-1,i,1):n<0&&(o=r.Ut.K_(2))&&o.spans&&0<o.spans.length?r.Ut.GT(t,-1,e,-1,2):!!((o=r.Ut.K_(3))&&o.spans&&0<o.spans.length)&&r.Ut.GT(t,n,e,i,3))},z.prototype.suspendPaint=function(){var t,n,t=this,n=t.My;t.My++,0===n&&z.et(t,lt,{suspend:!0})},z.prototype.resumePaint=function(){var t=this;t.My--,t.My<=0&&(t.My=0,z.et(t,lt,{suspend:!1}),t.hP())&&t.zw()},z.prototype.hP=function(){var t=this.parent;return!t||t.getActiveSheet()===this},z.prototype.isPaintSuspended=function(){return 0<this.My},z.prototype.nR=function(t,n){for(var e,i,r,o,e=this,i=t&&t.length,r=0;r<i;r++)if(o=t[r],n.intersect(o.row,o.col,o.rowCount,o.colCount))return t.splice(r,1),e.nR(t,n.union(o));return n},z.prototype.getClipboardHelperObj=function(){var t=this.ST();return{isCutting:t.ES,ranges:t._S,showInsertCopyPasteCells:t.TT,fromSheet:t.DS}},z.prototype.resetFloatingObjectHelperData=function(t){this.dP&&this.dP.remove(t)},z.prototype.ST=function(){var t=this,n=t.parent;return t.bM||(t.bM=n&&n.bM),t.bM},z.prototype.BO=function(){var t;return this.MC||((t=this).MC=new i.Wh(function(){!t.MC||t.parent&&t.parent.Vp&&t.parent.Vp.endingCallback||(z.et(t,"onImageLoaded"),t.repaint())})),this.MC},z.prototype.Qy=function(){var t,n=this.parent;if(n)return n.commandManager()},z.prototype.jT=function(t,n){this.ki(A.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:t,message:n})},z.prototype.Rj=function(t,n,e,i,r,o){var a,u;0===this.vf&&(a={sheet:this,sheetName:this.name(),row:n,col:e,sheetArea:i,propertyName:t,oldValue:r,newValue:o,isUndo:this.Nj},this.ki(A.Events.CellChanged,a),(u=this.Ut).ZI(["cellChanged",t,n,e,i,o,r]))},z.prototype.eT=function(t,n,e,i){this.ki(A.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:n,oldValue:e,newValue:i})},z.prototype.Dj=function(t,n,e,i,r){var o,a,o;if(0===this.vf){if(o={sheet:this,sheetName:this.name(),col:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,cancel:!1},"addColumns"!==e&&"deleteColumns"!==e||(o.count=i),this.ki(A.Events.ColumnChanging,o),!0===o.cancel)return!1;(a=this.Ut).ZI(["columnChanging",t,n,e,r,i])}return o=this.getDockScrollbarAttachedIndex(),D(o)||this.vP(),!0},z.prototype.vj=function(t,n,e,i,r){var o,a,o;0===this.vf?(o={sheet:this,sheetName:this.name(),col:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,isUndo:this.Nj},"addColumns"!==e&&"deleteColumns"!==e||(o.count=i),this.ki(A.Events.ColumnChanged,o),(a=this.Ut).ZI(["columnChanged",t,n,e,r,i])):this.Lj(this,[{col:t}],1),o=this.mP,D(o)||this.gP()},z.prototype._j=function(t,n,e,i){var r,o,a,u,s,o=[];if(this.tables){for(r=this.tables.pP(t,n,e,i),a=0;a<r.length;a++)o.push(r[a].name());0<o.length&&(u={isUndo:this.Nj,sheet:this,sheetName:this.name(),row:t,col:e,rowCount:n,colCount:i,tableNames:o,action:2},this.ki(A.Events.RangeChanged,u),(s=this.Ut).ZI(["rangeChanged",t,n,e,i]))}},z.prototype.kj=function(t,n,e,i,r){var o,a;if(0===this.vf){if(o={sheet:this,sheetName:this.name(),row:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,cancel:!1},"addRows"!==e&&"deleteRows"!==e||(o.count=i),this.ki(A.Events.RowChanging,o),!0===o.cancel)return!1;(a=this.Ut).ZI(["rowChanging",t,n,e,r,i])}return!0},z.prototype.dj=function(t,n,e,i,r){var o,a;0===this.vf?(o={sheet:this,sheetName:this.name(),row:t,sheetArea:n,propertyName:e,newValue:i,oldValue:r,isUndo:this.Nj},"addRows"!==e&&"deleteRows"!==e||(o.count=i),this.ki(A.Events.RowChanged,o),(a=this.Ut).ZI(["rowChanged",t,n,e,r,i])):this.Lj(this,[{row:t}],2)},z.prototype.Oj=function(t,n){n!==t&&(this.ki(A.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:n,newZoomFactor:t}),this.ki(A.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:n,newZoomFactor:t}))},z.prototype.EA=function(t,n){return!(this.O9||!this.rt._A(t,n)||(this.ki(A.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:n}),0))},z.prototype.jA=function(t,n){this.ki(A.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections(),shiftKey:n})},z.prototype.SI=function(t,n,e,i,r,o,a,u,s,c,f){var l,t,l={sheet:this,sheetName:this.name(),row:t,col:n,rowCount:e,colCount:i,changedCells:r,action:o},t={sheet:this,sheetName:this.name(),row:t,col:n,rowCount:e,colCount:i,changedCells:r,isUndo:!!c,action:o};a&&(t.sheetArea=l.sheetArea=a),u&&(l.value=u),(r&&0<r.length||f!==O)&&(s&&0<s.length&&(t.tableNames=s),this.ki(A.Events.RangeChanged,t),this.ki(A.Events.RangeChangedInternal,l))},z.prototype._i=function(t,n){var t={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:n};this.ki(A.Events.EditorStatusChanged,t)},z.prototype.bP=function(){return this.yP||(this.yP=(0,l.GC$)(W("input"))),this.yP},z.prototype.o5=function(){var t=this;return t.parent&&t.parent.options.pasteSkipInvisibleRange},z.prototype.lT=function(t,n,e){var i,r,o,a,u,i=this,r=0,o=i.getColumnWidth,a=i.getColumnCount();for(e&&(o=i.getRowHeight,a=i.getRowCount()),u=t=t<0?0:t;u<t+n;u++)u<a&&0===o.call(i,u)&&(r++,n++);return r},z.prototype.ox=function(t,n,e){var i,r,o,a,i=this,r=0,o=i.getColumnWidth;for(e&&(o=i.getRowHeight),a=t=t<0?0:t;t-n<a&&0<a;a--)0===o.call(i,a)&&(r++,n++);return r},z.prototype.ix=function(t,n,e){var i,r,o,a,i=this,r=0,o=i.getColumnWidth;for(e&&(o=i.getRowHeight),a=t=t<0?0:t;a<t+n;a++)0===o.call(i,a)&&r++;return r},z.prototype.bind=function(t,n,e){this.bP().bind(t+gt,n,e)},z.prototype.unbind=function(t,n){this.bP().unbind(t+gt,n)},z.prototype.ki=function(t,n,e){this.updateEventsData&&this.updateEventsData(t,n),0!==this.vf&&!e||this.bP().trigger(t,n)},z.prototype.unbindAll=function(){this.unbind("")},z.prototype.D3=function(t,n,e){0<=t.indexOf(".")?this.bind(t,n,e):this.bind(t+pt,n,e)},z.prototype._3=function(t,n){0<=t.indexOf(".")?this.unbind(t,n):this.unbind(t+pt,n)},z.prototype.E3=function(){this.unbind(pt)},z.prototype.ot=function(){var t=this.kg;return new A.Rect(t.x,t.y,t.width,t.height)},z.prototype.cg=function(t){this.kg=new A.Rect(t.x,t.y,t.width,t.height)},z.prototype.scroll=function(t,n){var e,i,r,o,a,i,u,s,r,n,c,f,n,e=this,i=e.parent;i&&(o=(r=i.options).scrollByPixel,a=r.scrollPixel,i=i.ib,u=r.scrollbarShowMax,s=r.showHorizontalScrollbar,r=r.showVerticalScrollbar,0!==n&&(c=(n=i.bw(e,Math.round(n)/a)).iw,f=o?n.Xy:0,c===e.Ab&&f===e.my||(i.wy(e,c,f),s&&(e.ow(),u||(e.Zw=!0)))),0!==t)&&(c=(n=i.hw(e,Math.round(t)/a)).Ky,f=o?n.Xy:0,c===e.Tb&&f===e.ly||(i.yy(e,c,f),r&&(e.tw(),u||(e.Ww=!0))))},z.prototype.isCtrlPressed=function(t){return this.rt&&this.rt.ctrl},z.prototype.deselectIgnoreSpan=function(){return!1},z.prototype.Wb=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,m,m,g,p,b,w,y,M,s,i,m,e=this,i=e.zoom(),r=n.newValue,o=n.oldValue,a=n.scrollEventType,u=t.options.scrollByPixel,s=t.options.scrollPixel;if(o=n.oldValue=D(o)?0:u?T(o):C(o+"",10),e.Ww=!1,l=e.pw(),h=e.mw().Ky,d=t.options.scrollbarShowMax,v=0,u){for(m=(r=T(r))-o,a!==_.Zi.thumbTrack&&(r=o+(m*=s*i),m=t.Xb.v4(),r<0?r=0:m<r&&(r=m)),d||(e.Ww=!0,a===_.Zi.smallIncrement&&r===o?r+=s*i:n.ignoreUpdatePosition=!0),b=(m=e.frozenRowCount())+(g=e.getRowCount()-e.frozenTrailingRowCount()-m)-1,y=w=0,M=m;M<=b;M++)if(r<=(w+=y=e.Gt(M))){v=w-r-y,c=M;break}D(c)&&(v=-e.Gt(c=b),r=w)}else c=C(r+"",10),c=e.oP(c),a===_.Zi.largeDecrement||a===_.Zi.smallDecrement?(a===_.Zi.largeDecrement&&(c=e.QA()),-1!==(f=e.vw(c,!0))&&f!==c&&(c=f),d||(e.Ww=!0,n.ignoreUpdatePosition=!0)):a!==_.Zi.largeIncrement&&a!==_.Zi.smallIncrement||(a===_.Zi.largeIncrement&&(c=e.sB())===e.Tb&&c++,d||(e.Ww=!0,a===_.Zi.smallIncrement&&r===o&&c++),-1!==(f=e.vw(c))&&f!==c&&(c=f)),h<(c=c<l?l:c)&&(c=h);s=u?T(r):e.qF(c),n.newValue!==s&&(n.newValue=s),i=s,0!==(m=e.Gt(c))&&(i+=S(v)/m),n.newValueWithOffset=u?s:i,o===s&&!u||t.ib.ay(e,c,v)},z.prototype.Kb=function(t){var n,e,i,r,o,a,n=this,e=t.Xb,i;e.g4!==_.ScrollType.pixels&&(r=n.oP(e.value()),o=n.pw(),a=n.mw().Ky,r<o?e.value(n.qF(o)):a<r&&e.value(n.qF(a))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?n.Ww=!0:t.QC())},z.prototype.Fb=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,m,m,g,p,b,w,y,M,s,i,m,e=this,i=e.zoom(),r=n.newValue,o=n.oldValue,a=n.scrollEventType,u=t.options.scrollByPixel,s=t.options.scrollPixel;if(o=n.oldValue=D(o)?0:u?T(o):C(o+"",10),e.Zw=!1,l=e.Sw(),h=e.Mw().iw,d=t.options.scrollbarShowMax,v=0,u){for(m=(r=T(r))-o,a!==_.Zi.thumbTrack&&(r=o+(m*=s*i),m=t.zb.v4(),r<0?r=0:m<r&&(r=m)),d||(e.Zw=!0,a===_.Zi.smallIncrement&&r===o?r+=s*i:n.ignoreUpdatePosition=!0),b=(m=e.frozenColumnCount())+(g=e.getColumnCount()-e.frozenTrailingColumnCount()-m)-1,y=w=0,M=m;M<=b;M++)if(r<=(w+=y=e.nn(M))){v=w-r-y,c=M;break}D(c)&&(v=-e.nn(c=b),r=w)}else c=C(r+"",10),c=e.aP(c),a===_.Zi.largeDecrement||a===_.Zi.smallDecrement?(a===_.Zi.largeDecrement&&(c=e.fB()),-1!==(f=e.ww(c,!0))&&f!==c&&(c=f),d||(e.Zw=!0,n.ignoreUpdatePosition=!0)):a!==_.Zi.largeIncrement&&a!==_.Zi.smallIncrement||(a===_.Zi.largeIncrement&&(c=e.oB())===e.Ab&&c++,d||(e.Zw=!0,a===_.Zi.smallIncrement&&r===o&&c++),-1!==(f=e.ww(c))&&f!==c&&(c=f)),h<(c=c<l?l:c)&&(c=h);s=u?T(r):e.KF(c),n.newValue!==s&&(n.newValue=s),i=s,0!==(m=e.nn(c))&&(i+=S(v)/m),n.newValueWithOffset=u?s:i,o===s&&!u||t.ib.ay(e,c,v,!0)},z.prototype.Gb=function(t){var n,e,i,r,o,a,n=this,e=t.zb;n&&e&&((i=e.g4===_.ScrollType.pixels)||(r=n.aP(e.value()),o=n.Sw(),a=n.Mw().iw,r<o?e.value(n.KF(o)):a<r&&e.value(n.KF(a))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?n.Zw=!0:t.WC()))},z.prototype.onHorizontalDockScroll=function(t,n){var e,i,n,r,e=this.wP;D(e)||(i=n.oldValue,n=n.newValue,this.scrollColumnView(e,-(r=n-i)))},z.prototype.WC=function(t,n,e){var i,r,o,a,o,u,u,a,s,c,f,l,h,d,v,m,h,f,n,t,h,f,s,i=this,r=e&&e.g4===_.ScrollType.pixels,o=i.frozenColumnCount(),a=i.getColumnCount()-i.frozenTrailingColumnCount()-o,o=o,u=i.Fi(),u=i.Gy(u),a=0==a?o:o+a-1,s=i.Ab,c=i.my,l=0;t?(r?(f=d=(h=i.Cw(u,o,a)).iw,l=v=h.Xy):f=i.sP(u,o,a),a=f):r&&(l=-i.nn(a)),n?r&&!t&&(l=-i.nn(a)):(h=(m=i.lP()).lastNonNullCol,a=(f=(f=i.sP(u,o,h))===o&&a<++f?a:f)<s?s<a?s:a:f,l=c),a<s?(i.Ab=a,i.my=r?l:0):s===a&&c<l&&(i.my=r?l:0),-1!==(n=i.ww(i.Ab))&&n!==i.Ab&&(i.Ab=n),e&&(s=f=h=t=0,r?(t=i.QF(o),h=i.QF(a)-l,f=u,s=i.QF(i.Ab)-i.my):(t=i.KF(o),h=i.KF(a),f=i.cP(),s=i.KF(i.Ab),f<1&&(f=1)),e.m4(t),e.v4(h),e.d4(f),e.w4(),e.value(s))},z.prototype.$C=function(t){var n,e,i,r,o,e,n;t&&(n=this.getDockScrollbarAttachedIndex(),D(n)||(e=this.getColumnWidth(n),r=0,o=(i=this.getColumnScrollWidth(n))-e,e=e,n=-this.getColumnScrollOffsetX(n),t.m4(0),t.v4(o),t.d4(e),t.w4(),t.value(n)))},z.prototype.QC=function(t,n,e){var i,r,o,a,o,u,a,s,c,f,l,u,h,d,v,m,h,f,n,t,h,f,s,i=this,r=e&&e.g4===_.ScrollType.pixels,o=i.frozenRowCount(),a=i.getRowCount()-i.frozenTrailingRowCount()-o,o=o,u=i.Fi(),a=0==a?o:o+a-1,s=i.Tb,c=i.ly,l=0,u=i.Sy(u);t?(r?(f=d=(h=i.gw(u,o,a)).Ky,l=v=h.Xy):f=i.uP(u,o,a),a=f):r&&(l=-i.Gt(a)),n?r&&!t&&(l=-i.Gt(a)):(h=(m=i.lP()).lastNonNullRow,a=(f=(f=i.uP(u,o,h))===o&&a<++f?a:f)<s?s<a?s:a:f,l=c),a<s?(i.Tb=a,i.ly=r?l:0):s===a&&c<l&&(i.ly=r?l:0),-1!==(n=i.vw(i.Tb))&&n!==i.Tb&&(i.Tb=n),e&&(s=f=h=t=0,r?(t=i.XF(o),h=i.XF(a)-l,f=u,s=i.XF(i.Tb)-i.ly):(t=i.qF(o),h=i.qF(a),f=i.fP(),s=i.qF(i.Tb),f<1&&(f=1)),e.m4(t),e.v4(h),e.d4(f),e.w4(),e.value(s))},z.prototype.FM=function(){for(var t,n,e,i,r,o,a,t=this,n=t.getRowCount(),e=t.getColumnCount(),i=0;i<n;i++)for(r=0;r<e;r++)(o=t.getValue(i,r))instanceof Date&&((a=t.Z_(i,r))&&a.g5(o),t.CL(i,r,a))},z.prototype.GB=function(t,n){var e=this;1===e.getRowCount(_.SheetArea.colHeader)&&(e.qL(t,n,bt,!1,_.SheetArea.colHeader),e.Zw=!0,e.zw())},z.prototype.Lt=function(t){var n;return this.Ut.getColumnHeaderFitMode(!1,1,t)},z.prototype.vL=function(t,n,e,i,r){var o,a,r,e,u,s,s,s,s,c;return D(i)&&(i=3),o=this,r||(a=o.t0(t,n,i),D(a))?(r=o.getCellType(t,n,i),e=e,"General"===(u=!(u=(u=o.l0(t,n,"formatter",i))&&"General"!==u?u:o.l0(t,n,"_autoFormatter",i))&&(s=o.pivotTables,s=3===i&&s?s.findPivotTable(t,n):N)?(s=s.hqt(t,n))&&s.formatter:u)&&(u=O),s={},c=o.l0(t,n,"quotePrefix",i),(e=r.format(e,u,s,{sheet:o,row:t,col:n,sheetArea:i,quotePrefix:c}))&&"string"==typeof e?e.replace(/\r\n?/g,"\n"):e):a},z.prototype.isRowFilterOut=function(t){return this.XT(t)},z.prototype.getHDockScrollbarWidth=function(){var t,n,e,i,r,o,a,u,t=this.getDockScrollbarAttachedIndex(),n,e=0;return e=this.Vy&&!D(t)&&(i=this.frozenTrailingColumnCount(),(o=(r=this.getColumnCount())-i)<=t||t<=(a=r-1))?(u=this.Fi()).zy:e},z.prototype.getDockScrollbarAttachedIndex=function(){return this.wP},z.prototype.setDockScrollbarAttachedIndex=function(t){this.wP=t,this.Zw=!0,this.zw()},z.prototype.vP=function(){var t,n,e,t,t=this.getDockScrollbarAttachedIndex(),n,e,t=this.Ut.Q_(!1,_.SheetArea.viewport).NE(t);this.mP=t},z.prototype.gP=function(){var t,n,e,i,e,t,n,e=this.Ut.Q_(!1,_.SheetArea.viewport).EE(),i=this.mP,e=e.indexOf(i);this.setDockScrollbarAttachedIndex(e=-1===e?N:e)},z.prototype.setScrollableColumnIndexInFrozenTrailingColumnArea=function(t){var n,e,i,r;0<=t&&(t+=i=(n=this.getColumnCount())-(e=this.frozenTrailingColumnCount()))<=(r=n-1)&&this.setDockScrollbarAttachedIndex(t)},z.prototype.getColumnScrollWidth=function(t){var n,e,n,e;return this.Ut.Q_(!1,_.SheetArea.viewport).getScrollContentWidth(t)},z.prototype.setColumnScrollWidth=function(t,n){var e,i,e,i;this.Ut.Q_(!1,_.SheetArea.viewport).setScrollContentWidth(t,n),this.Zw=!0,this.zw()},z.prototype.getColumnScrollOffsetX=function(t){var n,e,n,e;return this.Ut.Q_(!1,_.SheetArea.viewport).getScrollOffsetX(t)},z.prototype.setColumnScrollOffsetX=function(t,n){var e,i,e,i;this.Ut.Q_(!1,_.SheetArea.viewport).setScrollOffsetX(t,n),this.JF(),this.n3(),this.LL(t)},z.prototype.scrollColumnView=function(t,n){var e,i,r,o,a,u,e,i=this.Ut.Q_(!1,_.SheetArea.viewport),r=this.getColumnWidth(t),o=this.getColumnScrollWidth(t),a=this.getColumnScrollOffsetX(t),u=a+n;0<u?n=-a:u<r-o&&(n=r-o-a),i.setScrollOffsetX(t,n,!0),this.JF(),this.n3(),this.LL(t)},z.prototype.getScrollTooltipContent=function(t,n){var e,i,t,i,e="",i=this.Ab+1;return t?e=g().Tip_Row+(this.Tb+1):(t=this.getDockScrollbarAttachedIndex(),n&&!D(t)&&(i=this.getDockScrollbarAttachedIndex()+1),1!==this.options.colHeaderAutoText&&(i=A.util.Vf(i)),e=g().Tip_Column+i,n&&!D(t)&&(i=T(this.getColumnScrollOffsetX(t)),e+=" ".concat(g().Tip_Column_Offset,": ").concat(i))),e},z.prototype.expandSelection=function(t,n){for(var e,i,r,o,a,u,e=new A.Range(n.row,n.col,n.rowCount,n.colCount),i=new A.Range(n.row,n.col,n.rowCount,n.colCount),r=!0,o=!0,a=!0,u=!0;r||o||a||u;)r&&A.util.X0(t,e.row-1,e.col-1,e.colCount+2)&&(e.row=e.row-1,e.rowCount=e.rowCount+1),o&&A.util.X0(t,e.row+e.rowCount,e.col-1,e.colCount+2)&&(e.rowCount=e.rowCount+1),a&&A.util.q0(t,e.row-1,e.col-1,e.rowCount+2)&&(e.col=e.col-1,e.colCount=e.colCount+1),u&&A.util.q0(t,e.row-1,e.col+e.colCount,e.rowCount+2)&&(e.colCount=e.colCount+1),u=a=o=r=!1,t.getText(e.row-1,e.col-1)&&(r=a=!0),t.getText(e.row-1,e.col+e.colCount)&&(r=u=!0),t.getText(e.row+e.rowCount,e.col-1)&&(a=o=!0),t.getText(e.row+e.rowCount,e.col+e.colCount)&&(u=o=!0),i.row===e.row?i.rowCount===e.rowCount-1&&(o=!0):(r=!0,i.rowCount===e.rowCount-2&&(o=!0)),i.col===e.col?i.colCount===e.colCount-1&&(u=!0):(a=!0,i.colCount===e.colCount-2&&(u=!0)),i.row=e.row,i.col=e.col,i.rowCount=e.rowCount,i.colCount=e.colCount;return e},z.prototype.deleteBlankContent=function(t,n){1===n.rowCount&&1===n.colCount||(A.util.X0(t,n.row,n.col,n.colCount)||(n.row=n.row+1,n.rowCount=n.rowCount-1),A.util.X0(t,n.row+n.rowCount-1,n.col,n.colCount)||(n.rowCount=n.rowCount-1),A.util.q0(t,n.row,n.col,n.rowCount)||(n.col=n.col+1,n.colCount=n.colCount-1),A.util.q0(t,n.row,n.col+n.colCount-1,n.rowCount))||(n.colCount=n.colCount-1)},z.prototype.MP=function(){return!1},z.prototype.FT=function(){return g().Exp_InvalidOperationInProtect},z.prototype.Ci=function(t,n,e){return this.CP(t,n,e)},z.prototype.CP=function(t,n,e){return this.Ut.Ci(t,n,e)},z.prototype.R2e=function(){return this.options.sheetTabColor},z.prototype.parameter=function(t){var n,e,i,r;if(0===arguments.length){for(i in e={},n=this.ghe)n.hasOwnProperty(i)&&(e[i]=d(n[i]));return e}if(t){for(i in r={},t)t.hasOwnProperty(i)&&(r[i]=$(t[i]));this.ghe=r}},z.prototype.continuousPaginateLargeColumn=function(){return!1},z.prototype.$t=function(t,n,e,i){return this.getValue(t,n,e,i)},z.prototype.o2e=function(t,n,e,i,r){return this.getActualStyle(t,n,e,i,r)},z.prototype.isActualProtected=function(){return this.options.isProtected},z.prototype.getAutoFormatter=function(t,n){var t;return null==(t=this.getStyle(t,n))?void 0:t._autoFormatter},z.rL=1,z.Pp=St,z.n8=200,z.e8=20,z.r8=1,z.o8=1,Tt=z,t.Worksheet=Tt,(0,A.$e)(Tt),(At=Tt.prototype).visible=Q("visible",_.SheetTabVisible.visible,function(t){var n,e,i,r,o,a,u,s,n=this,e=n.parent,i=e.sheets,r=i.length,o=l.GC$.inArray(n,i),a=e.getActiveSheetIndex(),u="visible";if(!0!==t&&!1!==t&&t!==_.SheetTabVisible.visible&&t!==_.SheetTabVisible.hidden&&t!==_.SheetTabVisible.veryHidden&&(n._ps[u]=_.SheetTabVisible.visible),!0===t?n._ps[u]=_.SheetTabVisible.visible:!1===t&&(n._ps[u]=_.SheetTabVisible.hidden),t===_.SheetTabVisible.visible||!0===t)a<0?(e.tb(o,1),e.w2&&e.w2.om<0&&(e.w2.om=o)):e.Xg();else if(o===a){for(s=o+1;s<r&&i[s].visible()!==_.SheetTabVisible.visible;)s++;if(r<=s)for(s=o-1;0<=s&&i[s].visible()!==_.SheetTabVisible.visible;)s--;e.w2&&s<e.w2.om&&(e.w2.om=s),s<0?(n.L0(!1),e._2=s,e.Cg()):(e.tb(s,1),t===_.SheetTabVisible.veryHidden&&i[a]&&e.a3(i[a]))}else e.Xg()})},"./dist/plugins/autoMerge/autoMerge.js":function(F,t,n){"use strict";var e,b,i,n,a,u,s,n,c,w,l,h,y,M,C,r,o,f,i,n,i,d;function v(t,n){var t=d.call(this,t.row,t.col,t.rowCount,t.colCount)||this;return t.sheetArea=n,t.isAutoMerge=!0,t}function m(t,n,e){return e+"_"+t+"_"+n}function g(t,n,e){return n===t||(n===b.SheetArea.viewport?e&&t===b.SheetArea.rowHeader||!e&&t===b.SheetArea.colHeader:n===b.SheetArea.rowHeader?e&&t===b.SheetArea.viewport:n===b.SheetArea.colHeader&&!e&&t===b.SheetArea.viewport)}function p(t,n,e){t.clearSpan(n.row,n.col,n.rowCount,n.colCount,e)}function S(t,n,e){var i,r,o,a,u,s,c,f,l,h;return e===b.SheetArea.viewport&&!t.options.allowCellOverflow&&(i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=t.frozenRowCount(),s=t.frozenColumnCount(),c=t.frozenTrailingRowCount(),f=t.frozenTrailingColumnCount(),l=t.getRowCount(),h=t.getColumnCount(),0===u||-1!==i&&u<=i)&&(0===s||-1!==r&&s<=r)&&(0===c||-1!==i&&i+o<=l-c)&&(0===f||-1!==r&&r+a<=h-f)?((-1===r||0===r&&a===h)&&(r=t.getViewportLeftColumn(1),a=t.getViewportRightColumn(1)-r+1),(-1===i||0===i&&o===l)&&(i=t.getViewportTopRow(1),o=t.getViewportBottomRow(1)-i+1),(0,b.Ec)(i,r,o,a)):t.JS(n,e)}function T(t){this.Mf=t,this.SP=[],this.cE={},this.TP=[]}function A(t,n){var e,i,r,o,t,e=[],i=t.spans;if(i)for(r=0;r<i.length;r++)(o=i[r])&&e.push({n_:b.XFileConstants.xu,ref:u(o)});t=a(n,s),0<e.length&&(t?t.c_=t.c_.concat(e):(n.c_.push({n_:s,c_:e}),b.util.Pr(n,[b.XFileConstants.Su,b.XFileConstants.Tu,b.XFileConstants.Du,b.XFileConstants._u,b.XFileConstants.Eu,b.XFileConstants.bo,"sheetProtection","autoFilter",s,b.XFileConstants.ju,b.XFileConstants.Ou,b.XFileConstants.ku,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing","legacyDrawing",b.XFileConstants.Fo,b.XFileConstants.Bo,b.XFileConstants.Bu,b.XFileConstants.Au])))}function I(t,n){var e,e,e,e=t.ZF(b.SheetArea.viewport);0<e.length&&(n.spans?n.spans=n.spans.concat(e):n.spans=e),0<(e=t.ZF(b.SheetArea.rowHeader)).length&&(n.rowHeaderSpan?n.rowHeaderSpan=n.rowHeaderSpan.concat(e):n.rowHeaderSpan=e),0<(e=t.ZF(b.SheetArea.colHeader)).length&&(n.colHeaderSpan?n.colHeaderSpan=n.colHeaderSpan.concat(e):n.colHeaderSpan=e)}function x(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r={},o=[],a=e.row,u=e.row+e.rowCount-1,s=e.col,c=e.col+e.colCount-1,f=s;f<=c;f++)if(t.getColumnVisible(f,i)&&!(t.getColumnWidth(f,i)<=0)){for(h=(l=n===w.restricted)&&s<f,d=void 0,v=a;v<=u;)if(!t.getRowVisible(v,i)||t.getRowHeight(v,i)<=0)v++;else{if((m=t.j5(v,i,!0))===C||u<m)break;if(D(t,v,f,m,f,i)){if(h&&!N(t,r,v,f,m,f,i)){d&&(g=new y(d,i),o.push(g),E(r,d,g),d=M),v=m;continue}p=m-v+1,d?d.rowCount+=p-1:d=(0,b.Ec)(v,f,p,1)}else d&&(g=new y(d,i),o.push(g),E(r,d,g),d=M);v=m}d&&(g=new y(d,i),o.push(g),E(r,d,g),d=M)}return{cache:r,spans:o}}function N(t,n,e,i,r,o,a){var u,n,u,n=n[m(e,t.r6(i,a,!0),a)];return n&&n.sheetArea===a&&n.row<=e&&r<=n.row+n.rowCount-1}function k(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r={},o=[],a=e.row,u=e.row+e.rowCount-1,s=e.col,c=e.col+e.colCount-1,f=a;f<=u;f++)if(t.getRowVisible(f,i)&&!(t.getRowHeight(f,i)<=0)){for(h=(l=n===w.restricted)&&a<f,d=void 0,v=s;v<=c;)if(!t.getColumnVisible(v,i)||t.getColumnWidth(v,i)<=0)v++;else{if((m=t.O5(v,i,!0))===C||c<m)break;if(D(t,f,v,f,m,i)){if(h&&!_(t,r,f,v,f,m,i)){d&&(g=new y(d,i),o.push(g),E(r,d,g),d=M),v=m;continue}p=m-v+1,d?d.colCount+=p-1:d=(0,b.Ec)(f,v,1,p)}else d&&(g=new y(d,i),o.push(g),E(r,d,g),d=M);v=m}d&&(g=new y(d,i),o.push(g),E(r,d,g),d=M)}return{cache:r,spans:o}}function _(t,n,e,i,r,o,a){var u,n,u,n=n[m(t.nI(e,a,!0),i,a)];return n&&n.sheetArea===a&&n.col<=i&&o<=n.col+n.colCount-1}function D(t,n,e,i,r,o){var a,u,s,c,f,l,a=t.Ut,u=t.getText(n,e,o),s=t.getText(i,r,o),c="[object Object]",f,l;return!(""===u&&""===s&&!t.NMi||u===c&&s===c||u!==s||a.findSpan(n,e,o)||a.findSpan(i,r,o))}function j(t,n,e,i){for(var n,r,o,n,a,u,s,c,f,l,h,d,h,d,n=x(t,n,e,i),r=n.cache,o=n.spans,n=e.row,a=e.row+e.rowCount-1,u=e.col,s=e.col+e.colCount-1,c=n;c<=a;c++)if(t.getRowVisible(c,i)&&!(t.getRowHeight(c,i)<=0))for(f=u;f<=s;f++)if(t.getColumnVisible(f,i)&&!(t.getColumnWidth(f,i)<=0)){if((l=t.O5(f,i,!0))===C||s<l)break;D(t,c,f,c,l,i)&&(h=r[m(c,f,i)],d=r[m(c,l,i)],h&&d?h.row===c&&d.row===c&&h.rowCount===d.rowCount&&(h.colCount+=l-f,O(o,d),E(r,d,h)):h?1===h.rowCount&&(h.colCount+=l-f,E(r,new b.Range(c,l,1,1),h)):d?1===d.rowCount&&(d.col=f,d.colCount+=l-f,E(r,new b.Range(c,f,1,1),d)):(h=new b.Range(c,f,1,l-f+1),d=new y(h,i),o.push(d),E(r,h,d)))}return{cache:r,spans:o}}function O(t,n){for(var e,i,e=0;e<t.length;e++)if((i=t[e]).sheetArea===n.sheetArea&&i.equals(n)){t.splice(e,1);break}}function E(t,n,e){for(var i,r,o,i=e.sheetArea,r=0;r<n.rowCount;r++)for(o=0;o<n.colCount;o++)t[m(n.row+r,n.col+o,i)]=e}function R(t,n,e,i){for(var n,r,o,a,u,n,s,c,f,l,h,d,h,d,n=k(t,n,e,i),r=n.cache,o=n.spans,a=e.row,u=e.row+e.rowCount-1,n=e.col,s=e.col+e.colCount-1,c=n;c<=s;c++)if(t.getColumnVisible(c,i)&&!(t.getColumnWidth(c,i)<=0))for(f=a;f<=u;f++)if(t.getRowVisible(f,i)&&!(t.getRowHeight(f,i)<=0)){if((l=t.j5(f,i,!0))===C||u<l)break;D(t,f,c,l,c,i)&&(h=r[m(f,c,i)],d=r[m(l,c,i)],h&&d?h.col===c&&d.col===c&&h.colCount===d.colCount&&(h.rowCount+=l-f,O(o,d),E(r,d,h)):h?1===h.colCount&&(h.rowCount+=l-f,E(r,new b.Range(l,c,1,1),h)):d?1===d.colCount&&(d.row=f,d.rowCount+=l-f,E(r,new b.Range(f,c,1,1),d)):(h=new b.Range(f,c,l-f+1,1),d=new y(h,i),o.push(d),E(r,h,d)))}return{cache:r,spans:o}}e=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionMode=t.AutoMergeDirection=t.AutoMergeMode=t.SR=void 0,b=n("Core"),i=n("Common"),n=n("./dist/plugins/autoMerge/autoMerge.res.en.js"),t.SR={en:n},a=b.util.xr,u=b.range_parser.jc,s=b.XFileConstants.Iu,n=new i.Common.ResourceManager(t.SR,"AutoMerge"),c=n.getResource.bind(n),(i=w=t.AutoMergeMode||(t.AutoMergeMode={}))[i.free=0]="free",i[i.restricted=1]="restricted",(n=l=t.AutoMergeDirection||(t.AutoMergeDirection={}))[n.none=0]="none",n[n.column=1]="column",n[n.row=2]="row",n[n.columnRow=3]="columnRow",n[n.rowColumn=4]="rowColumn",(i=h=t.SelectionMode||(t.SelectionMode={}))[i.source=0]="source",i[i.merged=1]="merged",d=b.Range,e(v,d),y=v,M=void 0,C=null,T.prototype.L0=function(){this.Mf=C},T.prototype.add=function(t,n,e,i,r){var o,a,u,s;for(void 0===i&&(i=b.SheetArea.viewport),void 0===r&&(r=h.source),a=0,u=o=this.all();a<u.length;a++)if((s=u[a]).sheetArea===i&&s.range.intersect(t.row,t.col,t.rowCount,t.colCount))throw new Error(c().Exp_RangeIsIntersected);this.SP.push({range:t,direction:n,mode:e,sheetArea:i,selectionMode:r})},T.prototype.remove=function(t,n){var e,i,r,o;for(void 0===n&&(n=b.SheetArea.viewport),e=this.SP,i=this.Mf.Ut,r=0;r<e.length;r++)if((o=e[r]).sheetArea===n&&o.range.equals(t)){p(i,t,n),e.splice(r,1);break}},T.prototype.clear=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=this.SP,e=this.Mf.Ut,i=0;i<n.length;i++)r=n[i],t!==M&&t!==r.sheetArea||p(e,r.range,r.sheetArea);if(t===M)this.SP=[],this.cE={},this.TP=[];else{for(i=(o=this.SP).length-1;0<=i;i--)o[i].sheetArea===t&&o.splice(i,1);for(s in u=[],a=this.cE)a[s].sheetArea===t&&u.push(s);for(c=0,f=u;c<f.length;c++)delete a[s=f[c]];for(i=(l=this.TP).length-1;0<=i;i--)l[i].sheetArea===t&&l.splice(i,1)}},T.prototype.all=function(){return this.SP},T.prototype.Sb=function(n){return this.SP.some(function(t){return t.range.containsRange(n)})},T.prototype.AP=function(t){this.SP=t,this.IP()},T.prototype.D7=function(t,n,e){void 0===e&&(e=b.SheetArea.viewport);var t=this.cE[m(t,n,e)];return t?(0,b.Ec)(t.row,t.col,t.rowCount,t.colCount):C},T.prototype.ZF=function(n){return void 0===n&&(n=b.SheetArea.viewport),this.TP.filter(function(t){return t.sheetArea===n})},T.prototype.IP=function(a,u){var t,s,c,n,f,e,i,r;for(this.cE={},this.TP=[],t=this.SP,s=this.Mf,c=s.Ut,n=function(t){var n,e,i,r,t,o,n=t.direction,e=t.mode,i=t.sheetArea,r=u?s.JS(t.range,i):S(s,t.range,i),t=t.selectionMode===h.merged;(t||a)&&p(c,r,i),o=void 0,n===l.column?o=x(s,e,r,i):n===l.row?o=k(s,e,r,i):n===l.columnRow?o=j(s,e,r,i):n===l.rowColumn&&(o=R(s,e,r,i)),o&&(b.GC$.extend(f.cE,o.cache),f.TP=f.TP.concat(o.spans),t)&&o.spans.forEach(function(t){c.addSpan(t,i)})},f=this,e=0,i=t;e<i.length;e++)n(r=i[e])},T.prototype.JO=function(t,n,e){var i,r,o,a,a,u;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0))for(r=0,o=i=this.SP;r<o.length;r++)g((a=o[r]).sheetArea,e,!0)&&(t<=(u=(a=a.range).row)?a.row+=n:u<t&&t<u+a.rowCount&&(a.rowCount+=n))},T.prototype.qO=function(t,n,e){var i,r,o,a,a,u;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0))for(r=0,o=i=this.SP;r<o.length;r++)g((a=o[r]).sheetArea,e,!1)&&(t<=(u=(a=a.range).col)?a.col+=n:u<t&&t<u+a.colCount&&(a.colCount+=n))},T.prototype.xP=function(t,n,e){var i,r,o,a,a,u,s,c,f;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0)){for(i=this.SP,r=[],o=0;o<i.length;o++)g((a=i[o]).sheetArea,e,!0)&&(u=(a=a.range).row,s=a.rowCount,t<u?((c=t+n-u)<=0?u-=n:(u-=c,a.rowCount-=c),u<0&&(a.rowCount+=u,u=0),a.row=u):u<=t&&t<u+s&&(a.rowCount-=Math.min(n,u+s-t)),0===a.rowCount)&&r.push(o);for(f=r.length-1;0<=f;f--)i.splice(r[f],1)}},T.prototype.NP=function(t,n,e){var i,r,o,a,a,u,s,c,f;if(void 0===e&&(e=b.SheetArea.viewport),!(t<0||n<=0)){for(i=this.SP,r=[],o=0;o<i.length;o++)g((a=i[o]).sheetArea,e,!1)&&(u=(a=a.range).col,s=a.colCount,t<u?((c=t+n-u)<=0?u-=n:(u-=c,a.colCount-=c),u<0&&(a.colCount+=u,u=0),a.col=u):u<=t&&t<u+s&&(a.colCount-=Math.min(n,u+s-t)),0===a.colCount)&&r.push(o);for(f=r.length-1;0<=f;f--)i.splice(r[f],1)}},T.prototype.kP=function(t,n){var e,i,r;for(void 0===n&&(n=b.SheetArea.viewport),i=(e=this.SP).length-1;0<=i;i--)-1!==(r=e[i].range).row&&g(e[i].sheetArea,n,!0)&&(r.row>t-1?e.splice(i,1):r.row+r.rowCount-1>t-1&&(r.rowCount=t-1-r.row+1))},T.prototype.DP=function(t,n){var e,i,r;for(void 0===n&&(n=b.SheetArea.viewport),i=(e=this.SP).length-1;0<=i;i--)-1!==(r=e[i].range).col&&g(e[i].sheetArea,n,!1)&&(r.col>t-1?e.splice(i,1):r.col+r.colCount-1>t-1&&(r.colCount=t-1-r.col+1))},T.prototype.toJSON=function(){return this.SP.map(function(t){var n=t.range;return{range:{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount},direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}})},T.prototype.fromJSON=function(t){var n,e,i,r,o,a;if(t)for(n=this.SP,e=0,i=t;e<i.length;e++)o=(r=i[e]).range,(a=r.selectionMode)===M&&(a=h.source),n.push({range:(0,b.Ec)(o.row,o.col,o.rowCount,o.colCount),direction:r.direction,mode:r.mode,sheetArea:r.sheetArea,selectionMode:a})},r=T,b.GC$.extend(b.Y8.prototype,{_P:function(t){var n,e,n,n=this,e=n.G8;!e||!t&&e.originalAutoMerge||(n=n.Cb.all().map(function(t){var n=t.range;return{range:(0,b.Ec)(n.row,n.col,n.rowCount,n.colCount),direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}}),t?e.currentAutoMerge=n:e.originalAutoMerge=n)},EP:function(t){t&&this.Cb.AP(t)},jP:function(t,n,e){this._P(),this.Cb.JO(t,n,e),this._P(!0)},OP:function(t,n,e){this._P(),this.Cb.xP(t,n,e),this._P(!0)},RP:function(t,n,e){this._P(),this.Cb.qO(t,n,e),this._P(!0)},BP:function(t,n,e){this._P(),this.Cb.NP(t,n,e),this._P(!0)},LP:function(t,n){this._P(),this.Cb.kP(t,n),this._P(!0)},FP:function(t,n){this._P(),this.Cb.DP(t,n),this._P(!0)}}),b.Y8.ch(o="autoMerge",{init:function(){this.Cb=new r(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalAutoMerge:n.currentAutoMerge)&&this.EP(t)},undo:function(t){var t=t.originalAutoMerge;t&&this.EP(t)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.Cb&&(n.Cb.L0(),n.Cb=C)}}),b.Worksheet.ch(o,{init:function(){var u,s,u=this,s=u.Cb=u.Ut.Cb;u.unbind(b.Events.TopRowChanged+"."+o),u.unbind(b.Events.LeftColumnChanged+"."+o),u.bind(b.Events.TopRowChanged+"."+o,function(){var t,n,e,i,r,o,a,o,o,t=s.all();if(0<t.length)for(n=u.frozenColumnCount(),e=u.getColumnCount()-u.frozenTrailingColumnCount()-1,i=0,r=t;i<r.length;i++)a=(o=r[i]).sheetArea,o=o.range,a===b.SheetArea.viewport?((-1===o.col||o.col<n)&&u.repaint(u.getRangeRect(1,0,o)),(-1===o.col||o.col<=e&&o.col+o.colCount>=n)&&u.repaint(u.getRangeRect(1,1,o)),(-1===o.col||o.col+o.colCount>e)&&u.repaint(u.getRangeRect(1,2,o))):a===b.SheetArea.rowHeader&&(o=u.Fi(),u.repaint(o.B1(1)))}),u.bind(b.Events.LeftColumnChanged+"."+o,function(){var t,n,e,i,r,o,a,o,o,t=s.all();if(0<t.length)for(n=u.frozenRowCount(),e=u.getRowCount()-u.frozenTrailingRowCount()-1,i=0,r=t;i<r.length;i++)a=(o=r[i]).sheetArea,o=o.range,a===b.SheetArea.viewport?((-1===o.row||o.row<n)&&u.repaint(u.getRangeRect(0,1,o)),(-1===o.row||o.row<=e&&o.row+o.rowCount>=n)&&u.repaint(u.getRangeRect(1,1,o)),(-1===o.row||o.row+o.rowCount>e)&&u.repaint(u.getRangeRect(2,1,o))):a===b.SheetArea.colHeader&&(o=u.Fi(),u.repaint(o.L1(1)))})},dispose:function(t){!1!==t.clearCache&&(this.Cb=C,this.unbind(b.Events.TopRowChanged+"."+o),this.unbind(b.Events.LeftColumnChanged+"."+o))},onLayoutChanged:function(t){var n,e,i,r,o,t,a,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,t=t.sheetArea,a=this.Ut;"addRows"===n?a.jP(e,i,t):"deleteRows"===n?a.OP(e,i,t):"addColumns"===n?a.RP(r,o,t):"deleteColumns"===n?a.BP(r,o,t):"setRowCount"===n?a.LP(i,t):"setColumnCount"===n&&a.FP(o,t),"invalidateLayout"===n&&this.My<=0&&this.Cb.IP()},toJson:function(t,n){var e,i,e;n&&n.ignoreStyle||(i=this.Cb,t.autoMergeRangeInfos=i.toJSON(),n&&n.includeAutoMergedCells&&(i.IP(!0,!0),I(i,t)))},fromJson:function(t,n,e){var i;e&&e.ignoreStyle||this.Cb.fromJSON(t.autoMergeRangeInfos)},wh:function(t,n,e){var i,r,o,e,i;e&&!1===e.includeStyles||(t.lossless.autoMerge={},r=this.Cb,t.lossless.autoMerge.autoMergeRangeInfos=r.toJSON(),o=r.Mf.NMi,e&&e.includeAutoMergedCells&&!o&&(e={},r.IP(!0,!0),I(r,e),A(e,t)))},yh:function(t,n,e){var i;e&&!1===e.includeStyles||!t.lossless||!t.lossless.autoMerge||this.Cb.fromJSON(t.lossless.autoMerge.autoMergeRangeInfos)}}),b.Workbook.ch(o,{onCultureChanged:function(){c()}}),b.GC$.extend(b.Worksheet.prototype,{autoMerge:function(t,n,e,i,r){void 0===n&&(n=l.column),void 0===e&&(e=w.free),void 0===i&&(i=b.SheetArea.viewport),void 0===r&&(r=h.source);var o=this.Cb;if(0===arguments.length)return o.all();t&&(this.Ut._P(),n===l.none?o.remove(t,i):o.add(t,n,e,i,r),this.zw())}})},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_RangeIsIntersected=void 0,n.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},"./dist/plugins/cellState/cellStateManager.js":function(t,n,e){"use strict";var o,a,i,b,w,e,f,i,y,r,u,n,s;function c(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return new b.Range(n,e,i,t)}function l(t,n){this.Mf=t,this.Kh=n,this.cE=[];for(var e=1;e<=3;e++)this.PP(e)}function h(t){this.Mf=t,this.GP={}}function d(n,t,e){var i=[],r=n.getRowCount(3),o=n.getColumnCount(3);return t.forEach(function(t){i=i.concat(g(n,t.style,t.range,e,r,o))}),i}function v(t){for(var n,e,i,r,o,e,a,u,s,c,e,n=[],i=0,r=t.length;i<r;i++)o=(e=t[i]).style,e={range:{row:a=(e=e.range).row,col:u=e.col,colCount:s=e.colCount,rowCount:c=e.rowCount},style:o.toJSON()},n.push(e);return n}function m(t,n,e,i){for(var r,r,o,a,u,s,c,f,u,r,l,o=0,a=n.length;o<a;o++)s=(u=(r=n[o]).range).row,c=u.col,f=u.rowCount,u=u.colCount,r=r.style,(l=new b.Style).fromJSON(r,e,i),r={style:l,range:new b.Range(s,c,f,u)},t.push(r)}function g(t,n,e,i,r,o){var a;return t.BR(e,i,r,o).map(function(t){return{range:t,style:n}})}function p(t,n,e){return e.contains(t,n)}function M(t){var n=t.range,e=t.style;return n.constructor.name===Object&&((n=new b.Range(0,0,1,1)).fromJSON(t.range),(e=new b.Style).fromJSON(t.style)),{range:n,style:e}}o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},a=this&&this.__rest||function(t,n){var e,i,r,e={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Object.defineProperty(n,"__esModule",{value:!0}),n.CellStateManager=void 0,i=e("Common"),b=e("Core"),w=i.Common.lt.ht,e=b.GC$.extend,f=void 0,i="cellState",y=[b.CellStatesType.readonly,b.CellStatesType.invalid,b.CellStatesType.dirty,b.CellStatesType.invalidFormula,b.CellStatesType.selected,b.CellStatesType.active,b.CellStatesType.hover,b.CellStatesType.edit],l.prototype.PP=function(t){this.cE[t]=[]},l.prototype.UP=function(t){return this.cE[t]},l.prototype.HP=function(t,n){this.cE[n]=t},l.prototype.zP=function(t,n){for(var e,i,r,e=0,i=t.length;e<i;e++)if((r=t[e]).range.equals(n))return e;return-1},l.prototype.VP=function(t,n){var e,i,t,r,e=this,i=e.UP(n),t=this.zP(i,t);-1<t&&(r=i[t],e.YP(t,r.range,r.style,i,n),i.splice(t,1))},l.prototype.ZP=function(t,n,e){var i,r,o,a,i=this,r=i.UP(e),o=i.zP(r,t),a={range:t,style:n};i.WP({index:o,cache:r,range:t,style:n,sheetArea:e}),-1===o?r.push(a):r[o]=a},l.prototype.QP=function(t){var t=this.UP(t),e=this.Kh;return t.map(function(t){var n=t.range,t=t.style;return{range:c(n),style:t.clone(),state:e}})},l.prototype.ML=function(t,n,e){for(var i,r,o,a,u,i=this.UP(e),o=[],a=i.length,u=0;u<a;u++)p(t,n,(r=i[u]).range)&&o.push(r);return 0<o.length?o:null},l.prototype.KP=function(t,n,e){var i,e,r,o,a,i,e=this.UP(e);if(e&&0<e.length)for(r=0,o=e;r<o.length;r++)if(p(t,n,a=o[r].range))return!0;return!1},l.prototype.JP=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,a=this,u=a.Mf,s=a.UP(r);if(s&&0===s.length)return!1;if(a.Kh===b.CellStatesType.dirty&&(w(i)||0<(i&a.Kh)))return u.reportSheet&&u.reportSheet.internalIsDirtyCell?!!u.reportSheet.internalIsDirtyCell(n,e,r):u.XP(n,e,r);if(a.Kh===b.CellStatesType.selected&&(w(i)||0<(i&a.Kh))){for(f=0,l=c=a.Mf.getSelections();f<l.length;f++)if(p(n,e,h=l[f]))return!0;return!1}return a.Kh===b.CellStatesType.invalid?!(!u.isValid||!(w(i)||0<(i&a.Kh))||u.isValid(n,e,u.getValue(n,e,r))):a.Kh===b.CellStatesType.readonly?o&&a.Mf.isActualProtected():0<(a.Kh&t)},l.prototype.qP=function(t,n){var e=this,i=this.UP(n);this.$P({cache:i,sheetArea:n,collection:e,state:e.Kh,range:t}),this.HP(d(this.Mf,i,t),n)},l.prototype.toJSON=function(){for(var t,n,e,i,t=this,n={},i=0;i<=3;i++)(e=t.UP(i))&&0<e.length&&(n[i]=v(e));return n},l.prototype.fromJSON=function(t,n,e){var i,r,o,a,i=this;for(i.cE=[],o=1;o<=3;o++)i.PP(o);for(a in t)t.hasOwnProperty(a)&&m(r=i.UP(a),t[a],n,e)},l.prototype.tG=function(t){var t,n,e,t=a(t,[]),n=this,e;n.Mf.Ut.nG(o({type:"rangeChange",state:n.Kh},t))},l.prototype.WP=function(t){var n,e,i,r,t,o,a,n=t.index,e=t.cache,i=t.range,r=t.style,t=t.sheetArea,o=this,a=o.Mf.Ut;-1!==n&&(r=e[n].style),a.nG({type:"add",index:n,cache:e,state:o.Kh,range:i,style:r,sheetArea:t})},l.prototype.YP=function(t,n,e,i,r){var o=this,a;o.Mf.Ut.nG({type:"remove",index:t,range:n,style:e,cache:i,state:o.Kh,sheetArea:r})},l.prototype.$P=function(t){var t,n,e,t=a(t,[]),n=this,e;n.Mf.Ut.nG(o({type:"clear",state:n.Kh},t))},l.prototype.JO=function(o,a){for(var u,s,t,n,u=this,t=function(r){(s=u.UP(r))&&0<s.length&&s.forEach(function(t,n){var t,e,i,t=t.range,e=t.row,i=t.rowCount;o<=e?(t.row=e+a,u.tG({cache:s,range:t,row:e,index:n,sheetArea:r})):e<o&&o<e+i&&(t.rowCount=t.rowCount+a,u.tG({cache:s,range:t,rowCount:i,index:n,sheetArea:r}))})},n=0;n<=3;n++)t(n)},l.prototype.xP=function(a,u){for(var s,c,t,n,s=this,t=function(o){(c=s.UP(o))&&0<c.length&&c.forEach(function(t,n){var t,e,i,r,t=t.range,e=t.row,i=t.rowCount;a<e?((r=a+u-e)<=0?e-=u:(e-=r,t.rowCount-=r),e<0&&(t.rowCount=i+e,e=0),t.row=e,s.tG({cache:c,range:t,row:e,rowCount:i,index:n,sheetArea:o})):e<=a&&a<e+i&&(t.rowCount=t.rowCount-Math.min(u,e+i-a),s.tG({cache:c,range:t,rowCount:i,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},l.prototype.qO=function(o,a){for(var u,s,t,n,u=this,t=function(r){(s=u.UP(r))&&0<s.length&&s.forEach(function(t,n){var t,e,i,t=t.range,e=t.col,i=t.colCount;o<=e?(t.col=e+a,u.tG({cache:s,range:t,col:e,index:n,sheetArea:r})):e<o&&o<e+t.colCount&&(t.colCount=i+a,u.tG({cache:s,range:t,colCount:i,index:n,sheetArea:r}))})},n=0;n<=3;n++)t(n)},l.prototype.NP=function(a,u){for(var s,c,t,n,s=this,t=function(o){(c=s.UP(o))&&0<c.length&&c.forEach(function(t,n){var t,e,i,r,t=t.range,e=t.col,i=t.colCount;a<e?((r=a+u-e)<=0?e-=u:(e-=r,t.colCount-=r),e<0&&(t.colCount+=e,e=0),t.col=e,s.tG({cache:c,range:t,col:e,colCount:i,index:n,sheetArea:o})):e<=a&&a<e+i&&(t.colCount-=Math.min(u,e+i-a),s.tG({cache:c,range:t,colCount:i,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},l.prototype.eG=function(){this.cE=[],this.Mf=null},r=l,h.prototype.getCollection=function(t,n){var e=this;return!e.GP[t]&&n&&(e.GP[t]=new r(e.Mf,t)),e.GP[t]},h.prototype.hasIntersectInSelectionState=function(t,n,e,i){var r,o,o,a,u,s,r,o=this.GP[b.CellStatesType.selected];if(o&&(o=o.UP(b.SheetArea.viewport))&&0<o.length)for(a=0,u=o;a<u.length;a++)if((s=u[a].range).intersect(t,n,e,i))return!0;return!1},h.prototype.getState=function(t,n,e){var i;return this.Mf.Ut.W_(e).getCellState(t,n)||0},h.prototype.remove=function(t,n,e){var i;void 0===e&&(e=b.SheetArea.viewport),this.GP[n].VP(t,e)},h.prototype.all=function(t,n){var e,i;if(void 0===n&&(n=b.SheetArea.viewport),e=[],w(t))for(i in this.GP)this.GP.hasOwnProperty(i)&&(e=e.concat(this.GP[i].QP(n)));else e=this.GP[t].QP(n);return e},h.prototype.add=function(t,n,e,i){var r,n,e;if(b.CellStatesType[n]===f)throw new Error("Unmatched Cell State Type");w(i)&&(i=3),(r=this.getCollection(n,!0)).ZP(c(t),e,i),n=this.Mf,i===b.SheetArea.viewport?n.repaint(n.j1(t)):(e=n.Fi(),i===b.SheetArea.colHeader&&n.repaint(new b.Rect(e.Py,e.LA,n.Gy(e),e.qC)),i===b.SheetArea.rowHeader&&n.repaint(new b.Rect(e.BA,e.Cy,e.XC,n.Sy(e))))},h.prototype.clear=function(t,n){this.iG(t,n)},h.prototype.iG=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].qP(t,n)},h.prototype.rG=function(t,n,e,i,r,o){var a=this,u=a.Mf,a=a.GP[t];a&&a.KP(n,e,i)&&-1!==r&&-1!==o&&u.repaint(u.XL(u,n,e,r,o))},h.prototype.getStyle=function(t,n,e,i,r){var o,a,u,u,s,c,f,l,h,d,v,m,g,p;if(w(e)&&(e=3),o=new b.Style,a=[],l=(f=(c=(s=this).Mf).Ut).getSpan(t,n,e),w(l)||(t=l.row,n=l.col),h=w(i)?s.getState(t,n,e):s.getState(t,n,e)&i,!w(h)){for(d=0,v=y;d<v.length;d++)(u=s.GP[m=v[d]])&&u.JP(h,t,n,i,e,r)&&(u=u.ML(t,n,e))&&0<u.length&&(a=a.concat(u));if(0<a.length){for(p=(g=a.length)-1;0<=p;p--)o.h5(a[p].style);return o}}return null},h.prototype.destroy=function(){for(var t in this.GP)this.GP.hasOwnProperty(t)&&this.GP[t].eG();delete this.GP,delete this.Mf},h.prototype.toJSON=function(){var t,n,e,t={};for(e in this.GP)this.GP.hasOwnProperty(e)&&(n=this.GP[e],t[e]=n.toJSON());return t},h.prototype.fromJSON=function(t,n,e){var i,r,o,a,i=this;for(o in t)t.hasOwnProperty(o)&&(a=parseInt(o,10),(r=i.getCollection(a,!0)).fromJSON(t[a],n,e))},h.prototype.JO=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].JO(t,n)},h.prototype.xP=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].xP(t,n)},h.prototype.qO=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].qO(t,n)},h.prototype.NP=function(t,n){for(var e in this.GP)this.GP.hasOwnProperty(e)&&this.GP[e].NP(t,n)},u=h,n.CellStateManager=u,n={init:function(){this.cellStates=new u(this)},dispose:function(t){var n=this;n.cellStates&&!1!==t.clearCache&&(n.cellStates.destroy(),n.cellStates=null)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,c,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea;if(w(a)||a===b.SheetArea.viewport)if(u=this.cellStates,"addRows"===n)u.JO(e,i);else if("deleteRows"===n)u.xP(e,i);else if("addColumns"===n)u.qO(r,o);else if("deleteColumns"===n)u.NP(r,o);else if("clear"===n&&(3===a&&2==(2&t.type)&&u.iG(new b.Range(e,r,i,o),a),3===a)&&1==(1&t.type))for(s=e;s<e+i;s++)for(c=r;c<r+o;c++)this.Ut.W_(a).setCellState(s,c,b.CellStatesType.invalid,!1)},toJson:function(t,n){n&&n.ignoreStyle||(t.cellStates=this.cellStates.toJSON())},fromJson:function(t,n,e){var i,r,i=this,r=e&&!e.ignoreStyle||!e;t&&t.cellStates&&r&&(i.cellStates=new u(i),i.cellStates.fromJSON(t.cellStates,n,e))},wh:function(t,n,e){var i;e&&!1===e.includeStyles||(t.lossless.cellStates=this.cellStates.toJSON())},yh:function(t,n,e){var i;e&&!1===e.includeStyles||!t.lossless||!t.lossless.cellStates||this.cellStates.fromJSON(t.lossless.cellStates,f,e)}},e(b.Worksheet.prototype,s={k_:function(t,n,e,i,r,o){i&&i<=3&&0<i&&this.cellStates.rG(t,n,e,i,r,o)},XP:function(t,n,e){var i,e=this.Ut.Fj(e);return e&&e[t]&&e[t][n]}}),b.Worksheet.ch(i,n),e(b.Y8.prototype,{nG:function(t){var n,e,i,n,e=this.G8;e&&(i=void 0,(i=e.originalCellStates||[]).push(t),e.originalCellStates=i)},oG:function(t,i){var r=this;t&&0<t.length&&t.forEach(function(t){var n=t.type,e=a(t,["type"]);switch(n){case"rangeChange":r.aG(o({},e),i);break;case"add":r.uG(o({},e),i);break;case"clear":r.sG(o({},e),i);break;case"remove":r.cG(o({},e),i)}})},sG:function(t,n){var e=t.cache,i=t.sheetArea,r=t.collection,o=t.state,t=t.range;"Object"===r.constructor.name&&(r=this.Mf.cellStates.getCollection(o,!0),e=e.map(M)),n?r.HP(d(this.Mf,e,t),i):r.HP(e,i)},cG:function(t,n){var e=t.cache,i=t.range,r=t.sheetArea,o=t.state,a=t.style,t=t.index;"Object"===i.constructor.name&&(e=this.Mf.cellStates.getCollection(o,!0).UP(r)),n?e.splice(t,1):e.splice(t,0,M({range:i,style:a}))},uG:function(t,n){var e,i,r,o,a,t,u,s,e=t.cache,i=t.range,r=t.sheetArea,o=t.state,a=t.style,t=t.index;"Object"===i.constructor.name&&(e=this.Mf.cellStates.getCollection(o,!0).UP(r)),u=M({range:i,style:a}),n?-1===t?e.push(u):e[t]=u:-1===t?(e.forEach(function(t,n){var e=t.range,t=t.style;e===u.range&&t===u.style&&(s=n)}),e.splice(s,1)):e[t].style=u.style},aG:function(t,n){var e,i,r,o,a,u,s,c,t,r,e=t.cache,i=t.range,r=t.state,o=t.sheetArea,a=t.index,u=t.row,s=t.col,c=t.rowCount,t=t.colCount;"Object"===i.constructor.name&&(e=this.Mf.cellStates.getCollection(r,!0).UP(o),(r=new b.Range(0,0,0,0)).fromJSON(i),i=r),n?e[a].range=i:(i=e[a].range,u!==f&&(i.row=u),s!==f&&(i.col=s),c!==f&&(i.rowCount=c),t!==f&&(i.colCount=t))}}),b.Y8.ch(i,{applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.originalCellStates;n&&this.oG(n,!t)},undo:function(t){var t=t.originalCellStates;t&&this.oG(t)}})},"./dist/plugins/cellState/cellstate.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/cellState/cellStateManager.js"),n),r(e("./dist/plugins/cellState/stateManager.js"),n)},"./dist/plugins/cellState/stateManager.js":function(t,n,e){"use strict";var i,i,b,r,l,o,e,a,u,s;function c(t){this.fG={},this.getStateMethods={},this.context=t,o(this.getStateMethods,a)}function f(t,n){var t;if(n)return(t=new u(t)).fromJSON(n),t}Object.defineProperty(n,"__esModule",{value:!0}),n.lG=void 0,i=e("Common"),b=e("Core"),r=i.Common.lt.ht,l=i.Common.lt.q8,o=b.GC$.extend,e="states",(i={})[b.RowColumnStates.hover]=function(t,n,e,i){var r,o,a,u,r=this,o;return(e?t===r.A_:n===r.I_)&&(a=r.zO(r.A_,r.I_,b.SheetArea.viewport),!!(u=i&&i.some(function(t){return!(!t.contains(r.A_,r.I_)||!a)})))},i[b.RowColumnStates.active]=function(t,n,e,i){var r,o,a,r=this,o;return(e?t===r.ui:n===r.ci)&&!!(a=l(r.ui)&&l(r.ci)&&i&&i.some(function(t){return!!t.contains(r.ui,r.ci)}))},i[b.RowColumnStates.selected]=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,v,m,g,p,r=this,o=!this.parent||this.parent.options.hideSelection;if(o&&!(a=b.hi.ai()===this))return!1;for(s=!1,c=0,f=u=r.getSelections();c<f.length;c++)for(l=f[c],h=0,d=i;h<d.length;h++)v=d[h],l.intersect(v.row,v.col,v.rowCount,v.colCount)&&(v=-1===l.row?0:l.row,m=-1===l.rowCount?r.getRowCount():l.rowCount,g=-1===l.col?0:l.col,p=-1===l.colCount?r.getColumnCount():l.colCount,e&&v<=t&&t<v+m||!e&&g<=n&&n<g+p)&&(s=!0);return s},i[4]=function(t,n,e,i){return!1},i[b.RowColumnStates.edit]=function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.ui,a=r.ci,u;return(e?t===o:n===a)&&(c=((s=r.cellStates).getState(o,a,b.SheetArea.viewport)&b.RowColumnStates.edit)===b.RowColumnStates.edit)&&!!(f=l(o)&&l(a)&&i&&i.some(function(t){return!!t.contains(o,a)}))},i[b.RowColumnStates.invalid]=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,r=this,o=e?r.hG(t,-1):r.hG(-1,n);if(o&&0<o.length&&i)for(a=0,u=i;a<u.length;a++)if(s=u[a],e){for(c=-1===s.col?0:s.col,f=-1===s.colCount?r.getColumnCount():s.colCount,l=c;l<c+f;l++)if(!(h=r.isValid(t,l,r.getValue(t,l,b.SheetArea.viewport))))return!0}else for(d=-1===s.row?0:s.row,v=-1===s.rowCount?r.getRowCount():s.rowCount,m=d;m<d+v;m++)if(!(h=r.isValid(m,n,r.getValue(m,n,b.SheetArea.viewport))))return!0;return!1},i[b.RowColumnStates.dirty]=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r;if(i&&0!==i.length)for(o=this.Ut.Fj(),a=0,u=i;a<u.length;a++)for(c in s=u[a],o)if(o[c])for(h in f=Number(c),l=o[c])if(l[h]&&(d=Number(h),v=-1===s.row?0:s.row,m=-1===s.rowCount?this.getRowCount(b.SheetArea.viewport):s.rowCount,g=-1===s.col?0:s.col,p=-1===s.colCount?this.getColumnCount(b.SheetArea.viewport):s.colCount,e&&f===t&&(g<=d&&d<g+p||"n"===l[h])||!e&&d===n&&(v<=f&&f<v+m||"n"===l[h])))return!0;return!1},i[b.RowColumnStates.inserted]=function(t){for(var n,e,i,r,n,e=0,i=this.getInsertRows();e<i.length;e++)if((r=i[e]).row===t)return!0},i[256]=function(t){return!1},i[b.RowColumnStates.invalidFormula]=function(i,r,o,t){var n,a,e,u,s,c,n=this;if(t&&0!==t.length)for(a=n.cellStates,e=function(t,n,e){return!!((o?i===n:r===e)&&a.getState(n,e)&b.CellStatesType.invalidFormula)},u=0;u<t.length;u++)if(s=t[u],c=n.findSpecialNonNullCellInRange(s,e))return!0;return!1},a=i,c.prototype.enableState=function(t,n){var e=this.fG;r(e[t])&&(e[t]={row:!1,column:!1}),n?e[t].row=!0:e[t].column=!0},c.prototype.disableState=function(t,n){var e=this.fG;r(e[t])||(n?e[t].row=!1:e[t].column=!1)},c.prototype.isEnable=function(t,n){var e=this.fG;return!r(e[t])&&(n?e[t].row:e[t].column)},c.prototype.getState=function(t,n,e,i,r,o){var a,u,a=this.context,u=this.getStateMethods[e];if("function"==typeof u)return u.call(a,t,n,i,r,o)?e:0},c.prototype.destroy=function(){delete this.context,delete this.fG},c.prototype.fromJSON=function(t){this.fG=o({},t)},c.prototype.toJSON=function(){return o({},this.fG)},u=c,n.lG=u,b.Worksheet.ch(e,s={init:function(){this._1=new u(this)},dispose:function(t){var n=this;n._1&&!1!==t.clearCache&&(n._1.destroy(),n._1=null)},toJson:function(t){t.states=this._1.toJSON()},fromJson:function(t){var t=f(this,t&&t.states);t&&(this._1=t)},yh:function(t){var t=f(this,t&&t.lossless&&t.lossless.states);t&&(this._1=t)},wh:function(t){t.lossless||(t.lossless={}),t.lossless.states=this._1.toJSON()}})},"./dist/plugins/celltype/buttoncelltype.js":function(t,n,e){"use strict";var i,r,p,u,s,f,o,c,b,e,r,a,l,h,d,v,w,y,m,g,M,C,S;function T(t,n,e,i){var t,r,t=t.Ut;t&&(t.do("setValueForKey",n,e,d,h,i),r=t.getValueForKey(n,e,v,i))&&(clearTimeout(r),t.do("setValueForKey",n,e,v,h,i))}function A(){var t,e,t=S.call(this)||this;return t.typeName="6",e=t,a(g,function(t,n){e["_"+t]=n}),t}i=this&&this.__extends||(C=function(t,n){return(C=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}C(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Button=void 0,r=e("Common"),p=e("Core"),u=e("./dist/plugins/celltype/cellbuttons.js"),s=p.Events.SelectionChanged,f=r.Common.lt.ht,o=p.mt.vi,c=p.CellTypes.Context,b=p.CellTypes.Text,e=p.CellTypes.Base,r=p.GC$,a=r.each,h=void 0,d="_isFirstMouseUp",v="_mouseupToken",w="#707070",y="#34B4E3",m=".buttonCellType",g={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:l=null,buttonClickColor:l,buttonState:0},i(A,S=e),A.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,c,f,c,g;t&&(c=(s=this)._marginLeft,f=s._marginTop,l=e+c,h=i+f,d=r-c-s._marginRight,v=o-f-s._marginBottom,0<d-2)&&0<v-2&&(m=e<l+d&&l<e+r&&i<h+v&&h<i+o)&&(t.save(),(l<e||e+r<l+d||h<i||i+o<h+v)&&(t.rect(e,i,r,o),t.clip()),t.beginPath(),t.strokeStyle!==(c=w)&&(t.strokeStyle=c),t.strokeRect(l+.5,h+.5,d-1,v-1),f=void 0,c=s._buttonState,g=s._text,f=2===c?s._buttonClickColor||y:(f=s._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==f&&(t.fillStyle=f),p.W.setFillStyle(t,f,e,i,r,o,function(){t.fillRect(l+1,h+1,d-2,v-2)}),t.restore(),g)&&b.prototype.paintValue.call(s,t,g,l,h,d,v,a,u)},A.prototype.getText=function(t,n){return t},A.prototype.j3=function(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)},A.prototype.getHitInfo=function(t,n,e,i,r){var o,a,u,s,c,o,i,o=this;return r&&(a=r.sheetArea,f(a)||3===a)&&i?(u=i.x+o._marginLeft,s=i.x+i.width-o._marginRight,c=i.y+o._marginTop,o=i.y+i.height-o._marginBottom,i={x:t,y:n,row:r.row,col:r.col,cellRect:i,sheetArea:a,sheet:r.sheet,cellStyle:e},u<=t&&t<=s&&c<=n&&n<=o&&(i.isReservedLocation=!0),i):l},A.prototype.processMouseDown=function(t){var n,e,n=this,e=t&&t.sheet;return!(!e||!t.isReservedLocation||n.pG||(n.pG=!0,n._buttonState=2,(0,u.XCe)(e,t.cellRect),0))},A.prototype.processMouseUp=function(t){var n,e,i,r,o,a,t,n=this,e=t&&t.sheet;if(n.pG&&e&&t.isReservedLocation){if((n._buttonState=0,u.XCe)(e,t.cellRect),n.pG=!1,i=t.row,r=t.col,o=t.sheetArea,!(a=e.Ut.getValueForKey(i,r,d,o)))return n.j3(e,i,r,o),e.Ut.do("setValueForKey",i,r,d,!0,o),t=setTimeout(function(){T(e,i,r,o)},250),e.Ut.do("setValueForKey",i,r,v,t,o),!0;T(e,i,r,o)}return!1},A.prototype.processMouseLeave=function(t){var n,e,n=this,e=t&&t.sheet;e&&n.pG&&((n._buttonState=0,u.XCe)(e,t.cellRect),n.pG=!1)},A.prototype.processKeyDown=function(t,n){var e,i,r,e=n.sheet,i=this;return!(!e||i.bG)&&(r=e.getCellRect(n.row,n.col),i._buttonState=2,e.repaint(r),e.D3(s+m,function(){e._3(s+m),i.bG=!1,i._buttonState=0,e.repaint(r)}),i.bG=!0)},A.prototype.processKeyUp=function(t,n){var e,i,r,o,a,e=n.sheet,i=this;return!(!e||!i.bG||(r=n.row,o=n.col,a=e.getCellRect(r,o),i._buttonState=0,e.repaint(a),e._3(s+m),i.j3(e,r,o,n.sheetArea),i.bG=!1))},A.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},A.prototype.getAutoFitWidth=function(t,n,e,i,r){var o,a,o=this,a;return c.Bt(t,o._text,e,i,r)+o._marginLeft+o._marginRight},A.prototype.getAutoFitHeight=function(t,n,e,i,r){var o,a,o=this,a;return c.tn(t,o._text,e,i,r)+o._marginTop+o._marginBottom},A.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},A.prototype.isImeAware=function(t){return!1},A.prototype.toJSON=function(){var e,i,r,e=this,i={typeName:e.typeName};return a(g,function(t,n){"buttonState"!==t&&(r=e["_"+t])!==n&&(i[t]=r)}),i},A.prototype.fromJSON=function(e){var i=this;a(g,function(t){var n=e[t];f(n)||(i["_"+t]=n)})},A.prototype.jn=function(t){},A.prototype.Ke=function(){},M=A,n.Button=M,a(g,function(n){M.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:(this["_"+n]=t,this)}}),p.CellTypes.ti[6]=M},"./dist/plugins/celltype/cellbuttons.js":function(e,o,t){"use strict";var T,n,t,C,a,s,z,S,A,v,c,Y,Z,W,Q,J,g,p,h,K,I,d,X,x,q,N,$,r,b,w,y,M,k,_,D,j,f,m,l,O,n,tt,E,i,t;function nt(t){switch(t){case k:return T.ButtonPosition.left;case _:return T.ButtonPosition.right;case D:return T.ButtonPosition.leftOfText;case j:return T.ButtonPosition.rightOfText}}function et(t){switch(t){case T.ButtonPosition.left:return k;case T.ButtonPosition.right:return _;case T.ButtonPosition.leftOfText:return D;case T.ButtonPosition.rightOfText:return j}}function it(t){for(var n,e,i,n=t.split(" "),i=0;i<n.length;i++)if(0<=n[i].indexOf(r)){e=n[i];break}switch(e){case b:return k;case w:return _;case y:return D;case M:return j}}function rt(t){switch(t){case k:return b;case _:return w;case D:return y;case j:return M}}function ot(t,n,e,i){var t,r,t=t.Ut;t&&(t.do("setValueForKey",n,e,g,S,i),r=t.getValueForKey(n,e,p,i))&&(clearTimeout(r),t.do("setValueForKey",n,e,p,S,i))}function at(t,n,e){var i,r;switch(e){case E.topLeft:return new T.Rect(t.x,t.y,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.topCenter:return i=(t.width-n.width)/2,i=Math.max(0,i),new T.Rect(t.x+i,t.y,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.topRight:return i=t.width-n.width,i=Math.max(0,i),new T.Rect(t.x+i,t.y,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.MiddleLeft:return r=(t.height-n.height)/2,r=Math.max(0,r),new T.Rect(t.x,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.MiddleCenter:return i=(t.width-n.width)/2,i=Math.max(0,i),r=(t.height-n.height)/2,r=Math.max(0,r),new T.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.MiddleRight:return i=t.width-n.width,i=Math.max(0,i),r=(t.height-n.height)/2,r=Math.max(0,r),new T.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.bottomLeft:return r=t.height-n.height,r=Math.max(0,r),new T.Rect(t.x,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.bottomCenter:return i=(t.width-n.width)/2,i=Math.max(0,i),r=t.height-n.height,r=Math.max(0,r),new T.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height));case E.bottomRight:return i=t.width-n.width,i=Math.max(0,i),r=t.height-n.height,r=Math.max(0,r),new T.Rect(t.x+i,t.y+r,Math.min(n.width,t.width),Math.min(n.height,t.height))}}function ut(t,n,e){for(var i,r,i=[],r=0;r<t.length;r++)i.push({width:G(t[r].button,n,e),height:Tt(t[r].button,e),isStick:t[r].button.v_i});return i}function R(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,a=[],u=[],s=0;s<t.length;s++)c=n[t[s].index],C(c)?u.push(t[s]):a.push(c);for(f=ft(a),s=0;s<u.length;s++)l=G(u[s].button,e,i),(h=!o||f.width+l<=o.width)&&(f.width+=l);return f.height=f.height||(o?o.height:0),f}function st(t,n,e,i,r,o,a,u,s,c,f,l){var e,h,u,n,a,d,e,c,r,v,m,g,e=U(n,e,a,u,!0,[t]);if(0<e.length){switch(L(e,n,a),t){case T.ButtonPosition.left:h=b;break;case T.ButtonPosition.right:h=w;break;case T.ButtonPosition.leftOfText:h=y;break;case T.ButtonPosition.rightOfText:h=M;break;default:return}switch(u=R(e,c,r,i,!0,o),n="0",a=z(),((d=T.mt.Tt).mozilla||1<a)&&(n="1px"),e=u.width,c=u.height,r=et(t),C(s.canvasSizes)&&(s.canvasSizes={}),(v=s.canvasSizes)[r]={width:e,height:c},g=ct(h,e,c,m={width:e+"px",height:c+"px",display:"block",position:"absolute",bottom:n,overflow:"hidden",paddingTop:"0"}),t){case T.ButtonPosition.left:g.style.left="0";break;case T.ButtonPosition.right:g.style.right="0";break;case T.ButtonPosition.leftOfText:g.style.left="0";break;case T.ButtonPosition.rightOfText:g.style.right="0";break;default:return}f.appendChild(g)}}function ct(t,n,e,i){var r,o,r=document.createElement("canvas");for(o in r.className=t+" "+$,i)i.hasOwnProperty(o)&&(r.style[o]=i[o]);return r.width=n,r.height=e,r}function ft(t){var n,e,i,r,o;if(t.length<=0)return new T.Rect(0,0,0,0);for(n=t[0].x,e=t[0].y,i=t[0].x+t[0].width,r=t[0].y+t[0].height,o=1;o<t.length;o++)n=Math.min(n,t[o].x),e=Math.min(e,t[o].y),i=Math.max(i,t[o].x+t[o].width),r=Math.max(r,t[o].y+t[o].height);return new T.Rect(n,e,i-n,r-e)}function lt(t){var n,e,n=T.mt.Tt,e=z();if(1!==e)return n.mozilla?Math.ceil(t*e):Math.round(t*e)}function F(t,n,e,i,r,o,a,u){var s,a,c,f,l,h,d;if(!C(t))for(C(u[e])&&(u[e]={}),L(n,i.sheet,i.row),s=t.getContext("2d"),a=R(n,a,r,i,!0),s.setTransform(parseFloat(t.style.width)/a.width,0,0,parseFloat(t.style.height)/a.height,0,0),l=new T.Rect(f=c=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),h=0;h<n.length&&(d=P(s,c,0,G(n[h].button,r,i),i.sheet.getRowHeight(i.row),n[h].button,r,i,o,u[e],n[h].index,l),!C(d));h++)c+=d.width}function ht(e,i,r,o,a,t){var t,n,n,n,n;C(t.eventListeners)&&(t.eventListeners={}),C(t.eventListeners[i])&&(t.eventListeners[i]={}),n=(t=t.eventListeners[i]).mouseDownListener=function(t){var n;Nt(u({x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i},!0),!0,e)},e.addEventListener("mousedown",n),n=t.mouseUpListener=function(t){var n;kt(u({x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i},!0),!0,e)},e.addEventListener("mouseup",n),n=t.mouseMoveListener=function(t){var n;_t(u({x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i},!0),!0,e)},e.addEventListener("mousemove",n),n=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:r,cellRect:a,cellStyle:o,buttonArea:i};t.x<0&&(t.x=0),t.x>=parseFloat(e.style.width)&&(t.x=parseFloat(e.style.width)-1),Dt(u(t,!0),!0,e)},e.addEventListener("mouseleave",n)}function dt(t,n,e,i,r,o,a,u,s,c,f,l){var n,h,d,e,v,m,g,p,n=U(n,e,a,u,!0,[t]);if(0<n.length){switch(d=h=void 0,t){case T.ButtonPosition.left:h=b,d=k;break;case T.ButtonPosition.right:h=w,d=_;break;case T.ButtonPosition.leftOfText:h=y,d=D;break;case T.ButtonPosition.rightOfText:h=M,d=j;break;default:return}if(e=l.querySelector("."+h),!C(e)){switch(v=parseFloat(e.style.width),m=o.options.contentRect,g=o.options.leftExternalRect,p=o.options.rightExternalRect,t){case T.ButtonPosition.left:m.x+=v,m.width-=v;break;case T.ButtonPosition.right:m.width-=v;break;case T.ButtonPosition.leftOfText:g.width+=v;break;case T.ButtonPosition.rightOfText:p.width+=v}F(e,n,d,i,r,s,c,f),ht(e,d,i,r,o.options.cellRect,s)}}}function vt(t,n,e,i,r,o,a){var n,e,u,s,c,f,l,n=U(n,e,i,r,!0,[t]);if(n&&0<n.length)switch(e=et(t),u=o&&o[e]&&o[e].width||0,s=a.contentContainer,c=a.contentRect,f=a.leftExternalRect,l=a.rightExternalRect,t){case T.ButtonPosition.left:gt(s,"left",u),c.x+=u,c.width-=u;break;case T.ButtonPosition.leftOfText:gt(s,"left",u),f.width+=u;break;case T.ButtonPosition.right:c.width-=u;break;case T.ButtonPosition.rightOfText:l.width+=u}}function mt(t){return+t.replace("px","")||0}function gt(t,n,e){var i=0;t.style[n]&&(i=mt(t.style[n])),t.style[n]="".concat((i+=e)-1,"px")}function pt(t,n){C(n.mouseDownListener)||t.removeEventListener("mousedown",n.mouseDownListener),C(n.mouseUpListener)||t.removeEventListener("mouseup",n.mouseUpListener),C(n.mouseMoveListener)||t.removeEventListener("mousemove",n.mouseMoveListener),C(n.mouseLeaveListener)||t.removeEventListener("mouseleave",n.mouseLeaveListener)}function L(t,n,e){for(var i,r,o,i=n.BO(),r=0;r<t.length;r++)(o=Ft(t[r].button,e))&&i.addImage(o)}function B(t){var n=t.isPrinting,t=t.printZoomFactor;return n&&"number"==typeof t&&1!==t}function bt(t,n){return 2===n.columnHeaderFitMode&&n.cornerX&&(t.width=n.cornerX-t.x,t.height=t.height-(n.cornerY-t.y)-1,t.y=n.cornerY-1),t}function wt(t,n,e){switch(e){case T.ButtonPosition.leftOfText:return new T.Rect(t.x,t.y,n.x-t.x,t.height);case T.ButtonPosition.rightOfText:return new T.Rect(n.x+n.width,t.y,t.x+t.width-n.x-n.width,t.height)}}function yt(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m;if(t&&!(n.length<=0)){if(r=Ot(r),L(n,u=o.sheet,o.row),2===o.columnHeaderFitMode&&o.cornerX&&(s=o.cellRect.x+o.cellRect.width-(e.x+e.width),(e=e.clone()).width=o.cornerX-e.x-s,e.height=e.height-(o.cornerY-e.y)-1,e.y=o.cornerY-1),c=wt(e,i,a?T.ButtonPosition.leftOfText:T.ButtonPosition.rightOfText),t.save(),t.rect(c.x,c.y,c.width,c.height),t.clip(),t.beginPath(),f=H(u,o.row,o.col,o.sheetArea),l=Ot(r),C(f.layout)&&(f.layout={}),a){for(h=c.x+c.width,d=n.length-1;0<=d&&(m=P(t,h-=v=G(n[d].button,l,o),e.y,G(n[d].button,l,o),c.height,n[d].button,l,o,f,f.layout,n[d].index,e),!C(m));d--);i.x=h}else{for(h=c.x,d=0;d<n.length&&(m=P(t,h,e.y,G(n[d].button,l,o),c.height,n[d].button,l,o,f,f.layout,n[d].index,e),!C(m));d++)h+=m.width;i.width=h-i.x}t.restore()}}function Mt(t,n,e,i,r){if(!(t+e<r.x||t>r.x+r.width||n+i<r.y||n>r.y+r.height))return t+e>r.x+r.width&&(e=r.x+r.width-t),n+i>r.y+r.height&&(i=r.y+r.height-n),t<r.x&&(t=r.x),n<r.y&&(n=r.y),new T.Rect(t,n,e,i)}function P(t,n,e,i,r,o,a,u,s,c,f,l){var h,s,h=d;if(s.buttonDownIndex===f?h=X:s.buttonHoverIndex===f&&(h=x),s=Mt(n,e,i,r=a.vAlign===T.VerticalAlign.center?l.height:r,l),!C(s))return Ct(t,s.x,s.y,s.width,s.height,o,a,u,h,l),c[f]=new T.Rect(s.x,s.y,s.width,s.height),c[f].offsetX=s.x-l.x,c[f].offsetY=s.y-l.y,u.cornerY&&(c[f].offsetY+=u.cornerY),c[f]}function Ct(t,n,e,i,r,o,a,u,s,c){var f,l,h,h,d,d,v,d,m,f,f,s,v,f,m,g,p,b,w,b,n,b,y,e,i,M;t.save(),t.beginPath(),f=o.useButtonStyle,l=B(u),h=u.printZoomFactor,h=l?h:u.sheet.zoom(),n+=d=f?I*h:0,e+=d,i-=2*d,r-=2*d,d=Y,v=o.hoverBackColor||Q,d&&t.strokeStyle!==d&&(t.strokeStyle=d),f&&t.strokeRect(n+.5,e+.5,i-1,r-1),d=Lt(o.enabled,u.row),f?m=!1===o.enabled?o.buttonBackColor||W:s===X?Z:s===x||u.visualState===T.VisualState.hover?v:((f=t.createLinearGradient(n+i/2,e,n+i/2,e+r)).addColorStop(.125,"#F6FAFB"),f.addColorStop(1,"#D2DBEB"),o.buttonBackColor||f):(m=o.buttonBackColor||"white",s===x&&(o.enabled||C(o.enabled))&&(m=v)),(f=a.font)&&t.font!==f&&(t.font=f),t.fillStyle!==m&&(t.fillStyle=m),t.rect(n+=1,e+=1,i-=2,r-=2),t.clip(),t.beginPath(),t.fillRect(n,e,i,r),s=new T.Rect(n,e,i,r),v=new T.Rect(n,e,i,r),f=K*h,m=Ft(o,u.row),o.caption&&m&&(g=(N.Bt(A,o.caption,a,h,u)+2*I)*h,p=At(o)*h,b=new T.Rect(0,0,g+p+f,r),b=at(w=new T.Rect(n,e,i,r),b,E.MiddleCenter),o.captionAlign===T.CaptionAlignment.left?(v=new T.Rect(b.x,e,g,r),s=b.x+g+f<n+i-2?new T.Rect(b.x+g+f,e,Math.max(0,p),r):new T.Rect(0,0,0,0)):(s=new T.Rect(b.x,e,Math.min(p,i),r),v=b.x+p+f<n+i-2?new T.Rect(b.x+p+f,e,Math.min(i-2-p-f,g),r):new T.Rect(0,0,0,0))),o.caption&&(n=(N.Bt(A,o.caption,a,h,u)+2*I)*h,b=(N.tn(A,o.caption,a,h,u)+2*I)*h,e=at(v,y=new T.Rect(0,0,n,b),E.MiddleCenter),i=new q,a=a.clone(),!1===d&&(a.foreColor=J),a.cellButtons=S,a.decoration=S,i.paintValue(t,o.caption,e.x,e.y-(M=l?0:2),e.width,e.height,a,u)),m&&St(t,o,s.x,s.y,s.width,s.height,m,u,c),t.restore()}function St(t,n,e,i,r,o,a,u,s){var c,f,c,e,r,o,l,h,u,u,l,i,e,d;t.save(),t.rect(e+2,i+2,r-4,o-4),t.clip(),t.beginPath(),(f=(c=u.sheet).BO()).getState(a)?f.qh(a)&&(c=B(u)?u.printZoomFactor:c.zoom(),e=new T.Rect(e,i,r,o),r=At(n)-2,o=It(n)-2,h=at(e,l=new T.Rect(0,0,r*c,o*c),E.MiddleCenter),n.position!==T.ButtonPosition.leftOfText&&n.position!==T.ButtonPosition.rightOfText||((u=u.textRect)&&(h.y=v(u.y-u.height/2-l.height/2,i+4)),h.y+h.height>e.y+e.height&&(h.y=v(h.y-(h.y+h.height-e.y-e.height),e.y))),l=(u=f.getImage(a)).width,i=u.height,T.mt.Tt.msie&&n.imageType&&(i=n.imageType===T.ButtonImageType.custom?(m[a]||(u.style.position="absolute",u.style.left="-10000px",u.style.top="-100000px",document.body.appendChild(u),m[a]={width:u.width,height:u.height},document.body.removeChild(u)),l=m[a].width,m[a].height):l=12),s&&T.mt.Tt.msie&&h.x+h.width>s.x+s.width?0<(e=s.x+s.width-h.x)&&t.drawImage(u,0,0,e*(d=l/(r*c)),i,h.x,h.y,e,o*c):t.drawImage(u,0,0,l,i,h.x,h.y,r*c,o*c)):f.addImage(a),t.restore()}function G(t,n,e,i){var r,o,n,a,u,e;return void 0===i&&(i=!0),r=B(e)?e.printZoomFactor:e.sheet.zoom(),o=2*I+3,C(t.width)?(n=N.Bt(A,t.caption,n,r,e),a=t.useButtonStyle,(u=Ft(t,e.row))&&(n=At(t)+n,o=(a?o:0)+K),i?(n+o+7)*r:n+o+7):(e=v(1,t.width),isNaN(e)&&(e=1),i?e*r:e)}function Tt(t,n,e){var i,r,i,n,t;return void 0===e&&(e=!0),i=n.sheet,r=B(n)?n.printZoomFactor:i.zoom(),i=i.getRowHeight(n.row),n=t.imageSize?t.imageSize.height:A,t=v(1,n||i),isNaN(t)&&(t=1),e?t*r:t}function U(t,n,e,i,r,o){var a,u,s,c,f,l,a=[];if(!n||0===n.length)return[];for(u=!1,s=t.Ut.getValueForKey(e,i,h),t.getActiveRowIndex()===e&&t.getActiveColumnIndex()===i&&!0!==s&&(u=!0),c=0;c<n.length;c++)if(f=n[c].visible,!r||!n[c].i4i)for(l=0;l<o.length;l++)(n[c].position===o[l]||C(n[c].position)&&o[l]===T.ButtonPosition.right)&&(f&&"function"==typeof f&&f(e)||n[c].visibility===T.ButtonVisibility.onEditing&&r||n[c].visibility!==T.ButtonVisibility.onEditing&&u||n[c].visibility===T.ButtonVisibility.always||C(n[c].visibility))&&a.push({index:c,button:n[c]});return a}function At(t){var n;return n=(n=t.imageSize&&("string"==typeof t.imageSize.width&&(n=c(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:n)===A||isNaN(n)||n<0?16:n}function It(t){var n;return n=(n=t.imageSize&&("string"==typeof t.imageSize.height&&(n=c(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:n)===A||isNaN(n)||n<0?16:n}function H(t,n,e,i,r){var o,a,o={isMouseDownReservedLocation:!1};return i===T.SheetArea.corner?o:((a=t.Ut.getValueForKey(n,e,f,i))||r||xt(t,n,e,i,a=o),a)}function xt(t,n,e,i,r){t.Ut.setValueForKey(n,e,f,r,i)}function u(t,n){var e,i,r,o,a,u,s,c,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,c,t,f,t,f;if(void 0===n&&(n=!1),e=t.context.row,i=t.context.col,r=t.cellRect,o=t.cellStyle,a=t.context,s=(u={x:t.x,y:t.y,row:e,col:i,cellRect:r,cellStyle:o,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:a}).sheet,!1!==t.cellStyle.locked&&s.isActualProtected()&&!s.NMi&&(c={row:e,col:i,sheetArea:t.context.sheetArea,isLocked:!0},T.Worksheet.et(s,"getCellActualLockedInfo",c),c.isLocked))return null;if(c=H(s,u.row,u.col,u.sheetArea,!0),f=t.cellStyle.cellButtons,!c||!f||f.length<=0)return null;if(l=c.layout,!(l=n?c.editorLayout[t.buttonArea]:l))return null;for(m in h=-1,d=u.x,v=u.y,l)if(l.hasOwnProperty(m)){if(g=void 0,p=l[m],n)g=new T.Rect(p.x,p.y,p.width,p.height);else{if(b=p.offsetX,s.parent&&!s.parent.options.scrollByPixel&&0<(w=s.frozenColumnCount())&&w<(y=s.getViewportLeftColumn(1))&&(M=s.getSpan(e,i,u.sheetArea))&&M.col<=y&&y<M.col+M.colCount)for(C=y-w,S=0;S<C;S++)b-=s.getColumnWidth(w+S+1,u.sheetArea);g=new T.Rect(r.x+b,r.y+p.offsetY,p.width,p.height)}if(g&&g.contains(d,v)){h=+m;break}}return-1!==h?u.cellButtonHitInfo={hitButtonIndex:h,buttonConfig:f[h],buttonArea:t.buttonArea}:(c=s.getCellType(u.row,u.col))&&(t=R(U(s,f,e,i,n,[T.ButtonPosition.left]),l,o,a,!1),f=R(U(s,f,e,i,n,[T.ButtonPosition.right]),l,o,a,!1),t=new T.Rect(r.x+t.width,r.y,r.width-t.width-f.width,r.height),f=c.getHitInfo(u.x,u.y,o,t,a))&&f.isReservedLocation&&(u.isReservedLocation=!0),u}function Nt(t,n,e){var i,r,o,a,u,u,s,c,f,r,s,f,c,n,l,h;return void 0===n&&(n=!1),t&&t.cellButtonHitInfo&&(i=t.sheet,o=t.row,a=t.col,u=t.sheetArea,o===i.ui&&a===i.ci||u!==T.SheetArea.viewport||i.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(r=t.cellButtonHitInfo.buttonConfig.hasOverLay),u=H(i,o,a,t.sheetArea),t.cellButtonHitInfo&&(c=t.cellButtonHitInfo.hitButtonIndex,s=t.cellButtonHitInfo.buttonConfig),f=Lt(s&&s.enabled,t.row),i)&&(!u.isMouseDownReservedLocation||r)&&s&&(f||C(f))&&0<=c&&(u.buttonDownIndex=c,u.isMouseDownReservedLocation=!0,n&&e?(r=t.cellStyle,s=u.layout,f=t.context,c=u.editorLayout,n=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,l=r.cellButtons,n&&F(e,h=U(i,l,o,a,!0,[nt(n)]),n,f,r,u,s,c)):V(i,t.cellRect),1)}function kt(t,n,e){var i,r,o,a,u,s,s,c,f,l,u,h,d,v,m,e;if(void 0===n&&(n=!1),t&&(i=t&&t.sheet,r=t.row,o=t.col,a=H(i,t.row,t.col,t.sheetArea),u=t.cellButtonHitInfo,a.isMouseDownReservedLocation)&&i){if(u&&0<=u.hitButtonIndex&&u.buttonConfig.command&&(s=u.buttonConfig.command,n||i.getActiveRowIndex()===r&&i.getActiveColumnIndex()===o||i.eR(r,o,1,1,2),"string"==typeof s?i.getParent().commandManager().execute({cmd:s,row:r,col:o,sheetName:i.name(),sheetArea:t.sheetArea}):"function"==typeof s&&s.call(A,i,r,o,t.sheetArea)),n&&0<=a.buttonDownIndex&&e&&(a.buttonDownIndex=-1,s=t.cellStyle,c=a.layout,f=t.context,l=a.editorLayout,u=u&&u.buttonArea,h=s.cellButtons,u)&&F(e,d=U(i,h,r,o,!0,[nt(u)]),u,f,s,a,c,l),a.buttonDownIndex=-1,n||V(i,t.cellRect),a.isMouseDownReservedLocation=!1,v=t.sheetArea,!(m=i.Ut.getValueForKey(r,o,g,v)))return Et(i,r,o,v),i.Ut.do("setValueForKey",r,o,g,!0,v),e=setTimeout(function(){ot(i,r,o,v)},250),void i.Ut.do("setValueForKey",r,o,p,e,v);ot(i,r,o,v)}}function _t(t,n,e){var i,r,o,o,n,a,u,s,c,f,l;void 0===n&&(n=!1),t&&(r=H(i=t&&t.sheet,t.row,t.col,t.sheetArea),o=-1,(o=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:o)!==(C(r.buttonHoverIndex)?-1:r.buttonHoverIndex))&&(r.buttonHoverIndex=o,n?(o=t.cellStyle,n=r.layout,a=t.context,u=r.editorLayout,s=o.cellButtons,c=t.row,f=t.col,e&&jt(s,i,c,f,l=e.parentElement,a,o,r,n,u)):V(i,t.cellRect))}function V(t,n){var e,i,r,n,e,e=n.x-(0<n.x?2:0),i=n.y-(0<n.y?2:0),r=n.width+4,n=n.height+4,e=new T.Rect(e,i,r,n);t.repaint(e)}function Dt(t,n,e){var i,r,n,o,a,u,s,c,f,l;void 0===n&&(n=!1),t&&t.cellButtonHitInfo&&(r=H(i=t&&t.sheet,t.row,t.col,t.sheetArea),n?(r.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(n=t.cellStyle,o=r.layout,a=t.context,u=r.editorLayout,s=n.cellButtons,c=t.row,f=t.col,e)&&jt(s,i,c,f,l=e.parentElement,a,n,r,o,u)):(i&&(r.buttonHoverIndex=-1,r.buttonDownIndex=-1,r.isMouseDownReservedLocation=!1),V(i,t.cellRect)))}function jt(t,n,e,i,r,o,a,u,s,c){for(var f,l,h,d,f=0;f<O.length;f++)l=et(O[f]),F(h=r.querySelector("."+rt(l)),d=U(n,t,e,i,!0,[nt(l)]),l,o,a,u,s,c)}function Ot(t){var t=t.clone(!0);return t.hAlign=T.HorizontalAlign.left,t.vAlign=T.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function Et(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)}function Rt(t,n,e,i,r){var o,a,u,o=t.Il(n,e,r);if(o&&o.cellButtons&&0<o.cellButtons.length&&0<(a=o.cellButtons.filter(function(t){return 1===t.visibility})).length){i&&t.Ut.do("setValueForKey",n,e,h,!0,r);try{u=t.getCellRect(n,e,1===r?-1:void 0,2===r?-1:void 0),t.repaint(u)}finally{i&&t.Ut.do("setValueForKey",n,e,h,S,r)}}}function Ft(t,n){var e,i,n,r,e=null,i=t.imageType;if(C(t.imageType))return null;switch(r=(n=Lt(t.enabled,n))||C(n),i){case T.ButtonImageType.dropdown:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.left:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case T.ButtonImageType.right:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case T.ButtonImageType.clear:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.ok:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.plus:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.minus:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.redo:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.undo:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.search:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.separator:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.spinLeft:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.spinRight:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case T.ButtonImageType.ellipsis:e=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.expand:e=r?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case T.ButtonImageType.collapse:e=r?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case T.ButtonImageType.custom:e=t.imageSrc}return e}function Lt(t,n){return"function"==typeof t?t(n):t}Object.defineProperty(o,"__esModule",{value:!0}),o.XCe=void 0,T=t("Core"),n=t("Common"),t=t("./dist/plugins/celltype/celltypes.ns.js"),C=n.Common.lt.ht,a=T.W.V,s=T.mt.vt,z=T.Bf.Zl,S=void 0,A=null,v=Math.max,c=parseInt,Y="#707070",Z="#34B4E3",W="#e6e6e6",Q="lightgray",J="#CACACA",g="_isFirstMouseUp",p="_mouseupToken",h="_leaveCell",d=K=0,X=I=2,x=3,q=T.CellTypes.Base,N=T.CellTypes.Context,$="gc-cell-button-canvas",b=(r="gc-editor-")+"left-cellbuttons",w=r+"right-cellbuttons",y=r+"left-of-text-cellbuttons",M=r+"right-of-text-cellbuttons",k="leftButtonArea",_="rightButtonArea",D="leftOfTextButtonArea",j="rightOfTextButtonArea",f="_cellButtonParam",m={},l=T.GC$,O=[T.ButtonPosition.left,T.ButtonPosition.right,T.ButtonPosition.leftOfText,T.ButtonPosition.rightOfText],n=new n.Common.ResourceManager(t.SR,"CellTypes"),tt=n.getResource.bind(n),(t=E=E||{})[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight",T.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var n,e,i,r,o,a,u,s,c,f,a,l,h,d,v,m,g,p,b,n=t.options.context,e=t.options.style;if(!n.cellOverflowLayout&&e.cellButtons&&0<e.cellButtons.length&&(i=t.options.context.sheet,r=n.row,o=n.col,a=U(i,e.cellButtons,r,o,!1,[T.ButtonPosition.left,T.ButtonPosition.right]))&&0<a.length&&(u=Ot(e),L(a,i,t.options.context.row),s=t.ctx)){for(c=bt(t.options.rect.clone(),n),s.save(),s.rect(c.x,c.y,c.width,c.height),s.clip(),s.beginPath(),f=c.x,a=c.x+c.width,l=H(i,n.row,n.col,n.sheetArea),C(l.layout)&&(l.layout={}),h=l.layout,d=U(i,e.cellButtons,r,o,!1,[T.ButtonPosition.left]),v=0;v<d.length&&(m=P(s,f,c.y,G(d[v].button,u,n),c.height,d[v].button,u,n,l,h,d[v].index,c),!C(m));v++)f+=m.width;for(g=f,f=a,v=(p=U(i,e.cellButtons,r,o,!1,[T.ButtonPosition.right])).length-1;0<=v&&(m=P(s,f-=b=G(p[v].button,u,n),c.y,b,c.height,p[v].button,u,n,l,h,p[v].index,c),!C(m));v--);s.restore(),(c=t.options.rect).width=c.x+c.width-(a-f)-g,c.x=g}},beforePaintText:function(t){var n,e,i,r,o,t,n=t.context,e=t.style;!n.cellOverflowLayout&&e.cellButtons&&0<e.cellButtons.length&&(i=t.context.sheet,r=n.row,o=n.col,(t=t.externals).left=t.left.concat(ut(U(i,e.cellButtons,r,o,!1,[T.ButtonPosition.leftOfText]),e,n)),t.right=t.right.concat(ut(U(i,e.cellButtons,r,o,!1,[T.ButtonPosition.rightOfText]),e,n)))},beforeFillTextArea:function(t){var n,e,i,r,o,i,a,u,s,c,n=t.style,e=n.cellButtons;n.cellButtons&&0<n.cellButtons.length&&(i=t.ctx,r=t.availRect,o=t.textRect,yt(i,c=U(a=(i=t.context).sheet,e,u=i.row,s=i.col,!1,[T.ButtonPosition.leftOfText]),r,o,n,i,!0))},afterFillTextArea:function(t){var n,e,i,r,o,i,a,u,s,c,n=t.style,e=n.cellButtons;n.cellButtons&&0<n.cellButtons.length&&(i=t.ctx,r=t.availRect,o=t.textRect,yt(i,c=U(a=(i=t.context).sheet,e,u=i.row,s=i.col,!1,[T.ButtonPosition.rightOfText]),r,o,n,i,!1))},onCreateCellEditor:function(t){var n,e,i,r,o,a,u,s,c,t,f,l,h,d,v,n=t.options.dom;if(n&&n.children&&(e=n.children[0])&&e.children&&(i=e.children[0])&&(o=(r=t.context).sheet,a=r.row,u=r.col,s=t.options.cellStyle,c=(s=C(s)?o.getActualStyle(a,u):s).cellButtons,!(C(c)||c&&c.length<=0))){for(t=t.options.cellRect,f=new T.Rect(t.x,t.y,t.width,t.height),l=H(o,a,u,r.sheetArea),C(l.layout)&&(l.layout={}),h=l.layout,d=!1,v=0;v<c.length;v++)c[v].position!==T.ButtonPosition.leftOfText&&c[v].position!==T.ButtonPosition.rightOfText||(d=!0);for(d&&(e.style.overflow="hidden"),v=0;v<O.length;v++)st(O[v],o,c,r,s,f,a,u,l,h,n,e)}},onActivateCellEditor:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=t.context,e=n.sheet,i=n.row,r=n.col,o=t.options.cellStyle,a=o.cellButtons;if(!(C(a)||a.length<=0))for(u=H(e,i,r,n.sheetArea),C(u.editorLayout)&&(u.editorLayout={}),s=u.layout,c=u.editorLayout,f=Ot(o),l=t.options.dom,h=0;h<O.length;h++)dt(O[h],e,a,n,f,t,i,r,u,s,c,l)},onDeactivateCellEditor:function(t){var n,e,i,r,o,e,a,u,s,c,f,l,h,n=t.context,e=n.sheet,i=n.row,r=n.col,o,e=e.getActualStyle(i,r,n.sheetArea).cellButtons;if(e&&0<e.length)for(u=(a=H(n.sheet,i,r,n.sheetArea,!0))&&a.eventListeners,c=(s=t.options.dom).querySelectorAll("."+$),f=0;f<c.length;f++)h=it((l=c[f]).className),C(h)||C(u)||C(u[h])||(pt(l,u[h]),delete a.eventListeners[h])},onUpdateContainer:function(t){var n,e,i,r,n,o,a,u,n=t.context,e=n.sheet,i=n.row,r=n.col,n=H(n.sheet,i,r,n.sheetArea,!0),o=n&&n.canvasSizes,a=t.cellStyle.cellButtons;if(!(C(a)||a.length<=0))for(t.context.preventOverflow=!a.every(function(t){return t.i4i}),u=0;u<O.length;u++)vt(O[u],e,a,i,r,o,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=u(t)},processMouseDownOnCellPadding:function(t){Nt(t)},processMouseUpOnCellPadding:function(t){kt(t)},processMouseMoveOnCellPadding:function(t){_t(t)},processMouseLeaveOnCellPadding:function(t){Dt(t)},getCellButtonAutoHeight:function(i){var r,o,t,a,t,u,r=i.context.sheet,o=i.context.row,t=i.context.col,a=i.cellStyle;a.cellButtons&&0!==a.cellButtons.length&&(t=U(r,a.cellButtons,o,t,!1,[T.ButtonPosition.left,T.ButtonPosition.right]),u=0,t.forEach(function(t){var n,e,n=N.tn(A,t.button.caption,a,r.zoom(),i.context)-2,e;Ft(t.button,o)&&(n=v(n,At(t.button))),u=v(n,u)}),i.value=u+ +I)},getCellButtonAutoWidth:function(n){var t,e,i,r,t,o,t=n.context.sheet,e=n.context.row,i=n.context.col,r=n.cellStyle;r.cellButtons&&0!==r.cellButtons.length&&(t=U(t,r.cellButtons,e,i,!1,[T.ButtonPosition.left,T.ButtonPosition.right,T.ButtonPosition.leftOfText,T.ButtonPosition.rightOfText]),o=0,t.forEach(function(t){o+=G(t.button,r,n.context,!1)}),n.value=o)}}),o.XCe=V,T.Worksheet.ch(i="cellButtons",{setHost:function(){var e=this;e.bind(T.Events.EnterCell+"."+i,function(t,n){Rt(e,n.row,n.col,!1,n.sheetArea)}),e.bind(T.Events.LeaveCell+"."+i,function(t,n){Rt(e,n.row,n.col,!0,n.sheetArea)}),e.bind(T.Events.TopRowChanged+"."+i,function(t,n){Rt(e,n.row,n.col,!0,n.sheetArea)})},dispose:function(t){var n=this;n.unbind(T.Events.EnterCell+"."+i),n.unbind(T.Events.LeaveCell+"."+i),n.unbind(T.Events.TopRowChanged+"."+i)},processMouseDown:function(t){var n=t.hitInfo.cellTypeHitInfo;n&&n.cellButtonHitInfo&&Nt(n)&&(t.r=!0)}}),T.Workbook.ch(i,{onCultureChanged:function(){tt()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ti=n.EditorType=n.Context=n.Base=void 0,a=(o=e("Core")).CellTypes.Base,u=o.CellTypes.Context,s=o.CellTypes.EditorType,c=o.CellTypes.ti,n.Base=a,n.Context=u,n.EditorType=s,n.ti=c,n.Hi=o.CellTypes.Hi,n.zi=o.CellTypes.zi,Object.defineProperty(n,"Corner",{set:function(t){t!==n.Hi.Corner&&(n.Hi.Corner=t)},get:function(){return n.Hi.Corner}}),Object.defineProperty(n,"ColumnHeader",{set:function(t){t!==n.Hi.ColumnHeader&&(n.Hi.ColumnHeader=t)},get:function(){return n.Hi.ColumnHeader}}),Object.defineProperty(n,"RowHeader",{set:function(t){t!==n.Hi.RowHeader&&(n.Hi.RowHeader=t)},get:function(){return n.Hi.RowHeader}}),Object.defineProperty(n,"Text",{set:function(t){t!==n.zi.Text&&(n.zi.Text=t)},get:function(){return n.zi.Text}}),r(e("./dist/plugins/celltype/checkboxcelltype.js"),n),r(e("./dist/plugins/celltype/buttoncelltype.js"),n),r(e("./dist/plugins/celltype/hyperlinkcelltype.js"),n),r(e("./dist/plugins/celltype/comboboxcelltype.js"),n),e("./dist/plugins/celltype/cellbuttons.js"),r(e("./dist/plugins/celltype/editor/colorpicker.js"),n),r(e("./dist/plugins/celltype/editor/timepicker.js"),n),r(e("./dist/plugins/celltype/editor/calendar.js"),n),r(e("./dist/plugins/celltype/editor/calculator.js"),n),r(e("./dist/plugins/celltype/editor/monthPicker.js"),n),r(e("./dist/plugins/celltype/editor/listControl.js"),n),r(e("./dist/plugins/celltype/dropdown-action.js"),n),r(e("./dist/plugins/celltype/radiochecklistcelltype.js"),n),r(e("./dist/plugins/celltype/celltypes.ns.js"),n),r(e("./dist/plugins/celltype/rangecelltype.js"),n),r(e("./dist/plugins/celltype/dataobjectcelltype.js"),n),r(e("./dist/plugins/celltype/editor/popupControl.js"),n)},"./dist/plugins/celltype/celltypes.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/celltype/celltypes.res.en.js");n.SR={en:e}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Calendar_BuiltIn_Yesterday=n.Calendar_BuiltIn_Today=n.Calendar_Today=n.Calendar_FirstYear=n.Calendar_EraName_4=n.Calendar_EraName_3=n.Calendar_EraName_2=n.Calendar_EraName_1=n.Calendar_Time_PM=n.Calendar_Time_AM=n.Calendar_Months_12=n.Calendar_Months_11=n.Calendar_Months_10=n.Calendar_Months_9=n.Calendar_Months_8=n.Calendar_Months_7=n.Calendar_Months_6=n.Calendar_Months_5=n.Calendar_Months_4=n.Calendar_Months_3=n.Calendar_Months_2=n.Calendar_Months_1=n.Calendar_ShortMonths_12=n.Calendar_ShortMonths_11=n.Calendar_ShortMonths_10=n.Calendar_ShortMonths_9=n.Calendar_ShortMonths_8=n.Calendar_ShortMonths_7=n.Calendar_ShortMonths_6=n.Calendar_ShortMonths_5=n.Calendar_ShortMonths_4=n.Calendar_ShortMonths_3=n.Calendar_ShortMonths_2=n.Calendar_ShortMonths_1=n.Calendar_Weeks_7=n.Calendar_Weeks_6=n.Calendar_Weeks_5=n.Calendar_Weeks_4=n.Calendar_Weeks_3=n.Calendar_Weeks_2=n.Calendar_Weeks_1=n.Calendar_ShortWeeks_7=n.Calendar_ShortWeeks_6=n.Calendar_ShortWeeks_5=n.Calendar_ShortWeeks_4=n.Calendar_ShortWeeks_3=n.Calendar_ShortWeeks_2=n.Calendar_ShortWeeks_1=n.Cancel=n.OK=void 0,n.DataObject_MeetTable=n.DataObject_MeetSpan=n.DataObject_MeetLock=n.MultiColumn_InvalidDataSource=n.Calculator_OverFlowInfo=n.Calculator_SqrtParameterException=n.Calculator_InvalidInputInfo=n.Calculator_DivideByZeroInfo=n.StandardColor=n.ThemeColor=n.Quarter_Format_4=n.Quarter_Format_3=n.Quarter_Format_2=n.Quarter_Format_1=n.Calendar_NextTenYear=n.Calendar_LastTenYear=n.Calendar_NextYear=n.Calendar_LastYear=n.Calendar_NextMonth=n.Calendar_LastMonth=n.Calendar_BuiltIn_LastMonth=n.Calendar_BuiltIn_ThisMonth=n.Calendar_BuiltIn_Last7Days=void 0,n.OK="OK",n.Cancel="Cancel",n.Calendar_ShortWeeks_1="MON",n.Calendar_ShortWeeks_2="TUE",n.Calendar_ShortWeeks_3="WED",n.Calendar_ShortWeeks_4="THU",n.Calendar_ShortWeeks_5="FRI",n.Calendar_ShortWeeks_6="SAT",n.Calendar_ShortWeeks_7="SUN",n.Calendar_Weeks_1="Monday",n.Calendar_Weeks_2="Tuesday",n.Calendar_Weeks_3="Wednesday",n.Calendar_Weeks_4="Thursday",n.Calendar_Weeks_5="Friday",n.Calendar_Weeks_6="Saturday",n.Calendar_Weeks_7="Sunday",n.Calendar_ShortMonths_1="JAN",n.Calendar_ShortMonths_2="FEB",n.Calendar_ShortMonths_3="MAR",n.Calendar_ShortMonths_4="APR",n.Calendar_ShortMonths_5="MAY",n.Calendar_ShortMonths_6="JUN",n.Calendar_ShortMonths_7="JUL",n.Calendar_ShortMonths_8="AUG",n.Calendar_ShortMonths_9="SEP",n.Calendar_ShortMonths_10="OCT",n.Calendar_ShortMonths_11="NOV",n.Calendar_ShortMonths_12="DEC",n.Calendar_Months_1="JANUARY",n.Calendar_Months_2="FEBRUARY",n.Calendar_Months_3="MARCH",n.Calendar_Months_4="APRIL",n.Calendar_Months_5="MAY",n.Calendar_Months_6="JUNE",n.Calendar_Months_7="JULY",n.Calendar_Months_8="AUGUST",n.Calendar_Months_9="SEPTEMBER",n.Calendar_Months_10="OCTOBER",n.Calendar_Months_11="NOVEMBER",n.Calendar_Months_12="DECEMBER",n.Calendar_Time_AM="AM",n.Calendar_Time_PM="PM",n.Calendar_EraName_1="M",n.Calendar_EraName_2="T",n.Calendar_EraName_3="S",n.Calendar_EraName_4="H",n.Calendar_FirstYear="1",n.Calendar_Today="Today",n.Calendar_BuiltIn_Today="Today",n.Calendar_BuiltIn_Yesterday="Yesterday",n.Calendar_BuiltIn_Last7Days="Last 7 Days",n.Calendar_BuiltIn_ThisMonth="This Month",n.Calendar_BuiltIn_LastMonth="Last Month",n.Calendar_LastMonth="Go to previous month",n.Calendar_NextMonth="Go to next month",n.Calendar_LastYear="Go to previous year",n.Calendar_NextYear="Go to next year",n.Calendar_LastTenYear="Go to previous ten years",n.Calendar_NextTenYear="Go to next ten years",n.Quarter_Format_1="Q1",n.Quarter_Format_2="Q2",n.Quarter_Format_3="Q3",n.Quarter_Format_4="Q4",n.ThemeColor="Theme Colors",n.StandardColor="Standard Colors",n.Calculator_DivideByZeroInfo="Cannot divide by zero.",n.Calculator_InvalidInputInfo="Invalid Input.",n.Calculator_SqrtParameterException="Invalid input for function.",n.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",n.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",n.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",n.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",n.DataObject_MeetTable="Cannot insert data because a table in the way."},"./dist/plugins/celltype/checkboxcelltype.js":function(F,t,n){"use strict";var e,i,A,r,c,w,a,s,n,b,o,y,u,f,l,I,h,d,M,C,S,T,x,v,m,L,g,B,p,P,G,N,k,_,U,D,j,O,E,i,H;function V(t,n,e,i){var t,r,t=t.Ut;t&&(t.do("setValueForKey",n,e,k,f,i),r=t.getValueForKey(n,e,_,i))&&(clearTimeout(r),t.do("setValueForKey",n,e,_,f,i))}function R(){var t,e,t=H.call(this)||this;return t.typeName="5",t._boxSize=D,e=t,o(j,function(t,n){e["_"+t]=n}),t}function z(t){return 5*t}function Y(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,e,g,p,b,w,y,M,C,a,S,c,i,T,n,s=5*a,c=n.hAlign,f=e.x,l=e.width,h=0,d=0,v=n.vAlign,m=e.y,e=e.height,g=0,p=0,b=1<i.split("\n").length,w=f,y=m,M=l,C=e,a=D*a;return 0===t||1===t?(1===c?d=f+l/2-a/2:M=2===c?(d=f+l-s-a,l-s+2):(w=(d=f+s)-1,l-s+1),C=(c=A.q.un(i,S=M-3-1,n.font)).length*o,b=b||1<c.length,g=a+C,y=0===t?(1===v?(p=m+e/2-g/2+C-3,C+=6):p=2===v?m+e-s-g+C:m+s+C,p-C):(1===v?(p=m+e/2-g/2-3,C+=6):p=2===v?m+e-s-g:m+s,p+a)):(p=1===v?m+e/2-a/2:2===v?m+e-s-a:m+s,n=o/2-(i=I(u.fontInfo.fontSize))/2+(T=8<i?Math.floor((i-8)/5+2):1)-1,b=b||l-a-s-4<r,M=l-a-s,2===v?C=e+n+2-s:0===v&&(C=e-((y=m-(2+n)+s)-m)),2===t?(d=f+l-s-a,M=l-a):w=(d=f+s)+a+1),{multiLine:b,startX:d,startY:p,textX:w,textY:y,textW:M,textH:C}}function Z(t,n,e,i,r){var o,n,a,e,u,s,o=5*r,n=n.hAlign,a=e.x-1,e=e.width+1,u=0,s=0;return 0===t||1===t?(s=a+o,1===n?s=a+e/2-D*r/2:2===n&&(s=a+e-o-D*r)):2===t?(u=D*r+i,s=a+o+i,1===n?s=a+e/2-u/2+i:2===n&&(s=a+e-o-u+i)):(u=D*r+i,s=a+o,1===n?s=a+e/2-u/2:2===n&&(s=a+e-o-u)),s-a}function W(t,n,e,i,r){var o,n,a,e,u,s,o=5*r,n=n.vAlign,a=e.y-1,e=e.height+1,u=0,s=0;return 0===t?(u=D*r+i,s=a+o+i,1===n?s=a+e/2-u/2+i:2===n&&(s=a+e-o-u+i)):1===t?(u=D*r+i,s=a+o,1===n?s=a+e/2-u/2:2===n&&(s=a+e-o-u)):(s=a+o,1===n?s=a+e/2-D*r/2:2===n&&(s=a+e-o-D*r)),s-a}function Q(t,n,e,i,r){var o,o,o,o=n.getValue(e,i,r),o=t.wG(o),o={cmd:"editCell",sheetName:n.name(),row:e,col:i,newValue:o,autoFormat:!0};n.Qy().execute(o),t.j3(n,e,i,r)}function J(t,n,e,i,r){var o,a,o=r&&r.sheet,a=t.getEditorValue(n,r);t.setEditorValue(n,a,r),t.updateEditor(n,e,i,r),t.j3(o,o.ui,o.ci,r.sheetArea)}e=this&&this.__extends||(E=function(t,n){return(E=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}E(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,i=n("Common"),A=n("Core"),r=A.mt.En,c=i.Common.lt.ht,w=A.mt.vt,a=A.mt.vi,s=A.CellTypes.Context,n=A.CellTypes.Base,b=A.GC$,o=b.each,y=A.mt.yt,u=null,f=void 0,l=Math.max,I=parseInt,h="position",d="absolute",M="font",C="left",S="right",T="top",x="alphabetic",v=".gcEditingInput",m="background-color",L="white",g="green",B="div",p="normal 11pt calibri",P="width",G="height",N="white-space",k="_isFirstMouseUp",_="_mouseupToken",(i=U=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[i.top=0]="top",i[i.bottom=1]="bottom",i[i.left=2]="left",i[i.right=3]="right",j={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(D=12),boxSize:D},e(R,H=n),R.prototype.Poe=function(t,n,e,i,r,o,a,u){var s=this,c=I(e.startX),f=I(e.startY),l=I(e.textX),h=I(e.textY),d=I(e.textW),e=I(e.textH);s.Goe(t,c,f,r,o,a),s.paintText(t,n,l,h,d,e,u,i,n,null)},R.prototype.Goe=function(t,n,e,i,r,o){t.save(),t.strokeStyle="black",t.strokeRect(n+.5,e+.5,2*i+.05,2*i+.05),t.fillStyle=L,t.fillRect(n+1,e+1,2*i-1,2*i-1),this._isThreeState&&c(o)?(t.beginPath(),t.fillStyle=g,t.rect(n+3*r,e+3*r,2*(i-2.5*r),2*(i-2.5*r)),t.fill()):!0==!!o&&(t.beginPath(),t.lineWidth=2.5*r,t.moveTo(n+3*r,e+i),t.lineTo(n+i,e+2*i-3.5*r),t.lineTo(n+2*i-1.5*r,e+3*r),t.stroke()),t.restore()},R.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,g,p,b,p,b,p,r,o,o,r,p,e,o,i,r,s,c,a;t&&(t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),s=a.hAlign,c=a.font,f=a.foreColor,h=(l=this)._textAlign,d=l.getText(n,u),m=v=0,(g=u.sheet)&&(v=g.Qt(d,c),m=w(c)),g=g.zoom(),p=u.isPrinting,b=u.printZoomFactor,++e,++i,--r,--o,b=(p=this.CG(m,g=p&&"number"==typeof b&&1!==b?b:g)).radius,p=p.scaleFactor,r=new A.Rect(e,i,r,o),a.wordWrap&&(o=Y(h,a,r,d,v,m,g*p,u)).multiLine?l.Poe(t,d,o,u,b,g,n,a):(o=Z(h,a,r,v,g*p),r=W(h,a,r,m,g*p),p=I((e+o).toString()),e=I((i+r).toString()),o=C,i=p+1,1===s?(o="center",i+=b):2===s&&(o=S,i+=2*b),c&&t.font!==c&&A.mt.bt(t,c),f&&(t.fillStyle=f),r=a.textDecoration,a=m/2-(s=parseInt(u.fontInfo.fontSize,10))/2+(c=8<s?Math.floor((s-8)/5+2):1)-1,t.textBaseline!==x&&(t.textBaseline=x),2===h?(t.textAlign=S,t.fillText(d,p+1-2,e+b+m/2-a),r&&l.le(t,r,p+1-2,e+b+m/2-a,v,s,c)):0===h&&(t.textAlign=o,t.fillText(d,i,e-2-a),r)&&l.le(t,r,i,e-2-a,v,m),l.Goe(t,p,e,b,g,n),f&&(t.fillStyle=f),3===h?(t.textAlign=C,t.fillText(d,p+1+2*b+2,e+b+m/2-a),r&&l.le(t,r,p+1+2*b+2,e+b+m/2-a,v,s,c)):1===h&&(t.textAlign=o,t.fillText(d,i,e+2*b+2+m-a),r)&&l.le(t,r,i,e+2*b+2+m-a,v,s,c)),t.restore())},R.prototype.CG=function(t,n){var e,i,r,o,e,i=this._boxSize,r=D/2,o=1;return"auto"===i&&(r=t/4,o=t/2/D),"number"==typeof i&&0<i&&(r=n*i/2,o=i/D),{radius:r,scaleFactor:o}},R.prototype.bi=function(t,n,e){var i,n,t,r,o,a,i,n=n.font,t=this.getText(t,e),r=0,o;return e.sheet&&(r=w(n),t)&&(r*=(a=t.split(/\r\n|\r|\n/)).length),r},R.prototype.getText=function(t,n){return this.SG(t)},R.prototype.focus=function(t,n){t&&t.parentNode.focus()},R.prototype.createEditorElement=function(t,n){var e,e,e,n,t,i,i,n,e=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,e=A.mt.gi(e)+1e3;return b(n).css("z-index",e).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(e=b(n.firstChild)).css("overflow","hidden"),(n=b(r("input"))).attr("type","checkbox"),n.attr("class","gc-checkbox-cell-type-input"),i=(t=this.TG(t))/D,n.css("transform","scale("+i+")"),e.append(n),(i=b(r("span"))).css(h,d).css(M,y(p)).css("cursor","default").css(N,"nowrap").css("word-break","break-all"),e.append(i),(n=b(r(B))).css(h,d).css(m,g).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),e.append(n),u},R.prototype.TG=function(t){var n,e,n,i,n=t.sheet,e=n.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*e:"auto"===this._boxSize?(i="",i=(n=n.Z_(t.row,t.col))&&n.font?n.font:p,e*w(i)/2):D/2},R.prototype.wG=function(t){var t,t=this._isThreeState?!c(t)&&(!0!=!!t||u):!t;return t},R.prototype.setEditorValue=function(t,n,e){var t,i,r,t,o,e,a,u,s;t&&(i=(t=t.parentNode.children)[0],r=t[1],t=t[2],i)&&r&&t&&(o=this,s=u=void 0,(a=(e=e&&e.sheet)&&e.Ai)||(s=o.wG(n)),o._isThreeState?c(s)?(u=!1,b(t).show()):(u=!!s,b(t).hide()):u=!!s,i.checked=u,b(r).text(o.SG(s)))},R.prototype.getEditorValue=function(t,n){if(t){var t=t.parentNode.children,e=t[0],i=t[1],t=t[2];if(e&&i&&t&&(!this._isThreeState||!b(t).isVisible()))return e.checked}return u},R.prototype.j3=function(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)},R.prototype.activateEditor=function(n,e,i,r){var t,t,o,t=r&&r.sheet;n&&t&&(t=b(n.parentNode.parentNode),o=this,t.bind("mousedown"+v,function(t){a(t)}),t.bind("mouseup"+v,function(){J(o,n,e,i,r)}),t.bind("keydown"+v,function(t){var n=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===n)return o.AG=!0,a(t),!1;8===n&&a(t)}}),t.bind("keyup"+v,function(t){!o.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(o.AG=!1,J(o,n,e,i,r))}),b(n).bind("click",function(t){a(t)}))},R.prototype.updateEditor=function(t,n,e,i){var r,o,t,a,u,s,a,t,s,c,f,l,h,c,f,o,r,d,c,s,i,v,m,e,f,m,e,u,g,p,l,s,r=i&&i.sheet;t&&r&&(o=r.Dn,u=(a=(t=t.parentNode).children)[0],s=a[1],a=a[2],u)&&s&&a&&(b(t).width(e.width).height(e.height),s=(t=b(s)).text(),c=n.foreColor,f=n.font,l=n.hAlign,h=n.textDecoration,c&&t.css("color",c),c=void 0,c=f||o.Nn(),1<(f=r.zoom())&&(c=o._n(c)),t.css(M,y(c)),o=r.Gi(s,c),r=w(c),s&&(r*=(d=s.split(/\r\n|\r|\n/)).length),m=Z(s=(c=this)._textAlign,n,e,o,f*(v=(i=this.TG(i))/D)),e=W(s,n,e,r,f*v),b(u).css("margin-left",m).css("margin-top",e),f=u.offsetLeft,m=u.offsetTop,e=u.offsetWidth,u=u.offsetHeight,(p=g=0)===s?(g=f,1===l?g=f+i/2-o/2:2===l&&(g=f+i-o),p=m-r,g-=(v-1)*D/2,p-=(v-1)*D/2):1===s?(g=f,1===l?g=f+i/2-o/2:2===l&&(g=f+i-o),p=m+u,g-=(v-1)*D/2,p+=(v-1)*D/2):(2===s?(g=f-o-2,p=m+i/2-r/2,g-=(v-1)*D/2):(g=f+e+2,p=m+i/2-r/2,g+=(v-1)*D/2),p-=(v-1)*D/2),t.css(C,g).css(T,p),n.wordWrap?t.css(N,"normal"):t.css(N,"nowrap"),c._isThreeState?(l=f+(e-a.offsetWidth)/2,s=m+(u-a.offsetHeight)/2,b(a).css(C,l).css(T,s).toggle().toggle()):b(a).hide(),h)&&c.Qe(t,h)},R.prototype.SG=function(t){var n=this,e=n._caption;return n._isThreeState&&c(t)?n._textIndeterminate||e:!0==!!t?n._textTrue||e:n._textFalse||e},R.prototype.getHitInfo=function(t,n,e,i,r){if(r){var o=r.sheetArea;if(c(o)||3===o)return{x:t,y:n,row:r.row,col:r.col,cellRect:i,sheetArea:3,isReservedLocation:!0,sheet:r.sheet,cellStyle:e}}return u},R.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},R.prototype.processMouseUp=function(t){var n,e,i,r,o,a,t,n=this,e=t&&t.sheet;if(e&&n.pG&&t.isReservedLocation){if(n.pG=!1,i=t.row,r=t.col,o=t.sheetArea,!(a=e.Ut.getValueForKey(i,r,k,o)))return Q(n,e,i,r,o),e.Ut.do("setValueForKey",i,r,k,!0,o),t=setTimeout(function(){V(e,i,r,o)},250),e.Ut.do("setValueForKey",i,r,_,t,o),!0;V(e,i,r,o)}return!1},R.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},R.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},R.prototype.processKeyUp=function(t,n){return Q(this,n.sheet,n.row,n.col,n.sheetArea),!0},R.prototype.getAutoFitWidth=function(t,n,e,i,r){var o,a,u,t,e,o=this,a=o._textAlign,u=s.Bt(t,o.SG(t),e,i,r),t=o.bi(t,e,r),e=2*o.CG(t,i).radius;return 0===a||1===a?u=l(u,e):u+=e,u+5+2},R.prototype.getAutoFitHeight=function(t,n,e,i,r){var o,a,u,u,t,e,o=this,a=o._textAlign,u=o.SG(t),u=s.tn(u,u,e,i,r),t=o.bi(t,e,r),e=2*o.CG(t,i).radius;return 0===a||1===a?u+=e:u=l(u,e),u+5},R.prototype.QD=function(t){this.isReservedKey(t)&&a(t)},R.prototype.isImeAware=function(t){return!1},R.prototype.Ke=function(){},R.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&U[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},R.prototype.toJSON=function(){var e,i,r,e=this,i={typeName:e.typeName};return o(j,function(t,n){(r=e["_"+t])!==n&&(i[t]=r)}),i},R.prototype.fromJSON=function(e){var i=this;o(j,function(t){var n=e[t];c(n)||(i["_"+t]=n)})},R.prototype.Tfe=function(t){var n,e=this._textAlign;return 2===e||3===e?D*t+5*t:0},O=R,t.CheckBox=O,o(j,function(n){O.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:("boxSize"===n&&("number"==typeof t&&0<t&&(this["_"+n]=t),"auto"!==t)||(this["_"+n]=t),this)}}),A.CellTypes.ti[5]=O},"./dist/plugins/celltype/comboboxcelltype.js":function(r,t,n){"use strict";var o,B,b,P,f,l,G,c,u,h,a,U,H,V,z,d,v,w,s,m,g,p,y,Y,Z,W,Q,M,C,S,T,J,A,I,x,K,X,N,k,q,$,tt,_,nt,et,D,it,j,rt,ot,at,O,ut,st,ct,ft,lt,ht,dt,vt,mt,E,gt,pt,bt,wt,yt,Mt,Ct,n,St;function R(t,n){t.appendChild(n)}function Tt(t,n){t.removeChild(n)}function F(t){return t&&t.parentNode.parentNode.comboBox}function e(t,n,e,i,r,o,a,u,s){var c,n,s,t,e,i,e,t,s,c=this;c.xG=t,c.sfe=n,c.dfe=s,n=t.firstChild,h(t).bind(g,function(t){c.NG(t)}).css([q,C,S,I,x,"overflow"],[a||0,e,i,r,o,"visible"]).attr([T],["gcComboBox"]),s=w(0,r-17),c._editable=!1,c.DG=t=f(D),c._G=e=f("textarea"),R(n,c.EG=t),At(t),At(e),h(e).bind("keyup",function(){var t,n,t=c.EG.value;c._text=t,n=c.jG(t),c.editorValue(n),c.OG(t,!0,n),c.RG()}).bind(p,function(){c.BG()}).bind(y,function(){c.RG()}),h(t).bind(m,function(){c.LG?c.ki(E,{isMouse:!0}):c.PG()}).bind(p,function(){c.BG()}).bind(y,function(){c.RG()}),c.GG(0,0,s,o),R(n,i=c.UG=f(D)),h(i).css([ot,W,k,X],[A,Q,_,tt]).attr(T,"gcDropDownButton").bind(m,function(){var t,n;!l(c.HG)&&(t=c.HG,c.HG=v,(n=(new Date).valueOf())-t<100)||(c.LG?c.ki(E,{isMouse:!0}):c.PG())}),e=f("canvas"),c.fg=e,c.zG(s,0,r-s,o),R(i,e),R(n,t=c.VG=f(D)),c.YG=!1,c.ZG=u||r,h(t).css([W,ot,k,q,K,$,"cursor",X,x,at],[Q,"1px solid",_,a||0,A,A,"default",tt,o,c.ZG+O]),h(t).attr(T,"gcDropDownWindow").attr(J,-1),c.WG(0,+o),c.QG=0,R(t,s=c.KG=f(D)),c.JG=new b.x4(t,s),c._itemHeight=22,c.qG=20,c.$G=-1,c._editorValueType=0,c._items=[],c.eU=pt,c.iU=""}function At(t){h(t).css(["margin","overflow","resize",W,"padding",K,k,"white-space",X,ot],[0,"hidden",A,Q,dt+"px 0px 0px "+ht+O,A,_,"nowrap",tt,A]).attr(T,"gcComboBoxEditor").attr(J,-1)}function i(){var t,e,t=St.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,e=t,a(wt,function(t,n){e["_"+t]=n="items"===t?[]:n}),t}function It(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===Y&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}function L(t,n){return t.hasOwnProperty(n)}o=this&&this.__extends||(Ct=function(t,n){return(Ct=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Ct(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,B=n("Common"),b=n("Core"),P=b.CellTypes.Base,f=b.mt.En,l=B.Common.lt.ht,G=B.Common.ft,c=b.mt,u=c.vi,h=b.GC$,a=h.each,U=c.yt,H=c.Ct,V=c.M0,z=document,d=null,v=void 0,w=Math.max,s=parseInt,m="click",g="keydown",p="mouseover",y="mouseout",Y="string",Z="number",W="position",Q="absolute",M="font",C="left",S="top",T="gcUIElement",J="tabindex",A="none",I="width",x="height",K="outline",X="box-sizing",N="color",k="background-color",q="z-index",$="display",tt="content-box",_="white",nt="black",et="title",D="div",it="span",j="text",rt="value",ot="border",at="min-width",O="px",ut=c.wt,(n=st=t.EditorValueType||(t.EditorValueType={}))[n.text=0]="text",n[n.index=1]="index",n[n.value=2]="value",ct=17,dt=ht=1,vt=ht,E="EndEdit.gcEditingInput",gt=mt=18,pt="lightgrey",wt={editorValueType:lt=0,items:d,itemHeight:22,editable:!(bt="#1E90FF"),maxDropDownItems:ft=20,allowFloat:!0},e.prototype.getComboBox=function(){return this.xG},e.prototype.dispose=function(){var t=this;h(t.xG).unbind(g),h(t._G).unbind("keyup").unbind(p).unbind(y),h(t.DG).unbind(m).unbind(p).unbind(y),h(t.UG).unbind(m),h(t.KG).find("div").forEach(function(t){h(t).unbind(p).unbind(y).unbind(m)}),t.JG.dispose()},e.prototype.updateLocationAndSize=function(t,n,e,i){var r,o,r=this,o=w(0,e-17);r.GG(0,0,o,i),r.zG(o,0,e-o,i),r.WG(0,+i)},e.prototype.updateStyle=function(t,n,e){var i=this;e=U(e),t=t||v,h(i.EG).css(k,t).css(N,n).css(M,e),h(i.UG).css(k,t).css(N,n).css(M,e),h(i.VG).css(k,t).css(N,n).css(M,e),i.iU=n,h(i.xG).css(k,"transparent"),i.eU=G.Tv(G._(t),G._(pt))?_:pt},e.prototype.updateImeMode=function(t){h(this.EG).css("ime-mode",t)},e.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},e.prototype.editorValue=function(t){var n,e,n=this;return 0===arguments.length?n.oU:(t!==n.oU&&(n.oU=t,e=n.aU(t),n.text(e),n.OG(e,!0,t)),n)},e.prototype.aU=function(t){var n,e=this,i=e._items,r=i.length,o=e._editorValueType,a,u,s;if(e.uU=!0,1===o)(n=(a=i[t])&&L(a,j)?a.text:a)===v&&(n=t,e.uU=!1);else if(0===o){for(n=t,s=0;s<r&&!((a=i[s])&&L(a,j)&&a.text===t||a===t);s++);r<=s&&(e.uU=!1)}else if(2===o){for(u=0;u<r;u++)if((a=i[u])&&L(a,rt)&&a.value===t){n=a.text;break}r<=u&&(n=t,e.uU=!1)}return n=l(t)?"":n},e.prototype.jG=function(t){var n,e,i,n,r,o,a,u,n=this,e=n._items,i=e.length,n=n._editorValueType,r=t;if(1===n)for(a=0;a<i;a++)((o=e[a])&&L(o,j)&&o.text===t||o===t)&&(r=a);else if(2===n)for(u=0;u<i;u++)(o=e[u])&&L(o,j)&&o.text===t?r=o.value:o===t&&(r=v);return r},e.prototype.OG=function(t,n,e){var i,r,o,a,u,s,c,f,r=-1;if(!l(t)&&""!==t)for(a=(o=this._items).length,i=0;i<a;i++)if(c=s=void 0,s=L(u=o[i],j)?u.text:u,L(u,rt)&&(c=u.value),(f=n?s:s.toString().substr(0,t.length))===t){if(r=i,l(e))break;if(!l(c)&&c===e)break}this.sU(r)},e.prototype.RG=function(){h(this.EG).removeAttr(et)},e.prototype.BG=function(){var t,n,e,i,t=this,n=t.Wt(t._text),e=h(t.EG),i;e.width()+ht<n?e.attr(et,t._text):e.removeAttr(et)},e.prototype.GG=function(t,n,e,i){e-=0,i-=0,h(this.EG).css(C,t).css(S,n).css(I,e-ht).css(x,i-dt)},e.prototype.editable=function(t){var n,e,i,r,o,r,n=this;return 0===arguments.length?n._editable:n._editable!==t?(n._editable=t,e=n.xG.firstChild,i=n.EG,r=h(i),o={left:s(r.css(C)),top:s(r.css(S)),width:s(r.css(I)),height:s(r.css(x))},r={backColor:r.css(k),foreColor:r.css(N),font:i.style.font},Tt(e,i),n.EG=t?n._G:n.DG,R(e,n.EG),h(n.EG).css(k,r.backColor).css(N,r.foreColor).css(M,r.font),n.GG(o.left,o.top,o.width,o.height),n):void 0},e.prototype.text=function(t){var n=this,e=n.EG;if(0===arguments.length)return n._text;t!==n._text&&(n._text=t,n._editable?e.value=t:e.textContent=t)},e.prototype.focus=function(){var t=this,n=t.EG;n.focus(),t._editable&&(n.selectionStart=n.value.length)},e.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},e.prototype.zG=function(t,n,e,i){var r,o,r,t,n;e-=0,i-=0,o=(r=this).fg,h(r.UG).css(C,t).css(S,n).css(I,e).css(x,i),h(o).attr(I,e).attr(x,i),r=o.width,t=o.height,(n=o.getContext("2d")).beginPath(),n.lineWidth=2,n.fillStyle=nt,n.moveTo(r-17+4,(t-2)/2-2.5),n.lineTo(r-17+7,(t-2)/2+3.5),n.lineTo(r-17+10,(t-2)/2-2.5),n.fill()},e.prototype.showDropDownList=function(){var n=this,t=n.JG;n.YG=!0,h(n.VG).bind(g,function(t){n.NG(t)}).show(),n.cU=!1,n.fU(),this.adjustPosition(),n.cU&&t.pS(h(n.KG.children).height()),t.w4(!1),n.lU(bt,_),n.hU(n.$G),n.focus()},e.prototype.adjustPosition=function(){var t,n,e,i,r,o,a,u,s,c,f,c,l,l,l,c,t=this,n=h(t.VG);n&&(e=parseInt(n.css("left"),10),i=parseInt(n.css("top"),10),r=n.width(),o=n.height(),isNaN(e)||isNaN(i)||isNaN(r)||isNaN(o)||(u=a=0,!(s=.8)!==this.dfe?(f=(c=z.documentElement).clientWidth,c=c.clientHeight,l=n[0].getBoundingClientRect(),c<o&&(n.css("max-height",Math.round(.8*c)+O),o=Math.round(.8*c)),f<r&&(n.css("max-width",Math.round(.8*f)+O),r=Math.round(.8*f)),l.left+r>f&&(u=l.left+r-f),l.top+o>c&&(a=l.top+o-c)):(c=(l=t.sfe).clientHeight,f=l.clientWidth,c<o&&(o=Math.round(.8*c),n.css("max-height",o+O)),f<r&&(r=Math.round(.8*f),n.css("max-width",r+O)),l=n[0].getBoundingClientRect(),c=t.sfe.getBoundingClientRect(),a=w(0,l.bottom-c.bottom),u=w(0,l.right-c.right)),(e<0||i<0||0<a||0<u)&&((e-=u)<0&&(e-=22),n.css({left:e+O,top:(i-=a+5)+O}))))},e.prototype.shiftPadding=function(t,n){var e=this.xG.firstChild;t===C?h(e).css({left:(+h(e).css(C).replace(O,"")||0)-n}):t===S&&h(e).css({top:(+h(e).css(S).replace(O,"")||0)-n})},e.prototype.closeDropDownList=function(){var t=this;t.YG=!1,h(t.VG).unbind(g).hide(),t.lU("",t.iU),t.focus()},e.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},e.prototype.listHeight=function(t){var n=this,e=h(n.VG);if(0===arguments.length)return e.height();0<t&&(e.height(t),n.JG.w4(!1))},e.prototype.WG=function(t,n){h(this.VG).css(C,t).css(S,n)},e.prototype.items=function(t){var n,e,i,r,o,a,n=this;if(0===arguments.length)return n._items;if(t){for(n._items=t,e=n.KG,i=void 0,h(e).find("div").forEach(function(t){h(t).unbind(p).unbind(y).unbind(m)}),i=e.firstChild;i;)Tt(e,i),i=e.firstChild;for(r=n.QG=0,o=t.length;r<o;r++)a=t[r],n.dU(L(a,j)?a.text:a);return n}},e.prototype.dU=function(t){var n,e,i,n=this,e=f(D),i=f(it);i.textContent=t.toString(),i.style.padding="0 18px 0 "+vt+O,i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",R(e,i),R(n.KG,e),n.QG++,h(e).bind(m,function(){var t=h(e).index();n.selectedIndex(t),n.closeDropDownList(),n.ki(E,{isMouse:!0})}).bind(p,function(){var t=h(e);e.oldBackColor=t.css(k),t.css(k,n.eU)}).bind(y,function(){h(e).css(k,e.oldBackColor||"")}).css(at,n.ZG+"px")},e.prototype.vU=function(){var t=this;t.S5=f(it),h(t.S5).css([$,M],[A,t.VG.style.font]).appendTo(z.body)},e.prototype.mU=function(){Tt(z.body,this.S5)},e.prototype.Mt=function(t){return this.S5.textContent=t,h(this.S5).width()+2+vt},e.prototype.lU=function(t,n){var e=this,i=e.$G;0<=i&&i<e.QG&&h(e.KG.children[i]).css([k,N],[t,n])},e.prototype.NG=function(t){var n,e,i,r,o,a,n=this,e=t.keyCode,i=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===i||39===i)&&9!==i&&n.editable()||(r=n.QG,o=n.$G,a=0,38===i||40===i?(0<=(a=0<=o&&o<r?o+(38===i?-1:1):a)&&a<r&&n.selectedIndex(a),n.YG&&n.hU(a),u(t)):13===i||37===i||39===i||9===i?(n.selectedIndex(n.$G),(n.YG||n.editable())&&n.closeDropDownList(),n.ki(E,{keyCode:e,shiftKey:t.shiftKey}),(n.YG||n.editable())&&u(t)):27===i?(n.closeDropDownList(),n.ki(E,{keyCode:e}),u(t)):n.editable()||32!==i||u(t))},e.prototype.getSelectedValue=function(t,n,e){var n,i,n=n[t];return l(n)||(1===e?i=t:0===e?i=L(n,j)?n.text:n:2===e&&L(n,rt)&&(i=n.value)),i},e.prototype.sU=function(t){var n=this;n.lU("",n.iU),n.$G=t,n.lU(bt,_),n.hU(t)},e.prototype.selectedIndex=function(t){var n,t,n=this;if(0===arguments.length)return n.$G;0<=t&&t<n.QG&&(n.sU(t),t=n.getSelectedValue(n.$G,n._items,n._editorValueType),l(t)||n.editorValue(t))},e.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},e.prototype.allowFloat=function(t){var n=this;if(0===arguments.length)return n.dfe;n.dfe=t},e.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},e.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},e.prototype.fU=function(){var t,n,n,e,i,r,t=this;t.vU(),n=t._items[0],n=w(t._itemHeight,h(t.S5).text(l(n)?"":n).height()),h(t.KG.children).css(x,n),(i=t.QG)<=(r=t.qG)?e=i*n:(e=r*n,t.cU=!0),t.listHeight(e),t.mU()},e.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},e.prototype.bind=function(t,n,e){h(this.xG).bind(t,n,e)},e.prototype.unbind=function(t,n){h(this.xG).unbind(t,n)},e.prototype.ki=function(t,n){h(this.xG).trigger(t,n)},yt=e,o(i,St=P),i.prototype.isReservedKey=function(t,n){return this.rU},i.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,c,f,l,h,d,h,d,v,m,g,p,v,m,g,v,m,s=this,c=u.sheet,c=c.zoom?c.zoom():1,f=17,l=w(0,r-17-1);3===a.hAlign&&(a.hAlign=0),a.wordWrap&&(a.wordWrap=!1),h=u.isPrinting,d=u.printZoomFactor,h&&"number"==typeof d&&1!==d&&(c=d),0<l&&0<o&&(h={},d=void 0,u.quotePrefix=a.quotePrefix,v=a.formatter&&"General"!==a.formatter,m=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,g=void 0,p=this.getItemValue(n),g=v?a.formatter:m?a._autoFormatter:b.CellTypes.Context.Nt(t,p,l+1,a,c),d=this.format(ut(n),g,h,u),d=(v=s.getText(n,u))!==n?d||(n=v):d)&&(m=new b.Rect(e,i,r,o),St.prototype.adjustRectForIconSet.call(this,a.hAlign,u.sheet,u.row,u.col,u.sheetArea,m,h.content&&St.prototype.hasInfilling.call(this,h.content)),e=m.x,r=m.width,g=a.isVerticalText,H(p)&&!g&&!0!==a.shrinkToFit&&(d!==(v=b.CellTypes.Context.Et(t,d,l+1,a,c))&&(delete h.content,a.textIndent=0),d=v),m=s.Pn(t,d,a,u,e,i,r,o),this.paintText(t,n,e,i,l,o,a,u,d,h,void 0,m.externals)),t.save(),(r<17||o<17)&&(t.rect(e,i,r,o),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=nt,t.moveTo(e+r-17+3,i+(o-2)/2-2.5),t.lineTo(e+r-17+6,i+(o-2)/2+3.5),t.lineTo(e+r-17+9,i+(o-2)/2-2.5),t.fill(),t.restore()},i.prototype.getText=function(t,n){return t},i.prototype.createEditorElement=function(t,n){var e,i,i,i,r,o,a,u,a,s,s,t,e=t&&t.sheet,i=e&&e.parent,i=i&&i.Ti,i=c.gi(i)+1e3,r=e.defaults,o=this,a=e.getActualStyle(t.row,t.col).cellPadding,u=0;return a&&(u=parseFloat(It(a)[3])||0),a=0,a=(s=e.getSpan(t.row,t.col))?V(e,s.col,s.col+s.colCount,!1):e.nn(t.col)-u,(s=new yt(n,e.qc(),0,0,r.colWidth,r.rowHeight,i,a)).editorValueType(o._editorValueType),s.items(o._items),s.itemHeight(o._itemHeight),s.itemCountPerPage(o._maxDropDownItems),s.editable(o._editable),s.allowFloat(o.allowFloat()),t=s.getComboBox(),Object.defineProperty(t,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),t.comboBox=s,d},i.prototype.getEditorValue=function(t,n){var t=F(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},i.prototype.setEditorValue=function(t,n,e){var t=F(t);t&&t.editorValue(n)},i.prototype.focus=function(t,n){var t=F(t);t&&t.focus()},i.prototype.selectAll=function(t,n){var t=F(t);t&&t.selectAll()},i.prototype.activateEditor=function(t,n,e,i){var r,s,c,r=this,s=i.sheet,c=F(t);c&&(c.editorValueType(r._editorValueType),c.items(r._items),c.itemHeight(r._itemHeight),c.itemCountPerPage(r._maxDropDownItems),c.editable(r._editable),c.bind(E,function(t,n){var e,i,r,e,o,a,u,e=n.keyCode,i=n.shiftKey;if(e){if(e=(r=s.Qy()).getShortcutKey(e,!1,i||!1,!1,!1),o=r.getCommands(e))for(a=0,u=o.length;a<u;a++)if("navigationLeft"!==o[a].Zc&&"navigationRight"!==o[a].Zc||(s.Di=1),o[a].execute(s.parent,{sheetName:s.name()}))return!0}else n.isMouse&&c.LG&&s.endEdit()})),r.rU=!0},i.prototype.deactivateEditor=function(t,n){var e,i,r,o,a,u;if(t&&(e=F(t))){if(i=n.sheet.getActualStyle(n.row,n.col,n.sheetArea).cellPadding)for(r=[C,S],o=[3,0],a=0;a<r.length;a++)u=parseInt(It(i)[o[a]],10),e.shiftPadding(r[a],u=typeof u==Z&&0<u?u:0);e.unbind(E),e.closeDropDownList(),e.LG=!1}this.rU=!1},i.prototype.updateImeMode=function(t,n){var t;this.isImeAware()&&(t=F(t))&&t.updateImeMode(n)},i.prototype.updateEditor=function(t,n,e,i){var i,t,i,i=t&&i&&i.sheet;i&&(t=F(t),n&&t&&(i=i.Dn,t.updateStyle(n.backColor,n.foreColor||nt,i._n(n.font||i.Nn()))),e)&&t&&t.updateLocationAndSize(e.x,e.y,e.width,e.height)},i.prototype.format=function(t,n,e,i){var r,t;return l(t)?"":(t=(r=this).getItemValue(t),P.prototype.format.call(r,t,n,e))},i.prototype.getItemValue=function(t){var n,e,i,r,o,a,n,u,n=this,e=n._editorValueType,i=n._items;if(i)if(a=i.length,1===e){if(0<=(n=s(t))&&n<a&&(r=i[n])!==v&&r!==d)return o=L(r,j)?r.text:r}else if(2===e)for(u=0;u<a;u++)if((r=i[u])&&L(r,rt)&&r.value===t)return o=r.text;return t},i.prototype.parse=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i._editorValueType,o=i._items,s=P.prototype.parse.call(i,t,n);if(o){if(c=o.length,0===r)return s;if(1===r){for(u=0;u<c;u++)if((a=o[u])&&L(a,j)&&a.text===s||a===s)return u}else if(2===r)for(u=0;u<c;u++)if((a=o[u])&&L(a,j)&&a.text===s)return a.value}return s},i.prototype.getHitInfo=function(t,n,e,i,r){var o,a,u,u,u,n;return r&&(o=r.sheetArea,a=r.sheet,l(o)||3===o)&&i&&(u=It(e.cellPadding),u=parseInt(u[1],10)||0,u=i.x+i.width-u,n={x:t,y:n,row:r.row,col:r.col,cellStyle:e,cellRect:i,sheetArea:o,sheet:a},u-17<=t)&&t<u?(n.isReservedLocation=!0,n):d},i.prototype.processMouseDown=function(t){var n,e,e,n=t.sheet,e=t.sheetArea;(l(e)||3===e)&&t.isReservedLocation&&n&&(t.row===n.ui&&t.col===n.ci||n.setActiveCell(t.row,t.col),n.startEdit(),e=F(n.li))&&(c.Tt.mozilla&&(e.HG=(new Date).valueOf()),e.showDropDownList(),e.LG=!0)},i.prototype.getAutoFitWidth=function(t,n,e,i,r){var o;return e&&e.wordWrap&&(e.wordWrap=!1),b.CellTypes.Context.Bt(t,n,e,i,r)+17},i.prototype.getAutoFitHeight=function(t,n,e,i,r){return e&&e.wordWrap&&(e.wordWrap=!1),b.CellTypes.Context.tn(t,n,e,i,r)},i.prototype.isImeAware=function(t){return!0},i.prototype.lfe=function(t,n){var n=St.prototype.lfe.call(this,t,n);return t.readonly||this._editable||(n.readonly=!0),n},i.prototype.Ke=function(){},i.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&st[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},i.prototype.toJSON=function(){var i,r,o,i=this,r={typeName:i.typeName};return a(wt,function(t,n){var e;o=i["_"+t],("items"===t?o&&0<o.length:o!==n)&&(r[t]=o)}),r},i.prototype.fromJSON=function(e){var i=this;a(wt,function(t){var n=e[t];l(n)||(i["_"+t]=n)})},Mt=i,t.ComboBox=Mt,a(wt,function(n){Mt.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:(this["_"+n]=t,this)}}),b.CellTypes.ti[7]=Mt},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,n,f){"use strict";var e,i,r,l,o,o,h,s,o,d,v,r,a,c;function m(t){return t&&"object"==typeof t&&!(t instanceof i.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function u(t){return m(t)?g(t,""):[]}function g(t,n){for(var e,i,r,o,a,u,s,c,e=[],i,r=0,o=Object.keys(t);r<o.length;r++)a=o[r],s=n?n+"."+a:a,"function"!=typeof(u=t[a])&&(m(u)?(c=g(u,s),e.push({text:a,value:u,path:s,layout:{displayAs:l.LayoutDisplayAs.popup},items:c})):e.push({text:a,value:u,path:s}));return e}function p(t){var n=c.call(this)||this;return n.typeName="18",n.pU=t,n}e=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataObject=void 0,i=f("CalcEngine"),r=f("Common"),l=f("Core"),o=f("./dist/plugins/celltype/celltypes.ns.js"),o=new r.Common.ResourceManager(o.SR,"CellTypes"),h=o.getResource.bind(o),s="vc",o=l.CellTypes.Text,d=r.Common.lt.ht,v=void 0,e(p,c=o),p.prototype.Xe=function(t,n,e,i,r){var o=t.Z_(n,e,r,!0);o||((o=new l.Style).cellType=this),t.Ut.do("setStyle",n,e,o,r)},p.prototype.qe=function(s,c,t,n,e){var i,e,i,e=u(s.getValue(c,t,e));0<e.length?(n.formatter=this.pU,n.cellButtons=[{command:"openList",imageType:l.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],n.dropDowns=[{type:l.DropDownType.list,option:{items:e,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,n,e){for(var i,r,o,a,u,i=f("SheetsCalc"),r=e.sheetArea,o=e.col+1;o<t.getColumnCount(r);o++){if(t.isActualProtected()&&t.getCell(e.row,o,r).locked()){t.jT(16,h().DataObject_MeetLock);break}if(t.Ut.findSpan(e.row,o,r)){t.jT(16,h().DataObject_MeetSpan);break}if(3===r&&t.tables&&t.tables.find(e.row,o)||t.pivotTables&&t.pivotTables.findPivotTable(e.row,o)){t.jT(16,h().DataObject_MeetTable);break}if(d(t.getValue(e.row,o,r))){a=i.rangesToFormula([new l.Range(e.row,e.col,1,1)],c,o,15,1===s.parent.options.referenceStyle),u=e.path,t.Qy().execute({cmd:"editCell",sheetName:t.name(),row:e.row,col:o,sheetArea:r,newValue:"="+a+'."'+u+'"',autoFormat:!1});break}}}}]):(n.cellButtons=v,n.dropDowns=v),n.formatter&&l.util.St(n.formatter)&&s.SL(c,t,n.formatter)},p.prototype.paint=function(t,n,e,i,r,o,a,u){this.pU!==a.formatter||this.bU?(this.Xe(u.sheet,u.row,u.col,n,u.sheetArea),this.bU=!1):u.sheet.Ut.W_(u.sheetArea).getValueForKey(u.row,u.col,s)&&(this.Xe(u.sheet,u.row,u.col,n,u.sheetArea),u.sheet.Ut.W_(u.sheetArea).setValueForKey(u.row,u.col,s,v)),c.prototype.paint.call(this,t,n,e,i,r,o,a,u)},p.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},p.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},n.DataObject=r=p,l.CellTypes.ti[18]=r},"./dist/plugins/celltype/dropdown-action.js":function(c,t,n){"use strict";var S,T,A,I,x,N,k,g,_,t,p,D,j,O,i,r,o,E,n,b,R,F,L,B,P,G,U,H,V,e,a,w,u;function z(t,n){return e.createElement(t,n)}function s(C){return{canUndo:!1,execute:function(t,n,e){var i,t,r,o,a,u,s,c,f,l,h,d,v,f,m,g,p,b,w,f,l,t,y,r,M,f,l,i=(0,S._f)(t,n.sheetName);if(!i||t.jg().name()!==n.sheetName)return!1;if(t=n.row,r=n.col,(O(t)||O(r))&&(t=i.getActiveRowIndex(),r=i.getActiveColumnIndex()),o=n.sheetArea,O(o)&&(o=3),t<0||t>=i.getRowCount(o)||r<0||r>=i.getColumnCount(o))return!1;if(i.showCell(t,r,S.VerticalPosition.nearest,S.HorizontalPosition.nearest),s=i.getCellRect(t,r,a=1===o?-1:void 0,u=2===o?-1:void 0),i.parent&&!i.parent.options.scrollByPixel&&!i.isEditing()){if(0<(c=i.frozenColumnCount())&&c<(f=i.getViewportLeftColumn(1))&&(l=i.getSpan(t,r,o))&&l.col<=f&&f<l.col+l.colCount&&0<(h=f-c))for(d=0;d<h;d++)s.width=s.width-i.getColumnWidth(c+d+1,o);if(0<(v=i.frozenRowCount())&&v<(f=i.getViewportTopRow(1))&&(l=i.getSpan(t,r,o))&&l.row<=f&&0<(m=(f<l.row+l.rowCount?f:l.rowCount)-v))for(d=0;d<m;d++)s.height=s.height-i.getRowHeight(v+d+1,o)}switch(g=z("div"),p=Z(i,t,r,o),(O(n.row)||O(n.col))&&(n.row=i.getActiveRowIndex(),n.col=i.getActiveColumnIndex()),f=n.row,l=n.col,t=i.Il(f,l,o),y=W(C),(f=(r=t.dropDowns)&&0<r.length)&&(l=r.filter(function(t){return t.type===y})[0])&&(void 0!==l.option&&null!==l.option&&(w=l.option),M=l),C){case R:b=new k.ColorPicker(g);break;case F:b=w&&w.showDateRange?(p=Y(p,"dateRange"),new _.RangeCalendar(g,w)):(p=Y(p,"date"),new _.Calendar(g));break;case L:p=Y(p,"date"),b=new x.TimePicker(g);break;case B:p=(p=Y(p,"number")).toString(),b=new T.Calculator(g);break;case P:p=Y(p,"date"),b=new N.MonthPicker(g);break;case G:(b=new A.List(g)).formula=i.getFormula(n.row,n.col);break;case U:p=w&&w.showNumberRange?Y(p,"numberRange"):Y(p,"number"),b=new I.Slider(g);break;case H:b=new D.WorkFlow(g),"string"!=typeof p&&p!==E&&(p=p.toString());break;case V:b=new j.MultiColumn(g,E,i)}return Q(b,p,s,i,n,t,f,M,w),!0}}}function Z(t,n,e,i){var r,o;return t.isEditing()?(r=t.getCellType(n,e)).getEditorValue(t.li,o={sheet:t,row:n,col:e,sheetArea:i}):t.getValue(n,e,i)}function Y(t,n){var n,e;return"date"===n?"string"==typeof t?(t=r.yU(t))===E&&(t=new Date):t instanceof Date||(t=new Date):"dateRange"===n?t&&"object"==typeof t&&(t={start:o(t.start),end:o(t.end)}):"number"===n?"string"==typeof t?t=i.yU(t):"number"!=typeof t&&(t=0):"numberRange"===n&&(e=n=0,t&&"object"==typeof t&&("string"===t.start?n=i.yU(t.start):isNaN(t.start)||(n=t.start),"string"===t.end?e=i.yU(t.end):isNaN(t.end)||(e=t.end)),t={start:n,end:e}),t}function y(t,n,e,i){var r,o,a,u,e,n,u,a,s,r=e.row,o=e.col;(O(r)||O(o))&&(r=t.getActiveRowIndex(),o=t.getActiveColumnIndex()),a=e.sheetArea,O(a)&&(a=3),n&&n.submitCommand?"string"==typeof n.submitCommand?t.getParent().commandManager().execute({cmd:n.submitCommand,sheetName:t.name(),row:r,col:o,newValue:i.value}):"function"==typeof n.submitCommand&&((u={}).row=e.row,u.col=e.col,u.sheetArea=a,u.path=i.path,n.submitCommand.call(null,t,i.value,u)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:r,col:o,newValue:i.text,autoFormat:!i.noAutoFormat,sheetArea:a,isUndo:!1}),t.ci===o&&t.ui===r&&(e=t.getCellType(r,o),n={sheet:t,row:r,col:o,sheetArea:S.SheetArea.viewport},u=e.isImeAware(n),t.isEditing()?(a=t.Il(r,o,a),s=t.getCellRect(r,o),t.li.Li=i.value,e.updateEditor(t.li,a,s,n),e.setEditorValue(t.li,i.text,n)):u&&t.rt.ATe(e,r,o,i.text)))}function W(t){var n=-1;switch(t){case R:n=S.DropDownType.colorPicker;break;case F:n=S.DropDownType.dateTimePicker;break;case L:n=S.DropDownType.timePicker;break;case B:n=S.DropDownType.calculator;break;case P:n=S.DropDownType.monthPicker;break;case G:n=S.DropDownType.list;break;case U:n=S.DropDownType.slider;break;case H:n=S.DropDownType.workflowList;break;case V:n=S.DropDownType.multiColumn}return n}function M(t,n,e,i,r){var n,n,n=n.cellButtons;t&&n&&0<n.length&&(n=t.Ut.getValueForKey(e,i,a,r))&&n.isMouseDownReservedLocation&&(n.buttonDownIndex=-1,n.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(e,i)))}function Q(n,t,e,i,r,o,a,u,s){var c,f,l,h,d,s,t,s,v,v,t,s,e,m;b.ef(),c=i.parent,f=i.qc(),l=r.row,h=r.col,d=r.sheetArea,s&&(s.row=l,s.col=h),n.setOptions(s),n.setValue(t),s=f.getBoundingClientRect(),t=e.x+s.left,s=e.y+s.top,(v=C(c))&&(t+=v.x,s+=v.y),v=new g.Rectangle(t,s,e.width,e.height),s=(t=n.getOptions())&&!O(t.dropDownAlignment)?t.dropDownAlignment:S.DropDownAlignment.Far,e=t&&!O(t.dropDownDirection)?t.dropDownDirection:void 0,m=new g.PopupControl(n.getContainer(),v,{align:s,hostElement:f,direction:e}),w+=1,a&&n.wU(),m.open(),n.scrollToSelect(),a&&n.refresh(),n.on(p.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||m.close(),J(r,t)&&y(i,u,r,t)}),c&&(c.CC=c.CC||[],c.CC.push(m)),n.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),m.on("close",function(){M(i,o,l,h,d),n&&n.dispose(),--w,m=null;var t=c.CC.indexOf(m);c.CC.splice(t,1),b.cf()})}function C(t){var n,e,i,r;if(t&&(n=t.options.tabStripVisible)&&0!==(e=t.options.tabStripPosition)){switch(i={x:0,y:0},r=t.w2.kg,e){case 1:i.y=r.height;break;case 2:i.x=r.width}return i}}function J(t,n){return!0!==n.notSubmit&&(3===t.sheetArea||t.cmd!==B||!isNaN(n.value))}Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,S=n("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return S.Commands}}),T=n("./dist/plugins/celltype/editor/calculator.js"),A=n("./dist/plugins/celltype/editor/listControl.js"),I=n("./dist/plugins/celltype/editor/slider.js"),x=n("./dist/plugins/celltype/editor/timepicker.js"),N=n("./dist/plugins/celltype/editor/monthPicker.js"),k=n("./dist/plugins/celltype/editor/colorpicker.js"),g=n("./dist/plugins/celltype/editor/popupControl.js"),_=n("./dist/plugins/celltype/editor/calendar.js"),t=n("Common"),p=n("./dist/plugins/celltype/editor/baseControl.js"),D=n("./dist/plugins/celltype/editor/workflowPicker.js"),j=n("./dist/plugins/celltype/editor/multiColumnPicker.js"),O=t.Common.lt.ht,i=t.Common.st,r=t.Common.ct,o=S.mt.Eve,E=null,n=window,b=n.gcGlobal,R="openColorPicker",F="openDateTimePicker",L="openTimePicker",B="openCalculator",P="openMonthPicker",G="openList",U="openSlider",H="openWorkflowList",V="openMultiColumn",e=document,a="_cellButtonParam",S.Commands[R]=s(R),S.Commands[F]=s(F),S.Commands[L]=s(L),S.Commands[B]=s(B),S.Commands[P]=s(P),S.Commands[G]=s(G),S.Commands[U]=s(U),S.Commands[H]=s(H),S.Commands[V]=s(V),w=0,S.Workbook.ch("registerOpendropdownCommand",u={init:function(){this.commandManager().register(R,S.Commands[R]),this.commandManager().register(F,S.Commands[F]),this.commandManager().register(L,S.Commands[L]),this.commandManager().register(B,S.Commands[B]),this.commandManager().register(P,S.Commands[P]),this.commandManager().register(G,S.Commands[G]),this.commandManager().register(U,S.Commands[U]),this.commandManager().register(H,S.Commands[H]),this.commandManager().register(V,S.Commands[V])}}),S.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<w&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,n,e){"use strict";var i,e,r,o,a,u,s;function c(t){var n=u.call(this)||this;return n.Wc=t,n}function f(t){var n=s.call(this)||this;return n.Ti=t,n}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseDropdown=n.BaseControl=void 0,e=e("./dist/plugins/celltype/editor/eventbase.js"),u=e.EventBase,i(c,u),c.prototype.init=function(t,n,e){this.Ti=this.Wc.querySelector("."+n),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,n,e),this.Wc.appendChild(this.Ti))},c.prototype.GetContainer=function(){return this.Wc},c.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},c.prototype.CreateElement=function(t,n,e,i){var r,o,r=document.createElement(t);if(n&&(r.className=n),e)for(o in e)e[o]&&r.setAttribute(o,e[o]);return i&&i.appendChild(r),r},n.BaseControl=c,s=e.EventBase,i(f,s),f.prototype.getOptions=function(){return this.MU},f.prototype.updateStyle=function(t,n,e){},f.prototype.scrollToSelect=function(){},f.prototype.getContainer=function(){return this.Ti},f.prototype.refresh=function(){},f.prototype.wU=function(){},f.prototype.dispose=function(){},f.Event_ValueChanged="ValueChangedEvent",n.BaseDropdown=f},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,n,e){"use strict";var i,r,s,e,l,h,d,o,a,u,c,f,v,m,g;function p(t,n,e){var t=g.call(this,t)||this;return t.setOptions(n),t.CU=e,t}function b(t,n,e){var i={sheet:t};l(e)||(i.isEsc=e),t.ki(n,i)}i=this&&this.__extends||(m=function(t,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseSpreadPicker=void 0,r=e("./dist/plugins/celltype/editor/baseControl.js"),s=e("Core"),e=e("Common"),l=e.Common.lt.ht,h=Math.min,d=Math.max,o=null,a=".baseSpreadNS",u=800,c=400,f=100,g=r.BaseDropdown,i(p,g),p.prototype.setOptions=function(t){var n,t,n,n=this;(n.MU=t)&&(t=n.Ti,(n=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(n),this.SU=n,this.TU=this.AU(n))},p.prototype.setValue=function(t){var n,e,n=this;n.MU&&(e=n.TU,setTimeout(function(){var t;window.gcGlobal.cf(),e&&e.focus(!0)},1e3))},p.prototype.wU=function(){var t,n,e,i,r,e,t=this;t.SU&&(n=t.Ti,(e=t.MU)&&(i=e.width,r=e.height),e=t.IU(i,r),l(i)&&(i=e.width),l(r)&&(r=e.height),(0,s.GC$)(n).width(i).height(r))},p.prototype.refresh=function(){this.TU&&this.TU.refresh()},p.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=o),t.SU&&(t.SU=o),t.TU&&(t.TU.unbind(s.Events.DropdownSpreadMouseClick+a),t.TU.unbind(s.Events.DropdownSpreadKeyboardEnter+a),t.TU.L0(),t.TU=o)},p.prototype.IU=function(t,n){for(var e,i,r,o,a,u,s,c,c,t,t,n,f,e,i=this.TU,r=i.getActiveSheet(),o=r.getColumnCount(),a=0,u=0;u<o;u++)a+=r.getColumnWidth(u,3);return s=a,c=r.getRowCount(3)+r.getRowCount(1),c=r.getRowHeight(0,3)*c,s<800&&l(t)||s<=t?i.options.showHorizontalScrollbar=!1:(t=0,c+=t=i.zb?i.zb.ZC():t),c<400&&l(n)||c<n?i.options.showVerticalScrollbar=!1:(t=0,s+=t=(n=i.Xb)?(f=n.lS(!1))||i.NC():t),{width:h(s,800),height:h(d(c,100),400)}},p.prototype.AU=function(t){var t,n,e,i,t=new s.Workbook(t,{sheetCount:1});return t.xU=!0,(n=t.options).allowUserDragDrop=!1,n.allowUserDragFill=!1,n.allowUserResize=!1,n.allowUserZoom=!1,n.tabStripVisible=!1,n.allowContextMenu=!1,n.allowUserDeselect=!1,n.scrollbarMaxAlign=!0,(e=t.getActiveSheet()).RD=!0,i=this,t.bind(s.Events.DropdownSpreadMouseClick+a,function(t,n){i.submitData(n)}),t.bind(s.Events.DropdownSpreadKeyboardEnter+a,function(t,n){i.submitData(n)}),t},p.prototype.submitData=function(t){},n.BaseSpreadPicker=p,s.GC$.extend(s.Worksheet.prototype,{BD:function(){b(this,s.Events.DropdownSpreadMouseClick)},GD:function(t){b(this,s.Events.DropdownSpreadKeyboardEnter,t)},Lpe:function(t,n,e){var u,i,i,u=this,i=u.Rpe(),i=i&&i[t]&&i[t][n];i&&(u.suspendPaint(),i.forEach(function(t){var n,e,i,r,o,a,r,o,n=t.row,e=t.col,i=t.dataSource,r=t.dependSheetName,o=t.targetSheetName;r===u.name()&&(r=(r=(a=u.getParent()).Gm(o))._gi===s.SheetType.reportSheet&&r.getSheet?r.getSheet():r)&&(o=r.getStyle(n,e))&&o.dropDowns&&o.dropDowns.some(function(t){return t.type===s.DropDownType.multiColumn&&t.option.dataSource===i})&&r.YI(t.row,t.col,null)}),u.resumePaint())},Rpe:function(){var t,n,t=this,n=t.Fpe;return n=n||(t.Fpe=[])}})},"./dist/plugins/celltype/editor/calculator.js":function(t,n,e){"use strict";var i,o,r,a,u,e,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S;function T(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function A(){}function I(){}function x(){}function N(t,n,e,i,r,o,a,u,s,c,f){var l=this;l.Y6=t,l._x=n,l._y=e,l.NU=i,l.kU=r,l.DU=o,l._U=a,l.EU=u,l.jU=s,l.OU=c,l.RU=f,l.BU=g}function k(t){var n,e,i,n=S.call(this,t)||this,e=n;return e.Ti=document.createElement("div"),e.Ti.classList.add("gc-calculator-container"),e.Ti.innerHTML=c,(i=e.Ti.querySelector(".okbtn")).textContent=s().OK,t.appendChild(n.Ti),e.LU(),e.FU(),e.PU(),e.GU(),e.UU("0"),n}i=this&&this.__extends||(C=function(t,n){return(C=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}C(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Calculator=n.CalculatorErrorInfo=void 0,o=e("./dist/plugins/celltype/editor/baseControl.js"),r=e("./dist/plugins/celltype/celltypes.ns.js"),a=e("Common"),u=e("Core"),e=new a.Common.ResourceManager(r.SR,"CellTypes"),s=e.getResource.bind(e),c='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',f=Math.floor,l=Math.abs,h=Math.pow,d=Math.round,v=Math.sqrt,m=Math.max,g=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),A.Init=function(){var t;A.GetBrowserType(),A.IsIE=void 0!==A.ie||void 0!==A.edge},A.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?A.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?A.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(A.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(A.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(p=A).Init(),I.IsErrorText=function(t){return t===s().Calculator_DivideByZeroInfo||t===s().Calculator_InvalidInputInfo||t===s().Calculator_SqrtParameterException||t===s().Calculator_OverFlowInfo},b=I,n.CalculatorErrorInfo=b,x.IsDotContained=function(t){var n;return-1!==(t+"").indexOf(".")},x.GetDotPosition=function(t){var n,e,i,n=t+"",e=0,i=0;for(i=n.length;0<i;i--){if("."===n.substring(i-1,i))return e;e++}return 0===i?0:e},x.FormatOutput=function(t){var n,e,i;if(null==t)return null;if(e=0,i=(n=t+"").length,x.IsDotContained(n))for(;"0"===n.substring(i-1,i)&&""!==n&&-1===n.indexOf("e");)n=n.substring(0,i-1),i--;return n},x.FormatResult=function(t){var n,e,t,i,r,o,r,n=(t=isNaN(t)?0:t)+"",e="";return t<0&&(e="-",n=n.substring(1,n.length)),t=n.length,i="",-1!==(r=n.indexOf("e"))&&(i=n.substring(r,t),t=(n=n.substring(0,r)).length),x.IsDotContained(n)&&16<t&&(o=0,n=1<parseFloat(n)?(o=x.GetDotPosition(n)-(t-16),n.toString().substring(0,17)):(o=x.GetDotPosition(n)-(t-17),n.toString().substring(0,18)),n=(0<o?d(parseFloat(n)*h(10,o))/h(10,o):d(parseFloat(n))).toString()),t=n.length,!x.IsDotContained(n)&&15<t&&(o=t-15,n=(d(parseFloat(n)/h(10,o))*h(10,o)).toString()),n=e+n+i,r=parseFloat(n),x.IsOverFlow(r.toString())?s().Calculator_OverFlowInfo:r},x.SingleMathOperation=function(t,n){var t,n,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===n){if(t<0)return s().Calculator_InvalidInputInfo;t=v(t)}if("POW"===n&&(t=h(t,2)),"1/x"===n){if(0===t)return s().Calculator_DivideByZeroInfo;n=x.GetDotPosition(t.toString()),t=h(10,n)/(h(10,n)*t)}return x.FormatResult(t)},x.DoubleMathOperation=function(t,n,e){var t,n,i,r,o,a,t=parseFloat(t),n=parseFloat(n);if(x.IsDotContained(t.toString())||x.IsDotContained(n.toString())){if(o=r=0,x.IsDotContained(t.toString())&&(r=x.GetDotPosition(t.toString())),x.IsDotContained(n.toString())&&(o=x.GetDotPosition(n.toString())),a=m(r,o),"+"===e&&(i=((t*=h(10,a))+(n*=h(10,a)))/h(10,a)),"-"===e&&(i=((t*=h(10,a))-(n*=h(10,a)))/h(10,a)),"*"===e&&(i=(t*=h(10,r))*(n*=h(10,o))/h(10,r+o)),"/"===e){if(t*=h(10,a),0===(n*=h(10,a)))return s().Calculator_DivideByZeroInfo;i=t/n}"%"===e&&(i=(t*=h(10,r))*(n*=h(10,o))/h(10,r+o+2))}else{if("+"===e&&(i=t+n),"-"===e&&(i=t-n),"*"===e&&(i=t*n),"/"===e){if(0===n)return s().Calculator_DivideByZeroInfo;i=t/n}"%"===e&&(i=t*n/100)}return x.FormatResult(i)},x.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},w=x,N.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},N.prototype.Click=function(t){var n,t,n=this;return 0<=t&&t<=11&&(n.OU&&(n.zU(t),n.OU=!1),n.VU(t),10!==t)&&(n.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(n.OU?(n.zU(t),n.OU=!1):(n.YU(t),n.RU="ClickMathButton")),24===t&&(n.OU&&(n.zU(t),n.OU=!1),n.ZU()),25!==t&&26!==t||(n.zU(t),n.OU=!1),n.OU?null:((t={}).outputText=n.WU(),b.IsErrorText(n.Y6)&&(n.OU=!0),t.result=void 0===n.Y6||null===n.Y6?"":n.Y6,t.x=n._x,t.y=n._y,t.operation=n.NU,t.token=n.kU,t.count=n.DU,t.memoryNumber=n._U,t.isBSCanUse=n.EU,t.isEqualClicked=n.jU,t.isOperationInvalid=n.OU,t.lastOperation=n.RU,t)},N.prototype.VU=function(t){var n=this;if(null!==n.Y6&&void 0!==n.Y6||(n.Y6=""),!(14<n.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||n.Y6+""!="0"&&""!==n.Y6)&&n.DU++,10!==t&&(n.EU=!0),n.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0"),"0"===n.Y6&&0!==t?n.Y6=""+t:"0"!==n.Y6&&(n.Y6=n.Y6+""+t)),10===t&&(-1===n.Y6.toString().indexOf("e")?""!==n.Y6&&"0"!==n.Y6&&(-1===n.Y6.toString().indexOf("-")?n.Y6="-"+n.Y6:n.Y6=n.Y6.toString().substring(1,n.Y6.toString().length)):0<+n.Y6?n.Y6="-"+n.Y6:n.Y6=n.Y6.substring(1,n.Y6.length)),11===t&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0."),""===n.Y6||w.IsDotContained(n.Y6)?""!==n.Y6&&w.IsDotContained(n.Y6)||(n.Y6="0."):n.Y6=n.Y6+"."),n.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0"),"0"===n.Y6&&0===t||("0"===n.Y6&&0!==t?n.Y6=""+t:n.Y6=n.Y6+""+t)),10===t&&(-1===n.Y6.toString().indexOf("e")?""!==n.Y6&&"0"!==n.Y6&&(-1===n.Y6.toString().indexOf("-")?n.Y6="-"+n.Y6:n.Y6=n.Y6.toString().substring(1,n.Y6.toString().length)):0<+n.Y6?n.Y6="-"+n.Y6:n.Y6=n.Y6.substring(1,n.Y6.length)),11===t&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU?n.Y6="0.":w.IsDotContained(n.Y6)||(""===n.Y6?n.Y6="0.":n.Y6=n.Y6+".")),n.jU||(n._y=n.Y6);break;case 2:0<=t&&t<=9&&(n.Y6="",n.Y6=n.Y6+t),11===t&&(n.Y6="0."),10===t&&(n.Y6="0"),n.kU=3,n._y=n.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==n.RU&&void 0!==n.RU&&null!==n.RU&&(n.Y6="0"),"0"===n.Y6&&0===t||("0"===n.Y6&&0!==t?n.Y6=""+t:n.Y6=n.Y6+""+t)),10===t&&(-1===n.Y6.toString().indexOf("e")?""!==n.Y6&&"0"!==n.Y6&&(-1===n.Y6.toString().indexOf("-")?n.Y6="-"+n.Y6:n.Y6=n.Y6.toString().substring(1,n.Y6.toString().length)):0<+n.Y6?n.Y6="-"+n.Y6:n.Y6=n.Y6.substring(1,n.Y6.length)),11===t&&("ClickNumericButton"!==n.RU&&null!==n.RU?n.Y6="0.":w.IsDotContained(n.Y6)||(""===n.Y6?n.Y6="0.":n.Y6=n.Y6+".")),n._y=n.Y6}},N.prototype.YU=function(t){var n=this;switch(n.DU=0,n.EU=!1,n.jU&&(n.jU=!1),n.Y6=w.FormatOutput(n.Y6),n.kU){case 0:""===n.Y6&&(n.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),b.IsErrorText(n.Y6)||(n._x=n.Y6),n.kU=1),12<=t&&t<=15&&(n.NU=t,n._x=n.Y6,n.kU=2),17===t&&n.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),b.IsErrorText(n.Y6)||(null!==n.NU&&void 0!==n.NU&&null!==n._y&&void 0!==n._y?n._y=n.Y6:n._x=n.Y6)),19===t&&(null!==n.NU&&void 0!==n.NU&&null!==n._y&&void 0!==n._y?(n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[n.NU]).toString(),b.IsErrorText(n.Y6)||(n._x=n.Y6)):"-0."===n.Y6&&(n.Y6="0."),n.jU=!0,n.EU=!1),12<=t&&t<=15&&(n.NU=t,n._x=n.Y6,n.kU=2),17===t&&(null!==n.NU&&void 0!==n.NU?(n._y=n.Y6,n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[17]).toString(),n._y=n.Y6):n.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),b.IsErrorText(n.Y6)||(n.kU=3,n._y=n.Y6)),19===t&&(n._y=n._x,n.Y6=w.DoubleMathOperation(n._x.toString(),n._x.toString(),n.BU[n.NU]).toString(),b.IsErrorText(n.Y6)||(n._x=n.Y6,n.kU=1,n.EU=!1),n.jU=!0),12<=t&&t<=15&&(n.NU=t,n._y=n.Y6),17===t&&(n.Y6=w.DoubleMathOperation(n._x.toString(),n._x.toString(),n.BU[17]),b.IsErrorText(n.Y6)||(n._y=n.Y6,n.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(n.Y6=w.SingleMathOperation(n.Y6,n.BU[t]).toString(),b.IsErrorText(n.Y6)||(n._y=n.Y6)),12<=t&&t<=15&&(n._y=n.Y6,n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[n.NU]).toString(),b.IsErrorText(n.Y6)||(n._x=n.Y6,n._y=null,n.NU=t,n.kU=2)),17===t&&(n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[17]),b.IsErrorText(n.Y6)||(n._y=n.Y6)),19===t&&(n._y=n.Y6,n.Y6=w.DoubleMathOperation(n._x.toString(),n._y.toString(),n.BU[n.NU]).toString(),b.IsErrorText(n.Y6)||(n._x=n.Y6,n.kU=1,n.EU=!1),n.jU=!0)}n.Y6+=""},N.prototype.ZU=function(){var t,n,e,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(n=0)<(e=t.Y6.length)&&(t.Y6=t.Y6.substring(0,e-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},N.prototype.zU=function(t){var n=this;n.DU=0,n.EU=!1,n.Y6="",25===t&&(1!==n.kU||null===n.NU||void 0===n.NU||n.jU||(n._y=0),2===n.kU)&&(n.kU=3),26===t&&n.HU()},N.prototype.WU=function(){var t,n,t=this,n="";return n=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},N.prototype.mf=function(t){var n=t.keyCode;switch(t.shiftKey&&(n|=65536),t.ctrlKey&&(n|=131072),t.altKey&&(n|=262144),n){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(p.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===n&&p.firefox||187===n&&!p.firefox?19:-1}},y=N,S=o.BaseDropdown,i(k,S),k.prototype.setValue=function(t){var n,t,n=this;t=n.QU(t);try{if(!n.q8(t))throw new Error(s().Calculator_InvalidInputInfo);t=""===t?"0":t,n.Y6=n.KU(t),n._text=n.JU(t),n._x=parseFloat(n.Y6),n._y=null,n.NU=null,n.kU=0,n.DU=n.XU(parseFloat(n.Y6)),0<n.DU?n.EU=!0:n.EU=!1,n.jU=!1,n.OU=!1,n.RU=null}catch(t){n._text=s().Calculator_InvalidInputInfo,n.Y6="",n._x=null,n._y=null,n.OU=!0}return n.qU(n.OU),n.UU(n._text),(t={}).outputText=n._text,t.result=n.Y6,t.x=n._x,t.y=n._y,t.operation=n.NU,t.token=n.kU,t.count=n.DU,t.memoryNumber=n._U,t.isBSCanUse=n.EU,t.isEqualClicked=n.jU,t.isOperationInvalid=n.OU,t.lastOperation=n.RU,n.$U=new y(n.Y6,n._x,n._y,n.NU,n.kU,n.DU,n._U,n.EU,n.jU,n.OU,n.RU),n},k.prototype.setOptions=function(){},k.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},k.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},k.prototype.FU=function(){var t=this;t.$U=new y(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},k.prototype.PU=function(){var t=this;t.qU(t.OU)},k.prototype.GU=function(){var e,i,r,t,n,e=this,i=this,r=i.Ti,t,n=function(t){!0!==i.mf(t)&&(t.preventDefault(),t.stopPropagation())};r.addEventListener("click",function(t){for(var n,t,t,n=t.srcElement||t.target;n&&!n.classList.contains("button");)n=n.parentElement;n&&(n.getAttribute("data-value")?(t=n.getAttribute("data-value"),t=k.eH(t),r.focus(),-1!==t&&i.iH(t)):n.classList.contains("okbtn")&&("ClickNumericButton"===i.RU&&i.iH(19),e.fire(o.BaseDropdown.Event_ValueChanged,{value:i._text,text:i._text})))}),r.addEventListener("keydown",n),r.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},k.prototype.UU=function(t){var n,e,n=this.Ti.querySelector(".gc-main-screen .gc-main"),e=n.value;null!=e&&e.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(n.value=t,this.tH(n))},k.prototype.tH=function(t){var n=this;if(null!==n.rH&&void 0!==n.rH||(n.rH=T(t)),n.oH(t))for(;n.oH(t);)n.aH(t);else n.uH(t)},k.prototype.oH=function(t){var n,e,i,n,r,o;return 1<t.scrollWidth-t.clientWidth||!(!u.mt.Tt.edge&&!u.mt.Tt.msie||t.clientWidth<=0)&&(e=(n=window.getComputedStyle(t)).fontWeight,i=n.fontSize,n=n.fontFamily,(o=u.q.Wt(t.value,r=e+" "+i+" "+n))+40>t.clientWidth)},k.prototype.aH=function(t){var n=T(t);t.style.fontSize="".concat(n-1,"px")},k.prototype.uH=function(t){for(var n,e,n=this,e=T(t);!n.oH(t)&&e<n.rH;)if(t.style.fontSize="".concat(++e,"px"),n.oH(t)){for(;n.oH(t);)n.aH(t);break}},k.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},k.prototype.sH=function(t,n){var e,i,r,o;if(0===n.length)return"";for(e="",r=i=0;i<n.length;i++){for(o=!1,r=0;r<t.length;r++)n.substring(i,i+1)===t.substring(r,r+1)&&(o=!0);!0===o&&(e+=n.substring(i,i+1))}return e},k.prototype.q8=function(t){var n;return this.sH("-.0123456789",t)===t&&(-1===(n=t.indexOf("-"))||0===n)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},k.prototype.KU=function(t){var t,n,t,e,i,r,o,t=parseFloat(t),n=t<0?!0:!1,t=l(t),e=f(t),i=w.GetDotPosition(t.toString()),r=(t*h(10,i)-e*h(10,i))/h(10,i);if(999999999999999<e)throw new Error(s().Calculator_InvalidInputInfo);return 999999999999999!==e?(o=0===e?15:15-e.toString().length,r=d(r*h(10,o))/h(10,o),i=w.GetDotPosition(r.toString()),t=(e*h(10,i)+r*h(10,i))/h(10,i),e=f(t),i=w.GetDotPosition(t.toString()),0===(r=(t*h(10,i)-e*h(10,i))/h(10,i))&&(t=e),n?"-"+t:""+t):0===r?e:void 0},k.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},k.prototype.XU=function(t){var t,n,e,t,i,r,t=l(t),n=f(t),e=w.GetDotPosition(t.toString()),t=(t*h(10,e)-n*h(10,e))/h(10,e),i,r;return(0===n?0:n.toString().length)+(0==t?0:e)},k.prototype.qU=function(t){for(var n=10;n<=18;n++)this.cH(n,t);this.cH(27,t)},k.prototype.cH=function(t,n){var t,t,t=g[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(n?t.classList.add("disabled"):t.classList.remove("disabled"))},k.eH=function(t){var n=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=parseInt(t,10);break;case"+/-":n=10;break;case".":n=11;break;case"+":n=12;break;case"-":n=13;break;case"*":n=14;break;case"/":n=15;break;case"sqrt":n=16;break;case"%":n=17;break;case"1/x":n=18;break;case"=":n=19;break;case"MC":n=20;break;case"MR":n=21;break;case"MS":n=22;break;case"M+":n=23;break;case"BS":n=24;break;case"CE":n=25;break;case"C":n=26;break;case"pow":n=27;break;default:n=-1}return n},k.prototype.iH=function(t){var n,t,n=this,t=n.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(n.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(n.nH=t.outputText,n._text=n.nH,n.UU(n.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==n.OU&&(n.OU=t.isOperationInvalid,n.qU(n.OU)),t.memoryNumber!==n._U&&(n._U=t.memoryNumber),t.lastOperation!==n.RU)&&(n.RU=t.lastOperation)},k.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},n.Calculator=k},"./dist/plugins/celltype/editor/calendar.js":function(F,t,n){"use strict";var e,L,B,o,i,a,u,n,m,i,s,P,c,G,U,H,V,z,Y,Z,W,Q,J,f,g,K,X,q,$,tt,nt,et,it,rt,p,b,l,h,ot,d,v,at,r,ut,st,w,y,ct,M,C,S,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,T,St,A,Tt,At,It,xt,I,Nt,x,N,kt,_t,Dt,jt,k,Ot,Et,Rt,Ft,Lt,Bt,Pt,Gt,n,Ut,Ht,Vt;function _(t){return P.createElement(t)}function zt(){}function Yt(){this.yearTds=[]}function Zt(){this.monthTds=[]}function Wt(){this.weekThs=[],this.dayTds=[]}function Qt(){this.calendarYearSection=new kt,this.calendarMonthSection=new _t,this.calendarDaySection=new Dt,this.timeItemLIs=[]}function D(){}function Jt(t,n,e,i){this.year=t,this.selected=!!n,this.disabled=!!e,this.focused=!!i}function Kt(t,n,e,i){this.month=t,this.selected=!!n,this.disabled=!!e,this.focused=!!i}function Xt(t,n,e,i){this.date=t,this.selected=!!n,this.disabled=!!e,this.focused=!!i}function j(t){this.owner=t,this.calendarPage=u.CalendarPage.month,this.oldSelectedData=null,this.S1e=null,this.T1e={start:k.getDefaultDate(),end:k.getDefaultDate()},this.selectedDate=new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,N.initResource()}function O(t){var n=Ut.call(this)||this;return n.fH=40,n.lH=100,n.hH=!1,n.jS=t,n}function E(t,n,e,i){var r=Ht.call(this,t)||this;return r.dH=7,r.HG=!0,e&&(r.parent=e,r.A1e=!0,r.HG=!1,r.N1e=i),r._data=new Ft(r),r.Dn=new Lt(r),r.Dn.on(o.BaseDropdown.Event_ValueChanged,function(t){var n,n,n=a.Common.CultureManager.getCultureInfo().DateTimeFormat,n=new a.Formatter.GeneralFormatter(n.defaultDatePattern).format(t.newValue);r.fire(o.BaseDropdown.Event_ValueChanged,{text:n,value:t.newValue})}),r.Dn.on(Lt.Event_GetHost,function(t){t.host=r.Ti}),r.A1e||(r.Ti.innerHTML=""),r.Ti.appendChild(r.Dn.createCalendarDom()),r.Dn.attachEvent(),r.A1e||r.setValue(new Date),r.Dn.showCalendarPage(u.CalendarPage.day),r.Dn.setCalendarActivePart(x.Date),n&&r.setOptions(n),r}function R(t,n){var t=Vt.call(this,t)||this;return t.D1e=0,t.S1e=null,t.T1e={start:k.getDefaultDate(),end:k.getDefaultDate()},t._1e(n),t.aY(),t}e=this&&this.__extends||(Gt=function(t,n){return(Gt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Gt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RangeCalendar=t.Calendar=void 0,L=n("./dist/plugins/celltype/editor/eventbase.js"),B=n("./dist/plugins/celltype/editor/timepicker.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),i=n("./dist/plugins/celltype/celltypes.ns.js"),a=n("Common"),u=n("Core"),n=new a.Common.ResourceManager(i.SR,"CellTypes"),m=n.getResource.bind(n),i=a.Common.lt,s=i.ht,P=document,c="gc-calendar-container",G="gc-date-ranges-calendar",U="gc-range-calendar-container",H="gc-date-range-container",V="gc-date-time-container",z="gc-date-part-container",Y="gc-time-part-container",Z="gc-ok-button-container",W="gc-date-container",Q="gc-week-container",J="gc-today-container",f="gc-content-container",g="gc-header-container",K="gc-header-title",X="gc-content-td-date",q="gc-content-td-time",$="gc-date-time-vertical-partline",tt="gc-date-time-horizontal-partline",nt="gc-year-page",et="gc-year-select-div",it="gc-month-page",rt="gc-day-page",p="gc-left-arrow",b="gc-right-arrow",l="gc-arrow-disable",h="gc-is-focused",ot="gc-cl-select",d="gc-cl-is-selected",v="gc-cl-disabled-text",at="gc-cl-select-container",r="gc-focus-part-indicator",ut="gc-cl-datepicker",st="gc-cl-dropdown",w="gc-cl-datepicker-filter",y="gc-cl-datepicker-filter-month",ct="gc-cl-grid-align-spread",M="gc-cl-align-middle",C="gc-cl-button-icon-container",S="gc-cl-datepicker-month",ft="gc-cl-day",lt="gc-cl-week",ht="gc-cl-show-inline-block",dt="gc-builtIn-date-Range-child-div",vt="gc-builtIn-date-ranges-div",mt="gc-date-ranges-result-div",gt="gc-date-ranges-result-button",pt="gc-builtIn-date-range-childDiv-select",bt="gc-date-ranges-result-buttonDiv",wt="gc-date-ranges-result-input",yt="gc-cl-p-bottom-x-small",Mt="gc-cl-shrink-none",Ct="gc-cl-grow",T="gc-cl-grid",St="gc-uiButton",A="gc-cl-button",Tt="gc-cl-button-brand",At="year-index",It="month-index",xt="week-index",I="day-index",Nt="dateRange-index",(n=x=x||{})[n.Date=1]="Date",n[n.Time=2]="Time",zt.initResource=function(){zt.resource={shortWeeks:[m().Calendar_ShortWeeks_1,m().Calendar_ShortWeeks_2,m().Calendar_ShortWeeks_3,m().Calendar_ShortWeeks_4,m().Calendar_ShortWeeks_5,m().Calendar_ShortWeeks_6,m().Calendar_ShortWeeks_7],shortMonths:[m().Calendar_ShortMonths_1,m().Calendar_ShortMonths_2,m().Calendar_ShortMonths_3,m().Calendar_ShortMonths_4,m().Calendar_ShortMonths_5,m().Calendar_ShortMonths_6,m().Calendar_ShortMonths_7,m().Calendar_ShortMonths_8,m().Calendar_ShortMonths_9,m().Calendar_ShortMonths_10,m().Calendar_ShortMonths_11,m().Calendar_ShortMonths_12],weeks:[m().Calendar_Weeks_7,m().Calendar_Weeks_1,m().Calendar_Weeks_2,m().Calendar_Weeks_3,m().Calendar_Weeks_4,m().Calendar_Weeks_5,m().Calendar_Weeks_6],months:[m().Calendar_Months_1,m().Calendar_Months_2,m().Calendar_Months_3,m().Calendar_Months_4,m().Calendar_Months_5,m().Calendar_Months_6,m().Calendar_Months_7,m().Calendar_Months_8,m().Calendar_Months_9,m().Calendar_Months_10,m().Calendar_Months_11,m().Calendar_Months_12],timePrefix:[m().Calendar_Time_AM,m().Calendar_Time_PM],eraNames:[m().Calendar_EraName_1,m().Calendar_EraName_2,m().Calendar_EraName_3,m().Calendar_EraName_4],earFirstYear:m().Calendar_FirstYear,today:m().Calendar_Today,lastMonth:m().Calendar_LastMonth,nextMonth:m().Calendar_NextMonth,lastYear:m().Calendar_LastYear,nextYear:m().Calendar_NextYear,lastTenYears:m().Calendar_LastTenYear,nextTenYears:m().Calendar_NextTenYear}},zt.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},N=zt,kt=Yt,_t=Zt,Dt=Wt,jt=Qt,D.dateEqual=function(t,n,e){if(!t&&!n)return!0;if(!t)return!1;if(!n)return!1;try{return e?t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()&&t.getHours()===n.getHours()&&t.getMinutes()===n.getMinutes()&&t.getSeconds()===n.getSeconds():t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()}catch(t){return!1}},D.getMonthMaxDay=function(t,n){return-1!==[1,3,5,7,8,10,12].indexOf(n)?31:-1!==[4,6,9,11].indexOf(n)?30:t%4==0&&t%100!=0?29:28},D.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},D.addMilliseconds=function(t,n){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+n),new Date(t.valueOf())},D.getEraDate=function(t){var n,e,i,n={era:-1,eraYear:-1};if(D.isValidEraDate(t))for(e=0;e<D.eraCount;e++)if(t<(i=e+1!==D.eraCount?D.eraDates[e+1]:D.addMilliseconds(D.eraMax,1))){n.era=e,n.eraYear=t.getFullYear()-D.eraDates[e].getFullYear()+1;break}return n},D.getEraYearString=function(t){var n,n,n=new Date(t,5,30),n=D.getEraDate(n);return-1===n.era||-1===n.eraYear?t.toString():t.toString()+"\u5e74"},D.getShortEraYearString=function(t){var t,t,n,t=new Date(t,11,31),t=D.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(n=1===t.eraYear?N.resource.earFirstYear:t.eraYear,N.resource.eraNames[t.era]+n+"\u5e74")},D.getDateLocaleLabel=function(t){var n,t,e,i,r,n=t.getHours(),t=t.getMinutes(),e,i,r;return(n<12?N.resource.timePrefix[0]:N.resource.timePrefix[1])+" "+(0===n||12===n?"12":(n%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},D.getBuiltInDateRanges=function(){var t,n,e,i,r,o,a,i,t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.setDate(t.getDate()-1),(e=new Date(t)).setDate(t.getDate()-6),i=t.getFullYear(),r=t.getMonth(),o=new Date(i,r,1),a=new Date(i,r-1,1),i=new Date(i,r+1,0),[[m().Calendar_BuiltIn_Today,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[m().Calendar_BuiltIn_Yesterday,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:n}],[m().Calendar_BuiltIn_Last7Days,{start:new Date(e.getFullYear(),e.getMonth(),e.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[m().Calendar_BuiltIn_ThisMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),i.getDate())}],[m().Calendar_BuiltIn_LastMonth,{start:new Date(a.getFullYear(),a.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),0)}]]},D.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},D.getNextMonth=function(t){var n,t,e,n=t.getFullYear(),t=t.getMonth()+1,e=new Date(n,t,1);return 12===t&&(e.setFullYear(n+1),e.setMonth(0)),e},D.getPreviousMonth=function(t){var n,t,e,n=t.getFullYear(),t=t.getMonth()-1,e=new Date(n,t,1);return-1==t&&(e.setFullYear(n-1),e.setMonth(11)),e},D.getFirstDayOfMonth=function(t){var n,t,n=t.getFullYear(),t=t.getMonth();return new Date(n,t,1)},D.getShortDate=function(t){var n,t;return s(t)?t:(n=t.start,t=t.end,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())})},D.eraCount=4,D.eraMax=new Date(2087,11,31,23,59,59),D.eraMin=new Date(1868,8,8),D.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),k=D,Jt.prototype.getLabel=function(){return this.year.toString()},Ot=Jt,Kt.prototype.getLabel=function(){return N.resource.shortMonths[this.month]},Et=Kt,Xt.prototype.getLabel=function(){return this.date.getDate().toString()},Rt=Xt,j.getMonthName=function(t){return N.resource.months[t]},j.getShortMonthName=function(t){return N.resource.shortMonths[t]},Object.defineProperty(j.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),j.prototype.updateDayFocusDate=function(){var t,n;this.owner.A1e?(t=this.T1e,1===this.owner.N1e?this.focusDate=k.getFirstDayOfMonth(t.start):2===this.owner.N1e&&(n=void 0,n=t.end.getFullYear()===t.start.getFullYear()&&t.end.getMonth()===t.start.getMonth()?k.getNextMonth(t.start):k.getFirstDayOfMonth(t.end),this.focusDate=n)):this.focusDate=new Date(this.selectedDate.valueOf())},j.prototype.updateDayItems=function(){var t,n,e,i,r,o,a,u,s,c,f;for(this.dayItems=[],t=this.focusDate.getFullYear(),n=this.focusDate.getMonth(),u=a=((o=(i=(e=new Date(t,n,1)).getDay())-(r=this.owner.dH))<0?7+o:o)%7;0<u;u--)(s=new Date(t,n,1)).setDate(s.getDate()-u),c=new Rt(s,!1,!0,!1),this.dayItems.push(c);for(u=1;u<=42-a;u++)s=new Date(t,n,u),c=new Rt(s),s.getMonth()!==n&&(c.disabled=!0),this.owner.A1e?(f=this.T1e,(k.dateEqual(s,f.start)||k.dateEqual(s,f.end))&&(c.selected=!0),s>f.start&&(s<f.end||this.E1e&&s<=this.E1e)&&!c.disabled&&(c.focused=!0)):(k.dateEqual(s,this.selectedDate)&&(c.selected=!0),k.dateEqual(s,this.focusDate)&&(c.focused=!0)),this.dayItems.push(c)},j.prototype.updateMonthItems=function(){var t,n,e,e,i;for(this.monthItems=[],t=0;t<12;t++)n=new Et(t),this.owner.A1e?(e=this.T1e,n.selected=e.start.getMonth()===t||e.end.getMonth()===t,n.focused=e.start.getMonth()<t&&e.end.getMonth()>t):(e=this.selectedDate,i=this.focusDate,n.selected=e&&e.getMonth()===t&&e.getFullYear()===i.getFullYear(),n.focused=i&&i.getMonth()===t),this.monthItems.push(n)},j.prototype.updateYearItems=function(){var t,n,e;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)n=new Ot(t),this.owner.A1e?(e=this.T1e,n.selected=e.start.getFullYear()===t||e.end.getFullYear()===t,n.focused=e.start.getFullYear()<t&&e.end.getFullYear()>t):(n.selected=this.selectedDate&&this.selectedDate.getFullYear()===t,n.focused=this.focusDate&&this.focusDate.getFullYear()===t,n.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd),this.yearItems.push(n)},j.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},j.prototype.getShortWeekName=function(t){var n,e,n,e;return N.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},j.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return j.getMonthName(t)},j.prototype.updateCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):this.RangeCalendar.notifyCalendarData({selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e})},Ft=j,Ut=L.EventBase,e(O,Ut),Object.defineProperty(O.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),O.prototype.createCalendarDom=function(){var t,n,e,i,r,i,t,t=this.jS;return this.mH=new jt,n=_("div"),this.jS.A1e?n.className=c+" "+H:n.classList.add(c),t.HG?n.classList.add(V):n.classList.add(W),e=_("table"),i=_("tr"),(r=_("td")).classList.add(X),t.HG&&r.classList.add(q),r.appendChild(this.gH()),i.appendChild(r),e.appendChild(i),n.appendChild(e),t.HG&&(i=_("tr"),t=_("td"),r.appendChild(this.pH()),r.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),i.appendChild(t),e.appendChild(i)),this.mH.outerContainerDiv=n},O.prototype.wH=function(){var t,n,t=_("div");return t.classList.add(Z),(n=_("button")).textContent=m().OK,n.className=A+" "+Tt+" "+St,t.appendChild(n),this.mH.okButton=n,t},O.prototype.pH=function(){var t=_("div");return t.classList.add($),t},O.prototype.yH=function(){var t=_("div");return t.classList.add(tt),t},O.prototype.gH=function(){var t=_("div");return t.className=z+" "+ut+" "+st,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},O.prototype.MH=function(){var t=_("div");return t.classList.add(nt),t.appendChild(this.TH()),t.appendChild(this.AH()),t},O.prototype.TH=function(){var t,n,e,i,r,r,o,a,a,t=_("div");return t.className=g+" "+w+" "+T,(n=_("div")).className=y+" "+T+" "+ct+" "+Ct,(e=_("div")).classList.add(M),(i=_("button")).className=A+" "+C,i.title=m().Calendar_LastTenYear,i.setAttribute("type","button"),(r=_("div")).classList.add(p),i.appendChild(r),(r=_("span")).classList.add(M),(o=_("button")).className=A+" "+C,o.title=m().Calendar_NextTenYear,o.setAttribute("type","button"),(a=_("div")).classList.add(b),o.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),(a=this.mH.calendarYearSection).headerDiv=t,a.lastYearRangeButton=i,a.focusDateYearRangeName=r,a.nextYearRangeButton=o,t.appendChild(n),t},O.prototype.AH=function(){var t,n,t=_("table");return t.className=f+" "+S,(n=_("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),n},O.prototype.IH=function(){for(var t,n,e,i,r,o,a,t=this.mH.calendarYearSection,n=_("tbody"),e=0;e<3;e++){for(i=_("tr"),r=0;r<4;r++)(o=_("td")).setAttribute(At,(4*e+r).toString()),(a=_("span")).classList.add(ft),a.setAttribute(At,(4*e+r).toString()),a.innerText=(4*e+r+1).toString(),o.appendChild(a),i.appendChild(o),t.yearTds.push(o);n.appendChild(i)}t.currentYearRangeTable.appendChild(n)},O.prototype.CH=function(){var t=_("div");return t.classList.add(it),t.appendChild(this.xH()),t.appendChild(this.NH()),t},O.prototype.xH=function(){var t,n,e,i,r,r,o,a,a,t=_("div");return t.className=g+" "+w+" "+T,(n=_("div")).className=y+" "+T+" "+ct+" "+Ct,(e=_("div")).classList.add(M),(i=_("button")).className=A+" "+C,i.title=m().Calendar_LastYear,i.setAttribute("type","button"),(r=_("div")).classList.add(p),i.appendChild(r),(r=_("span")).className=K+" "+M,(o=_("button")).className=A+" "+C,o.title=m().Calendar_NextYear,o.setAttribute("type","button"),(a=_("div")).classList.add(b),o.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),(a=this.mH.calendarMonthSection).headerDiv=t,a.lastYearButton=i,a.currentYearName=r,a.nextYearButton=o,t.appendChild(n),t},O.prototype.NH=function(){var t,n,t=_("table");return t.className=f+" "+S,(n=_("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),n},O.prototype.kH=function(){for(var t,n,e,i,r,o,a,t=this.mH.calendarMonthSection,n=_("tbody"),e=0;e<3;e++){for(i=_("tr"),r=0;r<4;r++)(o=_("td")).setAttribute(It,(4*e+r+1).toString()),(a=_("span")).classList.add(ft),a.setAttribute(It,(4*e+r+1).toString()),a.innerText=(4*e+r+1).toString(),o.appendChild(a),i.appendChild(o),t.monthTds.push(o);n.appendChild(i)}t.currentYearTable.appendChild(n)},O.prototype.SH=function(){var t=_("div");return t.classList.add(rt),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.A1e||t.appendChild(this.OH()),t},O.prototype._H=function(){var t,n,e,i,r,r,o,a,a,u,s,c,f,l,h,d,v,c,t=_("div");for(t.className=g+" "+w+" "+T,(n=_("div")).className=y+" "+T+" "+ct+" "+Ct,(e=_("div")).classList.add(M),(i=_("button")).className=A+" "+C,i.title=m().Calendar_LastMonth,i.setAttribute("type","button"),(r=_("div")).classList.add(p),i.appendChild(r),(r=_("span")).className=K+" "+M,(o=_("button")).className=A+" "+C,o.title=m().Calendar_NextMonth,o.setAttribute("type","button"),(a=_("div")).classList.add(b),o.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),(a=_("div")).className=et+" "+Mt,(u=_("div")).classList.add(at),(s=_("select")).classList.add(ot),f=(c=new Date).getFullYear()-this.lH,l=c.getFullYear()+this.fH,h=f;h<=l;h++)(d=_("option")).text=h.toString(),d.value=h.toString(),s.options.add(d);return(v=_("div")).classList.add(at),u.appendChild(s),a.appendChild(u),t.appendChild(a),t.appendChild(n),(c=this.mH.calendarDaySection).headerDiv=t,c.lastMonthButton=i,c.currentMonthName=r,c.nextMonthButton=o,c.yearSelect=s,t},O.prototype.EH=function(){var t,n,e,i,r,o,a,t=_("div");for(t.className=Q+" "+w+" "+T,(n=_("table")).className=f+" "+S,e=_("thead"),i=_("tr"),r=0;r<7;r++)(o=_("th")).setAttribute(xt,r.toString()),(a=_("span")).classList.add(lt),a.setAttribute(xt,r.toString()),a.innerText=this.jS._data.getShortWeekName(r),o.appendChild(a),i.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return e.appendChild(i),n.appendChild(e),t.appendChild(n),t},O.prototype.jH=function(){var t,n,e,i,r,o,a,u,s,c,t=this.mH.calendarDaySection,n=_("div"),e=_("div"),i=_("table");for(i.className=f+" "+S,r=_("tbody"),o=0;o<6;o++){for(a=_("tr"),u=0;u<7;u++)(s=_("td")).setAttribute(I,(7*o+u).toString()),(c=_("span")).classList.add(ft),c.setAttribute(I,(7*o+u).toString()),s.appendChild(c),a.appendChild(s),t.dayTds.push(s);r.appendChild(a)}return i.appendChild(r),e.appendChild(i),n.appendChild(e),t.dayContentTable=i,n},O.prototype.OH=function(){var t,n,e,i,r,o,t=_("div");return t.classList.add(J),(n=_("table")).classList.add(f),e=_("tbody"),i=_("tr"),r=_("td"),(o=_("i")).className=ht+" "+yt,o.innerText=N.resource.today,r.appendChild(o),i.appendChild(r),e.appendChild(i),n.appendChild(e),t.appendChild(n),this.mH.calendarDaySection.todayTd=r,this.mH.calendarDaySection.todayTable=n,t},O.prototype.bH=function(){var n,t,n=this,t=_("div");return t.className=Y+" "+ut+" "+st,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new B.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(o.BaseDropdown.Event_ValueChanged,function(t){n.BH(t)}),t},O.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},O.prototype.LH=function(){switch(this.jS._data.calendarPage){case u.CalendarPage.year:this.PH();break;case u.CalendarPage.month:this.GH();break;case u.CalendarPage.day:this.UH()}},O.prototype.HH=function(){var t,n,e,i,r,o,t,a,u,a,t,n,s,c,f,t=this.jS._data,n=this.mH.calendarDaySection,e=!1;for(n.currentMonthName.innerText=t.getCurrentMonthName(),i=t.focusDate.getFullYear(),r=n.yearSelect,o=0;o<r.options.length;o++)if(i.toString()===r.options[o].value){r.selectedIndex=o,e=!0;break}if(t=this.fH+this.lH+1,e?r.options[t]&&r.selectedIndex<=t-1&&r.options[t].remove():((a=_("option")).text=i.toString(),a.value=i.toString(),r.options[t]=a,r.selectedIndex=t),this.jS.A1e&&(u=this.jS.parent).R1e&&u.B1e)if(a=n.lastMonthButton,t=n.nextMonthButton,n=this.jS.N1e,s=u.R1e._data.focusDate,c=u.B1e._data.focusDate,1===n){for(o=0;o<r.options.length;o++)(f=parseInt(r.options[o].value,10))>c.getFullYear()?r.options[o].disabled=!0:r.options[o].disabled=!1;s.getFullYear()===c.getFullYear()&&s.getMonth()>=c.getMonth()-1?(t.disabled=!0,t.classList.add(l)):(t.disabled=!1,t.classList.remove(l))}else if(2===n){for(o=0;o<r.options.length;o++)(f=parseInt(r.options[o].value,10))<s.getFullYear()?r.options[o].disabled=!0:r.options[o].disabled=!1;s.getFullYear()===c.getFullYear()&&c.getMonth()<=s.getMonth()+1?(a.disabled=!0,a.classList.add(l)):(a.disabled=!1,a.classList.remove(l))}},O.prototype.PH=function(){var t,n,e,i,r,o,a,u,a,s,t=this.jS._data,n=this.mH.calendarYearSection;if(t.updateYearItems(),n.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),e=n.yearTds,0!==(i=t.yearItems).length)for(r=0;r<3;r++)for(o=0;o<4;o++)u=i[a=4*r+o],(s=(a=e[a]).querySelector("span")).innerText=u.getLabel(),u.disabled?a.classList.add(v):a.classList.remove(v),u.selected?a.classList.add(d):a.classList.remove(d),u.focused?s.classList.add(h):s.classList.remove(h)},O.prototype.GH=function(){var t,n,e,i,r,o,a,u,s,u,c,t=this.jS._data,n=this.mH.calendarMonthSection;for(t.updateMonthItems(),e=t.focusDate.getFullYear(),i=t.monthItems,r=n.monthTds,n.currentYearName.innerText=e.toString(),o=0;o<3;o++)for(a=0;a<4;a++)s=i[u=4*o+a],(c=(u=r[u]).querySelector("span")).innerText=s.getLabel(),s.selected?u.classList.add(d):u.classList.remove(d),s.focused?c.classList.add(h):c.classList.remove(h)},O.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(O.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),O.prototype.zH=function(){var t,n,e,i,r,o,a,o,u,t=this.jS._data;if(t.updateDayItems(),0!==(n=t.dayItems).length)for(e=this.mH.calendarDaySection.dayTds,i=0;i<6;i++)for(r=0;r<7;r++)a=n[o=7*i+r],(u=(o=e[o]).querySelector("span")).innerText=a.getLabel(),a.disabled?o.classList.add(v):o.classList.remove(v),a.focused?u.classList.add(h):u.classList.remove(h),a.selected?o.classList.add(d):o.classList.remove(d)},O.prototype.FH=function(){this.RH.setValue(this.jS._data.selectedDate)},O.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},O.prototype.VH=function(){var n=this;this.mH.outerContainerDiv.addEventListener("keydown",function(t){n.YH(t)})},O.prototype.YH=function(t){9===t.keyCode?(this.jS.HG&&(this.jS._data.calendarActivePart===x.Date?this.setCalendarActivePart(x.Time):this.setCalendarActivePart(x.Date)),t.preventDefault()):this.jS._data.calendarActivePart!==x.Date||this.jS.A1e||this.ZH(t)},O.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case u.CalendarPage.year:this.WH(t);break;case u.CalendarPage.month:this.QH(t);break;case u.CalendarPage.day:this.KH(t)}},O.prototype.WH=function(t){var n,e,n=this.jS._data,e=n.focusDate;switch(t.keyCode){case 13:n.selectedDate=new Date(e.valueOf()),this.showCalendarPage(u.CalendarPage.month);break;case 32:n.selectedDate=new Date(e.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:e.setFullYear(n.focusDateYearRangeStart);break;case 35:e.setFullYear(n.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}n.updateYearRange(),this.LH()},O.prototype.QH=function(t){var n,e,n=this.jS._data,e=n.focusDate;switch(t.keyCode){case 13:n.selectedDate=new Date(e.valueOf()),this.showCalendarPage(u.CalendarPage.day);break;case 32:n.selectedDate=new Date(e.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:e.setMonth(0);break;case 35:e.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},O.prototype.KH=function(t){var n,e,i,r,o,a,n=this.jS._data,e=n.focusDate,i=e.getFullYear(),r=e.getMonth(),o=e.getDate(),a=k.getMonthMaxDay(i,r+1);switch(t.keyCode){case 13:return n.selectedDate=new Date(e.valueOf()),void this.oz();case 32:n.selectedDate=new Date(e.valueOf());break;case 37:e.setDate(o-1);break;case 39:e.setDate(o+1);break;case 38:e.setDate(o-7);break;case 40:e.setDate(o+7);break;case 36:e.setDate(1);break;case 35:e.setDate(a);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}n.selectedDate=new Date(e.valueOf()),this.LH()},O.prototype.attachDateEvent=function(){var n=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===n.mH.calendarDaySection.yearSelect||t.parentElement===n.mH.calendarDaySection.yearSelect)||n.setCalendarActivePart(x.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},O.prototype.attachYearEvent=function(){var n=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){n.$H(),n.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){n.tz(),n.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){n.az(t)})},O.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},O.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},O.prototype.qH=function(){this.showCalendarPage(u.CalendarPage.month)},O.prototype.az=function(t){var t,t,n,n,t=t.srcElement||t.target;t&&(t=+t.getAttribute(At),0!==(n=this.jS._data.yearItems).length)&&(n=n[t],this.jS._data.focusDate.setFullYear(n.year),this.qH())},O.prototype.attachMonthEvent=function(){var n=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){n.JH(),n.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){n.XH(),n.LH()}),this.jS.A1e||this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){n.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){n.uz(t)})},O.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},O.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},O.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(u.CalendarPage.year)},O.prototype.rz=function(){this.showCalendarPage(u.CalendarPage.day)},O.prototype.uz=function(t){var t,t,t=t.srcElement||t.target;t&&(t=+t.getAttribute(It),this.jS._data.focusDate.setMonth(t-1),this.rz())},O.prototype.attachDayEvent=function(){var n,t,n=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){n.nz(),n.hH||(n.jS.A1e?(n.RangeCalendar.checkFocusDateValid(),n.RangeCalendar.updateRangeCalendarDom()):n.LH())}),t.nextMonthButton.addEventListener("click",function(t){n.ez(),n.hH||(n.jS.A1e?(n.RangeCalendar.checkFocusDateValid(),n.RangeCalendar.updateRangeCalendarDom()):n.LH())}),t.todayTable&&t.todayTable.addEventListener("click",function(t){n.fz()}),this.jS.A1e?t.dayContentTable.addEventListener("mouseover",function(t){n.j1e(t)}):t.currentMonthName.addEventListener("click",function(t){n.cz()}),t.dayContentTable.addEventListener("click",function(t){n.jS.A1e?n.O1e(t):n.lz(t)}),t.yearSelect.addEventListener("change",function(t){n.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},O.prototype.nz=function(t){var n,t,e,t,i,r,e,n=this.jS._data,t=t||1,e=n.focusDate.getFullYear(),t=n.focusDate.getMonth()-t,i=n.focusDate.getDate();t<0&&(t+=12,--e),r=k.getMonthMaxDay(e,t+1),e=new Date(e,t,Math.min(i,r)),n.focusDate=e},O.prototype.ez=function(t){var n,t,e,t,i,r,e,n=this.jS._data,t=t||1,e=n.focusDate.getFullYear(),t=n.focusDate.getMonth()+t,i=n.focusDate.getDate();11<t&&(t-=12,e+=1),r=k.getMonthMaxDay(e,t+1),e=new Date(e,t,Math.min(i,r),n.focusDate.getHours(),n.focusDate.getMinutes(),n.focusDate.getSeconds()),n.focusDate=e},O.prototype.cz=function(){this.showCalendarPage(u.CalendarPage.month)},O.prototype.lz=function(t){var n,t,t,e,i,e,t,t,n=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(I),s(t))return;if(0===(e=n.dayItems).length)return;e=(i=e[+t]).date,t=(t=n.selectedDate)?new Date(t.valueOf()):new Date,n.selectedDate=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n.focusDate=new Date(n.selectedDate.valueOf()),this.LH(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},O.prototype.O1e=function(t){var n,t,t,e,e,t,e,i,r,r,i,r,n,e,n=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(I),s(t)||0!==(e=n.dayItems).length&&(t=(e=e[+t]).date,e=e.disabled,r=(i=n.T1e)?new Date(i.start.valueOf()):k.getDefaultDate(),0===this.RangeCalendar.D1e?(i.start=new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.end=i.start,this.RangeCalendar.D1e++):1===this.RangeCalendar.D1e&&(r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.start<=r?(i.end=r,this.RangeCalendar.D1e=0):(i.end=i.start=r,this.RangeCalendar.D1e=1)),n.updateCalendarData(),e&&(i=this.jS._data.focusDate,r=this.jS.parent,n=k.getFirstDayOfMonth(t),1===this.jS.N1e?i<t?r.B1e._data.focusDate=n:t<this.jS._data.focusDate&&(this.jS._data.focusDate=n):2===this.jS.N1e&&(e=r.R1e,i<t?(e._data.focusDate=k.getPreviousMonth(t),this.jS._data.focusDate=n):t<this.jS._data.focusDate&&(e._data.focusDate=n))),this.RangeCalendar.updateRangeCalendarDom()))},O.prototype.j1e=function(t){var n,t,t,e,i,e,t,r,e,n=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(I),s(t)||0!==(e=n.dayItems).length&&(e=(i=e[+t]).date,t=n.T1e,n.E1e=null,t.start&&1===this.RangeCalendar.D1e&&(r=t?new Date(t.start.valueOf()):k.getDefaultDate(),(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()))>t.start)&&(n.E1e=e),n.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()))},O.prototype.fz=function(){var t,n,n,e,t=this.jS,n=t._data.selectedDate,n=n?new Date(n.valueOf()):null,e=new Date;n&&(e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(0)),t._data.selectedDate=e,t._data.focusDate=new Date(e.valueOf()),this.LH(),t.HG||this.oz()},O.prototype.hz=function(t){var t=t.srcElement||t.target;t&&(this.jS._data.focusDate.setFullYear(+t.value),this.jS.A1e?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},O.prototype.attachTimeEvent=function(){var n=this;this.mH.timeContainerDiv.addEventListener("click",function(t){n.setCalendarActivePart(x.Time)}),this.mH.okButton.addEventListener("click",function(t){n.oz()})},O.prototype.BH=function(t){var n,e,t,n=this.jS._data,e=n.selectedDate?new Date(n.selectedDate.valueOf()):new Date,t=t.value;e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),n.selectedDate=e,n.focusDate=new Date(e.valueOf())},O.prototype.oz=function(){var t=this.jS._data;this.fire(o.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},O.prototype.showCalendarPage=function(t){var n,e,i,n=this.host.querySelector("."+nt),e=this.host.querySelector("."+it),i=this.host.querySelector("."+rt);switch(n.style.display="none",e.style.display="none",i.style.display="none",t){case u.CalendarPage.year:n.style.display="";break;case u.CalendarPage.month:e.style.display="";break;case u.CalendarPage.day:i.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},O.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(r),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(r),t){case x.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(r),this.mH.outerContainerDiv.focus();break;case x.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(r),this.mH.outerContainerDiv.focus()}},O.Event_GetHost="GetHost",Lt=O,Ht=o.BaseDropdown,e(E,Ht),E.prototype.setOptions=function(t){var n,t;t&&(t.showTime||this.A1e||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),n=t&&t.calendarPage?t.calendarPage:u.CalendarPage.day,(t=t&&t.startDay?t.startDay:u.CalendarStartDay.saturday)!==this.dH&&(this.dH=t,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(n),this.Dn.setCalendarActivePart(x.Date))},E.prototype.setValue=function(t){var n=this._data;if(t){if(this.A1e&&t instanceof Object){if(!t.start||!t.end)return;n.S1e={start:t.start,end:t.end},n.T1e={start:t.start,end:t.end},n.updateCalendarData()}else t instanceof Date&&(n.selectedDate=t,n.oldSelectedData=new Date(t.valueOf()),n.focusDate=new Date(t.valueOf()),n.updateYearRange());n.updateDayFocusDate()}},E.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},Bt=E,t.Calendar=Bt,Vt=o.BaseDropdown,e(R,Vt),R.prototype.setOptions=function(t){s(t.showBuiltInDateRange)&&(t.showBuiltInDateRange=!0),t.showTime=!1,t.calendarPage=u.CalendarPage.day,this.R1e.setOptions(t),this.B1e.setOptions(t)},R.prototype.setValue=function(t){this.R1e.setValue(t),this.B1e.setValue(t),this.updateRangeCalendarDom()},R.prototype.updateRangeCalendarDom=function(){this.R1e.Dn.updateCalendarDom(),this.B1e.Dn.updateCalendarDom(),this.updateDataRangeResult(this.T1e)},R.prototype.L1e=function(){var t,i,t=k.getBuiltInDateRanges(),i=_("div");return i.className=c+" "+vt,t.forEach(function(t,n){var e,n,e=_("div");e.className=dt,e.setAttribute(Nt,n+""),n=P.createTextNode(t[0]),e.appendChild(n),i.appendChild(e)}),this.P1e=i},R.prototype._1e=function(t){var n,e,e;this.Ti.innerHTML="",(n=_("div")).className=c+" "+U,t&&!1===t.showBuiltInDateRange||n.appendChild(this.L1e()),(e=_("div")).classList.add(G),this.R1e=new Bt(e,t,this,1),n.appendChild(e),(e=_("div")).classList.add(G),this.B1e=new Bt(e,t,this,2),n.appendChild(e),this.Ti.appendChild(n),this.Ti.appendChild(this.G1e())},R.prototype.aY=function(){var n=this;this.P1e&&this.P1e.addEventListener("click",function(t){n.U1e(t)}),this.H1e.addEventListener("click",function(t){n.onOkButtonClick(t)}),this.z1e.addEventListener("click",function(t){n.onCancelButtonClick(t)}),this.on(Lt.Event_GetHost,function(t){t.host=n.Ti})},R.prototype.G1e=function(){var t,n,n,e,n,e,t=_("div");return t.className=mt,(n=_("div")).classList.add(wt),t.appendChild(n),this.V1e=n,this.updateDataRangeResult(this.T1e),(n=_("div")).className=bt,(e=_("button")).textContent=m().Cancel,e.className=gt,n.appendChild(e),t.appendChild(n),this.z1e=e,(n=_("div")).className=bt,(e=_("button")).textContent=m().OK,e.className=gt,n.appendChild(e),t.appendChild(n),this.H1e=e,t},R.prototype.U1e=function(t){var t,t,n,t,t=t.srcElement||t.target;t&&(t=t.getAttribute(Nt),s(t)||(t=(n=k.getBuiltInDateRanges())[t],this.T1e={start:t[1].start,end:t[1].end},this.notifyCalendarData(),this.fire(o.BaseDropdown.Event_ValueChanged,{text:k.getShortDate(this.T1e)})))},R.prototype.updateDataRangeResult=function(t){var n,e,i,r,r;if(t&&t.start instanceof Date&&t.end instanceof Date&&(this.V1e.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.P1e)for(n=k.getBuiltInDateRanges(),e=0;e<this.P1e.children.length;e++)i=this.P1e.children[e],r=parseInt(i.getAttribute(Nt),10),i.className=dt,r=n[r]&&n[r][1],k.dateEqual(r.start,t.start)&&k.dateEqual(r.end,t.end)&&(i.className=dt+" "+pt)},R.prototype.onOkButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:k.getShortDate(this.T1e)})},R.prototype.onCancelButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:k.getShortDate(this.S1e)})},R.prototype.checkFocusDateValid=function(){var t,n,t,t=this.R1e._data.focusDate,n;this.B1e._data.focusDate<=t&&(t=k.getNextMonth(t),this.B1e._data.focusDate=t)},R.prototype.notifyCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):t={selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e},this.R1e&&this.R1e._data.updateCalendarData(t),this.B1e&&this.B1e._data.updateCalendarData(t)},t.RangeCalendar=R},"./dist/plugins/celltype/editor/colorpicker.js":function(t,n,e){"use strict";var i,r,o,a,u,e,s,f,e,c,l,h,d;function v(t,n){var t=d.call(this,t)||this;return t.Hc(),t.setOptions(n),t}i=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColorPicker=void 0,r=e("./dist/plugins/celltype/editor/listControl.js"),o=e("Core"),a=e("./dist/plugins/celltype/editor/baseControl.js"),u=e("./dist/plugins/celltype/celltypes.ns.js"),e=e("Common"),s=e.Common.lt.ht,f="group-name",e=new e.Common.ResourceManager(u.SR,"CellTypes"),c=e.getResource.bind(e),d=a.BaseDropdown,i(v,d),v.prototype.setOptions=function(t){var n;t&&(this.options=this.options||{},s(t.colorBlockSize)||(n=parseInt(t.colorBlockSize,10),!isNaN(n)&&0<=n&&(this.options.colorBlockSize=t.colorBlockSize)),s(t.groups)||(this.options.groups=t.groups)),this._6()},v.prototype.setValue=function(t){s(t)||(this.vz=t,this.mz=null,this._6())},v.prototype.Hc=function(){for(var n,t,e,i,n=this,t=v.DefaultColorGroup(),e=[],i=0;i<t.length;i++)e.push({name:t[i].name,colors:t[i].colors,needScaleColor:t[i].needScaleColor});this.options={colorBlockSize:v.DefaultCellWidth,groups:e},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){n.pz(t)}),this.Ti.appendChild(this.gz)},v.prototype._6=function(){this.gz.innerHTML="",new r.List(this.gz,this.bz()),this.yz()},v.prototype.yz=function(){var t,n,e,i,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(n=0;n<t.length;n++)t[n].classList.remove("selected"),e=t[n].getAttribute("color"),i=t[n].getAttribute(f),this.vz===e&&(!this.mz||this.mz&&this.mz===i)&&t[n].classList.add("selected")},v.prototype.wz=function(){for(var t,n,e,i,r,o,t=0,n=this.options.groups,e=0;e<n.length;e++)for(i=n[e],r=0;r<i.colors.length;r++)o=i.colors[r],t=Math.max(t,o.length);return t},v.prototype.bz=function(){for(var t,n,e,i,r,o,o,t=[],n=this.options.colorBlockSize||v.DefaultCellWidth,e=this.wz(),i=this.options.groups,r=0;r<i.length;r++)o=this.Mz(i[r],n,e),t.push(o),i[r].needScaleColor&&(o=this.Cz(i[r].colors[0]),t.push(this.Mz(o,n,e)));return{items:t}},v.prototype.Cz=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n={},e=[],r=[-(i=e.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],a=[80,60,40,-25,-50],u=document.createElement("span"),s=t.length;u.style.display="none",document.body.appendChild(u);try{for(c=0;c<s;c++)for(l=(f=this.Sz(t[c],u))[0],h=f[1],d=f[2],v=this.Tz(l,h,d),m=0;m<5;m++)e[m]||((g=[]).length=s,e[m]=g),e[m][c]=1===v?this.Az(l,h,d,r[m]):.8<=v?this.Az(l,h,d,o[m]):0===v?this.Az(l,h,d,Math.abs(r[5-m-1])):v<=.2?this.Az(l,h,d,Math.abs(o[5-m-1])):this.Az(l,h,d,a[m]);n.colors=e}finally{document.body.removeChild(u)}return n},v.prototype.Sz=function(t,n){var e,i,r,o,t;return n.style.color=t,t=(o=window.getComputedStyle(n).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[e=parseInt(t[0],10),i=parseInt(t[1],10),r=parseInt(t[2],10)]},v.prototype.Az=function(t,n,e,i){var t,n,e;return i/=100,t=this.Iz(t,n,e),n=parseInt((0<i?(240-t.luminosity)*i:t.luminosity*i).toString(),10),e=this.xz(t.hue,t.luminosity+n,t.saturation),this.Nz(e.r,e.g,e.b)},v.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},v.prototype.Nz=function(t,n,e){return"#"+this.kz(t)+this.kz(n)+this.kz(e)},v.prototype.xz=function(t,n,e){var i,r,o,a,u;return 0===e?i=r=o=parseInt((255*n/240).toString(),10):(u=a=void 0,a=2*n-(u=n<=120?(n*(240+e)+120)/240:n+e-(n*e+120)/240),i=parseInt(((255*this.Dz(a,u,t+80)+120)/240).toString(),10),r=parseInt(((255*this.Dz(a,u,t)+120)/240).toString(),10),o=parseInt(((255*this.Dz(a,u,t-80)+120)/240).toString(),10)),{a:255,r:i,g:r,b:o}},v.prototype.Dz=function(t,n,e){return e<0&&(e+=240),240<e&&(e-=240),e<40?t+((n-t)*e+20)/40:e<120?n:e<160?t+((n-t)*(160-e)+20)/40:t},v.prototype.Tz=function(t,n,e){var i;return this.Iz(t,n,e).luminosity/240},v.prototype.Iz=function(t,n,e){var i,r,o,a,u,s,u,s,c,e,a=Math.max(Math.max(t,n),e),u=Math.min(Math.min(t,n),e),s=a+u,i=parseInt(((240*s+255)/510).toString(),10),u=a-u;return 0==u?(r=0,o=160):(r=i<=120?parseInt(((240*u+s/2)/s).toString(),10):parseInt(((240*u+(510-s)/2)/(510-s)).toString(),10),s=(40*(a-t)+u/2)/u,c=(40*(a-n)+u/2)/u,e=(40*(a-e)+u/2)/u,(o=t===a?parseInt((e-c).toString(),10):n===a?parseInt((80+s-e).toString(),10):parseInt((160+c-s).toString(),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:i,saturation:r,hue:o}},v.prototype.Mz=function(a,u,s){var c,t,c=this,t={items:function(){var t,n,e,i,r,o,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(u+7)*s+"px",n=0;n<a.colors.length;n++){for((e=document.createElement("div")).classList.add("gc-color-picker-color-row"),i=a.colors[n],r=0;r<i.length;r++)(o=document.createElement("div")).setAttribute(f,a.name),o.setAttribute("color",i[r]),o.style.backgroundColor=i[r],o.style.width=u+"px",o.style.height=u+"px",o.classList.add("gc-color-picker-color-cell"),c.vz===i[r]&&c.mz===a.name&&o.classList.add("selected"),e.appendChild(o);t.appendChild(e)}return t},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return a.name&&(t.text=a.name),t},v.prototype.pz=function(t){var t,n,t,t=t.srcElement||t.target;t&&(n=t.getAttribute("color"),t=t.getAttribute(f),n)&&t&&(this.vz=n,this.mz=t,this._z(n),this.yz())},v.prototype._z=function(t){this.fire(a.BaseDropdown.Event_ValueChanged,{value:t,text:t})},v.DefaultCellWidth=10,v.DefaultColorGroup=function(){return[{name:c().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:c().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},n.ColorPicker=v},"./dist/plugins/celltype/editor/eventbase.js":function(t,n){"use strict";var e;function i(){this.Ez={}}Object.defineProperty(n,"__esModule",{value:!0}),n.EventBase=void 0,i.prototype.on=function(t,n){var e=this.Ez[t];(e=null==e?this.Ez[t]=[]:e).push(n)},i.prototype.off=function(t,n){var e,n;t?null!=(e=this.Ez[t])&&(n?(n=e.indexOf(n),e.splice(n,1)):e=[],this.Ez[t]=e):this.Ez={}},i.prototype.fire=function(t,n){var e,t,e=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(e,n)}catch(t){}})},n.EventBase=i},"./dist/plugins/celltype/editor/listControl.js":function(F,t,n){"use strict";var e,u,s,o,l,h,a,i,r,c,f,d,v,m,g,p,b,w,y,M,C,S,T,A,L,I,x,B,P,N,G,U,k,H,_,D;function j(t){return i.createElement(t)}function V(t,n){return t.substring(0,n)+t.substring(n+1,t.length)}function z(t,n){if(o.Common.Uf.OS(t,n))return 1;if(o.Common.ct.W0(n))for(var e=0;e<t.length;e++)if(t[e]-n==0)return 1}function Y(t,n){for(var e,i,e=o.Common.ct.W0(n),i=t.length-1;0<=i;i--)(t[i]===n||e&&t[i]-n==0)&&t.splice(i,1)}function Z(t){var n,e,i,r,o;if(h(t)||0===t.length)return[];for(n=[],i=e=0;i<t.length;i++)"\\"===(r=t.charAt(i))?","!==(o=t.charAt(i+1))&&"\\"!==o||(t=V(t,i)):","===r&&(n.push(t.substring(e,i)),e=i+1);return n.push(t.substring(e,t.length)),n}function W(t){for(var n,e,i,n=[],e=0;e<t.length;e++)(i=t[e])&&"string"==typeof i&&(i=i.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),n[e]=i;return n.join(",")}function O(){this.jz=new WeakMap}function E(t,n,e){var i=D.call(this,t)||this;return i.Ti=j("div"),i.Ti.classList.add(c),t.appendChild(i.Ti),i.cE=new r,i.Oz=e&&e.Oz||{y4:void 0},i.Rz={items:[],doms:[]},i.setOptions(n),i}function R(t){if(t.hasOwnProperty("items"))R(t.items);else if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n].hasOwnProperty("items")?R(t[n]):t[n].hasOwnProperty("text")&&!t[n].hasOwnProperty("value")&&(t[n].value=t[n].text);return t}e=this&&this.__extends||(_=function(t,n){return(_=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}_(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,u=n("./dist/plugins/celltype/editor/popupControl.js"),s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),l=n("Core"),h=o.Common.lt.ht,a=o.Common.Uf.hD,i=document,O.prototype.set=function(t,n,e){var i=this.jz.get(t);i||this.jz.set(t,i={}),i[n]=e},O.prototype.get=function(t,n){var t=this.jz.get(t);return t&&t[n]},O.prototype.clear=function(){this.jz=new WeakMap},r=O,c="gc-list-control",f="gc-list-control-container",d="gc-list-control-group",v="gc-list-control-group-text",m="gc-list-control-item",g="gc-list-control-hassubitem",p="gc-list-control-selected-item",b="gc-list-control-item-text",w="gc-list-control-item-text-ellipsis",y="gc-list-control-item-ellipsis",M="gc-list-control-item-icon",C="gc-list-control-emptyicon",S="gc-list-control-subitem",T="gc-list-alignment-horizontal",A="gc-list-alignment-vertical",L="gc-list-control-item-wrap",I="gc-list-control-noitem",x="gc-list-control-listseparator",B="gc-list-control-item-bigicon",P="gc-list-control-item-bigtext",N="hide-children",G="gc-list-control-tree",U="gc-list-control-tree-text",k="gc-list-control-tree-content",D=s.BaseDropdown,e(E,D),E.prototype.setOptions=function(t){h(t)||(this.MU=R(t),this.Ti.innerHTML="",this.Dn())},E.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=Z(t);else if(h(t))t=[];else if(o.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var n=0;n<t.length;n++)t[n]=""+t[n]}}else t=[t];this.Oz.y4=t,this.Bz()},E.prototype.scrollToSelect=function(){},E.prototype.updateStyle=function(t,n,e){this.Ti.style.font=e},E.prototype.Dn=function(){var t=j("div");t.classList.add(f),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},E.prototype.Lz=function(t,n){var e;n&&(this.Pz(t,n.layout),n.items)&&(Array.isArray(n.items)?this.Gz(t,n.items):(e=n.items())instanceof HTMLElement&&(t.appendChild(e),t.classList.add(m),this.Pz(e,n.layout)))},E.prototype.Pz=function(t,n){n&&n.direction===l.LayoutDirection.horizontal?t.classList.add(T):t.classList.add(A)},E.prototype.Gz=function(t,n){for(var e,i,r,o,a,u,s,o,c,f,f,e=n.some(function(t){return!!t.icon}),i=0;i<n.length;i++)n[i].items?(r=n[i]).layout&&r.layout.displayAs===l.LayoutDisplayAs.inline?((o=j("div")).classList.add(d),(a=j("span")).innerText=r.text,!h(r.text)&&""!==r.text||a.classList.add(N),a.classList.add(v),o.appendChild(a),Array.isArray(r.items)?this.Lz(o,r):(u=r.items())instanceof HTMLElement&&((s=j("div")).classList.add(m),this.Pz(u,r.layout),s.appendChild(u),o.appendChild(s)),t.appendChild(o)):r.layout&&r.layout.displayAs===l.LayoutDisplayAs.tree?((o=j("div")).classList.add(G),(c=j("div")).classList.add(m),c.classList.add(g),(a=j("span")).innerText=r.text,a.classList.add(U),c.appendChild(a),r.layout.collapsible&&((f=j("span")).classList.add(S),c.appendChild(f),this.Uz(c)),o.appendChild(c),(f=j("div")).classList.add(k),Array.isArray(r.items)?this.Lz(f,r):(u=r.items())instanceof HTMLElement&&((s=j("div")).classList.add(m),this.Pz(u,r.layout),s.appendChild(u),f.appendChild(s)),o.appendChild(f),t.appendChild(o)):this.Hz(t,n[i],!1,!0):this.Hz(t,n[i],e)},E.prototype.Hz=function(t,n,e,i){var r,o,o,e,o,e,o,e,o;void 0===i&&(i=!1),(r=j("div")).classList.add(m),this.MU.textEllipsis&&r.classList.add(y),"-"===n.text?(r.classList.add(I),(o=j("div")).classList.add(x),r.appendChild(o)):(e&&((o=j("div")).classList.add(M),n.icon?o.style.backgroundImage="url(".concat(n.icon,")"):o.classList.add(C),r.appendChild(o)),(e=j("span")).classList.add(b),this.MU.textEllipsis&&e.classList.add(w),o=n.text,h(n.text)&&(o=h(n.value)?"":n.value),e.innerText=o,r.appendChild(e),r.setAttribute("text",o),e=h(n.value)?null:n.value,(o=a(this.Rz.items,e))<0&&(o=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(e)),this.Rz.doms[o].push(r),this.cE.set(r,"items",n),i&&((e=j("span")).classList.add(S),r.classList.add(g),this.cE.set(r,"sub-items",n),r.appendChild(e),this.zz(r))),this.MU.Oue&&(r.setAttribute("role","option"),r.setAttribute("tabindex","0"),o=n.text||n.value,h(o)||r.setAttribute("aria-label",o)),t.appendChild(r)},E.prototype.qj=function(t,n){var e,i,e=this.Rz.doms[t];if(n)for(i=0;i<e.length;i++)e[i].classList.contains(g)||e[i].classList.add(p);else for(i=0;i<e.length;i++)e[i].classList.contains(p)&&e[i].classList.remove(p)},E.prototype.Bz=function(){for(var t,n,e,i,r,o,n=this,e=n.MU,t=h(n.formula)?e&&e.multiSelect?i=n.Oz.y4:[n.Oz.y4]:["="+n.formula],r=0;r<n.Rz.items.length;r++)o=n.Rz.items[r],z(t,o=e&&e.multiSelect&&1!==e.valueType?""+o:o)?n.qj(r,!0):n.qj(r,!1)},E.prototype.Fz=function(){var r=this;this.Ti.querySelector("."+f).addEventListener("click",function(t){var n,n,e,t,n,i,n=r.Vz(t.target,".".concat(m));n&&(n.classList.contains(g)?r.Yz(t):(n=r.cE.get(n,"items"),e=r.MU,!n&&o.Common.lt.Eh(e&&e.onItemSelected)&&(n={value:e.onItemSelected(t)}),h(n)||(t=n.value,n=n.path,e&&e.multiSelect&&(z(i=(i=r.Oz.y4).slice(0),t=e.multiSelect&&1!==e.valueType?""+t:t)?Y(i,t):o.Common.Uf.ZP(i,t),r.Oz.y4=t=i,r.Bz(),1!==e.valueType)&&(t=W(t)),r.fire(s.BaseDropdown.Event_ValueChanged,{path:n,value:t,text:t,notCloseDropDown:e&&e.multiSelect,noAutoFormat:!0}))))})},E.prototype.Vz=function(t,n){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var n=(this.document||this.ownerDocument).querySelectorAll(t),e=n.length;0<=e&&n.item(e)!==this;)--e;return-1<e});for(var e=t;e&&!e.matches(n);)e=e.parentElement;return e},E.prototype.Yz=function(t){var n,e,i,r,o,o,a,n=this,e=this.Vz(t.target,".".concat(m));e.classList.contains(g)&&(i=this.cE.get(e,"sub-items"))&&i.items&&(r=j("div"),o=this.MU,i.multiSelect=o&&o.multiSelect,i.valueType=o&&o.valueType,i.onItemSelected=o&&o.onItemSelected,(o=new E(r,i,this)).Bz(),(a=new u.PopupControl(r,e,{align:l.DropDownAlignment.Near,hostElement:e,direction:l.DropDownDirection.Right})).open(),o.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t),n.MU&&n.MU.multiSelect?n.Bz():a.close()}),this.cE.set(e,"sub-items-popup",a),t.stopPropagation(),t.preventDefault())},E.prototype.zz=function(t){var e=this;t.addEventListener("mouseenter",function(t){e.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,n,t=t.target;t.classList.contains(g)&&(n=e.cE.get(t,"sub-items-popup"))&&(n.close(),e.cE.set(t,"sub-items-pop",void 0))})},E.prototype.Uz=function(t){var i=this;t.addEventListener("click",function(t){var n,n,e,n=t.target,n=i.Vz(n,".".concat(g));n&&(e=n.parentElement.querySelector("."+k))&&(n.parentElement.classList.contains(N)?n.parentElement.classList.remove(N):n.parentElement.classList.add(N),t.stopPropagation(),t.preventDefault())})},t.List=E},"./dist/plugins/celltype/editor/monthPicker.js":function(t,n,e){"use strict";var i,s,r,c,o,e,f,a,u,l,h,d,v,m,g,p,b,w;function y(t){return a.createElement(t)}function M(t,n){var t=w.call(this,t)||this;return t.setOptions(n),t.Fz(),t}i=this&&this.__extends||(b=function(t,n){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}b(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.MonthPicker=void 0,s=e("./dist/plugins/celltype/editor/baseControl.js"),r=e("./dist/plugins/celltype/celltypes.ns.js"),c=e("Common"),o=c.Common.lt.ht,e=new c.Common.ResourceManager(r.SR,"CellTypes"),f=e.getResource.bind(e),a=document,u="gc-month-picker-separator",l="gc-month-picker-year-item",h="gc-month-picker-month-item",d="gc-month-picker-qtr-item",v="selected",m="data-month",g="data-qtr",w=s.BaseDropdown,i(M,w),M.prototype.setOptions=function(t){var n,e,e,i,i,i,n=this,e=new Date,e={startYear:e.getFullYear()-10,stopYear:e.getFullYear(),height:300};t&&(o(t.startYear)||(i=parseInt(t.startYear,10),isNaN(i))||(e.startYear=i),!o(t.stopYear)&&0<t.stopYear&&(i=parseInt(t.stopYear,10),isNaN(i)||(e.stopYear=i)),e.stopYear<e.startYear&&(e.stopYear=t.startYear),o(t.height)||(i=parseInt(t.height,10),isNaN(i))||(e.height=i)),e.height=Math.max(1,e.height),n.MU=e,n.Ti.innerHTML="",n.Zz()},M.prototype.setValue=function(t){var n,e,i,r,t,o,n=this;t&&(e=t.getMonth()+1,i=t.getFullYear()),this.MU.startYear&&this.MU.stopYear&&this.MU.startYear<this.MU.stopYear&&i>this.MU.stopYear&&(i=this.MU.stopYear),"number"==typeof e&&(t=n.Ti.querySelector("[".concat(m,"='").concat(i,"-").concat(e,"']")))&&(t.classList.add(v),n.Wz&&n.Wz.classList.remove(v),n.Wz=t)},M.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},M.prototype.Qz=function(t,n){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var n=(this.document||this.ownerDocument).querySelectorAll(t),e=n.length;0<=e&&n.item(e)!==this;)--e;return-1<e});for(var e=t;e&&!e.matches(n);)e=e.parentElement;return e},M.prototype.Fz=function(){var u=this;this.Ti.addEventListener("click",function(t){var n,t,e,i,r,o,t,t,r,a,e,n=u,t=n.Qz(t.target,".".concat(h,",.").concat(d));t&&!t.getAttribute(g)&&(t.classList.add(v),n.Wz&&n.Wz.classList.remove(v),r=i=e=null,(n.Wz=t).getAttribute(m)&&(e=+(t=(o=t.getAttribute(m)).split("-"))[1],r=+t[0]),t=new Date(r,e-1,1,0,0,0,0),r=c.Common.CultureManager.Fe().DateTimeFormat,e=(a=new c.Formatter.GeneralFormatter(r.shortDatePattern)).format(t),n.fire(s.BaseDropdown.Event_ValueChanged,{text:e,value:t}))})},M.prototype.Zz=function(){var t,n,e,i,r,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),n=t.MU.startYear;n<=t.MU.stopYear;n++)e=document.createElement("div"),t.Jz(e),(i=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(n,i),(r=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(n,1,r),t.qz(n,2,r),t.qz(n,3,r),t.qz(n,4,r),e.appendChild(i),e.appendChild(r),this.Ti.appendChild(e)},M.prototype.Jz=function(t){var n=y("div");n.classList.add(u),t.appendChild(n)},M.prototype.Xz=function(t,n){var e=y("div");e.classList.add(l),e.innerText="".concat(t),n.appendChild(e)},M.prototype.qz=function(t,n,e){var i,r,o,a,u,i=document.createElement("div"),r=y("div"),o=y("div"),a=y("div"),u=y("div");switch(r.classList.add(h),o.classList.add(h),a.classList.add(h),u.classList.add(d),n){case 1:r.innerText=f().Calendar_ShortMonths_1,r.setAttribute(m,"".concat(t,"-").concat(1)),o.innerText=f().Calendar_ShortMonths_2,o.setAttribute(m,"".concat(t,"-").concat(2)),a.innerText=f().Calendar_ShortMonths_3,a.setAttribute(m,"".concat(t,"-").concat(3)),u.innerText=f().Quarter_Format_1,u.setAttribute(g,"".concat(t,"-").concat(1));break;case 2:r.innerText=f().Calendar_ShortMonths_4,r.setAttribute(m,"".concat(t,"-").concat(4)),o.innerText=f().Calendar_ShortMonths_5,o.setAttribute(m,"".concat(t,"-").concat(5)),a.innerText=f().Calendar_ShortMonths_6,a.setAttribute(m,"".concat(t,"-").concat(6)),u.innerText=f().Quarter_Format_2,u.setAttribute(g,"".concat(t,"-").concat(2));break;case 3:r.innerText=f().Calendar_ShortMonths_7,r.setAttribute(m,"".concat(t,"-").concat(7)),o.innerText=f().Calendar_ShortMonths_8,o.setAttribute(m,"".concat(t,"-").concat(8)),a.innerText=f().Calendar_ShortMonths_9,a.setAttribute(m,"".concat(t,"-").concat(9)),u.innerText=f().Quarter_Format_3,u.setAttribute(g,"".concat(t,"-").concat(3));break;case 4:r.innerText=f().Calendar_ShortMonths_10,r.setAttribute(m,"".concat(t,"-").concat(10)),o.innerText=f().Calendar_ShortMonths_11,o.setAttribute(m,"".concat(t,"-").concat(11)),a.innerText=f().Calendar_ShortMonths_12,a.setAttribute(m,"".concat(t,"-").concat(12)),u.innerText=f().Quarter_Format_4,u.setAttribute(g,"".concat(t,"-").concat(4))}i.appendChild(r),i.appendChild(o),i.appendChild(a),i.appendChild(u),e.appendChild(i),n<4&&this.Jz(e)},n.MonthPicker=M},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,n,e){"use strict";var i,c,f,r,l,o,a,u,e,b,o,h,d,s,v,m,g;function p(t){return Array.isArray(t)}function w(t){return"string"==typeof t}function y(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function M(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function C(t,n){var e,r,o,a,i,u,s,e=t[0],r=[];if(p(e))for(a=S(o=t,n),i=function(t,n){var e=o[t],i={};a.forEach(function(t,n){i[t]=e[n]}),r.push(i)},u=0,s=o.length;u<s;u++)i(u,s);else r=t;return r}function S(t,n){var e=[];return n&&0<n.length?n.forEach(function(t){e.push(t.name)}):e=t.shift(),e}function T(t,n,e){return g.call(this,t,n,e)||this}function A(t,n){var e=[];return t.yMt(n,0,0,e),e=I(e)}function I(t){for(var n,e,i,r,o,n=[],e=[],i=0;i<t.length;i++)o=""+(r=t[i]).row+r.col+r.rowCount+r.colCount+r.sheetName,n.indexOf(o)<0&&(n.push(o),e.push(r));return e}function x(r,t,o,a,u,s){var c={row:o,col:a,dataSource:u,dependSheetName:void 0,targetSheetName:s.name()};t.forEach(function(t){var t,n,e,i,n=t.row,e=t.col,i=null!=(t=t.sheetName)?t:s.name();void 0===r[n]&&(r[n]=[]),void 0===r[n][e]&&(r[n][e]=[]),r[n][e].some(function(t){return t.row===o&&t.col===a&&t.dataSource===u&&t.dependSheetName===i})||(c.dependSheetName=i,r[n][e].push(c))})}function N(t,n,e){var i,r,o,a,u,s,c;if(t)for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]))for(o in r)if(r.hasOwnProperty(o)&&(a=r[o]))for(u=0,s=a;u<s.length;u++)(c=s[u]).row>=n&&(c.row+=e)}function k(t,n,e){var i,r,o,a,u,s,c,f;if(t)for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]))for(o in r)if(r.hasOwnProperty(o)&&(a=r[o])){for(u=[],s=0,c=a;s<c.length;s++)(f=c[s]).row<n?u.push(f):f.row<n+e||(f.row-=e,u.push(f));r[o]=u}}function _(t,n,e){var i,r,o,a,u,s,c;if(t)for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]))for(o in r)if(r.hasOwnProperty(o)&&(a=r[o]))for(u=0,s=a;u<s.length;u++)(c=s[u]).col>=n&&(c.col+=e)}function D(t,n,e){var i,r,o,a,u,s,c,f;if(t)for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]))for(o in r)if(r.hasOwnProperty(o)&&(a=r[o])){for(u=[],s=0,c=a;s<c.length;s++)(f=c[s]).col<n?u.push(f):f.col<n+e||(f.col-=e,u.push(f));r[o]=u}}i=this&&this.__extends||(m=function(t,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.MultiColumn=void 0,c=e("Core"),f=e("SheetsCalc"),r=e("CalcEngine"),l=e("CalcEngine"),o=e("Common"),a=e("./dist/plugins/celltype/editor/baseControl.js"),u=e("./dist/plugins/celltype/editor/baseSpreadPicker.js"),e=e("./dist/plugins/celltype/celltypes.ns.js"),b=o.Common.lt.ht,o=new o.Common.ResourceManager(e.SR,"CellTypes"),h=o.getResource.bind(o),d=!!r,s=".multiColumnNS",g=u.BaseSpreadPicker,i(T,g),T.prototype.setOptions=function(t){var n,e,i,r,t,o,e,a,i;if(g.prototype.setOptions.call(this,t),(n=this).MU=t){if(e=n.TU,i=t.dataSource,r=t.bindingInfos,t=t.border,o=n.SU,e=e.getActiveSheet(),i){a=!0,y(e),e.options.isProtected=!0,e.options.rowHeaderVisible=!1,e.selectionPolicy(c.SelectionPolicy.single),e.selectionUnit(c.SelectionUnit.row);try{n.$z(e,i,r)}catch(t){a=!1,n.dispose()}finally{a&&e&&((i=new c.Style).hv=!1,e.setStyle(-1,-1,i,c.SheetArea.viewport),M(e))}}b(t)||(o.style.border=t)}},T.prototype.setValue=function(t){var n,e,i,e,n,n=this;n.MU&&(g.prototype.setValue.call(this,t),e=n.TU,i=e.getActiveSheet(),e=n.tV(t),i.suspendPaint(),-1!==e?(i.clear(0,-1,-1,-1,c.SheetArea.colHeader,c.StorageType.style),i.setSelection(e,-1,1,-1)):(i.clearSelection(),(n=new c.Style).backColor="rgb(225, 225, 225)",n.foreColor="rgb(33, 115, 70)",n.font="bold 11pt Calibri",n.borderBottom=new c.LineBorder("rgb(33, 115, 70)",c.LineStyle.medium),i.setStyle(0,-1,n,c.SheetArea.colHeader),i.D3(c.Events.ActiveCellChanged+s,function(t,n){i.setSelection(0,-1,1,-1),i._3(c.Events.ActiveCellChanged+s)})),i.resumePaint())},T.prototype.dispose=function(){var t,n,e,t,n,e;this.TU.getActiveSheet()._3(c.Events.ActiveCellChanged+s),g.prototype.dispose.call(this)},T.prototype.$z=function(t,n,e){var i,n;n&&(n=this.nV(n))&&(t.setDataSource(C(n,e)),e)&&t.bindColumns(e)},T.prototype.nV=function(t){var t,n,e,i,r,i,e,o,a,u,r,s,i,o,r,i,o,t=t,n=this.CU;if(w(t)){if(d){if(r=(i=this.MU).row,i=i.col,e=(0,f.formulaToExpression)(n,t),o=void 0,n.reportDataModel?(o=n.reportDataModel.xCi.POt)&&o.setContext&&o.setContext({row:r,col:i,formula:t,triggerUpdatePrecedents:!0}):(o=n.Uw(),x(a=n.Rpe(),u=A(n,e),r,i,t,n)),r=n.getCalcService().evaluateParsedFormula(o,e,(0,l.eV)(0,0),!0),i=!1,o=void 0,!(i=!(s=l.Convert.LE(r)||l.Convert.Nh(r))||(o=l.Convert.iV(r,0,!1,!1,!1)).isError||o.isConvertError?i:!0))throw new Error(h().MultiColumn_InvalidDataSource);e=o}}else t instanceof c.Range?e=n.getArray(t.row,t.col,t.rowCount,t.colCount):p(t)?e=t:t.viewName&&(e=(o=(i=(r=n.parent)&&r.dataManager().rV)&&i[t.viewName])&&o.oV());return e},T.prototype.tV=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,n=this,e=-1;if(t)if(r=(i=n.TU).getActiveSheet(),a=(o=Object.keys(t)).length,s=(u=r.getDataSource()).length,c=!1,f=n.MU.valuePath,b(f))for(l=0;l<s;l++){for(h=u[l],c=!0,d=0;d<a;d++)if(h[f=o[d]]!==t[f]&&void 0!==h[f]){c=!1;break}if(c){e=l;break}}else for(m=(v=t instanceof Date)?t+"":t,l=0;l<s;l++)if(g=u[l][f],(p=v&&g instanceof Date?g+"":g)===m){e=l;break}return e},T.prototype.submitData=function(t){var n,e,i,r,o,t,e,t,n=this,e=t.sheet,i;t.isEsc?r={notSubmit:!0}:-1<(t=(o=e.getSelections()[0]).row)&&(e=e.getDataItem(t),t=n.MU.valuePath,r={value:e=b(t)?e:e[t],text:e}),b(r)||n.fire(a.BaseDropdown.Event_ValueChanged,r)},n.MultiColumn=T,c.Worksheet.ch("dropDowns",{onLayoutChanged:function(t){var n,e,i,r,o,a,t;!b(t.sheetArea)&&3!==t.sheetArea||(e=(n=this).Rpe(),i=t.changeType,r=t.row,o=t.rowCount,a=t.col,t=t.colCount,"addRows"===i?N(e,r,o):"deletingRows"===i?k(e,r,o):"addColumns"===i?_(e,a,t):"deletingColumns"===i&&D(e,a,t))},updatePrecedents:function(t){var n,e,i,r,o,a,t,n=this,e=n.Rpe(),i=t.row,r=t.col,o=t.cells,a=t.formula,t=n.getStyle(i,r);t&&t.dropDowns&&t.dropDowns.some(function(t){return t.type===c.DropDownType.multiColumn&&t.option.dataSource===a})&&x(e,o,i,r,a,n)}})},"./dist/plugins/celltype/editor/popupControl.js":function(t,n,e){"use strict";var i,y,e,M,C,r,o,a,u,s;function c(t,n,e,i){this._x=t,this._y=n,this.YC=e,this.ZC=i}function f(t,n,e){var i=s.call(this,null)||this;return i.sourceElement=t,i.target=n,i.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:y.DropDownDirection.Down,align:y.DropDownAlignment.Near,horAdj:M.Flip|M.Slide,verAdj:M.Flip|M.Slide},i.globalMousedownEventHandler=function(t){var n,e;if(i.rf){for(e=n=t.target;e&&e!==i.sourceElement;)e=e.parentElement;e||(i.close(),t.stopPropagation(),t.preventDefault())}},i.windowResizeEventHandler=function(){i.rf&&i.close()},i.MU=i.defaultOption,i.rf=!1,e&&i.mergeOption(e),i.aV=null===i.MU.hostElement||void 0===i.MU.hostElement||!(i.MU.hostElement instanceof HTMLElement),i}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PopupControl=n.Rectangle=n.DropDownAdjustment=void 0,y=e("Core"),e=e("./dist/plugins/celltype/editor/baseControl.js"),(u=M=n.DropDownAdjustment||(n.DropDownAdjustment={}))[u.None=0]="None",u[u.Flip=1]="Flip",u[u.Slide=2]="Slide",c.CreateFromDom=function(t){return new c(t.left,t.top,t.width,t.height)},Object.defineProperty(c.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),c.prototype.Offset=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},C=c,n.Rectangle=C,r="ribbon-dropdowngroup-popup",s=e.BaseControl,i(f,s),f.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},f.prototype.beforeOpen=function(){this.bindEvent()},f.prototype.dispose=function(){var n=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,n.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(r),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this.Z3):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},f.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.Oue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},f.prototype.mergeOption=function(t){for(var n in t)void 0!==t[n]&&(this.MU[n]=t[n])},f.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},f.prototype.calcPosition=function(){var t,n,e,e,t,i,r,o,a,o,a,e,n=this.target instanceof C,t=n?this.target:C.CreateFromDom(this.target.getBoundingClientRect()),e=new C(0,0,window.innerWidth,window.innerHeight),e=this.calculateDropDownLocation(e,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,i=t.getBoundingClientRect(),r=t===document.body,o=document.documentElement,a=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),o=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),a=e.X-(r?-a:i.left-t.scrollLeft),e=e.Y-(r?-o:i.top-t.scrollTop);n&&(a<0&&(a=0),e<0)&&(e=0),this.cV.style.left="".concat(a,"px"),this.cV.style.top="".concat(e,"px")},f.prototype.calculateDropDownLocation=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,a,o,b,w,n,u={X:t.x,Y:t.y};switch(t.Offset(-u.X,-u.Y),n.Offset(-u.X,-u.Y),s=n.left,c=n.right,f=n.top,l=n.bottom,h=f,d=t.height-l,v=s,m=t.width-c,g=(a&M.Flip)===M.Flip,p=(o&M.Flip)===M.Flip,a=(a&M.Slide)===M.Slide,o=(o&M.Slide)===M.Slide,i){case y.DropDownDirection.Up:e.height>h&&g&&(i=y.DropDownDirection.Down);break;case y.DropDownDirection.Down:e.height>d&&g&&(i=y.DropDownDirection.Up);break;case y.DropDownDirection.Left:e.width>v&&p&&(i=y.DropDownDirection.Right);break;case y.DropDownDirection.Right:e.width>m&&p&&(i=y.DropDownDirection.Left)}switch(w=b=0,i){case y.DropDownDirection.Up:w=f-e.height;break;case y.DropDownDirection.Down:w=l;break;case y.DropDownDirection.Left:b=s-e.width;break;case y.DropDownDirection.Right:b=c}return i===y.DropDownDirection.Up||i===y.DropDownDirection.Down?r===y.DropDownAlignment.Near?b=s:r===y.DropDownAlignment.Center?b=s-(e.width-n.width)/2:r===y.DropDownAlignment.Far&&(b=c-e.width):i!==y.DropDownDirection.Right&&i!==y.DropDownDirection.Left||(r===y.DropDownAlignment.Near?w=f:r===y.DropDownAlignment.Center?w=f-(e.height-n.height)/2:r===y.DropDownAlignment.Far&&(w=l-e.height)),n=new C(b,w,e.width,e.height),o&&(n.width>t.width?n.x=0:(n.x=Math.max(n.x,0),n.x=Math.min(n.x,t.width-n.width))),a&&(n.height>t.height?n.y=0:(n.y=Math.max(n.y,0),n.y=Math.min(n.y,t.height-n.height))),n.Offset(u),n.Location},f.prototype.render=function(){var n=this;this.aV?(this.Z3=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(r),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(r),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout(function(){var t;n.cV&&(t=n.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},f.prototype.bindEvent=function(){var n=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,n.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},n.PopupControl=f},"./dist/plugins/celltype/editor/slider.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C;function S(t){return document.createElement(t)}function T(t){var n=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(f(0,(n[1]||"").length-parseInt(n[2],10)))}function A(t){var t,n,t=T(t||0),n=0;return n=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:n}function I(){}function x(t,n){this.Wc=n,this.fV={},this.fV=d.extend(this.fV,t)}function N(t,n){this.Wc=n,this.lV={},this.lV=d.extend(this.lV,t)}function k(t,n){this.Wc=t,this.hV={},this.dV="",this.hV=d.extend(this.hV,n),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function _(t,n){this.Wc=n,this.vV={},this.mV=!1,this.gV=c,this.isSelected=!1,this.yme=c,this.vV=d.extend(this.vV,t),this.gV=new g(this.Wc,this.pV())}function D(t,n){this.Wc=n,this.bV={},this.bV=d.extend(this.bV,t)}function j(t,n,e,i,r){this.Wc=t,this.yV=n,this.wV=e,this.endHandle=i,this.MU=r,this.MV=c,this.CV=c,this.MV=new m(this.SV(),this.Wc),this.CV=new b(this.TV(),this.Wc)}function O(t,n){var i=C.call(this,t)||this;return i.yV=c,i.wV=c,i.Y1e=c,i.Z1e=c,i.AV=c,i.Mme=function(t){var t,t,t;d.pauseEvent(t),t=i.AV.getKeyboardValueMutator(t),d.isEmpty(t)||(t=t(i._V.value),(t=i.AV.trimAlignValue(t))!==i._V.value&&(i.setValue(t),i._V.onChange(t),i._V.onAfterChange(t),i.fire(r.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))},i.IV=function(t){0===t.button&&(document.addEventListener("mouseup",i.xV,!1),document.addEventListener("pointerup",i.xV,!1),document.addEventListener("MSPointerUp",i.xV,!1),document.addEventListener("mousemove",i.NV,!1),document.addEventListener("pointermove",i.NV,!1),document.addEventListener("MSPointerMove",i.NV,!1),i.NV(t))},i.NV=function(t){var t,n,t=i.kV(t,!0),n=i.AV.trimAlignValue(t);i._V.showNumberRange?i.Cme(n,t):i.DV!==n&&(i.setValue(n),i._V.onChange(n))},i.xV=function(t){var n,e;i.NV(t),document.removeEventListener("mousemove",i.NV),document.removeEventListener("mouseup",i.xV),document.removeEventListener("pointermove",i.NV),document.removeEventListener("pointerup",i.xV),document.removeEventListener("MSPointerMove",i.NV),document.removeEventListener("MSPointerUp",i.xV),n=i.kV(t,!0),e=i.AV.trimAlignValue(n),i._V.showNumberRange?(i.Cme(e,n),i._V.onAfterChange(i._V.numberRange),i.fire(r.BaseDropdown.Event_ValueChanged,{value:i._V.numberRange,text:i._V.numberRange,notCloseDropDown:!0})):(i.DV=e,i._V.onAfterChange(i._V.value),i.fire(r.BaseDropdown.Event_ValueChanged,{value:e,text:e.toString(),notCloseDropDown:!0})),d.pauseEvent(t)},i.EV=function(t){var n=t.target||t.srcElement;document.addEventListener("touchend",i.jV,!1),n.classList.contains("".concat(i._V.prefixCls,"-handle"))?document.addEventListener("touchmove",i.OV,!1):i.OV(t)},i.OV=function(t){var t,t,n,t=t.targetTouches[0],t=i.kV(t,!0),n=i.AV.trimAlignValue(t);i._V.showNumberRange?i.Cme(n,t):i.DV!==n&&(i.setValue(n),i._V.onChange(n))},i.jV=function(t){var n,n,e;document.removeEventListener("touchmove",i.OV),document.removeEventListener("touchend",i.jV),n=t.changedTouches[0],n=i.kV(n,!0),e=i.AV.trimAlignValue(n),i._V.showNumberRange?(i.Cme(e,n),i._V.onAfterChange(i._V.numberRange),i.fire(r.BaseDropdown.Event_ValueChanged,{value:i._V.numberRange,text:i._V.numberRange,notCloseDropDown:!0})):(i.DV=e,i._V.onAfterChange(i._V.value),i.fire(r.BaseDropdown.Event_ValueChanged,{value:e,text:e.toString(),notCloseDropDown:!0})),d.pauseEvent(t)},i.init(n),i}i=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Slider=void 0,r=e("./dist/plugins/celltype/editor/baseControl.js"),o=e("Common"),a=e("Core"),u=o.Common.lt.ht,s=o.Common.zf.j0,c=null,f=Math.max,l=Math.min,h=Math.abs,I.isEmpty=function(t){return void 0===t||t===c||""===t||Array.isArray(t)&&0===t.length},I.isEmptyObject=function(t){var n,e,n=!0;for(e in t)if(e){n=!1;break}return n},I.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},I.isObject=function(t){var n=typeof t;return"function"==n||"object"==n&&!!t},I.allKeys=function(t){var n,e,n=[];if(!I.isObject(t))return[];for(e in t)t.hasOwnProperty(e)&&n.push(e);return n},I.parseStyleObject=function(t){var n,e,i,r,o,a,o;if(!I.isObject(t))return"";for(n="",i=0,r=(e=I.allKeys(t)).length;i<r;i++)a=t[o=e[i]],o=o.replace(/([A-Z])/g,"-$1"),n+="".concat(o.toLowerCase(),": ").concat(a,"; ");return n.trim()},I.extend=function(t,n,e){var i,r,o,a,u;for(void 0===e&&(e={}),i=I.allKeys(t),o=0,a=(r=I.allKeys(n)).length;o<a;o++)e[u=r[o]]=n[u];for(o=0,a=i.length;o<a;o++)void 0===e[u=i[o]]&&(e[u]=t[u]);return e},I.noop=function(){},I.measureWidth=function(t,n){var e,i,e=0,i=S("span");i.classList.add(n);try{i.innerText=t,i.style.display="none",document.body.appendChild(i),e=(0,a.GC$)(i).width()}finally{document.body.removeChild(i)}return e},d=I,x.prototype.render=function(){var t,n;if(!this.fV.included)return c;t=this.RV(),(n=this.Wc.querySelector(".".concat(this.fV.className)))===c&&((n=S("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(n)),n.setAttribute("style",d.parseStyleObject(t))},x.prototype.setLength=function(t,n){this.fV.length=t,u(n)||(this.fV.offset=n),this.render()},x.prototype.RV=function(){return this.fV.direction===a.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},v=x,N.prototype.render=function(){var t,n,e,i,r,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===c){for((t=S("div")).className="".concat(this.lV.className),e=0,i=(n=this.BV()).length;e<i;e++)r=this.LV(n[e]),t.appendChild(r);this.Wc.appendChild(t)}},N.prototype.LV=function(t){var n,e,e,e,n=S("span"),e=this.lV.max-this.lV.min,e=h(t-this.lV.min)/e*100+"%",e=this.lV.direction===a.LayoutDirection.vertical?{bottom:e}:{left:e};return n.classList.add("".concat(this.lV.prefixCls,"-dot")),n.setAttribute("style",d.parseStyleObject(e)),n.setAttribute("key",t.toString()),n},N.prototype.BV=function(){var t,n,e,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,n){return t-n}),n=t,this.lV.dots)for(e=this.lV.min;e<=this.lV.max;e+=this.lV.step)-1===n.indexOf(e)&&n.push(e);return n},m=N,k.prototype.render=function(t,n){var t,n,e,e,i,e;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),n=new o.Formatter.GeneralFormatter(this.hV.formatString).format(n),d.isEmpty(t)&&(e=s(n),this.dV=this.dV.replace(/{{value}}/,e),(e=S("div")).innerHTML=this.dV,this.Wc.appendChild(e.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(i=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=n,e=this.GV(n),t.setAttribute("style",d.parseStyleObject(e)),this.hV.tooltipVisible?this.show():this.hide()},k.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));d.isEmpty(t)||(t.style.display="inline-block")},k.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));d.isEmpty(t)||(t.style.display="none")},k.prototype.GV=function(t){var t,t=0===(t=d.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===a.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},g=k,_.prototype.render=function(){var t,n,e,i,t=this.UV(),n=this.GV(),e=this.vV.tabIndex||0;!this.vV.disabled&&e!==c||(e=c),(i=this.Wc.querySelector(".".concat(this.vV.className)))===c&&((i=S("div")).className=t,this.Wc.appendChild(i),i.setAttribute("role","slider"),i.setAttribute("aria-valuemin",this.vV.min.toString()),i.setAttribute("aria-valuemax",this.vV.max.toString()),i.setAttribute("aria-valuenow",this.vV.value.toString()),i.setAttribute("aria-disabled",String(this.vV.disabled)),i.addEventListener("blur",this.Sme.bind(this)),i.addEventListener("mouseenter",this.Tme.bind(this)),i.addEventListener("keydown",this.Sme.bind(this)),i.addEventListener("mousedown",this.Ame.bind(this)),i.addEventListener("touchstart",this.Ame.bind(this)),document.addEventListener("touchend",this.Ime.bind(this)),document.addEventListener("mouseup",this.Ime.bind(this))),i.tabIndex=e,i.setAttribute("style",d.parseStyleObject(n)),this.yme=i},_.prototype.Ame=function(t){this.yme.focus(),this.isSelected=!0,this.gV.show()},_.prototype.Ime=function(t){var n=this.yme;document.activeElement===n&&(this.HV(!1),n.blur(),this.isSelected=!1)},_.prototype.Sme=function(){this.HV(!1)},_.prototype.Tme=function(){this.gV.show()},_.prototype.isSelectedByMouse=function(t){return u(t)||(this.isSelected=t),this.isSelected},_.prototype.setOffset=function(t,n){this.vV.offset=t,this.render(),this.gV.render(t,n)},_.prototype.HV=function(t){this.mV=t},_.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},_.prototype.GV=function(){return this.vV.direction===a.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},_.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},_.prototype.dispose=function(){this.yme&&(this.yme.removeEventListener("blur",this.Sme.bind(this)),this.yme.removeEventListener("mouseenter",this.Tme.bind(this)),this.yme.removeEventListener("keydown",this.Sme.bind(this)),this.yme.removeEventListener("mousedown",this.Ame.bind(this)),this.yme.removeEventListener("touchstart",this.Ame.bind(this))),this.yme=c,document.removeEventListener("touchend",this.Ime.bind(this)),document.removeEventListener("mouseup",this.Ime.bind(this))},p=_,D.prototype.render=function(){var t,n,e,i,r,r,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===c){for((t=S("div")).className="".concat(this.bV.className),n=this.zV(),this.VV(n),e=0,i=n.length;e<i;e++)r=n[e],(r=this.YV(r))!==c&&t.appendChild(r);this.Wc.appendChild(t)}},D.prototype.VV=function(t){var n,e,i,i;for(this.ZV=0,n=1,e=t.length;n<e;n++)(i=this.bV.marks[t[0]])&&(i=d.measureWidth(i.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<i)&&(this.ZV=i)},Object.defineProperty(D.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),D.prototype.zV=function(){var t;return d.allKeys(this.bV.marks).sort(function(t,n){return t-n})},D.prototype.YV=function(n){var e,t,i,r,o,o,t,e=this,t=this.bV.marks[n],i=d.isObject(t)?t.label:t;return d.isEmptyObject(i)?c:(r="".concat(this.bV.className,"-text"),o=this.WV(n),o=d.extend(o,t.style),(t=S("span")).classList.add(r),t.setAttribute("style",d.parseStyleObject(o)),t.setAttribute("key",n.toString()),t.addEventListener("mousedown",function(t){e.bV.onClickLabel(t,n)}),t.innerHTML=s(i),t)},D.prototype.WV=function(t){var n=this.bV.max-this.bV.min;return this.bV.direction===a.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/n*100+"%"}:{left:(t-this.bV.min)/n*100+"%",transform:"translateX(-50%)"}},b=D,j.prototype.render=function(){var t=S("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===a.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},j.prototype.calcValueByPosition=function(t,n){var t,t,t=t-this.QV(),t=this.KV(t);return n?t:this.trimAlignValue(t)},j.prototype.trimAlignValue=function(t){return d.isEmpty(t)?c:this.JV(t)},j.prototype.calcOffset=function(){var t;return 100*(f(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},j.prototype.getKeyboardValueMutator=function(t){var n=this;switch(t.keyCode){case 38:case 39:return function(t){return n.calculateNextValue("increase",t)};case 40:case 37:return function(t){return n.calculateNextValue("decrease",t)};case 35:return function(t){return n.MU.max};case 36:return function(t){return n.MU.min}}},j.prototype.calculateNextValue=function(t,n){var e,i,i,i,e={increase:function t(n,e){return n+e},decrease:function t(n,e){return n-e}},i=Object.keys(this.MU.marks).indexOf(String(n)),i=e[t](i,1),i=Object.keys(this.MU.marks)[i];return this.MU.step?e[t](n,this.MU.step):!d.isEmptyObject(this.MU.marks)&&this.MU.marks[i]?this.MU.marks[i]:n},j.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===c?t:parseFloat(t.toFixed(this.qV()))},j.prototype.qV=function(){var t,n;if(u(this.MU.precision)){for(n in t=f(A(this.MU.max),A(this.MU.min),A(this.MU.step)),this.MU.marks)t=f(A(parseFloat(n)),t);this.MU.precision=t}return this.MU.precision},j.prototype.XV=function(n){var t,e,e,e,e,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==c&&(e=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),e=l((n-this.MU.min)/this.MU.step,e),e=Math.round(e)*this.MU.step+this.MU.min,t.push(l(e,this.MU.max))),e=t.map(function(t){return h(n-t)}),t[e.indexOf(l.apply(void 0,e))]},j.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},j.prototype.TV=function(){var e=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?d.noop:function(t,n){e.$V(t,n)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},j.prototype.$V=function(t,n){},j.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===a.LayoutDirection.vertical?t.top:t.left},j.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===a.LayoutDirection.vertical?t.height:t.width},j.prototype.KV=function(t){var n,e,t,n=this.MU.min,e=this.MU.max,t=h(f(t,0)/this.tY());return(t=this.MU.direction===a.LayoutDirection.vertical?f(1-t,0):t)*(e-n)+n},w=j,C=r.BaseDropdown,i(O,C),O.prototype.setValue=function(t){var n,e,n;this._V.disabled||(this._V.showNumberRange?(u(this.W1e)&&(this.W1e={}),n=t.start,e=t.end,n=parseFloat(n),n=isNaN(n)?this._V.min:(n=f(this._V.min,n),l(this._V.max,n)),this._V.numberRange.start=n,this.W1e.start=n,this.Y1e.setOffset(this.calcOffset(n),n),e=parseFloat(e),e=isNaN(e)?this._V.max:(e=f(this._V.min,e),l(this._V.max,e)),e=f(n,e),this._V.numberRange.end=e,this.W1e.end=e,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(n)),this.Z1e.setOffset(this.calcOffset(e),e)):(n=parseFloat(t),n=isNaN(n)?this._V.min:(n=f(this._V.min,n),l(this._V.max,n)),this._V.value=n,this.DV=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),n)))},O.prototype.calcOffset=function(t){var t,t,t=u(t)?this._V.value:t,t=f(t-this._V.min,0)/(this._V.max-this._V.min);return 100*(t=l(t,1))},O.prototype.calcRangeOffset=function(){var t,t,t=this._V.numberRange.end-this._V.numberRange.start,t=f(t,0)/(this._V.max-this._V.min);return 100*(t=l(t,1))},O.prototype.setOptions=function(t){this.init(t)},O.prototype.init=function(t){var t,n,t,e,e;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=S("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===a.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(n=S("div")).className=this.UV(),t.appendChild(n),this.yV=new v(this.iY(),n),this._V.showNumberRange?((t=this.rY()).value=this._V.numberRange.start,e=S("div"),n.appendChild(e),this.Y1e=new p(t,e),t.tabIndex++,t.value=this._V.numberRange.end,e=S("div"),n.appendChild(e),this.Z1e=new p(t,e),this.AV=new w(n,this.yV,this.Y1e,this.Z1e,this.oY())):(this.wV=new p(this.rY(),n),this.AV=new w(n,this.yV,this.wV,c,this.oY())),this.AV.render(),this.aY(n)},O.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Mme))},O.prototype.Cme=function(t,n){var e,i,e,r,n,o,a,o,a,e=this._V.numberRange,i=e.start,e=e.end,r=h(n-i),n=h(e-n),o=this.Y1e,a=this.Z1e;i===e?(e<t?(this.setValue({start:i,end:t}),this._V.onChange({start:i,end:t})):t<i&&(this.setValue({start:t,end:e}),this._V.onChange({start:t,end:e})),o.isSelectedByMouse(!1),a.isSelectedByMouse(!1)):(o=this.Z1e.isSelectedByMouse(),a=this.Y1e.isSelectedByMouse(),(o&&r<n||n<r&&!a)&&e!==t&&(this.setValue({start:i,end:t}),this._V.onChange({start:i,end:t})),(a&&n<r||r<n&&!o)&&i!==t&&(this.setValue({start:t,end:e}),this._V.onChange({start:t,end:e})))},O.prototype.kV=function(t,n){var e=0,e;return e=this._V.direction===a.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,n):this.AV.calcValueByPosition(t.clientX,n)},O.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:a.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},O.prototype.eY=function(){(d.isEmpty(this._V)||d.isEmptyObject(this._V))&&(this._V={}),this._V=d.extend(this.uY(),this._V)},O.prototype.nY=function(t){var e=this;t&&(u(t.scaleVisible)||(this._V.dots=t.scaleVisible),u(t.direction)||(this._V.direction=t.direction),u(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),u(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),u(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,n,t=parseFloat(t);isNaN(t)||t>=e._V.min&&t<=e._V.max&&(n=new o.Formatter.GeneralFormatter(e._V.formatString),e._V.marks[t]={label:n.format(t)})})},O.prototype.sY=function(t,n){var t;u(t)||(t=parseFloat(t),isNaN(t))||(this._V[n]=t)},O.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},O.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},O.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},O.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===a.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),d.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},O.prototype.dispose=function(){var t=this.yV.Wc;t&&(t.removeEventListener("mousedown",this.IV),t.removeEventListener("pointerdown",this.IV),t.removeEventListener("MSPointerDown",this.IV),t.removeEventListener("touchstart",this.EV),t.removeEventListener("keyup",this.Mme)),this.yV.Wc=c,this.wV&&this.wV.dispose(),this.wV=c,this.Y1e&&this.Y1e.dispose(),this.Y1e=c,this.Z1e&&this.Z1e.dispose(),this.Z1e=c,C.prototype.dispose.call(this)},n.Slider=O},"./dist/plugins/celltype/editor/timepicker.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l;function h(t,n){var t=l.call(this,t)||this;return t.Hc(),t.setOptions(n),t}i=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TimePicker=void 0,r=e("./dist/plugins/celltype/editor/listControl.js"),o=e("./dist/plugins/celltype/editor/baseControl.js"),a="undefined",u=e("Common"),s=u.Common.lt.ht,l=o.BaseDropdown,i(h,l),h.prototype.setOptions=function(t){var n,n,n,n;t&&(null!==(n=this.cY(t.min))&&(this.MU.min=n),null!==(n=this.cY(t.max))&&(this.MU.max=n),null!==(n=this.cY(t.step))&&(this.MU.step=n),s(t.formatString)||(this.MU.formatString=t.formatString),s(t.height)||(n=parseInt(t.height,10),isNaN(n))||(this.MU.height=n),this.MU.height=Math.max(1,this.MU.height)),this._6()},h.prototype.setValue=function(t){void 0!==t&&(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},h.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},h.prototype.Hc=function(){var n=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){n.pz(t)}),this.Ti.appendChild(this.gz)},h.prototype.cY=function(t){var n,e,e,e,n=null;return s(t)||(n={},s(t.hour)||(e=parseInt(t.hour,10),isNaN(e))||(n.hour=e),s(t.minute)||(e=parseInt(t.minute,10),isNaN(e))||(n.minute=e),s(t.second))||(e=parseInt(t.second,10),isNaN(e))||(n.second=e),n},h.prototype._6=function(){this.gz.innerHTML="",new r.List(this.gz,this.lY()),this.yz()},h.prototype.yz=function(){var t,n,e,i,r,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(n=0;n<t.length;n++)t[n].classList.remove("selected"),e=+t[n].getAttribute("hour"),i=+t[n].getAttribute("minute"),r=+t[n].getAttribute("second"),this.hY(this.Bz,{hour:e,minute:i,second:r})&&t[n].classList.add("selected")},h.prototype.lY=function(){var r=this;return{items:function(){var t,n,e,i,t=r.dY(),n=document.createElement("div");for(n.classList.add("gc-time-picker-container"),r.Wc=n,r.MU.height<0?n.style.height="auto":n.style.maxHeight=r.MU.height+"px",(e=document.createElement("ul")).classList.add("gc-time-picker-ul"),i=0;i<t.length;i++)e.appendChild(r.vY(t[i]));return 24*t.length>r.MU.height&&0<=r.MU.height?n.style.overflowY="scroll":n.style.overflowY="hidden",n.appendChild(e),n}}},h.prototype.vY=function(t){var n=document.createElement("li");return n.classList.add("gc-time-picker-li"),n.setAttribute("hour",t.hour.toString()),n.setAttribute("minute",t.minute.toString()),n.setAttribute("second",t.second.toString()),n.innerText=this.mY(t),n},h.prototype.dY=function(){for(var t,n,e,t=this.gY(this.MU.min),n=this.gY(this.MU.max),e=[];t<=n;)e.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return e},h.prototype.pY=function(t,n){return typeof n.hour!=a&&t.setHours(t.getHours()+n.hour),typeof n.minute!=a&&t.setMinutes(t.getMinutes()+n.minute),typeof n.second!=a&&t.setSeconds(t.getSeconds()+n.second),t},h.prototype.mY=function(t){var n,e,t,n=new Date;return n.setHours(t.hour),n.setMinutes(t.minute),n.setSeconds(t.second),(t=(e=new u.Formatter.GeneralFormatter(this.MU.formatString)).format(n))&&""!==t&&null!==t?t:this.bY(n)},h.prototype.bY=function(t){var n,t,e,i,r,n=t.getHours(),t=t.getMinutes(),e,i,r;return(n<12?"AM":"PM")+" "+(0===n||12===n?"12":(n%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},h.prototype.gY=function(t){var n=new Date;return n.setHours(t.hour||0),n.setMinutes(t.minute||0),n.setSeconds(t.second||0),n},h.prototype.hY=function(t,n){return!(!t||!n)&&(t=this.yY(t),n=this.yY(n),t.hour===n.hour)&&t.minute===n.minute&&t.second===n.second},h.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},h.prototype.pz=function(t){var t,n,e,t,i,r,r,t=t.target;t&&(n=+t.getAttribute("hour"),e=+t.getAttribute("minute"),t=+t.getAttribute("second"),(i=this.fY||new Date).setHours(n),i.setMinutes(e),i.setSeconds(t),i.setMilliseconds(0),r=(new u.Common.CultureInfo).DateTimeFormat,r=new u.Formatter.GeneralFormatter(r.defaultDatePattern).format(i),this.fire(o.BaseDropdown.Event_ValueChanged,{value:i,text:r}),this.Bz={hour:n,minute:e,second:t},this.yz())},n.TimePicker=h},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,n,e){"use strict";var i,r,o,e,s,a,u,c;function f(t,n){var e=c.call(this,t)||this;return e.wY=new o.List(t),e.wY.on(r.BaseDropdown.Event_ValueChanged,function(t){e.fire(r.BaseDropdown.Event_ValueChanged,t)}),e.setOptions(n),e}function l(t,n){var i,r,o,e,a,u,i={items:[]},r=t.items,o=r.filter(function(t){return t.value===n})[0];if(s(o)&&r&&0<r.length)(e=i.items).push({text:r[0].value,value:r[0].value});else if(o&&o.transitions&&0<o.transitions.length)for(a=function(t){var n,t,e,n=o.transitions[t];"number"==typeof n&&r[n]&&(n=r[n].value),(t=r.filter(function(t){return t.value===n})[0])&&(e=i.items).push({text:t.value,value:t.value})},u=0;u<o.transitions.length;u++)a(u);return i}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.WorkFlow=void 0,r=e("./dist/plugins/celltype/editor/baseControl.js"),o=e("./dist/plugins/celltype/editor/listControl.js"),e=e("Common"),s=e.Common.lt.ht,c=r.BaseDropdown,i(f,c),f.prototype.setOptions=function(t){this.MU=t},f.prototype.setValue=function(t){var t;this.MU&&(t=l(this.MU,t),this.wY.setOptions(t))},f.prototype.updateStyle=function(t,n,e){this.wY.updateStyle(t,n,e)},n.WorkFlow=f},"./dist/plugins/celltype/hyperlinkcelltype.js":function(F,t,n){"use strict";var e,i,M,n,g,n,r,w,o,u,S,T,a,s,c,C,p,A,f,l,h,d,v,I,m,b,y,x,L,B,N,P,G,k,U,_,D,j,i,O;function H(t,n){t.removeChild(n)}function E(){var t,e,t=O.call(this)||this;return t.typeName="8",(e=t)._id=t.MY(),s(_,function(t,n){e["_"+t]=n}),t._onAction=function(t){var n,e,i,t,n,e,n=t&&t.sheet,e=t.row,i=t.col,t=t.sheetArea,n=n.getValue(e,i,t),e=V(this._target);n&&f(o(n),e)},t}function V(t){return["_blank","_self","_parent","_top"][t]}function z(t,n,e,i,r,o){var a,u,s,t,a=0,u=0,s=t.width,t=t.height;return a=o=o||0,1===i?a=(s-n)/2:2===i?a=s-n-o:5===i&&(a=(s-n)/2),1===r?u=(t-e)/2:2===r&&(u=t-e),{x:a,y:u}}function Y(t,n,e,i){var t,e,t=J(t,e,n),e=t.width;return e+=!0==(1!==n.hAlign&&!w(i))?i:0,t.width=e,t}function Z(t,n,e,i,r){var t,e,t=J(t,e,n,i.width),e=z(i,t.width,t.height,n.hAlign,n.vAlign,r);return t.x=e.x,t.y=e.y,t}function W(t,n){var e,t,e=R(n),t=t-3-e;return 5===n.hAlign&&(t-=e),--t}function Q(t,n,e,i){var n,e,n=W(n,e),e=M.q.Gge(t);return 1===e.length&&0===e[0].prefixSpaceCount?C(0,M.q.Wt(e[0].word,i,!0)):n}function J(t,n,e,i){var r,o,a,r=u(n),o,a;return{x:0,y:0,width:5===e.hAlign&&i?Q(t,i,e,n):Math.max(0,M.q.Wt(t,n,!0)),height:t.split(/\r\n|\r|\n/).length*r}}function K(t,n,e,i,r,o){var a,u,r,s,c,f,r,a,l,h,d,v,m,g,a=r.sheet,u=a.Dn;if(!w(e)&&(o=o||(r=a.getValue(r.row,r.col,r.sheetArea),w(r))?o:r+""))for(i=e.cellType.An(i,e,a.zoom()),o=o.replace(/\s+/g," "),s=e&&e.font?e.font:u.Nn(),s=u._n(s),c=[o],f=R(e),!e.wordWrap&&5!==e.hAlign||(r=i.width-3-f,5===e.hAlign&&(r-=f),o=(c=M.q.un(o,r,s)).join("\r\n")),a=Z(o,e,s,i,f),l=i.y+a.y,h=0;h<c.length;h++)if(d=Z(c[h],e,s,i,f),v=i.x+d.x,m=p(v+d.width,i.x+i.width),l=p((g=l)+d.height,i.y+i.height),v<=t&&t<m&&g<=n&&n<l)return!0;return!1}function R(t){return 8*(t.textIndent||0)}function X(t,n,e,i,r){var o,i,a,a,u,e,a,s,c,f,l,h,d,v,m,a,o=i&&i.sheet;if(o){if(a=o.Dn,u=n.font||a.Nn(),1<e&&(u=a._n(u)),e=R(n),n.wordWrap||r){if(n.wordWrap){if(a=i.row,s=i.col,c=i.sheetArea,f=0,l=o.Ut.findSpan(a,s,c)){if(l.row>=a&&l.rowCount<=1&&l.col>=s&&s===l.col&&(f=o.nn(s,c),1<l.colCount))for(h=s+1;h<s+l.colCount;h++)f+=o.nn(h,c)}else f=o.nn(s,c);if(i=g(n,1),0<(a=g(n,3))&&(f-=a),0<i&&(f-=i),d=M.q.un(t,f-3-e,u),r&&1<t.split(/\r\n|\r|\n/).length){for(m=v=0;m<d.length;m++)v=Math.max(v,Y(d[m],n,u,R(n)).width);return v}r||(t=d.join("\r\n"))}}else t=t.replace(/\s+/g," ");return a=Y(t,n,u,R(n)),r?a.width:a.height}return 0}e=this&&this.__extends||(j=function(t,n){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}j(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,i=n("Common"),n=(M=n("Core")).CellTypes.Context,g=n.gn,n=M.CellTypes.Base,r=M.mt.En,w=i.Common.lt.ht,o=i.Common.zf.TY,u=M.mt.vt,S=M.mt.Tt,T=S.mozilla,a=M.GC$,s=a.each,c=null,C=Math.max,p=Math.min,A=Math.floor,f=window.open,l="position",h="absolute",d="margin",v="font",I="left",m="top",b="padding",y="border",x="box-sizing",L="background-color",B="content-box",N="default",P="white",G="div",k="hyperlinkInfo",(i=U=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[i.blank=0]="blank",i[i.self=1]="self",i[i.parent=2]="parent",i[i.top=3]="top",_={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},e(E,O=n),E.prototype.MY=function(){var t,n;return w(this._id)&&(this._id="0"),n="id_"+(t=parseInt(this._id,10)),this._id=++t+"",n},E.prototype.AY=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,f,v,m,h,g,p,b,u,w,o,y,M,C,l=1,h=I,d=a.hAlign,f=a.vAlign,v=u.lineHeight,m=s.length;if(l+=n,1===d?(l=r/2,h="center"):2===d&&(l=r-1,l-=n,h="right"),t.textAlign!==h&&(t.textAlign=h),h=1,g="alphabetic",h+=v-(u=v/2-(p=parseInt(u.fontInfo.fontSize,10))/2+(b=8<p?A((p-8)/5+2):1)-1),1===f?v<o&&(h=T?(o-c)/2+1:S.msie?(o-c)/2+.5:(o-c)/2,A(h)!==h&&(h+=.5),h+=v/2-u):2===f&&(h=o-c-2.5-u),t.textBaseline!==g&&(t.textBaseline=g),w=i+h,5===d)a.textDecoration=null!=(f=a.textDecoration)?f:1,o=r-3-2*n,O.prototype.Pge.call(this,t,s,e,w,--o,r/2,1+n,v,a,p,b);else for(y=0;y<m;y++)t.fillText(s[y],e+l,w),M=t.measureText(s[y]).width,(C=a.textDecoration)&&this.le(t,C,e+l,w,M,p,b),w+=v},E.prototype.IY=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,h,m,g,p,b,w,a,u,y,c=a.hAlign,f=a.vAlign,l=u.lineHeight,d=s.length,m=0,g=0,b=0,w=0;for(2!==c&&(b=1),2===a.vAlign&&(w=-2.5),w-=C(0,Math.round(l/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),a=u.fontInfo.fontSize,u=A((a-12)/21+1),t.lineWidth=u,t.beginPath(),y=0;y<d;y++)h=t.measureText(s[y]).width,h=(v=b+e+(p=z(new M.Rect(e,i,r,o),h,l*d,c,f,n)).x)+h,m=w+i+p.y+l,A(m)===m&&(m+=.5),g=m,t.moveTo(v,m),t.lineTo(h,g),t.stroke(),w+=l},E.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,n,c,f,l,h,d,v,m,g,g,h,d,p,v,m,l,g,b,s=this;if(t&&(n=s.getText(n,u),!w(n))){for(c=(n+="").split(/\r\n|\r|\n/),f=0;f<c.length;)c[f]=c[f].replace(/\s+/g," "),f++;n=c.join("\r\n"),l=!1,h=u.sheet.Ut,d=u.row,v=u.col,m=u.sheetArea,(g=h.getValueForKey(d,v,k,m))&&(s._id===g.id?l=g.visited:h.do("setValueForKey",d,v,k,void 0,m)),t.save(),t.beginPath(),(g=l?s._visitedLinkColor:s._linkColor)&&t.fillStyle!==g&&(t.fillStyle=g),(h=a.font)&&t.font!==h&&M.mt.bt(t,h),d=R(a),u.sheet.outlineColumn&&u.sheet.outlineColumn.Un(u.col)&&(d=0),v=[],l=m=0,(p=a.wordWrap)||5===a.hAlign?(g=r-3-d,5===a.hAlign&&(g-=d),1<(m=(v=M.q.un(n,--g,h)).length)&&0!==a.vAlign&&(l=(m-1)*(b=u.lineHeight))):v.push(n),t.rect(e,i,r,o),t.clip(),t.beginPath(),s.AY(t,d,e,i,r,o,a,u,v,l),5!==a.hAlign&&s.IY(t,d,e,i,r,o,a,u,v),t.restore()}},E.prototype.getText=function(t,n){var e=this._text||t;return e=(w(e)||""===e)&&n.sheet&&n.sheet.getActualText?n.sheet.getActualText(t,n):e},E.prototype.j3=function(t,n,e,i){var r;t.Ai||(r=t.parent)&&r.j3(t,n,e,i)},E.prototype.getHitInfo=function(t,n,e,i,r){var o,a,o=this;return r&&(a=r.sheetArea,w(a)&&(a=3),e)&&i?{x:t,y:n,row:r.row,col:r.col,cellStyle:e,cellRect:i,sheetArea:a,isFocusAware:!0,sheet:r.sheet,isReservedLocation:K(t,n,e,i,r,o._text)}:c},E.prototype.processMouseDown=function(t){var n=t&&t.sheet,e=this;n&&!n.isEditing()&&t.isReservedLocation&&(e.xY=!0)},E.prototype.processMouseUp=function(t){var n,n,n=t&&t.sheet;n&&!n.isEditing()&&(n=this,t.isReservedLocation&&n.xY&&n.NY(t),n.xY=!1)},E.prototype.processMouseMove=function(t){var n,e,i,r,n,n=t.row,e=t.col,i=t.sheet,r=this;!i||i.isEditing()&&i.getActiveRowIndex()===n&&i.getActiveColumnIndex()===e||(n=i.Dg(),t.isReservedLocation?n&&(r.kY(i,t),n.style.cursor="pointer"):(r.DY(i),n&&(n.style.cursor=N)))},E.prototype.processMouseLeave=function(t){var t,n,n,t=t.sheet,n=this;n.xY=!1,n.DY(t),t&&(n=t.Dg())&&(n.style.cursor=N)},E.prototype.kY=function(t,n){var e,i,r,e,o,e,n,e=this;e._linkToolTip&&((i=e._Y()).className="gc-spread-hyperlink-celltype-tooltip",(r=a(i)).text(e._linkToolTip),o=(e=t.rt.it()).left+n.x,e=e.top+n.y+20,0===r.parent().length)&&((n=t&&t.qc())&&n.insertBefore(i,c),r.css(m,e).css(I,o))},E.prototype.DY=function(t){var n,t,n=this;n.EY&&((t=t&&t.qc())&&n.EY.parentElement===t&&H(t,n.EY),n.EY=c)},E.prototype._Y=function(){var t,n,t=this;return t.EY||(n=r(G),a(n).css(l,h).css(d,0).css(b,2).css(y,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(x,B).css(L,P).css(v,"9pt Arial"),t.EY=n),t.EY},E.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},E.prototype.processKeyUp=function(t,n){var e,i;return!!n.sheet&&(this.NY(n),!0)},E.prototype.getAutoFitWidth=function(t,n,e,i,r){return X(this._text||t,e,i,r,!0)},E.prototype.getAutoFitHeight=function(t,n,e,i,r){return X(this._text||t,e,i,r)},E.prototype.isImeAware=function(t){return!1},E.prototype.NY=function(t){var n,e,i,r,o,a,n=t&&t.sheet,e=this,i=t.row,r=t.col,o=t.sheetArea,a;e.onClickAction().call(this,t),n.Ut.do("setValueForKey",i,r,k,{id:e._id,visited:!0},o),n.repaint(n.getCellRect(i,r,1===o?-1:c,2===o?-1:c)),e.j3(n,i,r,o)},E.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},E.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&U[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},E.prototype.toJSON=function(){var e,i,r,e=this,i={typeName:e.typeName};return s(_,function(t,n){(r=e["_"+t])!==n&&(i[t]=r)}),i},E.prototype.fromJSON=function(e){var i=this;s(_,function(t){var n=e[t];w(n)||(i["_"+t]=n)})},E.prototype.jn=function(t){},E.prototype.Ke=function(){var e,i,r,e=this,r=new E;return s(_,function(t,n){(i=e["_"+t])!==n&&(r["_"+t]=i)}),r._onAction=e._onAction,r},D=E,t.HyperLink=D,s(_,function(n){D.prototype[n]=function(t){return 0===arguments.length?this["_"+n]:(this["_"+n]=t,this)}}),M.CellTypes.ti[8]=D},"./dist/plugins/celltype/radiochecklistcelltype.js":function(M,t,n){"use strict";var e,G,n,C,S,U,H,c,nt,l,f,h,d,et,n,i,a,V,z,w,T,o,Y,Z,W,u,r,i,n,A,s,v,I,i,i,x,N,k,m,g;function Q(t,n){return t.hasOwnProperty(n)}function p(t,n){return t instanceof Date&&n instanceof Date?S(t)===S(n):!d(t)&&!d(n)&&t.toString&&n.toString?t.toString()===n.toString():t===n}function _(t){var n,t,e,i,r,n=["0","0","0","0"];return typeof t===T&&(r=i=void 0,1===(e=(t=t.split(" ",4)).length)?n=[i=t[0],i,i,i]:2===e?n=[i=t[0],r=t[1],i,r]:3===e?(r=t[1],n=[t[0],r,t[2],r]):4===e&&(n=[t[0],t[1],t[2],t[3]])),n}function b(){var t,e,t=x.call(this)||this;return t.typeName="11",t.defaultPadding=5,e=t,a(u,function(t,n){e["_"+t]=n="items"===t?[]:n}),t}function D(){return null!==N&&N.apply(this,arguments)||this}function j(){var t=null!==k&&k.apply(this,arguments)||this;return t.typeName="12",t}function y(){var t,e,t=g.call(this)||this;return t.typeName="13",t.defaultPadding=0,e=t,a(s,function(t,n){e["_"+t]=n="items"===t?[]:n}),e._boxSize=0,delete e.boxSize,t}function O(t,n,e,i,r,o){var a,a,r,a=n.getValue(e,i,o),a=t.wG(a,r),r={cmd:"editCell",sheetName:n.name(),row:e,col:i,newValue:a,autoFormat:!1};n.Qy().execute(r),t.triggerButtonClicked(n,e,i,o)}function J(t,n,e,i,r){var n,o,e,a,u,n=n.zoom(),o=X(t._boxSize,e.font,n),e=rt(t,e),a,u=i;return H(e,o)*(u=t._items.length<i?t._items.length:u)+t._itemSpacing.vertical*n*(u-1)}function K(t,n,e,i,r){var o,a,u,n,s,o=n.zoom(),a=X(t._boxSize,e.font,o),u=t.defaultPadding*o,n=it(t,n,e,i,r),s=0;return n.forEach(function(t){s+=t}),s+=r*(a+u)+(r-1)*t._itemSpacing.horizontal*o}function it(t,n,e,i,r){for(var o,a,u,u,s,s,o=[],a=0;a<t._items.length;a++)u=Q(t._items[a],z)?t._items[a].text:t._items[a],u=n.Qt(u,e.font),(s=t.jY()).hasMargin&&(u=u+s.paddingLeft+s.paddingRight),s=U(a%r),o[s=t._direction===Z.vertical?U(a/i):s]=o[s]===h?u:Math.max(o[s],u);return o}function X(t,n,e){var i=Y*e;return"number"==typeof t&&0<=t?i=t*e:"auto"===t&&(i=V(n)/2),i}function rt(t,n){var n,t,n=V(n.font),t=t.jY();return n=t.hasMargin?n+t.paddingTop+t.paddingBottom:n}function q(t,n,e,i){var e,r,e=E(t)*e,r=e;return 1===t.hAlign?r=(n.width-i)/2:2===t.hAlign&&(r=n.width-e-i),r}function $(t,n,e,i){var e,r,e=2*e,r=e;return 1===t.vAlign?n.height-e>i&&(r=(n.height-i-e)/2+e):2===t.vAlign&&(r=n.height-i-e),r}function tt(t,n,e,i,r){var o,a,u,s;if(t._direction===Z.vertical){if(t._isFlowLayout){if(r!==h)for(o=t._items.length;0<o;){if(!(r<(a=J(t,n,e,o,c(t._items.length/o)))))return[o=H(o,1),c(t._items.length/o)];o-=1}return[t._items.length,1]}return[o=H(1,t._maxRowCount),c(t._items.length/o)]}if(t._isFlowLayout){if(i!==h)for(u=t._items.length;0<u;){if(!(i<(s=K(t,n,e,c(t._items.length/u),u))))return u=H(u,1),[c(t._items.length/u),u];u-=1}return[1,t._items.length]}return u=H(1,t._maxColumnCount),[c(t._items.length/u),u]}function E(t){var n=t.textIndent;return 1===t.hAlign||0===n||n===f||n===h?2:8*n}function R(u,s){for(var t,n,c,f,e,e,t,l,h,d,v,m,g,n,t,p,b,i,r,o,t=s.cellRect.width,n=s.cellRect.height,c=s.sheet,f=c.zoom(),e=c.Z_(s.row,s.col),e=e&&e.font,t=tt(u,c,s.cellStyle,t-1,n),l=t[0],h=t[1],d=it(u,c,s.cellStyle,l,h),v=X(u._boxSize,e,f),m=u.defaultPadding*f,g=H(rt(u,s.cellStyle),v),n=K(u,c,s.cellStyle,l,h),t=J(u,c,s.cellStyle,l,h),p=q(s.cellStyle,s.cellRect,f,n),b=$(s.cellStyle,s.cellRect,f,t),i=function(t){var n,n,e,i,r,o,a,e,e,n,n=Q(u._items[t],z)?u._items[t].text:u._items[t],n=c.Qt(n,s.cellStyle.font),e=U(t/h),i=t%h;if(u._direction===Z.vertical&&(e=t%l,i=U(t/l)),r=new G.Rect,o=0,(a=d.filter(function(t,n){return n<i})).forEach(function(t){o+=t}),r.x=p+o+i*(v+m+u._itemSpacing.horizontal*f),r.y=b+e*g+u._itemSpacing.vertical*f*e,e=u.jY(),r.width=(u._textAlign!==W.right||e.hasMargin?d[i]:n)+v+m,r.height=g,e=s.x-s.cellRect.x,n=s.y-s.cellRect.y,r&&r.contains(e,n))return{value:{value:Q(u._items[t],w)?u._items[t].value:u._items[t]}}},r=0;r<u._items.length;r++)if("object"==typeof(o=i(r)))return o.value}function F(t,n){var e,i,r,e=!1,i=Q(t,w)?t.value:t;if(n!==f)if(Array.isArray(n)){for(r=0;r<n.length;r++)if(p(n[r],i)){e=!0;break}}else e=p(n,i);return e}function L(t,n,e,i){var r,o,a,u,s;if(i)return n;for(t===f&&(t=[]),Array.isArray(t)||(t=[t]),r={},e.forEach(function(t){r[Q(t,w)?t.value:t]=!0}),o=t.length-1;0<=o;o--)r[t[o]]||t.splice(o,1);if(-1===(u=(a=t.slice()).indexOf(n)))a.push(n);else for(o=a.length-1;0<=o;o--)p(a[o],n)&&a.splice(o,1);return s=[],e.forEach(function(t){-1!==a.indexOf(t.value)&&s.push(t.value)}),s}e=this&&this.__extends||(I=function(t,n){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,G=n("Core"),n=n("Common"),C=n.Common.lt.tv,S=n.Common.ct.o0,U=Math.floor,H=Math.max,c=Math.ceil,nt="left",l="alphabetic",f=null,h=void 0,d=n.Common.lt.ht,et=G.mt.bt,n=G.CellTypes.Base,i=G.GC$,a=i.each,V=G.mt.vt,z="text",w="value",T="string",o="number",Y=12,(i=Z=t.Direction||(t.Direction={}))[i.horizontal=0]="horizontal",i[i.vertical=1]="vertical",(i=W=t.TextAlign||(t.TextAlign={}))[i.left=2]="left",i[i.right=3]="right",u={items:f,direction:Z.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:W.right,boxSize:Y},e(b,x=n),b.prototype.paintValue=function(t,n,e,i,r,o,a,u){var s,c,F,f,l,h,d,v,m,g,p,b,h,w,y,M,C,S,T,A,I,d,x,N,L,k,_,D,j,O,E,R,R,B,P,s=this;if(t){for(t.save(),t.rect(e+1,i+1,r-2,o-2),t.clip(),t.beginPath(),F=c=0,l=(f=u.sheet).zoom(),h=a.font,d=u.isPrinting,v=u.printZoomFactor,m=X(s._boxSize,h,l=d&&"number"==typeof v&&1!==v?v:l),g=s.defaultPadding*l,p=m/2,b=new G.Rect(e+1,i+1,r-2,o-2),M=K(s,f,a,w=(h=tt(s,f,a,r-2,o-2))[0],y=h[1]),C=J(s,f,a,w,y),S=it(s,f,a,w,y),T=rt(s,a),A=e+q(a,b,l,M),I=i+$(a,b,l,C),(d=a.font)&&t.font!==d&&et(t,u.fontInfo.font),a.foreColor&&(t.fillStyle=a.foreColor),x=a.textDecoration,L=8<(N=u.fontInfo.fontSize)?U((N-8)/5+2):1,k=0,k=(F=V(a.font))/2-N/2+L-1,_=A,D=I,O=j=0,m<N&&(j=s.OY(m),O=(T-k-Y)/2+1),E=0;E<s._items.length;E++)e+r<A||i+o<I||(R=Q(s._items[E],z)?s._items[E].text:s._items[E],c=f.Qt(R,a.font),t.textAlign=nt,R=s._direction===Z.vertical?S[U(E/w)]:S[E%y],B=0,B=s._textAlign===W.left?(s.RY(t,s._items[E],n,c,A,I+j,R,T,k),A=A+R+g,t.save(),s.BY(t,n,s._items[E],A,I+O,p),t.restore(),m):(t.save(),s.BY(t,n,s._items[E],A,I+O,p),A=A+m+g,t.restore(),s.RY(t,s._items[E],n,c,A,I+j,R,T,k),R),x&&(P=this.jY(),s.le(t,x,A-(s._textAlign===W.right?0:R+g)+P.paddingLeft,I+T-k-P.paddingBottom,c,N,L)),s._direction===Z.vertical?(I+=H(T,m)+s._itemSpacing.vertical*l,(E+1)%w==0&&(_=_+R+m+g+s._itemSpacing.horizontal*l,I=i+$(a,b,l,C)),A=_):(A=A+B+s._itemSpacing.horizontal*l,(E+1)%y==0&&(A=e+q(a,b,l,M),D=D+H(T,m)+s._itemSpacing.vertical*l),I=D));t.restore()}},b.prototype.OY=function(t){return(t-Y)/2},b.prototype.getText=function(t,n){return t},b.prototype.RY=function(t,n,e,i,r,o,a,u,s){var n=Q(n,z)?n.text:n;t.textBaseline!==l&&(t.textBaseline=l),t.fillText(n,r,o+u-s)},b.prototype.getItemsBound=function(u,t,n,e){var s,c,f,i,r,o,a,l,t,n,e,h,d,v,m,g,p,t,n,b,w,y,M,C,s=this,c=u.zoom(),f=u.getActualStyle(t,n,e),i,r=G.W.V("11pt "+u.currentTheme().bodyFont(),c);for(f.font&&(r=G.W.Lge(f,c)),f.font=r.font,t=(l=u.getCellRect(t,n,o=1===e?-1:void 0,a=2===e?-1:void 0)).width,n=l.height,e=tt(s,u,f,t-1,n),h=e[0],d=e[1],v=it(s,u,f,h,d),m=X(s._boxSize,r.font,c),g=s.defaultPadding*c,p=H(rt(s,f),m),t=K(s,u,f,h,d),n=J(s,u,f,h,d),b=q(f,l,c,t),w=$(f,l,c,n),y=[],M=function(t){var n,n,e,i,r,o,a,e,n=Q(s._items[t],z)?s._items[t].text:s._items[t],n=u.Qt(n,f.font),e=U(t/d),i=t%d;s._direction===Z.vertical&&(e=t%h,i=U(t/h)),r=new G.Rect,o=0,(a=v.filter(function(t,n){return n<i})).forEach(function(t){o+=t}),r.x=b+o+i*(m+g+s._itemSpacing.horizontal*c)+l.x,r.y=w+e*p+s._itemSpacing.vertical*c*e+l.y,e=s.jY(),r.width=(s._textAlign!==W.right||e.hasMargin?v[i]:n)+m+g,r.height=p,r.x>l.x+l.width||r.y>l.y+l.height?y[t]=null:y[t]=r},C=0;C<s._items.length;C++)M(C);return y},b.prototype.BY=function(t,n,e,i,r,o){},b.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},b.prototype.getAutoFitWidth=function(t,n,e,i,r){var r,o,a,u,s,r=r&&r.sheet,o=E(e),a=tt(this,r,e),u,s;return(K(this,r,e,a[0],a[1])+o)/i},b.prototype.getAutoFitHeight=function(t,n,e,i,r){var o,r,a,u,o=r&&r.sheet,r=tt(this,o,e,+o.getColumnWidth(r.col)*i),a,u;return J(this,o,e,r[0],r[1])/i},b.prototype.getHitInfo=function(t,n,e,i,r){var o,a,u,t,n,r,a,r,s,o,u,a,c,o=this;return r&&(a=r.sheetArea,u=r.sheet,i=e.cellType.An(i,e,u.zoom()),d(a)||3===a)&&i?(t={x:t,y:n,row:r.row,col:r.col,cellStyle:e,cellRect:i,sheetArea:a,sheet:u},n=u.zoom(),e.font&&(e.font=G.W.Lge(e,n).font),s=K(o,u,e,a=(r=tt(o,u,e,i.width-1,i.height-2))[0],r=r[1]),o=J(o,u,e,a,r),u=i.x+q(e,i,n,s),a=i.y+$(e,i,n,o),(c=new G.Rect(u,a,s,o)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):f},b.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},b.prototype.processMouseLeave=function(t){if(x.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},b.prototype.processMouseUp=function(t){var n,e,i,r,o,a;return!!t&&(e=t.sheet,!!((n=this).pG&&e&&t.isReservedLocation&&(n.pG=!1,i=t.row,r=t.col,o=t.sheetArea,a=R(n,t))))&&(O(n,e,i,r,a.value,o),!0)},b.prototype.wG=function(t,n){return L(t,n,this._items,!0)},b.prototype.triggerButtonClicked=function(t,n,e,i){var r=t.parent;r&&r.j3(t,n,e,i)},b.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&Z[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&W[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},b.prototype.toJSON=function(){var i,r,o,i=this,r={typeName:i.typeName};return a(u,function(t,n){var e;o=i["_"+t],("items"===t?o&&0<o.length:o!==n)&&(r[t]="object"==typeof o?C(o,!1):o)}),r},b.prototype.fromJSON=function(e){var i=this;a(u,function(t){var n=e[t];d(n)||(i["_"+t]=n)})},e(D,N=r=b),D.prototype.BY=function(t,n,e,i,r,o){var e=Q(e,w)?e.value:e;t.beginPath(),t.fillStyle="white",t.arc(i+o,r+o,o,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(i+o,r+o,o,0,2*Math.PI),t.stroke(),n!==f&&p(n,e)&&(t.beginPath(),t.strokeStyle="black",t.arc(i+o,r+o,.5*o,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=i=D,e(j,k=r),j.prototype.BY=function(t,n,e,i,r,o){t.strokeStyle="black",t.strokeRect(i+.5,r+.5,2*o+.05,2*o+.05),t.fillStyle="white",t.fillRect(i+1,r+1,2*o-1,2*o-1);var e=F(e,n);n!==f&&e&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(i+3,r+o),t.lineTo(i+o,r+2*o-3.5),t.lineTo(i+2*o-1.5,r+3),t.stroke())},j.prototype.wG=function(t,n){return L(t,n,this._items,!1)},t.CheckBoxList=n=j,(m=A=t.SelectionMode||(t.SelectionMode={}))[m.single=0]="single",m[m.multiple=1]="multiple",s={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:f,itemSpacing:{horizontal:5,vertical:5},selectionMode:A.multiple},e(y,g=r),y.prototype.RY=function(t,n,e,i,r,o,a,u,s){var e,n,c,f,e;t.save(),t.beginPath(),e=F(n,e),n=Q(n,z)?n.text:n,c=this._selectedBackColor,f=this._selectedForeColor,e&&(t.fillStyle=c,t.fillRect(r+1,o+1,a-1,u-1),t.fillStyle=f),t.textAlign="center",t.textBaseline!==l&&(t.textBaseline=l),e=this.jY(),t.fillText(n,r+e.paddingLeft+(a-e.paddingLeft-e.paddingRight)/2,o+e.paddingTop+u-e.paddingTop-e.paddingBottom-s),t.restore()},y.prototype.wG=function(t,n){return L(t,n,this._items,this._selectionMode===A.single)},y.prototype.jY=function(){var t,n,e,i,r,t=0,n=0,e=0,i=0;return this._padding&&(r=_(this._padding),t=typeof(t=parseInt(r[0],10))==o&&0<t?t:0,i=typeof(i=parseInt(r[1],10))==o&&0<i?i:0,n=typeof(n=parseInt(r[2],10))==o&&0<n?n:0,e=typeof(e=parseInt(r[3],10))==o&&0<e?e:0),{hasMargin:!0,paddingTop:t,paddingBottom:n,paddingLeft:e,paddingRight:i}},y.prototype.OY=function(t){return 0},y.prototype.toJSON=function(){var i,r,o,i=this,o=g.prototype.toJSON.call(this);return a(s,function(t,n){var e;r=i["_"+t],("items"===t?r&&0<r.length:r!==n)&&(o[t]="object"==typeof r?C(r):r)}),o},y.prototype.fromJSON=function(e){g.prototype.fromJSON.call(this,e);var i=this;a(s,function(t){var n=e[t];d(n)||(i["_"+t]=n)})},v=y,t.ButtonList=v,a(u,function(u){r.prototype[u]=function(t){var n,e,i,r,o,a,a,a,n="_"+u,e=this;if(0===arguments.length)return e[n];if("items"===u){for(i=[],r=0;r<t.length;r++)o=t[r],d(o.text)||d(o.value)?d(o.text)?d(o.value)?d(o)||"object"==typeof o||i.push({text:o,value:o}):(o.text=o.value,i.push(o)):(o.value=o.text,i.push(o)):i.push(o);t=i}if("itemSpacing"===u)a=e[n],e[n]={horizontal:a.horizontal,vertical:a.vertical},d(t.horizontal)||(a=parseInt(t.horizontal,10),isNaN(a))||(e[n].horizontal=a),d(t.vertical)||(a=parseInt(t.vertical,10),isNaN(a))||(e[n].vertical=a);else if("boxSize"===u){if(d(t))return e[n];"number"==typeof t&&0<=t&&(e[n]=t),"auto"===t&&(e[n]=t)}else e[n]=t;return e}}),G.CellTypes.ti[11]=i,G.CellTypes.ti[12]=n,a(s,function(u){v.prototype[u]=function(t){var n,e,i,r,o,a,a,a,n="_"+u,e=this;if(0===arguments.length)return e[n];if("items"===u){for(i=[],r=0;r<t.length;r++)o=t[r],d(o.text)||d(o.value)?d(o.text)?d(o.value)?d(o)||"object"==typeof o||i.push({text:o,value:o}):(o.text=o.value,i.push(o)):(o.value=o.text,i.push(o)):i.push(o);t=i}return"itemSpacing"===u?(a=e[n],e[n]={horizontal:a.horizontal,vertical:a.vertical},d(t.horizontal)||(a=parseInt(t.horizontal,10),isNaN(a))||(e[n].horizontal=a),d(t.vertical)||(a=parseInt(t.vertical,10),isNaN(a))||(e[n].vertical=a)):e[n]=t,e}}),G.CellTypes.ti[13]=v},"./dist/plugins/celltype/rangecelltype.js":function(t,n,e){"use strict";var i,pt,r,s,bt,wt,e,yt,Mt,Ct,a,u,i,o,c;function h(t){return t.map(function(t){return{start:t.start,size:t.size}})}function f(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function l(){}function d(t,n,e,i,r){var o,n,o=c.call(this)||this;return o.allowOverflow=!1,o.typeName="16",n=1===arguments.length?new pt.Range(0,0,t.getRowCount(),t.getColumnCount()):new pt.Range(n,e,i,r),t&&n&&(o.GY=(new a).yN(t,n),o.UY=(new u).yN(t,n)),o}function v(t,n,F,e,i,r,L){var o,a,u,s,c,B,f,P,G,l,h,d,U,v,H,V,z,m,g,p,Y,n,b,Z,w,W,Q,J,K,X,q,y,$,tt,M,C,S,T,C,nt,A,I,x,N,k,_,D,C,N,k,et,it,rt,j,O,ot,at,ut,st,ct,ft,E,T,k,lt,k,T,R,ht,dt,vt,mt,gt,R;for(void 0===L&&(L=1),o=n.x,a=n.y,u=n.width,s=n.height,c=e.sheet,B=e.sheetArea,f=e.isPrinting,P=e.needTopGridline,G=e.needLeftGridline,l=[],h=[],d=[],U=!0,v=[],H=c.BO(),V=r.rowCount,z=r.colCount,m=r.rowSize,g=r.colSize,p=r.cellStyleList,Y=r.sparklines,i.HY(F),b=(n=i.zY()).baseRow,Z=n.baseCol,W=(w=i.VY).hl,w.cg(new pt.Rect(0,0,u,s)),(Q=new pt.Yx(w,w._y(1,3),w.Yy(1,3),3)).JCe.oTe(!0),J=i.YY(!0),a+=1,--s,o+=1,--u,X=K=0,m=m.map(function(t){var n=t.size*s,e=Ct(n);return 1<=(X+=n-e)&&(e++,X--),{start:Ct(t.start*s),size:e}}),g=g.map(function(t){var n=t.size*u,e=Ct(n);return 1<=(K+=n-e)&&(e++,K--),{start:Ct(t.start*u),size:e}}),q=w.conditionalFormats,y=0;y<V;y++){for($={row:y+b,y:a,height:s},tt=[],M=0;M<z;M++)if(p[y][M]&&(S=(C=p[y][M]).style,T=C.isSpan,C=C.span,nt=!1,A=J[y][M],!T||C)){if(S=S.clone(!0),I=Ct(o+g[M].start),x=Ct(a+m[y].start),k=N=void 0,_=T?C.colCount:1,D=T?C.rowCount:1,N=g[M+_]?g[M+_].start:u,C=Ct(N-g[M].start),k=m[y+D]?m[y+D].start:s,N=Ct(k-m[y].start),$.y=x,$.height=N,A.formatStyle&&(A.formatStyle.h5(S),S=A.formatStyle),S.v5(W),k=Mt,T){for(k={row:y,col:M,x:Ct(I),y:Ct(x),width:Ct(C),height:Ct(N),rowCount:D,colCount:_},et={},it={},rt=[],O=j=void 0,j=at=ot=0;j<_-1;j++)st=(ut=g[M+j])?ut.size:0,ot+=it[j]=st;for(it[j]=Ct(C)-ot,O=0;O<D-1;O++)st=(ct=m[y+O])?ct.size:0,at+=et[O]=st;for(et[O]=Ct(N)-at,O=0;O<D;O++){for(ft=[],E=0;E<_;E++)p[O+y]&&p[O+y][M+E]&&ft.push(p[O+y][M+E].style);rt.push(ft)}k.spanSizeInfo={styleList:rt,rowSizes:et,colSizes:it}}Q.PN(y,M,Ct(I),Ct(x),Ct(C),Ct(N),S,k,P&&0===y,G&&0===M),(T=S.formatter)&&pt.util.St(T)&&(!(k=c.parent&&c.parent.xO(T))||!(lt=k.getExpression())||(k=(0,wt.evaluateFormula)(c,T.replace("@",JSON.stringify(A.value))))instanceof bt.CalcError||(A.value=k)),T=null,Y[y][M]&&(T=Y[y][M].clone())&&(T.ZY=w.name(),T.WY=T.QY(w),T.KY=T.JY(w),T.XY=w),A&&A.value&&"SparklineExValue"===A.value.typeName&&(v.push({value:A.value,x:I,y:x,width:C,height:N,option:e}),nt=!0),A.validStyle&&h.push({style:A.validStyle,x:I,y:x,width:C,height:N}),tt.push({col:M+Z,x:I,y:x,width:C,height:N}),l.push({data:nt?null:A.value,row:y,col:M,x:I,y:x,width:C,height:N,style:S,sparkline:T,baseRow:y+b,baseCol:M+Z,conditionalFormats:q,imageLoader:H,cellLayout:{row:y,col:M,x:I,y:x,width:C,height:N}}),S&&S.decoration&&S.decoration.icons&&0<S.decoration.icons.length&&d.push({style:S,x:I,y:x,width:C,height:N})}0<tt.length&&w.Dn.mfe(d,tt,$,f,c,B)}for(t.save(),P&&(a-=2,s+=4),G&&(o-=2,u+=4),t.rect(o,a,u,s),t.clip(),0<l.length&&w.Dn.eO(t,l,B,f,1,c,b,Z,L),Q.paint(t),0<h.length&&w.Dn.EO(t,h),0<d.length&&w.Dn.que(t,d,{isPrinting:f,printZoomFactor:1,sheet:c,imageLoader:H}),t.restore(),y=0;y<v.length;y++)ht=(R=v[y]).value,dt=R.x,vt=R.y,mt=R.width,gt=R.height,R=R.option,yt.dn(t,ht,dt,vt,mt,gt,R)}i=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.paintRangeTemplate=n.RangeTemplate=n.qY=n.$Y=void 0,pt=e("Core"),r=e("Bindings"),s=e("Sparkline"),bt=e("CalcEngine"),wt=e("SheetsCalc"),e=pt.CellTypes.Base,yt=pt.CellTypes.Context,Mt=null,Ct=Math.floor,f.prototype.yN=function(t,n){var e=this,i=n.row,r=n.col,o=n.rowCount,a=n.colCount;return e.FY=i,e.PY=r,e.Sx=o,e.Tx=a,e.TP=e.ZF(t,n),e.tZ=e.nZ(t,n),e},f.prototype.eZ=function(){return this.tZ},f.prototype.nZ=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,i,r,g,p,b,e=this,i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=0,s=[],c=0,f=[],l=0,h=i+o,d=r+a,v=i;v<h;v++)l=t.getRowHeight(v),c+=l,f.push(l);for(m=r;m<d;m++)l=t.getColumnWidth(m),u+=l,s.push(l);return l=0,i=f.map(function(t){var n=l/c,e;return l+=t,{start:n,size:t/c}}),l=0,r=s.map(function(t){var n=l/u,e;return l+=t,{start:n,size:t/u}}),g=e.ZF(t,n),{rowCount:o,colCount:a,rowSize:i,colSize:r,cellStyleList:p=e.iZ(t,n,g,i,r),sparklines:b=e.rZ(t,n),totalHeight:c,totalWidth:u}},f.prototype.oZ=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,o=null,a=0,u=r;a<u.length;a++)if(c=(s=u[a]).rowOffset,f=s.colOffset,l=s.rowCount,h=s.colCount,(d=new pt.Range(c+e,f+i,l,h)).contains(t,n)){o=s;break}return o},f.prototype.aZ=function(t,n,e){for(var i,r,o,i,a,u,s,c,f,l,i=[0,0],r=i[0],o=i[1],i=t.rowOffset,a=t.colOffset,u,s,c=i+t.rowCount,f=a+t.colCount,l=i;l<c;l++)o+=n[l]?n[l].size:0;for(l=a;l<f;l++)r+=e[l]?e[l].size:0;return{width:r,height:o}},f.prototype.iZ=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,o=n.row,a=n.col,u=n.rowCount,s=n.colCount,c=[],f=o;f<o+u;f++){for(l=[],h=a;h<a+s;h++)(d=this.oZ(f,h,o,a,e))&&d.rowOffset+o===f&&d.colOffset+a===h?(v=this.aZ(d,i,r),l.push({style:t.getActualStyle(f,h,3,!0),spanWidth:v.width,spanHeight:v.height,isSpan:!0,span:d})):l.push(d?{style:t.getActualStyle(f,h,3,!0),isSpan:!0}:{style:t.getActualStyle(f,h,3,!0)});c.push(l)}return c},f.prototype.ZF=function(t,n){for(var t,e,i,r,o,a,u,s,c,t=t.Ut.getSpans(),e=[],i=n.row,r=n.col,o=n.rowCount,a=n.colCount,u=0,s=t;u<s.length;u++)(c=s[u]).intersect(i,r,o,a)&&e.push({rowOffset:c.row-i,colOffset:c.col-r,rowCount:c.rowCount,colCount:c.colCount});return e},f.prototype.rZ=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=e;u<e+o;u++){for(s=[],c=i;c<i+r;c++)f=t.getSparkline(u,c),s.push(f?f.clone():null);a.push(s)}return a},f.prototype.toJSON=function(){var t,n,e,i,r,o,a,u,t,s,c,f,l,t=this.eZ(),n=t.rowCount,e=t.colCount,i=t.rowSize,r=t.colSize,o=t.cellStyleList,a=t.sparklines,u=t.totalWidth,t=t.totalHeight,s,c,f,l;return{rowCount:n,colCount:e,rowSize:h(i),colSize:h(r),cellStyleList:o.map(function(t){return t.map(function(t){var n,e,i,r,t;return t?(n=t.style,e=t.spanWidth,i=t.spanHeight,r=t.isSpan,t=t.span,{style:n.toJSON(),spanWidth:e,spanHeight:i,isSpan:r,span:t}):null})}),sparklines:a.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:u,totalHeight:t}},f.prototype.fromJSON=function(t){var n,e,i,r,o,a,u,t,i,r,o,a;t&&(n=t.rowCount,e=t.colCount,i=t.rowSize,r=t.colSize,o=t.cellStyleList,a=t.sparklines,u=t.totalWidth,t=t.totalHeight,i=h(i),r=h(r),o=o.map(function(t){return t.map(function(t){var n,e,i,r,t,o;return t?(n=t.style,e=t.spanWidth,i=t.spanHeight,r=t.isSpan,t=t.span,o=null,n&&(o=new pt.Style).fromJSON(n),{style:o,spanWidth:e,spanHeight:i,span:t,isSpan:r}):null})}),a=a.map(function(t){return t.map(function(t){var n,e;if(t&&s.SparklineSetting)return n=new s.Sparkline,e=new s.SparklineSetting(t.setting),n.fromJSON(t.sp),n.setting(e),n.sparklineType(t.sparklineType),n})}),this.tZ={rowCount:n,colCount:e,rowSize:i,colSize:r,cellStyleList:o,sparklines:a,totalWidth:u,totalHeight:t})},f.prototype.L0=function(){this.tZ=null},a=f,n.$Y=a,l.prototype.yN=function(t,n,e){var i=this;return i.Z5=n,i.VY=new pt.Worksheet,i.uZ=t.parent&&t.parent.options.allowDynamicArray,i.VY.getCalcService&&(i.VY.getCalcService().allowDynamicArray=i.uZ,i.sZ=i.cZ(t)),i.fZ(t,e),i},l.prototype.cZ=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,l,n=this.Z5,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=t.b3&&t.b3(),s=e;s<e+o;s++)for(c=i;c<i+r;c++)(f=t.getFormula(s,c))&&(l=u&&u.sT(s,c))&&l.isDynamicArray&&(h=l.row,d=l.col,v=l.rowCount,l=l.colCount,1<v&&a.push({row:h+1,col:d,rowCount:v-1,colCount:l}),1<l)&&a.push({row:h,col:d+1,rowCount:1,colCount:l-1});return a},l.prototype.lZ=function(){var t,n,e,i,r,o,a,u,s,o,t,n=this.sZ,e=this.VY;if(n)for(i=0,r=n;i<r.length;i++)a=(o=r[i]).row,u=o.col,s=o.rowCount,o=o.colCount,e.clear(a,u,s,o,3,1)},l.prototype.HY=function(t){var n,t;r.CellBindingSource&&((n=this.VY).suspendEvent(),t=new r.CellBindingSource(t),this.lZ(),n.setDataSource(t),n.resumeEvent())},l.prototype.fZ=function(t,n){var e,i,t,e,i=this.VY,t=t.toJSON({includeBindingSource:!0,ignoreFormula:!!n});delete t.charts,delete t.shapes,i.suspendCalcService(),i.fromJSON(JSON.parse(JSON.stringify(t))),i.resumeCalcService(),this.hZ()},l.prototype.hZ=function(){for(var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t.Z5,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=[],s=[],c=e;c<e+o;c++){for(s=[],f=i;f<i+r;f++)s.push(t.dZ(c,f,3));u.push(s)}this.vZ=u},l.prototype.zY=function(){var t=this.Z5,n,e;return{baseRow:t.row,baseCol:t.col}},l.prototype.YY=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n=this.VY,e=this.Z5,i=e.row,r=e.col,o=e.colCount,a=e.rowCount,u=[],s=i;s<i+a;s++){for(c=[],l=f=void 0,h=r;h<r+o;h++)d=n.getText(s,h),v=n.getValue(s,h,3,1),m=n.Jt.$t(s,h,3,1),g=n.getBindingPath(s,h),f=this.mZ(s,h,3),l=this.gZ(n,s,h,v,t),c.push({value:m,formatStyle:f,text:d,validStyle:l,bindingPath:g});u.push(c)}return u},l.prototype.dZ=function(t,n,e){var i,t,i;return this.VY.b8&&(t=this.VY.getDataValidator(t,n,e))?t.highlightStyle():null},l.prototype.gZ=function(t,n,e,i,r){var r,t,i;return r&&t.isValid&&!t.isValid(n,e,i)?(t=(r=this.Z5).row,i=r.col,this.vZ[n-t][e-i]):null},l.prototype.mZ=function(t,n,e){var i=this.VY.conditionalFormats;return i?i.bL(new pt.Style,t,n,e):null},l.prototype.getCellValueInfo=function(t){for(var n,e,i,r,o,a,u,s,c,f,n=this.Z5,e=n.row,i=n.col,r=n.colCount,o=n.rowCount,a=[],u=t.Ut,s=e;s<e+o;s++){for(c=[],f=i;f<i+r;f++)c.push({bindPath:t.getBindingPath(s,f),formula:t.getFormula(s,f),value:u.getValue(s,f,3,Mt,1)});a.push(c)}return a},l.prototype.setValueToDataStruct=function(t,n,e,i){i[t]||(i[t]={}),i[t][n]=e},l.prototype.toJSON=function(){var t,n,e,i,r,o,a,u,t=this.VY,n=this.uZ,e=this.sZ.map(function(t){var n,e,i,r;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),i=this.Z5,r,o,a,u;return{spillRanges:e,allowDynamicArray:n,range:{row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},l.prototype.fromJSON=function(t){var n,e,t,i,r,o,t;t&&((e=(n=this).VY=new pt.Worksheet).suspendCalcService&&e.suspendCalcService(),n.sZ=t.spillRanges||t.spillRangs,n.uZ=t.allowDynamicArray,e.getCalcService&&(e.getCalcService().allowDynamicArray=n.uZ),e.fromJSON(JSON.parse(t.templatejson)),n.lZ(),i=(t=t.range).row,r=t.col,o=t.rowCount,t=t.colCount,n.Z5=new pt.Range(i,r,o,t),this.hZ(),e.resumeCalcService)&&e.resumeCalcService()},l.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},u=l,n.qY=u,i(d,c=e),d.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},d.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},d.prototype.updateTemplate=function(t,n){t&&n&&(this.GY.yN(t,n),this.UY.yN(t,n))},d.prototype.paintContent=function(t,n,e,i,r,o,a,u){var s,c,c,s=this.UY,c=this.GY;s&&c&&(c=this.GY.eZ(),a.cellPadding&&(u.needTopGridline=!0,u.needLeftGridline=!0),v(t,{x:e,y:i,width:r,height:o},n,u,s,c))},d.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},d.prototype.fromJSON=function(t){t.layout&&(this.GY=new a,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new u,this.UY.fromJSON(t.resolver))},n.RangeTemplate=i=d,pt.CellTypes.ti[16]=i,n.paintRangeTemplate=v},"./dist/plugins/comment/comment-actions.js":function(F,t,n){"use strict";var e,i,a,u,r,s,o,n,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k;function _(t,n,e){var i,r,o,i=!1,r=t.Ut.pI.pZ();return!!r&&(o=r.location(),t.Qy().execute({cmd:d,sheetName:t.name(),row:r.bZ,col:r.yZ,oldValue:o.clone(),newValue:new a.Point(o.x+n,o.y+e),propertyName:"location"}))}function D(t){var n=t.comment;n&&(o(t.row)||o(t.col))&&(t.row=n.bZ,t.col=n.yZ)}function j(t,n){var e=x.call(this)||this;return D(n),e.Mf=t,e.tT=n,e}function O(t,n){var e=N.call(this)||this;return D(n),e.Mf=t,e.tT=n,e}function E(t,n){var e,i,r;if((n?t.canUndo():t.canExecute())&&(e=t.wZ)){for(i=0;i<e.length;i++)(r=e[i])&&(n?r.undo():r.execute());return!0}return!1}function R(t,n){var e,i,r,o,e=k.call(this)||this,i=e;if(i.wZ=[],i.Mf=t,r=(i.tT=n).commands)for(o=0;o<r.length;o++)i.add(r[o]);return e}e=this&&this.__extends||(I=function(t,n){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CommentPropertyUndoAction=t.CommentDeleteUndoAction=void 0,i=n("Common"),a=n("Core"),u=n("Core"),r=a.GC$,s=a.Events,o=i.Common.lt.ht,n=u.Commands.ActionBase,c="deleteComment",f="deleteCommentByKey",l="deleteCommentByBackspaceKey",h="deactivateComment",d="moveComment",v="moveCommentUp",m="moveCommentDown",g="moveCommentLeft",p="moveCommentRight",b="changeComment",w="changeCommentTransaction",y=null,M=u.Commands.zA,e(j,x=n),j.prototype.execute=function(){var t,n,e,i,r,o,o,t=this;return!!t.canExecute()&&(n=t.Mf,t.X5(n,!0),e=n.comments.get(t.tT.row,t.tT.col),r=(i=n.Ut).pI,o={sheet:n,sheetName:n.name(),comment:e,cancel:!1},n.ki(s.CommentRemoving,o),o.cancel||(i.startTransaction(),r.remove(e.bZ,e.yZ),r.MZ=y,n.cR(),n.ki(s.CommentRemoved,{sheet:n,sheetName:n.name(),comment:e}),o=u.Commands.TI(n.name()),t.tT[o]=i.endTransaction()),t.q5(n,!0),!0)},j.prototype.undo=function(){var t,n,e,t=this,n=t.Mf;return t.X5(n,!0),e=u.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),n.e4(),t.q5(n,!0),!0},t.CommentDeleteUndoAction=C=j,e(O,N=n),O.prototype.execute=function(){var t,n,e,i,r,t=this,n=t.tT,e=t.Mf,i=e.comments.get(n.row,n.col);return!(!t.canExecute()||!i||(t.X5(e,!0),i[r=n.propertyName](n.newValue),"location"===r&&(n.displayMode?i.displayMode(n.displayMode):n.displayMode=i.displayMode()),t.q5(e,!0),0))},O.prototype.undo=function(){var t,n,e,i,t=this,n=t.tT,e=t.Mf;return t.X5(e,!0),!!(i=e.comments.get(n.row,n.col))&&(i[n.propertyName](n.oldValue),t.q5(e,!0),!0)},O.prototype.toJSON=function(){return this.tT},t.CommentPropertyUndoAction=S=O,u.Commands.ChangeComment=S,e(R,k=n),R.prototype.execute=function(){return E(this,!1)},R.prototype.undo=function(){return E(this,!0)},R.prototype.add=function(t){this.wZ.push(t)},T=R,u.Commands[f]={canUndo:!1,execute:function(t,n){var t,n,t=u.Commands.Tp(t,n),n=t.Ut.pI.pZ();return!!n&&t.Qy().execute({cmd:c,sheetName:t.name(),row:n.bZ,col:n.yZ})}},u.Commands[h]={canUndo:!1,execute:function(t,n){var t,n,t=u.Commands.Tp(t,n),n=t.Ut.pI;return!!n.pZ()&&(n.CZ(),t.cR(),t.repaint(),!0)}},u.Commands[v]={canUndo:!1,execute:function(t,n){var e;return _(u.Commands.Tp(t,n),0,-1)}},u.Commands[m]={canUndo:!1,execute:function(t,n){var e;return _(u.Commands.Tp(t,n),0,1)}},u.Commands[g]={canUndo:!1,execute:function(t,n){var e;return _(u.Commands.Tp(t,n),-1,0)}},u.Commands[p]={canUndo:!1,execute:function(t,n){var e;return _(u.Commands.Tp(t,n),1,0)}},u.Commands[c]={canUndo:!0,execute:function(t,n,e){return M(t,C,n,e)}},u.Commands[d]={canUndo:!0,execute:function(t,n,e){return M(t,S,n,e)}},u.Commands[b]={canUndo:!0,execute:function(t,n,e){return M(t,S,n,e)}},u.Commands[w]={canUndo:!0,execute:function(t,n,e){return M(t,T,n,e)}},u.Commands.SZ=A=function(t){t.register(f,u.Commands[f],46,!1,!1,!1,!1),t.register(l,u.Commands[f],8,!1,!1,!1,!1),t.register(h,u.Commands[h],27,!1,!1,!1,!1),t.register(v,u.Commands[v],38,!1,!1,!1,!1),t.register(m,u.Commands[m],40,!1,!1,!1,!1),t.register(g,u.Commands[g],37,!1,!1,!1,!1),t.register(p,u.Commands[p],39,!1,!1,!1,!1),t.register(c,u.Commands[c]),t.register(b,u.Commands[b]),t.register(w,u.Commands[w]),t.register(d,u.Commands[d])}},"./dist/plugins/comment/comment-touch.js":function(t,n,e){"use strict";var i,n,r,a,o,u,s,e,c,f,l,h,d,v,m;function g(t,n){return d.call(this,t,n)||this}function p(t,n,e){return v.call(this,t,n,e,new l(t,n))||this}function b(t,n,e){return m.call(this,t,n,e,new s(t,n))||this}function w(t,n,e,i){var r,o,n,r=this,o=r.TZ=n.TZ;r.AZ=new a.IZ(r),r.xZ=new a.NZ(t,"Comment"+o.bZ+o.yZ,r.AZ,2,200),r.kZ=e,r.DZ=i,(n=r.xZ)._Z=function(){return 3!==o.commentState()},n.EZ=function(){return!0},n.jZ=function(t){return i.OZ(t)},n.RZ=function(t){return i.BZ(t)},n.LZ=function(t){return i.FZ(t)},n.PZ=function(t){return i.GZ(t)},n.UZ=function(t){return i.HZ(t)}}function y(t,n){var e=this;e.zZ=t,e.VZ=n,e.TZ=n.TZ,e.Mf=e.TZ.Mf,e.YZ=new a.ZZ(e.Mf)}i=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n=e("Core"),r=e("./dist/plugins/comment/comment.js"),a=e("Touch"),n.Of.touch&&(o=n.GC$,u=n.mt.vi,y.prototype.WZ=function(t){var t,n,e,t=new a.QZ(t.X,t.Y),n=o(this.zZ).offset();return n&&(e=document.body,t.X+=n.left+e.clientLeft||0,t.Y+=n.top+e.clientTop||0),t},y.prototype.OZ=function(t){t.KZ=35},y.prototype.BZ=function(t){var n,e,n=this,e=n.WZ(t.JZ);n.VZ.XZ({target:t.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}),n.YZ.$Z()},y.prototype.FZ=function(t){var n,e,i,r,r,i,n=this,e=t.nW.tW,i=n.Mf,r=i.parent;1!==e&&r&&r.options.allowUserZoom?(i.rt.s9=!1,r=n.VZ,o(r.eW).remove(),n.YZ.iW(e)):(i=n.WZ(t.JZ),n.VZ.pg({target:t.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}))},y.prototype.GZ=function(t){var n,e,i,r,r,n=this,e=t.nW.tW,i,r=n.Mf.parent;1!==e&&r&&r.options.allowUserZoom?n.YZ.rW(e):(r=n.WZ(t.JZ),n.VZ.bg({target:t.qZ,isTouch:!0,button:0,pageX:r.X,pageY:r.Y,stopPropagation:function(){}}))},y.prototype.HZ=function(t){var n=this,e=n.TZ,n=n.Mf;try{n.suspendPaint(),3===e.commentState()?e.commentState(1):1===e.commentState()&&e.commentState(2)}finally{n.resumePaint()}},s=y,w.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},w.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},w.prototype.sW=function(t){return this.AZ.sW()},w.prototype.cW=function(t){return this.AZ.cW()},w.prototype.fW=function(t){return this.AZ.fW()},i(b,m=e=w),c=b,i(p,v=e),f=p,i(g,d=s),g.prototype.BZ=function(t){var n,e,n=this,e=n.WZ(t.JZ);n.VZ.lW({target:t.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}),n.YZ.$Z()},l=g,r.hW.ch("touch",{init:function(t){var n,e,i,n=this,e,i=n.TZ.Mf.parent.kZ;n.dW=new c(t[0],n,i),n.dW.oW(),n.vW=new f(t[1],n,i),n.vW.oW()},detachEditor:function(t){var n=this,e=n.TZ.Mf;n.vW=new f(t,n,e.parent.kZ),n.vW.oW()},preProcessMouseDownEdit:function(t){var n,e,n=t.e,e=this.vW;e&&!n.isTouch&&e.sW(n)&&(u(n),t.r=!0)},preProcessMouseDownDragResize:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.sW(n)&&(u(n),t.r=!0)},preProcessMouseMove:function(t){var n,e,i,r,n=t.e,e=n.isTouch,i=this.dW,r=this.vW;i&&!e&&i.fW(n)&&(u(n),t.r=!0),r&&!e&&r.fW(n)&&(u(n),t.r=!0)},preProcessMouseUp:function(t){var n,e,i,r,n=t.e,e=n.isTouch,i=this.dW,r=this.vW;i&&!e&&i.cW(n)&&(u(n),t.r=!0),r&&!e&&r.cW(n)&&(u(n),t.r=!0)},dispose:function(){var t=this;t.dW.uW(),t.dW=null,t.vW.uW(),t.vW=null}}))},"./dist/plugins/comment/comment.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/comment/comment.js"),n),r(e("./dist/plugins/comment/comment-actions.js"),n),e("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(i,t,L){"use strict";var B,s,A,P,h,d,G,I,x,U,T,H,L,r,V,z,Y,g,Z,c,W,N,Q,J,K,X,q,$,tt,l,nt,et,S,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,p,b,St,Tt,v,m,o,a,u,At,It,xt,Nt,kt,_t,Dt,f,w,jt,Ot,Et,y,M,C,k,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,_,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,D,vn,mn,gn,pn,bn,wn,yn,Mn,Cn,Sn,Tn,n,An,In,n,n,n;function j(t,n){return new A.Point(t,n)}function O(t,n,e,i){return new A.Rect(t,n,e,i)}function E(t){return t.height}function R(t){return t.width}function xn(t,n){var e=t.options;return!t.isActualProtected()||e.protectionOptions.allowEditObjects||n&&!n.locked()}function Nn(t,n){var e=t.options;return!t.isActualProtected()||e.protectionOptions.allowEditObjects||n&&!n.lockText()}function kn(t){var n=96,e=72,i=37.7952755905512;try{return-1!==t.indexOf("pt")?parseFloat(t.replace("pt","")):-1!==t.indexOf("in")?72*parseFloat(t.replace("in","")):-1!==t.indexOf("cm")?parseFloat(t.replace("cm",""))*i*72/96:parseFloat(t)}catch(t){return 0}}function _n(t){var n,e,i,r,o,a,u,s,c,f,l,n=t.itemsData,e=t.collapseIndexMap={},i=n.length,c=!1;if(0===t.direction){for(r=i-1;0<=r;r--)if((o=n[r])&&1===o.count&&o.info&&o.info.collapsed){for(a=o.index+o.count,u=r+1;u<i;u++)(s=n[u])&&s.info&&s.info.level>o.info.level&&s.index===a&&(a=s.index+s.count);for(f=o.index+1;f<a;f++)e[f]=!0}}else for(r=0;r<i;r++)if((o=n[r])&&1===o.count&&o.info&&o.info.collapsed){if((a=o.index-1)<0&&-1===o.info.level)break;for(l=r-1;0<=l;l--)(s=n[l])&&s.info&&s.info.level>o.info.level&&s.index+s.count-1===a&&(a=s.index-1);for(f=a+1;f<o.index;f++)e[f]=!0}}function Dn(t,n){var e;return n&&(n.items?n.items[t]&&n.items[t].viewCollapsed:n.itemsData&&(n.collapseIndexMap||_n(n),n.collapseIndexMap[t]))}function jn(t,n,e,i){var t=t[n];return!t||i&&Dn(n,i)?void 0:!1===t.visible||t.size}function On(t,n,e,i){var t=t[n];return!t||i&&Dn(n,i)?void 0:!1===t.visible||t.size}function En(t,e,i){function n(t){var t,n,t,t=S(t,"ClientData");return(!t||"Note"===t.ObjectType)&&(n=parseInt(S(t,"Row").c_[0],10),t=parseInt(S(t,"Column").c_[0],10),n===e)&&t===i}return t.filter(n)[0]}function Rn(t,n){for(var e,i,r,o,a,u,e=t.defaults.rowHeight,i=0,r=0,a=t.getRowCount()||A.XmlConstants.Io;i<n&&r<a;)i+=o=t.Ut.getSize(!0,3,r)||e,r++;return 0<(u=i-n)?(r--,(u=o-u)<0&&(r+=1)):(u=n-i,r+=1),{row:r,rowOffset:u}}function Fn(t,n){for(var e,i,r,o,a,u,e=t.defaults.colWidth,i=0,r=0,a=t.getColumnCount()||A.XmlConstants.xo;i<n&&r<a;)i+=o=t.Ut.getSize(!1,3,r)||e,r++;return 0<(u=i-n)?(r--,(u=o-u)<0&&(r+=1)):(u=n-i,r+=1),{col:r,colOffset:u}}function Ln(t,n){if(!et(n))return"double";if(t)switch(t.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function Bn(t){var n,e;if(t)switch(t.toLowerCase()){case"solid":n="solid";break;case"dotted":n="1 1";break;case"dashed":n="dash";break;case"double":e="thinThin"}return{dashStyle:n,lineStyle:e}}function Pn(t,n){var e,i,r,o,o,r,t,i,e=n.location()||{x:9,y:-18},i=n.bZ,r=n.yZ,o=t.getSpan(i,r);return o&&(r=o.col+o.colCount-1),o=$(t,0,r+1),r=nt(t,0,i),t=["position:absolute"],0<=(i=l(o+e.x+7))&&t.push("margin-left:"+i+"pt"),0<=(i=l(r+e.y+7))&&t.push("margin-top:"+i+"pt"),(i=l(n.width()-14)+"pt")&&t.push("width:"+i),(i=l(n.height()-14)+"pt")&&t.push("height:"+i),t.push("z-index:"+n.zIndex()),t.push("visibility:"+(1===n.displayMode()?"visible":"hidden")),t.join(";")}function Gn(t){var n=A.ColorHelper.convertColorToHex(t);return n&&"string"==typeof n&&2<n.length?"#"+n.substring(2).toLowerCase():t}function Un(t,n){var t=(t||"").trim().split(n);return{key:t[0],value:t[1]}}function Hn(t,n,e,i,r){var o,a,u,s,c,f,l,t,o,a=this.Ut.pI;if(t&&a)for(s=a.all(),c=0;c<s.length;c++)f=(u=s[c]).bZ,l=u.yZ,f===n&&l===e||n<=f&&f<n+i&&e<=l&&l<e+r&&a.remove(f,l);(u=a.get(n,e))&&(t=a.mW(u))&&t.gW()}function Vn(){var t=this,n=t.pW&&t.pW();n&&n.bW(t)}function zn(t,n,e){var i=this,i=i.pW&&i.pW();i&&i.yW(t,n,e)}function Yn(t,n){var e,i,n,e=-1,i=-1;n&&0<=n.rowViewportIndex&&0<=n.colViewportIndex&&(e=n.row,i=n.col),!t.parent||e<0||i<0||(n=t.Ut.pI.get(e,i),t.Ut.pI.wW(n))}function Zn(t,n){return t&&t.getRowHeight(n)}function Wn(t,n){return t&&t.getColumnWidth(n)}function Qn(t,n){return t&&t.getViewportLeftColumn(n)}function Jn(t,n){return t&&t.getViewportTopRow(n)}function Kn(t,n,e,i){var r=this;arguments.length<=1?r.top=r.right=r.bottom=r.left=t||0:(r.top=t,r.right=n,r.bottom=e,r.left=i)}function Xn(t){var n=this;n.bZ=-1,n.yZ=-1,n.text(t||""),n.zIndex(Bt)}function qn(t,n,e){return bn.push(t),s.mt.p0(t,n,$n(t),e)}function $n(t){var r=t;return function(t,n){var e=this,i=e.Mf;i&&(i.Ut.MW({type:"property",comment:e,name:r,value:n,newValue:t}),i.hP()&&i.My<=0&&(i.CW(),"indicatorColor"!==r&&"indicatorSize"!==r||i.repaint(i.getCellRect(e.bZ,e.yZ))),i.ki(c.CommentChanged,{sheet:i,sheetName:i.name(),comment:e,propertyName:r}))}}function te(t,n,e,i,r){var n=O(n,e,i,i);n.cursor=r,t.push(n)}function ne(t,n,e,i){(0,A.GC$)(t.SW).css(n,e),(0,A.GC$)(t.TW).css(n,i)}function ee(t,n){for(var e,i,r,e=t.length,i=0,r=0;r<e;r++)i+=J(t[r],n);return i}function ie(t,n){t&&t.P_(n)}function re(t){var t=t;if(t){if("number"==typeof t)return 400<t;if("string"==typeof t)return-1!==t.toLowerCase().indexOf("bold")||400<parseInt(t,10)}}function oe(t){var t=t;return t&&-1!==["italic","oblique"].indexOf(t.toLowerCase().trim())}function F(t,n){var e,i,i,e=this,i=t&&t.Mf;e.AW=1,e.IW=1,e.TZ=t,e.xW(),e._zoomFactor=i.zoom(),e.NW=n,e.li=n.kW,e.Hc(),i=e.DW(e._W(),t.width(),t.height()),e.EW=j(i.x,i.y),e.jW(),e.OW()}function e(t){var n=this;n.Mf=t,n.RW={BW:!1,x:0,y:0,LW:h,FW:-1},n.kW=h,n.PW=h,n.MZ=h,n.wB=[],n.GW=0,n.UW=[],n.HW(),n.zW(),n.cE={}}function ae(t){var n=this;n.Mf=h,n.VW=!0,n.YW=n.ZW(),t.appendChild(n.YW)}function ue(t,n){if(t){var t=t.trim().toLowerCase();if(-1!==["false"].indexOf(t))return!1;if(-1!==["true"].indexOf(t))return!0}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.hW=t.Comment=t.Padding=t.DisplayMode=t.CommentState=void 0,B=L("Common"),s=L("Core"),A=L("Core"),P=s.Commands,h=null,d=void 0,G=Math.max,I=Math.min,x=Math.floor,U=Math.atan2,T=Math.abs,H="default",L=s.GC$.extend,r=s.mt.En,V=B.Common.Uf,z="comment",Y=s.hi,g=s.Bf,Z=s.mt,c=s.Events,W=Z.vi,N=Z.w0,Q=Z.M0,J=Z.bi,K=parseFloat,X=B.Common.zf,q=s.Lf,$=A.ExcelHelper.getActualColumnWidth,tt=A.ExcelHelper.pointToPixel,l=A.ExcelHelper.pixelToPoint,nt=A.ExcelHelper.getActualRowHeight,et=B.Common.lt.ht,S=A.mt.xr,it=A.mt.go,rt=A.mt.c1,ot=A.mt.n1,at=A.mt.vo,ut=A.mt.d1,st=A.mt.h1,ct=A.IndexHelper.nr,ft=A.Util.wr,lt=A.Util.ho,ht=7,dt=document,vt=window,mt=A.UsedRangeUtil.vh,gt=A.XFileConstants.Rr,pt=A.XFileConstants.Lr,bt=A.XFileConstants.ou,yt="mouse",Mt="move",Ct="DOMMouseScroll",p="left",b="top",St="right",Tt="bottom",v="width",m="height",o="position",a="absolute",u="overflow",At="visible",It="z-index",xt="hidden",Nt="box-sizing",kt="content-box",_t="padding",Dt="px",f="div",w=".comment",jt=".floatBlockCanvas",Ot=".hostContainer",Et=".lineCanvasContainer",y=".host",M=".editor",C="gc-spread-",k="className",Rt="cursor",Ft="text",Lt=701,Bt=898,Pt="gc-no-user-select",Gt=" ",Ut="unselectable",Ht="on",Vt="comment_editor",zt="comment_indicator",Yt="font-family",Zt="font-style",Wt="font-size",Qt="font-weight",Jt="color",Kt="textArea",Xt=".lineCanvas",qt=".commentDocument",_="-resize",$t="line-height",tn="background-color",nn="text-align",en="mousedown",rn="mousemove",on="mouseup",an="mousewheel",un="text-decoration",sn="black",(n=cn=cn||{})[n.none=0]="none",n[n.single=1]="single",n[n.double=2]="double",n[n.singleaccounting=3]="singleaccounting",n[n.doubleaccounting=4]="doubleaccounting",s.GC$.extend(A.Worksheet.prototype,{CW:function(t){var n,e,i,r,o,a,u,n=this,e=n.pW&&n.pW();if(n.hP()&&!n.D_)for(i=n.Fi(),r=void 0,o=0;o<=2;o++)for(a=0;a<=2;a++)!(r=i.c9(o,a))||0===R(r)||0===E(r)||t&&!r.intersectRect(t)||(u=n.Ut.pI,e&&u&&e.WW(u))}}),(fn=s.CellRange).prototype.comment=function(t){var n=this,e=n.sheet,i=n.row,r=n.col;return 0===arguments.length?e.Ut.pI.get(i,r):(t instanceof gn&&e.Ut.pI.WB(i,r,t),n)},ln=function(t,n){var e,n;!t.Ut.pI.Oy()&&(e=t.uw(),n=t.hitTest(n.pageX-e.left,n.pageY-e.top))&&Yn(t,n)},hn=function(t,e){e.bind(c.FloatingElementSelected+w,function(t,n){var n;"comments"!==n.type&&((n=e.Ut.pI).CZ(),n.wW(h))}),t.bind(en+w,function(t){e.Ut.pI.CZ(),ln(e,t)}).bind(an+w,function(t){ln(e,t)}).bind(rn+w,function(t){ln(e,t)})},dn=function(t,n){n.unbind(w),t.unbind(w)},c.CommentChanged="CommentChanged",(n=D=t.CommentState||(t.CommentState={}))[n.active=1]="active",n[n.edit=2]="edit",n[n.normal=3]="normal",(n=vn=t.DisplayMode||(t.DisplayMode={}))[n.alwaysShown=1]="alwaysShown",n[n.hoverShown=2]="hoverShown",Kn.prototype.clone=function(){var t=this;return new Kn(t.top,t.right,t.bottom,t.left)},Kn.prototype.toString=function(){var n=this,e="",t;return[b,St,Tt,p].forEach(function(t){e+=n[t]+Dt+Gt}),e.trim()},mn=Kn,t.Padding=mn,Xn.prototype.clone=function(){var e,i,e=this,i=new Xn;return bn.forEach(function(t){var n=e[t]();e[t].isDefault&&e[t].isDefault(n)||i[t](n&&n.clone?n.clone():n)}),i.Mf=e.Mf,i.bZ=e.bZ,i.yZ=e.yZ,i},Xn.prototype.toJSON=function(){var e,i,e=this,i={rowIndex:e.bZ,colIndex:e.yZ};return bn.forEach(function(t){var n=e[t]();e[t].isDefault&&e[t].isDefault(n)||(i[t]=n&&n.clone?n.clone():n)}),i},Xn.prototype.wh=function(t){var n,e,i,r,o,o,o,a,u,s,u,o,t,e,r,i,a,u,s,c,f,n=this,e=n.Mf,i={n_:"fill",color2:"#ffffe1"},r={n_:"stroke"},o=Bn(n.borderStyle());return o.dashStyle?r.dashStyle=o.dashStyle:o.lineStyle&&(r.lineStyle=o.lineStyle),o=n.opacity(),et(o)||1===o||(i.opacity=Math.floor(65535*o)+"f"),o=["Left","Center","Right"][n.horizontalAlign()||0]||"Left",!(a={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[n.bZ]},{n_:"Column",c_:[n.yZ]},{n_:"AutoFill",c_:["False"]}]})===n.dynamicMove()&&a.c_.push({n_:"MoveWithCells"}),!1===n.dynamicSize()&&a.c_.push({n_:"SizeWithCells"}),!1===n.locked()&&a.c_.push({n_:"Locked",c_:["False"]}),!1===n.lockText()&&a.c_.push({n_:"LockText",c_:["False"]}),"Left"!==o&&a.c_.push({n_:"TextHAlign",c_:[o]}),1===n.displayMode()&&a.c_.push({n_:"Visible"}),(u=n.padding())&&(s=[l(u.left)+"pt",l(u.top)+"pt",l(u.right)+"pt",l(u.bottom)+"pt"].join(",")),u={n_:"textbox",style:"mso-direction-alt:auto"+(n.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+o}]},o={n_:"shape",id:"_x0000_s"+t,type:"#_x0000_t202",style:Pn(e,n),fillcolor:Gn(n.backColor()),strokecolor:Gn(n.borderColor()),strokeweight:l(n.borderWidth()||1)+"pt",c_:[r,i,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},u,a]},s?u.inset=s:o["o:insetmode"]="auto",t=[],re(n.fontWeight())&&t.push({n_:"b"}),oe(n.fontStyle())&&t.push({n_:"i"}),1&(e=n.textDecoration())?t.push({n_:"u"}):8&e?t.push({n_:"u",val:"double"}):2&e&&t.push({n_:"strike"}),(r=-1!==(r=n.fontSize()||"9pt").indexOf("px")?l(parseFloat(r)):r.replace("pt",""))&&t.push({n_:"sz",val:r}),(i=n.foreColor())?(i=st(i),t.push(i)):t.push({n_:"color",indexed:"81"}),n.fontFamily()&&t.push({n_:"rFont",val:n.fontFamily()}),t.push({n_:"family",val:"2"}),a={n_:"t"},u=n.text(),(c=(s=et(u)?"":u).length!==s.trim().length)&&(a["xml:space"]="preserve"),a.c_=[at(s)],{vmlDrawingData:o,commentData:f={n_:"comment",ref:ct(n.yZ)+(n.bZ+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:t},a]}]}]}}},Xn.prototype.fromJSON=function(e,t){var i;e&&(i=this,bn.forEach(function(t){var n=e[t];n!==d&&("location"===t?i.location(new A.Point(n.x,n.y),!1):"padding"===t?i.padding(new mn(n.top,n.right,n.bottom,n.left),!1):i[t](n,!1))}),e.rowIndex!==d&&(i.bZ=e.rowIndex),e.colIndex!==d)&&(i.yZ=e.colIndex)},Xn.prototype.yh=function(f,t,l,h,d){var v,m,g,n,t,p,b,w,y,M,C;t&&(m=$(f,0,(v=this).yZ+1),g=nt(f,0,v.bZ),t=(n=S(t,"text")).c_)&&(p=1===t.length,b=[],t.forEach(function(t){var n,e,i,i,r,r,o,r,o,a,i,r,u,n,o,s,c,t,i,r,o,n,e,o,n=S(t,"rPr");n&&p&&((e=(i=S(n,"rFont"))?i.val:e)&&v.fontFamily(e),i=0,(r=S(n,"u"))&&(o=1,i|=2===(o=(r=r.val)?cn[r]:o)?8:1),S(n,"strike")&&(i|=2),i&&v.textDecoration(i),S(n,"b")&&v.fontWeight("bold"),S(n,"i")&&v.fontStyle("italic"),(e=S(n,"color"))&&(r=ut(e),v.foreColor(r)),e=S(n,"sz").val)&&v.fontSize(e+"pt"),(o=S(t,"t"))?o.c_&&b.push(o.c_[0]):"t"===t.n_&&t.c_&&b.push(t.c_[0]),(e=l.fillcolor)&&v.backColor(e.split(" ")[0]),(e=l.strokecolor)&&v.borderColor(e.split(" ")[0]),(e=l.strokeweight)&&v.borderWidth(tt(parseFloat(e.replace("pt","")))),(e=l.style)&&(a=e.split(";")).forEach(function(t){var t=Un(t,":"),n=t.key,e=t.value;if(!et(e))switch(n){case"margin-left":w=kn(e);break;case"margin-top":y=kn(e);break;case"width":M=e;break;case"height":C=e;break;case"z-index":v.zIndex(parseInt(e,10))}}),(e=S(l,"fill"))&&(i=e.opacity)&&("f"===i.substr(-1)?v.opacity(parseFloat(i.substr(0,i.length-1))/65535):v.opacity(parseFloat(i))),(e=S(l,"stroke"))&&v.borderStyle(Ln(e.dashStyle,e.lineStyle)),(e=S(l,"textbox"))&&((r=e.style)&&-1!==r.indexOf("mso-fit-shape-to-text:t")&&v.autoSize(!0),u=[0,0,0,0],e.inset&&e.inset.trim().split(",").forEach(function(t,n){var t=t||["0.1in","0.05in"][n%2];u[n]=tt(parseFloat(t.replace("pt","")))}),v.padding(new mn(u[1],u[2],u[3],u[0]))),n=S(l,"ClientData"),S(n,"SizeWithCells")&&v.dynamicSize(!1),S(n,"MoveWithCells")&&v.dynamicMove(!1),(e=S(n,"Locked"))&&v.locked(ue(e.c_[0],!0)),(e=S(n,"LockText"))&&v.lockText(ue(e.c_[0],!0)),(e=rt(S(n,"TextHAlign")))&&-1!==(o=["left","center","right"].indexOf(e.toLowerCase()))&&v.horizontalAlign(o),S(n,"Visible")&&v.displayMode(1),(e=rt(S(n,"Anchor")))?(t=e.split(",").map(function(t){return parseInt(t,10)}),i=$(f,0,t[0])+t[1]-7,r=nt(f,0,t[2])+t[3]-7,o=$(f,0,t[4])+t[5]+7,n=nt(f,0,t[6])+t[7]+7,v.location(new A.Point(i-m,r-g),!1),v.width(o-i),v.height(n-r),t&&(s=t[6]+1,c=t[4]+1)):(e=tt(w)-m-7,o=tt(y)-g-7,v.location(new A.Point(e,o)),v.width(tt(parseFloat(M.replace("pt","")))+14),v.height(tt(parseFloat(C.replace("pt","")))+14),s=Rn(f,v.location().y+g+v.height()).row+1,c=Fn(f,v.location().x+m+v.width()).col+1),A.Util.Co(h)&&A.Util.So(f,s,c,d)}),v.text(ot(b.join(""))))},gn=Xn,t.Comment=gn,pn={},bn=[],(wn=[[Ft,""],["location",j(9,-18)],[v,160,function(t){return 0<t}],[m,100,function(t){return 0<t}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(t){return/^\d+pt$/.test(t)&&0<parseInt(t,10)}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(t){return"boolean"==typeof t&&this.dynamicMove()}],["dynamicMove",!0,function(t){return t||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(t){return 0<=t&&t<=1}],["borderWidth",1,function(t){return 1<=t}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(t){return"string"==typeof t}],["indicatorSize",6,function(t){return"number"==typeof t&&1<t}]]).forEach(function(t){pn[t[0]]=qn(t[0],t[1],t[2])}),yn=pn.zIndex,pn.zIndex=function(){var t,n,e,t=yn.apply(this,arguments);return 0===arguments.length&&t===Bt&&(n=this.Mf.comments.GW,e=this.lp,t=Bt-(n-1-e)),t},Mn=pn.commentState,pn.commentState=function(t,n){var e,i,e=Mn.apply(this,arguments);return n&&(i=this.Mf).Rj("comment",null,null,A.SheetArea.viewport,this,this),e},L(gn.prototype,pn),F.prototype.Hc=function(){var t=this,n=t.TZ.Mf;t.QW=C+"floatBlockCanvas",t.KW=C+"host-container",t.JW=C+"host",t.XW=C+"lineCanvas",t.qW=r(f),(0,A.GC$)(t.qW).addClass(C+"floatBlockCanvas-container").css([o,u,Nt],[a,xt,kt]),t.SW=r("canvas"),g.Wl(t.SW,null,n),(0,A.GC$)(t.SW).addClass(t.QW).css([p,b,o],[0,0,a]),t.TW=r(f),(0,A.GC$)(t.TW).addClass(t.KW).css([o,Nt,u],[a,kt,xt]),t.Ti=r(f),(0,A.GC$)(t.Ti).addClass(t.JW+Gt+Pt).css([p,b,v,m,o,"word-wrap","word-break","white-space",u,Nt,Ut,$t],[0,0,"100%","100%",a,"break-word","normal","pre-wrap",xt,kt,Ht,"normal"]),(0,A.GC$)(t.TW).append(t.Ti),(0,A.GC$)(t.qW).append(t.SW).append(t.TW),t.$W=r(f),(0,A.GC$)(t.$W).addClass(C+"lineCanvas-container").css([o,u,"pointer-events"],[a,xt,"none"]),t.tQ=r("canvas"),g.Wl(t.tQ,h,n),(0,A.GC$)(t.tQ).addClass(t.XW).css([p,St,o],[0,0,a]),(0,A.GC$)(t.$W).append(t.tQ),t.nQ=[],t.eQ=7,t.iQ=!1,t.Eb=!1,F.et(t,"init",[t.SW,t.Ti])},F.prototype.rQ=function(){var t=this,n=t.TZ.Mf;!t.YW&&n&&n.pW&&(t.YW=n.pW().YW),t.YW&&(t.YW.appendChild(t.$W),t.oQ(),t.YW.appendChild(t.qW),t.aQ(t.SW,jt),t.aQ(t.TW,Ot),t.uQ()?t.sQ():t.cQ(),t.EW=t._W(),t.fQ())},F.prototype.lQ=function(){var t=this;t.qW&&t.$W&&t.YW&&(t.hQ(t.SW,jt),t.hQ(t.TW,Ot),t.dQ(),t.vQ(),t.mQ(),(0,A.GC$)(t.qW).remove(),(0,A.GC$)(t.$W).remove())},F.prototype.gQ=function(){return this.TZ.width()*this._zoomFactor},F.prototype.pQ=function(){return this.TZ.height()*this._zoomFactor},F.prototype._W=function(){var t=this,n=t.TZ;return n!==t.NW.PW||n.commentState()!==D.normal||n.ignoreDefaultLocation()?t.bQ(n.location()):(n.yQ=t.bQ(j(9,-18)),n.yQ)},F.prototype.bQ=function(t){var n,e,i,r,o,e,n,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o=j(0,0);return i&&(e=n.wQ(i,e.bZ,e.yZ,n.AW,n.IW)).x!==h&&void 0!==e.x&&e.y!==h&&void 0!==e.y&&R(e)&&E(e)&&(n=i.Fi(),o.x=e.x+R(e)+t.x*r-n.XC,o.y=e.y+t.y*r-n.qC),o},F.prototype.wQ=function(t,n,e,i,r){var o,a,u,s,c,f,l,o,s,l,c,o=this,a=O(0,0,0,0),u=t.Fi(),s=Jn(t,i),c=Qn(t,r),o=o._zoomFactor,f=N(t,c,e,!1,d,d,!0);return c===t.Ab&&(f+=t.my),l=N(t,s,n,!0,d,d,!0),s===t.Tb&&(l+=t.ly),a.y=s<=n?l:-l,a.x=c<=e?f:-f,(s=t.getSpan(n,e))!==d&&s!==h?(a.height=0===i&&Q(t,n,n+s.rowCount,!0)||N(t,n,n+s.rowCount,!0),a.width=0===r&&Q(t,e,e+s.colCount,!1)||N(t,e,e+s.colCount,!1)):(a[m]=Zn(t,n)*o,a[v]=Wn(t,e)*o),a.x+=u.XC,a.y+=u.qC,l=u.F6,c=u.L6,1===i?a.y+=c:2===i&&(a.y+=c+t.Sy(u)),1===r?a.x+=l:2===r&&(a.x+=l+t.Gy(u)),a},F.prototype.MQ=function(t){var n,e,i,r,o,e,n,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o=j(0,0);return i&&(e=n.wQ(i,e.bZ,e.yZ,n.AW,n.IW)).x!==h&&e.x!==d&&e.y!==h&&e.y!==d&&R(e)&&E(e)&&(n=i.Fi(),o.x=(t.x-(e.x+R(e)-n.XC))/r,o.y=(t.y-(e.y-n.qC))/r),o},F.prototype.CQ=function(){var t=this;t.EW=t._W(),t.jW(),t.OW(),t.fQ()},F.prototype.SQ=function(){var t,n,t=this,n=t.DW(t._W(),t.TZ.width(),t.TZ.height());t.EW=j(n.x,n.y),t.OW()},F.prototype.TQ=function(){var t,n,t,t=this,n=t.TZ;n.dynamicMove()?n.dynamicSize()?t.AQ():(t.IQ(),t.OW()):(t.jW(),t.OW(),t=t.MQ(t.EW===n.yQ?t._W():t.EW),n.location(t))},F.prototype.gW=function(){var t=this;t.EW=t._W(),t.fQ()},F.prototype.IQ=function(){var t,n,e,t=this,n=t.TZ,e=t.xQ();t.EW=e,n.location(t.MQ(e),!1),t.fQ()},F.prototype.xQ=function(){for(var t,n,e,n,i,r,o,a,u,i,s,c,u,i,t=this,n=t.TZ,e=n&&n.Mf,n=t._zoomFactor,i=Qn(e,t.IW),r=Jn(e,t.AW),o=0,a=0;a<t.IW;a++)o+=e.getViewportWidth(a);for(u=N(e,i,t.NQ,!1,d,d,!0),i<t.NQ?o+=u:o-=u,(i=Wn(e,t.NQ))<t.kQ&&(t.kQ=i),o+=t.kQ*n,c=s=0;c<t.IW;c++)s+=e.getViewportHeight(c);return u=N(e,r,t.DQ,!0,d,d,!0),r<t.DQ?s+=u:s-=u,(i=Zn(e,t.DQ))<t._Q&&(t._Q=i),j(o,s+=t._Q*n)},F.prototype.EQ=function(){var t,n,e,i,r,r,r,o,o,t=this,n=t.TZ,e=n&&n.Mf,i=N(e,t.NQ,t.jQ,!1,d,!0),r=Wn(e,t.NQ);r<t.kQ&&(t.kQ=r),(r=Wn(e,t.jQ))<t.OQ&&(t.OQ=r),i=i-t.kQ+t.OQ,r=N(e,t.DQ,t.RQ,!0,d,!0),(o=Zn(e,t.DQ))<t._Q&&(t._Q=o),(o=Zn(e,t.RQ))<t.BQ&&(t.BQ=o),r=r-t._Q+t.BQ,n.width(i),n.height(r)},F.prototype.AQ=function(){var t=this;t.EQ(),t.IQ()},F.prototype.jW=function(){var t,n,e,i,n,r,o,a,u,s,c,f,l,h,d,t=this,n=t.TZ,e=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=Qn(e,t.IW),r=Jn(e,t.AW),0===t.IW?o=t.EW.x:1===t.IW?o=t.EW.x-e.getViewportWidth(0):2===t.IW&&(o=t.EW.x-(e.getViewportWidth(0)+e.getViewportWidth(1))),0===t.AW?a=t.EW.y:1===t.AW?a=t.EW.y-e.getViewportHeight(0):2===t.AW&&(a=t.EW.y-(e.getViewportHeight(0)+e.getViewportHeight(1))),u=j(o,a),c=s=0,f=n;f<e.getColumnCount();f++){if(!(s+(l=Wn(e,f)*i)<u.x)){t.NQ=f,t.kQ=(u.x-s)/i;break}s+=l}for(h=r;h<e.getRowCount();h++){if(!(c+(d=Zn(e,h)*i)<u.y)){t.DQ=h,t._Q=(u.y-c)/i;break}c+=d}}},F.prototype.OW=function(){var t,n,e,i,n,r,o,a,u,s,c,f,l,h,d,t=this,n=t.TZ,e=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=Qn(e,t.IW),r=Jn(e,t.AW),0===t.IW?o=t.EW.x+t.gQ():1===t.IW?o=t.EW.x+t.gQ()-e.getViewportWidth(0):2===t.IW&&(o=t.EW.x+t.gQ()-(e.getViewportWidth(0)+e.getViewportWidth(1))),0===t.AW?a=t.EW.y+t.pQ():1===t.AW?a=t.EW.y+t.pQ()-e.getViewportHeight(0):2===t.AW&&(a=t.EW.y+t.pQ()-(e.getViewportHeight(0)+e.getViewportHeight(1))),u=j(o,a),c=s=0,f=n;f<e.getColumnCount();f++){if(!(s+(l=Wn(e,f)*i)<u.x)){t.jQ=f,t.OQ=(u.x-s)/i;break}s+=l}for(h=r;h<e.getRowCount();h++){if(!(c+(d=Zn(e,h)*i)<u.y)){t.RQ=h,t.BQ=(u.y-c)/i;break}c+=d}}},F.prototype.JO=function(t,n){var e=this,i=e.TZ;t<=e.DQ?i.dynamicMove()&&(e.DQ+=n,e.RQ+=n):t>e.DQ&&t<=e.RQ&&i.dynamicSize()&&(e.RQ+=n),e.AQ()},F.prototype.qO=function(t,n){var e=this,i=e.TZ;t<=e.NQ?i.dynamicMove()&&(e.NQ+=n,e.jQ+=n):t>e.NQ&&t<=e.jQ&&i.dynamicSize()&&(e.jQ+=n),e.AQ()},F.prototype.xP=function(t,n){var e,i,r,e=this,i=e.TZ,r=t+n-1;t<e.DQ?r<e.DQ?i.dynamicMove()&&(e.DQ-=n,e.RQ-=n):r<e.RQ&&i.dynamicMove()&&(i.dynamicSize()?e.RQ-=n:e.RQ-=e.DQ-t+1,e.DQ=t,e._Q=0):t<=e.RQ&&(r<e.RQ?i.dynamicSize()&&(e.RQ-=n):i.dynamicSize()&&(e.RQ=t,e.BQ=0)),e.AQ()},F.prototype.NP=function(t,n){var e,i,r,e=this,i=e.TZ,r=t+n-1;t<e.NQ?r<e.NQ?i.dynamicMove()&&(e.NQ-=n,e.jQ-=n):r<e.jQ&&i.dynamicMove()&&(i.dynamicSize()?e.jQ-=n:e.jQ-=e.NQ-t+1,e.NQ=t,e.kQ=0):t<=e.jQ&&(r<e.jQ?i.dynamicSize()&&(e.jQ-=n):i.dynamicSize()&&(e.jQ=t,e.OQ=0)),e.AQ()},F.prototype.fQ=function(){var t,n,e,e,t=this,n=t.TZ,e=n.Mf;t.LQ()&&(e=e.zoom(),t._zoomFactor!==e?(t._zoomFactor=e,t.EW=t.xQ()):(t._zoomFactor=e,t.EW!==n.yQ||1!==n.displayMode()&&2!==n.commentState()||(t.EW=t._W())),t.xW(),t.FQ(),t.PQ(),t.GQ(),t.UQ(),Z.Tt.chrome)&&t.HQ()},F.prototype.FQ=function(){var t,n,n,t=this,n=t.TZ.Mf,n=n.parent&&n.parent.options.useTouchLayout;t.eQ=n?11:7},F.prototype.xW=function(){var t=this,n=t.TZ,e=n.Mf;t.AW=e.C0(n.bZ),t.IW=e.S0(n.yZ)},F.prototype.PQ=function(){var t,n,e,t=this,n,e=2===t.TZ.commentState()?t.li:t.Ti;t.zQ(),t.VQ(e),t.YQ(e),t.ZQ(e),t.WQ()},F.prototype.YQ=function(t){var n=this,e=n.TZ;t===n.Ti&&(t.innerHTML=X.j0(e.text()))},F.prototype.ZQ=function(t,n){var e,i,r,o,r,a,o,u,r,s,c,f,l,h,s,d,v,m,s,v,d,f,m,c,l,u,r,n,f,v,d,s,c,a,e=this,i=e.TZ,r=n||2===i.commentState()||1===i.displayMode()?e._W():e.EW,o=e._zoomFactor;r&&(r=e.Eb?e.DW(r,i.width(),i.height()):e.DW(r),e.QQ(r),a=R(r)*o,o=E(r)*o,s=(u=r.x)+a,c=(r=r.y)+o,f=e.eQ,l=e.KQ(e.AW,e.IW),h=2*(f+i.borderWidth()),u<l.x?(ne(e,p,u-l.x,u+f-l.x),a+=u-l.x,u=l.x):(ne(e,p,0,f),s>l.x+R(l)&&(a+=l.x+R(l)-1-s)),(a=I(R(l)-1,a))<0&&(s=i.Mf,d=i.yZ,v=s.r6(s.getColumnCount()-s.lL),m=s.getViewportRightColumn(1),!1===s.Vy)&&d===v&&d===m&&(u=l.x+R(l)-1-i.width(),a=i.width()),r<l.y?(ne(e,b,r-l.y,r+f-l.y),o+=r-l.y,r=l.y):(ne(e,b,0,f),c>l.y+E(l)&&(o+=l.y+E(l)-1-c)),o=I(E(l)-1,o),(s=(0,A.GC$)(e.qW)).css({left:u,top:r}),v=s.height(),d=s.width(),m=!1,(f=e.JQ(a,o))&&(a=f.adjustedWidth,o=f.adjustedHeight,m=!n&&f.needReposition),o<=0&&v<=0||a<=0&&d<=0||((1<T(o-v)||1<T(a-d))&&(s.css({width:a,height:o}),g.$l(e.SW,a,o)),l=(c=(0,A.GC$)(e.TW)).width(),u=c.height(),r=G(0,a-h),n=G(0,o-h),(1<T(u-n)||1<T(l-r))&&(0,A.GC$)(e.TW).css({width:r,height:n}),v=(f=(0,A.GC$)(t)).width(),d=f.height(),s=r,c=n,(a=i.padding())&&(s-=Math.ceil(K(a.left)+K(a.right)),c-=Math.ceil(K(a.top)+K(a.bottom))),(1<T(d-c)||1<T(v-s))&&(0,A.GC$)(t).css({width:G(0,s),height:G(0,c)}),m&&e.ZQ(t,!0)))},F.prototype.QQ=function(t){var n,e,i,i,r,o,a,n=this,e=n.TZ,i=n.EW;t.x===i.x&&t.y===i.y&&R(t)===e.width()&&E(t)===e.height()||(i=n.MQ(j(t.x,t.y)),r=R(t),o=E(t),a=e.location(),i.x===a.x&&i.y===a.y||e.location(i,!1),r!==e.width()&&e.width(r,!1),o!==e.height()&&e.height(o,!1),e.dynamicMove()&&(n.EW=j(t.x,t.y)))},F.prototype.WQ=function(){var t=this,n=t.TZ,e;xn(n&&n.Mf)?(t.aQ(t.SW,jt),t.aQ(t.TW,Ot),t.oQ(),t.cQ(),t.sQ()):(n.locked()?(t.hQ(t.SW,jt),t.XQ(t.SW),t.hQ(t.TW,Ot),t.XQ(t.TW),t.SW.style.cursor=H,t.TW.style.cursor=H):(t.aQ(t.SW,jt),t.aQ(t.TW,Ot)),n.lockText()?(t.dQ(),t.XQ(t.Ti),t.mQ(),t.XQ(t.li),!n.locked()&&n.commentState()===D.active||n.commentState(3),t.Ti.style.cursor=n.locked()?H:Mt):(t.cQ(),t.sQ()),t.oQ())},F.prototype.zQ=function(){var t=this,n=t.TZ,e=t.NW,i=n&&n.Mf;switch(n.commentState()){case D.active:e.qQ(n),t.uQ()&&t.$Q(),0<i.getSelections().length&&i.e4(),Y.F1(i);break;case D.edit:e.qQ(n),t.uQ()||t.tK(),0<i.getSelections().length&&i.e4(),Y.F1(h);break;case D.normal:n===e.pZ()&&(e.CZ(),0===i.getSelections().length)&&i.cR()}},F.prototype.VQ=function(t){var n,e,i,r,i;function o(t,n,e){var e,i;return e?((i=(e=B.Common.ft)._(t)).a=n,e.j(i)):t}e=(n=this).TZ,(i=(0,A.GC$)(t)).css("font-family",e.fontFamily()).css("font-style",e.fontStyle()).css("font-size",parseInt(e.fontSize(),10)*n._zoomFactor+"pt").css("font-weight",e.fontWeight()),i.css("text-decoration",s.W.A5(e.textDecoration())),i.css("text-align",(r={0:"left",1:"center",2:"right",3:"general"})[e.horizontalAlign()]),e.padding()?i.css(_t,e.padding().toString()):i.css(_t,"0px"),i.css("background-color",o(e.backColor(),e.opacity(),t===n.Ti)).css("color",e.foreColor()),(0,A.GC$)(n.TW).css("border-width",e.borderWidth()).css("border-style",e.borderStyle()).css("border-color",e.borderColor()),i=n.NW.nK(e),(0,A.GC$)(n.$W).css(It,i),(0,A.GC$)(n.qW).css(It,i)},F.prototype.HQ=function(){var t,n,e,n,i,n,t,n=this.TZ.Mf,e=(0,A.GC$)(this.TW);n&&e&&(i=.5<=(n=n.uw()).left-x(n.left)?.5:0,n=.5<=n.top-x(n.top)?.5:0,e.css(p,K(e.css(p))+i),e.css(b,K(e.css(b))+n))},F.prototype.GQ=function(){var t,n,e,n,e,i,r,n,o,e,a,o,e,a,u,s,e,c,f,l,t=this,n=t.TZ,e=n.Mf,n=t.wQ(e,n.bZ,n.yZ,t.AW,t.IW),e=e.Fi(),i,r,n=j(n.x+R(n)-e.XC,n.y-e.qC),e=(0,A.GC$)(t.qW).position(),a=(0,A.GC$)(t.TW).position(),o=(0,A.GC$)(t.TW),o=e.left+a.left>n.x?j(e.left+a.left,e.top+a.top):e.top+a.top+o.height()<n.y?j(e.left+a.left+o.width(),e.top+a.top+o.height()):j(e.left+a.left+o.width(),e.top+a.top),e=t.eQ,a=T(n.x-o.x)+2*e,u=T(n.y-o.y)+2*e,s=I(n.x,o.x)-e,e=I(n.y,o.y)-e,c=s+a,f=e+u,l=t.KQ(t.AW,t.IW);s<l.x&&(a-=l.x-s,s=l.x),c>l.x+R(l)&&(a-=c-(l.x+R(l))),a=I(R(l),a),e<l.y&&(u-=l.y-e,e=l.y),f>l.y+E(l)&&(u-=f-(l.y+E(l))),u=I(E(l),u),(0,A.GC$)(t.$W).css(p,s).css(b,e).css(v,a).css(m,u),g.$l(t.tQ,a,u),n.x=n.x-s,n.y=n.y-e,o.x=o.x-s,o.y=o.y-e,t.eK(n,o)},F.prototype.eK=function(t,n){var e,i,r,e,e=this;e.iK||(e.iK=e.tQ.getContext("2d")),i=e.iK,r=e.TZ.borderColor(),i.strokeStyle=r,i.clearRect(0,0,g.Xl(e.tQ),g.ql(e.tQ)),i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(n.x,n.y),i.stroke(),i.save(),q.Yl(i,t.x,t.y),i.fillStyle=r,i.beginPath(),e=U(n.y-t.y,n.x-t.x),i.rotate(e),i.moveTo(0,0),i.lineTo(7,-4),i.lineTo(7,4),i.lineTo(0,0),i.fill(),q.Yl(i,-t.x,-t.y),i.closePath(),i.restore()},F.prototype.UQ=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.TZ,e=n.Mf;t.rK=t.TZ.commentState(),t.oK||(t.oK=t.SW.getContext("2d")),i=t.oK,r=g.Xl(t.SW),o=g.ql(t.SW),a=(0,A.GC$)(t.TW).outerWidth(),u=(0,A.GC$)(t.TW).outerHeight(),s=t.eQ,i.clearRect(0,0,r,o),t.TZ.showShadow()&&(t.aK(i,r,o),i.clearRect(s,s,r-(c=2*(s+2)),o-c),t.uK(i,s,a,u)),xn(e,n)&&t.sK(i,s,r,o,a,u),i.restore()},F.prototype.uK=function(t,n,e,i){t.save(),t.fillStyle=sn,t.fillRect(n+2,i+n,e,2),t.fillRect(e+n,n+2,2,i),t.restore()},F.prototype.aK=function(t,n,e){var i,r,o;switch(t.save(),t.strokeStyle=sn,this.rK){case D.active:for(t.beginPath(),r=0;r<e;r++)for(i=r%2==0?1:3;i<n;)t.moveTo(i,r),t.lineTo(i+1,r+1),i+=4;t.stroke(),t.closePath();break;case D.edit:for(t.beginPath(),r=i=0,o=4;i<n+e;)t.moveTo(i+4,0),t.lineTo(0,r+4),i+=4,r+=4;t.stroke(),t.closePath()}t.restore()},F.prototype.sK=function(o,t,n,e,i,r){var a=this,u=a.nQ;a.rK!==D.active&&a.rK!==D.edit||(u.splice(0,u.length),te(u,0,0,t,"nw"+_),te(u,n-t,0,t,"ne"+_),te(u,0,e-t,t,"sw"+_),te(u,n-t,e-t,t,"se"+_),3*t<=r?(te(u,0,x(e/2-t/2),t,"w"+_),te(u,n-t,x(e/2-t/2),t,"e"+_)):(u.push(h),u.push(h)),3*t<=i?(te(u,x(n/2-t/2),0,t,"n"+_),te(u,x(n/2-t/2),e-t,t,"s"+_)):(u.push(h),u.push(h)),o.restore(),o.fillStyle="white",o.strokeStyle="#939393",o.lineWidth=1,q.Yl(o,.5,.5),A.GC$.each(u,function(t,n){var e,i,r,n;n&&(e=n.x,i=n.y,r=R(n),n=E(n),o.beginPath(),o.fillRect(e,i,r-1,n-1),o.strokeRect(e,i,r-1,n-1),o.stroke(),o.closePath())}),q.Yl(o,-.5,-.5))},F.prototype.cK=function(){var n,t,e,i,e,n=this,t=n.KQ(n.AW,n.IW);n.eW?(0,A.GC$)(n.eW).remove():n.eW=r(f),e=(0,A.GC$)(n.eW),i=(0,A.GC$)(n.TW),e.addClass("gc-spread-moveResizeContainer").css([o,p,b,v,m,"border"],[a,n.EW.x+n.eQ-t.x,n.EW.y+n.eQ-t.y,i.outerWidth()-2,i.outerHeight()-2,"gray solid thin"]),n.fK?(0,A.GC$)(n.fK).remove():n.fK=r(f),(e=(0,A.GC$)(n.fK)).bind("mousemove",function(t){n.pg(t)}).bind(on,function(t){n.bg(t)}).css([o,u,b,p,v,m,"background",It],[a,xt,t.y,t.x,R(t),E(t),"rgba(255,255,255,0.01)",901]),e.append(n.eW),n.YW&&n.YW.appendChild(n.fK)},F.prototype.lK=function(t){var n,e,i,r,o,a,u,t,a,s,c,s,f,f,n=this,e=n.eQ,i=n._zoomFactor,r,o=n.NW.RW;o.BW&&(a=n.hK(),u=t.pageX/i-o.x+a.x,t=t.pageY/i-o.y+a.y,0===u&&0===t||(a=n.KQ(n.AW,n.IW),c=(0,A.GC$)(n.eW),o.FW<0?(s=o.LW.x+u,f=o.LW.y+t,s=n.bQ(j(s,f)),c.css([p,b],[s.x+e-a.x,s.y+e-a.y])):(f=n.dK(u,t,o.FW),s=n.bQ(j(f.x,f.y)),c.css([p,b,v,m],[s.x+e-a.x,s.y+e-a.y,R(f)*i-2*e-2,E(f)*i-2*e-2]))))},F.prototype.tK=function(){var t,n,e,t=this,n=t.TZ;t.uQ()||(e=t.NW.kW,(0,A.GC$)(t.Ti).remove(),t.dQ(),(0,A.GC$)(e).remove(),(0,A.GC$)(t.TW).append(e),t.vK(e),t.ZQ(e),(0,A.GC$)(e).focus(),e.selectionStart=e.value.length,t.sQ(),2!==n.commentState()&&n.commentState(2,!0))},F.prototype.$Q=function(){var t,n,e,i,t=this,n=t.TZ,e=n.Mf;t.uQ()&&(i=t.NW.kW,t.mQ(),(0,A.GC$)(i).remove(),(0,A.GC$)(t.TW).append(t.Ti),t.vK(t.Ti),t.cQ(),F.et(t,"detachEditor",t.Ti),2===n.commentState()&&n.commentState(3),(0,A.GC$)(i).val()!==n.text())&&e.Qy().execute({cmd:"changeComment",sheetName:e.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,A.GC$)(i).val(),propertyName:Ft})},F.prototype.mK=function(t){var n,e,i,n,e=this.TZ.Mf,i=-1;return 0===t||2===t?i=e.getViewportHeight(t):1===t&&(i=N(e,e.getViewportBottomRow(0)+1,Jn(e,2)+1,!0)),i},F.prototype.gK=function(t){var n,e,i,n,e=this.TZ.Mf,i=-1;return 0===t||2===t?i=e.getViewportWidth(t):1===t&&(i=N(e,e.getViewportRightColumn(0)+1,Qn(e,2)+1,!1)),i},F.prototype.KQ=function(t,n){var e,i,r,o,a,i,e,i=this.TZ.Mf,r=i.Fi(),o=r.c9(t,n),a=i.Gy(r),i=i.Sy(r);return 0===t&&0===n||0===t&&2===n||2===t&&0===n||2===t&&2===n?o=O(0,0,r.F6+a+r.zy,r.L6+i+r.Iy):0===t&&1===n||2===t&&1===n?o=O(r.F6,0,a,r.L6+i+r.Iy):1===t&&0===n||1===t&&2===n?o=O(0,r.L6,r.F6+a+r.zy,i):1===t&&1===n&&(o=O(r.F6,r.L6,a,i)),o},F.prototype.vK=function(t){var n=this,e=n.TZ,i=(0,A.GC$)(t);t!==n.li&&t!==n.Ti||(t===n.li?t.value=e.text():t.innerHTML=X.j0(e.text()),i.css([Yt,Zt,Wt,Qt,Jt,tn,nn,un],[e.fontFamily(),e.fontStyle(),e.fontSize(),e.fontWeight(),e.foreColor(),e.backColor(),e.horizontalAlign(),e.textDecoration()]),e.padding()?i.css(_t,e.padding().toString()):i.css(_t,"0px"))},F.prototype.LQ=function(){return!(!this.qW||!this.qW.parentNode)},F.prototype.uQ=function(){var t=this;return t.LQ()&&t.TZ===t.NW.pZ()&&0<(0,A.GC$)(t.TW).find(Kt).length},F.prototype.pK=function(){var t,n,e,n,t=this,n=t.TZ.Mf,e=h;return t.LQ()&&(n=n.Fi(),e=O(t.EW.x+n.BA+n.XC,t.EW.y+n.LA+n.qC,t.gQ(),t.pQ())),e},F.prototype.bK=function(){var t,n,e,i,r,o,a,u,t,s,t=this,n=t.TZ,e=t._zoomFactor;return t.LQ()&&(i=t.pK())?(u=a=o=r=void 0,t=(t.eQ+n.borderWidth())*e,O(r=i.x+t,o=i.y+t,a=R(i)-2*t,u=E(i)-2*t)):h},F.prototype.yK=function(t){var n,e,i,r,o,a,u,o,n=this,e=n.TZ,i=e.Mf,r=t.target,o=n.NW.RW,a=r.style,u=H;o.BW?r[k]!==n.JW&&r[k]!==n.QW&&r[k]!==n.XW&&r[k]!==C+"floatPanel"||(u=0<=o.FW?"crosshair":Mt):r[k]===n.JW?!xn(i)&&e.lockText()?e.locked()||(u=Mt):u=Ft:r[k]!==n.QW&&r[k]!==n.KW||xn(i,e)&&(u=0<=(o=n.wK(t))&&o<n.nQ.length?n.nQ[o].cursor:Mt),a[Rt]=u},F.prototype.lW=function(t){var n,e,i,r,n=this,e=n.TZ,i=e&&e.Mf;if(i&&i.endEdit()&&e&&i.comments.get(e.bZ,e.yZ)&&(F.et(n,"preProcessMouseDownEdit",r={e:t,r:h}),!r.r))return i.ki(c.FloatingElementSelected,{type:"comments"}),n.NW.qQ(e),e.commentState(2,!0),n.bg(t),W(t)},F.prototype.XZ=function(t){var n,e,i,r,o,a,u,u,r,o,e,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o=n.NW,a=o.RW;i.endEdit()&&(F.et(n,"preProcessMouseDownDragResize",u={e:t,r:h}),u.r||(i.ki(c.FloatingElementSelected,{type:"comments"}),a.x=t.pageX/r,a.y=t.pageY/r,a.LW=O(e.location().x,e.location().y,e.width(),e.height()),a.FW=n.wK(t),n.Fg(),a.BW=!0,n.yK(t),o.qQ(e),e.commentState(D.active,!0),xn(i,e)&&(n.CK={},n.CK.SK=Jn(i,n.AW),n.CK.TK=Qn(i,n.IW),n.cK(),a.FW<0?n.iQ=!0:n.Eb=!0),u=i.rt,r=i.uw(),o=j(t.pageX-r.left,t.pageY-r.top),e=i.hitTest(o.x,o.y),u.Rk={e9:e.rowViewportIndex,r9:e.colViewportIndex,Bk:e.hitTestType},u.fk=o,u.Ok(),u.s9=!0,t.stopPropagation()))},F.prototype.DW=function(t,n,e){var i,r,o,a,u,s,c,f,n,e,l,h,d,v,m,t,v,g,p,b,w,y,w,s,w,M,r,C,S,s,i=this,r=i.TZ,o=r&&r.Mf,a=i.eQ,u=i._zoomFactor,s=i.IW,c=i.AW,f=i.KQ(c,s),n=void 0!==n?n*u:i.gQ(),e=void 0!==e?e*u:i.pQ(),l=t.x,h=t.y,d=o.Fi(),v=i.wQ(o,0,0,c,s),m=t.x+(0-(v.x-d.XC))+n-a,t=t.y+(0-(v.y-d.qC))+e-a,v=0,g=0,p=0,b=0;return 0===s?(v=0-a,p=R(d)-d.XC):1===s?(w=N(o,o.getViewportRightColumn(0)+1,Qn(o,1),!1),v=f.x-a-w,p=y=i.gK(2)):2===s&&(v=0-a),l<v&&(i.Eb?n-=v-l:m+=v-l,l=v),1!==s&&2!==s||(p+=N(o,0,o.getColumnCount(),!1,m)),p<m&&(i.Eb?n-=m-p:i.iQ?l-=m-p:(w=i.NW.PW&&!r.ignoreDefaultLocation()?9:r.location().x,v<(w=l-(s=2*T(w)+Wn(o,r.yZ)+r.width()))?l=w:l<p?n-=m-p:(w=l-s,l=v<(M=m-s)?w<v?(n-=v-w,v):w:(w=l-(m-p))<v?(n-=v-w,v):w))),0===c?(g=0-a,b=E(d)-d.qC):1===c?(r=N(o,o.getViewportBottomRow(0)+1,Jn(o,1),!0),g=f.y-a-r,b=C=i.mK(2)):g=0-a,h<g&&(i.Eb?e-=g-h:t+=g-h,h=g),1!==c&&2!==c||(b+=N(o,0,o.getRowCount(),!0,t)),b<t&&(i.Eb?e-=t-b:i.iQ?h-=t-b:b<t&&(h=(s=h-(S=t-b))<g?(e-=g-s,g):s)),O(l,h,n/u,e/u)},F.prototype.hK=function(){var t,n,e,i,r,o,r,a,t,u,n,t=this,n=t.TZ.Mf,r=t.CK,o=r.SK,r=r.TK,a=Jn(n,t.AW),t=Qn(n,t.IW),u=N(n,o,a,!0),n=N(n,r,t,!1),e,i;return j(r<t?n:-n,o<a?u:-u)},F.prototype.AK=function(t){var n,e,i,r,o,a,u,s,c,t,r,s,f,f,l,l,c,n=this,e=n.TZ,i=e&&e.Mf,r=n._zoomFactor,o,a=n.NW.RW,u=P.ChangeComment;a.BW&&(s=n.hK(),c=t.pageX/r-a.x+s.x,t=t.pageY/r-a.y+s.y,0===c&&0===t||(s=r=void 0,a.FW<0?(f=a.LW.x+c,l=a.LW.y+t,r=n.bQ(j(f,l)),s=n.DW(r),(f=n.MQ(j(s.x,s.y))).x===e.location().x&&f.x===e.location().y||i.Qy().execute({cmd:"moveComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.location().clone(),newValue:f,propertyName:"location"})):(e.autoSize(!1),l=n.dK(c,t,a.FW),r=n.bQ(j(l.x,l.y)),s=n.DW(r,R(l),E(l)),c=[],(f=n.MQ(j(s.x,s.y))).x===e.location().x&&f.y===e.location().y||c.push(new u(i,{cmd:"changeComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.location().clone(),newValue:f,propertyName:"location"})),R(s)!==e.width()&&c.push(new u(i,{cmd:"changeComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.width(),newValue:s.width,propertyName:v})),E(s)!==e.height()&&c.push(new u(i,{cmd:"changeComment",sheetName:i.name(),row:e.bZ,col:e.yZ,oldValue:e.height(),newValue:s.height,propertyName:m})),0<c.length&&i.Qy().execute({cmd:"changeCommentTransaction",sheetName:i.name(),commands:c}))))},F.prototype.pg=function(t){var n,e,i,i,r,o,e,e,n=this,e=n.TZ.Mf,i={e:t,r:h};if(F.et(n,"preProcessMouseMove",i),!(i.r||(this.yK(t),e.getSelections()&&0<e.getSelections().length)))return i=n.NW,r=t.target,o=e.rt,e=e.uw(),e=j(t.pageX-e.left,t.pageY-e.top),r&&i.RW.BW&&(n.eW&&n.lK(t),1===n.AW&&(o.fk.y=e.y),1===n.IW&&(o.fk.x=e.x),o.a9()),W(t)},F.prototype.bg=function(t){var n,e,i,i,r,e,n=this,e=n.TZ.Mf,i={e:t,r:h};if(F.et(n,"preProcessMouseUp",i),!(i.r||e.getSelections()&&0<e.getSelections().length))return i=t.target,r=n.NW,(e=e.rt).s9=!1,e.l9(),i&&(n.AK(t),n.fK&&((0,A.GC$)(n.fK).remove(),n.fK=null,n.iQ=!1,n.Eb=!1),n.u2(),r.RW.BW=!1,n.yK(t)),W(t)},F.prototype.wK=function(t){var n,e,n,i,r,o,a,n=this,e=n.nQ;if(0<e.length&&(n.rK===D.active||n.rK===D.edit))for(n=n.SW,i=t.pageX-(0,A.GC$)(n).offset().left,r=t.pageY-(0,A.GC$)(n).offset().top,o=0;o<e.length;o++)if((a=e[o])&&a.contains(i,r))return o;return-1},F.prototype.dK=function(t,n,e){var i,r,o,e,t,i=this,r=-1,o=-1;switch(e){case 0:o=r=0;break;case 1:r=2,o=0;break;case 2:r=0,o=2;break;case 3:o=r=2;break;case 4:r=0,o=1;break;case 5:r=2,o=1;break;case 6:r=1,o=0;break;case 7:r=1,o=2}return e=i.IK(t,r),t=i.oh(n,o),O(e.x,t.y,e.w,t.h)},F.prototype.IK=function(t,n){var e,i,e,r,o,t,e=this,i=2*e.eQ,e=e.NW.RW,r=R(e.LW)-i;return 0===n?r-=t:2===n&&(r+=t),o=e.LW.x,0<=r?0===n&&(o+=t):0===n?o+=R(e.LW)-i:2===n&&(o+=r),t=R(e.LW),{x:o,w:t=1!==n?T(r)+i:t}},F.prototype.oh=function(t,n){var e,i,e,r,o,t,e=this,i=2*e.eQ,e=e.NW.RW,r=E(e.LW)-i;return 0===n?r-=t:2===n&&(r+=t),o=e.LW.y,0<=r?0===n&&(o+=t):0===n?o=E(e.LW)-i:2===n&&(o+=r),t=E(e.LW),{y:o,h:t=1!==n?T(r)+i:t}},F.prototype.XQ=function(t){var n,e,i,n,n=this,e=n.TZ.Mf;if(t){switch(i=d,t){case n.SW:i=jt;break;case n.TW:i=Ot;break;case n.$W:i=Et;break;case n.Ti:i=y;break;case n.li:i=M}i&&((0,A.GC$)(t).unbind(an+i).unbind(Ct+i),n=function(t){e.P_(t),W(t)},(0,A.GC$)(t).bind(an+i,n).bind(Ct+i,n))}},F.prototype.aQ=function(t,n){var e,i,r,i,e=this,i=e.TZ,r=i&&i.Mf;e.hQ(t,n),i=function(t){ie(r,t)},(0,A.GC$)(t).bind(en+n,function(t){e.XZ(t)}).bind(rn+n,function(t){e.pg(t)}).bind(on+n,function(t){e.bg(t)}).bind(an+n,i).bind(Ct+n,i)},F.prototype.hQ=function(t,n){(0,A.GC$)(t).unbind(n)},F.prototype.oQ=function(){var o,t,a,u,s,t,o=this,t=o.TZ,a=t&&t.Mf,u=o.NW;o.vQ(),a&&(s=a.uw(),t=function(t){a.P_(t)},(0,A.GC$)(o.tQ).bind(en+Xt,function(t){var n,e,e,n=a.Ut.pI.hitTest(t.pageX-s.left,t.pageY-s.top);n?(e=n.comment,e=u.mW(e),n.area===Vt?e.lW(t):n.area===zt&&e.XZ(t),(0,A.GC$)(e.qW).css(It,parseInt((0,A.GC$)(o.$W).css(It)+1,10))):a.B_(t)}).bind(rn+Xt,function(t){var n,e,i,r,i,n=a.Ut.pI.hitTest(t.pageX-s.left,t.pageY-s.top),e=o.tQ.style;n?(i=n.comment,(r=u.mW(i)).pg(t),n.area===Vt?e.cursor=Ft:n.area===zt&&(e.cursor=Mt)):(a.L_(t),o.NW.wW(h),(i=a.Dg())&&(e.cursor=i.style.cursor))}).bind(on+Xt,function(t){var n,n,e,n=a.Ut.pI.hitTest(t.pageX-s.left,t.pageY-s.top);n?(n=n.comment,(e=u.mW(n)).bg(t)):a.F_(t)}).bind("dblclick"+Xt,function(t){a.U_(t)}).bind(an+Xt,t).bind(Ct+Xt,t))},F.prototype.vQ=function(){var t;(0,A.GC$)(this.tQ).unbind(Xt)},F.prototype.cQ=function(){var n,t,e,t,n=this,t=n.TZ,e=t&&t.Mf;t.commentState()!==D.edit&&n.Ti&&(n.dQ(),t=function(t){ie(e,t)},(0,A.GC$)(n.Ti).bind(en+y,function(t){n.lW(t)}).bind(rn+y,function(t){n.pg(t)}).bind(on+y,function(t){n.bg(t)}).bind(an+y,t).bind(Ct+y,t))},F.prototype.dQ=function(){var t=this,n;t.TZ.commentState()!==D.edit&&t.Ti&&(0,A.GC$)(t.Ti).unbind(y)},F.prototype.sQ=function(){var t,n,e,i,t=this,n=t.TZ,e=n&&n.Mf,i=t.li;n.commentState()===D.edit&&i&&(this.mQ(),(0,A.GC$)(i).bind(en+M,function(t){t.stopPropagation()}).bind(rn+M,function(t){t.stopPropagation()}).bind(on+M,function(t){t.stopPropagation()}).bind("keydown"+M,function(t){27!==t.keyCode&&9!==t.keyCode||(n.commentState(D.active,!0),W(t),Y.F1(e))}).bind("focusout"+M,function(){(0,A.GC$)(i).val()!==n.text()&&e.Qy().execute({cmd:"changeComment",sheetName:e.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,A.GC$)(i).val(),propertyName:Ft})}))},F.prototype.JQ=function(t,n){var e,i,r,o,r,a,u,s,c,f,l,h,l,d,v,m,g,p,b,w,y,M,C,S,T,d,e=this,i=e.TZ,r=e.eQ,o=i.padding(),r=2*(r+i.borderWidth());if(!(!i.autoSize()||e.Eb||e.xK||n<=0)){if(e.xK=!0,u=(a=i.Mf).Fi(),s=a.qc()&&a.qc().getBoundingClientRect(),f=i.commentState()===D.edit?(c=e.li).value:(c=e.Ti,X.dI(c.innerHTML)),h="",(l=c.style).font?h+=l.font:(i.fontStyle()&&(h+=Gt+i.fontStyle()),i.fontWeight()&&(h+=Gt+i.fontWeight()),i.fontSize()&&(h+=Gt+parseInt(i.fontSize(),10)*e._zoomFactor+"pt"),i.fontFamily()&&(h+=Gt+i.fontFamily())),l=c.getBoundingClientRect(),d=i.location().x<0,v=!1,p=m=J("M",h),b=g=5,w=u.x+u.width-(l.left-s.left),y=u.y+u.height-(l.top-s.top),d&&(w=l.left-s.left+l.width-u.x,v=!0),(M=A.q.un(f,w,h))&&0<M.length){for(S=C=0;S<M.length;S++)C<(T=a.Gi(M[S],h))&&(C=T);d=ee(M,h),o&&(C+=(o.left||0)+(o.right||0),d+=(o.top||0)+(o.bottom||0)),b=x(I(w,G(C,5))),p=x(I(y,d))}return 2===i.commentState()&&i.text(c.value),n=p+r,t=b+r,i.width(b,!1),i.height(p,!1),v&&i.location().x+b<=0&&(v=!1),e.xK=!1,{adjustedWidth:t,adjustedHeight:n,needReposition:v}}},F.prototype.mQ=function(){var t,n=this.li;n&&(0,A.GC$)(n).unbind(M)},F.prototype.Fg=function(){var n=this,t=n.NW.RW;t.BW||((0,A.GC$)(dt).bind(rn+qt,function(t){n.pg(t)}).bind(on+qt,function(t){n.bg(t)}),t.BW=!0)},F.prototype.u2=function(){var t=this.NW.RW;t.BW&&(t.BW=!1,A.GC$)(dt).unbind(qt)},Cn=F,t.hW=Cn,s.$e(Cn),e.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,t,n=this.all(),e={};if(n)for(r=i=void 0,o=0,a=n;o<a.length;o++)i=(u=a[o]).bZ,r=u.yZ,mt(e,{minRow:i,minCol:r,maxRow:i,maxCol:r});return e},e.prototype.dispose=function(t){var n,e,n=this,e;n.all().forEach(function(t){n.NK(t)}),n.kK(),!1!==t&&(n.Mf=h)},e.prototype.add=function(t,n,e){var i,r,o,o,e,i=this,r=i.Mf,o=r.getSpan(t,n);return!o||o.row===t&&o.col===n?(o=i.get(t,n),e="string"==typeof e?new gn(e):e,i.WB(t,n,e),r.Rj("comment",t,n,A.SheetArea.viewport,o,e),e):h},e.prototype.WB=function(t,n,e,i){var r=this,o=r.Mf,a=r.wB;r.DK(t,n),e&&(e.bZ=t,e.yZ=n,e.Mf=o,a.push(e),e.lp=r.GW,o.Ut.MW({type:"add",row:t,col:n,comment:e}),r.GW++,r._K(t,n,e),i||o.zw())},e.prototype.get=function(t,n){return this.cE[t+"_"+n]||h},e.prototype._K=function(t,n,e){this.cE[t+"_"+n]=e},e.prototype.EK=function(t,n,e){var i=t.bZ,r=t.yZ;this.get(i,r)===t&&this._K(i,r,d),this.Mf.Ut.MW({type:"rowcol",comment:t,row:i,col:r,newRow:n,newCol:e}),t.bZ=n,t.yZ=e,this._K(n,e,t)},e.prototype.remove=function(t,n){var e=this,i=e.DK(t,n),e=e.Mf;i&&(e.Rj(z,t,n,A.SheetArea.viewport,i,d),e.zw())},e.prototype.DK=function(t,n){var e,i,r,i,e=this,i=e.Mf,r=e.get(t,n);return r&&(i.Ut.MW({type:"remove",row:t,col:n,comment:r}),e.NK(r),V.VP(e.wB,r),(i=e.mW(r))&&(Cn.et(i,"dispose"),V.VP(e.UW,i)),e._K(t,n,d)),r},e.prototype.clear=function(t){var n,e,i,r,o,a,o,n=this,e=n.Mf,i=n.wB;for(e.suspendPaint(),r=i.length-1;0<=r;r--)a=(o=i[r]).bZ,o=o.yZ,(!t||a>=t.row&&a<t.row+t.rowCount&&o>=t.col&&o<t.col+t.colCount)&&n.remove(a,o);e.resumePaint()},e.prototype.all=function(){return this.wB.concat()},e.prototype.CB=function(t,n,e,i,r,o){(t||i)&&(t&&this.EK(t,r,o),i)&&this.EK(i,n,e)},e.prototype.getOuterContainer=function(t){var t=this.mW(t);return t?t.qW:h},e.prototype.HW=function(){var t=r(Kt);(0,A.GC$)(t).addClass("gc-comment-editor").css(p,0).css(b,0).css(o,a).css("margin",0).css(_t,0).css("word-wrap","break-word").css("word-break","normal").css(u,xt).css("resize","none").css("outline","none").css("border","0px").css(Nt,kt).css($t,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.kW=t},e.prototype.zW=function(){var i=this,t=i.Mf;t&&(t.D3(c.ColumnChanged+w,function(t,n){var n=n.propertyName;n!==v&&"isVisible"!==n||i.jK()}),t.D3(c.RowChanged+w,function(t,n){var n=n.propertyName;n!==m&&"isVisible"!==n||i.jK()}),t.D3(c.ColumnWidthChanged+w,function(){i.jK()}),t.D3(c.RowHeightChanged+w,function(){i.jK()}),t.D3(c.CommentChanged+w,function(t,n){var e,n,n;n&&(e=n.propertyName,n=n.comment,n=i.mW(n))&&("location"===e?n.CQ():e!==v&&e!==m||n.SQ())}))},e.prototype.kK=function(){var t,n=this.Mf;n&&n._3(w)},e.prototype.mW=function(t){var n,e,i,r,n,e=this.UW;if(t)for(i=0;i<e.length;i++)if((r=e[i]).TZ===t)return r;return h},e.prototype.Oy=function(){return 0===this.wB.length},e.prototype.RK=function(){var t,n,e,i,r,t,n=this.wB;if(0<n.length){for(e=n[0].zIndex(),i=1;i<n.length;i++)e<(r=n[i]).zIndex()&&(e=r.zIndex());return e}return 0},e.prototype.JO=function(t,n){for(var e,i,r,o,a,u,s,e=this,i=e.wB,r=e.UW,o=0;o<i.length;o++)t<=(a=i[o]).bZ&&e.EK(a,a.bZ+n,a.yZ);for(u=0;u<r.length;u++)(s=r[u]).LQ()&&s.JO(t,n)},e.prototype.qO=function(t,n){for(var e,i,r,o,a,u,s,e=this,i=e.wB,r=e.UW,o=0;o<i.length;o++)t<=(a=i[o]).yZ&&e.EK(a,a.bZ,a.yZ+n);for(u=0;u<r.length;u++)(s=r[u]).LQ()&&s.qO(t,n)},e.prototype.xP=function(t,n){for(var e,i,r,o,a,u,s,c,e=this,i=e.wB,r=e.UW,o=i.length-1;0<=o;o--)u=(a=i[o]).bZ,s=a.yZ,t<=u&&u<t+n&&e.remove(u,s);for(o=0;o<i.length;o++)t<(a=i[o]).bZ&&e.EK(a,a.bZ-n,a.yZ);for(o=0;o<r.length;o++)(c=r[o]).LQ()&&c.xP(t,n)},e.prototype.NP=function(t,n){for(var e,i,r,o,a,u,s,c,e=this,i=e.wB,r=e.UW,o=i.length-1;0<=o;o--)u=(a=i[o]).bZ,t<=(s=a.yZ)&&s<t+n&&e.remove(u,s);for(o=0;o<i.length;o++)t<(a=i[o]).yZ&&e.EK(a,a.bZ,a.yZ-n);for(o=0;o<r.length;o++)(c=r[o]).LQ()&&c.NP(t,n)},e.prototype.pZ=function(){return this.MZ},e.prototype.qQ=function(t){var n=this;t&&t!==n.MZ&&(n.CZ(),n.MZ=t)},e.prototype.CZ=function(){var t,n,e,t=this,n=t.MZ;n&&(e=t.mW(n))&&!e.iQ&&!e.Eb&&(e.uQ()&&e.$Q(),n.commentState(D.normal),t.MZ=h)},e.prototype.$c=function(t){var n,e,n=this,e=n.mW(t);e||(e=new Cn(t,n),n.UW.push(e)),e.rQ()},e.prototype.wW=function(t){var n=this,e=n.MZ;if(e)if(1===e.displayMode()){if(e.commentState()===D.edit)return}else if(e.commentState()===D.edit||e.commentState()===D.active)return;t!==n.PW&&(n.PW&&n.NK(n.PW),t&&2===t.displayMode()?n.RW.BW||t.BK||((n.PW=t).BK=vt.setTimeout(function(){n.$c(t)},200)):n.PW=h)},e.prototype.NK=function(t){var n=this,e=n.mW(t);e&&e.LQ()&&(e.lQ(),t===n.MZ)&&n.Mf.cR(),clearTimeout(t.BK),delete t.BK},e.prototype.LK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,A.GC$)(t.YW).show()},e.prototype.FK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,A.GC$)(t.YW).hide()},e.prototype.PK=function(t,n,e){var t,t,t=this.mW(t);return!(!t||!(t=t.pK()))&&t.contains(n,e)},e.prototype.GK=function(t,n,e){var t,t,t=this.mW(t);return!(!t||!(t=t.bK()))&&t.contains(n,e)},e.prototype.hitTest=function(t,n){for(var e,i,r,o,e=this,i=h,r=0;r<e.wB.length;r++)o=e.wB[r],xn(e.Mf,o)&&e.PK(o,t,n)&&(!i||o.zIndex()>i.zIndex())&&(i=o);return i?{x:t,y:n,comment:i,area:e.GK(i,t,n)?Vt:zt}:h},e.prototype.nK=function(t){var n=this,e=n.RK();return t===n.PW?e+2:t===n.MZ?e+1:t.zIndex()},e.prototype.jK=function(){this.UW.forEach(function(t){t.TQ()})},e.prototype.fromJSON=function(t,n){var e,i,r,o,e=this;if(t&&0!==t.length){for(i=e.GW=0;i<t.length;i++)r=t[i],(o=new gn).fromJSON(r,n),3!==o.commentState()&&(e.MZ=o),e.Mf.Ut.pI.WB(o.bZ,o.yZ,o,!0);e.Mf.zw()}},e.prototype.yh=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=this;if(t&&n){for(r.GW=0,o=S(t,"commentList"),a=it(n,"shape"),o=o.c_,u=0;u<o.length;u++)s=o[u],h=En(a,f=(c=new gn).bZ=A.IndexHelper.qi(s.ref),l=c.yZ=A.IndexHelper.$i(s.ref)),s.lossless&&(c.showShadow(s.lossless.showShadow),c.indicatorSize(s.lossless.indicatorSize),c.indicatorColor(s.lossless.indicatorColor),c.ignoreDefaultLocation(s.lossless.ignoreDefaultLocation),c.commentState(s.lossless.commentState)),c.yh(r.Mf,s,h,e,i),3!==c.commentState()&&(r.MZ=c),r.Mf.Ut.pI.WB(c.bZ,c.yZ,c,!0);r.Mf.zw(),r.Pfe=S(t,"authors")}},e.prototype.toJSON=function(){var t,n,e,t=this.wB;if(!t||0===t.length)return d;for(n=[],e=0;e<t.length;e++)n.push(t[e].toJSON());return 0===n.length?d:n},Sn=e,ae.prototype.L0=function(){this.Mf=h},ae.prototype.ZW=function(){var t=r(f);return(0,A.GC$)(t).addClass("gc-comment-layoutPanel"+Gt+Pt).css([o,p,b,m,v,u,It,Ut],[a,0,0,0,0,At,Lt,Ht]),t},ae.prototype.bW=function(t){var n,e,i,e,n=this;t.Ut.pI.Oy()||(e=t.Fi(),(0,A.GC$)(n.YW).css(p,e.x+e.XC).css(b,e.y+e.qC),n.Mf!==t&&(n.Mf&&(e=(i=n.Mf.Ut).pI.pZ())&&e.commentState()===D.edit&&e.commentState(D.active,!0),n.Mf=t))},ae.prototype.yW=function(t,n,e){var i,r,o,a,u,e,s,n,s,i,i=e.row,r=e.col,o=e.x,a=e.y,u=R(e),e=E(e),s=this;n===A.SheetArea.viewport&&s.Mf&&(n=s.Mf.Ut.pI.get(i,r))&&(s=this.Mf,i=(n.indicatorSize()||6)*(s?s.zoom():1),t)&&0<u&&0<e&&(t.save(),t.rect(o,a,u,e),t.clip(),t.fillStyle=n.indicatorColor()||"red",t.beginPath(),t.moveTo(o+u-i,a),t.lineTo(o+u,a),t.lineTo(o+u,a+i),t.lineTo(o+u-i,a),t.fill(),t.restore())},ae.prototype.WW=function(t){var n,e,i,r,o,a,a;if(this.VW){for(t.LK(),n=this.Mf,e=t.all(),i=0;i<e.length;i++)r=e[i],o=t.mW(r),this.UK(t,r)?(1===r.displayMode()&&r===t.PW&&(t.PW=h),o&&o.LQ()?o.fQ():t.$c(r)):o&&o.LQ()&&t.NK(r);(a=t.pZ())&&(a=t.mW(a))&&a.LQ()&&0<n.getSelections().length&&n.Ut.do("clearSelection")}else t.FK()},ae.prototype.UK=function(t,n){var e=t.Mf;if(e&&Wn(e,n.yZ)&&Zn(e,n.bZ))switch(n.displayMode()){case 1:return!0;case 2:if(3!==n.commentState())return t&&n!==t.PW&&(t.PW=n),!0;if(n===t.PW)return!0}return!1},Tn=ae,n=s.Y8,s.GC$.extend(n.prototype,{MW:function(t){var n,e,n=this.G8;n&&(e=(e=n.commentChanges)||(n.commentChanges=[])).push(t)},HK:function(t,n){var e,i,r,o,a,u,u,s,e,i=this.pI;if(t)for(r=0;r<t.length;r++)a=(o=t[r]).comment,"add"===o.type?((u=new gn).fromJSON(a),(a=u).commentState(3)):a=i.get(a.rowIndex,a.colIndex),"add"===o.type?i.WB(o.row,o.col,a):"remove"===o.type?i.DK(o.row,o.col):"property"===o.type?(u=o.name,s=o.newValue,"commentState"!==u&&a[u](s)):"rowcol"===o.type&&i.EK(a,o.newRow,o.newCol);else n&&"changeComment"===n.cmd&&"commentState"!==n.propertyName&&(a=i.get(n.row,n.col))[n.propertyName](n.newValue)},zK:function(t){var n,e,i,r,o,a,u;if(t)for(e=(n=this).pI,i=t.length-1;0<=i;i--)o=(r=t[i]).comment,"add"===r.type?e.DK(r.row,r.col):"remove"===r.type?e.WB(r.row,r.col,r.comment):"property"===r.type?(a=r.name,u=r.value,o[a](u)):"rowcol"===r.type&&e.EK(o,r.row,r.col)},OL:function(t,n,e,i){for(var r,o,a,r=this,o=0;o<e;o++)for(a=0;a<i;a++)0===o&&0===a||r.getCell(t+o,n+a).comment()&&r.comments.remove(t+o,n+a)}}),n.ch("comments",{init:function(){this.pI=new Sn(this.Mf)},applyChanges:function(t){var n,e,i,t,i,n=this,e=t.command,i=t.changes,t=t.isUndo,i=i&&i.commentChanges;(i||e)&&(t?n.zK(i):n.HK(i,e))},undo:function(t){var t=t.commentChanges;t&&this.zK(t)},dispose:function(t){var n=this,t=t&&t.clearCache;n.pI&&n.pI.dispose(t),!1!==t&&(n.pI=h)}}),A.Worksheet.ch("comments",An={getUsedRange:function(t){var n,e,i;t.type&A.UsedRangeType.comment&&(i=(e=(n=this).comments).getUsedRange(),mt(t.range,i))},init:function(){var n=this;n.comments=n.Ut.pI,n.pW=function(){var t=n.parent;if(t)return t.VK||(t.VK=new Tn(t.j2())),(t.VK.Mf=n).parent.VK}},dispose:function(t){!1!==t.clearCache&&(this.pW=h,this.comments=h),dn(this,(0,A.GC$)(this.Dg()))},setHost:function(t){var n;t&&((n=this.Ut.pI)&&n.zW(),hn(t,this))},onLayoutChanged:function(t){var n,e,i,r,o,a,u;!et(t.sheetArea)&&3!==t.sheetArea||(e=(n=this).Ut.pI,i=t.changeType,r=t.row,o=t.rowCount,a=t.col,u=t.colCount,"addRows"===i?e.JO(r,o):"deletingRows"===i?e.xP(r,o):"addColumns"===i?e.qO(a,u):"deletingColumns"===i?e.NP(a,u):t.sheetArea===A.SheetArea.viewport&&("clear"===i?4==(4&t.type)&&e.clear(new s.Range(r,a,o,u)):"addSpan"===i?Hn.call(n,!0,r,a,o,u):"removeSpan"===i&&Hn.call(n,!1,r,a)))},paint:function(t){this.Ut.pI.Oy()||(Vn.call(this),this.CW(t.clipRect))},paintCell:function(t){t.isPrinting||t.sheetArea!==A.SheetArea.viewport||zn.call(this,t.ctx,t.sheetArea,t.cell)},toJson:function(t,n){var e;n&&n.ignoreStyle||(t.comments=this.Ut.pI.toJSON())},fromJson:function(t,n,e){var i,e,i;e&&e.ignoreStyle||t&&(e=n?t.commentManager:t.comments)&&this.Ut.pI.fromJSON(e,n)},lastNonNullRowAndCol:function(){var t,n,e,i,r,o,a,t=0,n=0,e=this.Ut.pI;if(e&&(i=e.UW)&&0<i.length)for(r=0,o=i.length;r<o;r++)(a=i[r])&&a.TZ&&(a.RQ>t&&(t=a.RQ),a.jQ>n)&&(n=a.jQ);return{lastNonNullRow:t,lastNonNullCol:n}},clearSelection:function(){this.Ut.pI.CZ()},processKeyDown:function(t){var n=this,e=n.Ut.pI.pZ();e&&n.rt.Pi(t.e)&&Nn(n,e)&&(e.commentState(2,!0),t.r=!0)},yh:function(t,n,e){var i,t,r,r,o,i,a,u,s,c,f,o,t,l,i=S(t,"legacyDrawing"),t=t.rels,r=e&&!1===e.includeStyles;if(i&&!r){for(r=this,o=t.c_,i=i&&i["r:id"],u=0,s=o;u<s.length;u++)if(0<(f=(c=s[u]).Target).indexOf(bt)){a=f.split("/").pop().slice(0,-4);break}o=A.Util.Gr(t,i,n),t=n.comments&&n.comments[a],(l=r.comments).yh(t,o,e,n)}},wh:function(t,n,e){var e,i,r,i,o,a;!t||e&&!1===e.includeStyles||(e=t.rels,i=this.comments&&this.comments.all(),r=this.parent.Cp,e&&i&&0<i.length&&(i=ft(e),a=this.wp,e.c_.push({n_:pt,Id:o=gt+i,Type:A.RelationshipConstants.hc,Target:"../"+A.XFileConstants.ou+a+"."+A.XFileConstants.Cr}),A.Util.Hr(t,r)))}}),s.Workbook.ch("comments",In={init:function(){P.SZ(this.commandManager())},dispose:function(){this.VK&&(this.VK.L0(),this.VK=h)},wh:function(t,n,e){var i,r,o,a,u,s,c,f,u,l,h,d,v,m,i,r=this.sheets;if(!e||!1!==e.includeStyles)for(o=0;o<r.length;o++)if(a=r[o],u=lt(t,a.name()),(c=(s=a.comments)&&s.all())&&0<c.length)for((f=A.Util.Ur(t,u)).c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600",spt:"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),u=s.Pfe||{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},l=t[bt+a.wp]={n_:bt,r_:[13,14,15,16],c_:[u,{n_:"commentList",c_:[]}]},h=A.Util.qr(a.wp,f),d=0;d<c.length;d++)(m=(v=c[d]).wh(h)).commentData&&(m.commentData.lossless={showShadow:v.showShadow(),indicatorSize:v.indicatorSize(),indicatorColor:v.indicatorColor(),ignoreDefaultLocation:v.ignoreDefaultLocation(),commentState:v.commentState()}),h++,f.c_.push(m.vmlDrawingData),l.c_[1].c_.push(m.commentData)}})},"./dist/plugins/conditional/conditional.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/conditional/conditional.js"),n),r(e("./dist/plugins/conditional/conditional.ns.js"),n)},"./dist/plugins/conditional/conditional.js":function(j,p,t){"use strict";var O,E,R,F,n,L,C,J,B,P,G,U,H,V,o,b,z,g,S,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,t,ft,lt,ht,dt,T,vt,w,A,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,t,kt,_t,Dt,jt,Ot,Et,Rt,Y,Ft,Lt,Bt,Pt,Gt,Z,Ut,Ht,Vt,zt,Yt,d,n,Zt,Wt,Qt,Jt,n,Kt,Xt,e,qt,I,$t,tn,nn,en,rn,v,on,an,un,sn,cn,x,fn,N,ln,hn,dn,vn,mn,gn,m,pn,f,l,h,bn,wn,yn,Mn,Cn,Sn,Tn,An,In,xn,Nn,y,e,i,kn,_n,Dn,jn,M,i,On,En,Rn,i,Fn,Ln,i,Bn,Pn,Gn,i,Un,Hn,Vn,zn,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,Yn,e,e,i,Zn,Wn,Qn,Jn,Kn;function Xn(t){return St(Tt(t))}function W(t){return t.rowCount}function Q(t){return t.colCount}function qn(t){return""===t.trim()}function $n(t){return""===t}function te(t){return T(t)?C.SheetArea.viewport:t}function ne(t,n,e,i){switch(i&&"string"==typeof n&&"string"==typeof e&&(n=n.toLowerCase(),e=e.toLowerCase()),t){case $t.equalsTo:return n===e;case $t.notEqualsTo:return n!==e;case $t.greaterThan:return e<n;case $t.greaterThanOrEqualsTo:return e<=n;case $t.lessThan:return n<e;case $t.lessThanOrEqualsTo:return n<=e;default:return!1}}function ee(t){return(null==t?void 0:t.fileType)===C.OpenSaveFileType.excel}function ie(t){var n,e,n={},e;return rt.YK(t,n)?n.value:typeof t===X&&t.toLowerCase()===q}function a(t,n){var e,i,e=(n=n||{}).formula;(i=this).offsetRow=0,i.offsetCol=0,i.conType("string"==typeof t?m[t]:t),T(n.compareType)||i.ZK(n.compareType),T(n.expected)||i.expected(n.expected),T(e)||i.formula("string"==typeof e?ft(b.trim(e),"="):e),T(n.item1)||i.item1(n.item1),T(n.item2)||i.item2(n.item2),T(n.customValueType)||i.customValueType(n.customValueType),T(n.type)||i.type(n.type),i.ranges(n.ranges),i.WK=g,i.QK=g}function re(t,n,e,i,r,o,a,u,s){var c=Math.round;switch(t.lineWidth=1,t.rect(o,a,u,s),e=c(++e),i=c(i),t.clip(),n.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:B.drawArrows(t,n.iconSetType,n.iconIndex,e,i,r);break;case 2:B.drawIconTypeIsTwo(t,n.iconSetType,n.iconIndex,e,i,r);break;case 3:B.drawStar(t,n.iconSetType,n.iconIndex,e,i,r);break;case 14:case 12:case 5:B.drawCircle(t,n.iconSetType,n.iconIndex,e,i,r);break;case 4:B.drawFlag(t,n.iconSetType,n.iconIndex,e,i,r);break;case 6:B.drawTrafficLight(t,n.iconSetType,n.iconIndex,e,i,r);break;case 7:B.drawIconTypeIsSen(t,n.iconSetType,n.iconIndex,e,i,r);break;case 8:B.drawIconTypeIsEight(t,n.iconSetType,n.iconIndex,e,i,r);break;case 9:B.drawIconTypeIsNine(t,n.iconSetType,n.iconIndex,e,i,r);break;case 18:B.drawSector(t,n.iconSetType,n.iconIndex,e,i,r);break;case 17:case 13:B.drawSignal(t,n.iconSetType,n.iconIndex,e,i,r);break;case 19:B.drawMagicCube(t,n.iconSetType,n.iconIndex,e,i,r)}}function oe(t,n,e){var i,r,o,a,u,i=[],r=t.row,o=t.rowCount,a=t.col,u=t.col+t.colCount-1;return a<n?n<=u&&u<=e?(i[0]=Y(r,a,o,n-a),i[1]=Y(r,n,o,u-n+1)):e<u&&(i[0]=Y(r,a,o,n-a),i[1]=Y(r,n,o,e-n+1),i[2]=Y(r,e+1,o,u-e)):a<=e&&(n<=u&&u<=e?i[1]=t:e<u&&(i[1]=Y(r,a,o,e-a+1),i[2]=Y(r,e+1,o,u-e))),i}function ae(t,n,e){var i,r,o,a,u,i=[],r=t.col,o=t.colCount,a=t.row,u=t.row+t.rowCount-1;return a<n?n<=u&&u<=e?(i[0]=Y(a,r,n-a,o),i[1]=Y(n,r,u-n+1,o)):e<u&&(i[0]=Y(a,r,n-a,o),i[1]=Y(n,r,e-n+1,o),i[2]=Y(e+1,r,u-e,o)):a<=e&&(n<=u&&u<=e?i[1]=t:e<u&&(i[1]=Y(a,r,e-a+1,o),i[2]=Y(e+1,r,u-e,o))),i}function r(t,n,e){var i=this;i.KK=!0,i.ruleType(t),i.style(n),i.ranges(e)}function ue(t,n){return t===I.cellValueRule&&(n===en.between||n===en.notBetween)}function se(t,n,e){var n,i,r,n;if(t&&n&&!(!(n=n[0])||n.row<0||n.col<0)){if(i=C.IndexHelper.nr(n.col)+(n.row+1),r="",r=n.rowCount===C.XmlConstants.Io?o("${0}:${1}",[C.IndexHelper.nr(n.col),C.IndexHelper.nr(n.col+n.colCount-1)]):n.colCount===C.XmlConstants.xo?o("${0}:${1}",[n.row+1,n.row+n.rowCount]):o("${0}${1}:${2}${3}",[C.IndexHelper.nr(n.col),n.row+1,C.IndexHelper.nr(n.col+n.colCount-1),n.row+n.rowCount]),n=Ie(e),"top10"===t.type)return t.bottom?t.percent?o("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",[r,t.rank,i]):o("SMALL(({0}),MIN({1},COUNT({0})))>={2}",[r,t.rank,i]):t.percent?o("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",[r,t.rank,i]):o("LARGE(({0}),MIN({1},COUNT({0})))<={2}",[r,t.rank,i]);if("containsText"===t.type)return o('NOT(ISERROR(SEARCH("{0}",{1})))',[n,i]);if("notContainsText"===t.type)return o('ISERROR(SEARCH("{0}",{1}))',[n,i]);if("beginsWith"===t.type)return o('LEFT({0},{1}) = "{2}"',[i,e.length,n]);if("endsWith"===t.type)return o('RIGHT({0},{1}) = "{2}"',[i,e.length,n]);if("duplicateValues"===t.type)return o("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",[r,i]);if("uniqueValues"===t.type)return o("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",[r,i]);if("aboveAverage"===t.type||"belowAverage"===t.type||"aboveOrEqualToAverage"===t.type||"belowOrEqualToAverage"===t.type){if("aboveAverage"===t.type&&T(t.stdDev))return o("{0}>AVERAGE({1})",[i,r]);if(!T(t.aboveAverage)){if(!(T(t.equalAverage)||t.aboveAverage||T(t.equalAverage))&&t.equalAverage&&T(t.stdDev))return o("{0}<=AVERAGE({1})",[i,r]);if(!t.aboveAverage&&T(t.stdDev))return o("{0}<AVERAGE({1})",[i,r])}if(!T(t.equalAverage)&&t.equalAverage&&T(t.stdDev))return o("{0}>=AVERAGE({1})",[i,r]);if(!T(t.stdDev))return T(t.aboveAverage)||t.aboveAverage?o("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",[i,r,t.stdDev]):o("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",[i,r,t.stdDev])}}return null}function ce(t){return t&&t.font&&0===t.font.indexOf("normal normal")&&delete t.font,t}function u(t,n,e,i,r,o,a,u,s,c){var t,e,t=Zn.call(this,t,e)||this,e=t;return e.ranges(n),e.operator(i),e.value1("string"==typeof r?b.trim(r):r),e.value2("string"==typeof o?b.trim(o):o),e.text(a),e.formula(u),e.type(s),e.rank(c),e.cached=!1,e.JK=g,t}function fe(t,n,e,i){var n,n,e,n=n.ranges(),n=Dt(n),e=J.formulaToExpression(t,e,n.r,n.c,i);return J.expressionToFormula(t,e,n.r,n.c,!i)}function le(t,n){this.type=t,this.value=n}function s(t,n,e,i,r,o,a,u,s,c,f){var t,f,n,e,i,r,o,a,u,s,c,t=Wn.call(this,t,g,f)||this,f=t;return f.KK=!1,f.lowestValueCached=g,f.highestValueCached=g,f.XK={},f.cached=!1,f.JK=g,n=n,e=e,i=i,r=r,o=o,a=a,u=u,s=s,c=c,arguments.length<=1&&(n=1,e=g,i=Rt(255,248,105,107),r=4,o=50,a=Rt(255,255,235,132),u=2,s=g,c=Rt(255,99,190,123)),f.minColor(i),f.minValue(e),f.minType(n),f.midColor(a),f.midValue(o),f.midType(r),f.maxColor(c),f.maxValue(s),f.maxType(u),t}function he(t){return t.c_[0]&&t.c_[0].c_[0]&&t.c_[0].c_[0].c_[0]}function c(t,n,e,i,r,o){var a,t,n,e,i,r,a=this,t=t,n=n,e=e,i=i,r=r;return 0===arguments.length&&(t=5,e=7,i=n=g,r=Rt(255,99,142,198)),(a=Qn.call(this,12,t,n,g,g,g,g,e,i,g,o)||this).KK=!1,a.Hc(r),a}function de(t,n,e){this.isGreaterThanOrEqualTo=t,this.iconValueType=n,this.iconValue=e}function k(t,n){var e,t,e=this,t=0===arguments.length?0:t;return(e=Jn.call(this,13,g,g,g)||this).KK=!1,e.ranges(n),e.Hc(t),e}function ve(t){return t="string"==typeof t&&"="!==t[0]?'="'+z.Vi(t,'"','""')+'"':t}function _(t,n,e,i){var t,i,t=Kn.call(this,t,S,i)||this,i=t;return i.style(e),i.state(n),t}function D(t){this.qK=[],this.$K=g,this.sE(),this.nJ=!0,this.eJ=t}function me(t,n,e,i,r){var o,a,u,s;if(!Yt(n))return n[t];for(o=$(n.length,e.length),a=0;a<o;a++)if((u=e[a]).contains(i,r,1,1))return(s=n[a])[t]}function ge(t,n){if(n)for(var e=0;e<n.length;e++)t.push(n[e])}function pe(t){for(var n,e,i,r,o,a,n=Z(t),e=0;e<n;e++)if(r=(i=t[e]).ranges)for(o=0;o<r.length;o++)if(1e3<(a=r[o]).rowCount)return 1}function be(t){for(var n,e,i,r,o,a,n=Z(t),e=0;e<n;e++)if(r=(i=t[e]).ranges())for(o=0;o<r.length;o++)if(1e3<(a=r[o]).rowCount)return 1}function we(t){for(var n,e,i,r,n=[],e=Z(t),r=0;r<e;r++)i=t[r],n.push(Y(i.row,i.col,W(i),Q(i)));return n}function ye(t,n){for(var e,i,e=0;e<t.length;e++)if((i=t[e])&&i.equals(n))return 1}function Me(t,n){for(var e,i,r,o,a,e=!0,i=!0,r=!0,o=n.iJ,a=0;a<o.length;a++)if(o[a].iconSetType!==t){e=!1;break}for(a=0;a<o.length;a++)if(o[a].iconIndex!==a){i=!1;break}for(a=0;a<o.length;a++)if(o[a].iconIndex!==o.length-1-a){r=!1;break}return!e||!i&&!r||!i&&!n.reverseIconOrder()}function Ce(t){return!(!t.ruleType||t.ruleType()!==I.dataBarRule)}function Se(t){var n;if(t.ruleType()===I.iconSetRule)return 3===(n=t.iconSetType())||2===n||19===n||Me(n,t)}function Te(t){return t.ruleType()===I.rowStateRule||t.ruleType()===I.columnStateRule}function Ae(t){var n,e,i,n,e=/</g,i=/>/g;return"string"==typeof t?t.replace(/&/g,"&amp;").replace(e,"&lt;").replace(i,"&gt;"):T(t)?t:""+t}function Ie(t){return"string"==typeof t?t.replace(/"/g,'""'):T(t)?t:""+t}function xe(t){var t=t.c_&&t.c_[0];if(t)return wt(t,"cfvo")}function Ne(t){var t,t,t=t.c_&&t.c_[0];return t&&(t=wt(t,"color"))&&0<t.length?t.map(function(t){return Mt(t)}):[]}function ke(t,n,e){switch(t){case"cellIs":return jn[n];case"containsText":return rn.contains;case"beginsWith":return rn.beginsWith;case"endsWith":return rn.endsWith;case"notContainsText":return rn.doesNotContain;case"timePeriod":return x[e]}}function _e(t,n,e){var i,r,o;switch(t){case I.cellValueRule:return i={type:"cellIs"},T(e)||(i.operator=jn[e]),i;case I.specificTextRule:return r="containsText",o="contains",2===e?o=r="beginsWith":3===e?o=r="endsWith":1===e?(r="notContainsText",o="notContains"):0===e&&(o="containsText"),i={type:r,operator:o};case I.formulaRule:return i={type:"expression"},T(e)||(i.operator=e),i;case I.dateOccurringRule:return i={type:"timePeriod"},T(n)||(i.timePeriod=Dn[n]),i;case I.top10Rule:return i={type:"top10"},T(e)||(i.operator=e),i;case I.uniqueRule:return i={type:"uniqueValues"},T(e)||(i.operator=e),i;case I.duplicateRule:return i={type:"duplicateValues"},T(e)||(i.operator=e),i;case I.averageRule:return i={type:"aboveAverage"},T(e)||(i.operator=e),i;case I.twoScaleRule:return i={type:"colorScale"},T(e)||(i.operator=e),i;default:return}}function De(t){var n;return{num:0,min:1,max:2,percent:3,percentile:4,formula:6,autoMin:5,autoMax:7}[t]}function je(t){var n;return{0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"}[t]}function Oe(t){var n;return{"3Arrows":0,"3ArrowsGray":1,"3Flags":4,"3TrafficLights1":5,"3TrafficLights2":6,"3Signs":7,"3Symbols":8,"3Symbols2":9,"4Arrows":10,"4ArrowsGray":11,"4RedToBlack":12,"4Rating":13,"4TrafficLights":14,"5Arrows":15,"5ArrowsGray":16,"5Rating":17,"5Quarters":18,"3Stars":3,"3Triangles":2,"5Boxes":19,NoIcons:20}[t]}function Ee(t){var n;return{0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"}[t]}function Re(t){var n,t,n,t={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8}[t];return t!==S?t:1}function Fe(t){var n;return{1:"num",4:"percent",5:"percentile",7:"formula"}[t]}function Le(t){var n;return{num:1,percent:4,percentile:5,formula:7}[t]}function Be(t){return"lowestValue"===t||"highestValue"===t}function Pe(t){return"string"==typeof(t=Tt(t))&&"="!==t.charAt(0)?"="+t:t}function Ge(t,n){for(var e,i,r,e=0,i=t.length;e<i;e++)if(r=t[e].rJ,!T(r)&&r===n)return t[e]}function Ue(t,n){var e;return T(t.val)?T(n)||(e=V(Tt(n.c_&&n.c_[0]))):e=t.val,e}function He(t,n,e){for(var i,r,o,i=0,r=t;i<r.length;i++)if((o=r[i]).rule===e)return void(ye(o.ranges,n)||o.ranges.push(n));t.push({rule:e,ranges:[n]})}function Ve(t,n,e){for(var i,r,o,i=0,r=t;i<r.length;i++)if((o=r[i]).rule===n)return void(o.rule=e)}function ze(t,n,e){for(var i,r,o,i=0,r=t;i<r.length;i++)if((o=r[i]).rule===e&&ye(o.ranges,n))return 1}function Ye(t,n){if(10===t){if(3===n)return{iconSetType:0,iconIndex:2};if(0===n)return{iconSetType:0,iconIndex:0}}else if(15===t){if(4===n)return{iconSetType:0,iconIndex:2};if(0===n)return{iconSetType:0,iconIndex:0};if(2===n)return{iconSetType:0,iconIndex:1};if(3===n)return{iconSetType:10,iconIndex:2};if(1===n)return{iconSetType:10,iconIndex:1}}else if(11===t){if(3===n)return{iconSetType:1,iconIndex:2};if(0===n)return{iconSetType:1,iconIndex:0}}else if(16===t){if(4===n)return{iconSetType:1,iconIndex:2};if(0===n)return{iconSetType:1,iconIndex:0};if(2===n)return{iconSetType:1,iconIndex:1};if(3===n)return{iconSetType:11,iconIndex:2};if(1===n)return{iconSetType:11,iconIndex:1}}else if(14===t){if(3===n)return{iconSetType:5,iconIndex:2};if(2===n)return{iconSetType:5,iconIndex:1};if(1===n)return{iconSetType:5,iconIndex:0}}else if(13===t){if(0===n)return{iconSetType:17,iconIndex:1};if(1===n)return{iconSetType:17,iconIndex:2};if(2===n)return{iconSetType:17,iconIndex:3};if(3===n)return{iconSetType:17,iconIndex:4}}return{iconSetType:t,iconIndex:n}}O=this&&this.__extends||(zn=function(t,n){return(zn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}zn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(p,"__esModule",{value:!0}),p.ConditionalFormats=p.StateRule=p.IconSetRule=p.IconCriterion=p.DataBarRule=p.ScaleRule=p.ScaleValue=p.NormalConditionRule=p.ConditionRuleBase=p.Condition=p.oJ=p.aJ=p.ConditionType=p.IconValueType=p.IconSetType=p.DataBarAxisPosition=p.BarDirection=p.ScaleValueType=p.AverageConditionType=p.QuarterType=p.DateOccurringType=p.Top10ConditionType=p.DateExConditionExpectType=p.DateCompareType=p.CustomValueType=p.ColorCompareType=p.TextCompareType=p.TextComparisonOperators=p.ComparisonOperators=p.LogicalOperators=p.GeneralComparisonOperators=p.RuleType=void 0,E=t("Common"),R=t("Core"),F=t("CalcEngine"),n=t("./dist/plugins/conditional/conditional.ns.js"),L=t("CalcEngine"),C=t("Core"),J=t("SheetsCalc"),B=t("./dist/plugins/conditional/conditionalFormatIcon.js"),P=C.UsedRangeUtil.vh,G=C.UsedRangeUtil.hh,U=C.XFileConstants.Au,H=C.XFileConstants.ju,V=C.Util.mr,o=E.Common.zf.I5,b=R.GC$,z=E.Common.zf,g=null,S=void 0,K="undefined",X="string",q="true",$=Math.min,tt=Math.max,nt=Math.abs,et=Math.floor,it=Math.ceil,rt=F.Convert,ot=rt.q8,at=rt.uJ,ut=rt.sJ,st=String.fromCharCode(32),ct=String.fromCharCode(160),t=E.Common.zf,ft=t.cJ,lt=t.fJ,ht=t.dT,dt=t.OS,T=E.Common.lt.ht,vt=E.Common.$T,w=E.Common.ut,A=R.mt,mt=A.t1,gt=C.mt.getFormulaString,pt=A.vo,bt=C.IndexHelper.nr,wt=A.go,yt=A.h1,Mt=A.d1,Ct=A.xr,St=A.g1,Tt=A.n1,At=A.Hue,It=A.c1,xt=C.range_parser.Dc,Nt=C.range_parser.getRangeString,t=R.$e,kt=A.G0,_t=A.C1,Dt=A.z0,jt=!!F,Ot=R.Style,Et=E.Common.ft,Rt=Et.j,Y=R.Ec,Ft=R.Range,Lt=E.Common.ct,Bt=E.Common.Uf,Pt=Bt.VP,Gt=Bt.hD,Z=Bt.tR,Ut=F.Functions,Ht=F.evaluateOperator,Vt=R.Pf,zt=C.Util.no,Yt=Array.isArray,d=C.NodeHelper.ur,n=new E.Common.ResourceManager(n.SR,"ConditionalFormatting"),Zt=n.getResource.bind(n),Wt=function(t){return/[\f\n\r\t\v]/.test(t)},Qt=function(t){var n,e,n=t.row<0?J.BAND_INDEX_CONST:t.row,e=t.col<0?J.BAND_INDEX_CONST:t.col;return(0,L.lJ)(g,g,n,e,n+t.rowCount-1,e+t.colCount-1)},Jt=function(t){var n;if(t instanceof F.Expression)n=t;else if(t instanceof Ft)n=Qt(t);else{if(!ot(t))throw Zt().Exp_NotSupport;t=at(t),isNaN(t)||((n=new F.Expression(2)).value=t)}return n},n=function(t,n,o,a){var u,s,t,u=t,s=n,t=function(t,n){var e,i,r,e=this;return e.hasOwnProperty("_ps")||(e._ps={}),i=e._ps,0===arguments.length?i[u]!==S?a?a.call(e,i[u]):i[u]:s:(i[u]!==t&&(r=i[u]!==S?i[u]:s,i[u]=t,!1!==n)&&o&&o.call(e,t,r),e)};return t.isDefault=function(t){return t===s},t},Kt=function(o,t,a){var u=this;return a=a||{},t=t||u,T(u.pivotTableName)||(a.pivot=!0),b.each(t,function(t,n){var e,i,r,e=u[n];T(e)||(i=e.call(u),"formula"===n?(u.getFormulaString?i=u.getFormulaString(o,S,S,!0):u.condition()&&u.condition().getFormulaString&&(i=u.condition().getFormulaString(o,S,S,!0)),i&&(a[n]=i)):"style"===n&&Yt(i)?(r=i.map(function(t){return t.toJSON()}),a[n]=r):"iconCriteria"===n||"icons"===n?a[n]=i:Lt.W0(i)?a[n]=Lt.Q0(i):i&&i.toJSON?a[n]=i.toJSON(o):T(i)||e.isDefault(i)||(a[n]=i))}),a},Xt=function(h,t,d,v){var m,g;d&&(m=this,b.each(t=t||m,function(t,n){var e,i,r,o,a,u,s,c,f,l,o;if(g=d[n],!T(g))if("ranges"===n){for(e=[],i=0;i<g.length;i++)r=g[i],e.push(Y(r.row,r.col,W(r),Q(r)));m.ranges(e,!1)}else if("style"===n)Yt(g)?(o=g.map(function(t){var n=new Ot;return n.fromJSON(t,v),n}),m.style(o)):(m.style(new Ot,!1),m.style().fromJSON(g,v));else if("iconCriteria"===n)for(a=g.length,u=0;u<a;u++)s=g[u],m.hJ[u]=new Bn(s.isGreaterThanOrEqualTo,s.iconValueType,s.iconValue);else if("icons"===n)for(c=g.length,f=0;f<c;f++)l=g[f],m.iJ[f]={iconSetType:l.iconSetType,iconIndex:l.iconIndex};else"iconSetType"===n?m[n](g,!0):"item1"===n||"item2"===n?(m[n]((0,p.aJ)(),!1),m[n]().fromJSON(g,h)):"expected"===n?b.getType(g)!==X||5!==d.conType&&13!==d.conType?m[n](g,!1):"/OADate("===g.substr(0,8)?m[n](Lt.dJ(g),!1):m[n](new Date(g)):"condition"===n?((o=new y).fromJSON(g,h),m.condition(o,!1)):b.getType(g)===X&&"/OADate("===g.substr(0,8)?m[n](Lt.dJ(g),!1):m[n](g,!1)}))},e=R.Y8,b.extend(e.prototype,{vJ:function(t){var n,e,n,n=this,e=n.G8;!e||!t&&e.originalConditionalRules||(n=n.mJ.qK.map(function(t){return{rule:t,ranges:t.ranges().slice()}}),t?e.currentConditionalRules=n:e.originalConditionalRules=n)},gJ:function(t){var i=this.mJ,r=this.Mf;r.suspendPaint(),t&&(0===t.length&&i.qK&&1===i.qK.length&&i.constructor.et(r,"onRuleUpdated",{ranges:i.qK[0].ranges()}),i.qK=t.map(function(t){var n,e,n=t.rule,e=t.ranges;return"Object"===n.constructor.name&&(n=i.pJ(t.rule,r,!1),e=e.map(function(t){return new Ft(t.row,t.col,t.rowCount,t.colCount)})),n.ranges(e),i.constructor.et(r,"onRuleUpdated",{ranges:n.ranges()}),n}),i.C8()),r.resumePaint()},bJ:function(t,n,e,i){this.vJ(),this.mJ.JO(t,n,e,i),this.vJ(!0)},yJ:function(t,n,e,i){this.vJ(),this.mJ.xP(t,n,e,i),this.vJ(!0)},wJ:function(t,n,e,i){this.vJ(),this.mJ.qO(t,n,e,i),this.vJ(!0)},MJ:function(t,n,e,i){this.vJ(),this.mJ.NP(t,n,e,i),this.vJ(!0)},CJ:function(){this.vJ(),this.mJ.dl(),this.vJ(!0)},SJ:function(){this.vJ(),this.mJ.C8()}}),e.ch("conditionalFormat",{init:function(){this.mJ=new Vn(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalConditionalRules:n.currentConditionalRules)&&this.gJ(t)},undo:function(t){var t=t.originalConditionalRules;t&&this.gJ(t)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.mJ&&(n.mJ.L0(),n.mJ=g)}}),R.Worksheet.ch("conditionalFormat",qt={init:function(){this.conditionalFormats=this.Ut.mJ},getUsedRange:function(t){var n,e,i;t.type&C.UsedRangeType.conditionFormat&&(i=(e=(n=this).conditionalFormats).getUsedRange(),P(t.range,i))},dispose:function(t){var t;!1!==t.clearCache&&(t=this.conditionalFormats)&&t.TJ()},onLayoutChanged:function(t){var n,e,i,r,o,t,a,u,s,n=t.changeType,e=t.row,i=W(t),r=t.col,o=Q(t),t=t.sheetArea,a=T(t)||t===C.SheetArea.viewport,u=this.Ut,s=this.tables;"addRows"===n&&a?u.bJ(e,i,s&&s.AJ(e,-1,i,-1,!0),!1):"deleteRows"===n&&a?u.yJ(e,i):"addColumns"===n&&a?u.wJ(r,o):"deleteColumns"===n&&a?u.MJ(r,o):"clear"===n?u.CJ():"setColumnCount"!==n&&"setRowCount"!==n||3!==t&&1!==t||u.SJ()},toJson:function(t,n){var e,n,e=this.conditionalFormats,n=n&&n.ignoreStyle;e&&!n&&(t.conditionalFormats=e.toJSON(this))},fromJson:function(t,n,e){var e=e&&e.ignoreStyle;t&&t.conditionalFormats&&!e&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,n,!0)},wh:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,g,r,b,i=this,r=e&&!1===e.includeStyles,o=i.conditionalFormats;if(!r&&o&&J&&!i.NMi&&(a=o.qK)&&0<a.length){for(u=n.styleManager,s=t.c_,c=[],h=l=f=void 0,d=0,v=a.length;d<v;d++)g=(m=a[d]).ruleType(),p=!0,Se(m)||Ce(m)?(c.push(m.IJ()),Se(m)&&(p=!1)):g===I.formulaRule&&A.e1(m.D5,i.name(),i.parent&&i.parent.r4())&&(f||(l=new C.SimpleSharedStrings,h=new C.SimpleSharedStrings,f=new C.SharedDxfs(l,h)),c.push(m.IJ(f)),p=!1),Te(m)?(t.lossless||(t.lossless={}),t.lossless.stateRules||(t.lossless.stateRules=[]),t.lossless.stateRules.push(m.toJSON())):p&&(g=m.wh(u,void 0,void 0,e,i))&&(g.lossless?(t.lossless.dateOccurringRules||(t.lossless.dateOccurringRules=[]),t.lossless.dateOccurringRules.push(g.lossless)):s.push(g));0<c.length&&((r=Ct(t,U)).c_.push(b={n_:"ext",r_:[1,3],c_:[{n_:"conditionalFormattings",c_:c}]}),f)&&(r.lossless={sharedDxfs:f.iv(),sharedColors:l.wh(),commonSharedStrings:h.wh()})}},yh:function(t,r,o){var a,n,u,s,c,n,e,i,f,l,a=this,n=o&&!1===o.includeStyles,u=this.conditionalFormats,s=u.qK,c=C.Util.Co(o);if(J&&u&&!n){for(n=wt(t,H),e=Ct(t,U),i=At(e,"conditionalFormattings"),f=r.styleManager,n&&0<n.length&&n.forEach(function(t){var e,i,n,e=C.NodeHelper.ur(t.pivot),i=xt(t.sqref);c&&C.Util.Ao(a,i,!0,r),(n=t.c_).forEach(function(t){var n=u.xJ(t,i,f,a,o);n&&(n.pivot=e,T(t.priority)||n.priority(+t.priority),s.push(n))})}),u.NJ(i,r,a,s,e,c),l=s.length-1;-1<l;l--)s[l].pivot&&s.splice(l,1);t.lossless&&t.lossless.stateRules&&0<t.lossless.stateRules.length&&t.lossless.stateRules.forEach(function(t){var n=new Hn;n.fromJSON(t,a),u.qK.push(n)}),t.lossless&&t.lossless.dateOccurringRules&&0<t.lossless.dateOccurringRules.length&&t.lossless.dateOccurringRules.forEach(function(t){var n=new M;n.fromJSON(t,a),u.qK.push(n)}),u.nJ=!be(u.qK),u.C8()}}}),R.Workbook.ch("conditionalFormat",{fromJson:function(t,n,e){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},yh:function(t,n,e){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},onCultureChanged:function(){Zt()}}),(e=I=p.RuleType||(p.RuleType={}))[e.conditionRuleBase=0]="conditionRuleBase",e[e.cellValueRule=1]="cellValueRule",e[e.specificTextRule=2]="specificTextRule",e[e.formulaRule=3]="formulaRule",e[e.dateOccurringRule=4]="dateOccurringRule",e[e.top10Rule=5]="top10Rule",e[e.uniqueRule=6]="uniqueRule",e[e.duplicateRule=7]="duplicateRule",e[e.averageRule=8]="averageRule",e[e.twoScaleRule=10]="twoScaleRule",e[e.threeScaleRule=11]="threeScaleRule",e[e.dataBarRule=12]="dataBarRule",e[e.iconSetRule=13]="iconSetRule",e[e.rowStateRule=14]="rowStateRule",e[e.columnStateRule=15]="columnStateRule",(e=$t=p.GeneralComparisonOperators||(p.GeneralComparisonOperators={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",tn=[9,10,13,14,11,12],(e=nn=p.LogicalOperators||(p.LogicalOperators={}))[e.or=0]="or",e[e.and=1]="and",(e=en=p.ComparisonOperators||(p.ComparisonOperators={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",e[e.between=6]="between",e[e.notBetween=7]="notBetween",(e=rn=p.TextComparisonOperators||(p.TextComparisonOperators={}))[e.contains=0]="contains",e[e.doesNotContain=1]="doesNotContain",e[e.beginsWith=2]="beginsWith",e[e.endsWith=3]="endsWith",(e=v=p.TextCompareType||(p.TextCompareType={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.beginsWith=2]="beginsWith",e[e.doesNotBeginWith=3]="doesNotBeginWith",e[e.endsWith=4]="endsWith",e[e.doesNotEndWith=5]="doesNotEndWith",e[e.contains=6]="contains",e[e.doesNotContain=7]="doesNotContain",(e=on=p.ColorCompareType||(p.ColorCompareType={}))[e.backgroundColor=0]="backgroundColor",e[e.foregroundColor=1]="foregroundColor",(e=an=p.CustomValueType||(p.CustomValueType={}))[e.empty=0]="empty",e[e.nonEmpty=1]="nonEmpty",e[e.error=2]="error",e[e.nonError=3]="nonError",e[e.formula=4]="formula",(e=un=p.DateCompareType||(p.DateCompareType={}))[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.before=2]="before",e[e.beforeEqualsTo=3]="beforeEqualsTo",e[e.after=4]="after",e[e.afterEqualsTo=5]="afterEqualsTo",(e=sn=p.DateExConditionExpectType||(p.DateExConditionExpectType={}))[e.dateOccurring=0]="dateOccurring",e[e.yearOccurring=1]="yearOccurring",e[e.quarterOccurring=2]="quarterOccurring",e[e.monthOccurring=3]="monthOccurring",e[e.weekOccurring=4]="weekOccurring",e[e.dayOccurring=5]="dayOccurring",e[e.yearToDate=6]="yearToDate",(e=cn=p.Top10ConditionType||(p.Top10ConditionType={}))[e.top=0]="top",e[e.bottom=1]="bottom",(e=x=p.DateOccurringType||(p.DateOccurringType={}))[e.today=0]="today",e[e.yesterday=1]="yesterday",e[e.tomorrow=2]="tomorrow",e[e.last7Days=3]="last7Days",e[e.thisMonth=4]="thisMonth",e[e.lastMonth=5]="lastMonth",e[e.nextMonth=6]="nextMonth",e[e.thisWeek=7]="thisWeek",e[e.lastWeek=8]="lastWeek",e[e.nextWeek=9]="nextWeek",e[e.nextQuarter=10]="nextQuarter",e[e.thisQuarter=11]="thisQuarter",e[e.lastQuarter=12]="lastQuarter",e[e.nextYear=13]="nextYear",e[e.thisYear=14]="thisYear",e[e.lastYear=15]="lastYear",(e=fn=p.QuarterType||(p.QuarterType={}))[e.quarter1=0]="quarter1",e[e.quarter2=1]="quarter2",e[e.quarter3=2]="quarter3",e[e.quarter4=3]="quarter4",(e=N=p.AverageConditionType||(p.AverageConditionType={}))[e.above=0]="above",e[e.below=1]="below",e[e.equalOrAbove=2]="equalOrAbove",e[e.equalOrBelow=3]="equalOrBelow",e[e.above1StdDev=4]="above1StdDev",e[e.below1StdDev=5]="below1StdDev",e[e.above2StdDev=6]="above2StdDev",e[e.below2StdDev=7]="below2StdDev",e[e.above3StdDev=8]="above3StdDev",e[e.below3StdDev=9]="below3StdDev",(e=ln=p.ScaleValueType||(p.ScaleValueType={}))[e.number=0]="number",e[e.lowestValue=1]="lowestValue",e[e.highestValue=2]="highestValue",e[e.percent=3]="percent",e[e.percentile=4]="percentile",e[e.automin=5]="automin",e[e.formula=6]="formula",e[e.automax=7]="automax",(e=hn=p.BarDirection||(p.BarDirection={}))[e.leftToRight=0]="leftToRight",e[e.rightToLeft=1]="rightToLeft",(e=dn=p.DataBarAxisPosition||(p.DataBarAxisPosition={}))[e.automatic=0]="automatic",e[e.cellMidPoint=1]="cellMidPoint",e[e.none=2]="none",(e=vn=p.IconSetType||(p.IconSetType={}))[e.threeArrowsColored=0]="threeArrowsColored",e[e.threeArrowsGray=1]="threeArrowsGray",e[e.threeTriangles=2]="threeTriangles",e[e.threeStars=3]="threeStars",e[e.threeFlags=4]="threeFlags",e[e.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",e[e.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",e[e.threeSigns=7]="threeSigns",e[e.threeSymbolsCircled=8]="threeSymbolsCircled",e[e.threeSymbolsUncircled=9]="threeSymbolsUncircled",e[e.fourArrowsColored=10]="fourArrowsColored",e[e.fourArrowsGray=11]="fourArrowsGray",e[e.fourRedToBlack=12]="fourRedToBlack",e[e.fourRatings=13]="fourRatings",e[e.fourTrafficLights=14]="fourTrafficLights",e[e.fiveArrowsColored=15]="fiveArrowsColored",e[e.fiveArrowsGray=16]="fiveArrowsGray",e[e.fiveRatings=17]="fiveRatings",e[e.fiveQuarters=18]="fiveQuarters",e[e.fiveBoxes=19]="fiveBoxes",e[e.noIcons=20]="noIcons",(e=mn=p.IconValueType||(p.IconValueType={}))[e.number=1]="number",e[e.percent=4]="percent",e[e.formula=7]="formula",e[e.percentile=5]="percentile",Yn=gn=gn||{},gn[gn.contains=0]="contains",(e=m=p.ConditionType||(p.ConditionType={}))[e.relationCondition=0]="relationCondition",e[e.numberCondition=1]="numberCondition",e[e.textCondition=2]="textCondition",e[e.colorCondition=3]="colorCondition",e[e.formulaCondition=4]="formulaCondition",e[e.dateCondition=5]="dateCondition",e[e.dateExCondition=6]="dateExCondition",e[e.textLengthCondition=7]="textLengthCondition",e[e.top10Condition=8]="top10Condition",e[e.uniqueCondition=9]="uniqueCondition",e[e.averageCondition=10]="averageCondition",e[e.cellValueCondition=11]="cellValueCondition",e[e.areaCondition=12]="areaCondition",e[e.timeCondition=13]="timeCondition",e[e.stateCondition=14]="stateCondition",(e=pn=pn||{})[e.automatic=0]="automatic",e[e.middle=1]="middle",e[e.none=2]="none",f=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},l=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},h=function(t,n){t.setDate(n)},bn=function(t){return t.getDate()},wn=function(t,n){return t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()},yn=function(t,n){var e;return l(t)<n},Mn=function(t,n){return t<n},Cn=function(t,n){var e;return n<f(t)},Sn=function(t,n){return n<t},Tn=function(t,n){return t.getHours()===n.getHours()&&t.getMinutes()===n.getMinutes()&&t.getSeconds()===n.getSeconds()&&t.getMilliseconds()===n.getMilliseconds()},An=function(t,n){var e,i,e,i;return new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())<new Date(1899,11,30,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())},In=function(t,n){return!An(t,n)&&!Tn(t,n)},p.aJ=xn=function(t,n,e,i,r,o,a,u,s){return new y(t,{compareType:n,expected:e,formula:i,customValueType:r,type:o,ranges:a,item1:u,item2:s})},p.oJ=new Ot,Nn=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],a.prototype.context=function(t){var n,e;return 1===arguments.length&&(this.DJ=t,n=this.item1(),e=this.item2(),n&&n.context&&n.context(t),e)&&e.context&&e.context(t),this.DJ},a.prototype.U0=function(t){var n=this,e=n.item1(),i=n.item2();t?n.G3=!0:n._J=!0,e&&e.U0(t),i&&i.U0(t)},a.prototype.H0=function(){var t=this,n=t.item1(),e=t.item2();delete t.G3,delete t._J,n&&n.H0(),e&&e.H0()},a.prototype.initExpression=function(t,n,e){var i,r,i,r,r,t,o,r,i=this.item1(),r=this.item2();i&&i.initExpression&&i.initExpression(),r&&r.initExpression&&r.initExpression(),t=t||this.DJ,i=this.D5,t&&i&&!this.WK&&(e=this.ranges()?(n=(r=Dt(this.ranges())).r,r.c):(n=n||0,e||0),r=t.getCalcService(),t=t.Uw(),r)&&t&&(o=!1,this.G3&&(o=!this._J),this.WK=r.parse(t,i,n,e,!1,!0,o),r={expr:this.WK,baseRow:n,baseCol:e},a.et(t.getSheet(),"initConditionExpression",r))},a.prototype.expression=function(t,n,e,i){var r,r,o;return 1===arguments.length?(this.WK=t,n=n||this.DJ,t?n&&(i=this.ranges()?(e=(r=Dt(this.ranges())).r,r.c):(e=e||0,i||0),r=n.getCalcService(),o=n.Uw(),r)&&o&&(this.D5=r.unparse(o,t,e,i)):this.D5=t):this.WK||this.initExpression(n,e,i),this.WK},a.prototype.getFormulaString=function(t,n,e,i){var r,o,a;return t=t||this.DJ,r=this.WK,o=this.D5,!t||!o||(r||(this.initExpression(t,n,e),r=this.WK),o&&(r.value&&14===r.value.type||r.value2&&14===r.value2.type))?o:(a=Dt(this.ranges()),n=T(n)?a.r:n,e=T(e)?a.c:e,t.getCalcService().unparse(t.Uw(),r,n,e,S,!!i))},a.prototype.formula=function(t,n,e){var i,r;if("string"!=typeof t)return i=this.item1(),r=this.item2(),0===e&&i&&i.formula?i.formula(t,n,e):1===e&&r&&r.formula?r.formula(t,n,e):this.getFormulaString(S,t,n);this.D5=t,this.WK=g},a.prototype.adjustOffset=function(t,n){var e,i,e=this,i=e.item1();i&&i.adjustOffset&&i.adjustOffset(t,n),(i=e.item2())&&i.adjustOffset&&i.adjustOffset(t,n),e.offsetRow=t,e.offsetCol=n},a.prototype.relationConditionEvaluate=function(i,r,o,e,t){var a,n,t,u,s;function c(t,n){var e;return i&&t&&3===t.conType()&&(e=i.getActualStyle(r,o,3,!0))&&(0===t.ZK()?n=e.backColor:1===t.ZK()&&(n=e.foreColor)),n}function f(t,n){if(t)return t.ignoreBlank(a.ignoreBlank()),arguments.length<5?c(t,e):n}function l(t,n){return!T(t)&&t.evaluate(i,r,o,n)}return n=f((a=this).item1(),e),t=f(a.item2(),t),(u=l(a.item1(),n)?1:0)+(s=l(a.item2(),t)?1:0)>a.ZK()},a.prototype.cellValueConditionEvaluate=function(t,n,e,i){var n=this.getExpected(t,n,e);return!(n!==g||!t||!t.EJ)||this.cellValueConditionCheckCondition(n,i)},a.prototype.cellValueConditionCheckCondition=function(t,n){var e,i,r,o,a,u,e,s,e=this,i=0,r=!1,o=e.ZK();if(T(n)&&T(t))switch(o){case $t.equalsTo:case $t.greaterThanOrEqualsTo:case $t.lessThanOrEqualsTo:return!0;case $t.notEqualsTo:case $t.greaterThan:case $t.lessThan:default:return!1}if(a=tn[o],F.ExcelCompatibleCalcMode)return Ht(a,n,t);if("boolean"==typeof t||"boolean"==typeof n)return ne(o,n,t);if(u={},T(n))e.treatNullValueAsZero()?r=!0:i=n;else{if(typeof n===X&&"number"==typeof t)return ne(o,1,0);"boolean"!=typeof n&&ut(n,u)&&(i=u.value,r=!isNaN(i))}return e=0,s=!1,("number"==typeof t||t&&"string"==typeof t&&!qn(t))&&ut(t,u)&&(e=u.value,s=!0),r?s?ne(o,i,e):Ht(a,n,t):"string"==typeof n?s?Ht(a,n,e):"string"==typeof t?Ht(a,n,t):1===o:!!T(n)&&o===$t.notEqualsTo},a.prototype.numberConditionEvaluate=function(t,n,e,i){var n=this.numberConditionGetExpected(t,n,e);return!(n!==g||!t||!t.EJ)||(this.integerValue()&&(n=isNaN(n)?g:(0<n?et:it)(n)),this.numberConditionCheckCondition(n,i))},a.prototype.numberConditionCheckCondition=function(t,n){var e,i,r,e=this;if((T(n)||""===n)&&e.ignoreBlank())return!0;if(T(t)){if(e.ignoreBlank())return!0;t=0}try{i=T(n)?0:"string"==typeof n?C.mt.Xf(g,n,!0):parseFloat(n)}catch(t){return!1}return"number"==typeof i&&(!e.integerValue()||(r=i-et(i)==0))&&ne(e.ZK(),i,t)},a.prototype.numberConditionGetExpected=function(t,n,e){var i,r,i=this;return i.D5&&0<i.D5.length&&(r=t.op())?r.evaluate(t.Uw(),i.expression(g,t),n,e):i.expected()},a.prototype.textConditionEvaluate=function(t,n,e,i){var r,o,a,u,t,s;function c(t,n){return r.testTextByCondition(n,t,"^","$",function(){return a?t.toLowerCase()===n.toLowerCase():t===n})}function f(t,n){return r.testTextByCondition(n,t,"^","",function(){return lt(n,t,a)})}function l(t,n){return r.testTextByCondition(n,t,"","$",function(){return ht(n,t,a)})}function h(t,n){return r.testTextByCondition(n,t,"","",function(){return dt(n,t===S||t===g?"":t,a)})}if(o=(r=this).compareType(),a=r.ignoreCase(),!r.forceValue2Text()&&w(i,Date))return o!==v.beginsWith&&o!==v.endsWith&&o!==v.contains&&(o===v.doesNotBeginWith||o===v.doesNotEndWith||o===v.doesNotContain);if(u=T(i)?"":i.toString(),r.ignoreBlank()&&""===u)return!0;if(t=this.getExpected(t,n,e),s=T(t)?"":t.toString(),r.hasWildcard(s)&&"number"==typeof i)return o===v.doesNotBeginWith||o===v.doesNotContain||o===v.doesNotEndWith||o===v.notEqualsTo;switch(o){case v.equalsTo:return c(s,u);case v.notEqualsTo:return!c(s,u);case v.beginsWith:return f(s,u);case v.doesNotBeginWith:return!f(s,u);case v.endsWith:return l(s,u);case v.doesNotEndWith:return!l(s,u);case v.contains:return h(s,u);case v.doesNotContain:return!h(s,u);default:return!1}},a.prototype.hasWildcard=function(t){return-1<t.indexOf("*")||-1<t.indexOf("?")},a.prototype.testTextByCondition=function(t,n,e,i,r){var o,n,o;return this.useWildCards()?this.regex()?vt.qT(this.regex()).test(t):(n=vt.jJ(n))?(n=e+n+i,(this.ignoreCase()?vt.OJ(n):vt.qT(n)).test(t)):r():r()},a.prototype.colorConditionEvaluate=function(t,n,e,i){var r,o,i,t;function a(t){return T(t)||""===t?g:Et._(t)}if(o=a((r=this).expected()),T(o)||""===o){if(r.ignoreBlank()||T(o)&&T(i))return!0}else if(i=a(i),(T(i)||""===i)&&t&&t.getDefaultStyle&&(t=t.getDefaultStyle(),r.ZK()===on.backgroundColor?i=t.backColor:r.ZK()===on.foregroundColor&&(i=t.foreColor)),!T(i)&&""!==i)return E.Common.ft.Tv(i,o);return!1},a.prototype.formulaConditionEvaluate=function(t,n,e,i){var r,o,o,a;if(!jt)return!1;if((r=this).customValueType()===an.formula)return(o=r.DJ&&r.DJ.getDataSource&&r.DJ.getDataSource())&&o.RJ&&(t.Uw().DJ=o.RJ(n)),o=r.getExpected(t,n,e),!(!r.ignoreBlank()||!T(o)&&""!==o)||(!F.ExcelCompatibleCalcMode||"0"!==o)&&ie(o);switch(a=rt.BJ,r.customValueType()){case an.empty:return T(i)||""===i;case an.nonEmpty:return!T(i)&&""!==i;case an.error:return a(i);case an.nonError:return!a(i);default:return!1}},a.prototype.formulaConditionGetExpected=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this;if(i.D5&&0<i.D5.length){if(!(r=t.op()))return i.expected();if(o=t.Uw(),a=r.evaluateParsedFormula(o,i.expression(S,t),(0,L.eV)(n,e),!0),l=f=c=s=u=void 0,rt.LE(a)){for(u=a.getRowCount(0),s=a.getColumnCount(0),c=[],f=0;f<u;f++)for(c[f]=[],l=0;l<s;l++)c[f][l]=a.getValue(0,f,l);a=c}else if(rt.Nh(a)){for(u=a.getRowCount(),s=a.getColumnCount(),c=[],f=0;f<u;f++)for(c[f]=[],l=0;l<s;l++)c[f][l]=a.getValue(f,l);a=c}return w(a,Array)?a[0][0]:a}return i.expected()},a.prototype.dateOrTimeEvaluate=function(t,n,e,i,r,o,a){var u,s,c,i,u=this;if((T(i)||""===i)&&u.ignoreBlank())return!0;if(!w(s=i,Date)){if(u.ZK()===un.notEqualsTo)return!0;if(!T(i))return!1;s=Lt.Y0(0)}if(c=g,i=this.getExpected(t,n,e),w(i,Date)?c=i:"string"==typeof i?c=Lt.yU(i):"number"==typeof i&&(c=Lt.Y0(i)),T(c))return!!u.ignoreBlank();switch(u.ZK()){case un.equalsTo:return r(c,s);case un.notEqualsTo:return!r(c,s);case un.after:return a(c,s);case un.afterEqualsTo:return a(c,s)||r(c,s);case un.before:return o(c,s);case un.beforeEqualsTo:return o(c,s)||r(c,s);default:return!1}},a.prototype.dateConditionEvaluate=function(t,n,e,i){var r=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,n,e,i,wn,r?Sn:Cn,r?Mn:yn)},a.prototype.timeConditionEvaluate=function(t,n,e,i){return this.dateOrTimeEvaluate(t,n,e,i,Tn,In,An)},a.prototype.dateExConditionEvaluate=function(t,n,e,i){var t=this.LJ(t,n,e);return!T(t)&&this.dateExConditionCheckCondition(t,i)},a.prototype.getExConditionDateScope=function(t){var n,e,i,r,o,a,o,a,o,a,o,a,o,a,o,a,o,a,u,s,c,a,u,c,s,o,u,c,o,s,a,c,o,a,u,s,c,n=g,e=g,i=new Date,r=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds());switch(t){case x.last7Days:h(r,bn(r)-6),n=f(r),e=l(i);break;case x.yesterday:h(r,bn(r)-1),n=f(r),e=l(r);break;case x.today:n=f(i),e=l(i);break;case x.tomorrow:h(r,bn(r)+1),n=f(r),e=l(r);break;case x.lastWeek:h(o=i,bn(i)-i.getDay()-7),(a=r).setDate(bn(r)-r.getDay()-1),n=f(o),e=l(a);break;case x.thisWeek:h(o=i,bn(i)-i.getDay()),h(a=r,bn(r)-r.getDay()+6),n=f(o),e=l(a);break;case x.nextWeek:h(o=i,bn(i)-i.getDay()+7),h(a=r,bn(r)-r.getDay()+13),n=f(o),e=l(a);break;case x.lastMonth:h(o=i,1),o.setMonth(i.getMonth()-1),h(a=r,0),n=f(o),e=l(a);break;case x.thisMonth:h(o=i,1),h(a=r,1),a.setMonth(r.getMonth()+1),h(a,0),n=f(o),e=l(a);break;case x.nextMonth:h(o=i,1),o.setMonth(i.getMonth()+1),h(a=r,1),a.setMonth(r.getMonth()+2),h(a,0),n=f(o),e=l(a);break;case x.nextQuarter:u=(a=(o=i).getMonth())%3,o.setDate(1),o.setMonth(a-u+3),c=void 0,(s=r).setDate(1),s.setMonth(a-u+3+2),c=2===s.getMonth()||11===s.getMonth()?31:30,s.setDate(c),n=f(o),e=l(s);break;case x.thisQuarter:c=(u=(a=i).getMonth())%3,a.setDate(1),a.setMonth(u-c),o=void 0,(s=r).setDate(1),s.setMonth(u-c+2),o=2===s.getMonth()||11===s.getMonth()?31:30,s.setDate(o),n=f(a),e=l(s);break;case x.lastQuarter:o=(c=(u=i).getMonth())%3,u.setDate(1),u.setMonth(c-o-3),a=void 0,(s=r).setDate(1),s.setMonth(c-o-3+2),a=2===s.getMonth()||11===s.getMonth()?31:30,s.setDate(a),n=f(u),e=l(s);break;case x.nextYear:(c=i).setDate(1),c.setFullYear(c.getFullYear()+1),c.setMonth(0),(o=r).setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31),n=f(c),e=l(o);break;case x.thisYear:(a=i).setDate(1),a.setMonth(0),(u=r).setMonth(11),u.setDate(31),n=f(a),e=l(u);break;case x.lastYear:(s=i).setFullYear(s.getFullYear()-1),s.setDate(1),s.setMonth(0),(c=r).setFullYear(c.getFullYear()-1),c.setMonth(11),c.setDate(31),n=f(s),e=l(c)}return{from:n,to:e}},a.prototype.dateExConditionCheckCondition=function(t,n){var e,n,i,r,t,i,t,i,t,o,t,e;function a(t,n){switch(t){case fn.quarter1:return 0<=n.getMonth()&&n.getMonth()<=2;case fn.quarter2:return 3<=n.getMonth()&&n.getMonth()<=5;case fn.quarter3:return 6<=n.getMonth()&&n.getMonth()<=8;case fn.quarter4:return 9<=n.getMonth()&&n.getMonth()<=11;default:return!1}}if(n=n,(e=this).ignoreBlank()&&(T(n)||""===n))return!0;try{if(T(n)&&!e.treatNullValueAsZero())return!1;n=rt.r0(n)}catch(t){return!1}if((r=e.expectTypeId())===sn.dateOccurring){if(i=(t=this.getExConditionDateScope(t)).from,t=t.to,!T(i)&&!T(t))return i=(0,p.aJ)(m.dateCondition,un.afterEqualsTo,i,g),t=(0,p.aJ)(m.dateCondition,un.beforeEqualsTo,t,g),(o=(0,p.aJ)(m.relationCondition,nn.and,g,g,g,g,g,i,t)).evaluate(g,0,0,n)}else if(i=e.LJ(g,0,0),!T(i)){if(r===sn.yearOccurring)return i===n.getFullYear();if(r===sn.quarterOccurring)return a(i,n);if(r===sn.monthOccurring)return i===n.getMonth();if(r===sn.weekOccurring)return i===n.getDay();if(r===sn.dayOccurring)return i===bn(n);if(r===sn.yearToDate)return t=new Date,e=new Date,t.setMonth(0,1),t.setHours(0,0,0,0),e.setHours(23,59,59,999),t<=n&&n<=e}return!1},a.prototype.textLengthConditionEvaluate=function(t,n,e,i){var i,t;return!(!T(i)&&""!==i||!this.ignoreBlank())||(i=T(i)?0:i.toString().length,"number"==typeof(t=this.LJ(t,n,e))&&ne(this.ZK(),i,t))},a.prototype.top10ConditionEvaluate=function(t,n,e,i){var r,n,o,e,r=this;if(T(i)||""===i)return r.ignoreBlank();if(n=r.LJ(t,n,e),!T(n)&&(o=void 0,o=r.FJ?(T(r.PJ)&&(r.PJ=r.getTopValues(t,n,r.ranges())),r.PJ):r.getTopValues(t,n,r.ranges()))){e=0;try{e=r.uJ(i)}catch(t){return!1}if(Bt.OS(o,e))return!0}return!1},a.prototype.LJ=function(t,n,e){var t=this.getExpected(t,n,e),t=parseInt(t,10);return isNaN(t)||!isFinite(t)?g:t},a.prototype.adjustRange=function(t,n){return Y(t.row,t.col,Math.min(W(t),n.getRowCount()),Math.min(Q(t),n.getColumnCount()))},a.prototype.getTopValues=function(t,n,e){var i,r,o,a,u,s,c,c,f,l,h,i=0===this.type()?1:-1,r=[];if(e){for(o=this.GJ(t,e),a=Z(o),f=0;f<a;f++)for(u=this.adjustRange(o[f],t),l=0;l<W(u);l++)for(s=l+u.row,h=0;h<Q(u);h++)c=h+u.col,c=this.uJ(t.getValue(s,c)),T(c)||r.push(c);r.sort(function(t,n){return(n-t)*i}),Z(r)>n&&(r=r.slice(0,n))}return r},a.prototype.uJ=function(t){return("number"==typeof t||w(t,Date))&&jt?at(t):g},a.prototype.uniqueConditionEvaluate=function(t,n,e,i){var r,i,n,e,n,e,r=this,i=i;return T(i)||""===i?r.ignoreBlank():(jt&&ot(i)&&!Wt(i)&&!C.mt.isInfinityNumberString(i)&&(i=at(i)),n=this.getExpected(t,n,e),rt.YK(n,e={}),!T(n=e.value)&&(e=r.duplicatedArrayCached||r.getDuplicated(t,r.ranges()),!T(e)&&Bt.OS(e,i)?!0===n:!0!==n))},a.prototype.getDuplicated=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,d,v,e=[],i={},r=this.GJ(t,n);if(r)for(o=Z(r),a=0;a<o;a++)for(u=r[a],s=W(u=this.adjustRange(u,t)),c=Q(u),f=0;f<s;f++)for(l=f+u.row,h=0;h<c;h++)d=h+u.col,d=t.getValue(l,d,3),(v=i[d=T(d)||!jt||!ot(d)||Wt(d)||C.mt.isInfinityNumberString(d)?d:at(d)])?1===v&&e.push(d):i[d]=1;return e},a.prototype.UJ=function(t,n){for(var e,i,e=t.length,i=0;i<e;i++)if(t[i].key===n)return!0;return!1},a.prototype.averageConditionEvaluate=function(t,n,e,i){var r,o,o,a,u,t,s,c;if(!jt)return!1;if((r=this).ignoreBlank()&&(T(i)||""===i))return!0;if(r.HJ(),o=r.FJ?(T(r.PJ)&&(r.PJ=r.getExpected(t,n,e)),r.PJ):r.getExpected(t,n,e),a=ut(o,o={})?o.value:NaN,u=g,t=r.QK?r.zJ(t,r.QK,n,e):g,T(t)||(u=ut(t,o={})?o.value:NaN),isNaN(a)||!ot(i,!0))return!1;switch(s=at(i),c=isNaN(u),r.type()){case N.above:return a<s;case N.below:return s<a;case N.equalOrAbove:return a<=s;case N.equalOrBelow:return s<=a;case N.above1StdDev:return!c&&a+u<s;case N.below1StdDev:return!c&&s<a-u;case N.above2StdDev:return!c&&a+2*u<s;case N.below2StdDev:return!c&&s<a-2*u;case N.above3StdDev:return!c&&a+3*u<s;case N.below3StdDev:return!c&&s<a-3*u;default:return!1}},a.prototype.HJ=function(){var t=this;t.ranges()&&(t.WK=t.VJ("AVERAGE",t.ranges()),4<=t.type())&&t.type()<=9&&(t.QK=t.VJ("STDEV",t.ranges()))},a.prototype.VJ=function(t,n){var t,e,i,r;if(jt&&(t=Ut.findGlobalFunction(t))){for(e=[],i=Z(n),r=0;r<i;r++)e[r]=Jt(n[r]);return F.YJ(t,e)}return g},a.prototype.averageConditionGetExpected=function(t,n,e){var i=t.op();return i?i.evaluateParsedFormula(t.Uw(),this.expression(S,t),(0,L.eV)(n,e),!1):g},a.prototype.ZJ=function(){var t=this.conType();t!==m.averageCondition&&t!==m.top10Condition||(this.FJ=!0)},a.prototype.WJ=function(){var t=this;t.FJ=!1,t.PJ=S},a.prototype.zJ=function(t,n,e,i){var r=t.op();return r?r.evaluateParsedFormula(t.Uw(),n,(0,L.eV)(e,i),!1):g},a.prototype.QJ=function(t,n){for(var e,i,i=0;i<Z(n);i++)e=n[i],w(e,Array)&&0<Z(e)?1<Z(n)?t.push(e[0]):t.push.apply(t,e):t.push(e)},a.prototype.getValidList=function(t,n,e){for(var i,r,o,a,i=[],r=this.getValidListImp(t,n,e),o=0,a=Z(r);o<a;o++)i.push(r[o].value);return i},a.prototype.KJ=function(){return this.D5&&0<this.D5.length},a.prototype.getValidListImp=function(t,n,e){var i,r,t,o,a,u,s,c,f,c,i=this,r=[];if(i.D5&&0<i.D5.length)t=i.getExpected(t,n,e),w(t,Array)?i.QJ(r,t):r.push(t);else if(i.expected()&&0<i.expected().length&&(u=(a=(o=i.expected()).replace(/\\,/g,String.fromCharCode(206))).split(",")))for(s=0;s<Z(u);s++)c=u[s],T(c)||(f=new RegExp(String.fromCharCode(206),"g"),""!==(c=b.trim(c).replace(f,","))&&r.push({text:c,value:c}));return r},a.prototype.areaConditionEvaluate=function(t,n,e,i){var r,o,a,u,s,c;function f(t,n,e){return w(t,Date)&&w(n,Date)?t.valueOf()===n.valueOf():e||"string"!=typeof t||"string"!=typeof n?t===n:t.toLowerCase()===n.toLowerCase()}if(r=this,T(i)||""===i)return!0===r.ignoreBlank();for(o=r.getValidList(t,n,e),a=0;a<Z(o);a++){if(u=o[a],T(u)&&T(i))return!0;if(r.D5){if(f(u,i,!1))return!0}else if(s=t.getActualStyle(n,e,3,!0),f(c=A.Xf(s,u,!0),i,!0))return!0}return!1},a.prototype.areaConditionGetExpected=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,l,t,i=this,r=[];if(i.D5){if(f=c=s=u=a=o=void 0,!(l=t.op()))return r;if(h=l.evaluateParsedFormula(t.Uw(),i.expression(S,t),(0,L.eV)(n,e),!0),rt.LE(h))for(o=h.getRowCount(0),a=h.getColumnCount(0),d=h.getRow(0),v=h.getColumn(0),(m=h.rT&&h.rT.Mf)&&(m.nre&&m.nre(),l=m.getRowCount(),t=m.getColumnCount(),o=l<o?tt(l-d,0):o,a=t<a?tt(t-v,0):a),u=0;u<o;u++)for(r[u]=[],s=0;s<a;s++)c=h.getValue(0,u,s),f=m?m.getText(d+u,v+s):c,r[u][s]={value:c,text:f};else if(rt.Nh(h))for(o=h.getRowCount(),a=h.getColumnCount(),u=0;u<o;u++)for(r[u]=[],s=0;s<a;s++)c=h.getValue(u,s),r[u][s]={value:c,text:c}}else r.push({value:i.expected(),text:i.expected()});return r},a.prototype.stateConditionEvaluate=function(t,n,e,i){var r=this.expected();return!(T(i)||T(r)||isNaN(i)||isNaN(i))&&0<(i&r)},a.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.ZK(1),t.item1(g),t.item2(g),t.value1=g,t.value2=g,t.expected(g),t.ZK(0),t.integerValue(!1),t.operator=0,t.text="",t.ZK(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.WK=g,t.type(0),this.expectTypeId(0),t.ranges(g),t.isPercent(!1),t.regex(g),t.conType()){case m.relationCondition:t.ignoreBlank(!1),t.ZK(1);break;case m.numberCondition:t.ZK(0),t.integerValue(!1);break;case m.textCondition:t.ZK(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case m.colorCondition:t.ZK(0);break;case m.formulaCondition:t.customValueType(0),t.QK=g;break;case m.dateCondition:case m.timeCondition:t.ZK(0);break;case m.dateExCondition:t.expectTypeId(0);break;case m.textLengthCondition:t.ZK(0);break;case m.top10Condition:case m.averageCondition:t.type(0);break;case m.cellValueCondition:t.operator=6;break;case m.areaCondition:}},a.prototype.evaluate=function(t,n,e,i){var r=this.conType();return!T(r)&&this[m[r]+"Evaluate"](t,n,e,i)},a.prototype.getExpectedNormal=function(t,n,e,i,r,o){var a,u,s,u,a=this,u=a.D5,s=a.expected();return(u=u&&t.op())?u.evaluateParsedFormula(t.Uw(),a.expression(S,t),(0,L.eV)(n,e),!1,o):s},a.prototype.getExpected=function(t,n,e){var i=this;switch(i.conType()){case 2:return i.getExpectedNormal(t,n,e,n-i.offsetRow,e-i.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return i.getExpectedNormal(t,n,e,n-i.offsetRow,e-i.offsetCol,!1);case 8:return i.getExpectedNormal(t,n,e,n,e);case 0:return g;case 1:return i.numberConditionGetExpected(t,n,e);case 3:return g;case 4:return i.formulaConditionGetExpected(t,n,e);case 10:return i.averageConditionGetExpected(t,n,e);case 12:return i.areaConditionGetExpected(t,n,e);default:return g}},a.prototype.GJ=function(t,n){for(var e,i,r,o,e=[],i=0,r=Z(n);i<r;i++)o=t.JS(n[i]),e.push(o);return e},a.prototype.getExpressions=function(){var t=[],n=this;return 0===n.conType()?(n.item1()&&n.item1().getExpressions&&(t=n.item1().getExpressions()),n.item2()&&n.item2().getExpressions?t.concat(n.item2().getExpressions()):t):(n.WK||n.initExpression(),n.WK?[n.WK]:[])},a.prototype.setExpressions=function(t,n){var e=this,i;n&&n.push({type:"condition",condition:this,expressions:e.getExpressions(),newExpressions:t}),0===e.conType()?(e.item1()&&e.item1().setExpressions&&(i=e.item1().getExpressions().length,e.item1().setExpressions(t.slice(0,i))),e.item2()&&e.item2().setExpressions&&e.item2().setExpressions(t.slice(i))):e.expression(t[0])},a.prototype.toJSON=function(t){var t=Kt.call(this,t,Nn);return t.ignoreBlank&&!isNaN(t.ignoreBlank)&&(t.ignoreBlank=0!==parseInt(t.ignoreBlank,10)),t},a.prototype.fromJSON=function(t,n,e){var i,r;t&&(Xt.call(i=this,n,Nn,t,e),(r=n&&n.Lp&&n.Lp.useR1C1)&&n instanceof C.Worksheet&&(i.context(n),kt(i)),i.U0(!0),i.initExpression(),i.H0())},a.fromSource=function(t){return(0,p.aJ)(12,g,t,g)},a.fromFormula=function(t){return(0,p.aJ)(12,g,"",t)},a.fromDay=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(5),t},a.fromMonth=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(3),t},a.fromQuarter=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(2),t},a.fromWeek=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(4),t},a.fromYear=function(t){var t=(0,p.aJ)(6,g,t);return t.expectTypeId(1),t},y=a,t(p.Condition=y),y.prototype.conType=n("conType",g),y.prototype.ranges=n("ranges",g,function(t){var n=this.item1(),e=this.item2();n&&n.ranges&&n.ranges(t),e&&e.ranges&&e.ranges(t)}),y.prototype.ignoreBlank=n("ignoreBlank",!1),y.prototype.preciseCompareDate=n("preciseCompareDate",!1),y.prototype.compareType=n("compareType",S),y.prototype.ZK=y.prototype.compareType,y.prototype.expected=n("expected",S),y.prototype.item1=n("item1",g),y.prototype.item2=n("item2",g),y.prototype.treatNullValueAsZero=n("treatNullValueAsZero",!1),y.prototype.integerValue=n("integerValue",!1),y.prototype.forceValue2Text=n("forceValue2Text",!1),y.prototype.useWildCards=n("useWildCards",!0),y.prototype.regex=n("regex",g),y.prototype.ignoreCase=n("ignoreCase",!1),y.prototype.customValueType=n("customValueType",S),y.prototype.expectTypeId=n("expectTypeId",0),y.prototype.type=n("type",g),y.prototype.isPercent=n("isPercent",!1),r.prototype.stopIfTrue=function(t){},r.prototype.evaluate=function(t,n,e,i){var r,o,a,a,u,t,r=this,o=r.JJ(n,e);return r.zT(o)?(r.initCondition(),r.getBaseCoordinate(a={baseRow:0,baseCol:0}),r.condition().adjustOffset(n-a.baseRow,e-a.baseCol),a=g,u=rt.BJ,(t=r.condition().evaluate(t,n,e,i))&&!u(t)&&(a=r.getExpected(o)||p.oJ),r.condition().adjustOffset(0,0),a):g},r.prototype.JJ=function(t,n){return this.contains(t,n)},r.prototype.zT=function(t){return t},r.prototype.contains=function(t,n){var e,i,r,o,e=this.ranges();if(e)for(i=Z(e),r=void 0,o=0;o<i;o++)if((r=e[o]).contains(t,n))return!0;return!1},r.prototype.createCondition=function(){return this.KK=!1,null},r.prototype.initCondition=function(t){var n=this.condition();n||((n=this.createCondition())&&(n.ranges(this.ranges()),this.condition(n)),t&&this.context(t),this.context()&&n&&n.context(this.context()))},r.prototype.XJ=function(){var t,n,t=this;t.KK&&((n=t.condition())||(t.initCondition(),n=t.condition()),n)&&!n.WK&&n.initExpression()},r.prototype.context=function(t){return 1===arguments.length&&(this.DJ=t,this.condition())&&this.condition().context(t),this.DJ},r.prototype.getExpected=function(t){return this.style()},r.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.stopIfTrue(!1),t.priority(1)},r.prototype.intersects=function(t,n,e,i){var r,o,a,u,r=this.ranges();if(r)for(o=Z(r),a=void 0,u=0;u<o;u++)if((a=r[u]).intersect(t,n,e,i))return!0;return!1},r.prototype.isScaleRule=function(){return!1},r.prototype.isStateRule=function(){return!1},r.prototype.getBaseCoordinate=function(t){var n,e,i,r,o,a,o;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,0<(i=(e=(n=this).ranges())?e.length:0))for(r=0;r<i;r++)a=(o=e[r]).row,o=-1===(o=o.col)?0:o,t.baseRow=$(a=-1===a?0:a,t.baseRow),t.baseCol=$(o,t.baseCol);else t.baseRow=0,t.baseCol=0},r.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,f,l,s,h,d,v,i=this,r=!1;if(i.XJ(),o=i.ranges())for(a=Z(o),u=0;u<a;u++)c=(s=o[u]).row,f=W(s),l=s.col,s=Q(s),h=c===t.row&&f===t.rowCount&&t.col<=l&&s<=t.colCount,d=c===n.row&&f===n.rowCount&&n.col<=l&&s<=n.colCount,(v=h||d)&&(o[u]=Y(c,l,f+e,s),r=!0);return r},r.prototype.$J=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,b,M,C,C,S,T,A,o=this,a=e?n:0,u=e?0:n;if(o.XJ(),s=o.ranges()){for(c=[],f=Z(s),l=0;l<f;l++)if(h=s[l],d=e?h.row:h.col,v=(e?W:Q)(h),-1!==d){if(i&&0<i.length){for(m=!1,g=0,p=i.length;g<p;g++)if((b=i[g])&&(w=!e&&b.col===t&&b.col===h.col&&b.colCount-n===h.colCount,y=!e&&b.col===t&&b.row===h.row&&b.rowCount===h.rowCount&&h.col>=b.col&&h.col+h.colCount<=b.col+b.colCount,b=e&&b.row===t&&b.row===h.row&&b.rowCount-n===h.rowCount,w||y||b)){s[l]=Y(h.row,h.col,W(h)+a,Q(h)+u),m=!0;break}if(m)break}if(M=h,C=r&&i&&i[0]){if((C=e?oe(h,C.col,C.col+C.colCount-1):ae(h,C.row,C.row+C.rowCount-1))[0]&&c.push(C[0]),C[2]&&c.push(C[2]),!C[1])continue;M=C[1]}t<=d?s[l]=Y(M.row+a,M.col+u,W(M),Q(M)):t<=d+v&&(s[l]=Y(M.row,M.col,W(M)+a,Q(M)+u))}for(S=0,T=c;S<T.length;S++)s.push(A=T[S])}},r.prototype.JO=function(t,n,e,i){this.$J(t,n,!0,e,i)},r.prototype.qO=function(t,n,e,i){this.$J(t,n,!1,e,i)},r.prototype.tX=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,m,w,y,M,C,S,T,A,o=this,a=e?t:0,u=e?0:t,s=e?n:0,c=e?0:n;if(o.XJ(),f=o.ranges()){for(l=[],h=[],d=Z(f),v=0;v<d;v++)if(m=f[v],g=e?m.row:m.col,p=(e?W:Q)(m),-1!==g){if(b=m,w=r&&i&&i[0]){if((m=e?oe(m,w.col,w.col+w.colCount-1):ae(m,w.row,w.row+w.rowCount-1))[0]&&l.push(m[0]),m[2]&&l.push(m[2]),!m[1])continue;b=m[1]}t<g?g+p<=t+n?h.push(b):f[v]=Y(b.row-s,b.col-c,W(b),Q(b)):t<g+p&&(w=Y(b.row,b.col,W(b)-$(b.row+W(b)-a,s),Q(b)-$(b.col+Q(b)-u,c)),0===Q(w)||0===W(w)?h.push(b):f[v]=w)}for(y=0,M=l;y<M.length;y++)f.push(C=M[y]);for(S=Z(h),T=0;T<S;T++)Pt(f,A=h[T])}},r.prototype.xP=function(t,n,e,i){this.tX(t,n,!0,e,i)},r.prototype.NP=function(t,n,e,i){this.tX(t,n,!1,e,i)},r.prototype.toJSON=function(t){return Kt.call(this,t)},r.prototype.fromJSON=function(t,n,e){t&&(Xt.call(this,n,g,t,e),this.initCondition(n))},r.prototype.kJ=function(){var t=this.condition();t&&kt(t)},r.prototype.nX=function(){var t,n,e,i,r,t=this.JK,n=this.ranges();if(t){if((e=Z(t))!==(i=Z(n)))return!0;for(r=0;r<i;r++)if(!t[r].equals(n[r]))return!0}else this.JK=we(n);return!1},(i=(p.ConditionRuleBase=e=r).prototype).ruleType=n("ruleType",g),i.ranges=n("ranges",g,function(t){var n,e,n=this.condition();n&&n.ranges()&&((e=n.DJ)&&e.Ut.vJ(),n.ranges(t),e)&&e.Ut.vJ(!0)}),i.condition=n("condition",g),i.style=n("style",g),i.priority=n("priority",1),i.stopIfTrue=n("stopIfTrue",!1),kn=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],_n={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},Dn={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},(i=jn=jn||{})[i.equal=0]="equal",i[i.notEqual=1]="notEqual",i[i.greaterThan=2]="greaterThan",i[i.greaterThanOrEqual=3]="greaterThanOrEqual",i[i.lessThan=4]="lessThan",i[i.lessThanOrEqual=5]="lessThanOrEqual",i[i.between=6]="between",i[i.notBetween=7]="notBetween",O(u,Zn=e),u.prototype.value1=function(t,n){var e,e;if(1!==arguments.length)return(e=this.condition())&&(e=e.formula(t,n,0))&&0<e.length?"="+ft(b.trim(e.toString()),"="):this.eX;this.eX=t},u.prototype.value2=function(t,n){var e,e;if(1!==arguments.length)return(e=this.condition())&&(e=e.formula(t,n,1))&&0<e.length?"="+ft(b.trim(e.toString()),"="):this.iX;this.iX=t},u.prototype.formula=function(t,n){var e=this,i=e.condition();if("string"!=typeof t)return i&&i.formula(t,n)||e.D5;e.D5=t,i&&i.formula(t)},u.prototype.cellValueRuleCreateCondition=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t,h,a,t=this,n=t.value1(),e=t.value2(),i=t.ranges(),r=t.kf(n)?ft(n,"="):g,o=t.kf(e)?ft(e,"="):g,t=t.operator();return t===en.between?((a=(0,p.aJ)(m.cellValueCondition,3,n,r,S,S,i)).treatNullValueAsZero(!0),(u=(0,p.aJ)(m.cellValueCondition,5,e,o,S,S,i)).treatNullValueAsZero(!0),f=(0,p.aJ)(m.relationCondition,1,g,g,g,g,i,a,u),(s=(0,p.aJ)(m.cellValueCondition,5,n,r,S,S,i)).treatNullValueAsZero(!0),(c=(0,p.aJ)(m.cellValueCondition,3,e,o,S,S,i)).treatNullValueAsZero(!0),l=(0,p.aJ)(m.relationCondition,1,g,g,g,g,i,s,c),(0,p.aJ)(m.relationCondition,0,g,g,g,g,i,f,l)):t===en.notBetween?((a=(0,p.aJ)(m.cellValueCondition,4,n,r,S,S,i)).treatNullValueAsZero(!0),u=(0,p.aJ)(m.cellValueCondition,2,e,o,S,S,i),a.treatNullValueAsZero(!0),f=(0,p.aJ)(m.relationCondition,0,g,g,g,g,i,a,u),(s=(0,p.aJ)(m.cellValueCondition,2,n,r,S,S,i)).treatNullValueAsZero(!0),(c=(0,p.aJ)(m.cellValueCondition,4,e,o,S,S,i)).treatNullValueAsZero(!0),l=(0,p.aJ)(m.relationCondition,0,g,g,g,g,i,s,c),(0,p.aJ)(m.relationCondition,1,g,g,g,g,i,f,l)):((a=(0,p.aJ)(11,t,n,r,S,S,i)).treatNullValueAsZero(!0),a)},u.prototype.kf=function(t){return!T(t)&&"="===t[0]},u.prototype.specificTextRuleCreateCondition=function(){var t,n,e,i,e,n=this.operator();switch(n){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return e=this.text(),i=g,e&&"="===e[0]&&(i=e),(e=(0,p.aJ)(2,t,e,i,S,S,this.ranges())).ignoreCase(!0),e.useWildCards(2!==n&&3!==n),e},u.prototype.formulaRuleCreateCondition=function(){var t=this,n=t.ranges();return(0,p.aJ)(4,g,g,t.D5,4,g,n)},u.prototype.dateOccurringRuleCreateCondition=function(){return(0,p.aJ)(6,g,this.type(),g,g,S,this.ranges())},u.prototype.top10RuleCreateCondition=function(){return(0,p.aJ)(8,g,this.rank(),g,g,this.type(),this.ranges())},u.prototype.uniqueRuleCreateCondition=function(){return(0,p.aJ)(9,g,!1,g,g,g,this.ranges())},u.prototype.duplicateRuleCreateCondition=function(){return(0,p.aJ)(9,g,!0,g,g,g,this.ranges())},u.prototype.averageRuleCreateCondition=function(){return(0,p.aJ)(10,g,g,g,g,this.type(),this.ranges())},u.prototype.createCondition=function(){return this[I[this.ruleType()]+"CreateCondition"]()},u.prototype.reset=function(){var t=this;switch(t.ranges(g),t.condition(g),t.style(g),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(g),t.value2(g),t.text(""),t.formula(g),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(g);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},u.prototype.evaluate=function(t,n,e,i){return this.rX(t),Zn.prototype.evaluate.call(this,t,n,e,i)},u.prototype.rX=function(t){var n,e,n=this;n.initCondition(),9===(e=n.condition()).conType()&&(n.nX()&&(n.dl(),n.JK=we(n.ranges())),!1===n.cached)&&(e.duplicatedArrayCached=e.getDuplicated(t,n.ranges()),n.cached=!0)},u.prototype.dl=function(){this.cached=!1},u.prototype.JO=function(t,n,e,i){Zn.prototype.JO.call(this,t,n,e,i),this.dl()},u.prototype.qO=function(t,n,e,i){Zn.prototype.qO.call(this,t,n,e,i),this.dl()},u.prototype.xP=function(t,n,e,i){Zn.prototype.xP.call(this,t,n,e,i),this.dl()},u.prototype.NP=function(t,n,e,i){Zn.prototype.NP.call(this,t,n,e,i),this.dl()},u.prototype.toJSON=function(t){var n,e,i,r,o,a,n=this;return T(n.condition())&&this.initCondition(),e=Kt.call(n,t,kn),i=n.value1(),ue(e.ruleType,e.operator)&&(r=n.value2()),o=t&&t.parent&&1===t.parent.options.referenceStyle,T(i)||(n.kf(i)&&o&&(i=fe(t,n,i,o)),e.value1=i),T(r)||(n.kf(r)&&o&&(r=fe(t,n,r,o)),e.value2=r),(a=n.ruleType())===I.conditionRuleBase&&(e.condition=n.condition().toJSON()),e},u.prototype.fromJSON=function(t,n,e){var i=kn;T(t.condition)||(i=kn.concat(["condition"])),Xt.call(this,n,i,t,e),T(t.value1)||this.value1(t.value1),T(t.value2)||this.value2(t.value2),this.initCondition(n)},u.prototype.oX=function(t,n,e){var i,r,n,o,t,a,u,s,s,e,c,f,s,l,h,d,v,f,m,g,p,b,w,u,y,M,y,a,n,i=this,r=i.ruleType(),n=C.Util.ko(n),o={n_:H,sqref:Nt(i.ranges())};return o.pivot=T(i.pivotTableName)?S:"1",t=t.getDxfIndex(i.style(),!0),a=i.operator&&i.operator(),u=i.type&&i.type(),s=[x.nextQuarter,x.thisQuarter,x.lastQuarter,x.nextYear,x.thisYear,x.lastYear],r===I.dateOccurringRule&&-1<s.indexOf(u)?o.lossless=i.toJSON(e):(e=(s=_e(r,u,a)).type,c=s.operator,f=i.condition(),s=s.timePeriod,l=i.priority()?""+i.priority():"1",h=i.stopIfTrue()?1:S,d=1===u?1:S,f=(v=f&&f.isPercent())?1:S,m=i.rank&&i.rank()||S,g=i.text&&i.text(),w=b=p=void 0,r===I.averageRule&&(w=0,u!==N.equalOrAbove&&u!==N.equalOrBelow||(b=1),u!==N.above1StdDev&&u!==N.below1StdDev||(w=1),u!==N.above2StdDev&&u!==N.below2StdDev||(w=2),u!==N.above3StdDev&&u!==N.below3StdDev||(w=3),u!==N.below&&u!==N.equalOrBelow&&u!==N.below1StdDev&&u!==N.below2StdDev&&u!==N.below3StdDev||(p=0)),u=[],y=T(i.value1())?i.D5:i.value1(),M=i.value2(),T(y)||u.push({n_:"formula",c_:[Ae(n?y:mt(y))]}),ue(r,a)&&!T(M)&&u.push({n_:"formula",c_:[Ae(n?M:mt(M))]}),y={n_:"cfRule",type:e,dxfId:t!==S?+t:t,priority:l,stopIfTrue:h,aboveAverage:p,equalAverage:b,bottom:d,percent:f,rank:m,operator:c,text:pt(g),stdDev:w,timePeriod:s},r===I.specificTextRule||r===I.dateOccurringRule||r===I.top10Rule||r===I.uniqueRule||r===I.duplicateRule||r===I.averageRule?(a=se(y,i.ranges(),g))&&(n=[{n_:"formula",c_:[Ae(A.getFormulaString(a))]}],y.c_=n):y.c_=u,o.c_=[y]),o},u.prototype.IJ=function(t){var n,e,i,r,i,t,n=this,e={n_:"conditionalFormatting","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},i=zt(),r={n_:"cfRule",type:"expression",id:i};return n.rJ=i,T(n.priority())||(r.priority=n.priority()),i={n_:"f",c_:[pt(gt(n.D5))]},n.style()&&(t={n_:"dxf",v:t.cv(n.style(),!0)},r.c_=[i,t]),e.c_=[r,{n_:"sqref",c_:[Nt(n.ranges())]}],e},u.prototype.aX=function(){var t=this;if(_t(t.value1())||_t(t.value2())||_t(t.text())||_t(t.D5))return!0},u.prototype.wh=function(t,n,e,i,r){var o=this;if(!ee(i)||!o.aX())return T(o.condition())&&o.initCondition(),n?o.IJ(e):o.oX(t,i,r)},u.prototype.uX=function(t,n,e,i){var r,o,i,e,a,u,a,s,i,c,f,l,h,a,r=this,o=t.type,i=C.Util.ko(i),e=e.getDxf(t.dxfId,void 0,!0,!0),a=wt(t,"formula"),u=V(a&&It(a[0])),a=V(a&&It(a[1]));switch("cellIs"===o?(r.eX=(i?"":"=")+Tt(u),a&&(r.iX=(i?"":"=")+Tt(a))):r.D5=Tt(u),T(t.stopIfTrue)||r.stopIfTrue(1==+t.stopIfTrue),s=t.rank,i=Re(o)){case 8:f=!0,0==+t.aboveAverage&&(f=!1),c=(l=1==+t.equalAverage)?f?2:3:f?0:1,T(t.stdDev)||(h=+t.stdDev,f?1==h?c=4:2==h?c=6:3==h&&(c=8):1==h?c=5:2==h?c=7:3==h&&(c=9));break;case 5:c=0,t.bottom&&(c=1),t.percent&&0===(s=Math.floor(n[0].rowCount*n[0].colCount*s/100))&&(s=1);break;case 4:c=0,"timePeriod"===t.type&&t.timePeriod&&(c=_n[t.timePeriod])}r.type(c),T(s)||r.rank(+s),a=ke(o,t.operator,t.timePeriod),r.operator(a),r.text(Tt(t.text)),r.ranges(n),r.ruleType(i),r.style(ce(e))},u.prototype.sX=function(t,n,e){var i,r,o,a,u,s,c,f,l,l,h,l,r,h,i=this,r=t.type,o=Re(r);switch(T(t.stopIfTrue)||i.stopIfTrue(1==+t.stopIfTrue),u=t.rank,o){case 8:s=!0,0==+t.aboveAverage&&(s=!1),a=(c=1==+t.equalAverage)?s?2:3:s?0:1,T(t.stdDev)||(f=+t.stdDev,s?1==f?a=4:2==f?a=6:3==f&&(a=8):1==f?a=5:2==f?a=7:3==f&&(a=9));break;case 5:a=0,t.bottom&&(a=1),t.percent&&0===(u=Math.floor(n[0].rowCount*n[0].colCount*u/100))&&(u=1);break;case 4:a=0,"timePeriod"===t.type&&t.timePeriod&&(a=_n[t.timePeriod])}i.type(a),T(u)||i.rank(+u),l=ke(r,t.operator,t.timePeriod),i.operator(l),i.ruleType(o),h=(l=wt(t,"f"))&&Tt(St(It(l[0]))),l=l&&Tt(St(It(l[1]))),"cellIs"===r?(i.eX=h,i.iX=l):i.D5=h,o===I.specificTextRule&&i.text(l),(r=Ct(t,"dxf"))&&(h=r.v,i.style(ce(e.fv(h,S,S,!0)))),i.ranges(n)},u.prototype.yh=function(t,n,e,i,r,o,a){var u=this;r?u.sX(t,n,o):u.uX(t,n,e,a),u.initCondition(i)},M=u,p.NormalConditionRule=M,i={operator:n("operator",g),text:n("text",g),type:n("type",g),rank:n("rank",g),priority:n("priority",1)},b.extend(M.prototype,i),p.ScaleValue=le,En=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],O(s,Wn=e),s.prototype.stopIfTrue=function(t){return!1},s.prototype.isScaleRule=function(){return!0},s.prototype.createCondition=function(){return g},s.prototype.cX=function(t){var t=(0,p.aJ)(8,g,g,g,g,1).getTopValues(t,1,this.ranges());return 0<Z(t)?t[0]:g},s.prototype.fX=function(t){var t=(0,p.aJ)(8,g,g,g,g,0).getTopValues(t,1,this.ranges());return 0<Z(t)?t[0]:g},s.prototype.rX=function(t){var n=this;n.nX()&&(n.dl(),n.JK=we(n.ranges())),!1===n.cached&&(n.lowestValueCached=n.cX(t),n.highestValueCached=n.fX(t),n.cached=!0)},s.prototype.dl=function(){this.lowestValueCached=g,this.highestValueCached=g,this.XK={},this.cached=!1},s.prototype.lX=function(t,n,e,i){var r,i;return i&&(r=t.op())?(i=r.parse(t.Uw(),i,n,e),r.evaluateParsedFormula(t.Uw(),i,(0,L.eV)(n,e),!1)):g},s.prototype.kf=function(t){return t&&"="===t[0]},s.prototype.hX=function(t){return T(t)||""===t?g:"="===t[0]?t.substr(1):t},s.prototype.dX=function(t,n,e,i){var t;return this.kf(i)?this.lX(t,n,e,this.hX(i.toString())):ut(i,t={})?t.value:NaN},s.prototype.vX=function(t){return this.rX(t),this.highestValueCached},s.prototype.mX=function(t){return this.rX(t),this.lowestValueCached},s.prototype.gX=function(t,n,e,i){var n,e,i,n=this.dX(t,n,e,i);return!isNaN(n)&&0<=n&&n<=100&&(e=this.mX(t),i=this.vX(t),typeof e!=K)&&e!==g&&typeof i!=K&&i!==g?e+(i-e)*n/100:g},s.prototype.pX=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,f,f,l,h,r=this.XK;if(void 0===r[i])if(o=this.dX(t,n,e,i),!isNaN(o)&&0<=o&&o<=100){for(a=0,u=this.ranges(),s=Z(u),c=0;c<s;c++)f=this.VJ("PERCENTILE",[t.JS(u[c]),o/100]),l=t.op(),h=t.Uw(),f=l.unparse(h,f,n,e),f=l.parse(h,f,n,e),l=l.evaluateParsedFormula(h,f,(0,L.eV)(n,e),!1),a+=ut(l,h={})?h.value:0;r[i]=a/s}else r[i]=g;return r[i]},s.prototype.bX=function(t,n,e,i,r){var o,a,a,o=this;switch(i){case ln.formula:return o.kf(r)||(r="="+r),o.dX(t,n,e,r);case ln.highestValue:return o.vX(t);case ln.lowestValue:return o.mX(t);case ln.number:return o.dX(t,n,e,r);case ln.percent:return o.gX(t,n,e,r);case ln.percentile:return o.pX(t,n,e,r);case ln.automax:return(a=o.vX(t))<0?0:a;case ln.automin:return 0<(a=o.mX(t))?0:a;default:return g}},s.prototype.yX=function(t,n,e){return t===n&&t===e?1:t<=n?0:e<=t?1:(t-n)/(e-n)},s.prototype.wX=function(t,n,e){var n,e,i,r,o,n;return 0<=t&&t<=1?(n=Et._(n),e=Et._(e),i=n.a*(1-t)+e.a*t,r=n.r*(1-t)+e.r*t,o=n.g*(1-t)+e.g*t,n=n.b*(1-t)+e.b*t,Rt(parseFloat(i/255+""),parseInt(r+"",10),parseInt(o+"",10),parseInt(n+"",10))):g},s.prototype.VJ=function(t,n){var t,e,i,r;if(jt&&(t=Ut.findGlobalFunction(t))){for(e=[],i=Z(n),r=0;r<i;r++)e[r]=Jt(n[r]);return F.YJ(t,e)}return g},s.prototype.JO=function(t,n,e,i){Wn.prototype.JO.call(this,t,n,e,i),this.dl()},s.prototype.qO=function(t,n,e,i){Wn.prototype.qO.call(this,t,n,e,i),this.dl()},s.prototype.xP=function(t,n,e,i){Wn.prototype.xP.call(this,t,n,e,i),this.dl()},s.prototype.NP=function(t,n,e,i){Wn.prototype.NP.call(this,t,n,e,i),this.dl()},s.prototype.scaleEvaluate=function(t,n,e,i){var r,o,a,u,s,r=this;if(r.rX(t),r.contains(n,e)){if(T(i))return g;try{if(o=at(i),a=r.bX(t,n,e,r.minType(),r.minValue()),u=r.bX(t,n,e,r.midType(),r.midValue()),(s=r.bX(t,n,e,r.maxType(),r.maxValue()))<a)return g;if(isNaN(u)){if(!isNaN(a)&&!isNaN(s))return r.yX(o,a,s)}else if(!isNaN(a)&&!isNaN(s))return o<a?0:s<=o?2:a<=o&&o<=u?r.yX(o,a,u):1+r.yX(o,a,s)}catch(t){}}return g},s.prototype.twoScaleRuleEvaluate=function(t,n,e,i){var r,i,r,o,t,n;if(!T(i)){if(r={},i=ot(i)&&ut(i,r)?r.value:NaN,isNaN(i))return g;if(o=(r=this).bX(t,n,e,r.minType(),r.minValue()),t=r.bX(t,n,e,r.maxType(),r.maxValue()),!T(o)&&!T(t))return n=r.yX(i,o,t),r.wX(n,r.minColor(),r.maxColor())}return g},s.prototype.threeScaleRuleEvaluate=function(t,n,e,i){var r,o,i,o,a,t,n,r=this;if(r.MX=t,!T(i)){if(o={},i=ot(i)&&ut(i,o)?o.value:NaN,isNaN(i))return g;if(o=r.bX(t,n,e,r.minType(),r.minValue()),a=r.bX(t,n,e,r.midType(),r.midValue()),t=r.bX(t,n,e,r.maxType(),r.maxValue()),!T(o)&&!T(t)&&!T(a))return n=void 0,t<o?g:i<=o||o===t?t<=i?r.maxColor():r.minColor():t<=i?r.maxColor():i<=a?(n=r.yX(i,o,a),r.wX(n,r.minColor(),r.midColor())):(n=r.yX(i,a,t),r.wX(n,r.midColor(),r.maxColor()))}return g},s.prototype.evaluate=function(t,n,e,i){return this[I[this.ruleType()]+"Evaluate"](t,n,e,i)},s.prototype.Hc=function(){var t=this;t.minValue(g),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(g),t.maxType(2),10===t.ruleType()&&(t.minColor(Rt(0,255,255,255)),t.maxColor(Rt(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(Rt(255,248,105,107)),t.midColor(Rt(255,255,235,132)),t.maxColor(Rt(255,99,190,123)))},s.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.Hc(),t.MX=g,t.stopIfTrue(!1),t.priority(1)},s.prototype.toJSON=function(t){return Kt.call(this,t,En)},s.prototype.fromJSON=function(t,n,e){Xt.call(this,n,En,t,e),this.initCondition(n)},s.prototype.aX=function(){var t=this;if(_t(t.minValue())||_t(t.midValue())||_t(t.maxValue()))return!0},s.prototype.wh=function(t,n,e,i,r){var o,i,a,u,s,c,f,l,h,u,s,c,o=this;if(!ee(i)||!o.aX())return T(o.condition())&&o.initCondition(),i=o.ruleType(),(a={n_:H,sqref:Nt(o.ranges())}).pivot=T(o.pivotTableName)?S:"1",u=je(o.minType()),s=o.minValue(),c=je(o.maxType()),f=o.maxValue(),l=o.minColor(),h=o.maxColor(),!T(u)&&"autoMin"!==u||(u="min"),!T(c)&&"autoMax"!==c||(c="max"),a.c_=[{n_:"cfRule",type:"colorScale",priority:o.priority()?""+o.priority():"1",c_:[{n_:"colorScale",c_:[{n_:"cfvo",type:u,val:T(s)||Be(u)?S:pt(mt(s))},{n_:"cfvo",type:c,val:T(f)||Be(c)?S:pt(mt(f))}]}]}],T(l)||a.c_[0].c_[0].c_.push(yt(l)),T(h)||a.c_[0].c_[0].c_.push(yt(h)),11===i&&(u=je(o.midType()),s=o.midValue(),c=o.midColor(),a.c_[0].c_[0].c_.splice(1,0,{n_:"cfvo",type:u,val:T(s)?50:pt(mt(s))}),T(c)||a.c_[0].c_[0].c_.splice(4,0,yt(c))),a},s.prototype.yh=function(t,n,e,i){var r,o,t,a,u,s,o,t,c,r=this,o=xe(t),t=Ne(t),a=o[0],o=2===o.length?o[1]:(u=o[1],o[2]),c=t[0],t=u?(s=t[1],t[2]):t[1];u?r.ruleType(I.threeScaleRule):r.ruleType(I.twoScaleRule),r.minColor(c),r.minValue(Pe(a.val)),r.minType(De(a.type)),r.midColor(s),u&&!T(u.val)&&r.midValue(Pe(u.val)),r.midType(De(u&&u.type)),r.maxColor(t),r.maxValue(Pe(o.val)),r.maxType(De(o.type)),r.ranges(n),r.initCondition(i)},Rn=s,p.ScaleRule=Rn,i={minValue:n("minValue",g),minType:n("minType",5),minColor:n("minColor",g),midValue:n("midValue",50,g,function(t){var n=this;if(n.MX){if(2===n.midType())return n.vX(n.MX);if(1===n.midType())return n.mX(n.MX)}return t}),midType:n("midType",g),midColor:n("midColor",g),maxType:n("maxType",7),maxValue:n("maxValue",g),maxColor:n("maxColor",g)},b.extend(Rn.prototype,i),Fn=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],O(c,Qn=Rn),c.prototype.Hc=function(t){var n=this;n.gradient(!0),n.color(t),n.showBorder(!1),n.borderColor("black"),n.dataBarDirection(0),n.negativeFillColor("red"),n.useNegativeFillColor(!0),n.negativeBorderColor("black"),n.useNegativeBorderColor(!1),n.axisPosition(0),n.axisColor("black"),n.showBarOnly(!1)},c.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.Hc(Rt(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(g),t.minType(5),t.midValue(g),t.midType(g),t.maxValue(g),t.maxType(7),t.minColor(g),t.midColor(g),t.maxColor(g)},c.prototype.CX=function(t,n,e,i){var r,o,a,u,s,c,o,r=this,a=i?r.maxType():r.minType(),u=i?r.maxValue():r.minValue();if(6!==a&&4!==a)return r.bX(t,n,e,a,u);for(s=0;s<Z(r.ranges());s++)if(r.ranges()[s].intersect(n,-1,1,-1)&&(o=r.ranges()[s]))return c=o.row,o=o.col,r.bX(t,c=-1===c?0:c,o=-1===o?0:o,a,u)},c.prototype.SX=function(t,n,e){var i=0;return e<=t&&n<t?[1,0]:t<=n&&t<e?[0,0]:e===n?[.5,0]:[(t-n)/(e-n),0]},c.prototype.TX=function(t,n,e){var i,r,o,r,i=.5,r=nt(e-n);return 0<e&&0<=n?e===n||e<=t?[.5,.5]:t<=n?[n/e*.5,.5]:[.5*nt(t/e),.5]:0<e&&n<0?(o=e>nt(n)?.5:e/r,r=e>nt(n)?n/r:-.5,0<t?e<=t?[o,.5]:[t/e*o,.5]:t<0?t<=n?[r,.5]:[t/n*r,.5]:[0,.5]):e<=0&&n<0?e===n?[-.5,.5]:e<=t?[-e/n*.5,.5]:t<=n?[-.5,.5]:[-t/n*.5,.5]:0===e&&0===n?[0,.5]:[i=-1,-1]},c.prototype.AX=function(t,n,e){var i,r,o,a,u,s,r,o,i=-1,r=nt(n),o=nt(e),a=nt(e-n),u=n<0?-1:1;return 0<e&&0<=n||e<=0&&n<0?(s=tt(r,o),r=$(r,o),i=n<0?1:0,(o=nt(t))<=r&&o<s?[0,i]:s<=o&&r<o?[u,i]:r===s?[.5*u,i]:[u*(nt(t)-r)/a,i]):0<e&&n<0?(i=nt(n)/a,0===t?[0,i]:e<=t?[1-i,i]:[tt(t,n)/a,i]):0===e&&0===n?(i=.5,0===t?[0,i]:[.5*u,i]):[-1,i]},c.prototype.IX=function(t,n,e){var i=this;return 0===i.axisPosition()?i.AX(t,n,e):1===i.axisPosition()?i.TX(t,n,e):i.SX(t,n,e)},c.prototype.evaluate=function(t,n,e,i){var r,i,r,o,n,e,e,o,n,o,i,a;if(!T(i)){if(r={},i=ot(i,!0)&&ut(i,r)?r.value:NaN,isNaN(i))return g;if(o=(r=this).CX(t,n,e,!1),n=r.CX(t,n,e,!0),w(o,Date)&&(o=Lt.o0(o)),w(n,Date)&&(n=Lt.o0(n)),!T(o)&&!T(n))return n<o&&(e=n,n=o,o=e),e=void 0,!(o=r.IX(i,o,n))||Z(o)<2?g:(n=o[0],e=o[1],o=i<0&&r.useNegativeFillColor()?r.negativeFillColor():r.color(),i=i<0&&r.useNegativeBorderColor()?r.negativeBorderColor():r.borderColor(),a=r.axisColor(),o=Vt.vl(t,o),i=Vt.vl(t,i),a=Vt.vl(t,a),{fillColor:o,borderColor:i,showBorder:r.showBorder(),axisColor:a,isGradient:r.gradient(),direction:r.dataBarDirection(),axisLocation:e,scale:n,showBarOnly:r.showBarOnly()})}return g},c.prototype.toJSON=function(t){return Kt.call(this,t,Fn)},c.prototype.fromJSON=function(t,n,e){Xt.call(this,n,Fn,t,e),this.initCondition(n)},c.paintDataBar=function(t,n,e,i,r,o){var i,a,u,s,c,f,l,h,d,v,i,o,a,m,o,o,g,p,b,i=new R.Rect(e+2,i+2,r-4,o-4),a=i.x,u=i.y,s=et(nt(i.width*n.scale)),c=i.height;if(0===n.axisLocation)n.scale<=0&&(s=0);else if(1===n.axisLocation)n.scale<0?a=a+i.width-s:s=0;else{for(f=et(i.width*n.axisLocation+a)+.5,l=i.y,d=o-2,t.lineWidth=h=1,t.strokeStyle=n.axisColor,t.beginPath(),v=0;v<=d;v+=2)1===n.direction?(t.moveTo(2*e+r-f,l+v),t.lineTo(2*e+r-f,l+v+1)):(t.moveTo(f,l+v),t.lineTo(f,l+v+1));t.stroke(),0<n.scale?a=f+1:n.scale<0?a=f-s:s=0}n.showBorder&&(a=et(a)+.5,--s,u+=.5,--c),o=(i=a)+s,1===n.direction&&(i=2*e+r-a-s,o=2*e+r-a),0<=s&&0<=c&&(a=n.fillColor,n.isGradient&&(m=.9,a=t.createLinearGradient(i,u,o,u),o=Et._(n.fillColor),o=Rt(o.a,et(229.5+o.r*(1-.9)),et(229.5+o.g*(1-.9)),et(229.5+o.b*(1-.9))),g=n.scale<0?1-.9:.9,p=n.fillColor,b=n.scale<0?1:0,1===n.direction?(a.addColorStop(g,p),a.addColorStop(b,o)):(a.addColorStop(g,o),a.addColorStop(b,p))),t.fillStyle=a,t.fillRect(i,u,s,c),n.showBorder)&&0<s&&0<c&&(t.strokeStyle=n.borderColor,t.strokeRect(i,u,s,c))},c.prototype.oX=function(){var t,n,e,i,r,o,a,u,s,t=this,n={n_:H,sqref:Nt(t.ranges())};return n.pivot=T(t.pivotTableName)?S:"1",e=t.showBarOnly()?0:S,i=je(t.minType()),r=t.minValue(),o=je(t.maxType()),a=t.maxValue(),u=t.color(),!T(i)&&"autoMin"!==i||(i="min"),!T(o)&&"autoMax"!==o||(o="max"),(s=[]).push({n_:"cfvo",type:i,val:T(r)||""===r||Be(i)?S:pt(mt(r))}),s.push({n_:"cfvo",type:o,val:T(a)||""===a||Be(o)?S:pt(mt(a))}),u&&s.push(yt(u)),n.c_=[{n_:"cfRule",type:"dataBar",priority:t.priority()?""+t.priority():"1",c_:[{n_:"dataBar",showValue:e,c_:s}]}],t.rJ&&n.c_[0].c_.push({n_:U,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),n},c.prototype.IJ=function(){var t,n,e,i,e,r,r,o,o,a,u,s,t=this,n={n_:"conditionalFormatting",r_:[2]};return n.pivot=T(t.pivotTableName)?S:"1",i={n_:"cfRule",type:"dataBar",id:e=zt()},t.rJ=e,e={n_:"dataBar",minLength:0,maxLength:100},t.showBarOnly()&&(e.showValue="0"),t.showBorder()&&(e.border="1"),!1===t.gradient()&&(e.gradient="0"),!1===t.useNegativeFillColor()&&(e.negativeBarColorSameAsPositive="1"),t.useNegativeBorderColor()&&(e.negativeBarBorderColorSameAsPositive="0"),e.direction=1===t.dataBarDirection()?"rightToLeft":"leftToRight",1===(r=t.axisPosition())?e.axisPosition="middle":2===r&&(e.axisPosition="none"),r=[],(o=t.color())&&r.push(yt(o)),o=t.minType(),a=t.minValue(),u=t.maxType(),s=t.maxValue(),T(o)||5===o?r.push({n_:"cfvo",type:"autoMin"}):T(a)||""===a?r.push({n_:"cfvo",type:je(o)}):r.push({n_:"cfvo",type:je(o),c_:[{n_:"f",c_:[pt(gt(a))]}]}),T(u)||7===u?r.push({n_:"cfvo",type:"autoMax"}):T(s)||""===s?r.push({n_:"cfvo",type:je(u)}):r.push({n_:"cfvo",type:je(u),c_:[{n_:"f",c_:[pt(gt(s))]}]}),t.showBorder()&&t.borderColor()&&r.push(yt(t.borderColor(),S,"borderColor")),T(t.negativeFillColor())?r.push(yt("red",S,"negativeFillColor")):r.push(yt(t.negativeFillColor(),S,"negativeFillColor")),T(t.negativeBorderColor())?r.push(yt("black",S,"negativeBorderColor")):r.push(yt(t.negativeBorderColor(),S,"negativeBorderColor")),2!==t.axisPosition()&&r.push(yt(t.axisColor(),S,"axisColor")),e.c_=r,i.c_=[e],n.c_=[i,{n_:"sqref",c_:[Nt(t.ranges())]}],n},c.prototype.wh=function(t,n,e,i,r){var o=this;if(!ee(i)||!o.aX())return n?o.IJ():o.oX()},c.prototype.uX=function(t,n){var e,i,r,r,i,r,e=this,i=xe(t),r=Ne(t);e.color(r[0]),r=i[0],i=i[1],e.minType(De(r.type)),e.minValue(Pe(r.val)),e.maxType(De(i.type)),e.maxValue(Pe(i.val)),e.priority(+t.priority),e.ranges(n),r=Ct(t,"dataBar"),T(r.showValue)||e.showBarOnly(!d(r.showValue,!0)),t.c_[1]&&t.c_[1].n_===U&&(e.rJ=he(t.c_[1]))},c.prototype.sX=function(t,n){var e,i,r,o,a,a,r,o,a,r,o,a,e=this,i=Ct(t,"dataBar");T(i.showValue)||e.showBarOnly(!d(i.showValue,!0)),T(i.border)||e.showBorder(d(i.border,!1)),T(i.gradient)||e.gradient(d(i.gradient,!0)),T(i.direction)||e.dataBarDirection("rightToLeft"===i.direction?1:0),T(i.axisPosition)||e.axisPosition(+pn[i.axisPosition]),T(i.negativeBarColorSameAsPositive)||e.useNegativeFillColor(!d(i.negativeBarColorSameAsPositive,!1)),T(i.negativeBarBorderColorSameAsPositive)||e.useNegativeBorderColor(!d(i.negativeBarBorderColorSameAsPositive,!0)),2===(r=wt(i,"cfvo")).length&&(e.minType(De(r[0].type)),o=wt(r[0],"f"),a=Ue(r[0],o&&o[0]),T(a)||e.minValue(Pe(a)),e.maxType(De(r[1].type)),o=wt(r[1],"f"),a=Ue(r[1],o&&o[0]),T(a)||e.maxValue(Pe(a))),(r=Ct(i,"fillColor"))&&e.color(Mt(r)),(o=Ct(i,"borderColor"))&&e.borderColor(Mt(o)),(a=Ct(i,"negativeFillColor"))&&e.negativeFillColor(Mt(a)),(r=Ct(i,"negativeBorderColor"))&&e.negativeBorderColor(Mt(r)),(o=Ct(i,"axisColor"))&&e.axisColor(Mt(o)),(a=Ne(t))&&0<a.length&&e.color(a[0]),e.ranges(n)},c.prototype.yh=function(t,n,e,i,r,o){var a=this;r?a.sX(t,n):a.uX(t,n),a.initCondition(i)},Ln=c,p.DataBarRule=Ln,i={gradient:n("gradient",!0),color:n("color",g),showBorder:n("showBorder",!1),borderColor:n("borderColor","black"),dataBarDirection:n("dataBarDirection",0),negativeFillColor:n("negativeFillColor","red"),useNegativeFillColor:n("useNegativeFillColor",!0),negativeBorderColor:n("negativeBorderColor","black"),useNegativeBorderColor:n("useNegativeBorderColor",!1),axisPosition:n("axisPosition",0),axisColor:n("axisColor","black"),showBarOnly:n("showBarOnly",!1)},b.extend(Ln.prototype,i),Bn=de,p.IconCriterion=Bn,Pn=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],O(k,Jn=Rn),k.prototype.xX=function(t){var n=this;n.iconSetType(t,!1),n.iconSetType()>=vn.threeArrowsColored&&n.iconSetType()<=vn.threeSymbolsUncircled?(n.hJ=[],n.hJ[0]=new Bn(!0,mn.percent,33),n.hJ[1]=new Bn(!0,mn.percent,67),n.iJ=[],n.iJ[0]={iconSetType:t,iconIndex:0},n.iJ[1]={iconSetType:t,iconIndex:1},n.iJ[2]={iconSetType:t,iconIndex:2}):n.iconSetType()>=vn.fourArrowsColored&&n.iconSetType()<=vn.fourTrafficLights?(n.hJ=[],n.hJ[0]=new Bn(!0,mn.percent,25),n.hJ[1]=new Bn(!0,mn.percent,50),n.hJ[2]=new Bn(!0,mn.percent,75),n.iJ=[],n.iJ[0]={iconSetType:t,iconIndex:0},n.iJ[1]={iconSetType:t,iconIndex:1},n.iJ[2]={iconSetType:t,iconIndex:2},n.iJ[3]={iconSetType:t,iconIndex:3}):n.iconSetType()>=vn.fiveArrowsColored&&n.iconSetType()<=vn.fiveBoxes?(n.hJ=[],n.hJ[0]=new Bn(!0,mn.percent,20),n.hJ[1]=new Bn(!0,mn.percent,40),n.hJ[2]=new Bn(!0,mn.percent,60),n.hJ[3]=new Bn(!0,mn.percent,80),n.iJ=[],n.iJ[0]={iconSetType:t,iconIndex:0},n.iJ[1]={iconSetType:t,iconIndex:1},n.iJ[2]={iconSetType:t,iconIndex:2},n.iJ[3]={iconSetType:t,iconIndex:3},n.iJ[4]={iconSetType:t,iconIndex:4}):n.iconSetType()>vn.fiveBoxes&&(n.hJ=[],n.iJ=[])},k.prototype.Hc=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xX(t)},k.prototype.NX=function(t){var n=Z(this.hJ)+1;return this.reverseIconOrder()&&2<n?n-1-t:t},k.prototype.bX=function(t,n,e,i){var r,o,r=this,o=r.hJ[i];if(o)switch(o.iconValueType){case mn.formula:case mn.number:return r.dX(t,n,e,o.iconValue);case mn.percent:return r.gX(t,n,e,o.iconValue);case mn.percentile:return r.pX(t,n,e,o.iconValue);default:return g}},k.prototype.evaluate=function(t,n,e,i){var r,o,a,u,o,i,s,c,f,l,h,c,a,i,r=this,o=i;if(T(o))return g;if(a={},u=ot(i,!0)&&"boolean"!=typeof o&&ut(i,a)?a.value:NaN,isNaN(u))return g;if(o=0,i=r.iconSetType(),s=r.hJ,i>=vn.fiveArrowsColored?o=5:i>=vn.fourArrowsColored?o=4:i>=vn.threeArrowsColored&&(o=3),!s)return 0;for(f=0,l=o-1;0<l;l--)if(l<Z(s)+1&&(c=s[l-1],!T(c&&c.iconValue))&&(h=r.bX(t,n,e,l-1),!T(h))&&(c=c.isGreaterThanOrEqualTo?h<=u:h<u,u<Number.MAX_VALUE)&&c){f=l;break}return a=r.NX(f),(i=r.iJ)?{iconSetType:i[a]?i[a].iconSetType:vn.noIcons,iconIndex:i[a]?i[a].iconIndex:0,showIconOnly:r.showIconOnly()}:{iconSetType:vn.noIcons,iconIndex:0,showIconOnly:r.showIconOnly()}},k.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,g),t.hJ=g,t.stopIfTrue(!1),t.priority(1),t.minColor(g),t.minValue(g),t.minType(5),t.midColor(g),t.midValue(g),t.midType(g),t.maxColor(g),t.maxValue(g),t.maxType(7),t.iJ=g},k.prototype.icons=function(t){return 1===arguments.length&&(this.iJ=t),this.iJ},k.prototype.iconCriteria=function(){return this.hJ},k.prototype.toJSON=function(t){return Kt.call(this,t,Pn)},k.prototype.fromJSON=function(t,n,e){Xt.call(this,n,Pn,t,e),this.initCondition(n)},k.prototype.aX=function(){var t,n,e,i,t,n=this.hJ;if(n&&0<n.length)for(e=0;e<n.length;e++)if(i=n[e].iconValue,_t(i))return!0},k.prototype.oX=function(){var t,n,e,i,r,o,a,u,t=this,n={n_:H,sqref:Nt(t.ranges())};for(n.pivot=T(t.pivotTableName)?S:"1",e=t.iconSetType(),T(e)&&(e=0),n.c_=[{n_:"cfRule",type:"iconSet",priority:t.priority()?""+t.priority():"1",c_:[{n_:"iconSet",iconSet:Ee(e),reverse:t.reverseIconOrder()?"1":S,showValue:t.showIconOnly()?"0":S,c_:[{n_:"cfvo",type:"percent",val:"0"}]}]}],i=n.c_[0].c_[0].c_,o=0,a=(r=t.hJ).length;o<a;o++)u=r[o],i.push({n_:"cfvo",type:Fe(u.iconValueType),val:pt(gt(u.iconValue)),gte:!1===u.isGreaterThanOrEqualTo?"0":S});return t.rJ&&n.c_[0].c_.push({n_:U,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),n},k.prototype.IJ=function(){var t,n,e,i,e,r,e,o,a,u,s,c,f,l,h,d,v,h,h,t=this,n={n_:"conditionalFormatting",r_:[2]};for(n.pivot=T(t.pivotTableName)?S:"1",i={n_:"cfRule",type:"iconSet",id:e=zt()},t.rJ=e,T(t.priority())||(i.priority=t.priority()),r={n_:"iconSet",iconSet:Ee(e=t.iconSetType())},(e=Me(e,t))&&(r.custom="1"),t.showIconOnly()&&(r.showValue="0"),!t.reverseIconOrder()||e||(r.reverse="1"),o=[{n_:"cfvo",type:"percent",c_:[{n_:"f",c_:["0"]}]}],a=t.hJ,e&&t.reverseIconOrder()&&(a=a.concat([]).reverse()),u=0;u<a.length;u++)!(c={n_:"cfvo",type:Fe((s=a[u]).iconValueType),c_:[{n_:"f",c_:[pt(mt(s.iconValue))]}]})===s.isGreaterThanOrEqualTo&&(c.gte="0"),o.push(c);for(f=t.iJ,l=0;l<f.length;l++)h={n_:"cfIcon",iconSet:Ee((h=Ye(d=(h=f[l]).iconSetType,v=h.iconIndex)).iconSetType),iconId:h.iconIndex},o.push(h);return r.c_=o,i.c_=[r],n.c_=[i,{n_:"sqref",c_:[Nt(t.ranges())]}],n},k.prototype.wh=function(t,n,e,i,r){var o=this;if(!ee(i)||!o.aX())return T(o.condition())&&o.initCondition(),n?o.IJ():o.oX()},k.prototype.uX=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=t.c_[0];if(i)for(r=Oe(i.iconSet||"3TrafficLights1"),e.showIconOnly(!d(i.showValue,!0)),e.reverseIconOrder(d(i.reverse,!1)),e.iconSetType(r),e.ranges(n),a=1,u=(o=xe(t)).length;a<u;a++)s=e.hJ[a-1],c=o[a],s?(c.type&&(s.iconValueType=Le(c.type)),T(c.val)||(s.iconValue=Xn(c.val)),T(c.gte)||(s.isGreaterThanOrEqualTo=d(c.gte))):(s=new Bn(d(c.gte),Le(c.type),Xn(c.val)),e.hJ[a-1]=s);t.c_[1]&&t.c_[1].n_===U&&(e.rJ=he(t.c_[1]))},k.prototype.sX=function(t,n){var e,t,i,r,o,a,u,s,c,f,l,h,e=this,t=Ct(t,"iconSet");for(e.iconSetType(Oe(t.iconSet)),e.ranges(n),T(t.showValue)||e.showIconOnly(!d(t.showValue,!0)),T(t.reverse)||e.reverseIconOrder(d(t.reverse,!1)),r=1,o=(i=wt(t,"cfvo")).length;r<o;r++)a=e.hJ[r-1],s=(u=i[r]).val,T(s)&&(c=Ct(u,"f"),s=V(c&&c.c_&&c.c_[0])),a?(u.type&&(a.iconValueType=Le(u.type)),T(s)||(a.iconValue=0===s?"=0":Xn(s)),T(u.gte)||(a.isGreaterThanOrEqualTo=d(u.gte))):(a=new Bn(d(u.gte),Le(u.type),Xn(s)),e.hJ[r-1]=a);for(r=0,o=(f=wt(t,"cfIcon")).length;r<o;r++)l=e.iJ[r],h=f[r],l&&(T(h.iconSet)||(l.iconSetType=Oe(h.iconSet)),T(h.iconId)||(l.iconIndex=+h.iconId))},k.prototype.yh=function(t,n,e,i,r,o){var a=this;r?a.sX(t,n):a.uX(t,n),a.initCondition(i)},k.getIcon=function(t,n){return g},k.kX=function(t,n,e,i,r,o,a){var u;a.getState(n)?(u=a.getImage(n),t.drawImage(u,e,i,r,o)):a.addImage(n)},k.paintIconSet=function(t,n,e,i,r,o,a,u,s,c){var f,a,l,h,d,v,u,l,h=C.W.Lge(a,1).fontSize,d=2,v=2,f=e+2;if(n.showIconOnly&&(1===a.hAlign?f=e+r/2-h/2:2===a.hAlign&&(f=e+r-2-h-2)),a=1===a.vAlign?i+o/2-h/2:2===a.vAlign?i+o-2-u/2-h/2:i+2+u/2-h/2,n.iconSetType!==vn.noIcons)if((u=k.getIcon(n.iconSetType,n.iconIndex))&&"string"===b.getType(u)&&c)try{k.kX(t,u,f,a,h,h,c)}catch(t){}else re(t,n,f,a,h,e,i,r,o)},Gn=k,p.IconSetRule=Gn,i={iconSetType:n("iconSetType",vn.threeArrowsColored,function(t){this.xX(t)}),reverseIconOrder:n("reverseIconOrder",!1),showIconOnly:n("showIconOnly",!1)},b.extend(Gn.prototype,i),Un=["ruleType","state","style","priority","stopIfTrue","ranges"],O(_,Kn=e),_.prototype.JJ=function(t,n){var e,i,r,o,e=this.ranges();if(e)for(i=Z(e),r=void 0,o=0;o<i;o++)if((r=e[o]).contains(t,n))return o;return-1},_.prototype.zT=function(t){return-1<t},_.prototype.getExpected=function(t){void 0===t&&(t=0);var n=this.style();return Yt(n)?n[t]:n},_.prototype.isRow=function(){var t,n,t=this,n=t.ruleType();return T(t.DX)&&(n===I.rowStateRule?t.DX=!0:n===I.columnStateRule&&(t.DX=!1)),this.DX},_.prototype.isStateRule=function(){return!0},_.prototype._X=function(){var t,n,t,t=this,n=t.state(),t=t.ranges();return(0,p.aJ)(m.stateCondition,gn.contains,n,S,S,S,t)},_.prototype.rowStateRuleCreateCondition=function(){return this._X()},_.prototype.columnStateRuleCreateCondition=function(){return this._X()},_.prototype.createCondition=function(){return this[I[this.ruleType()]+"CreateCondition"]()},_.prototype.EX=function(t){var n;return _.StatesPriority.indexOf(this.state())<_.StatesPriority.indexOf(t.state())},_.prototype.fromJSON=function(t,n,e){var i=Un;T(t.condition)||(i=Un.concat(["condition"])),Xt.call(this,n,i,t,e),this.initCondition(n)},_.prototype.toJSON=function(t){var n,t,e,n=this;return T(n.condition())&&this.initCondition(),t=Kt.call(n,t,Un),(e=n.ruleType())===I.conditionRuleBase&&(t.condition=n.condition().toJSON()),t},_.StatesPriority=[4,C.RowColumnStates.invalid,C.RowColumnStates.dirty,C.RowColumnStates.invalidFormula,C.RowColumnStates.inserted,256,C.RowColumnStates.selected,C.RowColumnStates.active,C.RowColumnStates.hover,C.RowColumnStates.edit],Hn=_,(p.StateRule=Hn).prototype.state=n("state",g),D.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.getRules(),e={};if(n)for(i=void 0,r=0,o=n;r<o.length;r++)for(u=0,s=i=(a=o[r]).ranges();u<s.length;u++)c=s[u],P(e,G(c));return e},D.prototype.L0=function(){this.eJ=g},D.prototype.getRule=function(t){return this.qK[t]},D.prototype.count=function(t){var n,e,i,r,o;if(T(t))return Z(this.qK);for(i=e=0,r=(n=this.qK).length;i<r;i++)te((o=n[i]).nT)===t&&e++;return e},D.prototype.qve=function(t){var n,e,i,r;if(T(t))return 0<Z(this.qK);for(e=0,i=(n=this.qK).length;e<i;e++)if(te((r=n[e]).nT)===t)return!0;return!1},D.prototype.jX=function(){return this.qK},D.prototype.GJ=function(t){for(var n,e,i,r,o,n=[],e=this.eJ,i=Z(t),r=0;r<i;r++)o=e.JS(t[r]),n.push(o);return n},D.prototype.OX=function(t){for(var n,e,i,r,o,a,n=[],e=this.eJ,i=0,r=Z(t);i<r;i++)o=t[i],a=new Ft(o.row,o.col,W(o),Q(o)),0===o.row&&W(o)===e.getRowCount()&&(a.row=-1),0===o.col&&Q(o)===e.getColumnCount()&&(a.col=-1),n.push(a);return n},D.prototype.Ige=function(t,n,e){var i,e,e,i=this;-1!==e&&(e=i.xge[e])&&ge(t,e),-1!==n&&(e=i.Nge[n])&&ge(t,e),0<i.kge.length&&ge(t,i.kge)},D.prototype._ge=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,o=this,a=o.xge,u=o.Nge,s=function(t){var n=t.indexOf(r);-1<n&&t.splice(n,1)};if(-1===t&&-1!==n&&0<i)for(f=(c=n)+i;c<f;c++)(l=a[c])&&(r?s(l):delete a[c]);if(-1!==t&&-1===n&&0<e)for(f=(h=t)+e;h<f;h++)(d=u[h])&&(r?s(d):delete u[h]);if(-1===t&&-1===n)if(r){for(v in s(o.kge),a)a.hasOwnProperty(v)&&s(a[v]);for(v in u)u.hasOwnProperty(v)&&s(u[v])}else o.kge=[],o.xge={},o.Nge={}},D.prototype.sE=function(){this.tJ={},this.kge=[],this.Nge={},this.xge={}},D.prototype.C8=function(){if(this.nJ&&(this.sE(),this.qK))for(var t=0;t<Z(this.qK);t++)this.fE(this.qK[t])},D.prototype.TJ=function(){this.nJ&&(this.tJ={})},D.prototype.fE=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I;if(this.nJ){for(e=(n=this).tJ,u=t.ranges(),s=[],c=0;c<Z(u);c++)if(l=-1===(f=u[c]).col,(h=-1===f.row)&&l)n.kge.push(t);else if(h){if(0<f.colCount)for(v=(d=f.col)+f.colCount;d<v;d++)(m=n.xge[d])||(n.xge[d]=m=[]),m.push(t)}else if(l){if(0<f.rowCount)for(v=(g=f.row)+f.rowCount;g<v;g++)(p=n.Nge[g])||(n.Nge[g]=p=[]),p.push(t)}else s.push(f);for(s=n.GJ(s),w=(b=n.eJ).getRowCount(),y=b.getColumnCount(),c=0;c<Z(s);c++)for(M=(f=s[c]).row,C=f.col,w<=M+(S=W(f))-1&&(S=w-M),y<=C+(T=Q(f))-1&&(T=y-C),A=0;A<S;A++)for((i=e[o=A+M])||(e[o]=i=[]),I=0;I<T;I++)(r=i[a=I+C])||(i[a]=r=[]),r.push(t)}},D.prototype.RX=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g;if(this.nJ){for(n=t.ranges(),e=0,i=Z(n);e<i;e++)r=n[e],this._ge(r.row,r.col,r.rowCount,r.colCount,t);for(o=this.tJ,f=this.GJ(t.ranges()),l=0;l<Z(f);l++)for(h=f[l],d=0;d<W(h);d++)if(a=o[s=d+h.row])for(v=0;v<Q(h);v++)if(u=a[c=v+h.col]){for(m=[],g=0;g<Z(u);g++)u[g]!==t&&m.push(u[g]);0===Z(m)&&(m=S),a[c]=m}}},D.prototype.BX=function(t,n,e,i){var r,o,a,u,s,c;if(this.nJ)for(this._ge(t,n,e,i),-1===n&&(n=0,i=this.eJ.getColumnCount()),-1===t&&(t=0,e=this.eJ.getRowCount()),a=this.tJ,s=0;s<e;s++)if(u=a[r=s+t])for(c=0;c<i;c++)u[o=c+n]=S},D.prototype.LX=function(t,n){for(var e,i,r,e=[],i=0;i<Z(this.qK);i++)(r=this.qK[i]).contains(t,n)&&e.push(r);return e},D.prototype.addSpecificTextRule=function(t,n,e,i){var i=new M(2,i,e,t,g,g,n);return this.addRule(i)},D.prototype.addCellValueRule=function(t,n,e,i,r){var r=new M(1,r,i,t,ve(n),ve(e));return this.addRule(r)},D.prototype.addDateOccurringRule=function(t,n,e){var e=new M(4,e,n,g,g,g,g,g,t);return this.addRule(e)},D.prototype.addFormulaRule=function(t,n,e){var e=new M(3,e,n,g,g,g,g,t);return this.addRule(e)},D.prototype.addTop10Rule=function(t,n,e,i){var i=new M(5,i,e,g,g,g,g,g,t,n);return this.addRule(i)},D.prototype.addUniqueRule=function(t,n){var n=new M(6,n,t);return this.addRule(n)},D.prototype.addDuplicateRule=function(t,n){var n=new M(7,n,t);return this.addRule(n)},D.prototype.addAverageRule=function(t,n,e){var e=new M(8,e,n,g,g,g,g,g,t);return this.addRule(e)},D.prototype.add3ScaleRule=function(t,n,e,i,r,o,a,u,s,c){var t,t=0===arguments.length?new Rn(11):new Rn(11,t,n,e,i,r,o,a,u,s,c);return this.addRule(t)},D.prototype.add2ScaleRule=function(t,n,e,i,r,o,a){var t,t=0===arguments.length?new Rn(10):new Rn(10,t,n,e,g,g,g,i,r,o,a);return this.addRule(t)},D.prototype.addDataBarRule=function(t,n,e,i,r,o){var t,t=0===arguments.length?new Ln:new Ln(t,n,e,i,r,o);return this.addRule(t)},D.prototype.addIconSetRule=function(t,n){var t=new Gn(t,n);return this.addRule(t)},D.prototype.addRowStateRule=function(t,n,e){var i,t,i=this,t=new Hn(I.rowStateRule,t,n,e);return i.addRule(t)},D.prototype.addColumnStateRule=function(t,n,e){var i,t,i=this,t=new Hn(I.columnStateRule,t,n,e);return i.addRule(t)},D.prototype.addRule=function(t){var n,e,i,r,o,a,a,a,r,o,u,s,c,f,l,h,n=this,e=n.eJ;if(e){if(!t)throw new Error(Zt().Exp_RuleIsNull);for(o=r=void 0,(i=t.ranges())&&(r=(a=Dt(i)).r,o=a.c,t.ranges(i.slice(0))),(a=(a=t.getExpected())&&a.formatter)&&"string"==typeof a&&e.SL(r||0,o||0,a),t.isStateRule()&&(r=t.state(),o=t.isRow(),e._1)&&e._1.enableState(r,o),e.Ut.vJ(),u=1,s=void 0,c=Z(n.qK),s=0;s<c;s++)h=(l=(f=n.qK[s])._ps).priority||1,l.priority=h+1,t.isStateRule()&&f.isStateRule()&&t.EX(f)&&(u=tt(u,l.priority),--l.priority);return t.priority(u),n.qK.push(t),D.et(e,"onRuleAdded",{ranges:i}),t.context(e),n.fE(t),e.Ut.vJ(!0),e.zw(),t}},D.prototype.removeRule=function(t){var n,e,i,r,r,o,i,a,u,s,c,n=this,e=n.eJ,i=e.parent;if(e){if(t&&((r=(r=t.getExpected())&&r.formatter)&&"string"==typeof r&&i.bp[r]&&i.o3(r),e.Ut.vJ(),n.RX(t),Pt(n.qK,t),e.Ut.vJ(!0),D.et(e,"onRuleRemoved",{priority:t.priority(),ranges:t.ranges()}),t.isStateRule())){for(o=t.state(),i=t.isRow(),a=!1,u=0,s=n.qK;u<s.length;u++)if((c=s[u]).isStateRule()&&c.state()===o){a=!0;break}a||e._1.disableState(o,i)}e.zw()}},D.prototype.FX=function(t,n,e,i,r){var o,a,u,s,n,i,e,r,c,f,f,f,n;return t.intersect(n,e,i,r)?(o=t.row,a=t.row+W(t)-1,u=t.col,s=t.col+Q(t)-1,i=(n=n)+i-1,r=(e=e)+r-1,c=[],-1!==o&&-1!==u&&-1!==n&&-1!==e&&(0<e-u&&(f=Y(o,u,W(t),e-u),c.push(f)),0<s-r&&(f=Y(o,1+r,W(t),s-r),c.push(f)),0<n-o&&(f=Y(o,tt(e,u),n-o,$(r,s)-tt(e,u)+1),c.push(f)),0<a-i)&&(n=Y(1+i,tt(e,u),a-i,$(r,s)-tt(e,u)+1),c.push(n)),0<Z(c)?c:g):[t]},D.prototype.removeRuleByRange=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r=this,o=r.eJ;if(o){if(a=[],r.qK)for(o.Ut.vJ(),r.BX(t,n,e,i),u=0,s=Z(r.qK);u<s;u++)if(c=r.qK[u],D.et(o,"onRuleRemoved",{ranges:[new Ft(t,n,e,i)]}),c&&c.ranges()&&c.intersects(t,n,e,i))if(o.pivotTables&&c.pivotTableName)(f=o.pivotTables.get(c.pivotTableName)).tqt(c,t,n,e,i);else{for(l=[],h=r.GJ(c.ranges()),d=0,v=Z(h);d<v;d++)(m=r.FX(h[d],t,n,e,i))&&(l=l.concat(m));0<Z(l)?c.ranges(r.OX(l)):a.push(c)}for(g=0,p=Z(a);g<p;g++)Pt(r.qK,a[g]);o.Ut.vJ(!0),o.zw()}},D.prototype.clearRule=function(){var t,n,e,i,r,o,a,a,u,s,t=this,n=t.eJ,e=n.parent;if(n){for(i=t.qK,n.Ut.vJ(),r=0;r<i.length;r++)a=(a=(o=i[r]).getExpected())&&a.formatter,D.et(n,"onRuleRemoved",{ranges:o.ranges()}),a&&"string"==typeof a&&e.bp[a]&&e.o3(a);if(n.pivotTables)for(u=n.pivotTables.all(),r=0;r<u.length;r++)(s=u[r]).iqt();t.qK.length=0,t.C8(),n.Ut.vJ(!0),n.zw()}},D.prototype.getRules=function(t,e){var n,i,r,i,o,a,i,u,s,c,n=this,i=n.qK;if(0===arguments.length||0===Z(i))return i;if(t=t===S?-1:t,e=e===S?-1:e,r=[],n.nJ)i=n.tJ,a=void 0,-1!==t&&-1!==e?(a=i[t])&&(o=a[e],ge(r,o)):-1===t?b.each(i,function(t,n){o=n[e],ge(r,o)}):(a=i[t])&&b.each(a,function(t,n){ge(r,n)}),n.Ige(r,t,e);else if(u=(i=n.eJ).getRowCount(),s=i.getColumnCount(),c=void 0,-1!==t&&-1!==e)ge(r,n.LX(t,e));else if(-1===t){if(i.NMi)return n.LX(t,e);for(c=0;c<u;c++)ge(r,n.LX(c,e))}else{if(i.NMi)return n.LX(t,e);for(c=0;c<s;c++)ge(r,n.LX(t,c))}return r},D.prototype.containsRule=function(t,n,e){return!(!t||!Bt.OS(this.qK,t))&&t.contains(n,e)},D.prototype.PX=function(t,n){var e,i,r,o,a,r,r,r,u,s,c,f,e=this,i=e.eJ;if(i){if(!t)throw new Error(Zt().Exp_RuleIsNull);for(a=o=void 0,(r=t.ranges())&&(o=(r=Dt(r)).r,a=r.c),(r=(r=t.getExpected())&&r.formatter)&&"string"==typeof r&&i.SL(o||0,a||0,r),i.Ut.vJ(),u=0,s=Z(e.qK);u<s;u++)n<=(f=(c=e.qK[u]._ps).priority||1)&&(c.priority=f+1);return t.priority(n),(e.qK[n]=t).context(i),e.fE(t),i.zw(),t}},D.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,f,i=this,r,o=i.eJ.Ut,a=i.qK,u=Z(a),s=!1;for(o.vJ(),c=0;c<u;c++)(f=a[c])&&f.qJ(t,n,e)&&(s=!0);s&&i.C8()},D.prototype.$J=function(t,n,e,i,r){var o,a,u,s,o=this;if(o.qK&&o.eJ)for(a=Z(o.qK),u=0;u<a;u++)(s=o.qK[u])&&(e?s.JO(t,n,i,r):s.qO(t,n,i,r));o.C8()},D.prototype.JO=function(t,n,e,i){this.$J(t,n,!0,e,i)},D.prototype.qO=function(t,n,e,i){this.$J(t,n,!1,e,i)},D.prototype.tX=function(t,n,e,i,r){var o,a,u,s,o=this;if(o.qK&&o.eJ)for(u=(a=Z(o.qK))-1;0<=u;u--)(s=o.qK[u])&&(e?s.xP(t,n,i,r):s.NP(t,n,i,r),s.ranges().length<=0)&&(o.RX(s),o.qK.splice(u,1));o.C8()},D.prototype.xP=function(t,n,e,i){this.tX(t,n,!0,e,i)},D.prototype.NP=function(t,n,e,i){this.tX(t,n,!1,e,i)},D.prototype.dl=function(){var t,n,e,i,t=this.qK;if(t!==g&&0<Z(t))for(e=0,i=Z(t);e<i;e++)(n=t[e]).dl&&n.dl()},D.prototype.jB=function(t,n,F,e,i,r,o,L,a,u){var a,s,c,f,l,B,h,d,v,P,m,g,p,b,w,y,M,C,S,T,s,A,I,T,G,x,N,k,U,_,k,_,H,D,j,V,O,E,R,O,z,R,O,R,O,c=[],f=[],l=[],B=[],h=[],d=this,v=d.eJ,P=!a&&v.o5();for(u&&(r=(a=[o,r])[0],o=a[1]),-1===t&&(e=t=0,r=v.getRowCount()),-1===n&&(i=n=0,o=v.getColumnCount()),m=0;m<r;m++)for(g=0;g<o;g++)for(p=d.getRules(t+m,n+g),b=0;b<Z(p);b++)if(y=(w=p[b]).ranges(),!w.isStateRule()){for(M=[],C=0;C<Z(y);C++)S=y[C],s=(T=v.JS(S)).row,A=T.col,I=W(T),T=Q(T),(G=Gt(l,S)<=-1||-1<Gt(l,S)&&Gt(B,w)<=-1)&&S.contains(t+m,n+g)&&(l.push(S),B.push(w),x=Y(e+m,i+g,-1,-1),(x=u?Y(e+g,i+m,-1,-1):x).rowCount=r+t<=s+I?r-m:t<s?I:s+I-t,x.colCount=o+n<=A+T?o-g:n<A?T:A+T-n,u&&(s=[x.colCount,x.rowCount],x.rowCount=s[0],x.colCount=s[1]),d===F&&S.containsRange(x)||M.push(x),L)&&He(h,x,w);0<M.length&&((N=c.indexOf(w))<0?(P&&(M=d.GX(M)),c.push(w),f.push(M)):(P&&(U=k=void 0,_=f[N][0].row,H=f[N][0].col,k=(D=M[0]).row-_,U=D.col-H,_=v.lT(_,k,!(k=_=void 0)),k=v.lT(H,U),D.row+=_,D.col+=k,M=d.GX(M)),f[N]=f[N].concat(M)))}for(j=0,V=c.length;j<V;j++)R=(E=d.pJ((O=c[j]).toJSON(),O.context())).ranges(),Ve(h,O,E),E.ranges(f[j]),(O=E.D5)&&(z=1===v.parent.options.referenceStyle,R=Dt(R),O=J.formulaToExpression(v,O,R.r,R.c,z),R=Dt(f[j]),O=J.expressionToFormula(v,O,R.r,R.c,z),E.formula(O)),F.addRule(E);return d.C8(),h},D.prototype.GX=function(t){var n,e,t,i,r,o,a,u,s,c,f,l,h,n,e=this.eJ,i=[];if(0<t.length){for(r=(t=t[0]).row,o=t.col,a=t.rowCount,u=t.colCount,a+=e.lT(r,a,!0),u+=e.lT(o,u),s=[],c=void 0,f=0;f<u;f++)0===f?c=new Ft(r,o,1,1):0!==e.getColumnWidth(o+f)?c.colCount++:(s.push(c),f=e.O5(o+f-1)-1-o,c=new Ft(r,o+f+1,1,0));for(s.push(c),l=0;l<a;l++)if(0!==l)if(0!==e.getRowHeight(r+l))for(h=0;h<s.length;h++)s[h].rowCount++;else for(i=i.concat(we(s)),l=e.j5(r+l-1)-1-r,h=0;h<s.length;h++)s[h].rowCount=0,s[h].row=r+l+1;i=i.concat(s)}return i},D.prototype.OB=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,I,_,a=[],u=this,s=u.eJ,c=s.getRowCount(3),f=s.getColumnCount(3);for(-1===t&&(t=0,e=s.getRowCount()),-1===n&&(n=0,i=s.getColumnCount()),l=[],h=0,d=r;h<d.length;h++)for(m=0,g=(v=d[h]).ranges;m<g.length;m++)ye(l,p=g[m])||l.push(p);for(b=0;b<e;b++)for(w=0;w<i;w++)for(y=u.getRules(t+b,n+w),M=0;M<Z(y);M++)if(S=(C=y[M]).ranges(),!C.isStateRule()){for(T=[],A=0;A<Z(S);A++)p=S[A],x=(I=s.JS(p)).row,N=I.col,k=W(I),I=Q(I),ze(r,p,C)||Gt(a,p)<=-1&&p.contains(t+b,n+w)&&(a.push(p),x<t&&T.push(Y(x,N,t-x,I)),N<n&&T.push(Y(tt(t,x),N,$(t+e,x+k)-tt(t,x),n-N)),n+i<N+I&&T.push(Y(tt(t,x),n+i,$(t+e,x+k)-tt(t,x),N+I-(n+i))),t+e<x+k)&&T.push(Y(t+e,N,x+k-(t+e),I));s&&s.Ut.vJ(),u.UX(s,a,l,S,c,f,o),0<(_=S.concat(T)).length?(C.XJ(),C.ranges(_)):u.removeRule(C)}u.C8()},D.prototype.UX=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,u=0;u<Z(n);u++){if(c=[s=n[u]],a)for(f=0;f<Z(e);f++)l=e[f],s.intersect(l.row,l.col,l.rowCount,l.colCount)&&(c=c.concat(t.BR(s,l,r,o)));for(h=0;h<Z(c);h++)Pt(i,c[h])}},D.prototype._e=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,h,d,v,l,s=16,c=!1,f=!1,l=u.sheet,h=u.row,d=u.col,v=l.zoom(),l=this.U(l,h,d,n,u.sheetArea),h=l&&l.iconSet,d=l&&l.dataBar;return(d||h)&&(t.save(),t.beginPath(),d&&(Ln.paintDataBar(t,d,e,i,r,o),c=d.showBarOnly),h&&((r<(s=parseInt(16*v+"",10))||o<s)&&(t.rect(e,i,r,o),t.clip(),t.beginPath()),Gn.paintIconSet(t,h,e,i,r,o,a,u.lineHeight,v,u.imageLoader),f=h.showIconOnly),t.restore()),c||f},D.prototype.U=function(t,n,e,i,r){var r,o,a,u,s,c,f,l,h,d,v,m;if(T(r)||3===r){if(r=this,s=(o=t.Jt).yl(n,e))a=s.i,u=s.d;else{if(c=r.getRules(n,e),0<(f=Z(c))){for(c.sort(function(t,n){return t.priority()-n.priority()}),h=l=g,m=v=d=void 0,m=0;m<f&&(!l||!h);m++)(d=c[m])&&(w(d,Ln)&&(l=d),w(d,Gn))&&(h=d);if(l||h)for(l=h=g,m=0;m<f&&(!l||!h)&&!((d=c[m])&&(!l&&w(d,Ln)&&(l=d),!h&&w(d,Gn)&&(h=d),d.stopIfTrue())&&(v=d.evaluate(t,n,e,i)));m++);l&&(u=l.evaluate(t,n,e,i)),h&&(a=h.evaluate(t,n,e,i))}o.Ml(n,e,u,a)}return{dataBar:u,iconSet:a}}},D.prototype.O=function(t,n,e){var i,r,o;if(T(e)||3===e)for(i=this.getRules(t,n),r=0,o=Z(i);r<o;r++)if(i[r]instanceof Gn)return!0;return!1},D.prototype.toJSON=function(t){for(var n,e,i,n=[],e=0;e<Z(this.qK);e++)i=this.qK[e],n.push(i?i.toJSON(t):g);return 0===Z(n)?S:{rules:n}},D.prototype.fromJSON=function(t,n,e,i){var r,o,a,u,u;if(t&&(r=t.rules)){for(this.qK=[],o=Z(r),a=0;a<o;a++)(u=r[a]).pivot&&i||(u=this.pJ(u,n,e))&&this.qK.push(u);this.nJ=!pe(r),this.C8()}},D.prototype.xJ=function(t,n,e,i,r,o){var a,u;switch(t.type){case"dataBar":u=new Ln;break;case"iconSet":u=new Gn;break;case"colorScale":u=new Rn;break;default:u=new M}return u&&u.yh(t,n,e,i,o,void 0,r),u},D.prototype.pJ=function(t,n,e){var i,r,o,o,t,i=g;return t&&(o=(r=this.HX())[t.ruleType])&&(i=new o).fromJSON(t,n,e),i.isStateRule()&&(o=i.state(),t=i.isRow(),n)&&n._1&&n._1.enableState(o,t),i},D.prototype.HX=function(){var t;return this.$K||((t={})[0]=M,t[1]=M,t[2]=M,t[3]=M,t[4]=M,t[5]=M,t[6]=M,t[7]=M,t[8]=M,t[9]=Rn,t[10]=Rn,t[11]=Rn,t[12]=Ln,t[13]=Gn,t[14]=Hn,t[15]=Hn,this.$K=t),this.$K},D.prototype.NJ=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,p,w,w,y;if(t&&t.c_&&!(t.c_.length<=0))for(s=0,c=(a=t.c_).length;s<c;s++)for(f=a[s],l=C.NodeHelper.ur(f.pivot),d=void 0,(h=Ct(f,"sqref"))&&(d=xt(h.c_[0]),o)&&C.Util.Ao(e,d,!0,n),v=wt(f,"cfRule"),m=0;m<v.length;m++)b=void 0,"dataBar"===(p=(g=v[m]).type)?(b=Ge(i,g.id))||(b=new Ln,this.qK.push(b)):"iconSet"===p?(b=Ge(i,g.id))||(b=new Gn,this.qK.push(b)):(w=Re(p)===I.specificTextRule,((p="expression"===p||"cellIs"===p)||w)&&(!u&&r.lossless&&((w=new C.SimpleSharedStrings).yh(r.lossless.sharedColors),(y=new C.SimpleSharedStrings).yh(r.lossless.commonSharedStrings),(u=new C.SharedDxfs(w,y)).rv(r.lossless.sharedDxfs)),b=p?new M(3):new M(I.specificTextRule,d,void 0),this.qK.push(b))),b&&(b.pivot=l,b.yh(g,d,n.styleManager,e,!0,u),T(g.priority)||b.priority(+g.priority))},D.prototype.bL=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,l,h,r=this;if(r&&r.qve(i)&&(o=r.getRules(n,e),a=Z(o),u=void 0,s=g,0<a))for(i=te(i),o.sort(function(t,n){return t.priority()-n.priority()}),c=0;c<a&&!((u=o[c])&&i===te(u.nT)&&(f=r.eJ,u.isScaleRule()?10!==u.ruleType()&&11!==u.ruleType()||(s=u.evaluate(f,n,e,f.getValue(n,e,i)))&&(t=t||new Ot).backColor===S&&(t.backColor=s):u.isStateRule()?(l=u.state(),h=u.isRow(),d=u.ranges(),l=f._1.getState(n,e,l,h,d,i),(s=u.evaluate(f,n,e,l))&&(t=t||new Ot,h=f.NMi&&i===C.SheetArea.colHeader,t.h5(s,!1,1,S,h))):(s=u.evaluate(f,n,e,f.getValue(n,e,i)))&&(t=t||new Ot).h5(s,!1,1),u.stopIfTrue())&&s);c++);return t},D.prototype.wL=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,h,d,v,d,m,r={yL:!1},o=this;if(o&&o.qve(i)&&(a=o.getRules(t,n),u=Z(a),s=void 0,c=g,0<u))for(i=te(i),a.sort(function(t,n){return t.priority()-n.priority()}),f=0;f<u;f++)if((s=a[f])&&i===te(s.nT)){if(l=o.eJ,s.isScaleRule()){if(h=s.ruleType(),"backColor"===e&&(10===h||11===h)&&(c=s.evaluate(l,t,n,l.getValue(t,n,i)))){r.Y6=c,r.yL=!0;break}}else if(s.isStateRule()){if(h=s.state(),d=s.isRow(),v=s.ranges(),d=l._1.getState(t,n,h,d,v,i),!((m=s.style())&&void 0!==me(e,m,v,t,n)||s.stopIfTrue()))continue;if((c=s.evaluate(l,t,n,d))&&c[e]!==S){r.Y6=c[e],r.yL=!0;break}}else{if(!((m=s.style())&&void 0!==m[e]||s.stopIfTrue()))continue;if((c=s.evaluate(l,t,n,l.getValue(t,n,i)))&&c[e]!==S){r.Y6=c[e],r.yL=!0;break}}if(s.stopIfTrue()&&c)break}return r},Vn=D,t(p.ConditionalFormats=Vn)},"./dist/plugins/conditional/conditional.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/conditional/conditional.res.en.js");n.SR={en:e}},"./dist/plugins/conditional/conditional.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_NotSupported=n.Exp_RuleIsNull=void 0,n.Exp_RuleIsNull="The argument 'rule' is null",n.Exp_NotSupported="Not supported exception"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(F,t){"use strict";var s,c,f,l,n,e,i,r,o,a,u,h,d,v,v,m,g,p;function b(t,n,e,i,r){t.beginPath(),t.moveTo(n,e),t.lineTo(n+i,e),t.lineTo(n+i,e+r),t.lineTo(n,e+r),t.lineTo(n,e),t.closePath(),t.fill(),t.stroke()}function w(t,n,e,i,r,o){var i,r;t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,i=p[n][e].fillColor.split(" "),r=c(.2*o),t.fillStyle=i[0],b(t,r+.5,3*r+.5,r,2*r),t.fillStyle=i[1],b(t,2*r+.5,2*r+.5,r,3*r),t.fillStyle=i[2],b(t,3*r+.5,r+.5,r,4*r),t.fillStyle=i[3],b(t,4*r+.5,.5,r,5*r)}function y(t,n,e,i,r,o){var i,r;t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,i=p[n][e].fillColor.split(" "),t.fillStyle=p[n][e].strokeStyle,r=c(o/2),t.fillStyle=i[0],b(t,.5,.5,r,r),t.fillStyle=i[1],b(t,r+.5,.5,r,r),t.fillStyle=i[2],b(t,.5,r+.5,r,r),t.fillStyle=i[3],b(t,r+.5,r+.5,r,r)}function M(t,n,e,i,r,o){t.translate(i+o/2,r+o/2),t.strokeStyle=p[n][e].strokeStyle,4===e?(t.beginPath(),t.arc(0,0,o/2,0,p[n][e].rotate),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,p[n][e].rotate),t.closePath(),t.stroke()):0===e?(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,o/2,0,p[n][e].rotate),t.stroke(),t.closePath()):1===e?(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-s,0),t.lineTo(0,0),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.arc(0,0,o/2,0,2*s),t.stroke()):2===e?(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-s,.5*s),t.moveTo(0,0),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.arc(0,0,o/2,0,2*s),t.stroke()):3===e&&(t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-s,s),t.lineTo(0,0),t.fillStyle=p[n][e].fillColor,t.fill(),t.arc(0,0,o/2,0,2*s),t.stroke(),t.closePath())}function C(t,n,e){t.moveTo(f(.1*s)*n,-l(.1*s)*n),t.lineTo(f(.3*s)*e,-l(.3*s)*e),t.lineTo(0*n,-l(.5*s)*n),t.lineTo(f(.7*s)*e,-l(.7*s)*e),t.lineTo(f(.9*s)*n,-l(.9*s)*n),t.lineTo(f(1.1*s)*e,-l(1.1*s)*e),t.lineTo(f(1.3*s)*n,-l(1.3*s)*n),t.lineTo(0*e,-l(1.5*s)*e),t.lineTo(f(1.7*s)*n,-l(1.7*s)*n),t.lineTo(f(1.9*s)*e,-l(1.9*s)*e),t.lineTo(f(.1*s)*n,-l(.1*s)*n)}function S(t,n,e,i,r,o){var a,o,u,a,o=o/1.8,u=o/2.5;t.translate(o+i,o+r),t.strokeStyle="#727272",t.fillStyle=p[n][e].fillColor,t.beginPath(),2===e&&(t.strokeStyle="#727272",C(t,o,u),t.fill(),t.stroke(),t.strokeStyle=p[n][e].strokeStyle,C(t,o,u),t.stroke(),t.closePath()),0===e&&(t.fillStyle="white",C(t,o,u),t.fill(),t.stroke(),t.strokeStyle="#727272",C(t,o,u),t.stroke(),t.closePath()),1===e&&(t.strokeStyle=p[n][e].fillColor,t.moveTo(0*o,-l(.5*s)*o),t.lineTo(f(.7*s)*u,-l(.7*s)*u),t.lineTo(f(.9*s)*o,-l(.9*s)*o),t.lineTo(f(1.1*s)*u,-l(1.1*s)*u),t.lineTo(f(1.3*s)*o,-l(1.3*s)*o),t.lineTo(0*u,-l(1.5*s)*u),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*o,-l(.5*s)*o),t.lineTo(-f(.7*s)*u,-l(.7*s)*u),t.lineTo(-f(.9*s)*o,-l(.9*s)*o),t.lineTo(-f(1.1*s)*u,-l(1.1*s)*u),t.lineTo(-f(1.3*s)*o,-l(1.3*s)*o),t.lineTo(0*u,-l(1.5*s)*u),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",C(t,o,u),t.stroke(),t.closePath())}function T(t,n,e,i,r,o){2===e?x(t,n,e,i,r,o):0===e?A(t,n,e,i,r,o):1===e&&I(t,n,e,i,r,o)}function A(t,n,e,i,r,o){var o,a,o=o,a=c(o/2);t.translate(i+a,r+a),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),t.arc(0,0,a,0,2*s),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,a,0,2*s),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.375*-o,.1*-o,.75*o,.2*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.1*-o,.375*-o,.2*o,.75*o),t.closePath(),t.fill(),t.stroke()}function I(t,n,e,i,r,o){var o=o;t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*s),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*s),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(o/3,.1*o),t.lineTo(o/1.5,.1*o),t.lineTo(.625*o,.6*o),t.lineTo(.375*o,.6*o),t.lineTo(o/3,.1*o),t.moveTo(.625*o,.85*o),t.arc(.5*o,.8*o,.15*o,0,2*s),t.fillStyle=p[n][e].fillColor2,t.fill(),t.closePath()}function x(t,n,e,i,r,o){var o=o;t.translate(c(i+o/2),c(o/2+r)),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),t.arc(0,0,o/2,0,2*s),t.closePath(),t.fillStyle=p[n][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,2*s),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.325*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=p[n][e].fillColor2,t.fillRect(.325*-o,.05*o,.65*o,.2*o),t.closePath(),t.fill(),t.stroke()}function N(t,n,e,i,r,o){2===e?D(t,n,e,i,r,o):0===e?_(t,n,e,i,r,o):1===e&&k(t,n,e,i,r,o)}function k(t,n,e,i,r,o){var o=o;t.translate(i,r),t.beginPath(),t.strokeStyle=p[n][e].strokeStyle,t.moveTo(o/3,.5),t.lineTo(o/1.5,.5),t.lineTo(.625*o,.65*o),t.lineTo(.375*o,.65*o),t.lineTo(o/3,.5),t.moveTo(.65*o,.85*o),t.arc(.5*o,.85*o,.15*o,0,2*s),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function _(t,n,e,i,r,o){var o,i,r,o=o;t.translate(c(i+o/2),c(r+o/2)),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),R(t,-(i=.5*o),-(r=.075*o)),E(t,-i,r),E(t,-r,r),E(t,-r,i),E(t,r,i),E(t,r,r),E(t,i,r),E(t,i,-r),E(t,r,-r),E(t,r,-i),E(t,-r,-i),E(t,-r,-r),E(t,-i,-r),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function D(t,n,e,i,r,o){var o=o;t.translate(c(i+o/2),c(r+o/2)),t.strokeStyle=p[n][e].strokeStyle,t.rotate(p[n][e].rotate),t.beginPath(),t.fillStyle=p[n][e].fillColor,t.fillRect(.375*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=p[n][e].fillColor,t.fillRect(.375*-o,.05*o,.75*o,.2*o),t.closePath(),t.fill(),t.stroke()}function j(t,n,e,i,r,o){var o=1.2*o;t.translate(i,r),t.strokeStyle=d,t.fillStyle=d,b(t,c(.2*o)+.5,.5,c(.06*o),c(.8*o)),t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),R(t,.4*o,.5),E(t,.4*o,.5*o),E(t,.9*o,.25*o),E(t,.4*o,.5),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function L(t,n,e,i,r,o){(2===e?O:1===e?U:G)(t,n,e,i,r,o)}function B(t,n,e,i,r,o){var o=c(o);t.strokeStyle=p[n][e].strokeStyle,t.fillStyle=p[n][e].fillColor,b(t,i+.5,r+.5,o,o),t.beginPath(),t.arc(o/2+i+.5,o/2+r+.5,.375*o,0,2*s),t.fillStyle=p[n][e].fillColor2,t.fill(),t.stroke()}function O(t,n,e,i,r,o){var o=o;t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),t.arc(o/2+i,o/2+r,o/2,0,2*s),t.fillStyle=p[n][e].fillColor,t.closePath(),t.fill(),t.stroke()}function P(t,n,e,i,r,o){1===e?H(t,n,e,i,r,o):0===e?V(t,n,e,i,r,o):2===e&&z(t,n,e,i,r,o)}function G(t,n,e,i,r,o){var o=o;t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),t.translate(i+c(o/2),r+c(o/2)),t.beginPath(),R(t,0,-o/2),E(t,o/2,0),E(t,0,o/2),E(t,-o/2,0),E(t,0,-o/2),t.fillStyle=p[n][e].fillColor,t.closePath(),t.fill(),t.stroke()}function U(t,n,e,i,r,o){var o=c(o);t.translate(i,r),t.strokeStyle=p[n][e].strokeStyle,t.beginPath(),R(t,0,o),E(t,o/2,o-o/2*Math.sqrt(3)),E(t,o,o),E(t,0,o),t.fillStyle=p[n][e].fillColor,t.closePath(),t.fill(),t.stroke()}function H(t,n,e,i,r,o){var o=o;t.strokeStyle=p[n][e].strokeStyle,t.translate(c(o/2+i),c(o/2+r)),t.beginPath(),t.rotate(p[n][e].rotate),R(t,-o/2,-o/5.4),E(t,o/2,-o/5.4),E(t,o/2,o/5.4),E(t,-o/2,o/5.4),E(t,-o/2,-o/5.4),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function V(t,n,e,i,r,o){t.strokeStyle=p[n][e].strokeStyle;var o=o;t.translate(c(o/2+i),c(o/2+r)),t.beginPath(),R(t,-o/2,-o/3),E(t,o/2,-o/3),E(t,0,o/3),E(t,-o/2,-o/3),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function z(t,n,e,i,r,o){t.strokeStyle=p[n][e].strokeStyle;var o=o;t.translate(c(o/2+i),c(o/2+r)),t.beginPath(),R(t,-o/2,o/3),E(t,o/2,o/3),E(t,0,-o/3),E(t,-o/2,o/3),t.fillStyle=p[n][e].fillColor,t.fill(),t.stroke()}function Y(t,n,e,i,r,o){var o,a,i,r,u,o,o=o/3.5,a=p[n].length-1;t.strokeStyle=p[n][a-e].strokeStyle,t.translate(c(1.75*o+i),c(1.75*o+r)),t.rotate(p[n][a-e].rotate),t.beginPath(),i=.25*o,r=1.25*o,R(t,-(u=.75*o),-(o=1.75*o)),E(t,i,-o),E(t,i,i),E(t,r,-u),E(t,r,i),E(t,-i,o),E(t,-o,i),E(t,-o,-u),E(t,-u,i),E(t,-u,-o),t.fillStyle=p[n][a-e].fillColor,t.fill(),t.stroke()}function E(t,n,e){t.lineTo(c(n)+.5,c(e)+.5)}function R(t,n,e){t.moveTo(c(n)+.5,c(e)+.5)}Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=t.drawIconTypeIsTwo=t.drawCircle=t.drawTrafficLight=t.drawIconTypeIsSen=t.drawFlag=t.drawIconTypeIsNine=t.drawIconTypeIsEight=t.drawStar=t.drawSector=t.drawMagicCube=t.drawSignal=void 0,s=Math.PI,c=Math.round,f=Math.cos,l=Math.sin,p=[[{strokeStyle:e="#326f5b",fillColor:i="#76a797",fillColor2:"",rotate:s},{strokeStyle:r="#A4802b",fillColor:o="#EAC282",fillColor2:"",rotate:-.5*s},{strokeStyle:a="#9E381C",fillColor:u="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:h="#646262",fillColor:d="#808080",fillColor2:"",rotate:s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.5*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:s}],[{strokeStyle:r,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:v="#303030",fillColor:m="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:v,fillColor:m,fillColor2:"#eac282",rotate:0},{strokeStyle:v,fillColor:m,fillColor2:i,rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"white",rotate:.25*s},{strokeStyle:r,fillColor:o,fillColor2:"white",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"white",rotate:-.25*s}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:.25*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:-.25*s}],[{strokeStyle:e,fillColor:i,fillColor2:"",rotate:s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.75*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.25*s},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:d,fillColor2:"",rotate:s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.75*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.25*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:v="#353535",fillColor:m,fillColor2:"",rotate:0},{strokeStyle:d,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:g="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:n="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:m,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:e,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:e,fillColor:i,fillColor2:"",rotate:s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.75*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.5*s},{strokeStyle:r,fillColor:o,fillColor2:"",rotate:-.25*s},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:d,fillColor2:"",rotate:s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.75*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.5*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:-.25*s},{strokeStyle:h,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:m,fillColor2:"",rotate:2*s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:.5*s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:.5*s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:+s},{strokeStyle:m,fillColor:m,fillColor2:"",rotate:2*s}],[{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:g,fillColor:n,fillColor2:"",rotate:0}]],t.drawSignal=w,t.drawMagicCube=y,t.drawSector=M,t.drawStar=S,t.drawIconTypeIsEight=T,t.drawIconTypeIsNine=N,t.drawFlag=j,t.drawIconTypeIsSen=L,t.drawTrafficLight=B,t.drawCircle=O,t.drawIconTypeIsTwo=P,t.drawArrows=Y},"./dist/plugins/contextMenu/context-menu-dialog.js":function(t,n,e){"use strict";var i,r,o,e,a,u,s,c,f,l,h;function d(t,n){var t,e,t=h.call(this,t,o(t))||this;return t.jTe=r.DialogFeatureType.contextMenu,t.zX=n,t}i=this&&this.__extends||(l=function(t,n){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenuViewDialog=void 0,r=e("Core"),o=r.mt.gi,e=r.zc,a=r.GC$,u="gc.command.executed",s="left",c="top",i(d,h=e),d.prototype.VX=function(t,n,e){var i,t,i=this,t=t[0];i.YX&&i.YX.ZX&&i.YX.ZX(t,n,e,i.zX)},d.prototype.rQ=function(t,n,e,i,r){var o,e,o=this,e=o.WX(e,i);o.YX=t,o.VX(e,n,r)},d.prototype.WX=function(t,n){var e,i,e=this,i=e.Xc();return i.css([s,c],[t,n]),i.empty(),h.prototype.$c.call(this),e.aY(),i},d.prototype.QX=function(t){var n,e,i,r,t,n,e=this.Xc();return"block"!==e.css("display")||((i=e.offset()).top+=document.body.clientTop||0,i.left+=document.body.clientLeft||0,r=t.x,t=t.y,r<i.left)||r>e.width()+i.left||t<i.top||t>e.height()+i.top},d.prototype.aY=function(){var t=this;t.zX.bind(u,function(){t.close()})},d.prototype.KX=function(){var t;this.zX.unbind(u)},d.prototype.close=function(){var t,n,e,e,t=this,n=t.YX;n&&n.DJ&&((e=n.JX)&&e.menuItemData.needKeepFocus||(e=n.DJ.getActiveSheet())&&e.rt&&!e.il&&e.rt.aA(),t.YX.L0()),t.KX(),t.Yc(t.Zc)&&a("#"+t.Zc).remove(),h.prototype.close.call(this)},n.ContextMenuViewDialog=d},"./dist/plugins/contextMenu/context-menu.entry.js":function(t,n,e){"use strict";var i,r,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.XX=void 0,r(e("./dist/plugins/contextMenu/context-menu.js"),n),r(e("./dist/plugins/contextMenu/menu-view.js"),n),r(e("./dist/plugins/contextMenu/context-menu.ns.js"),n),r=e("./dist/plugins/contextMenu/context-menu-dialog.js"),n.XX=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(m,g,t){"use strict";var p,M,C,S,it,T,A,l,rt,Mt,I,ot,b,n,w,x,e,at,ut,i,N,k,r,_,D,o,j,O,E,R,F,L,B,P,G,U,H,V,z,Y,Z,W,Q,J,a,K,X,q,$,tt,nt,et,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,u,Jt,Kt,Xt,qt,$t,tn,nn,st,ct,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,vn,mn,gn,pn,bn,wn,yn,Mn,Cn,Sn,Tn,An,In,xn,Nn,kn,_n,ft,lt,Dn,jn,On,ht,En,Rn,Fn,Ln,dt,Bn,Pn,Gn,Un,Hn,Vn,s,zn,vt,Yn,Zn,Wn,Qn,Jn,Kn,Xn,h,qn,$n,te,ne,ee,ie,re,oe,ae,ue,se,ce,fe,le,mt,gt,pt,bt,he,de,ve,me,ge,pe,be,we,ye,Me,Ce,Se,Te,Ae,Ie,xe,Ne,ke,_e,De,je,wt,Oe,c,Ee,Re,f,d,Fe,t,y,Le,Be,Pe;function Ge(t){var n,e;if(t.slicers&&(n=t.slicers.all())&&!Mt(n))for(e in n)if(n[e].isSelected())return 1}function Ue(t,n,e){for(var i,r,o,a,u,i=n===De?"rowCount":"colCount",r=0;r<t.length;r++)for(a=-1===(o=t[r])[n]?0:o[n],u=0;u<o[i];u++)e(a+u)}function He(t,n){for(var e=[],i=-1,r,r=t.row;r<t.row+t.rowCount;r++)!1!==n[r]&&-1===i&&(i=r),!1===n[r]&&-1!==i&&(e.push([i,r-i]),i=-1);return-1!==i&&e.push([i,r-i]),e}function Ve(t,n){var e,e,e,n;if(1===n.colCount&&-1===n.row){if((e=n.col)===t.k9()&&0<=(e=e-1)&&!t.getColumnVisible(e))return!0}else if(1===n.rowCount&&-1===n.col&&(e=n.row)===t.N9()&&0<=(n=e-1)&&!t.getRowVisible(n))return!0}function ze(t){var n,e,i;if(t.slicers){if(!(n=t.slicers.all())||Mt(n))return null;for(i in e=[],n)n[i].isSelected()&&e.push(n[i]);return e}}function Ye(t,n){var e,n,i,e=n.name,n=n.group;if(!([b+Jn,b+Qn,b+s].indexOf(e)<0&&b+s!==n&&e!==d(Oe))){if((i=(0,it.jf)(t))&&i.NMi&&(b+s===e||b+s===n))return!1;if(e===d(Oe)&&!it.mt.isEnablePasteSpecial(i))return!1;switch(e){case b+Zn:case b+zn:case b+Xn:case b+vt:case b+Kn:if(i&&!0===i.ST().ES)return!1}}return!0}function Ze(t,n){var n;return[b+Un].indexOf(n.name)<0||!(n=(0,it.jf)(t))||!n.NMi}function We(t,n){var n;return[b+Bn,b+Gn,b+dt,b+Pn].indexOf(n.name)<0||!(n=(0,it.jf)(t))||!n.NMi}function Qe(t,n){var n,t,n=n.name;return[b+_n,b+an,b+un,b+on].indexOf(n)<0||!(t=(0,it.jf)(t))||!t.NMi||n!==b+un&&n!==b+on}function Je(t,n){var e,n,i,e,t,r,o,a,u,e=[b+ht,b+ct,b+nn,b+st],n=n.name;if(e.indexOf(n)<0)return!0;if(e=(i=(0,it.jf)(t)).getActiveRowIndex(),t=i.getActiveColumnIndex(),i&&i.comments){if(r=i.comments.get(e,t))return n!==b+ht;if(n!==b+ct&&n!==b+nn){if(n===b+ht)return!0;for(o=i.getSelections(),a=0;a<o.length;a++)if(Xe(u=o[a],i))return!0}return!1}}function Ke(t,n){var e,i,r,o,a,u;if(n.comments)for(e=n.comments.all(),r=i=void 0,o=0;o<t.length;o++)for(a=t[o],u=0;u<e.length;u++)if(!e[u].locked()&&(r=e[u].bZ,i=e[u].yZ,r>=a.row)&&r<a.row+a.rowCount&&i>=a.col&&i<a.col+a.colCount)return 1}function Xe(t,n){var e,i,r,o;if(n.comments)for(e=n.comments.all(),r=i=void 0,o=0;o<e.length;o++)if(r=e[o].bZ,i=e[o].yZ,r>=t.row&&r<t.row+t.rowCount&&i>=t.col&&i<t.col+t.colCount)return 1}function qe(t,n){var n,t,n,t,t;return[b+jn,b+On].indexOf(n.name)<0||!((n=(0,it.jf)(t))&&n.NMi||!(t=n.getSelections())||1!==t.length||(t=ui(n,n=t[0]))&&(t=t.range(),n.row<t.row||n.col<t.col||n.row+n.rowCount>t.row+t.rowCount||n.col+n.colCount>t.col+t.colCount))}function $e(t,n){var n,t;return[b+mt].indexOf(n.name)<0||(t=(n=(0,it.jf)(t))&&n.ST())&&!t.ES&&t._S&&1===t._S.length&&1===n.getSelections().length&&ni(n)}function ti(t,n){var n,t;return[b+gt].indexOf(n.name)<0||(t=(n=(0,it.jf)(t))&&n.ST())&&t.ES&&t._S&&1===t._S.length&&1===n.getSelections().length&&ni(n)}function ni(t){var n,e,i,r,o,a;if(t.NMi)return!1;if(n=t.getActiveRowIndex(),e=t.getActiveColumnIndex(),!(i=t.ST()).TT)return!1;if(t.tables&&t.tables.find(n,e))return!1;for(r=t.Ut.getSpans(),o=0;o<r.length;o++)if(n>=(a=r[o]).row&&n<a.row+a.rowCount&&e>=a.col&&e<a.col+a.colCount)return!1;return!0}function ei(t,n){var t,e,n,i,r,t,o,a,u,a,t=(0,it.jf)(t),e=[b+ut+fn,b+ut+ln].indexOf(n.name),n=[b+ut+vn,b+ut+hn,b+ut+dn,b+ut+mn,b+ut+gn,b+ut+pn].indexOf(n.name),i=-1<e,r=-1<n;return t&&t.NMi&&(t=t.NMi,i||r)?!(o=t.qNi())||(u=[(a=t.options.menuItemVisibility).promoteMenuItemVisible,a.demoteMenuItemVisible],a=[a.addAboveMenuItemVisible,a.addAfterMenuItemVisible,a.addBeforeMenuItemVisible,a.addBelowMenuItemVisible,a.moveUpMenuItemVisible,a.moveDownMenuItemVisible],o=i&&u[e])||!t.qX()?o:r&&a[n]:!(i||r)}function ii(t,n,e){var t,i,r,o,a,u,s,t,c,f,e,l,t=(0,it.jf)(t),i=9,r=b+at,o=[bn,wn].map(function(t){return r+t}).indexOf(n.name),a,u=-1<o,s=-1<ri(9,function(t){return r+yn+(t+1)}).indexOf(n.name);return t&&t.NMi&&(t=t.NMi).qNi()&&(s||u)?(f=[(c=t.options.menuItemVisibility).expandAllLevelMenuItemVisible,c.collapseAllLevelMenuItemVisible],s?(e=e.$X=e.$X||t.MDi()+1,(l=parseInt(n.name.charAt((r+yn).length),10))<=Math.min(9,e)&&c.expandToLevelMenuItemVisible):u&&f[o]):!(s||u)}function ri(t,n){for(var e,i,e=[],i=0;i<t;i++)e.push(n(i,e));return e}function oi(t,n){var t,e,i,r,o,a,u,s,c;if([b+ut+mt,b+ut+gt].indexOf(n.name)<0)return!0;if(!(t=(0,it.jf)(t))||!t.NMi){if(e=t.ST(),i=t.getActiveRowIndex(),r=!1,t.tables)for(o=t.tables.all(),a=0;a<o.length;a++)if(i>=(u=o[a]).Ky&&i<u.Ky+u.Sx){r=!0;break}for(s=t.Ut.getSpans(),a=0;a<s.length;a++)if(i>(c=s[a]).row&&i<c.row+c.rowCount)return!1;if(e.TT&&(!e._S||1===e._S.length)&&1===t.getSelections().length)if(n.name===b+ut+gt){if(e.ES&&(r||e._S&&t.getColumnCount()%e._S[0].colCount==0))return!0}else if(n.name===b+ut+mt&&!e.ES&&(r||e._S&&t.getColumnCount()%e._S[0].colCount==0))return!0}return!1}function ai(t,n){var t,e,i,r,o,a,u,s,c;if([b+at+mt,b+at+gt].indexOf(n.name)<0)return!0;if(!(t=(0,it.jf)(t))||!t.NMi){if(e=t.ST(),i=t.getActiveColumnIndex(),r=!1,t.tables)for(o=t.tables.all(),a=0;a<o.length;a++)if(i>=(u=o[a]).iw&&i<u.iw+u.Tx){r=!0;break}for(s=t.Ut.getSpans(),a=0;a<s.length;a++)if(i>(c=s[a]).col&&i<c.col+c.colCount)return!1;if(e.TT&&(!e._S||1===e._S.length)&&1===t.getSelections().length)if(n.name===b+at+mt){if(!e.ES&&(r||e._S&&t.getRowCount()%e._S[0].rowCount==0))return!0}else if(n.name===b+at+gt&&e.ES&&(r||e._S&&t.getRowCount()%e._S[0].rowCount==0))return!0}return!1}function ui(t,n){var e,i,r;if(n)for(it.mt.J0(n,t.getRowCount(),t.getColumnCount()),e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(t.tables&&(r=t.tables.find(e,i)))return r;return null}function si(t,n,e,i){for(var r,o,r=0;r<n.length;r++)(o=n[r]).jj(e,i,!0,wt,o.tq())}function ci(t){for(var n,e,i,r,n=t,e=0;e<n.length-1;e++)for(i=e+1;i<n.length;i++)n[e].row<n[i].row&&(r=n[e],n[e]=n[i],n[i]=r);return n}function fi(t){for(var n,e,i,r,n=t,e=0;e<n.length-1;e++)for(i=e+1;i<n.length;i++)n[e].col<n[i].col&&(r=n[e],n[e]=n[i],n[i]=r);return n}function li(t,n,e,i){var r=t.Ut.getSpans(wt,3);0<=n?(vi(t,r,n,i,3),vi(t,t.Ut.getSpans(wt,2),n,i,2)):0<=e&&(hi(t,r,e,i,3),hi(t,t.Ut.getSpans(wt,1),e,i,1))}function hi(t,n,e,i,r){for(var o,a,u,s,c,f,o=0,a=n.length;o<a;o++)if(e>(u=n[o]).col&&e<u.col+u.colCount)for(s=u.row;s<u.row+u.rowCount;s++)if(c=mi(t,s,e,i,r,!0))for(f=e;f<e+i;f++)t.setStyle(s,f,c,r)}function di(t,n){return t.style===n.style&&t.color===n.color}function vi(t,n,e,i,r){for(var o,a,u,s,c,f,o=0,a=n.length;o<a;o++)if(e>(u=n[o]).row&&e<u.row+u.rowCount)for(s=u.col;s<u.col+u.colCount;s++)if(c=mi(t,e,s,i,r,!1))for(f=e;f<e+i;f++)t.setStyle(f,s,c,r)}function mi(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,f=["borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp"];if(o){if(a=t.Z_(n,e-1,r),(u=t.Z_(n,e+i,r))&&a){for(a=a.clone(),l=0,h=f;l<h.length;l++)a[d=h[l]]&&u[d]&&di(a[d],u[d])||(a[d]=void 0);return a}}else if(s=t.Z_(n-1,e,r),c=t.Z_(n+i,e,r),s&&c){for(s=s.clone(),v=0,m=f;v<m.length;v++)s[d=m[v]]&&c[d]&&di(s[d],c[d])||(s[d]=void 0);return s}}function yt(t,n,e,i,r,o){var a,u,s,c,f,e,r,a=(0,it._f)(t,n.sheetName);return!!a&&(u=n.considerAllSheets,s=t.i4(),a.suspendPaint(),c=it.Commands.TI(a.name()),e?(e=void 0,(e=r?r(a,n):e)&&e.cancel||(u?it.Commands.NI(s,n):a.Ut.undo(n[c]),o&&o(a,n,e))):(u?it.Commands.II(s):a.Ut.startTransaction(),f=i(a,n),u?it.Commands.xI(s,n):n[c]=a.Ut.endTransaction()),a.resumePaint(),u&&(r=(0,it.jf)(t))&&a!==r&&r.repaint(),f)}function gi(t,n,e){var i;if(0<e){for(i=n+1;i<t.getRowCount();i++)if((e-=t.getRowHeight(i))<=0)return i-n}else if(e<0)for(i=n-1;0<=i;i--)if(0<=(e+=t.getRowHeight(i)))return i-n;return 0}function pi(t,n,e){var i;if(0<e){for(i=n+1;i<t.getColumnCount();i++)if((e-=t.getColumnWidth(i))<=0)return i-n}else if(e<0)for(i=n-1;0<=i;i--)if(0<=(e+=t.getColumnWidth(i)))return i-n;return 0}function bi(t,n,e,i,r){var t=(0,it._f)(t,n.sheetName);t&&e.execute({cmd:Hn,sheetName:t.name(),pasteOption:i,pasteSpecialOptions:r})}function wi(i,r,t,o){return yt(i,r,t,function(t){var n,e,n=ze(t);if(n&&0!==n.length){for(e in n)n.hasOwnProperty(e)&&n[e].sortState(o);i.changeSelectionInCommandExecuting(r,null,null,[],n)}})}function yi(t){t.jT(8,y().hideSheetFailureInfo)}function Mi(t,n){var e,i,r,e=n.name(),i=t.Ese(e),r={sheetName:e,propertyName:"isVisible",cancel:!1,sheetIndex:i,sheetPosition:t.getSheetPosition(e),oldValue:!1,newValue:!0};if(t.ki(it.Events.SheetChanging,r),r.cancel)return!1;n.visible(!0),t.ki(it.Events.SheetChanged,{sheetName:e,propertyName:"isVisible",sheetIndex:i,sheetPosition:t.getSheetPosition(e),oldValue:!1,newValue:!0})}function Ci(t,n,e){var i,i,i={oldSheet:n,newSheet:e,cancel:!1};return t.ki(it.Events.ActiveSheetChanging,i),!i.cancel&&(i={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t.Ese(n.name()),sheetPosition:t.getSheetPosition(n.name())},t.ki(it.Events.SheetChanging,i),!i.cancel)&&(i={oldValue:!1,newValue:!0,sheetName:e.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t.Ese(e.name()),sheetPosition:t.getSheetPosition(e.name())},t.ki(it.Events.SheetChanging,i),!i.cancel)&&void 0}function Si(t,n){var e,n,e=(0,it.jf)(t);t.ki(it.Events.ActiveSheetChanged,{oldSheet:n,newSheet:e}),n={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",sheetIndex:t.Ese(n.name()),sheetPosition:t.getSheetPosition(n.name())},t.ki(it.Events.SheetChanged,n),n={oldValue:!1,newValue:!0,sheetName:e.name(),propertyName:"isSelected",sheetIndex:t.Ese(e.name()),sheetPosition:t.getSheetPosition(e.name())},t.ki(it.Events.SheetChanged,n)}function Ti(t,n,e){var t,i,n,r,o,a,u,t,s,c;if(void 0===e&&(e=!1),0<(t=t.selections).length&&(i=n.NMi,r=(n=t[0]).col,o=n.colCount,t=(u=(a=i.getDataView()).getColumnInfos()).filter(function(t){return!t.isFreeColumn}).length,!(r<0||t<=r||(o=Math.min(o,t-r))<=0))){for(s=r;s<r+o;s++)(c=u[s]).visible=e;try{a.setColumnInfos(u),i.setDataView(a)}catch(t){return!1}}}function Ai(t){var t=t.slice(t.lastIndexOf(".")+1);return t===ut+gt||t===ut+mt||t===at+gt||t===at+mt}function Ii(o){var t=function(i,r){return{canUndo:!1,execute:function(t,n,e){bi(t,n,o,i,r)}}};o.register(f.pasteFormulaAndNumberFormat,t(it.ClipboardPasteOptions.formulasAndNumberFormatting),null,!1,!1,!1,!1),o.register(f.pasteKeepSourceFormatting,t(it.ClipboardPasteOptions.usingSourceTheme),null,!1,!1,!1,!1),o.register(f.pasteNoBorders,t(it.ClipboardPasteOptions.noBorder),null,!1,!1,!1,!1),o.register(f.pasteColumnWidth,t(it.ClipboardPasteOptions.allAndColumnWidth),null,!1,!1,!1,!1),o.register(f.pasteTranspose,t(it.ClipboardPasteOptions.all,{transpose:!0}),null,!1,!1,!1,!1),o.register(f.pasteValueAndNumberFormats,t(it.ClipboardPasteOptions.valuesAndNumberFormatting),null,!1,!1,!1,!1),o.register(f.pasteValueAndSourceFormats,t(it.ClipboardPasteOptions.valuesAndSourceFormatting),null,!1,!1,!1,!1),o.register(f.pasteLink,t(it.ClipboardPasteOptions.all,{pasteLink:!0}),null,!1,!1,!1,!1)}function v(){var t=this;t.menuView=new S.MenuView,t.menuData=t.nq()}p=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(g,"__esModule",{value:!0}),g.ContextMenu=void 0,M=t("Common"),C=t("./dist/plugins/contextMenu/context-menu-dialog.js"),S=t("./dist/plugins/contextMenu/menu-view.js"),it=t("Core"),T=t("./dist/plugins/contextMenu/context-menu.ns.js"),A=t("./dist/plugins/contextMenu/menuItems/index.js"),l=it.GC$,rt=M.Common.lt.ht,Mt=M.Common.lt._h,I=it.mt.vi,n="gc-spread-",w="gc.spread.pivot",x="gc-spread-pivot-selected",e="viewport",at="colHeader",ut="rowHeader",i="slicer",N="timeline",k="sheetTab",r="corner",_="pivotPageFilter",D="pivotTopLeft",o="pivotHeader",j="pivotEmptyLabel",O="pivotContent",E="pivotGrandTotal",R="FieldName",F="SortType",L="pivotSummarizeValuesBy",B="pivotExpandOrCollapse",P="pivotTableGroup",G="OpenPivotGroupDialog",U="pivotTableUnGroup",H="pivotShowValueAs",V="pivotShowDetails",z="pivotRefresh",Y="removeField",Z="pivotTable",W="removePivotGrandTotal",Q="openValueFieldSettingDialogCmd",J="pivotSum",a="UpdatePivotValueFieldCmd",K="pivotCount",X="pivotAverage",q="pivotMax",$="pivotMin",tt="pivotProduct",nt="pivotNoCalculation",et="pivotGrandtotal",Ct="pivotColumnTotal",St="pivotRowTotal",Tt="pivotOf",At="pivotParentRowTotal",It="pivotDifferenceFrom",xt="pivotPercentDifferenceFro",Nt="pivotRunningTotalIn",kt="pivotPercentRunningTotalIn",_t="pivotRankSmallestToLargest",Dt="pivotOfParentTotal",jt="pivotParentColumnTotal",Ot="pivotRankLargestToSmallest",Et="pivotIndex",Rt="pivotMoreOptions",Ft="pivotFilter",Lt="pivotClearFilterFrom",Bt="pivotKeepOnlySelectedItems",Pt="pivotHideSelectedItems",Gt="pivotTop10",Ut="pivotLabelFilters",Ht="pivotValueFilters",Vt="pivotExpand",zt="pivotCollapse",Yt="pivotExpandEntireField",Zt="pivotCollapseEntireField",Wt="createDialogForValueFilter",Qt="createDialogForLabelFilter",u="OpenPivotShowValueAsDialog",Jt="filterFieldLabelValue",Kt="ClearCommand",Xt="pivotSort",qt="createDialogForPivotSort",$t="openPasteSpecialDialog",tn="removeSlicer",nn="toggleComment",st="deleteComment",ct="editComment",en="unhideSheet",rn="hideSheet",on="unhideRows",an="unhideColumns",un="hideRows",sn="pinRows",cn="pinColumns",fn="promote",ln="demote",hn="addAfter",dn="addBefore",vn="addAbove",mn="addBelow",gn="moveUp",pn="moveDown",bn="expandAllLevels",wn="collapseAllLevels",yn="expandLevel",Mn="expandLevel1",Cn="expandLevel2",Sn="expandLevel3",Tn="expandLevel4",An="expandLevel5",In="expandLevel6",xn="expandLevel7",Nn="expandLevel8",kn="expandLevel9",_n="hideColumns",ft="sortAscend",lt="sortDescend",Dn="sortMoreOptions",jn="sort",On="filter",ht="insertComment",En="deleteSheet",Rn="insertNote",Fn="replyComment",Ln="insertSheet",dt="insertRows",Bn="insertColumns",Pn="deleteRows",Gn="deleteColumns",Un="clearContents",Hn="paste",Vn="ganttSheetPaste",s="pasteOptions",zn="pasteFormatting",vt="pasteValues",Yn="pasteGanttValues",Zn="pasteFormula",Wn="pasteAll",Qn="cut",Jn="copy",Kn="pasteValuesFormatting",Xn="pasteFormulaFormatting",h="separator",qn="groupHeader",$n="slicerSortAscend",te="slicerSortDescend",ne="table",ee="tableInsert",ie="tableDelete",re="tableInsertRowsAbove",oe="tableInsertRowsBelow",ae="tableInsertColumnsLeft",ue="tableInsertColumnsRight",se="tableDeleteRows",ce="tableDeleteEntireSheetRows",fe="tableInsertEntireSheetRows",le="tableDeleteColumns",mt="insertCopiedCells",gt="insertCutCells",pt="shiftCellsDown",bt="shiftCellsRight",he="allSheets",de="tableInsertRowsAboveForContextMenu",ve="tableInsertRowsBelowForContextMenu",me="tableDeleteRowsForContextMenu",ge="tableInsertColumnsLeftForContextMenu",pe="tableInsertColumnsRightForContextMenu",be="tableDeleteColumnsForContextMenu",we="GanttRowHeader",ye="GanttField",Me="insertTask",Ce="deleteTask",Se="scrollToTask",Te="manuallySchedule",Ae="autoSchedule",Ie="GanttColumn",xe="hideGanttColumn",Ne="unHideGanttColumn",ke="indentGanttTask",_e="outdentGanttTask",De="row",je="col",wt=void 0,Oe="pasteSpecial",c=(b="gc.spread.")+"pasteSpecialPasteGroup",Ee=b+"pasteSpecialPasteValueGroup",Re=b+"pasteSpecialOtherOptionsGroup",f={pasteFormulaAndNumberFormat:(ot="gc.spread.contextMenu.")+"pasteFormulaAndNumberFormat",pasteKeepSourceFormatting:ot+"pasteKeepSourceFormatting",pasteNoBorders:ot+"pasteNoBorders",pasteColumnWidth:ot+"pasteColumnWidth",pasteTranspose:ot+"pasteTranspose",pasteValueAndNumberFormats:ot+"pasteValueAndNumberFormats",pasteValueAndSourceFormats:ot+"pasteValueAndSourceFormats",pasteLink:ot+"pasteLink"},d=function(t){return b+t},Fe=function(t){return n+t},t=new M.Common.ResourceManager(T.SR,"GanttSheet"),y=t.getResource.bind(t),Le={sheetTab:function(t,n,e){return new RegExp("sheetTab","i").test(e.workArea)&&t.tabStripHitInfo&&t.tabStripHitInfo.sheetTab&&"newSheet"!==t.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==t.tabStripHitInfo.sheetTab.sheetName},outline:function(t,n,e){return!!(new RegExp("outline","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.outlineHitInfo)},viewport:function(t,n,e){if(new RegExp("viewport","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo)return Ye(n,e)&&Ze(n,e)&&Je(n,e)&&qe(n,e)&&$e(n,e)&&ti(n,e)},rowHeader:function(t,n,e){if(new RegExp("rowHeader","i").test(e.workArea)&&t.worksheetHitInfo&&2===t.worksheetHitInfo.hitTestType)return Ye(n,e)&&Ze(n,e)&&We(n,e)&&Qe(n,e)&&oi(n,e)&&ei(n,e)},colHeader:function(t,n,e){var i,r,r,o,i=t.worksheetHitInfo;if(new RegExp("colHeader","i").test(e.workArea)&&i&&1===i.hitTestType&&(r=(r=(0,it.jf)(n))&&r.Ut.getFreeAreaRowCount(1),!(o=i.row<r)))return Ye(n,e)&&Ze(n,e)&&We(n,e)&&Qe(n,e)&&ai(n,e)&&ii(n,e,t)},corner:function(t,n,e){if(new RegExp("corner","i").test(e.workArea)&&t.worksheetHitInfo&&0===t.worksheetHitInfo.hitTestType)return Ye(n,e)&&Ze(n,e)&&Je(n,e)&&qe(n,e)},slicer:function(t,n,e){return new RegExp("slicer","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo&&t.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===t.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(t,n,e){var e,t,e=new RegExp("timeline","i").test(e.workArea),t=t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo&&t.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===t.worksheetHitInfo.shapeHitInfo.shape.drawingType;return e&&t},chart:function(t,n,e){return new RegExp("chart","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(t,n,e){return new RegExp("shape","i").test(e.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo},table:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.tables;return new RegExp("table","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo&&n&&n.eq()},vpWithoutTb:function(t,n,e){var i,t,r;if(new RegExp("vpWithoutTb","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo)return!((t=(0,it.jf)(n).tables)&&t.eq())&&Ye(n,e)&&Ze(n,e)&&Je(n,e)&&qe(n,e)},pivotTablePageFilterArea:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotPageFilter","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&0===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTopLeft","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&1===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotEmptyLabel","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&3===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotHeader","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&2===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotGrandTotal","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&5===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotContent","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&4===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(t,n,e){var n=(0,it.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTable","i").test(e.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo}},Be=[],v.prototype.nq=function(){var t=y();return p(p([],(0,A.createReportSheetMenuItems)(t),!0),[{text:y().copy,name:b+Jn,command:ot+Jn,iconClass:n+Jn,workArea:e+at+ut+i+r+Z+N},{text:y().cut,name:b+Qn,command:ot+Qn,iconClass:n+Qn,workArea:e+at+ut+i+r+N},{text:y().pasteOptions,name:b+s,iconClass:n+s,type:qn,workArea:e+at+ut+i+r+N},{command:ot+Wn,name:b+Wn,iconClass:n+Wn,group:b+s,text:y().pasteAll,workArea:e+at+ut+i+r+N},{command:ot+Zn,name:b+Zn,iconClass:n+Zn,group:b+s,text:y().pasteFormula,workArea:e+at+ut+r},{command:ot+vt,name:b+vt,iconClass:n+vt,group:b+s,text:y().pasteValues,workArea:e+at+ut+r},{command:ot+zn,name:b+zn,iconClass:n+zn,group:b+s,text:y().pasteFormatting,workArea:e+at+ut+r},{command:ot+Kn,name:b+Kn,iconClass:n+Kn,group:b+s,text:y().pasteValuesFormatting,workArea:e+at+ut+r},{command:ot+Xn,name:b+Xn,iconClass:n+Xn,group:b+s,text:y().pasteFormulaFormatting,workArea:e+at+ut+r},{text:y().pasteSpecial.title,name:d(Oe),command:$t,workArea:e+at+ut+r,type:"splitSubMenu",subMenu:[{text:y().paste,name:c,type:"groupHeader"},{command:ot+Wn,name:d("pasteSpecial.pasteAll"),iconClass:n+Wn,group:c,text:y().pasteAll},{command:ot+Zn,name:d("pasteSpecial.pasteFormula"),iconClass:n+"pasteFormula",group:c,text:y().pasteFormula},{command:f.pasteFormulaAndNumberFormat,name:d("formulaAndNumberFormat"),iconClass:n+"pasteFormulaAndNumberFormat",group:c,text:y().pasteSpecial.formulaAndNumberFormat},{command:f.pasteKeepSourceFormatting,name:d("keepSourceFormatting"),iconClass:n+"pasteKeepSourceFormat",group:c,text:y().pasteSpecial.keepSourceFormatting},{command:f.pasteNoBorders,name:d("noBorders"),iconClass:n+"pasteNoBorders",group:c,text:y().pasteSpecial.noBorders},{command:f.pasteColumnWidth,name:d("keepSourceColumnWidth"),iconClass:n+"pasteColumnWidth",group:c,text:y().pasteSpecial.columnWidth},{command:f.pasteTranspose,name:d("transpose"),iconClass:n+"pasteTranspose",group:c,text:y().pasteSpecial.transpose},{text:y().pasteValues,name:Ee,type:"groupHeader"},{command:ot+vt,name:d("pasteSpecial.pasteValues"),iconClass:n+"pasteValues",group:Ee,text:y().pasteValues},{command:f.pasteValueAndNumberFormats,name:d("pasteValueAndNumberFormat"),iconClass:n+"pasteValueAndNumberFormats",group:Ee,text:y().pasteSpecial.valuesAndNumberFormat},{command:f.pasteValueAndSourceFormats,name:d("pasteValueAndSourceFormat"),iconClass:n+"valueAndSourceFormats",group:Ee,text:y().pasteSpecial.valueAndSourceFormat},{text:y().pasteSpecial.otherPasteOptions,name:Re,type:"groupHeader"},{command:ot+zn,name:d("pasteSpecial.pasteFormatting"),iconClass:n+"pasteValuesFormatting",group:Re,text:y().pasteFormatting},{command:f.pasteLink,name:d("pasteLink"),iconClass:n+"pasteLink",group:Re,text:y().pasteSpecial.pasteLink},{type:"separator"},{command:$t,name:d("pasteSpecial.pasteSpecial"),text:y().pasteSpecial.title}]},{text:y().paste,name:b+Hn,command:ot+vt,iconClass:n+s,workArea:e+at+ut+r},{text:y().paste,name:b+Vn,command:ot+Yn,iconClass:n+s,workArea:e+at+ut+r},{type:h},{text:y().pinRows,name:b+sn,command:ot+sn,workArea:ut},{text:y().pinColumns,name:b+cn,command:ot+cn,workArea:at},{type:h},{text:y().scrollToTasks,name:b+Se,command:ot+Se,workArea:we+ye},{type:h},{text:y().insertTasks,name:b+Me,command:ot+Me,workArea:we+ye},{text:y().deleteTasks,name:b+Ce,command:ot+Ce,workArea:we+ye},{type:h},{text:y().indentTasks,name:b+ke,command:ot+ke,workArea:we+ye},{text:y().outdentTasks,name:b+_e,command:ot+_e,workArea:we+ye},{type:h},{text:y().manuallySchedule,name:b+Te,command:ot+Te,workArea:we+ye},{text:y().autoSchedule,name:b+Ae,command:ot+Ae,workArea:we+ye},{type:h},{text:y().hideColumn,name:b+xe,command:ot+xe,workArea:Ie},{text:y().unhideColumn,name:b+Ne,command:ot+Ne,workArea:Ie},{type:h},{text:y().promote,name:b+ut+fn,command:ot+fn,workArea:ut},{text:y().demote,name:b+ut+ln,command:ot+ln,workArea:ut},{type:h},{text:y().moveUp,name:b+ut+gn,command:ot+gn,workArea:ut},{text:y().moveDown,name:b+ut+pn,command:ot+pn,workArea:ut},{type:h},{text:y().addAfter,name:b+ut+hn,command:ot+hn,workArea:ut},{text:y().addBefore,name:b+ut+dn,command:ot+dn,workArea:ut},{text:y().addAbove,name:b+ut+vn,command:ot+vn,workArea:ut},{text:y().addBelow,name:b+ut+mn,command:ot+mn,workArea:ut},{type:h},{text:y().expandAllLevels,name:b+at+bn,command:ot+bn,workArea:at},{text:y().collapseAllLevels,name:b+at+wn,command:ot+wn,workArea:at},{text:y().expandLevel1,name:b+at+Mn,command:ot+Mn,workArea:at},{text:y().expandLevel2,name:b+at+Cn,command:ot+Cn,workArea:at},{text:y().expandLevel3,name:b+at+Sn,command:ot+Sn,workArea:at},{text:y().expandLevel4,name:b+at+Tn,command:ot+Tn,workArea:at},{text:y().expandLevel5,name:b+at+An,command:ot+An,workArea:at},{text:y().expandLevel6,name:b+at+In,command:ot+In,workArea:at},{text:y().expandLevel7,name:b+at+xn,command:ot+xn,workArea:at},{text:y().expandLevel8,name:b+at+Nn,command:ot+Nn,workArea:at},{text:y().expandLevel9,name:b+at+kn,command:ot+kn,workArea:at},{type:h},{text:y().clearContents,command:ot+Un,name:b+Un,workArea:e+at+ut+r},{type:h},{text:y().headerInsertCopiedCells,name:b+ut+mt,command:ot+ut+mt,workArea:ut},{text:y().headerInsertCutCells,name:b+ut+gt,command:ot+ut+gt,workArea:ut},{text:y().headerInsertCopiedCells,name:b+at+mt,command:ot+at+mt,workArea:at},{text:y().headerInsertCutCells,name:b+at+gt,command:ot+at+gt,workArea:at},{text:y().insertCopiedCells,name:b+mt,subMenu:[{text:y().shiftCellsRight,name:b+mt+bt,command:ot+mt+bt,iconClass:n+bt},{text:y().shiftCellsDown,name:b+mt+pt,command:ot+mt+pt,iconClass:n+pt}],workArea:e},{text:y().insertCutCells,name:b+gt,subMenu:[{text:y().shiftCellsRight,name:b+gt+bt,command:ot+gt+bt,iconClass:n+bt},{text:y().shiftCellsDown,name:b+gt+pt,command:ot+gt+pt,iconClass:n+pt}],workArea:e},{text:y().insertRows,name:b+dt,command:ot+dt,workArea:ut},{text:y().insertColumns,name:b+Bn,command:ot+Bn,workArea:at},{text:y().deleteRows,name:b+Pn,command:ot+Pn,workArea:ut},{text:y().deleteColumns,name:b+Gn,command:ot+Gn,workArea:at},{type:h},{text:y().tableInsert,name:b+ee,subMenu:[{text:y().tableInsertColumnsLeft,name:b+ae,command:ge,iconClass:n+ae},{text:y().tableInsertColumnsRight,name:b+ue,command:pe,iconClass:n+ue},{text:y().tableInsertRowsAbove,name:b+re,command:de,iconClass:n+re},{text:y().tableInsertRowsBelow,name:b+oe,command:ve,iconClass:n+oe},{text:y().tableDeleteOrInsertEntireSheetRow,name:b+fe,command:ot+dt,iconClass:n+re}],workArea:ne},{text:y().tableDelete,name:b+ie,subMenu:[{text:y().tableDeleteColumns,name:b+le,command:be,iconClass:n+le},{text:y().tableDeleteRows,name:b+se,command:me,iconClass:n+se},{text:y().tableDeleteOrInsertEntireSheetRow,name:b+ce,command:ot+Pn,iconClass:n+se}],workArea:ne},{type:h},{text:y().insertSheet,name:b+Ln,command:ot+Ln,workArea:k},{text:y().deleteSheet,name:b+En,command:ot+En,workArea:k},{type:h},{text:y().filter,name:b+On,command:ot+On,workArea:e+r},{text:y().sort,name:b+jn,subMenu:[{text:y().sortAscend,name:b+ft,command:ot+ft,iconClass:n+ft},{text:y().sortDescend,name:b+lt,command:ot+lt,iconClass:n+lt}],workArea:e+r},{text:y().slicerSortAscend,name:b+$n,command:ot+$n,iconClass:n+ft,workArea:i},{text:y().slicerSortDescend,name:b+te,command:ot+te,iconClass:n+lt,workArea:i},{type:h},{text:y().insertComment,name:b+ht,command:ot+ht,iconClass:n+ht,workArea:e+r,needKeepFocus:!0},{text:y().editComment,name:b+ct,command:ot+ct,iconClass:n+ct,workArea:e+r,needKeepFocus:!0},{text:y().deleteComment,name:b+st,command:ot+st,iconClass:n+st,workArea:e+r},{text:y().toggleComment,name:b+nn,command:ot+nn,workArea:e+r},{type:h},{text:y().hideRows,name:b+un,command:ot+un,workArea:ut},{text:y().unhideRows,name:b+on,command:ot+on,workArea:ut},{text:y().hideColumns,name:b+_n,command:ot+_n,workArea:at},{text:y().unhideColumns,name:b+an,command:ot+an,workArea:at},{type:h},{text:y().hideSheet,name:b+rn,command:ot+rn,workArea:k},{text:y().unhideSheet,name:b+en,command:ot+en,workArea:k},{type:h},{text:y().removeSlicer,name:b+tn,command:ot+tn,workArea:i+N},{type:h},{text:y().sort,name:b+jn,subMenu:[{text:y().sortAscend,name:b+ft,command:Xt,iconClass:n+ft,commandOptions:{subType:0},placeholder:F},{text:y().sortDescend,name:b+lt,command:Xt,iconClass:n+lt,commandOptions:{subType:1},placeholder:F},{text:y().pivotTableSortMoreOptions,name:b+Dn,command:qt}],workArea:o+O},{text:y().pivotTableRefresh,name:w+z,command:z,iconClass:n+z,workArea:_+D+O+o+E+j},{text:y().pivotTableRemove_,name:w+Y,command:Y,iconClass:n+Y,workArea:_+D+O+o,placeholder:R},{text:y().pivotTableRemoveGrandTotal,name:w+W,command:W,workArea:E},{text:y().pivotTableSummarizeValuesBy,name:w+L,subMenu:[{text:y().pivotTableSum,name:b+J,command:a,commandOptions:{subTotalType:8}},{text:y().pivotTableCount,name:b+K,command:a,commandOptions:{subTotalType:1}},{text:y().pivotTableAverage,name:b+X,command:a,commandOptions:{subTotalType:0}},{text:y().pivotTableMax,name:b+q,command:a,commandOptions:{subTotalType:3}},{text:y().pivotTableMin,name:b+$,command:a,commandOptions:{subTotalType:4}},{text:y().pivotTableProduct,name:b+tt,command:a,commandOptions:{subTotalType:5}}],workArea:D+O+E},{text:y().pivotTableShowValueAs,name:w+H,subMenu:[{text:y().pivotTableNoCalculation,name:b+nt,command:a,commandOptions:{showValueAsType:0}},{text:y().pivotTableGrandTotal,name:b+et,command:a,commandOptions:{showValueAsType:1}},{text:y().pivotTableColumnTotal,name:b+Ct,command:a,commandOptions:{showValueAsType:3}},{text:y().pivotTableRowTotal,name:b+St,command:a,commandOptions:{showValueAsType:2}},{text:y().pivotTableOf,name:b+Tt,command:u,commandOptions:{showValueAsType:4}},{text:y().pivotTableParentRowTotal,name:b+At,command:a,commandOptions:{showValueAsType:5}},{text:y().pivotTableParentColumnTotal,name:b+jt,command:a,commandOptions:{showValueAsType:6}},{text:y().pivotTableOfParentTotal,name:b+Dt,command:u,commandOptions:{showValueAsType:7}},{text:y().pivotTableDifferenceFrom,name:b+It,command:u,commandOptions:{showValueAsType:8}},{text:y().pivotTablePercentDifferenceFrom,name:b+xt,command:u,commandOptions:{showValueAsType:9}},{text:y().pivotTableRunningTotalIN,name:b+Nt,command:u,commandOptions:{showValueAsType:10}},{text:y().pivotTablePercentRunningTotalIn,name:b+kt,command:u,commandOptions:{showValueAsType:11}},{text:y().pivotTableRankSmallestToLargest,name:b+_t,command:u,commandOptions:{showValueAsType:12}},{text:y().pivotTableRankLargestToSmallest,name:b+Ot,command:u,commandOptions:{showValueAsType:13}},{text:y().pivotTableIndex,name:b+Et,command:a,commandOptions:{showValueAsType:14}}],workArea:D+O},{text:y().pivotTableFilter,name:w+Ft,iconClass:n+Ft,subMenu:[{text:y().pivotTableClearFilterFrom_,name:b+Lt,command:Kt,iconClass:n+Lt,placeholder:R,commandOptions:{clearType:0}},{text:y().pivotTableKeepOnlySelectedItems,name:b+Bt,command:Jt,commandOptions:{subType:1}},{text:y().pivotTableHideSelectedItems,name:b+Pt,command:Jt,commandOptions:{subType:2}},{text:y().pivotTableTop10,name:b+Gt,command:Wt,commandOptions:{isTop10:!0}},{text:y().pivotTableLabelFilters,name:b+Ut,command:Qt},{text:y().pivotTableValueFilters,name:b+Ht,command:Wt}],workArea:o},{text:y().pivotTableExpandOrCollapse,name:w+B,subMenu:[{text:y().pivotTableExpand,name:b+Vt,command:Vt,iconClass:n+Vt},{text:y().pivotTableCollapse,name:b+zt,command:zt,iconClass:n+zt},{text:y().pivotTableExpandEntireField,name:b+Yt,command:Yt,iconClass:n+Yt},{text:y().pivotTableCollapseEntireField,name:b+Zt,command:Zt,iconClass:n+Zt}],workArea:o},{text:y().pivotTableGroup,name:w+P,command:G,iconClass:n+P,workArea:o},{text:y().pivotTableUnGroup,name:w+U,command:U,iconClass:n+U,workArea:o},{text:y().pivotTableShowDetails,name:w+V,command:V,iconClass:n+V,workArea:O},{text:y().pivotTableValueFieldSettings,name:w+Q,command:Q,iconClass:n+Q,workArea:D+O+E}],!1)},v.prototype.Hc=function(t){var n=this;n.iq||(n.Qy=t.commandManager(),rt(n.rq)&&(n.rq=new C.ContextMenuViewDialog(t.j2(),l(t.oM))),n.oq(t),n.aq={filter:{menuDataDict:[b+On],checkFunction:function(t){if(t&&t.rowFilter)return!0}},comments:{menuDataDict:[b+ht,b+ct,b+st,b+nn],checkFunction:function(t){if(t&&t.comments)return!0}},slicer:{menuDataDict:[b+$n,b+te,b+tn],checkFunction:function(t){if(t&&t.slicers)return!0}},floatingObject:{menuDataDict:[b+vt,b+zn,b+Zn],checkFunction:function(t){var n,t,e;return!(t&&t.uq&&(t=(n=t.uq()).fromSheet)&&t.dP)||void 0}},table:{menuDataDict:[b+ee,b+ie],checkFunction:function(t){if(t&&t.tables)return!0}},tableSheet:{menuDataDict:[b+Hn,b+sn,b+cn,b+fn,b+ln,b+vn,b+hn,b+dn,b+mn,b+gn,b+pn,b+bn,b+wn,b+Mn,b+Cn,b+Sn,b+Tn,b+An,b+In,b+xn,b+Nn,b+kn],checkFunction:function(t){if(t&&t.NMi&&0===t.NMi._gi)return!0}},ganttSheet:{menuDataDict:[b+Vn,b+Me,b+Ce,b+ke,b+_e,b+Se,b+Te,b+Ae],checkFunction:function(t){if(t&&t.NMi&&1===t.NMi._gi)return!0}}},n.iq=!0)},v.prototype.cq=function(t,n){var e,i,r,o,a,u,s,s,u,a,u,a,r,c,e=this;if(n.focus(),i=e.fq(t,n),rt(i))I(t);else if((r=(0,it.jf)(n))&&r.options.disableContextMenu&&i.worksheetHitInfo)I(t);else{if(r){if(a=r.getActiveRowIndex(),u=r.getActiveColumnIndex(),it.Worksheet.et(r,"preProcessContextMenu",s={r:!1,hitInfo:i}),s.r)return;if(r.isEditing()&&i.worksheetHitInfo&&i.worksheetHitInfo.col===u&&i.worksheetHitInfo.row===a||n.getTab()&&n.getTab().Og)return}e.Hc(n),e.lq(i,n),(r=(0,it.jf)(n))&&(s=r.getSelections()[0],rt(s)||rt(r.pivotTables)||(u=r.floatingObjects&&r.floatingObjects.all().some(function(t){return t.isSelected()}),a=r.shapes&&r.shapes.all().some(function(t){return t.isSelected()}),u)||a||(u=r.pivotTables.findPivotTable(s.row,s.col),!rt(u)&&i.worksheetHitInfo&&(a=(i.worksheetHitInfo.pivotTableInfo=u).getPivotInfoImp(s.row,s.col,!1,!1,!0),rt(a)||(i.worksheetHitInfo.pivotTableCellInfo=a)))),r=e.hq(e.menuData,i,n),(c=e.onOpenMenu(e.menuData,r,i,n))||(I(t),r.length&&e.dq(r,i,n),e.onMenuOpened())}},v.prototype.lq=function(t,n){var e=this;e.rq.QX(t)&&e.vq(t,n)},v.prototype.vq=function(t,n){var e,i,e=this,i=(0,it.jf)(n);i&&i.isEditing()&&i.endEdit(void 0,!1),e.mq(t)?e.gq(t,n):e.pq(t)&&e.bq(t,n)},v.prototype.pq=function(t){return!!t.worksheetHitInfo},v.prototype.yq=function(t,n,e,i){var r=!0,o,a;if(1===i){for(o=0;o<t.length;o++)-1===(a=t[o]).row&&e>=a.col&&e<a.col+a.colCount&&(r=!1);return r}if(2===i){for(o=0;o<t.length;o++)-1===(a=t[o]).col&&n>=a.row&&n<a.row+a.rowCount&&(r=!1);return r}for(o=0;o<t.length;o++)if((a=t[o]).contains(n,e))return!1;return!0},v.prototype.mq=function(t){return!(!t.tabStripHitInfo||!t.tabStripHitInfo.sheetTab)},v.prototype.wq=function(t){return t.tabStripHitInfo.sheetTab.sheetName},v.prototype.Mq=function(t){return t.tabStripHitInfo.sheetTab.sheetIndex},v.prototype.bq=function(t,n){var e,n,t,e=this,n=(0,it.jf)(n),t=t.worksheetHitInfo;t.floatingObjectHitInfo||t.commentHitInfo||t.shapeHitInfo||(e.kk(n,t),e.Cq(n))},v.prototype.Cq=function(t){var n,e,t,n,n=t.getActiveRowIndex(),e=t.getActiveColumnIndex(),t=t.comments;t&&(n=t.get(n,e))&&t.PW===n&&t.NK(n)},v.prototype.Sq=function(t){return 3===t.hitTestType},v.prototype.PA=function(t,n,e){t.PA&&t.PA(n,e)},v.prototype.kk=function(t,n){var e,i,r,o,a,u,e,i,e=this,i=t.Ut.getSelections(),r=n.row,o=n.col;t.JA(n.rowViewportIndex<0?-1:n.row,n.colViewportIndex<0?-1:n.col)&&(a=!1,e.yq(i,r,o,n.hitTestType)?a=!0:0<(e=(u=t.shapes&&t.shapes.all()||[]).filter(function(t){return t.isSelected()})).length&&(e.forEach(function(t){return t.isSelected(!1)}),a=!0),a)&&((i=t.rt).kk(t,n,r,o),i.X9())},v.prototype.gq=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=this.Mq(t),i=n.e2(e);if(i){if(i.b2()){for(a=[],u=o=0,s=(r=n.qv()).length;u<s;u++)(c=r[u]).b2()&&(o++,rt(c._gi)||a.push(c));if(1<o)for(f=0,l=a.length;f<l;f++)(h=a[f]).b2(!1,!0)}else(r=n.qv()).forEach(function(t){t.b2()&&t.b2(!1,!0)}),i.b2(!0,!0);n.I2(e,2,!1,!0),this.Tq(this.menuData,t,n)}},v.prototype.fq=function(t,n){var e,i,t,e=n.wM(),i=t.pageX-e.left,t=t.pageY-e.top;return n.hitTest(i=0<=i?i:1,t=0<=t?t:1,!0)},v.prototype.onOpenMenu=function(t,n,e,i){},v.prototype.onMenuOpened=function(){},v.prototype.dq=function(t,n,e){var i=this;i.rq.QX(n)&&(i.Aq(),e.iy(),i.Iq(t,n,e))},v.prototype.Aq=function(){this.rq.close()},v.prototype.Iq=function(t,n,e){var i,r,o,n,i=this,r=e.uC(),o=n.x,n=n.y;o-=r.left,n-=r.top,i.rq.rQ(i.menuView,t,o,n,e)},v.prototype.hq=function(t,n,e){var i,r,t,i=this,r={};return l.extend(!0,r,t),t=i.xq(r,n,e),i.Nq(t,n),i.kq(t,e),i.Dq(t,e),i._q(t,e),i.Eq(t),i.Oq(t),t=(0,A.filterReportSheetMenuItems)(t,e,n),t=i.jq(t)},v.prototype.xq=function(t,a,u){var s,c,f,s=this,c=[],f=Object.keys(Le);return l.each(t,function(t,n){var e,i,r,o;if(!rt(n))for(n.type===h&&c.push(n),e=0;e<f.length;e++)if(i=f[e],(r=Le[i])(a,u,n)&&(o=s.Rq(n,a)))return void c.push(n)}),c},v.prototype.Bq=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,r,g,p,i=e.placeholder,r=e.name,o=n.area,a=n.value,u=n.menuArea,s=n.colHeadFieldInfo,c=n.rowInfos,f=n.colInfos,l=n.cornerFieldInfo,h=n.activeRowFieldInfo,d=n.activeColFieldInfo;if(rt(i))r===b+Ut&&(r=h&&h.name||d&&d.name||s&&s.fieldName||l&&l.fieldName,g=t.dh,p=r&&g.getFieldInfoByName(r)&&2===g.getFieldInfoByName(r).W5)&&(e.text=y().pivotTableLabelFilters_Date);else if(i===R){if(v=void 0,0===u)v=n.pageFieldInfo.fieldName;else if(2===o&&2===u){if(s)v=s.fieldName;else if(v=d&&d.name,rt(v)){for(m=d.index;0<=m&&f[m]&&rt(f[m].itemName);)m-=1;v=f[m].fieldName}}else if(3===o&&2===u){if(v=h&&h.name,rt(v)){for(m=h.index;0<=m&&c[m]&&rt(c[m].itemName);)m-=1;v=c[m].fieldName}}else 1===o?1===u?v=n.value:2===u&&l&&(v=l.fieldName):4===u&&(v=n.valueFieldName,2===o?v=d&&d.name||a:3===o&&(v=h&&h.name||a));e.text=e.text.replace("{0}",'"'+v+'"')}else i===F&&4===u&&(v=void 0,0===(g=e.commandOptions.subType)?v=y().pivotTableSortAscend:1===g&&(v=y().pivotTableSortDescend),e.text=v);rt(e.commandOptions)&&(e.commandOptions={}),e.commandOptions.pivotTableName=t.name(),e.commandOptions.pivotTableCellInfo=n},v.prototype.Oq=function(t){for(var n,e,i,r,n=0,e=!1,i=0;i<t.length&&((r=t[i].name)!==b+ut+mt&&r!==b+ut+gt&&r!==b+at+mt&&r!==b+at+gt||(e=!0),r!==b+dt&&r!==b+Bn||(n=i,!e));i++);e&&t.splice(n,1)},v.prototype.Nq=function(t,n){var n,e,n=n.worksheetHitInfo,e;!n||n.row!==wt&&n.col!==wt||t.splice(0,t.length)},v.prototype.kq=function(o,t){var a,u,t,a=this,u=(0,it.jf)(t),t=a.aq;return l.each(t,function(t,n){var e,i,r;if(!n.checkFunction(u))for(i=0,r=(e=n.menuDataDict).length;i<r;i++)a.Lq(o,e[i],function(t,n){t[n]=null})}),o},v.prototype.Rq=function(t,n){var e,i,r,n,o,a,u,s,c,f,l,h,d,v,m,g,p,e=this,i=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableInfo;if(i&&(r=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableCellInfo)){if(n=i.options.subtotalsPosition,o=r.value,a=r.area,u=r.menuArea,s=r.cornerFieldInfo,c=r.colHeadFieldInfo,f=r.activeRowFieldInfo,l=r.activeColFieldInfo,h=r.rowInfos,d=r.colInfos,v=r.valueFieldName,-1<(m=[w+B,w+Ft,w+V]).indexOf(t.name)&&((2===a||3===a)&&4===u||(!rt(s)||!rt(c))&&o===y().sigmaValueTemp||3===a&&f&&h[f.index].isSubtotal&&void 0===h[f.index].collapseIndex&&1!==n||2===a&&l&&d[l.index].isSubtotal&&void 0===d[l.index].collapseIndex&&1!==n))return!1;if(-1<(g=[w+P,w+U]).indexOf(t.name)&&(!rt(s)||!rt(c)))return!1;if(-1<(p=[w+Q,w+Y,w+L,w+H]).indexOf(t.name)&&rt(v)&&4===u&&4===a)return!1;t&&t.subMenu?t.subMenu.forEach(function(t){e.Bq(i,r,t),e.Fq(i,r,t)}):e.Bq(i,r,t)}return!0},v.prototype.Fq=function(t,n,e){var i,r,o,a,n,i,r,u,s,n,t,c,f,l,h,l,i=n.activeRowFieldInfo,r=n.activeColFieldInfo,o=n.cornerFieldInfo,a=n.colHeadFieldInfo,n=n.valueFieldName,i=i&&i.name||r&&r.name||a&&a.fieldName||o&&o.fieldName||n,r=t.dh,u=i&&r.getFieldInfoByName(i),s=r.K;switch(e.commandOptions&&u&&(n=e.commandOptions.showValueAsType,t=e.commandOptions.subTotalType,rt(n)||(c=u.Or&&u.Or.showDataAs||0)===n&&(e.iconClass=x),rt(t)||(f=u.getSubTotalType())===t&&(e.iconClass=x)),e.name){case b+Lt:h=!1,(l=s.Pq[u.a])&&l.C()&&(h=!0),l=!!l&&l.on(),h||l||(e.disable=!0);break;case b+Bt:case b+Pt:rt(o)&&rt(a)||(e.disable=!0)}},v.prototype.Dq=function(t,n){var n,e,r,o,a,n=(0,it.jf)(n),e=n&&n.getSelections();e&&0<e.length&&(r=ui(n,e[0]),o=n.getActiveRowIndex(),a=n.getActiveColumnIndex(),r)&&l.each(t,function(t,n){var e,i;rt(n)||(n.name===b+ee?(e=n.subMenu,(i=r.rowFilter()).isFiltered()?r.checkTableLastRow(o)?e.splice(2,2):e.splice(2,1):(e.splice(4,1),r.checkTableLastRow(o)&&e.splice(3,1)),r.checkTableLastCol(a)&&e.splice(1,1)):n.name===b+ie&&(e=n.subMenu,(i=r.rowFilter()).isFiltered()?e.splice(1,1):e.splice(2,1)))})},v.prototype.Eq=function(t){for(var n,e,i,n=this,i,e=t.length-1;0<=e;e--)t[e]?t[e].subMenu&&n.Eq(t[e].subMenu):t.splice(e,1);return t},v.prototype.jq=function(t){for(var n,e,i,r,o,a,u,n=[],i=t.length,e=0;e<i;e++)t[e]&&t[e].type===h&&t[e+1]&&t[e+1].type===h||n.push(t[e]);for(i=n.length,u=a=!(o=r=0),e=0;e<i&&(a&&n[e].type===h?r++:a=!1,u&&n[i-1-e].type===h?o++:u=!1,a||u);e++);return n.splice(i-o,o),n.splice(0,r),n},v.prototype._q=function(t,n){var e=this;e.Gq(t,n),e.Uq(t,n)},v.prototype.Gq=function(t,n){for(var e,i,r,o,a,e=this,i=(0,it.jf)(n),r=i&&i.tables,o=i&&i.NMi,a=0;a<t.length;a++)if(t[a]){switch(t[a].name){case b+dt:i.rR()||(t[a].disable=!0),i.isActualProtected()&&!i.options.protectionOptions.allowInsertRows&&(t[a].disable=!0);break;case b+Pn:i.rR()||(t[a].disable=!0),i.isActualProtected()&&!i.options.protectionOptions.allowDeleteRows&&(t[a].disable=!0),r&&r.containTableHeaderTotalRowForSheet()&&(t[a].disable=!0);break;case b+Bn:i.oR()||(t[a].disable=!0),i.isActualProtected()&&!i.options.protectionOptions.allowInsertColumns&&(t[a].disable=!0);break;case b+Gn:i.oR()||(t[a].disable=!0),i.isActualProtected()&&!i.options.protectionOptions.allowDeleteColumns&&(t[a].disable=!0);break;case b+re:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(t[a].disable=!0);break;case b+oe:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(t[a].disable=!0);break;case b+se:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(t[a].disable=!0);break;case b+ae:case b+ue:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(t[a].disable=!0);break;case b+le:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(t[a].disable=!0);break;case b+cn:o&&(t[a].disable=!o.enablePinColumn());break;case b+sn:o&&(t[a].disable=!o.enablePinRow())}t[a]&&t[a].subMenu&&e.Gq(t[a].subMenu,n)}},v.prototype.Uq=function(t,n){var e,i,r,o,a,u,s,s,e=this,i=(0,it.jf)(n),r=i&&i.isActualProtected(),o=i&&i.options.protectionOptions;if(r&&o)for(a=void 0,u=0;u<t.length;u++)if(t[u]){switch(t[u].name){case b+dt:o.allowInsertRows||(t[u].disable=!0);break;case b+Bn:o.allowInsertColumns||(t[u].disable=!0);break;case b+Pn:o.allowDeleteRows||(t[u].disable=!0);break;case b+Gn:o.allowDeleteColumns||(t[u].disable=!0);break;case b+On:o.allowFilter||(t[u].disable=!0);break;case b+ft:case b+lt:o.allowSort||(t[u].disable=!0);break;case b+un:case b+on:case b+_n:case b+an:i.NMi||(t[u].disable=!0);break;case b+$n:case b+te:o.allowEditObjects||t.splice(0,t.length);break;case b+ht:o.allowEditObjects||(t[u]=null);break;case b+ct:s=void 0,i.comments&&(s=(a=i.comments.get(i.getActiveRowIndex(),i.getActiveColumnIndex()))&&a.lockText()),!o.allowEditObjects&&s&&(t[u]=null);break;case b+st:s=void 0,i.comments&&(s=!Ke(i.getSelections(),i)),!o.allowEditObjects&&s&&(t[u]=null);break;case b+re:case b+oe:case b+ae:case b+ue:case b+se:case b+le:t[u].disable=!0}t[u]&&t[u].subMenu&&e.Uq(t[u].subMenu,n)}},v.prototype.Tq=function(t,n,e){var n,i,r,o;if(n.tabStripHitInfo&&(n=this,i=e.qv(),r=n.Hq(b+en))){for(o=0;o<i.length;o++)if(i[o].visible()===it.SheetTabVisible.hidden)return void(r.disable=!1);r.disable=!0}},v.prototype.Hq=function(t){var n=this;return n.zq(n.menuData,t)},v.prototype.zq=function(t,n){var e,i,e;return this.Lq(t,n,function(t,n){i=t[n]}),i},v.prototype.Lq=function(t,n,e){for(var i,r,o,i=this,r=t.length,o=0;o<r;o++)if(!rt(t[o])){if(n===t[o].name)return void e(t,o);t[o].subMenu&&i.Lq(t[o].subMenu,n,e)}},v.prototype.Vq=function(t,n){for(var e,i,r,o,e=this,i=t.length,r=0;r<i;r++)o=t[r],rt(o)||(n(o),o.subMenu&&e.Vq(o.subMenu,n))},v.prototype.oq=function(d){var c,t,n,e,i,i,r,o,a,u,s,f,l,h,v,m,g,i,p,i,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,F,L,B,P,G,U,H,V,z,Y,Z,W,Q,E,J,K,X,q,$,tt,nt,et;function R(t,n,e){for(var i,r,i=0;i<e;i++)-1===t.indexOf(r=n+i)&&t.push(r)}this.Yq||((c=d.commandManager()).register(ot+Jn,t={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&(Ge(t)?c.execute({cmd:"copyShapes",sheetName:t.name()}):c.execute({cmd:Jn,sheetName:t.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),c.register(ot+Qn,n={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&(Ge(t)?c.execute({cmd:"cutShapes",sheetName:t.name()}):c.execute({cmd:Qn,sheetName:t.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),c.register(ot+Wn,e={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&(t.isPasteFloatingObject&&t.isPasteFloatingObject()?c.execute({cmd:"pasteFloatingObjects",sheetName:t.name()}):t.isPasteShapes&&t.isPasteShapes()?c.execute({cmd:"pasteShapes",sheetName:t.name()}):c.execute({cmd:Hn,sheetName:t.name(),pasteOption:0}))}},null,!1,!1,!1,!1),c.register(ot+mt+bt,i={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&c.execute({cmd:Hn,sheetName:t.name(),pasteOption:0,shiftCells:it.InsertShiftCell.right,isHeaderPaste:Ai(n.itemName)})}},null,!1,!1,!1,!1),c.register(ot+gt+bt,i,null,!1,!1,!1,!1),c.register(ot+at+mt,i,null,!1,!1,!1,!1),c.register(ot+at+gt,i,null,!1,!1,!1,!1),c.register(ot+mt+pt,i={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&c.execute({cmd:Hn,sheetName:t.name(),pasteOption:0,shiftCells:it.InsertShiftCell.down,isHeaderPaste:Ai(n.itemName)})}},null,!1,!1,!1,!1),c.register(ot+gt+pt,i,null,!1,!1,!1,!1),c.register(ot+ut+mt,i,null,!1,!1,!1,!1),c.register(ot+ut+gt,i,null,!1,!1,!1,!1),c.register(ot+Zn,r={canUndo:!1,execute:function(t,n){var e=3;bi(t,n,c,3)}},null,!1,!1,!1,!1),c.register(ot+vt,o={canUndo:!1,execute:function(t,n){var e=1;bi(t,n,c,1)}},null,!1,!1,!1,!1),c.register(ot+Yn,a={canUndo:!1,execute:function(t,n){var e=1;bi(t,n,c,1)}},null,!1,!1,!1,!1),c.register(ot+zn,u={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&c.execute({cmd:Hn,sheetName:t.name(),pasteOption:2})}},null,!1,!1,!1,!1),c.register(ot+Kn,s={canUndo:!1,execute:function(t,n){var e=4;bi(t,n,c,4)}},null,!1,!1,!1,!1),c.register(ot+Xn,f={canUndo:!1,execute:function(t,n){var e=5;bi(t,n,c,5)}},null,!1,!1,!1,!1),c.register(ot+Un,l={canUndo:!1,execute:function(t,n){var t=(0,it._f)(t,n.sheetName);t&&c.execute({cmd:"clear",sheetName:t.name()})}},null,!1,!1,!1,!1),c.register(ot+ht,h={canUndo:!0,execute:function(v,t,n){return yt(v,t,n,function(t,n){var e,i,r,n,o,e,i,a,u,e,i,s,o,c,f,l,h,d,e=n.commentState||2,i=n.displayMode,r=n.activeRow,n=n.activeCol,o=t.comments.add(r,n,"");o&&(o.commentState(e),i&&o.displayMode(i),e=t.C0(r),i=t.S0(n),a=t.getCellRect(r,n,e,i),e=(u=t.Fi()).c9(e,i),i=o.location(),s=o.width(),o=o.height(),h=l=f=c=void 0,d=v.ib,a.y+i.y<e.y?(l=gi(t,r,a.y+i.y-e.y),c=d.Jy(t,l),d.yy(t,c.Ky,0),t.tw()):a.y+i.y+o>e.y+e.height&&(l=gi(t,r,a.y+i.y+o-(e.y+e.height)),c=d.Jy(t,l),d.yy(t,c.Ky,0),t.tw()),a.x+i.x+s>e.x+e.width)&&(h=pi(t,n,a.x+i.x+s-(e.x+e.width)),f=d.rw(t,h),d.wy(t,f.iw,0),t.ow())},function(t,n){var e,i,e,i,e=n.activeRow,i=n.activeCol,e=t.comments.get(e,i);if(e)return n.displayMode=e.displayMode(),n.commentState=e.commentState(),i={sheet:t,sheetName:t.name(),comment:e,cancel:!1},t.ki(it.Events.CommentRemoving,i),{cancel:i.cancel,comment:e}},function(t,n,e){t.ki(it.Events.CommentRemoved,{sheet:t,sheetName:t.name(),comment:e.comment})})}},null,!1,!1,!1,!1),c.register(ot+ct,v={canUndo:!1,execute:function(t,n){var t,e,n,t,t=(0,it._f)(t,n.sheetName);t&&(e=n.activeRow,n=n.activeCol,t=t.comments.get(e,n))&&t.commentState(2,!0)}},null,!1,!1,!1,!1),c.register(ot+st,m={canUndo:!0,execute:function(t,s,n){return yt(t,s,n,function(t){var n,e,i,r,o,a,u,n=s.selections,e=n.length;if(!(e<=0))for(i=0;i<e;i++)for(o=(r=n[i]).row;o<r.row+r.rowCount;o++)for(a=r.col;a<r.col+r.colCount;a++)!(u=t.comments.get(o,a))||t.isActualProtected()&&!t.options.protectionOptions.allowEditObjects&&u.locked()||c.execute({cmd:st,sheetName:t.name(),row:u.bZ,col:u.yZ})})}},null,!1,!1,!1,!1),c.register(ot+nn,g={canUndo:!1,execute:function(t,n){var t,e,n,t,t=(0,it._f)(t,n.sheetName);t&&(e=n.activeRow,n=n.activeCol,t=t.comments.get(e,n))&&(2===t.displayMode()?t.displayMode(1):t.displayMode(2))}},null,!1,!1,!1,!1),c.register(ot+dt,i={canUndo:!0,execute:function(t,v,n){return v.considerAllSheets=!0,yt(t,v,n,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,n=ci(v.selections),i=0;i<n.length;i++){for(e=n[i],r=t.getRange(e.row-1,0,1,e.colCount),o=[],a=0;a<r.colCount;a++)t.getCell(r.row,a).locked()||o.push(a);for(u=e.row,s=e.rowCount,t.addRows(u,s),c=0;c<o.length;c++)for(f=n[i].row;f<n[i].row+n[i].rowCount;f++)t.getCell(f,o[c]).locked(!1);if(t.tables&&0<s)for(l=t.tables.AB(u,-1,s,-1),h=0;h<l.length;h++)(d=l[h]).jj(u,s,!1,!1);li(t,u,-1,s)}})}},null,!1,!1,!1,!1),c.register(ot+"insertEntireSheetRows",i,null,!1,!1,!1,!1),c.register(ot+Bn,p={canUndo:!0,execute:function(t,v,n){return v.considerAllSheets=!0,yt(t,v,n,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,n=fi(v.selections),i=0;i<n.length;i++){for(e=n[i],r=t.getRange(0,e.col-1,e.rowCount,1),o=[],a=0;a<r.rowCount;a++)t.getCell(a,r.col).locked()||o.push(a);for(u=e.col,s=e.colCount,t.addColumns(u,s),c=0;c<o.length;c++)for(f=u;f<u+s;f++)t.getCell(o[c],f).locked(!1);if(t.tables&&0<s)for(l=t.tables.AB(-1,u,-1,s),h=0;h<l.length;h++)(d=l[h]).Ej(u,s,!1,!1);li(t,-1,u,s)}})}},null,!1,!1,!1,!1),c.register(ot+Pn,i={canUndo:!0,execute:function(t,h,n){if(!n){var e=(0,it._f)(t,h.sheetName);if(e.isActualProtected()&&it.mt.wme(e))return e.jT(it.InvalidOperationType.editProtected,e.FT()),!1}return h.considerAllSheets=!0,yt(t,h,n,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=ci(h.selections),e=t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.rowsVisibleInfo,i=e&&0<Object.keys(e).length,r=0;r<n.length;r++)if(a=(o=n[r]).row,u=o.rowCount,s=t.getRowCount(),i)for(f=(c=He(o,e)).length-1;0<=f;f--)a=c[f][0],u=c[f][1],l=t.tables&&t.tables.AB(a,-1,u,-1),t.deleteRows(a,u),0<l.length&&0<s-t.getRowCount()&&(s=t.getRowCount(),si(t,l,a,u));else l=t.tables&&t.tables.AB(a,-1,u,-1),t.deleteRows(a,u),0<l.length&&0<s-t.getRowCount()&&si(t,l,a,u)})}},null,!1,!1,!1,!1),c.register(ot+"deleteEntireSheetRows",i,null,!1,!1,!1,!1),c.register(ot+Gn,b={canUndo:!0,execute:function(t,c,n){if(!n){var e=(0,it._f)(t,c.sheetName);if(e.isActualProtected()&&it.mt.wme(e))return e.jT(it.InvalidOperationType.editProtected,e.FT()),!1}return c.considerAllSheets=!0,yt(t,c,n,function(t){for(var n,e,i,r,o,a,u,s,n=fi(c.selections),e=0;e<n.length;e++)if(i=t.getColumnCount(),r=n[e].col,o=n[e].colCount,a=void 0,t.tables&&(a=t.tables.AB(-1,r,-1,o)),t.deleteColumns(r,o),t.tables&&0<i-t.getColumnCount())for(u=0;u<a.length;u++)(s=a[u]).Ej(r,o,!0)})}},null,!1,!1,!1,!1),c.register(ot+Ln,w={canUndo:!1,execute:function(t){var n,e,i,r,o,a,u,s,n=t.getActiveSheetIndex(),e=t.getActiveSheetTabIndex(),i=[],r=(0,it.jf)(t),o=0<=e?t.bb("",it.SheetType.tableSheet):t.S2(t.T2(n)),a;t.qv().forEach(function(t){t.b2()&&i.push(t)}),i.forEach(function(t){t.b2(!1,!0)}),u={sheetName:o.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:-1!==n?n:e,sheetPosition:t.getSheetPosition(o.name())},t.ki(it.Events.SheetChanging,u),u.cancel||(t.ki(it.Events.ActiveSheetChanging,s={oldSheet:r,newSheet:o}),0<=e?t.yb(e,2,o):t.A2(Math.max(0,n),2,o),o.b2(!0,!0),t.ki(it.Events.SheetChanged,{sheetName:o.name(),propertyName:"insertSheet",sheetIndex:-1!==n?n:e,sheetPosition:t.getSheetPosition(o.name())}),t.ki(it.Events.ActiveSheetChanged,{oldSheet:r,newSheet:o}))}},null,!1,!1,!1,!1),c.register(ot+En,y={canUndo:!1,execute:function(r,t){var o,n,e,a,u,n,s,n,o=(0,it.jf)(r),n=r.qv();1<n.length&&(e=[],a=[],n.forEach(function(t,n){var t,t;t.b2()&&(t=t.name(),e.push(t),t=r.Ese(t),a.push(t))}),e.length!==n.length)?1<=e.length&&(r.suspendPaint(),r.suspendCalcService(),u={oldSheet:o,cancel:!1},n=r.sheets,r.options&&r.options.saveChangesForSheet&&it.Commands.II(n),s=[],e.forEach(function(t,n){var n,e,i,i,i,n=a[n],e=(0,it._f)(r,t),i={sheetName:t,propertyName:"deleteSheet",cancel:!1,sheetIndex:n,sheetPosition:r.getSheetPosition(t)};e===o&&r.ki(it.Events.ActiveSheetChanging,u),r.ki(it.Events.SheetChanging,i),u.cancel||i.cancel||(i=r.getSheetIndex(t),!rt(i)&&0<=i?(r.m3(i,2),-1===r.getActiveSheetIndex()&&r.setActiveSheetTab(0)):(i=r.getSheetTabIndex(t),!rt(i)&&0<=i&&(r.g3(i,2),-1===r.getActiveSheetTabIndex())&&r.setActiveSheetIndex(0)),s.push(t),r.ki(it.Events.SheetChanged,{sheetName:t,propertyName:"deleteSheet",sheetIndex:n,sheetPosition:r.getSheetPosition(t)}),i=(0,it.jf)(r),e===o&&r.ki(it.Events.ActiveSheetChanged,{oldSheet:e,newSheet:i}))}),t.deletedSheets=s,r.options&&r.options.saveChangesForSheet&&it.Commands.xI(n,t),(n=(0,it.jf)(r))&&!n.isSelected()&&n.b2(!0,!0),r.resumeCalcService(!1),r.resumePaint()):yi(o),r.undoManager().clear()}},null,!1,!1,!1,!1),c.register(ot+On,M={canUndo:!0,execute:function(t,u,n){return yt(t,u,n,function(t){var n,e,i,r,o,a,i,n,e=u.selections[0],i=ui(t,e),r=u.activeRow,o=u.activeCol;i?(a=i.range()).contains(r,o,1,1)&&(i=i.name(),c.execute({cmd:"contextmenuFilterForTable",sheetName:t.name(),cmdOption:{tableName:i,activeRow:r,activeCol:o,expectedText:t.getText(r,o)}})):t.rowFilter&&c.execute({cmd:"contextmenuFilterForSheet",sheetName:t.name(),cmdOption:{activeRow:r,activeCol:o,selection:e,expectedText:t.getText(r,o)}})})}},null,!1,!1,!1,!1),c.register(ot+ft,C={canUndo:!0,execute:function(t,o,n){if(!n){var e=(0,it._f)(t,o.sheetName);if(e.isActualProtected()&&it.mt.wme(e))return e.jT(it.InvalidOperationType.sort,e.FT()),!1}return yt(t,o,n,function(t){var n,e,i,e,r,r,n=o.activeCol,e=o.selections,i=ui(t,e[0]),e=i?i.dataRange():e[0],r=t.TB(e,!0,null),r={sheet:t,sheetName:t.name(),col:n,ascending:!0,range:e,compareFunction:wt,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};t.ki(it.Events.RangeSorting,r),!1===r.cancel&&(t.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:n,ascending:!0,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},wt,!!i),t.ki(it.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),c.register(ot+lt,S={canUndo:!0,execute:function(t,o,n){if(!n){var e=(0,it._f)(t,o.sheetName);if(e.isActualProtected()&&it.mt.wme(e))return e.jT(it.InvalidOperationType.sort,e.FT()),!1}return yt(t,o,n,function(t){var n,e,i,e,r,r,n=o.activeCol,e=o.selections,i=ui(t,e[0]),e=i?i.dataRange():e[0],r=t.TB(e,!0,null),r={sheet:t,sheetName:t.name(),col:n,ascending:!1,range:e,compareFunction:wt,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};t.ki(it.Events.RangeSorting,r),!1===r.cancel&&(t.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:n,ascending:!1,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},wt,!!i),t.ki(it.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),c.register(ot+$n,T={canUndo:!0,execute:function(t,n,e){return wi(t,n,e,1)}},null,!1,!1,!1,!1),c.register(ot+te,A={canUndo:!0,execute:function(t,n,e){return wi(t,n,e,2)}},null,!1,!1,!1,!1),c.register(ot+sn,I={canUndo:!0,execute:function(t,a,n){return yt(t,a,n,function(t){var n,e,i,r,o,n=a.selections;if(0<n.length){for(e=[],i=0,r=n;i<r.length;i++)R(e,(o=r[i]).row,o.rowCount);try{t.NMi.togglePinnedRows(e)}catch(t){return!1}}})}},null,!1,!1,!1,!1),c.register(ot+cn,x={canUndo:!0,execute:function(t,a,n){return yt(t,a,n,function(t){var n,e,i,r,o,n=a.selections;if(0<n.length){for(e=[],i=0,r=n;i<r.length;i++)R(e,(o=r[i]).col,o.colCount);try{t.NMi.togglePinnedColumns(e)}catch(t){return!1}}})}},null,!1,!1,!1,!1),c.register(ot+Me,N={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){c.execute({cmd:"ganttSheetInsertTask"})})}},null,!1,!1,!1,!1),c.register(ot+Ce,k={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(){return yt(t,n,e,function(){c.execute({cmd:"ganttSheetDeleteTask"})})})}},null,!1,!1,!1,!1),c.register(ot+Se,_={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){c.execute({cmd:"ganttSheetScrollToTask"})})}},null,!1,!1,!1,!1),c.register(ot+Te,D={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){c.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Manual"})})}},null,!1,!1,!1,!1),c.register(ot+Ae,j={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){c.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Auto"})})}},null,!1,!1,!1,!1),c.register(ot+xe,O={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){return Ti(n,t)})}},null,!1,!1,!1,!1),c.register(ot+Ne,F={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){return Ti(n,t,!0)})}},null,!1,!1,!1,!1),c.register(ot+ke,L={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){c.execute({cmd:"ganttSheetIndentTasks"})})}},null,!1,!1,!1,!1),c.register(ot+_e,B={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){c.execute({cmd:"ganttSheetOutdentTasks"})})}},null,!1,!1,!1,!1),c.register(ot+fn,P={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.promoteHierarchyLevel(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+ln,G={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.demoteHierarchyLevel(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+hn,U={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.addHierarchyItemAfter(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+dn,H={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.addHierarchyItemBefore(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+vn,V={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.addHierarchyItemAbove(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+mn,z={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.addHierarchyItemBelow(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+gn,Y={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.moveUp(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+pn,Z={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.moveDown(n.activeRow)}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+bn,W={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.expandAllHierarchyLevels()}catch(t){return!1}})}},null,!1,!1,!1,!1),c.register(ot+wn,Q={canUndo:!0,execute:function(t,n,e){return yt(t,n,e,function(t){try{t.NMi.collapseAllHierarchyLevels()}catch(t){return!1}})}},null,!1,!1,!1,!1),E={canUndo:!0,execute:function(t,e,n){return yt(t,e,n,function(t){try{var n=parseInt(e.cmd.charAt((ot+yn).length),10)-1;t.NMi.expandHierarchyLevel(n)}catch(t){return!1}})}},ri(9,function(t){c.register(ot+yn+(t+1),E,null,!1,!1,!1,!1)}),c.register(ot+he,J={canUndo:!1,execute:function(t,n){var n,e,n,i,n=n.itemName.substr(10),e=t.ep(),n=t.getSheetPosition(n);t.w2.g2(n),(i=t.getTab()).scrollTabToActive(e,n)}},null,!1,!1,!1,!1),c.register(ot+un,K={canUndo:!0,execute:function(t,e,n){return yt(t,e,n,function(n){t.suspendCalcService(),Ue(e.selections,De,function(t){n.setRowVisible(t,!1)}),t.resumeCalcService(!1)})}},null,!1,!1,!1,!1),c.register(ot+_n,X={canUndo:!0,execute:function(t,e,n){return yt(t,e,n,function(n){t.suspendCalcService(),Ue(e.selections,je,function(t){n.setColumnVisible(t,!1)}),t.resumeCalcService(!1)})}},null,!1,!1,!1,!1),c.register(ot+rn,q={canUndo:!1,execute:function(t){var n,e,i,r,o,a,u,s,c,f,l,f,l,e,h,h,n=0,e=t.qv();if(e.forEach(function(t){t.visible()===it.SheetTabVisible.visible&&(n+=1)}),i=(0,it.jf)(t),n<=1)yi(i);else{if(o=[],e.forEach(function(t){t.b2()&&o.push(t)}),n!==o.length){for(a=0;a<o.length;a++)f={sheetName:s=(u=o[a]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:c=t.Ese(s),sheetPosition:t.getSheetPosition(s),oldValue:!0,newValue:!1},t.ki(it.Events.SheetChanging,f),l={cancel:!1,oldSheet:u},s===i.name()&&t.ki(it.Events.ActiveSheetChanging,l),f.cancel||l.cancel||(u.b2(!1,!0),Be.push(u),u.visible(!1),f=(0,it.jf)(t),a===o.length-1&&f&&!f.isSelected()&&(r={oldValue:!1,newValue:!0,sheetName:l=f.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t.Ese(l),sheetPosition:d.getSheetPosition(l)},t.ki(it.Events.SheetChanging,r)),t.ki(it.Events.SheetChanged,{sheetName:s,propertyName:"isVisible",sheetIndex:c,sheetPosition:t.getSheetPosition(s),oldValue:!0,newValue:!1}));h=(e=(0,it.jf)(t))&&e.name(),r&&(r.cancel?e.Ut.qj(!1):(e.Ut.qj(!0),t&&t.w2&&t.w2.repaint(),h={oldValue:!1,newValue:!0,sheetName:h,propertyName:"isSelected",sheetIndex:t.Ese(h),sheetPosition:t.getSheetPosition(h)},t.ki(it.Events.SheetChanged,h))),i!==e&&t.ki(it.Events.ActiveSheetChanged,{oldSheet:i,newSheet:e})}else yi(i);t.undoManager().clear()}}},null,!1,!1,!1,!1),c.register(ot+on,$={canUndo:!0,execute:function(i,r,t){return yt(i,r,t,function(n){var t,e,t=r.selections,e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;rt(e)&&(e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Ve(n,t[0])),1===t.length&&e?(n.setRowVisible(t[0].row-1,!0),n.$A(t[0].row-1)):(i.suspendCalcService(),Ue(t,De,function(t){n.setRowVisible(t,!0),t===n.pw()&&(n.Tb=0,n.tw())}),i.resumeCalcService(!1))})}},null,!1,!1,!1,!1),c.register(ot+an,tt={canUndo:!0,execute:function(i,r,t){return yt(i,r,t,function(n){var t,e,t=r.selections,e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;rt(e)&&(e=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Ve(n,t[0])),1===t.length&&e?(n.setColumnVisible(t[0].col-1,!0),n.o9(t[0].col-1)):(i.suspendCalcService(),Ue(t,je,function(t){n.setColumnVisible(t,!0),t===n.Sw()&&(n.Ab=0,n.ow())}),i.resumeCalcService(!1))})}},null,!1,!1,!1,!1),c.register(ot+en,nt={canUndo:!1,execute:function(e,t){var i,n,r,o,a,u,t,s,i=e.qv();if(0===Be.length)for(n=0;n<i.length;n++)i[n].visible()===it.SheetTabVisible.hidden&&(Be.push(i[n]),i[n].b2(!1));if(r=(0,it.jf)(e),0<Be.length){if(i.forEach(function(t){t!==r&&t.b2(!1,!0)}),a=o=void 0,t&&!rt(t.activeSheetIndex)&&(o=i[t.activeSheetIndex]),t&&t.unhideSheetIndexes&&0<t.unhideSheetIndexes.length&&((t=t.unhideSheetIndexes).forEach(function(t){var n,n,n=i[t];!1!==(u=Mi(e,n))&&-1<(n=Be.indexOf(i[t]))&&Be.splice(n,1)}),o=o||i[t[t.length-1]]),!o){if(!(o=Be.pop()))return;if(!1===(u=Mi(e,o)))return}if(!o)return;if(!1===(s=Ci(e,r,o)))return;e.setActiveSheet(o.name())}(0,it.jf)(e)!==r&&Si(e,r)}},null,!1,!1,!1,!1),c.register(ot+tn,et={canUndo:!1,execute:function(t,n){var n,e,i,r,o,n=(0,it._f)(t,n.sheetName);if(n&&(t.suspendPaint(),e=[],i=n.slicers.all())&&!Mt(i)){for(r in i)i.hasOwnProperty(r)&&(o=i[r]).isSelected()&&e.push(o.name());c.execute({cmd:"deleteSlicers",sheetName:n.name(),slicerNames:e}),t.resumePaint()}}},null,!1,!1,!1,!1),Ii(c),this.Yq=!0)},v.prototype.openAllSheetsListContextMenu=function(t,n,e,i){var r,e,r=this.menuView.maxHeight();!rt(r)&&-1!==r||this.menuView.maxHeight(400),e=this.Zq(n,e),this.Hc(n),this.lq(e,n),this.rq.jTe=it.DialogFeatureType.sheetList,this.dq(t,e,n),this.rq.jTe=it.DialogFeatureType.contextMenu,rt(r)?this.menuView.maxHeight(-1):this.menuView.maxHeight(r),this.menuView.Wq&&this.menuView.Wq.hU(i)},v.prototype.Zq=function(t,n){var n,e,n=this.fq(n,t),e=2;return 0===t.options.tabStripPosition&&(n.x=n.x+2,n.y=n.y-2),n},Pe=v,g.ContextMenu=Pe,it.Workbook.ch("contextmenu",{init:function(){var t=this;t.contextMenu||(t.contextMenu=new Pe),t.contextMenu.oq(this)},setHost:function(){var n,t,n=this,t=n.Ti;n.contextMenu||(n.contextMenu=new Pe),l(t).bind("contextmenu.gcSheet",function(t){if(n.options.allowContextMenu)return n.contextMenu.cq(t,n)})},dispose:function(){l(this.Ti).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var t,n,e,i,t=this.contextMenu;t&&(n=t.menuData,e=t.nq(),i={},t.Vq(e,function(t){rt(t.name)||(i[t.name]=t.text)}),t.Vq(n,function(t){rt(t.name)||rt(i[t.name])||(t.text=i[t.name])}))},fromJson:function(t){var n=this.contextMenu&&this.contextMenu.menuView,e=t.contextMenu;n&&!rt(e)&&(n.Qq=t.scrollable,n.Kq=t.maxHeight)},toJson:function(t){var n=this.contextMenu&&this.contextMenu.menuView;!n||rt(n.Qq)&&rt(n.Kq)||(t.contextMenu={},t.contextMenu.scrollable=n.Qq,t.contextMenu.maxHeight=n.Kq)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/contextMenu/context-menu.res.en.js");n.SR={en:e}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tableDeleteColumns=n.tableDeleteOrInsertEntireSheetRow=n.tableDeleteRows=n.tableDelete=n.tableInsertColumnsRight=n.tableInsertColumnsLeft=n.tableInsertRowsBelow=n.tableInsertRowsAbove=n.tableInsert=n.removeFloatingObject=n.removeSlicer=n.toggleComment=n.deleteComment=n.editComment=n.unhideRows=n.unhideColumns=n.unhideSheet=n.hideSheet=n.hideColumns=n.hideRows=n.sortDescend=n.sortAscend=n.slicerSortDescend=n.slicerSortAscend=n.headerInsertCutCells=n.headerInsertCopiedCells=n.shiftCellsDown=n.shiftCellsRight=n.insertCutCells=n.insertCopiedCells=n.sort=n.filter=n.insertComment=n.deleteSheet=n.insertSheet=n.deleteColumns=n.deleteRows=n.insertColumns=n.insertRows=n.clearContents=n.pasteSpecial=n.pasteFormulaFormatting=n.pasteValuesFormatting=n.pasteFormatting=n.pasteValues=n.pasteFormula=n.pasteAll=n.pasteOptions=n.cut=n.copy=void 0,n.pivotTableExpand=n.pivotTableValueFilters=n.pivotTableLabelFilters_Date=n.pivotTableLabelFilters=n.pivotTableTop10=n.pivotTableHideSelectedItems=n.pivotTableKeepOnlySelectedItems=n.pivotTableClearFilterFrom_=n.pivotTableFieldSettings=n.pivotTableHideFieldList=n.pivotTableSubtotal_=n.pivotTableFilter=n.pivotTableExpandOrCollapse=n.pivotTableUnGroup=n.pivotTableGroup=n.pivotTableShowDetails=n.pivotTableIndex=n.pivotTableRankLargestToSmallest=n.pivotTableRankSmallestToLargest=n.pivotTablePercentRunningTotalIn=n.pivotTableRunningTotalIN=n.pivotTablePercentDifferenceFrom=n.pivotTableDifferenceFrom=n.pivotTableOfParentTotal=n.pivotTableParentColumnTotal=n.pivotTableParentRowTotal=n.pivotTableOf=n.pivotTableRowTotal=n.pivotTableColumnTotal=n.pivotTableGrandTotal=n.pivotTableNoCalculation=n.pivotTableShowValueAs=n.pivotTableMoreOptions=n.pivotTableDistinctCount=n.pivotTableProduct=n.pivotTableMin=n.pivotTableMax=n.pivotTableAverage=n.pivotTableCount=n.pivotTableSum=n.pivotTableSummarizeValuesBy=n.pivotTableSort=n.pivotTableNumberFormat=n.pivotTableOptions=n.pivotTableValueFieldSettings=n.pivotTableRemoveGrandTotal=n.pivotTableRemove_=n.pivotTableMove=n.pivotTableRefresh=n.hideSheetFailureInfo=void 0,n.autoSchedule=n.manuallySchedule=n.outdentTasks=n.indentTasks=n.deleteTasks=n.insertTasks=n.scrollToTasks=n.reportSheetResetCellValue=n.reportSheetSubmit=n.reportSheetDeleteRecord=n.reportSheetAddRecord=n.paste=n.expandLevel9=n.expandLevel8=n.expandLevel7=n.expandLevel6=n.expandLevel5=n.expandLevel4=n.expandLevel3=n.expandLevel2=n.expandLevel1=n.collapseAllLevels=n.expandAllLevels=n.addBelow=n.addAbove=n.addBefore=n.addAfter=n.moveDown=n.moveUp=n.demote=n.promote=n.pinColumns=n.pinRows=n.pivotTableSortMoreOptions=n.pivotTableSortDescend=n.pivotTableSortAscend=n.sigmaValueTemp=n.sigmaValue=n.pivotTableMove_ToColumns=n.pivotTableMove_ToRight=n.pivotTableMove_ToLeft=n.pivotTableMove_ToEnd=n.pivotTableMove_Down=n.pivotTableMove_Up=n.pivotTableMove_ToBeginning=n.pivotTableExpandTo_=n.pivotTableCollapseTo_=n.pivotTableCollapseEntireField=n.pivotTableExpandEntireField=n.pivotTableCollapse=void 0,n.unhideColumn=n.hideColumn=void 0,n.copy="Copy",n.cut="Cut",n.pasteOptions="Paste Options:",n.pasteAll="All",n.pasteFormula="Formulas",n.pasteValues="Values",n.pasteFormatting="Formatting",n.pasteValuesFormatting="Values&Formatting",n.pasteFormulaFormatting="Formula&Formatting",n.pasteSpecial={title:"Paste Special...",formulaAndNumberFormat:"Formula & Number Formatting",keepSourceFormatting:"Keep Source Formatting",noBorders:"No Borders",columnWidth:"Keep Source Column Widths",transpose:"Transpose",valuesAndNumberFormat:"Values & Number Formatting",valueAndSourceFormat:"Values & Source Formatting",pasteLink:"Paste Link",otherPasteOptions:"Other Paste Options"},n.clearContents="Clear Contents",n.insertRows="Insert",n.insertColumns="Insert",n.deleteRows="Delete",n.deleteColumns="Delete",n.insertSheet="Insert",n.deleteSheet="Delete",n.insertComment="Insert Comment",n.filter="Filter",n.sort="Sort",n.insertCopiedCells="Insert Copied Cells...",n.insertCutCells="Insert Cut Cells...",n.shiftCellsRight="Shift Cells Right",n.shiftCellsDown="Shift Cells Down",n.headerInsertCopiedCells="Insert Copied Cells",n.headerInsertCutCells="Insert Cut Cells",n.slicerSortAscend="Sort A to Z",n.slicerSortDescend="Sort Z to A",n.sortAscend="Sort A to Z",n.sortDescend="Sort Z to A",n.hideRows="Hide",n.hideColumns="Hide",n.hideSheet="Hide",n.unhideSheet="Unhide",n.unhideColumns="Unhide",n.unhideRows="Unhide",n.editComment="Edit Comment",n.deleteComment="Delete Comment",n.toggleComment="Show/Hide Comment",n.removeSlicer="Remove",n.removeFloatingObject="Remove",n.tableInsert="Insert",n.tableInsertRowsAbove="Table Rows Above",n.tableInsertRowsBelow="Table Row Below",n.tableInsertColumnsLeft="Table Columns to the Left",n.tableInsertColumnsRight="Table Columns to the Right",n.tableDelete="Delete",n.tableDeleteRows="Table Rows",n.tableDeleteOrInsertEntireSheetRow="Entire Sheet Row",n.tableDeleteColumns="Table Columns",n.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",n.pivotTableRefresh="Refresh",n.pivotTableMove="Move",n.pivotTableRemove_="Remove {0}",n.pivotTableRemoveGrandTotal="Remove GrandTotal",n.pivotTableValueFieldSettings="Value Field Settings...",n.pivotTableOptions="PivotTable Options...",n.pivotTableNumberFormat="Number Format...",n.pivotTableSort="Sort",n.pivotTableSummarizeValuesBy="Summarize Values By",n.pivotTableSum="Sum",n.pivotTableCount="Count",n.pivotTableAverage="Average",n.pivotTableMax="Max",n.pivotTableMin="Min",n.pivotTableProduct="Product",n.pivotTableDistinctCount="Distinct Count",n.pivotTableMoreOptions="More Options",n.pivotTableShowValueAs="Show Value As",n.pivotTableNoCalculation="No Calculation",n.pivotTableGrandTotal="% of Grand Total",n.pivotTableColumnTotal="% of Column Total",n.pivotTableRowTotal="% of Row Total",n.pivotTableOf="% Of...",n.pivotTableParentRowTotal="% of Parent Row Total",n.pivotTableParentColumnTotal="% of Parent Column Total",n.pivotTableOfParentTotal="% of Parent Total...",n.pivotTableDifferenceFrom="Difference From...",n.pivotTablePercentDifferenceFrom="% Difference From...",n.pivotTableRunningTotalIN="Running Total In...",n.pivotTablePercentRunningTotalIn="% Running Total In...",n.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",n.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",n.pivotTableIndex="Index",n.pivotTableShowDetails="Show Details",n.pivotTableGroup="Group...",n.pivotTableUnGroup="Ungroup...",n.pivotTableExpandOrCollapse="Expand/Collapse",n.pivotTableFilter="Filter",n.pivotTableSubtotal_="Subtotal {0}",n.pivotTableHideFieldList="Hide Field List",n.pivotTableFieldSettings="Field Settings...",n.pivotTableClearFilterFrom_="Clear Filter From {0}",n.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",n.pivotTableHideSelectedItems="Hide Selected Items",n.pivotTableTop10="Top 10...",n.pivotTableLabelFilters="Label Filters...",n.pivotTableLabelFilters_Date="Date Filters...",n.pivotTableValueFilters="Value Filters...",n.pivotTableExpand="Expand",n.pivotTableCollapse="Collapse",n.pivotTableExpandEntireField="Expand Entire Field",n.pivotTableCollapseEntireField="Collapse Entire Field",n.pivotTableCollapseTo_="Collapse to {0}",n.pivotTableExpandTo_="Expand to {0}",n.pivotTableMove_ToBeginning="Move {0} to Beginning",n.pivotTableMove_Up="Move {0} Up",n.pivotTableMove_Down="Move {0} Down",n.pivotTableMove_ToEnd="Move {0} to end",n.pivotTableMove_ToLeft="Move {0} to left",n.pivotTableMove_ToRight="Move {0} to Right",n.pivotTableMove_ToColumns="Move {0} to columns",n.sigmaValue="\u2211 Values",n.sigmaValueTemp="Values",n.pivotTableSortAscend="Sort Smallest to Largest",n.pivotTableSortDescend="Sort Largest to Smallest",n.pivotTableSortMoreOptions="More Sort Options...",n.pinRows="Pin/Unpin Rows",n.pinColumns="Pin/Unpin Columns",n.promote="Promote",n.demote="Demote",n.moveUp="Move Up",n.moveDown="Move Down",n.addAfter="Add After",n.addBefore="Add Before",n.addAbove="Add Above",n.addBelow="Add Below",n.expandAllLevels="Expand All Levels",n.collapseAllLevels="Collapse All Levels",n.expandLevel1="Expand to Level 1",n.expandLevel2="Expand to Level 2",n.expandLevel3="Expand to Level 3",n.expandLevel4="Expand to Level 4",n.expandLevel5="Expand to Level 5",n.expandLevel6="Expand to Level 6",n.expandLevel7="Expand to Level 7",n.expandLevel8="Expand to Level 8",n.expandLevel9="Expand to Level 9",n.paste="Paste",n.reportSheetAddRecord="Add Record",n.reportSheetDeleteRecord="Delete Record",n.reportSheetSubmit="Submit",n.reportSheetResetCellValue="Reset Current Cell",n.scrollToTasks="Scroll To Task",n.insertTasks="Insert Task",n.deleteTasks="Delete Task",n.indentTasks="Indent Task",n.outdentTasks="Outdent Task",n.manuallySchedule="Manually Schedule",n.autoSchedule="Auto Schedule",n.hideColumn="Hide Column",n.unhideColumn="Unhide Column"},"./dist/plugins/contextMenu/menu-view.js":function(F,t,n){"use strict";var i,f,M,l,n,b,L,B,u,w,e,a,P,C,G,U,s,c,h,H,V,z,r,Y,d,o,Z,W,Q,v,m,n,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,g,lt,p,ht,y,S,T,dt,vt,mt,A,I,x,N,gt,pt,k,_,D,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,j,O,Nt,kt,n;function _t(t){return t instanceof Object}function E(t,n,e){var i=this;i.Ti=t,i.Jq=n,i.Xq(t,n,e)}function R(){}function Dt(t,n,e,i,r){var o,a,e;b(n.pivotTableName)&&(n.pivotTableName=t.name()),b(n.pivotTableCellInfo)&&(n.pivotTableCellInfo=t.getPivotInfoImp(e,i,!1,!1,!0)),"gc.spread.sortAscend"!==r&&"gc.spread.sortDescend"!==r||!t.isSortValueField(n.pivotTableCellInfo)||(o="gc.spread.sortAscend"===r?0:1,(e=(a=t.dh).Q.map(function(t){return t.Zc})).sort(function(t,n){var t=t.localeCompare(n);return 1==o?-1*t:t}),n.sortValueInfo={sortedFieldNames:e,sortType:o})}Object.defineProperty(t,"__esModule",{value:!0}),t.MenuView=void 0,i=n("Common"),f=n("Core"),M=f.GC$,l=f.mt.En,n=i.Common.lt,b=n.ht,L=n.Eh,B=n.tv,u=void 0,w=null,e=document,a=window,P=Math.max,C=Math.min,G=Math.floor,s="mouseenter",c="mouseleave",h="click",H="mousewheel",V="DOMMouseScroll",z="gc.command.executed",r=".",Y="gc-ui-contextmenu",d=".gcScrollWrapper",o="-",Z="container",Q="disable-hover",v="text",m="icon",n="menuitem",J="nonselective-menuitem",K="menuitem-content",X="sup-container",q="separator",$="sup-indicator",tt="subitems-container",nt="group-container",et="title",it="group-header",rt="groupitems-container",ot="groupitem",at="nonexecutable",ut="executable",st="disable",ct="gcUIElement",ft="gcContextMenu",g="gc-statusbar-contextmenu",lt=" ui-widget",p=" ui-state-hover",ht=" ui-icon ui-icon-triangle-1-e",y="DIV",S="SPAN",T="keydown.ctx.gcSheet",vt="inline-block",mt="visible",A="hidden",I="block",x=dt="none",N="overflow",gt="split-item-container",pt="splitMenu-content",_=(k=function(t){return Y+o+t})(W="hover"),D=k(n),bt=k(J),wt=k(K),yt=k(ut),Mt=k(X),Ct=k(tt),St=g+o+"check",Tt=g+o+"check-container",At=g+o+"content",It=g+o+"status",xt=12,j="splitSubMenu",(n=O=O||{})[n.up=0]="up",n[n.down=1]="down",E.prototype.Xq=function(t,n,e){var i,r,o,a,i=this,r=i.qq=M(document.createElement("DIV")),o=i.$q=document.createElement("DIV"),a=i.t$=document.createElement("DIV");r[0].className="gc-ui-contextmenu-scroll-wrapper",o.className="gc-ui-contextmenu-scroll-indicator",o.innerText=String.fromCharCode(708),a.className="gc-ui-contextmenu-scroll-indicator",a.innerText=String.fromCharCode(709),t.append(M(o)),t.append(r),r.append(n),r.height(e.height-12),t.append(M(a)),i.n$=r.height()+12,i.e$=i.i$(n),i.NK(O.up),i.aY()},E.prototype.i$=function(t){var n=0;return t[0].childNodes.forEach(function(t){n+=t.offsetHeight}),n},E.prototype.r$=function(){return this.qq},E.prototype.o$=function(t){var n=this;if(b(t))return n.qq.scrollTop();n.qq.scrollTop(t),n.a$(t)},E.prototype.hU=function(t){for(var n,e,i,r,n,e=this.Jq[0].childNodes,i=0,r=0;r<t;r++)i+=e[r].offsetHeight;this.o$(i-12)},E.prototype.aY=function(){var e=this,t=e.$q,n=e.t$,i=e.qq,r=e.n$,o=e.e$;M(t).bind(s+d,function(){e.u$=a.setInterval(function(){var t,n,t=i.scrollTop(),n;e.o$(G(t<=10?0:t-10))},100)}),M(t).bind(c+d,function(){a.clearInterval(e.u$)}),M(t).bind(h+d,function(){e.o$(0)}),M(n).bind(s+d,function(){e.u$=a.setInterval(function(){var t,n,t=i.scrollTop(),n;e.o$(o-r-10<=t?o-r+2:t+10)},100)}),M(n).bind(c+d,function(){a.clearInterval(e.u$)}),M(n).bind(h+d,function(){e.o$(o-r)}),i.bind(H+d,function(t){e.a$(i.scrollTop()+(t.deltaY||-t.wheelDelta||0))}).bind(V+d,function(t){e.a$(i.scrollTop()+(t.deltaY||-t.wheelDelta||0))})},E.prototype.KX=function(){var t=this,n=t.$q,e=t.t$,t=t.qq;M(n).unbind(d),M(e).unbind(d),t.unbind(d)},E.prototype.eG=function(){var t=this;t.KX(),t.Ti.append(t.Jq),M(t.qq).remove(),M(t.$q).remove(),M(t.t$).remove(),t.Ti=u,t.Jq=u,t.qq=u,t.$q=u,t.t$=u},E.prototype.$c=function(t){switch(t){case O.up:this.$q.style.display=I;break;case O.down:this.t$.style.display=I}},E.prototype.NK=function(t){switch(t){case O.up:this.$q.style.display=x;break;case O.down:this.t$.style.display=x}},E.prototype.a$=function(t){var n=this,e=n.n$,i=n.e$;t<1?(n.$c(O.down),n.NK(O.up),n.s$(!0)):i-e-1<t?(n.$c(O.up),n.NK(O.down),n.s$(!1)):(n.$c(O.up),n.$c(O.down),n.s$(!0))},E.prototype.s$=function(t){var n=this,e=n.qq,n=n.n$;t&&(n-=12),e.height(n)},Nt=E,R.prototype.ZX=function(t,n,e,i){var r=this;r.Ti=M(t),r.c$=B(n),r.Qy=e.commandManager(),r.DJ=e,r.zX=i,r.f$=[],r.l$={},r.h$=[],r.d$={},r.JX=w,r.v$()},R.prototype.m$=function(){var t,n,e,i,r,o,a,u,s,c,f,s,c,n,l,s,h,d,v,m,g,d,h,m,v,m,p,d,t=this,n=t.g$,e=t.Ti,i=t.hostInfo;n[0].style.maxHeight="",r=parseInt(e.css("left"),10),o=parseInt(e.css("top"),10),a=e.width(),u=e.height(),(s=t.U2(u))&&(c=t.Wq=t.p$(e,n),u=t.b$()),"number"==typeof t.Kq&&(s?((f=c.r$())[0].style.maxHeight=t.Kq+"px",n.css(N,w)):(n[0].style.maxHeight=t.Kq+"px",n.css(N,A),u=n.height()+2)),c=(s=t.y$()).windowTop,n=s.windowLeft,l=s.windowWidth,s=s.windowHeight,b(i)?(g=(m=t.w$()).contextTop,d=m.contextLeft,h=m.contextWidth,m=m.contextHeight,v=g+o-Math.max(c,g),m=C(c+s,g+m)-(g+o),p=c+s-g+o,d=C(n+l,d+h)-(d+r),h<r+a?e.css("left",r=0<r-a?r-a:r):d<a&&e.css("left",r-a),m<u&&(u<=v?e.css("top",o-u):u<=v+m?e.css("top",o+m-u):p<u?e.css("top",c+s-g-u):e.css("top",c<g?0:c-g))):(i.left+r+a>n+l&&e.css("left",r=0<r-a?r-a:r),d=((h=t.DJ&&t.DJ.getHost())&&h.getBoundingClientRect().top)<i.top,v=i.top,d?u<=v+o?e.css("top",o-u):e.css("top",-v):s-v-o<u&&e.css("top",s-v-u))},R.prototype.y$=function(){return{windowTop:a.scrollY||a.pageYOffset,windowLeft:a.scrollX||a.pageXOffset,windowWidth:a.clientWidth||a.innerWidth,windowHeight:a.clientHeight||a.innerHeight}},R.prototype.w$=function(){var t,n,e,i,r,t,e,t=this;return t.DJ&&(n=(e=(t=M(t.DJ.getHost())).offset()).top,e=e.left,i=t.width(),r=t.height()),{contextTop:n,contextLeft:e,contextWidth:i,contextHeight:r}},R.prototype.p$=function(t,n){return new Nt(t,n,{height:this.b$()})},R.prototype.M$=function(){var t=this,n=t.g$;"number"==typeof t.Kq&&(n[0].style.maxHeight=t.Kq+"px",n.css(N,A))},R.prototype.v$=function(){var t,n,e,n,i,t=this,n=t.c$;b(n)||!_t(n)||n.length<1||(n instanceof Array||(n=[n]),n=t.S$(e="menuView",n),t.l$.menuView=n,i=t.A$(t.c$),t.g$=i,t.M$(),i.appendTo(t.Ti),this.Gpe(n),t.m$(),t.aY(),t.h$.push({name:e,menuView:i}))},R.prototype.Gpe=function(t){t.forEach(function(t){t.menuItemData.type===j&&(t.host=t.host.find("."+k(pt)))})},R.prototype.S$=function(t,n){for(var e,i,r,o,a,u,e=this,i=n.length,r=[],o=0;o<i;o++)a=n[o],b(a)||"separator"===a.type||(a.type===j?(u=this.convertSplitSubMenuIconData(a),e.l$[u.name]=e.S$(u.name,u.subMenu),e.l$[u.name].push(e.x$(t,u))):a.subMenu?e.l$[a.name]=e.S$(a.name,a.subMenu):"groupHeader"===a.type&&(e.I$(a,n),e.l$[a.name]=e.S$(t,a.groups)),r.push(e.x$(t,a)));return r},R.prototype.convertSplitSubMenuIconData=function(t){var n={name:t.name+"-sub",subMenu:t.subMenu,type:"splitSubMenuIcon"};return t.subMenuIcon=n,t.subMenu=void 0,n},R.prototype.x$=function(t,n){var e,i,r,r,e=this,i="groupHeader"===n.type||n.type===j?e.N$():e.k$(),r=e.createMenuItemElement(n);if(!b(r))return r instanceof HTMLElement&&(r=M(r)),b(n.itemClass)||i.addClass(n.itemClass),b(n.title)||i.attr("title",n.title),r.appendTo(i),r={name:n.name,host:i,menuItemData:n,menuName:t},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(r.host,r.menuItemData),e.f$.push(r),r},R.prototype.k$=function(){var t=M(l(y));return t.addClass(D),t},R.prototype.N$=function(){var t=M(l(y));return t.addClass(bt),t},R.prototype.createMenuItemElement=function(t){var n=this;switch(t.type){case"groupHeader":return n.D$(t);case"groupItem":return n._$(t);case"statusBar":return n.E$(t);case j:return n.Upe(t);case"splitSubMenuIcon":return this.Hpe(t)}return t.subMenu?n.j$(t):n.O$(t)},R.prototype.O$=function(t){var n,e,e,n=M(l(y)).addClass(wt);return t.command?t.disable?n.addClass(k(st)):n.addClass(yt):n.addClass(k(at)),e=M(l(S)).addClass(k(m)),t.iconClass&&e.addClass(t.iconClass),e.appendTo(n),t.text&&((e=M(l(S)).addClass(k(v)))[0].innerHTML=i.Common.zf.j0(t.text),e.appendTo(n)),n},R.prototype.B$=function(t){return M(l(y)).addClass(k(q))},R.prototype.D$=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=M(l(y)).addClass(k(nt));if(!(t.groups.length<=0)){for((i=n.O$(t)).addClass(k(it)),i.appendTo(e),r=M(l(y)).addClass(k(rt)),a=(o=t.groups).length,u=0;u<a;u++)(c=(s=n.L$("name",o[u].name)).host).addClass(k(ot)),c.appendTo(r);r.appendTo(e)}return e},R.prototype._$=function(t){var n,e,i,n,e=this.O$(t),i;return e.find(r+k(v)).remove(),e.attr(et,t.text),e},R.prototype.E$=function(t){var n,e,i,r,t,o,a,o,i,n=l("div"),e=M(n).addClass(wt),i=t.visible,r=t.menuContent,t=t.status,o=l("div");return M(o).addClass(St),a=l("div"),M(a).addClass(Tt),a.appendChild(o),a.style.visibility=i?mt:A,(o=l("div")).innerText=r,M(o).addClass(At),i=l("div"),M(i).addClass(It),t?(i.innerText=t,i.style.display=vt):i.style.display=dt,n.appendChild(a),n.appendChild(o),n.appendChild(i),e},R.prototype.j$=function(t,n){var e,i,r,o,a,u,e=this,i=M(l(y)).addClass(Mt),r=e.O$(t);return 0<t.subMenu.length&&((o=M(l(S)).addClass(k($+ht))).appendTo(r),a=e.A$(t.subMenu),u=M(l(y)).addClass(Ct),n&&u.addClass(n),a.appendTo(u),u.appendTo(e.Ti),e.d$[t.name]=u),r.appendTo(i),i},R.prototype.Hpe=function(t){var n,t,n,t=this.j$(t,k("split-sub-menu"));return t.addClass(k("splitMenu-icon")),t.find("."+k(m)).remove(),t},R.prototype.Upe=function(t){var n,e,i,r,n=this,e=M(l(y)).addClass(k("splitMenu-container"));return t.subMenuIcon&&((i=n.O$(t)).addClass(k(pt)).addClass(D),i.appendTo(e),(r=n.L$("name",t.subMenuIcon.name)).host.appendTo(e)),e},R.prototype.A$=function(t){for(var n,e,i,r,o,a,a,u,n=this,e=M(l(y)).addClass(k(Z+lt)),i=t.length,r=0;r<i;r++)b(t[r])||(o=t[r].name,b(o)?"separator"===t[r].type&&(a=n.N$(),(u=n.B$(t[r])).appendTo(a),a.appendTo(e)):(a=n.L$("name",o),b(a)||a.host.appendTo(e)));return e},R.prototype.L$=function(t,n){for(var e,i,r,o,e,i=this.f$,r=i.length,o=0;o<r;o++)if(n instanceof M?n[0]===i[o][t][0]:i[o][t]===n)return i[o]},R.prototype.I$=function(t,n){var e,i,r;for(t.groups=[],e=n.length,i=0;i<e;i++)(r=n[i])&&r.group&&r.group===t.name&&(r.type="groupItem",t.groups.push(r),n.splice(i,1),i--)},R.prototype.aY=function(){var o=this;M(r+D).bind(s,function(){var t,n,e,i,r,t=M(this),n=o.L$("host",t);for(o.JX=n,i=0,r=(e=o.h$).length;i<r&&n.menuName!==o.h$[r-i-1].name;i++)o.F$();o.P$(),o.G$(!1)}).bind(c,function(){o.JX=w,o.P$()}).bind(h,function(t){var n,n,e,n=M(this),n=o.L$("host",n);o.JX=n,(e=o.U$(!1,t))&&o.lQ()}),M(e).bind(T,function(t){var n,e,e;if(!t.target||M(t.target).attr(ct)!==ft){switch(t.keyCode){case 27:(n=o.F$())||o.lQ();break;case 32:case 13:(n=o.U$(!0,t))&&o.lQ();break;case 9:t.shiftKey?o.H$(!1,!0):o.H$(!0,!0);break;case 37:e=o.F$(),(e=o.L$("name",e))&&(o.JX=e),o.JX&&o.JX.menuItemData.group&&o.H$(!1,!0);break;case 38:o.H$(!1,!1);break;case 39:o.JX&&o.JX.menuItemData.group&&o.H$(!0,!0),o.G$(!0);break;case 40:o.H$(!0,!1)}t.preventDefault?t.preventDefault():t.returnValue=!1}})},R.prototype.z$=function(t,n){var e,i,r,o,a,i,u,s,c,f,u,l,h,d,n,h,v,m,g,p,m,b,d,c,f,w,o,y,e=this,i=e.w$(),r=i.contextTop,o=i.contextLeft,a=i.contextWidth,i=i.contextHeight,u=e.y$(),s=u.windowTop,c=u.windowLeft,f=u.windowWidth,u=u.windowHeight,l=n.parentRelatedLeft,h=n.parentRelatedTop,d=n.parentAbsoluteLeft,n=n.parentWidth;return t.css("top",h+2),h=t.width(),v=t.height(),m=t.position(),p=(g=t.offset()).top,m=m.top,d+n+h>C(c+f,o+a)?t.css("left",l-h-1):t.css("left",l+n),d=e.V$(),(c=e.U2(v))&&(f=M(t[0].firstChild),b=e.p$(t,f),v=e.b$()),"number"==typeof e.Kq&&(c?(w=b.r$())[0].style.maxHeight=e.Kq+"px":(t[0].style.maxHeight=e.Kq+"px",t.css(N,A),v=t.height())),(y=(o=C(s+u,r+i))-p)<v&&(d<v?t.css("top",s<r?0:s-r):t.css("top",m+o-p-v)),b},R.prototype.Y$=function(t){return t.command},R.prototype.getCommandOptions=function(t,n,e){},R.prototype.U$=function(t,n){var e,i,i,e=this,i=e.JX;if(i&&!i.menuItemData.disable){if(!(i=i.menuItemData).subMenu)return e.zA(n),!0;0<i.subMenu.length&&e.G$(t)}},R.prototype.zA=function(t){var n,e,i,t,r,n,o,a,u,s,c,t,n=this,e=n.JX,i=n.Y$(e.menuItemData);b(i)||(t=n.getCommandOptions(e.menuItemData,e.host[0],t),r=n.Qy,L(i)?i(n.DJ,t):(o=(n=(0,f.jf)(n.DJ))&&n.getActiveColumnIndex(),a=n&&n.getActiveRowIndex(),u=n&&n.tables&&n.tables.find(a,o),s=n&&n.pivotTables&&n.pivotTables.findPivotTable(a,o),c=e.menuItemData.name,b(s)?r.execute({cmd:i,sheetName:n&&n.name(),selections:n&&n.getSelections(),activeRow:a,activeCol:o,commandOptions:t,tableName:u?u.name():"",itemName:c}):(t=e.menuItemData.commandOptions,Dt(s,t=b(t)?{}:t,a,o,c),r.execute({cmd:i,sheetName:n.name(),selections:n.getSelections(),activeRow:a,activeCol:o,commandOptions:t,itemName:c}))))},R.prototype.KX=function(){M(r+D).unbind(s).unbind(c).unbind(h),M(e).unbind(T)},R.prototype.L0=function(){var t=this;t.Ti=w,t.c$=w,t.Qy=w,t.DJ=w,t.zX=w,t.f$=w,t.l$=w,t.JX=w,t.g$=w,t.d$=w,t.Wq&&(t.Wq.eG(),t.Wq=u),t.KX()},R.prototype.F$=function(){var t,t,n,e,t=this;if(1<t.h$.length)return(e=(n=(t=t.h$.pop()).menuView).find(r+D)).removeClass(_+p),t.menuView.hide(),t.subMenuWrapper&&(t.subMenuWrapper.eG(),t.subMenuWrapper=u),t.name},R.prototype.P$=function(){var t,n,e,i,r,t=this,n=t.Z$(!0);if(n){for(e=0,i=n.length;e<i;e++)n[e].host.removeClass(_+p);t.JX&&((r=t.JX.menuItemData).disable?t.JX.host.addClass(k(Q+p)):t.JX.host.addClass(_+p))}},R.prototype.lQ=function(){var t=this;t.zX.trigger(z),t.L0()},R.prototype.H$=function(t,n){var e,n,i,r,r,r,t,r,o,e,n,a,e=this,n=e.Z$(n);e.JX&&!(i=e.W$(e.JX,n))&&(r=e.l$[e.JX.menuItemData.group])&&(r=r[0],i=e.W$(r,n)),i=t?"number"==typeof(i=i!==u&&i!==n.length-1?i:-1)?i+1:0:"number"==typeof(i=i!==u&&0!==i?i:n.length)?i-1:0,e.JX=n[i],e.P$(),r=e.h$[e.h$.length-1],t=n.length,(r=r&&("menuView"===r.name?e.Wq:r.subMenuWrapper))&&(n=(e=(o=r.o$())+e.JX.host.position().top)+n[i].host.height()+2,a=r.r$().height(),e<o+12?0===i?r.o$(0):r.o$(e-12):o+a<n&&(i===t-1?r.o$(r.r$().height()):r.o$(e-12),r.o$(n-a)))},R.prototype.Z$=function(t){for(var n,e,i,r,o,a,u,n=this,e=n.h$[n.h$.length-1].name,i=n.l$[e],r=[],o=0;o<i.length;o++)if("groupHeader"===i[o].menuItemData.type)if(a=n.l$[i[o].menuItemData.name],t)for(u=0;u<a.length;u++)r.push(a[u]);else r.push(a[0]);else r.push(i[o]);return r},R.prototype.W$=function(t,n){for(var e,i,e=n.length,i=0;i<e;i++)if(t.name===n[i].name)return i},R.prototype.G$=function(t){var n,e,i,r,o,e,a,u,s,s,n=this,e=n.JX;e&&(i=e.menuItemData).subMenu&&0<i.subMenu.length&&(i.name!==n.h$[n.h$.length-1].name&&((r=n.d$[i.name]).show(),o=e.host,e=n.d$[e.menuName],a=o.offset(),u=o.position(),s=e&&e.position(),s=n.z$(r,{parentRelatedLeft:(s||u).left,parentRelatedTop:s?u.top+s.top:u.top,parentAbsoluteLeft:a.left,parentWidth:e?e.width():o.width()+3}),n.h$.push({name:i.name,menuView:r,subMenuWrapper:s})),n.JX=w,t)&&n.H$(!0,!1)},R.prototype.b$=function(){var t=this,n=t.V$();return n="number"==typeof t.Kq&&!1!==t.Qq?C(n,t.Kq):n},R.prototype.V$=function(){var t,n,e,i,e,t,r,t,t=this,n=t.hostInfo,e=t.w$(),i=e.contextTop,e=e.contextHeight,t=t.y$(),r=t.windowTop,t=t.windowHeight;return n?t:C(r+t,i+e)-P(r,i)},R.prototype.U2=function(t){var n,e,n=this;return!1!==n.Qq&&((e=n.b$())<t||void 0)},R.prototype.scrollable=function(t){var n=this;if(b(t))return n.Qq;n.Qq=t},R.prototype.maxHeight=function(t){var n=this;if(b(t))return n.Kq;(n.Kq=t)<0&&(n.Kq=void 0)},R.prototype.getHost=function(){return this.Ti},t.MenuView=R},"./dist/plugins/contextMenu/menuItems/helpers/utils.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.VIEWPORT=n.ICON_CLASS_PREFIX=void 0,n.ICON_CLASS_PREFIX="gc-spread-",n.VIEWPORT="viewport"},"./dist/plugins/contextMenu/menuItems/index.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/contextMenu/menuItems/report-sheet.js"),n)},"./dist/plugins/contextMenu/menuItems/report-sheet.js":function(t,n,e){"use strict";var f,i,l;function r(n){return["".concat(l,"AddRecord"),"".concat(l,"DeleteRecord"),"".concat(l,"Submit"),"".concat(l,"ResetCellValue")].map(function(t){return{text:n[t],name:t,command:t,iconClass:i.ICON_CLASS_PREFIX+t,workArea:i.VIEWPORT}})}function o(t,n,e){var n,i,r,o,a,u,n,n,e,s,r,c,n=n.getActiveSheetTab(),i;return n&&n._gi===f.SheetType.reportSheet?(u=a=o=r=void 0,e.worksheetHitInfo&&(r=n.isExpandable(e.worksheetHitInfo.row,e.worksheetHitInfo.col),o=n.internalIsDirtyCell(e.worksheetHitInfo.row,e.worksheetHitInfo.col),a=(n=n.getTemplate().getDataEntrySetting())&&n.length,u=-1===e.worksheetHitInfo.rowViewportIndex?f.SheetArea.colHeader:-1===e.worksheetHitInfo.colViewportIndex?f.SheetArea.rowHeader:f.SheetArea.viewport),r||(t=t.filter(function(n){return!n.name||!["AddRecord","DeleteRecord"].find(function(t){return n.name==="".concat(l).concat(t)})})),o||(n=t.find(function(t){return t.name==="".concat(l,"ResetCellValue")}))&&(n.disable=!0),a||(e=t.find(function(t){return t.name==="".concat(l,"Submit")}))&&(e.disable=!0),s=["gc.spread.filter","gc.spread.sort","gc.spread.insertComment"],r=t.filter(function(t){return!t.name||!s.includes(t.name)}),u!==f.SheetArea.rowHeader&&u!==f.SheetArea.colHeader||(c=["gc.spread.insertRows","gc.spread.deleteRows","gc.spread.hideRows","gc.spread.unhideRows","gc.spread.insertColumns","gc.spread.deleteColumns","gc.spread.hideColumns","gc.spread.unhideColumns","gc.spread.colHeaderinsertCopiedCells","gc.spread.rowHeaderinsertCopiedCells","gc.spread.colHeaderinsertCutCells","gc.spread.rowHeaderinsertCutCells"],r=r.filter(function(t){return!t.name||!c.includes(t.name)})),r):t.filter(function(t){return!t.name||0!==t.name.indexOf(l)})}Object.defineProperty(n,"__esModule",{value:!0}),n.filterReportSheetMenuItems=n.createReportSheetMenuItems=void 0,f=e("Core"),i=e("./dist/plugins/contextMenu/menuItems/helpers/utils.js"),l="reportSheet",n.createReportSheetMenuItems=r,n.filterReportSheetMenuItems=o},"./dist/plugins/data/binding.js":function(t,n,e){"use strict";var i,r,u,r,e,s,c,h,d,f,o,v,m,o,l,a,g,p;function b(t){this.rT=t}function w(t){this.Hc(t)}function y(t){var n=t&&t.H3;n&&n.Q$()&&i.Worksheet.et(t,"resetBinding",{sheet:t})}function M(t,n){var e=t&&t.H3;return!(!e||!e.Q$(n)||(t.clearPendingChanges(),i.Worksheet.et(t,"initBinding",{sheet:t,data:n}),0))}function C(t,n,e){var i,r,o,a,u,s,c,f,f,f,i,t,u,i=t,r=i._dataSource,o={value:h,hasBinding:!1};if(r)if(a=i.Mf,(u=i.K$)===m){if((f=a?a.getBindingPath(n,e):h)&&"object"!=typeof f)return{value:r.getValue(f),hasBinding:!0}}else{if(n<0||t.getRowCount()<=n)return o;if(f=(a||t).getColumnCount(),e<0||f<=e)return o;if(a?(i.J$||i.gTe(a.Ut.EE(!1,3)),(s=i.J$[e])&&(c=s.name)):t.Pq&&(i.J$?(s=i.J$[e])&&(c=s.dataField):c=t.Pq[e]),u)return f=v[u],t=x(i=s&&s.value)?i:h,u=a&&a.onItemGotten?a.onItemGotten.bind(a):d,f.getValue(r,t,c,n,e,u)}return o}function S(t,n,e,i){var r,o,a,u,s,c,f,l,l,l,u,r,r=t,o=r._dataSource,a=!1;if(o)if(u=r.Mf,(s=r.K$)===m)(l=u?u.getBindingPath(n,e):h)&&"object"!=typeof l&&(o.setValue(l,i),a=!0);else{if(n<0||t.getRowCount()<=n)return a;if(l=(u||t).getColumnCount(),e<0||l<=e)return a;u?(r.J$||r.gTe(u.Ut.EE(!1,3)),(c=r.J$[e])&&(f=c.name)):t.Pq&&(r.J$?(c=r.J$[e])&&(f=c.dataField):f=t.Pq[e]),s&&(l=v[s],r=x(u=c&&c.value)?u:h,a=l.setValue(o,r,f,n,e,i,d))}return a}function T(e){var i=h;return e&&(I(e)?i=m:u.each(v,function(t,n){if(n.isDataSource(e))return i=t,!1})),i}function A(t,n){return t&&n&&n!==m?v[n].getProperties(t):h}function I(t){return a&&t instanceof a}function x(t){return"function"==typeof t}function N(t,n,e){var i,r,o,a,u;if(t&&n)if(i=t[n],c(i))for(o=(r=n.split(".")).length,a=0;a<o&&(u=r[a],t);a++)a===o-1?x(t[u])?t[u](e):t[u]=e:t=x(t[u])?(c(t[u]())&&t[u]({}),t[u]()):(c(t[u])&&(t[u]={}),t[u]);else x(i)?t[n](e):t[n]=e}function k(t,n,e){var i,r,o,a,u;if(!t||!n)return h;if(i=t[n],!c(i))return x(i)?i():i;r=null,e?(r=e[n])||(r=n.split("."),e[n]=r):r=n.split("."),o=r.length,a=0;do{if(t=x(t[u=r[a]])?t[u]():t[u],c(t))return h}while(++a<o);return t}function _(){this.pathCache={}}Object.defineProperty(n,"__esModule",{value:!0}),n.X$=n.q$=n.setValueByPath=n.$$=n.CellBindingSource=void 0,i=e("Core"),r=e("Core"),u=r.GC$,r=e("Common"),e=e("./dist/plugins/data/data.ns.js"),s=u.isNumeric,c=r.Common.lt.ht,h=null,d=void 0,f="string",n.X$=o,v=n.X$=o={},m="cellBinding",o=new r.Common.ResourceManager(e.SR,"Bindings"),l=o.getResource.bind(o),i.Workbook.ch("binding",{onCultureChanged:function(){l()}}),b.prototype.setValue=function(t,n){N(this.rT,t,n)},b.prototype.getValue=function(t){return k(this.rT,t)},b.prototype.getSource=function(){return this.rT},a=b,n.CellBindingSource=a,w.prototype.bind=function(r,t){var n,e,i,t,i,o,a,n=this,e=n.Mf,i=n._dataSource;if(t&&n.ttt(t,{type:"bind",oldDataSource:i}),i&&(i.ntt&&(i.subscribe=i.ntt,delete i.ett,delete i.ntt),x(i.dispose))&&i.dispose(),n.itt(n.rtt),n.itt(n.ott),n.Hc(e),n._dataSource=r){if(!(t=n.K$=T(r)))throw new Error(l().Exp_NotSupportedDataSource);n.att=n.utt(),e&&u[u.sd]({jS:e.parent}),e&&(i=n.rtt,o=r.currentPosition,r.subscribe&&i.push(r.subscribe(n.stt,n)),o&&o.subscribe&&i.push(o.subscribe(n.ctt,n)),x(r.subscribe)&&!r.ntt&&(a=r.ntt=r.subscribe,r.ett=!1,r.subscribe=function(t,n){var e,i,e=[].concat.apply([],arguments),i;return e[0]=function(){if(!r.ett&&x(t))return t.apply(n,arguments)},a.apply(r,e)}),n.RA(),n.Mf.Ut.Spe()),n.Pq=A(r,t)}return M(e,r)},w.prototype.RA=function(){var t,n,e,i,r,i,o,a,t=this,n=t.Mf,e=t._dataSource;if(n&&e&&(i=t.K$,t.itt(t.ott),r=h,i!==m&&(i=n.getActiveRowIndex(),r=e.currentPosition?(-1<=i&&i<e.count()&&e.currentPosition(i),e.currentItem()):t.ftt(i)),r))for(a in o=function(){n&&n.repaint()},r)r[a]&&x(r[a].subscribe)&&t.ott.push(r[a].subscribe(o,h,h))},w.prototype.itt=function(t){var n,e;if(t)for(n=0;n<t.length;n++)(e=t[n])&&x(e.dispose)&&e.dispose()},w.prototype.getRowCount=function(){var t,n,t,e,t=this,n=t._dataSource,t=t.K$,e=0;return e=n&&t&&t!==m?v[t].getDataLength(n):e},w.prototype.getColumnCount=function(){var t,t,t,t,t=this.Pq;return t?t.length:(t=this._dataSource)&&(t=t[0],"null"===(t=u.getType(t))||t===f||"number"===t)?1:0},w.prototype.getSource=function(){return this._dataSource},w.prototype.ltt=function(){return this.Pq},w.prototype.htt=function(t){this.Pq=t},w.prototype.ftt=function(t){var n=this._dataSource,e=this.K$,i=h;return i=n&&e&&e!==m?v[e].getDataItem(n,t):i},w.prototype.utt=function(){var t,n,e,i,t=this;if(!t.att)for(n=t.getRowCount(),e=0;e<n;e++)if(i=t.ftt(e)){t.att=i.entityAspect&&i.entityType||i.constructor;break}return t.att},w.prototype.getValue=function(t,n){return C(this,t,n)},w.prototype.setValue=function(t,n,e,i){var r,o,r=this;return i&&(o=C(r,t,n).value,r.ttt(i,{type:"setValue",row:t,col:n,oldValue:o})),S(r,t,n,e)},w.prototype.pTe=function(){return this.J$},w.prototype.gTe=function(t,n){var e,i,e=this;n&&(i=e.J$,e.ttt(n,{type:"setColumnBindingInfo",oldColumnBindingInfo:i,columnBindingInfo:t})),e.J$=t},w.prototype.dtt=function(){var t=v[this.K$];return t&&t.canAdd&&t.canAdd()},w.prototype.vtt=function(){var t=v[this.K$];return t&&t.canInsert&&t.canInsert()},w.prototype.mtt=function(){var t=v[this.K$];return t&&t.canRemove&&t.canRemove()},w.prototype.allowSetCount=function(){var t,t,t=this.K$;return t===m||(t=v[t])&&t.allowSetCount&&t.allowSetCount()},w.prototype.kE=function(t,n,e){var i,r,o,a,i=this,r=i._dataSource;!r||t>i.getRowCount()||(o=i.K$,a=i.utt(),o&&o!==m&&!i.gtt&&(i.ptt=!0,e&&i.ttt(e,{type:"addItems",row:t,rowCount:n}),v[o].addItems(r,t,n,a,d),i.ptt=!1))},w.prototype.btt=function(t,n,e){var i,r,o,a,o,o,r,i=this,r=i.K$,o=i.getRowCount(),a=i._dataSource;!a||o<=t||r&&r!==m&&!i.gtt&&(i.ptt=!0,o=(o=i.Mf)&&o.onItemRemoved?o.onItemRemoved.bind(o):d,r=v[r].removeItems(a,t,n,o),e&&r&&0<r.length&&i.ttt(e,{type:"removeItems",row:t,removedItems:r}),i.ptt=!1)},w.prototype.ytt=function(t,n){var e,i,e,e=this,i=e._dataSource,e=e.K$;v[e].undoRemoveItems(i,t,n)},w.prototype.Q$=function(t){return I(t||this._dataSource)},w.prototype.Hc=function(t){var n=this;n._dataSource=h,n.K$="",n.att=h,n.Pq=h,n.rtt=[],n.ott=[],n.J$=h,y(n.Mf=t)},w.prototype.stt=function(t){var n,e,i,r,o,a,n=this,e=n.Mf;if(e&&!n.ptt){if(t){if(n.gtt=!0,!isNaN(t.length)&&(e.setRowCountCore(t.length),i=e.Ut,c(n.Pq))&&0===i._E(!1,3)&&(n.Pq=A(n._dataSource),e.setColumnCount(n.getColumnCount()),r=n.ltt()))for(o=0,a=r.length;o<a;o++)i.do("setItem",!1,3,o,{name:r[o]});n.gtt=!1}e.zw()}},w.prototype.ctt=function(){var t,n,t,t,t=this,n=t.Mf,t=t._dataSource;n&&t&&t.currentPosition&&(t=t.currentPosition(),n.ui!==t)&&(n.t4(t,n.ci,d,d,2),n.zw())},w.prototype.ttt=function(t,n){var e,e;this.Mf&&this.Mf.Ut&&!c(this.Mf.Ut.P8)&&this.Mf.Ut.P8<=0||(e=(e=t.bindingChanges)||(t.bindingChanges=[]),n.bindingManager=this,e.push(n))},w.prototype.wtt=function(t){var n,e,i,n=this,e=t.type,i=t.row;"bind"===e?n.bind(t.dataSource):"setValue"===e?n.setValue(i,t.col,t.value):"addItems"===e?n.kE(i,t.rowCount):"removeItems"===e?n.btt(i,t.rowCount):"setColumnBindingInfo"===e&&n.gTe(t.columnBindingInfo)},w.prototype.Mtt=function(t){var n,e,i,n=this,e=t.type,i=t.row;"bind"===e?n.bind(t.oldDataSource):"setValue"===e?n.setValue(i,t.col,t.oldValue):"addItems"===e?n.btt(i,t.rowCount):"removeItems"===e?n.ytt(i,t.removedItems):"setColumnBindingInfo"===e&&n.gTe(t.oldColumnBindingInfo)},w.prototype.toJSON=function(){var t,n,t=this._dataSource;return t?{type:n=this.K$,source:t=n===m?t.getSource():v[n].toJSON(t)}:h},w.prototype.fromJSON=function(t){var n,t,e,n=t&&t.source;n&&(e=void 0,e=(t=t.type)===m?new a(n):v[t].fromJSON(n))&&this.bind(e)},n.$$=w,n.setValueByPath=N,n.q$=k,_.prototype.isDataSource=function(t){return u.isArray(t)},_.prototype.getDataLength=function(t){return t.length},_.prototype.getDataItem=function(t,n){return t[n]},_.prototype.addItems=function(t,n,e,i){for(var r,o,r=0;r<e;r++)o={},i&&(o=i.createEntity?i.createEntity():new i),t.splice(n,0,o)},_.prototype.removeItems=function(t,n,e){var i=this.getDataLength(t);if(n<i)return t.splice(n,Math.min(e,i-n))},_.prototype.undoRemoveItems=function(t,n,e){for(var i=0,r=e.length;i<r;i++)t.splice(n+i,0,e[i])},_.prototype.getProperties=function(t){var n,e,i,r,n=t.length,e=h;if(0<n)for(r in e=[],i=t[0])x(i[r])||e.push(r);return e},_.prototype.getValue=function(t,n,e,i,r){var o=h,a=!1,t=this.getDataItem(t,i);return c(t)||(n?u.isEmptyObject(t)||(o=n(t),a=!0):e?(o=k(t,e,this.pathCache),a=!0):typeof t!=f&&!s(t)||0!==r||(o=t,a=!0)),{value:o,hasBinding:a}},_.prototype.setValue=function(t,n,e,i,r,o){var a=!1,u=this.getDataItem(t,i);return c(u)||(n?(u[e]=o,n(u,o),a=!0):e?(N(u,e,o),a=!0):typeof u!=f&&!s(u)||0!==r||(t[i]=o,a=!0)),a},_.prototype.fromJSON=function(t){return t},_.prototype.toJSON=function(t){return t},v.defaultBindingSource=new _},"./dist/plugins/data/data.dataview.js":function(t,n,e){"use strict";var i,r,u,s,o;function a(){}Object.defineProperty(n,"__esModule",{value:!0}),n.X$=void 0,i=e("Common"),r=e("./dist/plugins/data/binding.js"),Object.defineProperty(n,"X$",{enumerable:!0,get:function(){return r.X$}}),u=i.Common.lt.ht,s=null,a.prototype.isDataSource=function(t){var n=window.wijmo;return n&&n.data&&n.data.isDataView&&n.data.isDataView(t)},a.prototype.getDataLength=function(t){return t.count()},a.prototype.getDataItem=function(t,n){return t.item(n)},a.prototype.addItems=function(t,n,e,i){if(i)for(var r=0;r<e;r++)t.ett=!0,t.add(i.createEntity?i.createEntity():new i),t.ett=!1,t.commitEdit()},a.prototype.removeItems=function(t,n,e){var i,r,o,a,u,i=this.getDataLength(t);if(n<i){for(r=[],o=Math.min(e,i-n),a=0;a<o;a++)u=t.item(n),t.remove(u),r.push(u);return r}},a.prototype.undoRemoveItems=function(t,n,e){for(var i,r,o,i=t.getSource(),r=0,o=e.length;r<o;r++)i.splice(n+r,0,e[r]);t.refresh()},a.prototype.getProperties=function(t){var n,e,i,r,n=0,e=s,i=t.getProperties();if(i&&0<i.length)for(n=i.length,e=[],r=0;r<n;r++)e.push(i[r].name);return e},a.prototype.canInsert=function(){return!1},a.prototype.getValue=function(t,n,e,i,r){var o=s,a=!1,i=this.getDataItem(t,i);return u(i)||(n?(o=n(i),a=!0):e&&(o=t.getProperty(i,e),a=!0)),{value:o,hasBinding:a}},a.prototype.setValue=function(t,n,e,i,r,o){var a=!1,i=this.getDataItem(t,i);return u(i)||(n?(n(i,o),a=!0):e&&(t.setProperty(i,e,o),a=!0)),a},a.prototype.fromJSON=function(t){return t},a.prototype.toJSON=function(t){return t.local},r.X$.dataViewBinding=new a},"./dist/plugins/data/data.entry.js":function(t,n,e){"use strict";var i,r,o,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.q$=n.setValueByPath=n.$$=n.CellBindingSource=void 0,e("./dist/plugins/data/worksheet-databind.js"),o=e("./dist/plugins/data/binding.js"),Object.defineProperty(n,"CellBindingSource",{enumerable:!0,get:function(){return o.CellBindingSource}}),Object.defineProperty(n,"$$",{enumerable:!0,get:function(){return o.$$}}),Object.defineProperty(n,"setValueByPath",{enumerable:!0,get:function(){return o.setValueByPath}}),Object.defineProperty(n,"q$",{enumerable:!0,get:function(){return o.q$}}),r(e("./dist/plugins/data/data.ko.js"),n),r(e("./dist/plugins/data/data.dataview.js"),n),r(e("./dist/plugins/data/data.ns.js"),n)},"./dist/plugins/data/data.ko.js":function(t,n,e){"use strict";var m,i,s,c,g,o,f,l,u,p,a,r,e;function h(){}Object.defineProperty(n,"__esModule",{value:!0}),n.X$=void 0,m=e("Core"),i=e("Common"),s=e("./dist/plugins/data/binding.js"),Object.defineProperty(n,"X$",{enumerable:!0,get:function(){return s.X$}}),c=i.Common.lt.ht,g=m.GC$,o=g.isFunction,f=g.getType,l=g.isNumeric,u=null,p="string",a=window.ko,h.prototype.isDataSource=function(t){return a&&a.isObservable(t)},h.prototype.getDataLength=function(t){return t().length},h.prototype.getDataItem=function(t,n){return t()[n]},h.prototype.addItems=function(t,n,e,i){for(var r,o,r=0;r<e;r++)o={},i&&(o=i.createEntity?i.createEntity():new i),t.splice(n,0,o)},h.prototype.removeItems=function(t,n,e){var i=this.getDataLength(t);if(n<i)return t.splice(n,Math.min(e,i-n))},h.prototype.undoRemoveItems=function(t,n,e){for(var i=0,r=e.length;i<r;i++)t.splice(n+i,0,e[i])},h.prototype.getProperties=function(t){var t,n,e,i,r,t=t(),n,e=[];if(0<t.length)for(r in i=t[0])(!o(i[r])||a&&a.isObservable(i[r]))&&e.push(r);return e},h.prototype.getValue=function(t,n,e,i,r){var o=u,a=!1,t=this.getDataItem(t,i);return c(t)||(n?(o=n(t),a=!0):e?(o=(0,s.q$)(t,e),a=!0):f(t)!==p&&!l(t)||0!==r||(o=t,a=!0)),{value:o,hasBinding:a}},h.prototype.setValue=function(t,n,e,i,r,o){var a=!1,u=this.getDataItem(t,i);return c(u)||(n?(n(u,o),a=!0):e?((0,s.setValueByPath)(u,e,o),a=!0):f(u)!==p&&!l(u)||0!==r||(t()[i]=o,a=!0)),a},h.prototype.fromJSON=function(t){return a?a.observableArray(t):u},h.prototype.toJSON=function(t){return t()},s.X$.koBinding=new h,a&&((e=a.bindingHandlers)["gc-spread-sheets"]=e["gcspread-sheets"]=e.wijspread={init:function(t,n,e,i){var n,r,o,a,u,s,c,f,l,h,d,v;if(!g(t).data("workbook")&&(r=(n=n())&&n.sheets,o=new m.Workbook(g("#"+t.id)[0],n),r)){for(u=a=void 0,s=r.length,c=o.getSheetCount();c<s;)a=o.S2(o.T2(c)),o.A2(c,0,a),c=o.getSheetCount();for(f=0;f<s;f++)a=o.getSheet(f),l=(u=r[f]).name,h=u.autoGenerateColumns,d=u.data,v=u.columns,typeof l==p&&0<l.length&&a.ub(l),"boolean"==typeof h&&(a.autoGenerateColumns=h),d&&a.setDataSource(d),v&&0<v.length&&(a.autoGenerateColumns=!1,a.bindColumns(v))}},update:function(t,n,e,i){}})},"./dist/plugins/data/data.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/data/data.res.en.js");n.SR={en:e}},"./dist/plugins/data/data.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_NotSupportedDataSource=void 0,n.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(t,n,e){"use strict";var v,n,c,h,s,e,i,d,o,a,m,r;function u(t,n,e){t.Ut.do("setItem",!1,3,n,e="string"==typeof e?{name:e}:e);var i=e&&e.formatter,r=e&&e.cellType;i&&t.setFormatter&&t.setFormatter(-1,n,i),r&&t.setCellType(-1,n,r),e&&!h(e.width)&&t.setColumnWidth(n,e.width)}function f(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,h,a=t.H3,u="dataManagerBindingSource"===a.K$,s=t.NMi;if(s&&s._gi===v.SheetType.ganttSheet){for(c=0;c<e;c++)if(!s.zDi(c))for(f=0;f<i;f++)l=s.Rpi(c,f),o?t.c8(n,c,f,l,r):t.s8(n,c,f,l,u)}else for(c=0;c<e;c++)for(f=0;f<i;f++)d=(h=a.getValue(c,f)).value,h&&h.hasBinding&&(m.W0(h=d)&&(h=m.Q0(d)),o?t.c8(n,c,f,h,r):t.s8(n,c,f,h,u))}function l(t,n,e,i){var t=t.getSpan(n,e,i);return!(!t||t.row===n&&t.col===e)}function g(t,n,e,i){for(var r,o,a,u,s,u,r=t.options.colHeaderAutoTextIndex,o=0;o<e;o++)if(0<=r&&o===r||-1===r&&o===e-1)for(a=0;a<i;a++)u=n[o]&&n[o][a]&&n[o][a].value,s=t.Ut.q_(!1,3,a),h(u)&&s&&!l(t,o,a,1)&&(u=s.displayName||s.name)&&t.s8(n,o,a,u)}function p(t,n){var t,e;return"Object"===n.constructor.name&&(t=t.findByName(n.tableName))&&(t.H3?n=t.H3:((e=new c.$$).fromJSON(n),t.H3=n=e)),n}Object.defineProperty(n,"__esModule",{value:!0}),v=e("Core"),n=e("Common"),c=e("./dist/plugins/data/binding.js"),h=n.Common.lt.ht,s=v.GC$.isEmptyObject,e=v.GC$.extend,i=v.Worksheet.prototype,d=null,o="bindingPath",a=new RegExp("^\\d*(\\.\\d+)?\\*$"),m=n.Common.ct,e(i,r={getDataSource:function(){var t=this.H3;return t?t.getSource():d},setDataSource:function(t,n){var e,i,r,o,a,u,s,n,t,e=this,i=e.H3;if(i&&(i.getSource()!==t||e.NMi)){if(e.suspendPaint(),n&&e.sF(),e.suspendCalcService&&e.suspendCalcService(),t){if(r=e.Ut,(i=e.H3).Ctt=!0,!(o=i.bind(t,r.G8))){if(e.setRowCountCore(i.getRowCount()),e.autoGenerateColumns&&(e.setColumnCount(i.getColumnCount()),a=i.ltt()))for(u=0,s=a.length;u<s;u++)r.do("setItem",!1,3,u,{name:a[u]});r.yge(0,0,e.getRowCount(),e.getColumnCount())}}else e.H3=new c.$$(e);e.clearPendingChanges(),n=!1,i&&i.Ctt&&(n=i.Stt,delete i.Stt,delete i.Ctt),e.recalcAll&&e.recalcAll(n),e.resumeCalcService&&e.resumeCalcService(n),(t=e.ST())&&t.DS===e&&t.c5(),e.resumePaint()}},bindColumn:function(t,n){var e=this;e.suspendPaint();try{u(e,t,n)}finally{e.resumePaint()}},bindColumns:function(t){var n,e,i,r,o,n=this;n.suspendPaint();try{if(t)for(e=t.length,isNaN(e)||n.setColumnCount(e),i=0;i<e;i++)o=(r=t[i]).size,a.test(o)&&(r.starSize=o),u(n,i,r)}finally{n.resumePaint()}},getDataItem:function(t){var n,e,i,r,o,a,u,s,n=this,e=n.H3;if(!e||0===e.getRowCount())return d;if(i=n.getColumnCount(),r={},o=e.ftt(t))for(a in o)o.hasOwnProperty(a)&&"function"!=typeof a&&(r[a]=o[a]);for(u=0;u<i;u++)(s=n.Ut.q_(!1,3,u))&&s.name&&0<s.name.length&&h(r[s.name])&&(r[s.name]=n.getValue(t,u));return r},getDataColumnName:function(t){var n,n,n=this;return 0<=t&&t<n.getColumnCount()&&n.getDataSource()?(n=n.Ut.q_(!1,3,t))&&(n.displayName||n.name):d},getBindingPath:function(t,n){return this.Ut.getValueForKey(t,n,o)},setBindingPath:function(t,n,e){var i=this,r=i.Ut;return r.do("setValueForKey",t,n,o,e),r.gge(t,n,!e),i.ki(v.Events.WorksheetDataChanged,{type:"bindingPath"}),i.zw(),i}}),v.CellRange.prototype.bindingPath=v.CellRange.p0(i.getBindingPath,i.setBindingPath),v.Worksheet.ch("binding",{init:function(){var t=this;t.autoGenerateColumns=!0,t.H3=new c.$$(t)},dispose:function(t){var n;!1!==t.clearCache&&(this.H3=d)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,c,f,l,n=this,e=t.changeType,i=t.row,r=t.rowCount,o=t.sheetArea;if(h(o)||3===o||2===o)if(a=n.H3,"addingRows"===e)a&&!1===a.dtt()?t.canAdd=!1:a&&!1===a.vtt()&&(t.newRow=n.getRowCount());else if("addRows"===e)a&&a.kE(i,r,n.Ut.G8);else if("deletingRows"===e){if(a)if(!1===a.mtt())t.canDelete=!1;else for(n.aj||(n.aj=[]),u=n.aj,s=n.Ut,c=a.getRowCount(),f=0;f<r&&i+f<s.getRowCount();f++)l=d,i+f<c&&(l=a.ftt(i+f)),u.push({row:i+f,data:l})}else"deleteRows"===e?a&&a.btt(i,r,n.Ut.G8):"settingRowCount"!==e||!a.getSource()||a.allowSetCount()||3!==o&&2!==o||(t.canSet=!1)},toJson:function(t,n){var e,i,r,n,r,o,e=this,i=e.getColumnCount(),r=e.getDataSource();n&&n.includeBindingSource&&r&&(f(e,n=t.data.dataTable||{},e.getRowCount(),i),s(n)||(t.data.dataTable=n),g(e,r=t.colHeaderData.dataTable||{},e.getRowCount(1),i),s(r)||(t.colHeaderData.dataTable=r)),!0!==(o=e.autoGenerateColumns)&&(t.autoGenerateColumns=e.autoGenerateColumns)},fromJson:function(t,n){var e,i,r,o,r,e=this;e.H3=new c.$$(e),n&&(i=e.H3,r=t.dataSource,o=t.dataBinding,r&&i.bind(r),o)&&i.fromJSON(o,n),r=t.autoGenerateColumns,h(r)||(e.autoGenerateColumns=r)},preFromJson:function(){this.H3=new c.$$(this)},wh:function(t,n,e){var i,r,o,a,e,u,i=this,r=i.getColumnCount(),o=i.getDataSource(),a=t.lossless;a=a||(t.lossless={}),e&&e.includeBindingSource&&o&&(f(i,t,i.getRowCount(),r,n.sharedStrings,!0),g(i,e=a.colHeaderData.dataTable||{},i.getRowCount(1),r),s(e)||(a.colHeaderData.dataTable=e)),!0!==(u=i.autoGenerateColumns)&&(a.autoGenerateColumns=i.autoGenerateColumns)},yh:function(t){var n,t,n=this;n.H3=new c.$$(n),t=t.lossless&&t.lossless.autoGenerateColumns,h(t)||(n.autoGenerateColumns=t)}}),v.Y8.ch("binding",{priority:6e3,isValid:function(t){var n,t,n,t=-1<["getValue","setValue"].indexOf(t),n=null==(n=this.Mf.H3)?void 0:n._dataSource;return!t||n},getValue:function(t){var n,e,i,r,i,r,n=t.row,e=t.col,i=t.sheetArea,r=this.Mf.H3;3===i&&r&&r._dataSource&&(i=r.getValue(n,e),t.isValueGet=i.hasBinding,r=i.value,1!==t.valueType&&(r=v.mt.wt(r)),t.value=r)},setValue:function(t){var n,e,i,r,o,a,u,u,s,n=t.row,e=t.col,i=t.value,r=t.sheetArea,o=this.Mf,a=o.H3;3===r&&a&&a._dataSource&&(u=a.getValue(n,e)).hasBinding&&(i!==(u=u.value)?(o.isDirtySuspended()||(s=o.getDataItem(n),this.dE(n,e,{gE:s,d6:u},r)),t.isValueSet=a.setValue(n,e,i,o.Ut.G8)):t.isValueSet="dataManagerBindingSource"!==a.K$)},applyChanges:function(t){var n,t,e,i,r,o,n=t.changes,t=t.isUndo,e=n&&n._bindingChanges;if(e)if(t)for(i=e.length-1;0<=i;i--)(r=e[i]).bindingManager&&(o=p(this.Mf.tables,r.bindingManager)).Mtt(r);else for(i=0;i<e.length;i++)r=e[i],(o=p(this.Mf.tables,r.bindingManager)).wtt&&o.wtt(r)},undoValue:function(t){var n,e,i,n=t.bindingChanges;if(n)for(e=n.length-1;0<=e;e--)(i=n[e]).bindingManager.Mtt(i)}})},"./dist/plugins/dragMerge/dragMerge-action.js":function(t,n,e){"use strict";var i,s,e,r,o,c,a,u,f;function l(t,n){return t.JS(n)}function h(t,n){return f.call(this,t,n)||this}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Commands=void 0,s=e("Core"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return s.Commands}}),e=s.Commands.ActionBase,r=s.Commands.zA,o="dragMerge",c=Math.max,i(h,f=e),h.prototype.canExecute=function(){var t,n,e,n,n,t=this.Mf,n=this.tT,e=l(t,n.oldSelection),n=l(t,n.newSelection);if(e.equals(n)){if((n=t.getSpan(e.row,e.col))&&e.equals(n))return!1;if(1===e.rowCount&&1===e.colCount)return!1}return!0},h.prototype.canUndo=function(){var t,t,t=s.Commands.TI(this.Mf.name()),t=this.tT[t];return s.Commands.AI(t)},h.prototype.undo=function(){var t,n,e,t=this;if(!t.canUndo())return!1;n=t.Mf,t.X5(n,!0),e=s.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0)},h.prototype.execute=function(){var t,n,e,i,r,i,o,a,r,u,t=this,n=t.Mf,e=t.tT,i=e.oldSelection,r=e.newSelection;if(!t.canExecute())return!1;n.Ut.startTransaction(),t.X5(n,!0),n.Ut.do("clearSpan",i.row,i.col,i.rowCount,i.colCount),i=r.row,o=r.col,a=r.rowCount,r=r.colCount,n.addSpan(i,o,a,r),n.setSelection(i,o,c(a,1),c(r,1)),t.q5(n,!0),e[u=s.Commands.TI(n.name())]=n.Ut.endTransaction()},a=h,s.Commands[o]={canUndo:!0,execute:function(t,n,e){return r(t,a,n,e)}},s.Commands.Ttt=function(t){t.register(o,s.Commands[o])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(t,n,e){"use strict";var i,n,l,u,h,p;function s(t,n){t.ki(i.Events.DragMerging,n)}function c(t,n){t.ki(i.Events.DragMerged,n)}Object.defineProperty(n,"__esModule",{value:!0}),n=(i=e("Core")).GC$,l=null,u=void 0,h=Math.abs,p=i.Ec,n.extend(i.nk.prototype,{Att:function(t){var n,e,i,r,n,e,i=t,r=this.Mf.Ut.findSpan(t.row,t.col);return i=r&&r.containsRange(t)?r:i},zL:function(t,n,e){var i,r,o,a,u,s,c,f,r,o,i,a,r,i=this.Mf,r=i.parent,o=i.U5(),a=i.Dn,u=4,s=8,c=2,f=4;if(r&&r.options.allowUserDragMerge&&o&&!i.Oi&&a.Itt){if(o=(r=a.Itt).x,i=r.y,a=r.width,r=r.height,h(o+a-n)<=2&&h(i+r/2-e)<=4)return{right:!0};if(h(o+a/2-n)<=4&&h(i+r-e)<=2)return{bottom:!0}}return l},pk:function(t){var n,t,e,i,i,r,o,a,u,n=this;n.ab=!0,n.rb=!0,n.Uk=!0,n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.xtt=t.dragMergeInfo,e=(t=n.Mf).Ut,i=t.U5(),n.Ntt=n.Att(i),r=(i=t.JS(n.Ntt)).row,o=i.col,a=i.rowCount,u=i.colCount,e.GT(r,o,a,u)?(n.rb=!1,n.Uk=!1):(n.ktt=t.Ut.getSpans(i),t.suspendPaint(),e.do("clearSpan",r,o,a,u),t.resumePaint(),n.Dtt=i,n._tt(),n.Ett(i),n.Ok())},Hk:function(){var t,n,e,e,i,r,n,r,n,e,i,t=this,n=t.Mf,e=n.parent;e&&!e.options.allowUserDragMerge?t.ND():(e=t.Q9(),i=t.K9(),r=t.Dtt||t.Ntt,n=n.JS(r),0<=e&&0<=i&&(r=t.xtt,n=t.jtt(n,e,i,r),e=(t.Ott=n).rowCount,i=n.colCount,0<e)&&0<i&&(t._tt(),t.Ett(n),t.Dtt=n,t.a9()))},_tt:function(){var t,n,n,t=this.Mf,n=this.Dtt;n&&((n=t.j1(n)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},jtt:function(t,n,e,i){var r,o,a,u,s,t,c,f,l,h,d,v,m,g,r,o=this.Mf,a=t.row,u=t.col,s=t.rowCount,t=t.colCount;return i.right?(h=e-(f=u)+1,d=c=a,v=u+t,m=l=s,g=e-u-t+1):i.bottom&&(l=n-(c=a)+1,d=a+s,v=f=u,m=n-a-s+1,g=h=t),o.Ut.eE(d,v,m,g)&&(c=a,f=u,l=s,h=t),p(c,f,l,h)},ND:function(){var t,n,e,i,r,o,a,t,e,t=this,n=t.Mf,e=n.parent,i=t.ktt,r=t.Ntt,o=t.Ott||r;t.ab=!1,t.rb=!1,t.Uk=!1,t.Ott=u,t.ktt=u,t.Dtt=u,t.Ntt=u,t.l9(),e&&e.options.allowUserDragMerge&&(a=n.Ut,n.suspendPaint(),0<i.length&&i.forEach(function(t){a.do("addSpan",t)}),n.resumePaint(),t={sheetName:n.name(),sheet:n,mergeRange:o,cancel:!1},s(n,t),t.cancel||(e={cmd:"dragMerge",sheetName:n.name(),oldSelection:r,newSelection:o},n.Qy().execute(e),c(n,{sheetName:n.name(),sheet:n,mergeRange:o})))},Ett:function(t){var n,e,i=this.Mf.Dn,r;(0,i.Rtt)(i,t)}})},"./dist/plugins/dragMerge/dragMerge.entry.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/dragMerge/dragMerge-action.js"),e("./dist/plugins/dragMerge/dragMerge.js"),e("./dist/plugins/dragMerge/dragMerge-event.js")},"./dist/plugins/dragMerge/dragMerge.js":function(t,n,e){"use strict";var w,n,i,f,e,r,o,a;function l(t){var t=t.parent;return t&&t.options.backColor||r}function u(t,n,e){var i,i,e,t,n,i=t.C0(e.row);if((1===i||i!==t.C0(e.row+e.rowCount-1))&&0<(i=t.dw(1)).length)return e=n.y+n.height/2,t=i[0],n=i[i.length-1],t.y<=e&&e<=t.y+t.height||n.y<=e&&e<=n.y+n.height?1:void 0}function s(t,n,e){var i,i,e,t,n,i=t.S0(e.col);if((1===i||i!==t.S0(e.col+e.colCount-1))&&0<(i=t.yw(1)).length)return e=n.x+n.width/2,t=i[0],n=i[i.length-1],t.x<=e&&e<=t.x+t.width||n.x<=e&&e<=n.x+n.width?1:void 0}function y(t,n,e){var n,i,r,o,a,t,i=t.Fi(),r=t.Gy(i),o=t.Sy(i),a=u(t,n,e),t=s(t,n,e),n=1===a&&1===t?i.c9(a,t):1===a?new w.Rect(i.b6,i.Cy,i.F6+r+i.zy,o):1===t?new w.Rect(i.Py,i.T6,r,i.L6+o+i.Iy):new w.Rect(i.b6,i.T6,i.F6+r+i.zy,i.L6+o+i.Iy);return n}Object.defineProperty(n,"__esModule",{value:!0}),w=e("Core"),n=e("Common"),i=e("./dist/plugins/dragMerge/dragMerge-action.js"),f=n.Common.ft,e=w.GC$,r="white",e.extend(w.g7.prototype,{Btt:function(t,n){var e,i,r,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,i,c,e=this,i=e.Mf,r=i.rt;(0,w.needPaintSelection)(i)&&(c=(r=i.j1(r.Att(n))).x,f=r.y,l=r.width,h=r.height,b=y(i,p=new w.Rect(d=c+l-(u=2),v=f+h/2-(s=o=4),m=4,g=a=8),n),c=y(i,i=new w.Rect(d=c+l/2-4,v=f+h-2,m=8,g=4),n),e.Itt=r,e.Ltt(t,p,i,b,c))},Ltt:function(t,n,e,i,r){var o,a=this.Mf,a=w.Pf.vl(a,a.getSelectionBorderColor());t.save(),t.fillStyle=a,i&&(t.rect(i.x,i.y,i.width,i.height),t.clip()),t.beginPath(),t.rect(n.x,n.y,n.width,n.height),t.fill(),t.restore(),t.save(),t.fillStyle=a,r&&(t.rect(r.x,r.y,r.width,r.height),t.clip()),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.fill(),t.restore()},Rtt:function(t,n){var e,i,r,o,t,a,u,o,s,o,s,o,s,o,s,r,i,c,s,e=t,i=e.Mf,r=i.parent,o=i.rt,t=t.J(),a=2,u=1;r&&r.options.allowUserDragMerge&&o.Uk&&(o=i.getActiveRowIndex(),s=i.getActiveColumnIndex(),s=(o=i.getActualStyle(o,s))&&o.backColor,o=l(i),(s=f._(w.Pf.vl(i,s||o))).a*=.6/255,t.fillStyle=f.j(s),t.strokeStyle=w.Pf.vl(i,i.getSelectionBorderColor()),t.lineWidth=2,t.beginPath(),o=r.SC,r=(s=i.j1(n)).x,i=s.y,c=s.width,s=s.height,2007<o?(t.rect(r,i,c-1,s-1),t.strokeRect(r-1,i-1,c+1,s+1)):(t.rect(r+1,i+1,c-2-.5,s-2-.5),t.strokeRect(r-.5,i-.5,c,s)),t.fill(),t.restore(),e.Btt(t,n))}}),w.Workbook.ch("dragMerge",o={init:function(){i.Commands.Ttt(this.commandManager())}}),w.Worksheet.ch("dragMerge",a={paintAdornment:function(t){var t,n,e,i,i,t=t.ctx,n=this,e=n.Dn,i=n.Ut.getSelections();n.parent&&n.parent.options.allowUserDragMerge&&1===i.length&&!n.Oi&&(i=n.U5(),e.Btt(t,i))}})},"./dist/plugins/fill/drag-fill.js":function(y,t,n){"use strict";var e,l,N,h,t,n,u,k,_,A,d,n,I,x,i,f,T,a,D,j,O,E,v,r,o,s,t,m,M,c,C,S,g,G,U,H;function R(t){return t.rowCount}function F(t){return t.colCount}function L(t,n){return t.getRowCount(n)}function B(t,n){return t.getColumnCount(n)}function V(t,n,e,i){return t&&n&&n.containsRange(t)&&(!k(e)&&(1===e&&t.row===n.row&&R(t)===R(n)||0===e&&t.col===n.col&&F(t)===F(n))||!(k(i)||(2!==i&&3!==i||t.col!==n.col||F(t)!==F(n))&&(0!==i&&1!==i||t.row!==n.row||R(t)!==R(n))))}function p(t,n){var e,i,r,o,a,u,s,c,f,l,s,e=G.call(this)||this,i=e,r=n[E],o=0===r,a=o||1===r,u=n[j],s=n[D],c=s.row,f=s.col,l=R(s),s=F(s);return i.Mf=t,4===(i.Ftt=n)[O]?i.Ptt=new N.Commands.JI(t,{ranges:[n[j]]}):i.Gtt=a?d(c,o?u.col:f,l,s+F(u)):d(2===r?u.row:c,f,l+R(u),s),i.Utt=a?1:0,e}function b(t,n){var e,i,e=U.call(this)||this,i=e;return i.Mf=t,i.Htt=n,i.ztt=n[D],i.Vtt=n[j],i.Ytt=n[O],i.Ztt=n[E],e}function P(t,n,e,i,r,o){var a,i,r,n,a=t.getSelections();t.IA(),t.n4(n,e,i,r,!0),i=t.getSelections(),r=0<n?n:t.N9(),n=0<e?e:t.k9(),t.O6(r,n,t.R9,t.B9),t.jA(a),t.parent&&o.Z3&&t.parent.changeSelectionInCommandExecuting(o,null,null,i)}function z(t){var n,e,n,e=t.parent.getActiveSheet();e&&t!==e&&e.repaint()}function w(t,n){return H.call(this,t,n)||this}e=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),l=n("Common"),N=n("Core"),h=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),n=n("CalcEngine"),u=!!n,k=l.Common.lt.ht,_=null,A=void 0,d=N.Ec,n=N.GC$,I=Math.max,x=Math.floor,i=N.Commands.ActionBase,f=N.Commands.CI,T=N.Commands.SI,a=N.CopyToOptions.all,D="startRange",j="fillRange",O="autoFillType",E="fillDirection",v="cancel",r="fill",o="dragDrop",s=n.isEmptyObject,t=new l.Common.ResourceManager(t.SR,"Fill"),m=t.getResource.bind(t),n.extend(N.Worksheet.prototype,M={fillAuto:function(t,n,e){if(!n)throw new Error(m().Exp_RangeIsNull);var i=this,r=e.fillType,o=e.series,a=e.direction,u=e.step,s=e.stop,c=new h.Wtt(i),f=e.Qtt;if(V(t,n,a?_:o,a)){i.suspendPaint(),t&&(i.rt.Ktt=t);try{4===r?c.Jtt(n,o,!1,e.withTag,e.withoutStyle,f):0===r?c.Xtt(n,a):1===r||2===r?c.qtt(1===r,n,o,u,s):3===r&&c.$tt(n,o,3,u,k(s)?_:l.Common.ct.o0(s),e.unit)}finally{i.resumePaint()}}}}),N.Worksheet.ch(r,{init:function(){this.tnt=new h.nnt(this)},setHost:function(t){var t;t&&((t=this.Qy()).fill||t.register(r,N.Commands.fill),t[o]||t.register(o,N.Commands[o]))},dispose:function(t){var t;!1!==t.clearCache&&(t=this).tnt&&(t.tnt.L0(),t.tnt=_)}}),N.Workbook.ch(r,{onCultureChanged:function(){m()}}),e(p,G=i),p.prototype.canExecute=function(){var t=this,n=t.Mf,t=t.Ftt,e=t[D],i=t[j];return!(!n.PT(i.row,i.col,R(i),F(i),{isIgnoreFilterOutRow:!0,sheetArea:N.SheetArea.viewport})||4!==t[O]&&i.intersect(e.row,e.col,R(e),F(e)))},p.prototype.execute=function(){var t,n,e,i,r,o,o,t=this;if(t.canExecute()){e=(n=t.Ftt)[j],r=(i=t.Mf).parent.i4(),N.Commands.II(r),t.X5(i,!0);try{u&&i.suspendCalcService(),o=i.getSelections(),i.isDirtySuspended()||(t.ent=new f(i,n[j],a)),4===n[O]?t.int(i):t.rnt(i),i.EA(o,i.getSelections())&&i.jA(o)}finally{t.q5(i,!0),u&&i.resumeCalcService(!1),N.Commands.xI(r,n),i.Q1i&&i.Q1i(e.row,e.col,R(e),F(e)),o=[],i.isDirtySuspended()||(t.ont=new f(i,e,a),t.ont.yI(t.ent.bI()),o=t.ont.MI()),T(i,e.row,e.col,R(e),F(e),o,1)}}},p.prototype.int=function(t){var n,e,i,e,n,r,o,r,o,n,n=this;n.Ptt.execute(t),i=(e=n.Ftt)[D],e=e[j],n=0===n.Utt,o=R(i),r=F(i),o=n?I(1,o-R(e)):o,n=n?r:I(1,r-F(e)),i.equals(e)||(r=d(i.row,i.col,o,n),t.O6(I(t.N9(),r.row),I(t.k9(),r.col),t.R9,t.B9),t.IA(),t.n4(r.row,r.col,R(r),F(r)))},p.prototype.rnt=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,i,S,T,n=this,e=n.Mf,i=n.Ftt,r=i[D],o=i[j],a=i[O],u=n.Gtt,f={fillType:4,series:n.Utt,withTag:!0,withoutStyle:!(e.lF&N.CopyToOptions.style)},l=e.tables,h=!1,d=new N.Range(u.row,u.col,u.rowCount,u.colCount);if(l)try{g=0===(v=i[E]),(m=2===v)&&(p=r.rowCount,b=0===l.AB(r.row,r.col,p,r.colCount).length)&&(h=!0,d.rowCount-=p),g&&(w=r.colCount,b=0===l.AB(r.row,r.col,r.rowCount,w).length)&&(h=!0,d.colCount-=w),y=[],M=[],l.yx(_,d,A,A,A,y,{applyDragFillAfterTableExpand:h,backupTableResizedArgs:M}),0<y.length&&(f.Qtt=y),n.lCe=M}catch(t){return e.jT(6,t.message),void e.resumePaint()}if(1===a){if(e.fillAuto(r,u,f),e.lF&N.CopyToOptions.style&&e.Ut.eE(r.row,r.col,r.rowCount,r.colCount))for(s=0;s<o.rowCount;s++)for(c=0;c<o.colCount;c++)(C=e.vI(r.row+x(s%r.rowCount),r.col+x(c%r.colCount)))&&C.clone&&(C=C.clone()),e.CL(o.row+s,o.col+c,C)}else 0===a?(i=e.lF&~N.CopyToOptions.comment,n.ant(r,o,i)):2===a?n.ant(r,o,4320):3===a&&((S=!(1!==R(r)||1!==F(r)||-1===r.row&&-1!==r.col||-1===r.col&&-1!==r.row))?n.ant(r,o,T=4251):(f.withoutStyle=!0,e.fillAuto(r,u,f)));e.O6(I(t.N9(),u.row),I(t.k9(),u.col),t.R9,t.B9),t.IA&&t.IA(),e.n4(u.row,u.col,R(u),F(u))},p.prototype.ant=function(t,n,e){var i=this,r=i.Mf,t=r.JS(t),n=r.JS(n),o=t.row,a=t.col,u=R(t),s=F(t),c=n.row,f=n.col,l=R(n),h=F(n),t=i.Ftt[E],d=3===t,v=1===t,m=x(l/u),n=l%u,g=x(h/s),t=h%s,p,b,w,y,M;if(r.HB=!0,0===i.Utt){for(p=0;p<m;p++)r.vT(o,a,y=d?c+p*u:c+l-(p+1)*u,f,u,s,e,!0,!0);0!=n&&r.vT(b=d?o:o+(m+1)*u-l,a,y=d?c+u*m:c+l-m*u-n,f,n,s,e,!0,!0)}else{for(p=0;p<g;p++)r.vT(o,a,c,M=v?f+p*s:f+h-(p+1)*s,u,s,e,!0,!0);0!=t&&r.vT(o,w=v?a:a+(g+1)*s-h,c,M=v?f+s*g:f+h-g*s-t,u,t,e,!0,!0)}delete r.HB,r.recalcRange(c,f,l,h)},p.prototype.undo=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{u&&n.suspendCalcService(),i=n.getSelections(),r=t.Ftt,o=n.R_,a=r[j],e=4===r[O]?t.unt(n):t.snt(n),!n.cnt&&o&&o.close(),T(n,a.row,a.col,R(a),F(a),t.ont?t.ont.MI():[],1,A,!0),n.EA(i,n.getSelections())&&n.jA(i)}finally{t.q5(n,!0),u&&n.resumeCalcService(!1)}}return e},p.prototype.unt=function(t){var n,e,i,e,r,n=this,e=n.Ftt[D],i=e.row,e=e.col,r=N.Commands.TI(t.name());return t.Ut.undo(n.Ftt[r]),t.O6(I(t.N9(),i),I(t.k9(),e),t.R9,t.B9),!0},p.prototype.snt=function(t){var n,e,i,r,i,o,n,e=this.Ftt,i=e[D],r=i.row,i=i.col;u&&t.suspendCalcService();try{o=N.Commands.TI(t.name()),t.Ut.undo(e[o]),t.O6(I(t.N9(),r),I(t.k9(),i),t.R9,t.B9)}finally{u&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},c=p,e(b,U=i),b.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).parent,r=t.Vtt,o=t.Htt,a=e.parent.i4(),N.Commands.II(a),t.XI(),t.X5(e,!0),e.QI=!0;try{u=e.getSelections(),s=void 0,c=e.rt,(f={sheet:e,sheetName:e.name(),cancel:!1})[j]=r,f[O]=t.Ytt,f[E]=t.Ztt,e.ki(N.Events.DragFillBlock,f),c.fnt=f[O],c.lnt=f[v],f[v]||(t.hnt(f),e.ki(N.Events.DragFillBlockCompleted,f)),n=!0,s=e.getSelections(),e.EA(u,s)&&e.jA(u),i&&o.Z3&&i.changeSelectionInCommandExecuting(o,null,null,s)}finally{t.q5(e,!0),e.QI=!1,t.dnt(e,r),N.Commands.xI(a,t.Htt)}}return n},b.prototype.hnt=function(t){var n,e,i,r,o,i,r,n=this,e=n.Mf,i=e.rt,r=n.Vtt,o=n.Ytt;i.fnt=o,i.lnt||((i={})[D]=n.ztt,i[j]=r,i[O]=5===t[O]?o:t[O],i[E]=n.Ztt,r=new c(e,i),e.suspendEvent(),r.execute(),e.resumeEvent(),n.Htt.vnt=r)},b.prototype.XI=function(){var t=this;t.Mf.isDirtySuspended()||(t.ent=new f(t.Mf,t.Vtt,a))},b.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,n=this;if(n.canUndo()){e=n.Mf,i=n.Vtt,r=e.parent,o=n.Htt,n.XI(),n.X5(e,!0);try{a=e.getSelections(),e.suspendEvent(),e.Nj=!0,u=(0,N.hCe)(e),N.Commands.NI(u,o),e.Nj=!1,e.resumeEvent(),s=o[D],e.EA(a,[s])&&e.jA(a),r&&o.Z3&&r.changeSelectionInCommandExecuting(o,null,null,[s]),(0,N.handleRestoredTableResizedArgs)(null==(t=o.vnt)?void 0:t.lCe)}finally{n.q5(e,!0),n.dnt(e,i,!0)}}return!0},b.prototype.dnt=function(t,n,e){var i,r,o,i=this,r=[];t.isDirtySuspended()||((o=new f(t,n,a)).yI(i.ent.bI()),r=o.MI()),T(t,n.row,n.col,R(n),F(n),r,1,A,e)},C=b,e(w,H=i),w.prototype.canExecute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,c,d,v,m,g,c,t=this,n=t.Mf,e=t.tT,i=e.fromRow,r=e.fromColumn,o=R(e),a=e.columnCount,u=e.toRow,s=e.toColumn,c=!e.copy,f,l;if(n.tables&&n.tables.mx(n,{row:i,col:r,rowCount:o,colCount:a},n,{row:u,col:s,rowCount:o,colCount:a},c))return!1;if(!n.zT(i,r,o,a,L(n),B(n)))return!1;if(!e.insert&&!n.zT(u,s,o,a,L(n),B(n)))return!1;if(e.cmd===N.RangeChangedAction[0]&&n.tables&&(h=!1,0<(c=n.tables.AB(i,r,o,a)).length)){for(v=(d=c[0].range()).row;v<d.row+d.rowCount;v++)if(n.isRowFilterOut(v)){h=!0;break}return!(h&&d.contains(e.mouseTargetRow,e.mouseTargetCol,1,1))}return c=t.mnt(m=0<=u&&s<0&&0<=i&&r<0&&0<o&&a<0,g=u<0&&0<=s&&i<0&&0<=r&&o<0&&0<a),n.PT(u,s,o,a,{isAllowDragInsert:c,sheetArea:N.SheetArea.viewport})&&n.PT(i,r,o,a,{isAllowDragInsert:c,sheetArea:N.SheetArea.viewport})},w.prototype.mnt=function(t,n){var e,i,e,i,r,e,r,e,e=this,i=e.tT,e=e.Mf,i=i.insert,r=e.isActualProtected(),e=e.options.protectionOptions;return!(!r||s(e)||(r=e.allowDragInsertRows,e=e.allowDragInsertColumns,!i)||!(r&&t||e&&n))},w.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,t=this,n=!1;if(t.canExecute()){e=t.Mf,i=t.tT,t.XI(),u=i.fromRow,s=i.fromColumn,c=i.toRow,f=i.toColumn,l=R(i),h=i.columnCount,d=i.option,v=l,m=h,g=(a=o=r=void 0,N.hCe)(e),(p=e.o5())&&(v+=e.lT(c,l,!0),m+=e.lT(f,h)),N.Commands.II(g),t.X5(e,!0),e.QI=!0,b=void 0;try{try{w=[],b={shiftCells:i.insert&&i.shiftCells===N.InsertShiftCell.down,isCopy:i.copy,isFirst:!0},e.tables&&e.tables.yx(e,new N.Range(c,f,v,m),new N.Range(u,s,l,h),_,_,_,{shiftInfo:b,backupTableResizedArgs:w}),i.Kh.lCe=w}catch(t){return e.jT(6,t.message),void e.resumePaint()}i.insert?0<=s&&u<0?(r=s,a=h,y=o=f,e.addColumns(o,a),i.copy?e.copyTo(-1,o<=r?r+a:r,-1,o,-1,a,d):(e.moveTo(-1,o<=r?r+a:r,-1,o,-1,a,d),e.deleteColumns(o<=r?r+a:r,a),r<o&&(y=o-a)),P(e,-1,y,L(e),a,i)):0<=u&&s<0?(r=u,a=l,M=o=c,e.addRows(o,a),i.copy?e.copyTo(o<=r?r+a:r,-1,o,-1,a,-1,d):(e.moveTo(o<=r?r+a:r,-1,o,-1,a,-1,d),e.deleteRows(o<=r?r+a:r,a),r<o&&(M=o-a)),P(e,M,-1,a,B(e),i)):0<=u&&0<=s&&(C=i.shiftCells,S=new N.Range(c,f,1,1),T=[new N.Range(u,s,l,h)],k(C)||(A={cmd:"clipboardPaste",sheetName:e.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:T,fromSheet:e,isCutting:!i.copy,pasteOption:0,pastedRanges:[new N.Range(c,f,l,h)],cA:S,fA:T,sA:C,bx:!0,px:b&&b.ignoreFooterShiftIndex},e.Qy().execute(A),I=e.getSelections()[0],C===N.InsertShiftCell.down&&u<c&&!i.copy&&s===f?e.setSelection(I.row-l,I.col,I.rowCount,I.colCount):C===N.InsertShiftCell.right&&s<f&&!i.copy&&u===c&&e.setSelection(I.row,I.col-h,I.rowCount,I.colCount))):(i.copy?e.copyTo(u,s,c,f,l,h,d):e.moveTo(u,s,c,f,l,h,d),e&&(P(e,c,f,v,m,i),x=i.Kh,i.copy||e.isDirtySuspended()||(x.wx=t.gnt(e,x.qI,u,s,l,h)),e.isDirtySuspended()||(x.Mx=t.gnt(e,x.$I,c,f,l,h)))),n=!0}finally{e.rt.q6={},t.q5(e,!0),e.QI=!1,N.Commands.xI(g,i)}z(e)}return n},w.prototype.gnt=function(t,n,e,i,r,o){var a,u,a=new f(t,d(e,i,r,o),this.tT.option),u=t.tables&&t.tables.WI&&t.tables.WI(e,i,r,o);return u&&0<u.length&&(this.tT.tableNamesObj={r:e,c:i,rc:r,cc:o,tableNames:u}),a.yI(n.bI()),T(t,e,i,r,o,a.MI(),0,u),a},w.prototype.XI=function(){var t,n,t,e,i,r,o,a,u,s,c,o,a,i,r,t=this,n=t.Mf,t=t.tT,e=t.Kh;e=e||(t.Kh={}),i=t.fromRow,r=t.fromColumn,o=t.toRow,a=t.toColumn,u=t.option,s=i<0?0:i,c=r<0?0:r,o=o<0?0:o,a=a<0?0:a,i=i<0?L(n):R(t),r=r<0?B(n):t.columnCount,t.insert||n.isDirtySuspended()||(t.copy||(e.qI=new f(n,d(s,c,i,r),u)),e.$I=new f(n,d(o,a,i,r),u)),e.pnt=n.R9,e.bnt=n.B9,e.ynt=n.ui,e.wnt=n.ci},w.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,t=this;if(t.canUndo()){if(n=t.Mf,i=(e=t.tT).fromRow,r=e.fromColumn,o=e.toRow,a=e.toColumn,u=R(e),s=e.columnCount,!n.zT(i,r,u,s,L(n),B(n)))return!1;if(!e.insert&&!n.zT(o,a,u,s,L(n),B(n)))return!1;f=e.Kh,t.X5(n,!(c=void 0)),l=(0,N.hCe)(n),N.Commands.NI(l,e);try{e.insert?0<=r&&0<=i||(0<=r?(c=s,n&&P(n,-1,r,L(n),c,e)):0<=i&&(c=u,n)&&P(n,i,-1,c,B(n),e)):(v=i<0?0:i,m=r<0?0:r,g=o<0?0:o,p=a<0?0:a,b=i<0?L(n):u,w=r<0?B(n):s,n&&(P(n,i,r,u,s,e),y=e.tableNamesObj,M=[],C=[],y&&(y.r===g&&y.c===p&&y.rc===b&&y.cc===w?C=y.tableNames:M=y.tableNames),T(n,g,p,b,w,f.Mx?f.Mx.MI():[],0,M,!0),T(n,v,m,b,w,f.wx?f.wx.MI():[],0,C,!0))),n&&(-1!==f.ynt&&-1!==f.wnt&&((S=n.getSelections()[0]).contains(f.ynt,f.wnt)?n.XA(f.ynt,f.wnt):n.XA(S.row,S.col)),-2!==f.pnt&&-2!==f.bnt&&-1!==f.ynt&&-1!==f.wnt&&n.showCell(f.ynt,f.wnt,3,3),(0,N.handleRestoredTableResizedArgs)(f.lCe))}finally{t.q5(n,!0)}z(n)}return!0},S=w,N.Commands.fill={canUndo:!0,execute:function(t,n,e){return N.Commands.zA(t,C,n,e)}},N.Commands[o]={canUndo:!0,execute:function(t,n,e){return N.Commands.zA(t,S,n,e)}}},"./dist/plugins/fill/fill-event.js":function(r,t,n){"use strict";var g,C,m,i,p,t,b,w,d,y,c,M,S,T,v,A,e,o,f,l,h,I,n,x;function N(t){return t.rowViewportIndex}function k(t){return t.colViewportIndex}function a(t){return t.frozenRowCount()}function s(t){return t.frozenColumnCount()}function u(t){return t.hitTestType}function _(t,n){return t.getRowCount(n)}function D(t,n){return t.getColumnCount(n)}function j(t){return t.colCount}function O(t){return t.rowCount}function E(t){return t.height}function R(t){return t.width}function F(t){var n,t,n=7,t=t.parent;return n=t?2007<t.SC?2:7:n}function L(t,n,e,i,r,o,a){var u,s,c;t.save(),o=o||h,a=a||2,n===i?(t.rect(n-2,e,7,v(r-e)),t.clip(),t.beginPath(),e<r?(e-=3,r+=3):(e+=3,r-=3),u=(0,C.Zx)(n-1,e-1,i-1,r+1,o,a),s=(0,C.Zx)(n,e,i,r,o,a),c=(0,C.Zx)(n+1,e-1,i+1,r+1,o,a)):e===r&&(t.rect(n,e-2,v(i-n),7),t.clip(),t.beginPath(),n<i?(n-=3,i+=3):(n+=3,i-=3),u=(0,C.Zx)(n-1,e-1,i+1,r-1,o,a),s=(0,C.Zx)(n,e,i,r,o,a),c=(0,C.Zx)(n-1,e+1,i+1,r+1,o,a)),u&&u.qx(t),s&&s.qx(t),c&&c.qx(t),t.strokeStyle=o,t.stroke(),t.beginPath(),t.restore()}function B(t,n,e,i,r,o,a,u,s,c,f){var l=n?C.Events.DragDropBlock:C.Events.DragDropBlockCompleted,e={sheet:t,sheetName:t.name(),fromRow:e,fromCol:i,toRow:r,toCol:o,rowCount:a,colCount:u,copy:s,insert:c,copyOption:f};return n&&(e.cancel=!1),t.ki(l,e),e}function P(t,n,e,i,r){for(var o,a,u,o=0;o<e.rowCount;o++){for(a=0;a<e.colCount;a++){if(!(u=t.getSpan(e.row+o,e.col+a))||u.rowCount!==n.rowCount||u.colCount!==n.colCount)return!1;i&&(a+=n.colCount)}r&&(o+=n.rowCount)}return!0}function G(t,n,e){var i,r,o,a,u,s,c,f,r,a,i,i=n.row,r=n.rowCount,o=n.col,a=n.colCount,u=e.row,s=e.rowCount,c=e.col,f=e.colCount,r=i===u&&r===s,a=o===c&&a===f;return(r||a)&&(i=t.getSpan(i,o))&&P(t,i,n,r,a)&&!t.Ut.GT(u,c,s,f)&&P(t,i,e,r,a)}Object.defineProperty(t,"__esModule",{value:!0}),g=n("Common"),C=n("Core"),m=n("SheetsCalc"),i=n("./dist/plugins/fill/fill-ui.js"),p=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),b=n("CalcEngine"),w=!!b,d=C.GC$,y=C.Ec,c=g.Common.lt.ht,M=null,S=void 0,T=Math.min,v=Math.abs,A=Math.max,e=5,o=3,f="drag",l="corner",h="black",I=g.Common.zf,n=new g.Common.ResourceManager(t.SR,"Fill"),x=n.getResource.bind(n),d.extend(C.nk.prototype,{bk:function(t){var n,e,i,r,r,o,a,a,o,r,a,e,n=this;n.zk||(e=n.Mf,i=M,1===(r=e.Ut.getSelections()).length?i=r[0]:r.length<1&&(i=e.Ut.getSpan(e.ui,e.ci)),i&&(n.zk=!0,n.rb=!0,n.Mnt=i,(r=e.tables&&e.tables.find(i.row,i.col))&&(o=n.Cnt=!0,a=r.range(),o=!(r.showHeader()&&i.row===a.row||r.showFooter()&&i.row===a.row+a.rowCount-1||i.col!==a.col||i.colCount!==a.colCount)&&o)&&(n.Snt=!0,n.e_=!0,n.Tnt=r.name()),a=e.getRangeRect(N(t),k(t),i),(o=n.q6).x=a.x,o.y=a.y,o.width=a.width-1,o.height=a.height-1,o.row=i.row,o.col=i.col,o.rowCount=O(i),o.colCount=j(i),r=e.JS(i),a=t.row,e=t.col,(a=a<r.row?r.row:a)>=r.row+O(r)&&(a=r.row+O(r)-1),(e=e<r.col?r.col:e)>=r.col+j(r)&&(e=r.col+j(r)-1),o.hitRow=a,o.hitCol=e,o.rowOffset=a-r.row,o.colOffset=e-r.col,n.Rk={e9:N(t),r9:k(t),Bk:u(t)},n.Ok()))},Vk:function(){var t,n,e,i,r,o,a,i,e,u,s,t=this;t.Rk&&t.rb&&t.zk&&t.Mnt&&(n=t.fk,e=t.q6,r=(i=t.Mf.getCellRect(e.hitRow,e.hitCol)).width/2,o=i.x+r,a=i.height/2,i=i.y+a,e.hitTarget={x:n.x,y:n.y},e=t.Q9(),u=t.K9(),s=!1,(v(o-n.x)>5+r||v(i-n.y)>5+a)&&(s=!0),0<=e&&0<=u&&s&&t.Ant(e,u),t.a9())},Ant:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,l,a,f,c,l,a,t,n,o,e=this;e.zk&&e.Mnt&&(i=e.Mf,r=e.q6,o=i.o5(),a=i.U5(),u=_(i),s=D(i),c=T(s-j(r),n-r.colOffset),f=T(u-O(r),t-r.rowOffset),o&&(l=i.ox(n,r.colOffset+1),f-=h=i.ox(t,r.rowOffset+1,!0),0===i.getColumnWidth(c-=l)&&(c=i.r6(c)),0===i.getRowHeight(f))&&(f=i.nI(f)),-1===a.row&&-1!==a.col?(r.row=-1,r.col=A(0,c)):-1!==a.row&&-1===a.col?(r.row=A(0,f),r.col=-1):(r.row=r.row<0?-1:A(0,f),r.col=r.col<0?-1:A(0,c)),e.Snt&&(a=(l=i.tables&&i.tables.find(t,n))&&l.range(),!l||l.name()!==e.Tnt||t===a.row||l.showFooter()&&t===a.row+a.rowCount?e.e_=!1:e.e_=!0,e.e_?(r.col=a.col,e.i_=!e.isPressShiftKey):e.i_=e.isPressShiftKey),r.hitRow=t,r.hitCol=n,f=i.JS(r),o&&(c=i.lT(f.row,f.rowCount,!0),l=i.lT(f.col,f.colCount),f.rowCount+=c,f.colCount+=l,f.rowCount=T(u,f.rowCount),f.colCount=T(s,f.colCount),f.row+f.rowCount>u||f.col+f.colCount>s)||(a=e.Int)&&f.row===a.row&&f.col===a.col&&O(f)===O(a)&&j(f)===j(a)&&f.row>i.N9()&&f.col>i.k9()&&f.row+O(f)-1<i.P6()&&f.col+j(f)-1<i.G6()||(e.xnt=f,i.Dn.o_(),e.Int=f,(t=i.parent)&&t.options.showDragDropTip&&(n=r.x+r.width+5,o=r.y+r.height+5,t.Tw(I.j0(e.Nnt(f)),n,o))))},Nnt:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v;return t&&w?(i=O(e=(n=this.Mf).U5()),r=j(e),o=n.getActiveRowIndex(),a=n.getActiveColumnIndex(),u=void 0,s=n.o5(),o=o<0?0:o,a=a<0?0:a,u=1===i&&1===r?b.knt(M,M,t.row-o,t.col-a,!0,!0):(h=l=f=c=void 0,v=d=0,-1===e.row&&0<=e.col?(c=l=m.BAND_INDEX_CONST,f=t.col-a,h=t.col-a+r-1,v=r):-1===e.col&&0<=e.row?(f=h=m.BAND_INDEX_CONST,c=t.row-o,l=t.row-o+i-1,d=i):0<=e.row&&0<=e.col&&(c=t.row-o,l=t.row-o+i-1,f=t.col-a,h=t.col-a+r-1,d=i,v=r),s&&(l+=n.lT(t.row,d,!0),h+=n.lT(t.col,v)),b.lJ(M,M,c,f,l,h,!0,!0,!0,!0,o,a)),n.op().unparse(n.Uw(),u,o,a)):S},kD:function(t){var n,e,i,r,o,a,a,u,s,c,f,l,h,d,a,v,m,g,p,p,b,p,b,b,n=this,e=!1,i="",r=!1,o=n.Mf;n.Rk=M,n.l9(),a=o.U5(),u=n.q6.row,s=n.q6.col,c=n.q6.hitRow,f=n.q6.hitCol,n.i_&&a.contains(c,f)||(a=a&&(0<O(a)||0<j(a))?{r:a.row,c:a.col,rc:O(a),cc:j(a)}:{r:o.ui,c:o.ci,rc:1,cc:1},!0===n.zk&&!0===n.rb&&(l=a.r,h=a.c,d=a.rc,a=a.cc,v=o.options.protectionOptions,m=o.lF,g=void 0,n.shiftCells=null,n.i_&&(n.shiftCells=n.Dnt?C.InsertShiftCell.right:C.InsertShiftCell.down),p={fromRow:l,fromColumn:h,rowCount:d,columnCount:a,toRow:u,toColumn:s,isDragInsert:n.i_,isDragCopy:n.t_},o.ki(C.Events.BeforeDragDrop,p),(i=p.invalidMessage)&&0!==i.length||(!n.i_||-1!==l&&-1!==h?u===l&&s===h||(p=o.GT(l,h,d,a),b=o.GT(u,s,d,a),!p&&!b||(b=!1,b=!(p||n.shiftCells!==C.InsertShiftCell.right&&n.shiftCells!==C.InsertShiftCell.down)||b)||(e=!0,i=x().Exp_ChangeMergedCell),e||w&&(o.KT(l,h,d,a)||o.KT(u,s,d,a))&&(e=!0,i=x().Exp_ChangePartOfArray),!e&&o.isActualProtected()&&(!n.t_&&o.dA(y(l,h,d,a),!0,C.SheetArea.viewport)||o.dA(y(u,s,d,a),!0,C.SheetArea.viewport))&&(e=!0,i=o.FT()),e)||(n.i_&&(n.Dnt?s=n.q6.hitCol:u=n.q6.hitRow),(g=B(o,!0,l,h,u,s,d,a,n.t_,!1,m)).cancel)||(r=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:l,fromColumn:h,toRow:u,toColumn:s,rowCount:d,columnCount:a,copy:n.t_,insert:n.i_,shiftCells:n.shiftCells,option:g.copyOption,mouseTargetRow:c,mouseTargetCol:f}),B(o,!1,l,h,u,s,d,a,n.t_,!1,g.copyOption)):0<=h?(n.t_&&(s<=h||h+a<=s)||!n.t_&&(s<h||h+a<s))&&((o.GT(-1,h,-1,a)||o.GT(-1,s,-1,0))&&(e=!0,i=x().Exp_ChangeMergedCell),p=v&&v.allowDragInsertColumns,!e&&o.isActualProtected()&&!0!==p&&(e=!0,i=x().Exp_ColumnReadOnly),e||(g=B(o,!0,-1,h,-1,s,-1,a,n.t_,!0,m)).cancel||(r=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:-1,fromColumn:h,toRow:-1,toColumn:s,rowCount:-1,columnCount:a,copy:n.t_,insert:!0,option:g.copyOption,mouseTargetRow:c,mouseTargetCol:f}),B(o,!1,-1,h,-1,s,-1,a,n.t_,!0,g.copyOption))):0<=l&&h<0&&(n.t_&&(u<=l||l+d<=u)||!n.t_&&(u<l||l+d<u))&&((o.GT(l,-1,d,-1)||o.GT(u,-1,0,-1))&&(e=!0,i=x().Exp_ChangeMergedCell),e||w&&(o.KT(l,-1,d,-1)||o.KT(u,-1,0,-1))&&(e=!0,i=x().Exp_ChangePartOfArray),b=v&&v.allowDragInsertRows,!e&&o.isActualProtected()&&!0!==b&&(e=!0,i=x().Exp_RowReadOnly),e||(g=B(o,!0,l,-1,u,-1,d,-1,n.t_,!0,m)).cancel||(r=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:l,fromColumn:-1,toRow:u,toColumn:-1,rowCount:d,columnCount:-1,copy:n.t_,insert:!0,option:g.copyOption,mouseTargetRow:c,mouseTargetCol:f}),B(o,!1,l,-1,u,-1,d,-1,n.t_,!0,g.copyOption)))))),n.rb=!1,n.zk=!1,n.Snt=!1,n.Cnt=!1,n.e_=!1,n.Tnt=M,n.Mnt=M,n.i_=!1,n.t_=!1,n.Int=M,n.xnt=M,n.iy(),r||(n.q6={},o.repaint()),e&&o.jT(3,i)},wk:function(t){var n=this;!0!==n.Yk&&!0!==n.rb&&(n._nt(),n.Ktt)&&(n.rb=!0,n.Yk=!0,n.hO=!0,n.Ent=t,n.jnt=k(t),n.Ont=N(t),n.Rnt=k(t),n.Bnt(),n.Rk={e9:N(t),r9:k(t),Bk:u(t)},n.Ok())},Bnt:function(){var t,n,e,i,n,t=this,n=a(t.Mf),e=s(t.Mf),i=t.Lnt();0<=i&&i<n?t.Fnt=0:n<=i&&i<=_(t.Mf)&&(t.Fnt=1),t.Pnt()?t.Gnt=1:t.Gnt=t.Ent,0<=(n=t.Unt())&&n<e?t.Hnt=0:e<=n&&n<=D(t.Mf)&&(t.Hnt=1),t.znt()?t.Vnt=1:t.Vnt=t.jnt},Zk:function(){var t,n,e,i,t=this;t.Rk&&t.Yk&&t.rb&&t.Ktt&&(t.Ont=t.nD(),t.Rnt=t.eD(),t.Ynt=t.Q9(),t.Znt=t.K9(),0<=t.Ynt&&0<=t.Znt&&(t.Wnt(),t.Qnt(),n=t.Mf.parent,e=!1,(i=t.Knt())&&(e=t.Jnt(t.Ktt,t.Xnt,!0)),n&&n.options.showDragFillTip&&e&&t.qnt(),t.$nt()),t.a9())},tet:function(){var t,n,e,i,r,r,o,a,u,u,s,a,c,f,l,h,d,h,d,v,m,t=this,n=t.Mf,e=t.Ktt,i=t.Xnt,r=n.parent.options.defaultDragFillType,r=t.net(3===r?5:r,3===r),o=t.eet(),a=t.Knt();return 1===r?(u=0===o||1===o?1:0,a=(s=new p.Wtt(n)).Jtt(a,u,!0),u=t.iet(o,i,e),f=(c=n.getActualStyle(u.row,u.col)).cellType||n.$f(),l=c.formatter||c._autoFormatter,h=g.Formatter&&g.Formatter.GeneralFormatter,a instanceof Date&&h&&(l=new h(g.Common.CultureManager.Fe().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),h=3,(d=t.Rk)&&(h=d.Bk),d={sheet:n,row:u.row,col:u.col,sheetArea:h,quotePrefix:c.quotePrefix},f.format(a,l,v={},d)):0!==r||(u=t.iet(o,i,e),m=n.getFormula(u.row,u.col))?M:n.getText(u.row,u.col)},iet:function(t,n,e){var i,r,o,e,a,u,i=e.row,r=e.col,o=O(e),e=j(e),a=y(i,r,1,1);return 3===t?(u=O(n)%o,a.row=u=0===u?i+o-1:i+u-1,a.col=r):1===t?(u=0===(u=j(n)%e)?r+e-1:r+u-1,a.row=i,a.col=u):0===t?(u=0===(u=j(n)%e)?r:r+e-u,a.row=i,a.col=u):2===t&&(u=O(n)%o,a.row=u=0===u?i:i+o-u,a.col=r),a},qnt:function(){var t,n,e,i,r,o,a,o,n,t=this,n=t.Mf,e;if(4===t.net()||t.znt()||t.Pnt())return t.iy(),M;a=t.eet(),o=t.Knt(),n=n.j1(o),o=t.tet(),3===a||1===a?(i=n.x+n.width+3,r=n.y+n.height+3):0===a?(i=n.x+3,r=n.y+n.height+3):2===a&&(i=n.x+n.width+3,r=n.y+3),t.Tw(o,i,r)},$nt:function(){var t=this;t.ret(),t.oet(),t.aet(),t.uet=t.Knt()},ret:function(){var t,n,t=this.Mf;this.uet&&((n=t.j1(this.uet)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},oet:function(t){var n;this.Mf.Dn.E1(this.Ktt,M,t)},aet:function(){var t,n,e,i,e,r,t,t=this.Mf,n=t.Dn,e=this.Knt();e&&(i=n.J(),e=t.j1(e),r=t.getSelectionBorderColor(),t=F(t),i.save(),i.beginPath(),n.cet(i,e,r,t),i.restore())},Qnt:function(){this.Xnt=this.dO()},znt:function(){return-1===this.Ktt.col&&-1!==this.Ktt.row},Pnt:function(){return-1===this.Ktt.row&&-1!==this.Ktt.col},lO:function(){return 4===this.bO||5===this.bO},dO:function(){var t,n,e,i,r,t=this,n=-1,e=-1,i=-1,r=-1;switch(t.bO){case 0:i=t.Pnt()?n=-1:(n=t.Lnt(),O(t.Ktt)),e=t.Znt,r=t.Unt()-e;break;case 1:i=t.Pnt()?n=-1:(n=t.Lnt(),O(t.Ktt)),e=t.fet()+1,r=t.Znt-e+1;break;case 2:n=t.Ynt,i=t.Lnt()-n,r=t.znt()?e=-1:(e=t.Unt(),j(t.Ktt));break;case 3:n=t.let()+1,i=t.Ynt-n+1,r=t.znt()?e=-1:(e=t.Unt(),j(t.Ktt));break;case 5:n=t.Ynt,i=t.let()-n+1,r=t.znt()?e=-1:(e=t.Unt(),j(t.Ktt));break;case 4:i=t.Pnt()?n=-1:(n=t.Ktt.row,O(t.Ktt)),e=t.Znt,r=t.fet()-e+1}return y(n,e,i,r)},het:function(){var t=this.let();return-1!==t?this.Mf._y(this.Gnt).findRow(t):M},det:function(){return this.Mf._y(this.Ont).findRow(this.vet())},vet:function(){return this.Mf.getViewportBottomRow(this.Ont)},met:function(){var t=this.fet();return-1!==t?this.Mf.Yy(this.Vnt).findCol(t):M},pet:function(){return this.Mf.Yy(this.Rnt).findCol(this.bet())},bet:function(){return this.Mf.getViewportRightColumn(this.Rnt)},Wnt:function(){var t,n,e,i,r,o,a,u,r,i,s,c,f,l,o,a,l,f,o,a,s,c,f,o,a,s,f,a,c,h,t=this,n=t.znt(),e=t.Pnt(),i=d(t.Mf.Dg()).offset(),r=t.fk.e,o=t.fk.x,a=t.fk.y,u=r.pageX-i.left,r=r.pageY-i.top,i=!1;n||e?e?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=4:t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):n&&(t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.bO=5:t.Ynt<t.Lnt()?t.bO=2:t.Ynt>t.let()&&(t.bO=3)):t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?(s=v(t.Znt-t.fet()))<(c=v(t.Ynt-t.let()))?t.bO=5:c<s?t.bO=4:a>(f=(f=t.het())||t.det()).y+f.height?t.bO=3:(o=(l=(l=t.met())||t.pet()).x+l.width-o,a=f.y+f.height-a,u>=l.x&&u<=l.x+l.width&&r>=f.y&&r<=f.y+f.height?t.bO=a<=o?4:5:i=!0):t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):t.Ynt<t.Lnt()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=2:t.Znt<t.Unt()?(s=v(t.Znt-t.Unt()),c=v(t.Ynt-t.Lnt()),t.bO=s<=c?2:0):t.Znt>t.fet()&&(s=v(t.Znt-t.fet()),c=v(t.Ynt-t.Lnt()),t.bO=s<=c?2:1):t.Ynt>t.let()&&(t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=3:t.Znt<t.Unt()?(s=v(t.Znt-t.Unt()),c=v(t.Ynt-t.let()),t.bO=s<=c?3:0):t.Znt>t.fet()&&(s=v(t.Znt-t.fet()),c=v(t.Ynt-t.let()),t.bO=s<=c?3:1)),(l=t.Mf.Dn.yet)&&(a=(f=t.let())+1,s=(o=t.fet())+1,c=t.Mf.getRowHeight(f,3),f=t.Mf.getColumnWidth(o,3),o=t.Mf.getRowHeight(a,3),a=t.Mf.getColumnWidth(s,3),s=l.x+l.width/2-T(10,f/2),f=l.x+l.width/2+T(10,a/2),a=l.y+l.height/2-T(10,c/2),c=l.y+l.height/2+T(10,o/2),h=!1,(h=n||e?e?s<=u&&u<=f:a<=r&&r<=c:s<=u&&u<=f&&a<=r&&r<=c)||i?(t.hO=!0,t.bO=4):t.hO=!1)},Lnt:function(){return this.Ktt?-1===this.Ktt.row?0:this.Ktt.row:-1},let:function(){var t=this;return t.Ktt?-1===t.Ktt.row?_(t.Mf)-1:t.Ktt.row+O(t.Ktt)-1:-1},Unt:function(){return this.Ktt?-1===this.Ktt.col?0:this.Ktt.col:-1},fet:function(){var t=this;return t.Ktt?-1===t.Ktt.col?D(t.Mf)-1:t.Ktt.col+j(t.Ktt)-1:-1},wet:function(t,n){var n,e,i,r,r,i,r,t,n=y(n.row,n.col,n.rowCount,n.colCount),e=this.Mf;return e.Ut.findSpan(t.row,t.col)&&(i=t.rowCount,r=n.rowCount,0!==Math.floor(r%i)&&(r=Math.ceil(r/i)*i,n.row+r<=e.getRowCount())&&(n.rowCount=r),i=t.colCount,r=n.colCount,0!==Math.floor(r%i))&&(t=Math.ceil(r/i)*i,n.col+t<=e.getColumnCount())&&(n.colCount=t),n},DD:function(){var t,n,e,i,r,o,a,u,t=this,n=t.Mf;t.Rk=M,t.l9(),t.iy(),t.Yk&&t.rb?(t.Yk=!1,t.rb=!1,(e=t.Knt())&&(!(i=t.Jnt(t.Ktt,t.Xnt))||t.hO?(t.Met(),t.Ax(e)):(r=n.rt.Ktt,o=t.wet(r,t.Xnt),a=t.net(),n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:r,fillRange:o,autoFillType:a,fillDirection:n.rt.eet()}),!(u=t.lnt)&&t.Cet()&&n.parent.options.showDragFillSmartTag&&4!==t.fnt?t.Tet(t.fnt):t.Ax(e),t.Met()))):t.Met()},Tet:function(t){var n,e,e,n=this.Mf,e=n.Dn.yet,e={x:e.x+e.width,y:e.y+e.height,fillType:t};n.R_=new i.Aet(n.parent.j2(),n,e),n.R_.rQ()},_nt:function(){var t,n,n,e,t=this.Mf,n=t.Ut.getSelections();1===n.length?(n=n[0],(e=t.Ut.getSpans(n))&&0<e.length&&(n=t.kR(e,n)),this.Ktt=n):0<=t.ui&&0<=t.ci&&(this.Ktt=y(t.ui,t.ci,1,1))},Met:function(){this.rb=!1,this.Yk=!1},Ax:function(t){this.Mf.Dn.E1(t)},net:function(t,n){var e,i,t,r,e=this,i=e.Mf,t=t!==S?t:i.parent.options.defaultDragFillType;return e.lO()?4:5!==t?t:(r=1===O(e.Ktt)&&1===j(e.Ktt)&&!e.Pnt()&&!e.znt())?e.a_&&!n?1:0:e.a_&&!n?0:1},Knt:function(){var t,n,e,i,r,t=this;return t.Ktt?t.lO()?t.Ktt:t.Xnt?(r=i=e=n=0,r=t.Iet()?(n=(2===t.bO?t.Xnt:t.Ktt).row,e=O(t.Ktt)+O(t.Xnt),i=t.Ktt.col,j(t.Ktt)):(n=t.Ktt.row,e=O(t.Ktt),i=(0===t.bO?t.Xnt:t.Ktt).col,j(t.Ktt)+j(t.Xnt)),y(n,i,e,r)):M:M},Jnt:function(t,n,e){var i,r,o,i=this.Mf,r=!0,o="";return i.Ut.eE(n.row,n.col,O(n),j(n))&&!G(i,t,n)&&(r=!1,o=x().Exp_FillRangeContainsMergedCell),r&&i.isActualProtected()&&i.dA(n,!0,C.SheetArea.viewport)&&(r=!1,o=i.FT()),r||e||i.ki(C.Events.InvalidOperation,{sheet:i,sheetName:i.name(),invalidType:C.InvalidOperationType.dragFill,message:o,fillRange:n}),r},Cet:function(){return this.xet()||this.Net()},xet:function(){return 3===this.bO||1===this.bO},Net:function(){return 0===this.bO||2===this.bO},Iet:function(){return 2===this.bO||3===this.bO||5===this.bO},eet:function(){var t=this.bO;return 0<=t&&t<=3?t:4===t?0:5===t?2:3},VL:function(t,n,e){var i,r,o,t,a,u,s,a,o,i=this,r=M,o=N(t),t=k(t),a=i.Mf,u=a.parent;if(!c(o)&&!c(t)&&(u.options.allowUserDragDrop||u.options.allowUserDragFill)&&(-1!==(s=a.U5()).row||-1!==s.col)){if(0<=o&&0<=t&&1===a.Ut.getSelections().length){if(i.yD(o,t,n,e))return r;(r=(a=a.getRangeRect(o,t,s)).x-4<n&&n<a.x+4&&a.y<=e&&e<a.y+a.height?{action:f,side:"left"}:r)||(o=i.Mf.Dn.yet)&&o.x<=n&&n<=o.x+o.width&&o.y<=e&&e<=o.y+o.height&&(r={action:f,side:l}),r||a.x+a.width-4<n&&n<a.x+a.width+4&&a.y<=e&&e<a.y+a.height&&(r={action:f,side:"right"}),r||a.y-4<e&&e<a.y+4&&a.x<=n&&n<a.x+a.width&&(r={action:f,side:"top"}),r||a.y+a.height-4<e&&e<a.y+a.height+4&&a.x<=n&&n<a.x+a.width&&(r={action:f,side:"bottom"}),r&&(n<a.x||n>a.x+a.width||e<a.y||e>a.y+a.height)&&(r.outside=!0)}u&&u.options.allowUserDragDrop||r&&r.side!==l&&(r.side=M),u&&u.options.allowUserDragFill||r&&r.side===l&&(r.side=M)}return r},ket:function(t,n){var e,i,r,e=this,i,r=e.Mf.getSpan(t,n,3);return r?!c(e.Mf.getValue(r.row,r.col,3,0)):!c(e.Mf.getValue(t,n,3,0))},Det:function(t,n){var e,i,r,r,e,i,r=this.Mf.tables;return!(!r||0===r.all().length)&&(r=r.AB(t,n,1,1)[0])&&r.footerIndex()===t},_et:function(t,n,e,i){for(var r,o,r=this,o=n;o<n+i;o++)if(!r.ket(t,o)||r.Det(t,o))return!1;return!0},Eet:function(t,n,e,i){for(var r,o,r=this,o=n;o<n+i;o++)if(r.ket(t,o))return!1;return!0},jet:function(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=this,o=r.Mf;if("left"===i){for(a=0;a<n;a++)r.ket(t,a)&&(e.searchArray[a]=!0);for(u=n-1,s=1;e.searchArray[u];)u--,s++;e.searchLength=s}if("right"===i){for(c=o.getColumnCount(),f=n;f<c;f++)r.ket(t,f)&&(e.searchArray[f-n]=!0);for(l=0,h=1;e.searchArray[l];)l++,h++;e.searchLength=h}return e},Oet:function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,o=this,a=o.Mf,u=0,s={searchArray:new Array(i),searchLength:1},c={searchArray:new Array(a.getColumnCount()-r),searchLength:1},f=n;f<e;f++)s=o.jet(f,t.col,s,"left"),c=o.jet(f,t.col+t.colCount-1,c,"right");for(;o.Eet(e+u,t.col,1,t.colCount);){for(h=!(l=!0),s=o.jet(e+u,i,s,"left"),c=o.jet(e+u,r,c,"right"),d=i-1;d>=i-s.searchLength;d--)if(o.ket(e+u,d)){u++,l=!1;break}if(l){for(v=r+1;v<=r+c.searchLength;v++)if(o.ket(e+u,v)){u++,h=!0;break}if(!h)return u}}return u},Ret:function(t){for(var n,e,n=this,e=0;n._et(t.row+t.rowCount+e,t.col,1,t.colCount);)e++;return e},Bet:function(t){var n,e,i,r,o,n=this;return n._et(t.row+t.rowCount,t.col,1,t.colCount)?n.Ret(t):(r=t.row-2,o=t.row+t.rowCount,i=1===t.colCount?e=t.col:(e=t.col,t.col+t.colCount-1),n.Oet(t,r,o,e,i))},H_:function(){var t,n,e,i,i,r,o,t=this,n=t.Mf,e=n.rt.Ktt,i=t.Bet(e);0!==i&&(i=y(e.row+e.rowCount,e.col,i,e.colCount),t.bO=3,t.Xnt=i,r=t.net(),o=t.lnt,n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:e,fillRange:i,autoFillType:r,fillDirection:t.bO}),!o)&&n.parent.options.showDragFillSmartTag&&4!==t.fnt&&t.Tet(t.fnt)}}),d.extend(C.g7.prototype,{Let:function(t,n){var e,i,r,o,t,a,e,u,s,n,e=this.Mf,i=t.x,r=t.y,o=R(t),t=E(t),a=e.U5(),e=e.Fi(),u=4,s=-2.5;return 2007<n&&(u=5,s=-3),n=new C.Rect(-4,-4,u,u),-1===a.col?(n.x=e.b6,n.y=r+t+s):-1===a.row?(n.x=i+o+s,n.y=e.T6):(n.x=i+o+s,n.y=r+t+s),n},yO:function(t,n,e,i,r){var o,a,u,s,s,i,c,f,l,h,u,n,e,o=this,a=o.Mf,u=a.Fi(),s=a.parent,s=s&&s.SC,i=o.Let(i,s),c=i.x,f=i.y,l=R(i),h=E(i),u=u.c9(n,e);r&&!i.intersectRect(r)||i.intersectRect(u)&&(n=-1.5,(e=new C.Rect(c+(n=2007<s?-1:n),f+n,l+2,h+2)).x=A(e.x,u.x),e.y=A(e.y,u.y),o.O1(e),t.save(),r&&!r.containsRect(i)&&(t.rect(r.x,r.y,R(r),E(r)),t.clip()),t.beginPath(),t.fillStyle=C.Pf.vl(a,a.getSelectionBorderColor()),t.fillRect(c,f,l,h),o.yet=new C.Rect(i.x,i.y,4,4),t.beginPath(),t.restore())},cet:function(t,n,e,i){var r=n.x,o=n.y,a=r+R(n),n=o+E(n);L(t,r-2,o,a+1,o,e,i),L(t,r-1,n,a+1,n,e,i),L(t,r,o-1,r,n+1,e,i),L(t,a,o-1,a,n+1,e,i)},Fet:function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,w,y,w,a,w,f,c,M,e=this,i=e.Mf,r=i.rt,o=r.q6,a=o.hitTarget;o&&a&&(u=o.hitCol,s=o.hitRow,c=o.row,f=o.col,l=r.i_,h=i.Pet,v=i.getSelectionBorderColor(),m=F(i),g=8,t.save(),!0===l?(l=i.Yy(0).findCol(u)||i.Yy(1).findCol(u)||i.Yy(2).findCol(u),p=i._y(0).findRow(s)||i._y(1).findRow(s)||i._y(2).findRow(s),-1===o.row&&-1!==o.col?l&&(b=l.x,w=R(l),o.col=u,a.x>b+w/2&&(o.col<i.getLastFullyVisibleColumn()||o.col===i.G6())&&(b=l.x+R(l),o.col++),(h=h&&0===R(h)?h:r.q6)&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,E(h)+16),e.O1(d,n),e.E1(i.U5(),n)),i.Uet=new C.Rect(b,o.y,0,E(o)),t.rect(n.x,n.y,R(n),E(n)),t.clip(),t.beginPath(),L(t,b-8,o.y,b+8,o.y,v,m),L(t,b,o.y,b,o.y+E(o),v,m),L(t,b-8,o.y+E(o),b+8,o.y+E(o),v,m)):-1!==o.row&&-1===o.col?p&&(y=p.y,w=E(p),o.row=s,a.y>y+w/2&&(o.row<i.getLastFullyVisibleRow()||o.row===i.P6())&&(y=p.y+E(p),o.row++),(h=h&&0===E(h)?h:r.q6)&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,E(h)+16),e.O1(d,n),e.E1(i.U5(),n)),i.Uet=new C.Rect(o.x,y,R(o),0),t.rect(n.x,n.y,R(n),E(n)),t.clip(),t.beginPath(),L(t,o.x,y-8,o.x,y+8,v,m),L(t,o.x,y,o.x+R(o),y,v,m),L(t,o.x+R(o),y-8,o.x+R(o),y+8,v,m)):-1!==o.row&&-1!==o.col&&(a=i.Yy(0).findCol(f)||i.Yy(1).findCol(f)||i.Yy(2).findCol(f),w=i._y(0).findRow(c)||i._y(1).findRow(c)||i._y(2).findRow(c),p)&&l&&w&&a&&(b=a.x,y=w.y,h&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,E(h)+16),e.O1(d,n),e.E1(i.U5(),n)),f=!1,c=i.getCellRect(s,u),(f=!r.Cnt&&c?(M=o.hitTarget.x-c.x)<T(16,i.nn(u)/4):f)?b=l.x:y=p.y,i.Uet=new C.Rect(b,y,R(o),E(o)),i.U5().contains(s,u)||(t.rect(n.x,n.y,R(n),E(n)),t.clip(),t.beginPath(),f?(L(t,b-8,y,b+8,y,v,m),L(t,b,y,b,y+E(o),v,m),L(t,b-8,y+E(o),b+8,y+E(o),v,m),r.Dnt=!0):(L(t,b,y-8,b,y+8,v,m),L(t,b,y,b+R(o),y,v,m),L(t,b+R(o),y-8,b+R(o),y+8,v,m),r.Dnt=!1)))):(h&&(d=new C.Rect(h.x-8,h.y-8,R(h)+16,E(h)+16),e.O1(d,n),e.E1(i.U5(),n)),t.rect(n.x,n.y,R(n),E(n)),t.clip(),t.beginPath(),e.cet(t,o,v,m)),t.beginPath(),t.restore())},o_:function(){var t,n,e,i,e,r,o,a,u,s,c,f,l,u,c,t=this,n=t.Mf,e=n.sw,i=n.rt.xnt;e&&e.dragInfo&&i&&(e=t.J(),r=n.Fi(),o=n.rt.q6,a=n.j1(i),u=n.frozenTrailingColumnCount(),s=n.frozenTrailingRowCount(),c=n.getColumnCount()-u,f=n.getRowCount()-s,l=r.c9(1,1),0<u&&i.col+i.colCount<=c&&a.x+R(a)>l.x+R(l)&&a.intersectRect(l)&&(a=a.getIntersectRect(l)),0<s&&i.row+i.rowCount<=f&&a.y+E(a)>l.y+E(l)&&a.intersectRect(l)&&(a=a.getIntersectRect(l)),u=new C.Rect(r.b6,r.T6,r.Hy+r.zy,r.Ay+r.Iy),0<=R(a)&&0<=E(a)&&(o.x=a.x,o.y=a.y,o.width=R(a),o.height=E(a),t.Fet(e,u)),c=n.rt.i_,n.Pet=!0===c?n.Uet:new C.Rect(o.x,o.y,R(o),E(o)))}})},"./dist/plugins/fill/fill-ui.js":function(F,t,n){"use strict";var e,L,a,n,u,s,i,c,f,r,o,l,h,d,v,m,g,p,b,w,y,M,B,P,C,S,T,A,I,x,N,k,G,r,_,U,H,V,D,j;function O(t,n,e,i,r,o){var t=t.Oi,a=t?"160px":"150px",t=t?"25px":"20px",a=u(s("div")).css([M,P,C,"padding",S],["block",a,t,0,0]).addClass("gc-smartMenu-item-default "+e+" ui-state-default"+f),t=u(s("div")).addClass(m).appendTo(a),e=u(s("div")).addClass("gc-menu-item-text").appendTo(a),n=u(s("input")).attr({id:n,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(t);return u(s("span")).text(i).appendTo(e),o?(t.addClass(v),n.prop("checked","checked")):n.prop("checked",""),a}function E(t,n){var t,e,t=D.call(this,t,i(n.parent.Ti))||this;return t.jTe=a.DialogFeatureType.fill,t.Mf=n,t.Het=u("."+p),(e=t.g$=t.Xc()).addClass(l),O(n,"smartMenuCopyCells",o,_().CopyCells,"0",!0).appendTo(e),O(n,"smartMenuFillSeries",o,_().FillSeries,"1").appendTo(e),n.NMi||(O(n,"smartMenuFillFormattingOnly",o,_().FillFormattingOnly,"2").appendTo(e),O(n,"smartMenuFillWithoutFormatting",o,_().FillWithoutFormatting,"3").appendTo(e)),t}function R(t,n,e){var t,n,t=j.call(this,t,i(n.parent.Ti))||this;return t.Mf=n,t.zet=e,n=t.Vet=t.Xc().addClass("gc-smart-tag-default "+p+" gc-no-user-select ui-widget-header"+f),t.Yet=u(s("div")).attr("class","fillSmartTag").css(b,w).appendTo(n),t.Zet=u(s("div")).attr("class","fillSmartTagDown").css([b,M],[w,"none"]).appendTo(n),t}e=this&&this.__extends||(V=function(t,n){return(V=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}V(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Aet=void 0,L=n("Common"),a=n("Core"),n=n("./dist/plugins/fill/fill.ns.js"),u=a.GC$,s=a.mt.En,i=a.mt.gi,c=u(document),f=" btn btn-default",o="gc-fill-type-item",l="gc-fill-menu-container",h=(r="ui-state-hover ")+"gc-smartMenu-item-hover",d=r+"gc-smart-tag-hover",v="ui-icon ui-icon-check gc-check-image",m="gc-menu-item-input",g="ui-state-active gc-smart-tag-active",p="gc-tag-container",b="float",w="left",y="top",M="display",B="width",P="min-width",C="height",S="margin",T="change",A="input[type=radio]",I="mouseover",x="mouseout",N="click",k="fillTypeChanged",G="keydown.ui-fill",r=new L.Common.ResourceManager(n.SR,"Fill"),_=r.getResource.bind(r),D=a.zc,e(E,D),E.prototype.$c=function(){D.prototype.$c.call(this)},E.prototype.aY=function(){var r,t,n,r=this,t;u("."+o).bind(I,function(){u(this).addClass(h)}).bind(x,function(){u(this).removeClass(h)}).bind(N,function(){var t,n,e,i,e,t=u(this),n=r.Het,e=t.find(A),i=e[0];i.checked=!0,e.trigger(T),n.trigger(N),n.trigger(x),t.removeClass(h),e=parseInt(u(i).attr("value"),10),r.Wet(e)}),(n=r.g$.find(A)).bind(T,function(){u("."+m).removeClass(v),u(this).parent().addClass(v)})},E.prototype.Qet=function(){u("."+o).unbind(I).unbind(x).unbind(N),this.g$.find(A).unbind(T)},E.prototype.Wet=function(t){var n=this,e=n.Mf,i=e.rt;if(n.Ket!==t){n.Ket=t,e.cnt=!0,e.suspendEvent();try{a.Commands.undo.execute(e.parent,{sheetName:e.name()})}finally{e.resumeEvent()}e.cnt=!1,e.Qy().execute({cmd:"fill",sheetName:e.name(),startRange:i.Ktt,fillRange:i.Xnt,autoFillType:t,fillDirection:i.bO}),n.Het.trigger(k,t)}},E.prototype.Jet=function(){return!!u("."+l).length},U=E,j=a.zc,e(R,j),R.prototype.Xet=function(t,n,e){var i=this,r=i.Mf.Oi,n=u(n),o=i.qet,i=i.Zet,a=r?"38px":"32px",r=r?"24px":"18px";o&&o.Jet()||(t?n.addClass(d):n.removeClass(d),n.css([B,C],[t?a:r,r]),e)||(t?i.show():i.hide())},R.prototype.$et=function(){var r=this,t=r.Vet,n=a.mt.pi(),o=a.mt.Tt.safari&&(n.ipad||n.iphone);t.bind(I,function(){r.Xet(!0,this,o)}).bind(x,function(){r.Xet(!1,this,o)}),t.bind(N,function(){var t,n,e,i,n,e,t=u(this),n=r.qet,e=r.Zet,i;n&&n.Jet()?(o&&e.hide(),t.removeClass(g),r.tit()):(o&&e.show(),t.addClass(g),r.nit(),(e=(n=r.g$)&&n.find(A)[r.zet.fillType])&&!e.checked&&(e.checked=!0,u(e).trigger(T)))}),c.bind(G,function(t){27===t.keyCode&&(r.qet&&r.qet.Jet()?r.tit():r.close(),a.mt.vi(t))})},R.prototype.rQ=function(){var t=this,n=t.Vet,e=t.zet,i=t.Mf.Oi,r=i?"3px":"0px",i=i?"24px":"18px";n&&(n.css([w,y],[e.x,e.y]),t.$c(),t.$et(),t.Yet.css(S,r),t.Zet.css(C,i),t.c5())},R.prototype.nit=function(){var t,n,n,e,i,i,r,o,a,t=this,n=t.Mf;t.qet||(t.qet=new U(n.parent.j2(),n),t.g$=t.qet.Xc()),e=(n=t.Vet).css(w),i=n.css(y),i=parseFloat(i),o=t.qet,a=t.zet,o.Ket=a.fillType,isNaN(i)||(r=i+n.height()+2),t.g$.css([w,y],[e,r]),o.$c(),o.aY(),o.Het.unbind(k).bind(k,function(t,n){a.fillType=n})},R.prototype.tit=function(){var t=this.qet;t&&(t.Qet(),t.close())},R.prototype.c5=function(){var t=this,n=t.qet,t=t.Vet;n&&(n.Jet()&&t.trigger(N),t.trigger(x))},R.prototype.close=function(){var t,n,t,t=this,n=t.Mf;t.c5(),c.unbind(G),j.prototype.close.call(this),(t=n.fg)&&(t.style.cursor="default"),n&&n.Zg()},R.prototype.lf=function(t){var n;return!(!this.Wc||!j.prototype.hf.call(this,this.Wc.get(0),t))||this.g$&&j.prototype.hf.call(this,this.g$.get(0),t)},t.Aet=R},"./dist/plugins/fill/fill.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/fill/drag-fill.js"),e("./dist/plugins/fill/fill-event.js"),r(e("./dist/plugins/fill/fill-ui.js"),n),r(e("./dist/plugins/fill/fill.js"),n),r(e("./dist/plugins/fill/fill.ns.js"),n)},"./dist/plugins/fill/fill.js":function(I,t,n){"use strict";var e,r,h,i,x,n,_,o,tt,y,M,C,nt,D,a,j,N,a,O,E,et,it,rt,R,a,k,F,L,B,P,G,U,ot,H,V,a,n,z,Y,Z,n,W,Q,J,K,X,q,$,st,ct,ft,lt,ht,n,a,n,a,n,dt,vt,mt,gt,pt,bt,wt,yt,Mt,u,s,Ct,St;function at(t){return!ut(t)&&o.q8(t)}function ut(t){return"string"==typeof t}function Tt(t,n){return-1!==t.lastIndexOf(n)}function At(t){var n=[t];return n.rowCount=1,n.colCount=N(t),n}function It(t){return t}function xt(t,n,e,i){var n=At(n),e=At(e),i=At([i]),t=t?r.Common.eit(n,e,i,!0,It,tt,tt,tt):r.Common.iit(n,e,i,!0,tt,tt,tt),n=t&&t[0][0];return typeof n===et?r.Common.st.E8(n,13):n}function Nt(t){return t.toLowerCase()}function c(t){this.rit=[],this.oit=[],this.ait=[],this.uit=tt,this.sit=[],this.cit=tt,this.lit=nt(t)?-1:t}function f(t){this.hit=-1,this.dit=[],this.MV=-1,this.Mf=t}function kt(){this.vit="",this.mit="",this.MV=0,this.git=1,this._padding=""}function l(t){var n,e,i,r,n=t.length,e=1;if(1<n)for(e=t[1]-t[0],r=2;r<n;r++)if(e!==(i=t[r]-t[r-1])){e=0;break}return e}function d(t,n){return 0<t?(t-1)%n:n-Math.abs(t)%n-1}function v(t){for(var n="",e=0;e<t;)n+="0",e++;return n}function m(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())}function _t(t){return t.every(function(t){var n;return 1===t.getDate()})}function Dt(t){return t.every(function(t){var n,e,i,r,n=t.getFullYear(),e=t.getMonth(),i,r;return t.getDate()===new Date(n,e+1,0).getDate()})}function jt(t){var n,e,n=0,e;return t.every(function(t){var t=t.getDate();return(n=n||t)===t})?n:0}function Ot(t,n){for(var e,i,r,o,e=t.length,i=!0,o=2;o<e&&(i=n===(r=m(t[o-1],t[o])));o++);return i}function Et(t){return t.every(function(t){var n=t.getHours(),e=t.getMinutes(),t=t.getSeconds();return 0!==n||0!==e||0!==t})}function Rt(t,n){return new Date(t,n+1,0).getDate()}function g(t){return"0"===t[0]}function Ft(n,t,e){var i,r,o,r,o,a,u,a=e?1:2,u=e?2:1;return t.every(function(t){return!!(i=t.match(n.pit))&&(r=i[a],(o=r.length)>n.yit&&g(r)&&(n.yit=o),o=parseInt(r,10),r=i[u],nt(n.cit)&&(n.cit=r),r!==n.cit?(n.wit=!0,n.cit=tt,n.sit=[]):n.sit.push(o),!0)})}function p(){}function Lt(){var t=null!==dt&&dt.apply(this,arguments)||this;return t.Mit=0,t.uit=it,t}function b(){return null!==vt&&vt.apply(this,arguments)||this}function w(){return null!==mt&&mt.apply(this,arguments)||this}function Bt(){return null!==gt&&gt.apply(this,arguments)||this}function Pt(){var t=pt.call(this)||this;return t.pit=tt,t.sit=[],t.cit=tt,t.wit=!1,t.yit=0,t.uit=rt,t.Cit=!1,t.Sit=!1,t.Tit=new V,t}function S(t){var n=bt.call(this)||this;return n.Ait=new H(t),n}function Gt(){var t=null!==wt&&wt.apply(this,arguments)||this;return t.pit=/^\d+$/,t}function Ut(){var t=null!==yt&&yt.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)$/,t}function Ht(){var t=null!==Mt&&Mt.apply(this,arguments)||this;return t.pit=/^(\d+)(\D+.*)$/,t}function T(){var t=null!==u&&u.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)(\D+.*)$/,t}function Vt(){return null!==s&&s.apply(this,arguments)||this}function zt(){return null!==Ct&&Ct.apply(this,arguments)||this}function Yt(){var t=null!==St&&St.apply(this,arguments)||this;return t.Cit=!0,t}function Zt(t){var n,e,e,t,i,r,o,n=this;n.Iit=[new z,new Y,new Z],n.xit=new st,n.Nit=new ct,e=F.culture(),e=F.Fe(e).isJCKCulture,t=new W(t),i=new Q,r=new J,o=new K,n.kit=e?[t,i,new $,r,o,new X]:[t,i,r,o]}function Wt(t){t.forEach(function(t){t&&t.dispose()})}function A(t){this.Mf=t,this.Dit=!1,this._it=[]}e=this&&this.__extends||(ht=function(t,n){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}ht(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Wtt=t.nnt=t.FillDateUnit=t.FillType=t.FillSeries=t.FillDirection=t.AutoFillType=void 0,r=n("Common"),h=n("Core"),i=n("CalcEngine"),x=n("SheetsCalc"),n=n("./dist/plugins/fill/fill.ns.js"),_=!!i,o=r.Common.lt,tt=null,y=void 0,M=Math.floor,C=h.Ec,nt=o.ht,D=o.uJ,a=r.Common.Uf,j=a.Eit,N=a.tR,a=r.Common.ct,O=a.o0,E=a.Y0,et="number",it="date",rt="string",R="default",a=new r.Common.ResourceManager(n.SR,"Fill"),k=a.getResource.bind(a),F=r.Common.CultureManager,(n=L=t.AutoFillType||(t.AutoFillType={}))[n.copyCells=0]="copyCells",n[n.fillSeries=1]="fillSeries",n[n.fillFormattingOnly=2]="fillFormattingOnly",n[n.fillWithoutFormatting=3]="fillWithoutFormatting",n[n.clearValues=4]="clearValues",n[n.auto=5]="auto",(a=B=t.FillDirection||(t.FillDirection={}))[a.left=0]="left",a[a.right=1]="right",a[a.up=2]="up",a[a.down=3]="down",(n=P=t.FillSeries||(t.FillSeries={}))[n.column=0]="column",n[n.row=1]="row",(a=G=t.FillType||(t.FillType={}))[a.direction=0]="direction",a[a.linear=1]="linear",a[a.growth=2]="growth",a[a.date=3]="date",a[a.auto=4]="auto",(n=U=t.FillDateUnit||(t.FillDateUnit={}))[n.day=0]="day",n[n.weekday=1]="weekday",n[n.month=2]="month",n[n.year=3]="year",c.prototype.jit=function(){return N(this.rit)},c.prototype.Oit=function(){for(var t=this,n=[],e=t.oit,i,r,i=0;i<N(e);i++)r=e[i],n.push("object"===t.uit?t.r0(r):r);return n},c.prototype.Rit=function(){var t,n,e,i,r,t=this,n=t.rit;if(0<N(n)){for(i=[],r=void 0,-1===(e=t.lit)&&(e=n[0]),r=0;r<N(n);r++)i[r]=n[r]-e+1;return i}return tt},c.prototype.Bit=function(){var t=this.oit;return N(t)?t:tt},c.prototype.Eit=function(t,n,e){if(!at(e))throw new Error(k().Exp_NumberOnly);var i=this;nt(i.uit)&&(i.uit=e instanceof Date?it:et),j(i.rit,t,n),j(i.oit,t,D(e))},c.prototype.ZP=function(t,n){var e=this,i=nt(e.uit);at(n)?(i&&(n instanceof Date?e.uit=it:e.uit=et),e.oit.push(D(n))):i&&(e.uit=ut(n)?rt:R),e.rit.push(t),e.ait.push(n)},c.prototype.Lit=function(t){return this.uit===it?this.r0(t):t},c.prototype.r0=function(n){var e=tt;if(n instanceof Date)e=n;else if(i)try{e=i.Convert.r0(n)}catch(t){e=n}return e},ot=c,f.prototype.L0=function(){this.Mf=tt},f.prototype.Fit=function(){var t=this.Mf;return t.parent&&t.parent.Ow()||[]},f.prototype.Pit=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n=t.length,e=!1;if(t&&0<n)for(i=Nt(t[0]),r=this.Fit(),f=c=s=u=a=o=void 0,o=0;o<r.length;o++)if(0<=(s=(u=(a=r[o]).map(Nt)).indexOf(i))){for(c=s,l=u.length,v=d=h=void 0,m=1;m<n;m++){if(d=Nt(t[m]),!(0<=(h=u.indexOf(d)))){e=!1;break}if(v=h-c+l,f){if(f!==v){e=!1;break}}else e=!0,f=v,c=h}if(g=1===n,e||g){e=!0,this.hit=s,this.dit=a,this.MV=g?1:f;break}}return e},f.prototype.Sl=function(t){var n=this.dit,e=this.hit,i=this.MV,r=n.length,o,a,a;return n[(e+i*d(t,r))%r]},H=f,kt.prototype.Sl=function(t){var t=this.MV*(t-1)+this.git,n=this._padding.length,t=""+Math.abs(t),e,i=this._padding+t,r=i.length,t=n<t.length?t:i.substr(r-n);return this.vit+t+this.mit},V=kt,p.prototype.match=function(t){return!1},p.prototype.getTargetValue=function(t,n,e,i,r){},p.prototype.resetProp=function(){},p.prototype.Git=function(t,n){return t.indexOf(n+1)},p.prototype.dispose=function(){},e(Lt,dt=a=p),e(b,vt=n=Lt),b.prototype.match=function(t){var n,e,i,r,n=this.Mit=m(t[0],t[1]),e=_t(t),i=t.length,r=!0;return e&&2<i&&(r=Ot(t,n)),e&&r},b.prototype.getTargetValue=function(t,n){var e,t=t.ait[0],i=t.getFullYear(),r,o,a,t=t.getMonth()+this.Mit*(n-1);return new Date(i+parseInt(t/12,10),t%12,1)},z=b,e(w,mt=n),w.prototype.match=function(t){var n,e,i,r,n=this.Mit=m(t[0],t[1]),e=Dt(t),i=t.length,r=!0;return e&&2<i&&(r=Ot(t,n)),e&&r},w.prototype.getTargetValue=function(t,n){var e,t=t.ait[0],i=t.getFullYear(),r,o,a,t=t.getMonth()+this.Mit*(n-1),n=i+parseInt(t/12,10),i=t%12;return new Date(n,i,Rt(n,i))},Y=w,e(Bt,gt=n),Bt.prototype.match=function(t){var n,e,i,r,o,a,n=!1;return Et(t)||(e=this.Mit=m(t[0],t[1]),r=0<(i=jt(t)),o=t.length,a=!0,this.Uit=i,r&&2<o&&(a=Ot(t,e)),n=r&&a),n},Bt.prototype.getTargetValue=function(t,n){var e,t=t.ait[0],i=t.getFullYear(),r,o,a,t=t.getMonth()+this.Mit*(n-1),n=i+parseInt(t/12,10),u;return new Date(n,t%12,this.Uit)},Z=Bt,e(Pt,pt=a),Pt.prototype.resetProp=function(){this.sit=[],this.yit=0,this.cit=tt,this.wit=!1,this.Cit=!1,this.Sit=!1},Pt.prototype.getInternal=function(t){for(var n,e,i,r,n=!1,e=t[0],r=1;r<t.length;r++)if(i=t[r],1!==Math.abs(i-e)){n=!0;break}return n},e(S,bt=n=Pt),S.prototype.dispose=function(){var t=this;t.Ait&&(t.Ait.L0(),t.Ait=tt)},S.prototype.match=function(t){return this.Ait.Pit(t)},S.prototype.getTargetValue=function(t,n,e,i,r){var o,t=t.ait.length,e=this.Git(e,i),i=tt,a;return i=-1!==e?this.Ait.Sl(a=t*r+e+1):i},W=S,e(Gt,wt=n),Gt.prototype.match=function(t){var n=this,e,i,i;return t.every(function(t){return!!(e=t.match(n.pit))&&((i=t.length)>n.yit&&g(t)&&(n.yit=i),i=parseInt(t,10),n.sit.push(i),!0)})},Gt.prototype.getTargetValue=function(t,n,e,i,r){var o=t.ait,a=this.Tit,u=l(this.sit),o=o.length,s=0!==u,n=s?0:d(n,o),e=this.Git(e,i),i=tt,c;return this.Cit=s,this.Sit=this.getInternal(t.rit),-1!==e&&(a.MV=u,a.git=this.sit[n],a._padding=v(this.yit),i=a.Sl(c=o*r+e+1)),i},Q=Gt,e(Ut,yt=n),Ut.prototype.match=function(t){return Ft(this,t,!1)},Ut.prototype.getTargetValue=function(t,n,e,i,r){var o=t.ait,a=this.Tit,u=l(this.sit),o=o.length,s=0!==u,n=s?0:d(n,o),e=this.Git(e,i),i=tt,c;return this.Cit=s,this.Sit=this.getInternal(t.rit),-1!==e&&(a.vit=this.cit,a.MV=u,a.git=this.sit[n],a._padding=v(this.yit),i=a.Sl(c=o*r+e+1)),i},J=Ut,e(Ht,Mt=n),Ht.prototype.match=function(t){return Ft(this,t,!0)},Ht.prototype.getTargetValue=function(t,n,e,i,r){var o=t.ait,a=this.Tit,u=l(this.sit),o=o.length,s=0!==u,n=s?0:d(n,o),e=this.Git(e,i),i=tt,c;return this.Cit=s,this.Sit=this.getInternal(t.rit),-1!==e&&(a.mit=this.cit,a.MV=u,a.git=this.sit[n],a._padding=v(this.yit),i=a.Sl(c=o*r+e+1)),i},K=Ht,e(T,u=n),T.prototype.resetProp=function(){u.prototype.resetProp.call(this),this.Hit=tt},T.prototype.match=function(t){var n,e,i,e,n,i,r,r=this;return t.every(function(t){return!!(n=t.match(r.pit))&&(e=n[2],(i=e.length)>r.yit&&g(e)&&(r.yit=i),i=parseInt(e,10),e=n[1],nt(r.cit)&&(r.cit=e),n=n[3],nt(r.Hit)&&(r.Hit=n),e!==r.cit||n!==r.Hit?(r.wit=!0,r.cit=tt,r.Hit=tt,r.sit=[]):r.sit.push(i),!0)})},T.prototype.getTargetValue=function(t,n,e,i,r){var o=this,a=t.ait,u=o.Tit,s=l(o.sit),a=a.length,c=0!==s,n=c?0:d(n,a),e=o.Git(e,i),i=tt,f;return o.Cit=c,o.Sit=o.getInternal(t.rit),-1!==e&&(u.vit=o.cit,u.mit=o.Hit,u.MV=s,u.git=o.sit[n],u._padding=v(o.yit),i=u.Sl(f=a*r+e+1)),i},q=["-","_",":",".",","],e(Vt,s=X=T),Vt.prototype.resetProp=function(){s.prototype.resetProp.call(this),this.zit=tt},Vt.prototype.match=function(t){var i,r,o,i,r,o,a,u,a=this;return t.every(function(n){var t,t,t,e,t=a.zit;if(u=nt(t)?q.some(function(t){if(Tt(n,t))return a.zit=t,!0}):Tt(n,t)){if(t=a.zit,t=n.lastIndexOf(t),i=n.substring(0,t+1),nt(a.cit))a.cit=i;else if(a.cit!==i)return!1;if(t=n.substr(t+1),i=t.match(e=/^(\d+)(\D+.*)$/))return r=i[1],(o=r.length)>a.yit&&g(r)&&(a.yit=o),o=parseInt(r,10),r=i[2],nt(a.Hit)&&(a.Hit=r),r!==a.Hit?(a.cit=tt,a.Hit=tt,!(a.sit=[])):(a.sit.push(o),!0)}return!1})},$=Vt,e(zt,Ct=a),zt.prototype.getTargetValue=function(t,n,e){return xt(!0,t.Bit(),e,n)},st=zt,e(Yt,St=a),Yt.prototype.getTargetValue=function(t,n,e,i){var t=t.ait,r,o;return t[d(n,t.length)]},ct=Yt,Zt.prototype.getRule=function(t,n){var e,i,r,o,a,e=[],i=this.Nit;for(t===it?(e=this.Iit,i=this.xit):t===rt?e=this.kit:t===et&&(i=this.xit),r=0;r<e.length;r++)if(a=void 0,(o=e[r]).resetProp(),o.match(n)){if(a=o.wit,nt(a)||!1===a)return o;if(!0===a)return i}return i},Zt.prototype.L0=function(){var t=this;t.Iit&&(Wt(t.Iit),t.Iit=tt),t.kit&&(Wt(t.kit),t.kit=tt),t.xit&&(t.xit.dispose(),t.xit=tt),t.Nit&&(t.Nit.dispose(),t.Nit=tt)},t.nnt=Zt,A.prototype.qtt=function(t,n,e,i,r){var o=this,t=t?1:2;nt(i)&&nt(r)?o.$tt(n,e,t):o.$tt(n,e,t,i,r,tt)},A.prototype.$tt=function(t,n,e,i,r,o){var a,u,t,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,t,T,A,g,I,x,a=this,u=a.Mf,t=u.JS(t),s=t.row,c=t.col,f=t.rowCount,l=t.colCount;if(u.Ut.eE(s,c,f,l))throw new Error(k().Exp_RangeContainsMergedCell);for(b=0,y=(w=1===n)?l:f,C=w?s+f:c+l,S=(p=3<arguments.length)?1:y,T=(t=this.Mf.rt.Ktt).row===s&&t.rowCount===f&&t.col>c||t.col===c&&t.colCount===l&&t.row>s,h=M=w?s:c;h<C;h++)if(g=T&&p?s+f-1:s,(I=w?a.Vit(h,A=T&&p?c+l-1:c,1,S,n):a.Vit(g,h,S,1,n))&&I.jit())for(m=I.rit[0],p?(g=T?I.oit[N(I.oit)-1]:I.oit[0],d=a.Yit(T,g,y,e,i,r,o),T&&(b=y-N(d),m=I.rit[N(I.rit)-1])):d=a.Zit(I,y,e),v=0;v<N(d);v++)x=I.Lit(d[v]),w?a.Wit(u,h,m,h,c+b+v,x,e):a.Wit(u,m,h,s+b+v,h,x,e)},A.prototype.Vit=function(t,n,e,i,r){for(var o=tt,a=this.Mf,u,s=1===r,c=s?n+i-1:t+e-1,f=s?n:t;f<=c;)at(u=s?a.getValue(t,c):a.getValue(c,n))&&(o=o||new ot(f)).Eit(0,c,u),c--;return o},A.prototype.Yit=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,d,u=[],s=n,f=0<=r,l=nt(o),c=0;c<e;c++)h=o<=s,d=s<=o,t&&(l||f&&h||!f&&d)?(u.unshift(s),1===i?s-=r:2===i?s/=r:3!==i||nt(a)||(s=this.Qit(!0,a,n,s,r,c+1))):!t&&(l||f&&d||!f&&h)&&(u.push(s),1===i?s+=r:2===i?s*=r:3!==i||nt(a)||(s=this.Qit(!1,a,n,s,r,c+1)));return u},A.prototype.Zit=function(t,n,e){var i=[],r,o=1===e;if(o||2===e){for(1===t.jit()&&t.ZP(t.rit[0]+1,o?t.Lit(t.oit[0]+1):t.Oit()[0]),r=0;r<n;r++)i.push(xt(!!o,t.Bit(),t.Rit(),r+1));return i}return tt},A.prototype.Jtt=function(t,n,e,i,r,o){var a,u,s,t,c,f,l,t,u,h,d,s,a=this,u=a.Mf,s=u.Ut,t=u.JS(t),c=t.row,f=t.col,l=t.rowCount,t=t.colCount,u=u.JS(u.rt.Ktt),h=u.row,d=u.col;if(s.GT(h,d,u.rowCount,u.colCount)||s.GT(c,f,l,t))throw new Error(k().Exp_ChangeMergedCell);return s=a.Kit(u,l,t,n,e,!(c<h||f<d),i,r,o),a.Jit&&a.Jit.IB&&(a.Jit.IB.reFilter(),delete a.Jit),s},A.prototype.Kit=function(t,n,e,i,r,o,a,u,s){var c=this,f=o?1:-1,l,h,d,v,m=t.row,g=t.col,p=t.rowCount,b=t.colCount;if(1===i){if(l=M(e/b),h=e%b,!r)for(v=1;v<l;v++)d=C(m,g+v*f*b,p,b),c.Tle(t,d,i,4,r,o,y,y,!0,a,u),c.Xit(t,d,i,4,r,o,y,y,!0,a,u);if(r&&1<l&&0===h&&(l-=1,h=b),0<l&&0<h)return d=C(m,o?g+l*b:g-l*b+b-h,p,h),c.Tle(t,d,i,4,r,o,tt,o?0:b-h,y,a,u),c.Xit(t,d,i,4,r,o,tt,o?0:b-h,y,a,u)}else{if(l=M(n/p),h=n%p,c.Dit||(d=C(m+f*p,g,n-p,e),c.qit(t,d,f,s)),!r)for(v=1;v<l;v++)d=C(m+v*f*p,g,p,b),c.Tle(t,d,i,4,r,o,tt,tt,!0,a,u),c.Xit(t,d,i,4,r,o,tt,tt,!0,a,u);if(r&&1<l&&0===h&&(l-=1,h=p),0<l&&0<h)return d=C(o?m+l*p:m-l*p+p-h,g,h,b),c.Tle(t,d,i,4,r,o,o?0:p-h,tt,!0,a,u),c.Xit(t,d,i,4,r,o,o?0:p-h,tt,!0,a,u)}},A.prototype.Xit=function(t,n,F,e,i,r,L,B,o,a,u){for(var s,c,P,f,G,l,h,d,v,U,H,V,m,z,Y,Z,g,p,b,w,y,M,C,S,T,W,A,I,x,N,Q,k,_,l,D,j,J,K,X,O,q,$,E,R,s=this,c=s.Mf,P=c.Ut,f=1===F,U=f?t.row:t.col,H=f?t.col:t.row,V=f?n.row:n.col,m=f?n.col:n.row,z=f?t.rowCount:t.colCount,Y=f?t.colCount:t.rowCount,Z=f?n.colCount:n.rowCount,d=0;d<z;d++){for(b=0,M=w=U+d,C=y=V+d,S=(f?B:L)||0,T=f?0:S,W=f?tt:o,A=p=g=tt;b<Y;)if(N=void 0,Q=I=H+b,k=x=m+b-S,f||(w=I,I=M,y=x,x=C),h=P.findSpan(w,I),N=c.getValue(w,I),(_=s.Dit)&&nt(A)&&(A=!1===r?c.getValue(H+Y-1,I):c.getValue(w,I)),_||4!==e||!at(N)&&!ut(N)||c.hasFormula(w,I)||(g=g||new ot,l=at(N)?N instanceof Date?it:et:rt,(p=p||l)!==l))if(!_&&N&&g&&g.jit()){if(v=s.$it(f,t,n,M,C,g,i,r,T,W,a,u),i&&v)return v;p=g=tt}else{if(_||!h||h&&(f?h.row:h.col)===M)if(l=k===m+Z-1,D=_?A:N,i){if(_)return D;if(h&&l||!h&&(l&&r||!r&&k===m))return N}else!(k<m+Z&&m<=k)||!_&&!f&&(f||o&&c.XT&&c.XT(k))||_&&-1!==s._it.indexOf(y)||s.Wit(c,w,I,y,x,D,e,a,u);h?b+=f?h.colCount:h.rowCount:b++}else g.ZP(Q,N),h?b+=f?h.colCount:h.rowCount:b++;if(s.Dit)for(j=t.row,J=t.col,K=t.rowCount,X=t.colCount,q=O=void 0,$=!1===r?-1:1,E=1;E<K;E++)for(O=j+$*E,R=0;R<X;)q=J+R,-1===s._it.indexOf(O)&&s.Wit(c,j,J,O,q,A,e,a,u),R++;if(g&&g.jit()&&(v=s.$it(f,t,n,M,C,g,i,r,T,o,a,u),i)&&!nt(v))return v}return tt},A.prototype.Tle=function(t,n,F,e,i,r,L,B,P,o,a){var u,s,G,c,f,l,h,d,v,U,m,H,g,V,p,z,b,w,y,M,C,S,T,A,I,x,N,k,_,D,Y,j,l,l,h,Z,W,Q,J,O,K,X,E,R;if(!i){for(c=(G=(s=(u=this).Mf).Ut).yle(),U=(f=1===F)?t.row:t.col,m=f?t.col:t.row,H=f?n.row:n.col,g=f?n.col:n.row,V=f?t.rowCount:t.colCount,p=f?t.colCount:t.rowCount,z=f?n.colCount:n.rowCount,v=0;v<V;v++){for(y=0,S=M=U+v,T=C=H+v,A=(f?B:L)||0,I=f?0:A,x=f?tt:P,N=w=b=tt;y<p;)D=tt,Y=k=m+y,j=_=g+y-A,f||(M=k,k=S,C=_,_=T),d=G.findSpan(M,k),l=s.getValueIgnoreDefault(M,k),nt(l)?y++:((l=c.getFormula(M,k))&&""!==l||(D=c.getValue(M,k)),(l=u.Dit)&&nt(N)&&(N=!1===r?c.getValue(m+p-1,k):c.getValue(M,k)),l||4!==e||!at(D)&&!ut(D)||(b=b||new ot,h=at(D)?D instanceof Date?it:et:rt,(w=w||h)!==h)?!l&&D&&b&&b.jit()?(u.$it(f,t,n,S,T,b,i,r,I,x,o,a,!0),w=b=tt):((l||!d||d&&(f?d.row:d.col)===S)&&(h=l?N:D,!(j<g+z&&g<=j)||!l&&!f&&(f||P&&s.XT&&s.XT(j))||l&&-1!==u._it.indexOf(C)||u.Wit(s,M,k,C,_,h,e,o,a,!0)),d?y+=f?d.colCount:d.rowCount:y++):(b.ZP(Y,D),d?y+=f?d.colCount:d.rowCount:y++));if(u.Dit)for(Z=t.row,W=t.col,Q=t.rowCount,J=t.colCount,K=O=void 0,X=!1===r?-1:1,E=1;E<Q;E++)for(O=Z+X*E,R=0;R<J;)K=W+R,-1===u._it.indexOf(O)&&u.Wit(s,Z,W,O,K,N,e,o,a,!0),R++;b&&b.jit()&&u.$it(f,t,n,S,T,b,i,r,I,x,o,a,!0)}return tt}},A.prototype.qit=function(t,n,e,i){var r,o,a,n,u,s,n,c,f,t,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,r=this,o=r.Mf,a=o.tables,n=t.union(n),u=n.row,s=n.rowCount,n=t.row,c=t.col,f=t.rowCount,t=t.colCount;if(a)for(h=0,d=l=a.AB(n,c,f,t);h<d.length;h++){if(m=(v=d[h]).Ky,g=v.iw,p=s,i)for(b=0,w=i;b<w.length;b++)if((y=w[b]).row===m&&y.col===g){p=y.rowCount,r.Jit=v;break}if(M=v.IB,C=r._it,S=void 0,M&&M.isFiltered&&M.isFiltered()){for(T=0;T<p;T++)M.isRowFilteredOut(S=u+e*T)&&r._it.push(S);if(0<C.length){r.Dit=!0;break}}}if(A=o.IB,!0!==r.Dit&&A&&A.isFiltered&&A.isFiltered()){for(C=r._it,S=void 0,T=0;T<s;T++)A.isRowFilteredOut(S=u+e*T)&&r._it.push(S);0<C.length&&(r.Dit=!0)}},A.prototype.Wit=function(t,n,e,i,r,o,a,u,s,c){var f,l,l,a,f=t.Ut;_&&(c?((l=f.yle().getExpression(n,e))&&t.hasFormula(n,e,3,!0)||!nt(t.getValueIgnoreDefault(n,e)))&&(0,h.copyDefaultFormula)(t,t,i,r,l):(t.hasFormula(n,e,3)||t.hasFormula(i,r,3))&&(t.setFormula(i,r,tt),0!==a&&4!==a||(t.getFormula(n,e)||f.getDefaultValue(n,e,tt,h.DefaultChangeValueType.Expression))&&x.CalcOperatorAdjustor.copyFormula(t,n,e,t,i,r,1,1,y,!0))),c||nt(t.getValueIgnoreDefault(n,e))&&!nt(f.getDefaultValue(n,e,tt,h.DefaultChangeValueType.Value))?f.getDefaultValue(n,e,tt,h.DefaultChangeValueType.Expression)||f.setDefaultValue(i,r,o,tt,h.DefaultChangeValueType.Value):t.setValue(i,r,o),c||(l=s?0:64,u&&(l|=4224),t.vT(n,e,i,r,1,1,l=l|1024|256,y,!0),s)||(t.removeSpan(i,r,3),(a=f.findSpan(n,e))&&n===a.row&&e===a.col&&t.EL(i,r,a.rowCount,a.colCount,3))},A.prototype.$it=function(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,x,D,N,x,d=this,v=d.Mf,w=t?e.col:e.row,y=t?n.col:n.row,M=t?e.colCount:e.rowCount,C=t?n.colCount:n.rowCount;if(s=s||0,S=o.jit(),T=(w-y-s)/C,A=d.Cit(o.rit,o.oit),I=o.uit,A){for(p=[],g=0;g<S;g++)p[g]=g+1;m=S}else b=o.rit[0],m=o.rit[S-1]-b+1,1===S&&I!==rt&&o.ZP(o.rit[0]+1,o.Lit(o.oit[0]+1)),p=o.Rit();for(g=0;g<m;g++)if(x=o.ait,_=k=N=void 0,D=w+M-1,x=(N=(_=(N=I!==it&&I!==rt?N:v.tnt&&v.tnt.getRule(I,x))?(k=N.getTargetValue(o,m*T+g+1,p,g,T),A=N.Cit||A,x=N.Sit||!1,A&&!x):(k=xt(!0,o.Bit(),p,m*T+g+1),A))?o.rit[g]:b+g)+T*C,a){if(A&&(u&&x===D||!u&&x===w)||!A&&x+s===D)return o.Lit(k)}else x<w+M&&w<=x&&(t?c&&v.XT&&v.XT(i)||d.Wit(v,i,N,r,x,o.Lit(k),4,f,l,h):c&&v.XT&&v.XT(x)||d.Wit(v,N,i,x,r,o.Lit(k),4,f,l,h));return tt},A.prototype.Cit=function(t,n){var e,i,r,o,e=N(n);if(e<=1||N(t)!==e)return!1;for(i=t[1]-t[0],r=n[1]-n[0],o=2;o<e;o++)if(t[o]-t[o-1]!=i||n[o]-n[o-1]!=r)return!1;return!0},A.prototype.Xtt=function(t,n){var e=this,i=this.Mf,r=i.Ut.getSpans(),t=i.JS(t),o=t.row,a=t.col,u=t.rowCount,t=t.colCount,s,s=0===n?C(o,a+t-1,u,1):1===n?C(o,a,u,1):C(2===n?o+u-1:o,a,1,t);(s=i.nR(r,s))&&e.trt(s,o,a,u,t,n)},A.prototype.trt=function(t,n,e,i,r,o){var a=this,u=t.row,s=t.col,c=t.rowCount,f=t.colCount,l,h,d,v,m,g,p,b=a.Mf.Ut,w,m=0===o?(w=b.eE(n,e,i,r-f),g=0,p=-1*f,d=r,v=f,1):1===o?(w=b.eE(n,e+f,i,r-f),g=0,d=r,v=p=f,1):p=(v=2===o?(w=b.eE(n,e,i-c,r),g=-1*c,d=i,c):(w=b.eE(n+c,e,i-c,r),d=i,g=c),0);if(w)throw new Error(k().Exp_TargetContainsMergedCells);if(d%v!=0)throw new Error(k().Exp_MergedCellsIdentical);for(l=M(d/v),h=1;h<l;h++)a.Xit(t,C(u+h*g,s+h*p,c,f),m,0,y,y,y,y,!0)},A.prototype.Qit=function(t,n,e,i,r,o){var a,t,u,s,a=t?-1:1,t=M(o*r),u=Math.abs(r),s=E(1<n?e:i);if(0===n)s.setDate(s.getDate()+a*r);else if(1===n)for(;0<u;)s.setDate(s.getDate()+a*(0<r?1:-1)),6!==s.getDay()&&0!==s.getDay()&&u--;else 2===n?s.setMonth(s.getMonth()+a*t):s.setFullYear(s.getFullYear()+a*t);return O(s)},t.Wtt=A},"./dist/plugins/fill/fill.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/fill/fill.res.en.js");n.SR={en:e}},"./dist/plugins/fill/fill.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_ChangePartOfArray=n.Exp_RangeIsNull=n.Exp_CellReadOnly=n.Exp_RowReadOnly=n.Exp_ColumnReadOnly=n.Exp_ChangeMergedCell=n.Exp_FillCellsReadOnly=n.Exp_FillRangeContainsMergedCell=n.Exp_MergedCellsIdentical=n.Exp_TargetContainsMergedCells=n.Exp_RangeContainsMergedCell=n.Exp_NumberOnly=n.FillWithoutFormatting=n.FillFormattingOnly=n.FillSeries=n.CopyCells=void 0,n.CopyCells="Copy Cells",n.FillSeries="Fill Series",n.FillFormattingOnly="Fill Formatting Only",n.FillWithoutFormatting="Fill Without Formatting",n.Exp_NumberOnly="Only works for Numbers",n.Exp_RangeContainsMergedCell="Range should not have merged cells.",n.Exp_TargetContainsMergedCells="Target range should not have merged cells.",n.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",n.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",n.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",n.Exp_ChangeMergedCell="Cannot change part of merged cell.",n.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",n.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",n.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",n.Exp_RangeIsNull="range is null",n.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/filter/filter-actions.js":function(F,t,n){"use strict";var e,t,g,i,s,p,c,L,n,r,o,a,u,f,l,h,b,d,w,i,y,v,m,M,C,B,P,S,G,U,H,V,z,Y;function T(t,n){var e,t;return t?(t=n.tables.findByName(t))&&(e=t.rowFilter()):e=n.rowFilter(),e}function A(t,n,e,i,r){return{sheet:t,sheetName:t.name(),table:n,tableCol:e,filterValues:i,conditionInfo:0===b(i)&&r?r.toJSON():d}}function I(t,n,e,i){return{sheet:t,sheetName:t.name(),col:n,filterValues:e,conditionInfo:0===b(e)&&i?i.toJSON():d}}function x(t,n,e,i,r){var o=e?t-e.range().col:-1;e?n.ki(g.Events.TableFiltering,A(n,e,o,i,r)):n.ki(g.Events.RangeFiltering,I(n,t,i,r))}function Z(t,n,e){var i,i;e?(i=t-e.range().col,i={sheet:n,sheetName:n.name(),table:e,tableCol:i},n.ki(g.Events.TableFilterClearing,i)):(i={sheet:n,sheetName:n.name(),col:t},n.ki(g.Events.RangeFilterClearing,i))}function W(t,n,e){var i,i;e?(i=t-e.range().col,i={sheet:n,sheetName:n.name(),table:e,tableCol:i},n.ki(g.Events.TableFilterCleared,i)):(i={sheet:n,sheetName:n.name(),col:t},n.ki(g.Events.RangeFilterCleared,i))}function N(t,n,e,i,r,o){var a=i?n-i.range().col:-1;t.filter(n),i?e.ki(g.Events.TableFiltered,A(e,i,a,r,o)):e.ki(g.Events.RangeFiltered,I(e,n,r,o))}function k(t,n){var e,i,n,r,n,i,o,a;return t.suspendPaint(),i=n[e=g.Commands.TI(t.name())],t.Ut.undo(i),t.resumePaint(),n=n.cmdOption,i&&n&&(r=n.colIndex,n=n.tableName,i=i.originalFilter,a=o=void 0,n&&(a=(o=t.tables.findByName(n))?r-o.range().col:-1),o?t.ki(g.Events.TableFiltered,A(t,o,a,i,w)):t.ki(g.Events.RangeFiltered,I(t,r,i,w))),!0}function _(t,n){var t,n,t=G.call(this,t,n)||this,n=t;return n.nrt=n.tT.cmdOption,n.nrt.rowFilter=T(n.nrt.tableName,n.Mf),t}function D(t,n){var t,n,t=U.call(this,t,n)||this,n=t;return n.nrt=n.tT.cmdOption,t}function j(t,n){return H.call(this,t,n)||this}function O(t,n){return V.call(this,t,n)||this}function E(t,n){return z.call(this,t,n)||this}function R(t,n){return Y.call(this,t,n)||this}e=this&&this.__extends||(S=function(t,n){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}S(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t=n("./dist/plugins/filter/filter-ns.js"),g=n("Core"),i=n("Common"),s=n("./dist/plugins/filter/filter.js"),p=n("ConditionalFormatting"),c=i.Common.lt.ht,L=i.Common.lt.Oh,n=g.Commands.ActionBase,r="sortFilter",o="filterTextSelectAction",a="filterByCondition",u="clearFilter",f="contextmenuFilterForSheet",l="contextmenuFilterForTable",h=g.Commands.zA,b=i.Common.Uf.tR,d=void 0,w=null,i=new i.Common.ResourceManager(t.SR,"Filter"),y=i.getResource.bind(i),e(_,G=n),_.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,a,t=this,n=t.nrt.rowFilter,e=t.nrt.colIndex,i=t.nrt.compareFunction,r=t.nrt.isAsc,o=!c(t.nrt.tableName),a=t.nrt.color,u=t.nrt.isBackColor,s={groupSort:t.nrt.groupSort,ignoreHidden:t.nrt.ignoreHidden};t.Mf.suspendPaint(),t.Mf.Ut.startTransaction();try{a!==d?n.sortColumnByColor(e,r,a,u,s,o):n.ert(e,r,i,s,o)}finally{a=g.Commands.TI(t.Mf.name()),t.tT[a]=t.Mf.Ut.endTransaction(),t.Mf.resumePaint()}},_.prototype.undo=function(){return k(this.Mf,this.tT)},v=_,g.Commands[r]={canUndo:!0,execute:function(t,n,e){return h(t,v,n,e)}},e(D,U=n),D.prototype.execute=function(){var t,n,e,i,r,i,t=this,n=t.nrt.colIndex,i=t.tT.cmdOption.tableName,e=T(i,t.Mf);e&&(i&&(r=t.Mf.tables.findByName(i)),t.Mf.suspendPaint(),t.Mf.suspendCalcService(),t.Mf.Ut.startTransaction(),Z(n,t.Mf,r),e.removeFilterItems(n),W(n,t.Mf,r),i=g.Commands.TI(t.Mf.name()),t.tT[i]=t.Mf.Ut.endTransaction(),t.Mf.resumeCalcService(!1),t.Mf.resumePaint())},D.prototype.undo=function(){return k(this.Mf,this.tT)},m=D,g.Commands[u]={canUndo:!0,execute:function(t,n,e){return h(t,m,n,e)}},e(j,H=n),j.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,h,u,t=this,n=t.tT.cmdOption.colIndex,e=t.tT.cmdOption.checkedValues,i=t.tT.cmdOption.allValuesLength,r=b(e),o=y().Blanks,u=t.tT.cmdOption.tableName,s=t.Mf,a=T(u,s);if(a){if(u&&(c=s.tables.findByName(u)),s.suspendPaint(),s.suspendCalcService(),s.Ut.startTransaction(),x(n,s,c,e,w),a.removeFilterItems(n),r!==i)if(a.irt)a.rrt[n]=e;else{for(f=[],l=0;l<r;l++)d=void 0,v=(h=e[l]).text,m=h.value,h=h.type,v===o&&(v=""),(d=new p.Condition(2))._ps.expected=v,d._ps.compareType=0,d._ps.useWildCards=!1,("date"===h||"blank"===h&&a.ort)&&(d.art=!0,d.urt=m),f.push(d);a.addFilterItem(n,f)}N(a,n,s,c,e,w),u=g.Commands.TI(s.name()),t.tT[u]=s.Ut.endTransaction(),s.resumeCalcService(!1),s.resumePaint()}},j.prototype.undo=function(){return k(this.Mf,this.tT)},M=j,g.Commands[o]={canUndo:!0,execute:function(t,n,e){return h(t,M,n,e)}},e(O,V=n),O.prototype.execute=function(){var t,n,e,i,r,o,a,o,t=this,n=t.tT.cmdOption.colIndex,e=t.tT.cmdOption.condition,r=t.tT.cmdOption.tableName,o=t.Mf,i=T(r,t.Mf);if(c(e))return o.jT(7,y().invalidCondition),!1;i&&(r&&(a=t.Mf.tables.findByName(r)),t.Mf.suspendPaint(),t.Mf.Ut.startTransaction(),x(n,t.Mf,a,[],e),i.removeFilterItems(n),i.addFilterItem(n,e),N(i,n,t.Mf,a,[],e),o=g.Commands.TI(t.Mf.name()),t.tT[o]=t.Mf.Ut.endTransaction(),t.Mf.resumePaint())},O.prototype.undo=function(){return k(this.Mf,this.tT)},C=O,g.Commands[a]={canUndo:!0,execute:function(t,n,e){return h(t,C,n,e)}},e(E,z=n),E.prototype.execute=function(){var t,n,t,e,i,r,t,o,a,u,i,u,t=this,n=t.Mf,t=t.tT.cmdOption,e=t.selection,i=t.activeRow,r=t.activeCol,t=t.expectedText;n.Ut.startTransaction(),1===e.rowCount&&1===e.colCount&&(e=this.Mf.expandSelection(n,e),this.Mf.deleteBlankContent(n,e)),n.rowFilter()?(o=void 0,(u=(a=n.rowFilter()).extendedRange||a.range).contains(i,r,1,1)?(x(r,n,d,[t],w),o=new p.Condition(p.ConditionType.textCondition,{compareType:0,expected:t}),a.addFilterItem(r,o),N(a,r,n,d,[t],w)):u.row-1!==i||c(a.srt[r])?(n.rowFilter().unfilter(),n.rowFilter(new s.HideRowFilter(e))):(i=n.getText(u.row,r),x(r,n,d,[t],w),o=new p.Condition(p.ConditionType.textCondition,{compareType:0,expected:i}),a.addFilterItem(r,o),N(a,r,n,d,[t],w))):n.rowFilter(new s.HideRowFilter(e)),u=g.Commands.TI(n.name()),this.tT[u]=n.Ut.endTransaction()},E.prototype.undo=function(){return k(this.Mf,this.tT)},B=E,g.Commands[f]={canUndo:!0,execute:function(t,n,e){return h(t,B,n,e)}},e(R,Y=n),R.prototype.execute=function(){var t,n,t,e,i,r,t,o,e,a,e,a,t=this,n=t.Mf,t=t.tT.cmdOption,e=t.tableName,i=t.expectedText,r=t.activeCol,t=t.activeRow;n.Ut.startTransaction(),o=T(e,n),e=n.tables.findByName(e),o&&e&&(a=e.range(),e.showHeader()&&a.row===t&&!c(o.srt[r-a.col])&&(i=n.getText(t+1,r)),x(r,n,d,[i],w),e=new p.Condition(p.ConditionType.textCondition,{compareType:0,expected:i}),o.removeFilterItems(r),o.addFilterItem(r,e),N(o,r,n,d,[i],w),a=g.Commands.TI(n.name()),this.tT[a]=n.Ut.endTransaction())},R.prototype.undo=function(){return k(this.Mf,this.tT)},P=R,g.Commands[l]={canUndo:!0,execute:function(t,n,e){return h(t,P,n,e)}},g.Commands.crt=function(t){t.register(r,g.Commands[r]),t.register(o,g.Commands[o]),t.register(a,g.Commands[a]),t.register(u,g.Commands[u]),t.register(f,g.Commands[f]),t.register(l,g.Commands[l])}},"./dist/plugins/filter/filter-button-images.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getFilterButtonImageSrc=void 0;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";function i(t){return 0===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===t?e+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}n.getFilterButtonImageSrc=i},"./dist/plugins/filter/filter-dialog.js":function(F,t,n){"use strict";var e,m,i,g,L,B,P,n,G,U,l,H,V,z,Y,h,p,d,Z,W,r,v,Q,J,K,X,q,$,tt,b,a,nt,o,et,it,rt,u,ot,at,ut,st,s,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,w,yt,Mt,Ct,St,Tt,At,It,xt,c,Nt,kt,_t,Dt,jt,y,Ot,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,M,C,Kt,Xt,qt,$t,tn,nn,en,S,rn,on,f,T,A,an,I,x,un,sn,cn,fn,ln,hn,dn,vn,mn,gn,pn,bn,wn,yn,Mn,Cn,Sn,Tn,et,An,In,xn,Nn,kn,_n,Dn,jn,et,N,An,In,On,En,Rn,Fn,xn,Ln,Bn,Pn,Gn,Un,Hn,Vn,zn,Yn,Zn,Wn,Qn,Jn;function Kn(t){return typeof t===qt?JSON.stringify(t):i.Common.ft.j(i.Common.ft._(t))}function Xn(t,n,e,i){var r,o;try{e.suspendPaint(),i&&(o={tableName:r=i.nM?i.nM.name():p,colIndex:t,condition:n},(0,L.zA)("filterByCondition",o,e))}finally{e.resumePaint()}}function k(t,n,e,i,r,o){var a=this;a.uit=p,a.frt=o,a.lrt=t,a.Mf=i,a.hrt=(0,m.GC$)(t),a.Wc=n,a.drt=!1,a.vrt=e,a.IB=e.rowFilter,a.mrt=r,a.grt=h}function _(t,n,e,i,r,o){return Un.call(this,t,n,e,i,r,o)||this}function qn(t,n,e,i,r,o){var t,n,t=Hn.call(this,t,n,e,i,r,o)||this,n=Cn;return i._isExternalFilter&&(n=n.slice(0,7).concat(n.slice(n.length-1))),t.Lz=n,t}function $n(t,n,e,i,r,o){var t=Vn.call(this,t,n,e,i,r,o)||this;return t.Lz=Sn,t}function D(t,n,e,i,r,o){var t,n,t=zn.call(this,t,n,e,i,r,o)||this,n=Tn;return i._isExternalFilter&&(n=n.slice(0,4).concat(n.slice(n.length-1))),t.Lz=n,t}function j(t,n,e,i,r,o){return Yn.call(this,t,n,e,i,r,o)||this}function O(t,n,e,i){var r,o,t,r=this,o=n.parent;return(t=r=Zn.call(this,t,Z.gi(o&&o.Ti),!0)||this).Mf=n,t.prt=t.Zc+"_OK",t.brt=t.Zc+"_Cancel",t.yrt=t.Zc+"_Close",t.vrt=e,t.IB=e.rowFilter,t.frt=i,t.Wc=t.Xc(),r}function te(t,n,e,i){var t,n,t=Wn.call(this,t,n,e,i)||this,n=t;return n.YC=230,n.ZC=140,n.vrt=e,n.IB=n.vrt.rowFilter,n.frt=i,n.uY=n.wrt(),n.Mrt(),t}function E(t,n,e,i,r,o,a){var t,n,t=Qn.call(this,t,n,e,i)||this,n=t;return n.YC=416,n.ZC=100,n.Crt=36,n.Srt=24,n.Trt=8,n.Art=7,n.frt=i,n.Irt=r,n.xrt=o?0:1,n.vz=typeof a!==qt&&a?Kn(a):a,n.Nrt=h,n.krt=h,n.Mrt(),t}function R(t,n,e,i,r,o,a,u,s){var t,n,t=Jn.call(this,t,n,e,i)||this,n=t;return n.vrt=e,n.IB=n.vrt.rowFilter,n.frt=i,n.Drt=o,n._rt=r,n.Ert=a,n.jrt=s,n.Ort=u,n.Rrt(o),n.Mrt(),t}e=this&&this.__extends||(Gn=function(t,n){return(Gn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Gn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Brt=t.Lrt=t.Frt=t.Prt=t.Grt=void 0,m=n("Core"),i=n("Common"),g=n("ConditionalFormatting"),L=n("./dist/plugins/filter/filter.js"),B=n("CellTypes"),P=n("./dist/plugins/filter/filter-button-images.js"),n=n("./dist/plugins/filter/filter-ns.js"),G=i.Formatter.GeneralFormatter,U=m.mt.jse,l=i.Common.CultureManager,H=i.Common.ct,V=i.Common.lt.Oh,z=i.Common.zf.j0,Y=i.Common.zf.dI,h=null,p=void 0,d=m.mt.En,Z=m.mt,W=i.Common.Uf.tR,r=Z.vi,v="left",Q="top",J="float",K="relative",X="gc-ui-filter-subitems-container",q="gc-no-user-select",$="gc-filter-dialog-style",tt="position",b="gc-ui-filter-subitem-item",a="gc-ui-filter-allDate-item",nt="gc-filter-alldates-arrow",u=(rt="gc-filter-hover")+" form-control well "+(it=(et="ui-state-hover ")+(o="gc-filter-item-hover")),ot="gc-filter-button-hover "+et,at="gc-filter-submenu-check",ut="gc-filter-submenu-check-img",st="gc-filter-allDate-check-img",s="gc-filter-alldates-list",ct="gc-filter-addDates-container",ft="gc-filter-subMenu-wrap",lt="top10_dialog",ht="custom_dialog",dt="gc-sub-color-sort",vt="gc-sub-color-filter",mt="automatic",gt="more_color",pt="gc-filter-dialog-color-title",bt="gc-color-item",wt="color-checked-wrap",w="gc-color-item-list",yt="gc-filter-sort",Mt="gc-filter-color-dialog-background",Ct="gc-filter-color-dialog-font",St="gc-filter-color-dialog-style",Tt="TextFilter",At="NumberFilter",It="DateFilter",xt="#D3F0E0",c="#86BFA0",Nt="#000000",kt="#FFFFFF",_t="transparent",Dt="border-box",jt="data-isCheck",y="inline-block",Ot="content-box",Et="#top10-item",Rt="#gc-color-dialog-selected",Ft="#gc-color-dialog-noFill",Lt="thin solid rgb(160,160,160)",Bt="data-checked",Pt="gc-filter-dialog-close",Gt="1px solid #c2c2c2",Ut="gc-filter-top10-rank-illegal",Ht="1px solid #e0e0e0",Vt="data-isNeedDialog",zt="data-isCustom",Yt="data-conditionType",Zt="data-operatorType",Wt="data-colIndex",Qt="data-colorType",Jt="data-color",M="<div class=",C="<span class=",Kt="<img class=",Xt="<li class=",qt="object",$t="</span><span>",tn="</div></div>",nn=".filter-custom-select-input",en="gc-spread-filter-dialog-title",S="display",rn="box-sizing",on="none",f="width",T="height",A="padding",an="border",I="click",x="mouseover",un="mouseout",sn="resize",cn="inherit",fn="#E81123",ln="white",hn="backgroundColor",dn="#f0f0f0",mn=(vn="margin")+"Left",gn=vn+"Top",pn=vn+"Right",bn="font-size",wn=188,yn=16,Mn=1e4,Cn=[[1,"Equal","E",1,0],[1,"NotEqual","N",1,1],[1,"GreaterThan","G",1,2],[1,"GreaterOrEquals","O",1,3],[1,"LessThan","L",1,4],[1,"LessThanOrEquals","Q",1,5],[1,"Between","W",0,1],[1,"Top10","T",8,0],[0,"AboveAverage","A",10,0],[0,"BelowAverage","O",10,1],[1,"Custom","F",1,0]],Sn=[[1,"Equal","E",2,0],[1,"NotEqual","N",2,1],[1,"Begin","I",2,2],[1,"End","T",2,4],[1,"Contain","A",2,6],[1,"NotContain","D",2,7],[1,"Custom","F",2,0]],Tn=[[1,"Equal","E",5,0],[1,"Before","B",5,2],[1,"After","A",5,4],[1,"Between","W",0,1],[0,"Tomorrow","T",6,2],[0,"Today","O",6,0],[0,"Yesterday","D",6,1],[0,"NextWeek","K",6,9],[0,"ThisWeek","H",6,7],[0,"LastWeek","L",6,8],[0,"NextMonth","M",6,6],[0,"ThisMonth","S",6,4],[0,"LastMonth","N",6,5],[0,"NextQuarter","N",6,10],[0,"ThisQuarter","N",6,11],[0,"LastQuarter","N",6,12],[0,"NextYear","N",6,13],[0,"ThisYear","N",6,14],[0,"LastYear","N",6,15],[0,"YearToDate","A",6,0,6],[0,"AllDates","P",6,1],[1,"Custom","F",6,0]],kn=[["Q1","1",6,0,2],["Q2","B",6,1,2],["Q3","A",6,2,2],["Q4","4",6,3,2],["Jan","J",6,0,3],["Feb","F",6,1,3],["Mar","M",6,2,3],["Apr","A",6,3,3],["May","Y",6,4,3],["Jun","U",6,5,3],["Jul","L",6,6,3],["Aug","T",6,7,3],["Sep","S",6,8,3],["Oct","O",6,9,3],["Nov","N",6,10,3],["Dec","D",6,11,3]],_n=["IsEquals-0-1","NotEquals-1-11","IsGreaterThan-2-11","IsGreaterOrEqual-3-11","IsLess-4-11","LessOrEqual-5-11",et="IsBeginWith-2-2","NotBeginWith-3-2",An="IsEndWith-4-2",In="NotEndWith-5-2",xn="IsContain-6-2",Nn="NotContains-7-2"],Dn=["IsEquals-0-2-11","NotEquals-1-2-11","IsGreaterThan-2-11","IsGreaterOrEqual-3-11","IsLess-4-11","LessOrEqual-5-11",et,"NotBeginWith-3-2",An,In,xn,Nn],jn=["IsEquals-0-5","NotEquals-1-5","IsAfter-4-5","AfterOrEqual-5-5","IsBefore-2-5","BeforeOrEqual-3-5",et,"NotBeginWith-4-2",An,In,xn,Nn],et=new i.Common.ResourceManager(n.SR,"Filter"),N=et.getResource.bind(et),k.prototype.Hc=function(){this.Dn(this.Urt()),this.Fz()},k.prototype.Hrt=function(t){return(0,P.getFilterButtonImageSrc)(t)},k.prototype.Urt=function(){var t=(0,m.GC$)(d("div")).attr("id",X+"_"+this.frt);return t.addClass($+" "+q+" "+ft),t.css([tt,S,rn],["fixed",on,Dt]),this.grt=t,(0,m.GC$)(this.lrt).append(this.grt),t},k.prototype.rf=function(){return"none"!==this.grt[0].style.display},k.prototype.$c=function(){(0,m.GC$)("."+ft).hide(),this.grt.show(),this.zrt()},k.prototype.NK=function(){this.grt.hide(),this.grt.find("."+u).removeClass(u)},k.prototype.Vrt=function(t){return this.uit=t,this},k.prototype.zrt=function(t){var n,e,i,r,e,o,i,a,u,s,a,r,c,f,l,h,d,o,n=this.hrt.offset(),e=this.mrt.Fc.offset(),i=document.documentElement,r=e.left,e=e.top,o=i.clientWidth,i=i.clientHeight,a=this.grt.width(),u=this.grt.height(),c,f=this.hrt.parent().parent().offset(),l=f.top,h=this.Wc.offset(),d=this.Wc[0].getBoundingClientRect(),r=h.left+this.Wc.width()+a-r>o?(s=-1*(a+2)+d.left+"px",!1):(s=this.Wc.width()+d.left+"px",!0),o=n.top-h.top,a=i<l+o+u-e?e+i-u-f.top-6+d.top:o+d.top;this.grt.css([v,Q],[s,a+="px"]),t&&t.call(this,r)},k.prototype.Yrt=function(t,n){var e=this,i,r;Xn(t,n,e.Mf,e.IB),this.mrt.close()},k.prototype.Zrt=function(){var t;(0,m.GC$)("."+o,this.grt[0]).trigger(I)},k.prototype.Wrt=function(){var t,n,e,i,n,n,t,n=this.vrt,e=this.Mf,i=n.col,n=n.rowFilter;n&&(n={rowFilter:n,colIndex:i},e.Qy().execute({cmd:"clearFilter",sheetName:e.name(),cmdOption:n}))},k.prototype.Qrt=function(){return this.NK(),h},k.prototype.Krt=function(){this.rf()||(this.$c(),this.Jrt())},k.prototype.Dn=function(t){},k.prototype.Fz=function(){},k.prototype.Jrt=function(){},k.prototype.Xrt=function(){},k.prototype.qrt=function(){},e(_,Un=An=k),_.prototype.Dn=function(t){this.$rt()},_.prototype.Fz=function(){var n=this;n.grt.bind(x,function(t){r(t)}).bind(un,function(t){r(t)}),(0,m.GC$)("."+b,n.grt[0]).bind(x,function(t){(0,m.GC$)("."+b).removeClass(u),(0,m.GC$)(this).addClass(u),r(t)}).bind(un,function(t){(0,m.GC$)(this).removeClass(u),r(t)}).bind(I,function(t){(0,m.GC$)(this).attr("id")!==ct&&n.tot((0,m.GC$)(this)),r(t)}),this.not&&this.not()},_.prototype.eot=function(t){return t!==p&&"TRUE"===t||"FALSE"===t},_.prototype.iot=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this.IB.rrt[this.vrt.col],n=this.Lz,o=!1;if(t&&0<t.length&&t[0]instanceof g.Condition)for(s=(t=t[0]).compareType(),c=t.expected(),a=t.expectTypeId(),10===(u=t.conType())&&(s=t.type()),8===u&&(s=0),0===(u=this.eot(c)?11:u)&&(f=t.item1().compareType(),l=t.item2().compareType(),5===Math.max(f,l))&&3===Math.min(f,l)&&(o=!0),h=0,d=W(n);h<d;h++){if((i=0===u&&n[h][3]===u&&o||n[h][3]===u&&0!==u||11===u&&(0===n[h][3]||1===n[h][3]))&&8===u){e=h;break}if(r=n[h][4]===s&&!o||6===n[h][3]&&c===n[h][4]||o,i&&r&&(isNaN(a)||0===a)){e=h;break}}isNaN(a)||6!==a||(e=19),isNaN(a)||2!==a&&3!==a||(e=20,this.oot&&this.oot(kn,c,a)),e!==p&&0!==e?v=(0,m.GC$)("."+b)[e]:!t||3===u||e!==p||2===u&&0===s?0===e&&5===u&&(v=(0,m.GC$)("."+b)[e]):v=(0,m.GC$)("."+b)[W(n)-1],(0,m.GC$)(v).attr(jt,1),(0,m.GC$)(v).find("."+ut).css([S],[y])},_.prototype.Jrt=function(){var t=(0,m.GC$)("."+b).removeClass(u)[0];(0,m.GC$)(t).addClass(u)},_.prototype.aot=function(t){var n;if(0!==t)n=t;else switch(this.uit){case At:n=1;break;case Tt:n=2;break;case It:n=5}return n},_.prototype.uot=function(t,n,e,i){var r=this.Mf,o;switch(t){case lt:o=new Ln(r.parent.j2(),r,this.vrt,lt);break;case ht:o=new Pn(r.parent.j2(),r,this.vrt,ht,this.mrt._rt,i,n,e,this.aot(n))}o&&o.rQ()},_.prototype.tot=function(t){var n,e,i,r,o,a,u,t,t,n=this.vrt.col,e=parseInt(t.attr(Vt),10),i=parseInt(t.attr(Yt),10),r=parseInt(t.attr(Zt),10),a=parseInt(t.attr("data-expectTypeId"),10),u=parseInt(t.attr(zt),10),t=parseInt(t.attr(jt),10);isNaN(a)||(u=e=0),0===e&&1===t?(this.Wrt(),this.mrt.close()):1===e?(this.mrt.close(),this.uot(o=8===i&&0===r?lt:ht,i,r,u)):(t=new g.Condition(i),10===i?t.type(r):t.compareType(r),6!==i||isNaN(a)?6===i&&(t=new g.Condition(i)).expected(r):((t=new g.Condition(i)).expectTypeId(a),t.expected(r)),this.Yrt(n,t))},_.prototype.$rt=function(){},_.prototype.sot=function(t){for(var n,e,i,n="",e=0,i=t.length;e<i;e++)n+=e===i-1?this.cot(t[e],1):this.cot(t[e],0);this.grt.html(n),(0,m.GC$)(this.lrt).append(this.grt),this.fot(),this.iot()},_.prototype.fot=function(){var t=this.lrt.offsetHeight-2,n=this.lrt.offsetTop;(0,m.GC$)("."+b+",."+a).css([A,T,"line-height","white-space","clear",an,f,T,bn,vn],["0 10px 0 0",t,t,"nowrap","both",on,"auto","auto","12px",0]),this.grt.css([v,Q],["100%",n]),(0,m.GC$)(".gc-filter-hotkey").css(["text-decoration"],["underline"]),(0,m.GC$)("."+at).css([S,f,"textAlign"],[y,"24px","center"]),(0,m.GC$)("."+at+" img").css([S,"verticalAlign"],[y,"text-bottom"]),(0,m.GC$)("."+ut+",."+st).hide(),(0,m.GC$)("#"+ct).css([tt],[K]),(0,m.GC$)("."+nt).css([mn,f,T,"background-position"],["5px","16px","16px","center bottom"]),(0,m.GC$)("#"+s).css([tt,S,f],["absolute","none","auto"])},_.prototype.cot=function(t,n){var e="",i=t[0],r=N()[t[1]],o=t[3],t=t[4],e;return M+'"'+b+'" '+zt+'="'+n+'" '+Vt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+t+'">'+M+'"'+yt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+tn},_.prototype.qrt=function(){var t,n,t=(0,m.GC$)("."+o,this.grt[0]).removeClass(u),n=(0,m.GC$)("."+b);(0===t.index()?(0,m.GC$)(n[n.length-1]):(0,m.GC$)(n[t.index()-1])).addClass(u)},_.prototype.Xrt=function(){var t=(0,m.GC$)("."+o,this.grt[0]);0<t.length&&t[0].nextSibling?(t.removeClass(u),(0,m.GC$)(t[0].nextSibling).addClass(u)):this.Jrt()},e(qn,Hn=In=_),qn.prototype.$rt=function(){this.sot(this.Lz)},t.Grt=qn,e($n,Vn=In),$n.prototype.$rt=function(){this.sot(Sn)},t.Prt=$n,e(D,zn=In),D.prototype.$rt=function(){this.sot(this.Lz)},D.prototype.cot=function(t,n){var e="",i=t[0],r=N()[t[1]],o=t[3],a=t[4],e;return e="AllDates"===t[1]?'<div id="'+ct+'" class="'+b+'" '+zt+'="'+n+'" '+Vt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+a+'">'+M+'"'+yt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+C+'"'+nt+' gc-filterDialog-rightArrow"></span></div>'+this.lot()+"</div>":"YearToDate"===t[1]?M+'"'+b+'" data-expectTypeId="'+t[5]+'" '+zt+'="'+n+'" '+Vt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+a+'">'+M+'"'+yt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+tn:M+'"'+b+'" '+zt+'="'+n+'" '+Vt+' ="'+i+'" '+Yt+'="'+o+'" '+Zt+'="'+a+'">'+M+'"'+yt+'">'+C+'"'+at+'">'+Kt+'"'+ut+'" src="'+this.Hrt(11)+'">'+$t+r+"</span>"+tn},D.prototype.$c=function(){(0,m.GC$)("."+ft).hide(),this.grt.show(),this.zrt(this.hot)},D.prototype.hot=function(t){var n,e,i,r,t,o,r,o,a,u;this.grt.show(),n=(0,m.GC$)("#"+s),e=(0,m.GC$)("#"+ct),i=this.grt,n.length<=0||(r=(o=document.documentElement).clientWidth,o=o.clientHeight,u=(a=this.mrt.Fc.offset()).top,r=!(i.offset().left+i.width()+n.width()>r)&&t?i.width()+"px":-1*n.width()+"px",t=e.offset().top+n.height()-u>o?u+o-n.height()-e.offset().top-5:0,n.css([v,Q],[r,t+="px"]))},D.prototype.lot=function(){for(var t,n,t='<div id="'+s+'" class="'+$+'">',n=0;n<W(kn);n++)t+=M+'"'+a+'" data-expectTypeId="'+kn[n][4]+'" '+Yt+'="6"  '+Zt+'="'+kn[n][3]+'">'+M+'"'+yt+'">'+C+'"'+at+'">'+Kt+'"'+st+'" src="'+this.Hrt(11)+'">'+$t+N()[kn[n][0]]+"</span>"+tn;return t+="</div>"},D.prototype.Jrt=function(){var t,t;(this.vot()?(t=(0,m.GC$)("."+a).removeClass(u),(0,m.GC$)(t[0])):(t=(0,m.GC$)("."+b).removeClass(u)[0],(0,m.GC$)(t))).addClass(u)},D.prototype.vot=function(){var t=!1,n=(0,m.GC$)("#"+s);return t=0!==n.length?n.css(S)!==on:t},D.prototype.mot=function(){(0,m.GC$)("#"+s).hide(),(0,m.GC$)("."+a).removeClass(u)},D.prototype.not=function(){var n=this;(0,m.GC$)("."+a,n.grt[0]).bind(x,function(){(0,m.GC$)(this).addClass(u),(0,m.GC$)("#"+ct).addClass(u)}).bind(un,function(){(0,m.GC$)(this).removeClass(u)}).bind(I,function(t){n.tot((0,m.GC$)(this)),r(t)}),(0,m.GC$)("#"+ct,n.grt[0]).bind(x,function(){(0,m.GC$)("#"+s).show()}).bind(un,function(){n.mot()}).bind(I,function(t){(0,m.GC$)("#"+s).show(),n.Jrt(),r(t)})},D.prototype.got=function(){var t=!1,n=(0,m.GC$)("#"+ct);return t=0!==n.length?n.hasClass(u):t},D.prototype.oot=function(t,n,e){for(var i,r,o,r=0;r<W(t);r++)if(t[r][3]===n&&t[r][4]===e){i=r;break}o=(0,m.GC$)("."+a)[i],(0,m.GC$)(o).attr(jt,1),(0,m.GC$)(o).find("."+st).css([S],[y]).attr(jt,1)},D.prototype.Zrt=function(){var t,t=this.vot()?(0,m.GC$)("."+o,(0,m.GC$)("#"+s)[0]):(0,m.GC$)("."+o,this.grt[0]);t.trigger(I)},D.prototype.Qrt=function(){var t=h;return this.vot()?(this.mot(),t=this):this.NK(),t},D.prototype.Krt=function(){var t=this.rf(),n=this.vot();t?!n&&this.got()&&((0,m.GC$)("#"+s).show(),this.Jrt()):(this.$c(),this.Jrt())},D.prototype.qrt=function(){var t,n,n,t;(this.vot()?(t=(0,m.GC$)("."+o,(0,m.GC$)("#"+s)[0]).removeClass(u),n=(0,m.GC$)("."+a),0===t.index()?(0,m.GC$)(n[n.length-1]):(0,m.GC$)(n[t.index()-1])):(n=(0,m.GC$)("."+o,this.grt[0]).removeClass(u),t=(0,m.GC$)("."+b),0===n.index()?(0,m.GC$)(t[t.length-1]):(0,m.GC$)(t[n.index()-1]))).addClass(u)},D.prototype.Xrt=function(){var t,n,n;this.vot()?(t=(0,m.GC$)("."+o,(0,m.GC$)("#"+s)[0]).removeClass(u),n=(0,m.GC$)("."+a),(t.index()===n.length-1?(0,m.GC$)(n[0]):(0,m.GC$)(n[t.index()+1])).addClass(u)):0<(n=(0,m.GC$)("."+o,this.grt[0])).length&&n[0].nextSibling?(n.removeClass(u),(0,m.GC$)(n[0].nextSibling).addClass(u)):this.Jrt()},t.Frt=D,e(j,Yn=An),j.prototype.Dn=function(){this.pot(this.mrt.bot,this.mrt.yot)},j.prototype.wot=function(){var t,n,e,n,t,i,n=this.IB.nrt;if(n&&n.color!==p){if(e=n.isBackColor?0:1,n=n.color,t=this.mrt.bot,i=this.mrt.yot,"{"===n[0]?n=JSON.parse(n):""!==n&&(n=Kn(n)),""===n&&0==e&&t[mt]===p||""===n&&0!=e&&i[mt]===p)return p;t={colorType:e,color:n}}return t},j.prototype.Mot=function(){var t=this.IB.rrt[this.vrt.col],n;return n=t&&0<t.length&&t[0]instanceof g.Condition&&3===t[0].conType()?{colorType:t[0].compareType(),color:t[0].expected()}:n},j.prototype.pot=function(t,n){this.Cot(t,n),this.Sot()},j.prototype.Tot=function(t,n){this.mrt.Aot(t,n),this.mrt.close()},j.prototype.Iot=function(t){var n,e,i,r,o;this.mrt.close(),e=(n=this).Mf,r=t?this.mrt.bot:this.mrt.yot,this.xot&&(i=this.xot.color),(o=new Bn(e.parent.j2(),e,this.vrt,this.frt,r,t,i)).rQ()},j.prototype.Not=function(t,n){var e,i,n,r,e=new g.Condition(3),i=this.vrt.col,n=n?0:1,r=this.Mot();r&&r.colorType===n&&r.color===t?(this.Wrt(),this.mrt.close()):(e.compareType(n),e.expected(t),this.Yrt(i,e))},j.prototype.Sot=function(){(0,m.GC$)("."+pt,this.grt[0]).css([T,"line-height","textIndent","whiteSpace"],["32px","32px","8px","nowrap"]),(0,m.GC$)("."+w,this.grt[0]).css(["listStyle","padding",T,"lineHeight",an,"whiteSpace",f,vn,bn,rn],[on,"2px 0","23px","23px","1px solid transparent","nowrap","140px",0,"12px","content-box"]),(0,m.GC$)("."+bt,this.grt[0]).css([f,an,pn,T,rn,"whiteSpace",J],["75px","1px solid rgb(130,130,130)","24px","22px",Dt,"nowrap",v]),(0,m.GC$)("."+wt,this.grt[0]).css([S,f,T,"verticalAlign",vn,"textAlign",J],[y,"22px","22px","middle","0 3px 0 2px","center",v]),(0,m.GC$)("."+wt+" img",this.grt[0]).css([gn,S],["3px",on]),(0,m.GC$)(".gc-color-dialog-more-color",this.grt[0]).css([A],["0 5px 0 0"]),(0,m.GC$)("."+wt+" img.checked",this.grt[0]).css([gn,S],["3px","block"])},j.prototype.Cot=function(t,n){var e,i,r,e;this.frt===dt?(e=N().SortCellTitle,i=N().SortFontTitle,r=this.wot()):this.frt===vt&&(e=N().FilterCellTitle,i=N().FilterFontTitle,r=this.Mot()),this.xot=r,e=this.kot(e,t[mt],t.data,0,r),""!==(e+=this.kot(i,n[mt],n.data,1,r))?this.grt.html(e):this.drt=!0,(0,m.GC$)(this.lrt).append(this.grt),this.grt.find("canvas").forEach(function(t,n,e){var t,i,r,o,a,u,t=t,i="{"===t.textContent[0]?JSON.parse(t.textContent):t.textContent,r=73,o=20;t.width=73,t.height=20,a=t.getContext("2d"),m.W.setFillStyle(a,i,0,0,73,20,u=function(){a.fillRect(0,0,73,20)})})},j.prototype.kot=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,r,t,n,t,u=!1,s="checked";for(l in r&&i===r.colorType&&""!==r.color?a=Kn(r.color):r&&""===r.color&&i===r.colorType&&(a=r.color),c=M+"'"+pt+"'>"+t+"</div><ul class='"+(o=0===i?Mt:Ct)+"' style='padding: 7px 0 0 0;margin:0'>",f=0,e)e.hasOwnProperty(l)&&f<5&&(h="",a!==p&&a===l&&(h=s,u=!0),c+=Xt+'"'+w+'" '+Wt+'="'+e[l]+'" '+Qt+'="'+i+'">'+C+'"'+wt+'">'+Kt+'"'+h+'" src="'+this.Hrt(11)+'"></span>'+M+'"'+bt+'"><canvas>'+l+"</canvas></div></li>",f++);return 0===f&&a===p||n===p&&1===f?"":(n!==p&&(r=0===i?N().NoFill:N().Automatic,t="",a!==p&&""===a&&(t=s,u=!0),c+=Xt+'"'+w+'" '+Wt+'="'+mt+'" '+Qt+'="'+i+'" '+Jt+' = "">'+C+'"'+wt+'"><img  class="'+t+'" src="'+this.Hrt(11)+'"></span>'+M+'"'+yt+'">'+r+"</div></li>"),5===f&&(n=u||a===p?"":s,t=0===i?N().CellColor:N().FontColor,c+=Xt+'"'+w+'" '+Wt+'="'+gt+'" '+Qt+'="'+i+'" >'+C+'"'+wt+'">'+Kt+'"'+n+'" src="'+this.Hrt(11)+'"></span>'+M+'"'+yt+' gc-color-dialog-more-color">'+t+"</div></li>"),c+"</ul>")},j.prototype.Jrt=function(){var t=(0,m.GC$)("."+w,this.grt[0]).removeClass(u)[0];(0,m.GC$)(t).addClass(u)},j.prototype.Fz=function(){var o=this;o.grt.bind(x,function(t){r(t)}).bind(un,function(t){r(t)}),(0,m.GC$)("."+w,o.grt[0]).bind(I,function(){var t,n=(0,m.GC$)(this).find("canvas"),e=(0,m.GC$)(this).attr(Wt),i=(0,m.GC$)(this).attr(Qt),r=!1;n&&0<n.length?"{"===(t=n.text())[0]&&(t=JSON.parse(t)):t=(0,m.GC$)(this).attr(Jt),0===(i=parseInt(i,10))&&(r=!0),"more_color"===e?o.Iot(r):o.frt===dt?o.Tot(t,r):o.frt===vt&&o.Not(t,r)}).bind(x,function(t){(0,m.GC$)("."+w,o.grt[0]).removeClass(u),(0,m.GC$)(this).addClass(u),r(t)}).bind(un,function(t){(0,m.GC$)(this).removeClass(u),r(t)})},j.prototype.Dot=function(t){var e=0;return t.forEach(function(t,n){(0,m.GC$)(t).hasClass(o)&&(e=n)}),e},j.prototype.qrt=function(){var t,n,t,t=(0,m.GC$)("."+w,this.grt[0]),n=this.Dot(t);(0===n?(0,m.GC$)(t.removeClass(u)[t.length-1]):(t=t.removeClass(u)[n-1],(0,m.GC$)(t))).addClass(u)},j.prototype.Xrt=function(){var t,n,t,t=(0,m.GC$)("."+w,this.grt[0]),n=this.Dot(t);n===t.length-1?this.Jrt():(t=t.removeClass(u)[n+1],(0,m.GC$)(t).addClass(u))},t.Lrt=j,Zn=m.Ase,e(O,Zn),O.prototype.rQ=function(){},O.prototype.Mrt=function(){this.$c(),this.Dn(),this._ot(),this.Eot()},O.prototype.Dn=function(){},O.prototype.Eot=function(){var t=this,n=t.Wc.width(),e=t.Wc.height(),i=t.Fc.width(),t=t.Fc.height();this.Wc.css([tt,v,Q],["fixed",(i-n)/2+"px",(t-e)/2+"px"])},O.prototype._ot=function(){var e,t,e=this,t=function(t){t.stopPropagation(),e.jot(),e.Oot(),e.close()};(0,m.GC$)("#"+e.prt).bind(I,function(t){var n;t.stopPropagation(),e.Rot()&&(e.Oot(),e.close())}),(0,m.GC$)("#"+e.brt).bind(I,t),(0,m.GC$)("#"+e.yrt).bind(I,t).bind(x,function(){this.style.backgroundColor=fn,this.style.color=ln}).bind(un,function(){this.style.backgroundColor=cn,this.style.color=cn}),(0,m.GC$)("#"+e.prt+", #"+e.brt).bind(x,function(){(0,m.GC$)(this).addClass(ot)}).bind(un,function(){(0,m.GC$)(this).removeClass(ot)}),(0,m.GC$)(document).bind(sn,function(){e.Eot()})},O.prototype.tot=function(t){var n=this.vrt,e,i,r;Xn(n.col,t,this.Mf,n.rowFilter)},O.prototype.Rot=function(){return!0},O.prototype.jot=function(){},O.prototype.Oot=function(){},t.Brt=xn=O,e(te,Wn=xn),te.prototype.wrt=function(){var t,n,n,e,i,t={rank:0,item:10},n=this,n=n.IB.rrt[n.vrt.col];return t=n&&0<n.length&&n[0]instanceof g.Condition&&8===n[0].conType()?{rank:e=n[0].type(),item:i=n[0].expected()}:t},te.prototype.Dn=function(){var t=this.Bot();this.Xc().html(t),this.setStyle(),this.Fz()},te.prototype.Lot=function(t){1===t.value.length?t.value=t.value.replace(/[^1-9]/g,""):t.value=t.value.replace(/\D/g,"")},te.prototype.Fz=function(){var t=this;(0,m.GC$)(Et).bind("keyup",function(){(0,m.GC$)(this).removeClass(Ut),t.Lot(this)}).bind("paste",function(){(0,m.GC$)(this).removeClass(Ut),t.Lot(this)}),t.bindMoveEvent((0,m.GC$)("."+en,t.Wc[0])[0])},te.prototype.Rot=function(){var t,n,e,i,r,t=this,n=parseInt((0,m.GC$)("#top10-rank").val(),10),e=parseInt((0,m.GC$)(Et).val(),10),i=new g.Condition(8),r=!1;return e?(r=!0,i.type(n),i.expected(e),t.tot(i)):(0,m.GC$)(Et).addClass(Ut).focus(),r},te.prototype.Bot=function(){var t="",n="",n=1===this.uY.rank?'<select id="top10-rank"><option value="0">'+N().top+'</option><option value="1" selected = "selected">'+N().bottom+"</option></select>":'<select id="top10-rank"><option value="0" selected="selected">'+N().top+'</option><option value="1">'+N().bottom+"</option></select>";return t+='<div class="gc-popup ui-widget '+$+'"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix gc-spread-filter-dialog-title"><span class="gc-filter-dialog-title">'+N().Top10Filter+'</span><span id="'+this.yrt+'" class="gc-filter-dialog-close">\xd7</span></div><div id="top10-desc"><div class="top10-show-text">'+N().Show+'</div><div class="ui-dialog-hr"></div></div><div class="top10-wrap">'+n+'<input id="top10-item" class="gc-filter-top10-rank" type="text"  value="'+this.uY.item+'" /></div><div class="top10-footer top10-wrap"><input type="button" id="'+this.prt+'" value="'+N().OK+'"><input id="'+this.brt+'" type="button" class="gc-filter-dialog-close" value="'+N().Cancel+'"/></div></div>'},te.prototype.setStyle=function(){(0,m.GC$)(".gc-popup",this.Wc[0]).css([hn,f,T],[dn,this.YC,this.ZC]),(0,m.GC$)(".ui-dialog-titlebar",this.Wc[0]).css({height:"34px",background:"white",fontSize:"12px",fontWeight:"normal",color:"#222",border:"none",borderRadius:"0"}),(0,m.GC$)(".gc-filter-dialog-title",this.Wc[0]).css({float:"left",height:"34px",lineHeight:"34px",display:y,marginLeft:"15px"}),(0,m.GC$)(".top10-show-text",this.Wc[0]).css({float:"left"}),(0,m.GC$)(".ui-dialog-hr",this.Wc[0]).css({position:"absolute",left:"24px",right:"0",margin:"0 5px",height:"12px",borderBottom:Ht,borderWidth:"thin"}),(0,m.GC$)("#top10-desc",this.Wc[0]).css({height:"24px",lineHeight:"24px",marginLeft:"15px",position:K,fontSize:"10px"}),(0,m.GC$)("#"+this.yrt,this.Wc[0]).css({float:"right",fontSize:"18px",width:"36px",height:"34px",lineHeight:"34px",textAlign:"center"}),(0,m.GC$)("#top10-rank",this.Wc[0]).css({width:"120px",marginRight:"20px",height:"21px",textIndent:"5px",fontSize:"inherit",padding:"0",marginBottom:0}),(0,m.GC$)(Et,this.Wc[0]).css({width:"60px",textIndent:"5px",padding:0,height:"21px",margin:0,fontSize:"inherit",display:y}),(0,m.GC$)(".top10-wrap",this.Wc[0]).css({padding:"0px 12px",textAlign:"right",color:"#9B9C9C",fontSize:"13px"}),(0,m.GC$)(".top10-footer",this.Wc[0]).css({padding:"20px 12px 12px"}),(0,m.GC$)("#"+this.prt+", #"+this.brt).css({width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:Gt,padding:0,display:y}),(0,m.GC$)("#"+this.prt,this.Wc[0]).css({marginRight:"12px"})},Ln=te,e(E,Qn=xn),E.prototype.Dn=function(){var t,t,n,t=this.Fot();this.Wc.append(t),t=(0,m.GC$)("#color-spread-wrap",this.Wc[0])[0],this.eU=this.Pot(),n=this.Got(t),this.Uot(t,n),this.Fz(this.Nrt,this.krt)},E.prototype.Pot=function(){return xt},E.prototype.Got=function(t){var n=this.Irt.colorNumber,e,i,r=!1,i=this.Crt*this.Art+4;return Math.ceil(n/this.Art)>this.Trt?(e=this.Srt*this.Art,r=!0,i+=20):e=this.Srt*Math.ceil(n/this.Art),(0,m.GC$)(t).height(e),(0,m.GC$)(t).width(i),r},E.prototype.Hot=function(t,n,e){var i,r,e;t.suspendPaint(),i=t.options,r=n.options,i.showHorizontalScrollbar=!1,i.allowContextMenu=!1,i.showVerticalScrollbar=e,i.scrollbarMaxAlign=!0,i.tabStripVisible=!1,i.allowUserResize=!1,i.allowUserDragDrop=!1,i.allowUserDragFill=!1,i.allowUserZoom=!1,i.grayAreaBackColor="#fff",r.colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor=_t,r.selectionBorderColor=_t,r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.isProtected=!0,n.setColumnCount(this.Art+2),e=this.Irt.colorNumber,n.setRowCount(Math.ceil(e/this.Art)+1),n.defaults.rowHeight=21,n.defaults.colWidth=36,n.setColumnWidth(0,2),n.setColumnWidth(this.Art+1,2),n.setRowHeight(0,2),t.resumePaint()},E.prototype.zot=function(t,n){var e,i,r,o,a;for(a in n.suspendPaint(),e=(this.Art-this.Irt.colorNumber)*this.Crt/2,n.setColumnWidth(0,e),this.Irt.data)this.Irt.data.hasOwnProperty(a)&&(i=(o=this.Vot(i,r)).row,r=o.col,this.Yot(i,r,a,n));n.resumePaint()},E.prototype.Yot=function(t,n,e,i){var r=new B.Button;r.buttonBackColor("{"===e[0]?JSON.parse(e):e),r.marginLeft(3),r.marginTop(3),r.marginRight(3),r.marginBottom(3),i.setCellType(t,n,r,3),e===this.vz&&this.Zot(i,t,n,this.eU)},E.prototype.Vot=function(t,n){return t===p&&n===p?n=t=1:n<this.Art?n+=1:(t+=1,n=1),{row:t,col:n}},E.prototype.Wot=function(t,n){var e,i,r,o;for(o in n.suspendPaint(),i=e=p,this.Irt.data)this.Irt.data.hasOwnProperty(o)&&(e=(r=this.Vot(e,i)).row,i=r.col,this.Yot(e,i,o,n));n.resumePaint()},E.prototype.Zot=function(t,n,e,i){var r,r;t.suspendPaint(),this.Qot&&((r=t.Z_(this.Qot.row,this.Qot.col,3)).backColor="#ffffff",r.borderLeft=new m.LineBorder(c,m.LineStyle.empty),r.borderTop=new m.LineBorder(c,m.LineStyle.empty),r.borderRight=new m.LineBorder(c,m.LineStyle.empty),r.borderBottom=new m.LineBorder(c,m.LineStyle.empty),t.setStyle(this.Qot.row,this.Qot.col,r,3)),this.Qot={row:n,col:e},(r=t.Z_(n,e,3)).backColor=i,r.borderLeft=new m.LineBorder(c,m.LineStyle.thin),r.borderTop=new m.LineBorder(c,m.LineStyle.thin),r.borderRight=new m.LineBorder(c,m.LineStyle.thin),r.borderBottom=new m.LineBorder(c,m.LineStyle.thin),t.setStyle(n,e,r,3),t.resumePaint()},E.prototype.Uot=function(t,n){var t,e,t=new m.Workbook(t);t.xU=!0,e=t.getActiveSheet(),this.Nrt=t,this.krt=e,this.Hot(t,e,n),this.Irt.colorNumber<this.Art?this.zot(t,e):this.Wot(t,e)},E.prototype.Kot=function(){var t,n,t=p;for(n in this.Irt.data)if(this.Irt.data.hasOwnProperty(n)){t=n;break}return"{"===t[0]?JSON.parse(t):t},E.prototype.Fot=function(){var t,n,n,n,e,e,e,t=(0,m.GC$)(d("div")).addClass("gc-popup ui-widget "+St+" "+$+" "+q);return t.css({backgroundColor:"#f0f0f0"}),n=this.Jot(),t.append(n),n=this.Xot(),t.append(n),n=(0,m.GC$)(d("div")).css([A],["0 12px"]),(e=this.qot())!==p&&n.append(e),e=this.$ot(),n.append(e),e=this.tat(),n.append(e),t.append(n),t.append(this.nat()),t},E.prototype.Jot=function(){var t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("span")),e=(0,m.GC$)(d("span")).attr("id",this.yrt);return t.css([f,T,hn,A,rn],["100%","34px","#fff","0 0 0 12px",Dt]),n.css(["float",T,"lineHeight",S],[v,"34px","34px",y]).html(N().ColorTitle),e.css(["float",T,"lineHeight",S,bn,f,"textAlign"],["right","34px","34px",y,"18px","36px","center"]).html("\xd7").addClass(Pt),t.append(n),t.append(e),t.addClass(en),t},E.prototype.Xot=function(){var t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("div")),e;return 0===this.xrt&&this.frt===dt?e=N().SortCell:0===this.xrt&&this.frt===vt?e=N().FilterCell:1===this.xrt&&this.frt===dt?e=N().SortFont:1===this.xrt&&this.frt===vt&&(e=N().FilterFont),t.css(A,"0 12px"),n.css([T,"lineHeight"],["24px","24px"]).html(e),t.append(n),t},E.prototype.qot=function(){var t,n,e,e,t=p;return this.Irt[mt]!==p&&(n=""===this.vz,e=1===this.xrt?N().Automatic:N().NoFill,(e=(0,m.GC$)(d("div")).html(e)).attr("id","gc-color-dialog-noFill"),n?(e.attr(Bt,"checked"),e.css([hn,A,an,"textAlign","margin"],["rgb(134,191,160)","0 12px",Lt,"center","5px 0"])):e.css([hn,A,an,"textAlign","margin"],[_t,"0 12px",Lt,"center","5px 0"]),t=e),t},E.prototype.$ot=function(){var t=(0,m.GC$)(d("div")).attr("id","color-spread-wrap");return t.css([hn,A,an,f,"box-sizing"],["#fff","6px","1px solid rgb(160,160,160)","288px",Ot]),t},E.prototype.tat=function(){var t,n,e,i,r,o,t=this,n=(0,m.GC$)(d("div")),e=(0,m.GC$)(d("div")).html(N().Selected),i=d("canvas"),r=(0,m.GC$)(i).attr("id","gc-color-dialog-selected");return n.css([tt,A,rn,vn,T],[K,"0 12px",Ot,"12px 0","16px"]),e.css([J,f,"text-align"],[v,"60px","center"]),o=1===t.xrt?Nt:kt,t.vz===p&&(t.vz=t.Kot()),""!==t.vz&&(o=t.vz),r.css([tt,v,an],["absolute","70px",Lt]),i.width=188,i.height=16,t.eat(r,o),n.append(e),n.append(r),n},E.prototype.eat=function(t,n){var n,e,t,n=typeof n===qt?JSON.stringify(n):n;t.text(n),e=t[0].getContext("2d"),t=function(){e.fillRect(0,0,188,16)},m.W.setFillStyle(e,"{"===n[0]?JSON.parse(n):n,0,0,188,16,t)},E.prototype.Rot=function(){var t,t=(0,m.GC$)(Ft),t=1===t.length&&"checked"===t.attr(Bt)?"":this.vz;return this.iat(t),!0},E.prototype.iat=function(t){var n=0===this.xrt;this.frt===dt?this.rat(t,n):this.frt===vt&&this.oat(t,n)},E.prototype.rat=function(t,n,e){var i,r,o,i,r,a,i=this,r=i.vrt,o=r.rowFilter,i=i.Mf;o&&i&&i._B()&&(e=e!==p&&e,r=r.col,a={sheet:i,sheetName:i.Zc,col:r,ascending:e,color:t,isBackColor:n,cancel:!1},i.ki(m.Events.RangeSorting,a),!1===a.cancel)&&(i.suspendPaint(),o.sortColumnByColor(r,e,t,n),i.resumePaint(),i.ki(m.Events.RangeSorted,a))},E.prototype.oat=function(t,n){var e,i,e=new g.Condition(3),i;e.compareType(n?0:1),e.expected(t),this.tot(e)},E.prototype.Fz=function(t,r){var o=this;(0,m.GC$)(Ft).bind(I,function(){var t=1===o.xrt?Nt:kt;o.eat((0,m.GC$)(Rt),t),(0,m.GC$)(this).css(hn,"rgb(134,191,160)"),(0,m.GC$)(this).attr(Bt,"checked")}),t.bind(m.Events.ButtonClicked,function(t,n){var e,n,i,e,e=n.row,n=n.col,i=r.getCellType(e,n);o.Zot(r,e,n,o.eU),e=i.buttonBackColor(),o.eat((0,m.GC$)(Rt),e),(0,m.GC$)(Ft).css(hn,_t).attr(Bt,""),o.vz=e}),t.bind(m.Events.TouchToolStripOpening,function(t,n){n.handled=!0}),o.bindMoveEvent((0,m.GC$)("."+en,o.Wc[0])[0])},E.prototype.nat=function(){var t,n,e,i,t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("input")).attr({type:"button",value:N().OK,id:this.prt}),e=(0,m.GC$)(d("input")).attr({type:"button",value:N().Cancel,id:this.brt}).addClass(Pt),i={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:Gt,padding:"0",display:y,margin:"0"};return t.addClass("color-custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),n.css(i).css({marginRight:"12px"}),e.css(i),t.append(n[0]),t.append(e[0]),t},Bn=E,e(R,Jn=xn),R.prototype.Dn=function(){var t=this,n=t.aat(this.uY);t.Wc.append(n),(0,m.GC$)(".gc-popup",this.Wc[0]).addClass("gc-spread-filter-custom-dialog"),t.Fz()},R.prototype.Fz=function(){var o=this;(0,m.GC$)(nn).bind("change",function(){var t=(0,m.GC$)(this).find("option")[this.selectedIndex];(0,m.GC$)(this).parent().find("input").val((0,m.GC$)(t).text()).attr("gc-data",(0,m.GC$)(this).val())}),1e4<o._rt.length&&(o.Oot=function(){var t,n,t=o.uat;if(t)for(n=0;n<t.length;n++)t[n].workbook.destroy();(o.uat=null,m.GC$)("#first-condition-expected input, #sec-condition-expected input").remove(),(0,m.GC$)(nn).remove(),(0,m.GC$)(".gc-filter-dialog-style").remove(),(0,m.GC$)(".filter-custom-select-first-option").remove()},(0,m.GC$)(nn).bind("mousedown",function(t){var n,e,i,r;if(t.preventDefault(),t.stopPropagation(),n=(0,m.GC$)(this).parent().find("div")[0],e=o.uat,n&&e)for(i="none"===n.style.display,r=0;r<e.length;r++)e[r].container===n?(e[r].container.style.display=i?"block":"none",i&&e[r].workbook.refresh()):e[r].container.style.display="none"}),(0,m.GC$)(".gc-filter-dialog-style").bind("mousedown",function(t){for(var n,e,i,n=o.uat,i=0;i<n.length;i++)(e=n[i].container).contains(t.target)||(e.style.display="none")})),(0,m.GC$)(".filter-custom-select-first-option").bind("click",function(t){t.stopPropagation(),t.preventDefault(),(0,m.GC$)(this).parent().trigger("change")}),(0,m.GC$)("#first-condition-expected input, #sec-condition-expected input").bind("change",function(){var e,i,e=(0,m.GC$)(this).val(),i=-1;o._rt.forEach(function(t,n){t.text===e&&(i=n)}),""===e&&((0,m.GC$)(this).parent().find("select")[0].value=""),(0,m.GC$)(this).attr("gc-data",i)}),o.bindMoveEvent((0,m.GC$)("."+en,o.Wc[0])[0])},R.prototype.cat=function(t,n,e){var i,r,t,t,t,o,i=t.val(),t=t.attr("gc-data");return 2===n&&-1===Number(t)?i:(t=this._rt[t])?2===n?t.text:t.value:11!==n||isNaN(Number(i))?(t={},(o=new G).getPreferredDisplayFormatter(i,t),t.value):parseFloat(i)},R.prototype.Rot=function(){var t,n,n,e,t=this,n=parseInt((0,m.GC$)("#filter-logical-wrap input:checked").val(),10),n=t.fat(n),e=!1;return t.tot(n),n?e=!0:(0,m.GC$)("#first-condition-type").focus(),e},R.prototype.aJ=function(t,n){var t,e,n,t,t,t=t.val().trim();return t?(e=parseInt(t.split("-")[0],10),t=parseInt(t.split("-")[1],10),n=this.cat(n,t,e),t=new g.Condition(t),this.eot(n)&&t.conType(2),t.compareType(e),"string"===V(n)&&(n=Y(n)),t.expected(n),t.treatNullValueAsZero(!1),t.ignoreCase(!0),"string"===V(n)&&-1===n.indexOf("*")&&-1===n.indexOf("?")?t.useWildCards(!1):"string"!==V(n)||-1===n.indexOf("*")&&-1===n.indexOf("?")||(t.conType(2),t.useWildCards(!0)),t):h},R.prototype.fat=function(t){var n,e,i,n=this.aJ((0,m.GC$)("#first-condition-type"),(0,m.GC$)("#first-condition-expected input")),e=this.aJ((0,m.GC$)("#sec-condition-type"),(0,m.GC$)("#sec-condition-expected input"));return n?(e?((i=new g.Condition(0)).compareType(t),i.item1(n),i.item2(e)):i=n,i):null},R.prototype.hat=function(){var t=this.vrt,n=t.rowFilter,e=this.Mf.getText(t.row,t.col);return e=n&&n.range.row<=0?this.Mf.getText(t.row,t.col,t.sheetArea):e},R.prototype.aat=function(t){var n,e,n,n,t,n,i;return this.uat=[],n=this.hat(),(e=(0,m.GC$)(d("div")).addClass("gc-popup ui-widget "+$)).css({backgroundColor:"#f0f0f0"}),e.append(this.dat()),e.append(this.vat(n)),n=this.mat("first-condition-type","first-condition-expected",t.compareType1||0,t.expected1,t.conType1,!0),e.append(n),e.append(this.gat(t.logic)),n=this.mat("sec-condition-type","sec-condition-expected",t.compareType2,t.expected2,t.conType2),e.append(n),t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("p")).html(N().Explain1).css({margin:"0",lineHeight:"initial",backgroundColor:_t}),i=(0,m.GC$)(d("p")).html(N().Explain2).css({margin:"0",lineHeight:"initial",backgroundColor:_t}),t.append(n),t.append(i),t.css({fontSize:"10px",textIndent:"12px"}),e.append(t),e.append(this.pat()),e},R.prototype.mat=function(t,n,e,i,r,o){var a=(0,m.GC$)(d("div")),e;return a.addClass("gc-spread-filter-dialog-condition"),a.append(this.bat(e,r,o).attr("id",t)),e=(1e4<this._rt.length?this.yat(this._rt,i):this.wat(this._rt,i)).attr("id",n),a.append(e),a},R.prototype.dat=function(){var t='\n            <div class="gc-spread-filter-dialog-title">\n                <span class="gc-spread-filter-dialog-title-text">'.concat(N().CustomTitle,'</span>\n                <span id="').concat(this.yrt,'" class="gc-spread-filter-dialog-title-close ').concat(Pt,'">').concat("\xd7","</span>\n            </div>\n        ");return(0,m.GC$)(U(t))},R.prototype.gat=function(t){var n=(0,m.GC$)(d("div")),e=(0,m.GC$)(d("input")).attr({name:"filter-logical",id:"filter-dialog-and",type:"radio"}).val(1).css([f,S],["unset",y]),i=(0,m.GC$)(d("input")).attr({name:"filter-logical",id:"filter-dialog-or",type:"radio"}).val(0).css([f,S],["unset",y]),r=(0,m.GC$)(d("label")).attr({for:"filter-dialog-and"}).html(N().And).css([pn,"font-weight",bn,S,"margin-bottom",A],["10px","inherit","13px",y,"0","0"]),o=(0,m.GC$)(d("label")).attr({for:"filter-dialog-or"}).html(N().Or).css([pn,"font-weight",bn,S,"margin-bottom",A],["10px","inherit","13px",y,"0","0"]);return n.attr("id","filter-logical-wrap"),n.css({padding:"0 0 0 40px",height:"30px"}),0===t?(i.prop("checked",!0),e.prop("checked",!1)):(i.prop("checked",!1),e.prop("checked",!0)),n.append(e),n.append(r),n.append(i),n.append(o),n},R.prototype.vat=function(t){var n,e,e,i,t,n=(0,m.GC$)(d("div")),e=(0,m.GC$)(d("div")).html(N().ShowRows);return n.css(A,"0 12px"),e.css([T,"lineHeight"],["24px","24px"]),n.append(e),e=(0,m.GC$)(d("div")),i=(0,m.GC$)(d("div")),t?((t=(0,m.GC$)(d("div")).html(z(t))).css([J,"maxWidth","textOverflow","whiteSpace","overflow"],[v,"300px","ellipsis","nowrap","hidden"]),e.css({height:"24px",lineHeight:"24px",marginLeft:"15px",fontSize:"10px"}),i.css({overflow:"hidden",margin:"0 5px",height:"12px",borderBottom:Ht,borderWidth:"thin"}),e.append(t)):(e.css({height:"12px",lineHeight:"2px",marginLeft:"15px",fontSize:"10px"}),i.css({margin:"0 5px",height:"2px",borderBottom:Ht,borderWidth:"thin"})),e.append(i),n.append(e),n},R.prototype.bat=function(t,n,e){var i,r,o,a,u,s,c,f,i=[],r=!1;for(i=6===this.Ert||5===this.Ert?jn:1===this.Ert?_n:Dn,o=t===p?'<option selected="selected" >&nbsp;</option>':"<option>&nbsp;</option>",s=!1,c=0;c<i.length;c++)u=!1,(u=(a=i[c].split("-"))[2]&&(s=!1,s=n===parseInt(a[2],10)||6===this.jrt&&5===parseInt(a[2],10)||11===parseInt(a[2],10)||n===parseInt(a[3],10)||s)&&t===parseInt(a[1],10)?!0:u)&&(r=!0),o+="<option ".concat(u?'selected="selected"':"",' value="').concat(a[1]+"-"+a[2],'" style="height:20px">').concat(N()[a[0]],"</option>");return(f=(0,m.GC$)(d("select"))).addClass("gc-spread-filter-dialog-custom-select"),f[0].innerHTML=o,!r&&e&&(0,m.GC$)((0,m.GC$)("option",f[0])[1]).attr("selected","selected"),f},R.prototype.Mat=function(t){var t=z(t);return t=t&&100<t.length?t.substr(0,100)+"...":t},R.prototype.wat=function(t,n){for(var e,i,r,o,a,u,s,c,f,f,e=-1,i=n,o="",a=!0,u=N().Blanks,s=0;s<t.length;s++)t[s].text===u&&t[s].value===h||(c=this.Mat(t[s].text),"date"===V(t[s].value)&&(r=r||l.Fe(l.culture()).DateTimeFormat,c=H.Pe(t[s].value,r.shortDatePattern)),t[s].value+""==n+""&&(e=s,i=c),c=c.replace(/\s/g,"&nbsp;"),a?(o+='<option class="filter-custom-select-first-option" value="'+s+'">'+c+"</option>",a=!a):o+='<option value="'+s+'">'+c+"</option>");return"date"===V(i)&&(r=r||l.Fe(l.culture()).DateTimeFormat,i=H.Pe(i,r.shortDatePattern)),f='\n            <div class="gc-spread-filter-dialog-value-select-wrap">\n                <select class="filter-custom-select-input gc-spread-filter-dialog-value-select">'.concat(o,'</select>\n                <input class="gc-spread-filter-dialog-value-select-input" gc-data=').concat(e,"></input>\n            </div>\n        "),(f=(0,m.GC$)(U(f))).find(".gc-spread-filter-dialog-value-select-input").val(i),f.find(".gc-spread-filter-dialog-value-select")[0].selectedIndex=-1,f},R.prototype.yat=function(t,n){var e,i,r,o,a,u,u,e=n,r,o=(0,m.GC$)(U('\n            <div class="gc-spread-filter-dialog-value-select-wrap">\n                <div class="gc-spread-filter-dialog-value-select-spread"></div>\n                <select class="filter-custom-select-input gc-spread-filter-dialog-value-select">\n                    <option value="0">0</option>\n                </select>\n                <input class="gc-spread-filter-dialog-value-select-input"></input>\n            </div>\n        ')),a=o.find(".gc-spread-filter-dialog-value-select-input"),u=o.find(".gc-spread-filter-dialog-value-select-spread");return u.css(S,on),this.Cat(u[0],t,n,u=function(t){a.val(t)}),"date"===V(e)&&(i=i||l.Fe(l.culture()).DateTimeFormat,e=H.Pe(e,i.shortDatePattern)),u(e),o},R.prototype.Cat=function(e,t,n,i){var r,r,o,o,a,a,r=new m.Workbook(e,{allowContextMenu:!1,showHorizontalScrollbar:!1,showVerticalScrollbar:!0,scrollbarMaxAlign:!0,tabStripVisible:!1,allowUserResize:!1,allowUserDragDrop:!1,allowUserDragFill:!1,allowUserZoom:!1,grayAreaBackColor:"white",sheetCount:1});this.uat.push({container:e,workbook:r}),o=(r=r.getActiveSheet()).options,r.suspendPaint(),o.colHeaderVisible=!1,o.rowHeaderVisible=!1,o.selectionBackColor="transparent",o.selectionBorderColor="transparent",o.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},o.isProtected=!0,r.defaults.rowHeight=17,r.defaults.colWidth=540,r.setRowCount(t.length),(o=new m.Style).foreColor="white",o.backColor="#1E90FF",a=new m.Range(-1,0,-1,1),r.cellStates.add(a,1,o),r.autoGenerateColumns=!1,r.bindColumn(0,"text"),r.setDataSource(t),r.setColumnCount(1),r.bind(m.Events.CellClick,function(t,n){e.style.display="none";var n=n.sheet.getValue(n.row,n.col);i(n)}),(a=new m.Style).vAlign=1,r.setStyle(-1,0,a),r.resumePaint()},R.prototype.pat=function(){var t,n,e,i,t=(0,m.GC$)(d("div")),n=(0,m.GC$)(d("input")).attr({type:"button",value:N().OK,id:this.prt}),e=(0,m.GC$)(d("input")).attr({type:"button",value:N().Cancel,id:this.brt}).addClass(Pt),i={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:Gt,padding:0,display:y};return t.addClass("custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),n.css(i).css({marginRight:"12px"}),e.css(i),t.append(n[0]),t.append(e[0]),t},R.prototype.Rrt=function(t){var n,e,i,n=this,e=n.IB.rrt[n.vrt.col],i={conType1:2,conType2:p,compareType1:0,compareType2:p,expected1:p,expected2:p,logic:1};e=e&&e.length&&e[0]instanceof g.Condition?e[0]:h,n.uY=n.Sat(i,t,e)},R.prototype.Tat=function(t,n){var e,i,r,t,o,e=l.Fe(l.culture()).DateTimeFormat,i={},r=t.expectTypeId();if(0===r)i=t.getExConditionDateScope(t.expected());else if(6===r)t=new Date,o=new Date,t.setMonth(0,1),t.setHours(0,0,0,0),o.setHours(23,59,59,999),i={from:t,to:o};else if(3===r)return n.conType1=this.jrt,n.compareType1=this.Ort,n.expected1=p,n;return n.conType1=5,n.conType2=5,n.compareType1=5,n.compareType2=2,n.expected1=H.Pe(i.from,e.shortDatePattern),n.expected2=H.Pe(i.to,e.shortDatePattern),n},R.prototype.Sat=function(t,n,e){var i,r,o,a,u,a,u,i=e&&(e.conType()===this.Ert||11===e.conType()&&(1===this.Ert||2===this.Ert)),r=e&&(e.compareType()===this.Ort||0===e.conType());return!e||1!==n||6!==e.conType()||0!==e.expectTypeId()&&6!==e.expectTypeId()&&3!==e.expectTypeId()?(o=!0,1===this.jrt&&e&&0===e.conType()&&(a=e.item1().compareType(),u=e.item2().compareType(),5===Math.max(a,u)&&3===Math.min(a,u)||(o=!1)),1===n||i&&r&&o?e&&0===e.conType()?(this.Ert=this.jrt,t.conType1=e.item1().conType(),t.conType2=e.item2().conType(),t.compareType1=e.item1().compareType(),t.compareType2=e.item2().compareType(),t.expected1=e.item1().expected(),t.expected2=e.item2().expected(),t.logic=e.compareType()):e&&0!==e.conType()&&3!==e.conType()&&(a=e.compareType(),u=e.conType(),t.conType1=u,t.expected1=e.expected(),t.compareType1=a):0===this.Ert?(this.Ert=this.jrt,1===this.jrt?(t.conType1=1,t.conType2=1,t.compareType1=3,t.compareType2=5):5===this.jrt&&(t.conType1=5,t.compareType1=5,t.conType2=5,t.compareType2=3)):1===this.Ert&&this.Aat(e)?(t.conType1=this.jrt,t.compareType1=this.Ort,t.expected1=e.expected()):(t.conType1=this.jrt,t.compareType1=this.Ort,t.expected1=p),t):this.Tat(e,t)},R.prototype.eot=function(t){return t!==p&&"TRUE"===t||"FALSE"===t},R.prototype.Aat=function(t){var n,e;return!!t&&(n=!1,e=t.expected(),!(1!==t.conType()||!this.eot(e))||n)},Pn=R},"./dist/plugins/filter/filter-ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/filter/filter.res.en.js");n.SR={en:e}},"./dist/plugins/filter/filter-ui.js":function(i,r,t){"use strict";var B,a,x,P,G,U,H,o,t,V,z,Y,Z,d,u,c,w,s,N,h,W,Q,J,v,K,X,q,$,tt,nt,et,it,rt,n,ot,at,ut,l,st,ct,f,ft,lt,ht,dt,vt,mt,gt,pt,bt,m,g,wt,yt,p,Mt,Ct,St,Tt,At,b,It,xt,Nt,kt,y,_t,M,Dt,jt,C,Ot,S,T,A,I,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,k,Kt,_,D,Xt,qt,j,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,O,dn,vn,mn,gn,pn,bn,wn,yn,Mn,Cn,Sn,Tn,n,E,An,In,xn,n,n,Nn;function kn(t,n,e,i,r,o,a,u){var s=this;s.rowFilter=t,s.row=n,s.col=e,s.sheetArea=i,s.x=r,s.y=o,s.width=a,s.height=u}function R(t,n){(0,x.GC$)(t).addClass(n)}function _n(t,n){return"object"==typeof t?JSON.stringify(t):(t=n.getColor(t),a.Common.ft.j(a.Common.ft._(t)))}function Dn(t,n){var e,i,r,t,n,e,o,e={date:0,number:1,string:2,boolean:3,blank:4},i=t.value,r=n.value,t=t.type,n=n.type;if(t!==n)return e[t]<e[n]?-1:1;if("date"===t&&"date"===n){if((e=i.getFullYear())<(o=r.getFullYear()))return 1;if(o<e)return-1}return"string"===t&&"string"===n&&(i=i.toLowerCase(),r=r.toLowerCase()),r<i?1:i<r?-1:0}function jn(t,n,e,i,r){var o;t?(o=void 0,"string"==typeof t?(o=r[t])===j&&(o=r[t]=_n(t,e)):o=JSON.stringify(t),n.data[o]===j&&n.colorNumber++,n.data[o]=i):n[$t]=$t}function F(t,n){(0,x.GC$)(t).removeClass(n)}function On(t,n,e){t.css([A,I],[n+m,e+m])}function En(t){(0,x.GC$)(t).css([Et,M,C,"outline"],[0,0,0,T])}function L(t){return t.concat([])}function Rn(t,n){var e,i,e,i,r,i,o;if(N(t)||""===t||"number"==typeof t&&isNaN(t))return"blank";if(e=Wt(t),i="number"==typeof t,"General"===n||N(n)){if(e)return"date"}else if(!z(n)&&(e||i))return e=/d|D|m|M|y|Y|z|Z|g|G|e/,r=(i=n instanceof a.Formatter.FormatterBase)?n:new a.Formatter.GeneralFormatter(n),i=Fn(i=i?n.formatString():n),(o=e.test(i)&&!(r.hasFormattedColor&&r.hasFormattedColor())&&!("General"===i||""===i||void 0===i))?"date":"number";return Yt(t)}function Fn(t){var n,e;return t&&(e=/:mm|:m|mm:|m:/gi,t=(t=t.replace(n=/AM\/PM/gi,"")).replace(e,"")),t}function Ln(t){for(var n,e,i,r,o,n="",e=!1,i=0,r=t.length;i<r;i++)'"'===(o=t[i])&&(e=!e),"E"===o||e||(n+=o.toLowerCase());return n}function Bn(t,n,e,i,r){var t,o,a,u,s,t;if(n&&t)return s=[],(t=t.format(e))&&(o=(t=t.split("/"))[0]||"",a=t[1]||"",u=t[2]||""),s.push({value:o,level:0,status:i}),s.push({value:a,level:1,status:i}),s.push({value:u,level:2,status:i}),{key:n,value:e,children:s,status:i,type:r}}function Pn(t,n,e,i,r,o,a,u){var s,c;if(n)return(s=[]).push({value:n,level:t.outlineColumn&&t.outlineColumn.Un(r)?t.getCell(i,r).textIndent():0,status:o}),(c=t.NMi)&&c._Ni&&t.outlineColumn&&t.outlineColumn.Un(r)&&(s[0].level=c._Ni(i,r),N(u)||(s[0].status=o=Sn[!u])),{key:n,value:e,children:s,status:o,type:a}}function Gn(t){var n,e,i,e,e,r,i,e,e,t,r;if(N(t)&&(t=""),(e=(n=new a.Formatter.GeneralFormatter(t)).formatters)&&!(e.length<=0)&&(i=e[0]))return e=(e=a.Common.CultureManager.getCultureInfo())&&e.id,r=i.localeIDFormatPart,i=i.dbNumberFormatPart,e=r&&r.Iat||e,e=a.Common.CultureManager.xat(e,Ln(t)),t=r&&r.Nat||"",r=i&&i.Nat||"",new a.Formatter.GeneralFormatter(r+t+e)}function e(t,n,e,i,r){var o,a,t,o=this,a=n.parent;return(o=Nn.call(this,t,u.gi(a&&a.Ti))||this).jTe=x.DialogFeatureType.filter,(t=o).kat={},t._rt=[],t.Dat=[],t._at=[],t.Eat=[],t.jat=[],t.Oat=[],t.Rat=[],t.Bat=!1,t.Lat=0,t.Fat=!1,t.Pat={Number:0,Text:0,Date:0},t.Gat="",t.Uat=s,t.sheet=n,t.filterButtonInfo=e,t.Vat=26,t.Yat=191,t.Zat=150,t.Wat=1.2,t.Hat=237,t.zat=410,r&&(t.Zue=u.w1({},r)),t.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,t.elementList=[],t.activeItemIndex=s,t.Wc=t.Xc(),t.Qat=t.Kat(),t.Jat=t.Xat(),t.qat=i,t.$at=t.tut(),t.nut(),t.eut(),o}B=this&&this.__extends||(xn=function(t,n){return(xn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}xn(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(r,"__esModule",{value:!0}),r.iut=r.rut=void 0,a=t("Common"),x=t("Core"),P=t("./dist/plugins/filter/filter-dialog.js"),G=t("ConditionalFormatting"),U=t("CellTypes"),H=t("./dist/plugins/filter/filter.js"),o=t("./dist/plugins/filter/filter-button-images.js"),t=t("./dist/plugins/filter/filter-ns.js"),V=a.Common.$T,z=x.mt.St,Y=a.Common.zf.j0,Z=a.Formatter.Hf,d=x.mt.En,u=x.mt,c=u.vi,w=a.Common.Uf.tR,s=null,N=a.Common.lt.ht,h=parseFloat,W=x.GC$.inArray,Q="gc-sortASC",J="gc-sortDES",v="gc-filterOK",K="gc-filterCancel",X="gc-filterSearch",q="gc-filterCheckAll",$="gc-filterUnCheckAll",tt="gc-filter-item-container",et="gc-filter-button",it="gc-filter-item-link ",rt="gc-filter-sort",ot="gc-filter-button-hover "+(n="ui-state-hover "),l=(nt="gc-filter-hover")+" form-control well "+(ut=n+(at="gc-filter-item-hover")),st=" ui-corner-all ",ct="ui-button-disabled",f=" ui-state-disabled",ft="gc-filter-button-disable",lt="gc-sub-color-filter",ht="gc-sub-content-flter",dt="gc-sub-color-sort",vt="gc-no-user-select",mt=" gc-filter-check",gt="gc-filter-check-outerDiv",pt="gc-filter-button-active",bt=".ui-filter-dialog",m="px",g="font-size",wt="string",yt="mouseout",p="click",Mt="keydown",Ct="keyup",St="search",Tt="input",At="span",b="div",It="button",xt="DOMMouseScroll",Nt="mousewheel",kt="mousedown",y="mouseover",_t="mouseup",Dt=(M="margin")+"Left",jt=M+"Top",Ot=(C="padding")+"Top",S="display",T="none",A="width",I="height",Et="border",Rt="position",Ft="absolute",Lt="background-color",Bt="left",Pt="top",Gt="box-sizing",Ut="content-box",Ht="block",Vt="gc-filter-button-container",zt="gc-filter-dialog-resizable",Yt=a.Common.lt.Oh,Zt=a.Common.ct.Y0,Wt=a.Common.ct.W0,Qt="gc-sortASC-tr",Jt="gc-sortDEC-tr",k="gc-sort-color-tr",Kt="clear_filter",_="gc-color-filter",D="gc-major_filter",Xt="gc-search-tr",qt="gc-filter-function-tr",j=void 0,$t="automatic",tn="gc-async-process-tr",nn="TextFilter",en="NumberFilter",rn="DateFilter",on="gc-filter-choose-area",an="filter-button-tr",un="gc-filter-dialog-style",sn="gc-sortColor",cn="gc-filter-color",fn="gc-clearFilter",ln="gc-majorFilter",hn="gc-filterDialog-rightArrow",O="gc-filter-disable-item",dn=500,vn=100,mn=20,gn=10,pn=30,bn=5e4,wn=237,yn=410,Mn=191,Cn=150,(n=Sn=Sn||{})[n.true=1]="true",n[n.false=2]="false",n[n[void 0]=2]="undefined",n[n.null=3]="null",(n=Tn=Tn||{})[n.false=0]="false",n[n.true=1]="true",n=new a.Common.ResourceManager(t.SR,"Filter"),E=n.getResource.bind(n),kn.prototype.jt=function(){var t=this,n=t.rowFilter,t=t.col,e=n.getSortState(t);return n?n.isFiltered(t)?[3,4,5][e]:e:0},r.rut=kn,Nn=x.zc,B(e,Nn),e.prototype.tut=function(){var t,n,e,i,r,t=this,n=[],e=this.qat,i=t.zat,r=t.Vat;return e.sortByValue?n=n.concat([1,1]):(n=n.concat([0,0]),i-=2*r),e.sortByColor?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.filterByValue||!0===e.filterByColor?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.filterByColor?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.filterByValue?n=n.concat([1]):(n=n.concat([0]),i-=r),!0===e.listFilterArea?n=n.concat([1,1,1,1]):(n=n.concat([0,0,0,0]),i-=254),t.zat=i,n},e.prototype.rQ=function(){var t,n,e,i,r,n,t=this,n=t.sheet.parent,e=t.filterButtonInfo,i=t.qat,r=t.Wc;t.aut=!!n&&n.options.useTouchLayout,(i.filterByValue||i.listFilterArea||i.sortByColor||i.filterByColor)&&(t.uut(e.col),t.sut(),t.fut(),t.lut()),1===(0,x.GC$)("#"+D).length&&(t.hut=t.dut((0,x.GC$)("#"+D)[0].children[2]),t.hut.Vrt(t.Gat).Hc()),1===(0,x.GC$)("#"+_).length&&(t.vut=t.mut((0,x.GC$)("#"+_)[0].children[2],lt),t.vut.Hc()),1===(0,x.GC$)("#"+k).length&&(t.gut=t.mut((0,x.GC$)("#"+k)[0].children[2],dt),t.gut.Hc()),r.hide(),t.$c(function(){0<t.elementList.length&&(0,x.GC$)(t.elementList[0]).focus()}),t.put(t.aut),n=e.x+e.width-237-6,r.css([Bt,Pt],[n=n<5?5:n,e.y+e.height]),t.if(),t.use(),t.aY(),t.but(),setTimeout(function(){t.Wc.focus()}),t.sheet.rt.u2()},e.prototype.if=function(){var t,n,e,t,e,i,r,o,a,i,u,e,a,t=this,n=t.Wc;0===n.length||(e=t.sheet.parent,t=t.filterButtonInfo,e=e.getHost().getBoundingClientRect(),i=n[0].getBoundingClientRect(),r=parseInt(n.css("left"),10),o=parseInt(n.css("top"),10),a=i.width,i=i.height,isNaN(r))||isNaN(o)||isNaN(a)||isNaN(i)||(a=!1,(u=0)<(u=(e=e.height)<o+i?o+i-e:u)&&(0<t.y-i?o=t.y-i:(o-=u,a=!0)),n.css({left:r+"px",top:(o=o<0&&!a?0:o)+"px"}))},e.prototype.yut=function(){var t;1===(0,x.GC$)("#"+D).length&&(t=(0,x.GC$)("#"+D)[0],(0,x.GC$)(t).addClass(O+f))},e.prototype.sut=function(){var t=this;t.itemList&&0<t.itemList.length?t.wut(t.dataSource):t.sheet.endEdit()},e.prototype.put=function(t){var n,t,e,i,r,t,e,t,e,n,o,a,u,s,c,f,r,l,i,n=this;t&&(t=n.Hat*n.Wat,e=n.zat*n.Wat,i=t-n.Hat,r=e-n.zat,On(n.Wc,t,e),t=(0,x.GC$)("."+rt),e=h(t.css(Ot))+r/30,t.css(C,e+m+" 6px"),n.qat.listFilterArea)&&(t=(0,x.GC$)("."+et),e=h(t.css(A))+i/4,n=h(t.css(I))+r/8,o=(0,x.GC$)("#"+v),a=h(o.css(Dt))+i/2,u=(0,x.GC$)("#"+X),s=h(u.css(A))+i,c=h(u.css(I))+r/8,f=(0,x.GC$)("."+gt),r=h(f.css(jt))+r/10,l=(0,x.GC$)("#"+$),i=h(l.css(Dt))+i,On(t,e,n),o.css(Dt,a+m),On(u,s,c),f.css(jt,r+m),l.css(Dt,i+m))},e.prototype.close=function(){var t,n,e,n=this,e=n.sheet;n.Wue&&n.Wue.disconnect(),n.Wue=s,null!=(t=n.Zue)&&t.keepDialogSize&&n.qat.listFilterArea&&(n.filterButtonInfo.rowFilter.dialogOptions=u.w1({},u.w1(n.Zue,{dialogWidth:n.Wc[0].clientWidth,dialogHeight:n.Wc[0].clientHeight}))),n.Wc.hide(),n.Mut&&(n.Mut.L0(),n.Mut=null),Nn.prototype.close.call(n),(0,x.GC$)(n._itemSpanElement).remove(),(0,x.GC$)(n._itemInputElement).remove(),e.Cut=null,e&&e.rt&&e.rt.aA()},e.prototype.Sut=function(){1===(0,x.GC$)("#"+Qt).length&&this.Tut(),1===(0,x.GC$)("#"+k).length&&this.Aut()},e.prototype.Tut=function(){var t,n,e,t,i,r,t=this,n=t.elementList,e=t.Iut(Q,E().SortAscending),t=t.Iut(J,E().SortDescending),i=(0,x.GC$)("#"+Qt)[0],r=(0,x.GC$)("#"+Jt)[0];(0,x.GC$)(i.children[0]).append((0,x.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(6))),(0,x.GC$)(r.children[0]).append((0,x.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(7))),(0,x.GC$)(i.children[1]).append(e),(0,x.GC$)(r.children[1]).append(t),n.push(i),n.push(r)},e.prototype.Aut=function(){var t,n,e,i,t,t,r,t=this,n=t.elementList,e=t.Iut(sn,E().SortColor),i=(0,x.GC$)("#"+k)[0],t=t.xut(),t=this.Nut(t),r=(0,x.GC$)(d("span"));r.addClass(hn),(0,x.GC$)(i.children[0]).append(t),(0,x.GC$)(i.children[1]).append(e),(0,x.GC$)(i.children[2]).append(r),n.push(i)},e.prototype.kut=function(t){var n,e,n,i,r,t,n=this,e=n.elementList,n=n.Iut(cn,E().FilterColor),i=(0,x.GC$)("#"+_)[0],r=(0,x.GC$)(d("span"));r.addClass(hn),t=this.Nut(t.isShowColorFilterSelect),(0,x.GC$)(i.children[0]).append(t),(0,x.GC$)(i.children[1]).append(n),(0,x.GC$)(i.children[2]).append(r),e.push(i)},e.prototype.Dut=function(t){var n,e,i,t,r,o,a,e,n=this,e=n.sheet,i=n.filterButtonInfo.col,t=n.Nut(t.isShowMajorCheck),r=(0,x.GC$)("#"+D)[0],o;e.outlineColumn&&e.outlineColumn.Un(i)&&(0,x.GC$)(r).addClass(O+f),(0,x.GC$)(r.children[0]).append(t),(a=n.Iut(ln,"")).appendTo(r.children[1]),(e=(0,x.GC$)(d("span"))).addClass(hn),(0,x.GC$)(r.children[2]).append(e),n.elementList.push(r)},e.prototype._ut=function(){var t,n,e,i,r,i,t=1===(0,x.GC$)("#"+_).length,n=1===(0,x.GC$)("#"+D).length;(t||n)&&(i=(e=this).elementList,r=(0,x.GC$)("#"+Kt)[0],e.Eut(r),i.push(r),i=e.jut(),t&&e.kut(i),n)&&e.Dut(i)},e.prototype.Out=function(){var t=this;t.qat.listFilterArea&&(t.Rut(),t.But(),t.Lut(),t.Fut())},e.prototype.Fut=function(){var t=et+" gc-filter-button-default ui-button ui-state-default"+st+"btn btn-default",n=(0,x.GC$)("#"+an)[0],e=d(It),i=d(It),r=(0,x.GC$)(e).text(E().OK).css(g,"1em").attr("id",v),o=(0,x.GC$)(i).text(E().Cancel).css(g,"1em").attr("id",K);R(e,t),R(i,t),(0,x.GC$)(n.children[1]).append(r).append(o).addClass(Vt),this.elementList.push(e),this.elementList.push(i)},e.prototype.But=function(){var t,n,e,n,t,t=this,n=(0,x.GC$)("#"+tn),e=n[0].children[1];n.css([S,Rt],[T,Ft]),n=(0,x.GC$)(d(At)).css([A,I,M,Et,S],[t.Yat,2,"-5px 0 0 4px","solid 1px #A7ABB0",Ht]),t=t.Put=(0,x.GC$)(d(At)).css([A,I,Lt,S],[0,2,"#A7ABB0",Ht]),(0,x.GC$)(n).append(t),(0,x.GC$)(e).append(n)},e.prototype.Lut=function(){var t,n,e,i,n,t=this,n=t.jut(),e=(0,x.GC$)("#"+on)[0],i=(0,x.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(11)).addClass("gc-filter-checked");i.css(["verticalAlign","margin-top"],["top","4px"]),n.isShowSelectCheck||i.css([S],[T]),R((n=t.itemList=(0,x.GC$)(d(b)).css([A,I,Gt],[t.Yat,t.Zat,Ut]))[0],tt),(0,x.GC$)(e.children[0]).append(i).css([S],["inline-block"]),(0,x.GC$)(e.children[1]).append(n)},e.prototype.Rut=function(){var t,n,e,i,e,e,r,o,t=this,n=(0,x.GC$)(d(b)).css([M,C],[0,0]),e=(0,x.GC$)(d(b)).appendTo(n),i=(0,x.GC$)("#"+Xt)[0],e=(0,x.GC$)(d(Tt)).attr({type:St,placeholder:E().Search,id:X}).appendTo(e);R(n[0],"gc-search-outer-div ui-widget-header"+st+"ui-multiselect-header ui-helper-clearfix"),t.elementList.push(e[0]),e=(0,x.GC$)(d(b)).appendTo(n),r=t.Gut(q,E().CheckAll,"gc-check-image ui-icon ui-icon-check"),o=t.Gut($,E().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick"),R(e[0],gt),e.append(r).append(o),(0,x.GC$)(i.children[1]).append(n),t.elementList.push(r[0]),t.elementList.push(o[0])},e.prototype.eut=function(){var t=this;t.Sut(),t._ut(),t.Out()},e.prototype.use=function(){var t,n,e,i,r,o,n,t=this,n=this.Zue,e=this.Wc,i=this.itemList;e.css(["min-width","min-height"],[e.width()+m,e.height()+m]),r=e[0].getBoundingClientRect(),n&&t.qat.listFilterArea&&(o=n.dialogWidth,n=n.dialogHeight,o&&o>t.Hat&&(o=Math.min(o,document.body.clientWidth-r.left-20),e.css(A,o),i)&&i.css(A,t.Yat+(o-t.Hat)),n)&&n>t.zat&&(n=Math.min(n,document.body.clientHeight-r.top-20),e.css(I,n),i)&&i.css(I,t.Zat+(n-t.zat))},e.prototype.dut=function(t){var n=this,e=s;switch(this.Gat){case en:e=new P.Grt(t,n.Wc,n.filterButtonInfo,n.sheet,n,ht);break;case nn:e=new P.Prt(t,n.Wc,n.filterButtonInfo,n.sheet,n,ht);break;case rn:e=new P.Frt(t,n.Wc,n.filterButtonInfo,n.sheet,n,ht)}return e},e.prototype.mut=function(t,n){var e=this,i=s;return n===lt?i=new P.Lrt(t,e.Wc,e.filterButtonInfo,e.sheet,e,lt):n===dt&&(i=new P.Lrt(t,e.Wc,e.filterButtonInfo,e.sheet,e,dt)),i},e.prototype.xut=function(){var t,n=this.filterButtonInfo,e,i=!1,r=n.rowFilter.nrt;return i=r!==s&&r.color!==j&&n.col===r.index?!0:i},e.prototype.Nut=function(t){var n,e,n=(0,x.GC$)(d("div")),e=(0,x.GC$)(d("img")).attr("src",(0,o.getFilterButtonImageSrc)(11)).addClass("gc-filter-checked");return t||e.css([S],[T]),n.append(e),n},e.prototype.Kat=function(){var t,n,e,i,r,e,t=this,n=t.filterButtonInfo,e=n.rowFilter,i=n.col,r=t.sheet.getText(t.filterButtonInfo.row,i,n.sheetArea),e=e&&e.Uoe();return""===(r=e&&e.row<=0?t.sheet.getText(n.row,i,n.sheetArea):r||t.sheet.getText(0,i,1))&&1===t.sheet.options.colHeaderAutoText?r="(Column "+(i+1)+")":""===r&&(r="(Column "+u.Vf(i+1)+")"),r='"'+r},e.prototype.Eut=function(t){var n=this,e;n.Jat?(e=(0,o.getFilterButtonImageSrc)(12),(0,x.GC$)(t).addClass("gc-filter-item")):(e=(0,o.getFilterButtonImageSrc)(13),(0,x.GC$)(t).addClass(O+f)),(0,x.GC$)(t.children[0]).append((0,x.GC$)(d("img")).attr("src",e).css([A],["18px"])),n.Uut(fn,n.Qat,(0,x.GC$)(t.children[1]))},e.prototype.Hut=function(t){var n;return 0===t.conType()&&0===t.item1().compareType()&&0===t.item2().compareType()&&5===t.item1().conType()&&5===t.item2().conType()},e.prototype.jut=function(){var t,n,e,i,r,o,a,r,o,u,r,t=this,n=!1,e=!1,i=!1,r=t.filterButtonInfo,o=r.col,a,r=r.rowFilter.rrt[o];return r&&0<r.length&&((r=r[0])instanceof G.Condition?(o=r.conType(),0===(u=r.compareType())&&3!==o&&t.qat.listFilterArea?i=!0:0===u&&3!==o&&!t.qat.listFilterArea||0!==u&&3!==o?n=!0:3===o&&(e=!0),r=this.Hut(r),(5===o&&0===u||r)&&(n=!(i=!1))):i=t.qat.listFilterArea),{isShowColorFilterSelect:e,isShowMajorCheck:n,isShowSelectCheck:i}},e.prototype.Xat=function(){var t,n=!1,e=this.filterButtonInfo,i=e.col,r,e=e.rowFilter.rrt[i];return n=e&&0<e.length?!0:n},e.prototype.zut=function(){var t=Math.max(this.Pat.Date,this.Pat.Number,this.Pat.Text);return t===this.Pat.Text?nn:t===this.Pat.Number?en:t===this.Pat.Date?rn:void 0},e.prototype.fut=function(){var t,t,n,t=this.zut();this.Gat=t,t=E()[t],(n=(0,x.GC$)("#"+ln)).text(t)},e.prototype.Vut=function(t){var n,t,e,n=this,t=n.Yat*t,e;(0,x.GC$)(n.Put).css([A],[t])},e.prototype.Yut=function(t){var n;(0,x.GC$)("#"+tn).css([S],[t?Ht:T])},e.prototype.Wrt=function(){var t,n,e,i,n,r,n,t=this,n=t.filterButtonInfo,e=this.sheet,i=n.col,n=n.rowFilter;n&&(n={tableName:r=n.nM?n.nM.name():j,colIndex:i},e.Qy().execute({cmd:"clearFilter",sheetName:e.name(),cmdOption:n}),t.close())},e.prototype.lut=function(){var t,n,e,i,r,n,t=!1,n=this.bot,e=this.yot,i=n.colorNumber,r=e.colorNumber;n.automatic&&i++,e.automatic&&r++,(i!==j&&1<i||r!==j&&1<r)&&(t=!0),n=this.jut(),t||(n.isShowColorFilterSelect||this.Zut(_),this.xut())||this.Zut(k)},e.prototype.Zut=function(t){var n;(0,x.GC$)("#"+t).addClass(O+f).find("."+hn)},e.prototype.nut=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,n=this,e=n.Wc,i=" gc-sort-container ui-menu-item",a=n.table=(0,x.GC$)(d("table")).css([C,S],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(R(a[0],"gc-layout-table"),u=[Qt,Jt,k,Kt,_,D,Xt],s=n.$at,r=0;r<10;r++)if(1===s[r])for(c=d("tr"),f=(0,x.GC$)(c).appendTo(a),r<6&&((0,x.GC$)(c).attr("id",u[r]).css([S,I,g],["table-row","26px","9pt"]),(0,x.GC$)(c).addClass(qt)),6===r&&(0,x.GC$)(c).attr("id",u[r]),7===r&&(0,x.GC$)(c).attr("tabindex",0).attr("id",on),8===r&&(0,x.GC$)(c).attr("id",tn),9===r&&(0,x.GC$)(c).attr("id",an),En(c),o=0;o<3;o++)l=d("td"),(0,x.GC$)(l).appendTo(f),En(l),0===o?R(l,"gc-layout-table-first-column"):2===o?R(l,"gc-layout-table-last-column"):1===o&&(0===r?R(l,"gc-filter-sort-asc-container"+i+"gc-layout-table-middle-column"):1===r&&R(l,"gc-filter-sort-desc-container"+i+"gc-layout-table-middle-column"));n.table.appendTo(e),e.css(["box-shadow",A,I,Gt],["rgba(0, 0, 0, 0.15) 2px 4px 5px",n.Hat+m,n.zat+m,Ut]),R(e[0],un+" "+vt),e.appendTo(n.qc()),null!=(t=n.Zue)&&t.allowResize&&(e.addClass(zt),h=e[0],n.Wue=new x.Ose(h,function(){var t,t,t=h.getBoundingClientRect();e.css(["max-width","max-height"],[document.body.clientWidth-t.left-10+m,document.body.clientHeight-t.top-10+m]),(t=(0,x.GC$)("."+tt)[0])&&(t.style.height=h.clientHeight-(n.zat-n.Zat)+m,t.style.width=h.clientWidth-(n.Hat-n.Yat)+m,n.Mut.Cg(),n.Rfe())},40))},e.prototype.zfe=function(t){var n=this;n.hut&&(0,x.GC$)(t).attr("id")!==D&&n.hut.rf()&&(n.hut.NK(),F((n.Uat=s,x.GC$)("#"+D)[0],l)),n.vut&&(0,x.GC$)(t).attr("id")!==_&&n.vut.rf()&&(n.vut.NK(),F((n.Uat=s,x.GC$)("#"+_)[0],l)),n.gut&&(0,x.GC$)(t).attr("id")!==k&&n.gut.rf()&&(n.gut.NK(),F((n.Uat=s,x.GC$)("#"+k)[0],l))},e.prototype.aY=function(){var s,n,e,t,i,r,o,t,s=this,n=!1,e=!1,t=(0,x.GC$)("."+et);(0,x.GC$)("#"+Qt).bind(_t,function(t){n&&(n=!1,s.Wut(!0),s.close(),c(t))}).bind(kt,function(t){c(t),n=!0}),(0,x.GC$)("#"+Jt).bind(_t,function(t){e&&(e=!1,s.Wut(!1),s.close(),c(t))}).bind(kt,function(t){c(t),e=!0}),(0,x.GC$)("."+qt).bind(y,function(){s.zfe(this),!(0,x.GC$)(this).hasClass(f.trim())&&(0,x.GC$)(this).index()<6&&R(this,l)}).bind(yt,function(){s.hut&&(0,x.GC$)(this).attr("id")===D&&(clearTimeout(i),s.hut.rf())||s.vut&&(0,x.GC$)(this).attr("id")===_&&(clearTimeout(r),s.vut.rf())||s.gut&&(0,x.GC$)(this).attr("id")===k&&(clearTimeout(o),s.gut.rf())||F(this,l)}),(0,x.GC$)("#"+Kt).bind(p,function(){s.Jat&&s.Wrt()}),(0,x.GC$)("#"+D).bind(y,function(){(0,x.GC$)(this).hasClass(O)||(i=setTimeout(function(){s.Uat=s.hut,s.Uat.$c()},500))}),(0,x.GC$)("#"+_).bind(y,function(){(0,x.GC$)(this).hasClass(O)||(r=setTimeout(function(){s.Uat=s.vut,s.Uat.$c()},500))}),(0,x.GC$)("#"+k).bind(y,function(){(0,x.GC$)(this).hasClass(O)||(o=setTimeout(function(){s.Uat=s.gut,s.Uat.$c()},500))}),(0,x.GC$)("#"+q).bind(p,function(t){s.Qut(t,!0)}),(0,x.GC$)("#"+$).bind(p,function(t){s.Qut(t,!1)}),(0,x.GC$)("#"+X).bind(Mt,function(t){13===(t.which||t.keyCode)&&t.preventDefault()}).bind(Ct,function(t){W(t.keyCode,[9,37,38,39,40])<0&&(s.Kut(),s.but())}).bind(St,function(t){s.Kut(),s.but()}),t.bind(y,function(){R(this,ot)}).bind(yt,function(){F(this,ot)}),t.bind(kt,function(){F(this,ot),R(this,pt)}).bind(yt,function(){F(this,pt)}),(0,x.GC$)("#"+v).bind(p,function(){var t,n,e,i,r,o,a,u,n,t,n=s.filterButtonInfo.rowFilter;if(!1===s.Jut?(n.irt=!0,s.Xut()):(s.qut(),!0===s.Jut?n.ort=!0:s.sheet.NMi&&s.sheet.NMi._gi===x.SheetType.tableSheet&&(n.irt=!0)),e=s.Oat,i=[],r=s.Dat,o=e.length,a=r.length,s.Bat){for(u=0;u<(a<o?o:a);u++)r[u]&&i.push(r[u]),!e[u]||e[u].repeat||e[u].noCheck||i.push(e[u]);s.Dat=i}n=s.Dat,s.sheet.suspendPaint(),s.aL(n),s.sheet.resumePaint(),s.close()}),(0,x.GC$)("#"+K).bind(p,function(){s.close()}),(0,x.GC$)("#"+Xt).bind(y,function(t){s.zfe(t.currentTarget)}),(0,x.GC$)("#"+on).bind(y,function(t){s.zfe(t.currentTarget)}),(0,x.GC$)("#"+an).bind(y,function(t){s.zfe(t.currentTarget)}),s.Wc.bind(Nt,function(t){c(t)}).bind(xt,function(t){c(t)}).bind(Mt+bt,function(t){s.$ut(t)}).bind(Ct+bt,function(t){c(t)}),s.itemList&&0<s.itemList.length&&(s.Mut.bind(x.Events.TopRowChanged,function(t,n){s.Bfe(n)}),s.Mut.bind(x.Events.CellClick,t=function(t,n){!1===s.Jut?s.nst(n):s.est(n)}),s.Mut.bind(x.Events.CellChanged,t),s.Mut.bind(x.Events.TouchToolStripOpening,function(t,n){n.handled=!0}))},e.prototype.Bfe=function(t){var n,e,t,i,r,r;t.oldTopRow>t.newTopRow||(n=this,e=t.sheet,t=t.newTopRow,i=e.dw(1).length,r=n.ist,r=e.getColumnWidth(r),n.rst(e,r,t,i))},e.prototype.rst=function(t,n,e,i,r){var o,a,u,s,i,c,f,a,l,h,d,o,v,o,i,a=this,u=t.parent,s=a.ist,i=e+i,f=a.Jut,a=a.itemList.width()-(u.options.showVerticalScrollbar?22:0),l=0;for(!1!==f&&(c=t.outlineColumn.ost()),h=Math.min(i,t.getRowCount()),d=e;d<h;d++)o=(null==(o=null==r?void 0:r[d])?void 0:o.name)||t.getText(d,s),v=!1===f?30:c[d].cellContent.left,o=x.q.Wt(o),l=Math.max(o+v,l);(i=Math.ceil(Math.max(a,l)/n))!==t.getColumnCount()&&t.setColumnCount(i),a<l&&(u.options.showHorizontalScrollbar=!0)},e.prototype.zce=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=this,i=e.dataSource[n].name,r=e.dataSource[n].level,o=[],a=n-1;0<=a&&!((u=e.dataSource[a].level)<r);a--)u===r&&i===e.dataSource[a].name&&o.push(a);for(a=n+1;a<e.dataSource.length&&!((s=e.dataSource[a].level)<r);a++)s===r&&i===e.dataSource[a].name&&o.push(a);for(c=e.ust(e.dataSource[n].status),f=0;f<o.length;f++)t.outlineColumn.setCheckStatus(o[f],c)},e.prototype.est=function(t){var n,e,i,r,o,a,a,t,u,s,a,t,a,t,o,r,a,n=this,e=t.sheet,i=t.row,r=t.sheetArea,o=n.ist;n.activeItemIndex=i,a=n.ast.outlineColumn.getCheckStatus(),"add_current"===n.dataSource[0].key&&0===i&&(n.Bat=1===a[0]),e.suspendPaint(),t.ignoreClick||!e.sw||(u=(t=(a=e.sw.cellTypeHitInfo)&&a.outlineColumnHitInfo)&&t.indicator)||(e.outlineColumn.getCheckStatus(i,o)===n.dataSource[i].status&&(s=e.outlineColumn).setCheckStatus(i,n.ust(n.dataSource[i].status)),(a=n.sheet.NMi)&&a.qNi&&a.qNi()&&n.zce(e,i),n.sst()),e.Oi&&e.aR("transparent"),t=(0,x.GC$)("."+at,this.Wc[0]),0<w(t)?F(t,ut):n.cst(e),t=(a=e.Z_(i,o,r))&&a.clone()||new x.Style,R(o=(0,x.GC$)(d(b)),l),this.Wc.append(o),r=o.css("backgroundColor"),a=o.css("color"),o.remove(),t.backColor=r,t.foreColor=a,e.setStyle(i,-1,t),e.resumePaint(),n.qut(),n.but()},e.prototype.nst=function(t){var n,e,i,r,o,a,u,s,c,s,f,a,t,c,u,s,f,n=this,e=t.sheet,i=t.row,r=t.sheetArea,o=n.ist,a=t.col;n.activeItemIndex=i,u=n.Eat,(c=(s="add_current"===n.dataSource[0].key)&&0===i)&&(0===a?n.Bat=Boolean(this.dataSource[0].status):(n.Bat=!Boolean(this.dataSource[0].status),this.dataSource[0].status=n.Bat?1:0)),s=s?i-1:i,e.suspendPaint(),!t.ignoreClick&&e.sw&&(f=void 0,0===a?f=t.newValue?1:0:c||(f=u[s].status?0:1,this.dataSource[i].status=f),c||(u[s].status=f,n.Lat+=f?1:-1)),e.Oi&&e.aR("transparent"),a=(0,x.GC$)("."+at,this.Wc[0]),0<w(a)?F(a,ut):n.cst(e),c=(t=e.Z_(i,o,r))&&t.clone()||new x.Style,R(u=(0,x.GC$)(d(b)),l),this.Wc.append(u),s=u.css("backgroundColor"),f=u.css("color"),u.remove(),c.backColor=s,c.foreColor=f,e.setStyle(i,-1,c),e.resumePaint(),n.but()},e.prototype.sst=function(){for(var t,n,e,i,r,t=this,n,e,i=t.ast.outlineColumn.getCheckStatus(),r=0;r<i.length;)t.dataSource[r].status=i[r],r++},e.prototype.ust=function(t){return 1===t?2:1},e.prototype.cst=function(t){for(var n,e,i,n=t.getRowCount(),e=0;e<n;e++)if((i=t.Z_(e,-1))&&(i.backColor||i.foreColor)){i.foreColor=i.backColor=void 0,t.setStyle(e,-1,i);break}},e.prototype.fst=function(t){for(var n=this,e=n.dataSource,i=0,r=n.Eat,o=e[0]&&"add_current"===e[0].key?1:0;i<r.length;)e[i+o].status=t,r[i].status=t,i++},e.prototype.qut=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=this,n=t.ast.outlineColumn.getCheckStatus(),e=0,i=t._at||t.Dat,r=t.Eat,a=0;for(t.Bat=1===n[0],"add_current"===t.dataSource[0].key&&(e=1),t.Dat=[],u=0;u<r.length&&(o=r[u],!(a>=i.length));u++)if(o.key===i[a].text){for(a++,s=o.children,c=j,f=0;f<s.length;f++)l=s[f],h=n[e],!1!==l.show&&(e+=1),c=h||c,3!==h&&(l.status=h);2!==c?t.Dat.push({text:o.key,value:o.value,type:o.type}):t.lst(u,o)}},e.prototype.Xut=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t._at||t.Dat,e=t.Eat,r=0;for("add_current"===t.dataSource[0].key&&(t.Bat=Boolean(t.dataSource[0].status)),t.Dat=[],a=(o=t.filterButtonInfo).col,(s=(u=o.rowFilter).hst)[a]=[],c=0;c<e.length&&(i=e[c],!(r>=n.length));c++)i.key===n[r].text&&(r++,(f=i.status)?t.Dat.push({text:i.key,value:i.value,type:i.type}):(t.lst(c,i),s[a].push(i.key)))},e.prototype.lst=function(t,n){var e,i,r,e=this,i=e.Rat;if(i[t])if(i[t].value===n.value)e.Rat[t]=null;else for(r=t+1;r<i.length;){if(i[r]&&i[r].value===n.value){e.Rat[r]=null;break}r++}},e.prototype.Qut=function(t,n){var e,i,r,o,a,r,a,e=this,i=e.ast,a=e._at;i.suspendPaint(),e.Dat=n?L(a):[],!n&&e.Bat&&(e.Bat=!1),o=Sn[n],!1===e.Jut?(r=Tn[n],e.fst(r),e.Lat=n?a.length:0):(r=i.outlineColumn)&&(r.dst(o),e.sst(),n)&&e.Fat&&((a=r.mst.vst[0])&&a.checkBox&&(r.mst.vst[0].checkBox.checkStatus=0),r.refresh()),i.resumePaint(),e.but(),c(t)},e.prototype.gst=function(t){switch(t){case D:this.Uat=this.hut;break;case _:this.Uat=this.vut;break;case k:this.Uat=this.gut}},e.prototype.pst=function(t){var n=this;n.Uat=t,n.Uat.$c(),n.Uat.Jrt()},e.prototype.bst=function(t){var n,e,i,r,n=w(t);0!==n&&(e=this,r=(i=t.attr("id"))===Qt,1===n?r||i===Jt?(e.Wut(r),e.close()):i===K?e.close():i===D?e.Uat!==s?e.Uat.Zrt():e.pst(e.hut):i===_?e.pst(e.vut):i===k?e.pst(e.gut):i===Kt?e.Wrt():(0,x.GC$)("#"+v).trigger(p):2===w(t)||3===w(t)?e.Uat&&e.Uat.Zrt():(0,x.GC$)("#"+v).trigger(p))},e.prototype.yst=function(t,n){var e,n,t,i,r,e=this;return!(!t[0]||"INPUT"===t[0].nodeName||(w(t)?(e.Uat===s&&e.gst(n),e.Uat===s||e.Uat.drt||e.Uat.Krt(),t.trigger(kt),t.trigger(_t),t.trigger(p)):N(this.activeItemIndex)||(n=e.ast,t=this.activeItemIndex,n.outlineColumn.getCheckStatus(t,i=0)===e.dataSource[t].status&&(r=n.outlineColumn).setCheckStatus(t,e.ust(e.dataSource[t].status)),e.sst()),0))},e.prototype.wst=function(){for(var t,n,e,i,r,o,a,u,s,t=this,n=t.Eat,e=t._at,i=0,r=[],o=0;o<n.length;o++)if(!N(e[i])&&n[o].key===e[i].text)for(i++,a=n[o].children,u=0;u<a.length;u++)!1!==(s=a[u]).show&&r.push(s.value||n[o].key);return r},e.prototype.Mst=function(t,n,e){var i,r,e,r,i=this,r=i.elementList,e=!w(n)&&N(i.activeItemIndex)?r[0]:(w(n)?F(n,ut):i.cst(i.ast),r=i.wst(),4===t?i.Cst(r,n,e):i.Sst(r,n,t));return e},e.prototype.Sst=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,i=this,r=i.elementList,o=n[0],u=r.length-2,s=L(r),c=i.activeItemIndex||0,f=0,l=0;l<w(t);l++)s.splice(-2,0,t[l]);if(d=3===e,0<=(h=o?W(o,s):u+c)){for(a=d?s[h+1]:s[h-1],c=c||0,f=d?h+1:h-1,0<=W(a,t)&&0<w(n)&&(h=d?h+c:c+(r.length-2),a=d?s[h+1]:s[h],f=d?h+1:h);d&&h<w(s)&&i.Tst(a);)f=h+1,a=s[(h+=1)+1];if(!d){for(;0<h&&i.Tst(a);)f=h-1,a=s[--h-1];a=a||s[w(s)-1]}a=a||s[0]}return typeof a==wt?f-u:a},e.prototype.Cst=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i.elementList,o=n[0],s=L(r),c=i.activeItemIndex||0;if(s.splice(-2,0,t[c]),w(n)){if(0<=(u=W(o,s))){for(a=e?s[u-1]||s[w(s)-1]:s[u+1];e&&0<u&&i.Tst(a);)a=s[--u-1];for(;!e&&i.Tst(a)&&u<w(s);)a=s[(u+=1)+1]}}else a=e?r[r.length-3]:i.Tst(r[r.length-2])?r[r.length-1]:r[r.length-2];return typeof(a=a||s[0])==wt?c:a},e.prototype.$ut=function(t){var n,e,i,r,r,i,r,n=this,e=(0,x.GC$)("."+at,n.Wc[0]),r=t.which||t.keyCode,r=W(r,[27,13,38,40,9,37,39,32]);if(0<e.length&&(i=e.attr("id")),0===r)n.close(),c(t);else if(1===r)this.bst(e);else if(4<r){if(5===r)n.Uat===s&&n.gst(i),n.Uat!==s&&(n.Uat=n.Uat.Qrt());else if(6===r)n.Uat===s&&n.gst(i),n.Uat===s||n.Uat.drt||n.Uat.Krt();else if(7===r&&!this.yst(e,i))return;c(t)}else 1<r&&n.Uat!==s&&n.Uat.rf()?(2===r||4===r&&t.shiftKey?n.Uat.qrt():3!==r&&(4!==r||t.shiftKey)||n.Uat.Xrt(),c(t)):1<r&&("number"==typeof(i=n.Mst(r,e,t.shiftKey))?(n.est({sheet:n.ast,row:e=i,sheetArea:3,ignoreClick:!0}),n.ast.OA(e,n.ist),(0,x.GC$)("#"+on).focus()):(((r=(e=(0,x.GC$)(i)).attr("id"))!==X&&r!==v&&r!==K&&r!==q&&r!==$?e.find("i"):e).focus(),R(e,nt+" "+ut)),c(t))},e.prototype.Tst=function(t){return typeof t!=wt&&(t=(0,x.GC$)(t),0!==w(t))&&!!(t.hasClass(ct)||t.hasClass(f)||t.hasClass(ft))},e.prototype.aL=function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet;if(e)try{e.suspendPaint(),(r=(i=n.filterButtonInfo).rowFilter)&&(o=i.col,u={tableName:a=r.nM?r.nM.name():j,colIndex:o,checkedValues:t,allValuesLength:w(n._rt)},e.Qy().execute({cmd:"filterTextSelectAction",sheetName:e.name(),cmdOption:u}))}finally{e.resumePaint()}},e.prototype.Kut=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,d,g,g,p,b,t=this,n=x.GC$.trim((0,x.GC$)("#"+X).val().toLowerCase()),e=!1===t.Jut?t.Ast:t.Eat,i=t.jat,o={},a=t.Rat;if(a.forEach(function(t){t&&t.repeat&&delete t.repeat}),n){for(s=[],c=void 0,(u=V.jJ(n))||(c=new RegExp(n.replace(t.rEscape,"\\$&"),"gi")),r=0;r<e.length;r++)for(l=(f=e[r]).children,h=0;h<l.length;h++){if(d=l[h],v=f.key,m=f.type,d=d.value||v,(g=u&&V.OJ(u).exec(d))&&0===g.index||!u&&-1!==d.search(c)){if(o[v])break;if(s.push({text:v,value:f.value,type:m}),(g=a[r])&&g.value===f.value)g.repeat=!0;else for(p=r+1;p<a.length;){if((b=a[p])&&b.value===f.value){b.repeat=!0;break}p++}o[v]=!0;break}a[r]&&a[r].repeat&&delete a[r].repeat}t.Ist=!0,t._at=L(s),t.Oat=a,t.Dat=L(s),t.Lat=t._at.length,t.xst(o)}else if(w(i)){for(this.Fat=!1,r=0;r<i.length;r++)1!==i[r].status&&(i[r].status=1);t._at=L(t._rt),t.Dat=L(t._rt),!1===t.Jut?(t.Nst(i,!1),t.Eat=t.Ast):t.kst(i),t.dataSource=i,t.Lat=i.length}else this.Fat=!1,t.jat=L(t.dataSource)},e.prototype.Iut=function(t,n){var e=(0,x.GC$)(d("i"));return e.attr({id:t}).text(n).css([S,C,"cursor",M,"text-decoration","text-align",g,"outline",I],[Ht,"0 6px","default","0px 0 1px 2px",T,Bt,"12px",T,"inherit"]),R(e[0],it+rt+st),e},e.prototype.Uut=function(t,n,e){var i,r,t,n,e,i=E().Clear,r=(0,x.GC$)(d("i")).html(i.replace("{0}",'"'));r.attr({id:t}).css([S,C,"cursor",M,"text-decoration","text-align",g,"outline",I,"white-space"],["inline","0 6px","default","0px 0 1px 2px",T,Bt,"12px",T,"inherit","nowrap"]),e.append(r),t=e.width()-r[0].offsetWidth,e='<span class="filterName">'+Y(n)+'</span><span style="vertical-align: top">"</span>',n=i.replace("{0}",e),r.html(n),(0,x.GC$)(".filterName",r[0]).css(["max-width","overflow","text-overflow",S,"vertical-align"],[t+"px","hidden","ellipsis","inline-block","text-bottom"]),R(r[0],it+rt+st)},e.prototype.Gut=function(t,n,e){var i=d(At),n=(0,x.GC$)(d(At)).text(n),r=d("i"),o=(0,x.GC$)(r);return R(i,"gc-check-uncheck-all "+e),o.attr({id:t}).css(["float",Dt,C,g,I],[Bt,"7px","0","12px","16px"]).append((0,x.GC$)(i)).append(n),R(r,mt+mt+"-style"),o},e.prototype.Dst=function(t){"date"===t?this.Pat.Date++:"number"===t||"boolean"===t?this.Pat.Number++:"string"===t&&this.Pat.Text++},e.prototype._st=function(){var t,n,e,i,t=this.Pat.Date,n=this.Pat.Number,e=this.Pat.Text,i=t+n+e;return t<i&&n<i&&e<i?"mix":i===t?"type":i===n?"number":i===e?"text":void 0},e.prototype.Est=function(t){var n,t,e,n=!0,t=t.rrt[this.filterButtonInfo.col];return n=t&&0<t.length&&t[0]instanceof G.Condition&&(t=t[0],e=this.Hut(t),0!==t.compareType()||e||0===t.compareType()&&5===t.conType())?!1:n},e.prototype.jst=function(t){var n,e,i,n=this,e=n.kat[t];return N(e)&&(i=t.replace(/(\[[^hms]+\])|(General)/gi,""),e=Z.a0(i),n.kat[t]=e),e},e.prototype.Ost=function(t,n){return"number"===Yt(n)&&"string"===Yt(t)&&this.jst(t)?Zt(n):n},e.prototype.Rst=function(t,n,e,i,r,o){jn(t!==s&&t.backColor,e,i,r,o),jn(t!==s&&t.foreColor,n,i,r,o)},e.prototype.uut=function(t){var n,e,i,e,r,o,a,u,s,c,f,i,n=this,e=n.filterButtonInfo.rowFilter;e&&(r=(e=(i=n.sheet).JS(e.extendedRange||e.range)).col,o={},a=[],u={},s=[],c={data:{},colorNumber:0},f={data:{},colorNumber:0},i=i.outlineColumn&&i.outlineColumn.Un(t),n.hasBlank=!1,r<=t&&t<r+e.colCount&&n.Bst(t,c,f,o,u,a,s),n.Lst(c,f,i,a,s,u,t))},e.prototype.Bst=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,u=this,s=u.filterButtonInfo.rowFilter;if(s)for(l=(c=u.sheet).currentTheme(),h={},d=c.JS(s.extendedRange||s.range),v=u.qat.sortByColor||u.qat.filterByColor,m=d.rowCount,c._isExternalFilter&&(m=Math.min(m,100)),g=0;g<m;g++)p=d.row+g,(w=(b=0<c.getRowHeight(p))||!s.isFiltered()||s.Fst(p,t))&&v&&(f=c.getActualStyle(p,t,3,!1,!1,!0),this.Rst(f,e,n,l,p,h)),u.Pst(i,r,o,p,t,a)},e.prototype.Lst=function(t,n,e,i,r,o,a){var u,s,u=this;u.bot=t,u.yot=n,e||(s=i.length)<=5e4&&(i.sort(Dn),r.sort(Dn)),u._rt=i,u.Rat=r,u._at=L(i),!1===u.Jut?(u.Eat=u.Gst(a,o,i),u.Ast=L(u.Eat),u.Lat=u.Dat.length):(u.Eat=u.Ust(a,o,i),u.Lat=u.Eat.length),u.jat=u.dataSource},e.prototype.Hst=function(t,n,e){var i,r,e,i,r=this.sheet;return e||((e=r.l0(t,n,"_autoFormatter"))&&e.formatCached?e.formatCached:void 0)},e.prototype.zst=function(t){var n,e;return this.sheet.l0(-1,t,"formatter")},e.prototype.Pst=function(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,s,u,a,m,g,p,b,w,y,M,p,C,S,T,c,c,A,I,c,f,l,p,h=this,d=h.sheet,v=h.filterButtonInfo.rowFilter,u=a?u:d.getValue(i,r),a=a?s:d.vL(i,r,u),s=a=a&&a.trim(),m=E().Blanks,g=h.Est(v),p=d.NMi&&d.NMi._gi===x.SheetType.tableSheet;h.Vst||(h.Vst=[]),h.Vst.hasOwnProperty(r)?y=h.Vst[r]:h.Vst[r]=y=v.isFiltered(r),h.Yst||(h.Yst=[]),h.Yst.hasOwnProperty(r)?M=h.Yst[r]:h.Yst[r]=M=d.outlineColumn&&d.outlineColumn.Un(r),p?(C=!(p=!1),v.hst||(v.hst={}),h.Zst||(h.Zst=[]),h.Zst.hasOwnProperty(r)?b=h.Zst[r]:h.Zst[r]=b=h.zst(r),b&&!z(b)&&(u=h.Ost(b,u)),T="date"===(S=c),h.Dst(S),1===h.Pat.Date&&(h.Wst=Gn(b)),T&&(s=v.Qst.format(u)),(c=d.NMi).qNi&&c.qNi()?(c=f,""!==a&&!N(a)||(S="blank",h.hasBlank=!0,a=m),c?(n[a]=!0,h.Dat.push({text:a,value:u,type:S}),o.push({text:a,value:u,type:S})):o.push({text:a,value:u,noCheck:!0,type:S}),!1!==l&&e.push({text:a,value:u,type:S,noCheck:!c})):(A=v.isFiltered(),I=!0,""!==a||!C&&A&&!I?t[s]||C&&(f?(p=n[a]=!0,h.Dat.push({text:a,value:u,type:S}),o.push({text:a,value:u,type:S})):o.push({text:a,value:u,noCheck:!0,type:S}),!1!==l)&&(e.push({text:a,value:u,type:S,noCheck:!p}),t[s]=!0):h.hasBlank||(S="blank",h.hasBlank=!0,f?(p=n[m]=!0,h.Dat.push({text:m,value:u,type:S}),o.push({text:m,value:u,type:S})):o.push({text:m,value:u,noCheck:!0,type:S}),!1!==l&&e.push({text:m,value:u,type:S,noCheck:!p})))):(C=0<d.getRowHeight(i),T="date"===(S=Rn(u=(b=d.getFormatter(i,r))&&!z(b)?h.Ost(b,u):u,w=h.Hst(i,r,b))),h.Dst(S),1===h.Pat.Date&&(h.Wst=Gn(b)),T&&(s=v.Qst.format(u)),c=d.getRowVisible(i,3,!0),f=v.Kst(i,r),A=v.isFiltered(),I=v.Fst(i,r),l=d._o(i),p=g&&(C||!y||M&&c&&!f),""!==a||!C&&A&&!I?t[s]||c&&l&&(p?(n[a]=!0,h.Dat.push({text:a,value:u,type:S}),o.push({text:a,value:u,type:S})):o.push({text:a,value:u,noCheck:!0,type:S}),!C&&A&&!I||(e.push({text:a,value:u,type:S}),t[s]=!0)):h.hasBlank||(h.hasBlank=!0,e.push({text:m,value:u,type:S}),p?(n[m]=!0,h.Dat.push({text:m,value:u,type:S}),o.push({text:m,value:u,type:S})):o.push({text:m,value:u,noCheck:!0,type:S})))},e.prototype.Ust=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,i=this,o=[],a=[],g=i.sheet,p=g.JS(i.filterButtonInfo.rowFilter.extendedRange||i.filterButtonInfo.rowFilter.range),b=g.outlineColumn;if(b&&b.Un(t))for(h=0;h<e.length;h++)w=e[h].text,y=e[h].value,M=e[h].type,C=e[h].noCheck,l=Sn[!!n[w]],d=Pn(g,w,y,p.row+h,t,l,M,C),o.push(d),(m=d.children[0])&&!1!==m.show&&a.push({name:m.value||d.key,level:i.Ist?0:m.level,status:m.status});else for(h=0;h<e.length;h++)switch(w=e[h].text,y=e[h].value,M=e[h].type){case"date":for(l=Sn[!!n[w]],u=(v=(d=Bn(i.Wst,w,y,l,M)).children)[0].value,s=v[1].value||v[0].value,v[0].show=v[1].show=!0,u===c&&(v[0].show=!1,s===f)&&(v[1].show=!1),c=u,f=s,o.push(d),m=d.children,S=0;S<3;S++)m[S]&&!1!==m[S].show&&a.push({name:m[S].value||d.key,level:m[S].level,status:m[S].status});break;case"number":case"string":case"boolean":case"blank":case"array":case"object":l=Sn[!!n[w]],d=Pn(g,w,y,p.row+h,t,l,M),o.push(d),(m=d.children[0])&&!1!==m.show&&a.push({name:m.value||d.key,level:m.level,status:m.status})}return i.dataSource=a,o},e.prototype.Gst=function(t,n,e,i){var r=this,o=[],a=[],u,s,c,f,l,c,h,u;for(i&&(o=[],a=[]),f=0;f<e.length;f++)l=e[f].text,c=e[f].value,h=e[f].type,u=void 0===(u=e[f].noCheck)?n[l]:!u,s=Tn[u],o.push(c={key:l,value:c,children:[{value:l,level:0,status:s}],status:s,type:h,checked:u}),a.push({name:c.children[0].value||c.key,level:0,status:s});return r.dataSource=a,o},e.prototype.wut=function(t){var n,e,i,r,o,n=this,e=0,i=n.itemList,r=!1,o=n.Mut;o||(o=new x.Workbook(i[0],{allowContextMenu:!1,showHorizontalScrollbar:!1,showVerticalScrollbar:!1,scrollbarMaxAlign:!0,tabStripVisible:!1,allowUserResize:!1,allowUserDragDrop:!1,allowUserDragFill:!1,allowUserZoom:!1,grayAreaBackColor:"white",sheetCount:1}),r=!0),o.xU=!0,n.Mut=o,n.ast=o.getActiveSheet(),n.ist=0,!1===n.Jut?(n.ist=1,n.Nst(t,r)):(n.kst(t),n.sst())},e.prototype.kst=function(t){var n,e,i,r,r,n=this,e=n.Mut;0<n.Mut.sheets.length&&(n.Mut.removeSheet(0),n.ast=j),e.addSheet(0,new x.Worksheet("sheet1")),i=n.ast=e.sheets[0],e.suspendEvent(),i.suspendPaint(),(r=i.options).colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor="transparent",r.selectionBorderColor="transparent",r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.protectionOptions.allowOutlineRows=!0,r.isProtected=!0,i.defaults.rowHeight=20,i.defaults.colWidth=10,i.setRowCount(0===t.length?0:t.length+1),(r=new x.Style).font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',i.setDefaultStyle(r),i.Jst=!0,i.outlineColumn.options({columnIndex:n.ist,showIndicator:!0,showCheckBox:!0,Jut:this.Jut}),i.outlineColumn.Xst(),i.showRowOutline(!1),i.setColumnCount(1),0<t.length&&n.Ist?(n.Ist=!1,t.unshift({name:E().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),n.Fat=!0):0===t.length&&(n.Ist=!1),n.qst(i,t),n.Rfe(),i.outlineColumn.$st(),this.tct(t),i.resumePaint(),e.resumeEvent()},e.prototype.Rfe=function(){var t,n,e,i,r,o,a,u,t=this,n=t.ast,e=t.Mut,i=t.dataSource,r,o=t.itemList.height();e.suspendPaint(),e.options.showHorizontalScrollbar=!1,e.options.showVerticalScrollbar=!1,20*i.length>o&&(e.options.showVerticalScrollbar=!0),a=n.dw(1).length,u=n.getViewportTopRow(1),t.rst(n,10,u,a,i),!e.options.showVerticalScrollbar&&e.options.showHorizontalScrollbar&&20*i.length>(o-=22)&&(e.options.showVerticalScrollbar=!0),e.resumePaint()},e.prototype.tct=function(t){for(var n,e,n,i,r,o,a,u,n=this,e=n.Mut,n=n.ast=e.sheets[0],i=n.rowOutlines,o=[],a=[],u=0;u<t.length;u++)r=t[u].level,t[u+1]&&t[u+1].level===r+1&&(0===r?o.push(u):1===r&&a.push(u));1===o.length?1!==a.length&&a.forEach(function(t){i.setCollapsed(t,!0)}):(o.forEach(function(t){i.setCollapsed(t,!0)}),a.forEach(function(t){i.setCollapsed(t,!0)})),n.$A(0)},e.prototype.Nst=function(t,n){var e,i,r,o,a,u,r,n,r,n,e=this,i=e.Mut,r=e.sheet,o,a=e.itemList.height(),u=e.ast=i.sheets[0];i.suspendEvent(),u.suspendPaint(),r.endEdit(),n||u.reset(),r=i.options,n=u.options,r.showHorizontalScrollbar=!1,r.showVerticalScrollbar=!1,n.colHeaderVisible=!1,n.rowHeaderVisible=!1,n.selectionBackColor="transparent",n.selectionBorderColor="transparent",n.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},n.isProtected=!0,u.defaults.rowHeight=20,u.defaults.colWidth=30,u.setRowCount(0===t.length?0:t.length+1),(r=new x.Style).font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',r.vAlign=2,u.setDefaultStyle(r),u.Jst=!0,0<t.length&&e.Ist?(e.Ist=!1,t.unshift({name:E().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),e.Fat=!0):0===t.length&&(e.Ist=!1),e.nct(u,t,i),20*t.length>a&&(i.options.showVerticalScrollbar=!0),n=u.dw(1).length,e.rst(u,30,0,n,t),u.resumePaint(),i.resumeEvent()},e.prototype.qst=function(t,n){var e,i,r,o,a,u,s;if(0!==n.length){if(o=i=0,a=t.outlineColumn,u=(e=this).ist,t.suspendPaint(),t.autoGenerateColumns=!1,t.bindColumn(0,"name"),t.setDataSource(n),"text"!==(s=e._st())&&"number"!==s||e.sheet.outlineColumn&&e.sheet.outlineColumn.Un(e.filterButtonInfo.col))for(;o<n.length;o++)i=n[o].level,t.getCell(o,u).textIndent(i);else t.getCell(-1,u).textIndent(i);for(a.refresh(),o=0;o<n.length;o++)r=n[o].status,a.ect(o,r);t.resumePaint()}},e.prototype.nct=function(t,n,e){var n,n;0!==n.length&&(t.suspendPaint(),t.autoGenerateColumns=!1,t.bindColumn(1,"name"),t.bindColumn(0,"status"),t.setDataSource(n),t.setColumnCount(2),(n=new x.Style).locked=!1,t.setStyle(-1,0,n),(n=new U.CheckBox)._caption="  ",n._textAlign=2,t.setCellType(-1,0,n),e.bind(x.Events.EditStarting,function(t,n){n.cancel=!0}),t.resumePaint())},e.prototype.xst=function(t){var n=this;!1===n.Jut?(n.Eat=n.Gst(n.filterButtonInfo.col,t,n._at,!0),n.Lat=n.Dat.length,n.Nst(n.dataSource,!1)):(n.Ust(n.filterButtonInfo.col,t,n._at),n.kst(n.dataSource))},e.prototype.Wut=function(t){var n,e,i,n,r,r,o,e,r,o,a,n=this,e=n.filterButtonInfo,i=e.rowFilter,n=n.sheet,r=i.Uoe(),r=n.JS(r);i&&n&&n._B()&&(o=n.TB(r,!0,null),e=e.col,r={sheet:n,sheetName:n.name(),col:e,ascending:t,range:r,compareFunction:j,groupSort:o.groupSort,ignoreHidden:o.ignoreHidden,cancel:!1},n.ki(x.Events.RangeSorting,r),!1===r.cancel)&&(o=i.nM?i.nM.name():j,(0,H.zA)("sortFilter",a={tableName:o,colIndex:e,compareFunction:r.compareFunction,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,isAsc:t},n),n.ki(x.Events.RangeSorted,r))},e.prototype.Aot=function(t,n,e){var i,r,o,i,r,a,o,u,i=this,r=i.filterButtonInfo,o=r.rowFilter,i=i.sheet;o&&i&&i._B()&&(e=e!==j&&e,r=r.col,a={sheet:i,sheetName:i.Zc,col:r,ascending:e,color:t,isBackColor:n,cancel:!1},i.ki(x.Events.RangeSorting,a),!1===a.cancel)&&(o=o.nM?o.nM.name():j,(0,H.zA)("sortFilter",u={tableName:o,colIndex:r,isAsc:e,color:t,isBackColor:n},i),i.ki(x.Events.RangeSorted,a))},e.prototype.but=function(){var t,n,e,t=(0,x.GC$)("#"+v),n=ct+f+" "+ft,e=!1===this.Jut?this.Lat:0<w(this.Dat);(this.Bat||e?(t.prop("disabled",!1),F):(t.prop("disabled",!0),R))(t[0],n)},r.iut=e},"./dist/plugins/filter/filter.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/filter/filter-ns.js"),n),e("./dist/plugins/filter/filter-actions.js"),r(e("./dist/plugins/filter/filter-ui.js"),n),r(e("./dist/plugins/filter/filter.js"),n)},"./dist/plugins/filter/filter.js":function(c,t,n){"use strict";var f,J,x,K,u,X,g,e,N,D,j,O,E,l,k,h,v,_,b,q,p,R,$,L,B,n,w,y,M,tt,nt,i,et,P,n,G,U,H,V,z,F,Y,Z,W,n,Q,it,rt,ot,at,e,ut;function st(t){var i={};return t.forEach(function(t){var n,e,n=t.col,e;t.visibleIndex.forEach(function(t){i[t]?i[t].push(n):i[t]=[n]})}),i}function ct(t,n,e){var t,n,t={cmd:t,sheetName:e.name(),cmdOption:n};e._isExternalFilter?(n=K.Commands[t.cmd])&&n.execute(e.parent,t,0):e.Qy().execute(t)}function ft(t,n,e,i){for(var r,o,o=0;o<tt(t);o++)if((r=t[o])&&r.row===n&&r.col===e&&r.sheetArea===i)return r;return b}function lt(t,n){var e,i,t,e=d(t),i=t.compareType();2===e||7===e?(t=t.art,-1!==w(n,"T")||t?-1===w(n,"DT")&&t&&n.push("DT"):n.push("T")):3===e?0===i&&-1===w(n,"BC")?n.push("BC"):1===i&&-1===w(n,"FC")&&n.push("FC"):-1===w(n,"V")&&n.push("V")}function ht(t){for(var n,e,i,r,o,n=[],e=0;e<tt(t);e++)0===d(i=t[e])?(r=i.item1(),o=i.item2(),r&&lt(r,n),o&&lt(o,n)):lt(i,n);return n}function C(t){return t.getColumnCount()}function S(t,n){return t.getRowCount(n)}function d(t){return t.conType()}function dt(t,n,e,i){var r=t.getSpan(n,e,i);return r=!r&&t.Cb?t.Cb.D7(n,e,i):r}function m(t){return $(t)?t:2<=t.length&&"="===t[0]?t.substring(1):"="===t?"":t}function vt(t){return"number"==typeof t?"number":t instanceof Date||"string"==typeof t&&0===t.indexOf("/OADate(")&&t.indexOf(")")===t.length-2?"date":"boolean"==typeof t?"boolean":""}function mt(t){var n=t.formula();return n=$(n)&&(n="string"==typeof(n=t.expected())?'"'+n+'"':n)instanceof Date?_(n)+"":n}function gt(t,n,e){var t,i,e,i,t=j(t,"colorFilter");t&&(i=E(t.dxfId,0),e=e.getDxf(i),i=O(t.cellColor,!0),n.push(p(3,i?0:1,e&&e.backColor)))}function pt(t,n,e){var t,i,r,t,o,a,u,s,c,f,l,h,d,v,m,g,l,l,t=j(t,"filters");if(t){if(i="1"===t.blank,r=D(t,"filter"),t=D(t,"dateGroupItem"),i&&(r=r||[]).push({n_:"filter",val:""}),r)for(o=0,a=r;o<a.length;o++)u=a[o],(s=p(2,0,k(u.val))).ignoreCase(!0),s.ignoreBlank(i),n.push(s);if(t)for(c=0,f=t;c<f.length;c++)l=f[c],h=E(l.day,1),d=E(l.hour,0),v=E(l.minute,0),m=E(l.month,0),g=E(l.second,0),l=E(l.year,0),l=new Date(l,0<m?m-1:m,h,d,v,g),(s=p(2,0,e.format(l))).art=!0,s.urt=l,s.useWildCards(!1),s.ignoreBlank(!1),n.push(s)}}function bt(t,n,e){var i,r,o,o,r={none:0,equal:0,lessThan:4,lessThanOrEqual:5,notEqual:1,greaterThan:2,greaterThanOrEqual:3};switch(t){case"string":i=2;break;case"number":i=1,o=parseFloat(e),isNaN(o)||(e=o);break;case"date":i=5,e="string"==typeof e&&0===e.indexOf("/OADate(")?(o=parseInt(e.replace("/OADate(",""),10),v(o)):v(parseInt(e,10)),r={none:0,equal:0,lessThan:2,lessThanOrEqual:3,notEqual:1,greaterThan:4,greaterThanOrEqual:5};break;default:i=11}return p(i,r[n],e)}function wt(t,n,s){var t,e,t,i,t,r,o;function a(t,n){var e,i,r,o,a,r,u,r="notEqual"===t,o=n.indexOf("*"),a=n.lastIndexOf("*");return-1!==o?(e=o===n.length-1&&0!==o?p(2,i=r?3:2,n.substring(0,n.length-1)):0===o&&o===a?p(2,i=r?5:4,n.substring(1)):(r=r?7:6,-1!==o&&-1!==a&&(n=n.substr(1,n.length-2)),p(2,r,n))).ignoreCase(!0):e=bt(u=vt(s),t||"none",n),e}(t=j(t,"customFilters"))&&(e=t.and,i=(t=D(t,"customFilter"))[0],t=t[1],r=void 0,i&&(r=a(i.operator,i.val)),t?n.push(p(0,o="1"===e?1:0,b,b,b,b,b,r,a(t.operator,t.val))):n.push(r))}function yt(t,n,e){var t,i,r,t,e,o,t=j(t,"dynamicFilter");t&&(i=Z[t.type],r=t.val,t=t.maxVal,e=new K.Range(e.row,e.col,e.rowCount,1),o=void 0,100===i||101===i?o=p(10,b,b,b,b,i-100,[e]):16===i?(o=p(6,b,0)).expectTypeId(6):17<=i&&i<=20?(o=p(6,b,i-17)).expectTypeId(2):21<=i&&i<=32?(o=p(6,b,i-21)).expectTypeId(3):0<=i&&i<=15&&(o=p(6,b,i)),o)&&($(r)||(o.value=r),$(t)||(o.maxValue=t),n.push(o))}function Mt(t,n){var t,e,i,t,e,t=j(t,"top10");t&&(e=l(t.val,NaN),i=O(t.percent,!1),t=O(t.top,!0)?0:1,(e=p(8,b,e,b,b,t)).isPercent(i),n.push(e))}function Ct(t,n,e,i){var r,o,a;if(1===e.colCount){for(r=[],a=e.row;a<e.row+e.rowCount;a++)o=t.getValue(a,e.col),$(o)||r.push(o);return r.sort(function(t,n){return i?n-t:t-n}),r[n-1]}}function St(t){var n,e,i,r,o,a,r,n=[],e=[];for(e.push(t);0<e.length;)0===(o=(r=(i=e.shift())instanceof X.Condition)?i.conType():i.conType)?(a=r?i.item1():i.item1,r=r?i.item2():i.item2,$(a)||e.push(a),$(r)||e.push(r)):n.push(i);return n}function Tt(t,n){var e,t,i,n,e=t.expected(),t=0===t.compareType(),i,n={n_:"colorFilter",dxfId:n.getDxfIndex(t?{backColor:e}:{backColor:{type:1,patternColor:e}})};return t||(n.cellColor="0"),n}function At(t,n,e){var i,r,o,n,a,i={n_:"top10"},r=1===n.type(),o=n.isPercent(),n=n.expected(),a=NaN;return r&&(i.top=0),o&&(i.percent=1),$(n)||(o&&(n=Math.ceil(e.rowCount%n/100)),$(e))||(a=Ct(t,n,e,!r)),isNaN(n)||(i.val=n),isNaN(a)||(i.filterVal=a),i}function It(t,n,e,i,r){var o,n;return $(t)?b:(o=Y[t],6===n&&(o=W[e][t]),(n={n_:"dynamicFilter"}).type=o&&"null"!==o?o:"null",o&&"Q"!==o[0]&&"M"!==o[0]&&($(i)||(n.val=i),$(r)||(n.maxVal=r)),n)}function xt(t,n,e){for(var i,r,n,o,a,u,s,c,i=n.type(),r=n.conType(),n=n.expectTypeId()||0,o=0,a=0,s=0;s<e.rowCount;s++)c=parseFloat(t.getValue(e.row+s,e.col)),isNaN(c)||(o+=c,a++);return It(i,r,n,u=0<a?o/a:u)}function Nt(t){var n,e,i,r,o,n=new Date,e=n.getDay(),i=n.getDate(),r=new Date(n),o=new Date(n);switch(t){case 3:r.setDate(i-6);break;case 1:r.setDate(i-1);break;case 0:break;case 2:r.setDate(i+1);break;case 8:r.setDate(i-e-7),o.setDate(i-e-1);break;case 7:r.setDate(i-e),o.setDate(i-e+6);break;case 9:r.setDate(i-e+7),o.setDate(i-e+13);break;case 5:r.setDate(1),r.setMonth(r.getMonth()-1),o.setDate(0);break;case 4:r.setDate(1),o.setMonth(o.getMonth()+1),o.setDate(0);break;case 6:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+2),o.setDate(0)}return r.setHours(0),r.setMinutes(0),r.setSeconds(0),o.setHours(23),o.setMinutes(59),o.setSeconds(59),{from:r,to:o}}function kt(t){var n,e,t,i,r,o,n=t.expected(),e=t.conType(),t=t.expectTypeId();return 0<=n&&n<=15||21<=n&&n<=32?(o=Nt(n)).from&&o.to&&(i=o.from,r=o.to):n=-1,It(n,e,t,i,r)}function T(t,n){var e,i,e={n_:"customFilter"},i;return"none"!==(t={"-1":"none",0:"equal",4:"lessThan",5:"lessThanOrEqual",1:"notEqual",2:"greaterThan",3:"greaterThanOrEqual"}[t])&&(e.operator=t),e.val=""+n,e}function A(t,n,e){var i;return $(t)&&$(e)?b:(i={n_:"customFilters"},n&&(i.and="1"),$(t)||(i.c_||(i.c_=[]),i.c_.push(t)),$(e)||(i.c_||(i.c_=[]),i.c_.push(e)),i)}function I(t,n,e){var i,r,e,o,i={n_:"filters",c_:[]};return e&&(i.blank="1"),(t=[].concat(t))&&0<t.length&&(r=[],e=[],n||t.forEach(function(t){var t,t,t=t.expected();$(t)||(""===t?i.blank="1":(t={n_:"filter",val:h(t)},r.push(t)))}),0<r.length&&(e=e.concat(r)),o=[],0<(e=n&&(t.forEach(function(t){o.push(jt(t.expected()))}),0<o.length)?e.concat(o):e).length)&&(i.c_=e),i}function _t(t,n){var e,i,r,e,e=t.compareType();if(!$(e))return i=t.expected(),r=void 0,e=T(e,r=$(i)?m(t.D5)+"":i+""),n?e:A(e)}function Dt(t,n){var e,i,r,e=t.expected(),i=-1;switch(t.compareType()){case 0:return I(t);case 1:i=1;break;case 2:e+="*";break;case 3:i=1,e+="*";break;case 4:e="*"+e;break;case 5:i=1,e="*"+e;break;case 6:e="*"+e+"*";break;case 7:i=1,e="*"+e+"*"}return r=T(""+i,e),n?r:A(r)}function jt(t,n){var e,i,r,o,a,u,t,e={n_:"dateGroupItem"},i=t.getFullYear(),r=t.getMonth()+1,o=t.getDate(),a=t.getHours(),u=t.getMinutes(),t=t.getSeconds();return 0<i&&(e.year=i),0<=r&&r<12&&(e.month=r),0<o&&o<32&&(e.day=o),a<24&&(e.hour=a),u<60&&(e.minute=u),t<60&&(e.second=t),e.dateTimeGrouping="day",e}function Ot(t,n){var e,i,r,e,e=t.compareType();if(0===e)return I(t,n);switch(i=-1,e){case 0:break;case 1:i=1;break;case 2:i=4;break;case 3:i=5;break;case 4:i=2;break;case 5:i=3}return-1!==i?(e=T(""+i,r=mt(t)),n?e:A(e)):void 0}function Et(t,n){return t.every(function(t){return t.conType()===n})}function Rt(t){var n=-1;switch(t){case 0:case 2:case 4:case 6:n=0;break;case 1:case 3:case 5:case 7:n=1;break;default:n=0}return""+n}function Ft(t,n){switch(n){case 0:case 1:return t;case 2:case 3:return t.concat("*");case 4:case 5:return"*".concat(t);case 6:case 7:return"*".concat(t).concat("*");default:return t}}function Lt(t,n,e,i,r){var o;if(!$(n))return 3===(o=n.conType())?Tt(n,i):8===o?At(t,n,e):10===o?xt(t,n,e):6===o?kt(n):11===o||1===o?_t(n,r):2===o?Dt(n,r):5===o?Ot(n,r):void 0}function Bt(t,n,e){var i,r,o,a,u,s,c,t,f,l,h,d,t,f,t,v,t,i=St(t),r=i.length,o;if(0===t.compareType()){if(Et(i,5))return I(i,!0);if(Et(i,2)){if(a=!1,r<=2)for(u=0,s=i;u<s.length;u++)if(0!==(c=s[u]).compareType()){a=!0;break}return a?(f=(t=i[0]).compareType(),l=t.expected(),h=T(Rt(f),$(l)?m(t.D5):Ft(l,f)),d=void 0,2===r&&(f=(t=i[1]).compareType(),l=t.expected(),d=T(Rt(f),$(l)?m(t.D5):Ft(l,f))),A(h,!1,d)):I(i)}if(Et(i,11)){if(t=!0,t=i.length<=2?!1:t)return I(i);if(0<i.length)return t=(f=i[0]).compareType(),l=f.expected(),d=h=void 0,h=T(t,$(l)?m(f.D5):l),2===r&&(t=(f=i[1]).compareType(),l=f.expected(),d=T(t,$(l)?m(f.D5):l)),A(h,!1,d)}return A(v=Lt(n,i[0],e,t=void 0,!0),!1,t=1<r?Lt(n,i[1],e,void 0,!0):t)}if(2===r)return h=Lt(n,i[0],e,void 0,!0),$(h)||(d=Lt(n,i[1],e,void 0,!0),$(d))?b:A(h,!0,d)}function Pt(t,n,e){var n,i,n,r,t,r;if(t&&!$(t.ascending)&&!$(t.index))return i={n_:"sortState",ref:n=K.range_parser.getRangeString([new K.Range(n.row,t.index,n.rowCount,1)])},n={n_:"sortCondition",ref:n},t.ascending||(n.descending=1),(r=t.color)!==q&&(t=t.isBackColor,"{"===r[0]&&(r=JSON.parse(r)),r=t?{backColor:r}:{foreColor:r},n.sortBy=t?K.SortBy.cellColor:K.SortBy.fontColor,n.dxfId=e.getDxfIndex(r)),i.c_||(i.c_=[]),i.c_.push(n),i}function Gt(t){for(var n in t)if(t.hasOwnProperty(n)&&!t[n])return;return 1}function Ut(t,n,e){for(var i,r,o,a,u,s,c,f,i=0;i<tt(n);i++)if(!$(n[i]))for(o=(r=n[i]).conditions,a=0;a<tt(o);a++)(u=o[a])&&(s=void 0,f=t[c=r.index],!1===u.isCondition?s=u:(s=p()).fromJSON(u,e),(f=f||(t[c]=[])).push(s))}function Ht(t){for(var n,e,i,r,o,a,n=0,e=[],i=0;i<tt(t);i++)if(r=t[i]){for(o=[],a=void 0,a=0;a<tt(r);a++)o.push(r[a]instanceof X.Condition?r[a].toJSON():J(J({},r[a]),{isCondition:!1}));e[n]={index:i,conditions:o},n++}return e}function r(t){var n=this;n.range=t,n.ict=!0,t&&(n.rct=new K.Range(t.row,t.col,t.rowCount,t.colCount)),n.reset(),n.typeName="",n.filterHandler=b,n.oct()}function Vt(t){return t.lossless||(t.lossless={}),t.lossless.definedNames||(t.lossless.definedNames=[]),t.lossless.definedNames}function zt(t,n){var e,i,t,r,n,e,e=n.IB;n&&e&&e.range&&(i=n.name(),t=Vt(t),r=e.f8?n.frozenRowCount():0,n=qt(n,e.range,r),e=(0,K.getAbsoluteRangeText)(n.row,n.row+n.rowCount,n.col,n.col+n.colCount,i))&&t.push({name:"_xlnm._FilterDatabase",formula:e})}function Yt(t,n){var e,i,n,r,o,a,u,s,c,f,l;if(n&&(e=t.getRowCount(),i=t.getColumnCount(),r=(n=Zt(t,n,e,i)).row,o=n.col,a=n.rowCount,u=n.colCount,s=t.tables,!$(s)))for(c=r;c<r+a;c++)for(f=o;f<o+u;f++)if(l=s.find(c,f))return l}function Zt(t,n,e,i){var r=n.row,o=n.col,a=n.rowCount,n=n.colCount;return e=e||t.getRowCount(),i=i||t.getColumnCount(),-1===r&&(r=0,a=e),-1===o&&(o=0,n=i),new K.Range(r,o,a=e<r+a?e-r:a,n=i<o+n?i-o:n)}function o(t){var t=ut.call(this,t)||this;return t.dialogOptions={allowResize:!0,keepDialogSize:!0},t.act=!0,t.typeName=nt,t.uct=et.extend({},F),t.Qst=new u.Formatter.GeneralFormatter("yyyy/mm/dd"),t}function a(){this.c5()}function Wt(t,n,e,i){var r=t.typeName,r,o;r&&r!==nt?(r=(0,K.getTypeFromString)(r))&&(o=new r):o=new Q,o&&((n.IB=o).Mf=n,o.fromJSON(t,e),o.sct=!!i,i?o.reFilter():o.xCe())}function Qt(t,n,e,i,r){var o,o,a,o,o=t.lossless&&t.lossless.typeName;o&&o!==nt?(o=(0,K.getTypeFromString)(o))&&(a=new o):a=new Q,a&&((n.IB=a).Mf=n,a.yh(t,void 0,e,r),(o=n.parent)&&!0!==o.options.allowAutoExtendFilterRange&&(o.options.allowAutoExtendFilterRange=!0),a.sct=!!i,i?a.reFilter():a.xCe())}function Jt(a){a&&(a.bind("shiftCellsDown"+i,function(t,n){var e,i,r,o,n,e=a.rowFilter();e&&e.range&&(i=n.row,r=n.col,o=n.changedRowCount,n=n.changedColCount,e.range.row+e.range.rowCount===i&&--i,e.range.col+e.range.colCount===r&&1!==e.range.colCount&&--r,e.range.contains(i,r,1,1))&&(0<o?e.JO(i,o):o<0&&e.xP(i,o),0<n?e.qO(r,n):n<0&&e.NP(r,n))}),a.bind(K.Events.CellChanged+i,function(){Kt(a,!0)}),a.bind(K.Events.RangeChanged+i,function(){Kt(a,!0)}),a.bind(K.Events.RowChanged+i,function(){Kt(a,!0)}),a.bind(K.Events.ColumnChanged+i,function(){Kt(a,!0)}))}function Kt(t,n){var t=t.rowFilter();t&&(t.ict=n)}function Xt(t){t&&(t.unbind("shiftCellsDown"+i),t.unbind(K.Events.CellChanged+i),t.unbind(K.Events.RangeChanged+i),t.unbind(K.Events.RowChanged+i),t.unbind(K.Events.ColumnChanged+i))}function qt(t,n,e){void 0===e&&(e=0);var i=n.row,r=n.col,o=n.rowCount,n=n.colCount;return-1===i&&(i=e,o=t.getRowCount()),-1===r&&(r=0,n=t.getColumnCount()),i<=0?i=0:(i--,o+=1),R(i,r,o,n)}function $t(t){for(var n,e,i,n=[],e=Object.keys(t),i=0;i<e.length;i++)n.push(+e[i])}function s(t,n){n&&(t.filterRowsVisibleInfo=n)}function tn(t,n){var t,e,i,t,n,r,o,a,u,s,c,e=-1,i=null==(t=t.filterRowsVisibleInfo)?void 0:t.rowsVisibleInfo,t=null==n?void 0:n.rowsVisibleInfo;if(i&&t){for(n=Object.keys(i),r=Object.keys(t),o=0,a=n;o<a.length;o++)if(i[u=a[o]]!==r[u]){e=+u;break}for(s=0,c=r;s<c.length;s++)if(r[u=c[s]]!==i[u]){(e<0||+u<e)&&(e=+u);break}}return e}function nn(t,n){var n=t.vw(n);-1!==n&&n<t.Tb&&(t.Tb=n,t.ly=0)}function en(t){var n,e,t;return!$(t)&&(n=t.type(),10!==(e=t.conType())||(t=Y[n],!$(t)))}f=this&&this.__extends||(at=function(t,n){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}at(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),J=this&&this.__assign||function(){return(J=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},x=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.HideRowFilter=t.RowFilterBase=t.FilterActionType=t.zA=void 0,K=n("Core"),u=n("Common"),X=n("ConditionalFormatting"),g=n("./dist/plugins/filter/filter-ui.js"),e=n("./dist/plugins/filter/filter-ns.js"),N=n("./dist/plugins/filter/filter-button-images.js"),D=K.mt.go,j=K.mt.xr,O=K.NodeHelper.ur,E=K.NodeHelper.sr,l=K.NodeHelper.ar,k=K.mt.n1,h=K.mt.vo,v=u.Common.ct.Y0,_=u.Common.ct.o0,b=null,q=void 0,p=X.aJ,R=K.Ec,$=u.Common.lt.ht,L=u.Common.lt.Nh,B=parseInt,n=u.Common.Uf,w=n.hD,y=n.OS,M=n.VP,tt=n.tR,nt="HideRowFilter",i=".filter",et=K.GC$,P=et.each,n=new u.Common.ResourceManager(e.SR,"Filter"),G=n.getResource.bind(n),U=K.UsedRangeUtil.vh,H=K.UsedRangeUtil.hh,t.zA=ct,et.extend(K.Worksheet.prototype,V={rowFilter:function(t){var n=this,e=n.IB;return!tt(arguments)||t&&Yt(n,t.range)?e:(n.Ut.cct(e,0),e&&e.reset(),(e=n.IB=t)&&(n.IB.Mf=n),n.zw(),n.Ut.cct(e,0,q,!0),n)},fct:function(){var t,r,n,e,i,o,a,u,s,c,f,l,h,e,t=this,r=[],n=t.rowFilter(),e=n&&n.range,i=t.tables;if(e&&(s=e.row,f=void 0,l=(c=e.col)<0?C(t):c+e.colCount,a=c<0?0:c,f=s<1?(o=S(t,1)-1,1):(o=s-1,3),0<=o))for(;a<l;)n.filterButtonVisible(a)?((u=new g.rut(n)).sheetArea=f,(h=dt(t,u.row=o,a,f))?(u.row=h.row,u.col=h.col,a+=h.colCount):(u.col=a,a++),r.push(u)):a++;return i&&(e=i.all(),P(e,function(t,n){if(o=n.headerIndex(),n&&n.showHeader()&&0<=o)for(var e=n.range(),i=void 0,i=0;i<e.colCount;i++)a=e.col+i,n.filterButtonVisible(i)&&(u=new g.rut(n.rowFilter(),o,a,3),r.push(u))})),r},AO:function(){var t=this,n,n;return n=(n=t.lct)||(t.lct=t.fct())},XT:function(t,n){var e=this.filterRowsVisibleInfo;return!(3!==(n=$(n)?3:n)&&2!==n||!e||e.hct(t))},iA:function(){return this.filterRowsVisibleInfo.dct()},an:function(t,n,e){var i,r,o,a,n,i,a,o,i=this,r=i.zoom(),o=i.parent,a=1<r?1:r,n=3===n||n===q?i.defaults.rowHeight:i.defaults.colHeaderRowHeight,i=B((Math.min(20,n)*a).toString());return o&&o.options.useTouchLayout&&(i=B((n*r).toString())),a={x:t.x+t.width-i,y:t.y+t.height-i,width:i,height:i},e&&0!==e.columnHeaderFitMode&&(o=e.cellWidth)&&(a.x=t.x+o-i),a}}),(e=z=t.FilterActionType||(t.FilterActionType={}))[e.filter=0]="filter",e[e.unfilter=1]="unfilter",F={sortByValue:!0,sortByColor:!0,filterByColor:!0,filterByValue:!0,listFilterArea:!0},Y={"-1":"null",0:"aboveAverage",1:"belowAverage"},Z={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},W=[["today","yesterday","tomorrow","lastWeek","thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear"],[],["Q1","Q2","Q3","Q4"],["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],[],[],["yearToDate"]],r.prototype.getUsedRange=function(){var t,n,t,n=this.extendedRange;return H(n)},r.prototype.oct=function(){var n=this;Object.defineProperty(n,"extendedRange",{get:function(){return n.vct()?(n.ict&&n.mct(),n.rct):n.range},set:function(t){n.rct=t,n.vct()&&n.mct()}})},r.prototype.vct=function(){var t=this,n=t.Mf,n=n&&n.parent;return n&&n.options.allowAutoExtendFilterRange&&t.act},r.prototype.Ale=function(){var t,n,e,n,i,r,o,a,u,n,s,c,t=this,n=t.Mf,e=null==n?void 0:n.Ut,n=t.range;if(n&&e){for(r=(i=new K.Range(n.row,n.col,n.rowCount,n.colCount)).row,o=i.col,a=i.colCount,s=n=r+(u=n.rowCount),c=-1;t.gct(e,s,o,1,a);)s++;return c=Math.max(n,s),i.rowCount=c-r,i}},r.prototype.mct=function(){var t=this,n=t.Mf,n=null==n?void 0:n.Ut,e;t.range&&n&&(t.rct=t.Ale(),t.ict=!1)},r.prototype.L0=function(){this.Mf=b,this.nM=b},r.prototype.gct=function(t,n,e,i,r){for(var o,a,o=n;o<n+i;o++)for(a=e;a<e+r;a++)if(!$(t.getValue(o,a,K.SheetArea.viewport,!0)))return!0;return!1},r.prototype.filterButtonVisible=function(t,n){var e,i,r,o,a,i,u,s,c,i,f,l,h,e=this,i=e.Uoe();if(!$(i)){if(r=e.Mf,o=e.pct(i),a=e.bct(i,r),u=e.srt,s=tt(i=arguments),i=typeof(c=i[0]),0===s){for(f=o;f<a;f++)if(u[f]||u[f]===q)return!0;return!1}if(l=t,1===s){if("number"==i)return(h=o<=l&&l<a)&&u[l]===q&&(u[l]=!0),u[l];if("boolean"==i){for(r&&r.Ut.cct(e,3),f=o;f<a;f++)u[f]=c;r&&r.Ut.cct(e,3,q,!0)}}else 2===s&&o<=l&&l<a&&(r&&r.Ut.cct(e,4,t),u[l]=n,r)&&r.Ut.cct(e,4,t,!0);return r&&r.zw(),e}},r.prototype.pct=function(t){return t.col<0?0:t.col},r.prototype.bct=function(t,n){return n&&t.col<0?C(n):t.col+t.colCount},r.prototype.addFilterItem=function(t,n){var e,i,r,o,a,u,e=this,i=e.Mf,r=e.Uoe(),o=e.rrt,a=o[t];if($(n))throw new Error(G().Exp_FilterItemIsNull);if(t<-1||t>=C(i))throw new Error(G().Exp_InvalidColumnIndex);if(r&&(i.Ut.cct(e,5),!(t<(r=i.JS(r)).col||t>=r.col+r.colCount))){if(a=a||[],n instanceof X.Condition)a.push(n);else if(L(n))for(u=0;u<n.length;u++)a.push(n[u]);o[t]=a,i.Ut.cct(e,5,q,!0)}},r.prototype.removeFilterItems=function(t,n){this.Mf.Ut.cct(this,6),this.yct(t),this.unfilter(t,n),this.Mf.Ut.cct(this,6,q,!0)},r.prototype.yct=function(t){var n=this,e=n.rrt;n.wct(t),$(t)?n.rrt=[]:e[t]&&e.splice(t,1,b)},r.prototype.unfilter=function(t,n){var e,i,r,o,a,e=this,i=e.Mf;if(i){if(i.Ut.cct(e,2),r=[],o=e.Mct,a=void 0,$(t))for(a=tt(o)-1;0<=a;a--)r.push(o[a]),e.Cct(o[a]);else r.push(t),e.Cct(t),e.reFilter(n);n||e.Sct(i,1,r),i.Ut.cct(e,2,q,!0)}},r.prototype.Tct=function(t){var r,n,e,i,o,a,u,e,s,c,r=this,n=r.Uoe();r.Cct(t),r.rrt[t]&&n&&(-1!==(e=n.col)&&(t<e||t>=e+n.colCount)||(n=r.Mf.JS(n),i=n.row,o=n.rowCount,a=r.Act(t,i,o),e=r.Ict(i,o,t,a),s=e.otherConditionals,(c=e.filterData).forEach(function(t){var n,e,t,i,n=t.row,e=t.col,t=t.condition;r.jct(n,e),(i=r.isRowFilteredOut(n))||r.Rct(t)}),r.ICe(s,function(){for(u=i;u<i+o;u++)r.isRowFilteredOut(u)||r.xct(s,u,t,a)}),r.Nct(t,!0)))},r.prototype.NCe=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Uoe();if(n){for(e=n.row,i=n.col,r=n.rowCount,o=n.colCount,-1===e&&(e=0,r=t.Mf.getRowCount()),-1===i&&(i=0,o=t.Mf.getColumnCount()),a=[],u=i;u<i+o;u++)(s=t.kCe(u,e,r))&&a.push({col:u,visibleIndex:s});return a=a.sort(function(t,n){return n.visibleIndex.length-t.visibleIndex.length})}},r.prototype.kCe=function(e,i,r){var o,a,t,n,u,t,s,c,o=this,a=o.Act(e,i,r),t=o.rrt[e],n=o.isFiltered(e),u=[];if(t&&!(t.length<1)&&n)return t=o.Ict(i,r,e,a),s=t.otherConditionals,(c=t.filterData).forEach(function(t){return u.push(t.row)}),o.ICe(s,function(){for(var t,n,t=i;t<i+r;t++)(n=o._Ce(s,t,e,a))&&u.push(t)}),u},r.prototype.Act=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,v,i=this,r=i.Mf,o=ht(i.rrt[t]),a={},u=tt(o),s=n;s<n+e;s++){for(h={},c=0;c<u;c++)"T"===(f=o[c])?(d=r.getValue(s,t),v=r.getText(s,t),("number"==typeof d||d instanceof Date)&&(h.V=d),h[f]=v&&v.trim()):"DT"===f?(d=r.getValue(s,t),v=i.Qst,h[f]=v.format(d)):"BC"===f?(l=r.getActualStyle(s,t,3,!1,!1,!0))&&(h[f]=l.backColor):"FC"===f?(l=r.getActualStyle(s,t,3,!1,!1,!0))&&(h[f]=l.foreColor):"V"===f&&(h[f]=r.getValue(s,t));a[s]=h}return a},r.prototype.filter=function(t,n){var e,i,r,o,a,e=this,i=e.Mf,r=e.rrt;if(i){if(i.Ut.cct(e,7),!(a=[])===e.sct&&(delete e.sct,e.Mct=[]),$(t))for(o=0;o<tt(r);o++)r[o]&&(a.push(o),e.Tct(o));else{if(!r[t])return;a.push(t),e.Tct(t)}n||e.Sct(i,0,a),i.Ut.cct(e,7,q,!0)}},r.prototype.Sct=function(t,n,e){var i,n,i=this;K.Worksheet.et(t,"onFilterChanged"),n=i.Dct(n,e),i.filterHandler&&i.filterHandler(n),i.onFilter(n),t.zw()},r.prototype.Dct=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.Mf,r=e.Uoe(),o=[],a=[];if(r)for(c=void 0,c=s=(u=i.JS(r)).row;c<s+u.rowCount;c++)(e.isRowFilteredOut(c)?a:o).push(c);return{action:t,sheet:i,range:r,filteredRows:o,filteredOutRows:a,columns:n}},r.prototype.onFilter=function(t){},r.prototype.isFiltered=function(t){var n=this.Mct;return arguments.length?y(n,t):0<n.length},r.prototype.isRowFilteredOut=function(t){var n,e,i,r,n=this,e=n.Uoe();return!(!n.isFiltered()||!e||(i=e.row,r=n._ct[t],-1!==i&&(t<i||t>=i+e.rowCount))||tt(r)>=tt(n.Mct))},r.prototype.reset=function(){var t=this,n=t.Mf;n&&n.Ut.cct(t,8),t.nrt=b,t.unfilter(),t.rrt=[],t.Mct=[],t.Ect=[],t._ct={},t.srt={}},r.prototype.rn=function(t,n,e){var i,r,o,i,a,u,n,i=this,r=!1,o=i.Mf,i=i.Uoe();return r=i&&(a=(i=o.JS(i,e)).row,n=(u=i.col)<=n&&n<u+i.colCount,1===e&&t===S(o,e)-1&&a-1<0&&n||3===e&&t===a-1&&n)?!0:r},r.prototype.getFilterItems=function(t){var n;return this.rrt[t]||[]},r.prototype.getFilteredItems=function(){return this.Ect},r.prototype.sortColumn=function(t,n){this.ert(t,n,null)},r.prototype.ert=function(t,n,e,i,r){var o,a,u,u,s,c,o=this,a=o.Mf;if(a){u=o.Uoe(),u=a.JS(u),a.suspendPaint();try{a.Ut.cct(o,1,t),s={index:t,ascending:n,compareFunction:e},c=void 0;try{o.Ipe=!0,c=a.sortRange(u.row,u.col,u.rowCount,u.colCount,!0,[s],i,b,r)}catch(t){}finally{this.Ipe=!1}c&&(o.nrt=s,o.isFiltered(t))&&o.reFilter(),a.Ut.cct(o,1,t,!0)}finally{a.resumePaint()}}},r.prototype.sortColumnByColor=function(t,n,e,i,r,o){var a,u,s,s,n,e,a=this,u=a.Mf;if(u){s=a.Uoe(),s=u.JS(s),u.suspendPaint(),u.Ut.cct(a,1,t),n={index:t,ascending:n,color:e,isBackColor:i},e=void 0;try{a.Ipe=!0,e=u.sortRange(s.row,s.col,s.rowCount,s.colCount,!0,[n],r,b,o)}catch(t){}finally{this.Ipe=!1}e&&(a.nrt=n,a.isFiltered(t))&&a.reFilter(),u.Ut.cct(a,1,t,!0),u.resumePaint()}},r.prototype.getSortState=function(t){var n=this.nrt,e=0;return e=n&&n.index===t?n.ascending?1:2:e},r.prototype.reFilter=function(t){var n,e=this,i=e.Mct,r=tt(i);for(e.Mf.Ut.cct(e,13),e._ct={},e.Ect=[],e.Mct=[],n=0;n<r;n++)e.filter(i[n],t);e.Mf.Ut.cct(e,13,q,!0)},r.prototype.openFilterDialog=function(){},r.prototype.jct=function(t,n){var e=this._ct,i=e[t];$(i)?i=[n]:(y(i,n)&&M(i,n),i.push(n)),e[t]=i},r.prototype.Rct=function(t){var n=this.Ect;y(n,t)||n.push(t)},r.prototype.Cct=function(t){var n,e,i,r,o,n=this,e=n._ct,r;if(n.Uoe()&&n.isFiltered(t)){for(o in n.Nct(t,!1),e)o&&(i=e[o])&&y(i,t)&&(M(i,t),tt(i)||(e[o]=q));n.wct(t)}},r.prototype.Nct=function(t,n){var e=this.Mct;if(n){if(tt(e)){if(e[tt(e)-1]===t)return;M(e,t)}e.push(t)}else M(e,t)},r.prototype.wct=function(t){for(var n,e,i,r,o,a,u,n=this,e=n.rrt,i=e.length,r=[],o=[],a=0;a<i;a++)a===t?r=r.concat(e[a]):o=o.concat(e[a]);for(u=r.length,a=0;a<u;a++)y(o,r[a])||M(n.Ect,r[a])},r.prototype.Ict=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,h,r=this,o=r.rrt[e],a={},u=[],f=[],s=0;s<tt(o);s++)2!==d(c=o[s])||0!==c.compareType()||c.forceValue2Text()||c.useWildCards()||c.ignoreCase()||c.ignoreBlank()?u.push(c):c.art?a[(l=r.Qst).format(c.urt)]=c:a[c.expected()]=c;for(s=t;s<t+n;s++)a[(h=i[s]).T]===q&&a[h.DT]===q||(h=a[h.T]||a[h.DT],f.push({row:s,col:e,condition:h}));return{otherConditionals:u,filterData:f}},r.prototype.ICe=function(t,n){t.forEach(function(t){t.ZJ()}),n(),t.forEach(function(t){t.WJ()})},r.prototype.DCe=function(t,n,e,i){var r,o,a,u,s,c,a,u,o,i,r=this,o=r.Uoe(),a=t.item1(),u=t.item2();if(0===d(t)?(a&&(s=r.Bct(a,n,e,o,i)),u&&(c=r.Bct(u,n,e,o,i))):s=r.Bct(t,n,e,o,i),a=i[n].V,!$(a)){if(u=t.conType(),o=t.compareType(),i=t.expected(),"number"==typeof a||a instanceof Date){if(2===u){if([6,2,4].includes(o))return!1;if([7,3,5].includes(o))return!0}if(11===u&&"string"==typeof i&&[2,3,4,5].includes(o))return!1}if("string"==typeof a&&11===u&&"number"==typeof i&&[2,3,4,5].includes(o))return!1}return t.evaluate(r.Mf,n,e,s,c)},r.prototype._Ce=function(t,n,e,i){for(var r,o,a,r=0;r<tt(t);r++)if(o=t[r],a=this.DCe(o,n,e,i))return!0;return!1},r.prototype.xct=function(t,n,e,i){for(var r,o,a,u,r=this,o=0;o<tt(t);o++)a=t[o],(u=r.DCe(a,n,e,i))&&(r.jct(n,e),r.Rct(a))},r.prototype.Bct=function(t,n,e,i,r){var o,a,u,s,r,n,o,i,o=this,a=b,u=d(t),s=t.compareType(),r=r[n];return 8!==u&&10!==u||(n=[],(i=(o=o.Mf.JS(i)).col)<=e&&e<i+o.colCount&&n.push(R(o.row,e,o.rowCount,1)),t.ranges(n)),2===u||7===u?a=r.T:3===u?0===s?a=r.BC:1===s&&(a=r.FC):a=r.V,a},r.prototype.Lct=function(t,n){var e,i,r,i,e,o,e=this,i=e.Mct;return!!tt(i)&&(i=e._ct[t],e=tt(i),!!($(i)||e<0)||(o=w(i,n))<0)},r.prototype.Kst=function(t,n){var e,i,r,n,e,t,e=this,i=e.Mct;return!!tt(i)&&(r=-1,n=w(i,n),e=e._ct[t],t=tt(e),-1<(r=0<n?i[n-1]:r)?!!t&&r===e[t-1]:!t)},r.prototype.Fst=function(t,n){var e,i,r,e,t,e=this,i=e.Mct;return!tt(i)||(r=w(i,n),e=e._ct[t],(t=tt(e)||0)>=tt(i))||!(r<0||t<tt(i)-1)&&(!e||w(e,n)<0)},r.prototype.JO=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,i=this,r=i.range;if(r&&(o=S(i.Mf)-n-1,a=r.row,u=r.col,s=r.rowCount,c=r.colCount,-1<a&&(o=a+s-1,t<a||e&&t===a&&0===t?i.Fct(R(a+n,u,s,c)):t<a+s&&i.Fct(R(a,u,s+n,c))),f=i._ct,i.isFiltered())&&f){for(l=[],h=void 0,Object.keys(f).forEach(function(t){l.push(+t)}),l.sort(function(t,n){return n-t}),d={},v=[],h=0;h<tt(l);h++)t<=(m=l[h])&&m<=o?d[m+n]=f[m]:m<t&&(d[m]=f[m]);for(-1!==u&&-1!==c||(u=0,c=i.Mf.getColumnCount()),g=0;g<c;g++)v.push(g+u);for(p=0;p<n;p++)d[p+t]=x([],v,!0);i._ct=d}},r.prototype.qO=function(t,n,e){var i,r,o,a,u,r,s,c,f,l,h,d,v,v,m,g,o,p,b,i=this,r=i.range;if(r=i.nM&&(e||t>r.col&&t<=r.col+r.colCount)?i.nM.dataRange():r){if(o=r.row,a=r.col,u=r.rowCount,r=r.colCount,c=-1,(f=s=0)<=t&&i.Pct()){for(l=0;l<n;l++)l+t<=i.Gct()&&s++;i.Gct(i.Gct()+s)}for(-1<a&&(t<=a&&!e?i.Fct(R(o,(c=a)+n,u,f=r)):t<a+r&&(f=r-((c=t)-a),i.Fct(R(o,a,u,r+(h=e?0:n))))),c<0&&(c=0,f=C(i.Mf)-n),l=c+f-1;c<=l;l--)t<=l&&(d=l+n,0<=(v=w(i.Mct,l))&&(i.Mct[v]=d),v=i.rrt[l],tt(v))&&(M(i.rrt,l),i.rrt[d]=v);if((g=(m=i.srt)&&Object.keys(m))&&0<g.length){for((o=i.Mf.Ut).cct(i,3),p=g.length-1;0<=p;p--)t<=(b=+g[p])+a&&(m[b+n]=m[b],m[b]=!0);o.cct(i,3,q,!0)}i.reFilter()}},r.prototype.xP=function(t,n){var e,i,r,o,a,u,s,c,f,i,l,h,d,v,e=this,i=e.range,r=e.Mf,o=r&&r.parent;if(i&&(a=0,u=S(r)+n-1,s=i.row,c=i.col,f=i.rowCount,i=i.colCount,-1<s&&(u=(a=s)+f-1,t<=s?r.cp?(e.Fct(R(t,c,f,i)),delete r.cp):s===t+1||s+f<=t+n?o&&!o.options.allowAutoExtendFilterRange&&0!==f&&e.Fct(b):s<t+n?e.Fct(R(t,c,s+f-(t+n),i)):e.Fct(R(s-n,c,f,i)):t<s+f&&e.Fct(R(s,c,f-Math.min(s+f-t,n),i))),l=e._ct,e.isFiltered())&&l)for(h=a;h<=u;h++)t<=h&&h<t+n?l[h]=q:t+n<=h&&(v=l[d=h])&&(l[d-n]=v,l[d]=q)},r.prototype.Fct=function(t){this.Mf.Ut.cct(this,14),this.range=t,this.ict=!0,this.Mf.Ut.cct(this,14,q,!0)},r.prototype.Uct=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,f,n=this,e=n.Mf,i=n.range;if(i)if(t){if(!t.equals(i)){if(a=i.col,u=i.colCount,s=t.col,c=t.colCount,f=C(e),n.isFiltered()&&!(a<0&&s<0))for(a<0&&(a=0,u=f),s<0&&(s=0,c=f),r=0;r<u;r++)((o=a+r)<s||s+c<=o)&&n.removeFilterItems(o);if(l=i.row,h=i.rowCount,d=t.row,v=t.rowCount,f=S(e),n.isFiltered()&&n._ct&&!(l<0&&d<0))for(l<0&&(l=0,h=f),d<0&&(d=0,v=f),r=0;r<h;r++)((o=l+r)<d||d+v<=o)&&(n._ct[o]=q)}}else n.reset();!n.Pct()||t&&t.contains(-1,n.Gct())||(n.nrt=b),n.Fct(t)},r.prototype.NP=function(t,n){var e,i,r,o,r,a,u,s,c,f,l,h,d,v,i,m,g,p,e=this,i=e.range,r=e.Gct(),o=t+n;if(i){for(0<=t&&e.Pct()&&(t<=r&&r<o?e.Gct(-1):o<=r&&e.Gct(r-n)),r=i.row,a=i.col,u=i.rowCount,s=a<0?(a=0,C(e.Mf)+n):i.colCount,c=a;c<a+s;c++)t<=c&&(c<o?e.removeFilterItems(c):(f=c-n,l=w(e.Mct,c),h=e.rrt[c],0<=l&&(e.Mct[l]=f),tt(h)&&(M(e.rrt,c),e.rrt[f]=h)));if(0<=a&&(t<a?o<=a?e.Fct(R(r,a-n,u,s)):o<=a+s?e.Fct(R(r,t,u,a+s-o)):e.Fct(b):t<a+s&&(o<=a+s?e.Fct(R(r,a,u,s-n)):e.Fct(R(r,a,u,t-a)))),(v=(d=e.srt)&&Object.keys(d))&&0<v.length){for((i=e.Mf.Ut).cct(e,3),m=0;m<v.length;m++)t+n<=(p=(g=+v[m])+a)&&(d[g-n]=d[g],d[g]=!0);i.cct(e,3,q,!0)}e.reFilter()}},r.prototype.Pct=function(){var t=this,n=t.nrt;return!!n&&-1<n.index&&0!==t.getSortState(n.index)},r.prototype.Gct=function(t){var n=this,e=n.nrt,t,t=tt(arguments)?(e?e.index=t:n.nrt={index:t,ascending:!1},n):e?e.index:-1;return t},r.prototype.d5=function(t,n,e,i){var r,o,t,n,e,r=this,o=r.range;o&&(t=R(t,n,e,i),r.filterButtonVisible()?(n=o.row-1,e=o.rowCount+1,n<0&&(e=n=-1),t.containsRange(R(n,o.col,e,o.colCount))&&r.unfilter()):t.containsRange(o)&&r.unfilter())},r.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d;if(t){for(i=t.range,r=t.filterItemMap,o=(e=this).rrt,a=t.sortInfo,u=t.showFilterButton,s=t.filterButtonVisibleInfo,h=e.Mf,i&&(e.range=R(i.row,i.col,i.rowCount,i.colCount)),t.dialogVisibleInfo&&(e.uct=et.extend({},F,t.dialogVisibleInfo)),Ut(o,r,n),l=t.filteredColumns||t.filteredColMap,c=0;c<tt(l);c++)$(l[c])||e.Mct.push(l[c]);if(a&&a.color===q?e.nrt={index:a.index,ascending:a.ascending}:a&&a.color!==q&&(e.nrt={index:a.index,ascending:a.ascending,color:a.color,isBackColor:a.isBackColor}),u!==q)if(d=e.range,s)e.srt=s;else if(d)for(c=e.pct(d);c<e.bct(d,h);c++)e.srt[c]=u}},r.prototype.yh=function(t,n,e,i){var r,o,a,i,u,s,c,f,a,r,l,h,d,v,m,g,p,b,b,w,t,y,M,c,t,r,C,C,c,r,C,c,S,T,A,I,x,N,k,_;if(t&&(r=t.ref&&t.ref.toUpperCase(),a=(o=t.lossless)&&o.range,i=(null==i?void 0:i.fileType)===K.OpenSaveFileType.excel,r&&"#REF!"!==r||a)){if(s=(u=this).Mf,a?c=a:(c=K.range_parser.Dc(r)[0],(f=o&&o.isSJSFilter)||(0<=c.row&&(c.row=c.row+1),0<=c.rowCount&&(c.rowCount=c.rowCount-1))),a=D(t,"filterColumn"),r=j(t,"sortState")||n,c&&(u.range=R(c.row,c.col,c.rowCount,c.colCount)),o&&o.dialogVisibleInfo&&(u.uct=et.extend({},F,o.dialogVisibleInfo)),l=u.range,h=u.rrt,d=l&&l.col,a)for(m=0,g=a;m<g.length;m++)b=(p=g[m]).colId,$(b)||$(d)||(gt(p,w=(w=h[b=parseInt(b,10)+d])||[],e),pt(p,w,u.Qst),wt(p,w,s.getValue(l.row,b)),yt(p,w,l),Mt(p,w),0<w.length&&(u.rrt[b]=w,u.Mct.push(b)),!v&&0<w.length&&(v=!0));if((t=o&&o.filterItemMap)&&Ut(h,t),(y=o&&o.filterColumns)&&0<y.length)for(M=0;M<y.length;M++)-1===u.Mct.indexOf(y[M])&&u.Mct.push(y[M]);if(r&&(t=(c=j(r,"sortCondition")).sortBy,r=!c.descending,C=K.range_parser.Dc(c.ref)[0].col,u.nrt={index:C,ascending:r},t!==K.SortBy.fontColor&&t!==K.SortBy.cellColor||(C=E(j(c,"dxfId"),0),r=void 0,(c=e.getDxf(C))&&(r=c.backColor),u.nrt.color=r||"",u.nrt.isBackColor=t===K.SortBy.cellColor)),C=u.Uoe(),(C=i&&!u.vct()?u.Ale():C)&&(S=(c=s.Ut.Q_(!0,3)).getHiddenRows(),T=c.infos,v)&&S&&0<S.length&&a&&0<a.length&&s.filterRowsVisibleInfo){for(A=s.filterRowsVisibleInfo.rowsVisibleInfo||{},I=!0,x=C.row+C.rowCount,-1===C.row&&(x=s.getRowCount()),N=C.row;N<x;N++)0<=S.indexOf(N)&&(I=A[N]=!1,T[N])&&!1===T[N].visible&&(T[N].visible=!0);!1===I&&(s.filterRowsVisibleInfo.rowsVisibleInfo=A,s.filterRowsVisibleInfo.empty=!1)}for(k=!0,(o&&(!1===o.showTableHeader||!1===o.showFilterButton)||!l&&!n||a&&0<a.length&&!0===O(a[0].hiddenButton,!1))&&(k=!1),!l&&o&&(u.range=l=o.filterRange),_=o&&o.filterButtonVisibleInfo,N=u.pct(l);N<u.bct(l,s);N++)u.srt[N]=_?_[N]:k}},r.prototype.xCe=function(){var t=this.NCe();t&&(this.Mct=t.map(function(t){return t.col}),this._ct=st(t))},r.prototype.getToJsonRowFilter=function(){var t,n,e,i,r,o,a,u,s,c,f,l,t=[],n=this.Mf,e=this.range,i=n.parent&&n.parent.options.saveChangesForSheet,o=r=0;if((e=i&&this.extendedRange?this.extendedRange:e)&&(r=e.row,o=Math.min(n.getRowCount()-1,e.row+e.rowCount-1)),n&&(a=n.filterRowsVisibleInfo&&n.filterRowsVisibleInfo.rowsVisibleInfo,!$(a)))for(s=void 0,c=0,f=u=Object.keys(a);c<f.length;c++)r<=(s=+(l=f[c]))&&s<=o&&!1===a[s]&&t.push(s);return t},r.prototype.toJSON=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n={},e=t.range,i=t.srt,r=t.rrt,o=t.Mct,a=t.nrt,u=[],c=0,f=t.typeName,l=t.f8;if(l&&(n.adjustRangeForFrozen=l),e&&(n.range=e),f&&(n.typeName=f),t.uct){for(d in h={},t.uct)t.uct.hasOwnProperty(d)&&!1===t.uct[d]&&(h[d]=!1);n.dialogVisibleInfo=h}if(u=Ht(r),tt(u)&&(n.filterItemMap=u),tt(o)&&(n.filteredColumns=o),a&&(n.sortInfo=a),i)if(et.isEmptyObject(i))n.showFilterButton=!0;else{for(s in n.filterButtonVisibleInfo=et.extend({},i),v=!1,i)if(i[s]){v=!0;break}n.showFilterButton=v}return n.filteredOutRows=t.getToJsonRowFilter(),n},r.prototype.wh=function(F,t,n){var e,i,r,o,a,u,s,c,f,l,h,L,d,v,m,g,p,b,w,p,y,M,C,S,T,B,P,A,I,x,N,G,k,U,_,H,V,C,z,D,C,j,Y,O,Z,l,C,n,l,W,E,Q,R,e=F.c_,i=this,r=i.Mf,o=i.range,a=i.rrt,u=i.Mct,s=[],c=o&&o.col,f=i.nM,l=1,h=!1;if(f&&(!1===(L=f.jO)&&(l=0),h=!0),d=n&&K.OpenSaveFileType.excel===n.fileType,a&&0<a.length&&u&&0<u.length)for(m=0;m<tt(a);m++)if(g=a[m]){if(d&&(!o||m<c||m>=c+o.colCount||u.indexOf(m)<0))return;if(b=void 0,(p=g[0])instanceof X.Condition)for(b=p,w=1;w<g.length;w++)b=(0,X.aJ)(0,0,q,q,q,q,q,b,g[w]);b&&(en(b)?(p={n_:"filterColumn",colId:(f?m-f.iw:m-c)+""},o&&(y=new K.Range(o.row+(d?1:0),c,(o.rowCount<0?r.getRowCount():o.rowCount)-(d?1:0),o.colCount<0?r.getColumnCount():o.colCount),M=void 0,1===tt(g)&&(M=Lt(r,b,y,t),!$(M))||(M=Bt(b,r,y)),$(M)||(p.c_=[M])),s.push(p)):d||(v=$(v)?[]:v).push({index:m,conditions:[b instanceof X.Condition?b.toJSON():J(J({},b),{isCondition:!1})]}))}if(C=r.getSpans(),S=[],o&&C&&0<C.length){for(T=o.row-1,B=0<s.length,P=o.colCount,A=0,I=C;A<I.length;A++)if(N=(x=I[A]).row,G=x.rowCount,k=x.col,U=x.colCount,c<=k&&k+U<=P&&(T===N||T==N+G-1))for(_=k;_<k+U-1;_++)H=_-c,!B&&!0!==h||((V=s[_])&&+V.colId==H?s[_].showButton=0:S.push({n_:"filterColumn",colId:H,showButton:0}));s=s.concat(S)}if((C=i.nrt)&&o&&(h?z=Pt(C,o,t):s.push(Pt(C,o,t))),C=!0,D=i.srt){if(j=!1,et.isEmptyObject(D))j=!0;else for(m in D)if(D[m]){j=!0;break}if(0!==l){if(f&&(!j||!Gt(D)))if(0===s.length){if(d&&o)for(m=0;m<o.colCount;m++)s.push({n_:"filterColumn",colId:m+"",hiddenButton:"1"})}else for(Y=void 0,O=0,Z=s;O<Z.length;O++)D[(Y=Z[O]).colId]||(Y.hiddenButton=1)}else C=!1}if(o&&C){if(l=i.f8?r.frozenRowCount():0,C=!(n&&n.fileType===K.OpenSaveFileType.excel),n={n_:"autoFilter",ref:K.range_parser.jc(C?o:qt(r,o,l))},C&&(n.lossless||(n.lossless={}),n.lossless.isSJSFilter=C,n.lossless.filterButtonVisibleInfo=D,(W=(l=i.typeName)&&l!==nt)?(n.lossless.typeName=l,n.lossless.filterItemMap=Ht(a)):$(v)||(n.lossless.filterItemMap=v,n.lossless.filterColumns=i.Mct),E=i.uct)){for(R in Q={},E)E.hasOwnProperty(R)&&!1===E[R]&&(Q[R]=!1);n.lossless.dialogVisibleInfo=Q}0<s.length&&(n.c_=s),(e=e||(F.c_=[])).push(n),z&&e.push(z)}},r.prototype.Hct=function(t){var n=t.options;return!t.isActualProtected()||n.protectionOptions.allowFilter},r.prototype.hitTest=function(t,n,e){var i,r,o,t,a,u,s,c,t,a,u,s,f,l,u,f,l,s,i=this.Mf;if(i){if(r=t.rowViewportIndex,o=t.colViewportIndex,t=t.hitTestType,a=i.yw(o),1===t?(u=i.jF().findY(e),s=a.findX(n),c=1):3===t&&(u=i.dw(r).findY(e),s=a.findX(n),c=3),!u||!s)return b;if(u=dt(i,t=u.row,a=s.col,c),s=i.AO(),u){if(f=u.row,l=u.col,!u.contains(t,a,1,1))return b;t=f,a=l}return s&&(u=ft(s,t,a,c))&&(f=i.getCellRect(t,a,r,o,!0),l=i.Lt(a),(s=i.an(f,c,{columnHeaderFitMode:l,cellWidth:i.getColumnWidth(a)})).x<=n)&&n<=s.x+s.width&&s.y<=e&&e<=s.y+s.height?new g.rut(u.rowFilter,u.row,u.col,u.sheetArea,s.x,s.y,s.width,s.height):b}},r.prototype.Uoe=function(){return this.extendedRange||this.range},t.RowFilterBase=n=r,f(o,ut=n),o.prototype.onFilter=function(t){var n,e,n,n=this,e=n.Mf;e&&((n=n.zct(e,t.filteredRows,t.filteredOutRows))&&0<n.length&&nn(e,n[0]),e.iP())},o.prototype.filterDialogVisibleInfo=function(t){var n;return 0===arguments.length?(this.uct||(this.uct=et.extend({},F)),this.uct):t?(n={},t.sortByValue!==q&&(n.sortByValue=!!t.sortByValue),t.sortByColor!==q&&(n.sortByColor=!!t.sortByColor),t.filterByColor!==q&&(n.filterByColor=!!t.filterByColor),t.filterByValue!==q&&(n.filterByValue=!!t.filterByValue),t.listFilterArea!==q&&(n.listFilterArea=!!t.listFilterArea),et.extend(this.uct,n),this):void 0},o.prototype.zct=function(t,n,e){var i,r,i,i=t.filterRowsVisibleInfo;if(i)return(r=t.getCalcService()).suspend(),r.Vct=4,i=i.Yct(n,e),t.recalcRows&&t.recalcRows(i),delete r.Vct,r.resume(!1),r.Zct(),i},o.prototype.openFilterDialog=function(t){var n,e,t,n=this,e=n.Mf;n.Hct(e)&&(t=new g.iut(e.parent.j2(),e,t,n.filterDialogVisibleInfo(),n.dialogOptions),(e.Cut=t).rQ())},Q=o,t.HideRowFilter=Q,a.prototype.hct=function(t){var t;return!!this.empty||(t=this.rowsVisibleInfo[t],!!$(t))||t},a.prototype.Yct=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,e=[],i=this.rowsVisibleInfo,r=0,o=t.length;r<o;r++)(u=i[a=t[r]])!==q&&u!==b&&e.push(a),delete i[a];for(s=0,c=n.length;s<c;s++)(l=i[f=n[s]])!==q&&l!==b||e.push(f),i[f]=!1;return this.empty=0===n.length&&K.GC$.isEmptyObject(i),e},a.prototype.c5=function(){this.rowsVisibleInfo={},this.empty=!0},a.prototype.Wct=function(t,n){for(var e,i,r,e=this.rowsVisibleInfo,r=0;r<n;r++)i=e[r+t],$(i)||delete e[r+t]},a.prototype.rE=function(t,n){for(var e,i,r,o,a,u,s,e=this.rowsVisibleInfo,i={},r,a=0,u=Object.keys(e);a<u.length;a++)t<=(o=+(s=u[a]))?i[o+n]=e[o]:i[o]=e[o];this.rowsVisibleInfo=i},a.prototype.aE=function(t,n){for(var e,i,r,o,a,u,s,c,e=this.rowsVisibleInfo,i={},r,o=t+n,u=0,s=Object.keys(e);u<s.length;u++)t<=(a=+(c=s[u]))&&a<o?delete e[a]:o<=a?i[a-n]=e[a]:i[a]=e[a];this.rowsVisibleInfo=i},a.prototype.dct=function(){return!this.empty},a.prototype.clone=function(){var t=new a;return t.rowsVisibleInfo=et.extend({},this.rowsVisibleInfo),t.empty=this.empty,t},it=a,K.Worksheet.ch("filter",rt={init:function(){var n=this;n.IB=b,n.filterRowsVisibleInfo=new it,n.$L.push({tF:function(t){return n.filterRowsVisibleInfo.hct(t)}}),Jt(n)},getUsedRange:function(t){var n,e,e;t.type&K.UsedRangeType.filter&&(e=(e=(n=this).IB)&&e.getUsedRange(),U(t.range,e))},processMouseDown:function(t){var n=t.hitInfo.filterButtonHitInfo;n&&(n.rowFilter.openFilterDialog(n),t.r=!0)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,n,n=this,e=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,u=n.IB;"invalidateLayout"===e?n.lct=b:(s=$(t.sheetArea)||t.sheetArea===K.SheetArea.viewport,u&&(n=n.Ut,"addRows"===e&&s?n.Qct(i,r,t.rowExpand):"deleteRows"===e&&s?n.Kct(i,r):"addColumns"===e&&s?n.Jct(o,a):"deleteColumns"===e&&s?n.Xct(o,a):"clear"===e&&u.range&&n.qct(i,o,r,a)))},dispose:function(t){var n=this,e=n.Cut,t=t&&t.clearCache;e&&e.close(),!1!==t&&Xt(n)},toJson:function(t,n){var e,n,e=this.IB,n=n&&n.ignoreStyle;e&&!n&&(t.rowFilter=e.toJSON())},wh:function(t,n,e){var i,r,o,i=this.IB,r=e&&!1===e.includeStyles,o;e&&K.OpenSaveFileType.excel===e.fileType&&!r&&zt(t,this),!i||r||this.NMi||i.wh(t,n.styleManager,e)},yh:function(t,n,e){var i,r,i,i=e&&!1===e.includeStyles,r=e&&e.isApplyRefilter;i||(i=j(t,"autoFilter"),$(i))||Qt(i,this,n.styleManager,r,e)},fromJson:function(t,n,e){var i,t,e,i=t.rowFilter,t=t.isApplyRefilter,e=e&&e.ignoreStyle;i&&!e&&Wt(i,this,n,t)},paintCell:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,s,o,u,t,m,e,i,n=this,e=t.cell,i=e.width,r=e.height,o=e.cellLayout,a=n.BO(),u=n.AO(),s=[],c=t.ctx;if(e&&e.cornerX&&0!==e.columnHeaderFitMode&&(f=e.columnHeaderFitMode,h=(l=e.cornerX)-e.x),(!o||!y(s,o))&&u&&0<i&&0<r&&(m=ft(u,d=e.baseRow||e.row,v=e.baseCol||e.col,t.sheetArea))){s=new g.rut(m.rowFilter,m.row,m.col,m.sheetArea,e.x,e.y,i,r),u=(o=n.an(new K.Rect(s.x,s.y,s.width,s.height),s.sheetArea,{cellWidth:h,columnHeaderFitMode:f})).width,t=o.height,m=o.x,e=o.y,i=(0,N.getFilterButtonImageSrc)(s.jt()),c.save(),c.rect(s.x,s.y,s.width,s.height),c.clip(),c.beginPath(),c.lineWidth=1,c.fillStyle="#FFFFFF",c.strokeStyle="#CCCCCC",c.fillRect(m+1,e+1,u-3,t-3),c.strokeRect(m+1-.5,e+2-.5,u-3,t-4);try{a.getState(i)?c.drawImage(a.getImage(i),m,e+1,u-3,t-3):a.addImage(i)}catch(t){}c.beginPath(),c.restore()}}}),K.Workbook.ch("filter",ot={init:function(){K.Commands.crt(this.commandManager())},onCultureChanged:function(){G()}}),et.extend(K.Y8.prototype,{cct:function(t,n,e,i){var r,o,a,u,s,r=this,o=r.G8;if(o){switch(o.originalFilter||(o.originalFilter=[]),a={type:n,newState:i,rowFilter:t},n){case 0:u=void 0,u=t?{range:t.range,typeName:t.typeName,filteredColumns:t.Mct.concat([]),filteredItems:t.Ect.concat([]),filterItemMap:t.rrt.concat([]),filteredInRowsWithColIndexs:et.extend({},t._ct),filterButtonVisibleInfo:et.extend({},t.srt),sortInfo:et.extend({},t.nrt)}:b,s=r.Mf.filterRowsVisibleInfo.clone(),a.changeInfo={rowFilter:u,filterRowsVisibleInfo:s};break;case 2:case 7:a.changeInfo={filteredColumns:t.Mct.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 1:a.changeInfo=t.nrt;break;case 3:a.changeInfo=et.extend({},t.srt);break;case 4:a.changeInfo={col:e,val:t.srt[e]};break;case 5:case 6:a.changeInfo={filterItemMap:t.rrt.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone(),filteredColumns:t.Mct.concat([])};break;case 8:a.changeInfo={range:t.range,filteredColumns:t.Mct.concat([]),filteredItems:t.Ect.concat([]),filteredInRowsWithColIndexs:et.extend({},t._ct),filterButtonVisibleInfo:et.extend({},t.srt),sortInfo:et.extend({},t.nrt),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 9:case 10:a.changeInfo={range:t.range,filteredInRowsWithColIndexs:et.extend({},t._ct),filteredColumns:t.Mct.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 11:case 12:a.changeInfo={range:t.range,sortInfo:et.extend({},t.nrt),filterItemMap:t.rrt.concat([]),filteredColumns:t.Mct.concat([]),filterRowsVisibleInfo:r.Mf.filterRowsVisibleInfo.clone()};break;case 13:a.changeInfo={filteredInRowsWithColIndexs:et.extend({},t._ct),filteredItems:t.Ect.concat([]),filteredColumns:t.Mct.concat([])};break;case 14:a.changeInfo={range:t.range}}o.originalFilter.push(a)}},$ct:function(t){var n,e,i,r,o,o,a,n,e=this.Mf,i=t.rowFilter,r=t.changeInfo;if(i||0===t.type){if(i&&"Object"===i.constructor.name){if(!i.range)return;i.tableName?(o=e.tables.findByName(i.tableName))&&(i=o.rowFilter()):r&&r.rowFilter?Wt(t.rowFilter,e,!1):i=e.rowFilter()}switch(r&&r.filterRowsVisibleInfo&&"Object"===r.filterRowsVisibleInfo.constructor.name&&((o=new it).rowsVisibleInfo=u.Common.lt.Dh({},r.filterRowsVisibleInfo.rowsVisibleInfo),o.empty=r.filterRowsVisibleInfo.empty,r.filterRowsVisibleInfo=o),t.type){case 0:r.rowFilter?e.IB=et.extend(i,r.rowFilter):e.IB=r.rowFilter,s(e,r.filterRowsVisibleInfo);break;case 1:i.nrt=r;break;case 3:i.srt=r;break;case 4:i.srt[r.col]=r.val;break;case 5:case 6:i.rrt=r.filterItemMap,i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 2:case 7:i.Mct=r.filteredColumns,a=tn(e,r.filterRowsVisibleInfo),s(e,r.filterRowsVisibleInfo),-1<a&&nn(e,a);break;case 8:et.extend(i,r),s(e,r.filterRowsVisibleInfo);break;case 9:case 10:i.range=r.range,i._ct=r.filteredInRowsWithColIndexs,i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 11:case 12:i.range=r.range,i.nrt=r.sortInfo,i.rrt=r.filterItemMap,i.Mct=r.filteredColumns,s(e,r.filterRowsVisibleInfo);break;case 13:i._ct=r.filteredInRowsWithColIndexs,i.Ect=r.filteredItems,i.Mct=r.filteredColumns;break;case 14:i.range=r.range,i.reFilter()}}},tft:function(t,n){var e,i,r,e=tt(t);if(n)for(i=0;i<e;i++)(r=t[i]).newState&&this.$ct(r);else for(i=e-1;0<=i;i--)(r=t[i]).newState||this.$ct(r)},Qct:function(t,n,e){var i=this.Mf.IB;i&&(this.cct(i,9),i.JO(t,n,e),this.cct(i,9,q,!0))},Kct:function(t,n){var e=this.Mf.IB;e&&(this.cct(e,10),e.xP(t,n),this.cct(e,10,q,!0))},Jct:function(t,n){var e=this.Mf.IB;e&&(this.cct(e,11),e.qO(t,n),this.cct(e,11,q,!0))},Xct:function(t,n){var e=this.Mf.IB;e&&(this.cct(e,12),e.NP(t,n),this.cct(e,12,q,!0))},qct:function(t,n,e,i){var r=this.Mf.IB;r&&r.d5(t,n,e,i)}}),K.Y8.ch("filter",{applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.originalFilter;n&&tt(n)&&this.tft(n,!t)},undo:function(t){var t=t.originalFilter;tt(t)&&this.tft(t)}})},"./dist/plugins/filter/filter.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ThisWeek=n.NextWeek=n.Yesterday=n.Today=n.Tomorrow=n.After=n.Before=n.NotContain=n.Contain=n.End=n.Begin=n.BelowAverage=n.AboveAverage=n.Top10=n.Between=n.LessThanOrEquals=n.LessThan=n.GreaterOrEquals=n.GreaterThan=n.NotEqual=n.Equal=n.Custom=n.NumberFilter=n.DateFilter=n.TextFilter=n.Clear=n.Automatic=n.NoFill=n.CellColor=n.FontColor=n.SortFontTitle=n.SortCellTitle=n.FilterFontTitle=n.FilterCellTitle=n.FilterColor=n.SortColor=n.Or=n.And=n.ShowRows=n.Show=n.Exp_FilterItemIsNull=n.Blanks=n.UncheckAll=n.CheckAll=n.Search=n.Cancel=n.OK=n.SortDescending=n.SortAscending=n.Exp_InvalidColumnIndex=void 0,n.Aug=n.Jul=n.Jun=n.May=n.Apr=n.Mar=n.Feb=n.Jan=n.Q4=n.Q3=n.Q2=n.Q1=n.BeforeOrEqual=n.IsBefore=n.AfterOrEqual=n.IsAfter=n.NotContains=n.IsContain=n.NotEndWith=n.IsEndWith=n.NotBeginWith=n.IsBeginWith=n.LessOrEqual=n.IsLess=n.IsGreaterOrEqual=n.IsGreaterThan=n.NotEquals=n.IsEquals=n.Selected=n.FilterFont=n.FilterCell=n.SortFont=n.SortCell=n.bottom=n.top=n.ColorTitle=n.CustomTitle=n.Top10Filter=n.AllDates=n.YearToDate=n.LastYear=n.ThisYear=n.NextYear=n.LastQuarter=n.ThisQuarter=n.NextQuarter=n.LastMonth=n.ThisMonth=n.NextMonth=n.LastWeek=void 0,n.invalidCondition=n.add_current_filter=n.Day=n.Year=n.Explain2=n.Explain1=n.Dec=n.Nov=n.Oct=n.Sep=void 0,n.Exp_InvalidColumnIndex="Invalid column index.",n.SortAscending="Sort Ascending",n.SortDescending="Sort Descending",n.OK="OK",n.Cancel="Cancel",n.Search="Search",n.CheckAll="Check all",n.UncheckAll="Uncheck all",n.Blanks="(Blanks)",n.Exp_FilterItemIsNull="FilterItem is null.",n.Show="Show",n.ShowRows="Show rows where:",n.And="And",n.Or="Or",n.SortColor="Sort By Color",n.FilterColor="Filter By Color",n.FilterCellTitle="Filter By Cell Color",n.FilterFontTitle="Filter By Font Color",n.SortCellTitle="Sort By Cell Color",n.SortFontTitle="Sort By Font Color",n.FontColor="More Font Colors...",n.CellColor="More Cell Colors...",n.NoFill="No Fill",n.Automatic="Automatic",n.Clear="Clear Filter From {0}",n.TextFilter="Text Filters",n.DateFilter="Date Filters",n.NumberFilter="Number Filters",n.Custom="Custom Filter...",n.Equal="Equals...",n.NotEqual="Does Not Equal...",n.GreaterThan="Greater Than...",n.GreaterOrEquals="Greater Than Or Equal To...",n.LessThan="Less Than...",n.LessThanOrEquals="Less Than Or Equal To...",n.Between="Between...",n.Top10="Top 10...",n.AboveAverage="Above Average",n.BelowAverage="Below Average",n.Begin="Begins With...",n.End="Ends With...",n.Contain="Contains...",n.NotContain="Does Not Contain...",n.Before="Before...",n.After="After...",n.Tomorrow="Tomorrow",n.Today="Today",n.Yesterday="Yesterday",n.NextWeek="Next Week",n.ThisWeek="This Week",n.LastWeek="Last Week",n.NextMonth="Next Month",n.ThisMonth="This Month",n.LastMonth="Last Month",n.NextQuarter="Next Quarter",n.ThisQuarter="This Quarter",n.LastQuarter="Last Quarter",n.NextYear="Next Year",n.ThisYear="This Year",n.LastYear="Last Year",n.YearToDate="Year To Date",n.AllDates="All Dates in Period",n.Top10Filter="Top 10 Auto Filter",n.CustomTitle="Custom AutoFilter",n.ColorTitle="Available Cell Colors",n.top="top",n.bottom="bottom",n.SortCell="Select a cell color to sort by:",n.SortFont="Select a font color to sort by:",n.FilterCell="Select a cell color to filter by:",n.FilterFont="Select a font color to filter by:",n.Selected="Selected:",n.IsEquals="equals",n.NotEquals="does not equal",n.IsGreaterThan="is greater than",n.IsGreaterOrEqual="is greater than or equal to",n.IsLess="is less than",n.LessOrEqual="is less than or equal to",n.IsBeginWith="begins with",n.NotBeginWith="does not begin with",n.IsEndWith="ends with",n.NotEndWith="does not end with",n.IsContain="contains",n.NotContains="does not contain",n.IsAfter="is after",n.AfterOrEqual="is after or equal to",n.IsBefore="is before",n.BeforeOrEqual="is before or equal to",n.Q1="Quarter 1",n.Q2="Quarter 2",n.Q3="Quarter 3",n.Q4="Quarter 4",n.Jan="January",n.Feb="February",n.Mar="March",n.Apr="April",n.May="May",n.Jun="June",n.Jul="July",n.Aug="August",n.Sep="September",n.Oct="October",n.Nov="November",n.Dec="December",n.Explain1="Use ? to represent any single character",n.Explain2="Use * to represent any series of characters",n.Year="",n.Day="",n.add_current_filter="Add current selection to filter",n.invalidCondition="Error in parse line"},"./dist/plugins/floatingObject/drawing/chart.ns.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),n),r(e("./dist/plugins/floatingObject/drawing/stateful.js"),n),r(e("./dist/plugins/floatingObject/drawing/common.js"),n),r(e("./dist/plugins/floatingObject/drawing/color.js"),n),r(e("./dist/plugins/floatingObject/drawing/colorData.js"),n),r(e("./dist/plugins/floatingObject/drawing/colorFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/effects.js"),n),r(e("./dist/plugins/floatingObject/drawing/fillFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/fontData.js"),n),r(e("./dist/plugins/floatingObject/drawing/fontFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/gradient.js"),n),r(e("./dist/plugins/floatingObject/drawing/lineFormat.js"),n),r(e("./dist/plugins/floatingObject/drawing/picture.js"),n),r(e("./dist/plugins/floatingObject/drawing/threeDFormat.js"),n)},"./dist/plugins/floatingObject/drawing/color.js":function(t,n,e){"use strict";var i,e,r,o,a,u,s,c,f,l,h,d,v,m,g,p,i;function b(t,n,e,i){var r=this;r.value=t,r.state=n,r.name=e,r.knownColor=i}function w(){}function y(){}function M(t){this._tV=0,this.EtV=0,this.FtV=0,this.StV=255,this.setColor(t||{r:0,g:0,b:0,a:255})}Object.defineProperty(n,"__esModule",{value:!0}),n.DrawingColorHelper=n.ColorParse=n.KnownColorTable=n.KnownColor=n.ARGBColor=void 0,i=e("Common"),e=e("./dist/plugins/floatingObject/drawing/common.js"),r=i.Common.ft,o=e.UnitHelper.isNullOrUndefined,a=void 0,u=null,s=Math.min,c=Math.max,f=Math.round,l=Math.pow,b.FromKnownColor=function(t){return new b(0,b.StateKnownColorValid,u,t)},b.FromIndexedColor=function(t,n){var e,e=(e=b.IndexedColors)||(b.IndexedColors=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,b.FromKnownColor(d.WindowText).ToArgb(),b.FromKnownColor(d.Window).ToArgb()]);return b.FromArgb(e[t]).GetTintColor(n)},b.FromArgb=function(t){return new b(t,b.StateARGBValueValid,u,0)},b.FromArgbs=function(t,n,e,i){return b.CheckByte(t,"alpha"),b.CheckByte(n,"red"),b.CheckByte(e,"green"),b.CheckByte(i,"blue"),new b(b.MakeArgb(t,n,e,i),b.StateARGBValueValid,u,0)},b.FromBaseColor=function(t,n){return b.CheckByte(t,"alpha"),new b(b.MakeArgb(t,n.R,n.G,n.B),b.StateARGBValueValid,u,0)},b.FromRgb=function(t,n,e){return b.FromArgbs(255,t,n,e)},b.CheckByte=function(t,n){if(t<0||255<t)throw new Error("InvalidEx2BoundArgument")},b.MakeArgb=function(t,n,e,i){var r;return Math.pow(2,24)*t+(n<<16|e<<8|i)},Object.defineProperty(b.prototype,"Transparent",{get:function(){return b.FromKnownColor(d.Transparent)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"R",{get:function(){return this.Value>>16&255},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"G",{get:function(){return this.Value>>8&255},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"B",{get:function(){return 255&this.Value},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"A",{get:function(){return this.Value>>24&255},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"IsKnownColor",{get:function(){return 0!=(this.state&b.StateKnownColorValid)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"IsEmpty",{get:function(){return 0===this.state},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"IsNamedColor",{get:function(){return 0!=(this.state&b.StateNameValid)||this.IsKnownColor},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"IsSystemColor",{get:function(){return!!this.IsKnownColor&&(!(26<this.knownColor)||167<this.knownColor)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"Name",{get:function(){var t,n,t=this;return 0!=(t.state&b.StateNameValid)?t.name:t.IsKnownColor?(n=m.KnownColorToName(t.knownColor),o(n)?"":n):t.value.toString(16)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"Value",{get:function(){var t=this;return 0!=(t.state&b.StateValueMask)?t.value:t.IsKnownColor?m.KnownColorToArgb(t.knownColor):b.NotDefinedValue},enumerable:!1,configurable:!0}),b.prototype.Equals=function(t){return t instanceof b&&this.Value===t.Value},b.prototype.GetTintColor=function(t){var n,n,n=this;return 0===t||o(t)?n:(n=r.Cv({r:n.R,g:n.G,b:n.B},t),b.FromArgbs(n.a,n.r,n.g,n.b))},b.prototype.GetBrightness=function(){var t,n,e,i,r,t=this.R/255,n=this.G/255,e=this.B/255,i=t,r=t;return((i=(i=t<n?n:t)<e?e:i)+(r=e<(r=n<t?n:t)?e:r))/2},b.prototype.GetHue=function(){var t,n,e,t,i,r,o,o,t=this;return t.R===t.G&&t.G===t.B?0:(i=0,o=r=n=t.R/255,o=(r=(r=r<(e=t.G/255)?e:r)<(t=t.B/255)?t:r)-(o=t<(o=e<n?e:n)?t:o),n===r?i=(e-t)/o:e===r?i=2+(t-n)/o:t===r&&(i=4+(n-e)/o),(i*=60)<0&&(i+=360),i)},b.prototype.GetSaturation=function(){var t,n,e,i,r,t,o,t=this.R/255,n=this.G/255,e=this.B/255,i=0,r=t,t=t;return(r=(r=r<n?n:r)<e?e:r)===(t=e<(t=n<t?n:t)?e:t)?0:(o=(r+t)/2)<=.5?(r-t)/(r+t):(r-t)/(2-r-t)},b.prototype.ToArgb=function(){return this.Value},b.prototype.ToKnownColor=function(){return this.knownColor},b.prototype.ToString=function(){var t,n,t=this,n="ARGBColor";return n+=" [",0!=(t.state&b.StateNameValid)||0!=(t.state&b.StateKnownColorValid)?n+=t.Name:0!=(t.state&b.StateValueMask)?n=(n=(n=(n=n+"A="+t.A)+", R="+t.R)+", G="+t.G)+", B="+t.B:n+="Empty",n+="]"},b.StateKnownColorValid=1,b.StateARGBValueValid=2,b.StateValueMask=2,b.StateNameValid=8,b.NotDefinedValue=0,h=b,n.ARGBColor=h,(i=d=n.KnownColor||(n.KnownColor={}))[i.ActiveBorder=1]="ActiveBorder",i[i.ActiveCaption=2]="ActiveCaption",i[i.ActiveCaptionText=3]="ActiveCaptionText",i[i.AliceBlue=28]="AliceBlue",i[i.AntiqueWhite=29]="AntiqueWhite",i[i.AppWorkspace=4]="AppWorkspace",i[i.Aqua=30]="Aqua",i[i.Aquamarine=31]="Aquamarine",i[i.Azure=32]="Azure",i[i.Beige=33]="Beige",i[i.Bisque=34]="Bisque",i[i.Black=35]="Black",i[i.BlanchedAlmond=36]="BlanchedAlmond",i[i.Blue=37]="Blue",i[i.BlueViolet=38]="BlueViolet",i[i.Brown=39]="Brown",i[i.BurlyWood=40]="BurlyWood",i[i.ButtonFace=168]="ButtonFace",i[i.ButtonHighlight=169]="ButtonHighlight",i[i.ButtonShadow=170]="ButtonShadow",i[i.CadetBlue=41]="CadetBlue",i[i.Chartreuse=42]="Chartreuse",i[i.Chocolate=43]="Chocolate",i[i.Control=5]="Control",i[i.ControlDark=6]="ControlDark",i[i.ControlDarkDark=7]="ControlDarkDark",i[i.ControlLight=8]="ControlLight",i[i.ControlLightLight=9]="ControlLightLight",i[i.ControlText=10]="ControlText",i[i.Coral=44]="Coral",i[i.CornflowerBlue=45]="CornflowerBlue",i[i.Cornsilk=46]="Cornsilk",i[i.Crimson=47]="Crimson",i[i.Cyan=48]="Cyan",i[i.DarkBlue=49]="DarkBlue",i[i.DarkCyan=50]="DarkCyan",i[i.DarkGoldenrod=51]="DarkGoldenrod",i[i.DarkGray=52]="DarkGray",i[i.DarkGreen=53]="DarkGreen",i[i.DarkKhaki=54]="DarkKhaki",i[i.DarkMagenta=55]="DarkMagenta",i[i.DarkOliveGreen=56]="DarkOliveGreen",i[i.DarkOrange=57]="DarkOrange",i[i.DarkOrchid=58]="DarkOrchid",i[i.DarkRed=59]="DarkRed",i[i.DarkSalmon=60]="DarkSalmon",i[i.DarkSeaGreen=61]="DarkSeaGreen",i[i.DarkSlateBlue=62]="DarkSlateBlue",i[i.DarkSlateGray=63]="DarkSlateGray",i[i.DarkTurquoise=64]="DarkTurquoise",i[i.DarkViolet=65]="DarkViolet",i[i.DeepPink=66]="DeepPink",i[i.DeepSkyBlue=67]="DeepSkyBlue",i[i.Desktop=11]="Desktop",i[i.DimGray=68]="DimGray",i[i.DodgerBlue=69]="DodgerBlue",i[i.Firebrick=70]="Firebrick",i[i.FloralWhite=71]="FloralWhite",i[i.ForestGreen=72]="ForestGreen",i[i.Fuchsia=73]="Fuchsia",i[i.Gainsboro=74]="Gainsboro",i[i.GhostWhite=75]="GhostWhite",i[i.Gold=76]="Gold",i[i.Goldenrod=77]="Goldenrod",i[i.GradientActiveCaption=171]="GradientActiveCaption",i[i.GradientInactiveCaption=172]="GradientInactiveCaption",i[i.Gray=78]="Gray",i[i.GrayText=12]="GrayText",i[i.Green=79]="Green",i[i.GreenYellow=80]="GreenYellow",i[i.Highlight=13]="Highlight",i[i.HighlightText=14]="HighlightText",i[i.Honeydew=81]="Honeydew",i[i.HotPink=82]="HotPink",i[i.HotTrack=15]="HotTrack",i[i.InactiveBorder=16]="InactiveBorder",i[i.InactiveCaption=17]="InactiveCaption",i[i.InactiveCaptionText=18]="InactiveCaptionText",i[i.IndianRed=83]="IndianRed",i[i.Indigo=84]="Indigo",i[i.Info=19]="Info",i[i.InfoText=20]="InfoText",i[i.Ivory=85]="Ivory",i[i.Khaki=86]="Khaki",i[i.Lavender=87]="Lavender",i[i.LavenderBlush=88]="LavenderBlush",i[i.LawnGreen=89]="LawnGreen",i[i.LemonChiffon=90]="LemonChiffon",i[i.LightBlue=91]="LightBlue",i[i.LightCoral=92]="LightCoral",i[i.LightCyan=93]="LightCyan",i[i.LightGoldenrodYellow=94]="LightGoldenrodYellow",i[i.LightGray=95]="LightGray",i[i.LightGreen=96]="LightGreen",i[i.LightPink=97]="LightPink",i[i.LightSalmon=98]="LightSalmon",i[i.LightSeaGreen=99]="LightSeaGreen",i[i.LightSkyBlue=100]="LightSkyBlue",i[i.LightSlateGray=101]="LightSlateGray",i[i.LightSteelBlue=102]="LightSteelBlue",i[i.LightYellow=103]="LightYellow",i[i.Lime=104]="Lime",i[i.LimeGreen=105]="LimeGreen",i[i.Linen=106]="Linen",i[i.Magenta=107]="Magenta",i[i.Maroon=108]="Maroon",i[i.MediumAquamarine=109]="MediumAquamarine",i[i.MediumBlue=110]="MediumBlue",i[i.MediumOrchid=111]="MediumOrchid",i[i.MediumPurple=112]="MediumPurple",i[i.MediumSeaGreen=113]="MediumSeaGreen",i[i.MediumSlateBlue=114]="MediumSlateBlue",i[i.MediumSpringGreen=115]="MediumSpringGreen",i[i.MediumTurquoise=116]="MediumTurquoise",i[i.MediumVioletRed=117]="MediumVioletRed",i[i.Menu=21]="Menu",i[i.MenuBar=173]="MenuBar",i[i.MenuHighlight=174]="MenuHighlight",i[i.MenuText=22]="MenuText",i[i.MidnightBlue=118]="MidnightBlue",i[i.MintCream=119]="MintCream",i[i.MistyRose=120]="MistyRose",i[i.Moccasin=121]="Moccasin",i[i.NavajoWhite=122]="NavajoWhite",i[i.Navy=123]="Navy",i[i.OldLace=124]="OldLace",i[i.Olive=125]="Olive",i[i.OliveDrab=126]="OliveDrab",i[i.Orange=127]="Orange",i[i.OrangeRed=128]="OrangeRed",i[i.Orchid=129]="Orchid",i[i.PaleGoldenrod=130]="PaleGoldenrod",i[i.PaleGreen=131]="PaleGreen",i[i.PaleTurquoise=132]="PaleTurquoise",i[i.PaleVioletRed=133]="PaleVioletRed",i[i.PapayaWhip=134]="PapayaWhip",i[i.PeachPuff=135]="PeachPuff",i[i.Peru=136]="Peru",i[i.Pink=137]="Pink",i[i.Plum=138]="Plum",i[i.PowderBlue=139]="PowderBlue",i[i.Purple=140]="Purple",i[i.Red=141]="Red",i[i.RosyBrown=142]="RosyBrown",i[i.RoyalBlue=143]="RoyalBlue",i[i.SaddleBrown=144]="SaddleBrown",i[i.Salmon=145]="Salmon",i[i.SandyBrown=146]="SandyBrown",i[i.ScrollBar=23]="ScrollBar",i[i.SeaGreen=147]="SeaGreen",i[i.SeaShell=148]="SeaShell",i[i.Sienna=149]="Sienna",i[i.Silver=150]="Silver",i[i.SkyBlue=151]="SkyBlue",i[i.SlateBlue=152]="SlateBlue",i[i.SlateGray=153]="SlateGray",i[i.Snow=154]="Snow",i[i.SpringGreen=155]="SpringGreen",i[i.SteelBlue=156]="SteelBlue",i[i.Tan=157]="Tan",i[i.Teal=158]="Teal",i[i.Thistle=159]="Thistle",i[i.Tomato=160]="Tomato",i[i.Transparent=27]="Transparent",i[i.Turquoise=161]="Turquoise",i[i.Violet=162]="Violet",i[i.Wheat=163]="Wheat",i[i.White=164]="White",i[i.WhiteSmoke=165]="WhiteSmoke",i[i.Window=24]="Window",i[i.WindowFrame=25]="WindowFrame",i[i.WindowText=26]="WindowText",i[i.Yellow=166]="Yellow",i[i.YellowGreen=167]="YellowGreen",v=function(t){t[1]=4290032820,t[2]=4288263377,t[3]=4278190080,t[4]=4289440683,t[5]=4293980400,t[6]=4288716960,t[7]=4285098345,t[8]=4293125091,t[9]=4294967295,t[10]=4278190080,t[11]=4278190080,t[12]=4285361517,t[13]=4281571839,t[14]=4294967295,t[15]=4278216396,t[16]=4294244348,t[17]=4290760155,t[18]=4278190080,t[19]=4294967265,t[20]=4278190080,t[21]=4293980400,t[22]=4278190080,t[23]=4291348680,t[24]=4294967295,t[25]=4284769380,t[26]=4278190080,t[168]=4293980400,t[169]=4294967295,t[170]=4288716960,t[171]=4290367978,t[172]=4292338930,t[173]=4293980400,t[174]=4281571839},w.ArgbToKnownColor=function(t){var n,e,i;for(this.EnsureColorTable(),n=0;n<w.colorTable.length;n++)if((e=w.colorTable[n])===t&&!(i=h.FromArgb(n)).IsSystemColor)return i;return h.FromArgb(t)},w.Encode=function(t,n,e,i){return n<<16|e<<8|i|t<<24},w.EnsureColorNameTable=function(){o(w.colorNameTable)&&w.InitColorNameTable()},w.EnsureColorTable=function(){o(w.colorTable)&&this.InitColorTable()},w.InitColorNameTable=function(){var t,n,t=[];for(n in d)d.hasOwnProperty(n)&&(t[d[n]]=n);w.colorNameTable=t},w.InitColorTable=function(){var t=[];v(t),t[27]=16777215,t[28]=-984833,t[29]=-332841,t[30]=-16711681,t[31]=-8388652,t[32]=-983041,t[33]=-657956,t[34]=-6972,t[35]=-16777216,t[36]=-5171,t[37]=-16776961,t[38]=-7722014,t[39]=-5952982,t[40]=-2180985,t[41]=-10510688,t[42]=-8388864,t[43]=-2987746,t[44]=-32944,t[45]=-10185235,t[46]=-1828,t[47]=-2354116,t[48]=-16711681,t[49]=-16777077,t[50]=-16741493,t[51]=-4684277,t[52]=-5658199,t[53]=-16751616,t[54]=-4343957,t[55]=-7667573,t[56]=-11179217,t[57]=-29696,t[58]=-6737204,t[59]=-7667712,t[60]=-1468806,t[61]=-7357301,t[62]=-12042869,t[63]=-13676721,t[64]=-16724271,t[65]=-7077677,t[66]=-60269,t[67]=-16728065,t[68]=-9868951,t[69]=-14774017,t[70]=-5103070,t[71]=-1296,t[72]=-14513374,t[73]=-65281,t[74]=-2302756,t[75]=-460545,t[76]=-10496,t[77]=-2448096,t[78]=-8355712,t[79]=-16744448,t[80]=-5374161,t[81]=-983056,t[82]=-38476,t[83]=-3318692,t[84]=-11861886,t[85]=-16,t[86]=-989556,t[87]=-1644806,t[88]=-3851,t[89]=-8586240,t[90]=-1331,t[91]=-5383962,t[92]=-1015680,t[93]=-2031617,t[94]=-329006,t[95]=-2894893,t[96]=-7278960,t[97]=-18751,t[98]=-24454,t[99]=-14634326,t[100]=-7876870,t[101]=-8943463,t[102]=-5192482,t[103]=-32,t[104]=-16711936,t[105]=-13447886,t[106]=-331546,t[107]=-65281,t[108]=-8388608,t[109]=-10039894,t[110]=-16777011,t[111]=-4565549,t[112]=-7114533,t[113]=-12799119,t[114]=-8689426,t[115]=-16713062,t[116]=-12004916,t[117]=-3730043,t[118]=-15132304,t[119]=-655366,t[120]=-6943,t[121]=-6987,t[122]=-8531,t[123]=-16777088,t[124]=-133658,t[125]=-8355840,t[126]=-9728477,t[127]=-23296,t[128]=-47872,t[129]=-2461482,t[130]=-1120086,t[131]=-6751336,t[132]=-5247250,t[133]=-2396013,t[134]=-4139,t[135]=-9543,t[136]=-3308225,t[137]=-16181,t[138]=-2252579,t[139]=-5185306,t[140]=-8388480,t[141]=-65536,t[142]=-4419697,t[143]=-12490271,t[144]=-7650029,t[145]=-360334,t[146]=-744352,t[147]=-13726889,t[148]=-2578,t[149]=-6270419,t[150]=-4144960,t[151]=-7876885,t[152]=-9807155,t[153]=-9404272,t[154]=-1286,t[155]=-16711809,t[156]=-12156236,t[157]=-2968436,t[158]=-16744320,t[159]=-2572328,t[160]=-40121,t[161]=-12525360,t[162]=-1146130,t[163]=-663885,t[164]=-1,t[165]=-657931,t[166]=-256,t[167]=-6632142,w.colorTable=t},w.KnownColorToArgb=function(t){return this.EnsureColorTable(),t<=d.MenuHighlight?this.colorTable[t]:0},w.KnownColorToName=function(t){return this.EnsureColorNameTable(),t<=d.MenuHighlight?w.colorNameTable[t]:u},w.IsKnowColor=function(t){return w.EnsureColorTable(),-1!==w.colorTable.indexOf(t)},m=w,n.KnownColorTable=m,y.parse=function(t){var n,n;return n=(n=y.fastParse(t))||r._(t)},y.fastParse=function(t){var n,e,i,n=y.COLOR_REG,e=function(t){return parseInt(t,16)};return t=t.trim().toLowerCase(),(i=n.rgb.exec(t))?{r:+i[1],g:+i[2],b:+i[3],a:255}:(i=n.rgba.exec(t))?{r:+i[1],g:+i[2],b:+i[3],a:255*+i[4]}:(i=n.hex8.exec(t))?{r:e(i[1]),g:e(i[2]),b:e(i[3]),a:e(i[4])}:(i=n.hex6.exec(t))?{r:e(i[1]),g:e(i[2]),b:e(i[3]),a:255}:(i=n.hex4.exec(t))?{r:e(i[1]+""+i[1]),g:e(i[2]+""+i[2]),b:e(i[3]+""+i[3]),a:e(i[4]+""+i[4])}:(i=n.hex3.exec(t))?{r:e(i[1]+""+i[1]),g:e(i[2]+""+i[2]),b:e(i[3]+""+i[3]),a:255}:void 0},y.COLOR_REG={rgb:/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/,rgba:/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d*\.?\d+)\s*\)$/,hex3:/^#([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})$/,hex6:/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/,hex4:/^#([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})$/,hex8:/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/},g=y,n.ColorParse=g,M.fromString=function(t){return new M(g.parse(t))},M.fromARGBColor=function(t){return new M({r:t.R,g:t.G,b:t.B,a:t.A})},Object.defineProperty(M.prototype,"red",{get:function(){return this._tV},set:function(t){this._tV=t},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"green",{get:function(){return this.EtV},set:function(t){this.EtV=t},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"blue",{get:function(){return this.FtV},set:function(t){this.FtV=t},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"alpha",{get:function(){return this.StV},set:function(t){this.StV=t},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"transparency",{get:function(){return 1-this.alpha/255},set:function(t){this.alpha=255*(1-t)},enumerable:!1,configurable:!0}),M.prototype.applyTint=function(t){var n,e,n=this;t=M.boundValue(t,0,1),e=n.toIColor(),M.sRgbToLinearRgb(e),e.r=M.boundValue(1-(1-e.r)*t,0,1),e.g=M.boundValue(1-(1-e.g)*t,0,1),e.b=M.boundValue(1-(1-e.b)*t,0,1),M.linearRgbToSRgb(e),n.setColor(e)},M.prototype.applyShade=function(t){var n,e,n=this;t=M.boundValue(t,0,1),e=n.toIColor(),M.sRgbToLinearRgb(e),e.r*=t,e.g*=t,e.b*=t,M.linearRgbToSRgb(e),n.setColor(e)},M.prototype.applyBrightness=function(t){var n,e,t,i,n=this,e=0<t?1-t:1+t,t=0<t?t:0,i=M.rgbToHsl([n.red,n.green,n.blue]);i[2]*=e,i[2]+=100*t,i[2]=M.boundValue(i[2],0,100),n.setHsl(i)},M.prototype.applySatMod=function(t){var n,e,n=this,e=M.rgbToHsl([n.red,n.green,n.blue]);e[1]*=t,n.setHsl(e)},M.prototype.toIColor=function(){return{r:this.red,g:this.green,b:this.blue,a:this.alpha}},M.prototype.toRgbString=function(){var t,n,e,t=this.red,n=this.green,e=this.blue;return"rgb(".concat(t,",").concat(n,",").concat(e,")")},M.prototype.toRgbaString=function(){var t,n,e,i,t=this.red,n=this.green,e=this.blue,i=Math.round(100*this.alpha/255)/100;return"rgba(".concat(t,",").concat(n,",").concat(e,",").concat(i,")")},M.prototype.toHexString=function(){return"#"+this.toHexValueString()},M.prototype.toHexValueString=function(){var t,n,e,i,t=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},n=this.red,e=this.green,i=this.blue;return"".concat(t(n)).concat(t(e)).concat(t(i))},M.prototype.toARGBColor=function(){var t=this;return h.FromArgbs(t.alpha,t.red,t.green,t.blue)},M.rgbToHsl=function(t){var n,e,t,i,r,o,t,a,n,n=t[0]/255,e=t[1]/255,t=t[2]/255,i=s(n,e,t),r=c(n,e,t),o=r-i,t=r===i?0:n===r?(e-t)/o:e===r?2+(t-n)/o:t===r?4+(n-e)/o:0;return(t=s(60*t,360))<0&&(t+=360),n=(i+r)/2,[t,100*(a=r===i?0:n<=.5?o/(r+i):o/(2-r-i)),100*n]},M.hslToRgb=function(t){var n,e,t,i,r,o,a,u,s,n=t[0]/360,e=t[1]/100,t=t[2]/100;if(0==e)return[o=255*t,o,o];for(a=2*t-(i=t<.5?t*(1+e):t+e-t*e),u=[0,0,0],s=0;s<3;s++)(r=n+1/3*-(s-1))<0&&r++,1<r&&r--,u[s]=255*(o=6*r<1?a+6*(i-a)*r:2*r<1?i:3*r<2?a+(i-a)*(2/3-r)*6:a);return u},M.sRgbToLinearRgb=function(t){var n=function(t){return t<=.04045?t/12.92:l((t+.055)/1.055,2.4)};t.r=n(t.r/255),t.g=n(t.g/255),t.b=n(t.b/255)},M.linearRgbToSRgb=function(t){var n=function(t){return t<=.0031308?12.92*t:1.055*l(t,1/2.4)-.055};t.r=255*n(t.r),t.g=255*n(t.g),t.b=255*n(t.b)},M.prototype.setColor=function(t){var n=this;n._tV=M.boundRgbComponent(t.r),n.EtV=M.boundRgbComponent(t.g),n.FtV=M.boundRgbComponent(t.b),n.StV=t.a===a?255:M.boundRgbComponent(t.a)},M.prototype.setHsl=function(t){this.setRgb(M.hslToRgb(t))},M.prototype.setRgb=function(t){var n=this;n.red=M.boundRgbComponent(t[0]),n.green=M.boundRgbComponent(t[1]),n.blue=M.boundRgbComponent(t[2])},M.boundRgbComponent=function(t){return M.boundValue(f(t),0,255)},M.boundValue=function(t,n,e){return c(n,s(t,e))},n.DrawingColorHelper=M},"./dist/plugins/floatingObject/drawing/colorData.js":function(t,n,e){"use strict";var i,u,r,e;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ColorData=n.ColorDataFlag=void 0,i=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),(e=u=n.ColorDataFlag||(n.ColorDataFlag={}))[e.None=0]="None",e[e.ColorType=1]="ColorType",e[e.Value=2]="Value",e[e.Tint=4]="Tint",e[e.All=7]="All",o.ConvertHexStringToInt=function(t){return parseInt(t,16)},o.prototype.Equals=function(t){return this.ColorType===t.ColorType&&this.Value===t.Value&&this.Tint===t.Tint},o.prototype.Clone=function(){return this},o.prototype.Compose=function(t,n){void 0===n&&(n=!0),t.Flag!==u.None&&(n?this.ConflictCompose(t):this.NonConflictCompose(t))},o.prototype.ConflictCompose=function(t){var n=this;(t.Flag&u.ColorType)===u.ColorType&&n.ColorType!==t.ColorType&&(n.ColorType=t.ColorType,n.Value=0,n.Tint=0),(t.Flag&u.Value)===u.Value&&(n.Value=t.Value),(t.Flag&u.Tint)===u.Tint&&(n.Tint=t.Tint),n.Flag|=t.Flag},o.prototype.NonConflictCompose=function(t){var n=this;(n.Flag&u.ColorType)!==u.ColorType&&(t.Flag&u.ColorType)===u.ColorType&&(n.ColorType=t.ColorType,n.Value=t.Value,n.Tint=t.Tint,n.Flag=t.Flag)},o.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},o.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},o.prototype.Compare=function(t,n){var e,i,r,o,a,e=this,i=!1;return(e.Flag&u.ColorType)===u.ColorType&&(a=(t.Flag&u.ColorType)!==u.ColorType||e.ColorType!==t.ColorType,n?(a||((e.Flag&u.Value)===u.Value&&(r=(t.Flag&u.Value)!==u.Value||e.Value!==t.Value)&&(e.Flag=u.None,i=!0),(e.Flag&u.Tint)===u.Tint&&(o=(t.Flag&u.Tint)!==u.Tint||e.Tint!==t.Tint)))&&(e.Flag=u.None,i=!0):a||((e.Flag&u.Value)!==u.Value||(r=(t.Flag&u.Value)!==u.Value||e.Value!==t.Value)||(e.Flag&=~u.Value,i=!0),(e.Flag&u.Tint)!==u.Tint||(o=(t.Flag&u.Tint)!==u.Tint||e.Tint!==t.Tint)||(e.Flag&=~u.Tint,i=!0),e.Flag===u.ColorType&&(e.Flag=u.None,i=!0))),i},o.prototype.UpdateDefaultValueFlag=function(){this.ColorType===i.ColorType.None?this.Flag=u.None:this.Flag=u.All},o.prototype.UpdateFlagFromBottom=function(){},o.prototype.ClearFlag=function(){this.Flag=u.None},o.prototype.SetFullFlag=function(){this.Flag=u.All},o.prototype.IsFullFlag=function(){return this.Flag===u.All},n.ColorData=o},"./dist/plugins/floatingObject/drawing/colorFormat.js":function(F,t,n){"use strict";var e,i,r,o,u,a,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N;function k(t,n){return t.getColor(n)!==n}function _(t,n){var e,e,t,e=N.call(this,n)||this;return void 0===n&&(n=p),(e=e).eft=c.ColorSchemeIndex.None,e.ift=p,e.rft=0,e.Vfe=0,e.oft=0,e.aft=v,e.uft=m,e.DJ=t,e.sft=n,(t=e.DJ.DrawingType)===c.DrawingType.Shape?e.xrt=c.SolidColorType.Theme:t===c.DrawingType.Chart?e.xrt=c.SolidColorType.Automatic:t===c.DrawingType.Picture&&(e.xrt=c.SolidColorType.None),e}function D(t,n){var t,e,i,r,o,a,n,t=u.DrawingColorHelper.fromARGBColor(t),e=n.Transparency,i=n.Tint,r=n.Shade,o=n.Brightness,a=n.SatMod,n=n.ApplyBrightness;return d(e)||0===e||(t.alpha=w(255*(1-e))),d(i)||0===i||t.applyTint(i),d(r)||0===r||t.applyShade(r),d(o)||0===o||!1===n||t.applyBrightness(o),d(a)||1===a||t.applySatMod(a),t.toARGBColor()}function j(t){delete t.hslClr,delete t.prstClr,delete t.scrgbClr,delete t.srgbClr,delete t.sysClr}function O(t){var n=null;switch(t){case c.ST_SystemColorVal.scrollBar:n=23;break;case c.ST_SystemColorVal.activeCaption:n=2;break;case c.ST_SystemColorVal.inactiveCaption:n=17;break;case c.ST_SystemColorVal.menu:n=21;break;case c.ST_SystemColorVal.window:n=24;break;case c.ST_SystemColorVal.windowFrame:n=25;break;case c.ST_SystemColorVal.menuText:n=22;break;case c.ST_SystemColorVal.windowText:n=26;break;case c.ST_SystemColorVal.activeBorder:n=1;break;case c.ST_SystemColorVal.inactiveBorder:n=16;break;case c.ST_SystemColorVal.appWorkspace:n=4;break;case c.ST_SystemColorVal.highlight:n=13;break;case c.ST_SystemColorVal.highlightText:n=14;break;case c.ST_SystemColorVal.btnFace:n=168;break;case c.ST_SystemColorVal.btnShadow:n=170;break;case c.ST_SystemColorVal.grayText:n=12;break;case c.ST_SystemColorVal.inactiveCaptionText:n=18;break;case c.ST_SystemColorVal.btnHighlight:n=169;break;case c.ST_SystemColorVal.infoText:n=20;break;case c.ST_SystemColorVal.infoBk:n=19;break;case c.ST_SystemColorVal.gradientActiveCaption:n=171;break;case c.ST_SystemColorVal.gradientInactiveCaption:n=172;break;case c.ST_SystemColorVal.menuHighlight:n=174;break;case c.ST_SystemColorVal.menuBar:n=173}return n}function E(t){var n=null;switch(t){case 1:n=c.ST_SystemColorVal.activeBorder;break;case 2:n=c.ST_SystemColorVal.activeCaption;break;case 168:n=c.ST_SystemColorVal.btnFace;break;case 169:n=c.ST_SystemColorVal.btnHighlight;break;case 170:n=c.ST_SystemColorVal.btnShadow;break;case 171:n=c.ST_SystemColorVal.gradientActiveCaption;break;case 172:n=c.ST_SystemColorVal.gradientInactiveCaption;break;case 12:n=c.ST_SystemColorVal.grayText;break;case 13:n=c.ST_SystemColorVal.highlight;break;case 14:n=c.ST_SystemColorVal.highlightText;break;case 16:n=c.ST_SystemColorVal.inactiveBorder;break;case 17:n=c.ST_SystemColorVal.inactiveCaption;break;case 18:n=c.ST_SystemColorVal.inactiveCaptionText;break;case 20:n=c.ST_SystemColorVal.infoText;break;case 21:n=c.ST_SystemColorVal.menu;break;case 173:n=c.ST_SystemColorVal.menuBar;break;case 174:n=c.ST_SystemColorVal.menuHighlight;break;case 22:n=c.ST_SystemColorVal.menuText;break;case 24:n=c.ST_SystemColorVal.window;break;case 25:n=c.ST_SystemColorVal.windowFrame;break;case 26:n=c.ST_SystemColorVal.windowText}return n}function R(t){var n=c.ST_SchemeColorVal.accent1;switch(t){case 4:n=c.ST_SchemeColorVal.accent1;break;case 5:n=c.ST_SchemeColorVal.accent2;break;case 6:n=c.ST_SchemeColorVal.accent3;break;case 7:n=c.ST_SchemeColorVal.accent4;break;case 8:n=c.ST_SchemeColorVal.accent5;break;case 9:n=c.ST_SchemeColorVal.accent6;break;case 0:n=c.ST_SchemeColorVal.bg1;break;case 2:n=c.ST_SchemeColorVal.bg2;break;case 11:n=c.ST_SchemeColorVal.folHlink;break;case 10:n=c.ST_SchemeColorVal.hlink;break;case 12:n=c.ST_SchemeColorVal.phClr;break;case 13:n=c.ST_SchemeColorVal.dk1;break;case 14:n=c.ST_SchemeColorVal.lt1;break;case 15:n=c.ST_SchemeColorVal.dk2;break;case 16:n=c.ST_SchemeColorVal.lt2;break;case 1:n=c.ST_SchemeColorVal.tx1;break;case 3:n=c.ST_SchemeColorVal.tx2}return n}function L(t){var n=4;switch(t){case c.ST_SchemeColorVal.bg1:n=0;break;case c.ST_SchemeColorVal.tx1:n=1;break;case c.ST_SchemeColorVal.bg2:n=2;break;case c.ST_SchemeColorVal.tx2:n=3;break;case c.ST_SchemeColorVal.accent2:n=5;break;case c.ST_SchemeColorVal.accent3:n=6;break;case c.ST_SchemeColorVal.accent4:n=7;break;case c.ST_SchemeColorVal.accent5:n=8;break;case c.ST_SchemeColorVal.accent6:n=9;break;case c.ST_SchemeColorVal.hlink:n=10;break;case c.ST_SchemeColorVal.folHlink:n=11;break;case c.ST_SchemeColorVal.phClr:n=12;break;case c.ST_SchemeColorVal.dk1:n=13;break;case c.ST_SchemeColorVal.lt1:n=14;break;case c.ST_SchemeColorVal.dk2:n=15;break;case c.ST_SchemeColorVal.lt2:n=16}return n}e=this&&this.__extends||(x=function(t,n){return(x=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}x(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=t.ColorFormat=t.createColorFormat=t.createColorFormatFromRGB=void 0,i=n("Common"),r=n("Core"),o=n("./dist/plugins/floatingObject/drawing/colorData.js"),u=n("./dist/plugins/floatingObject/drawing/color.js"),a=n("./dist/plugins/floatingObject/drawing/common.js"),s=n("./dist/plugins/floatingObject/drawing/stateful.js"),c=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),f=r.Util.StringToByteArray,l=r.NodeHelper.sr,h=i.Common.ft,d=a.UnitHelper.isNullOrUndefined,v=a.DrawingConstants.DefaultTransparent,m=a.DrawingConstants.DefaultSatMod,g=a.DrawingConstants.PositionConver,p=null,b=Math.abs,w=Math.floor,y=Math.max,M=Math.min,C=Math.round,S=Math.pow,t.createColorFormatFromRGB=T=function(t,n,e){var t=new I(t);return t.ColorType=n,t.RGB=e,t},t.createColorFormat=A=function(t,n,e,i){var t=new I(t);return t.ColorType=n,t.ObjectThemeColor=e,i&&(t.TintAndShade=i),t},N=s.StatefulBase,e(_,N),_.prototype.setColor=function(t,n){var e,t,t,e=this;t&&k(t.currentTheme(),n)?(t=a.DrawingUtility.fromThemeColorString(n))&&(e.ObjectThemeColor=t.index,e.kme(),void 0!==t.tint)&&(e.Brightness=t.tint):n===a.AUTO_COLOR?e.ColorType=c.SolidColorType.Automatic:(t=h._(n),e.RGB=u.ARGBColor.FromArgbs(t.a,t.r,t.g,t.b))},_.prototype.GetColorData=function(){var t,n,e,i,i,r,t=this,n=new o.ColorData;if(n.ColorType=c.ColorType.RGB,(e=t.xrt)===c.SolidColorType.None)n.ColorType=c.ColorType.None;else if(e===c.SolidColorType.Automatic){if(n.ColorType=c.ColorType.Auto,i=t.GetAutoColorFormat(),!d(i))return i.GetColorData()}else e===c.SolidColorType.RGB?d(t.ift)||(n.ColorType=c.ColorType.RGB,i=this.ift,1!=(r=1-t.aft)&&(i=u.ARGBColor.FromArgbs(parseInt(255*r,10),i.R,i.G,i.B)),n.Value=i.ToArgb(),n.Tint=t.TintAndShade,n.Transparency=t.Transparency,n.Shade=t.Shade,n.Brightness=t.Brightness,n.SatMod=t.SatMod):e===c.SolidColorType.Theme&&(n.ColorType=c.ColorType.Theme,n.Value=t.eft,n.Tint=t.TintAndShade,n.Transparency=t.Transparency,n.Shade=t.Shade,n.Brightness=t.Brightness,n.SatMod=t.SatMod);return n},_.prototype.HasOwnColor=function(){return this.GetState(c.ColorFormatStates.ObjectThemeColor)||this.GetState(c.ColorFormatStates.RGB)||this.GetAutoColorFormat()!==p},_.prototype.GetAutoColorFormat=function(){if(this.ColorType===c.SolidColorType.Automatic&&!d(this.AutoColorFormat)){var t=this.AutoColorFormat();if(!d(t)&&t.ColorType!==c.SolidColorType.Automatic)return t}return p},_.prototype.OnParentChanged=function(t){this.sft=t},_.prototype.ClearModel=function(){var t,n,e;for(this.cft=p,this.fft=p,t=0,n=this.Children;t<n.length;t++)(e=n[t]).ClearModel()},_.prototype.CalcBrightness=function(t,n){return t&&0<t.length&&n&&0<n.length?n[0]/g:t&&0<t.length?t[0]/g-1:0},_.prototype.CalcLumModeOff=function(t,n){var e=this;0<e.Brightness?(t.push(w((1-e.Brightness)*g)),n.push(w(e.Brightness*g))):e.Brightness<0&&t.push(w((1+e.Brightness)*g))},_.prototype.Yfe=function(t){var n=[],e=[];this.CalcLumModeOff(n,e),0<n.length&&(t.lumMod=n),0<e.length&&(t.lumOff=e)},_.prototype.lft=function(t){var n=this;0<n.Brightness?(t.lumMod={val:String(w((1-n.Brightness)*g))},t.lumOff={val:String(w(n.Brightness*g))}):n.Brightness<0&&(t.lumMod={val:String(w((1+n.Brightness)*g))},delete t.lumOff)},_.prototype.FromCT_ColorProperties=function(t){var n,e,i,e,i,e,e,i,n=this;n.cft=t,d(t)?n.ColorType=c.SolidColorType.None:d(t.schemeClr)?d(t.srgbClr)||d(t.srgbClr.val)||3!==t.srgbClr.val.length?d(t.scrgbClr)?d(t.sysClr)?d(t.prstClr)||(e=t.prstClr,i=a.DrawingUtility.GetPresetColorRGB(e.val),n.RGB=u.ARGBColor.FromRgb(i[0],i[1],i[2]),n.Zfe(e)):(e=(i=t.sysClr).val,d(e)?d(i.lastClr)||3!==i.lastClr.length||(n.RGB=u.ARGBColor.FromRgb(i.lastClr[0],i.lastClr[1],i.lastClr[2])):n.RGB=u.ARGBColor.FromKnownColor(e),n.Zfe(i)):(e=t.scrgbClr,n.RGB=u.ARGBColor.FromRgb(e.r,e.g,e.b)):(i=t.srgbClr,n.RGB=u.ARGBColor.FromRgb(i.val[0],i.val[1],i.val[2]),n.Zfe(i)):(e=t.schemeClr,n.ObjectThemeColor=e.val,n.Zfe(e))},_.prototype.Zfe=function(t){var n,e,n=this;n.Brightness=n.CalcBrightness(t.lumMod,t.lumOff),n.aft=v,!d(t.alpha)&&0<t.alpha.length&&n.FromTransparency(t.alpha[0]),n.rft=0,!d(t.tint)&&0<t.tint.length&&n.FromTint(t.tint[0]),n.Vfe=0,(e=t.shade)&&e.length&&n.FromShade(e[0]),n.uft=m,!d(t.satMod)&&0<t.satMod.length&&n.FromSatMod(t.satMod[0])},_.prototype.hft=function(t){var n,e,i,e,i,e,i,n=this,e=t.lumMod,i=t.lumOff;e=e&&[l(e.val)],i=i&&[l(i.val)],n.Brightness=n.CalcBrightness(e,i),n.aft=v,e=t.alpha,d(e)||n.FromTransparency(l(e.val,v)),n.rft=0,i=t.tint,d(i)||n.FromTint(l(i.val,0)),n.Vfe=0,e=t.shade,d(e)||n.FromShade(l(e.val,0)),n.uft=m,i=t.satMod,d(i)||n.FromSatMod(l(i.val,m))},_.prototype.Wfe=function(t){var n=this;n.Yfe(t=t||{}),n.Transparency!==v&&(t.alpha=[n.ToTransparency()]),0!==n.TintAndShade&&(t.tint=[n.ToTint()]),0!==n.Shade&&(t.shade=[n.ToShade()]),n.SatMod!==m&&(t.satMod=[n.ToSatMod()])},_.prototype.dft=function(t){var n=this;n.lft(t=t||{}),n.Transparency!==v&&(t.alpha={val:String(n.ToTransparency())}),0!==n.TintAndShade&&(t.tint={val:String(n.ToTint())}),0!==n.Shade&&(t.shade={val:String(n.ToShade())}),n.SatMod!==m&&(t.satMod={val:String(n.ToSatMod())})},_.prototype.FromSJSCT_ColorProperties=function(t){var n,e,i,r,e,r,i,e,i,r,n=this;n.fft=t,d(t)?n.ColorType=c.SolidColorType.None:d(t.schemeClr)?d(t.srgbClr)?d(t.scrgbClr)?d(t.sysClr)?d(t.prstClr)||(i=t.prstClr,r=a.DrawingUtility.GetPresetColorRGB(+c.ST_PresetColorVal[i.val]),n.RGB=u.ARGBColor.FromRgb(r[0],r[1],r[2]),n.hft(i)):(i=(r=t.sysClr).val,d(i)?d(r.lastClr)||(e=f(r.lastClr),n.RGB=u.ARGBColor.FromRgb(e[0],e[1],e[2])):n.RGB=u.ARGBColor.FromKnownColor(O(+c.ST_SystemColorVal[i])),n.hft(r)):(e=t.scrgbClr,n.RGB=u.ARGBColor.FromRgb(+e.r,+e.g,+e.b),n.hft(e)):(i=t.srgbClr,(r=f(i.val||i))&&3===r.length&&(n.RGB=u.ARGBColor.FromRgb(r[0],r[1],r[2]),n.hft(i))):(e=t.schemeClr,n.ObjectThemeColor=L(c.ST_SchemeColorVal[e.val||e]),n.hft(e))},_.prototype.ToCT_ColorProperties=function(t){var n,e,i,i,r,o,o,i,n=this,e=n.cft||t,i=e.schemeClr;return i&&a.DrawingUtility.removeEmptyArrayProperties(i),n.ColorType===c.SolidColorType.Theme?(j(e),(i=i||(e.schemeClr={})).val=n.ObjectThemeColor,n.Wfe(i)):n.ColorType===c.SolidColorType.RGB&&(j(e),delete e.schemeClr,i=p,n.ift&&n.ift.IsKnownColor&&(i=n.ift.ToKnownColor()),r=n.NoTransformedRGB,d(i)?((o=e.srgbClr={}).val=[r.R,r.G,r.B],n.Wfe(o)):((o=e.sysClr={}).val=i,o.lastClr=[r.R,r.G,r.B],n.Wfe(o))),i=t&&t.colorFillType,d(i)||(e.colorFillType=i),e},_.prototype.ToSJSCT_ColorProperties=function(t){var n,e,i,i,r,r,o,o,i,n=this,e=n.fft||t,i=e.schemeClr;return i&&a.DrawingUtility.removeEmptyArrayProperties(i),n.ColorType===c.SolidColorType.Theme?(j(e),(i=i||(e.schemeClr={})).val=c.ST_SchemeColorVal[R(n.ObjectThemeColor)],n.dft(i)):n.ColorType===c.SolidColorType.RGB&&(j(e),delete e.schemeClr,i=p,n.ift&&n.ift.IsKnownColor&&(i=n.ift.ToKnownColor()),r=n.NoTransformedRGB,r=u.DrawingColorHelper.fromARGBColor(r).toHexValueString(),d(i)?(o=e.srgbClr={val:r},n.dft(o)):((o=e.sysClr={}).val=c.ST_SystemColorVal[E(i)],o.lastClr=r,n.dft(o))),i=t&&t.colorFillType,d(i)||(e.colorFillType=i),e},_.prototype.FromTint=function(t){this.TintAndShade=t/g},_.prototype.FromShade=function(t){this.Shade=t/g},_.prototype.ToTint=function(){return w(b(this.TintAndShade*g))},_.prototype.ToShade=function(){return w(b(this.Shade*g))},_.prototype.FromTransparency=function(t){this.Transparency=1-t/g},_.prototype.ToTransparency=function(){return w((1-this.Transparency)*g)},_.prototype.FromSatMod=function(t){this.SatMod=t/g},_.prototype.ToSatMod=function(){return w(this.SatMod*g)},_.prototype.Clone=function(){var t,n,t=this,n=new _(t.DJ);return n.oft=t.oft,n.xrt=t.xrt,n.DJ=t.DJ,n.ift=t.ift,n.eft=t.eft,n.rft=t.rft,n.Vfe=t.Vfe,n.AutoColorFormat=t.AutoColorFormat,n},_.prototype.FromOOModel=function(t){this.FromCT_ColorProperties(t)},_.prototype.FromSJSOOModel=function(t){this.FromSJSCT_ColorProperties(t)},_.prototype.ToOOModel=function(){var t=this.ColorType;return t===c.SolidColorType.Automatic?{}:t===c.SolidColorType.None?{colorFillType:c.ColorFillType.NoFillProperties}:this.ToCT_ColorProperties({colorFillType:0})},_.prototype.ToSJSOOModel=function(){var t=this.ColorType;return t===c.SolidColorType.Automatic?{}:t===c.SolidColorType.None?{colorFillType:c.ColorFillType.NoFillProperties}:this.ToSJSCT_ColorProperties({colorFillType:0})},_.prototype.Color_FromOOModel=function(t){this.FromCT_ColorProperties(t)},_.prototype.Color_ToOOModel=function(){return this.ToCT_ColorProperties({})},_.prototype.Color_ToSJSOOModel=function(){return this.ToSJSCT_ColorProperties({})},_.prototype.GradientStop_FromOOModel=function(t){this.FromCT_ColorProperties(t)},_.prototype.GradientStop_ToOOModel=function(){return this.ToCT_ColorProperties({})},_.prototype.ColorData_FromOOModel=function(t){t.ColorType===c.ColorType.Index?this.RGB=u.ARGBColor.FromArgb(t.Value):t.ColorType===c.ColorType.Theme&&(this.ObjectThemeColor=t.Value,this.TintAndShade=t.Tint)},_.prototype.ColorData_ToOOModel=function(){var t,n,t=this,n=new o.ColorData;return t.ColorType===c.SolidColorType.RGB?(n.Value=t.RGB.Value,n.ColorType=c.ColorType.RGB):t.ColorType===c.SolidColorType.Theme&&(n.Value=t.ObjectThemeColor,n.Tint=t.TintAndShade,n.ColorType=c.ColorType.Theme),n},_.prototype.nft=function(t){var n,e,e,i,n,n=this,e=n.DJ.sheet();if(e)return e=e.currentTheme(),i=n.GetColorData(),n=n.Qfe(e,i),n=t?D(n,i):n},_.prototype.Qfe=function(t,n){var e,i,n,t,e=n.ColorType,i=u.ARGBColor.FromArgb(n.Value);return e===c.ColorType.Index?i=u.ARGBColor.FromIndexedColor(n.Value,0):e===c.ColorType.Theme?(n=a.DrawingUtility.toThemeColorString(n.Value,0),t=u.ColorParse.parse(t.getColor(n)),i=u.ARGBColor.FromArgbs(t.a,t.r,t.g,t.b)):e===c.ColorType.Auto?i=u.ARGBColor.FromKnownColor(u.KnownColor.WindowText):e===c.ColorType.None&&(i=new u.ARGBColor),i},_.prototype.kme=function(){var t=this;t.oft=0,t.rft=0,t.Vfe=0,t.uft=1},Object.defineProperty(_.prototype,"Brightness",{get:function(){return this.GetState(c.ColorFormatStates.Brightness)||d(this.sft)?this.oft:this.sft.Brightness},set:function(t){if(t<-1||1<t)throw new Error;this.oft=t,this.Dirty(c.ColorFormatStates.Brightness)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"ObjectThemeColor",{get:function(){return this.GetState(c.ColorFormatStates.ObjectThemeColor)||d(this.sft)?this.eft:this.sft.ObjectThemeColor},set:function(t){var n,e,n=this,e={13:1,14:0,15:3,16:2};d(e[t])||(t=e[t]),n.eft=t,n.Dirty(c.ColorFormatStates.ObjectThemeColor),n.ColorType=c.SolidColorType.Theme,n.ift=p,n.UnDirty(c.ColorFormatStates.RGB),n.oft=0,n.Dirty(c.ColorFormatStates.Brightness)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"NoTransformedRGB",{get:function(){var t=this;return t.HasOwnColor()||d(t.sft)?t.nft(!1):t.sft.RGB},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"RGB",{get:function(){var t=this;return t.HasOwnColor()||d(t.sft)?t.nft(!0):t.sft.RGB},set:function(t){var n=this;n.ift=t,n.Transparency=1-t.A/255,n.Dirty(c.ColorFormatStates.RGB),n.ColorType=c.SolidColorType.RGB,n.eft=c.ColorSchemeIndex.None,n.Dirty(c.ColorFormatStates.ObjectThemeColor),n.kme(),n.Dirty(c.ColorFormatStates.Brightness),n.Dirty(c.ColorFormatStates.TintAndShade)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TintAndShade",{get:function(){var t;return this.rft},set:function(t){this.rft=t,this.Dirty(c.ColorFormatStates.TintAndShade)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Shade",{get:function(){var t;return this.Vfe},set:function(t){this.Vfe=t,this.Dirty(c.ColorFormatStates.TintAndShade)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Transparency",{get:function(){var t=this;return t.GetState(c.ColorFormatStates.Transparency)||d(t.sft)?t.aft:t.sft.Transparency},set:function(t){t=y(0,M(1,t)),this.aft=t,this.Dirty(c.ColorFormatStates.Transparency)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"SatMod",{get:function(){var t=this;return t.GetState(c.ColorFormatStates.SatMod)||d(t.sft)?t.uft:t.sft.SatMod},set:function(t){this.uft=t,this.Dirty(c.ColorFormatStates.SatMod)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"ColorType",{get:function(){var t=this;return t.GetState(c.ColorFormatStates.ColorType)||d(t.sft)?t.xrt:t.sft.ColorType},set:function(t){this.xrt=t,this.Dirty(c.ColorFormatStates.ColorType)},enumerable:!1,configurable:!0}),I=_,t.ColorFormat=I,t.transformColor=D},"./dist/plugins/floatingObject/drawing/common.js":function(t,e,n){"use strict";var i,s,c,o,a,r,u,f,l,h,d,v,m,g,p,b,n,n;function w(){}function y(t,n){var n=Math.pow(10,n);return Math.round(t*n)/n}function M(){}function C(t,n,e,i,r){var o=this;o.Row=t,o.Column=n,o.RowCount=e,o.ColumnCount=i,o.Worksheet=r}function S(t,n,e,i,r){var o=this;o.WorksheetName=t,o.Row=n,o.Column=e,void 0!==i&&(o.LastRow=i),void 0!==r&&(o.LastColumn=r)}function T(t){delete t.solidFill,delete t.pattFill,delete t.blipFill,delete t.gradFill,delete t.noFill,delete t.grpFill,delete t.uFill,delete t.uFillTx}function A(){}function I(t){return parseFloat(t||"0")/1e5}function x(t){var n=null;switch(t){case i.ST_SystemColorVal.scrollBar:n=23;break;case i.ST_SystemColorVal.activeCaption:n=2;break;case i.ST_SystemColorVal.inactiveCaption:n=17;break;case i.ST_SystemColorVal.menu:n=21;break;case i.ST_SystemColorVal.window:n=24;break;case i.ST_SystemColorVal.windowFrame:n=25;break;case i.ST_SystemColorVal.menuText:n=22;break;case i.ST_SystemColorVal.windowText:n=26;break;case i.ST_SystemColorVal.activeBorder:n=1;break;case i.ST_SystemColorVal.inactiveBorder:n=16;break;case i.ST_SystemColorVal.appWorkspace:n=4;break;case i.ST_SystemColorVal.highlight:n=13;break;case i.ST_SystemColorVal.highlightText:n=14;break;case i.ST_SystemColorVal.btnFace:n=168;break;case i.ST_SystemColorVal.btnShadow:n=170;break;case i.ST_SystemColorVal.grayText:n=12;break;case i.ST_SystemColorVal.inactiveCaptionText:n=18;break;case i.ST_SystemColorVal.btnHighlight:n=169;break;case i.ST_SystemColorVal.infoText:n=20;break;case i.ST_SystemColorVal.infoBk:n=19;break;case i.ST_SystemColorVal.gradientActiveCaption:n=171;break;case i.ST_SystemColorVal.gradientInactiveCaption:n=172;break;case i.ST_SystemColorVal.menuHighlight:n=174;break;case i.ST_SystemColorVal.menuBar:n=173}return n}function N(t){return t=!t||t instanceof Array?t:[t]}function k(t){var n=4;switch(t){case i.ST_SchemeColorVal.bg1:n=0;break;case i.ST_SchemeColorVal.tx1:n=1;break;case i.ST_SchemeColorVal.bg2:n=2;break;case i.ST_SchemeColorVal.tx2:n=3;break;case i.ST_SchemeColorVal.accent2:n=5;break;case i.ST_SchemeColorVal.accent3:n=6;break;case i.ST_SchemeColorVal.accent4:n=7;break;case i.ST_SchemeColorVal.accent5:n=8;break;case i.ST_SchemeColorVal.accent6:n=9;break;case i.ST_SchemeColorVal.hlink:n=10;break;case i.ST_SchemeColorVal.folHlink:n=11;break;case i.ST_SchemeColorVal.phClr:n=12;break;case i.ST_SchemeColorVal.dk1:n=13;break;case i.ST_SchemeColorVal.lt1:n=14;break;case i.ST_SchemeColorVal.dk2:n=15;break;case i.ST_SchemeColorVal.lt2:n=16}return n}function _(t){return t?"1":"0"}Object.defineProperty(e,"__esModule",{value:!0}),e.mft=e.toColorSchemeIndex=e.gft=e.toKnownColor=e.pft=e.DrawingUtility=e.ThemeColorDict=e.DrawingConstants=e.ChartConstants=e.Reference=e.CellRect=e.UnitHelper=e.NumberExtension=e.AUTO_COLOR=void 0,i=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),s=null,c=void 0,o=Math.max,a=Math.min,r=Math.floor,u=Math.log,f=Math.pow,l=Math.abs,e.AUTO_COLOR="auto",w.log=function(t,n){return u(t)/u(n)},w.round=function(t,n){var n=f(10,n);return Math.round(t*n)/n},w.isNaNOrInfinite=function(t){return isNaN(t)||!isFinite(t)},w.GetTriangleAngle=function(t,n,e){var e,i;return 0===t&&0===n?0:(e=(t*t+e*e-n*n)/l(2*t*e),t<(i=0)&&0<n?i=90:t<0&&n<0?i=180:0<t&&n<0&&(i=270),180*Math.acos(e)/Math.PI+i)},w.INT32_MAX_VALUE=2147483647,w.DOUBLE_MAX_VALUE=Number.MAX_VALUE,w.DOUBLE_MIN_VALUE=-Number.MAX_VALUE,e.NumberExtension=h=w,M.pointToPixel=function(t){return y(96*t/72,2)},M.IsNullOrEmpty=function(t){return M.isNullOrUndefined(t)||""===t},M.IsNegativeInfinity=function(t){return t===Number.NEGATIVE_INFINITY},M.IsPositiveInfinity=function(t){return t===Number.POSITIVE_INFINITY},M.isNullOrUndefined=function(t){return t===c||t===s},d=M,e.UnitHelper=d,Object.defineProperty(C.prototype,"Left",{get:function(){return this.Column},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"Top",{get:function(){return this.Row},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"Right",{get:function(){return this.Column+this.ColumnCount},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"Bottom",{get:function(){return this.Row+this.RowCount},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"IsFullColumn",{get:function(){return 0===this.Row&&this.RowCount===h.INT32_MAX_VALUE},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"IsFullRow",{get:function(){return 0===this.Column&&this.ColumnCount===h.INT32_MAX_VALUE},enumerable:!1,configurable:!0}),C.prototype.Intersect=function(t){var n,t,e,i,r,t,n=this,t=t,e=o(n.Column,t.Column),i=o(n.Row,t.Row),r=a(n.Right,t.Right),t=a(n.Bottom,t.Bottom);r<=e||t<=i?(n.Column=0,n.Row=0,n.ColumnCount=0,n.RowCount=0):(n.Column=e,n.Row=i,n.ColumnCount=r-e,n.RowCount=t-i)},C.prototype.IntersectsWith=function(t){var n,e,n=this,e;return!(n.Left>=t.Right||n.Right<=t.Left||n.Top>=t.Bottom||n.Bottom<=t.Top)},v=C,e.CellRect=v,(n=m=m||{})[n.Row=1]="Row",n[n.Column=2]="Column",n[n.RowIsRelative=4]="RowIsRelative",n[n.ColumnIsRelative=8]="ColumnIsRelative",n[n.LastRowIsRelative=16]="LastRowIsRelative",n[n.LastColumnIsRelative=32]="LastColumnIsRelative",n[n.Range=64]="Range",n[n.Error=128]="Error",Object.defineProperty(S.prototype,"Row",{get:function(){return(this.Kind&m.Row)===m.Row?this.Ky:0},set:function(t){this.Ky=t,this.Kind|=m.Row},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Column",{get:function(){return(this.Kind&m.Column)===m.Column?this.yft:0},set:function(t){this.yft=t,this.Kind|=m.Column},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"RowCount",{get:function(){var t,n,e,t=this;return t.IsRange?(t.Kind&m.Row)===m.Row?t.RowIsRelative&&t.LastRowIsRelative||!t.RowIsRelative&&!t.LastRowIsRelative?t.LastRow-t.Row+1:-1:(n=t.Worksheet).getRowCount():1},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"ColumnCount",{get:function(){var t=this;return t.IsRange?(t.Kind&m.Column)===m.Column?t.ColumnIsRelative&&t.LastColumnIsRelative||!t.ColumnIsRelative&&!t.LastColumnIsRelative?t.LastColumn-t.Column+1:-1:t.Worksheet.getColumnCount():1},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"LastColumn",{get:function(){var t,n,e,t=this;return t.IsRange?(t.Kind&m.Column)===m.Column?t.wft:(e=(n=t.Worksheet).getColumnCount())-1:t.Column},set:function(t){this.wft=t,this.Kind|=m.Column|m.Range},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"LastRow",{get:function(){var t,n,e,t=this;return t.IsRange?(t.Kind&m.Row)===m.Row?t.Mft:(e=(n=t.Worksheet).getRowCount())-1:t.Row},set:function(t){this.Mft=t,this.Kind|=m.Row|m.Range},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"RowIsRelative",{get:function(){return(this.Kind&(m.Row|m.RowIsRelative))==(m.Row|m.RowIsRelative)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"ColumnIsRelative",{get:function(){return(this.Kind&(m.Column|m.ColumnIsRelative))==(m.Column|m.ColumnIsRelative)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"LastRowIsRelative",{get:function(){return this.IsRange?(this.Kind&(m.Row|m.LastRowIsRelative))==(m.Row|m.LastRowIsRelative):this.RowIsRelative},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"LastColumnIsRelative",{get:function(){return this.IsRange?(this.Kind&(m.Column|m.LastColumnIsRelative))==(m.Column|m.LastColumnIsRelative):this.ColumnIsRelative},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"IsRange",{get:function(){return(this.Kind&m.Range)===m.Range},set:function(t){t?this.Kind|=m.Range:this.Kind&=~m.Range},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"IsError",{get:function(){return"#REF"===this.WorksheetName},enumerable:!1,configurable:!0}),S.prototype.GetSourceRange=function(t,n){var e,i,r,o,e,e=this,i=e.Row,r=e.Column,o=e.LastRow,e=e.LastColumn;return new v(i,r,o-i+1,e-r+1)},S.prototype.ToR1C1Text=function(t){var n,e,i,r,o,a;return t===c&&(t=s),e=(n=this).D5,d.isNullOrUndefined(e)?(n.Kind&m.Error)===m.Error?n.GetPrevText(t)+"#REF!":(i="",(n.Kind&m.Row)===m.Row&&(r=n.Row,n.RowIsRelative?i+=0===r?"R":"R["+r.toString()+"]":i+="R"+(r+1).toString()),(n.Kind&m.Column)===m.Column&&(o=n.Column,n.ColumnIsRelative?i+=0===o?"C":"C["+o.toString()+"]":i+="C"+(o+1).toString()),n.IsRange&&(a=!1,(n.Kind&(m.Row|m.Column))!=(m.Row|m.Column)&&((n.Kind&m.Row)===m.Row?n.RowIsRelative===n.LastRowIsRelative&&n.Row===n.LastRow&&(a=!0):n.ColumnIsRelative===n.LastColumnIsRelative&&n.Column===n.LastColumn&&(a=!0)),a||(i+=":",(n.Kind&m.Row)===m.Row&&(r=n.LastRow,n.LastRowIsRelative?i+=0===r?"R":"R["+r.toString()+"]":i+="R"+(r+1).toString()),(n.Kind&m.Column)===m.Column&&(o=n.LastColumn,n.LastColumnIsRelative?i+=0===o?"C":"C["+o.toString()+"]":i+="C"+(o+1).toString()))),n.GetPrevText(t)+i):e},S.prototype.ToA1Text=function(t,n,e){var i,r,o,a,u;return e===c&&(e=s),r=(i=this).D5,d.isNullOrUndefined(r)?(i.Kind&m.Error)===m.Error?i.GetPrevText(e)+"#REF!":(o="",(i.Kind&m.Column)===m.Column&&(u=i.Column,i.ColumnIsRelative?u+=n:o+="$",isNaN(u)||(o+=i.GetColumnIndexInA1Letter(u))),(i.Kind&m.Row)===m.Row&&(a=i.Row,i.RowIsRelative?a+=t:o+="$",o+=(a+1).toString()),i.IsRange&&(o+=":",(i.Kind&m.Column)===m.Column&&(u=i.LastColumn,i.LastColumnIsRelative?u+=n:o+="$",isNaN(u)||(o+=i.GetColumnIndexInA1Letter(u))),(i.Kind&m.Row)===m.Row)&&(a=i.LastRow,i.LastRowIsRelative?a+=t:o+="$",o+=(a+1).toString()),i.GetPrevText(e)+o):r},S.prototype.GetPrevText=function(t){var n,e,i,n=this,e="";return 0<n.Workbook&&(e="["+n.Workbook.toString()+"]"),i=n.WorksheetName,(i=d.isNullOrUndefined(i)?t:i)&&(d.isNullOrUndefined(n.LastWorksheetName)?e+=i:e+=i+":"+n.LastWorksheetName),e?((n.IsSpecialSheetName(i)||n.IsSpecialSheetName(n.LastWorksheetName))&&(e="'"+e.replace("'","''")+"'"),e+="!"):""===i&&(e="!"),e},S.prototype.IsSpecialSheetName=function(t){var n,e;if(!d.isNullOrUndefined(t)){if(t===S.ErrorWorksheetName)return!1;for(n=0;n<t.length;n++)if(!("A"<=(e=t[n])&&e<="Z"||"a"<=e&&e<="z"||"0"<=e&&e<="9"||"_"===e))return!0}return!1},S.prototype.GetColumnIndexInA1Letter=function(t){for(var n,e,i,n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",e=[],i=0;(i=t%26,!isNaN(i))&&(e.unshift(n[i]),0!==(t=parseInt(t/26+"",10)));)t--;return e.join("")},S.ErrorWorksheetName="#REF",g=S,e.Reference=g,e.ChartConstants={XValuesMinMax:"XValuesMinMax",ValuesMinMax:"ValuesMinMax",PrimaryValuesMinMax:"PrimaryValuesMinMax",SecondaryValuesMinMax:"SecondaryValuesMinMax",PrimaryXValuesMinMax:"PrimaryXValuesMinMax",SecondaryXValuesMinMax:"SecondaryXValuesMinMax",Collection:"Collection",Restore:"Restore",ChartType:"ChartType",AxisGroup:"AxisGroup",AreAllXValuesDateTime:"AreAllXValuesDateTime",XValuesFormula:"XValuesFormula",XValues:"XValues",CategoryNames:"CategoryNames",CategoryType:"CategoryType",SecondaryPlot:"SecondaryPlot",SplitType:"SplitType",SplitValue:"SplitValue",IsMultiLevelXValues:"IsMultiLevelXValues",PlotOrder:"PlotOrder",FIELD_TYPE_CELLRANGE:"CELLRANGE",FIELD_TYPE_SERIESNAME:"SERIESNAME",FIELD_TYPE_CATEGORYNAME:"CATEGORYNAME",FIELD_TYPE_VALUE:"VALUE",FIELD_TYPE_XVALUE:"XVALUE",FIELD_TYPE_YVALUE:"YVALUE",FIELD_TYPE_BUBBLESIZE:"BUBBLESIZE",FIELD_TYPE_PERCENTAGE:"PERCENTAGE",FIELD_TYPE_TXLINK:"TxLink",FIELD_TEXT_CELLRANGE:"[CELLRANGE]",FIELD_TEXT_SERIESNAME:"[SERIES NAME]",FIELD_TEXT_CATEGORYNAME:"[CATEGORY NAME]",FIELD_TEXT_VALUE:"[VALUE]",FIELD_TEXT_XVALUE:"[XVALUE]",FIELD_TEXT_YVALUE:"[YVALUE]",FIELD_TEXT_BUBBLESIZE:"[BUBBLE SIZE]",CHART_LATIN_HEAD_FONT:"+mj-lt",CHART_LATIN_BODY_FONT:"+mn-lt",CHART_EA_HEAD_FONT:"+mj-ea",CHART_EA_BODY_FONT:"+mn-ea",CHART_CS_HEAD_FONT:"+mj-cs",CHART_CS_BODY_FONT:"+mn-cs",DefaultLineColorBrightness:.85,DefaultMarkerSize:7},e.DrawingConstants={ShapeTypePrefix:"Shape",PositiveFixedAngleConvert:6e4,PositionConver:1e5,CropPositionConver:1e3,ShadeConver:2e5,DefaultBrightness:.5,RelativeRectConver:1e3,DefaultTransparent:0,PositiveFixedPercentageConvert:1e5,DefaultOffset:2.07995176,DefaultSatMod:1},(n=p=e.ThemeColorDict||(e.ThemeColorDict={}))[n["background 1"]=0]="background 1",n[n["background 2"]=2]="background 2",n[n["text 1"]=1]="text 1",n[n["text 2"]=3]="text 2",n[n["accent 1"]=4]="accent 1",n[n["accent 2"]=5]="accent 2",n[n["accent 3"]=6]="accent 3",n[n["accent 4"]=7]="accent 4",n[n["accent 5"]=8]="accent 5",n[n["accent 6"]=9]="accent 6",n[n.hyperlink=10]="hyperlink",n[n.followedhyperlink=11]="followedhyperlink",A.Cft=function(t,n){return n===i.ThemeFont.Major?t.getFont("Headings"):n===i.ThemeFont.Minor?t.getFont("Body"):""},A.InitPresetColors=function(){var t=A.presetColors;t[i.ST_PresetColorVal.aliceBlue]=[240,248,255],t[i.ST_PresetColorVal.antiqueWhite]=[250,235,215],t[i.ST_PresetColorVal.aqua]=[0,255,255],t[i.ST_PresetColorVal.aquamarine]=[127,255,212],t[i.ST_PresetColorVal.azure]=[240,255,255],t[i.ST_PresetColorVal.beige]=[245,245,220],t[i.ST_PresetColorVal.bisque]=[255,228,196],t[i.ST_PresetColorVal.black]=[0,0,0],t[i.ST_PresetColorVal.blanchedAlmond]=[255,235,205],t[i.ST_PresetColorVal.blue]=[0,0,255],t[i.ST_PresetColorVal.blueViolet]=[138,43,226],t[i.ST_PresetColorVal.brown]=[165,42,42],t[i.ST_PresetColorVal.burlyWood]=[222,184,135],t[i.ST_PresetColorVal.cadetBlue]=[95,158,160],t[i.ST_PresetColorVal.chartreuse]=[127,255,0],t[i.ST_PresetColorVal.chocolate]=[210,105,30],t[i.ST_PresetColorVal.coral]=[255,127,80],t[i.ST_PresetColorVal.cornflowerBlue]=[100,149,237],t[i.ST_PresetColorVal.cornsilk]=[255,248,220],t[i.ST_PresetColorVal.crimson]=[220,20,60],t[i.ST_PresetColorVal.cyan]=[0,255,255],t[i.ST_PresetColorVal.darkBlue]=[0,0,139],t[i.ST_PresetColorVal.darkCyan]=[0,139,139],t[i.ST_PresetColorVal.darkGoldenrod]=[184,134,11],t[i.ST_PresetColorVal.darkGray]=[169,169,169],t[i.ST_PresetColorVal.darkGreen]=[0,100,0],t[i.ST_PresetColorVal.darkGrey]=[169,169,169],t[i.ST_PresetColorVal.darkKhaki]=[189,183,107],t[i.ST_PresetColorVal.darkMagenta]=[139,0,139],t[i.ST_PresetColorVal.darkOliveGreen]=[85,107,47],t[i.ST_PresetColorVal.darkOrange]=[255,140,0],t[i.ST_PresetColorVal.darkOrchid]=[153,50,204],t[i.ST_PresetColorVal.darkRed]=[139,0,0],t[i.ST_PresetColorVal.darkSalmon]=[233,150,122],t[i.ST_PresetColorVal.darkSeaGreen]=[143,188,143],t[i.ST_PresetColorVal.darkSlateBlue]=[72,61,139],t[i.ST_PresetColorVal.darkSlateGray]=[47,79,79],t[i.ST_PresetColorVal.darkSlateGrey]=[47,79,79],t[i.ST_PresetColorVal.darkTurquoise]=[0,206,209],t[i.ST_PresetColorVal.darkViolet]=[148,0,211],t[i.ST_PresetColorVal.deepPink]=[255,20,147],t[i.ST_PresetColorVal.deepSkyBlue]=[0,191,255],t[i.ST_PresetColorVal.dimGray]=[105,105,105],t[i.ST_PresetColorVal.dimGrey]=[105,105,105],t[i.ST_PresetColorVal.dkBlue]=[0,0,139],t[i.ST_PresetColorVal.dkCyan]=[0,139,139],t[i.ST_PresetColorVal.dkGoldenrod]=[184,134,11],t[i.ST_PresetColorVal.dkGray]=[169,169,169],t[i.ST_PresetColorVal.dkGreen]=[0,100,0],t[i.ST_PresetColorVal.dkGrey]=[169,169,169],t[i.ST_PresetColorVal.dkKhaki]=[189,183,107],t[i.ST_PresetColorVal.dkMagenta]=[139,0,139],t[i.ST_PresetColorVal.dkOliveGreen]=[85,107,47],t[i.ST_PresetColorVal.dkOrange]=[255,140,0],t[i.ST_PresetColorVal.dkOrchid]=[153,50,204],t[i.ST_PresetColorVal.dkRed]=[139,0,0],t[i.ST_PresetColorVal.dkSalmon]=[233,150,122],t[i.ST_PresetColorVal.dkSeaGreen]=[143,188,139],t[i.ST_PresetColorVal.dkSlateBlue]=[72,61,139],t[i.ST_PresetColorVal.dkSlateGray]=[47,79,79],t[i.ST_PresetColorVal.dkSlateGrey]=[47,79,79],t[i.ST_PresetColorVal.dkTurquoise]=[0,206,209],t[i.ST_PresetColorVal.dkViolet]=[148,0,211],t[i.ST_PresetColorVal.dodgerBlue]=[30,144,255],t[i.ST_PresetColorVal.firebrick]=[178,34,34],t[i.ST_PresetColorVal.floralWhite]=[255,250,240],t[i.ST_PresetColorVal.forestGreen]=[34,139,34],t[i.ST_PresetColorVal.fuchsia]=[255,0,255],t[i.ST_PresetColorVal.gainsboro]=[220,220,220],t[i.ST_PresetColorVal.ghostWhite]=[248,248,255],t[i.ST_PresetColorVal.gold]=[255,215,0],t[i.ST_PresetColorVal.goldenrod]=[218,165,32],t[i.ST_PresetColorVal.gray]=[128,128,128],t[i.ST_PresetColorVal.green]=[0,128,0],t[i.ST_PresetColorVal.greenYellow]=[173,255,47],t[i.ST_PresetColorVal.grey]=[128,128,128],t[i.ST_PresetColorVal.honeydew]=[240,255,240],t[i.ST_PresetColorVal.hotPink]=[255,105,180],t[i.ST_PresetColorVal.indianRed]=[205,92,92],t[i.ST_PresetColorVal.indigo]=[75,0,130],t[i.ST_PresetColorVal.ivory]=[255,255,240],t[i.ST_PresetColorVal.khaki]=[240,230,140],t[i.ST_PresetColorVal.lavender]=[230,230,250],t[i.ST_PresetColorVal.lavenderBlush]=[255,240,245],t[i.ST_PresetColorVal.lawnGreen]=[124,252,0],t[i.ST_PresetColorVal.lemonChiffon]=[255,250,205],t[i.ST_PresetColorVal.lightBlue]=[173,216,230],t[i.ST_PresetColorVal.lightCoral]=[240,128,128],t[i.ST_PresetColorVal.lightCyan]=[224,255,255],t[i.ST_PresetColorVal.lightGoldenrodYellow]=[250,250,210],t[i.ST_PresetColorVal.lightGray]=[211,211,211],t[i.ST_PresetColorVal.lightGreen]=[144,238,144],t[i.ST_PresetColorVal.lightGrey]=[211,211,211],t[i.ST_PresetColorVal.lightPink]=[255,182,193],t[i.ST_PresetColorVal.lightSalmon]=[255,160,122],t[i.ST_PresetColorVal.lightSeaGreen]=[32,178,170],t[i.ST_PresetColorVal.lightSkyBlue]=[135,206,250],t[i.ST_PresetColorVal.lightSlateGray]=[119,136,153],t[i.ST_PresetColorVal.lightSlateGrey]=[119,136,153],t[i.ST_PresetColorVal.lightSteelBlue]=[176,196,222],t[i.ST_PresetColorVal.lightYellow]=[255,255,224],t[i.ST_PresetColorVal.lime]=[0,255,0],t[i.ST_PresetColorVal.limeGreen]=[50,205,50],t[i.ST_PresetColorVal.linen]=[250,240,230],t[i.ST_PresetColorVal.ltBlue]=[173,216,230],t[i.ST_PresetColorVal.ltCoral]=[240,128,128],t[i.ST_PresetColorVal.ltCyan]=[224,255,255],t[i.ST_PresetColorVal.ltGoldenrodYellow]=[250,250,120],t[i.ST_PresetColorVal.ltGray]=[211,211,211],t[i.ST_PresetColorVal.ltGreen]=[144,238,144],t[i.ST_PresetColorVal.ltGrey]=[211,211,211],t[i.ST_PresetColorVal.ltPink]=[255,182,193],t[i.ST_PresetColorVal.ltSalmon]=[255,160,122],t[i.ST_PresetColorVal.ltSeaGreen]=[32,178,170],t[i.ST_PresetColorVal.ltSkyBlue]=[135,206,250],t[i.ST_PresetColorVal.ltSlateGray]=[119,136,153],t[i.ST_PresetColorVal.ltSlateGrey]=[119,136,153],t[i.ST_PresetColorVal.ltSteelBlue]=[176,196,222],t[i.ST_PresetColorVal.ltYellow]=[255,255,224],t[i.ST_PresetColorVal.magenta]=[255,0,255],t[i.ST_PresetColorVal.maroon]=[128,0,0],t[i.ST_PresetColorVal.medAquamarine]=[102,205,170],t[i.ST_PresetColorVal.medBlue]=[0,0,205],t[i.ST_PresetColorVal.mediumAquamarine]=[102,205,170],t[i.ST_PresetColorVal.mediumBlue]=[0,0,205],t[i.ST_PresetColorVal.mediumOrchid]=[186,85,211],t[i.ST_PresetColorVal.mediumPurple]=[147,112,219],t[i.ST_PresetColorVal.mediumSeaGreen]=[60,179,113],t[i.ST_PresetColorVal.mediumSlateBlue]=[123,104,238],t[i.ST_PresetColorVal.mediumSpringGreen]=[0,250,154],t[i.ST_PresetColorVal.mediumTurquoise]=[72,209,204],t[i.ST_PresetColorVal.mediumVioletRed]=[199,21,133],t[i.ST_PresetColorVal.medOrchid]=[186,85,211],t[i.ST_PresetColorVal.medPurple]=[147,112,219],t[i.ST_PresetColorVal.medSeaGreen]=[60,179,113],t[i.ST_PresetColorVal.medSlateBlue]=[123,104,238],t[i.ST_PresetColorVal.medSpringGreen]=[0,250,154],t[i.ST_PresetColorVal.medTurquoise]=[72,209,204],t[i.ST_PresetColorVal.medVioletRed]=[199,21,133],t[i.ST_PresetColorVal.midnightBlue]=[25,25,112],t[i.ST_PresetColorVal.mintCream]=[245,255,250],t[i.ST_PresetColorVal.mistyRose]=[255,228,225],t[i.ST_PresetColorVal.moccasin]=[255,228,181],t[i.ST_PresetColorVal.navajoWhite]=[255,222,173],t[i.ST_PresetColorVal.navy]=[0,0,128],t[i.ST_PresetColorVal.oldLace]=[253,245,230],t[i.ST_PresetColorVal.olive]=[128,128,0],t[i.ST_PresetColorVal.oliveDrab]=[107,142,35],t[i.ST_PresetColorVal.orange]=[255,165,0],t[i.ST_PresetColorVal.orangeRed]=[255,69,0],t[i.ST_PresetColorVal.orchid]=[218,112,214],t[i.ST_PresetColorVal.paleGoldenrod]=[238,232,170],t[i.ST_PresetColorVal.paleGreen]=[152,251,152],t[i.ST_PresetColorVal.paleTurquoise]=[175,238,238],t[i.ST_PresetColorVal.paleVioletRed]=[219,112,147],t[i.ST_PresetColorVal.papayaWhip]=[255,239,213],t[i.ST_PresetColorVal.peachPuff]=[255,218,185],t[i.ST_PresetColorVal.peru]=[205,133,63],t[i.ST_PresetColorVal.pink]=[255,192,203],t[i.ST_PresetColorVal.plum]=[221,160,221],t[i.ST_PresetColorVal.powderBlue]=[176,224,230],t[i.ST_PresetColorVal.purple]=[128,0,128],t[i.ST_PresetColorVal.red]=[255,0,0],t[i.ST_PresetColorVal.rosyBrown]=[188,143,143],t[i.ST_PresetColorVal.royalBlue]=[65,105,225],t[i.ST_PresetColorVal.saddleBrown]=[139,69,19],t[i.ST_PresetColorVal.salmon]=[250,128,114],t[i.ST_PresetColorVal.sandyBrown]=[244,164,96],t[i.ST_PresetColorVal.seaGreen]=[46,139,87],t[i.ST_PresetColorVal.seaShell]=[255,245,238],t[i.ST_PresetColorVal.sienna]=[160,82,45],t[i.ST_PresetColorVal.silver]=[192,192,192],t[i.ST_PresetColorVal.skyBlue]=[135,206,235],t[i.ST_PresetColorVal.slateBlue]=[106,90,205],t[i.ST_PresetColorVal.slateGray]=[112,128,144],t[i.ST_PresetColorVal.slateGrey]=[112,128,144],t[i.ST_PresetColorVal.snow]=[255,250,250],t[i.ST_PresetColorVal.springGreen]=[0,255,127],t[i.ST_PresetColorVal.steelBlue]=[70,130,180],t[i.ST_PresetColorVal.tan]=[210,180,140],t[i.ST_PresetColorVal.teal]=[0,128,128],t[i.ST_PresetColorVal.thistle]=[216,191,216],t[i.ST_PresetColorVal.tomato]=[255,99,71],t[i.ST_PresetColorVal.turquoise]=[64,224,208],t[i.ST_PresetColorVal.violet]=[238,130,238],t[i.ST_PresetColorVal.wheat]=[245,222,179],t[i.ST_PresetColorVal.white]=[255,255,255],t[i.ST_PresetColorVal.whiteSmoke]=[245,245,245],t[i.ST_PresetColorVal.yellow]=[255,255,0],t[i.ST_PresetColorVal.yellowGreen]=[154,205,50]},A.GetPresetColorRGB=function(t){return A.presetColors[t]},A.GetTextFieldTypeString=function(t){var n;return{0:e.ChartConstants.FIELD_TYPE_CELLRANGE,1:e.ChartConstants.FIELD_TYPE_SERIESNAME,2:e.ChartConstants.FIELD_TYPE_CATEGORYNAME,3:e.ChartConstants.FIELD_TYPE_VALUE,4:e.ChartConstants.FIELD_TYPE_XVALUE,5:e.ChartConstants.FIELD_TYPE_YVALUE,6:e.ChartConstants.FIELD_TYPE_BUBBLESIZE,7:e.ChartConstants.FIELD_TYPE_PERCENTAGE,8:e.ChartConstants.FIELD_TYPE_TXLINK}[t]||""},A.GetTextFieldTypeText=function(t){var n;return{0:e.ChartConstants.FIELD_TEXT_CELLRANGE,1:e.ChartConstants.FIELD_TEXT_SERIESNAME,2:e.ChartConstants.FIELD_TEXT_CATEGORYNAME,3:e.ChartConstants.FIELD_TEXT_VALUE,4:e.ChartConstants.FIELD_TEXT_XVALUE,5:e.ChartConstants.FIELD_TEXT_YVALUE,6:e.ChartConstants.FIELD_TEXT_BUBBLESIZE}[t]||""},A.GetTextFieldType=function(t){var n=i.TextFieldType.CellRange;switch(t){case e.ChartConstants.FIELD_TYPE_CELLRANGE:n=i.TextFieldType.CellRange;break;case e.ChartConstants.FIELD_TYPE_SERIESNAME:n=i.TextFieldType.SeriesName;break;case e.ChartConstants.FIELD_TYPE_CATEGORYNAME:n=i.TextFieldType.CategoryName;break;case e.ChartConstants.FIELD_TYPE_VALUE:n=i.TextFieldType.Value;break;case e.ChartConstants.FIELD_TYPE_XVALUE:n=i.TextFieldType.XValue;break;case e.ChartConstants.FIELD_TYPE_YVALUE:n=i.TextFieldType.YValue;break;case e.ChartConstants.FIELD_TYPE_BUBBLESIZE:n=i.TextFieldType.BubbleSize;break;case e.ChartConstants.FIELD_TYPE_PERCENTAGE:n=i.TextFieldType.Percentage;break;case e.ChartConstants.FIELD_TYPE_TXLINK:n=i.TextFieldType.TxLink}return n},A.toThemeColorString=function(t,n){return p[t]+" "+parseInt(100*n+"",10)},A.fromThemeColorString=function(t){var t,n,e,i,t,e,t=t.split(" "),n=t.length,e=t[0].toLowerCase(),i=t[1],t=t[2];if("hyperlink"===e||"followedhyperlink"===e){if(1===n)return{index:p[e],tint:0};if(2===n)return{index:p[e],tint:parseInt(i,10)/100}}if(2<=n&&(e=p[e+" "+i])!==c)return 2===n?{index:e,tint:0}:3===n?{index:e,tint:parseInt(t,10)/100}:void 0},A.ToPatternType=function(t){var n=0;switch(t){case 0:n=1;break;case 1:n=2;break;case 2:n=3;break;case 3:n=4;break;case 4:n=5;break;case 5:n=6;break;case 6:n=7;break;case 7:n=8;break;case 8:n=9;break;case 9:n=10;break;case 10:n=11;break;case 11:n=12;break;case 16:n=13;break;case 17:n=14;break;case 27:n=15;break;case 28:n=16;break;case 34:n=17;break;case 52:n=18;break;case 14:n=19;break;case 15:n=20;break;case 25:n=21;break;case 26:n=22;break;case 36:n=23;break;case 45:n=24;break;case 29:n=25;break;case 30:n=26;break;case 32:n=27;break;case 31:n=28;break;case 19:n=29;break;case 18:n=30;break;case 21:n=31;break;case 20:n=32;break;case 40:n=33;break;case 37:n=34;break;case 41:n=35;break;case 35:n=36;break;case 39:n=37;break;case 53:n=38;break;case 43:n=39;break;case 42:n=40;break;case 44:n=41;break;case 46:n=42;break;case 47:n=43;break;case 48:n=44;break;case 38:n=45;break;case 49:n=46;break;case 50:n=47;break;case 51:n=48;break;case 12:n=49;break;case 13:n=50;break;case 22:n=51;break;case 23:n=52;break;case 24:n=53;break;case 33:n=54}return n},A.ToST_PresetPatternVal=function(t){var n=0;switch(t){case 2:n=1;break;case 3:n=2;break;case 4:n=3;break;case 5:n=4;break;case 6:n=5;break;case 7:n=6;break;case 8:n=7;break;case 9:n=8;break;case 10:n=9;break;case 11:n=10;break;case 12:n=11;break;case 13:n=16;break;case 14:n=17;break;case 15:n=27;break;case 16:n=28;break;case 17:n=34;break;case 18:n=52;break;case 19:n=14;break;case 20:n=15;break;case 21:n=25;break;case 22:n=26;break;case 23:n=36;break;case 24:n=45;break;case 25:n=29;break;case 26:n=30;break;case 27:n=32;break;case 28:n=31;break;case 29:n=19;break;case 30:n=18;break;case 31:n=21;break;case 32:n=20;break;case 33:n=40;break;case 34:n=37;break;case 35:n=41;break;case 36:n=35;break;case 37:n=39;break;case 38:n=53;break;case 39:n=43;break;case 40:n=42;break;case 41:n=44;break;case 42:n=46;break;case 43:n=47;break;case 44:n=48;break;case 45:n=38;break;case 46:n=49;break;case 47:n=50;break;case 48:n=51;break;case 49:n=12;break;case 50:n=13;break;case 51:n=22;break;case 52:n=23;break;case 53:n=24;break;case 54:n=33}return n},A.ConvertToTextUnderlineType=function(t){var n=i.TextUnderlineType.None;return t===i.UnderlineType.Single?n=i.TextUnderlineType.Single:t===i.UnderlineType.Double&&(n=i.TextUnderlineType.Double),n},A.ToUnderlineType=function(t){var n=i.UnderlineType.None;return t===i.TextUnderlineType.Single?n=i.UnderlineType.Single:t===i.TextUnderlineType.Double&&(n=i.UnderlineType.Double),n},A.ToLum=function(t){return 1e5-r(2e5*(1-t))},A.FromLum=function(t){return 1-(1e5-t)/2e5},A.removeEmptyArrayProperties=function(t){var n,e;for(n in t)t.hasOwnProperty(n)&&(void 0===(e=t[n])||Array.isArray(e)&&0===e.length)&&delete t[n]},A.CreateReference=function(t,n,e,i,r){return 1===i&&1===r?new g(t,n,e):new g(t,n,e,n+i-1,e+r-1)},A.presetColors={},A.Aft=T,(e.DrawingUtility=b=A).InitPresetColors(),e.pft=I,e.toKnownColor=x,e.gft=N,e.toColorSchemeIndex=k,e.mft=_},"./dist/plugins/floatingObject/drawing/drawingInterface.js":function(F,t){"use strict";var n,e,L,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,B,P,G,U,H,V,z,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E;function R(){}Object.defineProperty(t,"__esModule",{value:!0}),t.ArrowheadStyle=t.ArrowheadLength=t.GradientStyle=t.PatternType=t.GradientColorType=t.PresetTexture=t.PresetGradientType=t.FillType=t.TextureType=t.TextureFlipType=t.TextureAlignment=t.DrawingType=t.ST_TextHorzOverflowType=t.ST_TextAnchoringType=t.ReferenceKind=t.ThemeFont=t.ColorSchemeIndex=t.ST_CompoundLine=t.ST_SchemeColorVal=t.ST_SystemColorVal=t.ST_RectAlignment=t.ST_LightRigDirection=t.ST_TextTabAlignType=t.ST_TextShapeType=t.ST_TextWrappingType=t.ST_TextVerticalType=t.ST_TextVertOverflowType=t.ST_TextAutonumberScheme=t.ST_TextAlignType=t.ST_TextFontAlignType=t.ST_PresetShadowVal=t.ST_EffectContainerType=t.ST_LightRigType=t.ST_BlendMode=t.ST_TileFlipMode=t.StyleDataFlag=t.TextParagraphElementType=t.ST_PresetColorVal=t.ST_FontCollectionIndex=t.ColorFillType=t.ST_BevelPresetType=t.ST_PresetMaterialType=t.ST_PathShadeType=t.ST_BlipCompression=t.ST_LineCap=t.ST_PresetPatternVal=t.ST_TextUnderlineType=t.OOXMLFileHelper=t.ST_TextCapsType=t.ST_TextStrikeType=void 0,t.BevelType=t.ST_TimeUnit=t.PictureFormatType=t.ColorFormatStates=t.LineFormatStates=t.ST_AnchorType=t.ST_LineEndLength=t.ST_LineEndType=t.ST_LineEndWidth=t.ST_PresetLineDashVal=t.ST_PresetCameraType=t.ColorType=t.UnderlineType=t.TextFieldType=t.ReflectionType=t.TextUnderlineType=t.SolidColorType=t.ImageType=t.Placement=t.VertAlignType=t.LineType=t.LightRigDirection=t.LightRigType=t.PresetLightingDirection=t.PresetCamera=t.SoftEdgeType=t.ShadowStyle=t.ShadowType=t.PictureColorType=t.LineStyle=t.LineJoinStyle=t.LineCapStyle=t.LineDashStyle=t.ArrowheadWidth=void 0,(E=n=t.ST_TextStrikeType||(t.ST_TextStrikeType={}))[E.noStrike=0]="noStrike",E[E.sngStrike=1]="sngStrike",E[E.dblStrike=2]="dblStrike",(E=e=t.ST_TextCapsType||(t.ST_TextCapsType={}))[E.none=0]="none",E[E.small=1]="small",E[E.all=2]="all",R.HiddenScene3dUri="{31F19639-BCED-4A60-ADC4-E9642A236FB7}",R.HiddenSp3dUri="{E45631CC-5BF2-4C18-A39C-3461C7D3F71A}",R.HiddenFillUri="{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}",R.HiddenLineUri="{91240B29-F687-4F45-9708-019B960494DF}",t.OOXMLFileHelper=R,(E=i=t.ST_TextUnderlineType||(t.ST_TextUnderlineType={}))[E.none=0]="none",E[E.words=1]="words",E[E.sng=2]="sng",E[E.dbl=3]="dbl",E[E.heavy=4]="heavy",E[E.dotted=5]="dotted",E[E.dottedHeavy=6]="dottedHeavy",E[E.dash=7]="dash",E[E.dashHeavy=8]="dashHeavy",E[E.dashLong=9]="dashLong",E[E.dashLongHeavy=10]="dashLongHeavy",E[E.dotDash=11]="dotDash",E[E.dotDashHeavy=12]="dotDashHeavy",E[E.dotDotDash=13]="dotDotDash",E[E.dotDotDashHeavy=14]="dotDotDashHeavy",E[E.wavy=15]="wavy",E[E.wavyHeavy=16]="wavyHeavy",E[E.wavyDb=17]="wavyDb",(E=r=t.ST_PresetPatternVal||(t.ST_PresetPatternVal={}))[E.pct5=0]="pct5",E[E.pct10=1]="pct10",E[E.pct20=2]="pct20",E[E.pct25=3]="pct25",E[E.pct30=4]="pct30",E[E.pct40=5]="pct40",E[E.pct50=6]="pct50",E[E.pct60=7]="pct60",E[E.pct70=8]="pct70",E[E.pct75=9]="pct75",E[E.pct80=10]="pct80",E[E.pct90=11]="pct90",E[E.horz=12]="horz",E[E.vert=13]="vert",E[E.ltHorz=14]="ltHorz",E[E.ltVert=15]="ltVert",E[E.dkHorz=16]="dkHorz",E[E.dkVert=17]="dkVert",E[E.narHorz=18]="narHorz",E[E.narVert=19]="narVert",E[E.dashHorz=20]="dashHorz",E[E.dashVert=21]="dashVert",E[E.cross=22]="cross",E[E.dnDiag=23]="dnDiag",E[E.upDiag=24]="upDiag",E[E.ltDnDiag=25]="ltDnDiag",E[E.ltUpDiag=26]="ltUpDiag",E[E.dkDnDiag=27]="dkDnDiag",E[E.dkUpDiag=28]="dkUpDiag",E[E.wdDnDiag=29]="wdDnDiag",E[E.wdUpDiag=30]="wdUpDiag",E[E.dashDnDiag=31]="dashDnDiag",E[E.dashUpDiag=32]="dashUpDiag",E[E.diagCross=33]="diagCross",E[E.smCheck=34]="smCheck",E[E.lgCheck=35]="lgCheck",E[E.smGrid=36]="smGrid",E[E.lgGrid=37]="lgGrid",E[E.dotGrid=38]="dotGrid",E[E.smConfetti=39]="smConfetti",E[E.lgConfetti=40]="lgConfetti",E[E.horzBrick=41]="horzBrick",E[E.diagBrick=42]="diagBrick",E[E.solidDmnd=43]="solidDmnd",E[E.openDmnd=44]="openDmnd",E[E.dotDmnd=45]="dotDmnd",E[E.plaid=46]="plaid",E[E.sphere=47]="sphere",E[E.weave=48]="weave",E[E.divot=49]="divot",E[E.shingle=50]="shingle",E[E.wave=51]="wave",E[E.trellis=52]="trellis",E[E.zigZag=53]="zigZag",(E=o=t.ST_LineCap||(t.ST_LineCap={}))[E.rnd=0]="rnd",E[E.sq=1]="sq",E[E.flat=2]="flat",(E=a=t.ST_BlipCompression||(t.ST_BlipCompression={}))[E.email=0]="email",E[E.screen=1]="screen",E[E.print=2]="print",E[E.hqprint=3]="hqprint",E[E.none=4]="none",(E=u=t.ST_PathShadeType||(t.ST_PathShadeType={}))[E.shape=0]="shape",E[E.circle=1]="circle",E[E.rect=2]="rect",(E=s=t.ST_PresetMaterialType||(t.ST_PresetMaterialType={}))[E.legacyMatte=0]="legacyMatte",E[E.legacyPlastic=1]="legacyPlastic",E[E.legacyMetal=2]="legacyMetal",E[E.legacyWireframe=3]="legacyWireframe",E[E.matte=4]="matte",E[E.plastic=5]="plastic",E[E.metal=6]="metal",E[E.warmMatte=7]="warmMatte",E[E.translucentPowder=8]="translucentPowder",E[E.powder=9]="powder",E[E.dkEdge=10]="dkEdge",E[E.softEdge=11]="softEdge",E[E.clear=12]="clear",E[E.flat=13]="flat",E[E.softmetal=14]="softmetal",(E=c=t.ST_BevelPresetType||(t.ST_BevelPresetType={}))[E.relaxedInset=0]="relaxedInset",E[E.circle=1]="circle",E[E.slope=2]="slope",E[E.cross=3]="cross",E[E.angle=4]="angle",E[E.softRound=5]="softRound",E[E.convex=6]="convex",E[E.coolSlant=7]="coolSlant",E[E.divot=8]="divot",E[E.riblet=9]="riblet",E[E.hardEdge=10]="hardEdge",E[E.artDeco=11]="artDeco",(E=f=t.ColorFillType||(t.ColorFillType={}))[E.SolidColorFillProperties=0]="SolidColorFillProperties",E[E.PatternFillProperties=1]="PatternFillProperties",E[E.GradientFillProperties=2]="GradientFillProperties",E[E.BlipFillProperties=3]="BlipFillProperties",E[E.GroupFillProperties=4]="GroupFillProperties",E[E.NoFillProperties=5]="NoFillProperties",(E=l=t.ST_FontCollectionIndex||(t.ST_FontCollectionIndex={}))[E.major=0]="major",E[E.minor=1]="minor",E[E.none=2]="none",(E=h=t.ST_PresetColorVal||(t.ST_PresetColorVal={}))[E.aliceBlue=0]="aliceBlue",E[E.antiqueWhite=1]="antiqueWhite",E[E.aqua=2]="aqua",E[E.aquamarine=3]="aquamarine",E[E.azure=4]="azure",E[E.beige=5]="beige",E[E.bisque=6]="bisque",E[E.black=7]="black",E[E.blanchedAlmond=8]="blanchedAlmond",E[E.blue=9]="blue",E[E.blueViolet=10]="blueViolet",E[E.brown=11]="brown",E[E.burlyWood=12]="burlyWood",E[E.cadetBlue=13]="cadetBlue",E[E.chartreuse=14]="chartreuse",E[E.chocolate=15]="chocolate",E[E.coral=16]="coral",E[E.cornflowerBlue=17]="cornflowerBlue",E[E.cornsilk=18]="cornsilk",E[E.crimson=19]="crimson",E[E.cyan=20]="cyan",E[E.darkBlue=21]="darkBlue",E[E.darkCyan=22]="darkCyan",E[E.darkGoldenrod=23]="darkGoldenrod",E[E.darkGray=24]="darkGray",E[E.darkGreen=25]="darkGreen",E[E.darkGrey=26]="darkGrey",E[E.darkKhaki=27]="darkKhaki",E[E.darkMagenta=28]="darkMagenta",E[E.darkOliveGreen=29]="darkOliveGreen",E[E.darkOrange=30]="darkOrange",E[E.darkOrchid=31]="darkOrchid",E[E.darkRed=32]="darkRed",E[E.darkSalmon=33]="darkSalmon",E[E.darkSeaGreen=34]="darkSeaGreen",E[E.darkSlateBlue=35]="darkSlateBlue",E[E.darkSlateGray=36]="darkSlateGray",E[E.darkSlateGrey=37]="darkSlateGrey",E[E.darkTurquoise=38]="darkTurquoise",E[E.darkViolet=39]="darkViolet",E[E.deepPink=40]="deepPink",E[E.deepSkyBlue=41]="deepSkyBlue",E[E.dimGray=42]="dimGray",E[E.dimGrey=43]="dimGrey",E[E.dkBlue=44]="dkBlue",E[E.dkCyan=45]="dkCyan",E[E.dkGoldenrod=46]="dkGoldenrod",E[E.dkGray=47]="dkGray",E[E.dkGreen=48]="dkGreen",E[E.dkGrey=49]="dkGrey",E[E.dkKhaki=50]="dkKhaki",E[E.dkMagenta=51]="dkMagenta",E[E.dkOliveGreen=52]="dkOliveGreen",E[E.dkOrange=53]="dkOrange",E[E.dkOrchid=54]="dkOrchid",E[E.dkRed=55]="dkRed",E[E.dkSalmon=56]="dkSalmon",E[E.dkSeaGreen=57]="dkSeaGreen",E[E.dkSlateBlue=58]="dkSlateBlue",E[E.dkSlateGray=59]="dkSlateGray",E[E.dkSlateGrey=60]="dkSlateGrey",E[E.dkTurquoise=61]="dkTurquoise",E[E.dkViolet=62]="dkViolet",E[E.dodgerBlue=63]="dodgerBlue",E[E.firebrick=64]="firebrick",E[E.floralWhite=65]="floralWhite",E[E.forestGreen=66]="forestGreen",E[E.fuchsia=67]="fuchsia",E[E.gainsboro=68]="gainsboro",E[E.ghostWhite=69]="ghostWhite",E[E.gold=70]="gold",E[E.goldenrod=71]="goldenrod",E[E.gray=72]="gray",E[E.green=73]="green",E[E.greenYellow=74]="greenYellow",E[E.grey=75]="grey",E[E.honeydew=76]="honeydew",E[E.hotPink=77]="hotPink",E[E.indianRed=78]="indianRed",E[E.indigo=79]="indigo",E[E.ivory=80]="ivory",E[E.khaki=81]="khaki",E[E.lavender=82]="lavender",E[E.lavenderBlush=83]="lavenderBlush",E[E.lawnGreen=84]="lawnGreen",E[E.lemonChiffon=85]="lemonChiffon",E[E.lightBlue=86]="lightBlue",E[E.lightCoral=87]="lightCoral",E[E.lightCyan=88]="lightCyan",E[E.lightGoldenrodYellow=89]="lightGoldenrodYellow",E[E.lightGray=90]="lightGray",E[E.lightGreen=91]="lightGreen",E[E.lightGrey=92]="lightGrey",E[E.lightPink=93]="lightPink",E[E.lightSalmon=94]="lightSalmon",E[E.lightSeaGreen=95]="lightSeaGreen",E[E.lightSkyBlue=96]="lightSkyBlue",E[E.lightSlateGray=97]="lightSlateGray",E[E.lightSlateGrey=98]="lightSlateGrey",E[E.lightSteelBlue=99]="lightSteelBlue",E[E.lightYellow=100]="lightYellow",E[E.lime=101]="lime",E[E.limeGreen=102]="limeGreen",E[E.linen=103]="linen",E[E.ltBlue=104]="ltBlue",E[E.ltCoral=105]="ltCoral",E[E.ltCyan=106]="ltCyan",E[E.ltGoldenrodYellow=107]="ltGoldenrodYellow",E[E.ltGray=108]="ltGray",E[E.ltGreen=109]="ltGreen",E[E.ltGrey=110]="ltGrey",E[E.ltPink=111]="ltPink",E[E.ltSalmon=112]="ltSalmon",E[E.ltSeaGreen=113]="ltSeaGreen",E[E.ltSkyBlue=114]="ltSkyBlue",E[E.ltSlateGray=115]="ltSlateGray",E[E.ltSlateGrey=116]="ltSlateGrey",E[E.ltSteelBlue=117]="ltSteelBlue",E[E.ltYellow=118]="ltYellow",E[E.magenta=119]="magenta",E[E.maroon=120]="maroon",E[E.medAquamarine=121]="medAquamarine",E[E.medBlue=122]="medBlue",E[E.mediumAquamarine=123]="mediumAquamarine",E[E.mediumBlue=124]="mediumBlue",E[E.mediumOrchid=125]="mediumOrchid",E[E.mediumPurple=126]="mediumPurple",E[E.mediumSeaGreen=127]="mediumSeaGreen",E[E.mediumSlateBlue=128]="mediumSlateBlue",E[E.mediumSpringGreen=129]="mediumSpringGreen",E[E.mediumTurquoise=130]="mediumTurquoise",E[E.mediumVioletRed=131]="mediumVioletRed",E[E.medOrchid=132]="medOrchid",E[E.medPurple=133]="medPurple",E[E.medSeaGreen=134]="medSeaGreen",E[E.medSlateBlue=135]="medSlateBlue",E[E.medSpringGreen=136]="medSpringGreen",E[E.medTurquoise=137]="medTurquoise",E[E.medVioletRed=138]="medVioletRed",E[E.midnightBlue=139]="midnightBlue",E[E.mintCream=140]="mintCream",E[E.mistyRose=141]="mistyRose",E[E.moccasin=142]="moccasin",E[E.navajoWhite=143]="navajoWhite",E[E.navy=144]="navy",E[E.oldLace=145]="oldLace",E[E.olive=146]="olive",E[E.oliveDrab=147]="oliveDrab",E[E.orange=148]="orange",E[E.orangeRed=149]="orangeRed",E[E.orchid=150]="orchid",E[E.paleGoldenrod=151]="paleGoldenrod",E[E.paleGreen=152]="paleGreen",E[E.paleTurquoise=153]="paleTurquoise",E[E.paleVioletRed=154]="paleVioletRed",E[E.papayaWhip=155]="papayaWhip",E[E.peachPuff=156]="peachPuff",E[E.peru=157]="peru",E[E.pink=158]="pink",E[E.plum=159]="plum",E[E.powderBlue=160]="powderBlue",E[E.purple=161]="purple",E[E.red=162]="red",E[E.rosyBrown=163]="rosyBrown",E[E.royalBlue=164]="royalBlue",E[E.saddleBrown=165]="saddleBrown",E[E.salmon=166]="salmon",E[E.sandyBrown=167]="sandyBrown",E[E.seaGreen=168]="seaGreen",E[E.seaShell=169]="seaShell",E[E.sienna=170]="sienna",E[E.silver=171]="silver",E[E.skyBlue=172]="skyBlue",E[E.slateBlue=173]="slateBlue",E[E.slateGray=174]="slateGray",E[E.slateGrey=175]="slateGrey",E[E.snow=176]="snow",E[E.springGreen=177]="springGreen",E[E.steelBlue=178]="steelBlue",E[E.tan=179]="tan",E[E.teal=180]="teal",E[E.thistle=181]="thistle",E[E.tomato=182]="tomato",E[E.turquoise=183]="turquoise",E[E.violet=184]="violet",E[E.wheat=185]="wheat",E[E.white=186]="white",E[E.whiteSmoke=187]="whiteSmoke",E[E.yellow=188]="yellow",E[E.yellowGreen=189]="yellowGreen",(E=d=t.TextParagraphElementType||(t.TextParagraphElementType={}))[E.RegularTextRun=0]="RegularTextRun",E[E.TextLineBreak=1]="TextLineBreak",E[E.TextField=2]="TextField",(E=v=t.StyleDataFlag||(t.StyleDataFlag={}))[E.None=0]="None",E[E.Font=1]="Font",E[E.Fill=2]="Fill",E[E.Border=4]="Border",E[E.Alignment=8]="Alignment",E[E.Protection=16]="Protection",E[E.FormatCode=32]="FormatCode",E[E.All=63]="All",(E=m=t.ST_TileFlipMode||(t.ST_TileFlipMode={}))[E.none=0]="none",E[E.x=1]="x",E[E.y=2]="y",E[E.xy=3]="xy",(E=g=t.ST_BlendMode||(t.ST_BlendMode={}))[E.over=0]="over",E[E.mult=1]="mult",E[E.screen=2]="screen",E[E.darken=3]="darken",E[E.lighten=4]="lighten",(E=p=t.ST_LightRigType||(t.ST_LightRigType={}))[E.legacyFlat1=0]="legacyFlat1",E[E.legacyFlat2=1]="legacyFlat2",E[E.legacyFlat3=2]="legacyFlat3",E[E.legacyFlat4=3]="legacyFlat4",E[E.legacyNormal1=4]="legacyNormal1",E[E.legacyNormal2=5]="legacyNormal2",E[E.legacyNormal3=6]="legacyNormal3",E[E.legacyNormal4=7]="legacyNormal4",E[E.legacyHarsh1=8]="legacyHarsh1",E[E.legacyHarsh2=9]="legacyHarsh2",E[E.legacyHarsh3=10]="legacyHarsh3",E[E.legacyHarsh4=11]="legacyHarsh4",E[E.threePt=12]="threePt",E[E.balanced=13]="balanced",E[E.soft=14]="soft",E[E.harsh=15]="harsh",E[E.flood=16]="flood",E[E.contrasting=17]="contrasting",E[E.morning=18]="morning",E[E.sunrise=19]="sunrise",E[E.sunset=20]="sunset",E[E.chilly=21]="chilly",E[E.freezing=22]="freezing",E[E.flat=23]="flat",E[E.twoPt=24]="twoPt",E[E.glow=25]="glow",E[E.brightRoom=26]="brightRoom",(E=b=t.ST_EffectContainerType||(t.ST_EffectContainerType={}))[E.sib=0]="sib",E[E.tree=1]="tree",(E=w=t.ST_PresetShadowVal||(t.ST_PresetShadowVal={}))[E.shdw1=0]="shdw1",E[E.shdw2=1]="shdw2",E[E.shdw3=2]="shdw3",E[E.shdw4=3]="shdw4",E[E.shdw5=4]="shdw5",E[E.shdw6=5]="shdw6",E[E.shdw7=6]="shdw7",E[E.shdw8=7]="shdw8",E[E.shdw9=8]="shdw9",E[E.shdw10=9]="shdw10",E[E.shdw11=10]="shdw11",E[E.shdw12=11]="shdw12",E[E.shdw13=12]="shdw13",E[E.shdw14=13]="shdw14",E[E.shdw15=14]="shdw15",E[E.shdw16=15]="shdw16",E[E.shdw17=16]="shdw17",E[E.shdw18=17]="shdw18",E[E.shdw19=18]="shdw19",E[E.shdw20=19]="shdw20",(E=y=t.ST_TextFontAlignType||(t.ST_TextFontAlignType={}))[E.auto=0]="auto",E[E.t=1]="t",E[E.ctr=2]="ctr",E[E.base=3]="base",E[E.b=4]="b",(E=M=t.ST_TextAlignType||(t.ST_TextAlignType={}))[E.l=0]="l",E[E.ctr=1]="ctr",E[E.r=2]="r",E[E.just=3]="just",E[E.justLow=4]="justLow",E[E.dist=5]="dist",E[E.thaiDist=6]="thaiDist",(E=C=t.ST_TextAutonumberScheme||(t.ST_TextAutonumberScheme={}))[E.alphaLcParenBoth=0]="alphaLcParenBoth",E[E.alphaUcParenBoth=1]="alphaUcParenBoth",E[E.alphaLcParenR=2]="alphaLcParenR",E[E.alphaUcParenR=3]="alphaUcParenR",E[E.alphaLcPeriod=4]="alphaLcPeriod",E[E.alphaUcPeriod=5]="alphaUcPeriod",E[E.arabicParenBoth=6]="arabicParenBoth",E[E.arabicParenR=7]="arabicParenR",E[E.arabicPeriod=8]="arabicPeriod",E[E.arabicPlain=9]="arabicPlain",E[E.romanLcParenBoth=10]="romanLcParenBoth",E[E.romanUcParenBoth=11]="romanUcParenBoth",E[E.romanLcParenR=12]="romanLcParenR",E[E.romanUcParenR=13]="romanUcParenR",E[E.romanLcPeriod=14]="romanLcPeriod",E[E.romanUcPeriod=15]="romanUcPeriod",E[E.circleNumDbPlain=16]="circleNumDbPlain",E[E.circleNumWdBlackPlain=17]="circleNumWdBlackPlain",E[E.circleNumWdWhitePlain=18]="circleNumWdWhitePlain",E[E.arabicDbPeriod=19]="arabicDbPeriod",E[E.arabicDbPlain=20]="arabicDbPlain",E[E.ea1ChsPeriod=21]="ea1ChsPeriod",E[E.ea1ChsPlain=22]="ea1ChsPlain",E[E.ea1ChtPeriod=23]="ea1ChtPeriod",E[E.ea1ChtPlain=24]="ea1ChtPlain",E[E.ea1JpnChsDbPeriod=25]="ea1JpnChsDbPeriod",E[E.ea1JpnKorPlain=26]="ea1JpnKorPlain",E[E.ea1JpnKorPeriod=27]="ea1JpnKorPeriod",E[E.arabic1Minus=28]="arabic1Minus",E[E.arabic2Minus=29]="arabic2Minus",E[E.hebrew2Minus=30]="hebrew2Minus",E[E.thaiAlphaPeriod=31]="thaiAlphaPeriod",E[E.thaiAlphaParenR=32]="thaiAlphaParenR",E[E.thaiAlphaParenBoth=33]="thaiAlphaParenBoth",E[E.thaiNumPeriod=34]="thaiNumPeriod",E[E.thaiNumParenR=35]="thaiNumParenR",E[E.thaiNumParenBoth=36]="thaiNumParenBoth",E[E.hindiAlphaPeriod=37]="hindiAlphaPeriod",E[E.hindiNumPeriod=38]="hindiNumPeriod",E[E.hindiNumParenR=39]="hindiNumParenR",E[E.hindiAlpha1Period=40]="hindiAlpha1Period",(E=S=t.ST_TextVertOverflowType||(t.ST_TextVertOverflowType={}))[E.overflow=0]="overflow",E[E.ellipsis=1]="ellipsis",E[E.clip=2]="clip",(E=T=t.ST_TextVerticalType||(t.ST_TextVerticalType={}))[E.horz=0]="horz",E[E.vert=1]="vert",E[E.vert270=2]="vert270",E[E.wordArtVert=3]="wordArtVert",E[E.eaVert=4]="eaVert",E[E.mongolianVert=5]="mongolianVert",E[E.wordArtVertRtl=6]="wordArtVertRtl",(E=A=t.ST_TextWrappingType||(t.ST_TextWrappingType={}))[E.none=0]="none",E[E.square=1]="square",(E=I=t.ST_TextShapeType||(t.ST_TextShapeType={}))[E.textNoShape=0]="textNoShape",E[E.textPlain=1]="textPlain",E[E.textStop=2]="textStop",E[E.textTriangle=3]="textTriangle",E[E.textTriangleInverted=4]="textTriangleInverted",E[E.textChevron=5]="textChevron",E[E.textChevronInverted=6]="textChevronInverted",E[E.textRingInside=7]="textRingInside",E[E.textRingOutside=8]="textRingOutside",E[E.textArchUp=9]="textArchUp",E[E.textArchDown=10]="textArchDown",E[E.textCircle=11]="textCircle",E[E.textButton=12]="textButton",E[E.textArchUpPour=13]="textArchUpPour",E[E.textArchDownPour=14]="textArchDownPour",E[E.textCirclePour=15]="textCirclePour",E[E.textButtonPour=16]="textButtonPour",E[E.textCurveUp=17]="textCurveUp",E[E.textCurveDown=18]="textCurveDown",E[E.textCanUp=19]="textCanUp",E[E.textCanDown=20]="textCanDown",E[E.textWave1=21]="textWave1",E[E.textWave2=22]="textWave2",E[E.textDoubleWave1=23]="textDoubleWave1",E[E.textWave4=24]="textWave4",E[E.textInflate=25]="textInflate",E[E.textDeflate=26]="textDeflate",E[E.textInflateBottom=27]="textInflateBottom",E[E.textDeflateBottom=28]="textDeflateBottom",E[E.textInflateTop=29]="textInflateTop",E[E.textDeflateTop=30]="textDeflateTop",E[E.textDeflateInflate=31]="textDeflateInflate",E[E.textDeflateInflateDeflate=32]="textDeflateInflateDeflate",E[E.textFadeRight=33]="textFadeRight",E[E.textFadeLeft=34]="textFadeLeft",E[E.textFadeUp=35]="textFadeUp",E[E.textFadeDown=36]="textFadeDown",E[E.textSlantUp=37]="textSlantUp",E[E.textSlantDown=38]="textSlantDown",E[E.textCascadeUp=39]="textCascadeUp",E[E.textCascadeDown=40]="textCascadeDown",(E=x=t.ST_TextTabAlignType||(t.ST_TextTabAlignType={}))[E.l=0]="l",E[E.ctr=1]="ctr",E[E.r=2]="r",E[E.dec=3]="dec",(E=N=t.ST_LightRigDirection||(t.ST_LightRigDirection={}))[E.tl=0]="tl",E[E.t=1]="t",E[E.tr=2]="tr",E[E.l=3]="l",E[E.r=4]="r",E[E.bl=5]="bl",E[E.b=6]="b",E[E.br=7]="br",(E=k=t.ST_RectAlignment||(t.ST_RectAlignment={}))[E.tl=0]="tl",E[E.t=1]="t",E[E.tr=2]="tr",E[E.l=3]="l",E[E.ctr=4]="ctr",E[E.r=5]="r",E[E.bl=6]="bl",E[E.b=7]="b",E[E.br=8]="br",(E=_=t.ST_SystemColorVal||(t.ST_SystemColorVal={}))[E.scrollBar=0]="scrollBar",E[E.background=1]="background",E[E.activeCaption=2]="activeCaption",E[E.inactiveCaption=3]="inactiveCaption",E[E.menu=4]="menu",E[E.window=5]="window",E[E.windowFrame=6]="windowFrame",E[E.menuText=7]="menuText",E[E.windowText=8]="windowText",E[E.captionText=9]="captionText",E[E.activeBorder=10]="activeBorder",E[E.inactiveBorder=11]="inactiveBorder",E[E.appWorkspace=12]="appWorkspace",E[E.highlight=13]="highlight",E[E.highlightText=14]="highlightText",E[E.btnFace=15]="btnFace",E[E.btnShadow=16]="btnShadow",E[E.grayText=17]="grayText",E[E.btnText=18]="btnText",E[E.inactiveCaptionText=19]="inactiveCaptionText",E[E.btnHighlight=20]="btnHighlight",E[E.Item3dDkShadow=21]="Item3dDkShadow",E[E.Item3dLight=22]="Item3dLight",E[E.infoText=23]="infoText",E[E.infoBk=24]="infoBk",E[E.hotLight=25]="hotLight",E[E.gradientActiveCaption=26]="gradientActiveCaption",E[E.gradientInactiveCaption=27]="gradientInactiveCaption",E[E.menuHighlight=28]="menuHighlight",E[E.menuBar=29]="menuBar",(E=D=t.ST_SchemeColorVal||(t.ST_SchemeColorVal={}))[E.bg1=0]="bg1",E[E.tx1=1]="tx1",E[E.bg2=2]="bg2",E[E.tx2=3]="tx2",E[E.accent1=4]="accent1",E[E.accent2=5]="accent2",E[E.accent3=6]="accent3",E[E.accent4=7]="accent4",E[E.accent5=8]="accent5",E[E.accent6=9]="accent6",E[E.hlink=10]="hlink",E[E.folHlink=11]="folHlink",E[E.phClr=12]="phClr",E[E.dk1=13]="dk1",E[E.lt1=14]="lt1",E[E.dk2=15]="dk2",E[E.lt2=16]="lt2",(E=j=t.ST_CompoundLine||(t.ST_CompoundLine={}))[E.sng=0]="sng",E[E.dbl=1]="dbl",E[E.thickThin=2]="thickThin",E[E.thinThick=3]="thinThick",E[E.tri=4]="tri",(E=O=t.ColorSchemeIndex||(t.ColorSchemeIndex={}))[E.None=-4142]="None",E[E.LT1=0]="LT1",E[E.DK1=1]="DK1",E[E.LT2=2]="LT2",E[E.DK2=3]="DK2",E[E.Accent1=4]="Accent1",E[E.Accent2=5]="Accent2",E[E.Accent3=6]="Accent3",E[E.Accent4=7]="Accent4",E[E.Accent5=8]="Accent5",E[E.Accent6=9]="Accent6",E[E.Hlink=10]="Hlink",E[E.FolHlink=11]="FolHlink",(E=B=t.ThemeFont||(t.ThemeFont={}))[E.None=0]="None",E[E.Major=1]="Major",E[E.Minor=2]="Minor",(E=P=t.ReferenceKind||(t.ReferenceKind={}))[E.Empty=0]="Empty",E[E.Row=1]="Row",E[E.Column=2]="Column",E[E.RowIsRelative=4]="RowIsRelative",E[E.ColumnIsRelative=8]="ColumnIsRelative",E[E.LastRowIsRelative=16]="LastRowIsRelative",E[E.LastColumnIsRelative=32]="LastColumnIsRelative",E[E.Range=64]="Range",E[E.Error=128]="Error",(E=G=t.ST_TextAnchoringType||(t.ST_TextAnchoringType={}))[E.t=0]="t",E[E.ctr=1]="ctr",E[E.b=2]="b",E[E.just=3]="just",E[E.dist=4]="dist",(E=U=t.ST_TextHorzOverflowType||(t.ST_TextHorzOverflowType={}))[E.overflow=0]="overflow",E[E.clip=1]="clip",(E=H=t.DrawingType||(t.DrawingType={}))[E.Shape=0]="Shape",E[E.Chart=1]="Chart",E[E.Picture=2]="Picture",E[E.Connector=3]="Connector",E[E.GroupShape=4]="GroupShape",(E=V=t.TextureAlignment||(t.TextureAlignment={}))[E.TextureTopLeft=0]="TextureTopLeft",E[E.TextureTop=1]="TextureTop",E[E.TextureTopRight=2]="TextureTopRight",E[E.TextureLeft=3]="TextureLeft",E[E.TextureCenter=4]="TextureCenter",E[E.TextureRight=5]="TextureRight",E[E.TextureBottomLeft=6]="TextureBottomLeft",E[E.TextureBottom=7]="TextureBottom",E[E.TextureBottomRight=8]="TextureBottomRight",(E=z=t.TextureFlipType||(t.TextureFlipType={}))[E.None=0]="None",E[E.Horizontal=1]="Horizontal",E[E.Vertical=2]="Vertical",E[E.Both=3]="Both",(E=Y=t.TextureType||(t.TextureType={}))[E.TextureTypeNone=0]="TextureTypeNone",E[E.TexturePreset=1]="TexturePreset",E[E.TextureUserDefined=2]="TextureUserDefined",(E=Z=t.FillType||(t.FillType={}))[E.Solid=0]="Solid",E[E.Patterned=1]="Patterned",E[E.Gradient=2]="Gradient",E[E.Textured=3]="Textured",E[E.Background=4]="Background",E[E.Picture=5]="Picture",E[E.Group=6]="Group",(E=W=t.PresetGradientType||(t.PresetGradientType={}))[E.GradientEarlySunset=0]="GradientEarlySunset",E[E.GradientLateSunset=1]="GradientLateSunset",E[E.GradientNightfall=2]="GradientNightfall",E[E.GradientDaybreak=3]="GradientDaybreak",E[E.GradientHorizon=4]="GradientHorizon",E[E.GradientDesert=5]="GradientDesert",E[E.GradientOcean=6]="GradientOcean",E[E.GradientCalmWater=7]="GradientCalmWater",E[E.GradientFire=8]="GradientFire",E[E.GradientFog=9]="GradientFog",E[E.GradientMoss=10]="GradientMoss",E[E.GradientPeacock=11]="GradientPeacock",E[E.GradientWheat=12]="GradientWheat",E[E.GradientParchment=13]="GradientParchment",E[E.GradientMahogany=14]="GradientMahogany",E[E.GradientRainbow=15]="GradientRainbow",E[E.GradientRainbowII=16]="GradientRainbowII",E[E.GradientGold=17]="GradientGold",E[E.GradientGoldII=18]="GradientGoldII",E[E.GradientBrass=19]="GradientBrass",E[E.GradientChrome=20]="GradientChrome",E[E.GradientChromeII=21]="GradientChromeII",E[E.GradientSilver=22]="GradientSilver",E[E.GradientSapphire=23]="GradientSapphire",(E=Q=t.PresetTexture||(t.PresetTexture={}))[E.TexturePapyrus=0]="TexturePapyrus",E[E.TextureCanvas=1]="TextureCanvas",E[E.TextureDenim=2]="TextureDenim",E[E.TextureWovenMat=3]="TextureWovenMat",E[E.TextureWaterDroplets=4]="TextureWaterDroplets",E[E.TexturePaperBag=5]="TexturePaperBag",E[E.TextureFishFossil=6]="TextureFishFossil",E[E.TextureSand=7]="TextureSand",E[E.TextureGreenMarble=8]="TextureGreenMarble",E[E.TextureWhiteMarble=9]="TextureWhiteMarble",E[E.TextureBrownMarble=10]="TextureBrownMarble",E[E.TextureGranite=11]="TextureGranite",E[E.TextureNewsprint=12]="TextureNewsprint",E[E.TextureRecycledPaper=13]="TextureRecycledPaper",E[E.TextureParchment=14]="TextureParchment",E[E.TextureStationery=15]="TextureStationery",E[E.TextureBlueTissuePaper=16]="TextureBlueTissuePaper",E[E.TexturePinkTissuePaper=17]="TexturePinkTissuePaper",E[E.TexturePurpleMesh=18]="TexturePurpleMesh",E[E.TextureBouquet=19]="TextureBouquet",E[E.TextureCork=20]="TextureCork",E[E.TextureWalnut=21]="TextureWalnut",E[E.TextureOak=22]="TextureOak",E[E.TextureMediumWood=23]="TextureMediumWood",(E=J=t.GradientColorType||(t.GradientColorType={}))[E.GradientColorNone=0]="GradientColorNone",E[E.GradientOneColor=1]="GradientOneColor",E[E.GradientTwoColors=2]="GradientTwoColors",E[E.GradientPresetColors=3]="GradientPresetColors",E[E.GradientMultiColor=4]="GradientMultiColor",(E=K=t.PatternType||(t.PatternType={}))[E.none=0]="none",E[E.dottedPercent5=1]="dottedPercent5",E[E.dottedPercent10=2]="dottedPercent10",E[E.dottedPercent20=3]="dottedPercent20",E[E.dottedPercent25=4]="dottedPercent25",E[E.dottedPercent30=5]="dottedPercent30",E[E.dottedPercent40=6]="dottedPercent40",E[E.dottedPercent50=7]="dottedPercent50",E[E.dottedPercent60=8]="dottedPercent60",E[E.dottedPercent70=9]="dottedPercent70",E[E.dottedPercent75=10]="dottedPercent75",E[E.dottedPercent80=11]="dottedPercent80",E[E.dottedPercent90=12]="dottedPercent90",E[E.darkHorizontal=13]="darkHorizontal",E[E.darkVertical=14]="darkVertical",E[E.darkDownwardDiagonal=15]="darkDownwardDiagonal",E[E.darkUpwardDiagonal=16]="darkUpwardDiagonal",E[E.smallCheckerBoard=17]="smallCheckerBoard",E[E.trellis=18]="trellis",E[E.lightHorizontal=19]="lightHorizontal",E[E.lightVertical=20]="lightVertical",E[E.lightDownwardDiagonal=21]="lightDownwardDiagonal",E[E.lightUpwardDiagonal=22]="lightUpwardDiagonal",E[E.smallGrid=23]="smallGrid",E[E.dottedDiamond=24]="dottedDiamond",E[E.wideDownwardDiagonal=25]="wideDownwardDiagonal",E[E.wideUpwardDiagonal=26]="wideUpwardDiagonal",E[E.dashedUpwardDiagonal=27]="dashedUpwardDiagonal",E[E.dashedDownwardDiagonal=28]="dashedDownwardDiagonal",E[E.narrowVertical=29]="narrowVertical",E[E.narrowHorizontal=30]="narrowHorizontal",E[E.dashedVertical=31]="dashedVertical",E[E.dashedHorizontal=32]="dashedHorizontal",E[E.largeConfetti=33]="largeConfetti",E[E.largeGrid=34]="largeGrid",E[E.horizontalBrick=35]="horizontalBrick",E[E.largeCheckerBoard=36]="largeCheckerBoard",E[E.smallConfetti=37]="smallConfetti",E[E.zigZag=38]="zigZag",E[E.solidDiamond=39]="solidDiamond",E[E.diagonalBrick=40]="diagonalBrick",E[E.outlinedDiamond=41]="outlinedDiamond",E[E.plaid=42]="plaid",E[E.sphere=43]="sphere",E[E.weave=44]="weave",E[E.dottedGrid=45]="dottedGrid",E[E.divot=46]="divot",E[E.shingle=47]="shingle",E[E.wave=48]="wave",(E=X=t.GradientStyle||(t.GradientStyle={}))[E.GradientHorizontal=0]="GradientHorizontal",E[E.GradientVertical=1]="GradientVertical",E[E.GradientDiagonalUp=2]="GradientDiagonalUp",E[E.GradientDiagonalDown=3]="GradientDiagonalDown",E[E.GradientFromCorner=4]="GradientFromCorner",E[E.GradientFromTitle=5]="GradientFromTitle",E[E.GradientFromCenter=6]="GradientFromCenter",E[E.GradientTopSpotlight=7]="GradientTopSpotlight",E[E.GradientBottomSpotlight=8]="GradientBottomSpotlight",(E=q=t.ArrowheadLength||(t.ArrowheadLength={}))[E.short=0]="short",E[E.medium=1]="medium",E[E.long=2]="long",(E=$=t.ArrowheadStyle||(t.ArrowheadStyle={}))[E.none=0]="none",E[E.triangle=1]="triangle",E[E.stealth=2]="stealth",E[E.diamond=3]="diamond",E[E.oval=4]="oval",E[E.open=5]="open",(E=tt=t.ArrowheadWidth||(t.ArrowheadWidth={}))[E.narrow=0]="narrow",E[E.medium=1]="medium",E[E.wide=2]="wide",(E=nt=t.LineDashStyle||(t.LineDashStyle={}))[E.solid=0]="solid",E[E.squareDot=1]="squareDot",E[E.dash=2]="dash",E[E.longDash=3]="longDash",E[E.dashDot=4]="dashDot",E[E.longDashDot=5]="longDashDot",E[E.longDashDotDot=6]="longDashDotDot",E[E.sysDash=7]="sysDash",E[E.sysDot=8]="sysDot",E[E.sysDashDot=9]="sysDashDot",E[E.dashDotDot=10]="dashDotDot",E[E.roundDot=11]="roundDot",(E=et=t.LineCapStyle||(t.LineCapStyle={}))[E.flat=2]="flat",E[E.square=1]="square",E[E.round=0]="round",(E=it=t.LineJoinStyle||(t.LineJoinStyle={}))[E.round=0]="round",E[E.miter=1]="miter",E[E.bevel=2]="bevel",(E=rt=t.LineStyle||(t.LineStyle={}))[E.LineSingle=0]="LineSingle",E[E.LineThinThin=1]="LineThinThin",E[E.LineThinThick=2]="LineThinThick",E[E.LineThickThin=3]="LineThickThin",E[E.LineThickBetweenThin=4]="LineThickBetweenThin",(E=ot=t.PictureColorType||(t.PictureColorType={}))[E.PictureAutomatic=0]="PictureAutomatic",E[E.PictureGrayscale=1]="PictureGrayscale",E[E.PictureBlackAndWhite=2]="PictureBlackAndWhite",E[E.PictureWatermark=3]="PictureWatermark",(E=at=t.ShadowType||(t.ShadowType={}))[E.Shadow1=0]="Shadow1",E[E.Shadow2=1]="Shadow2",E[E.Shadow3=2]="Shadow3",E[E.Shadow4=3]="Shadow4",E[E.Shadow5=4]="Shadow5",E[E.Shadow6=5]="Shadow6",E[E.Shadow7=6]="Shadow7",E[E.Shadow8=7]="Shadow8",E[E.Shadow9=8]="Shadow9",E[E.Shadow10=9]="Shadow10",E[E.Shadow11=10]="Shadow11",E[E.Shadow12=11]="Shadow12",E[E.Shadow13=12]="Shadow13",E[E.Shadow14=13]="Shadow14",E[E.Shadow15=14]="Shadow15",E[E.Shadow16=15]="Shadow16",E[E.Shadow17=16]="Shadow17",E[E.Shadow18=17]="Shadow18",E[E.Shadow19=18]="Shadow19",E[E.Shadow20=19]="Shadow20",E[E.Shadow21=20]="Shadow21",E[E.Shadow22=21]="Shadow22",E[E.Shadow23=22]="Shadow23",E[E.Shadow24=23]="Shadow24",E[E.Shadow25=24]="Shadow25",E[E.Shadow26=25]="Shadow26",E[E.Shadow27=26]="Shadow27",E[E.Shadow28=27]="Shadow28",E[E.Shadow29=28]="Shadow29",E[E.Shadow30=29]="Shadow30",E[E.Shadow31=30]="Shadow31",E[E.Shadow32=31]="Shadow32",E[E.Shadow33=32]="Shadow33",E[E.Shadow34=33]="Shadow34",E[E.Shadow35=34]="Shadow35",E[E.Shadow36=35]="Shadow36",E[E.Shadow37=36]="Shadow37",E[E.Shadow38=37]="Shadow38",E[E.Shadow39=38]="Shadow39",E[E.Shadow40=39]="Shadow40",E[E.Shadow41=40]="Shadow41",E[E.Shadow42=41]="Shadow42",E[E.Shadow43=42]="Shadow43",(E=ut=t.ShadowStyle||(t.ShadowStyle={}))[E.ShadowStyleInnerShadow=0]="ShadowStyleInnerShadow",E[E.ShadowStyleOuterShadow=1]="ShadowStyleOuterShadow",(E=st=t.SoftEdgeType||(t.SoftEdgeType={}))[E.SoftEdgeTypeNone=0]="SoftEdgeTypeNone",E[E.SoftEdgeType1=1]="SoftEdgeType1",E[E.SoftEdgeType2=2]="SoftEdgeType2",E[E.SoftEdgeType3=3]="SoftEdgeType3",E[E.SoftEdgeType4=4]="SoftEdgeType4",E[E.SoftEdgeType5=5]="SoftEdgeType5",E[E.SoftEdgeType6=6]="SoftEdgeType6",(E=ct=t.PresetCamera||(t.PresetCamera={}))[E.CameraLegacyObliqueTopLeft=0]="CameraLegacyObliqueTopLeft",E[E.CameraLegacyObliqueTop=1]="CameraLegacyObliqueTop",E[E.CameraLegacyObliqueTopRight=2]="CameraLegacyObliqueTopRight",E[E.CameraLegacyObliqueLeft=3]="CameraLegacyObliqueLeft",E[E.CameraLegacyObliqueFront=4]="CameraLegacyObliqueFront",E[E.CameraLegacyObliqueRight=5]="CameraLegacyObliqueRight",E[E.CameraLegacyObliqueBottomLeft=6]="CameraLegacyObliqueBottomLeft",E[E.CameraLegacyObliqueBottom=7]="CameraLegacyObliqueBottom",E[E.CameraLegacyObliqueBottomRight=8]="CameraLegacyObliqueBottomRight",E[E.CameraLegacyPerspectiveTopLeft=9]="CameraLegacyPerspectiveTopLeft",E[E.CameraLegacyPerspectiveTop=10]="CameraLegacyPerspectiveTop",E[E.CameraLegacyPerspectiveTopRight=11]="CameraLegacyPerspectiveTopRight",E[E.CameraLegacyPerspectiveLeft=12]="CameraLegacyPerspectiveLeft",E[E.CameraLegacyPerspectiveFront=13]="CameraLegacyPerspectiveFront",E[E.CameraLegacyPerspectiveRight=14]="CameraLegacyPerspectiveRight",E[E.CameraLegacyPerspectiveBottomLeft=15]="CameraLegacyPerspectiveBottomLeft",E[E.CameraLegacyPerspectiveBottom=16]="CameraLegacyPerspectiveBottom",E[E.CameraLegacyPerspectiveBottomRight=17]="CameraLegacyPerspectiveBottomRight",E[E.CameraOrthographicFront=18]="CameraOrthographicFront",E[E.CameraIsometricTopUp=19]="CameraIsometricTopUp",E[E.CameraIsometricTopDown=20]="CameraIsometricTopDown",E[E.CameraIsometricBottomUp=21]="CameraIsometricBottomUp",E[E.CameraIsometricBottomDown=22]="CameraIsometricBottomDown",E[E.CameraIsometricLeftUp=23]="CameraIsometricLeftUp",E[E.CameraIsometricLeftDown=24]="CameraIsometricLeftDown",E[E.CameraIsometricRightUp=25]="CameraIsometricRightUp",E[E.CameraIsometricRightDown=26]="CameraIsometricRightDown",E[E.CameraIsometricOffAxis1Left=27]="CameraIsometricOffAxis1Left",E[E.CameraIsometricOffAxis1Right=28]="CameraIsometricOffAxis1Right",E[E.CameraIsometricOffAxis1Top=29]="CameraIsometricOffAxis1Top",E[E.CameraIsometricOffAxis2Left=30]="CameraIsometricOffAxis2Left",E[E.CameraIsometricOffAxis2Right=31]="CameraIsometricOffAxis2Right",E[E.CameraIsometricOffAxis2Top=32]="CameraIsometricOffAxis2Top",E[E.CameraIsometricOffAxis3Left=33]="CameraIsometricOffAxis3Left",E[E.CameraIsometricOffAxis3Right=34]="CameraIsometricOffAxis3Right",E[E.CameraIsometricOffAxis3Bottom=35]="CameraIsometricOffAxis3Bottom",E[E.CameraIsometricOffAxis4Left=36]="CameraIsometricOffAxis4Left",E[E.CameraIsometricOffAxis4Right=37]="CameraIsometricOffAxis4Right",E[E.CameraIsometricOffAxis4Bottom=38]="CameraIsometricOffAxis4Bottom",E[E.CameraObliqueTopLeft=39]="CameraObliqueTopLeft",E[E.CameraObliqueTop=40]="CameraObliqueTop",E[E.CameraObliqueTopRight=41]="CameraObliqueTopRight",E[E.CameraObliqueLeft=42]="CameraObliqueLeft",E[E.CameraObliqueRight=43]="CameraObliqueRight",E[E.CameraObliqueBottomLeft=44]="CameraObliqueBottomLeft",E[E.CameraObliqueBottom=45]="CameraObliqueBottom",E[E.CameraObliqueBottomRight=46]="CameraObliqueBottomRight",E[E.CameraPerspectiveFront=47]="CameraPerspectiveFront",E[E.CameraPerspectiveLeft=48]="CameraPerspectiveLeft",E[E.CameraPerspectiveRight=49]="CameraPerspectiveRight",E[E.CameraPerspectiveAbove=50]="CameraPerspectiveAbove",E[E.CameraPerspectiveBelow=51]="CameraPerspectiveBelow",E[E.CameraPerspectiveAboveLeftFacing=52]="CameraPerspectiveAboveLeftFacing",E[E.CameraPerspectiveAboveRightFacing=53]="CameraPerspectiveAboveRightFacing",E[E.CameraPerspectiveContrastingLeftFacing=54]="CameraPerspectiveContrastingLeftFacing",E[E.CameraPerspectiveContrastingRightFacing=55]="CameraPerspectiveContrastingRightFacing",E[E.CameraPerspectiveHeroicLeftFacing=56]="CameraPerspectiveHeroicLeftFacing",E[E.CameraPerspectiveHeroicRightFacing=57]="CameraPerspectiveHeroicRightFacing",E[E.CameraPerspectiveHeroicExtremeLeftFacing=58]="CameraPerspectiveHeroicExtremeLeftFacing",E[E.CameraPerspectiveHeroicExtremeRightFacing=59]="CameraPerspectiveHeroicExtremeRightFacing",E[E.CameraPerspectiveRelaxed=60]="CameraPerspectiveRelaxed",E[E.CameraPerspectiveRelaxedModerately=61]="CameraPerspectiveRelaxedModerately",E[E.PresetCameraNone=62]="PresetCameraNone",(E=ft=t.PresetLightingDirection||(t.PresetLightingDirection={}))[E.LightingTopLeft=0]="LightingTopLeft",E[E.LightingTop=1]="LightingTop",E[E.LightingTopRight=2]="LightingTopRight",E[E.LightingLeft=3]="LightingLeft",E[E.LightingNone=4]="LightingNone",E[E.LightingRight=5]="LightingRight",E[E.LightingBottomLeft=6]="LightingBottomLeft",E[E.LightingBottom=7]="LightingBottom",E[E.LightingBottomRight=8]="LightingBottomRight",(E=lt=t.LightRigType||(t.LightRigType={}))[E.LightRigLegacyFlat1=0]="LightRigLegacyFlat1",E[E.LightRigLegacyFlat2=1]="LightRigLegacyFlat2",E[E.LightRigLegacyFlat3=2]="LightRigLegacyFlat3",E[E.LightRigLegacyFlat4=3]="LightRigLegacyFlat4",E[E.LightRigLegacyNormal1=4]="LightRigLegacyNormal1",E[E.LightRigLegacyNormal2=5]="LightRigLegacyNormal2",E[E.LightRigLegacyNormal3=6]="LightRigLegacyNormal3",E[E.LightRigLegacyNormal4=7]="LightRigLegacyNormal4",E[E.LightRigLegacyHarsh1=8]="LightRigLegacyHarsh1",E[E.LightRigLegacyHarsh2=9]="LightRigLegacyHarsh2",E[E.LightRigLegacyHarsh3=10]="LightRigLegacyHarsh3",E[E.LightRigLegacyHarsh4=11]="LightRigLegacyHarsh4",E[E.LightRigThreePoint=12]="LightRigThreePoint",E[E.LightRigBalanced=13]="LightRigBalanced",E[E.LightRigSoft=14]="LightRigSoft",E[E.LightRigHarsh=15]="LightRigHarsh",E[E.LightRigFlood=16]="LightRigFlood",E[E.LightRigContrasting=17]="LightRigContrasting",E[E.LightRigMorning=18]="LightRigMorning",E[E.LightRigSunrise=19]="LightRigSunrise",E[E.LightRigSunset=20]="LightRigSunset",E[E.LightRigChilly=21]="LightRigChilly",E[E.LightRigFreezing=22]="LightRigFreezing",E[E.LightRigFlat=23]="LightRigFlat",E[E.LightRigTwoPoint=24]="LightRigTwoPoint",E[E.LightRigGlow=25]="LightRigGlow",E[E.LightRigBrightRoom=26]="LightRigBrightRoom",(E=ht=t.LightRigDirection||(t.LightRigDirection={}))[E.tl=0]="tl",E[E.t=1]="t",E[E.tr=2]="tr",E[E.l=3]="l",E[E.r=4]="r",E[E.bl=5]="bl",E[E.b=6]="b",E[E.br=7]="br",(E=dt=t.LineType||(t.LineType={}))[E.solid=0]="solid",E[E.dot=1]="dot",E[E.dash=2]="dash",E[E.lgDash=3]="lgDash",E[E.dashDot=4]="dashDot",E[E.lgDashDot=5]="lgDashDot",E[E.lgDashDotDot=6]="lgDashDotDot",E[E.sysDash=7]="sysDash",E[E.sysDot=8]="sysDot",E[E.sysDashDot=9]="sysDashDot",E[E.sysDashDotDot=10]="sysDashDotDot",(E=vt=t.VertAlignType||(t.VertAlignType={}))[E.Baseline=0]="Baseline",E[E.Superscript=1]="Superscript",E[E.Subscript=2]="Subscript",(E=mt=t.Placement||(t.Placement={}))[E.MoveAndSize=0]="MoveAndSize",E[E.Move=1]="Move",E[E.FreeFloating=2]="FreeFloating",(E=gt=t.ImageType||(t.ImageType={}))[E.PNG=0]="PNG",E[E.JPG=1]="JPG",E[E.JPEG=2]="JPEG",E[E.EMF=3]="EMF",(E=pt=t.SolidColorType||(t.SolidColorType={}))[E.None=0]="None",E[E.Automatic=1]="Automatic",E[E.RGB=2]="RGB",E[E.Theme=3]="Theme",(E=bt=t.TextUnderlineType||(t.TextUnderlineType={}))[E.None=0]="None",E[E.Words=1]="Words",E[E.Single=2]="Single",E[E.Double=3]="Double",E[E.Heavy=4]="Heavy",E[E.Dotted=5]="Dotted",E[E.DottedHeavy=6]="DottedHeavy",E[E.Dash=7]="Dash",E[E.DashHeavy=8]="DashHeavy",E[E.DashLong=9]="DashLong",E[E.DashLongHeavy=10]="DashLongHeavy",E[E.DotDash=11]="DotDash",E[E.DotDashHeavy=12]="DotDashHeavy",E[E.DotDotDash=13]="DotDotDash",E[E.DotDotDashHeavy=14]="DotDotDashHeavy",E[E.Wavy=15]="Wavy",E[E.WavyHeavy=16]="WavyHeavy",E[E.WavyDouble=17]="WavyDouble",(E=wt=t.ReflectionType||(t.ReflectionType={}))[E.ReflectionTypeNone=0]="ReflectionTypeNone",E[E.ReflectionType1=1]="ReflectionType1",E[E.ReflectionType2=2]="ReflectionType2",E[E.ReflectionType3=3]="ReflectionType3",E[E.ReflectionType4=4]="ReflectionType4",E[E.ReflectionType5=5]="ReflectionType5",E[E.ReflectionType6=6]="ReflectionType6",E[E.ReflectionType7=7]="ReflectionType7",E[E.ReflectionType8=8]="ReflectionType8",E[E.ReflectionType9=9]="ReflectionType9",(E=yt=t.TextFieldType||(t.TextFieldType={}))[E.CellRange=0]="CellRange",E[E.SeriesName=1]="SeriesName",E[E.CategoryName=2]="CategoryName",E[E.Value=3]="Value",E[E.XValue=4]="XValue",E[E.YValue=5]="YValue",E[E.BubbleSize=6]="BubbleSize",E[E.Percentage=7]="Percentage",E[E.TxLink=8]="TxLink",(E=Mt=t.UnderlineType||(t.UnderlineType={}))[E.None=0]="None",E[E.Single=1]="Single",E[E.Double=2]="Double",E[E.SingleAccounting=3]="SingleAccounting",E[E.DoubleAccounting=4]="DoubleAccounting",(E=Ct=t.ColorType||(t.ColorType={}))[E.None=0]="None",E[E.Auto=1]="Auto",E[E.RGB=2]="RGB",E[E.Index=3]="Index",E[E.Theme=4]="Theme",(E=St=t.ST_PresetCameraType||(t.ST_PresetCameraType={}))[E.legacyObliqueTopLeft=0]="legacyObliqueTopLeft",E[E.legacyObliqueTop=1]="legacyObliqueTop",E[E.legacyObliqueTopRight=2]="legacyObliqueTopRight",E[E.legacyObliqueLeft=3]="legacyObliqueLeft",E[E.legacyObliqueFront=4]="legacyObliqueFront",E[E.legacyObliqueRight=5]="legacyObliqueRight",E[E.legacyObliqueBottomLeft=6]="legacyObliqueBottomLeft",E[E.legacyObliqueBottom=7]="legacyObliqueBottom",E[E.legacyObliqueBottomRight=8]="legacyObliqueBottomRight",E[E.legacyPerspectiveTopLeft=9]="legacyPerspectiveTopLeft",E[E.legacyPerspectiveTop=10]="legacyPerspectiveTop",E[E.legacyPerspectiveTopRight=11]="legacyPerspectiveTopRight",E[E.legacyPerspectiveLeft=12]="legacyPerspectiveLeft",E[E.legacyPerspectiveFront=13]="legacyPerspectiveFront",E[E.legacyPerspectiveRight=14]="legacyPerspectiveRight",E[E.legacyPerspectiveBottomLeft=15]="legacyPerspectiveBottomLeft",E[E.legacyPerspectiveBottom=16]="legacyPerspectiveBottom",E[E.legacyPerspectiveBottomRight=17]="legacyPerspectiveBottomRight",E[E.orthographicFront=18]="orthographicFront",E[E.isometricTopUp=19]="isometricTopUp",E[E.isometricTopDown=20]="isometricTopDown",E[E.isometricBottomUp=21]="isometricBottomUp",E[E.isometricBottomDown=22]="isometricBottomDown",E[E.isometricLeftUp=23]="isometricLeftUp",E[E.isometricLeftDown=24]="isometricLeftDown",E[E.isometricRightUp=25]="isometricRightUp",E[E.isometricRightDown=26]="isometricRightDown",E[E.isometricOffAxis1Left=27]="isometricOffAxis1Left",E[E.isometricOffAxis1Right=28]="isometricOffAxis1Right",E[E.isometricOffAxis1Top=29]="isometricOffAxis1Top",E[E.isometricOffAxis2Left=30]="isometricOffAxis2Left",E[E.isometricOffAxis2Right=31]="isometricOffAxis2Right",E[E.isometricOffAxis2Top=32]="isometricOffAxis2Top",E[E.isometricOffAxis3Left=33]="isometricOffAxis3Left",E[E.isometricOffAxis3Right=34]="isometricOffAxis3Right",E[E.isometricOffAxis3Bottom=35]="isometricOffAxis3Bottom",E[E.isometricOffAxis4Left=36]="isometricOffAxis4Left",E[E.isometricOffAxis4Right=37]="isometricOffAxis4Right",E[E.isometricOffAxis4Bottom=38]="isometricOffAxis4Bottom",E[E.obliqueTopLeft=39]="obliqueTopLeft",E[E.obliqueTop=40]="obliqueTop",E[E.obliqueTopRight=41]="obliqueTopRight",E[E.obliqueLeft=42]="obliqueLeft",E[E.obliqueRight=43]="obliqueRight",E[E.obliqueBottomLeft=44]="obliqueBottomLeft",E[E.obliqueBottom=45]="obliqueBottom",E[E.obliqueBottomRight=46]="obliqueBottomRight",E[E.perspectiveFront=47]="perspectiveFront",E[E.perspectiveLeft=48]="perspectiveLeft",E[E.perspectiveRight=49]="perspectiveRight",E[E.perspectiveAbove=50]="perspectiveAbove",E[E.perspectiveBelow=51]="perspectiveBelow",E[E.perspectiveAboveLeftFacing=52]="perspectiveAboveLeftFacing",E[E.perspectiveAboveRightFacing=53]="perspectiveAboveRightFacing",E[E.perspectiveContrastingLeftFacing=54]="perspectiveContrastingLeftFacing",E[E.perspectiveContrastingRightFacing=55]="perspectiveContrastingRightFacing",E[E.perspectiveHeroicLeftFacing=56]="perspectiveHeroicLeftFacing",E[E.perspectiveHeroicRightFacing=57]="perspectiveHeroicRightFacing",E[E.perspectiveHeroicExtremeLeftFacing=58]="perspectiveHeroicExtremeLeftFacing",E[E.perspectiveHeroicExtremeRightFacing=59]="perspectiveHeroicExtremeRightFacing",E[E.perspectiveRelaxed=60]="perspectiveRelaxed",E[E.perspectiveRelaxedModeratel=61]="perspectiveRelaxedModeratel",(E=Tt=t.ST_PresetLineDashVal||(t.ST_PresetLineDashVal={}))[E.solid=0]="solid",E[E.dot=1]="dot",E[E.dash=2]="dash",E[E.lgDash=3]="lgDash",E[E.dashDot=4]="dashDot",E[E.lgDashDot=5]="lgDashDot",E[E.lgDashDotDot=6]="lgDashDotDot",E[E.sysDash=7]="sysDash",E[E.sysDot=8]="sysDot",E[E.sysDashDot=9]="sysDashDot",E[E.sysDashDotDot=10]="sysDashDotDot",(E=At=t.ST_LineEndWidth||(t.ST_LineEndWidth={}))[E.sm=0]="sm",E[E.med=1]="med",E[E.lg=2]="lg",(E=It=t.ST_LineEndType||(t.ST_LineEndType={}))[E.none=0]="none",E[E.triangle=1]="triangle",E[E.stealth=2]="stealth",E[E.diamond=3]="diamond",E[E.oval=4]="oval",E[E.arrow=5]="arrow",(E=xt=t.ST_LineEndLength||(t.ST_LineEndLength={}))[E.sm=0]="sm",E[E.med=1]="med",E[E.lg=2]="lg",(E=Nt=t.ST_AnchorType||(t.ST_AnchorType={}))[E.twoCellAnchor=0]="twoCellAnchor",E[E.oneCellAnchor=1]="oneCellAnchor",E[E.absoluteAnchor=2]="absoluteAnchor",E[E.groupShapeAnchor=3]="groupShapeAnchor",(E=kt=t.LineFormatStates||(t.LineFormatStates={}))[E.Color=1]="Color",E[E.PatternColor=2]="PatternColor",E[E.BeginArrowheadLength=4]="BeginArrowheadLength",E[E.BeginArrowheadStyle=8]="BeginArrowheadStyle",E[E.BeginArrowheadWidth=16]="BeginArrowheadWidth",E[E.DashStyle=32]="DashStyle",E[E.EndArrowheadLength=64]="EndArrowheadLength",E[E.EndArrowheadStyle=128]="EndArrowheadStyle",E[E.EndArrowheadWidth=256]="EndArrowheadWidth",E[E.InsetPen=512]="InsetPen",E[E.Pattern=1024]="Pattern",E[E.Style=2048]="Style",E[E.Transparency=4096]="Transparency",E[E.Visible=8192]="Visible",E[E.Weight=16384]="Weight",E[E.CapStyle=32768]="CapStyle",E[E.JoinStyle=65536]="JoinStyle",(E=_t=t.ColorFormatStates||(t.ColorFormatStates={}))[E.Brightness=1]="Brightness",E[E.ObjectThemeColor=2]="ObjectThemeColor",E[E.RGB=4]="RGB",E[E.TintAndShade=8]="TintAndShade",E[E.ColorType=16]="ColorType",E[E.Transparency=32]="Transparency",E[E.SatMod=64]="SatMod",(E=Dt=t.PictureFormatType||(t.PictureFormatType={}))[E.PictureShape=0]="PictureShape",E[E.PictureFill=1]="PictureFill",E[E.TextureFill=2]="TextureFill",(E=jt=t.ST_TimeUnit||(t.ST_TimeUnit={}))[E.days=0]="days",E[E.months=1]="months",E[E.years=2]="years",(E=Ot=t.BevelType||(t.BevelType={}))[E.BevelNone=0]="BevelNone",E[E.BevelRelaxedInset=1]="BevelRelaxedInset",E[E.BevelCircle=2]="BevelCircle",E[E.BevelSlope=3]="BevelSlope",E[E.BevelCross=4]="BevelCross",E[E.BevelAngle=5]="BevelAngle",E[E.BevelSoftRound=6]="BevelSoftRound",E[E.BevelConvex=7]="BevelConvex",E[E.BevelCoolSlant=8]="BevelCoolSlant",E[E.BevelDivot=9]="BevelDivot",E[E.BevelRiblet=10]="BevelRiblet",E[E.BevelHardEdge=11]="BevelHardEdge",E[E.BevelArtDeco=12]="BevelArtDeco"},"./dist/plugins/floatingObject/drawing/effects.js":function(t,n,e){"use strict";var i,r,c,o,f,a,l,h,u,s,d,v,m,g,p,b,e,e,w,y,M,e,C;function S(t,n){var e,i,e=w.call(this,n)||this,i=e;return i.xft=5,i.Nft=!1,i.kft=c.DrawingConstants.DefaultOffset,i.Dft=c.DrawingConstants.DefaultOffset,i._ft=!1,i.Eft=100,i.aft=0,i.jft=!1,i.presetShadowOffset=-6,i.DJ=t,i.sft=n,e}function T(t){return y.call(this,t)||this}function A(t,n){var e,i,e=M.call(this,n)||this,i=e;return i.Eft=100,i.uit=f.ReflectionType.ReflectionType1,i.presetShadowOffset=-6,i.DJ=t,i.sft=n,e}function I(t,n){var e=C.call(this,n)||this;return e.DJ=t,e.sft=n,e}i=this&&this.__extends||(b=function(t,n){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}b(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.GlowFormat=n.ReflectionFormat=n.SoftEdgeFormat=n.ShadowFormat=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),c=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/colorFormat.js"),f=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),(e=a=a||{})[e.Blur=1]="Blur",e[e.Offset=2]="Offset",e[e.Size=4]="Size",e[e.Transparency=8]="Transparency",e[e.Type=16]="Type",l=c.UnitHelper.isNullOrUndefined,h=Math.floor,u=Math.sqrt,(e=s=s||{})[e.Blur=1]="Blur",e[e.Obscured=2]="Obscured",e[e.OffsetX=4]="OffsetX",e[e.OffsetY=8]="OffsetY",e[e.RotateWithShape=16]="RotateWithShape",e[e.Size=32]="Size",e[e.Style=64]="Style",e[e.Transparency=128]="Transparency",e[e.Type=256]="Type",e[e.Visible=512]="Visible",w=r.StatefulBase,i(S,w),S.prototype.OnStyleChange=function(){var t=this;t.xft=0,t.kft=0,t.Dft=0,t.Eft=100,t.aft=0,t.UnDirty(s.Type),t.Style===f.ShadowStyle.ShadowStyleInnerShadow?t._ft=!1:t.Style===f.ShadowStyle.ShadowStyleOuterShadow&&(t._ft=!0)},S.prototype.OnTypeChange=function(){var t=this;t.xft=5,t.kft=t.presetShadowOffset,t.Dft=t.presetShadowOffset,t.Eft=100,t.aft=.5,t.UnDirty(s.Style)},S.prototype.GetDefaultColor=function(){var t=new o.ColorFormat(this.DJ,this.sft&&this.sft.Oft);return t.ColorType=f.SolidColorType.None,t},S.prototype.IncrementOffsetX=function(t){this.OffsetX+=t},S.prototype.IncrementOffsetY=function(t){this.OffsetY+=t},S.prototype.FromOOModel=function(t){this.cft=t},S.prototype.ToOOModel=function(){return this.cft},S.prototype.FromSJSOOModel=function(t){this.Xnn=t},S.prototype.ToSJSOOModel=function(){return this.Xnn},S.prototype.ToCT_PresetShadowEffect=function(){var t,n,e,i,r,t=this,n=t.OffsetX,e=t.OffsetY,i=u(n*n+e*e),r={dist:0,dir:0};return r.dist=i,r.dir=h(c.NumberExtension.GetTriangleAngle(n,e,i)*c.DrawingConstants.PositiveFixedAngleConvert),r.prst=t.Type,t.ToCT_Color(r),r},S.prototype.ToCT_InnerShadowEffect=function(){var t,n,e,i,r,t=this,n=t.OffsetX,e=t.OffsetY,i=u(n*n+e*e),r={blurRad:0,dist:0,dir:0};return r.blurRad=t.Blur,r.dist=i,0===n&&0===e||(r.dir=h(c.NumberExtension.GetTriangleAngle(n,e,i)*c.DrawingConstants.PositiveFixedAngleConvert)),r.scrgbClr=t.ToCT_ScRgbColor(),r},S.prototype.ToCT_OuterShadowEffect=function(){var t,n,e,i,r,t=this,n=t.OffsetX,e=t.OffsetY,i=u(n*n+e*e),r={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:f.TextureAlignment.TextureBottom,rotWithShape:!0};return r.blurRad=t.Blur,r.dist=i,0===n&&0===e||(r.dir=h(c.NumberExtension.GetTriangleAngle(n,e,i)*c.DrawingConstants.PositiveFixedAngleConvert)),r.rotWithShape=!0===t.RotateWithShape,r.sx=h(t.Size*c.DrawingConstants.RelativeRectConver),r.sy=h(t.Size*c.DrawingConstants.RelativeRectConver),r.scrgbClr=t.ToCT_ScRgbColor(),r},S.prototype.ToCT_Color=function(t){var n,e,i,r,o,o,n=this;l(n.Oft)||(n.Oft.ColorType===f.SolidColorType.Theme?((o={}).val=n.Oft.ObjectThemeColor,0!==n.Oft.Brightness&&(e=h(1e5*n.Oft.Brightness),o.lumMod=[e],i=h(1e5*(1-n.Oft.Brightness)),o.lumOff=[i]),0<n.Oft.TintAndShade&&n.Oft.TintAndShade<1&&(r=h(n.Oft.TintAndShade*c.DrawingConstants.ShadeConver),o.shade=[r]),t.schemeClr=o):n.Oft.ColorType===f.SolidColorType.RGB&&((o={}).val=[n.Oft.RGB.R,n.Oft.RGB.G,n.Oft.RGB.B],0!==n.Oft.Brightness&&(e=h(1e5*n.Oft.Brightness),o.lumMod=[e],i=h(1e5*(1-n.Oft.Brightness)),o.lumOff=[i]),0!==n.Transparency&&(r=h(n.Transparency*c.DrawingConstants.PositiveFixedPercentageConvert),o.alpha=[r]),t.srgbClr=o))},S.prototype.ToCT_ScRgbColor=function(){var t,n,t={};return 0!==this.Transparency&&(n=h(this.Transparency*c.DrawingConstants.PositiveFixedPercentageConvert),t.alpha=[n]),t},S.prototype.SetState=function(t,n){w.prototype.SetState.call(this,t,n),t!==s.Blur&&t!==s.OffsetX&&t!==s.OffsetY&&t!==s.RotateWithShape&&t!==s.Size&&t!==s.Transparency||this.GetState(s.Style)||(this.RN=f.ShadowStyle.ShadowStyleOuterShadow)},Object.defineProperty(S.prototype,"ForeColor",{get:function(){var t=this;return l(t.Oft)&&(t.Oft=t.GetDefaultColor()),t.Oft},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Obscured",{get:function(){var t=this;return t.GetState(s.Obscured)||l(t.sft)?t.Nft:t.sft.Obscured},set:function(t){this.Nft=t,this.SetState(s.Obscured,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Blur",{get:function(){var t=this;return t.GetState(s.Blur)||l(t.sft)?t.xft:t.sft.Blur},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Blue",{set:function(t){this.xft=t,this.SetState(s.Blur,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"OffsetX",{get:function(){var t=this;return t.GetState(s.OffsetX)||l(t.sft)?t.kft:t.sft.OffsetX},set:function(t){this.kft=t,this.SetState(s.OffsetX,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"OffsetY",{get:function(){var t=this;return t.GetState(s.OffsetY)||l(t.sft)?t.Dft:t.sft.OffsetY},set:function(t){this.Dft=t,this.SetState(s.OffsetY,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"RotateWithShape",{get:function(){var t=this;return t.GetState(s.RotateWithShape)||l(t.sft)?t._ft:t.sft.RotateWithShape},set:function(t){var n=this;n.Style===f.ShadowStyle.ShadowStyleInnerShadow||n.GetState(s.Type)||(n._ft=t,n.SetState(s.RotateWithShape,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Size",{get:function(){var t=this;return t.GetState(s.Size)||l(t.sft)?t.Eft:t.sft.Size},set:function(t){this.Eft=t,this.SetState(s.Size,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Style",{get:function(){var t=this;return t.GetState(s.Style)||l(t.sft)?t.RN:t.sft.Style},set:function(t){var n=this;n.Style!==t&&n.OnStyleChange(),n.RN=t,n.SetState(s.Style,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Transparency",{get:function(){var t=this;return t.GetState(s.Transparency)||l(t.sft)?t.aft:t.sft.Transparency},set:function(t){this.aft=t,this.SetState(s.Transparency,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Type",{get:function(){var t=this;return t.GetState(s.Type)||l(t.sft)?t.uit:t.sft.Type},set:function(t){this.uit=t,this.SetState(s.Type,!0),this.OnTypeChange()},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"Visible",{get:function(){var t=this;return t.GetState(s.Visible)||l(t.sft)?t.jft:t.sft.Visible},set:function(t){var n=this;n.jft=t,n.SetState(s.Visible,!0),!1===t||n.GetState(s.Style)||(n.RN=f.ShadowStyle.ShadowStyleOuterShadow)},enumerable:!1,configurable:!0}),n.ShadowFormat=S,y=r.StatefulBase,i(T,y),T.prototype.FromOOModel=function(t){this.cft=t},T.prototype.ToOOModel=function(){return this.cft},T.prototype.FromSJSOOModel=function(t){this.Xnn=t},T.prototype.ToSJSOOModel=function(){return this.Xnn},n.SoftEdgeFormat=T,M=r.StatefulBase,i(A,M),Object.defineProperty(A.prototype,"Blur",{get:function(){var t=this;return t.GetState(a.Blur)||l(t.sft)?t.xft:t.sft.Blur},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Blue",{set:function(t){this.xft=t,this.SetState(a.Blur,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Offset",{get:function(){var t=this;return t.GetState(a.Offset)||l(t.sft)?t.Xy:t.sft.Offset},set:function(t){this.Xy=t,this.SetState(a.Offset,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Size",{get:function(){var t=this;return t.GetState(a.Size)||l(t.sft)?t.Eft:t.sft.Size},set:function(t){this.Eft=t,this.SetState(a.Size,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Transparency",{get:function(){var t=this;return t.GetState(a.Transparency)||l(t.sft)?t.aft:t.sft.Transparency},set:function(t){this.aft=t,this.SetState(a.Transparency,!0)},enumerable:!1,configurable:!0}),A.prototype.FromOOModel=function(t){this.cft=t},A.prototype.ToOOModel=function(){return this.cft},A.prototype.FromSJSOOModel=function(t){this.Xnn=t},A.prototype.ToSJSOOModel=function(){return this.Xnn},A.prototype.OnTypeChange=function(){var t=this;t.xft=5,t.Xy=t.presetShadowOffset,t.Eft=100,t.aft=.5},n.ReflectionFormat=A,(e=g=g||{})[e.Color=1]="Color",e[e.Radius=2]="Radius",e[e.Transparency=4]="Transparency",C=r.StatefulBase,i(I,C),Object.defineProperty(I.prototype,"Color",{get:function(){var t=this;return l(t._x)&&(t._x=t.GetDefaultColor()),t._x},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Radius",{get:function(){var t=this;return t.GetState(g.Radius)||l(t.sft)?t.radius:t.sft.Radius},set:function(t){this.radius=t,this.Dirty(g.Radius)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Transparency",{get:function(){var t=this;return t.GetState(g.Transparency)||l(t.sft)?t.aft:t.sft.Transparency},set:function(t){this.aft=t,this.Dirty(g.Transparency)},enumerable:!1,configurable:!0}),I.prototype.FromOOModel=function(t){this.cft=t},I.prototype.ToOOModel=function(){return this.cft},I.prototype.FromSJSOOModel=function(t){this.Xnn=t},I.prototype.ToSJSOOModel=function(){return this.Xnn},I.prototype.GetDefaultColor=function(){var t=new o.ColorFormat(this.DJ,this.sft&&this.sft.Color);return t.ColorType=f.SolidColorType.None,t},I.prototype.SetState=function(t,n){var e=this;C.prototype.SetState.call(e,t,n),t!==g.Radius&&t!==g.Transparency||e._x&&e._x.ColorType===f.SolidColorType.None&&(e._x.ColorType=f.SolidColorType.RGB)},I.prototype.ToCT_Color=function(t){var n,e,i,r,o,a,u,s,s,n=this,o=n._x;l(o)||(a=o.ColorType,u=o.Brightness,a===f.SolidColorType.Theme?((s={}).val=o.ObjectThemeColor,0!==u&&(e=h(1e5*u),s.lumMod=[e],i=h(1e5*(1-u)),s.lumOff=[i]),0<o.TintAndShade&&o.TintAndShade<1&&(r=h(o.TintAndShade*c.DrawingConstants.ShadeConver),s.shade=[r]),t.schemeClr=s):a===f.SolidColorType.RGB&&((s={}).val=[o.RGB.R,o.RGB.G,o.RGB.B],0!==u&&(e=h(1e5*u),s.lumMod=[e],i=h(1e5*(1-u)),s.lumOff=[i]),0!==n.Transparency&&(r=h(n.Transparency*c.DrawingConstants.PositiveFixedPercentageConvert),s.alpha=[r]),t.srgbClr=s))},n.GlowFormat=I},"./dist/plugins/floatingObject/drawing/fillFormat.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,e,h,d,v,e,m,g,p,b,w,y,M,C,S,T,A,I,x,o,N;function k(t){return{l:String(t.l),t:String(t.t),r:String(t.r),b:String(t.b)}}function _(t,n,e,i){var r,o,r=N.call(this,n)||this,o=r;return o.Rft=!0,o.Bft=c.ST_PathShadeType.rect,o.Ox=c.PatternType.none,o.Lft=!0,o.jft=!0,o.Fft=M,o.DJ=t,o.uit=c.FillType.Solid,o.sft=n,o.Pft=e,o.Wc=i,o.Gft=new s.PictureFormat(c.PictureFormatType.PictureFill,n&&n.PictureFormat),o.Gft.Container=i,o.Uft=1,o.Hft=1,o.zft=new u.GradientStops(o.DJ),r}i=this&&this.__extends||(x=function(t,n){return(x=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}x(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.FillFormat=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),o=e("./dist/plugins/floatingObject/drawing/common.js"),a=e("./dist/plugins/floatingObject/drawing/colorFormat.js"),u=e("./dist/plugins/floatingObject/drawing/gradient.js"),s=e("./dist/plugins/floatingObject/drawing/picture.js"),c=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),f=e("Core"),l=f.ExcelHelper.pixelToEMU,e=o.DrawingConstants,h=e.PositiveFixedPercentageConvert,d=e.PositiveFixedAngleConvert,v=e.PositionConver,e=o.UnitHelper,m=o.pft,g=o.DrawingUtility,p=o.mft,b=f.NodeHelper.sr,w=f.NodeHelper.ur,y=e.isNullOrUndefined,M=null,C=void 0,S=Math.floor,T="The specified value is out of range",(o=A=A||{})[o.GradientStops=1]="GradientStops",o[o.GradientStyle=2]="GradientStyle",o[o.GradientColorType=4]="GradientColorType",o[o.Pattern=8]="Pattern",o[o.PresetTexture=16]="PresetTexture",o[o.RotateWithObject=32]="RotateWithObject",o[o.TextureAlignment=64]="TextureAlignment",o[o.TextureHorizontalScale=128]="TextureHorizontalScale",o[o.TextureName=256]="TextureName",o[o.TextureOffsetX=512]="TextureOffsetX",o[o.TextureOffsetY=1024]="TextureOffsetY",o[o.TextureTile=2048]="TextureTile",o[o.TextureType=4096]="TextureType",o[o.TextureVerticalScale=8192]="TextureVerticalScale",o[o.Transparency=16384]="Transparency",o[o.Type=32768]="Type",o[o.Visible=65536]="Visible",o[o.Color=131072]="Color",o[o.PatternColor=262144]="PatternColor",o[o.PictureFormat=524288]="PictureFormat",o[o.GradientDegree=1048576]="GradientDegree",o[o.GradientAngle=2097152]="GradientAngle",o[o.GradientVariant=4194304]="GradientVariant",o[o.PresetGradientType=8388608]="PresetGradientType",N=r.StatefulBase,i(_,N),Object.defineProperty(_.prototype,"Parent",{get:function(){return this.sft},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PictureFormat",{get:function(){return this.Gft},set:function(t){var n,e,n=this;y(n.Gft)||n.Gft.SetParentForChildren(t),e=n.Gft,n.Gft=t,y(e)||(n.Gft.ParentStateful=e.ParentStateful)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PatternColor",{get:function(){return this.PatternColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Color",{get:function(){return this.ColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientAngle",{get:function(){var t=this;if(!t.IsDirty(A.GradientAngle)&&!y(t.sft))return t.sft.GradientAngle;if(t.GradientStyle===c.GradientStyle.GradientFromCenter||t.GradientStyle===c.GradientStyle.GradientFromCorner)throw new Error;return t.Vft},set:function(t){this.Vft=t,this.Dirty(A.GradientAngle)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientColorType",{get:function(){return this.GetGradientColorType()},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientDegree",{get:function(){var t=this;return t.IsDirty(A.GradientDegree)||y(t.sft)?t.Yft:t.sft.GradientDegree},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientStops",{get:function(){var t=this;return t.IsDirty(A.GradientStops)||y(t.sft)?t.zft:t.sft.GradientStops},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientStyle",{get:function(){var t=this;return t.IsDirty(A.GradientStyle)||y(t.sft)?t.Zft:t.sft.GradientStyle},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"GradientVariant",{get:function(){var t=this;return t.IsDirty(A.GradientVariant)||y(t.sft)?t.Wft:t.sft.GradientVariant},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Pattern",{get:function(){var t=this;return t.IsDirty(A.Pattern)||y(t.sft)?t.Ox:t.sft.Pattern},set:function(t){this.Ox=t,this.Dirty(A.Pattern)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PresetGradientType",{get:function(){var t=this;return t.IsDirty(A.PresetGradientType)||y(t.sft)?t.Qft:t.sft.PresetGradientType},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"RotateWithObject",{get:function(){var t=this;return t.IsDirty(A.RotateWithObject)||y(t.sft)?t.Lft:t.sft.RotateWithObject},set:function(t){this.Lft=t,this.Dirty(A.RotateWithObject)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureAlignment",{get:function(){var t=this;return t.IsDirty(A.TextureAlignment)||y(t.sft)?t.Kft:t.sft.TextureAlignment},set:function(t){this.Kft=t,this.Dirty(A.TextureAlignment)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureHorizontalScale",{get:function(){var t=this;return t.IsDirty(A.TextureHorizontalScale)||y(t.sft)?t.Uft:t.sft.TextureHorizontalScale},set:function(t){this.Uft=t,this.Dirty(A.TextureHorizontalScale)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureOffsetX",{get:function(){var t=this;return t.IsDirty(A.TextureOffsetX)||y(t.sft)?t.Jft:t.sft.TextureOffsetX},set:function(t){this.Jft=t,this.Dirty(A.TextureOffsetX)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureOffsetY",{get:function(){var t=this;return t.IsDirty(A.TextureOffsetY)||y(t.sft)?t.Xft:t.sft.TextureOffsetY},set:function(t){this.Xft=t,this.Dirty(A.TextureOffsetY)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"TextureVerticalScale",{get:function(){var t=this;return t.IsDirty(A.TextureVerticalScale)||y(t.sft)?t.Hft:t.sft.TextureVerticalScale},set:function(t){this.Hft=t,this.Dirty(A.TextureVerticalScale)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Transparency",{get:function(){var t=this;return(t.IsDirty(A.Transparency)||y(t.sft)?t.ColorInternal:t.sft).Transparency},set:function(t){this.ColorInternal.Transparency=t,this.Dirty(A.Transparency)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Type",{get:function(){var t=this;return t.IsDirty(A.Type)||y(t.sft)?t.uit:t.sft.Type},set:function(t){this.uit=t,this.Dirty(A.Type)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Visible",{get:function(){var t=this;return t.IsDirty(A.Visible)||y(t.sft)?t.jft:t.sft.Visible},set:function(t){this.jft=t,this.Dirty(A.Visible)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"ColorInternal",{get:function(){var t=this;return y(t._x)&&(t._x=new a.ColorFormat(t.DJ,y(t.sft)?M:t.sft.Color),t._x.AutoColorFormat=t.Pft),t._x},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PatternColorInternal",{get:function(){var t=this;return y(t.qft)&&(t.qft=new a.ColorFormat(t.DJ,y(t.sft)?M:t.sft.PatternColor)),t.qft},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"PresetTexture",{get:function(){var t=this;return t.IsDirty(A.PresetTexture)||y(t.sft)?t.$ft:t.sft.PresetTexture},set:function(t){this.$ft=t,this.Dirty(A.PresetTexture)},enumerable:!1,configurable:!0}),_.prototype.GetGradientColorType=function(){for(var t,n,e,i,r,t=[],n=0,e=this.zft.GradientStopList;n<e.length;n++)i=e[n],this.FindInColorStops(i.Color,t)||t.push(i.Color);return 0===(r=t.length)?c.GradientColorType.GradientColorNone:1===r?c.GradientColorType.GradientOneColor:2===r?c.GradientColorType.GradientTwoColors:c.GradientColorType.GradientMultiColor},_.prototype.FindInColorStops=function(t,n){for(var e,i,r,o,e=0,i=n;e<i.length;e++)if((o=(r=i[e]).ColorType)===t.ColorType)if(o===c.SolidColorType.Theme){if(r.ObjectThemeColor===t.ObjectThemeColor&&r.TintAndShade===t.TintAndShade)return!0}else if(o===c.SolidColorType.RGB&&r.RGB.Equals(t.RGB)&&r.TintAndShade===t.TintAndShade)return!0;return!1},_.prototype.t0t=function(t){this.Yft=t,this.Dirty(A.GradientDegree)},_.prototype.n0t=function(t){this.zft=t,this.Dirty(A.GradientStops)},_.prototype.e0t=function(t){this.Zft=t,this.Dirty(A.GradientStyle)},_.prototype.i0t=function(t){this.Wft=t,this.Dirty(A.GradientVariant)},_.prototype.r0t=function(t){if(t===c.PatternType.none)throw new Error(T);var n=this;n.Pattern===c.PatternType.none&&n.o0t(c.FillType.Patterned),n.Ox=t,n.Dirty(A.Pattern)},_.prototype.a0t=function(t){this.Qft=t,this.Dirty(A.PresetGradientType)},_.prototype.o0t=function(t){this.uit=t,this.Dirty(A.Type)},_.prototype.InitGradientInfo=function(t,n,e){if(t===c.GradientStyle.GradientFromTitle)throw new Error(T);var i=this;i.e0t(t),i.i0t(n),i.o0t(c.FillType.Gradient),i.a0t(e)},_.prototype.OneColorGradient=function(t,n,e){if(e<0||1<e)throw new Error(T);var i=this;i.InitGradientInfo(t,n,c.PresetGradientType.GradientEarlySunset),i.t0t(e),u.PresetGradientUtility.InitGradientStops(i.DJ,i,c.GradientColorType.GradientOneColor)},_.prototype.TwoColorGradient=function(t,n){this.InitGradientInfo(t,n,c.PresetGradientType.GradientEarlySunset),u.PresetGradientUtility.InitGradientStops(this.DJ,this,c.GradientColorType.GradientTwoColors)},_.prototype.PresetGradient=function(t,n,e){this.InitGradientInfo(t,n,e),u.PresetGradientUtility.InitGradientStops(this.DJ,this,c.GradientColorType.GradientPresetColors)},_.prototype.Patterned=function(t){this.SetPatternColor(),this.o0t(c.FillType.Patterned),this.r0t(t)},_.prototype.SetPatternColor=function(){var t=this;t.Color.ObjectThemeColor=c.ColorSchemeIndex.LT1,t.PatternColor.ObjectThemeColor=c.ColorSchemeIndex.Accent1,t.Color.ClearModel(),t.PatternColor.ClearModel()},_.prototype.Solid=function(){this.o0t(c.FillType.Solid),y(this._x)||this._x.ClearModel()},_.prototype.ClearColor=function(){this._x=M},_.prototype.GetState=function(t,n){var e=this;return n===C&&(n=!1),t!==A.Color||y(e._x)?t!==A.PatternColor||y(e.qft)?N.prototype.GetState.call(e,t,n):e.qft.IsDirtyIncludingParent(n):e._x.IsDirtyIncludingParent(n)},_.prototype.IsDirtyIncludingParent=function(t){void 0===t&&(t=!1);var n=this;return!(y(n.qft)||!n.qft.IsDirtyIncludingParent())||!(y(n._x)||!n._x.IsDirtyIncludingParent())||!y(n.zft)&&0<n.zft.Count||!(y(n.Gft)||!n.Gft.IsDirtyIncludingParent())||N.prototype.IsDirtyIncludingParent.call(n,t)},_.prototype.OnParentChanged=function(t){var n=this;n.sft=t,y(n.sft)?(y(n._x)||(n._x.ParentStateful=M),y(n.qft)||(n.qft.ParentStateful=M)):(y(n._x)||(n._x.ParentStateful=n.sft.Color),y(n.qft)||(n.qft.ParentStateful=n.sft.PatternColor))},_.prototype.FromOOModel=function(t,n){if(y(n))throw new Error("colorFillType not provided!");var e=this;e.Fft=t,n===c.ColorFillType.SolidColorFillProperties?(e.ColorInternal.FromOOModel(e.Fft),e.uit=c.FillType.Solid,e.SetState(A.Type,!0)):n===c.ColorFillType.PatternFillProperties?(e.FromCT_PatternFillProperties(t),e.uit=c.FillType.Patterned,e.SetState(A.Type,!0)):n===c.ColorFillType.GradientFillProperties?(e.FromCT_GradientFillProperties(t),e.uit=c.FillType.Gradient,e.SetState(A.Type,!0)):n===c.ColorFillType.BlipFillProperties?(e.Gft.FromOOModel(t),e.uit=c.FillType.Picture,e.SetState(A.Type,!0)):n===c.ColorFillType.GroupFillProperties?(e.uit=c.FillType.Group,e.SetState(A.Type,!0)):n===c.ColorFillType.NoFillProperties&&(e.uit=c.FillType.Solid,e.SetState(A.Type,!0))},_.prototype.FromSJSOOModel=function(t,n){if(y(n))throw new Error("colorFillType not provided!");var e=this;n===c.ColorFillType.SolidColorFillProperties?(e.ColorInternal.FromSJSOOModel(t),e.uit=c.FillType.Solid,e.SetState(A.Type,!0)):n===c.ColorFillType.PatternFillProperties?(e.FromSJSCT_PatternFillProperties(t),e.uit=c.FillType.Patterned,e.SetState(A.Type,!0)):n===c.ColorFillType.GradientFillProperties?(e.FromSJSCT_GradientFillProperties(t),e.uit=c.FillType.Gradient,e.SetState(A.Type,!0)):n===c.ColorFillType.BlipFillProperties?(e.Gft.FromSJSOOModel(t),e.uit=c.FillType.Picture,e.SetState(A.Type,!0)):n===c.ColorFillType.GroupFillProperties?(e.uit=c.FillType.Group,e.SetState(A.Type,!0)):n===c.ColorFillType.NoFillProperties&&(e.uit=c.FillType.Solid,e.SetState(A.Type,!0))},_.prototype.ToOOModel=function(t){var n;if(this.Visible)switch(this.Type){case c.FillType.Solid:n=this.ToCT_SolidColorFillProperties();break;case c.FillType.Patterned:n=this.ToCT_PatternFillProperties();break;case c.FillType.Gradient:n=this.ToCT_GradientFillProperties();break;case c.FillType.Textured:n=this.ToCT_TileFillProperties();break;case c.FillType.Background:break;case c.FillType.Picture:n=this.ToCT_PictureFillProperties();break;case c.FillType.Group:n={colorFillType:c.ColorFillType.GroupFillProperties}}else n={colorFillType:c.ColorFillType.NoFillProperties};return n},_.prototype.ToSJSOOModel=function(t){var n;if(this.Visible)switch(this.Type){case c.FillType.Solid:n=this.ToSJSCT_SolidColorFillProperties();break;case c.FillType.Patterned:n=this.ToSJSCT_PatternFillProperties();break;case c.FillType.Gradient:n=this.ToSJSCT_GradientFillProperties();break;case c.FillType.Textured:n=this.ToSJSCT_TileFillProperties();break;case c.FillType.Background:break;case c.FillType.Picture:n=this.ToSJSCT_PictureFillProperties();break;case c.FillType.Group:n={colorFillType:c.ColorFillType.GroupFillProperties}}else n={colorFillType:c.ColorFillType.NoFillProperties};return n},_.prototype.ToSJS_FillGroup=function(t){var n,n,e,n=this;g.Aft(t),(e=(n=n.ToSJSOOModel()).colorFillType)===c.ColorFillType.SolidColorFillProperties?t.solidFill=n:e===c.ColorFillType.PatternFillProperties?t.pattFill=n:e===c.ColorFillType.GradientFillProperties?t.gradFill=n:e===c.ColorFillType.BlipFillProperties?t.blipFill=n:e===c.ColorFillType.NoFillProperties&&(t.noFill={}),delete n.colorFillType},_.prototype.FromCT_PatternFillProperties=function(t){this.r0t(t.prst),this.ColorInternal.FromOOModel(t.bgClr),this.PatternColorInternal.FromOOModel(t.fgClr)},_.prototype.FromSJSCT_PatternFillProperties=function(t){this.r0t(g.ToPatternType(c.ST_PresetPatternVal[t.prst])),this.ColorInternal.FromSJSOOModel(t.bgClr),this.PatternColorInternal.FromSJSOOModel(t.fgClr)},_.prototype.ToCT_PatternFillProperties=function(){var t,n,t=this;return t.DJ.DrawingType===c.DrawingType.GroupShape?M:((n={colorFillType:c.ColorFillType.PatternFillProperties}).prst=t.Pattern,t.PatternColorInternal.ColorType!==c.SolidColorType.None&&(n.fgClr=t.PatternColorInternal.Color_ToOOModel()),t.Color.ColorType!==c.SolidColorType.None&&(n.bgClr=t.Color.Color_ToOOModel()),n)},_.prototype.ToSJSCT_PatternFillProperties=function(){var t,n,t=this;return t.DJ.DrawingType===c.DrawingType.GroupShape?M:((n={colorFillType:c.ColorFillType.PatternFillProperties}).prst=c.ST_PresetPatternVal[g.ToST_PresetPatternVal(+t.Pattern)],t.PatternColorInternal.ColorType!==c.SolidColorType.None&&(n.fgClr=t.PatternColorInternal.Color_ToSJSOOModel()),t.Color.ColorType!==c.SolidColorType.None&&(n.bgClr=t.Color.Color_ToSJSOOModel()),n)},_.prototype.FromCT_GradientFillProperties=function(t){var n=this;n.n0t(new u.GradientStops(n.DJ)),n.zft.FromOOModel(t.gsLst),n.RotateWithObject=t.rotWithShape,y(t.path)?y(t.lin)||(n.FromCT_LinearShadeProperties(t.lin),n.FromTitleCT_RelativeRect(t.tileRect)):n.FromCT_PathShadeProperties(t.path)},_.prototype.FromSJSCT_GradientFillProperties=function(t){var n,e,i,n=this;n.n0t(new u.GradientStops(n.DJ)),n.zft.FromSJSOOModel(t.gsLst),n.RotateWithObject=w(t.rotWithShape,!1),e=t.path,i=t.lin,y(e)?y(i)||(n.FromSJSCT_LinearShadeProperties(i),n.FromTitleSJSCT_RelativeRect(t.tileRect)):n.FromSJSCT_PathShadeProperties(e)},_.prototype.ToCT_GradientFillProperties=function(){var t,n,t=this,n={colorFillType:c.ColorFillType.GradientFillProperties};return n.rotWithShape=t.RotateWithObject,!y(t.GradientStops)&&0<t.GradientStops.Count&&(n.gsLst=t.GradientStops.ToOOModel()),t.GradientStyle===c.GradientStyle.GradientFromCenter||t.GradientStyle===c.GradientStyle.GradientFromCorner||t.GradientStyle===c.GradientStyle.GradientTopSpotlight||t.GradientStyle===c.GradientStyle.GradientBottomSpotlight?n.path=t.ToCT_PathShadeProperties():n.lin=t.ToCT_LinearShadeProperties(),n.tileRect=t.ToTitleCT_RelativeRect(),n},_.prototype.ToSJSCT_GradientFillProperties=function(){var t,n,t=this,n={};return n.rotWithShape=p(t.RotateWithObject),!y(t.GradientStops)&&0<t.GradientStops.Count&&(n.gsLst=t.GradientStops.ToSJSOOModel()),t.GradientStyle===c.GradientStyle.GradientFromCenter||t.GradientStyle===c.GradientStyle.GradientFromCorner||t.GradientStyle===c.GradientStyle.GradientTopSpotlight||t.GradientStyle===c.GradientStyle.GradientBottomSpotlight?n.path=t.ToSJSCT_PathShadeProperties():n.lin=t.ToSJSCT_LinearShadeProperties(),n.tileRect=t.ToSJSTitleCT_RelativeRect(),n.colorFillType=c.ColorFillType.GradientFillProperties,n},_.prototype.ToCT_PictureFillProperties=function(){return this.Gft.ToOOModel()},_.prototype.ToSJSCT_PictureFillProperties=function(){return this.Gft.ToSJSOOModel()},_.prototype.FromTitleCT_RelativeRect=function(t){var n=this;y(t)||(t.l===-h&&t.t===-h?n.i0t(1):t.t===-h&&t.r===-h?n.i0t(2):t.l===-h&&t.b===-h?n.i0t(3):t.r===-h&&t.b===-h&&n.i0t(4))},_.prototype.FromTitleSJSCT_RelativeRect=function(t){var n,e,i,r,t,n=this;y(t)||(e=m(t.l),i=m(t.t),r=m(t.r),t=m(t.b),e===-h&&i===-h?n.i0t(1):i===-h&&r===-h?n.i0t(2):e===-h&&t===-h?n.i0t(3):r===-h&&t===-h&&n.i0t(4))},_.prototype.ToTitleCT_RelativeRect=function(){var t,n,t={l:0,r:0,t:0,b:0},n=this.GradientVariant;return this.GradientStyle===c.GradientStyle.GradientFromCorner&&(1===n?(t.l=-h,t.t=-h):2===n?(t.t=-h,t.r=-h):3===n?(t.l=-h,t.b=-h):4===n&&(t.r=-h,t.b=-h)),t},_.prototype.ToSJSTitleCT_RelativeRect=function(){return k(this.ToTitleCT_RelativeRect())},_.prototype.FromCT_LinearShadeProperties=function(t){this.GradientAngle=(t.ang||0)/d,this.u0t=!0,this.Rft=t.scaled},_.prototype.FromSJSCT_LinearShadeProperties=function(t){this.GradientAngle=parseFloat(t.ang||"0")/d,this.u0t=!0,this.Rft=f.NodeHelper.ur(t.scaled,!1)},_.prototype.ToCT_LinearShadeProperties=function(){return{ang:S(this.GradientAngle*d),scaled:this.Rft}},_.prototype.ToSJSCT_LinearShadeProperties=function(){return{ang:String(S(this.GradientAngle*d)),scaled:p(this.Rft)}},_.prototype.FromCT_PathShadeProperties=function(t){y(t)||(this.Bft=t.path,this.FromCT_RelativeRect(t.fillToRect))},_.prototype.FromSJSCT_PathShadeProperties=function(t){y(t)||(this.Bft=c.ST_PathShadeType[t.path],this.FromSJSCT_RelativeRect(t.fillToRect))},_.prototype.ToCT_PathShadeProperties=function(){return{path:this.Bft,fillToRect:this.ToCT_RelativeRect()}},_.prototype.ToSJSCT_PathShadeProperties=function(){return{path:c.ST_PathShadeType[this.Bft],fillToRect:this.ToSJSCT_RelativeRect()}},_.prototype.FromCT_RelativeRect=function(t){var n,e;y(t)||(e=this,t.l===(n=.5*h)&&t.t===n&&t.r===n&&t.b===n?e.e0t(c.GradientStyle.GradientFromCenter):t.r===h&&t.b===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(1)):t.l===h&&t.b===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(2)):t.r===h&&t.t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(3)):t.l===h&&t.t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(4)):t.l===n&&t.t===.8*-h?e.e0t(c.GradientStyle.GradientTopSpotlight):t.l===n&&t.t===1.3*h&&e.e0t(c.GradientStyle.GradientBottomSpotlight))},_.prototype.FromSJSCT_RelativeRect=function(t){var n,e,i,r,o,t;y(t)||(n=.5*h,e=this,i=b(t.l),r=b(t.r),o=b(t.t),t=b(t.b),i===n&&o===n&&r===n&&t===n?e.e0t(c.GradientStyle.GradientFromCenter):r===h&&t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(1)):i===h&&t===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(2)):r===h&&o===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(3)):i===h&&o===h?(e.e0t(c.GradientStyle.GradientFromCorner),e.i0t(4)):i===n&&o===.8*-h?e.e0t(c.GradientStyle.GradientTopSpotlight):i===n&&o===1.3*h&&e.e0t(c.GradientStyle.GradientBottomSpotlight))},_.prototype.ToCT_RelativeRect=function(){var t,n,e,t={l:0,r:0,t:0,b:0},n=.5*h;return this.GradientStyle===c.GradientStyle.GradientFromCenter?(t.l=n,t.t=n,t.r=n,t.b=n):this.GradientStyle===c.GradientStyle.GradientFromCorner?1===(e=this.GradientVariant)?(t.r=h,t.b=h):2===e?(t.l=h,t.b=h):3===e?(t.t=h,t.r=h):4===e&&(t.l=h,t.t=h):this.GradientStyle===c.GradientStyle.GradientTopSpotlight?(t.l=n,t.r=n,t.t=.8*-d,t.b=1.8*h):this.GradientStyle===c.GradientStyle.GradientBottomSpotlight&&(t.l=n,t.r=n,t.t=1.3*h,t.b=.3*-d),t},_.prototype.ToSJSCT_RelativeRect=function(){return k(this.ToCT_RelativeRect())},_.prototype.ToCT_SolidColorFillProperties=function(){return this.ColorInternal.ToOOModel()},_.prototype.ToSJSCT_SolidColorFillProperties=function(){return this.ColorInternal.ToSJSOOModel()},_.prototype.ToCT_TileFillProperties=function(){var t=this.Gft.ToOOModel();return t.tile=this.ToCT_TileInfoProperties(),t},_.prototype.ToSJSCT_TileFillProperties=function(){var t=this.Gft.ToSJSOOModel();return t.tile=this.ToSJSCT_TileInfoProperties(),t},_.prototype.ToCT_TileInfoProperties=function(){var t=this;return{algn:t.TextureAlignment,tx:t.TextureOffsetX,ty:t.TextureOffsetY,sx:S(t.TextureHorizontalScale*v),sy:S(t.TextureVerticalScale*v)}},_.prototype.ToSJSCT_TileInfoProperties=function(){var t=this;return{algn:c.ST_RectAlignment[t.TextureAlignment],tx:l(t.TextureOffsetX),ty:l(t.TextureOffsetY),sx:S(t.TextureHorizontalScale*v),sy:S(t.TextureVerticalScale*v)}},_.prototype.Clone=function(){var t,n,t=this,n=new _(t.DJ,t.sft,t.Pft,t.Wc);return y(t.qft)||(n.qft=t.qft.Clone()),y(t._x)||(n._x=t._x.Clone()),n.Yft=t.Yft,n.Rft=t.Rft,n.zft=t.zft,n.Wft=t.Wft,n.Ox=t.Ox,n.Qft=t.Qft,n.$ft=t.$ft,n.s0t=t.s0t,n.c0t=t.c0t,n.uit=t.uit,n.Vft=t.Vft,n.Lft=t.Lft,n.Kft=t.Kft,n.Uft=t.Uft,n.Jft=t.Jft,n.Xft=t.Xft,n.f0t=t.f0t,n.Hft=t.Hft,n.aft=t.aft,n.jft=t.jft,n.l0t=t.l0t,n.sft=t.sft,n},n.FillFormat=_},"./dist/plugins/floatingObject/drawing/fontData.js":function(t,n,e){"use strict";var i,r,l,o,h,a,e;function u(){var t=this;t.Flag=h.None,t.Size=0,t.Family=0,t.CharSet=0,t.Scheme=r.ThemeFont.None,t.Underline=r.UnderlineType.None,t.VertAlign=r.VertAlignType.Baseline}Object.defineProperty(n,"__esModule",{value:!0}),n.FontData=void 0,i=e("./dist/plugins/floatingObject/drawing/common.js"),r=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),l=e("./dist/plugins/floatingObject/drawing/colorData.js"),o=i.UnitHelper.isNullOrUndefined,(e=h=h||{})[e.None=0]="None",e[e.Color=1]="Color",e[e.Size=2]="Size",e[e.Name=4]="Name",e[e.Family=8]="Family",e[e.CharSet=16]="CharSet",e[e.Scheme=32]="Scheme",e[e.Bold=64]="Bold",e[e.Italic=128]="Italic",e[e.Underline=256]="Underline",e[e.Strike=512]="Strike",e[e.VertAlign=1024]="VertAlign",e[e.Shadow=2048]="Shadow",e[e.Outline=4096]="Outline",e[e.Condense=8192]="Condense",e[e.Extend=16384]="Extend",e[e.All=32767]="All",u.prototype.Equals=function(t){var n;return!o(t)&&(n=this).Size===t.Size&&n.Color.Equals(t.Color)&&n.Name===t.Name&&n.Family===t.Family&&n.CharSet===t.CharSet&&n.Scheme===t.Scheme&&n.Bold===t.Bold&&n.Italic===t.Italic&&n.Underline===t.Underline&&n.Strike===t.Strike&&n.VertAlign===t.VertAlign&&n.Shadow===t.Shadow&&n.Outline===t.Outline&&n.Condense===t.Condense&&n.Extend===t.Extend&&n.NotUsed===t.NotUsed},u.prototype.Clone=function(){var t,n,t=new u,n=this;return t.Color=n.Color,t.Size=n.Size,t.Name=n.Name,t.Family=n.Family,t.CharSet=n.CharSet,t.Scheme=n.Scheme,t.Bold=n.Bold,t.Italic=n.Italic,t.Underline=n.Underline,t.Strike=n.Strike,t.VertAlign=n.VertAlign,t.Shadow=n.Shadow,t.Outline=n.Outline,t.Condense=n.Condense,t.Extend=n.Extend,t.Flag=n.Flag,t.NotUsed=n.NotUsed,t},u.prototype.UpdateDefaultValueFlag=function(){var t,n,t=this,n=h.None;t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==l.ColorDataFlag.None&&(n|=h.Color),0!==t.Size&&(n|=h.Size),o(t.Name)||(n|=h.Name),0!==t.Family&&(n|=h.Family),0!==t.CharSet&&(n|=h.CharSet),t.Scheme!==r.ThemeFont.None&&(n|=h.Scheme),t.Bold&&(n|=h.Bold),t.Italic&&(n|=h.Italic),t.Underline!==r.UnderlineType.None&&(n|=h.Underline),t.Strike&&(n|=h.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(n|=h.VertAlign),t.Shadow&&(n|=h.Shadow),t.Outline&&(n|=h.Outline),t.Condense&&(n|=h.Condense),t.Extend&&(n|=h.Extend),t.Flag=n},u.prototype.UpdateFlagFromBottom=function(){var t=this;t.Color.UpdateFlagFromBottom(),t.Color.Flag===l.ColorDataFlag.None?t.Flag&=~h.Color:t.Flag|=h.Color},u.prototype.UpdateDefaultValueFlagForDxf=function(){var t,n,e,t=this,n=t.Flag,e=h.None;(n&h.Bold)===h.Bold&&(e|=h.Bold),(n&h.Italic)===h.Italic&&(e|=h.Italic),t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==l.ColorDataFlag.None&&(e|=h.Color),0!==t.Size&&(e|=h.Size),o(t.Name)||(e|=h.Name),0!==t.Family&&(e|=h.Family),0!==t.CharSet&&(e|=h.CharSet),t.Scheme!==r.ThemeFont.None&&(e|=h.Scheme),t.Underline!==r.UnderlineType.None&&(e|=h.Underline),t.Strike&&(e|=h.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(e|=h.VertAlign),t.Shadow&&(e|=h.Shadow),t.Outline&&(e|=h.Outline),t.Condense&&(e|=h.Condense),t.Extend&&(e|=h.Extend),t.Flag=e},u.prototype.Compose=function(t,n){void 0===n&&(n=!0),t.Flag!==h.None&&(n?this.ConflictCompose(t):this.NonConflictCompose(t))},u.prototype.ConflictCompose=function(t){var n,e,n=this,e=t.Flag;(e&h.Color)===h.Color&&n.Color.Compose(t.Color),(e&h.Size)===h.Size&&(n.Size=t.Size),(e&h.Name)===h.Name&&(n.Name=t.Name),(e&h.Family)===h.Family&&(n.Family=t.Family),(e&h.CharSet)===h.CharSet&&(n.CharSet=t.CharSet),(e&h.Scheme)===h.Scheme?n.Scheme=t.Scheme:(e&h.Name)===h.Name&&(n.Scheme=r.ThemeFont.None,e&=~h.Scheme),(e&h.Bold)===h.Bold&&(n.Bold=t.Bold),(e&h.Italic)===h.Italic&&(n.Italic=t.Italic),(e&h.Underline)===h.Underline&&(n.Underline=t.Underline),(e&h.Strike)===h.Strike&&(n.Strike=t.Strike),(e&h.VertAlign)===h.VertAlign&&(n.VertAlign=t.VertAlign),(e&h.Shadow)===h.Shadow&&(n.Shadow=t.Shadow),(e&h.Outline)===h.Outline&&(n.Outline=t.Outline),(e&h.Condense)===h.Condense&&(n.Condense=t.Condense),(e&h.Extend)===h.Extend&&(n.Extend=t.Extend),n.Flag|=e},u.prototype.NonConflictCompose=function(t){var n,e,n=this,e=n.Flag;n.Color.Compose(t.Color,!1),(e&h.Size)!==h.Size&&(n.Size=t.Size),(e&h.Name)!==h.Name&&(n.Name=t.Name),(e&h.Family)!==h.Family&&(n.Family=t.Family),(e&h.CharSet)!==h.CharSet&&(n.CharSet=t.CharSet),(e&h.Scheme)!==h.Scheme&&(n.Scheme=t.Scheme),(e&h.Bold)!==h.Bold&&(n.Bold=t.Bold),(e&h.Italic)!==h.Italic&&(n.Italic=t.Italic),(e&h.Underline)!==h.Underline&&(n.Underline=t.Underline),(e&h.Strike)!==h.Strike&&(n.Strike=t.Strike),(e&h.VertAlign)!==h.VertAlign&&(n.VertAlign=t.VertAlign),(e&h.Shadow)!==h.Shadow&&(n.Shadow=t.Shadow),(e&h.Outline)!==h.Outline&&(n.Outline=t.Outline),(e&h.Condense)!==h.Condense&&(n.Condense=t.Condense),(e&h.Extend)!==h.Extend&&(n.Extend=t.Extend),n.Flag|=t.Flag},u.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},u.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},u.prototype.Compare=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.Flag,r=t.Flag,o=[],a=!1;if((i&h.Color)===h.Color&&(u=(u=(r&h.Color)!==h.Color)||(n?(a=e.Color.RemoveDifferentStyle(t.Color),e.Color.Flag===l.ColorDataFlag.None):(a=e.Color.RemoveDuplicateStyle(t.Color),e.Color.Flag!==l.ColorDataFlag.None)),s=n?u:!u)&&o.push(h.Color),(i&h.Size)===h.Size&&(u=(r&h.Size)!==h.Size||e.Size!==t.Size,s=n?u:!u)&&o.push(h.Size),(i&h.Name)===h.Name&&(u=(r&h.Name)!==h.Name||e.Name!==t.Name,s=n?u:!u)&&o.push(h.Name),(i&h.Family)===h.Family&&(u=(r&h.Family)!==h.Family||e.Family!==t.Family,s=n?u:!u)&&o.push(h.Family),(i&h.CharSet)===h.CharSet&&(u=(r&h.CharSet)!==h.CharSet||e.CharSet!==t.CharSet,s=n?u:!u)&&o.push(h.CharSet),(i&h.Scheme)===h.Scheme&&(u=(r&h.Scheme)!==h.Scheme||e.Scheme!==t.Scheme,s=n?u:!u)&&o.push(h.Scheme),(i&h.Bold)===h.Bold&&(u=(r&h.Bold)!==h.Bold||e.Bold!==t.Bold,s=n?u:!u)&&o.push(h.Bold),(i&h.Italic)===h.Italic&&(u=(r&h.Italic)!==h.Italic||e.Italic!==t.Italic,s=n?u:!u)&&o.push(h.Italic),(i&h.Underline)===h.Underline&&(u=(r&h.Underline)!==h.Underline||e.Underline!==t.Underline,s=n?u:!u)&&o.push(h.Underline),(i&h.Strike)===h.Strike&&(u=(r&h.Strike)!==h.Strike||e.Strike!==t.Strike,s=n?u:!u)&&o.push(h.Strike),(i&h.VertAlign)===h.VertAlign&&(u=(r&h.VertAlign)!==h.VertAlign||e.VertAlign!==t.VertAlign,s=n?u:!u)&&o.push(h.VertAlign),(i&h.Shadow)===h.Shadow&&(u=(r&h.Shadow)!==h.Shadow||e.Shadow!==t.Shadow,s=n?u:!u)&&o.push(~h.Shadow),(i&h.Outline)===h.Outline&&(u=(r&h.Outline)!==h.Outline||e.Outline!==t.Outline,s=n?u:!u)&&o.push(h.Outline),(i&h.Condense)===h.Condense&&(u=(r&h.Condense)!==h.Condense||e.Condense!==t.Condense,s=n?u:!u)&&o.push(h.Condense),(i&h.Extend)===h.Extend&&(u=(r&h.Extend)!==h.Extend||e.Extend!==t.Extend,s=n?u:!u)&&o.push(h.Extend),0<(c=o.length))for(a=!0,f=0;f<c;f++)i&=~o[f];return e.Flag=i,a},u.prototype.ClearFlag=function(){this.Color.ClearFlag(),this.Flag=h.None},u.prototype.SetFullFlag=function(){this.Color.SetFullFlag(),this.Flag=h.All},u.prototype.IsFullFlag=function(){return this.Flag===h.All&&this.Color.IsFullFlag()},n.FontData=u},"./dist/plugins/floatingObject/drawing/fontFormat.js":function(F,t,n){"use strict";var e,d,i,h,r,o,a,L,B,v,u,s,P,c,f,m,G,U,l,H,V,n,g,p,z,b,i,w,y,M,C,Y,S,T,n,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at;function ut(t,n,e,i,r){var o,a,u,t,e,s,c,f,l,o=[],a=new h.Evaluator,u,t=(n.source||t.Uw()).getEvaluatorContext((0,h.eV)(e,i)),e=(0,h.h0t)(t,n,!1,0,0,!0,!0),s=a.evaluate(e||n,t,!0,!0);if(s instanceof h.CalcReference)for(c=s.getSource().getName(),f=0;f<s.getRangeCount();f++)l=p.CreateReference(c,s.getRow(f),s.getColumn(f),s.getRowCount(f),s.getColumnCount(f)),n.rowRelative&&(l.Kind|=v.ReferenceKind.RowIsRelative),n.columnRelative&&(l.Kind|=v.ReferenceKind.ColumnIsRelative),n.endRowRelative&&(l.Kind|=v.ReferenceKind.LastRowIsRelative),n.endColumnRelative&&(l.Kind|=v.ReferenceKind.LastColumnIsRelative),o.push(l);return o}function st(t,n,e,i,r){var o,a,u,o=t&&t.getCalcService();if(n&&o){a=void 0;try{u=o.parse(t.Uw(),n,0,0,!1,!1,!r),a=ut(t,u,0,0,n)}catch(t){}if(a&&0<a.length)return a[0]}return y}function A(t){this.d0t=t}function I(t,n,e,i){var t,r,t=tt.call(this,t)||this;return n===M&&(n=y),e===M&&(e=y),i===M&&(i=y),(r=t).v0t=y,r.m0t=y,r.g0t=y,r.p0t=e||"",r.b0t=i,r.InitRichTextFields(n),t}function x(t,n,e){var i,r,i=this;return n===M&&(n=y),e===M&&(e=y),(r=i=nt.call(this,n)||this).y0t=v.ThemeFont.None,r.w0t=y,r.M0t=y,r.C0t=y,r.DJ=t,r.S0t=new L.FillFormat(t,n&&n.FillInternal),r.sft=n,e&&(w(e.Size)||(r.Eft=e.Size),w(e.Bold)||(r.T0t=e.Bold)),r}function N(t,n){var e=this;e.DJ=t,e.A0t=n,e._font=new T(t),e._font.ParentStateful=n.Font}function k(t,n,e){var e,i,e=et.call(this,t,e)||this,i=e;return i.I0t=y,i.x0t=y,i._text=n,i.DJ=t,i.elementType=v.TextParagraphElementType.RegularTextRun,e}function _(t,n,e){var e,i,e=it.call(this,t,e)||this,i=e;return i.uit=n,i.d0t=t,i.N0t=new C(i.d0t),i.elementType=v.TextParagraphElementType.TextField,e}function D(t,n){var t=rt.call(this,t,n)||this;return t.elementType=v.TextParagraphElementType.TextLineBreak,t}function j(t,n){var e=this;e.k0t=y,e.D0t=y,e._0t=" ",e.DJ=t,e.v0t=n,e._font=new T(t),e._font.ParentStateful=e.v0t.Font,e.j0t=[]}function O(t,n){this.O0t=[],this.R0t=y,this.B0t=y,this.DJ=t,this.b0t=n,this._font=new T(t,y,n),this.L0t=void 0,this.F0t={top:void 0,bottom:void 0,left:void 0,right:void 0},this.P0t=void 0,this.G0t=void 0,this.U0t=void 0,this.lrt=void 0,this.H0t=void 0,this.z0t=void 0}function E(t,n){var e,i,e=ot.call(this)||this,i=e;return i.Format1=t,i.Format2=n,e}function R(t,n){var e,i,e=at.call(this)||this,i=e;return i.Format1=t,i.Format2=n,e}e=this&&this.__extends||($=function(t,n){return($=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}$(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.ComboFontFormat=t.ComboColorFormat=t.DrawingTextBody=t.DrawingTextParagraph=t.DrawingLineBreak=t.DrawingTextField=t.DrawingTextRun=t.DrawingTextElement=t.FontFormat=t.DrawingText=t.ReferenceText=void 0,i=n("Common"),h=n("CalcEngine"),r=n("Core"),o=n("./dist/plugins/floatingObject/drawing/stateful.js"),a=n("./dist/plugins/floatingObject/drawing/common.js"),L=n("./dist/plugins/floatingObject/drawing/fillFormat.js"),B=n("./dist/plugins/floatingObject/drawing/fontData.js"),v=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=r.NodeHelper.sr,s=r.NodeHelper.ur,P=r.ExcelHelper.pointToPixel,c=r.ExcelHelper.emuToPixles,f=r.ExcelHelper.pixelToEMU,m=r.mt.u1,G=r.mt.n1,U=r.mt.vo,l=r.mt.r1,H=45720,V=91440,n=i.Common.lt,g=n._h,p=a.DrawingUtility,z=p.Aft,b=a.ChartConstants,i=a.UnitHelper,w=i.isNullOrUndefined,y=null,M=void 0,Object.defineProperty(A.prototype,"Formula",{get:function(){return this.GetFormula(!1)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"FormulaR1C1",{get:function(){return this.GetFormula(!0)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Parent",{get:function(){return this.d0t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"ReferingText",{get:function(){return this.GetReferingText()},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Worksheet",{get:function(){return this.d0t.sheet()},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"TextRefer",{get:function(){return this.Y0t},set:function(t){this.SetTextRefer(t)},enumerable:!1,configurable:!0}),A.prototype.SetTextRefer=function(t,n){this.SetTextReferInternal(t,n=n===M?!0:n),this.OnSetTextRefer(t)},A.prototype.OnSetTextRefer=function(t){},A.prototype.GetReferingText=function(){var t="";return t=w(this.Y0t)?t:this.GetFirstCellText(this.Y0t)},A.prototype.GetFirstCellText=function(t){var n,n,n,n,n=this.Worksheet;return w(t.WorksheetName)&&(t.WorksheetName=n.name()),n=(n=(n=n.parent)&&n.getSheetFromName(t.WorksheetName))&&n.getText(t.Row,t.Column),w(n)?"":n},A.prototype.GetTextList=function(t){var n,e,i,r,o,a,n=[],e=this.Worksheet;for(w(t.WorksheetName)&&(t.WorksheetName=e.name()),i=e.Mnn(t.WorksheetName),r=t.Row;r<=t.LastRow;r++)for(o=t.Column;o<=t.LastColumn;o++)a=i.Snn(r,o).Text,n.push(w(a)?"":a);return n},A.prototype.SetTextReferInternal=function(t,n){this.Y0t=t},A.prototype.GetFormula=function(t){var n,e;return t===M&&(t=!1),(n=this.Y0t)?(e=this.Worksheet.name(),t?n.ToR1C1Text(e):n.ToA1Text(0,0,e)):""},A.prototype.UpdateTextByFormulas=function(t,n){this.Y0t=st(this.Worksheet,t,0,0,n=n===M?!1:n)},C=A,t.ReferenceText=C,e(I,tt=C),I.prototype.InitRichTextFields=function(t){var n,e,n=this,e=n.CreateDrawingTextBody(n.d0t,n.b0t);w(n.v0t)||n.v0t.Font.SetParentForChildren(e.Font),n.v0t=e,n.v0t.Font.ParentStateful=t,w(n.p0t)||n.v0t.AddParagraph(n.p0t)},Object.defineProperty(I.prototype,"TextBody",{get:function(){return this.v0t},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Font",{get:function(){return this.v0t.Font},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"Text",{get:function(){return w(this.TextRefer)?this.v0t.Text:this.ReferingText},set:function(t){this.SetTextInternal(t)},enumerable:!1,configurable:!0}),I.prototype.SetTextInternal=function(t){this.SetTextReferInternal(y),this.UpdateTextBody(t)},I.prototype.UpdateTextBody=function(t){this.v0t.Clear();var t=w(t)?this.p0t:t;w(t)||this.v0t.AddParagraph(t)},I.prototype.OnSetTextRefer=function(t){tt.prototype.OnSetTextRefer.call(this,t),this.UpdateTextBody(y)},I.prototype.FromOOModel=function(t){var n=this;n.m0t=t,n.InitRichTextFields(n.v0t.Font.ParentStateful),w(t.rich)||n.v0t.FromOOModel(t.rich),!w(t.strRef)&&t.strRef.f&&n.UpdateTextByFormulas(t.strRef.f)},I.prototype.FromSJSOOModel=function(t){var n=this;n.g0t=t,n.InitRichTextFields(n.v0t.Font.ParentStateful),w(t.rich)||n.v0t.FromSJSOOModel(t.rich),!w(t.strRef)&&t.strRef.f&&t.strRef.f.v_&&n.UpdateTextByFormulas(t.strRef.f.v_)},I.prototype.ToOOModel=function(t){var n,e,n=this,e=w(n.m0t)?{}:n.m0t;return w(n.Y0t)||(e.strRef={f:n.Formula}),e.rich=n.v0t.ToOOModel(t),e},I.prototype.ToSJSOOModel=function(t){var n,e,n=this,e=w(n.g0t)?{}:n.g0t;return w(n.Y0t)||(e.strRef={f:{v_:n.Formula}}),e.rich=n.v0t.ToSJSOOModel(t),e},I.prototype.SetParagraphSplitFlag=function(t){for(var n,e,i,n=this.v0t,e=0,i=n.Count;e<i;e++)n.Get(e).SplitSpaceFlag=t},I.prototype.CreateDrawingTextBody=function(t,n){return new K(t,n)},t.DrawingText=I,S={Bold:1,Color:2,Italic:4,Name:8,OutlineFont:16,Shadow:32,Size:64,Strikethrough:128,Subscript:256,Superscript:512,ThemeFont:1024,Underline:2048},nt=o.StatefulBase,e(x,nt),Object.defineProperty(x.prototype,"Bold",{get:function(){var t=this.sft;return t&&!this.GetState(S.Bold)?t.Bold:this.T0t},set:function(t){this.T0t=t,this.SetState(S.Bold,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Color",{get:function(){return this.FillInternal.Color},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Italic",{get:function(){var t=this.sft;return t&&!this.GetState(S.Italic)?t.Italic:this.Z0t},set:function(t){this.Z0t=t,this.SetState(S.Italic,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Name",{get:function(){var t=this.sft;return t&&!this.HasOwnFont()?t.Name:this.GetOwnFont()},set:function(t){this.SetFont(t),this.ClearOOFontNames()},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Size",{get:function(){var t=this.sft;return t&&!this.GetState(S.Size)?t.Size:this.Eft},set:function(t){this.Eft=t,this.SetState(S.Size,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Strikethrough",{get:function(){var t=this.sft;return t&&!this.GetState(S.Strikethrough)?t.Strikethrough:this.W0t},set:function(t){this.W0t=t,this.SetState(S.Strikethrough,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Subscript",{get:function(){var t=this.sft;return t&&!this.GetState(S.Subscript)?t.Subscript:this.Q0t},set:function(t){this.Q0t=t,this.SetState(S.Subscript,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Superscript",{get:function(){var t=this.sft;return t&&!this.GetState(S.Superscript)?t.Superscript:this.K0t},set:function(t){this.K0t=t,this.SetState(S.Superscript,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"Underline",{get:function(){var t=this.sft;return t&&!this.GetState(S.Underline)?t.Underline:this.J0t},set:function(t){this.J0t=t,this.SetState(S.Underline,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"ThemeFont",{get:function(){var t=this.sft;return t&&!this.GetState(S.ThemeFont)?t.ThemeFont:this.y0t},set:function(t){this.SetThemeFont(t),this.ClearOOFontNames()},enumerable:!1,configurable:!0}),x.prototype.IsDirtyIncludingParent=function(t){return!(!this.S0t||!this.S0t.IsDirtyIncludingParent(t))||nt.prototype.IsDirtyIncludingParent.call(this,t)},x.prototype.HasOwnFont=function(){return this.IsDirty(S.Name)||this.IsDirty(S.ThemeFont)},x.prototype.OnParentChanged=function(t){this.sft=t,this.S0t&&(this.S0t.ParentStateful=t&&t.FillInternal)},x.prototype.GetOwnFont=function(){return this.y0t===v.ThemeFont.None?this.Zc:this.DJ.Cft(this.y0t)},x.prototype.SetFont=function(t){var n=this;t===b.CHART_CS_HEAD_FONT||t===b.CHART_EA_HEAD_FONT||t===b.CHART_LATIN_HEAD_FONT?n.SetThemeFont(v.ThemeFont.Major):t===b.CHART_CS_BODY_FONT||t===b.CHART_EA_BODY_FONT||t===b.CHART_LATIN_BODY_FONT?n.SetThemeFont(v.ThemeFont.Minor):(n.Zc=t,n.SetState(S.Name,!0),n.y0t=v.ThemeFont.None,n.SetState(S.ThemeFont,!1))},x.prototype.SetThemeFont=function(t){var n=this;n.y0t=t,n.SetState(S.ThemeFont,!0),n.Zc=y,n.SetState(S.Name,!1)},x.prototype.ClearOOFontNames=function(){this.M0t=y,this.C0t=y,this.w0t=y},x.prototype.GetActualFormat=function(){var t,n,e,i,t,n=new x(this.DJ);for(e in S)if(this.IsDirty(i=S[e]))switch(i){case S.Bold:n.Bold=this.Bold;break;case S.Italic:n.Italic=this.Italic;break;case S.Name:n.Name=this.Name;break;case S.Size:n.Size=this.Size;break;case S.Strikethrough:n.Strikethrough=this.Strikethrough;break;case S.Subscript:n.Superscript=this.Superscript;break;case S.Superscript:n.Subscript=this.Subscript;break;case S.ThemeFont:n.ThemeFont=this.ThemeFont;break;case S.Underline:n.Underline=this.Underline}return n},Object.defineProperty(x.prototype,"FillInternal",{get:function(){var t=this;return t.S0t||(t.S0t=new L.FillFormat(t.DJ,t.sft&&t.sft.FillInternal)),t.S0t},enumerable:!1,configurable:!0}),x.prototype.TextCharacterProperties_FromOOModel=function(t){var n,e,n=this;n.SuspendClearChildrenState(),n.X0t=t,w(t.latin)||(n.M0t=t.latin.typeface),w(t.ea)||(n.w0t=t.ea.typeface),w(t.cs)||(n.C0t=t.cs.typeface),n.M0t?n.SetFont(n.M0t):n.w0t?n.SetFont(n.w0t):n.C0t&&n.SetFont(n.C0t),w(t.sz)||(e=t.sz,n.Eft!==e&&(n.Size=e)),w(t.b)||(n.Bold=t.b),w(t.i)||(n.Italic=t.i),w(t.strike)||(n.Strikethrough=t.strike===v.ST_TextStrikeType.sngStrike||t.strike===v.ST_TextStrikeType.dblStrike),w(t.u)||(n.Underline=t.u),w(t.baseline)||0===t.baseline?n.Subscript=!1:n.Subscript=!0,w(t.solidFill)?w(t.noFill)?w(t.blipFill)?w(t.gradFill)?w(t.pattFill)?n.SetFillField(y):n.FillInternal.FromOOModel(t.pattFill,v.ColorFillType.PatternFillProperties):n.FillInternal.FromOOModel(t.gradFill,v.ColorFillType.GradientFillProperties):n.FillInternal.FromOOModel(t.blipFill,v.ColorFillType.BlipFillProperties):n.FillInternal.Color.ColorType=v.SolidColorType.None:n.FillInternal.FromOOModel(t.solidFill,v.ColorFillType.SolidColorFillProperties),n.ResumeClearChilrenState()},x.prototype.TextCharacterProperties_FromSJSOOModel=function(t){var n,e,e,n=this;n.SuspendClearChildrenState(),w(t.latin)||(n.M0t=t.latin.typeface),w(t.ea)||(n.w0t=t.ea.typeface),w(t.cs)||(n.C0t=t.cs.typeface),n.M0t?n.SetFont(n.M0t):n.w0t?n.SetFont(n.w0t):n.C0t&&n.SetFont(n.C0t),w(t.sz)||(e=P(u(t.sz)/100),n.Eft!==e&&(n.Size=e)),w(t.b)||(n.Bold=s(t.b)),w(t.i)||(n.Italic=s(t.i)),w(t.strike)||(n.Strikethrough=v.ST_TextStrikeType[t.strike]===v.ST_TextStrikeType.sngStrike||v.ST_TextStrikeType[t.strike]===v.ST_TextStrikeType.dblStrike),w(t.u)||(n.Underline=v.ST_TextUnderlineType[t.u]),n.Subscript=!1,e=t.solidFill,w(e)?w(t.noFill)?w(t.blipFill)?w(t.gradFill)?w(t.pattFill)?n.SetFillField(y):n.FillInternal.FromSJSOOModel(t.pattFill,v.ColorFillType.PatternFillProperties):n.FillInternal.FromSJSOOModel(t.gradFill,v.ColorFillType.GradientFillProperties):n.FillInternal.FromSJSOOModel(t.blipFill,v.ColorFillType.BlipFillProperties):n.FillInternal.Color.ColorType=v.SolidColorType.None:n.FillInternal.FromSJSOOModel(e,v.ColorFillType.SolidColorFillProperties),n.ResumeClearChilrenState()},x.prototype.AdjustStateful=function(t,n){w(t)||(t.SetParentForChildren(n),w(n)||(n.ParentStateful=t.ParentStateful),t.ParentStateful=y)},x.prototype.SetFillField=function(t){this.AdjustStateful(this.S0t,t),this.S0t=t},x.prototype.TextCharacterProperties_ToOOModel=function(){var t,n,e,e,t,t=this;return t.IsDirtyIncludingParent(!0)?(n=t.X0t||{},t.IsPropDirtyIncludingParent(S.Name,!0)?(e=t.Name,w(n.latin)&&(n.latin={}),n.latin.typeface=e):t.IsPropDirtyIncludingParent(S.ThemeFont,!0)&&t.ThemeFont!==v.ThemeFont.None?(w(n.latin)&&(n.latin={}),n.latin.typeface=t.ThemeFont===v.ThemeFont.Major?b.CHART_LATIN_HEAD_FONT:b.CHART_LATIN_BODY_FONT):(t.M0t||t.w0t||t.C0t)&&(t.M0t&&(w(n.latin)&&(n.latin={}),n.latin.typeface=t.M0t),t.w0t&&(w(n.ea)&&(n.ea={}),n.ea.typeface=t.w0t),t.C0t)&&(w(n.cs)&&(n.cs={}),n.cs.typeface=t.C0t),t.IsPropDirtyIncludingParent(S.Size,!0)&&1<t.Size?n.sz=t.Size:delete n.sz,t.IsPropDirtyIncludingParent(S.Bold,!0)&&(n.b=t.Bold),t.IsPropDirtyIncludingParent(S.Italic,!0)&&(n.i=t.Italic),t.IsPropDirtyIncludingParent(S.Strikethrough,!0)&&(n.strike=t.Strikethrough?v.ST_TextStrikeType.sngStrike:v.ST_TextStrikeType.noStrike),t.IsPropDirtyIncludingParent(S.Underline,!0)&&(n.u=t.Underline),t.Subscript&&w(n.baseline)?n.baseline=-25e3:t.Superscript&&w(n.baseline)?n.baseline=3e4:t.Subscript||t.Superscript||delete n.baseline,z(n),!w(t.S0t)&&t.S0t.IsDirtyIncludingParent(!0)&&((t=(e=t.S0t.ToOOModel()).colorFillType)===v.ColorFillType.SolidColorFillProperties?n.solidFill=e:t===v.ColorFillType.PatternFillProperties?n.pattFill=e:t===v.ColorFillType.GradientFillProperties?n.gradFill=e:t===v.ColorFillType.BlipFillProperties?n.blipFill=e:t===v.ColorFillType.NoFillProperties&&(n.noFill=!0),delete e.colorFillType),n):{}},x.prototype.TextCharacterProperties_ToSJSOOModel=function(){var t,n,e,t=this;return t.IsDirtyIncludingParent(!0)?(n={},!w(t.S0t)&&t.S0t.IsDirtyIncludingParent(!0)&&t.S0t.ToSJS_FillGroup(n),t.IsPropDirtyIncludingParent(S.Name,!0)?(e=t.Name,w(n.latin)&&(n.latin={}),n.latin.typeface=l(e)):t.IsPropDirtyIncludingParent(S.ThemeFont,!0)&&t.ThemeFont!==v.ThemeFont.None?(w(n.latin)&&(n.latin={}),n.latin.typeface=l(t.ThemeFont===v.ThemeFont.Major?b.CHART_LATIN_HEAD_FONT:b.CHART_LATIN_BODY_FONT)):(t.M0t||t.w0t||t.C0t)&&(t.M0t&&(w(n.latin)&&(n.latin={}),n.latin.typeface=l(t.M0t)),t.w0t&&(w(n.ea)&&(n.ea={}),n.ea.typeface=l(t.w0t)),t.C0t)&&(w(n.cs)&&(n.cs={}),n.cs.typeface=l(t.C0t)),t.IsPropDirtyIncludingParent(S.Size,!0)&&1<t.Size?n.sz=Math.round(100*r.ExcelHelper.pixelToPoint(t.Size))+"":delete n.sz,t.IsPropDirtyIncludingParent(S.Bold,!0)&&(n.b=t.Bold?"1":"0"),t.IsPropDirtyIncludingParent(S.Italic,!0)&&(n.i=t.Italic?"1":"0"),t.IsPropDirtyIncludingParent(S.Strikethrough,!0)&&(n.strike=t.Strikethrough?v.ST_TextStrikeType[1]:v.ST_TextStrikeType[0]),t.IsPropDirtyIncludingParent(S.Underline,!0)&&(n.u=v.ST_TextUnderlineType[t.Underline]),t.Subscript&&w(n.baseline)?n.baseline=-25e3:t.Superscript&&w(n.baseline)?n.baseline=3e4:t.Subscript||t.Superscript||delete n.baseline,n):{}},x.prototype.FromOOModel=function(t){var n=this;n.Bold=t.Bold,n.Italic=t.Italic,n.Name=t.Name,t.Scheme!==v.ThemeFont.None&&(n.ThemeFont=t.Scheme),n.Size=t.Size,n.Underline=p.ConvertToTextUnderlineType(t.Underline),n.Strikethrough=t.Strike,n.Subscript=(t.VertAlign&v.VertAlignType.Subscript)===v.VertAlignType.Subscript,n.Superscript=(t.VertAlign&v.VertAlignType.Superscript)===v.VertAlignType.Superscript,n.FillInternal.ColorInternal.ColorData_FromOOModel(t.Color)},x.prototype.FromSJSOOModel=function(t){this.FromOOModel(t)},x.prototype.ToOOModel=function(){var t,n,t,t=this,n=new B.FontData;return n.Bold=t.Bold,n.Italic=t.Italic,n.Name=t.Name,n.Scheme=t.ThemeFont,n.Size=t.Size,n.Underline=p.ToUnderlineType(t.Underline),n.Strike=t.Strikethrough,t.Subscript?n.VertAlign=v.VertAlignType.Subscript:t.Superscript&&(n.VertAlign=v.VertAlignType.Superscript),(t=t.S0t)&&t.ColorInternal.IsDirtyIncludingParent(!0)&&t.ColorInternal.ColorType!==v.SolidColorType.None&&(n.Color=t.ColorInternal.ColorData_ToOOModel()),n},x.prototype.ToSJSOOModel=function(){this.ToOOModel()},T=x,t.FontFormat=T,Object.defineProperty(N.prototype,"Font",{get:function(){return this._font},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"Text",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"IsCustomText",{get:function(){return!1},enumerable:!1,configurable:!0}),N.prototype.Delete=function(){this.A0t.DeleteElement(this),this.A0t=y},N.prototype.FromOOModel=function(t){},N.prototype.ToOOModel=function(){},N.prototype.ToSJSOOModel=function(){},t.DrawingTextElement=n=N,e(k,et=n),Object.defineProperty(k.prototype,"Text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!1,configurable:!0}),k.prototype.FromOOModel=function(t){var n=this;n.I0t=t,n._text=t.t,w(t.rPr)?n._font=new T(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromOOModel(t.rPr)},k.prototype.FromSJSOOModel=function(t){var n=this;n.x0t=t,n._text=G(t.t.v_),w(t.rPr)?n._font=new T(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromSJSOOModel(t.rPr)},k.prototype.ToOOModel=function(){var t=this.I0t||{elementType:v.TextParagraphElementType.RegularTextRun};return t.t=this.Text,t.rPr=this._font.TextCharacterProperties_ToOOModel(),t},k.prototype.ToSJSOOModel=function(){var t=this.x0t||{};return t.rPr=this._font.TextCharacterProperties_ToSJSOOModel(),t.t={v_:U(this.Text)},t},Z=k,t.DrawingTextRun=Z,e(_,it=n),Object.defineProperty(_.prototype,"Type",{get:function(){return this.uit},set:function(t){this.uit=t},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Text",{get:function(){return this.Type===v.TextFieldType.TxLink?this.N0t.ReferingText:p.GetTextFieldTypeText(this.Type)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"Worksheet",{get:function(){return this.d0t&&this.d0t.Parent},enumerable:!1,configurable:!0}),_.prototype.FromOOModel=function(t){var n=this;n.cft=t,n.Type=p.GetTextFieldType(t.type),w(t.rPr)?n._font=new T(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromOOModel(t.rPr)},_.prototype.FromSJSOOModel=function(t){var n=this;n.fft=t,n.Type=p.GetTextFieldType(t.type),w(t.rPr)?n._font=new T(n.DJ,n._font.ParentStateful):n._font.TextCharacterProperties_FromSJSOOModel(t.rPr)},_.prototype.q0t=function(){var t;return("{"+this.$0t(8)+"-"+this.$0t(4)+"-"+this.$0t(4)+"-"+this.$0t(4)+"-"+this.$0t(12)+"}").toUpperCase()},_.prototype.$0t=function(t){return Math.random().toString(16).slice(-t)},_.prototype.ToOOModel=function(){var t,n,e,t=this,n=t.cft||{elementType:v.TextParagraphElementType.TextField},e=/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/;return(w(n.id)||n.id&&!e.test(n.id))&&(n.id=this.q0t()),n.type=p.GetTextFieldTypeString(t.Type),w(n.rPr)&&(n.rPr={}),n.rPr=t._font.TextCharacterProperties_ToOOModel(),n.t=t.Text,n},_.prototype.ToSJSOOModel=function(){var t,n,e,t=this,n=t.fft||{},e=/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/;return(w(n.id)||n.id&&!e.test(n.id))&&(n.id=this.q0t()),n.type=p.GetTextFieldTypeString(t.Type),w(n.rPr)&&(n.rPr={}),n.rPr=t._font.TextCharacterProperties_ToSJSOOModel(),n.t={v_:U(t.Text)},n},_.prototype.UpdateTextByFormulas=function(t,n){this.N0t.UpdateTextByFormulas(t,n)},W=_,t.DrawingTextField=W,e(D,rt=n),Object.defineProperty(D.prototype,"Text",{get:function(){return"\r\n"},enumerable:!1,configurable:!0}),D.prototype.FromOOModel=function(t){this.cft=t},D.prototype.FromSJSOOModel=function(t){this.fft=t},D.prototype.ToOOModel=function(){return this.cft||{elementType:v.TextParagraphElementType.TextLineBreak}},D.prototype.ToSJSOOModel=function(){return this.fft||{}},Q=D,t.DrawingLineBreak=Q,Object.defineProperty(j.prototype,"SplitSpaceFlag",{get:function(){return this._0t},set:function(t){this._0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"Algn",{get:function(){return this.E0t},set:function(t){this.E0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"Text",{get:function(){for(var t,n,e,i,t="",n=0,e=this.j0t;n<e.length;n++)i=e[n],w(i.Text)||(t+=i.Text);return t},set:function(t){this.Clear(),this.AddRun(t)},enumerable:!1,configurable:!0}),j.prototype.Get=function(t){return this.j0t[t]},Object.defineProperty(j.prototype,"Count",{get:function(){return this.j0t.length},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"Font",{get:function(){return this._font},enumerable:!1,configurable:!0}),j.prototype.AddRun=function(t,n){return this.AddRunInternal(t,n)},j.prototype.AddField=function(t){return this.AddFieldInternal(t)},j.prototype.Clear=function(){for(var t,n,e,t=0,n=this.j0t;t<n.length;t++)(e=n[t]).Font.ParentStateful=y;this.j0t.length=0},j.prototype.FromOOModel=function(t){var n,e,i,r,o,a,u,s,n=this;if((n.k0t=t).pPr&&n.FromParagraphProperties(t.pPr),t.elements)for(e=t.elements.length,i=n.j0t=[],r=n.DJ,o=0;o<e;o++)s=void 0,(u=(a=t.elements[o]).elementType)===v.TextParagraphElementType.RegularTextRun?s=n.CreateDrawingTextRun(r,a.t):u===v.TextParagraphElementType.TextLineBreak?s=n.CreateDrawingLineBreak(r):u===v.TextParagraphElementType.TextField&&(s=n.CreateDrawingTextField(r,p.GetTextFieldType(a.type))),s&&(s.FromOOModel(a),i.push(s))},j.prototype.FromSJSOOModel=function(t){var i,r,o,i=this;i.D0t=t,r=i.j0t=[],o=i.DJ,t.c_&&t.c_.forEach(function(t){var n,e;t.pPr?i.FromSJSParagraphProperties(t.pPr):t.r?(n=i.CreateDrawingTextRun(o,t.r.t?t.r.t.v_:""),e=t.r):t.br?(n=i.CreateDrawingLineBreak(o),e=t.br):t.fld&&(n=i.CreateDrawingTextField(o,p.GetTextFieldType(t.fld.type)),e=t.fld),n&&(n.FromSJSOOModel(e),r.push(n))})},j.prototype.FromParagraphProperties=function(t){var n;t&&(n=this,w(t.algn)||(n.E0t=t.algn),t.defRPr)&&n._font.TextCharacterProperties_FromOOModel(t.defRPr)},j.prototype.FromSJSParagraphProperties=function(t){var n;t&&(n=this,w(t.algn)||(n.E0t=v.ST_TextAlignType[t.algn]),t.defRPr)&&n._font.TextCharacterProperties_FromSJSOOModel(t.defRPr)},j.prototype.ToParagraphProperties=function(t){var n=this;return w(n.E0t)||(t.algn=n.E0t),w(n._font)||(t.defRPr=n._font.TextCharacterProperties_ToOOModel()),t},j.prototype.ToSJSParagraphProperties=function(t){var n=this;return w(n.E0t)||0===n.E0t||(t.algn=v.ST_TextAlignType[n.E0t]),w(n._font)||(t.defRPr=n._font.TextCharacterProperties_ToSJSOOModel()),t},j.prototype.AddRunInternal=function(t,n){var e,e,t,e=this;return n===M&&(n=-1),e=e.CreateDrawingTextRun(e.DJ,t),t=this.j0t,n<0||n>=t.length?t.push(e):t.splice(n,0,e),e},j.prototype.AddFieldInternal=function(t){var t=this.CreateDrawingTextField(this.DJ,t);return this.j0t.push(t),t},j.prototype.ToOOModel=function(){var t,n,e,i,r,o,t=this,n=t.k0t||{elements:[]};for(n.pPr=t.ToParagraphProperties(n.pPr||{}),e=n.elements=[],i=0,o=(r=t.j0t).length;i<o;i++)e.push(r[i].ToOOModel());return(t.DJ.DrawingType===v.DrawingType.Chart||w(t.k0t))&&w(n.endParaRPr)&&(n.endParaRPr={}),n},j.prototype.ToSJSOOModel=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.D0t||{n_:"p",c_:[]},e=m(n,"pPr")||{},i=m(n,"endParaRPr")||{};for(n.c_=[],t.ToSJSParagraphProperties(e),n.c_.push({pPr:e}),r=0,a=(o=t.j0t).length;r<a;r++)u=o[r].elementType,s=o[r].ToSJSOOModel(),u===v.TextParagraphElementType.RegularTextRun?n.c_.push({r:s}):u===v.TextParagraphElementType.TextLineBreak?n.c_.push({br:s}):u===v.TextParagraphElementType.TextField&&n.c_.push({fld:s});return n.c_.push({endParaRPr:i}),n},j.prototype.To2016ChartOOModel=function(){var t,n,e,i,r,o,a,t=this,n=t.k0t||{elements:[]};for(n.pPr||(n.pPr={}),e=n.pPr,w(t._font)||(e.defRPr=t._font.TextCharacterProperties_ToOOModel()),i=n.elements=[],r=0,a=(o=t.j0t).length;r<a;r++)i.push(o[r].ToOOModel());return w(t._font)||(n.endParaRPr=t._font.TextCharacterProperties_ToOOModel()),n},j.prototype.To2016ChartSJSOOModel=function(){var t,n,t=this,n=t.ToSJSOOModel();return w(t._font)||(n.c_[n.c_.length-1].endParaRPr=t._font.TextCharacterProperties_ToSJSOOModel()),n},j.prototype.Delete=function(){for(var t,n,t=this,n=t.j0t.length-1;0<=n;n--)t.DeleteElement(t.j0t[n]);t.v0t.DeleteParagraph(t),t.v0t=y},j.prototype.DeleteElement=function(t){t.Font.ParentStateful=y;var t=this.j0t.indexOf(t);0<=t&&this.j0t.splice(t,1)},j.prototype.CreateDrawingTextRun=function(t,n){return new Z(t,n,this)},j.prototype.CreateDrawingLineBreak=function(t){return new Q(t,this)},j.prototype.CreateDrawingTextField=function(t,n){return new W(t,n,this)},J=j,t.DrawingTextParagraph=J,Object.defineProperty(O.prototype,"Text",{get:function(){for(var t,n,e,i,t="",n=0,e=this.O0t;n<e.length;n++)""!==t&&(t+="\r\n"),t+=(i=e[n]).Text;return t},set:function(t){this.Clear(),this.AddParagraph(t)},enumerable:!1,configurable:!0}),O.prototype.Get=function(t){return this.O0t[t]},Object.defineProperty(O.prototype,"Count",{get:function(){return this.O0t.length},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"Font",{get:function(){return this._font},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"Rotation",{get:function(){return this.L0t},set:function(t){this.L0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"Inset",{get:function(){return this.F0t},set:function(t){this.F0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"anchorCtr",{get:function(){return this.P0t},set:function(t){this.P0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"anchor",{get:function(){return this.G0t},set:function(t){this.G0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"vert",{get:function(){return this.U0t},set:function(t){this.U0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"wrap",{get:function(){return this.lrt},set:function(t){this.lrt=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"horzOverflow",{get:function(){return this.H0t},set:function(t){this.H0t=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"vertOverflow",{get:function(){return this.z0t},set:function(t){this.z0t=t},enumerable:!1,configurable:!0}),O.prototype.setFontColor=function(t,n){var e,i,r,e=this,i=e.O0t.length;for(e._font&&e._font.Color.setColor(t,n),r=0;r<i;r++)e.O0t[r].Font.Color.setColor(t,n)},O.prototype.setFontTransparency=function(t){var n,e,i,n=this,e=n.O0t.length;for(n._font&&(n._font.Color.Transparency=t),i=0;i<e;i++)n.O0t[i].Font.Color.Transparency=t},O.prototype.updateFont=function(n,e,i,r){var t,o,t=this,o=[t._font];t.O0t.forEach(function(t){o.push(t.Font)}),o.forEach(function(t){t&&(t.Name=n,t.Size=e,t.Bold=i,t.Italic=r)})},O.prototype.AddParagraph=function(t,n){var e,t;return n===M&&(n=-1),e=this.CreateDrawingTextParagraph(this.DJ),w(t)||e.AddRun(t),t=this.O0t,n<0||n>=t.length?t.push(e):t.splice(n,0,e),e},O.prototype.Clear=function(){for(var t,n,e,t=0,n=this.O0t;t<n.length;t++)(e=n[t]).Font.ParentStateful=y;this.O0t.length=0},O.prototype.ToOOModel=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.R0t||{p:[]},i=this.O0t,r=i.length;if(0===r&&!this._font.IsDirtyIncludingParent())return y;if(o=e.p=[],0<r)for(a=0;a<r;a++)u=i[a],o.push(t?u.To2016ChartOOModel():u.ToOOModel());else(c=(s=n.CreateDrawingTextParagraph(n.DJ)).ToOOModel()).pPr.defRPr=n._font.TextCharacterProperties_ToOOModel(),o.push(c);return e.bodyPr=n.t1t(e.bodyPr||{}),w(e.lstStyle)&&(e.lstStyle={}),e},O.prototype.ToSJSOOModel=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.B0t||{bodyPr:{},p:[]},i=this.O0t,r=i.length;if(0===r&&!this._font.IsDirtyIncludingParent())return y;if(e.bodyPr=n.n1t(e.bodyPr||{}),o=e.p=[],0<r)for(a=0;a<r;a++)u=i[a],o.push(t?u.To2016ChartSJSOOModel():u.ToSJSOOModel());else(c=(s=n.CreateDrawingTextParagraph(n.DJ)).ToSJSOOModel()).c_[0].pPr.defRPr=n._font.TextCharacterProperties_ToSJSOOModel(),o.push(c);return e},O.prototype.FromOOModel=function(t){var n,e,i,r,o,a,a,o,u,s,c,f,l,h,n=this;for(n.R0t=t,e=0,i=n.O0t;e<i.length;e++)(r=i[e]).Clear();if(n.O0t.length=0,o=new T(n.DJ,y,n.b0t),(a=n._font)&&(a.SetParentForChildren(o),o.ParentStateful=a.ParentStateful,a.ParentStateful=y),n._font=o,t.p&&t.p.length)for(a=t.p[0].pPr,o=t.p[0].elements&&t.p[0].elements[0]&&t.p[0].elements[0].rPr,u=t.p[0].endParaRPr,s=void 0,a&&a.defRPr&&!g(a.defRPr)?s=d(d({},a.defRPr),o):u&&!g(u)?s=u:o&&!g(o)&&(s=o),s&&n._font.TextCharacterProperties_FromOOModel(s),c=0,f=t.p;c<f.length;c++)l=f[c],(h=n.CreateDrawingTextParagraph(n.DJ)).FromOOModel(l),n.O0t.push(h);n.e1t(t.bodyPr)},O.prototype.FromSJSOOModel=function(t){var n,e,i,r,o,a,a,o,u,u,a,s,c,f,l,h,n=this;for(n.B0t=t,e=0,i=n.O0t;e<i.length;e++)(r=i[e]).Clear();if(n.O0t.length=0,o=new T(n.DJ,y,n.b0t),(a=n._font)&&(a.SetParentForChildren(o),o.ParentStateful=a.ParentStateful,a.ParentStateful=y),n._font=o,t.p=t.p&&[].concat(t.p),t.p&&t.p.length)for(a=t.p[0],o=m(a,"pPr"),u=(u=m(a,"r")||m(a,"br")||m(a,"fld"))&&u.rPr,a=m(a,"endParaRPr"),s=void 0,o&&o.defRPr&&!g(o.defRPr)?s=d(d({},o.defRPr),u):a&&!g(a)?s=a:u&&!g(u)&&(s=u),s&&n._font.TextCharacterProperties_FromSJSOOModel(s),c=0,f=t.p;c<f.length;c++)l=f[c],(h=n.CreateDrawingTextParagraph(n.DJ)).FromSJSOOModel(l),n.O0t.push(h);n.i1t(t.bodyPr)},O.prototype.e1t=function(t){var n,e,e,e,e,e,e,e,e;t&&(n=this,e=t.rot,w(e)||(n.L0t=e),e=t.anchorCtr,w(e)||(n.P0t=e),e=t.anchor,w(e)||(n.G0t=e),e=t.vert,w(e)||(n.U0t=e),e=t.wrap,w(e)||(n.lrt=e),e=t.horzOverflow,w(e)||(n.H0t=e),e=t.vertOverflow,w(e)||(n.z0t=e),e=n.F0t,w(t.tIns)||(e.top=c(t.tIns,6)),w(t.bIns)||(e.bottom=c(t.bIns,6)),w(t.lIns)||(e.left=c(t.lIns,6)),w(t.rIns)||(e.right=c(t.rIns,6)))},O.prototype.t1t=function(t){var n,e,e,e,e,e,e,e,e,n=this,e=n.Rotation;return w(e)||(t.rot=e),e=n.P0t,w(e)||(t.anchorCtr=e),e=n.G0t,w(e)||(t.anchor=e),e=n.U0t,w(e)||(t.vert=e),e=n.lrt,w(e)||(t.wrap=e),e=n.H0t,w(e)||(t.horzOverflow=e),e=n.z0t,w(e)||(t.vertOverflow=e),e=n.F0t,w(e.top)||(t.tIns=f(e.top)),w(e.bottom)||(t.bIns=f(e.bottom)),w(e.left)||(t.lIns=f(e.left)),w(e.right)||(t.rIns=f(e.right)),t},O.prototype.i1t=function(t){var n,e,e,n=this;t.rot?(e=u(t.rot),w(e)||-6e7===e||(n.L0t=e/6e4)):v.ST_TextVerticalType[t.vert]===v.ST_TextVerticalType.horz&&(n.L0t=0),w(t.anchorCtr)||(n.P0t=s(t.anchorCtr)),w(t.anchor)||(n.G0t=v.ST_TextAnchoringType[t.anchor]),w(t.vert)||(n.U0t=v.ST_TextVerticalType[t.vert]),w(t.wrap)||(n.lrt=v.ST_TextWrappingType[t.wrap]),w(t.horzOverflow)||(n.H0t=v.ST_TextHorzOverflowType[t.horzOverflow]),w(t.vertOverflow)||(n.z0t=v.ST_TextVertOverflowType[t.vertOverflow]),e=n.F0t,w(t.tIns)||(e.top=c(u(t.tIns),6)),w(t.bIns)||(e.bottom=c(u(t.bIns),6)),w(t.lIns)||(e.left=c(u(t.lIns),6)),w(t.rIns)||(e.right=c(u(t.rIns),6))},O.prototype.n1t=function(t){var n,e,e,i,i,i,i,n=this,e=n.Rotation;return w(e)||0===e||(t.rot=6e4*parseInt(e+"",10)),e=n.F0t,w(e.top)||(i=f(e.top))!==H&&(t.tIns=i),w(e.bottom)||(i=f(e.bottom))!==H&&(t.bIns=i),w(e.left)||(i=f(e.left))!==V&&(t.lIns=i),w(e.right)||(i=f(e.right))!==V&&(t.rIns=i),!0===n.P0t&&(t.anchorCtr="1"),w(n.G0t)||0===n.G0t||(t.anchor=v.ST_TextAnchoringType[n.G0t]),w(n.U0t)||(t.vert=v.ST_TextVerticalType[n.U0t]),w(n.lrt)||0===n.lrt||(t.wrap=v.ST_TextWrappingType[n.lrt]),w(n.horzOverflow)||0===n.horzOverflow||(t.horzOverflow=v.ST_TextHorzOverflowType[n.horzOverflow]),w(n.vertOverflow)||0===n.vertOverflow||(t.vertOverflow=v.ST_TextVertOverflowType[n.vertOverflow]),t},O.prototype.Delete=function(){for(var t=this.O0t,n=t.length-1;0<=n;n--)this.DeleteParagraph(t[n])},O.prototype.DeleteParagraph=function(t){t.Font.ParentStateful=y;var t=this.O0t.indexOf(t);0<=t&&this.O0t.splice(t,1)},O.prototype.CreateDrawingTextParagraph=function(t){return new J(t,this)},K=O,t.DrawingTextBody=K,ot=o.StatefulBase,e(E,ot),Object.defineProperty(E.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"Brightness",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(v.ColorFormatStates.Brightness,!1)?t.Format2:t.Format1).Brightness},set:function(t){this.Format1.Brightness=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"ColorType",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(v.ColorFormatStates.ColorType,!1)?t.Format2:t.Format1).ColorType},set:function(t){this.Format1.ColorType=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"ObjectThemeColor",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(v.ColorFormatStates.ObjectThemeColor,!1)?t.Format2:t.Format1).ObjectThemeColor},set:function(t){this.Format1.ObjectThemeColor=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"RGB",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(v.ColorFormatStates.RGB,!1)?t.Format2:t.Format1).RGB},set:function(t){this.Format1.RGB=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"TintAndShade",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(v.ColorFormatStates.TintAndShade,!1)?t.Format2:t.Format1).TintAndShade},set:function(t){this.Format1.TintAndShade=t},enumerable:!1,configurable:!0}),E.prototype.GetState=function(){},E.prototype.SetState=function(){},E.prototype.IsDirtyIncludingParent=function(){},E.prototype.IsPropDirtyIncludingParent=function(t,n){return this.Stateful1.IsPropDirtyIncludingParent(t,n)||this.Stateful2.IsPropDirtyIncludingParent(t,n)},E.prototype.Dirty=function(){},E.prototype.UnDirty=function(){},E.prototype.SuspendClearChildrenState=function(){},E.prototype.ResumeClearChilrenState=function(){},E.prototype.AddChildInternal=function(){},E.prototype.RemoveChildInternal=function(){},X=E,t.ComboColorFormat=X,at=o.StatefulBase,e(R,at),Object.defineProperty(R.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Bold",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Bold,!1)?t.Format2:t.Format1).Bold},set:function(t){this.Format1.Bold=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Color",{get:function(){return new X(this.Format1.Color,this.Format2.Color)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Italic",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Italic,!1)?t.Format2:t.Format1).Bold},set:function(t){this.Format1.Bold=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Name",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Name,!1)?t.Format2:t.Format1).Name},set:function(t){this.Format1.Name=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Size",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Size,!1)?t.Format2:t.Format1).Size},set:function(t){this.Format1.Size=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Strikethrough",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Strikethrough,!1)?t.Format2:t.Format1).Strikethrough},set:function(t){this.Format1.Strikethrough=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Subscript",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Subscript,!1)?t.Format2:t.Format1).Subscript},set:function(t){this.Format1.Subscript=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Superscript",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Superscript,!1)?t.Format2:t.Format1).Superscript},set:function(t){this.Format1.Superscript=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"ThemeFont",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.ThemeFont,!1)?t.Format2:t.Format1).ThemeFont},set:function(t){this.Format1.ThemeFont=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"Underline",{get:function(){var t=this;return(!w(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(S.Underline,!1)?t.Format2:t.Format1).Underline},set:function(t){this.Format1.Underline=t},enumerable:!1,configurable:!0}),R.prototype.GetState=function(){},R.prototype.SetState=function(){},R.prototype.IsDirtyIncludingParent=function(){},R.prototype.IsPropDirtyIncludingParent=function(t,n){return this.Stateful1.IsPropDirtyIncludingParent(t,n)||this.Stateful2.IsPropDirtyIncludingParent(t,n)},R.prototype.Dirty=function(){},R.prototype.UnDirty=function(){},R.prototype.SuspendClearChildrenState=function(){},R.prototype.ResumeClearChilrenState=function(){},R.prototype.AddChildInternal=function(){},R.prototype.RemoveChildInternal=function(){},t.ComboFontFormat=R},"./dist/plugins/floatingObject/drawing/gradient.js":function(t,n,e){"use strict";var i,a,g,p,r,o,u,s,c,f,l;function h(t){this.r1t=t,this._x=new g.ColorFormat(this.r1t)}function d(t){this.o1t=t,this.a1t=[]}function b(t,n,e){var t=new c(t);return t.Position=n,t.Color=e,t}function w(t){return a.ARGBColor.FromArgb(t)}function v(){}Object.defineProperty(n,"__esModule",{value:!0}),n.PresetGradientUtility=n.GradientStops=n.GradientStop=void 0,i=e("./dist/plugins/floatingObject/drawing/common.js"),a=e("./dist/plugins/floatingObject/drawing/color.js"),g=e("./dist/plugins/floatingObject/drawing/colorFormat.js"),p=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),r=e("Core"),o=i.DrawingConstants.PositionConver,u=i.gft,s=void 0,Object.defineProperty(h.prototype,"Color",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"Position",{get:function(){return this.u_},set:function(t){this.u_=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"Transparency",{get:function(){return this._x.Transparency},set:function(t){this._x.Transparency=t},enumerable:!1,configurable:!0}),h.prototype.FromOOModel=function(t){this.Position=t.pos/o,this._x.FromOOModel(t)},h.prototype.FromSJSOOModel=function(t){var n=r.NodeHelper.sr(t.pos,o);this.Position=n/o,this._x.FromSJSOOModel(t)},h.prototype.ToOOModel=function(){var t=this._x.ToOOModel();return t.pos=Math.round(this.Position*o),t},h.prototype.ToSJSOOModel=function(){var t=this._x.ToSJSOOModel();return delete t.colorFillType,t.pos=Math.round(this.Position*o),t},c=h,n.GradientStop=c,d.prototype.Item=function(t){return this.a1t[t]},Object.defineProperty(d.prototype,"Count",{get:function(){return this.a1t.length},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"GradientStopList",{get:function(){return this.a1t},enumerable:!1,configurable:!0}),d.prototype.Delete=function(t){-1===t&&(t=this.Count-1),this.a1t.splice(t,1)},d.prototype.Insert=function(t,n,e,i,r){e===s&&(e=0),i===s&&(i=-1),r===s&&(r=0);var o=new c(this.o1t);o.Color.RGB=a.ARGBColor.FromArgb(t),o.Position=n,o.Transparency=e,o.Color.Brightness=r,i<0?this.a1t.push(o):this.a1t.splice(i,0,o)},d.prototype.FromOOModel=function(t){for(var n,e,i,r,n=0,e=t.gs;n<e.length;n++)i=e[n],(r=new c(this.o1t)).FromOOModel(i),this.GradientStopList.push(r)},d.prototype.FromSJSOOModel=function(t){for(var n,e,i,r,o,n,e=0,i=u(t.gs);e<i.length;e++)r=i[e],(o=new c(this.o1t)).FromSJSOOModel(r),this.GradientStopList.push(o)},d.prototype.ToOOModel=function(){for(var t,n,e,i,t={gs:[]},n=0,e=this.a1t;n<e.length;n++)i=e[n],t.gs.push(i.ToOOModel());return t},d.prototype.ToSJSOOModel=function(){for(var t,n,e,i,t={gs:[]},n=0,e=this.a1t;n<e.length;n++)i=e[n],t.gs.push(i.ToSJSOOModel());return t},f=d,n.GradientStops=f,v.InitGradientStopPresetColor=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,m=n.GradientStops.GradientStopList;switch(n.PresetGradientType){case p.PresetGradientType.GradientEarlySunset:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(130))),i=b(t,.3,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(6684815))),r=b(t,.64999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12189798))),o=b(t,.89999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16711680))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16744960))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientLateSunset:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(0))),i=b(t,.2,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(64))),r=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(4194368))),o=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(9371712))),a=b(t,.89999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15889152))),u=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16760576))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u);break;case p.PresetGradientType.GradientNightfall:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(0))),i=b(t,.39999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(660108))),r=b(t,.7,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(1580231))),o=b(t,.88,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(7341524))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(9190801))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientDaybreak:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(6201087))),i=b(t,.39999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8766207))),r=b(t,.7,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12900075))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16772090))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientHorizon:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(14478325))),i=b(t,.08,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8628163))),r=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(7770041))),o=b(t,.21001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8628163))),a=b(t,.52,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))),u=b(t,.56,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10249571))),s=b(t,.58,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8400941))),c=b(t,.71001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12603982))),f=b(t,.94,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15456980))),l=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(5580316))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l);break;case p.PresetGradientType.GradientDesert:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16555979))),i=b(t,.87,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16298057))),r=b(t,.78999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16298057))),o=b(t,.37,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16705522))),a=b(t,.33,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16339616))),u=b(t,.31,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12912713))),s=b(t,.17999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(11812485))),c=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16298057))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientOcean:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(251048))),i=b(t,.25,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(2217696))),r=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(34790))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(23743))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientCalmWater:e=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13421823))),i=b(t,.41001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10079487))),r=b(t,.32,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10053375))),o=b(t,.195,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13408767))),a=b(t,.8999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10079487))),u=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13421823))),s=b(t,.59,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10079487))),c=b(t,.68,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10053375))),f=b(t,.805,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13408767))),l=b(t,.91001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10079487))),h=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13421823))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l),m.push(h);break;case p.PresetGradientType.GradientFire:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16773632))),i=b(t,.45,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16742912))),r=b(t,.7,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16712448))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(5048328))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientFog:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8685764))),i=b(t,.53,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13950719))),r=b(t,.83,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13950719))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(9874324))),m.push(e),m.push(i),m.push(r),m.push(o);break;case p.PresetGradientType.GradientMoss:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(14543823))),i=b(t,.25,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10270830))),r=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(1403667))),o=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(14543823))),a=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10270830))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientPeacock:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(3381759))),i=b(t,.16,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(52428))),r=b(t,.47,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10066431))),o=b(t,.60001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(3041170))),a=b(t,.71001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(3355596))),u=b(t,.81,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(1143039))),s=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(26265))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s);break;case p.PresetGradientType.GradientWheat:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16509639))),i=b(t,.17999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16705522))),r=b(t,.36,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16435069))),o=b(t,.61,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16492925))),a=b(t,.82001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16503964))),u=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16705522))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u);break;case p.PresetGradientType.GradientParchment:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16773073))),i=b(t,.64999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15789013))),r=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13747103))),m.push(e),m.push(i),m.push(r);break;case p.PresetGradientType.GradientMahogany:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(14070172))),i=b(t,.15,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13934188))),r=b(t,.35,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10900776))),o=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(6696978))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(14070172))),u=b(t,.85,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13934188))),s=b(t,.65,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10900776))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s);break;case p.PresetGradientType.GradientRainbow:e=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10879915))),i=b(t,.395,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(530939))),r=b(t,.32499,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(1740104))),o=b(t,.24,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16776960))),a=b(t,.135,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15613719))),u=b(t,.6,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15210342))),s=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10879915))),c=b(t,.60501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(530939))),f=b(t,.67501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(1740104))),l=b(t,.76,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16776960))),h=b(t,.865,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15613719))),d=b(t,.94,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15210342))),v=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10879915))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l),m.push(h),m.push(d),m.push(v);break;case p.PresetGradientType.GradientRainbowII:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16724889))),i=b(t,.25,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16737843))),r=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16776960))),o=b(t,.75,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(108431))),a=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(3368703))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a);break;case p.PresetGradientType.GradientGold:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15129772))),i=b(t,.12,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15128458))),r=b(t,.3,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13085772))),o=b(t,.45,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15128458))),a=b(t,.77,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13085772))),u=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15129772))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u);break;case p.PresetGradientType.GradientGoldII:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16508078))),i=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12423722))),r=b(t,.21001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12423722))),o=b(t,.63,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16508078))),a=b(t,.67,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(12423722))),u=b(t,.69,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8609303))),s=b(t,.82001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(10651977))),c=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16442295))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientBrass:e=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8541696))),i=b(t,.87,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16754688))),r=b(t,.72,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8541696))),o=b(t,.57001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16754688))),a=b(t,.42,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8541696))),u=b(t,.28,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16754688))),s=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8541696))),c=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16754688))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientChrome:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))),i=b(t,.16,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(2039583))),r=b(t,.17999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))),o=b(t,.42,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(6513507))),a=b(t,.53,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13619151))),u=b(t,.66,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13619151))),s=b(t,.75999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(2039583))),c=b(t,.78999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))),f=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8355711))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f);break;case p.PresetGradientType.GradientChromeII:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(13355979))),i=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(6250335))),r=b(t,.21001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(6250335))),o=b(t,.63,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))),a=b(t,.67,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(11711154))),u=b(t,.69,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(2697513))),s=b(t,.82001,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(7829367))),c=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15395562))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c);break;case p.PresetGradientType.GradientSilver:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))),i=b(t,.03501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15132390))),r=b(t,.16,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8225942))),o=b(t,.235,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15132390))),a=b(t,.42501,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8225942))),u=b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15132390))),s=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15132390))),c=b(t,.965,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15132390))),f=b(t,.84,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8225942))),l=b(t,.765,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(15132390))),h=b(t,.575,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(8225942))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c),m.push(f),m.push(l),m.push(h);break;case p.PresetGradientType.GradientSapphire:e=b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(130))),i=b(t,.13,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(18431))),r=b(t,.28,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(130))),o=b(t,.42999,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(18431))),a=b(t,.58,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(130))),u=b(t,.72,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(18431))),s=b(t,.87,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(130))),c=b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(18431))),m.push(e),m.push(i),m.push(r),m.push(o),m.push(a),m.push(u),m.push(s),m.push(c)}},v.InitGradientStopTwoColor=function(t,n){var e,e,n,e=n.GradientStyle;e===p.GradientStyle.GradientFromCenter?this.InitGradientTwoColorCenterStops(t,n):e===p.GradientStyle.GradientFromCorner?this.InitGradientTwoColorCornerStops(t,n):(e=n.GradientStops.GradientStopList,1===(n=n.GradientVariant)||2===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))))):3===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215)))),e.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(e.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215)))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))))))},v.InitGradientTwoColorCornerStops=function(t,n){var n=n.GradientStops.GradientStopList;n.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),n.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))))},v.InitGradientTwoColorCenterStops=function(t,n){var e,n,e=n.GradientStops.GradientStopList,n=n.GradientVariant;1===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215))))):2===n?(e.push(b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215)))),e.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):3===n?(e.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,.5,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215)))),e.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(e.push(b(t,0,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215)))),e.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),e.push(b(t,1,(0,g.createColorFormatFromRGB)(t,p.SolidColorType.RGB,w(16777215)))))},v.InitGradientOneColorCornerStops=function(t,n){var e,n,e=(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(n.GradientDegree)),n=n.GradientStops.GradientStopList;n.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),n.push(b(t,1,e))},v.InitGradientOneColorCenterStops=function(t,n){var e,i,n,e=(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(n.GradientDegree)),i=n.GradientStops.GradientStopList,n=n.GradientVariant;1===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,e))):2===n?(i.push(b(t,0,e)),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):3===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,.5,e)),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(i.push(b(t,0,e)),i.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,e)))},v.InitGradientStopOneColor=function(t,n){var e,e,i,n,e=n.GradientStyle;e===p.GradientStyle.GradientFromCenter?this.InitGradientOneColorCenterStops(t,n):e===p.GradientStyle.GradientFromCorner?this.InitGradientOneColorCornerStops(t,n):(e=this.GetTintAndShadeByDegree(n.GradientDegree),i=n.GradientStops.GradientStopList,1===(n=n.GradientVariant)||2===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,e)))):3===n?(i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,e))),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1)))):4===n&&(i.push(b(t,.5,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,0,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1))),i.push(b(t,1,(0,g.createColorFormat)(t,p.SolidColorType.Theme,p.ColorSchemeIndex.Accent1,e)))))},v.InitGradientStops=function(t,n,e){var i=this;if(n.n0t(new f(t)),e===p.GradientColorType.GradientOneColor)i.InitGradientStopOneColor(t,n);else if(e===p.GradientColorType.GradientTwoColors)i.InitGradientStopTwoColor(t,n);else{if(e!==p.GradientColorType.GradientPresetColors)throw new Error;i.InitGradientStopPresetColor(t,n)}n.GradientAngle=i.GetGradientAngle(n.GradientStyle,n.GradientVariant)},v.GetGradientAngle=function(t,n){var e=0;switch(t){case p.GradientStyle.GradientHorizontal:1===n?e=90:2===n||4===n?e=270:3===n&&(e=90);break;case p.GradientStyle.GradientVertical:2!==n&&4!==n||(e=180);break;case p.GradientStyle.GradientDiagonalUp:1===n||3===n?e=45:2!==n&&4!==n||(e=225);break;case p.GradientStyle.GradientDiagonalDown:1===n||3===n?e=135:2!==n&&4!==n||(e=315);break;case p.GradientStyle.GradientFromCorner:case p.GradientStyle.GradientFromCenter:e=135}return e},v.GetTintAndShadeByDegree=function(t){return 2*(t-.5)},n.PresetGradientUtility=v},"./dist/plugins/floatingObject/drawing/lineFormat.js":function(t,n,e){"use strict";var i,a,r,o,u,s,c,f,l,h,d,v,m;function g(t,n,e){return n<=t&&t<=e}function p(t,n,e){var i,r,i=m.call(this,n)||this,r=i;return r.u1t=s.ArrowheadLength.medium,r.s1t=s.ArrowheadStyle.none,r.c1t=s.ArrowheadWidth.medium,r.f1t=s.LineDashStyle.solid,r.l1t=s.ArrowheadLength.medium,r.h1t=s.ArrowheadStyle.none,r.d1t=s.ArrowheadWidth.medium,r.RN=s.LineStyle.LineSingle,r.jft=!0,r.v1t=-1,r.m1t=h,r.g1t=h,r.DJ=t,r.sft=n,r.Pft=e,r.p1t=s.LineCapStyle.flat,r.b1t=s.LineJoinStyle.round,r.S0t=new u.FillFormat(t,n&&n.FillInternal,e),i}i=this&&this.__extends||(v=function(t,n){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.LineFormat=void 0,a=e("Core"),r=e("./dist/plugins/floatingObject/drawing/stateful.js"),o=e("./dist/plugins/floatingObject/drawing/common.js"),u=e("./dist/plugins/floatingObject/drawing/fillFormat.js"),s=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),c=a.NodeHelper.sr,f=o.DrawingUtility.Aft,l=o.UnitHelper.isNullOrUndefined,h=null,m=r.StatefulBase,i(p,m),Object.defineProperty(p.prototype,"PatternColor",{get:function(){return this.FillInternal.PatternColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Color",{get:function(){return this.FillInternal.ColorInternal},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"BeginArrowheadLength",{get:function(){return this.IsDirty(s.LineFormatStates.BeginArrowheadLength)||l(this.sft)?this.u1t:this.sft.BeginArrowheadLength},set:function(t){this.u1t=t,this.Dirty(s.LineFormatStates.BeginArrowheadLength)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"BeginArrowheadStyle",{get:function(){return this.IsDirty(s.LineFormatStates.BeginArrowheadStyle)||l(this.sft)?this.s1t:this.sft.BeginArrowheadStyle},set:function(t){this.s1t=t,this.Dirty(s.LineFormatStates.BeginArrowheadStyle)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"BeginArrowheadWidth",{get:function(){return this.IsDirty(s.LineFormatStates.BeginArrowheadWidth)||l(this.sft)?this.c1t:this.sft.BeginArrowheadWidth},set:function(t){this.c1t=t,this.Dirty(s.LineFormatStates.BeginArrowheadWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"DashStyle",{get:function(){return this.IsDirty(s.LineFormatStates.DashStyle)||l(this.sft)?this.f1t:this.sft.DashStyle},set:function(t){g(t,0,11)&&(this.f1t=t,this.Dirty(s.LineFormatStates.DashStyle))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"CapStyle",{get:function(){return this.IsDirty(s.LineFormatStates.CapStyle)||l(this.sft)?this.p1t:this.sft.CapStyle},set:function(t){g(t,0,2)&&(this.p1t=t,this.Dirty(s.LineFormatStates.CapStyle))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"JoinStyle",{get:function(){return this.IsDirty(s.LineFormatStates.JoinStyle)||l(this.sft)?this.b1t:this.sft.JoinStyle},set:function(t){g(t,0,2)&&(this.b1t=t,this.Dirty(s.LineFormatStates.JoinStyle))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"EndArrowheadLength",{get:function(){return this.IsDirty(s.LineFormatStates.EndArrowheadLength)||l(this.sft)?this.l1t:this.sft.EndArrowheadLength},set:function(t){this.l1t=t,this.Dirty(s.LineFormatStates.EndArrowheadLength)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"EndArrowheadStyle",{get:function(){return this.IsDirty(s.LineFormatStates.EndArrowheadStyle)||l(this.sft)?this.h1t:this.sft.EndArrowheadStyle},set:function(t){this.h1t=t,this.Dirty(s.LineFormatStates.EndArrowheadStyle)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"EndArrowheadWidth",{get:function(){return this.IsDirty(s.LineFormatStates.EndArrowheadWidth)||l(this.sft)?this.d1t:this.sft.EndArrowheadWidth},set:function(t){this.d1t=t,this.Dirty(s.LineFormatStates.EndArrowheadWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"InsetPen",{get:function(){return this.IsDirty(s.LineFormatStates.InsetPen)||l(this.sft)?this.y1t:this.sft.InsetPen},set:function(t){this.y1t=t,this.Dirty(s.LineFormatStates.InsetPen)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Pattern",{get:function(){return this.FillInternal.Pattern},set:function(t){this.FillInternal.r0t(t)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"PresetGradientType",{get:function(){return this.FillInternal.PresetGradientType},enumerable:!1,configurable:!0}),p.prototype.a0t=function(t){this.FillInternal.a0t(t)},Object.defineProperty(p.prototype,"GradientAngle",{get:function(){return this.FillInternal.GradientAngle},set:function(t){this.FillInternal.GradientAngle=t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"GradientColorType",{get:function(){return this.FillInternal.GradientColorType},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"GradientDegree",{get:function(){return this.FillInternal.GradientDegree},enumerable:!1,configurable:!0}),p.prototype.t0t=function(t){this.FillInternal.t0t(t)},Object.defineProperty(p.prototype,"GradientStops",{get:function(){return this.FillInternal.GradientStops},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"GradientStyle",{get:function(){return this.FillInternal.GradientStyle},enumerable:!1,configurable:!0}),p.prototype.e0t=function(t){this.FillInternal.e0t(t)},Object.defineProperty(p.prototype,"GradientVariant",{get:function(){return this.FillInternal.GradientVariant},enumerable:!1,configurable:!0}),p.prototype.i0t=function(t){this.FillInternal.i0t(t)},Object.defineProperty(p.prototype,"Style",{get:function(){return this.IsDirty(s.LineFormatStates.Style)||l(this.sft)?this.RN:this.sft.Style},set:function(t){g(t,0,4)&&(this.RN=t,this.Dirty(s.LineFormatStates.Style))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Transparency",{get:function(){return this.FillInternal.Transparency},set:function(t){this.FillInternal.Transparency=t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Visible",{get:function(){return this.IsDirty(s.LineFormatStates.Visible)||l(this.sft)?this.jft:this.sft.Visible},set:function(t){this.jft=t,this.Dirty(s.LineFormatStates.Visible)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Weight",{get:function(){return this.IsDirty(s.LineFormatStates.Weight)||l(this.sft)?this.v1t:this.sft.Weight},set:function(t){this.v1t=t,this.Dirty(s.LineFormatStates.Weight)},enumerable:!1,configurable:!0}),p.prototype.OneColorGradient=function(t,n,e){this.FillInternal.OneColorGradient(t,n,e)},p.prototype.TwoColorGradient=function(t,n){this.FillInternal.TwoColorGradient(t,n)},p.prototype.PresetGradient=function(t,n,e){this.FillInternal.PresetGradient(t,n,e)},p.prototype.Solid=function(){this.FillInternal.Solid()},p.prototype.Patterned=function(t){this.FillInternal.Patterned(t)},Object.defineProperty(p.prototype,"FillInternal",{get:function(){var t=this;return t.S0t||(t.S0t=new u.FillFormat(t.DJ,t.sft&&t.sft.FillInternal,t.Pft)),t.S0t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"Type",{get:function(){return this.FillInternal.Type},enumerable:!1,configurable:!0}),p.prototype.GetState=function(t,n){var e=this.S0t;if(e){if(t===s.LineFormatStates.Color&&e.Color)return e.Color.IsDirtyIncludingParent(n);if(t===s.LineFormatStates.PatternColor&&e.PatternColor)return e.PatternColor.IsDirtyIncludingParent(n)}return m.prototype.GetState.call(this,t,n)},p.prototype.IsDirtyIncludingParent=function(t){var n=this.S0t;return!(!n||!n.IsDirtyIncludingParent(t))||m.prototype.IsDirtyIncludingParent.call(this,t)},p.prototype.OnParentChanged=function(t){this.sft=t;var n=this.S0t;n&&t&&(n.ParentStateful=t.FillInternal)},p.prototype.FromOOModel=function(t){this.m1t=t,this.FromCT_LineProperties(t)},p.prototype.FromSJSOOModel=function(t){this.g1t=t,this.FromSJSCT_LineProperties(t)},p.prototype.ToOOModel=function(){return this.ToCT_LineProperties()},p.prototype.ToSJSOOModel=function(){return this.ToSJSCT_LineProperties()},p.prototype.FromCT_LineProperties=function(t){var n=this;l(t.solidFill)?l(t.pattFill)?l(t.gradFill)?l(t.noFill)||(n.FillInternal.ColorInternal.ColorType=s.SolidColorType.None):n.FillInternal.FromOOModel(t.gradFill,s.ColorFillType.GradientFillProperties):n.FillInternal.FromOOModel(t.pattFill,s.ColorFillType.PatternFillProperties):n.FillInternal.FromOOModel(t.solidFill,s.ColorFillType.SolidColorFillProperties),l(t.headEnd)||n.FromCT_LineEndProperties(t.headEnd),l(t.tailEnd)||n.FromCT_TailLineEndProperties(t.tailEnd),!l(t.w)&&0<=t.w?n.Weight=t.w:l(t.solidFill)&&l(t.gradFill)?(n.v1t=-1,n.UnDirty(s.LineFormatStates.Weight)):n.Weight=1,l(t.cmpd)||(n.Style=t.cmpd),n.Round=!!t.round,l(t.prstDash)?n.UnDirty(s.LineFormatStates.DashStyle):n.DashStyle=t.prstDash,l(t.cap)||(n.CapStyle=t.cap),t.bevel?n.JoinStyle=s.LineJoinStyle.bevel:t.round?n.JoinStyle=s.LineJoinStyle.round:t.miter&&(n.JoinStyle=s.LineJoinStyle.miter)},p.prototype.FromSJSCT_LineProperties=function(t){var n,e,i,r,i,o,i,n=this,e=t.solidFill,i=t.pattFill,r=t.gradFill;l(e)?l(i)?l(r)?l(t.noFill)||(n.FillInternal.ColorInternal.ColorType=s.SolidColorType.None):n.FillInternal.FromSJSOOModel(r,s.ColorFillType.GradientFillProperties):n.FillInternal.FromSJSOOModel(i,s.ColorFillType.PatternFillProperties):n.FillInternal.FromSJSOOModel(e,s.ColorFillType.SolidColorFillProperties),i=t.headEnd,o=t.tailEnd,l(i)||n.FromSJSCT_LineEndProperties(i),l(o)||n.FromSJSCT_TailLineEndProperties(o),l(t.w)?l(e)&&l(r)?(n.v1t=-1,n.UnDirty(s.LineFormatStates.Weight)):n.Weight=1:n.Weight=a.ExcelHelper.emuToPixles(c(t.w)),0===n.Weight&&l(t.noFill)&&(n.Weight=1),l(t.cmpd)||(n.Style=s.ST_CompoundLine[t.cmpd]),n.Round=!0,i=t.prstDash,l(i)?n.UnDirty(s.LineFormatStates.DashStyle):n.DashStyle=s.LineType[i.val],l(t.cap)||(n.CapStyle=s.ST_LineCap[t.cap]),t.bevel?n.JoinStyle=s.LineJoinStyle.bevel:t.round?n.JoinStyle=s.LineJoinStyle.round:t.miter&&(n.JoinStyle=s.LineJoinStyle.miter)},p.prototype.ToCT_LineProperties=function(){var t,n,e,i,i,i,t=this,n=t.m1t;return t.IsDirtyIncludingParent()||l(n)?(f(e=n||{}),t.jft?l(t.S0t)||((i=t.S0t.ToOOModel()).colorFillType===s.ColorFillType.SolidColorFillProperties?e.solidFill=i:i.colorFillType===s.ColorFillType.PatternFillProperties?e.pattFill=i:i.colorFillType===s.ColorFillType.GradientFillProperties?e.gradFill=i:i.colorFillType===s.ColorFillType.NoFillProperties&&(e.noFill=!0),delete i.colorFillType):e.noFill=!0,(i=t.ToCT_HeadLineEndProperties())&&(e.headEnd=i),(i=t.ToCT_TailLineEndProperties())&&(e.tailEnd=i),0<=t.Weight&&(e.w=t.Weight),t.GetState(s.LineFormatStates.Style,!0)&&(e.cmpd=t.Style),t.GetState(s.LineFormatStates.DashStyle,!0)&&(e.prstDash=t.DashStyle),t.Round&&(e.round=!0),t.GetState(s.LineFormatStates.CapStyle,!0)&&(e.cap=t.CapStyle),delete e.bevel,delete e.round,delete e.miter,t.GetState(s.LineFormatStates.JoinStyle,!0)&&((i=t.JoinStyle)===s.LineJoinStyle.bevel?e.bevel={}:i===s.LineJoinStyle.round?e.round=!0:i===s.LineJoinStyle.miter&&(e.miter={lim:8e5})),e):n},p.prototype.ToSJSCT_LineProperties=function(){var t,n,e,i,i,i,t=this,n=t.g1t;return t.IsDirtyIncludingParent()||l(n)?(e={},0<=t.Weight&&(e.w=a.ExcelHelper.pixelToEMU(t.Weight)),t.GetState(s.LineFormatStates.Style,!0)&&(e.cmpd=s.ST_CompoundLine[t.Style]),t.GetState(s.LineFormatStates.CapStyle,!0)&&(e.cap=s.ST_LineCap[t.CapStyle]),l(n&&n.algn)||(e.algn=n.algn),f(e),!t.jft||e.w<=0?e.noFill={}:l(t.S0t)||((i=t.S0t.ToSJSOOModel()).colorFillType===s.ColorFillType.SolidColorFillProperties?e.solidFill=i:i.colorFillType===s.ColorFillType.PatternFillProperties?e.pattFill=i:i.colorFillType===s.ColorFillType.GradientFillProperties?e.gradFill=i:i.colorFillType===s.ColorFillType.NoFillProperties&&(e.noFill={}),delete i.colorFillType),t.GetState(s.LineFormatStates.DashStyle,!0)&&(e.prstDash={val:s.ST_PresetLineDashVal[11===t.DashStyle?1:t.DashStyle]}),t.GetState(s.LineFormatStates.JoinStyle,!0)&&((i=t.JoinStyle)===s.LineJoinStyle.bevel?e.bevel={}:i===s.LineJoinStyle.round?e.round={}:i===s.LineJoinStyle.miter&&(e.miter={lim:8e5})),(i=t.ToSJSCT_HeadLineEndProperties())&&(e.headEnd=i),(i=t.ToSJSCT_TailLineEndProperties())&&(e.tailEnd=i),l(n&&n.extLst)||(e.extLst=n.extLst),e):n},p.prototype.FromCT_LineEndProperties=function(t){var n=this;n.s1t=t.type,n.c1t=t.w,n.u1t=t.len,n.SetState(s.LineFormatStates.BeginArrowheadStyle,!0),n.SetState(s.LineFormatStates.BeginArrowheadWidth,!0),n.SetState(s.LineFormatStates.BeginArrowheadLength,!0)},p.prototype.FromSJSCT_LineEndProperties=function(t){var n=this;n.s1t=s.ST_LineEndType[t.type],n.c1t=t.w?s.ST_LineEndWidth[t.w]:1,n.u1t=t.len?s.ST_LineEndLength[t.len]:1,n.SetState(s.LineFormatStates.BeginArrowheadStyle,!0),n.SetState(s.LineFormatStates.BeginArrowheadWidth,!0),n.SetState(s.LineFormatStates.BeginArrowheadLength,!0)},p.prototype.ToCT_HeadLineEndProperties=function(){var t,n,e,t={w:s.ArrowheadWidth.medium,len:s.ArrowheadLength.medium},n=this,e=!1;return n.GetState(s.LineFormatStates.BeginArrowheadStyle,!0)&&(t.type=n.BeginArrowheadStyle,e=!0),n.GetState(s.LineFormatStates.BeginArrowheadWidth,!0)&&(t.w=n.BeginArrowheadWidth,e=!0),n.GetState(s.LineFormatStates.BeginArrowheadLength,!0)&&(t.len=n.BeginArrowheadLength,e=!0),e?t:h},p.prototype.ToSJSCT_HeadLineEndProperties=function(){var t,n,e,t={w:s.ST_LineEndWidth[1],len:s.ST_LineEndWidth[1]},n=this,e=!1;return n.GetState(s.LineFormatStates.BeginArrowheadStyle,!0)&&(t.type=s.ST_LineEndType[n.BeginArrowheadStyle],e=!0),n.GetState(s.LineFormatStates.BeginArrowheadWidth,!0)&&(t.w=s.ST_LineEndWidth[n.BeginArrowheadWidth],e=!0),n.GetState(s.LineFormatStates.BeginArrowheadLength,!0)&&(t.len=s.ST_LineEndWidth[n.BeginArrowheadLength],e=!0),e?t:h},p.prototype.FromCT_TailLineEndProperties=function(t){var n;l(t)||((n=this).h1t=t.type,n.d1t=t.w,n.l1t=t.len,n.SetState(s.LineFormatStates.EndArrowheadStyle,!0),n.SetState(s.LineFormatStates.EndArrowheadWidth,!0),n.SetState(s.LineFormatStates.EndArrowheadLength,!0))},p.prototype.FromSJSCT_TailLineEndProperties=function(t){var n;l(t)||((n=this).h1t=s.ST_LineEndType[t.type],n.d1t=t.w?s.ST_LineEndWidth[t.w]:1,n.l1t=t.len?s.ST_LineEndLength[t.len]:1,n.SetState(s.LineFormatStates.EndArrowheadStyle,!0),n.SetState(s.LineFormatStates.EndArrowheadWidth,!0),n.SetState(s.LineFormatStates.EndArrowheadLength,!0))},p.prototype.ToCT_TailLineEndProperties=function(){var t,n,e,t={w:s.ArrowheadWidth.medium,len:s.ArrowheadLength.medium},n=!1,e=this;return e.GetState(s.LineFormatStates.EndArrowheadStyle,!0)&&(t.type=e.EndArrowheadStyle,n=!0),e.GetState(s.LineFormatStates.EndArrowheadWidth,!0)&&(t.w=e.EndArrowheadWidth,n=!0),e.GetState(s.LineFormatStates.EndArrowheadLength,!0)&&(t.len=e.EndArrowheadLength,n=!0),n?t:h},p.prototype.ToSJSCT_TailLineEndProperties=function(){var t,n,e,t={w:s.ST_LineEndWidth[1],len:s.ST_LineEndWidth[1]},n=!1,e=this;return e.GetState(s.LineFormatStates.EndArrowheadStyle,!0)&&(t.type=s.ST_LineEndType[e.EndArrowheadStyle],n=!0),e.GetState(s.LineFormatStates.EndArrowheadWidth,!0)&&(t.w=s.ST_LineEndWidth[e.EndArrowheadWidth],n=!0),e.GetState(s.LineFormatStates.EndArrowheadLength,!0)&&(t.len=s.ST_LineEndWidth[e.EndArrowheadLength],n=!0),n?t:h},p.prototype.Clone=function(){var t,n,t=this,n=new p(t.DJ);return n.S0t=t.S0t&&t.S0t.Clone(),n.u1t=t.u1t,n.s1t=t.s1t,n.c1t=t.c1t,n.f1t=t.f1t,n.l1t=t.l1t,n.h1t=t.h1t,n.d1t=t.d1t,n.y1t=t.y1t,n.jft=t.jft,n.v1t=t.v1t,n.l0t=t.l0t,n.sft=t.sft,n},n.LineFormat=p},"./dist/plugins/floatingObject/drawing/picture.js":function(t,n,e){"use strict";var i,r,a,o,e,u,s,f,c,l,h,d,v,m,g,p,b,w,y;function M(t,n){return d(t)?n:t}function C(t){return d(t)?0:parseInt(t,10)}function S(t,n){t&&parseFloat(t)}function T(t){var n=this;n.w1t=0,n.M1t=0,n.C1t=0,n.S1t=0,n.Wc=t}function A(t,n){var e,i,e=this;return t===m&&(t=o.PictureFormatType.PictureShape),(i=e=y.call(this,n=n===m?v:n)||this).oft=a.DrawingConstants.DefaultBrightness,i.xrt=o.PictureColorType.PictureAutomatic,i.T1t=a.DrawingConstants.DefaultBrightness,i.A1t=a.DrawingConstants.DefaultTransparent,i.I1t=t,i.sft=n,i.x1t=i.I1t===o.PictureFormatType.PictureShape,i.aft=a.DrawingConstants.DefaultTransparent,i.N1t={left:0,right:0,top:0,bottom:0},i.k1t={offsetX:0,offsetY:0,scaleX:1,scaleY:1,alignment:0,mirrorType:0},i}i=this&&this.__extends||(w=function(t,n){return(w=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}w(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PictureFormat=n.Crop=void 0,r=e("./dist/plugins/floatingObject/drawing/stateful.js"),a=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),e=e("Core"),u=e.ExcelHelper.emuToPixles,s=e.ExcelHelper.pixelToEMU,f=a.DrawingConstants.PositionConver,c=a.DrawingConstants.PositiveFixedPercentageConvert,l=a.DrawingUtility.FromLum,h=a.DrawingUtility.ToLum,d=a.UnitHelper.isNullOrUndefined,v=null,m=void 0,g=e.NodeHelper.sr,Object.defineProperty(T.prototype,"PictureHeight",{get:function(){return this.S1t},set:function(t){this.S1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"PictureOffsetX",{get:function(){return this.w1t},set:function(t){this.w1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"PictureOffsetY",{get:function(){return this.M1t},set:function(t){this.M1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"PictureWidth",{get:function(){return this.C1t},set:function(t){this.C1t=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeHeight",{get:function(){return this.Wc.Height},set:function(t){this.Wc.Height=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeLeft",{get:function(){return this.Wc.Left},set:function(t){this.Wc.Left=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeTop",{get:function(){return this.Wc.Top},set:function(t){this.Wc.Top=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ShapeWidth",{get:function(){return this.Wc.Width},set:function(t){this.Wc.Width=t},enumerable:!1,configurable:!0}),T.prototype.Clone=function(){var t,n,t=this,n=new T(t.Wc);return n.S1t=t.S1t,n.w1t=t.w1t,n.M1t=t.M1t,n.C1t=t.C1t,n},p=T,n.Crop=p,y=r.StatefulBase,i(A,y),Object.defineProperty(A.prototype,"Brightness",{get:function(){return this.IsDirty(1)||d(this.sft)?this.oft:this.sft.Brightness},set:function(t){if(t<0||1<t)throw new Error;this.oft=t,this.Dirty(1)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"ColorType",{get:function(){return this.IsDirty(2)||d(this.sft)?this.xrt:this.sft.ColorType},set:function(t){t===o.PictureColorType.PictureAutomatic?(this.oft=a.DrawingConstants.DefaultBrightness,this.T1t=a.DrawingConstants.DefaultBrightness):t===o.PictureColorType.PictureWatermark&&(this.oft=.85,this.T1t=.15),this.xrt=t,this.Dirty(2)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Contrast",{get:function(){return this.IsDirty(4)||d(this.sft)?this.T1t:this.sft.Contrast},set:function(t){if(t<0||1<t)throw new Error;this.T1t=t,this.Dirty(4)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Crop",{get:function(){var t=this;return t.D1t||(t.D1t=new p(t._1t)),t.D1t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropBottom",{get:function(){return this.Crop.ShapeTop+this.Crop.ShapeHeight},set:function(t){this.Crop.ShapeHeight=t-this.Crop.ShapeTop},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropLeft",{get:function(){return this.Crop.ShapeLeft},set:function(t){this.Crop.ShapeLeft=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropRight",{get:function(){return this.Crop.ShapeLeft+this.Crop.ShapeWidth},set:function(t){this.Crop.ShapeWidth=t-this.Crop.ShapeLeft},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"CropTop",{get:function(){return this.Crop.ShapeTop},set:function(t){this.Crop.ShapeTop=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Stretch",{get:function(){return this.N1t},set:function(t){this.N1t=JSON.parse(JSON.stringify(t))},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Tile",{get:function(){return this.k1t},set:function(t){this.k1t=JSON.parse(JSON.stringify(t))},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Transparency",{get:function(){return this.aft},set:function(t){t=Math.max(0,t),t=Math.min(1,t),this.aft=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"TransparencyColor",{get:function(){return this.IsDirty(8)||d(this.sft)?this.A1t:this.sft.TransparencyColor},set:function(t){this.A1t=t,this.Dirty(8)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"TransparentBackground",{get:function(){return this.IsDirty(16)||d(this.sft)?this.x1t:this.sft.TransparentBackground},set:function(t){this.x1t=t;var n=this._1t.Fill;t&&(n.Transparency=1),n.Solid(),this.Dirty(16)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"Container",{get:function(){return this._1t},set:function(t){var n;(this._1t=t)&&((n=this.Crop).PictureWidth=t.Width,n.PictureHeight=t.Height)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"PicSrc",{get:function(){return this.wue},set:function(t){this.wue=t},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"PicFill",{get:function(){return this.IsDirty(32)||d(this.sft)?this.E1t:this.sft.PicFill},set:function(t){this.E1t=t,this.Dirty(32)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"PicType",{get:function(){return this.IsDirty(64)||d(this.sft)?this.j1t:this.sft.PicType},set:function(t){this.j1t=t,this.Dirty(64)},enumerable:!1,configurable:!0}),A.prototype.ClearModel=function(){var t,n,e;for(this.O1t=v,this.fft=v,t=0,n=this.Children;t<n.length;t++)(e=n[t]).ClearModel()},Object.defineProperty(A.prototype,"PictureFormatType",{get:function(){return this.I1t},set:function(t){this.I1t=t},enumerable:!1,configurable:!0}),A.prototype.HasOwnPicture=function(){return this.IsDirty(1)||this.IsDirty(2)||this.IsDirty(4)||this.IsDirty(8)||this.IsDirty(16)},A.prototype.SetPictureInfo=function(t,n,e){this.PicFill=t,this.PicType=n,this.PictureFormatType=e},A.prototype.IncrementBrightness=function(t){this.Brightness+=t},A.prototype.IncrementContrast=function(t){this.Contrast+=t},A.prototype.FromOOModel=function(t){var n,e,n=this;n.O1t=t,d(t)||(n.FromCT_Blip(t.blip),e=n._1t,d(e))||(d(t.tile)||(n.PictureFormatType=o.PictureFormatType.TextureFill),n.Crop.PictureWidth=e.Width,n.Crop.PictureHeight=e.Height,n.PictureFormatType===o.PictureFormatType.PictureShape?n.FromCT_RelativeRect(t.srcRect):n.PictureFormatType===o.PictureFormatType.PictureFill?n.FromCT_Stretch(t.stretch):n.PictureFormatType===o.PictureFormatType.TextureFill&&n.FromCT_Tile(t.tile))},A.prototype.FromSJSOOModel=function(t){var n,e,i,r,t,n=this;n.fft=t,d(t)||(n.FromSJSCT_Blip(t.blip),e=n._1t,d(e))||(i=t.srcRect,r=t.stretch,t=t.tile,d(t)||(n.PictureFormatType=o.PictureFormatType.TextureFill),n.Crop.PictureWidth=e.Width,n.Crop.PictureHeight=e.Height,n.PictureFormatType===o.PictureFormatType.PictureShape?n.FromSJSCT_RelativeRect(i):n.PictureFormatType===o.PictureFormatType.PictureFill?n.FromSJSCT_Stretch(r):n.PictureFormatType===o.PictureFormatType.TextureFill&&n.FromSJSCT_Tile(t))},A.prototype.ToOOModel=function(){var t,n,e,e,t=this,n=t.O1t||{};return n.colorFillType=o.ColorFillType.BlipFillProperties,n.blip=t.ToCT_Blip(),e=t._1t,d(e)||((e=t.PictureFormatType)===o.PictureFormatType.PictureShape?(n.srcRect=t.ToCT_RelativeRect(),n.stretch={},n.stretch.fillRect={l:0,r:0,t:0,b:0}):e===o.PictureFormatType.PictureFill?(n.stretch=t.ToCT_Strecth(),n.srcRect={l:0,r:0,t:0,b:0},n.tile=v):e===o.PictureFormatType.TextureFill&&(n.stretch=v,n.srcRect=v,n.tile=t.ToCT_Tile())),n},A.prototype.ToSJSOOModel=function(){var t,n,e,e,t=this,n=t.fft||{};return n.colorFillType=o.ColorFillType.BlipFillProperties,n.blip=t.ToSJSCT_Blip(),e=t._1t,d(e)||((e=t.PictureFormatType)===o.PictureFormatType.PictureShape?(n.srcRect=t.ToCT_RelativeRect(),n.stretch={},n.stretch.fillRect={l:0,r:0,t:0,b:0}):e===o.PictureFormatType.PictureFill?(n.stretch=t.ToCT_Strecth(),n.srcRect={l:0,r:0,t:0,b:0},n.tile=v):e===o.PictureFormatType.TextureFill&&(n.stretch=v,n.srcRect=v,n.tile=t.ToSJSCT_Tile())),n},A.prototype.FromCT_Blip=function(t){var n;d(t)||((n=this).FromCT_ColorChangeEffect(t.clrChange),n.FromCT_LuminanceEffect(t.lum),d(t.alphaModFix)||(n.Transparency=1-t.alphaModFix.amt/c),d(t.grayscl)?d(t.biLevel)||(n.ColorType=o.PictureColorType.PictureBlackAndWhite):n.ColorType=o.PictureColorType.PictureGrayscale,n.FromCT_BlipBlob(t.blipBlob))},A.prototype.FromSJSCT_Blip=function(t){var n,e;d(t)||((n=this).FromSJSCT_ColorChangeEffect(t.clrChange),n.FromSJSCT_LuminanceEffect(t.lum),e=t.alphaModFix,d(e)||(n.Transparency=1-g(e.amt,1e5)/c),d(t.grayscl)?d(t.biLevel)||(n.ColorType=o.PictureColorType.PictureBlackAndWhite):n.ColorType=o.PictureColorType.PictureGrayscale,n.FromSJSCT_BlipBlob(t.blipBlob),t.lossless&&t.lossless.src&&(n.PicSrc=t.lossless.src))},A.prototype.ToCT_Blip=function(){var t,n,t=this,n=t.O1t&&t.O1t.blip||{cstate:o.ST_BlipCompression.none};return t.TransparencyColor!==a.DrawingConstants.DefaultTransparent&&(n.clrChange=t.ToCT_ColorChangeEffect()),t.Brightness===a.DrawingConstants.DefaultBrightness&&t.Contrast===a.DrawingConstants.DefaultBrightness||(n.lum=t.ToCT_LuminanceEffect()),t.Transparency!==a.DrawingConstants.DefaultTransparent?n.alphaModFix={amt:(1-t.Transparency)*c}:delete n.alphaModFix,t.ColorType===o.PictureColorType.PictureGrayscale?n.grayscl={}:t.ColorType===o.PictureColorType.PictureBlackAndWhite&&(n.biLevel={thresh:5e4}),n.blipBlob=t.ToCT_BlipBlob(),n},A.prototype.ToSJSCT_Blip=function(){var t,n,t=this,n={r_:[8]};return t.TransparencyColor!==a.DrawingConstants.DefaultTransparent&&(n.clrChange=t.ToCT_ColorChangeEffect()),t.Brightness===a.DrawingConstants.DefaultBrightness&&t.Contrast===a.DrawingConstants.DefaultBrightness||(n.lum=t.ToCT_LuminanceEffect()),t.Transparency!==a.DrawingConstants.DefaultTransparent&&(n.alphaModFix={amt:(1-t.Transparency)*c}),t.ColorType===o.PictureColorType.PictureGrayscale?n.grayscl={}:t.ColorType===o.PictureColorType.PictureBlackAndWhite&&(n.biLevel={thresh:5e4}),n.blipBlob={blob:t.PicFill},t.PicSrc!==n.blipBlob.blob&&(n.lossless={src:t.PicSrc}),n},A.prototype.FromCT_ColorChangeEffect=function(t){var n;t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},A.prototype.FromSJSCT_ColorChangeEffect=function(t){var n;t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},A.prototype.ToCT_ColorChangeEffect=function(){var t=this.ToColorByteArr(this.A1t);return{useA:!0,clrFrom:{srgbClr:{val:t}},clrTo:{srgbClr:{val:t,alpha:[0]}}}},A.prototype.FromColorByteArr=function(t){this.A1t=0|t[2]<<16|t[1]<<8|t[0]},A.prototype.ToColorByteArr=function(t){var n=[];return n[3]=Math.floor(t/(1<<24)),t%=1<<24,n[2]=Math.floor(t/65536),t%=65536,n[1]=Math.floor(t/256),t%=256,n[0]=Math.floor(t),n},A.prototype.FromCT_LuminanceEffect=function(t){t&&(this.Brightness=l(t.bright),this.Contrast=l(t.contrast))},A.prototype.FromSJSCT_LuminanceEffect=function(t){t&&(this.Brightness=l(C(t.bright)),this.Contrast=l(C(t.contrast)))},A.prototype.ToCT_LuminanceEffect=function(){return{bright:h(this.Brightness),contrast:h(this.Contrast)}},A.prototype.FromCT_BlipBlob=function(t){var n;t&&((n=this).wue=t.src||t.blob,n.E1t=t.blob,n.Dirty(32),n.j1t=t.type,n.Dirty(64))},A.prototype.FromSJSCT_BlipBlob=function(t){var n;t&&((n=this).wue=t.blob,n.E1t=t.blob,n.Dirty(32),n.j1t=M(t.type,"png"),n.Dirty(64))},A.prototype.ToCT_BlipBlob=function(){var t,n,t=this,n=t.O1t&&t.O1t.blip&&t.O1t.blip.blipBlob||{type:o.ImageType.PNG};return n.blob=t.PicFill,n.type=t.PicType,t.PicSrc!==n.blob&&(n.src=t.PicSrc),n},A.prototype.FromCT_Tile=function(t){this.k1t={offsetX:t.tx,offsetY:t.ty,scaleX:t.sx/f,scaleY:t.sy/f,alignment:t.algn,mirrorType:t.flip}},A.prototype.FromSJSCT_Tile=function(t){this.k1t={offsetX:u(g(t.tx,0)),offsetY:u(g(t.ty,0)),scaleX:g(t.sx,f)/f,scaleY:g(t.sy,f)/f,alignment:o.ST_RectAlignment[t.algn||"tl"],mirrorType:o.ST_TileFlipMode[t.flip||"none"]}},A.prototype.ToCT_Tile=function(){var t=this.Tile;return{tx:t.offsetX,ty:t.offsetY,sx:Math.round(t.scaleX*f),sy:Math.round(t.scaleY*f),algn:t.alignment,flip:t.mirrorType}},A.prototype.ToSJSCT_Tile=function(){var t=this.Tile;return{tx:s(Math.round(t.offsetX)),ty:s(Math.round(t.offsetY)),sx:Math.round(t.scaleX*f),sy:Math.round(t.scaleY*f),algn:o.ST_RectAlignment[t.alignment],flip:o.ST_TileFlipMode[t.mirrorType]}},A.prototype.FromCT_Stretch=function(t){var t,n,e,i,t,t=t&&t.fillRect;d(t)||(n=t.l/f,e=t.r/f,i=t.t/f,t=t.b/f,this.N1t={left:n,right:e,top:i,bottom:t})},A.prototype.FromSJSCT_Stretch=function(t){var t,n,e,i,t,t=t&&t.fillRect;d(t)||(n=(0,a.pft)(t.l),e=(0,a.pft)(t.r),i=(0,a.pft)(t.t),t=(0,a.pft)(t.b),this.N1t={left:n,right:e,top:i,bottom:t})},A.prototype.ToCT_Strecth=function(){var t=this.Stretch,n=t.left,e=t.right,i=t.top,t=t.bottom;return{fillRect:{l:Math.round(n*f),r:Math.round(e*f),t:Math.round(i*f),b:Math.round(t*f)}}},A.prototype.FromCT_RelativeRect=function(t){var n,e,i,r,t,o,i,t,n=this._1t;d(t)||d(n)||(e=t.l/f,i=t.r/f,r=t.t/f,t=t.b/f,i=(o=this.Crop).PictureWidth=n.Width/(1-e-i),t=o.PictureHeight=n.Height/(1-r-t),o.PictureOffsetX=(i-n.Width)/2-e*i,o.PictureOffsetY=(t-n.Height)/2-r*t)},A.prototype.FromSJSCT_RelativeRect=function(t){var n,e,i,r,t,o,i,t,n=this._1t;d(t)||d(n)||(e=(0,a.pft)(t.l),i=(0,a.pft)(t.r),r=(0,a.pft)(t.t),t=(0,a.pft)(t.b),i=(o=this.Crop).PictureWidth=n.Width/(1-e-i),t=o.PictureHeight=n.Height/(1-r-t),o.PictureOffsetX=(i-n.Width)/2-e*i,o.PictureOffsetY=(t-n.Height)/2-r*t)},A.prototype.ToCT_RelativeRect=function(){var t,n,e,i,t,r,o,n,a,u,s,c,t=this._1t,n=this.Crop,e=n.ShapeHeight,i=n.ShapeWidth;return d(t)||0===e||0===i?{l:0,r:0,t:0,b:0}:(t=n.PictureWidth,r=n.PictureHeight,o=n.PictureOffsetX,n=n.PictureOffsetY,{l:(a=((t-i)/2-o)/t)*f,r:(u=((t-i)/2+o)/t)*f,t:(s=((r-e)/2-n)/r)*f,b:(c=((r-e)/2+n)/r)*f})},A.prototype.Clone=function(){var t,n,t=this,n=new A;return n.oft=t.oft,n.T1t=t.T1t,n.xrt=t.xrt,t.D1t&&(n.D1t=t.D1t.Clone()),n.aft=t.aft,n.k1t=JSON.parse(JSON.stringify(t.k1t)),n.N1t=JSON.parse(JSON.stringify(t.N1t)),n.wue=t.wue,n.E1t=t.E1t,n.I1t=t.I1t,n.j1t=t.j1t,n._1t=t._1t,n.A1t=t.A1t,n.x1t=t.x1t,n},A.prototype.OnParentChanged=function(t){this.sft=t},n.PictureFormat=A},"./dist/plugins/floatingObject/drawing/stateful.js":function(t,n,e){"use strict";var i,e,o,r;function a(t){var n=this;n.R1t=[],n.B1t=0,n.l0t=0,n.L1t=t,n.L1t&&n.L1t.AddChildInternal(n)}Object.defineProperty(n,"__esModule",{value:!0}),n.StatefulBase=void 0,e=(i=e("Common")).Common.lt,o=e.ht,a.prototype.SetState=function(n,t){var e,i,e=this,i=n;t?e.l0t|=i:e.l0t&=~i,e.IsClearChildrenStateSuspended||e.R1t.forEach(function(t){t.SetState(n,!1)})},a.prototype.GetState=function(t,n){var e,i,r,e=this,i,r=(t&e.l0t)===t;return r=r||!n||o(e.L1t)?r:e.L1t.GetState(t,!0)},a.prototype.OnStateChanged=function(t){},a.prototype.Dirty=function(t){this.SetState(t,!0)},a.prototype.UnDirty=function(t){this.SetState(t,!1)},a.prototype.UnDirtyAll=function(){this.l0t=0},a.prototype.IsDirty=function(t){return this.GetState(t)},a.prototype.IsPropDirtyIncludingParent=function(t,n){var e,i,e=this,i;return!!e.GetState(t)||!(!n||o(e.L1t))&&e.L1t.IsPropDirtyIncludingParent(t,!0)},a.prototype.IsDirtyIncludingParent=function(t){var n=this;return 0<n.l0t||!(!t||o(n.L1t))&&n.L1t.IsDirtyIncludingParent(!0)},a.prototype.AddChildInternal=function(t){var n=this.R1t;-1===n.indexOf(t)&&n.push(t)},a.prototype.RemoveChildInternal=function(t){var n=this.R1t,t=n.indexOf(t);-1!==t&&n.splice(t,1)},a.prototype.SetParentForChildren=function(n){var t;this.R1t.slice(0).forEach(function(t){t.ParentStateful=n})},a.prototype.OnParentChanged=function(t){},a.prototype.SuspendClearChildrenState=function(){this.B1t++},a.prototype.ResumeClearChilrenState=function(){this.B1t--},Object.defineProperty(a.prototype,"ParentStateful",{get:function(){return this.L1t},set:function(t){var n=this;t!==n.L1t&&(n.L1t&&n.L1t.RemoveChildInternal(this),n.L1t=t,n.L1t&&n.L1t.AddChildInternal(this),n.OnParentChanged(t))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Children",{get:function(){return this.R1t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"IsClearChildrenStateSuspended",{get:function(){return 0<this.B1t},enumerable:!1,configurable:!0}),n.StatefulBase=a},"./dist/plugins/floatingObject/drawing/threeDFormat.js":function(t,n,e){"use strict";var i,r,o,a,e,u,s,c,f,l,h,d,v,e,r,m;function g(t,n){var e,i,e=m.call(this,n)||this,i=e;return i.F1t=a.BevelType.BevelNone,i.P1t=a.BevelType.BevelNone,i.G1t=l.ExtrusionColorAutomatic,i.U1t=45,i.jft=!0,i.H1t=h,i.z1t=!0,i.V1t=100,i.Y1t=100,i.Z1t=!0,i.DJ=t,i.W1t=30,i.sft=n,i.Q1t(a.PresetCamera.PresetCameraNone),e}i=this&&this.__extends||(v=function(t,n){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ThreeDFormat=n.ThreeDFormatStates=void 0,r=e("./dist/plugins/floatingObject/drawing/common.js"),o=e("./dist/plugins/floatingObject/drawing/stateful.js"),a=e("./dist/plugins/floatingObject/drawing/drawingInterface.js"),e=e("Core"),u=e.ExcelHelper.emuToPixles,s=r.DrawingConstants.PositiveFixedAngleConvert,c=r.UnitHelper.isNullOrUndefined,(e=f=n.ThreeDFormatStates||(n.ThreeDFormatStates={}))[e.BevelBottomDepth=1]="BevelBottomDepth",e[e.BevelBottomInset=2]="BevelBottomInset",e[e.BevelBottomType=4]="BevelBottomType",e[e.BevelTopDepth=8]="BevelTopDepth",e[e.BevelTopInset=16]="BevelTopInset",e[e.BevelTopType=32]="BevelTopType",e[e.ContourColor=64]="ContourColor",e[e.ContourWidth=128]="ContourWidth",e[e.Depth=256]="Depth",e[e.ExtrusionColor=512]="ExtrusionColor",e[e.ExtrusionColorType=1024]="ExtrusionColorType",e[e.FieldOfView=2048]="FieldOfView",e[e.LightAngle=4096]="LightAngle",e[e.Perspective=8192]="Perspective",e[e.PresetCamera=16384]="PresetCamera",e[e.PresetExtrusionDirection=32768]="PresetExtrusionDirection",e[e.PresetLighting=65536]="PresetLighting",e[e.PresetLightingDirection=131072]="PresetLightingDirection",e[e.PresetLightingSoftness=262144]="PresetLightingSoftness",e[e.PresetMaterial=524288]="PresetMaterial",e[e.PresetThreeDFormat=1048576]="PresetThreeDFormat",e[e.ProjectText=2097152]="ProjectText",e[e.RotationX=4194304]="RotationX",e[e.RotationY=8388608]="RotationY",e[e.RotationZ=16777216]="RotationZ",e[e.Visible=33554432]="Visible",e[e.Z=67108864]="Z",e[e.AutoScale=134217728]="AutoScale",e[e.DepthPercent=268435456]="DepthPercent",e[e.HeightPercent=536870912]="HeightPercent",e[e.RightAngleAxes=1073741824]="RightAngleAxes",(r=l=l||{})[r.ExtrusionColorAutomatic=0]="ExtrusionColorAutomatic",r[r.ExtrusionColorCustom=1]="ExtrusionColorCustom",h=null,m=o.StatefulBase,i(g,m),g.prototype.Q1t=function(t){var n=this;n.K1t=t,n.Dirty(f.PresetCamera)},g.prototype.InitDicCameraType=function(){var t=this.H1t=[];t[a.PresetCamera.CameraLegacyObliqueTopLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueTop]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueTopRight]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueFront]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueRight]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueBottomLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueBottom]=[0,0,0],t[a.PresetCamera.CameraLegacyObliqueBottomRight]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveTopLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveTop]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveTopRight]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveFront]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveRight]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveBottomLeft]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveBottom]=[0,0,0],t[a.PresetCamera.CameraLegacyPerspectiveBottomRight]=[0,0,0],t[a.PresetCamera.CameraOrthographicFront]=[0,0,0],t[a.PresetCamera.CameraIsometricTopUp]=[314.7191,324.6037,60.16242],t[a.PresetCamera.CameraIsometricTopDown]=[45.28088,324.6037,299.8376],t[a.PresetCamera.CameraIsometricBottomUp]=[45.28088,35.39627,60.16242],t[a.PresetCamera.CameraIsometricBottomDown]=[314.7191,35.39627,299.8376],t[a.PresetCamera.CameraIsometricLeftUp]=[45,325,0],t[a.PresetCamera.CameraIsometricLeftDown]=[45,35,0],t[a.PresetCamera.CameraIsometricRightUp]=[315,35,0],t[a.PresetCamera.CameraIsometricRightDown]=[315,325,0],t[a.PresetCamera.CameraIsometricOffAxis1Left]=[64,18,0],t[a.PresetCamera.CameraIsometricOffAxis1Right]=[334,18,0],t[a.PresetCamera.CameraIsometricOffAxis1Top]=[306.5457,301.2619,57.6425],t[a.PresetCamera.CameraIsometricOffAxis2Left]=[26,18,0],t[a.PresetCamera.CameraIsometricOffAxis2Right]=[296,18,0],t[a.PresetCamera.CameraIsometricOffAxis2Top]=[53.45424,301.2619,302.3575],t[a.PresetCamera.CameraIsometricOffAxis3Left]=[64,342,0],t[a.PresetCamera.CameraIsometricOffAxis3Right]=[334,342,0],t[a.PresetCamera.CameraIsometricOffAxis3Bottom]=[306.5457,58.73808,302.3575],t[a.PresetCamera.CameraIsometricOffAxis4Left]=[26,342,0],t[a.PresetCamera.CameraIsometricOffAxis4Right]=[296,342,0],t[a.PresetCamera.CameraIsometricOffAxis4Bottom]=[53.45424,58.73808,57.64252],t[a.PresetCamera.CameraObliqueTopLeft]=[0,0,0],t[a.PresetCamera.CameraObliqueTop]=[0,0,0],t[a.PresetCamera.CameraObliqueTopRight]=[0,0,0],t[a.PresetCamera.CameraObliqueLeft]=[0,0,0],t[a.PresetCamera.CameraObliqueRight]=[0,0,0],t[a.PresetCamera.CameraObliqueBottomLeft]=[0,0,0],t[a.PresetCamera.CameraObliqueBottom]=[0,0,0],t[a.PresetCamera.CameraObliqueBottomRight]=[0,0,0],t[a.PresetCamera.CameraPerspectiveFront]=[0,0,0],t[a.PresetCamera.CameraPerspectiveLeft]=[20,0,0],t[a.PresetCamera.CameraPerspectiveRight]=[340,0,0],t[a.PresetCamera.CameraPerspectiveAbove]=[0,340,0],t[a.PresetCamera.CameraPerspectiveBelow]=[0,20,0],t[a.PresetCamera.CameraPerspectiveAboveLeftFacing]=[14.33758,39.30647,341.1238],t[a.PresetCamera.CameraPerspectiveAboveRightFacing]=[345.6624,39.30647,18.87615],t[a.PresetCamera.CameraPerspectiveContrastingLeftFacing]=[43.93887,10.39642,356.4465],t[a.PresetCamera.CameraPerspectiveContrastingRightFacing]=[316.0611,10.39642,3.553517],t[a.PresetCamera.CameraPerspectiveHeroicLeftFacing]=[14.29302,348.9837,2.626817],t[a.PresetCamera.CameraPerspectiveHeroicRightFacing]=[345.7069,348.9837,357.3732],t[a.PresetCamera.CameraPerspectiveHeroicExtremeLeftFacing]=[34.46068,8.12245,357.0914],t[a.PresetCamera.CameraPerspectiveHeroicExtremeRightFacing]=[325.5393,8.12245,2.9086],t[a.PresetCamera.CameraPerspectiveRelaxed]=[0,309.5601,0],t[a.PresetCamera.CameraPerspectiveRelaxedModerately]=[0,324.844,0]},g.prototype.SetPresetCamera=function(t){var n=this;n.K1t=t,n.Dirty(f.PresetCamera)},g.prototype.UpdatePresetCamera=function(){var t=this;t.K1t===a.PresetCamera.PresetCameraNone&&t.SetPresetCamera(a.PresetCamera.CameraOrthographicFront)},g.prototype.IncrementRotationX=function(t){this.RotationX+=t},g.prototype.IncrementRotationY=function(t){this.RotationY+=t},g.prototype.IncrementRotationZ=function(t){this.RotationZ+=t},g.prototype.ResetRotation=function(){var t=this;t.RotationX=0,t.RotationY=0,t.RotationZ=0},g.prototype.Clone=function(){var t,n,t=this,n=new g(t.DJ);return n.J1t=t.J1t,n.X1t=t.X1t,n.F1t=t.F1t,n.q1t=t.q1t,n.$1t=t.$1t,n.P1t=t.P1t,c(t.tlt)||(n.tlt=t.tlt.Clone()),n.nlt=t.nlt,n.elt=t.elt,c(t.ilt)||(n.ilt=t.ilt.Clone()),n.G1t=t.G1t,n.U1t=t.U1t,n.rlt=t.rlt,n.W1t=t.W1t,n.K1t=t.K1t,n.olt=t.olt,n.ult=t.ult,n.slt=t.slt,n.clt=t.clt,n.flt=t.flt,n.llt=t.llt,n.hlt=t.hlt,n.dlt=t.dlt,n.vlt=t.vlt,n.mlt=t.mlt,n.jft=t.jft,n._z=t._z,n.l0t=t.l0t,n.sft=t.sft,n},g.prototype.IsDirtyIncludingParent=function(t){var n=this;return!(!n.tlt||!n.tlt.IsDirtyIncludingParent(t))||!(!n.ilt||!n.ilt.IsDirtyIncludingParent(t))||m.prototype.IsDirtyIncludingParent.call(this,t)},g.prototype.OnParentChanged=function(t){var n=this;n.sft=t,c(n.sft)&&(n.tlt&&(n.tlt.ParentStateful=h),n.ilt)&&(n.ilt.ParentStateful=h)},g.prototype.FromOOModel=function(t){var n=this;n.cft=t,n.FromCT_Scene3D(n.cft.Scene3D),n.FromCT_View3D(n.cft.View3D),n.FromCT_Shape3D(n.cft.Shape3D)},g.prototype.FromSJSOOModel=function(t,n,e){var i=this;i.cft={scene3d:t,sp3d:n,extLst:e},t||n?(i.plt(t),i.blt(n)):e&&i.ylt(e)},g.prototype.wlt=function(t){var n,e,i,t;t&&(e=t.lat,i=t.lon,t=t.rev,(n=this).RotationX=parseInt(i,10)/s,n.RotationY=parseInt(e,10)/s,n.RotationZ=parseInt(t,10)/s)},g.prototype.Mlt=function(t){var n,e,t,n=this,e=t.prst,t=t.rot;n.Q1t(a.ST_PresetCameraType[e]),c(t)||n.wlt(t)},g.prototype.plt=function(t){var n,e,t,n=this;c(t)||(e=t.camera,t=t.extLst,e&&n.Mlt(e),t&&n.ylt(t))},g.prototype.Clt=function(t){var n,e,i,t,n={w:76200,h:76200,prst:1},e=t.w,i=t.h,t=t.prst;return e&&(n.w=parseInt(e,10)),i&&(n.h=parseInt(i,10)),t&&(n.prst=a.ST_BevelPresetType[t]),n},g.prototype.blt=function(t){var n,e,e,e,e;t&&(n=this,(e=t.extrusionH)&&0!==(e=u(parseInt(e,10)))&&(n.Depth=e,n.Dirty(f.Depth)),t.z&&0!==(e=u(parseInt(t.z,10)))&&(n.Z=e,n.Dirty(f.Z)),e=t.extLst)&&n.ylt(e)},g.prototype.ylt=function(t){var i,t,n,i=this,t=t&&t.ext;t&&(n=[].concat(t)).forEach(function(t){var n,e,t,n=c(t.uri)?"":t.uri,e=t.scene3d,t=t.sp3d;n===a.OOXMLFileHelper.HiddenScene3dUri?i.plt(e):n===a.OOXMLFileHelper.HiddenSp3dUri&&i.blt(t),(e||t)&&(i._InternalVisible=!1,i.Dirty(f.Visible))})},g.prototype.ToOOModel=function(t){var n,e,n=this,e=n.cft||{};return e.View3D=n.ToCT_View3D(),n.PresetCamera!==a.PresetCamera.PresetCameraNone&&(e.Scene3D=n.ToCT_Scene3D()),(n.IsPropDirtyIncludingParent(f.Depth,!0)||n.IsPropDirtyIncludingParent(f.Z,!0))&&(e.Shape3D=n.ToCT_Shape3D()),e},g.prototype.FromCT_View3D=function(t){var n=this;c(t)||(c(t.hPercent)||(n._HeightPercent=t.hPercent),c(t.depthPercent)||(n._DepthPercent=t.depthPercent),c(t.rotX)||(n.RotationY=t.rotX),c(t.rotY)||(n.RotationX=t.rotY),c(t.rAngAx)?n._RightAngleAxes=!1:n._RightAngleAxes=t.rAngAx,c(t.perspective))||(n.Perspective=t.perspective/2)},g.prototype.ToCT_View3D=function(){var t,n,t=this,n=t.cft&&t.cft.View3D||{};return!t._AutoScale&&t.IsDirty(f.HeightPercent)&&(n.hPercent=t._HeightPercent),t.IsDirty(f.DepthPercent)&&(n.depthPercent=t._DepthPercent),t.IsDirty(f.RotationY)&&(n.rotX=t.RotationY),t.IsDirty(f.RotationX)&&(n.rotY=t.RotationX),t.IsDirty(f.RightAngleAxes)&&(n.rAngAx=t._RightAngleAxes),!t._RightAngleAxes&&t.IsDirty(f.Perspective)&&(n.perspective=2*t.Perspective),n},g.prototype.FromCT_Scene3D=function(t){c(t)||this.FromCT_Camera(t.camera)},g.prototype.ToCT_Scene3D=function(){var t,n,n,t=this,n=t.cft,n=n&&n.Scene3D||{};return n.camera=t.ToCT_Camera(),!c(n.camera)&&c(n.lightRig)&&(n.lightRig=t.ToDefaultCT_LightRig()),c(n.camera)&&c(n.backdrop)&&c(n.lightRig)?h:n},g.prototype.GetActualCT_Scene3D=function(){var t=this;return c(t.cft)||c(t.cft.Scene3D)?c(t.sft)?h:t.GetActualCT_Scene3D():t.cft.Scene3D},g.prototype.FromCT_Shape3D=function(t){var n=this;c(t)||(0!==t.extrusionH&&(n.Depth=t.extrusionH,n.Dirty(f.Depth)),0!==t.z&&(n.Z=t.z,n.Dirty(f.Z)))},g.prototype.ToCT_Shape3D=function(){var t,n,n,t=this,n=t.cft,n=n&&n.Shape3D||{z:0,extrusionH:0,contourW:0,prstMaterial:a.ST_PresetMaterialType.warmMatte};return n.extrusionH=t.Depth,n.z=t.Z,n},g.prototype.ToDefaultCT_LightRig=function(){return{rig:a.LightRigType.LightRigThreePoint,dir:a.PresetLightingDirection.LightingTopLeft}},g.prototype.FromCT_Camera=function(t){c(t)||(this.Q1t(t.prst),c(t.rot))||this.FromCameraCT_SphereCoords(t.rot)},g.prototype.ToCT_Camera=function(){var t,n,n,t=this;return t.DJ.DrawingType===a.DrawingType.Shape||t.DJ.DrawingType===a.DrawingType.GroupShape?((n={zoom:1e5}).prst=t.PresetCamera,n.rot=t.ToCameraCT_SphereCoords(),n):(n=t.cft)&&n.Scene3D&&n.Scene3D.camera||h},g.prototype.FromCameraCT_SphereCoords=function(t){var n=this;c(t)||(n.RotationX=t.lon/s,n.RotationY=t.lat/s,n.RotationZ=t.rev/s)},g.prototype.ToCameraCT_SphereCoords=function(){var t,n,e,i,t,t=this;return 0===t.RotationX&&0===t.RotationY&&0===t.RotationZ?h:(e=t.RotationX,i=t.RotationY,t=t.RotationZ,(n={}).lon=e*s,n.lat=i*s,n.rev=t*s,n)},Object.defineProperty(g.prototype,"Perspective",{get:function(){var t=this;return t.Dirty(f.Perspective),c(t.sft)?t.W1t:t.sft.Perspective},set:function(t){var n=this;n.W1t=t,n.Dirty(f.Perspective)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"PresetCamera",{get:function(){var t=this;return t.Dirty(f.PresetCamera),c(t.sft)?t.K1t:t.sft.PresetCamera},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"RotationX",{get:function(){var t=this;return t.Dirty(f.RotationX),c(t.sft)?t.Visible?t.dlt:0:t.sft.RotationX},set:function(t){var n=this;t!==n.dlt&&(n.dlt=t,n.Dirty(f.RotationX),n.UpdatePresetCamera())},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"RotationY",{get:function(){var t=this;return t.Dirty(f.RotationY),c(t.sft)?t.Visible?t.vlt:0:t.sft.RotationY},set:function(t){var n=this;if(n.DJ.DrawingType===a.DrawingType.Chart){if(t<-90&&180<=t)return}else if(t<0&&360<=t)return;n.vlt=t,n.Dirty(f.RotationY),n.UpdatePresetCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"RotationZ",{get:function(){var t=this;return t.Dirty(f.RotationZ),c(t.sft)?t.Visible?t.mlt:0:t.sft.RotationZ},set:function(t){var n=this;t!==n.mlt&&(n.mlt=t,n.Dirty(f.RotationZ),n.UpdatePresetCamera())},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"Visible",{get:function(){var t=this;return t.Dirty(f.Visible),c(t.sft)?t.jft:t.sft.Visible},set:function(t){var n=this;n.jft=t,n.Dirty(f.Visible)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"Z",{get:function(){var t=this;return t.Dirty(f.Z),c(t.sft)?t.Visible?t._z:0:t.sft.Z},set:function(t){var n=this;n._z=t,n.Dirty(f.Z),n.UpdatePresetCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"Depth",{get:function(){var t=this;return t.Dirty(f.Depth),c(t.sft)?t.Visible?t.elt:0:t.sft.Depth},set:function(t){var n=this;n.elt=t,n.Dirty(f.Depth),n.UpdatePresetCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"DicCameraType",{get:function(){var t=this;return c(t.H1t)&&t.InitDicCameraType(),t.H1t},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_InternalVisible",{get:function(){return this.jft},set:function(t){this.jft=t},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_AutoScale",{get:function(){return this.z1t},set:function(t){var n=this;n.z1t=t,n.Dirty(f.AutoScale)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_DepthPercent",{get:function(){return this.V1t},set:function(t){var n=this;20<=t&&t<=2e3&&(n.V1t=t,n.Dirty(f.DepthPercent))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_HeightPercent",{get:function(){return this.Y1t},set:function(t){var n=this;5<=t&&t<=500&&(n.Y1t=t,n.Dirty(f.HeightPercent))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"_RightAngleAxes",{get:function(){return this.Z1t},set:function(t){var n=this;n.Z1t=t,n.Dirty(f.RightAngleAxes)},enumerable:!1,configurable:!0}),n.ThreeDFormat=g},"./dist/plugins/floatingObject/floatingobject-actions.js":function(k,t,n){"use strict";var e,i,O,_,n,l,E,D,R,j,G,r,o,U,a,u,c,s,f,h,d,v,m,g,p,b,w,F,L,H,y,n,M,V,z,i,Y,Z,C,W,S,Q,J,K,X,q,$,n;function B(t){var t=t.WL,n=!1;return t&&t.QP().forEach(function(t){t&&t[F]()&&(n=!0)}),n}function tt(t,n){var e=E(n),i,r;if(0<E(n))for(i=0;i<e;i++)(r=t.WL.ev(n[i]))&&r.isSelected(!0)}function P(t,n,e,i,r){var o,a,u,s,t,i,o=t.parent,a=[],u=t.WL;if(i)a=i;else for(s=0;s<e.length;s++)a.push(u.ev(e[s]));o&&n.Z3&&a[0]&&(t=a[0].startRow(),i=a[0].startColumn(),o.changeSelectionInCommandExecuting(n,t,i,[],a),n.Z3.X3=r)}function T(){return null!==S&&S.apply(this,arguments)||this}function A(t,n){return Q.call(this,t,n)||this}function nt(t){var t,n,e,t=t,n=t.Mf;return!!t.canUndo()&&(t.X5(n,!0),e=O.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0),!0)}function I(t,n){return J.call(this,t,n)||this}function x(t,n){return K.call(this,t,n)||this}function N(){var t=X.call(this)||this;return t.Mf=D,t}function et(t,n){var e,i,e=q.call(this)||this,i=e;return i.OFFSET=15,i.Mf=t,i.tT=n,G(n.clipboardFloatingObjectData)&&(n.clipboardFloatingObjectData=n.fromSheet.dP),e}function it(t,n){var e,i,e=$.call(this)||this,i=e;return i.Mf=t,i.tT=n,e}function rt(t){var n=[];return t.WL.QP().forEach(function(t){t[F]()&&n.push(t[L]())}),n}function ot(t,n,e){var i,r,o,a,u,s,i=t.uq(),r=i.fromSheet;for(i.fromSheet=t,i.isCutting=e,o=new _.Nlt,u=a=0;u<E(n);u++)(s=t.WL.ev(n[u]))&&(o.push(s),a++);return r&&(r.dP=D),t.dP=o,0<a}function at(t){var n,e,e;switch(t.typeName){case"0":case"1":break;case"2":n="Chart "}return n}function ut(r){return function(t,n){var t,n,e,i,t=O.Commands.Tp(t,n),n=0;return r===C.left?n=-1:r===C.right&&(n=1),e=0,r===C.up?e=-1:r===C.down&&(e=1),i=rt(t),0<E(i)&&t.Qy().execute({cmd:v,sheetName:t.name(),floatingObjects:i,offsetX:n,offsetY:e})}}e=this&&this.__extends||(W=function(t,n){return(W=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}W(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.DragCopyFloatingObjectUndoAction=t.ClipboardPasteFloatingObjectUndoAction=t.FloatingObjectCopyPasteUndoAction=t.ResizingFloatingObjectUndoAction=t.MovingFloatingObjectUndoAction=t.DeleteFloatingObjectUndoAction=t.FloatingObjectUndoActionBase=void 0,i=n("Common"),O=n("Core"),_=n("./dist/plugins/floatingObject/floatingobject.js"),n=O.GC$,l=n.isArray,E=i.Common.Uf.tR,D=null,R=Math.min,j=Math.max,G=i.Common.lt.ht,r="unSelectAllFloatingObjects",o="deleteFloatingObjects",U="deleteFloatingObjectsByBackspaceKey",a="navigationNextFloatingObject",u="navigationPreviousFloatingObject",c="cutFloatingObjects",s="copyFloatingObjects",f="pasteFloatingObjects",h="dragCopyFloatingObjects",d="selectAllFloatingObjects",v="moveFloatingObjects",m="moveFloatingObjectsUp",g="moveFloatingObjectsDown",p="moveFloatingObjectsLeft",b="moveFloatingObjectsRight",w="resizeFloatingObjects",F="isSelected",L="name",H="cancel",y=O.Commands.zA,S=O.Commands.ActionBase,e(T,S),T.prototype.canExecute=function(){return!!B(this.Mf)},T.prototype.canUndo=function(){var t,t,n,t=O.Commands.TI(this.Mf.name()),t=this.tT[t],n=t&&t.floatingObjectChanges;return!!(n&&0<E(n))||!!((n=t&&t.slicerChanges)&&0<E(n))},t.FloatingObjectUndoActionBase=n=T,e(A,Q=n),A.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1,e=t.Mf,i=t.tT,r=i.floatingObjects;if(t.canExecute()&&l(r)){for(P(e,i,r),e.Ut.startTransaction(),t.X5(e,!0),o=e.WL,a=0,u=E(r);a<u;a++)(s=o.ev(r[a]))&&(c=e.slicers,t.klt(s)&&c&&c.DK(s[L]()),o.VP(r[a],!0),s[F](!1));e.cR(),t.q5(e,!0),i[f=O.Commands.TI(e.name())]=e.Ut.endTransaction(),n=0<E(r)}return n},A.prototype.undo=function(){var t,n,e,i,t=this,n=t.tT,e=t.Mf;return!!t.canUndo()&&(t.X5(e,!0),i=O.Commands.TI(e.name()),e.Ut.undo(n[i]),e.e4(),t.q5(e,!0),!0)},A.prototype.klt=function(t){return t&&"Slicer"===t.typeName},t.DeleteFloatingObjectUndoAction=M=A,e(I,J=n),I.prototype.canExecute=function(){return!0},I.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1,e=t.tT,i=e.floatingObjects,r=t.Mf;if(t.canExecute()&&l(i)){for(P(r,e,i),r.Ut.startTransaction(),t.X5(r,!0),o=r.WL,a=0,u=E(i);a<u;a++)(s=o.ev(i[a])).allowMove()&&(c=s.position(),s.position(new O.Point(c.x+e.offsetX,c.y+e.offsetY)));t.q5(r,!0),e[f=O.Commands.TI(r.name())]=r.Ut.endTransaction(),n=0<E(i)}return n},I.prototype.undo=function(){return nt(this)},t.MovingFloatingObjectUndoAction=V=I,e(x,K=n),x.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1,e=t.tT,i=e.floatingObjects,r=t.Mf;if(tt(r,i),t.canExecute()&&l(i)){for(P(r,e,i),r.Ut.startTransaction(),t.X5(r,!0),o=r.WL,a=0,u=E(i);a<u;a++)(s=o.ev(i[a])).allowResize()&&(c=s.position(),s.width(j(s.width()+e.offsetWidth,0)),s.height(j(s.height()+e.offsetHeight,0)),s.position(new O.Point(c.x+e.offsetX,c.y+e.offsetY)));t.q5(r,!0),e[f=O.Commands.TI(r.name())]=r.Ut.endTransaction(),n=0<E(i)}return n},x.prototype.undo=function(){return nt(this)},t.ResizingFloatingObjectUndoAction=z=x,X=O.Commands.ActionBase,e(N,X),N.prototype.canExecute=function(){var t=this,n=t.tT.floatingObjects;return!!(0<E(n)&&t.Dlt(n))},N.prototype.canUndo=function(){var t,t,t,t=O.Commands.TI(this.Mf.name()),t=this.tT[t],t=t&&t.floatingObjectChanges;return!!(t&&0<E(t))},N.prototype.Dlt=function(t){for(var n,e,i,r,o,a,n,e=this.Mf,i=e.WL,r=0,o=E(t);r<o;r++)if((a=i.ev(t[r]))&&!e._lt(a))return!1;return!0},N.prototype.klt=function(t){return t&&"Slicer"===t.typeName},t.FloatingObjectCopyPasteUndoAction=i=N,e(et,q=i),et.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,l,r,k,_,D,r,j,t=this,n=t.tT,e=n.floatingObjects;if(t.canExecute()){for(i=t.Mf,r=n.fromSheet,i.Ut.startTransaction(),t.X5(i,!0),o=[],a=i.WL,u=n.clipboardFloatingObjectData,void 0===n.ui&&(B(i)&&a.QP().forEach(function(t){t&&t[F]()&&o.push(t)}),n.ui=t.Mf.getActiveRowIndex(),n.Elt=t.Mf.getActiveColumnIndex()),B(i)&&a.QP().forEach(function(t){t&&t[F]()&&t[F](!1)}),s=[],f=c=void 0,d=h=l=Number.MAX_VALUE,v=[],f=E(e),c=0;c<f;c++)m=u.find(e[c]).position(),h=R(h,m.x),d=R(d,m.y),v.push(new O.Point(m.x-h,m.y-d));if(p=g=0,o.length)w=b=l,o.forEach(function(t){var t;t&&(t=t.position(),b=R(b,t.x),w=R(w,t.y))}),g=b<l?b+t.OFFSET:0,p=w<l?w+t.OFFSET:0;else{for(y=0;y<n.ui;y++)p+=i._o(y,3);for(M=0;M<n.Elt;M++)g+=i.Do(M,3)}for(f=E(e),c=0;c<f;c++)s.push(new O.Point(g+(C=v[c]).x,p+C.y));for(S=n.isCutting,T=r.WL,A=[],I=[],f=E(e),c=0;c<f;c++)(N=(x=u.find(e[c])).clone(i)).sheet(i),A.push(N),I.push(x);if(l=!1,r={sheet:i,sheetName:i.name(),objects:A,fromSheet:n.fromSheet,isCutting:n.isCutting,cancel:!1,action:n.isCutting?O.ClipboardActionType.cut:O.ClipboardActionType.copy},i.ki(O.Events.ClipboardPasting,r),!r.cancel){for(c=0;c<f;c++)N=A[c],k=void 0,_=!1,x=I[c],!S||T.ev(e[c])||a.ev(e[c])?(_=N.name()===x.name())&&(D=at(N),k=t.klt(N)?i.slicers.G1i(N[L]()):a.jlt(D)):k=x.name(),_&&N[L](k),t.klt(N)&&(i.slicers.WB(N),N.width(x.width()),N.height(x.height())),N.isVisible(!0),N.position(s[c]),N[F](!0),a.ZP(N);P(i,n,null,A,!0),r={sheet:i,sheetName:i.name(),objects:A,fromSheet:n.fromSheet,isCutting:n.isCutting,action:n.isCutting?O.ClipboardActionType.cut:O.ClipboardActionType.copy},i.ki(O.Events.ClipboardPasted,r),l=!0}return t.q5(i,!0),n[j=O.Commands.TI(i.name())]=i.Ut.endTransaction(),l||(n.JD=!0),l}return!1},et.prototype.undo=function(){var t,n,e,t=this;return!!t.canUndo()&&(n=t.Mf,t.X5(n,!0),e=O.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0),!0)},t.ClipboardPasteFloatingObjectUndoAction=Y=et,e(it,$=i),it.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,f,s,l,t=this,n=!1,e=t.tT,i=e.floatingObjects,r=t.Mf;if(t.canExecute()){for(P(r,e,i),r.Ut.startTransaction(),t.X5(r,!0),o=r.WL,a=E(i),u=0;u<a;u++)(s=o.ev(i[u]))&&((c=s.clone(r)).sheet(r),f=s.position(),c.position(new O.Point(f.x+e.offsetX,f.y+e.offsetY)),c[L](o.jlt()),c[F](!0),s[F](!1),t.klt(c)&&r.slicers&&(f=c,s=r.slicers.G1i(f.columnName()),f[L](s),r.slicers.WB(f)),o.ZP(c));t.q5(r,!0),e[l=O.Commands.TI(r.name())]=r.Ut.endTransaction(),n=!0}return n},it.prototype.undo=function(){var t,n,e,t=this,n=t.Mf;return!!t.canUndo()&&(t.X5(n,!0),e=O.Commands.TI(n.name()),n.Ut.undo(t.tT[e]),t.q5(n,!0),!0)},t.DragCopyFloatingObjectUndoAction=Z=it,O.Commands[r]={canUndo:!1,execute:function(t,n){var t=O.Commands.Tp(t,n);return!!B(t)&&(t.suspendPaint(),t.Olt(),t.cR(),t.resumePaint(),!0)}},O.Commands[d]={canUndo:!1,execute:function(t,n){var t=O.Commands.Tp(t,n);t.isEditing()||(t.suspendPaint(),t.WL.QP().forEach(function(t){t[F](!0)}),t.resumePaint())}},O.Commands[o]={canUndo:!0,execute:function(t,n,e){var i,i,i=O.Commands.Tp(t,n);return e||(n.cmd||(n.cmd=o),n.floatingObjects)||(i=rt(i),n.floatingObjects=i),0<E(n.floatingObjects)&&y(t,M,n,e)}},O.Commands[a]={canUndo:!1,execute:function(t,n){var t,e,i,r,o,a,u,s,t=O.Commands.Tp(t,n);if(B(t)){for(t.suspendPaint(),o=r=i=e=void 0,u=(a=t.WL.QP()).length,o=0;o<u;o++){if(s=a[o],i=i||s,e){r=s;break}s&&s[F]()&&(e=s)}return t.Olt(),(r=r||i)&&r[F](!0),t.resumePaint(),!0}return!1}},O.Commands[u]={canUndo:!1,execute:function(t,n){var t,e,i,r,o,a,u,t=O.Commands.Tp(t,n);if(B(t)){for(t.suspendPaint(),r=i=e=void 0,a=(o=t.WL.QP()).length,r=0;r<a;r++)if(u=o[r],(e=e||u)[F]())i=u;else if(u[F]()||(i=u),u[F]())break;return i&&(t.Olt(),i[F](!0)),t.resumePaint(),!0}return!1}},O.Commands[c]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,a,o,u,s,i=!1;return e?i=y(t,M,n,e):(r=O.Commands.Tp(t,n),n.cmd||(n.cmd=c),o=r.uq(),n.floatingObjects||(a=rt(r),n.floatingObjects=a,n.fromSheet=o.fromSheet,n.isCutting=o.isCutting),a=n.floatingObjects,s=u=o=void 0,0<E(a)&&(u=a.map(function(t){return r.WL.ev(t)}),o={sheet:r,sheetName:r.name(),objects:u,isCutting:!0,cancel:!1,action:O.ClipboardActionType.cut},r.ki(O.Events.ClipboardChanging,o),o.cancel?n.JD=!0:((s=ot(r,a,!0))&&(r.ieV&&r.ieV(),O.Commands.fI(r.parent)),i=y(t,M,n,e),r.ki(O.Events.ClipboardChanged,{sheet:r,sheetName:r.name(),objects:u})))),i}},O.Commands[s]={canUndo:!1,execute:function(t,n){var e,t,i,r,r,e=O.Commands.Tp(t,n),t=O.mt.cTe(e);if(0<E(t)){if(i=t.map(function(t){return e.WL.ev(t)}),r={sheet:e,sheetName:e.name(),objects:i,isCutting:!1,cancel:!1,action:O.ClipboardActionType.copy},e.ki(O.Events.ClipboardChanging,r),!r.cancel)return(r=ot(e,t,!1))&&(e.ieV&&e.ieV(),O.Commands.fI(e.parent)),e.ki(O.Events.ClipboardChanged,{sheet:e,sheetName:e.name(),objects:i}),r;n.JD=!0}return!1}},O.Commands[f]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,i=O.Commands.Tp(t,n);return!i.isEditing()&&!!(a=(o=(r=i.uq()).fromSheet)&&o.dP)&&(u=[],a.each(function(t){u.push(t[L]())}),0!==E(u))&&!i.xT&&(e||(n.cmd||(n.cmd=f),n.floatingObjects)||(n.floatingObjects=u,n.fromSheet=o,n.isCutting=r.isCutting),0<E(n.floatingObjects))&&y(t,Y,n,e)}},O.Commands[h]={canUndo:!0,execute:function(t,n,e){return y(t,Z,n,e)}},(n=C=C||{})[n.left=0]="left",n[n.up=1]="up",n[n.right=2]="right",n[n.down=3]="down",O.Commands[p]=ut(C.left),O.Commands[m]=ut(C.up),O.Commands[b]=ut(C.right),O.Commands[g]=ut(C.down),O.Commands[v]={canUndo:!0,execute:function(t,n,e){return(0!==n.offsetX||0!==n.offsetY)&&y(t,V,n,e)}},O.Commands[w]={canUndo:!0,execute:function(t,n,e){return y(t,z,n,e)}},O.Commands.Rlt=function(t){var n,e,i,e,n=O.mt.Tt,e=O.mt.Qf(),i=!e,e=e;t.register(r,O.Commands[r],27,!1,!1,!1,!1),t.register(d,O.Commands[d],65,i,!1,!1,e),t.register(o,O.Commands[o],46,!1,!1,!1,!1),t.register(U,O.Commands[o],8,!1,!1,!1,!1),t.register(a,O.Commands[a],9,!1,!1,!1,!1),t.register(u,O.Commands[u],9,!1,!0,!1,!1),n.msie||n.edge?(t.register(c,O.Commands[c],88,i,!1,!1,e),t.register(s,O.Commands[s],67,i,!1,!1,e),t.register(f,O.Commands[f],86,i,!1,!1,e)):(t.register(c,O.Commands[c]),t.register(s,O.Commands[s]),t.register(f,O.Commands[f])),t.register(h,O.Commands[h]),t.register(v,O.Commands[v]),t.register(m,O.Commands[m],38,!1,!1,!1,!1),t.register(g,O.Commands[g],40,!1,!1,!1,!1),t.register(p,O.Commands[p],37,!1,!1,!1,!1),t.register(b,O.Commands[b],39,!1,!1,!1,!1),t.register(w,O.Commands[w])}},"./dist/plugins/floatingObject/floatingobject-touch.js":function(t,n,e){"use strict";var o,a,e,i,u,r,s;function c(t,n,e){var i,r,e,i=this;i.AZ=new o.IZ(i),i.xZ=new o.NZ(t,"FL_"+n.name,i.AZ,2,200),i.kZ=e,i.DZ=new s(t,n),r=i.DZ,(e=i.xZ)._Z=function(){return n.Blt.isSelected()},e.EZ=function(){return!0},e.jZ=function(t){return r.OZ(t)},e.RZ=function(t){return r.BZ(t)},e.LZ=function(t){return r.FZ(t)},e.PZ=function(t){return r.GZ(t)},e.UZ=function(t){return r.HZ(t)}}function f(t,n){var e=this;e.Llt=n,e.Blt=n.Blt,e.zZ=t,e.YZ=new o.ZZ(n.Mf)}Object.defineProperty(n,"__esModule",{value:!0}),n.FloatingObjectTouchEventHandler=void 0,o=e("Touch"),a=e("Core"),e=e("./dist/plugins/floatingObject/floatingobject.js"),i=a.mt.vi,u=null,c.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},c.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},c.prototype.sW=function(t){return this.AZ.sW()},c.prototype.cW=function(t){return this.AZ.cW()},c.prototype.fW=function(t){return this.AZ.fW()},r=c,f.prototype.WZ=function(t){var t,n,e,t=new o.QZ(t.X,t.Y),n=(0,a.GC$)(this.zZ).offset();return n&&(e=document.body,t.X+=n.left+e.clientLeft||0,t.Y+=n.top+e.clientTop||0),t},f.prototype.OZ=function(t){t.KZ=3},f.prototype.BZ=function(t,n){var e,i,e=this,i=n?t.JZ:e.WZ(t.JZ);e.Llt.gg({target:t.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}),n||e.YZ.$Z()},f.prototype.FZ=function(t,n){var e,i,t,r,o,e=this,i=n?t.JZ:e.WZ(t.JZ),t=t.nW.tW,r=e.Llt.Mf,o=r.parent;1!==t&&o&&o.options.allowUserZoom&&!n?(r.rt.u9=!1,e.Llt.Flt(),e.YZ.iW(t)):e.Llt.pg({isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})},f.prototype.GZ=function(t,n){var e,i,t,r,o,e=this,i=n?t.JZ:e.WZ(t.JZ),t=t.nW.tW,r,o=e.Llt.Mf.parent;1!==t&&o&&o.options.allowUserZoom&&!n?e.YZ.rW(t):this.Llt.bg({isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}})},f.prototype.HZ=function(t,n){var e,i,n,t,r,o,e=this,n=n?t.JZ:e.WZ(t.JZ),t={e:{JZ:n},r:u};if(f.et(e,"preProcessTapped",t),!t.r)try{(i=e.Llt.Mf).suspendPaint(),e.Blt.isSelected()?(r=i.parent.touchToolStrip,o=100,r.open(n.X,n.Y-100)):(i.Olt(),e.Blt.isSelected(!0),i.ki(a.Events.FloatingElementSelected,{type:"floatingObject"}),a.hi.F1(i)),i.clearSelection()}finally{i.resumePaint()}},s=f,n.FloatingObjectTouchEventHandler=s,(0,a.$e)(s),a.Of.touch&&e.FloatingObjectRender.ch("touch",{init:function(t){var n,e,n=this,e;(n.dW=new r(t,n,n.Mf.parent.kZ)).oW()},dispose:function(){var t=this.dW;t&&t.uW()},preProcessMouseDown:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.sW(n)&&(i(n),t.r=!0)},preProcessMouseMove:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.fW(n)&&(i(n),t.r=!0)},preProcessMouseUp:function(t){var n,e,n=t.e,e=this.dW;e&&!n.isTouch&&e.cW(n)&&(i(n),t.r=!0)}})},"./dist/plugins/floatingObject/floatingobject.entry.js":function(t,n,e){"use strict";var i,r,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.Drawing=void 0,r(e("./dist/plugins/floatingObject/picture.js"),n),r(e("./dist/plugins/floatingObject/floatingobject.js"),n),r(e("./dist/plugins/floatingObject/floatingobject-actions.js"),n),r(e("./dist/plugins/floatingObject/floatingobject-touch.js"),n),r(e("./dist/plugins/floatingObject/floatingobject.ns.js"),n),r=e("./dist/plugins/floatingObject/drawing/chart.ns.js"),n.Drawing=r},"./dist/plugins/floatingObject/floatingobject.js":function(F,t,n){"use strict";var S,e,i,l,L,B,P,G,U,n,f,r,o,h,_,D,H,V,z,i,a,Y,i,d,Z,W,Q,v,m,J,c,g,T,p,b,w,y,s,M,A,K,n,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,I,i,mt,gt,e,C,pt,x,bt,wt,yt,e;function u(){this.j0t={}}function Mt(t,n,e){for(var i=n=n||e,r=1;-1<t.indexOf(i);)i=n+"_"+r,r++;return i}function Ct(t){return"string"==typeof t[A.Plt]?t[A.Plt]:t[A.Plt]()}function St(t,n){var e,i,r,o,a,u,s,t,e=t.Glt;if(e){for(a=o=r=i=void 0,o=e.length,i=0;i<o;i++)if(u=e[i]){for(a=u.length,r=0;r<a;r++)(s=u[r])&&s.L0();u.length=0}e.length=0,t.Glt=T}(t=t.WL)&&!1!==n&&t.L0()}function Tt(t,n,e){t.QP().forEach(function(t){t.JO(n,e)})}function At(n,e,i){var t,r,o,o=[];for(n.QP().forEach(function(t){Nt(e,-1,e+i-1,n.sheet().getColumnCount(),t)&&(t.dynamicMove()||t.dynamicSize())?o.push(t):t.xP(e,i)}),r=o.length,t=0;t<r;t++)n.VP(o[t].name())}function It(t,n,e){t.QP().forEach(function(t){t.qO(n,e)})}function xt(n,e,i){var t,r,o,o=[];for(n.QP().forEach(function(t){Nt(-1,e,n.sheet().getRowCount(),e+i-1,t)&&(t.dynamicMove()||t.dynamicSize())?o.push(t):t.NP(e,i)}),r=o.length,t=0;t<r;t++)n.VP(o[t].name())}function Nt(t,n,e,i,r){var o,a,u,r,o=r[A.Ult](),a=r[A.Hlt](),u=r[A.zlt](),r=r[A.Vlt]();return t<=o&&n<=a&&u<=e&&r<=i}function kt(t,r){var o=this;return r=r||{},S.GC$.each(t,function(t,n){var e,i,e=o[n],i=e.call(o);e.isDefault(i)||(r[n]=i)}),r}function _t(t,e){var i;e&&(i=this,S.GC$.each(t,function(t,n){e[n]!==p&&i[n].call(i,e[n],!1)}))}function Dt(t){var r=t;return function(t,n){var e=this,i=e.sheet();r===A.Ylt&&(e.Zlt=!0),i&&i.zw(),e.onPropertyChanged(r,t,n)}}function jt(t){var r=t;return function(t,n){var e=this,i=e.sheet();i&&(Et(e),e.Wlt||Pt(e),i.zw()),e.onPropertyChanged(r,t,n)}}function Ot(t){var r=t;return function(t,n){var e=this,i=e.sheet();i&&(nn(e),i.zw()),e.onPropertyChanged(r,t,n)}}function Et(o){var a,t,n,e,i;function r(t,n,e,i){var r=0,t=t.call(o),r=n.call(o,a,0,t);return r+=Rt(e.call(o),i.call(a,t))}(a=o.sheet())&&(t=r(o[A.Ult],Ft,o[A.Qlt],a.getRowHeight),n=r(o[A.Hlt],Lt,o[A.Klt],a.getColumnWidth),e=o.x(),i=o.y(),e===n&&i===t||(o.x(n,!1),o.y(t,!1),o.onPropertyChanged("position",new S.Point(n,t),new S.Point(e,i))))}function Rt(t,n){return 0<n&&n--,s(t,n)}function Ft(t,n,e,i){for(var r,o,r=0,o=n;o<e&&!(i<(r+=t.getRowHeight(o,3)));o++);return r}function Lt(t,n,e,i){for(var r,o,r=0,o=n;o<e&&!(i<(r+=t.getColumnWidth(o,3)));o++);return r}function Bt(o){var t=o.sheet();function n(t,n,e,i,r){var t,n,t=Gt(o,t,n),n=t.index;i.call(o,t.offset,!1),-1===t.offset&&(n+=1,i.call(o,0),n===r)&&(n=r-1),e.call(o,n,!1)}t&&(n(!0,o.y(),o[A.Ult],o[A.Qlt],t.getRowCount()),n(!1,o.x(),o[A.Hlt],o[A.Klt],t.getColumnCount()))}function Pt(r){var t;function n(t,n,e,i){var t=Gt(r,t,n);e.call(r,t.index,!1),i.call(r,t.offset,!1)}r.sheet()&&(n(!0,r.y()+r[A.Jlt](),r[A.zlt],r[A.Xlt]),n(!1,r.x()+r[A.qlt](),r[A.Vlt],r[A.$lt]))}function Gt(t,n,e){for(var i,r,o,a,u,s,i=0,r=0,o=t.sheet(),a=n?o.getRowCount():o.getColumnCount(),u=0;u<a;u++){if(0<(r=(i+=s=n?o.getRowHeight(u,3):o.getColumnWidth(u,3))-e)){r=0<r?s-r:-1;break}if(0===r){r=0,u+=1;break}}return a<=u&&(u=a-1,r=n?o.getRowHeight(u,3):o.getColumnWidth(u,3)),{offset:r,index:u}}function Ut(n,t){var e,t,e=new l.ColorFormat({DrawingType:0,sheet:function(){return n},Cft:function(t){return n.Cft(t)}});return e.setColor(n,t),delete(t=e.ToSJSOOModel()).colorFillType,e.DJ=p,t}function Ht(t,n){Vt(n,zt(t))}function Vt(t,n){t&&(t.style.zIndex=n+"")}function zt(t){var n=t.tht;return n=d(n)?t.nht:n}function Yt(t,e){t.tht=e,t.Ti.forEach(function(t){for(var n=t.parentElement;-1===n.className.indexOf(A.eht);)n=n.parentElement;Vt(n,e)})}function Zt(t,n){d(t.tht)&&(t.nht+=n)}function N(t,n){this.Mf=t,this.iht=n}function Wt(e){var n=e.sheet();n&&((0,S.GC$)(c.body).bind("scroll"+A.rht,function(){var t=n.parent&&n.parent.getActiveSheet();t&&t.WL&&n.oht(t.ot())}),n.D3(S.Events.ColumnChanged+A.rht,function(t,n){var n=n.propertyName;n!==A.qlt&&n!==A.aht||Qt(e)}),n.D3(S.Events.RowChanged+A.rht,function(t,n){var n=n.propertyName;n!==A.Jlt&&n!==A.aht||Qt(e)}),n.D3(S.Events.ColumnWidthChanged+A.rht,function(){Qt(e)}),n.D3(S.Events.RowHeightChanged+A.rht,function(){Qt(e)}))}function Qt(t){var n=t.sheet();t.isNeedToUpdateLayout=!0,n.oht(n.ot())}function Jt(t,n,e){return e&&0<e.width&&0<e.height&&(e.x===t||e.y===n||e.contains(t,n))}function Kt(t){return t===S.RelationshipConstants.Xr||t===S.RelationshipConstants.bc}function Xt(t){return t instanceof Array}function qt(t,n,e,i){var t=t[n].v_,r;d(t)||(r=parseInt(t,10)),i&&(r=o(r)),e[n]=r}function $t(t){var n={};return qt(t,"row",n),qt(t,"col",n),qt(t,"rowOff",n,!0),qt(t,"colOff",n,!0),n}function tn(t){var n,t,n=t.toJSON(),t=t.tht;return isNaN(t)||(n.zIndex=t),n}function k(t){var n=this;n.sheet(t),Wt(n),n.vst={},n.uht=[]}function nn(u){var s,t,n,e,n;function i(t,n,e,i,r,o){var a,t,n,o,e,a=0,t=t.call(u),n=n.call(u),o=Rt(o.call(u),i.call(s,n));return a=e.call(u,s,t,n),t===n?a=y(0,o-r.call(u)):(0<(e=i.call(s,t,3))&&(a-=Rt(r.call(u),e)),a+=o),a}(s=u.sheet())&&(t=i(u[A.Ult],u[A.zlt],Ft,s.getRowHeight,u[A.Qlt],u[A.Xlt]),(n=i(u[A.Hlt],u[A.Vlt],Lt,s.getColumnWidth,u[A.Klt],u[A.$lt]))<0&&(n=0),t<0&&(t=0),(e=u[A.qlt]())!==n&&(u[A.qlt](n,!1),u.onPropertyChanged(A.qlt,n,e)),(n=u[A.Jlt]())!==t)&&(u[A.Jlt](t,!1),u.onPropertyChanged(A.Jlt,t,n))}function en(t){return 0<=mt.indexOf(t)}function rn(t){var n,n,e;if(!Q(t)||"string"==typeof t&&""!==t)return!(t===(n=this).name()||(n=n.sheet())&&n.WL.ev(t));throw new Error(a().Exp_FloatingObjectNameEmptyError)}function on(e){return function(t,n){this.onPropertyChanged(e,t,n)}}function an(r,o){return function(t,n){var e=this,i=e.sheet();i&&(o&&cn(e),fn(e),vn(e),i.zw()),e.onPropertyChanged(r,t,n)}}function un(t,n,e,i){var r,o,a,r=this;r.Wlt=!0,o=t.call(r),a=n.call(r),e<=o?r.dynamicMove()&&(t.call(r,o+i),n.call(r,a+i)):e<a&&r.dynamicSize()&&n.call(r,a+i),r.Wlt=!1}function sn(t,n,e,i,r,o,a){var u,s,c,f,s,u=this;u.Wlt=!0,s=t.call(u),c=e.call(u),r<=s?a<s?u.dynamicMove()&&(t.call(u,s-o),e.call(u,c-o)):a<c&&(s=c-s+1-(f=a-s+1),u.dynamicMove()&&(t.call(u,r),n.call(u,0)),u.dynamicSize())&&e.call(u,r+s-1):r<=c&&(a<c?u.dynamicSize()&&e.call(u,c-o):u.dynamicSize()&&(e.call(u,r),i.call(u,0))),u.Wlt=!1}function cn(t){var n,e,n=hn(t,t[A.Jlt]()),e=dn(t,t[A.qlt]());t[A.qlt]()>e&&t[A.qlt](e,!1),t[A.Jlt]()>n&&t[A.Jlt](n,!1)}function fn(t){var n,e,n,e,n=t.x()+t[A.qlt](),e=dn(t,n);e<n&&t.x(y(0,e-t[A.qlt]()),!1),t.x()<0&&t.x(0,!1),n=t.y()+t[A.Jlt](),(e=hn(t,n))<n&&t.y(y(0,e-t[A.Jlt]()),!1),t.y()<0&&t.y(0,!1)}function ln(t){var n,e,n,e;cn(t),fn(t),n=t[A.Ult](),e=t[A.Hlt](),(d(n)||d(e)?Bt:Et)(t),n=t[A.zlt](),e=t[A.Vlt](),(d(n)||d(e)?Pt:nn)(t)}function hn(t,n){var t,e,t=t.sheet();return t?(e=t.getRowCount(),Ft(t,0,e,n)):A.sht}function dn(t,n){var t,e,t=t.sheet();return t?(e=t.getColumnCount(),Lt(t,0,e,n)):A.sht}function vn(t){Bt(t),Pt(t)}function mn(t,n,e,i,r,o,a){for(var u,s,c,u=0,s=a?o.getRowHeight:o.getColumnWidth,c=t;c<n;c++)u+=b(s.call(o,c)*r);return u=(u-=b((e||0)*r))+b((i||0)*r)}function gn(t,n,e,i){for(var r,o,r=0,o=0;o<t;o++)r+=i?e.getRowHeight(o,3):e.getColumnWidth(o,3);return r+=n}function pn(t){return t&&t.lossless&&t.lossless.isFloatingObject}function bn(t,n){var e=0;return!1===t&&!1===n?e=2:!1===n&&(e=1),e}function wn(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,w,y,M,C,S,T,A,I,x,N,e=t.getRowCount(),i=t.getColumnCount(),r=n.width(),o=n.height(),a=n.startRow(),u=n.startRowOffset()||0,s=n.startColumn(),c=n.startColumnOffset()||0,f=n.endRow(),l=n.endRowOffset()||0,h=n.endColumn(),d=n.endColumnOffset()||0,v=n.getOriginalWidth(),n=n.getOriginalHeight(),m,g,p=o<n?u:u+(o-n)/2,b=r<v?c:c+(r-v)/2;for(r=Math.min(r,v),o=Math.min(o,n),w=0,y=a,M=p,C=!1;y<e;)if(S=D(t,y,y+1),y++,C||(M-=S),M<0&&!C&&(a=y-1<0?0:y-1,u=S+M,C=!0),o+p<(w+=S)){f=y-1<0?0:y-1,l=S-(w-o-p);break}for(T=0,A=s,I=b,x=!1;A<i;)if(N=_(t,A,A+1),A++,x||(I-=N),I<0&&!x&&(s=A-1<0?0:A-1,c=N+I,x=!0),r+b<(T+=N)){h=A-1<0?0:A-1,d=N-(T-r-b);break}return{width:r,height:o,startRow:a,startRowOffset:u,startColumn:s,startColumnOffset:c,endRow:f,endRowOffset:l,endColumn:h,endColumnOffset:d}}function yn(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,e=t.getRowCount(),i=t.getColumnCount(),r=n.width(),o=n.height(),a=n.startRow(),u=n.startRowOffset()||0,s=n.startColumn(),c=n.startColumnOffset()||0,f=n.endRow(),l=n.endRowOffset()||0,h=n.endColumn(),d=n.endColumnOffset()||0,v=n.getOriginalWidth(),n=n.getOriginalHeight(),m=r/o,g=v/n,p={width:r,height:o,startRow:a,startRowOffset:u,startColumn:s,startColumnOffset:c,endRow:f,endRowOffset:l,endColumn:h,endColumnOffset:d},b=0,w=0,y=r,M=o;if(0<o&&0<n&&g<m)b=c+r/2-(y=g*o)/2,o=1/g*(r=y);else{if(!(0<r&&0<v&&1/g<1/m))return p;w=u+o/2-(M=1/g*r)/2,r=g*(o=M)}if(0<b){for(;s<i;)if(C=_(t,s,s+1),s++,(b-=C)<0){s--,c=b+C;break}for(S=0,T=s;T<i;)if(A=_(t,T,T+1),T++,y+c<(S+=A)){d=A-(S-y-c),h=T-1<0?0:T-1;break}}else if(0<w){for(;a<e;)if(I=D(t,a,a+1),a++,(w-=I)<0){a--,u=w+I;break}for(x=0,N=a;N<e;)if(k=D(t,N,N+1),N++,M+u<(x+=k)){l=k-(x-M-u),f=N-1<0?0:N-1;break}}return p.width=r,p.height=o,p.startRow=a,p.startRowOffset=u,p.endRow=f,p.endRowOffset=l,p.startColumn=s,p.startColumnOffset=c,p.endColumn=h,p.endColumnOffset=d,p}function Mn(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,w,y,e=t.getRowCount(),i=t.getColumnCount(),r=n.width(),o=n.height(),a=n.startRow(),u=n.startRowOffset()||0,s=n.startColumn(),c=n.startColumnOffset()||0,f=n.endRow(),l=n.endRowOffset()||0,h=n.endColumn(),d=n.endColumnOffset()||0,v=n.getOriginalWidth(),n=n.getOriginalHeight();for(r=Math.min(r,v),o=Math.min(o,n),m=0,g=a;g<e;)if(p=D(t,g,g+1),g++,o+u<(m+=p)){f=g-1<0?0:g-1,l=p-(m-o-u);break}for(b=0,w=s;w<i;)if(y=_(t,w,w+1),w++,r+c<(b+=y)){h=w-1<0?0:w-1,d=y-(b-r-c);break}return{width:r,height:o,startRow:a,startRowOffset:u,startColumn:s,startColumnOffset:c,endRow:f,endRowOffset:l,endColumn:h,endColumnOffset:d}}function Cn(t){return!t||"hidden"===t}function Sn(t){switch(t){case"dotted":return"dot";case"dashed":return"dash";case"double":return"dbl"}return"solid"}function Tn(t){var n=1e5;return{l:parseInt(1e5*(t.l||0),10),t:parseInt(1e5*(t.t||0),10),r:parseInt(1e5*(t.r||0),10),b:parseInt(1e5*(t.b||0),10)}}function An(t){return 6e4*t}function j(t,n,e,i,r){var o=this;o.cht={startRowOffset:p,startColumnOffset:p,endRowOffset:p,endColumnOffset:p},o.typeName="0",o.iht="0",o.name(t),o.x(n||0,!1),o.y(e||0,!1),o[A.qlt](i||0,!1),o[A.Jlt](r||0,!1),o.Ti=[],o.Zlt=!1,o.nht=A.fht,o.Wlt=!1}function In(t,n,e){var i=t.lht,r,o,a,u;switch(n){case ot:r=s(i[A.hht]+i[A.dht],e.x),o=s(i[A.vht]+i[A.mht],e.y),a=M(e.x-i[A.hht]-i[A.dht]),u=M(e.y-i[A.vht]-i[A.mht]);break;case at:r=i[A.hht],o=s(i[A.vht]+i[A.mht],e.y),a=i[A.dht],u=M(e.y-i[A.vht]-i[A.mht]);break;case ut:r=s(i[A.hht],e.x),o=s(i[A.vht]+i[A.mht],e.y),a=M(e.x-i[A.hht]),u=M(e.y-i[A.vht]-i[A.mht]);break;case st:r=s(i[A.hht]+i[A.dht],e.x),o=i[A.vht],a=M(e.x-i[A.hht]-i[A.dht]),u=i[A.mht];break;case ct:r=s(i[A.hht],e.x),o=i[A.vht],a=M(e.x-i[A.hht]),u=i[A.mht];break;case ft:r=s(i[A.hht]+i[A.dht],e.x),o=s(i[A.vht],e.y),a=M(e.x-i[A.hht]-i[A.dht]),u=M(e.y-i[A.vht]);break;case lt:r=i[A.hht],o=s(i[A.vht],e.y),a=i[A.dht],u=M(e.y-i[A.vht]);break;case ht:r=s(i[A.hht],e.x),o=s(i[A.vht],e.y),a=M(e.x-i[A.hht]),u=M(e.y-i[A.vht])}return new S.Rect(r,o,a,u)}function xn(t){var t,n,t=(0,S.GC$)(t),n=t.position();return new S.Rect(n.left,n.top,t[A.qlt](),t[A.Jlt]())}function Nn(t,n,e,i,r,o){(0,S.GC$)(t).css([A.ght,A.pht,A.qlt,A.Jlt],[[i-1],[e-1],r,o]).addClass(A.bht).appendTo(n)}function kn(t,n){var t;return t.GY?(t={inMoving:!1},n||(t.inMoving=!0),t):T}function _n(t){var t,n,e,i,r,o,a,u,s,c,f,l,h,t,d,v,m,t,g,p,b,o,t=t,n=t.Mf,e=t.AW,i=t.IW,r=n.frozenTrailingRowCount(),o=n.frozenTrailingColumnCount(),a=n.Fi(),u=a.c9(e,i),t=t.Blt,d=t[A.Ult](),v=t[A.Hlt](),m=t[A.zlt](),t=t[A.Vlt](),g=n.frozenRowCount(),p=n.frozenColumnCount(),b=n.getRowCount(3)-r-1,o=n.getColumnCount(3)-o-1;return e===A.yht?(0<g&&(s=n.getViewportTopRow(e),d<g||s===g)&&(u.y-=a.L6,u[A.Jlt]+=a.L6),0<r&&(c=n.getViewportBottomRow(e),b<m)&&c===b&&(u[A.Jlt]+=a.Iy)):e===A.yht-1?((s=n.getViewportTopRow(e+1))<=m||s===g)&&(h=a.c9(e+1,i),u[A.Jlt]+=h[A.Jlt]):e===A.yht+1&&(d<=(c=n.getViewportBottomRow(e-1))||c===b)&&(h=a.c9(e-1,i),u.y=h.y,u[A.Jlt]+=h[A.Jlt]),i===A.yht?(0<p&&(f=n.getViewportLeftColumn(i),v<p||f===p)&&(u.x-=a.F6,u[A.qlt]+=a.F6),0<n.frozenTrailingColumnCount()&&(l=n.getViewportRightColumn(i),o<t||l===o)&&(u[A.qlt]+=a.zy)):i===A.yht-1?((f=n.getViewportLeftColumn(i+1))<=t||f===p)&&(h=a.c9(e,i+1),u[A.qlt]+=h[A.qlt]):i===A.yht+1&&(v<=(l=n.getViewportRightColumn(i-1))||l===o)&&(h=a.c9(e,i-1),u.x=h.x,u[A.qlt]+=h[A.qlt]),u}function Dn(t,n,e,i,r){var o=xn(t);(0,S.GC$)(t).css([A.ght,A.pht,A.qlt,A.Jlt],[o.y+e,o.x+n,o[A.qlt]+i,o[A.Jlt]+r])}function jn(t){var t,n,e,i,r,o,a,e,u,s,c,f,l,h,d,t=t;if(t.wht)for(h in n=t.fk,e=_n(t),i=t.Mht,a=void 0,a=In(t,o=(r=t.lht).direction,n=new S.Point(n.x-e.x,n.y-e.y)),r.endX=a.x,r.endY=a.y,r.endWidth=a[A.qlt],r.endHeight=a[A.Jlt],e=xn(i),u=a.y-e.y,Dn(i,s=a.x-e.x,u,c=a[A.qlt]-e[A.qlt],f=a[A.Jlt]-e[A.Jlt]),l=t.Cht)g(l,h)&&Dn((d=l[h]).moveResizeDiv,s,u,c,f)}function On(t,n){var t,e,t=t.Mf;t&&!1===(e=t.P_(n))&&S.mt.vi(n)}function En(t){var t,n,e,i,r,r,e,o,a,u,t=t,n=t.Mf,e=t.CK;if(e&&(i=m(n,e[A.Sht],n.getViewportTopRow(t.AW),!0),r=m(n,e[A.Tht],n.getViewportLeftColumn(t.IW),!1),r=e[A.Aht]-e[A.hht]+(e[A.Aht]>e[A.hht]?r:-1*r),e=e[A.Iht]-e[A.vht]+(e[A.Iht]>e[A.vht]?i:-1*i),0!==r||0!==e)){for(u in(o=[]).push(t.Blt.name()),a=t.Cht)g(a,u)&&o.push(u);n.Qy().execute({cmd:"dragCopyFloatingObjects",sheetName:n.name(),floatingObjects:o,offsetX:r,offsetY:e})}}function Rn(t){var t,n,e,i,r,o,a,r,o,u,r,o,s,c,f,t=t,n=t.Mf,e=t.CK,i=n.zoom();if(e){for(f in r=e[A.Sht],o=n.getViewportTopRow(t.AW),a=m(n,r,o,!0),(o<r||r===o&&e[A.Iht]<e[A.vht])&&(a*=-1),r=e[A.Tht],o=n.getViewportLeftColumn(t.IW),u=m(n,r,o,!1),(o<r||r===o&&e[A.Aht]<e[A.hht])&&(u*=-1),r=e[A.Aht]-e[A.hht]+u,o=e[A.Iht]-e[A.vht]+a,r/=i,o/=i,(s=[]).push(t.Blt.name()),c=t.Cht)g(c,f)&&s.push(f);n.Qy().execute({cmd:"moveFloatingObjects",sheetName:n.name(),floatingObjects:s,offsetX:r,offsetY:o})}}function Fn(t,n,e,i){var t=m(t,n,e,i);return e<n?-t:t}function Ln(t){var t,n,e,i,r,o,a,u,s,a,r,c,f,l,t=t,n=t.Mf,e=n.zoom(),i=t.Blt,r=t.lht;if(r){for(l in o=Fn(n,r[A.Sht],n.getViewportTopRow(t.AW),!0),a=Fn(n,r[A.Tht],n.getViewportLeftColumn(t.IW),!1),s=u=void 0,u=r[A.Aht]!==r[A.hht]?r[A.Aht]-r[A.hht]+a:0,u/=e,s=r[A.Iht]!==r[A.vht]?r[A.Iht]-r[A.vht]+o:0,s/=e,a=(r.endWidth+a)/e-i[A.qlt](),r=(r.endHeight+o)/e-i[A.Jlt](),(c=[]).push(i.name()),f=t.Cht)g(f,l)&&c.push(l);n.Qy().execute({cmd:"resizeFloatingObjects",sheetName:n.name(),floatingObjects:c,offsetX:u,offsetY:s,offsetWidth:a,offsetHeight:r})}}function Bn(t,n,e){var t,i,r,o,a,u,s,t=t,i=t.Mht;if(i)for(u in Pn(i,r=e.x-n.x,o=e.y-n.y),a=t.Cht)g(a,u)&&Pn((s=a[u]).moveResizeDiv,r,o)}function Pn(t,n,e){var i,t,i=(0,S.GC$)(t),t=(0,S.GC$)(t).position();i.css([A.ght,A.pht],[t[A.ght]+e,t[A.pht]+n])}function Gn(t){var t,n,e,i,r,o,r,a,u,s,c,f,e,t=t,n=t.CK;n&&(e=t.Blt,o=(r=(i=t.Mf).Fi())[A.qlt]-r.XC-r.BA,r=r[A.Jlt]-r.qC-r.LA,a=n.startX,u=n.startY,s=e.position().x,c=e.position().y,f=e[A.qlt](),e=e[A.Jlt](),s+n.endX-a<0&&(n.endX=a-s),c+n.endY-u<0&&(n.endY=u-c),s+f+n.endX-a>o&&(n.endX=o+a-s-f),c+e+n.endY-u>r&&(n.endY=r+u-c-e),n.startTopRow=i.getViewportTopRow(t.AW),n.startLeftColumn=i.getViewportLeftColumn(t.IW))}function Un(t){var t,n,e,i,r,i,o,t=t,n=t.lht;n&&(r=(i=(e=t.Mf).Fi())[A.qlt]-i.XC-i.BA,i=i[A.Jlt]-i.qC-i.LA,o=(o=new S.Rect(n.endX,n.endY,n.endWidth,n.endHeight)).getIntersect(0,0,r,i),n.endX=o.x,n.endY=o.y,n.endWidth=o[A.qlt],n.endHeight=o[A.Jlt],n.startTopRow=e.getViewportTopRow(t.AW),n.startLeftColumn=e.getViewportLeftColumn(t.IW))}function Hn(t){var n,e,i,t,r,o,a,u,s,c,f,n=v(A.xht),e=(0,S.GC$)(n),i=t;return e.addClass(A.eht).addClass(A.Nht).attr(A.kht,A.Dht).css(A._ht,A.fht).bind("mousedown",function(t){i.gg(t)}).bind(A.Eht,function(t){i.pg(t)}).bind(A.jht,function(t){i.bg(t)}),n.addEventListener("mousewheel",function(t){On(i,t)},!1),n.addEventListener("DOMMouseScroll",function(t){On(i,t)},!1),t=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Rht+" "+A.Bht+" "+A.Lht),r=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Rht+" "+A.Fht+" "+A.Lht),o=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Rht+" "+A.Pht+" "+A.Lht),a=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Ght+" "+A.Bht+" "+A.Lht),u=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Ght+" "+A.Pht+" "+A.Lht),s=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Uht+" "+A.Bht+" "+A.Lht),c=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Uht+" "+A.Fht+" "+A.Lht),f=(0,S.GC$)(v(A.xht)).addClass(A.Oht+" "+A.Uht+" "+A.Pht+" "+A.Lht),e.append(t).append(r).append(o).append(a).append(u).append(s).append(c).append(f),x.et(i,"init",n),n}function Vn(t){var e,i,t,n,r,o,a,u,s,c,e=t,i=e.Hht&&e.GY;if(i&&!e.Mht){for(s in t=e.zht=v(A.xht),e.Mht=v(A.xht),e.Cht={},e.Yht.Vht.each(function(t){var n,t,n=t.Blt;n&&n.name()!==e.Blt.name()&&n.isSelected()&&!e.Cht[n.name()]&&(t=t.GY,e.Cht[n.name()]={offsetX:t.x-i.x,offsetY:t.y-i.y,height:t[A.Jlt],width:t[A.qlt],moveResizeDiv:v(A.xht)})}),n=_n(e),(r=(0,S.GC$)(t)).css([A._ht,A.ght,A.pht,A.qlt,A.Jlt,A.Zht],[A.Wht,n.y,n.x,n[A.qlt],n[A.Jlt],"rgba(255,255,255,0.01)"]).addClass(A.Qht).bind(A.Eht,function(t){e.pg(t)}).bind(A.jht,function(t){e.bg(t)}),o=i.y-n.y,a=i.x-n.x,Nn(e.Mht,t,a,o,i[A.qlt],i[A.Jlt]),u=e.Cht)g(u,s)&&Nn((c=u[s]).moveResizeDiv,e.zht,a+c.offsetX,o+c.offsetY,c[A.qlt],c[A.Jlt]);e.fF&&(0,S.GC$)(e.fF).append(e.zht)}}function zn(t){var n=t;n.p4||((0,S.GC$)(c).bind(A.Eht+A.rht,function(t){n.pg(t)}).bind(A.jht+A.rht,function(t){n.bg(t)}),n.p4=!0)}function Yn(t){var t=t;t.p4&&(t.p4=!1,S.GC$)(c).unbind(A.Eht+A.rht).unbind(A.jht+A.rht)}function Zn(t,n){var e,n,t,i,r,o,i,a,u,s,c,f,l,o,h,d,r,e;(0,S.GC$)(A.Kht,n).removeClass(A.Jht),t=xn((n=t).Hht),i=n.Xht,r=n.Blt,n.qht&&(i=n.qht),o=x.$ht,a=(i=xn(i)).x,u=i.y,s=t[A.Jlt]-i.y-i[A.Jlt],c=t[A.qlt]-i.x-i[A.qlt],f=0,l=o+2,o=w(o/2+1),"1"===r.typeName&&(h=r.borderWidth(),o<=(h=en(d=r.borderStyle())?h:0)&&(f=h-o),s=t[A.Jlt]-u-i[A.Jlt]-h,c=t[A.qlt]-a-i[A.qlt]-h,a+=h,u+=h),r=[],0<a?(O(n,0<u,X,f,f,p,p,"nw"+A.tdt,ot,r),O(n,0<t[A.Jlt],q,f,(i[A.Jlt]-l)/2+u,p,p,"w"+A.tdt,st,r),O(n,0<s,$,f,p,p,f,"ne"+A.tdt,ft,r)):(E(n,X),E(n,q),E(n,$)),O(n,0<u,tt,(i[A.qlt]-l)/2+a,f,p,p,"n"+A.tdt,at,r),O(n,0<s,nt,(i[A.qlt]-l)/2+a,p,p,f,"n"+A.tdt,lt,r),0<c?(O(n,0<u,et,p,f,f,p,"sw"+A.tdt,ut,r),O(n,0<t[A.Jlt],it,p,(i[A.Jlt]-l)/2+u,f,p,"w"+A.tdt,ct,r),O(n,0<s,rt,p,p,f,f,"se"+A.tdt,ht,r)):(E(n,et),E(n,it),E(n,rt)),n.ndt=!0,n.edt=r}function O(t,n,e,i,r,o,a,u,s,c){var t,f,l,n,f,e,t,t=t,f=(0,S.GC$)(e,t.Hht),l=x.$ht;n?f.css([A.pht,A.ght,A.idt,A.rdt,A.qlt,A.Jlt,A.odt],[i,r,o,a,l,l,u]).addClass(A.adt).attr("resizeDirection",s):E(t,e),c&&(n=(0,S.GC$)(t.Hht),e=f=0,d(i)||(f=i),d(r)||(e=r),d(o)||(f=n.width()-o-l),d(a)||(e=n.height()-a-l),t=new S.Rect(f,e,l,l),c.push({rect:t,cursor:u,direction:s}))}function E(t,n){(0,S.GC$)(n,t.Hht).removeClass(A.adt).addClass(A.Jht)}function Wn(t,n){(0,S.GC$)(A.Kht,n).removeClass(A.adt).addClass(A.Jht),t.ndt=!1}function Qn(t){var t,n,e,i,r,o,a,t,e,r,a,n,u,s,c,f,l,t=t,n=t.Blt,e=n.udt||n.src(),i=n.pictureStretch(),r=S.Pf.vl(n.sheet(),n.backColor()),o=t.Xht;e&&o&&(a=(0,S.GC$)(o),t.sdt!==e&&(t.sdt=e,a.css([A.Zht+"-image",A.Zht+"-repeat"],["url('"+e+"')","no-repeat"])),a.css(A.Zht+"-color",r),i!==T)&&i!==p&&n.cdt&&(t=n.getOriginalWidth(),e=n.getOriginalHeight(),r=a[A.qlt](),a=a[A.Jlt](),u=void 0,(n=n.fdt)&&(s=r/n.width,c=a/n.height,u={position:-(f=s*n.left)+"px "+-(l=c*n.top)+"px",size:s+"px "+c+"px"}),S.mt.Wf(o,r,a,t,e,i,u))}function Jn(t,n,e){var i,t,r,o,a,u,s,c,t,s,f,l,i=t.qht,t=t.Blt,r=t.borderWidth(),o=t.borderStyle(),a=S.Pf.vl(t.sheet(),t.borderColor()),u=t.borderRadius(),s=0,c=w(x.$ht/2+1),l=f=s=t=s=(r=en(o)&&!t.noFill()?r:0)<c?c-r:s;c=y(r,c),n.x<0?t+=n.x-c:(n.x<c?t+=n.x-c:t+=0,l=e[A.qlt]-t-n[A.qlt]-2-2*r),n.y<0?s+=n.y-c:(n.y<c?s+=n.y-c:s+=0,f=e[A.Jlt]-s-n[A.Jlt]-2-2*r),(0,S.GC$)(i).css([A.ldt,A.pht,A.ght,A.rdt,A.idt,A.hdt+"-width",A.hdt+"-style",A.hdt+"-color",A.hdt+"-radius"],[A.ddt,t,s,f,l,r,o,a,u])}function R(t,n){this.sdt="";var e=this;e.Blt=t,e.name=t?t.name():"",e.Mf=n,e.p4=!1,e.ndt=!1}function Kn(t){t.QP().forEach(function(t){(t.dynamicMove()?Et:Bt)(t),(t.dynamicSize()?nn:Pt)(t)})}function Xn(t,n,e){var t,i,r,o,a,u,s,c,r,c,r,t,f,t=t.Mf,i=t.Fi(),r=t.yw(e),o=0,a=0,u=0,s=0;return r&&0<r.length&&(c=r[0],r=r[r.length-1],o=c.x,u=r.x+r[A.qlt]-o,0===e)&&o+u>i.x+i.width&&(u=i.x+i.width-o),(c=t.dw(n))&&0<c.length&&(r=c[0],t=c[c.length-1],a=r.y,s=t.y+t[A.Jlt]-a,0===n)&&a+s>i.y+i.height&&(s=i.y+i.height-a),(f=i.c9(n,e)).getIntersect(o,a,u,s)||new S.Rect(0,0,0,0)}function qn(t,n,e,d){var i,v,m,t,g,p,b,w,y,M,C,S,i,v=t.Mf,m=new J,t=v.WL;return t.isNeedToUpdateLayout&&(Kn(t),t.isNeedToUpdateLayout=!1),g=v.Fi(),p=v.Jt,b=v.yw(e),w=v.dw(n),b.length<=0||w.length<=0||(y=b[0],M=b[b.length-1],C=w[0],S=w[w.length-1],t.QP().forEach(function(t){var n,e,i,r,o,a,u,u,s,c,u,f,l,u,h;if(t&&t.isVisible()){if(e=n=void 0,i=t[A.Ult](),r=t[A.Hlt](),o=t[A.zlt](),a=t[A.Vlt](),t.fixedPosition())n=(u=t.position()).x*d+g.b6,e=u.y*d+g.T6;else{if(u=b.findCol(r))n=u.x;else if(r<y.col)for(n=y.x,s=y.col-1;r<=s;s--)n-=p.Kt(s);else for(n=M.x+M[A.qlt],c=M.col+1;c<=r;c++)n+=p.Kt(c);if(n+=Rt(t[A.Klt](),v.getColumnWidth(r))*d,u=w.findRow(i))e=u.y;else if(i<C.row)for(e=C.y,f=C.row-1;i<=f;f--)e-=p.Gt(f);else for(e=S.y+S[A.Jlt],l=S.row+1;l<=i;l++)e+=p.Gt(l);e+=Rt(t[A.Qlt](),v.getRowHeight(i))*d}h=u=void 0,u=t.vdt(d),h=t.mdt(d),$n(v,i,r,o,a)||m.push({name:t.name(),x:n,y:e,width:u,height:h})}})),m}function $n(t,n,e,i,r){var o,a,u;if(t.rowOutlines)for(o=!0,u=n;u<=i;u++)if(!t.rowOutlines.isCollapsed(u)){o=!1;break}if(t.columnOutlines)for(a=!0,u=e;u<=r;u++)if(!t.columnOutlines.isCollapsed(u)){a=!1;break}return o||a}function te(t){var n,e,i,r;if(t)for(e=(n=t.QP()).length,i=0;i<e;i++)if((r=n[i]).isSelected())return 1}function ne(t){var n,t,n=t.target;return!(!t.target||"input"!==(t=n.tagName.toLowerCase())&&"textarea"!==t)}function ee(t){this.Mf=t,this.Vht=new J}function ie(t,n,e){var i,r,o,o,o,i=void 0;return t&&(r=void 0,o=t.floatingObjectType,"0"===(o=S.mt.T1(o)?o+"":t.typeName)?i=new C:"1"===o?i=C.gdt():(r=(0,S.getTypeFromString)(o))&&(i=new r(e)),i)&&(i.fromJSON(t,n),o=t.zIndex,d(o)||(i.tht=o)),i}function re(t){var n=!0,e=!0;return 2===t?e=n=!1:1===t&&(e=!1),{dynamicMove:n,dynamicSize:e}}function oe(t,n){var e,i,e="png",i=t.lastIndexOf(".");return"svg"===(e=-1!==i?t.substr(i+1):e)&&(e="svg+xml"),n?"data:image/"+e+";base64,"+n:T}function ae(t){var n,e,i,t,r,i,o,a,u,t,e,s,c,f,l,h,d,n,e,r,v,n=Math.PI/180/6e4;if(t)return e=t.rot||0,i=t.off,t=t.ext,r=i.x,i=i.y,u=(o=t.cx)/2,t=(a=t.cy)/2,e=e*n,s=Math.sin(e),c=Math.cos(e),f=r+u,l=i+t,h=[],d=[],[{x:-u,y:-t},{x:u,y:-t},{x:-u,y:t},{x:u,y:t}].forEach(function(t){var t=ue(t,s,c);h.push(t.x+f),d.push(t.y+l)}),n=Math.min.apply(null,h),e=Math.max.apply(null,h),{x:n,y:r=Math.min.apply(null,d),width:e-n,height:(v=Math.max.apply(null,d))-r}}function ue(t,n,e){return{x:t.x*e-t.y*n,y:t.x*n+t.y*e}}Object.defineProperty(t,"__esModule",{value:!0}),t.FloatingObjectRender=t.FloatingObject=t.isFloatingObjectPicture=t.FloatingObjectModel=t.FloatingObjectCollection=t.propertyRefreshCallback=t.fromJsonFn=t.toJsonFn=t.Nlt=void 0,S=n("Core"),e=n("Common"),i=n("./dist/plugins/floatingObject/floatingobject.ns.js"),l=n("./dist/plugins/floatingObject/drawing/chart.ns.js"),L=S.UsedRangeUtil.vh,B=S.XFileConstants.Ki,P=S.Util.Ir,G=S.Util.Er,U=S.Util.jr,u.prototype.push=function(t){this.j0t[Ct(t)]=t},u.prototype.remove=function(t){delete this.j0t[t]},u.prototype.find=function(t){return this.j0t[t]},u.prototype.empty=function(){delete this.j0t,this.j0t={}},u.prototype.each=function(t){var n,e,n=this.j0t;for(e in n)n.hasOwnProperty(e)&&t(n[e])},u.prototype.isEmpty=function(){var t,n,t=this.j0t;for(n in t)if(t.hasOwnProperty(n))return!1;return!0},t.Nlt=n=u,f=S.NodeHelper.ur,r=S.NodeHelper.sr,o=S.ExcelHelper.emuToPixles,h=S.ExcelHelper.pixelToEMU,_=S.ExcelHelper.getActualColumnWidth,D=S.ExcelHelper.getActualRowHeight,H=S.Util.ho,V=S.Util.Sr,z=S.Util.To,i=new e.Common.ResourceManager(i.SR,"FloatingObjects"),a=i.getResource.bind(i),Y=e.Common.lt,i=e.Common.kh,d=Y.ht,Z=Y.dt,W=S.mt.p0,Q=S.mt.T1,v=S.mt.En,m=S.mt.w0,J=n,c=document,g=i,T=null,p=void 0,b=Math.ceil,w=Math.floor,y=Math.max,s=Math.min,M=Math.abs,A={xht:"div",Dht:"on",_ht:"z-index",pdt:"move",kht:"unselectable",yht:1,hdt:"border",sht:9007199254740992,bdt:"floatingObjects",rht:".gcFloatingObject",Plt:"name",ydt:"scroll",_X:"x",_Y:"y",qlt:"width",Jlt:"height",Ult:"startRow",Qlt:"startRowOffset",Hlt:"startColumn",Klt:"startColumnOffset",zlt:"endRow",Xlt:"endRowOffset",Vlt:"endColumn",$lt:"endColumnOffset",Cdt:"isSelected",Sdt:"isLocked",aht:"isVisible",Tdt:"canPrint",Adt:"dynamicSize",Idt:"dynamicMove",xdt:"fixedPosition",Ndt:"allowResize",kdt:"allowMove",fht:700,Wht:701,ldt:"position",ddt:"absolute",Zht:"background",Nht:"gc-no-user-select",Ddt:"gc-floatingobject-selected",_dt:"gc-floatingobject-unselected",adt:"gc-floatingobject-resize-indicator-select",Jht:"gc-floatingobject-resize-indicator-unSelect",Edt:"gc-floatingobject-content-container",eht:"gc-floatingobject-container",Qht:"gc-floatingobject-moving-container",bht:"gc-floatingobject-moving-div",Kht:".gc-floatingobject-resize-indicator",Oht:"gc-floatingobject-resize-indicator",Lht:"gc-floatingobject-absolute",Rht:"gc-floatingobject-top",Ght:"gc-floatingobject-middle",Uht:"gcfloatingobject-bottom",Bht:"gc-floatingobject-left",Fht:"gc-floatingobject-center",Pht:"gc-floatingobject-right",Ylt:"content",jdt:"gc-no-user-select",Odt:"100%",Rdt:"gc-floatingobject-background-cover",Bdt:".fos",pht:"left",Ldt:"center",idt:"right",ght:"top",Fdt:"middle",rdt:"bottom",tdt:"-resize",odt:"cursor",Eht:"mousemove",jht:"mouseup",hht:"startX",vht:"startY",dht:"startWidth",mht:"startHeight",Aht:"endX",Iht:"endY",Sht:"startTopRow",Tht:"startLeftColumn"},(e=K=K||{})[e.twoCell=0]="twoCell",e[e.oneCell=1]="oneCell",e[e.absolute=2]="absolute",n=A.xht+"."+A.Oht,X=n+"."+A.Rht+"."+A.Bht,q=n+"."+A.Ght+"."+A.Bht,$=n+"."+A.Uht+"."+A.Bht,tt=n+"."+A.Rht+"."+A.Fht,nt=n+"."+A.Uht+"."+A.Fht,et=n+"."+A.Rht+"."+A.Pht,it=n+"."+A.Ght+"."+A.Pht,rt=n+"."+A.Uht+"."+A.Pht,ot=A.ght+A.pht,at=A.ght+A.Ldt,ut=A.ght+A.idt,st=A.Fdt+A.pht,ct=A.Fdt+A.idt,ft=A.rdt+A.pht,lt=A.rdt+A.Ldt,ht=A.rdt+A.idt,(dt=function(){var t=this;t.Olt=function(){var t=this.WL;t&&t.QP().forEach(function(t){t.isSelected(!1)})},t.uq=function(){var t=this,n=t.parent,e=t.aM,n=n&&n.aM,e;return e=e||(t.aM=n||{fromSheet:T,isCutting:!1})},t.AT=function(){var t,n=this.uq(),e=n&&n.fromSheet;e&&(e.dP=T),n.fromSheet=T,n.isCutting=!1},t.Pdt=function(t){var n=this.options;return!this.isActualProtected()||!t.isLocked()||n.protectionOptions.allowEditObjects},t._lt=function(t){var n=this.options;return!this.isActualProtected()||!t.isLocked()||n.protectionOptions.allowEditObjects},t.isPasteFloatingObject=function(){var t,n,e,t,n=this.uq().fromSheet,e=this.dP;return(e=!e&&n?n.dP:e)&&!e.isEmpty()},t.Gdt=function(t,n){var e,i,r,e=this;return e.Glt||(e.Glt=[]),(i=e.Glt[t])||(e.Glt[t]=[]),(r=e.Glt[t][n])||(e.Glt[t][n]=new bt(e)),r=e.Glt[t][n]},t.oht=function(t,n){var e,i,r,o,a,u,s,e,i=this;if(!i.D_&&i.WL&&i.Dn&&i.Dn.J())for(r=i.Fi(),o=void 0,n!==T&&void 0!==n||(n=i.zoom()),a=0;a<=2;a++)for(u=0;u<=2;u++)(o=r.c9(a,u))&&(s=i.Gdt(a,u))&&s.Dn(a,u,n)}}).call(S.Worksheet.prototype),t.toJsonFn=kt,t.fromJsonFn=_t,t.propertyRefreshCallback=Dt,N.prototype.L0=function(){this.Mf=T},N.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.all(),e={};if(n)for(a=o=r=i=void 0,u=0,s=n;u<s.length;u++)i=(c=s[u]).startRow(),r=c.startColumn(),o=c.endRow(),a=c.endColumn(),L(e,{minRow:i,minCol:r,maxRow:o,maxCol:a});return e},N.prototype.add=function(t,n,e,i,r,o){var a=this,u;return"1"===a.iht?u=C.gdt(t,n,e,i,r,o):"0"===a.iht&&(u=t),a.Mf.WL.ZP(u),u},N.prototype.get=function(t){return this.Mf.WL.ev(t)},N.prototype.remove=function(t){this.Mf.WL.VP(t)},N.prototype.clear=function(){return this.Mf.WL.d5(this.iht)},N.prototype.all=function(){return this.Mf.WL.QP(this.iht)},N.prototype.zIndex=function(t,n){return this.Mf.WL.tht(t,n)},N.prototype.Udt=function(i,r,o){this.all().forEach(function(t){var n=o?t.startRow():t.startColumn(),e=o?t.endRow():t.endColumn();r<n||e<i||!t.dynamicSize()||nn(t),Et(t)})},vt=N,t.FloatingObjectCollection=vt,k.prototype.Hdt=function(n){this.QP().forEach(function(t){Zt(t,n)})},k.prototype.ZP=function(t,n){var e,i,r,e=this,i=e.sheet();if(i.suspendPaint(),!(r=t.name()))throw i.resumePaint(),new Error(a().Exp_FloatingObjectNameEmptyError);if(e.vst[r]){if(!n)throw i.resumePaint(),new Error(a().Exp_FloatingObjectHasSameNameError);r=e.jlt(r+"__"),t.name(r)}i.Ut.zdt(),e.Hdt(-1),t.sheet(i),e.vst[r]=t,e.uht.push(r),i.Vdt(t),i.Ut.zdt(!0),i.resumePaint()},k.prototype.ev=function(t){return this.vst[t]},k.prototype.VP=function(t,n){var e,i,r,n,o,e=this;return!!t&&(i=e.sheet(),(r=e.ev(t))?(i.Ut.zdt(),i.suspendPaint(),n?(n={sheet:i,sheetName:i.name(),floatingObject:r,cancel:!1},i.ki(S.Events.FloatingObjectRemoving,n),!1===n.cancel&&(delete e.vst[t],-1<(o=e.uht.indexOf(t))&&e.uht.splice(o),i.ki(S.Events.FloatingObjectRemoved,{sheet:i,sheetName:i.name(),floatingObject:r}))):(delete e.vst[t],-1<(o=e.uht.indexOf(t))&&e.uht.splice(o)),i.Ut.zdt(!0),i.resumePaint(),!0):void 0)},k.prototype.Ydt=function(t,n){var e,i,r,o,e=this,i=e.sheet();if(i.suspendPaint(),!n)throw new Error(a().Exp_FloatingObjectNameEmptyError);if(e.vst[n])throw new Error(a().Exp_FloatingObjectHasSameNameError);r=e.vst[t],delete e.vst[t],e.vst[n]=r,-1<(o=e.uht.indexOf(t))&&e.uht.splice(o),e.uht.push(n),r.onNameChanged&&r.onNameChanged(t,n),i.resumePaint()},k.prototype.d5=function(e){var i=this,t=i.sheet();t.suspendPaint(),S.GC$.each(this.vst,function(t,n){e&&e!==n.iht||i.VP(n.name())}),i.uht=[],t.resumePaint()},k.prototype.QP=function(e){var i=[];return S.GC$.each(this.vst,function(t,n){e&&e!==n.iht||i.push(n)}),i},k.prototype.tht=function(t,n){var e,t,e=isNaN(n),t=this.ev(t);if(t){if(e)return zt(t);Yt(t,n)}if(e)return-1},k.prototype.toJSON=function(){var e=[];return this.QP().forEach(function(t){var n,t;t instanceof C&&t.Zdt()&&(n=t.toJSON(),t=t.tht,isNaN(t)||(n.zIndex=t),e.push(n))}),e},k.prototype.wh=function(){this.toJSON()},k.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,u,u,a,u,a,e=this;if(t&&0!==t.length)for(i=0;i<t.length;i++)o=void 0,(r=t[i])&&(a=void 0,u=r.floatingObjectType,"0"===(u=S.mt.T1(u)?u+"":r.typeName)?o=new C:"1"===u?o=C.gdt():(a=(0,S.getTypeFromString)(u))&&(o=new a),o)&&(u=(a=(u=e.sheet())&&u.parent)&&a.Gie,o.fromJSON(r,n,u),e.ZP(o),a=r.zIndex,d(a)||(o.tht=a))},k.prototype.yh=function(t,n,e,i){var r,o,a;t&&0!==t.c_.length&&(o=(r=this).sheet(),a=S.Util.Co(i),t.c_.forEach(function(t){r.Wdt(o,t,e,n,a)}))},k.prototype.Wdt=function(t,n,e,i,r){var o,a;n.twoCellAnchor?(o=n.twoCellAnchor,a=l.ST_AnchorType.twoCellAnchor):n.oneCellAnchor?(o=n.oneCellAnchor,a=l.ST_AnchorType.oneCellAnchor):n.absoluteAnchor&&(o=n.absoluteAnchor,a=l.ST_AnchorType.absoluteAnchor),o&&(o.grpSp?this.zpe(t,o,e,i,r):this.zoe(t,o,a,e,i,r))},k.prototype.zoe=function(t,n,e,i,r,o){var a,u,r,s,c,f,o,e,a,s,t,a=this,u={};a.fromBaseDrawingSJSFormat(n,u),(r=V(r.c_,u.Qdt))&&(k.et(this,"isSupportType",s={relatedFile:r}),c=Kt(r.Type)&&pn(n.pic),s.isSupportType||c)&&(o&&z(t,n,p,i),e===l.ST_AnchorType.twoCellAnchor?a.Kdt(t,n,u):e===l.ST_AnchorType.oneCellAnchor?a.Jdt(t,n,u):e===l.ST_AnchorType.absoluteAnchor?a.Xdt(n,u):e===l.ST_AnchorType.groupShapeAnchor&&a.Ype(n,u),s.isSupportType?k.et(this,"fromSJSFormat",f={relatedFile:r,data:i,sheet:t,resultData:u}):c&&(o=C.gdt&&C.gdt())&&(e=(e=r.Target).split("/").pop(),a=i.media,s=u.name,u.src=oe(e,a[e]),s&&(u.name=Mt(this.uht,s)),o.fromJSON(u),this.ZP(o),n.lossless)&&n.lossless.content&&((t=v(A.xht)).innerHTML=n.lossless.content,o.content((0,S.GC$)(t.firstChild)[0])))},k.prototype.zpe=function(n,t,e,i,r){var o,t,a,o=this,t=(0,S.RF)(t.grpSp&&t.grpSp.c_||t.c_||[]),a=t[1].grpSpPr.xfrm;t.forEach(function(t){"grpSp"===t.n_?(o.updateGroupXfrm(a,t.c_[1].grpSpPr.xfrm),o.zpe(n,t,e,i,r)):t.graphicFrame&&(o.updateGroupXfrm(a,t.graphicFrame.xfrm),o.zoe(n,t,l.ST_AnchorType.groupShapeAnchor,e,i,r))})},k.prototype.convertXfrm=function(t){var n=function(t){return o(r(t),6)};t.chExt&&(t.chExt.cx=n(t.chExt.cx),t.chExt.cy=n(t.chExt.cy)),t.chOff&&(t.chOff.x=n(t.chOff.x),t.chOff.y=n(t.chOff.y)),t.ext.cx=n(t.ext.cx),t.ext.cy=n(t.ext.cy),t.off.x=n(t.off.x),t.off.y=n(t.off.y)},k.prototype.updateGroupXfrm=function(t,n){var e,i,r,o,a,u,s,t,c,f,l,h,d,v;t.hasConvert||(this.convertXfrm(t),t.hasConvert=!0),n.hasConvert||(this.convertXfrm(n),n.hasConvert=!0),e=t.chExt.cx,i=t.chExt.cy,r=t.chOff.x,o=t.chOff.y,a=t.off.x,u=t.off.y,s=t.ext.cx,t=t.ext.cy,c=n.off.x,f=n.off.y,l=n.ext.cx,h=n.ext.cy,n.off.x=a+(d=(c-r)/(e||1)*s),n.off.y=u+(v=(f-o)/(i||1)*t),n.ext.cx=l/(e||1)*s,n.ext.cy=h/(i||1)*t},k.prototype.Kdt=function(t,n,e){var i,r,o,a,n,u,u,o,o=n.editAs||0,a=n.from,n=n.to,u=re(K[o]);e.dynamicMove=u.dynamicMove,e.dynamicSize=u.dynamicSize,e.placement=o,a&&(u=$t(a),e.x=_(t,0,u.col)+u.colOff,e.y=D(t,0,u.row)+u.rowOff,e.startRow=u.row,e.startRowOffset=u.rowOff,e.startColumn=u.col,e.startColumnOffset=u.colOff),n&&(o=$t(n),i=_(t,0,o.col)+o.colOff,r=D(t,0,o.row)+o.rowOff,e.endRow=o.row,e.endRowOffset=o.rowOff,e.endColumn=o.col,e.endColumnOffset=o.colOff),e.height=r-e.y,e.width=i-e.x},k.prototype.Jdt=function(t,n,e){var i,n,i,i=n.from,n=n.ext;e.dynamicMove=!0,e.dynamicSize=!1,e.placement=1,i&&(i=$t(i),e.x=_(t,0,i.col)+i.colOff,e.y=D(t,0,i.row)+i.rowOff),n&&(e.width=o(r(n.cx),6),e.height=o(r(n.cy),6))},k.prototype.Xdt=function(t,n){var e=t.from||t.pos,t=t.ext;n.dynamicMove=!1,n.dynamicSize=!1,n.placement=2,e&&(n.x=o(r(e.x),6),n.y=o(r(e.y),6)),t&&(n.width=o(r(t.cx),6),n.height=o(r(t.cy),6))},k.prototype.Ype=function(t,n){var t,t,t=t.graphicFrame;n.dynamicMove=!1,n.dynamicSize=!1,n.placement=2,t=ae(t.xfrm),n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height},k.prototype.fromBaseDrawingSJSFormat=function(t,n){var e,i,r,t,o,o,o,e,o,a,u,s,c,e,e=t.graphicFrame,i=t.pic,r=t.AlternateContent,t=t.clientData;if((e=r&&r.Choice&&(o=r.Choice.graphicFrame)?o:e)&&((o=e.nvGraphicFramePr.cNvPr)&&(n.name=o.name,n.isVisible=!f(o.hidden)||!1,n.alt=o.descr),o=e.graphic.graphicData)&&o.chart&&(n.Qdt=o.chart[B]),i){for(s in(e=i.nvPicPr.cNvPr)&&(n.name=e.name,n.isVisible=!f(e.hidden)||!1,n.alt=e.descr),a=(o=i.blipFill.blip)&&o["r:embed"],u=Xt(u=o&&o.extLst&&o.extLst.ext)?u:[u])u.hasOwnProperty(s)&&(c=u[s]&&u[s]["asvg:svgBlip"])&&(a=c["r:embed"]);n.Qdt=a}r&&((e=r.cNvPr)&&(n.name=e.name,n.isVisible=!f(e.hidden)||!1,n.alt=e.descr),r.chart)&&(n.Qdt=r.chart[B]),t?(n.isLocked=f(t.fLocksWithSheet,!0),n.canPrint=f(t.fPrintsWithSheet,!0)):(n.isLocked=!0,n.canPrint=!0)},k.prototype.L0=function(e){(0,S.GC$)(c.body).unbind("scroll"+A.rht);var t=this,n=t.sheet();n&&(n._3(S.Events.ColumnChanged+A.rht),n._3(S.Events.RowChanged+A.rht),n._3(S.Events.ColumnWidthChanged+A.rht),n._3(S.Events.RowHeightChanged+A.rht)),!1!==e&&(t.vst&&S.GC$.each(t.vst,function(t,n){n.L0(e)}),t.sheet(T))},k.prototype.hitTest=function(e,i,r){var o,t,a,n,u,s,s,o=this.sheet(),t=o.Fi(),a=T;if(t)for(n=0;n<=2;n++)for(u=0;u<=2;u++)if((s=t.c9(n,u))&&s.contains(e,i)&&((s=o.Gdt&&o.Gdt(n,u))&&s.Vht.each(function(t){var n=t.Blt;n&&n.isVisible()&&(o.Pdt(n)||r)&&Jt(e,i,t.qdt)&&(a?zt(a.floatingObject)<zt(n)&&(a.floatingobject=n):a={x:e,y:i,floatingObject:n,Dn:t})}),a))return a;return a},k.prototype.jlt=function(t){for(var n,e,e=(t=t||"FloatingObject")+(n=1).toString();this.ev(e);)e=t+(++n).toString();return e},I=k,t.FloatingObjectModel=I,i={sheet:W("sheet",p)},S.GC$.extend(I.prototype,i),(0,S.$e)(I),mt=["dotted","dashed","solid","double","groove","ridge","inset","outset"],gt=[A.Plt,A._X,A._Y,A.qlt,A.Jlt,A.Ult,A.Qlt,A.Hlt,A.Klt,A.zlt,A.Xlt,A.Vlt,A.$lt,A.Tdt,A.Cdt,A.Sdt,A.aht,A.Idt,A.Adt,A.xdt,A.Ndt,A.kdt,"alt"],e=[["sheet",T,function(){ln(this)}],[A.Plt,p,function(t,n){var e,i,i,r,e=this,i=e.sheet();i&&(r=(i=i.WL).ev(n))===e&&i.Ydt(n,t),e.onPropertyChanged("name",t,n)},rn],[A._X,0,an(A._X,!1)],[A._Y,0,an(A._Y,!1)],[A.Jlt,0,an(A.Jlt,!0)],[A.qlt,0,an(A.qlt,!0)],[A.Ult,p,jt(A.Ult)],[A.Qlt,0,jt(A.Qlt)],[A.Hlt,p,jt(A.Hlt)],[A.Klt,0,jt(A.Klt)],[A.zlt,p,Ot(A.zlt)],[A.Xlt,0,Ot(A.Xlt)],[A.Vlt,p,Ot(A.Vlt)],[A.$lt,0,Ot(A.$lt)],[A.Cdt,!1,Dt(A.Cdt)],[A.Sdt,!0,on(A.Sdt)],[A.Tdt,!0,on(A.Tdt)],[A.aht,!0,Dt(A.aht)],[A.Idt,!0,function(t,n){on(A.Idt).call(this,t,n)},function(t){return"boolean"==typeof t&&(t||this.dynamicSize(!1,!1),!this.fixedPosition())}],[A.Adt,!0,function(t,n){on(A.Adt).call(this,t,n)},function(t){return"boolean"==typeof t&&this.dynamicMove()&&!this.fixedPosition()}],[A.xdt,!1,function(t,n){var e=this;t&&(e.dynamicMove(!1,!1),e.dynamicSize(!1,!1)),e.onPropertyChanged(A.xdt,t,n)}],[A.Ndt,!0,Dt(A.Ndt)],[A.kdt,!0,Dt(A.kdt)],["alt","",on("alt")]],t.isFloatingObjectPicture=pn,j.prototype.position=function(t){var n,e,i,r,n=this,e=n.sheet();return 0===arguments.length?new S.Point(n.x(),n.y()):(i=n.x(),r=n.y(),!t||isNaN(t.x)||isNaN(t.y)||i===t.x&&r===t.y||(n.x(t.x,!1),n.y(t.y,!1),fn(n),vn(n),e&&e.zw(),n.onPropertyChanged("position",t,new S.Point(i,r))),n)},j.prototype.cloneContent=function(){var t,n,e,t=this.content();return t?(n=void 0,n=t.cloneNode?t.cloneNode(!0):((e=v(A.xht)).innerHTML=t.outerHTML,e.firstChild),(0,S.GC$)(n).removeAttr("id")[0]):T},j.prototype.refreshContent=function(t){var n,e,i,r,o,a,u,n=this;n.Zlt&&t&&((e=(0,S.GC$)(t)).empty(),i=n.cloneContent(),r=A.Odt,o=A.Odt,u=a="",i&&i.style&&(a=i.style.width,u=i.style.height),""!==a&&(r=a),""!==u&&(o=u),i!==T&&(0,S.GC$)(i).css({width:r,height:o}).addClass(A.Rdt).addClass(A.Nht).attr(A.kht,A.Dht).appendTo(t),e.css(A.Zht,""),n.Zlt=!1)},j.prototype.toJSON=function(){var t,n,e,i,t=this,n=kt.call(t,gt),e=t.cht;for(i in e)d(e[i])||(n[i]=e[i]);return n.typeName=t.typeName,n[A.Ylt]=(0,S.GC$)(v(A.xht)).append(t.cloneContent()).html(),n},j.prototype.wh=function(t){var n,e,n=this,e;return"1"===n.typeName&&n.toSJSFormat_PictureDrawing(t),t},j.prototype.toSJSFormat_PictureDrawing=function(t){var n,e,i,r,i,i,r,o,o,r,a,a,u,a,u,s,c,f,l,n=this,e=n.sheet(),i=n.pictureStretch();1===i?r=wn(e,n):2===i?r=yn(e,n):3===i&&(r=Mn(e,n)),i=bn(n.dynamicMove(),n.dynamicSize()),i={editAs:K[i]},r?(i.from={col:{v_:r.startColumn},colOff:{v_:h(r.startColumnOffset||0)},row:{v_:r.startRow},rowOff:{v_:h(r.startRowOffset||0)}},i.to={col:{v_:r.endColumn},colOff:{v_:h(r.endColumnOffset||0)},row:{v_:r.endRow},rowOff:{v_:h(r.endRowOffset||0)}}):(i.from={col:{v_:n.startColumn()},colOff:{v_:h(n.startColumnOffset()||0)},row:{v_:n.startRow()},rowOff:{v_:h(n.startRowOffset()||0)}},i.to={col:{v_:n.endColumn()},colOff:{v_:h(n.endColumnOffset()||0)},row:{v_:n.endRow()},rowOff:{v_:h(n.endRowOffset()||0)}}),!1===n.isLocked()&&(i.fLocksWithSheet="0"),r={id:n.wp,name:n.name()},n.isVisible()||(r.hidden="1"),(o=n.alt())&&(r.descr=o),r.extLst={ext:{r_:[26],creationId:{r_:[24,25]}}},o={cNvPr:r,cNvPicPr:{picLocks:{noChangeAspect:"1"}}},(r={}).blip={r_:[8],"r:embed":t._id,extLst:{ext:{r_:[23],useLocalDpi:{r_:[22],val:"0"}}}},(a=n.fdt)?(a=Tn(a),u={},d(a.l)||0===a.l||(u.l=a.l),d(a.t)||0===a.t||(u.t=a.t),d(a.r)||0===a.r||(u.r=a.r),d(a.b)||0===a.b||(u.b=a.b),r.srcRect=u):r.stretch={fillRect:{}},a={},n.$dt&&(a.rot=6e4*n.$dt),a.xfrm={off:{x:"0",y:"0"},ext:{cx:"0",cy:"0"}},a.prstGeom={prst:"rect",avLst:{}},n.backColor()?a.solidFill=Ut(e,n.backColor()):a.noFill={},u=Cn(n.borderStyle())?0:n.borderWidth(),s=n.borderColor(),c=Sn(n.borderStyle()),f=n.noFill(),l=a.ln={},d(u)||(l.w=y(h(u),0)),"dbl"===c&&(l.cmpd="dbl"),f?l.noFill={}:l.solidFill=Ut(e,s),"dbl"!==c&&(l.prstDash={val:c}),i.pic={nvPicPr:o,blipFill:r,spPr:a,lossless:{isFloatingObject:!0}},i.clientData={},d(i.lossless)&&(i.lossless={}),i.lossless[A.Ylt]=(0,S.GC$)(v(A.xht)).append(n.cloneContent()).html(),t.c_.push({twoCellAnchor:i})},j.prototype.fromJSON=function(t,n){var e,n;t&&((e=this).tvt=!0,_t.call(this,gt,t,n),d(t[A.Ult])&&vn(e),t.content&&((n=v(A.xht)).innerHTML=t.content,e.content((0,S.GC$)(n.firstChild)[0])),e.tvt=p)},j.prototype.yh=function(t,n){},j.prototype.clone=function(t){var n,e,e,i,n=this,e=(0,S.getTypeFromString)(n.typeName),e=new(e||j),i=JSON.stringify(n.toJSON());return e.fromJSON(JSON.parse(i)),e.content(n.cloneContent()),e},j.prototype.onPropertyChanged=function(t,n,e){var i,r,i=this;i.tvt||(r=i.sheet())&&(r.Ut.nvt(i,t,e,n),i.ki({sheet:r,sheetName:r.name(),floatingObject:i,propertyName:t,oldValue:e}))},j.prototype.ki=function(t){var n,t,n=this.sheet();n&&(n.ki(S.Events.FloatingObjectChanged,t),t.propertyName===A.Cdt)&&(t={sheet:t.sheet,sheetName:t.sheetName,floatingObject:t.floatingObject},n.ki(S.Events.FloatingObjectSelectionChanged,t))},j.prototype.JO=function(t,n){var e=this;t=b(t),n=b(n),un.call(e,e[A.Ult],e[A.zlt],t,n)},j.prototype.xP=function(t,n){var e=this,i;sn.call(e,e[A.Ult],e[A.Qlt],e[A.zlt],e[A.Xlt],t,n,t+n-1)},j.prototype.qO=function(t,n){var e=this;t=b(t),n=b(n),un.call(e,e[A.Hlt],e[A.Vlt],t,n)},j.prototype.NP=function(t,n){var e,i,e=this;t=b(t),n=b(n),sn.call(e,e[A.Hlt],e[A.Klt],e[A.Vlt],e[A.$lt],t,n,i=t+n-1)},j.prototype.getHost=function(t,n){var e,i,r,e=this.Ti.concat();if(d(t)||d(n))return e;for(i=0;i<e.length;i++)if((r=e[i]).rowViewportIndex===t&&r.columnViewportIndex===n)return r;return T},j.prototype.evt=function(t,n,e){var i=this.Ti;t&&i.indexOf(t)<0&&(t.rowViewportIndex=n,t.columnViewportIndex=e,i.push(t))},j.prototype.ivt=function(t){var n=this.Ti,t=n.indexOf(t);0<=t&&n.splice(t,1)},j.prototype.rvt=function(t,n){var e,i,r,o,a,u,s,e=v(A.xht);return(0,S.GC$)(e).addClass(A.jdt).addClass(A.Edt).attr(A.kht,A.Dht).css(A.ldt,A.ddt),i=this.cloneContent(),r=A.Odt,o=A.Odt,u=a="",(s=i&&i.style)&&(a=s.width,u=s.height),""!==a&&(r=a),""!==u&&(o=u),i!==T&&(0,S.GC$)(i).css({width:r,height:o}).addClass(A.Rdt).addClass(A.jdt).attr(A.kht,A.Dht).appendTo(e),this.evt(e,t,n),e},j.prototype.Zdt=function(){return!0},j.prototype.L0=function(t){},j.prototype.ovt=function(){Et(this),nn(this)},j.prototype.vdt=function(t){var n,e,e,n=this;return 1===t?w(n.width()):(e=gn(n.startColumn(),n.startColumnOffset(),n.sheet(),!1),e=Gt(n,!1,e+n[A.qlt]()),mn(n.startColumn(),e.index,n.startColumnOffset(),e.offset,t,n.sheet(),!1))},j.prototype.mdt=function(t){var n,e,e,n=this;return 1===t?w(n.height()):(e=gn(n.startRow(),n.startRowOffset(),n.sheet(),!0),e=Gt(n,!0,e+n[A.Jlt]()),mn(n.startRow(),e.index,n.startRowOffset(),e.offset,t,n.sheet(),!0))},C=j,t.FloatingObject=C,pt={content:W(A.Ylt,T,Dt(A.Ylt))},S.GC$.each(e,function(t,n){pt[n[0]]=W(n[0],n[1],n[2],n[3])}),S.GC$.extend(C.prototype,pt),R.prototype.wK=function(t){var n,n,e,i,r,o,a,n=(0,S.GC$)(t.target).attr("resizeDirection");if(n)return n;if(n=(0,S.GC$)(this.Hht).offset(),e=t.pageX-n.left,i=t.pageY-n.top,r=this.edt)for(o=0;o<r.length;o++)if((a=r[o]).rect.contains(e,i))return a.direction},R.prototype.avt=function(t){var n,e,n,i,r,o,a,u,n=t.target,e;if((0,S.GC$)(n).attr("resizeDirection"))return n.style.cursor;if(n=(0,S.GC$)(this.Hht).offset(),i=t.pageX-n.left,r=t.pageY-n.top,o=this.edt)for(a=0;a<o.length;a++)if((u=o[a]).rect.contains(i,r))return u.cursor},R.prototype.gg=function(t){var n,e,i,r,o,a,u,u,u,r,s,r,c,i,c,i,i,n=this,e=n.Mf,i=n.Blt,r=e.Ut.pI,o=n.AW,a=n.IW;if(e._lt(i)&&e.endEdit()&&(e.Zg(!0),R.et(n,"preProcessMouseDown",u={e:t,r:T}),!u.r)){if(0===t.button||2===t.button){if(u=i.isSelected(),t.ctrlKey||t.shiftKey?i.isSelected(!u):u||(e.Olt(),i.isSelected(!0)),u||S.hi.F1(e),r&&r.CZ(),e.e4(),e.G1&&e.G1(),2===t.button)return;if(u=e.rt,r=e.uw(),s=n.wK(t),r=new S.Point(t.pageX-r.left,t.pageY-r.top),c=kn(n,s),!i.allowMove()&&(!i.allowResize()||c.inMoving))return;n.fk=r,n.uvt=!0,(n.wht=c).inMoving?((i={}).startTopRow=e.getViewportTopRow(o),i.startLeftColumn=e.getViewportLeftColumn(a),i.startX=r.x,i.startY=r.y,n.CK=i):(Vn(n),c={},i=xn(n.Mht),c.startX=i.x,c.startY=i.y,c.startWidth=i[A.qlt],c.startHeight=i[A.Jlt],c.startTopRow=e.getViewportTopRow(o),c.startLeftColumn=e.getViewportLeftColumn(a),c.cursor=n.avt(t),c.direction=s,n.lht=c),zn(n),i=e.hitTest(r.x,r.y),u.Rk={e9:i.rowViewportIndex,r9:i.colViewportIndex,Bk:i.hitTestType},u.fk=r,u.Ok(),u.u9=!0,e.ki(S.Events.FloatingElementSelected,{type:"floatingObject"})}return!1}},R.prototype.pg=function(t){var n,e,i,r,o,r,a,u,u,s,t,s,n=this,e=n.Mf,i=n.Hht,r=n.zht;if(e._lt(n.Blt)){if(R.et(n,"preProcessMouseMove",o={e:t,r:T}),!o.r)return u=(a=n.Blt).isLocked()&&e.isActualProtected(),(0,S.GC$)(i).css(A.odt,u||!a.allowMove()?"default":A.pdt),e.vk?(i&&(0,S.GC$)(i).css(A.odt,"default"),!0):(u=e.rt,s=e.uw(),t=new S.Point(t.pageX-s.left,t.pageY-s.top),n.uvt?(n.wht.inMoving?n.fk.x===t.x&&n.fk.y===t.y||(n.iQ=!0,Vn(n),Bn(n,n.fk,t),(0,S.GC$)(r).css(A.odt,A.pdt)):n.Blt.allowResize()&&(n.Eb=!0,jn(n),(0,S.GC$)(r).css(A.odt,n.lht[A.odt])),(n.iQ||n.Eb)&&(n.fk=t,u.fk=t,u.a9(),(0,S.GC$)(c.body).addClass(A.Nht).attr(A.kht,A.Dht))):(s=e.parent).options.enableAccessibility&&s.n2(a.alt()),!1);(r=o.cursor)&&(0,S.GC$)(i).css(A.odt,r)}},R.prototype.bg=function(t){var n,e,i,r,o,a,u,u,o,i,e,n=this,e=n.Mf,i=e.rt,r=n.Blt,o=n.Hht,a=n.wht;if(e._lt(r)&&(R.et(n,"preProcessMouseUp",u={e:t,r:T}),!u.r))return e.vk?((0,S.GC$)(o).css(A.odt,A.pdt),!0):(i.u9=!1,i.l9(),u=e.uw(),o=new S.Point(t.pageX-u.left,t.pageY-u.top),(i=n.CK)&&(i.endX=o.x,i.endY=o.y),a&&(e=r.fixedPosition(),a.inMoving&&n.iQ?(e&&Gn(n),(t.ctrlKey?En:Rn)(n)):n.Eb&&(e&&Un(n),Ln(n)),(0,S.GC$)(c.body).removeClass(A.Nht)),n.Flt(),!1)},R.prototype.Flt=function(){var t=this;t.lht=T,t.CK=T,(t.Cht=T,S.GC$)(t.zht).remove(),t.Mht=T,t.uvt=!1,Yn(t),t.iQ=!1,t.Eb=!1},R.prototype.Dn=function(t,n){var e,i,r,o,a,u,u,u,s,n,e=this,i=e.Blt,r=e.Mf;if(i){if(o=!1,e.svt=t,!(a=e.Hht)){if(t.width<=0||t.height<=0)return;Ht(i,a=e.Hht=Hn(e)),(u=r.parent)&&(u=e.fF=u.j2())&&(0,S.GC$)(u).append(a)}(u=e.Xht)||(u=e.Xht=i.rvt(e.AW,e.IW),"1"===i.typeName?(e.qht=v(A.xht),(0,S.GC$)(e.qht).addClass(A.Nht+" "+A.Edt).attr(A.kht,A.Dht),a.appendChild(e.qht),e.qht.appendChild(u)):(a.appendChild(u),o=!0)),e.qht&&(Jn(e,n,t),n.x=0,n.y=0),s=(0,S.GC$)(u),(0,S.GC$)(a).css([A.ght,A.pht,A.qlt,A.Jlt],[t.y,t.x,t[A.qlt],t[A.Jlt]]),s.css([A.ght,A.pht,A.qlt,A.Jlt],[n.y,n.x,n[A.qlt],n[A.Jlt]]),e.qdt=t,i.refreshContent&&i.refreshContent(u),e.qht&&Qn(e),i.isSelected()?(s.removeClass(A._dt).addClass(A.Ddt),i.allowResize()?Zn(e,a):e.ndt&&Wn(e,a)):(s.removeClass(A.Ddt).addClass(A._dt),Wn(e,a)),o&&(n=u.firstChild,r.ki(S.Events.FloatingObjectLoaded,{sheet:r,sheetName:r.name(),floatingObject:i,element:n}))}},R.prototype.L0=function(){var t=this,n=t.Blt,e=t.Hht,i=t.zht,r=t.Xht;R.et(t,"dispose"),r&&n.ivt&&(n.ivt(r),n.L0(!1)),e&&((0,S.GC$)(e).remove(),t.Hht=T),i&&((0,S.GC$)(i).remove(),t.zht=T)},R.$ht=7,x=R,t.FloatingObjectRender=x,(0,S.$e)(x),ee.prototype.L0=function(){var t=this.Vht;t.each(function(t){t.L0()}),t.empty(),this.Mf=T},ee.prototype.Dn=function(d,v,t){var m,g,p,b,n,e,i,r,o,t;if(!(d<0||v<0)){for(g=(m=this).Mf,p=m.Vht,b=g.WL,n=qn(m,d,v,t),e=[],p.each(function(t){n.find(t.name)&&b.ev(t.name)===t.Blt||e.push(t)}),r=e.length,i=0;i<r;i++)(o=e[i]).Yht=T,p.remove(o.name),o.L0();t=g.parent&&g.parent.options.useTouchLayout,x.$ht=t?11:7,n.each(function(t){var n,e,i,r,n,o,i,a,u,s,a,i,c,u,f,l,h,h,e,n=b.ev(t.name),e=w(x.$ht/2+1);n&&"1"===n.typeName&&(i=n.borderWidth(),e<(i=en(r=n.borderStyle())?i:0))&&(e=i),n=Xn(m,d,v),i=t.x-e-(o=1),a=t.y-e-1,u=t[A.qlt]+2*e+2,c=s=t[A.Jlt]+2*e+2,u=u,h=-1*(l=f=e)-1,(f=a-(a=y(n.y,a))+(f=e))<=0?c=c+f+h:f<e&&0<f&&(c-=e-f),(l=i-(i=y(n.x,i))+(l=e))<=0?u=u+l+h:l<e&&0<l&&(u-=e-l),(h=p.find(t.name))||((h=new x(b.ev(t.name),g)).Yht=m,p.push(h)),h.GY=t,h.AW=d,h.IW=v,e=new S.Rect(n.x,n.y,n[A.qlt],n[A.Jlt]),h.Dn(new S.Rect(i,a,u,c).getIntersectRect(e)||new S.Rect(i,a,0,0),new S.Rect(l,f,t[A.qlt],t[A.Jlt]))})}},bt=ee,S.Worksheet.ch(A.bdt,wt={getUsedRange:function(t){var n,e,e;t.type&S.UsedRangeType.picture&&(e=(e=(n=this).pictures)&&e.getUsedRange(),L(t.range,e))},init:function(){var t,e,t=this,e=t.cvt=[];t.Vdt=function(n){e.forEach(function(t){t.Vnn&&t.Vnn(n)})},t.WL=t.Ut.WL,t.pictures=new vt(t,"1"),t.floatingObjects=new vt(t,"0")},dispose:function(e){var t=this;St(t,e.clearCache),t.WL&&S.GC$.each(t.WL.QP(),function(t,n){n.L0(e.clearCache)}),!1!==e.clearCache&&(t.pictures&&(t.pictures.L0(),t.pictures=T),t.floatingObjects&&(t.floatingObjects.L0(),t.floatingObjects=T),t.oht=T,t.Vdt=T,t.Gdt=T),t.unbind(S.Events.TableFiltered+A.Bdt),t.unbind(S.Events.RangeFiltered+A.Bdt),t.unbind(S.Events.FloatingElementSelected+A.Bdt)},setHost:function(t){var e;t&&(e=this).bind(S.Events.FloatingElementSelected+A.Bdt,function(t,n){"floatingObject"!==n.type&&e.Olt()})},onLayoutChanged:function(t){var n,e,i,r,t,o;!d(t.sheetArea)&&3!==t.sheetArea||(n=t.changeType,e=t.row,i=t.rowCount,r=t.col,t=t.colCount,o=this.WL,"addRows"===n?Tt(o,e,i):"deleteRows"===n?At(o,e,i):"addColumns"===n?It(o,r,t):"deleteColumns"===n&&xt(o,r,t))},paint:function(t){var n,t,n,t=t.clipRect;this.oht(t)},lastNonNullRowAndCol:function(){var n,e,t,n=0,e=0,t=this.WL;return t&&t.QP().forEach(function(t){t&&(t[A.zlt]()>n&&(n=t[A.zlt]()),t[A.Vlt]()>e)&&(e=t[A.Vlt]())}),{lastNonNullRow:n,lastNonNullCol:e}},toJson:function(t,n){var e,n,e;n&&n.ignoreStyle||0<(n=this.WL.toJSON()).length&&(t.floatingObjects=n)},fromJson:function(t,n,e){var i,e,r,r,i;e&&e.ignoreStyle||((e=this).WL=new I(e),e.Ut.WL=e.WL,e.WL.isNeedToUpdateLayout=!0,r=t&&t.floatingObjectArray,!(r=n?r&&r.floatingObjects:t.floatingObjects))||e.WL.fromJSON(r,n)},preProcessMouseDown:function(t){var t,n,e,t,n,e,t=t.e,n=this.uw(),e=t.pageX-n.left,t=t.pageY-n.top;!this.il&&this.mnn&&(e=(n=this.hitTest(e,t))&&n.formulaRangeHitInfo)&&(e.inBorder||e.inTopLeft||e.inTopRight||e.inBottomLeft||e.inBottomRight)||this.Olt()},processKeyDown:function(t){te(this.WL)&&(t.r=!0)},onGroupChanged:function(t){this.floatingObjects.Udt(t.start,t.end,t.isRow),this.pictures.Udt(t.start,t.end,t.isRow)},processCompositionStart:function(t){te(this.WL)&&(t.r=!0)},preProcessKeyDown:function(t){var n=this.WL;n&&ne(t.e)&&te(n)&&(t.r=!0)},yh:function(t,n,e){var i,r,o,a,r,a,i;(!e||!1!==e.includeStyles)&&(o=(r=this).WL,(a=t.lossless&&t.lossless.floatingObjects)&&r.WL.fromJSON(a),r=P(t,n))&&(a=r.rels,o.yh(r,a,n,e))},onFilterChanged:function(){var t,n=this.WL;n&&(n.isNeedToUpdateLayout=!0)}}),yt={priority:900,init:function(){S.Commands.Rlt(this.commandManager())},onCommandExecuting:function(t){var n;t.WL.QP().forEach(function(t){t.isSelected(!1)})},onCultureChanged:function(){a()},wh:function(t,n,e){var i,r,o,r,a,u,s,c,f,f,l,h,d,v,d,m,g,p,b,w,y,M,C,i=this,r={type:"floatingObjects",saveOptions:e,sheets:[]};if(S.Workbook.et(i,"getAdditionalWorksheetToSJSFormat",r),o=i.sheets.concat(r.sheets),r=i.mp)for(a=0,u=r;a<u.length;a++)s=u[a],e&&e.fileType===S.OpenSaveFileType.excel&&s._gi===S.SheetType.ganttSheet&&(f=(c=s.Mf).name()+"_Chart",(f=c.pictures.get(f))&&0!==f.startRow()&&(f.Wlt=!0,f.startRow(0),f.endRow(c.getRowCount()-1),f.endRowOffset(0),f.Wlt=!1),o.push(s.Mf));for(l=0;l<o.length;l++){if(c=o[l],(h=H(t,c.name())).lossless||(h.lossless={}),v=(d=c.pictures)&&d.all(),m=(d=c.floatingObjects)&&d.all(),I.et(T,"toSJSFormat",{sheet:c,sheetData:h,data:t,saveOptions:e,sjsFileCountDict:i.Cp}),v&&0<v.length){for(g={c_:[]},b=p=void 0,w=0;w<v.length;w++)M=";base64,",(C=(y=v[w]).src())&&0<C.indexOf(M)?(p||(U(h,i.Cp),b=(p=G(t,h)).rels),yt.toSJSFormat_Picture(t,y,g,b)):(h.lossless.floatingObjects||(h.lossless.floatingObjects=[]),h.lossless.floatingObjects.push(tn(y)));0<g.c_.length&&(p.c_=g.c_.concat(p.c_))}if(m&&0<m.length)for(h.lossless.floatingObjects||(h.lossless.floatingObjects=[]),w=0;w<m.length;w++)h.lossless.floatingObjects.push(tn(m[w]))}},toSJSFormat_Picture:function(t,n,e,i){var i=S.Util.Kr(n.src(),i,t);e._id=i,n.wh(e),delete e._id}},S.Workbook.ch(A.bdt,yt),S.GC$.extend(S.Y8.prototype,{nvt:function(t,n,e,i){var r,o,r=this.G8;r&&(o=(o=r.floatingObjectChanges)||(r.floatingObjectChanges=[])).push({type:"property",floatingObject:t,name:n,value:e,newValue:i})},zdt:function(t){var n,e,i,n,r,n=this.G8;n&&(e=(e=n.floatingObjectChanges)||(n.floatingObjectChanges=[]),i={},n=this.WL,S.GC$.each(n.vst,function(t,n){i[t]=n}),t?(r=e[e.length-1]).currentObjects=i:e.push({type:"collection",floatingObjects:i}))},fvt:function(o,a){var u,s,t,n;if(o)for(s=(u=this).WL,t=function(t){var t,n,e,n,i,i,r,t,t=o[t];"collection"===t.type?(n=a?t.currentObjects:t.floatingObjects,e=s.vst,s.vst={},u.Mf.suspendPaint(),u.Mf.clearSelection(),Y.y0(n,function(t,n){var t,t;"Object"===n.constructor.name?(t=(t=e[t])||ie(n,!1,u.Mf),s.ZP(t)):s.ZP(n)}),u.Mf.resumePaint()):"property"===t.type&&(n=["startRow","startRowOffset","startColumn","startColumnOffset","endRow","endRowOffset","endColumn","endColumnOffset"],i="function"==typeof t.floatingObject.name?t.floatingObject.name():t.floatingObject.name,i=s.ev(i),r=t.name,t=a?t.newValue:t.value,i)&&(i.Wlt=!0,i[r](t),0<=n.indexOf(r)&&(Et(i),nn(i),i.sheet().zw()),i.Wlt=!1)},n=o.length-1;0<=n;n--)t(n)}}),S.Y8.ch(A.bdt,{init:function(){this.WL=new I(this.Mf)},applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.floatingObjectChanges;n&&this.fvt(n,!t)},undo:function(t){var t=t.floatingObjectChanges;t&&this.fvt(t)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.WL&&(n.WL.L0(),n.WL=T)}})},"./dist/plugins/floatingObject/floatingobject.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/floatingObject/floatingobject.res.en.js");n.SR={en:e}},"./dist/plugins/floatingObject/floatingobject.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_FloatingObjectNameEmptyError=n.Exp_FloatingObjectHasSameNameError=void 0,n.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",n.Exp_FloatingObjectNameEmptyError="Floating object must have name"},"./dist/plugins/floatingObject/picture.js":function(t,n,e){"use strict";var i,o,a,r,u,s,c,f,l,e,h,d,v,m,g,p,b,w,i,y,M,C;function S(t){return"number"==typeof t&&!isNaN(t)}function T(t,n,e,i,r,o){var t,e,t=C.call(this,t,e,i,r,o)||this,e=t;return e.typeName="1",e.iht="1",e.MC=c,e.cdt=!1,e.lvt=!1,"string"==typeof n&&(e.lvt=!(S(r)&&S(o)),e.src(n)),t}function A(t){var n,t,e,i,r,n=t,t=n.src(),e=n.sheet();n.MC||(n.MC=new o.Wh(function(){A(n)})),i=n.MC;try{i.getState(t)?(n.cdt=!0,r=i.getImage(t),n.hvt=r.width,n.dvt=r.height,n.$dt&&n.$dt%90==0&&(n.udt=I(r,r.width,r.height,n.$dt)),n.lvt&&(n.width(r.width,!0),n.height(r.height,!0),n.lvt=!1),n.ki({sheet:e,sheetName:e.name(),picture:n,propertyName:"originalSize"}),n.isVisible()&&e&&e.repaint()):i.addImage(t)}catch(t){}}function I(t,n,e,i){var r,o,a,u,r=n,o=e;return 90!==i&&270!==i||(r=e,o=n),(a=document.createElement("canvas")).width=r,a.height=o,(u=a.getContext("2d")).translate(r/2,o/2),u.rotate(i/180*Math.PI),u.translate(-r/2,-o/2),u.drawImage(t,0,0,n,e,(r-n)/2,(o-e)/2,n,e),u.setTransform(1,0,0,1,0,0),a.toDataURL()}i=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Picture=void 0,o=e("Core"),a=e("./dist/plugins/floatingObject/floatingobject.js"),r=o.mt.En,u=o.mt.p0,s=o.GC$,c=null,f=void 0,b=[l="src",e="backColor",d="borderRadius",v="borderWidth",m="borderStyle",p="noFill",g="borderColor",h="pictureStretch"],a.FloatingObject.gdt=function(t,n,e,i,r,o){return new w(t,n,e,i,r,o)},C=a.FloatingObject,i(T,C),T.prototype.onPropertyChanged=function(t,n,e){var i,r,i=this;i.tvt||(r=i.sheet())&&(r.Ut.nvt(i,t,e,n),this.ki({sheet:r,sheetName:r.name(),picture:i,propertyName:t}))},T.prototype.toJSON=function(){var t,n,e,i,r,t=this,n=C.prototype.toJSON.call(this);return a.toJsonFn.call(t,b,n),n.originalWidth=t.getOriginalWidth(),n.originalHeight=t.getOriginalHeight(),t.$dt&&(n.rot=t.$dt),(e=t.fdt)&&(i=e.left,r=e.top,n.srcRect={l:i,t:r,r:1-i-e.width,b:1-r-e.height}),n.isTakeOriginalSize=t.lvt,delete n.content,n},T.prototype.fromJSON=function(t,n,e){var i,r,e,n,o;t&&((i=this).tvt=!0,e&&(r=S(t.x)&&S(t.y)&&S(t.width)&&S(t.height))&&(t.endRow=null,t.endRowOffset=null,t.endColumn=null,t.endColumnOffset=null),C.prototype.fromJSON.call(this,t,n),a.fromJsonFn.call(i,b,t,n),t.rot&&(i.$dt=t.rot),i.cdt=!1,(e=t.srcRect)&&(n=e.l,o=e.t,i.fdt={left:n,top:o,width:1-n-e.r,height:1-o-e.b}),i.lvt=t.isTakeOriginalSize,A(i),i.tvt=f)},T.prototype.yh=function(t,n,e){this.fromJSON(t,n,e)},T.prototype.clone=function(){var t,n,t=new T,n=JSON.stringify(this.toJSON());return t.fromJSON(JSON.parse(n)),t},T.prototype.getOriginalWidth=function(){return this.hvt},T.prototype.getOriginalHeight=function(){return this.dvt},T.prototype.vvt=function(t){var n;return 0<=["dotted","dashed","solid","double","groove","ridge","inset","outset"].indexOf(t)},T.prototype.rvt=function(t,n){var e=r("div");return s(e).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.evt(e,t,n),e},T.prototype.ki=function(t){var n,t,n=this.sheet();n&&(n.ki(o.Events.PictureChanged,t),"isSelected"===t.propertyName)&&(t={sheet:t.sheet,sheetName:t.sheetName,picture:t.picture},n.ki(o.Events.PictureSelectionChanged,t))},T.prototype.L0=function(t){var n=this;n.MC&&!1!==t&&(n.MC.L0(),n.MC=c)},w=T,n.Picture=w,i=[[l,f,function(t,n){var e=this;e.cdt=!1,A(e),e.srccallback||(e.srccallback=(0,a.propertyRefreshCallback)(l)),e.srccallback.call(e,t,n)}],[e,c,(0,a.propertyRefreshCallback)(e)],[d,-1,(0,a.propertyRefreshCallback)(d),S],[v,1,(0,a.propertyRefreshCallback)(v),S],[m,"none",function(t,n){var e=this;e.vvt(t)||e.borderWidth(0),e.bscallback||(e.bscallback=(0,a.propertyRefreshCallback)(m)),e.bscallback.call(e,t,n)}],[p,f],[g,c,(0,a.propertyRefreshCallback)(g)],[h,0,(0,a.propertyRefreshCallback)(h)]],y=w.prototype,s.each(i,function(t,n){y[n[0]]=u(n[0],n[1],n[2],n[3])})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js":function(t,n,e){"use strict";var S,T,A,n,I,e,b,x,w,y;function N(t,n,e,i,r){var n,t,o,a,u,s,c,n=n.Ut,t=t.Qvt(),o=S.SheetArea.viewport;return t===S.SheetArea.colHeader&&r===S.SheetArea.colHeader?e<(a=n.getFreeAreaRowCount(S.SheetArea.colHeader))&&(o=S.SheetArea.colHeader):t===S.SheetArea.rowHeader&&r===S.SheetArea.rowHeader&&i<(s=n.getFreeAreaColumnCount(S.SheetArea.rowHeader))&&(o=S.SheetArea.rowHeader),o}function k(t,n,e,i,r,o,a,u){var s=t.xA(n,e,n,e,a,u),s=(0,S.Ec)(s.row,s.col,1,1);return s=o&&0<=i?t.xA(n,e,i,r,a,u):s}Object.defineProperty(n,"__esModule",{value:!0}),S=e("Core"),T=e("CalcEngine"),A=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),n=e("Common"),I=n.Common.lt.ht,e=S.GC$.extend,b=null,x=void 0,w=Math.max,y=Math.min,e(S.nk.prototype,{Kvt:function(t){var n,e,i,r,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,o,s,a,c,e,f,r,o,s,n=this,e=n.Mf,i=n.Dde(),r=e.parent,r=r&&0!==r.options.pivotAreaReference;i&&(n.jde(),o=e.frozenRowCount(),a=e.frozenColumnCount(),(u=i.XD)&&n.Lvt||(n.Lvt={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),s=e.getRowCount(),c=e.getColumnCount(),f=t.hitTestType,l=t.row,h=t.col,d=n.shift,v=n.ctrl,i&&i.Xvt&&(i.Xvt===S.SelectionUnit.row?f=2:i.Xvt===S.SelectionUnit.column&&(f=1)),g=(m=n.Lvt).anchorRow,p=m.anchorCol,w=b=-1,M=N(i,e,l,h,f),0===f?(b=o?e.N9():e.Tb,w=a?e.k9():e.Ab,y=(0,S.Ec)(-1,-1,-1,-1),i.Gvt((0,A.Uvt)(e,y),d,!v,x,M),n.rb=!0):1===f?(M===S.SheetArea.viewport?(b=o?e.N9():e.Tb,y=e.xA(0,w=h,s-1,h,!0),d&&0<=p&&(y=e.xA(0,h,s-1,p,!0)),y=(0,S.Ec)(-1,y.col,-1,y.colCount)):M===S.SheetArea.colHeader&&(y=k(e,b=l,w=h,g,p,d,!0,M)),(C=t.tableSelectInfo&&t.tableSelectInfo.tableSelection)?n.Dse(C,y,l,h,g,p,d,v,M):i.Gvt((0,A.Uvt)(e,y,x,M),d,!v,x,M),n.rb=!0):2===f?(b=l,w=a?e.k9():e.Ab,y=e.xA(l,0,l,c-1,!0),d&&0<=g&&(y=e.xA(l,0,g,c-1,!0)),y=(0,S.Ec)(y.row,-1,y.rowCount,-1),i.Gvt((0,A.Uvt)(e,y),d,!v,x,M),n.rb=!0):3===f&&(w=h,(b=l)!==x)&&h!==x&&(o=t.row,s=t.col,e=(c=(a=t.pivotTableInfo)&&a.getPivotInfoImp(o,s,!1,!0))&&c.area,C=t.tableSelectInfo&&t.tableSelectInfo.tableSelection,!(r&&T.Functions.findGlobalFunction("GETPIVOTDATA")&&!i.Ivt&&a&&c&&4===e)||(i.Fvt=new S.Range(o,s,1,1),f=c.valueFieldName,r=c.rowInfos,o=c.colInfos,I(f))||!r&&!o?n.Dse(C,y,l,h,g,p,d,v,M):(s=n.Pvt(e,f,r,o,a.position()))&&(i.Gvt(s,d,!v,!0,M),n.rb=!0,n.LD=!0)),n.Wk=n.rb,d&&u||(m.anchorRow=b,m.anchorCol=w,m.leadingRow=b,m.leadingCol=w,m.sheetArea=M),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},Dse:function(t,n,e,i,r,o,a,u,s){var c,f,l,c=this,f=c.Mf,l=this.Dde();delete l.Fvt,n=t||k(f,e,i,r,o,a,!0,s),l.Gvt((0,A.Uvt)(f,n,x,s),a,!u,x,s),c.rb=!0},Pvt:function(t,n,e,i,r){var o,a,t,u,s,c,r,c,f,r,l,h,a,o,a=this.Mf;if(4===t)return u=t=void 0,c=r.row,r=r.col,c=(s="",S.Ec)(c,r,1,1),t=(0,A.Uvt)(a,c,!0),f=[],r=[],r=Array.isArray(e)&&Array.isArray(i)?e.concat(i):Array.isArray(e)&&e||Array.isArray(i)&&i,l=/\"/g,h='""',r&&r.forEach(function(t){"number"==typeof t.fieldName?f.push(t.fieldName):f.push('"'+t.fieldName.replace(l,h)+'"'),"number"==typeof t.itemName?f.push(t.itemName):f.push('"'+t.itemName.replace(l,h)+'"')}),s=f.join(","),a='GETPIVOTDATA("'+(u=n.replace(l,h))+'",'+t,""!==s&&(a+=","+s),a+")"},qvt:function(t){var n=A.Ode.Ede();return!!n&&n.Rde(t)},Qk:function(){var t,n,e,i,e,i,t=this,n=this.Dde(),e=t.Rk,i=t.Lvt;e&&t.rb&&(e=e.Bk,i=i.sheetArea,n&&n.Xvt&&(n.Xvt===S.SelectionUnit.row?e=2:n.Xvt===S.SelectionUnit.column&&(e=1)),e===S.SheetArea.viewport||i===S.SheetArea.colHeader||i===S.SheetArea.rowHeader?t.tmt():2===e?t.nmt():1===e&&t.emt())},tmt:function(){var t,n,e,i,n,r,o,a,r,o,e,t=this,n=t.Lvt,e=n.anchorRow,i=n.anchorCol,n=n.sheetArea,r=t.Q9(x,n,!0),o=t.K9(x,n,!0);0<=e&&0<=i&&0<=r&&0<=o&&(r=(a=t.Mf).xA(r,o,e,i,!0,n),o=(0,A.Uvt)(a,r,x,n))&&(e=t.Dde(),t.LD?r.equals(e.Fvt)||(delete e.Fvt,e.Gvt(o,!0,!0)):e.Gvt(o,!0,!1)),t.a9()},nmt:function(){var t,n,e,i,e,n,r,t=this,n=t.Lvt.anchorRow,e=t.Q9();0<=n&&0<=e&&(e=(i=t.Mf).xA(e,0,n,i.getColumnCount()-1,!0),e=(0,S.Ec)(e.row,-1,e.rowCount,-1),n=(0,A.Uvt)(i,e))&&(r=t.Dde()).Gvt(n,!0,!1),t.a9()},emt:function(){var t,n,e,i,e,n,r,t=this,n=t.Lvt.anchorCol,e=t.K9();0<=n&&0<=e&&(e=(i=t.Mf).xA(0,e,i.getRowCount()-1,n,!0),e=(0,S.Ec)(-1,e.col,-1,e.colCount),n=(0,A.Uvt)(i,e))&&(r=t.Dde()).Gvt(n,!0,!1),t.a9()},_D:function(){var t,t,t=this;t.l9(),t.Rk=b,t.rb=!1,t.Wk=!1,(t=t.Dde()).onRangeAppend&&t.onRangeAppend()},Mk:function(t){var n,e,i,r,i,r,o,r,e,a,u,a,u,n=this,e=n.Mf,i=n.Dde(),r=t.formulaRangeHitInfo;r&&r.inBorder&&i&&(i.XD&&i.qD(),i.close(),r=(i=r.paramRange)&&i.text,o=I(i.sheetArea)?S.SheetArea.viewport:i.sheetArea,r)&&(r=(0,A.Vvt)(e,r))&&(n.jde(),e=e.JS(r,o),a=t.row,u=t.col,(a=a<e.row?e.row:a)>=e.row+e.rowCount&&(a=e.row+e.rowCount-1),(u=u<e.col?e.col:u)>=e.col+e.colCount&&(u=e.col+e.colCount-1),a=a-e.row,u=u-e.col,n.rb=!0,n.Kk=!0,n.imt={paramRange:i,fromRange:r,rowOffset:a,colOffset:u,sheetArea:o},n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},Jk:function(){var t,n,e,i,r,o,a,u,s,c,f,l,s,c,l,h,d,v,o,m,g,g,m,g,h,p,t=this;t.rb&&t.Kk&&(e=(n=t.imt).sheetArea,i=t.Q9(x,e,!0),r=t.K9(x,e,!0),0<=i&&0<=r&&(o=n.fromRange,a=n.rowOffset,u=n.colOffset,s=n.toRow,c=n.toCol,l=r,i!==s||l!==c)&&(n.toRow=i,n.toCol=l,c=(s=t.Mf).getRowCount(e),l=s.getColumnCount(e),h=o.row,d=o.col,v=o.rowCount,o=o.colCount,(g=(m=s.Ut).getFreeAreaRowCount(e))<c&&(c=g),(g=m.getFreeAreaColumnCount(e))<l&&(l=g),m=h<0?-1:w(0,y(c-v,i-a)),g=d<0?-1:w(0,y(l-o,r-u)),h=(0,A.Uvt)(s,(0,S.Ec)(m,g,v,o),x,e))&&(p=t.Dde()).Lde(n.paramRange.index,h,!0),t.a9())},ED:function(){var t,t,t=this;t.l9(),t.rb=!1,t.Kk=!1,t.imt=b,(t=t.Dde()).onRangeMoved&&t.onRangeMoved()},Ck:function(t){var n,e,i,r,i,o,a,e,o,u,a,s,c,f,l,n=this,e=n.Mf,i=n.Dde(),r=t.formulaRangeHitInfo;if(r&&i&&(i.XD&&i.qD(),o=(i=r.paramRange)&&i.text,i)&&o&&(a=(0,A.Vvt)(e,o))){if(n.jde(),e=a.row,o=a.row<0?-1:a.row+a.rowCount-1,u=a.col,a=a.col<0?-1:a.col+a.colCount-1,r.inTopLeft)s=o,c=a,f=e,l=u;else if(r.inTopRight)s=o,c=u,f=e,l=a;else if(r.inBottomLeft)s=e,c=a,f=o,l=u;else{if(!r.inBottomRight)return;s=e,c=u,f=o,l=a}n.rb=!0,n.Xk=!0,n.omt={paramRange:i,anchorRow:s,anchorCol:c,toRow:f,toCol:l,sheetArea:t.hitTestType},n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok()}},Ik:function(t,n){var e=this.Dde();return!(e&&e.qMi||(e&&e.Dvt()?(this.Kvt(n),0):!this.qvt(t)))},qk:function(){var t,n,e,i,r,o,a,u,s,i,r,u,s,e,o,a,c,f,o,i,a,r,s,t=this;t.rb&&t.Xk&&(n=t.omt,e=S.SheetArea.viewport,n&&!I(n.sheetArea)&&(e=n.sheetArea),i=t.Q9(x,e,!0),r=t.K9(x,e,!0),0<=i&&0<=r&&(o=n.anchorRow,a=n.anchorCol,u=n.toRow,s=n.toCol,r=r,(i=i)!==u||r!==s)&&(n.toRow=i,n.toCol=r,s=(u=t.Mf).getRowCount(e),e=u.getColumnCount(e),a=a<0?e-1:a,c=y(o=o<0?s-1:o,i),f=y(a,r),o=w(o,i)-c+1,i=w(a,r)-f+1,a=t.Dde(),(0===c&&o===s||a&&a.Xvt===S.SelectionUnit.column)&&(o=c=-1),(0===f&&i===e||a&&a.Xvt===S.SelectionUnit.row)&&(i=f=-1),r=n.paramRange,s=(0,A.Uvt)(u,(0,S.Ec)(c,f,o,i),x,r.sheetArea))&&a.Lde(r.index,s,!0),t.a9())},jD:function(){var t,t,n,t=this;t.l9(),t.rb=!1,t.Xk=!1,t.omt=b,(t=t.Dde()).rl&&-(t.umt=1)!==(n=t.text().lastIndexOf(",",t.caret()))&&(t.umt=n+1),t.onRangeResized&&t.onRangeResized()},ZL:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,l,d,d,v,m,g,p,l,i=this.Mf,r=this.Dde(),o=r&&r.smt();if(o&&0!==o.length&&r.cmt&&(a=t.rowViewportIndex,u=t.colViewportIndex,s=t.hitTestType,!this.yD(a,u,n,e)))for(h=o.length-1;0<=h;h--)if(l=(c=o[h]).sheetArea,!1!==c.allowDrag&&(I(l)||l===s)&&!((d=A.Ode.Ede())&&d._text||(f=(0,A.Vvt)(i,c.text),I(f)))){if(I(l)&&(l=S.SheetArea.viewport),(d=i.Ut.findSpan(f.row,f.col,l))&&d.containsRange(f)&&(f=d),m=(l=i.getRangeRect(a,u,f)).x-2,g=l.x+l.width+1-(v=5),p=l.y-2,l=l.y+l.height+1-5,5+m<=n&&n<g&&(1+p<=e&&e<=3+p||1+l<=e&&e<=3+l))return{paramRange:c,inBorder:!0};if(5+p<=e&&e<l&&(1+m<=n&&n<=3+m||1+g<=n&&n<=3+g))return{paramRange:c,inBorder:!0};if(g<=n&&n<5+g&&l<=e&&e<5+l)return{paramRange:c,inBottomRight:!0};if(m<=n&&n<5+m&&l<=e&&e<5+l)return{paramRange:c,inBottomLeft:!0};if(g<=n&&n<5+g&&p<=e&&e<5+p)return{paramRange:c,inTopRight:!0};if(m<=n&&n<5+m&&p<=e&&e<5+p)return{paramRange:c,inTopLeft:!0}}return b},Dde:function(){var t=this.Mf;return t.il||t.mnn||t.Nde},jde:function(){var t=this.Dde();t&&t.mmt()}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js":function(t,n,e){"use strict";var L,B,P,n,G;function f(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,y,T,A,I,I,y,x,x,N,k,_,D,F,j,O,E,R,a=t.Mf,u=a.rt,s=a.C6(e,i),c=o&&o.smt(),f=c&&c.length;if(!(f<=0)&&(l=t.uO(e,i,r))){for(n.save(),n.rect(l.x,l.y,l.width,l.height),n.clip(),n.beginPath(),h=[],d=u.isFormulaRangeHovering,v=u.AD,m=u.Kk,g=u.imt,p=u.Xk,b=u.omt,T=0;T<f;T++)if(("number"!=typeof(y=(w=c[T]).sheetArea)||y===s)&&(y=w.text,M=w.ranges&&0<w.ranges.length?w.ranges:[(0,P.Vvt)(a,y)])){if((A=P.Ode.Ede())&&A.Mf&&void 0!==y)if(G.OS(y,"!")){if(I=G.gmt(y,"!"),a.name()!==I&&"'"+a.name()+"'"!==I)continue}else if(I=G.gmt(y,"["),y=a.tables,x=(x=a.NMi)&&x._gi===L.SheetType.tableSheet&&x.name()===I,!(a.getCustomNames()[I]||y&&y.findByName(I)||x))continue;for(C=t.fO(e,i,M,l),N=0;N<C.length;N++)(k=C[N])&&0<k.width&&0<k.height&&(S=o.pmt(T),o.bmt(w)||w.isPivotClickCell?(d&&v.paramRange.index===T&&(n.beginPath(),n.lineWidth=2,n.strokeStyle=S,n.rect(k.x+1,k.y+1,k.width-3,k.height-3),n.stroke()),t.wO(n,k,S)):(d&&v.paramRange.index===T||m&&g.paramRange.index===T||p&&b.paramRange.index===T?(n.beginPath(),n.lineWidth=2,n.strokeStyle=S,n.rect(k.x+1,k.y+1,k.width-3,k.height-3)):(n.beginPath(),n.lineWidth=2,n.strokeStyle=S,n.rect(k.x,k.y,k.width-1,k.height-1)),n.stroke()),o.ymt(w)&&((_=B.Common.ft._(S)).a=.1,n.beginPath(),n.fillStyle=B.Common.ft.j(_),n.fillRect(k.x+1,k.y+1,k.width-3,k.height-3)),h.push({rect:k,color:S,allowDrag:w.allowDrag}))}if(0<h.length&&o.cmt)for(D=h.length,T=0;T<D;T++)k=h[T].rect,S=h[T].color,j=k.x-2,O=k.x+k.width+1-(F=5),E=k.y-2,R=k.y+k.height+1-5,!1===h[T].allowDrag||(A=P.Ode.Ede())&&A._text||(n.beginPath(),n.fillStyle=S,n.fillRect(j,E,5,5),n.fillRect(O,E,5,5),n.fillRect(j,R,5,5),n.fillRect(O,R,5,5));n.beginPath(),n.restore()}}Object.defineProperty(n,"__esModule",{value:!0}),L=e("Core"),B=e("Common"),P=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),n=L.GC$.extend,G=B.Common.zf,n(L.g7.prototype,{kde:function(){var t,n,n,e,t=this,n=t.Mf;0<n.My||(n=n.Fi(),e=t.J(),t.FA(n.x,n.y,n.width,n.height),t.jy(e))}}),L.Worksheet.ch("formulaReferencedRanges",{paintAdornment:function(t){var n,e,i,r,o,a,u,s,c,n=this,e=t.ctx,i=t.clipRect,r=n.Dn,o=n.Fi(),c=n.rt.Dde();if(c)for(u=-1;u<=2;u++)for(s=-1;s<=2;s++)-1===u&&-1===s||(a=-1===u?o.L1(s):-1===s?o.B1(u):o.c9(u,s))&&0!==a.width&&0!==a.height&&f(r,e,u,s,i,c)}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js":function(t,n,e){"use strict";var h,i,d,v,u,m;function r(){}function o(t,n){var e,e,i,e;if(n){i=(e=(e=m.Ede())&&e.Mf||t).ui,e=e.ci;try{return h.formulaToRange(t,n,i,e)}catch(t){}}return v}function a(t,n,e,i){var r,o,a,u,a,s,s,c,f,f,e,i,l;return void 0===i&&(i=d.SheetArea.viewport),n?(r=t.Nde,u=(a=(o=m.Ede())&&o.Mf||t).ui,a=a.ci,s=(s=t.parent)&&1===s.options.referenceStyle,c=15,(r&&r.Ivt||e)&&(c=0),n.row<0&&n.col<0&&(n=new d.Range(0,-1,t.getRowCount(),-1)),f=(f=t.tables)&&f.find(n.row,n.col),(o&&o.Ivt||e)&&(c=0),r&&!r.rl&&g(f,n,u)?(o&&o._text&&o.Mf!==t&&(a=-1),h.rangeToFormulaWithStructReference(t,n,u,a,c,s,f)):(e=t.NMi,!f&&i===d.SheetArea.viewport&&e&&e._gi===d.SheetType.tableSheet?p(t,n.col,n.colCount,f=e):(i=h.rangeToFormula(n,u,a,c,s),o&&o._text||r&&r.rl&&r.Smt?(l=(0,d.i2e)(t.name()))+"!"+i:i))):v}function g(t,n,e){if(t){var i=!1,r=!1;if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 1;if(t.hasTotalsRow()&&n.row===t.endRow())return 1;if(n.row===e&&n.col>=t.startColumn()&&n.col+n.colCount<=t.startColumn()+t.dataRange().colCount)return 1}else t.hasHeadersRow()&&n.row===t.startRow()&&(n.rowCount===t.dataRange().rowCount+1&&(i=!0),t.hasTotalsRow())&&n.rowCount===t.dataRange().rowCount+1+1&&(i=!0),n.row===t.dataRange().row&&(n.rowCount===t.dataRange().rowCount&&(i=!0),t.hasTotalsRow())&&n.rowCount===t.dataRange().rowCount+1&&(i=!0);return n.col+n.colCount<=t.startColumn()+t.dataRange().colCount&&(r=!0),i&&r}}function s(t){return t&&"["===t[0]&&"]"===t[t.length-1]}function p(t,n,e,i){var r,o,r,i,r,r,e,n,r=c(i),o=r.columns,r=r.groupInfo,i=i.name();if(-1===n&&(n=0),-1===e&&(e=o.length),r){if(r=r.rightGroupColumnIndex,1===e&&n<=r)return"";if(1<e&&n<=r){if(n+e<=r+1)return"";e-=r-n+1,n=r+1}}return 1===e?"".concat(i,"[").concat(o[n].name,"]"):1<e?(r=n+e-1,s(e=o[n].name)||(e="[".concat(e,"]")),s(n=o[r].name)||(n="[".concat(n,"]")),"".concat(i,"[").concat(e,":").concat(n,"]")):""}function c(t){for(var n,e,i,r,o,a,n=[],e=0,i="";i!==v;)i=t.getColumnName(e),o=void 0,t.Mf.NMi&&(o=t.FDi(e))&&(r=e),e++,i!==v&&n.push({name:i,description:"",isGroupColumn:o});return a={columns:n},u(r)||(a.groupInfo={rightGroupColumnIndex:r}),a}function f(t,n,e,i,r){var o,a,i,o,o=t.rowRelative,a=t.columnRelative;i&&(o&&a?(t.rowRelative=!1,t.columnRelative=!1,t.row+=n,t.column+=e):!o&&a?(t.rowRelative=!0,t.columnRelative=!1,t.row-=n,t.column+=e):(t.columnRelative=!0,t.column-=e)),i=t.endRowRelative,o=t.endColumnRelative,r&&(i&&o?(t.endRowRelative=!1,t.endColumnRelative=!1,t.endRow+=n,t.endColumn+=e):!i&&o?(t.endRowRelative=!0,t.endColumnRelative=!1,t.endRow-=n,t.endColumn+=e):(t.endColumnRelative=!0,t.endColumn-=e))}function l(t,n,e){var i=t.rowRelative,r=t.columnRelative;i&&r?(t.rowRelative=!1,t.columnRelative=!1,t.row+=n,t.column+=e):!i&&r?(t.rowRelative=!0,t.columnRelative=!1,t.row-=n,t.column+=e):(t.columnRelative=!0,t.column-=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.dmt=n.lmt=n.Uvt=n.Vvt=n.Ode=void 0,h=e("SheetsCalc"),i=e("Common"),d=e("Core"),v=null,u=i.Common.lt.ht,r.Ede=function(){return r.DJ},m=r,n.Ode=m,n.Vvt=o,n.Uvt=a,n.lmt=f,n.dmt=l,d.GC$.extend(d.Hv.prototype,{C2:function(t){return!t||!t.Nde||!t.Nde.Dvt()},D2:function(t){return!t||!t.Nde||!!t.Nde.xmt}})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=void 0,o=e("Core"),r(e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),n),e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js"),e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js"),r(e("./dist/plugins/formulaTextbox/formulatextbox.js"),n),r(e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n),e("./dist/plugins/formulaTextbox/formulatextbox-event.js"),e("./dist/plugins/formulaTextbox/formulatextbox-render.js"),e("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),a=e("./dist/plugins/formulaTextbox/formulatextbox.js"),n.findControl=u=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data(a.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(t,n,e){"use strict";var d,i,v,r,m,g,o,a,u;function s(t){var n,e,n=d.mt.En("textarea"),e;return(0,d.GC$)(n).css({display:"none"}),(0,d.GC$)(t).append(n),n}function c(t,n){var e,t,n,n;t&&t.il&&(e=t.il.Kmt,t=t.il.Jmt,n=n?"addClass":"removeClass",e&&(0,d.GC$)(e)[n](r),t)&&(0,d.GC$)(t)[n](r)}function f(){var t=this;t.bZ=-1,t.mvt=-1,t._text="",t.gvt=-1,t.Mf=null,t.XD=!1,t.pvt=-1,t.bvt=null,t.Vv=null,t.yvt=null}function l(){}Object.defineProperty(n,"__esModule",{value:!0}),n.wvt=n.Mvt=void 0,d=e("Core"),i=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),v=e("./dist/plugins/formulaTextbox/formulatextbox.js"),r="gc-across-sheet-func-popup",m=null,g=void 0,n.Mvt=s,f.prototype.d5=function(){var t=this;t.Cvt(),t.bZ=-1,t.mvt=-1,t._text="",t.gvt=-1,t.XD=!1,t.pvt=-1,t.Mf=null,t.Vv=null,t.yvt=null},f.prototype.Cvt=function(){var t,n,e,t=this;t.Mf.xT||(n=t.Mf.getCellType(t.bZ,t.mvt),e={sheet:t.Mf,row:t.bZ,col:t.mvt,sheetArea:3},t.bvt&&t.bvt.firstChild&&n.deactivateEditor(t.bvt.firstChild.firstChild,e)),(0,d.GC$)(t.bvt).remove(),t.bvt=null},f.prototype.Svt=function(t){var n,e,i,n=this,e=t.il;e&&(i=t.vA,n._text=e.text(),n.bZ=i?i.row:t.getActiveRowIndex(),n.mvt=i?i.col:t.getActiveColumnIndex(),n.nT=i?i.sheetArea:d.SheetArea.viewport,n.gvt=e.caret(),n.XD=e.XD,n.pvt=e.Tvt(),n.rl=e.rl,n.Avt=e.Avt,n.Ivt=e.Ivt,n.Mf=t,n.Vv=t.parent,n.yvt=t.rt.it())},f.prototype._6=function(t){var n=this;t.il&&n.Mf&&(n._text=t.il.text(),n.gvt=t.il.caret(),n.XD=t.il.XD,n.pvt=t.il.Tvt())},f.prototype.xvt=function(t){var n,t,n=this,t=t.il;t&&(t.rl=n.rl,t.Avt=n.Avt,t.Ivt=n.Ivt,t.text(n._text),t.caret(n.gvt),n.XD)&&(t.Nvt(),t.Tvt(n.pvt))},f.prototype.kvt=function(t){var n,e,i,r,n=t.oldSheet,e=this,i=n&&n.il;if(i)if(i.close(),(!e.Mf||e.Mf.xT)&&i.Dvt()||e.Avt!==i.Avt){e.Svt(n),r=n.getValue(e.bZ,e.mvt,e.nT),n.suspendEvent();try{if(!n.endEdit(!0,!1))return}finally{n.resumeEvent()}n.setValue(e.bZ,e.mvt,r,e.nT,!0),n.Di=1,t.needTriggerSheetChange=!1}else e._text&&(e._6(n),i.destroy(),n.il=m,n.Nde=m,t.needTriggerSheetChange=!1)},f.prototype._vt=function(t){var n,t,e,i,i,r,i,r,n=t.oldSheet,t=t.newSheet,e=this;if(t&&!t.xT){if(e.bvt&&""===e._text&&(n&&n.cR(),c(t,!1),e.d5()),e._text&&e.Mf===t)t.Di=0,t.Zg(),t.suspendEvent(),e.rl?(i=s(t.parent.Ti),(0,v.Evt)(t,i,m,t.ui,t.ci,3),t.Di=2,t.Dn.ID()):(r=i=void 0,e.nT===d.SheetArea.rowHeader?r=-(i=1):e.nT===d.SheetArea.colHeader&&(i=-1,r=1),t.f6(t.Dg(),e.bZ,e.mvt,i,r,!1)),t.resumeEvent(),e.xvt(t),e.GG(t,e.bZ,e.mvt,e.nT),n&&n.cR(),c(t,!1),e.d5();else if(e._text&&!e.bvt){if(t.Di=1,n&&(n.Di=1),e.jvt(t),c(t,!0),!e.Mf||e.Mf.xT)return;t.e4()}else if(e._text&&e.Mf!==t){if(t.Di=1,n&&(n.Di=1,n.cR()),e.jvt(t),c(t,!0),!e.Mf||e.Mf.xT)return;t.e4()}(i=e.Mf)&&(r=t.il)&&(r.U6=i!==t)}},f.prototype.jvt=function(t){var n,e,i,r,o,a,u,s,c,f,l,f,l,h,n=this,e=n.Mf;e&&!e.xT&&(i=n.bZ,r=n.mvt,o=n.nT,a=e.getCellType(i,r,o),u={sheet:e,row:i,col:r,sheetArea:o,canvasOffset:this.yvt},(s=a.isImeAware(u))||o!==d.SheetArea.viewport)&&(t.Di=1,c=a.jn(u),n.bvt&&n.Cvt(),l=f=void 0,n.nT===d.SheetArea.rowHeader?l=-(f=1):n.nT===d.SheetArea.colHeader&&(f=-1,l=1),n.bvt=c,(0,d.GC$)(c).css("position","absolute"),(f=e.getCellRect(i,r,f,l)).width===g&&(f.width=0),f.height===g&&(f.height=0),(0,d.GC$)(c).attr("id","across"),(0,d.GC$)(c).addClass("gc-across-sheet-ftb"),l=e.getActualStyle(i,r,o),a.On(c,l,f,u),(h=n.Vv&&n.Vv.getHost()||document.body).insertBefore(c,m),n.rl&&(0,d.GC$)(c).css({display:"none"}),(0,v.Evt)(t,a.getEditingElement(),!0,t.ui,t.ci,3),c.firstChild&&!n.rl&&a.focus(c.firstChild.firstChild),n.xvt(t),a.Rn(c,l,f,u))},f.prototype.GG=function(t,n,e,i){var r,o,a,u,s,c,r,o,f;i===d.SheetArea.rowHeader?o=-1:i===d.SheetArea.colHeader&&(r=-1),a=t.getCellType(n,e,i),u=t.li,s=t.Fi(),c=t.getActualStyle(n,e,i),r=t.getCellRect(n,e,r,o),o=!1,i===d.SheetArea.rowHeader?o=r.x>=s.x&&r.y>=s.y+s.qC&&r.x+r.width<=s.Py&&r.y+r.height<=s.Ay+s.Iy:i===d.SheetArea.colHeader?o=r.x>=s.x+s.XC&&r.y>=s.y&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Cy:i===d.SheetArea.viewport&&(o=r.x>=s.b6&&r.y>=s.T6&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Ay+s.Iy),r&&0<r.width&&0<r.height&&o&&u&&u.parentNode&&a.Rn(u.parentNode.parentNode,c,r,f={sheet:t,row:n,col:e,sheetArea:i})},f.prototype.Rde=function(t){var n,e,i,r,n=this;if(!n.bvt)return!1;if(e=!1,i=n.Mf,(r=t.il)&&i.setFormula(n.bZ,n.mvt,r.text()),i!==t){if(d.Commands.VA.Yvt(i),!i.endEdit())return;e=!0}else r&&(r.destroy(),t.il=m,t.Nde=m),n.d5();return e},o=f,l.Ovt=function(t,n){(l.Rvt=l.Rvt?l.Rvt:new o).kvt(n)},l.Bvt=function(t,n){(l.Rvt=l.Rvt?l.Rvt:new o)._vt(n)},n.wvt=a=l,u=i.Ode.Ede,i.Ode.Ede=function(){return u()||a.Rvt}},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(t,n,e){"use strict";var b,n,r,o,w,a,y,u;function M(t){var n,n,e,n=t.il,e=t.rt,n=n.XD?e.Lvt:e.Lvt={anchorRow:t.ui,anchorCol:t.ci,leadingRow:t.qA,leadingCol:t.hR};return n}function s(t,n,e,i,r){var o,a,a,a,u,s,c,f,u,s,n,l,h,d,a,v,m,g,p,l,h,g,p,l,o=t.il,a=t.parent,a=a&&a.options;if(o&&o.Dvt()&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox){switch(u=(a=M(t)).anchorRow,s=a.anchorCol,c=a.leadingRow,f=a.leadingCol,y(i)&&(i=u),y(r)&&(r=s),u=t.rt,n){case 3:d=t.sI(i,r,e,c);break;case 4:d=t.uI(i,r,e,c);break;case 1:d=t.lR(i,r,e,f);break;case 2:d=t.gR(i,r,e,f);break;case 5:d=t.yR();break;case 6:d=t.bR()}d&&(s=d.row,n=d.col,l=d.leadingCellRow||s,h=d.leadingCellCol||n,t.dR(s,n))&&(a.anchorRow=s,a.anchorCol=n,a.leadingRow=l,a.leadingCol=h,a=t.pivotTables&&t.pivotTables.findPivotTable(l,h),v=o.shift,m=o.ctrl,p=(g=a&&a.getPivotInfoImp(l,h,!1,!0))&&g.area,!o.Ivt&&a&&g&&4===p?(o.Fvt=new b.Range(l,h,1,1),l=g.valueFieldName,h=g.rowInfos,g=g.colInfos,(h||g)&&(p=t.rt.Pvt(p,l,h,g,a.position()))&&(o.Gvt(p,v,!m,!0),o.rb=!1)):(delete o.Fvt,(l=(0,w.Uvt)(u.Mf,(0,b.Ec)(s,n,1,1)))&&o.Gvt(l,!1,!0)),0<=s)&&0<=n&&t.OA(s,n)}}function i(t,n){var e;return!!t&&2!==t.Di&&((e=t.il)&&e.Dvt()?s(t,n,!1):(t=e?u.Hvt(t):t).G5(n,!1),!0)}function c(t,n,e,i){var r;return!!t&&2!==t.Di&&((r=t.il)&&r.Dvt()?s(t,n,!1,e,i):(t=r?u.Hvt(t):t).G5(n,!1,e,i),!0)}function f(t,n,e){var i,r,r,r,o,a,o,u,u,t,u,i=t.il,r=t.parent,r=r&&r.options;i&&i.Dvt()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(r=t.rt,a=(o=M(t)).anchorRow,o=o.anchorCol,u=i.XD?(u=i.zvt(),(0,w.Vvt)(t,u.text)):(0,b.Ec)(a,o,1,1))&&(t=t.HR(u,n,e,a,o),u=(0,w.Uvt)(r.Mf,t))&&i.Gvt(u,!0,!1)}function l(t,n,e){if(t){if(2===t.Di)return!1;var i=t.il;if(i&&i.Dvt())f(t,n,e);else{if(!(t=i?u.Hvt(t):t).endEdit())return!1;t.HA(n,e)}return!0}return!1}function h(){}Object.defineProperty(n,"__esModule",{value:!0}),b=e("Core"),n=e("Common"),r=e("./dist/plugins/formulaTextbox/formulatextbox.js"),o=e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),w=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),a=void 0,y=n.Common.lt.ht,b.Commands.B5=i,b.Commands.UA=c,b.Commands.L5=l,h.YA=function(t){return h.Hvt(t)},h.ZA=function(t){return h.Hvt(t)},h.WA=function(t){return h.Hvt(t)},h.Hvt=function(t){var t,n,t=t,n=o.wvt.Rvt;return n&&n._text&&n.Mf&&(t=n.Mf,h.Yvt(t)),t},h.Yvt=function(t,n){var e,i;void 0===n&&(n=!0),e=t.parent,(i=o.wvt.Rvt)&&i._text&&e.e3(t,n)},h.KA=function(t,n,e){var i,r,o,n,i=!1,r=t.il;return r&&r.Dvt()?((o=M(t)).anchorRow=n,o.leadingRow=n,(n=(0,w.Uvt)(t,(0,b.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(n,!1,!0),t.$A(e),i=!0):r&&(t=h.Hvt(t)),{sheet:t,r:i}},h.eI=function(t,n,e){var i,r,o,n,i=!1,r=t.il;return r&&r.Dvt()?((o=M(t)).anchorRow=n,o.leadingRow=n,(n=(0,w.Uvt)(t,(0,b.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(n,!1,!0),t.$A(e),i=!0):r&&(t=h.Hvt(t)),{sheet:t,r:i}},h.Zvt=function(t,n){var e,n,i,r,o,e=!1,n=n?5:6,i=t.il,r=t.ui,o=t.ci;return i&&i.Dvt()?(i.XD||(t.rt.Lvt={anchorRow:r,anchorCol:o,leadingRow:t.qA,leadingCol:t.hR}),s(t,n,!1,r,o),e=!0):i&&(t=h.Hvt(t)),{sheet:t,r:e}},h.iI=function(t){return h.Zvt(t,!0)},h.rI=function(t){return h.Zvt(t,!1)},h.oI=function(t){return h.Hvt(t)},h.aI=function(t){return h.Hvt(t)},h.cI=function(t){var n,e,i,n,n=o.wvt.Rvt;if(n&&n._text&&n.Mf&&(t=n.Mf,e=n.bZ,i=n.mvt,h.Yvt(t,!1),(0,r.Wvt)(t),n.rl||t.t4(e,i,a,a,1),t.isEditing()))return n=t.getValue(e,i,3),!!t.ol(!0,void 0,void 0,!0)&&(t.setValue(e,i,n,3,!0),!0)},u=h,b.Commands.VA=u},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(t,n,e){"use strict";var n,d,v,m,e,g;Object.defineProperty(n,"__esModule",{value:!0}),n=e("Core"),d=e("CalcEngine"),v=e("SheetsCalc"),m=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),e=n.GC$.extend,g=null,e(n.nk.prototype,{hI:function(){var t,n,e,i,r,o,o,a,u,s,c,f,l,n,h,o,t,n=this.Mf,e=n.il;if(e)if(i=n.ui,r=n.ci,o=(o=n.parent)&&1===o.options.referenceStyle,a=new v.SheetParserContext(n,o,(0,d.eV)(i,r)),u=new d.Parser,e.XD)for(f=e.fmt(),l=0;l<f.length;l++){s=f[l];try{c=u.parse(a,s.text)}catch(t){c=g}c&&1===c.type&&((0,m.lmt)(c,i,r,!0,!0),e.Lde(s.index,u.unparse(a,c)))}else if(s=e.zvt()){try{c=u.parse(a,s.text)}catch(t){c=g}c&&1===c.type&&(c.isFullColumn||c.isFullRow?((0,m.lmt)(c,i,r,!0,!0),e.Lde(s.index,u.unparse(a,c))):c.hmt()?((0,m.dmt)(c,i,r),e.Lde(s.index,u.unparse(a,c))):(n=s.textOffset+s.text.lastIndexOf(":"),(h=e.caret()<=n)?((0,m.lmt)(c,i,r,!0,!1),o=u.unparse(a,c),e.Lde(s.index,o),e.caret(s.textOffset+o.lastIndexOf(":"))):((0,m.lmt)(c,i,r,!1,!0),e.Lde(s.index,u.unparse(a,c)))))}}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(t,n,e){"use strict";var n,i;Object.defineProperty(n,"__esModule",{value:!0}),(i=(n=e("Core")).GC$.extend)(n.g7.prototype,{ID:function(){this.kde()}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(n,s,t){"use strict";var p,B,d,b,l,w,c,f,y,i,a,h,v,m,g,u,e,M,C,r,S,P,T,o,A,I,x,N,G,U,H,V,z,k,_,D,Y,Z,W,Q,J,K,j,X,q,$,tt,O,E,nt,et,t,it,rt,ot;function at(t,n){for(var e,i,e=0,i=0;i<t.length;i++)t[i]===n&&e++;return e}function ut(){var e=[];return b.GC$.each(p.sR().wmt,function(t,n){p.Functions.Mmt[t]&&(n.name=t,e.push(n))}),e}function st(t){var e=[],i;return b.GC$.each(t,function(t,n){(i=n.description())&&(i.name=t,e.push(i))}),e}function R(t){var n,n,n=p.getMapping()&&p.getMapping().builtInFunctionsMapping,n=n&&n[t]&&n[t].alias||t;return m.j0(n)}function ct(t,n,e){var e;return e?(e=new RegExp("\u200b","g"),t.replace(e,"")===n.replace(e,"")):t===n}function ft(t){for(var n,e,i,r,o,a,n=[],e=0,i="";i!==w;)i=t.getColumnName(e),o=void 0,t.Mf.NMi&&(o=t.FDi(e))&&(r=e),e++,i!==w&&n.push({name:i,description:"",isGroupColumn:o});return a={columns:n},u(r)||(a.groupInfo={rightGroupColumnIndex:r}),a}function lt(e,t,n,i,r,o){var a,u,n,t,s,c,f,a=e.parent,u=a&&a.options;(t&&u&&u.allowUserEditFormula&&u.enableFormulaTextbox||n)&&(e.il&&e.il.destroy(),e.il=new ot(t,null,a),e.Nde=e.il,n=e.il.text(),t=e.getFormulaInformation(i,r,o),"="!==n[0]||t&&t.hasFormula||"="===n||u.allowInvalidFormula||e.il.text(n="'"+n),s=e.il,c=e.rt,f=e.Dn,s.bind("AppendStarted",function(){s.close();var t=e.Di;1!==t&&(e.Di=1,e._i(t,1))}),s.bind("AppendEnded",function(){f.ID()}),s.bind(x,function(t,n){var n;e.xT||(n&&n.type!==S&&(c.By(n),n=e.getCellType(i,r,o),e.ki(b.Events.EditChange,{sheet:e,sheetName:e.name(),row:i,col:r,editingText:n.getEditorValue(e.li)})),f.ID(),e.ki(b.Events.FormulaTextBoxTextChanged,{sheet:e,sheetName:e.name(),text:s.text(),sheetArea:o}))}),s.bind("CaretChanged",function(){f.ID(),e.ki(b.Events.FormulaTextBoxCaretChanged,{sheet:e,sheetName:e.name(),caret:s.caret()})}),s.add(ut()),s.add(st(p.Functions.Tmt)),s.add(st(e.Amt).concat(st(a.Amt))),f.ID())}function ht(t){t.il&&(t.il.destroy(),t.il=w,t.Nde=w,t.Dn.ID());var n=t.parent&&t.parent.h6;v.activeElement===(n&&n.Ti)&&t.rt.aA()}function dt(t,n){var t,e,i,e,i,r,e,t,o,i,o,t=(0,b.GC$)(t);return t.attr("contenteditable","false"),e=a("table"),(0,b.GC$)(e).css("border-spacing","0"),(0,b.GC$)(e).css("width","100%"),t.append(e),i=a("tbody"),e.appendChild(i),e=document.createElement("tr"),i.appendChild(e),i=document.createElement("td"),(0,b.GC$)(i).css("padding-right","0px"),e.appendChild(i),r=document.createElement("td"),(0,b.GC$)(r).css("width","23px"),(0,b.GC$)(r).css("padding-right","0px"),e.appendChild(r),e=t.width()-(0,b.GC$)(r).width(),t=a("div"),o=a("div"),(0,b.GC$)(o).width(e),(0,b.GC$)(o).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),o.appendChild(t),i.appendChild(o),i=a("div"),r.appendChild(i),(0,b.GC$)(t).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),(0,b.GC$)(t).width(e),(0,b.GC$)(t).attr("contenteditable","true"),(0,b.GC$)(t).attr("spellcheck","false"),(o=(0,b.GC$)(i)).css({display:"block",float:"right",width:"23px",height:"23px",background:X,"background-repeat":"no-repeat"}),o.bind("click",function(){n.Imt?(n.Vv.ki("RangeSelectEnding",n),n.endSelectMode()):n.startSelectMode()}),{contentDiv:t,button:i}}function vt(t){for(var n,e,n=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"],e=0;e<n.length;e++)if(t===n[e])return 1}function F(t,n,e,i){var r,o,i,n,a,u,r=this,o=t;if(r.rl=!1,r.Ivt=!1,r.xmt=!0,r.Smt=!0,r.Nmt=[],r.kmt=[],r.Dmt=[],r.U6=!1,r.Zpe=!!i,n&&n.rangeSelectMode&&(!0===n.absoluteReference&&(r.Ivt=!0),!1===n.needSheetName&&(r.Smt=!1),!1===n.acrossSheet&&(r.xmt=!1),r.Lve=n.needFuncHelp,r.Xvt=n.selectionUnit,r.rl=!0,r.Imt=!1,r._mt=!1,o=(i=dt(r.Emt=t,r)).contentDiv,r.jmt=i.button,r.Omt=t,r.Avt=rt,rt++),r.cmt=!0,r.Hc(e&&e.getHost()||v.body),o&&r.Rmt(o),e&&(r.Bmt=!0,r.Lmt(e),r.Vv._3(b.Events.ActiveSheetChangingInternal+A,l.wvt.Ovt),r.Vv.D3(b.Events.ActiveSheetChangingInternal+A,l.wvt.Ovt),r.Vv._3(b.Events.ActiveSheetChangedInternal+A,l.wvt.Bvt),r.Vv.D3(b.Events.ActiveSheetChangedInternal+A,l.wvt.Bvt),r.Vv._3(b.Events.FormulaTextBoxUpdatePosition+T,void 0),r.Vv.D3(b.Events.FormulaTextBoxUpdatePosition+T,function(t,n){r.u_()})),n=r.text(),r.Fmt=r.Ost(n),a=r.vmt(o)){r.Pmt(r.Fmt);try{(u=h.getSelection()).selectAllChildren(o),0<u.rangeCount&&u.collapseToEnd()}catch(t){}(0,b.GC$)(r.Ti).data(O,n)}(0,b.GC$)(t).data(s.CONST_FORMULATEXTBOX,r)}function mt(){var t,n,e,n,t=h.getSelection();0<t.rangeCount&&(n=t.getRangeAt(0),(e=v.createElement("span")).innerHTML="<br/>\u200b",n.insertNode(e),(n=v.createRange()).setStartAfter(e),n.setEndAfter(e),n.collapse(!1),t.removeAllRanges(),t.addRange(n))}function L(t){return"gcAttachedFormulaTextBox"===t.target.getAttribute("gcuielement")}Object.defineProperty(s,"__esModule",{value:!0}),s.FormulaTextBox=s.Wvt=s.Evt=s.CONST_FORMULATEXTBOX=void 0,p=t("CalcEngine"),B=t("SheetsCalc"),d=t("Common"),b=t("Core"),l=t("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),w=null,c=void 0,f=Math.max,y=Math.min,i=b.GC$.extend,a=b.mt.En,h=window,v=document,m=d.Common.zf,g=b.mt.vi,u=d.Common.lt.ht,e=b.mt.Tt,M=e.msie&&parseInt(e.version,10)<10,C=m.Gmt,s.CONST_FORMULATEXTBOX="formulatextbox",r="gcUIElement",S="input",P="\xa0",T=".gcFormulaTextBoxInternal",o=".gcFormulaTextBox",A=".gcFormulaTextBoxAcrossSheetInternal",I=".gcsj-func-ac-row",x="TextChanged",N="CaretChanged",G="AppendStarted",U="AppendEnded",V=37,z=39,k=38,_=40,D=9,Y=13,Z=33,W=34,Q=35,J=36,K=27,j=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],X='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',q='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',$="background",tt="background-repeat",O="text-before",E="caret-before",nt="\u200b",et="=",b.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",b.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",b.Events.FormulaTextBoxUpdatePosition="FormulaTextBoxUpdatePosition",h.gcGlobal.wf.push(function(t,n){var e,n,e=l.wvt;!n&&t.endEdit&&e&&(n=e.Rvt)&&n.bvt&&t.il&&(t.il&&t.il.destroy(),t.il=w,t.Nde=w,n.rl||n.d5())}),s.Evt=lt,s.Wvt=ht,b.Worksheet.ch(s.CONST_FORMULATEXTBOX,{startEdit:function(t){t.preventFormulaTextBox||lt(this,t.element,c,t.row,t.col,t.sheetArea)},endEdit:function(){ht(this)},preProcessKeyDown:function(t){var n,n,e,e,n=this.il;(n&&n.$D(t.e)||(e=(n=this.parent)&&n.h6)&&e.$D(t.e,t.c)||(e=n&&n.vCe)&&e.$D(t.e,t.c))&&(t.r=!0)}}),t=b.Hv.prototype,it=t.O2,b.Hv.ch(s.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(t){var n,n,n,e,n=(0,b.jf)(this.Vv),n=n?n.il:void 0,n=n&&n.Dvt(),e=l.wvt.Rvt;n?t.r=!1:e&&e.bvt&&e.d5()}}),t.O2=function(){var t=(0,b.jf)(this.Vv),t=t&&t.il,n=l.wvt.Rvt,n=n&&n._text;return it.call(this)&&!n&&!t},rt=1,F.prototype.Umt=function(t){var n,e,i,e,t,r,o,n=this;n.Hmt(),n.FD(),n._mt=!0,e=(0,l.Mvt)(n.Vv.Ti),(i=(n.Vv.vCe=n).zmt())&&(i.suspendPaint(),lt(i,e,!0,i.ui,i.ci,3),(e=i.il).rl=!0,e.Avt=n.Avt,e.Ivt=n.Ivt,e.Smt=n.Smt,e.Xvt=n.Xvt,e.xmt=n.xmt,t&&(n.text(t),n.caret(t.length)),t=n.text(),(r=n.caret())<=0&&(r=t.length),n.focus(),n.caret(r),n.XD=!0,-(n.umt=1)!==(o=t.lastIndexOf(",",r))&&(n.umt=o+1),t||(n.text("="),t="=",n.caret(1),r=1),"="!==t[0]&&(t="="+t,r++),e.text(t),e.caret(r),e.XD=n.XD,e.umt=n.umt,i.resumePaint())},F.prototype.startSelectMode=function(t){var t,n,t=t;t&&0!==t.indexOf("=")&&(t="="+t),(n=this).rl=!0,n.Imt=!0,(0,b.GC$)(n.jmt).css([$,tt],[q,"no-repeat"]),n.Umt(t)},F.prototype.endSelectMode=function(){this.Imt=!1,this.Vmt(),(0,b.GC$)(this.jmt).css([$,tt],[X,"no-repeat"]);var t=l.wvt.Rvt;t&&t.bvt&&t.d5()},F.prototype.Vmt=function(){var t,t,t=this.Vv;t&&(t.vCe=null),(t=this.zmt())&&(t.ol(!0,c,!0),t.repaint())},F.prototype.Ak=function(t){t&&(this.Dmt=[t])},F.prototype.Hce=function(){this.Dmt=w},F.prototype.Ymt=function(){return this.Dmt},F.prototype.destroy=function(){var t=this;t.Imt&&t.Vmt(),t.Dmt=w,t.XD=!1,t.umt=-1,t.Zmt(),t.Wmt(),t.Qmt(),(0,b.GC$)(t.Kmt).remove(),(0,b.GC$)(t.Jmt).remove(),(0,b.GC$)(t.F0).remove()},F.prototype.bind=function(t,n,e){var i=this.Ti;i&&t&&(t=t.split(/\s+/).join(o+" "),(0,b.GC$)(i).bind(t+o,n,e))},F.prototype.unbind=function(t,n){var e=this.Ti;e&&t&&(t=t.split(/\s+/).join(o+" "),(0,b.GC$)(e).unbind(t+o,n))},F.prototype.unbindAll=function(){var t=this.Ti;t&&(0,b.GC$)(t).unbind(o)},F.prototype.caret=function(t){var n,e,i,r,n=this,e=n.Ti;if(e){if(i=v.activeElement===e,r=(0,b.GC$)(e),0===arguments.length)return i?n.Xmt(e).end:r.data(E);t!==n.caret()&&(i?(n.qmt(e,t),r.data(E,n.Xmt(e).end)):r.data(E,t),n.ki(N,{}))}},F.prototype.Xmt=function(t){var n,e,i,n,n,r,n=this,e=-1,i=-1;return n.$mt(t)?(e=t.selectionStart,i=t.selectionEnd):n.vmt(t)&&0<(n=h.getSelection()).rangeCount&&((r=(n=n.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(n.endContainer,n.endOffset),i=r.toString().length,(r=n.cloneRange()).selectNodeContents(t),r.setEnd(n.startContainer,n.startOffset),e=r.toString().length,r.detach()),{start:e,end:i}},F.prototype.qmt=function(t,n){var e,n,i,e,r,e=this;e.$mt(t)?t.setSelectionRange(n,n):e.vmt(t)&&(e=this.tgt(t,n))&&(n=h.getSelection(),i=v.createRange(),(r=e.node)&&1===r.childNodes.length?i.setStart(r.firstChild,e.offset):r.lastChild&&r.lastChild.length&&i.setStart(r.lastChild,r.lastChild.length),i.collapse(!0),n.removeAllRanges(),n.addRange(i),this.rl)&&(t.parentElement.scrollTop=t.parentElement.scrollHeight)},F.prototype.text=function(t){var n,e,i,i,r,o,a,u,a,a,i,r,n=this,e=n.Ti,i=n.zmt();if(!e)return"";if(!i||i.xT)return e.innerHTML="";if(i=n.$mt(e),r=n.vmt(e),o=n.hfe(e),0===arguments.length){if(a="",i)a=e.value;else if(r){if(0<(u=e.getElementsByClassName("gcsj-func-gray-formula")).length)return"";0<=(a=(a=M?b.mt.oi(e):e.innerText).replace(/\r\n?/g,"\n")).indexOf("\xa0")&&(a=b.mt.yi(a,"\xa0"," "))}else o&&0<=(a=(a=M?b.mt.oi(e):e.innerText).replace(/\r\n?/g,"\n")).indexOf("\xa0")&&(a=b.mt.yi(a,"\xa0"," "));return a}(t=null==t?"":t)!==n.text()&&(a=n.ngt(t),n.Fmt=a?n.Ost(a):n.Ost(t),i?e.value=t:r?(a=n.egt(n.Fmt,t),n.Pmt(a),n.caret(t.length)):o?e.innerHTML=t:e.value=t,i={},(r=l.wvt.Rvt)&&r._text&&(i={sheet:r.Mf,editor:r.bvt&&r.bvt.firstChild.firstChild,canvasOffset:r.yvt}),n.ki(x,i)),n.igt&&n.rgt()},F.prototype.I6=function(){var t=this;(0,b.GC$)(t.Ti).data(O,t.text())},F.prototype.autoComplete=function(t){if(0===arguments.length)return this.ogt;this.ogt=t},F.prototype.showHelp=function(t){if(0===arguments.length)return this.agt;this.agt=t},F.prototype.add=function(t){var n,e;if(t)if(b.GC$.isArray(t))for(n=t.length,e=0;e<n;e++)this.ZP(t[e]);else this.ZP(t)},F.prototype.ZP=function(t){var n,e,i,r,o,n=t&&C(R(t.name));if(n){for(i=(e=this.ugt).length,r=0;r<i;r++){if((o=C(e[r].name))===n)return;if(n<o)break}e.splice(r,0,t)}},F.prototype.remove=function(t){var n,e,i;if(t)for(t=C(t),e=(n=this.ugt).length,i=0;i<e;i++)if(C(n[i].name)===t){n.splice(i,1);break}},F.prototype.workbook=function(t){var n=this;if(0===arguments.length)return n.Vv;t===w?n.rl&&n.Vmt():(n.Lmt(t),n.sgt())},F.prototype.Lmt=function(t){var n,e;t&&((n=this).Vv&&n.Wmt(),e=n.Ti)&&(n.Vv=t)},F.prototype.smt=function(){var t,n,e,i,r,o,a,u,s,c,t=[],n=this.Fmt,e=n&&n.length,o=0,a=0;if(0<e)for(u=0;u<e;u++)r=(i=n[u]).text,11===i.type&&(s={textOffset:o,text:r,ranges:i.ranges,index:a,allowDrag:i.allowDrag},"number"==typeof i.sheetArea&&(s.sheetArea=i.sheetArea),t.push(s),a++),o+=r.length;return(c=this.Fvt)&&t.push({ranges:[c],index:a,allowDrag:!1,isPivotClickCell:!0}),t},F.prototype.zvt=function(){var t,n,e,i,r,o,a,t=this.Ti,n=this.smt();if(t&&n&&0<n.length)for(e=this.caret(),i=n.length,o=r=void 0,a=0;a<i;a++){if((o=(r=n[a]).textOffset)<=e&&e<=o+r.text.length)return r;if(e<=o)break}return w},F.prototype.ymt=function(t){var n,e,t;return!!t&&(n=this.caret(),e=t.text,(t=t.textOffset)<=n)&&n<=t+e.length},F.prototype.pmt=function(t){var n,e,i,r,o,a,u,s,c,n=this.smt(),e=n.length;if(t<0||e<=t)return"";for(i=[],a=o=0;a<e;a++){for(r=n[a],u=!1,s=0;s<i.length;s++)if(r.text&&i[s].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){u=!0;break}if(u){if(t===a){o=s;break}}else if(i.push(r),t===a){o=i.length-1;break}}return j[o%j.length]},F.prototype.Dvt=function(){var t,n,t;return!!this.XD||!!this.rl||!!(0,b.Df)(this.text())||!!(t=this.cgt(this.caret()))&&(n=t.type,t=t.text,1===n||8===n||7===n&&"%"!==t||5===n||9===n||15===n)},F.prototype.bmt=function(t){var n,e,n;return!(!t||!this.XD)&&(n=this.umt,e=this.caret(),n<=(n=t.textOffset))&&n<e},F.prototype.fmt=function(){var t,n,e,i,r,t=[],n=this.smt(),e=n.length;if(0<e)for(r=0;r<e;r++)i=n[r],this.bmt(i)&&t.push(i);return t},F.prototype.Gvt=function(t,n,e,i,r){var o,a,a,u,s,c,e,n,n,f,e,i,u;if(void 0===r&&(r=b.SheetArea.viewport),a=(o=this).Ti,t&&a){if(!o.XD){if(!o.Dvt())return;o.XD=!(n=!1),o.umt=o.caret(),o.ki(G,{})}a=o.umt,u=o.text(),s=o.caret(),u||(u="=",s=a=o.umt=1),c=s,e&&(n=!1,u=u.substr(0,a)+(s<0?"":u.substr(s)),o.Fmt=o.Ost(u),c=s=a),e=o.cgt(s),n?(n=(n=u.substr(0,s)).substr(0,n.length-e.text.length)).length>=a&&(e.text=t,c=n.length+t.length):(n=o.Fmt,f=d.Common.Uf.hD(n,e),e=o.rl&&1<n.length&&f===n.length-1&&11===e.type,i?(t=a<s||e?u+this.fgt()+t:u.slice(0,s)+t+u.slice(s),o.Fmt=o.Ost(t)):a<s||e?(n.splice(f+1,0,{text:this.fgt(),type:8}),n.splice(f+2,0,{text:t,type:11,sheetArea:r}),t=","+t):n.splice(f+1,0,{text:t,type:11,sheetArea:r}),c=s+t.length),o.lgt(),i={},(u=l.wvt.Rvt)&&u._text&&(i={sheet:u.Mf,editor:u.bvt&&u.bvt.firstChild.firstChild,canvasOffset:u.yvt}),o.ki(x,i),o.caret(c)}},F.prototype.qD=function(){var t=this;t.XD&&(t.XD=!1,t.umt=-1,t.ki(U,{}))},F.prototype.Nvt=function(){this.XD=!0,this.umt=this.caret()},F.prototype.Tvt=function(t){return void 0!==t&&(this.umt=t),this.umt},F.prototype.Lde=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.Ti;if(r&&!(t<0)&&n){for(o="",a=!1,s=(u=i.Fmt)&&u.length,l=f=0;l<s;l++){if(11===(c=u[l]).type&&f++===t){u[l]={text:n,type:11,sheetArea:c.sheetArea},a=!0;break}o+=c.text}a&&(i.lgt(),i.ki(x,{}),e?i.caret(i.text().length):i.caret(o.length+n.length))}},F.prototype.sgt=function(){var t,n,n,t=this;t.Vv&&(n=t.Ti,t.Vv)&&n&&(n.setAttribute(r,"gcAttachedFormulaTextBox"),t.rl||(t.Vv.h6=t),t.Vv.D3(b.Events.FormulaTextboxEditStarted+T,t,t.hgt),t.Vv.D3(b.Events.EnterCellInternal+T,t,t.dgt),t.Vv.D3(b.Events.FormulaTextboxEditEnded+T,t,t.vgt),t.Vv.D3(b.Events.ActiveSheetChangedInternal+T,t,t.mgt),t.Vv.D3(b.Events.RangeChangedInternal+T,t,t.ggt),t.Vv.D3(b.Events.FormulaTextBoxTextChanged+T,t,t.pgt),t.Vv.D3(b.Events.FormulaTextBoxCaretChanged+T,t,t.bgt),t.Vv.D3(b.Events.ValueChanged+T,t,t.ygt),t.Vv.D3(b.Events.CellChanged+T,t,t.ygt),(n=(0,b.jf)(t.Vv))&&!t.rl&&t.text(t.wgt(n,n.ui,n.ci)),t.D3(x,t,t.Mgt),t.D3(N,t,t.Cgt))},F.prototype.refresh=function(t){var n,e,n,n=this.Vv,e=this;n&&(n=(0,b.jf)(n))&&!e.rl&&(e.rb=!!t||e.rb,e.text(e.wgt(n,n.ui,n.ci)),e.rb=!1)},F.prototype.Wmt=function(){var t=this,n=t.Vv;!t.Bmt&&n&&(t.rl||(n.h6=null,n._3(b.Events.FormulaTextboxEditStarted+T,t.hgt),n._3(b.Events.EnterCellInternal+T,t.dgt),n._3(b.Events.FormulaTextboxEditEnded+T,t.vgt),n._3(b.Events.ActiveSheetChangedInternal+T,t.mgt),n._3(b.Events.RangeChangedInternal+T,t.ggt),n._3(b.Events.FormulaTextBoxTextChanged+T,t.pgt),n._3(b.Events.FormulaTextBoxCaretChanged+T,t.bgt),n._3(b.Events.ValueChanged+T,t.ygt),n._3(b.Events.CellChanged+T,t.ygt),t._3(x,t.Mgt),t._3(N,t.Cgt)),t.text("")),t.Vv=null},F.prototype.Hmt=function(){var t,n,n,t=this;t.rb||(t.rb=!0,(n=(n=this.Vv)&&(0,b.jf)(n))&&!n.isEditing()?(t.rl||n.f6(null,n.ui,n.ci,null,null,!1,null),t.Sgt=!0):n&&1===n.Di?(n.Di=2,n._i(1,2)):t.Sgt=!1,t.rb=!1,t.Tgt)||t.w6()},F.prototype.Agt=function(){var t=this,n=t.Ti,e=t.Igt;n.insertBefore(e,n.firstChild),e.innerText=t.igt},F.prototype.xgt=function(t,n){var e;t&&this.Ngt!==n&&(this.Ngt=n,t.style.display=n?"":"none")},F.prototype.rgt=function(){var t,n,e,i,t=this,n=t.Ti,e;t.vmt(n)?((i=t.Igt)||((i=t.Igt=a("span")).className="gcsj-func-gray-formula"),t.xgt(i,!0),t.Agt()):n.placeholder=t.igt},F.prototype.kgt=function(){var t,n,e,t=this;t.igt&&(t.igt="",n=t.Ti,(e=t.vmt(n))?t.xgt(t.Igt,!1):n&&(n.placeholder=""))},F.prototype.FD=function(){var t,n,n,e,i,r,o,a,i,t=this,n=t.Vv,n=n&&(0,b.jf)(n);n&&(e=n.il,t.Sgt&&e&&(i=e.text(),ct(r=t.text(),i,!0)||(o=t.caret(),a=n.getFormulaInformation(n.getActiveRowIndex(),n.getActiveColumnIndex(),3),t.text(i),a.isArrayFormula&&(o>=r.length&&(o-=1),o=f(0,o-1)),t.caret(o))),t.Sgt&&e||t.rl)&&2!==(i=n.Di)&&(n.Di=2,n._i(i,2))},F.prototype.wgt=function(t,n,e){var i,r,r,o,o,a,i="";if(t){if(r=(r=t.parent)&&r.options,(o=t.getFormulaInformation(n,e,3))&&o.hasFormula){if(i="="+o.formulaWithCulture,o.isDynamicArray)return this.igt=i,"";this.igt="",o.isArrayFormula&&(i="{"+i+"}")}else o=t.getActualStyle(n,e),i="string"==typeof(a=t.getValue(n,e))&&(o.quotePrefix||1<a.length&&"="===a[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+a:b.mt.mi(o,a,t,{sheet:t,row:n,col:e,sheetArea:3})||"";this.kgt()}return i},F.prototype.Ove=function(){var t,n,e,e,t,i,e,n=this,e=n.Vv,e=e&&(0,b.jf)(e),t=e.ui,i=e.ci,e=e.getCellType(t,i);!1===(null==(t=null==e?void 0:e.editable)?void 0:t.call(e))&&n.mCe(!0)},F.prototype.mCe=function(t){var n,e,i,n,n=this,e=n.Ti;e&&(i=n.$mt(e),n=n.hfe(e),i?e.disabled=t:n&&(e.contentEditable=t?"false":"true"))},F.prototype.mgt=function(t,n){var t,e,i,t=t.data;t.rb||(e=n.newSheet,t.rl)||(t.rb=!0,t.close(),n&&e&&t.text(t.wgt(e,e.ui,e.ci)),t.rb=!1)},F.prototype.hgt=function(t,n){var t,e,e,e,t=t.data;t.rb||(e=(e=(e=t.Vv)&&(0,b.jf)(e))&&e.il)&&t.rl===e.rl&&t.Avt===e.Avt&&n.sheetArea!==b.SheetArea.colHeader&&n.sheetArea!==b.SheetArea.rowHeader&&(t.kgt(),t.rb=!0,t.text(e.text()),t.rb=!1)},F.prototype.dgt=function(t,n){var t=t.data;t.rl||t.rb||(t.rb=!0,n&&(t.text(t.wgt(n.sheet,n.row,n.col)),t.Ti)&&t.mCe(!!n.readonly),t.rb=!1)},F.prototype.ggt=function(t,n){var t,e,i,r,o,n,t=t.data;t.rb||t.rl||(t.rb=!0,n&&(e=n.sheet,i=n.row,r=n.col,o=n.rowCount,n=n.colCount,new b.Range(i,r,o,n).contains(e.ui,e.ci))&&t.text(t.wgt(e,e.ui,e.ci)),t.rb=!1)},F.prototype.vgt=function(t,n){var t,e,t=t.data;t.rl&&t.Imt&&t._mt?n.ignore=!0:t.rb||n.sheetArea!==b.SheetArea.colHeader&&n.sheetArea!==b.SheetArea.rowHeader&&(t.rb=!0,t.close(),(e=l.wvt.Rvt)&&e.Mf&&e.Mf!==n.sheet&&e._6(n.sheet),n&&n.sheet.il&&!n.sheet.il.rl&&!t.rl&&t.text(t.wgt(n.sheet,n.row,n.col)),t.rb=!1)},F.prototype.ygt=function(t,n){var e,i,e=n.sheet,i=e&&e.parent&&e.parent.h6;i&&i.Dgt()===n.row&&i._gt()===n.col&&i.zmt()===e&&t.data instanceof F&&(t.data.rl||("[styleinfo]"===n.propertyName&&t.data.Ove(),n.text=t.data.wgt(e,n.row,n.col),t.data.pgt(t,n)))},F.prototype.pgt=function(t,n){var t,e,t=t.data;t.rb||n.sheet.il&&(t.rl!==n.sheet.il.rl||t.Avt!==n.sheet.il.Avt)||n.sheetArea===b.SheetArea.colHeader||n.sheetArea===b.SheetArea.rowHeader||(t.rb=!0,n&&(e=t.caret(),t.text(n.text),t.caret(e)),t.rb=!1)},F.prototype.bgt=function(t,n){var t=t.data;t.rb||n.sheet.il&&(t.rl!==n.sheet.il.rl||t.Avt!==n.sheet.il.Avt)||(t.rb=!0,n&&t.caret(n.caret),t.rb=!1)},F.prototype.Mgt=function(t){var t,n,n,e,i,r,o,a,r,t=t.data;if(!t.rb&&(n=(n=t.Vv)&&(0,b.jf)(n))){if(n.isEditing()||(t.Hmt(),t.focus()),t.rb=!0,e=n.ui,i=n.ci,r=n.il,o=n.getCellType(e,i),r){if(t.rl!==r.rl||t.Avt!==r.Avt)return;a=r.caret(),r.text(t.text()),r.caret(a)}else r={sheet:n,row:e,col:i,sheetArea:3},o.setEditorValue(n.li,t.text(),r);t.rb=!1}},F.prototype.Cgt=function(t){var t,n,n,n,t=t.data;t.rb||(n=(n=t.Vv)&&(0,b.jf)(n))&&n.isEditing()&&((n=n.il)&&(t.rl!==n.rl||t.Avt!==n.Avt)||(t.rb=!0,n&&(n.caret(t.caret()),t.w6()),t.rb=!1))},F.prototype.Hc=function(t){var n,e,i,i,n=this;n.Egt=!1,n.jgt=!1,n.XD=!1,n.umt=-1,n.ugt=[],n.ogt=!0,n.agt=!0,n.Ogt=!0,(e=a("div")).className="gcsj-func-ac-popup",e.style.display="none",e.setAttribute(r,"gcFuncACPopup"),t.insertBefore(e,w),n.Kmt=e,n.Tgt=!1,(i=a("div")).className="gcsj-func-help-popup",i.style.display="none",i.setAttribute(r,"gcFuncHelpPopup"),t.insertBefore(i,w),n.Jmt=i,(n.Rgt=!1,b.GC$)(e).bind("mouseover",function(){n.Ogt=!1}).bind("mouseout",function(){n.Ogt=!0}),(0,b.GC$)(i).bind("mouseover",function(){n.Ogt=!1}).bind("mouseout",function(){n.Ogt=!0}),(0,b.GC$)(e).bind("scroll",function(){n.Bgt&&clearTimeout(n.Bgt),n.Bgt=h.setTimeout(function(){n.Ti&&n.Ti.focus()},100)}),(i=a("div")).style.display="none",i.setAttribute(r,"gcFuncHelpDiv"),t.insertBefore(i,w),n.F0=i,n.Vv=null,n.rb=!1,n.Sgt=!1,n.Bmt=!1},F.prototype.Rmt=function(t){var c,f,n;t&&(f=(c=this).vmt(t),c.$mt(t)||f)&&(n=(0,b.GC$)(t),c.Ti&&c.Zmt(),c.Ti=t,e&&(e.msie||e.chrome)?f||M||e.chrome?(c.D3("focus",function(){n.data(O,c.text())}),c.D3("click",function(){n.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(t){c.D3(t,function(){c.Lgt()})})):c.D3(S,function(){c.Fgt()}):c.D3(S,function(){var t;f&&(t=c.Ti.lastChild,e.chrome)&&t&&"BR"===t.tagName&&c.Ti.removeChild(t),c.Fgt()}),c.D3("keydown",function(t){var n,e,i,r,o,a,u,s,u,u,s,n=t.ctrlKey,e=t.shiftKey,i=t.altKey,r=t.metaKey,o,a=t.keyCode;n||e||i||r||!c.Tgt||(a===_?(c.Pgt(1),g(t)):a===k?(c.Pgt(-1),g(t)):a===D&&(c.Ggt(),g(t))),a===K&&c.close(),c.Ugt(t),s=(u=(0,b.jf)(c.Vv))&&u.rt.Pi(t),c.rl&&s&&(u=u.il)&&u.XD&&u.qD(),f&&(s?(8===a?L(t)&&b.di.processBackspaceAndLeftArrowKeyEvent(t,!0):46===a&&L(t)&&b.di.processDeleteAndRightArrowKeyEvent(t,!0),c.mmt()):13===a&&(n||i)?(L(t)&&mt(),c.mmt(!0)):37===a?L(t)&&b.di.processBackspaceAndLeftArrowKeyEvent(t,!1):39===a&&L(t)&&b.di.processDeleteAndRightArrowKeyEvent(t,!1),f)&&n&&(90===a||89===a)&&g(t),u=c.text(),b.mt.Qf()&&f&&r&&(s=void 0,90===a)&&(e?(s=c.kmt.pop())&&(c.text(s),c.Nmt.push(u)):(s=c.Nmt.pop()||"",c.text(s),c.kmt.push(u)),t.preventDefault(),t.stopPropagation())}),c.D3("keyup",function(t){var n,e,i,t;c.Ugt(t),n=c.text(),f&&(e=void 0,i=t.keyCode,(t=t.ctrlKey)&&90===i?(e=c.Nmt.pop()||"",c.text(e),c.kmt.push(n)):t&&89===i&&(e=c.kmt.pop())&&(c.text(e),c.Nmt.push(n)))}),c.D3("focus",function(t){var n;e&&e.mozilla&&!c.Ti.innerText&&(c.Ti.innerText=""),c.Ugt(t),c.rl&&c.Imt&&(c._mt=!0,c.Umt())}),c.D3("blur",function(){c.Ogt&&c.close(),c.rl&&(c.Vmt(),c._mt=!1)}),c.D3("mousedown",function(){c._mt=!0,c.Ngt&&c.igt&&(c.kgt(),c.Hgt=!0),c.Hmt()}),c.D3("mouseup",function(){var t,n;c.Hgt&&(c.Hgt=!1,(t=c.Ti)!==(n=h.getSelection()).anchorNode)&&n.selectAllChildren(t),c.FD()}),c.D3("click",function(t){var n,n,n;c.XD&&c.qD(),(n=(n=(n=c.Vv)&&(0,b.jf)(n))&&n.il)&&n.XD&&!n.rl&&n.qD(),c.Ugt(t)}),c.D3("compositionstart",function(){c.Egt=!0}),c.D3("compositionend",function(){c.Egt=!1,(e.edge||e.chrome||e.msie)&&c.Lgt()}))},F.prototype.Zmt=function(){var t,n,n,t=this,n=t.Ti;n&&((n=(0,b.GC$)(n)).removeData(O),n.removeData(E),n.removeAttr(r),n.data(s.CONST_FORMULATEXTBOX)&&n.data(s.CONST_FORMULATEXTBOX,w),t.E3(),t.unbindAll(),t.rl&&((0,b.GC$)(t.Emt).empty(),t.Emt=w),t.Ti=w)},F.prototype.Lgt=function(){var t=this,n=(0,b.GC$)(t.Ti),e=t.text();n.data(O)!==e&&(t.Egt||n.data(O,e),t.Fgt())},F.prototype.Ugt=function(t){var n;e&&e.msie?setTimeout(function(t,n){return function(){t.zgt(t,n)}}(this,t),10):this.zgt(this,t)},F.prototype.zgt=function(t,n){var e,i,e,n,i,e,n,e=n.keyCode,i=e===V||e===z||e===J||e===Q||e===W||e===Z||e===D||e===Y;t.ogt||(i=i||e===k||e===_),e=void 0!==n.button,(i||e)&&(n=t.Ti,i=(0,b.GC$)(n),(e=t.Xmt(n)).start===e.end)&&(n=e.end,i.data(E)!==n)&&(i.data(E,n),t.ki(N,{}),t.w6())},F.prototype.Dgt=function(t){var t,n,t,t=t||this.zmt();return t?(n=t.ui,(t=t.vA)?t.row:n):c},F.prototype._gt=function(t){var t,n,t,t=t||this.zmt();return t?(n=t.ci,(t=t.vA)?t.col:n):c},F.prototype.Qvt=function(t){var t,n,t,t=t||this.zmt();return t?(n=b.SheetArea.viewport,(t=t.vA)?t.sheetArea:n):c},F.prototype.zmt=function(){if(this.Vv)return(0,b.jf)(this.Vv)},F.prototype.parseInternal=function(t,n,e,i,r){var o,a,u,u;return void 0===r&&(r=b.SheetArea.viewport),o=this,a=[],(0,b.kf)(t)&&at(t,'"')%2!=1?(u=new p.Parser,u=B.Vgt(u,t,n,e,i,!0,c,c,r),a=o.Ygt(u,t)):a.push({text:t,type:17}),a},F.prototype.Ost=function(t){var n,e,i,n,e,r,n=this.Vv&&1===this.Vv.options.referenceStyle,e=l.wvt.Rvt,i=this.zmt();return n&&e&&e.Mf&&e.Mf!==i&&(i=e.Mf),n=this.Dgt(i),e=this._gt(i),r=this.Qvt(i),this.parseInternal(t,i,n,e,r)},F.prototype.Fgt=function(){var t,n,e,i,r,e,t=this,n=t.text();"\n"!==n&&0<=n.indexOf("\n")?t.ki(x,{type:S}):(e=t.Ti,i=(0,b.GC$)(e),t.jgt=!0,t.Fmt=t.Ost(n),t.vmt(e)?t.Egt||("\n"===n?(i.empty(),t.ki(x,{type:S})):(r=t.caret(),t.Pmt(t.Fmt),t.ki(x,{type:S}),t.caret(r))):t.ki(x,{type:S}),r=t.caret(),i.data(E)!==r&&(i.data(E,r),t.ki(N,{})),(e=t.zmt())&&e.ignoreShowFunctions&&e.ignoreShowFunctions()||(t.Zgt(),t.Tgt)||t.w6())},F.prototype.Wgt=function(){return d.Common.CultureManager.Fe().NumberFormat},F.prototype.Qgt=function(){var t=this.Wgt();return t&&t.arrayGroupSeperator||";"},F.prototype.Kgt=function(){var t=this.Wgt();return t&&t.arrayListSeparator||","},F.prototype.fgt=function(){var t=this.Wgt();return t&&t.listSeparator||","},F.prototype.Jgt=function(){var t=this.Wgt();return t&&t.numberDecimalSeparator||"."},F.prototype.Ygt=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,h,e=[],i=[],r=n&&"="!==n[0],o=this.Qgt(),a=this.Kgt(),u=!1,s=0;s<t.length;s++)0<s&&s<t.length-1&&";"===t[s-1].text&&","===t[s].text&&"ARRAYROW"===t[s+1].text||(c=t[s],f=this.Xgt(c,i),l=c.text,2===f?e.push({text:l,type:f}):u&&8===f&&","===l?e.push({text:a,type:9}):u&&8===f&&";"===l?e.push({text:o,type:10}):8===f?e.push({text:l,type:f}):3===f?("ARRAY"===l&&(u=!0),e.push({text:"{",type:3})):4===f?"ARRAY"===l||"}"===l?(u=!1,e.push({text:"}",type:4})):e.push({text:l,type:4}):6===f?e.push({text:")",type:f}):13===f?e.push({text:d.Common.st.Ge(l),type:f,ranges:c.ranges,allowDrag:c.canDrag}):1===f&&r||null!==f&&(11===f&&t[s+1]&&"#"===t[s+1].text&&c.ranges&&0<c.ranges.length?(h=new p.CalcReference(this.zmt().qgt,c.ranges).getSpillRef())&&h.$gt&&(s++,c.ranges=h.$gt,l+="#"):11===f&&l.length===c.endIndex-c.index&&"!"===n[c.endIndex]&&(l+="!"),h={text:l,type:f,ranges:c.ranges,allowDrag:c.canDrag},11===f&&(h.sheetArea=c.sheetArea),e.push(h)));return e},F.prototype.Xgt=function(t,n){var e,i,r,t,r,e=t.type,i=t.subType,r=t.text,t=t.value;if(1===e){if(1===i)return"ARRAY"===r||"ARRAYROW"===r?(n.push(3),3):(n.push(5),"@"===t||"("===t.trim()?5:2);if(2===i){if(")"===t.trim())return 6;if(0<n.length){if(3===(r=n[n.length-1]))return n.pop(),4;if(5===r)return n.pop(),6}}if("="===t.trim())return 1}else if(3===e){if(0===i)return 8}else{if(5===e||6===e||4===e)return 7;if(0===e)return 7===i||0===i||12===i?11:5===i?12:4===i?13:3!==i&&6===i?16:14;if(7===e)return 15;if(8===e);}return 17},F.prototype.lgt=function(){for(var t,n,e,i,r,o,t=this,n=t.Ti,e=t.Fmt,i="",r=e&&e.length,o=0;o<r;o++)i+=e[o].text;t.$mt(n)?n.value=i:t.vmt(n)&&t.Pmt(e)},F.prototype.$mt=function(t){var t=t&&t.tagName;return"TEXTAREA"===t||"INPUT"===t},F.prototype.vmt=function(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable},F.prototype.hfe=function(t){return t&&"DIV"===t.tagName},F.prototype.t2t=function(t){return"gcEditingInput"===(0,b.GC$)(t).attr(r)},F.prototype.D3=function(t,n,e){var i=this.Ti;i&&t&&(t=t.split(/\s+/).join(T+" "),(0,b.GC$)(i).bind(t+T,n,e))},F.prototype._3=function(t,n){var e=this.Ti;e&&t&&(t=t.split(/\s+/).join(T+" "),(0,b.GC$)(e).unbind(t+T,n))},F.prototype.E3=function(){var t=this.Ti;t&&(0,b.GC$)(t).unbind(T)},F.prototype.ki=function(t,n){var e=this.Ti;e&&(0,b.GC$)(e).trigger(t,n)},F.prototype.cgt=function(t){var n,e,i,r,o;if(!(t<=0)&&0<(e=(n=this.Fmt)&&n.length))for(r=void(i=0),o=0;o<e;o++)if(t<=(i+=(r=n[o]).text.length))return r;return w},F.prototype.n2t=function(){var t,n,e,i,r,i,o,t=this.Vv;if(t&&(n=(0,b.jf)(t))&&(e=n.getCalcService().allowDynamicArray,i=n.il)){for(r=[].concat(i.ugt),b.Worksheet.et(n,"getAllFunctions",i={funcs:r,isFuncGet:!1}),o=(r=i.funcs).length-1;0<=o;o--)!e&&r[o]&&vt(r[o].name)?r.splice(o,1):u(r[o].isFunc)&&(r[o].isFunc=!0);return i.isFuncGet?r:r.concat(this.e2t(t,n)).concat(this.i2t(t.sheets)).concat(this.r2t(t))}return this.ugt},F.prototype.e2t=function(t,n){var e,n,n,e=[],n=n.getCustomNames();return n&&b.GC$.each(n,function(t,n){e.push({name:n.Zc,description:n.TZ})}),(n=t.getCustomNames())&&b.GC$.each(n,function(t,n){e.push({name:n.Zc,description:n.TZ})}),e},F.prototype.i2t=function(t){var i=[];return t.forEach(function(t){var t,n,e,t=t.tables;if(t&&(n=t.all()))for(e=0;e<n.length;e++)i.push({name:n[e].name(),description:p.sR().Fbx_TableName_Description+n[e].name()})}),i},F.prototype.r2t=function(t){for(var n,e,i,n=[],e=t.mp,i=0;i<e.length;i++)e[i]._gi===b.SheetType.tableSheet&&n.push({name:e[i].name(),description:p.sR().Fbx_TableSheetName_Description+e[i].name()});return n},F.prototype.o2t=function(t,n){var e,i,r,o;for(t=C(t),m.OS(t,"[")&&(t=t.substr(t.lastIndexOf("[")+1),t=m.Vi(t,"@","")),e=[],i=n&&n.length,o=0;o<i;o++)r=n[o],0===C(R(r.name)).indexOf(t)&&e.push(r);return e},F.prototype.a2t=function(){var t,n,e,i,r,o,t=this.caret();if(!(t<=0)&&0<(e=(n=this.Fmt)&&n.length))for(r=void(i=0),o=0;o<e;o++){if(i+(r=n[o]).text.length>=t)return r.text.substring(0,t-i);i+=r.text.length}return""},F.prototype.u2t=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,t=this.caret(),n=this.Fmt,e=n&&n.length,i=[],r=0,a=0;a<e;a++){if(o=n[a],i.push(o),6===o.type)for(u=0;0<i.length;)if(6===(s=i.pop()).type&&u++,5===s.type&&u--,0===u){0<i.length&&(s=i[i.length-1])&&2===s.type&&i.pop();break}if(t<=(r+=o.text.length))break}if(0<i.length)for(c=0;0<i.length;)if(8===(o=i.pop()).type)c++;else if(2===o.type){for(f=C(o.text),h=(l=this.n2t())&&l.length,d=void 0,a=0;a<h;a++)if(d=l[a],C(R(d.name))===f)return{func:d,activeParamterIndex:c,isFunc:d.isFunc};break}return w},F.prototype.Zgt=function(){var n,t,e,i,r,o,a,u,i,s,c,n=this,t=n.s2t(),e;if(!(n.ogt&&(0,b.kf)(n.text())&&t&&0<t.length&&(!n.XD||n.Lve)&&!n.Egt)||n.rl&&!n.Lve)n.f2t();else{for(n.c2t(),i=n.Kmt,8<t.length?(i.style.height="204px",i.style.overflowY="scroll"):(i.style.height="auto",i.style.overflowY=""),r="",o=t.length,a=void 0,u=0;u<o;u++)r+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(a=t[u]).isFunc+">"+R(a.name)+"</div><div class='gcsj-func-ac-row-description'>"+(a.description||"")+"</div></div>";(i=(0,b.GC$)(n.Kmt)).html(r).show(),n.Tgt=!0,0<(s=i.find(I)).length&&(c="gcsj-ac-row-active",(0,b.GC$)(s[0]).addClass(c),s.bind("mouseover",function(){s.removeClass(c),(0,b.GC$)(this).addClass(c)}),s.bind("click",function(){n.Ggt()}),n.Ngi)&&s.bind("mousedown",function(t){n.Ggt(),g(t)}),n.u_()}},F.prototype.Qmt=function(){var t,n,t=this,n=(0,b.GC$)(t.Kmt).find(I);n&&(n.unbind("mouseover"),n.unbind("click"),t.Ngi)&&n.unbind("mousedown")},F.prototype.s2t=function(){var t,n,e,i,r,n,r,o,a,u,s,c,n,t=this,n=t.cgt(t.caret()),e=n&&n.text,i=[],r=t.Fmt.indexOf(n);if(n&&14===n.type)return i;if(n=this._getTable(r),0<(r=t.h2t(r,n)).length){if(o=[],!n.Mf.NMi)for(s in a=JSON.parse(JSON.stringify(p.sR().d2t)),u=p.getMapping()&&p.getMapping().tableFunctionsMapping,a)(c=u&&u[a[s].name])&&(a[s].name=c),o.push(a[s]);if(i=i.concat(r).concat(o),m.dT(e,"[")||m.dT(e,"[@"))return i}else i=this.n2t();return n=[],n=(e=t.a2t())?t.o2t(e,i):n},F.prototype._getTable=function(t){var n,e,i,n,t,n,i,n,n=this.Fmt;return!(t<0||!n||t>=n.length)&&(i=(e=this.Vv)&&(0,b.jf)(e),u(t)&&(t=n.length),i)?(n=n[t],t=m.gmt(n.text,"["),i=(n=i.tables)&&n.findByName(t),u(i)&&(n=e.getSheetTab(t))&&n._gi===b.SheetType.tableSheet?n:i):null},F.prototype.h2t=function(t,n){var e=[];return e=u(n)?e:ft(n).columns},F.prototype.f2t=function(){(0,b.GC$)(this.Kmt).hide(),this.Tgt=!1},F.prototype.Pgt=function(t){var n,e,i,r,o,a,u,s,n=(0,b.GC$)(this.Kmt).find(I),e=n.length;if(0!==e){if(i="gcsj-ac-row-active",r=0,t)for(o=0;o<e;o++)if((0,b.GC$)(n[o]).hasClass(i)){r=o+t;break}a=(0,b.GC$)(this.Kmt).scrollTop(),n.removeClass(i),(u=0)<e&&(u=n[0].offsetHeight),r=f(r,0),s=n[r=y(r,e-1)],(0,b.GC$)(s).addClass(i),s.offsetTop+s.offsetHeight>(0,b.GC$)(this.Kmt).scrollTop()+(0,b.GC$)(this.Kmt).height()?(0,b.GC$)(this.Kmt).scrollTop((0,b.GC$)(this.Kmt).scrollTop()+u):s.offsetTop<(0,b.GC$)(this.Kmt).scrollTop()?(0,b.GC$)(this.Kmt).scrollTop(s.offsetTop):(0,b.GC$)(this.Kmt).scrollTop(a)}},F.prototype.Ggt=function(){var t,n,e,n,i,r,o,a,u,s,c,f,l,h,d,d,l,f,d,t=this,n=(0,b.GC$)(t.Kmt).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),e=n.text(),n="true"===n.attr("isFunc");if(e){for(i=t.caret(),o=(r=t.Fmt)&&r.length,s=u=a=0,c=w;s<o&&!(i<=a+(u=(c=r[s]).text.length));)s++,a+=u;f=i-a,l=c.text,d=h=0,m.OS(l,"[")?-1===(h=l.lastIndexOf("[",f-1))?(h=l.indexOf("["),c.text=-1===h?e:e+l.substr(h),h=0):("@"===l.charAt(++h)&&(h+=1),-1===(d=l.indexOf("]",f))&&(d=l.length),c.text=l.substring(0,h)+e+l.substr(d)):(c.text=e,(d=l.substr(f))&&1<(l=t.Ost("="+d)).length&&r.splice(s+1,0,l[1])),c.type=n?2:11,d=r[f=s+1],!n||d&&5===d.type||r.splice(f,0,{text:"(",type:5}),t.f2t(),t.Ti.focus(),t.lgt(),t.caret(a+e.length+h+(n?1:0)),t.w6(),t.Fmt=t.Ost(t.text()),t.ki(x,{})}},F.prototype.w6=function(){var t,n,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n,t=this,n=t.zmt();if(!(n&&n.ignoreShowFunctions&&n.ignoreShowFunctions()))if(t.Tgt&&t.f2t(),(n=t.u2t())===w||!0!==n.isFunc)t.c2t();else if(e=t.fgt(),!(i=t.agt&&(0,b.kf)(t.text())&&n&&!t.XD&&!t.Egt)||t.rl&&!t.Lve)t.c2t();else{for(a=(o=(r=n.func).parameters)&&o.length,u=y(a-1,n.activeParamterIndex),s=void 0,c="",f=0;f<a;f++)l=(s=o[f]).name,s.repeatable&&(l+=e+"..."),s.optional&&(l="["+l+"]"),h=f===a-1?"":e+" ",c+=l=f===u?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+l+"</span>"+h:"<span class='gcsj-func-help-paramter'>"+l+"</span>"+h;n=(d="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+R(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+c+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>")+(g="<div class='gcsj-func-help-body'>"+(m="<div class='gcsj-func-help-section-content'>"+(v="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+p.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div>")+"</div>")+"</div>"),(0,b.GC$)(t.Jmt).html(n).show(),t.Rgt=!0,t.u_()}},F.prototype.c2t=function(){(0,b.GC$)(this.Jmt).hide(),this.Rgt=!1},F.prototype.close=function(){this.f2t(),this.c2t()},F.prototype.$D=function(t,n){var e,i,r,o,a,u,e=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,i=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.metaKey,u=t.srcElement||t.target;return t.target===this.Ti&&(46===i||8===i)||!this.XD&&(!(!this.Tgt||e||i!==_&&i!==k&&i!==D)||!!(u&&n&&n.isEditing&&"gcAttachedFormulaTextBox"===u.getAttribute("gcUIElement"))&&(67===i&&(r||a)&&!o||88===i&&(r||a)&&!o))},F.prototype.u_=function(){var t,n,e,n,i,r,t,o,o,i,e,r,a,u,t,s,e,t=this,n=w;t.Tgt?n=t.Kmt:t.Rgt&&(n=t.Jmt),n&&(t.Zpe?t.Wpe(n):(e=(0,b.GC$)(t.Ti),n=(0,b.GC$)(n),i=e.parent(),r=e.outerHeight(),t.t2t(t.Ti)&&(r=(i=i.parent()).outerHeight()),t=i.css("top"),o=parseFloat(t),isNaN(o)||(t=o),o=i.css("left"),"auto"===t&&(t=e.offset().top,o=e.offset().left),i=t+r,e=(0,b.GC$)(v.body).outerHeight(),r=(0,b.GC$)(v.body).outerWidth(!0),a=n.outerHeight(),u=n[0].offsetWidth,e<(s=i+a)&&0<=(e=t-a)&&(i=e),r<(t=parseFloat(o))+u+2&&(t-=t+u+2-r),n.css("top",i).css("left",t)))},F.prototype.Wpe=function(t){var n,e,i,e,r,o,n,a,u,s,n,r,n,n=this,e=t.getBoundingClientRect(),i=e.height,e=e.width,r=v.body.clientHeight,o=v.body.clientWidth,n=n.Ti.getBoundingClientRect(),a=n.left,u=n.top,s=n.width,n=n.height;t.style.position="fixed",r<(r=u+n)+i&&0<=u-i&&(r=u-i),o<(n=a)+e&&0<=a+s-e&&(n=a+s-e),(0,b.GC$)(t).css("top",r).css("left",n)},F.prototype.focus=function(){(0,b.GC$)(this.Ti).focus()},F.prototype.Pmt=function(t){for(var n,e,i,r,o,a,u,s,c,n=this,e="",i="",r=t&&t.length,o=0,u=0;u<r;u++)s="",11===(a=t[u]).type&&(s=" style='color: "+n.pmt(o)+"'",o++),n.F0.innerText=a.text,e+="<span"+s+" class='gcsj-func-color-text'>"+n.F0.innerHTML+"</span>",i+=a.text;if(i||n.text())if(c=n.Ti,e)c.innerHTML="<span class='gcsj-func-color-content'>"+e+"</span>";else for(;c.firstChild;)c.removeChild(c.firstChild)},F.prototype.tgt=function(t,n){var e,i,r,o,a,e=(0,b.GC$)(t).find(".gcsj-func-color-content .gcsj-func-color-text"),i=e.length;for(n=f(0,n),a=0;a<i;a++)if((n-=(o=(r=e[a]).innerText).length)<=0)return{node:r,offset:o.length+n};return o?{node:r,offset:o.length}:w},F.prototype.y6=function(t,n){var e,i,r,e=h.getSelection(),i=this.Ti.children[0],r=document.createRange();r.setStart(i,t),r.setEnd(i,n),e.removeAllRanges(),e.addRange(r)},F.prototype.mmt=function(t){var n,e,e,i,n=this,e=n.Ti,e=n.vmt(e),i=n.text();e&&i&&(i=t?i.substr(0,i.length-2):i,n.Nmt.push(i))},F.prototype.egt=function(t,n){var e,i,r,o,a,u,s,c;if(n)for(o=n.length,a=r=i=e=0;a<t.length;a++){for(u=t[a].text;i<o;i++)if((s=n[i].toUpperCase())===(c=u[r]?u[r].toUpperCase():void 0))r+=1;else{if("\n"!==s)break;i+1<o&&"\u200b"===n[i+1]&&(i+=1)}t[a].text=n.substring(e,i),e=i,r=0}return t},F.prototype.ngt=function(t){var n,e,i,r,o;if("="===t[0]&&-1!==t.indexOf("\n")){for(e=t.length,i=!(n=[]),r=0;r<e;r++)(i='"'===(o=t[r])?!i:i)||"\n"!==o?n.push(o):r+1<e&&"\u200b"===t[r+1]&&(r+=1);return n.join("")}},F.prototype.isOutFormulaTextBox=function(t){if(0===arguments.length)return this.Ngi;this.Ngi=t},ot=F,s.FormulaTextBox=ot},"./dist/plugins/group/group-actions.js":function(F,t,n){"use strict";var e,i,c,y,t,L,r,o,a,u,s,f,l,h,d,n,v,m,i,g,p,n,b,w,i,M,C,S,T,A,I,x,N,k,_,B,P,G,U,H,V;function D(t){var n=t.Mf;return t.v2t?n.rowOutlines:n.columnOutlines}function z(t){var n,e,i,r,o,a,t,n=this,e=!1;return(t?n.canExecute():n.canUndo())&&(i=n.Mf,r=n.tT.index,o=n.tT.count,a=D(n),i)&&a&&!d(r)&&!d(o)&&(t=t?a.group:a.ungroupRange,n.X5(i,!0),t.call(a,r,o),n.q5(i,!0),e=!0),e}function j(t,n,e){var t=A.call(this,t,n)||this;return t.v2t=e,t}function Y(t,n){return I.call(this,t,n,!1)||this}function Z(t,n){return x.call(this,t,n,!0)||this}function O(t,n,e){var t=N.call(this,t,n)||this;return t.v2t=e,t}function W(t,n){return k.call(this,t,n,!1)||this}function Q(t,n){return _.call(this,t,n,!0)||this}function J(t,n,e,i,r){for(var o=0,a,a=n;a<=e&&a<i;a++)o+=r.call(t,a)*t.zoom();return o}function K(t,n,e,i,r){for(var o=0,a,a=n;a<i&&o<e;a++)n++,o+=r.call(t,a)*t.zoom();return i<=n?i-1:n}function X(t,n,e,i,r){if(n<i)return i;if(r<n)return r;for(var o=n;o<=r;o++)if(e.call(t,o))return o;return-1}function q(t,n,e){var i,r,o,a,u,i,s,s,c,f,l,h,f,d,v,m,g,m,p,b,w,i,c,e,i=this,r=i.Mf,o=e.index,a=n?r.getRowCount():r.getColumnCount(),u=void 0,i=D(i),s=i.KMi;o<0||a<=o||s||(s=1===i.direction(),(0,y.isIndexValid)(i,c=s?o-1:o+1)&&(f=r.Fi(),l=n?r.frozenRowCount():r.frozenColumnCount(),h=n?r.frozenTrailingRowCount():r.frozenTrailingColumnCount(),f=n?f.Ty:f.Uy,d=n?r.Ny:r.Vy,v=n?r.getRowHeight:r.getColumnWidth,m=n?r.getViewportTopRow:r.getViewportLeftColumn,g=n?r.getViewportHeight:r.getViewportWidth,m=m.call(r,1),i=i.find(c,e.level))&&(c=s?i.start:o,e=s?o:i.end,s?(t?c=o:c<l&&(c=l),c<m&&(m=c),a-h<=e&&(e=a-h-1),p=g.call(r,1),w=X(r,m=(p+=d?0:f)<(b=J(r,m,e,a,v))?K(r,m,b-p,a,v):m,v,l,a-1)):(t?e=o:a<=e&&(e=a-1),a-h<=e&&(e=a-h-1),(c<m||(p=g.call(r,1),(p+=d?0:f)<(b=J(r,m,e,a,v))))&&(w=X(r,c,v,l,a-1))),n&&w!==u?(r.Tb=w,r.tw()):n||w===u||(r.Ab=w,r.ow())))}function $(t){var n,e,i,r,o,a,u,s,c,t,n=this,e=!1;return(t?n.canExecute():n.canUndo())&&(i=n.Mf,r=n.tT,o=D(n),a=r.collapsed,u=r.index,s=r.level,!i||!o||d(a)||d(u)||d(s)||(n.X5(i,!0),t||(a=!a),(c=1===o.direction()?0<=u-1&&o.find(u-1,s):u+1<o.items.length&&o.find(u+1,s))&&o.setCollapsed(u,a),d(r.index)&&(r.index=(0,y.getExtendIndex)(i,n.v2t,s)),q.call(n,a,n.v2t,r),(t=i.getCalcService()).Vct=4,i.recalcRange(0,0,i.getRowCount(),i.getColumnCount()),delete t.Vct,i.resumeCalcService(!1),t.Zct(),n.q5(i,!0),e=!0)),e}function E(t,n,e){var t=B.call(this,t,n)||this;return t.v2t=e,t}function tt(t,n){return P.call(this,t,n,!1)||this}function nt(t,n){return G.call(this,t,n,!0)||this}function R(t,n,e){var t=U.call(this,t,n)||this;return t.v2t=e,t}function et(t,n){return H.call(this,t,n,!1)||this}function it(t,n){return V.call(this,t,n,!0)||this}e=this&&this.__extends||(T=function(t,n){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}T(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Commands=void 0,i=n("Common"),c=n("Core"),Object.defineProperty(t,"Commands",{enumerable:!0,get:function(){return c.Commands}}),y=n("./dist/plugins/group/group.js"),t=c.Commands.ActionBase,L=c.GC$,r="outlineColumn",o="removeColumnOutline",a="expandColumnOutline",u="expandColumnOutlineForLevel",s="outlineRow",f="removeRowOutline",l="expandRowOutline",h="expandRowOutlineForLevel",d=i.Common.lt.ht,e(j,A=t),j.prototype.execute=function(){var t,n,e,i,t,r,t=this,n=t.Mf,e=t.tT,i=n.Ut;return i.startTransaction(),t=z.call(t,!0),e[r=c.Commands.TI(n.name())]=i.endTransaction(),t},j.prototype.undo=function(){return z.call(this,!1)},e(Y,I=n=j),v=Y,e(Z,x=n),m=Z,e(O,N=t),O.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=n.Ut,i=!1;return t.canExecute()&&(o=(r=t.tT).index,a=r.count,u=D(t),n)&&u&&!d(o)&&!d(a)&&(e.startTransaction(),t.X5(n,!0),u.ungroupRange(o,a),t.q5(n,!0),r[s=c.Commands.TI(n.name())]=e.endTransaction(),i=!0),i},O.prototype.undo=function(){var t,n,e,i,i,t=this,n=!1,e=t.Mf;return t.canUndo()&&(i=c.Commands.TI(e.name()),i=t.tT[i],e)&&i&&(t.X5(e,!0),e.Ut.undo(i),t.q5(e,!0),n=!0),n},e(W,k=i=O),g=W,e(Q,_=i),p=Q,e(E,B=t),E.prototype.canExecute=function(){var t,n,e,i,t,t=this,n,e=t.Mf.NMi;return!e||(i=t.tT.level,t=D(t),e.detailColumnsVisible())||i<t.getMaxLevel()},E.prototype.execute=function(){var t,n,e,i,t,r,t=this,n=t.Mf,e=t.tT,i=n.Ut;return i.startTransaction(),t=$.call(t,!0),e[r=c.Commands.TI(n.name())]=i.endTransaction(),t},E.prototype.undo=function(){return $.call(this,!1)},e(tt,P=n=E),b=tt,e(nt,G=n),w=nt,e(R,U=t),R.prototype.canExecute=function(){var t,n,e,i,t,t=this,n,e=t.Mf.NMi;return!e||(i=t.tT.level,t=D(t),e.detailColumnsVisible())||i<=t.getMaxLevel()},R.prototype.execute=function(){var t,n,e,i,r,o,a,a,a,t=this,n=t.Mf,e=!1;if(t.canExecute()&&(i=void 0,r=t.tT.level,o=D(t),n)&&o&&!d(r)){for(n.Ut.startTransaction(),t.X5(n,!0),n.suspendCalcService(),n.Ut.m2t(t.v2t),o.Xst(),i=0;i<r;i++)o.expand(i,!0,!0);o.expand(r,!1,!0),o.$st(),n.Ut.m2t(t.v2t,!0),a=t.tT.index,d(a)&&(a=(0,y.getExtendIndex)(n,t.v2t,r)),q.call(t,!1,t.v2t,{level:r-1,index:a}),(a=n.getCalcService()).Vct=4,n.recalcRange(0,0,n.getRowCount(),n.getColumnCount()),delete a.Vct,n.resumeCalcService(!1),a.Zct(),t.q5(n,!0),a=c.Commands.TI(n.name()),t.tT[a]=n.Ut.endTransaction(),e=!0}return e},R.prototype.undo=function(){var t,n,e,i,i,t=this,n=!1;return t.canUndo()&&(e=t.Mf,i=c.Commands.TI(e.name()),i=t.tT[i],e)&&i&&(t.X5(e,!0),e.Ut.undo(i),t.q5(e,n=!0)),n},e(et,H=i=R),M=et,e(it,V=i),C=it,S=c.Commands.zA,c.Commands[r]={canUndo:!0,execute:function(t,n,e){return S(t,v,n,e)}},c.Commands[s]={canUndo:!0,execute:function(t,n,e){return S(t,m,n,e)}},c.Commands[o]={canUndo:!0,execute:function(t,n,e){return S(t,g,n,e)}},c.Commands[f]={canUndo:!0,execute:function(t,n,e){return S(t,p,n,e)}},c.Commands[a]={canUndo:!0,execute:function(t,n,e){return S(t,b,n,e)}},c.Commands[l]={canUndo:!0,execute:function(t,n,e){return S(t,w,n,e)}},c.Commands[u]={canUndo:!0,execute:function(t,n,e){return S(t,M,n,e)}},c.Commands[h]={canUndo:!0,execute:function(t,n,e){return S(t,C,n,e)}},c.Commands.g2t=function(t){t.register(r,c.Commands[r]),t.register(s,c.Commands[s]),t.register(o,c.Commands[o]),t.register(f,c.Commands[f]),t.register(a,c.Commands[a]),t.register(l,c.Commands[l]),t.register(u,c.Commands[u]),t.register(h,c.Commands[h])}},"./dist/plugins/group/group.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/group/group-actions.js"),n),r(e("./dist/plugins/group/group.js"),n),r(e("./dist/plugins/group/group.ns.js"),n)},"./dist/plugins/group/group.js":function(b,f,t){"use strict";var y,n,N,M,t,e,I,w,U,H,A,V,c,x,z,v,l,h,Y,R,C,S,u,k,T,F,L,_,B,P,D,Z,Q,J,W,G,d,K,m,X,q,$,tt,nt,n,et,t,it,rt,ot,t,g,j,i,at,ut,n,n;function st(t,n){t.ki(N.Events.RangeGroupStateChanging,n)}function ct(t,n){t.ki(N.Events.RangeGroupStateChanged,n)}function ft(t,n){var e,i,t,e=t.options,i;return!t.isActualProtected()||(t=e.protectionOptions,n?t.allowOutlineRows:t.allowOutlineColumns)}function lt(t,n){var e,i,n,i,r,o,e=n.what===d,i=ft(t,e);t.isEditing&&t.isEditing()||!i?i||t.jT(N.InvalidOperationType.groupProtected,(0,f.getSR)().Exp_GROUP_PROTECTED):(i=e?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",st(t,r=dt(t,e,-1,n=n.info.index,!0)),o=vt(t,e,n-1),r&&!1===r.cancel&&(t.Qy().execute({cmd:i,sheetName:t.name(),level:n,index:o}),ct(t,dt(t,e,-1,n,!1))))}function ht(t,n){var e,i,i,n,r,o,a,u,e=n.what===m,i=ft(t,e);t.isEditing&&t.isEditing()||!i?i||t.jT(N.InvalidOperationType.groupProtected,(0,f.getSR)().Exp_GROUP_PROTECTED):O(e,t)&&(r=n=(i=n.info).index,o=i.level,u=e?"expandRowOutline":"expandColumnOutline",1===i.lineDirection?n--:n++,st(t,a=dt(t,e,n,o,!(a=void 0))),a)&&!1===a.cancel&&(t.Qy().execute({cmd:u,sheetName:t.name(),index:r,level:o,collapsed:i.isExpanded}),ct(t,dt(t,e,n,o,!1)))}function dt(t,n,e,i,r){var t={sheet:t,sheetName:t.name(),isRowGroup:n,index:e,level:i};return r&&(t.cancel=!1),t}function vt(t,n,e){var i,r,o,a,i=n?t.rowOutlines:t.columnOutlines;if(i)for(r=i.items,o=!1,a=0;a<r.length;a++)if(r[a])if(r[a].level===e)o=!0;else if(o)return a;return n?t.getActiveRowIndex():t.getActiveColumnIndex()}function mt(t,n){var e,i,r,o,a,r,a,u,e=this,i=e.gj(),r=i.width,o=i.height;return(r||o)&&(a=e.Fi(),r=new N.Rect(i.x,i.y,r,a.height),a=new N.Rect(i.x,i.y,a.width,o),r.contains(t,n)||a.contains(t,n))?(u=(u=gt(e,t,n,i.rowMaxLevel,!0))||gt(e,t,n,i.colMaxLevel,!1))||{what:"empty",info:I}:I}function r(t,n,e){var i=this;i.PADDING=2,i.Mf=t,i.v2t=n,i.$X=u(e)?e:O(n,t).getMaxLevel()}function o(t,n,e,i){var r=this;r.PADDING=2,r.LINE_SIZE=2,r.START_LINE_SIZE=6,r.p2t=[],r.b2t=[],r.y2t=[],r.Mf=t,r.v2t=n,r.w2t=e,r.$X=u(i)?i:O(n,t).getMaxLevel()}function gt(t,n,e,i,r){var o,a,u,s,o,a=new it(t,r,i).M2t(n,e,r);if(a)return{what:r?d:K,info:a};for(u=pt(t,r,i),s=0;s<=2;s++)if(a=u[s].C2t(n,e,r))return{what:r?m:X,info:a};return I}function pt(t,n,e){for(var i=[new rt(t,n,0,e),new rt(t,n,1,e),new rt(t,n,2,e)],r,r=0;r<=2;r++)i[r].S2t();return i}function bt(t,n){var n=n?t.width:t.height;return U(0,(n-2*this.PADDING)/(this.$X+2))}function O(t,n){return t?n.rowOutlines:n.columnOutlines}function wt(t,n,e,i){var r=this;r.children=[],r.parent=I,r.model=t,r.start=n,r.end=e,r.level=i}function yt(t){this.level=t?t.level:0,this.collapsed=!!t&&t.collapsed,this.viewCollapsed=!!t&&t.viewCollapsed}function Mt(t,n,e){var i,r,o,a;if(0<e){for(i=t.items,o=r=void 0,a=[],r=0;r<e;r++)a.push(I);if(t.items=i=i.slice(0,n).concat(a,i.slice(n)),t.T2t<=0&&0<n&&(o=i[n-1]))for(r=0;r<e;r++)i[n+r]=new j(o);It(t)}}function Ct(t,n,e){var e,e,i;0<e&&(e=t.items.splice(n,e),0<n&&0<e.length&&(e=e[0],i=t.items[n],e)&&e.collapsed&&(i?e.level===i.level&&(i.collapsed=e.collapsed):t.items.length>n&&-1===e.level&&e.collapsed&&(t.items[n]=new j(e))),It(t))}function St(t,n,e){for(var i,r,o,o,a,u,s,c,i=I,r=t.items,a=n,u=Y(r);a<u&&(!(o=r[a])||o.level<e||(i=i||new g(t,a,a,e),o.level>e&&(a=(o=St(t,a,e+1)).index,i.addChild(o.g)),a>i.end&&(i.end=a),!t.isGroupEnd(a,e)));a++);if(i)for(s=i.end+1,c=i.start;c<s;c++)r[c].groupInfo||(r[c].groupInfo=i);return{g:i,index:a}}function a(t,n){return-1<=n&&n<Y(t.items)}function Tt(t,n,e){var t,i,r,t=t&&t.items;if(t)for(i=t[n]&&t[n].groupInfo;i;){if((r=i.level)===e)return i;if(!(e<r))break;i=i.parent}return I}function At(t,n){switch(t){case"head":case"tail":return n===I;case"direction":return 1===n;case"itemsData":return 0===Y(n);default:return}}function It(t){t.A2t=I,t.refresh()}function E(t,n){!n&&t.I2t||(t.A2t=t.createRangeGroup(),Nt(t))}function xt(t){t.I2t&&!t.A2t&&(t.A2t=t.createRangeGroup())}function Nt(t,n){!t.I2t&&t.groupChangeHandler&&t.groupChangeHandler(n)}function kt(t,n,e){if(_t(t,n),!a(t,n+e-1))throw new Error((0,f.getSR)().Exp_InvalidCount)}function _t(t,n){if(!a(t,n))throw new Error((0,f.getSR)().Exp_InvalidIndex)}function Dt(t,n){for(var e,i,e=t.parent;e&&(i=n?t.end===e.end:t.start===e.start);)e=(t=e).parent;return t}function s(t,n,e){var i=this;i.head=I,i.tail=I,i.A2t=I,i.items=new Array(t),i.T2t=0,i.x2t=!0,i.Mf=n,i.v2t=e}function p(t){return t&&new j(t)}function jt(t){return{items:t.items.map(p),head:p(t.head),tail:p(t.tail),x2t:t.x2t,direction:t.direction()}}function Ot(t,n){t.items=n.items.map(p),t.head=p(n.head),t.tail=p(n.tail),t.x2t=n.x2t,t.direction(n.direction),E(t,!0)}function Et(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,p;if(t)for(o=0===i,a=t.rowItems,s=function(t){return o?t<n.rowCount:0<=t},c=function(t){return o?t+1:t-1},f=function(t){return o?t-1:t+1},l=function(t,n){var t=a[t];if(t)return t.level<=n?t:l(t.parentIndex,n)},h=(u=function(){return o?0:n.rowCount-1})(),d=void 0;s(h);h=c(h))(v=a[h])&&-1!==v.level?(m=f(h),p=!(g=a[m])&&"number"==typeof v.level||g&&g.level<v.level,b=g&&g.level>v.level,y=w=void 0,p?(w=m,y=!!g&&(g.collapsed||g.viewCollapsed)):b?-1===v.level?y=!1:(p=void 0,(p=g.parentIndex===d?g:l(g.parentIndex,v.level))&&(w=p.parentIndex,y=p.viewCollapsed)):(w=g.parentIndex,y=g.viewCollapsed),v.parentIndex=w,!(v.viewCollapsed=y)&&e[h].hidden&&(e[h].visible=!1,k(r.infos[h])&&(r.infos[h]={}),r.infos[h].visible=!1)):d=h}function Rt(t,n,e,i,r,o){var a,u,s,c,f,a=t.itemsData;a&&(u=a[a.length-1],s=a[a.length-2],c=u&&u.info,f=s&&s.info,c)&&(i&&r&&1===u.count?f&&s.index===u.index-1&&f.level===c.level-1?f.collapsed=!0:0<n?a.splice(a.length-2,0,{index:u.index-1,count:1,info:{level:c.level-1,collapsed:!0}}):t.head={collapsed:!0,level:e-1}:!i&&o&&(f&&u.index===s.index+1&&c.level===f.level-1?u.collapsed=!0:n>=u.index+u.count&&a.push({index:u.index+u.count,count:1,info:{level:c.level-1,collapsed:!0}})))}y=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(f,"__esModule",{value:!0}),f.Outline=f.isIndexValid=f.OutlineInfo=f.OutlineState=f.OutlineDirection=f.getExtendIndex=f.getSR=void 0,n=t("Common"),N=t("Core"),M=t("./dist/plugins/group/group-actions.js"),t=t("./dist/plugins/group/group.ns.js"),e={},I=null,w=void 0,U=Math.max,H=Math.min,A=Math.round,V=Math.ceil,c=N.GC$,x=c.each,z=N.I.fl,v=n.Common.Uf,l=v.N2t,h=v.d5,Y=v.tR,R=8.25,C=17,S=4,u=N.mt.T1,k=n.Common.lt.ht,T=N.mt.p0,F=N.mt.vt,L=N.mt.o1,_=N.mt.xr,B=N.mt.go,P="rangegroup",Q=(Z=(D="gc-group")+"-box")+"-expand",J=Z+"-collapsed",W=D+"-line",G=D+"-dot",d="rgh",K="cgh",m="rg",X="cg",q=N.XFileConstants.Su,$=N.XFileConstants.bo,tt="1",nt="0",n=new n.Common.ResourceManager(t.SR,"Outlines"),f.getSR=n.getResource.bind(n),et=N.NodeHelper.ur,t={gj:function(){var t,n,e,n,n,i,r,o,a,t=this,n=t.k2t;return n||(n={x:(n=(e=t.options).sheetAreaOffset).left,y:n.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},i=t.rowOutlines,r=t.columnOutlines,o=17*t.zoom(),t.showRowOutline()&&i&&!i.Oy()&&0<=(a=i.getMaxLevel())&&(n.width=o*(a+2)+4,n.rowMaxLevel=a),t.showColumnOutline()&&r&&!r.Oy()&&0<=(a=r.getMaxLevel())&&(n.height=o*(a+2)+4,n.colMaxLevel=a),t.k2t=n)},showRowOutline:T("showRowOutline",!0,function(){this.zw()}),showColumnOutline:T("showColumnOutline",!0,function(){this.zw()})},c.extend(N.Worksheet.prototype,t),f.getExtendIndex=vt,r.prototype.D2t=function(t){var n,e,i,r,o,a,u,i,s,c,f,l,h,o,d,v,m,g,p,o,d,c,b,w,y,v,M,C,S,T,n=this,e=n.Mf,i=n.$X;if(!(i<0)&&(r=n.v2t,o=e.gj(),a=bt.call(n,o,r))){if(u=i+2,i=n.PADDING,s=e.options,c=o.width,f=o.height,l=o.x,h=o.y,d=(o=e.Fi()).width,v=o.height,m=o.qC,g=o.XC,p=o.BA,o=o.LA,t.save(),t.fillStyle=z(D).backgroundColor,t.strokeStyle=z(D).borderTopColor,t.lineWidth=1,t.fillRect(l,h,r?c:d,r?v:f),t.strokeRect(l-.5,h-.5,r?c:d+1,r?v+1:f),r?t.strokeRect(l-.5,o-.5,c,m):t.strokeRect(p-.5,h-.5,g,f),b=U(0,(r?o-s.sheetAreaOffset.top:p-s.sheetAreaOffset.left)+(d=(r?m:g)-a)/2),w=i,r&&(v=b,b=w,w=v),t.restore(),c=r?s.colHeaderVisible:s.rowHeaderVisible,t.save(),c&&0<=d)for(y=0;y<u;y++)M=a-1,C=void 0,S=l+b,T=h+w,r?S=A(S)+.5:T+=.5,t.fillStyle=z(Z).backgroundColor,t.fillRect(S,T,M,M),t.font=R*e.zoom()+"pt Arial",t.strokeStyle=z(Z).borderTopColor,t.strokeRect(S,T,M,M),t.fillStyle=z(Z).color,C=F(t.font),n._2t(t,S,T,M,a,y+1,C),r?b+=a:w+=a;t.restore()}},r.prototype._2t=function(t,n,e,i,r,o,a){var o=""+o,u=t.measureText(o).width;u<=i&&a<=r&&(t.textBaseline="middle",t.fillText(o,n+(i-u)/2,e+i/2))},r.prototype.M2t=function(t,n,e){var i,r,o,o,a,u,s,i=this,r=i.Mf,o=i.$X;return o<0?I:(o=o+2,a=r.Fi(),s=(u=r.options).sheetAreaOffset,e?i.E2t(r,t,n,e,u.colHeaderVisible,a.qC,a.LA-s.top,o):i.E2t(r,t,n,e,u.rowHeaderVisible,a.XC,a.BA-s.left,o))},r.prototype.E2t=function(t,n,e,i,r,o,a,u){var s,c,f,t,l,h,d,v,o,s=this,c=t.gj(),f=bt.call(s,c,i),t=o-f;if(f&&r&&0<=t)for(l=U(0,a+t/2),h=s.PADDING,i&&(o=l,l=h,h=o),v=0;v<u;v++){if((d=new N.Rect(c.x+l,c.y+h,f,f)).contains(n,e))return{index:v};i?l+=f:h+=f}return I},it=r,o.prototype.S2t=function(){var e,t,e=this;-1!==e.$X&&(t=e.j2t(0,e.v2t),x(t,function(t,n){e.O2t(n)}))},o.prototype.O2t=function(t){var o,n,e,n,a,i,r,e,u,s,c,f,l,h,d,v,h,m,g,p,b,w,y,M,C,S,y,T,A,o=this,n=o.Mf,e=o.v2t,n=O(e,n).direction(),a=1===n,i=0===n,r=o.R2t(!0,e),e=o.R2t(!1,e),u=t.start,s=t.end,c=t.level;if(a?f=s+1:i&&(f=u-1),0===t.state()){if(l=!0,(l=(h=t.parent)&&(i&&u===h.start||a&&s===h.end)?!1:l)&&o.B2t(!0,c,f,r,e,n),u<=e&&r<=s){for(d=U(r,u),v=H(e,s),m=h=void 0,l&&(h={start:d,end:v,level:c,startLine:I},(a&&d===u||i&&v===s)&&(h.startLine=!0),o.p2t.push(h)),p=[],b=t.children,m=d;m<=v;m++)p.push(!1);for(x(b,function(t,n){var e=n.start,i=n.end,r;if(1===n.state())for(g=e;g<=i;g++)p[g-d]=!0;p[(r=a?i+1:i-1)-d]=!0,o.O2t(n)}),w=!0,m=0;m<Y(b);m++){if(M=(y=b[m]).start,y=(C=y.end)===s,(S=M===u)&&y){w=!1;break}if(a&&y||i&&S)for(g=M;g<=C;g++)p[g-d]=!0}if(w)for(T=d;T<=v;T++)p[T-d]||o.b2t.push(A={index:T,level:c+1})}}else 1===t.state()&&o.B2t(!1,c,f,r,e,n)},o.prototype.B2t=function(t,n,e,i,r,o){var n={isExpanded:t,level:n};t&&(n.paintLine=!0),i<=e&&e<=r&&(n.index=e,n.lineDirection=o,this.y2t.push(n))},o.prototype.L2t=function(t){var n=this,e=n.Mf,i=n.w2t;return n.v2t?e._y(i).findRow(t):e.Yy(i).findCol(t)},o.prototype.F2t=function(t){var n,e,i,r,o,a,u,s,c,e,f,l,h,d,n=this;-1!==n.$X&&(i=(e=n.Mf).gj(),r=n.v2t,o=bt.call(n,i,r))&&(a=parseInt(z(W).borderTopWidth,10),a=isNaN(a)?2:a,u=A(o/3),c=(o-a)/2+(s=n.PADDING),t.save(),t.fillStyle=z(D).color,e=e.Fi(),l=f=0,h=i.width,d=i.height,r?(l+=e.y+e.qC,d=e.height-e.qC):(f+=e.x+e.XC,h=e.width-e.XC),t.rect(f,l,h,d),t.clip(),n.P2t(t,n.b2t,r,i,o,c,a),r?n.G2t(t,n.p2t,r,i,o,c,a,u):n.U2t(t,n.p2t,r,i,o,c,a,u),n.H2t(t,n.y2t,r,i,o,c,a,s),t.beginPath(),t.restore())},o.prototype.P2t=function(o,t,a,u,s,c,f){var l,h,d,n,e,i,r,v,m,g,d=this,n=2,e,i,r=d.Mf.options.sheetAreaOffset,v=r.left,m=r.top;o.save(),o.fillStyle=z(G).color,g=d.p2t,x(t,function(t,n){var e,i,r,e,i,r,e,i,e=n.index,i=n.level,r=d.L2t(e);r&&!d.z2t(g,e,i)&&(e=a?r.y:r.x,0<=(i=(a?r.height:r.width)-f))&&(l=e+U(0,i/2),h=n.level*s+c,a?(r=l,l=h+.5,h=r,h-=m):(h+=.5,l-=v),o.strokeStyle="transparent",o.lineWidth=0,(e=u.x+l)%1!=0&&(e+=.5),(i=u.y+h)%1!=0&&(i+=.5),o.strokeRect(e,i,2,2),o.fillRect(e,i,2,2))}),o.restore()},o.prototype.z2t=function(t,n,e){for(var i,r,o,i=!1,r=Y(t),o=0;o<r;o++)if(t[o].level===e&&t[o].start<=n&&t[o].end>=n){i=!0;break}return i},o.prototype.G2t=function(t,n,e,i,r,o,a,u){var s,e,c,f,l,h,d,v,m,g,p,b,w,y,M,C,M;for(t.save(),t.strokeStyle=z(W).borderTopColor,t.fillStyle=z(W).borderTopColor,t.lineWidth=a,c=O(e,e=(s=this).Mf).direction(),d=(h=(l=e.options).sheetAreaOffset).top,f=0;f<Y(n);f++){for(m=(v=n[f]).start,g=v.end,b=p=void 0;p=s.L2t(m),m++,!p&&m<=g;);for(;b=s.L2t(g),g--,!b&&m<=g;);(p||b)&&(p?b=b||p:p=b,w=p.y,y=v.level*r+o,M=a,C=U(0,b.y+b.height-p.y),1===c?w+=1:--w,w-=d,t.beginPath(),M=i.x+y+M/2,M=V(M),t.moveTo(M,i.y+w),t.lineTo(M,i.y+w+C),t.stroke(),v.startLine)&&0<r/2-2*a&&(w=0===c?w+C-a-d:w)>=p.y-d&&w<b.y+b.height-d&&t.fillRect(V(i.x+y),i.y+w,u,a)}t.restore()},o.prototype.U2t=function(t,n,e,i,r,o,a,u){var s,e,c,f,l,h,d,v,m,g,p,b,w,y,M,C;for(t.save(),t.strokeStyle=z(W).borderTopColor,t.fillStyle=z(W).borderTopColor,t.lineWidth=a,c=O(e,e=(s=this).Mf).direction(),d=(h=(l=e.options).sheetAreaOffset).left,f=0;f<Y(n);f++){for(m=(v=n[f]).start,g=v.end,b=p=void 0;p=s.L2t(m),m++,!p&&m<=g;);for(;b=s.L2t(g),g--,!b&&m<=g;);(p||b)&&(p?b=b||p:p=b,w=p.x,y=v.level*r+o,M=U(0,b.x+b.width-p.x),1===c&&(w+=1),w-=d,C=i.y+y+a/2,C=V(C),t.beginPath(),t.moveTo(i.x+w,C),t.lineTo(i.x+w+M,C),t.stroke(),v.startLine)&&0<r/2-2*a&&(w=0===c?w+M-a-d:w)>=p.x-d&&w<b.x+b.width-d&&t.fillRect(i.x+w,V(i.y+y),a,u)}t.restore()},o.prototype.V2t=function(t){var t=z(t).backgroundImage;return t=(t="none"===t?"":t)&&(t=(t=t.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()},o.prototype.H2t=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,F,L,B,P,G,l,v,m,g,f,l,p,b,w,y,M,C,C,S,T,A,I,x,N,k,_,D,j,x,T,O,E,R,S,S,E,C,k,_,I,_,s=this,f=s.Mf,l=f.options,h=l.sheetAreaOffset.left,d=l.sheetAreaOffset.top,F=z(Z).borderTopColor,L=z(Z).backgroundColor,B=z(Z).color,P=z(W).borderTopColor,G=1,l=f.BO(),v=s.V2t(Q),m=s.V2t(J);for(v&&!l.getState(v)&&l.addImage(v),m&&!l.getState(m)&&l.addImage(m),g=m&&l.getImage(m),f=v&&l.getImage(v),l=z(Q),p=z(J),b=f?l.backgroundColor:"",w=g?p.backgroundColor:"",y=f?l.borderTopColor:"",M=g?p.borderTopColor:"",c=0;c<Y(n);c++)t.save(),A=n[c],!(I=s.L2t(A.index))||(x=e?I.height:I.width)<=0?t.restore():(N=U(0,(x-r)/2),D=(e?I.y-d:I.x-h)+N,j=A.level*r+u,E=O=_=k=void 0,R=x-(x=H(T=r,x)),E=e?(S=D,D=j,j=S,S=x,x=T,T=S,O=.5,0):(O=0,.5),S=A.isExpanded?y:M,t.strokeStyle=S||F,t.lineWidth=1,C=A.isExpanded?b:w,t.fillStyle=C||L,t.fillRect(i.x+D,i.y+j,x,T),k=i.x+D+O,_=i.y+j+E,t.strokeRect(k,_,x,T),t.fillStyle=B,C=A.isExpanded?v:m,s.Y2t(t,A.isExpanded,C,k,_,x,T),t.restore(),A.paintLine&&0<R&&(t.save(),t.strokeStyle=P,D=e?I.y-d:I.x-h,j=A.level*r+o,E=0===A.lineDirection,C=e?a:N,k=e?N:a,e?(_=D,D=j,j=_,E&&(j+=N+T,k=R-N)):E&&(D+=N+x,C=R-N),t.beginPath(),t.lineWidth=a,I=V(i.x+D+a/2),_=V(i.y+j+a/2),e?(t.moveTo(I,i.y+j),t.lineTo(I,i.y+j+k-1)):(T=0,g&&!A.isExpanded&&(T=1),t.moveTo(i.x+D,_),t.lineTo(i.x+D+O+C+T,_)),t.stroke(),t.restore()))},o.prototype.Y2t=function(t,n,e,i,r,o,a){var u,s,c,c,e,f,u=this,s,c=this.Mf.BO();if(e&&c.getState(e)){e=(c=c.getImage(e)).width,f=c.height;try{t.drawImage(c,0,0,e,f,A(i),A(r),o-1,a-1)}catch(t){}}else u.Z2t(t,n,i,r,o,a)},o.prototype.Z2t=function(t,n,e,i,r,o){var a,u,n,s,a=A(r/4),u=A(r/2);n||(n=A(o/4),s=A(o/2),t.fillRect(e+r/2-1,i+n,2,o-s)),t.fillRect(e+a,i+o/2-1,u,2)},o.prototype.j2t=function(t,n){var e,i,r,o,a,u,s,c,e,f,l,e,e=this,i=e.Mf,r=[],a=-1,u=-1,s=O(n,i),c,e=(n?i._y:i.Yy).call(i,e.w2t),f=Y(e);for(f&&(l=e[0],e=e[f-1],a=U(0,(n?l.row:l.col)-1),u=n?H(i.getRowCount(),e.row+2):H(i.getColumnCount(),e.col+2));a<u;)(o=s.find(a,t))?(a=o.end+1,r.push(o)):a++;return r},o.prototype.R2t=function(t,n){var e=-1,i=this,r=i.Mf,i=i.w2t,o=r.frozenRowCount(),a=r.frozenColumnCount(),u=r.frozenTrailingRowCount(),s=r.frozenTrailingColumnCount(),c=r.getRowCount(),r=r.getColumnCount();return 0===i?e=t?0:(n?o:a)-1:1===i?e=t?n?o:a:(n?c-u:r-s)-1:2===i&&(e=t?n?c-u:r-s:(n?c:r)-1),e},o.prototype.W2t=function(t){t&&this.Mf.Oi&&(t.x-=2,t.y-=2,t.width+=4,t.height+=4)},o.prototype.C2t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,d,g,p,g,h,b,w,w,i=this,r=i.$X,o=i.Mf,a=o.options,u=a.sheetAreaOffset.left,s=a.sheetAreaOffset.top;if(!(r<0)&&(c=o.gj(),f=bt.call(i,c,e)))for(l=i.y2t,v=0;v<Y(l);v++)if(g=(m=l[v]).index,d=m.level*f+i.PADDING,(g=i.L2t(g))&&!((h=e?g.height:g.width)<=0)&&(p=H(f,h),h=(e?g.y-s:g.x-u)+U(0,(h-(g=f))/2),b=d,e&&(w=p,p=g,g=w,w=h,h=d,b=w),d=new N.Rect(c.x+h+.5,c.y+b+.5,p,g),i.W2t(d),d.contains(t,n)))return m;return I},rt=o,(n=ot=f.OutlineDirection||(f.OutlineDirection={}))[n.backward=0]="backward",n[n.forward=1]="forward",e.OutlineDirection=ot,(n=t=f.OutlineState||(f.OutlineState={}))[n.expanded=0]="expanded",n[n.collapsed=1]="collapsed",e.OutlineState=t,wt.prototype.state=function(t){var n=this,e=n.model;if(!arguments.length)return e?e.getState(n):0;e&&e.expandGroup(n,0===t)},wt.prototype.contains=function(t){return this.start<=t&&t<=this.end},wt.prototype.addChild=function(t){t&&(this.children.push(t),t.parent=this)},g=wt,f.OutlineInfo=g,e.OutlineInfo=g,j=yt,f.isIndexValid=a,s.prototype.L0=function(){this.Mf=I},s.prototype.getUsedRange=function(t){var t,n,e,i,r,t,o,t,a,u,s,c,f;if(t&N.UsedRangeType.axis&&(n=(t=this).items,e=t.v2t,r=(i=Object.keys(n)).length,t=t.Mf,0<r)&&t){for(a=(t=r)-1,u=o=0;u<r;u++)if(n[+i[u]]){o=u;break}for(s=r-1;0<=s;s--)if(n[+i[s]]){a=s;break}if(c=n[+i[o]],f=n[+i[a]],c&&f)return c&&-1===c.level&&(o+=1),f&&-1===f.level&&(t=a),e?{minRow:+i[o],minCol:0,maxRow:+i[t-1],maxCol:1/0}:{minRow:0,minCol:+i[o],maxRow:1/0,maxCol:+i[t-1]}}},s.prototype.group=function(t,n){var e=this,i,r;for(kt(e,t,n),e.Mf.Ut.m2t(e.v2t),i=0;i<n;i++)e.items[r=t+i]?e.items[r].level++:e.items[r]=new j;e.I2t&&e.A2t&&(e.A2t=I),e.Mf.Ut.m2t(e.v2t,!0),E(e),e.x2t=!1},s.prototype.Xst=function(){this.I2t=!0,this.A2t=I},s.prototype.$st=function(){var t=this;t.I2t=!1,t.refresh()},s.prototype.ungroupRange=function(t,n){var e=this,i,r;for(kt(e,t,n),e.Mf.Ut.m2t(e.v2t),i=0;i<n;i++)(r=e.items[t+i])&&-1<r.level&&r.level--;e.Mf.Ut.m2t(e.v2t,!0),E(e)},s.prototype.ungroup=function(){var t=this,n=Y(t.items);t.Mf.Ut.m2t(t.v2t),t.items=new Array(n),E(t),t.x2t=!0},s.prototype.expand=function(t,n,e){var i,r,o,a,u,s,c;if(t<-1)throw new Error((0,f.getSR)().Exp_InvalidLevel);for(r=(i=this).items,(a=i.Mf).Ut.m2t(i.v2t),xt(i),u=a.op(),a.suspendPaint(),u.suspend(),s=0,c=r.length;s<c;s++)r[s]&&(o=i.find(s,t))&&(i.expandGroup(o,n,!0),s=o.end);e||i.Mf.Ut.m2t(i.v2t,!0),u.resume(!1),a.resumePaint()},s.prototype.expandGroup=function(t,n,e){if(!t)throw new Error((0,f.getSR)().Exp_GroupInfoIsNull);var i=this,r=i.direction(),o=-1;e||i.Mf.Ut.m2t(i.v2t),0===r?o=t.start-1:1===r&&(o=t.end+1),i.setCollapsed(o,!n,t.level,e),e||i.Mf.Ut.m2t(i.v2t,!0),i.Mf.zw()},s.prototype.tF=function(t){return!(!this.x2t&&a(this,t)&&this.isCollapsed(t))},s.prototype.isCollapsed=function(t){var t=this.items[t];return!!(t&&t.viewCollapsed&&-1<t.level)},s.prototype.find=function(t,n){var e=this,i;return xt(e),i=-1===n?e.A2t:(e.Mf.NMi||_t(e,t),Tt(e,t,n))},s.prototype.getLevel=function(t){var t=this.items[t];return t?t.level:-1},s.prototype.getCollapsed=function(t){var t=this.items[t];return!!t&&!!t.collapsed},s.prototype.Q2t=function(t,n,e,i){for(var r,o,r=n;r<=e;r++)(o=t[r])||((o=t[r]=new j).level=-1),o.viewCollapsed=i},s.prototype.setCollapsed=function(t,n,e,i){var r,o,a,u,s,c,s,a,f,l,h,r=this,o=!1,a=r.items,s=r.Mf.Ut,c=[];if(i||s.m2t(r.v2t),xt(r),t<0?u=(u=r.head)||(r.head=new j):t<Y(a)?(u=a[t])||((u=a[t]=new j).level=-1):u=(u=r.tail)||(r.tail=new j),s=1===r.direction(),(a=e!==w)||u.collapsed===n?a&&(u.level===e-1&&(u.collapsed=n),o=!0,r.K2t(t,n,e)):(u.collapsed=n,o=!0,r.K2t(t,n,e)),o&&(l=r.find(t+=s?-1:1,r.getLevel(t)))){for(h=l.start;h<=l.end;h++)c.push(h);f={indexes:c}}Nt(r,f),i||r.Mf.Ut.m2t(r.v2t,!0)},s.prototype.J2t=function(t,n){var e,e,e=this.items;e[t]?e[t].collapsed!==n&&(e[t].collapsed=n):((e=e[t]=new j).level=-1,e.collapsed=n)},s.prototype.K2t=function(t,n,e){var i,r,o,a,u,s,c,s,f,e,l,h,d,v,m,g,p,b,i=this,r=i.items,o=1===i.direction(),a,u=e!==w,s=t+(o?-1:1),c=u?e:i.getLevel(s),s=Tt(i,s,c);if(s&&(f=o?s.end+1:s.start-1)!==t&&(s=null),k(s)&&(c=u?e:i.getLevel(t),s=Tt(i,t,c)),s)if(e=void 0,l=s.parent,n)u||(e=o?s.end+1:s.start-1,i.J2t(e,!0),s=Dt(s,o)),i.Q2t(r,s.start,s.end,!0);else{for(h=!1,d=void 0;l;){if(r[d=o?l.end+1:l.start-1]&&r[d].collapsed&&-1<r[d].level){h=!0;break}l=l.parent}if(!h)for(u||(e=o?s.end+1:s.start-1,i.J2t(e,!1),s=Dt(s,o)),i.Q2t(r,s.start,s.end,!1),v=[s],m=0;0<=m;)if(g=v[m],m--,r[d=o?g.end+1:g.start-1]&&r[d].collapsed&&-1!==r[d].level)i.Q2t(r,g.start,g.end,!0);else for(p=g.children,b=0;p&&b<p.length;b++)v[++m]=p[b]}},s.prototype.getMaxLevel=function(){var e=-1,t=this.items,i;return x(t,function(t,n){n&&(i=n.level,e<i)&&(e=i)}),e},s.prototype.PB=function(t,e,n,i){var r,o,a,u,s;if(!(n<=0||t===e)){for((r=this).Mf.Ut.m2t(r.v2t),e<0&&(e=0),o=[],a=r.items,u=l(a,(t=t<0?0:t)-1);0<=u&&u<t+n;)s=new j(a[u]),o.push({index:u-t,value:s}),u=l(a,u);i&&h(a,t,n),h(a,e,n),x(o,function(t,n){a[e+n.index]=n.value}),It(r),r.Mf.Ut.m2t(r.v2t,!0)}},s.prototype.FB=function(t,n,e,i,r){var o,a,u,o=this;if(o.Mf.Ut.m2t(o.v2t),n<0&&(n=0),e<0&&(e=0),a=[],t)for(u=l(t.items,n-1);0<=u&&u<n+i;)a[u-n]=new j(t.items[u]),u=l(t.items,u);h(o.items,e,i),0<a.length&&a.forEach(function(t,n){o.items[e+n]=t}),r&&h(t.items,n,i),o.Mf.Ut.m2t(o.v2t,!0)},s.prototype.refresh=function(){this.x2t||E(this)},s.prototype.X2t=function(t){var n=this,e=n.items,i,r=t-Y(e);r<0?e.splice(t,-r):n.items=e.concat(new Array(r)),It(n)},s.prototype.getState=function(t){var n=this,e=n.items,i,i=n.direction(),r=-1;return 0===i?r=t.start-1:1===i&&(r=t.end+1),(i=r<0?n.head:r<Y(e)?e[r]:n.tail)&&i.collapsed?1:0},s.prototype.q2t=function(t,n){var e=this,i=e.items;t<0?(e.head||(e.head=new j),e.head.level=n):t<Y(i)?(i[t]||(i[t]=new j),i[t].level=n):(e.tail||(e.tail=new j),e.tail.level=n),It(e)},s.prototype.suspendAdding=function(){this.T2t++},s.prototype.resumeAdding=function(){this.T2t--},s.prototype.createRangeGroup=function(){for(var t,n,e,i,r,o,a,t=this,n=t.items,e=Y(t.items),i=new g(t,0,e-1,-1),r=0;r<e;)n[r]&&(n[r].groupInfo=I),r++;for(r=0;r<e;)n[r]?(a=(o=St(t,r,0)).g,r=o.index+1,a&&-1<a.level&&i.addChild(a)):r++;return i},s.prototype.$2t=function(t,n){return 1===this.direction()?n===t.end+1:n===t.start-1},s.prototype.tpt=function(t,n,e,i){var r=this,o=-1,a=0;if(1===r.direction()&&(o=0,a=1),t===n)return r.$2t(t,e)||r.$2t(t,i)?{start:t.start,end:t.end,level:t.level}:{start:e,end:i,level:t.level};for(;t.level>n.level;){if(n===t.parent)return r.$2t(n,i)?{start:n.start,end:n.end,level:n.level}:{start:t.start+o,end:i,level:t.level-1};t=t.parent}for(;t.level<n.level;){if(t===n.parent)return r.$2t(t,e)?{start:t.start,end:t.end,level:t.level}:{start:e,end:n.end+a,level:n.level-1};n=n.parent}for(;0<=t.level;){if(t.parent===n.parent)return{start:t.start+o,end:n.end+a,level:n.level-1};t=t.parent,n=n.parent}return{start:t.start+o,end:n.end+a,level:n.level-1}},s.prototype.npt=function(t){var n,e,i,n,r,o,n=this,e=n.items,i=e[t],n=1===n.direction()?e[t-1]:e[t+1],r,o;return(i?i.level:-1)<(n?n.level:-1)?n&&n.groupInfo:i&&i.groupInfo},s.prototype.lB=function(t,n){var e,i,r,o,e,e=this,i=e.npt(t),r=e.npt(t+n-1);if(k(i)&&k(r))return{start:t,end:t+n-1,count:n,level:-1};if(!i||!r){for(o=i||r;o&&-1!==o.level;)o=o.parent;i=i||o,r=r||o}return(e=e.tpt(i,r,t,t+n-1)).count=e.end-e.start+1,e},s.prototype.kB=function(t,n){for(var e,i,r,o,e,e,e=this,i=e.items,r=t;r<t+n;r++)if(o=i[r]&&i[r].groupInfo&&i[r].groupInfo.level,!k(o)&&0<=o)return!0;return e=i[e=1===e.direction()?t-1:t+n]&&i[e].groupInfo&&i[e].groupInfo.level,!k(e)&&0<=e},s.prototype.ept=function(t){var n,e,e,n,e=this.items,e=e[t]&&e[t].groupInfo&&e[t].groupInfo.level;return k(e)?-1:e},s.prototype.ipt=function(t,n,e){for(var i,r,o,a,u,i=this,r=[],o=[],a=t;a<t+n;a++)(u=i.ept(a))===e&&o.push(a),i.ept(a+1)<e&&0<o.length&&(r.push(o),o=[]);return 0<o.length&&r.push(o),r},s.prototype.hB=function(t,n){var e,i,r,o,a,e=this;if(1===n)return e.ipt(t.start,t.count,t.level);for(i=[],r=e.getMaxLevel(),o=2===n?t.level+1:t.level,a=r;o<=a&&-1<=a;a--)i=i.concat(e.ipt(t.start,t.count,a));return i},s.prototype.vB=function(t,n,e){for(var i,r,o,a,i=this,r=t.length-1;0<=r;r--)(o=t[r]).collapse&&i.setCollapsed(o.head,!1),i.ungroupRange(o.start,o.count);for(r=t.length-1;0<=r;r--)o=t[r],a=v.hD(n,o.head)+e,1===i.direction()?i.group(a-o.count,o.count):i.group(a+1,o.count),o.collapse&&i.setCollapsed(a,o.collapse)},s.prototype.dB=function(t,n,e){var i,r,o,a,e,u,s,c,f,l,h,d,i=this,r=i.items;if(1===e)for(o=i.getMaxLevel(),a=n.level+1;a<=o;a++)t.splice.apply(t,y([0,0],i.ipt(n.start,n.count,a),!1));else 2===e&&t.push.apply(t,i.ipt(n.start,n.count,n.level));for(u=t[(e=t.length)-1].concat([]),s=[],a=e-2;0<=a;a--)f=(c=r[t[a][0]]).groupInfo,1===i.direction()?(l=f.end+1,h=v.hD(u,l),u.splice.apply(u,y([h,0],t[a],!1)),s.push({head:l,start:f.start,count:l-f.start,collapse:c.viewCollapsed})):(l=f.start-1,h=v.hD(u,l),u.splice.apply(u,y([h+1,0],t[a],!1)),s.push({head:l,start:f.start,count:f.end-l,collapse:c.viewCollapsed}));for(d=!1,a=0;a<n.count;a++)if(u[a]!==a+n.start){d=!0;break}return{array:u,isChanged:d,groupSwap:s}},s.prototype.isGroupEnd=function(t,n){var e,i,r,e,e,i,r,o,t,e=this,i=e.items,r=t+1;return!a(e,r)||!(e=i[r])||(r=!1,(e=e.level)<(i=i[t].level)&&0<=(t=i-n)&&t<(o=i-e))||r},s.prototype.hitTest=function(t,n,e){return mt.call(t,n,e)},s.prototype.getBtnRectangle=function(){var t,n,e,i,r,o,a,t,u,i,e,s,c,f,r,l,h,d,v,t,t=this.Mf,n=this.v2t,e=t.Fi(),i=t.options,r=i.sheetAreaOffset,o=n?e.qC:e.XC,a=t.gj(),t=n?a.rowMaxLevel:a.colMaxLevel,u=n?a.width:a.height,i=n?i.colHeaderVisible:i.rowHeaderVisible,e=n?e.LA-r.top:e.BA-r.left,s=2,c=t+2,f=U(0,(u-4)/c),r=o-f,l=[];if(f&&i&&0<=r)for(h=U(0,e+r/2),d=2,n&&(t=h,h=d,d=t),v=0;v<c;v++)l.push({x:a.x+h,y:a.y+d,width:f,height:f}),n?h+=f:d+=f;return l},s.prototype._e=function(t,n,e,i){var r,o,a,u,s,u,o,c,s,f,l,h;if(!this.Oy()&&(r=t.gj(),o=t.Fi(),a=t.Jt,u=r.width,s=r.height,u||s)){if(u=i?u:o.width,o=i?o.height:s,c=i?r.rowMaxLevel:r.colMaxLevel,s=i?a.kl:a._l,n.save(),n.beginPath(),!e||e.intersect(r.x,r.y,u,o))for(h=l=void 0,(f=new it(t,i,c)).D2t(n),l=s.call(t.Jt,function(){return pt(t,i,c)}),h=0;h<=2;h++)l[h].F2t(n);n.beginPath(),n.restore()}},s.prototype.rpt=function(t,n){var e;n&&((e=n.what)===d||e===K?lt(t,n):e!==m&&e!==X||ht(t,n))},s.prototype.Oy=function(){return this.x2t},s.prototype.Ry=function(){var t=parseInt(z(W).borderTopWidth,10);return isNaN(t)?2:t},s.prototype.fromJSON=function(t,n){var n,e,i,r,n,o,a,t,u,s,c,f,l,h,d,n=n&&n.ignoreStyle;if(t&&!n){if(i=(e=this).items,r=t.items,n=t.itemsData,o=t.direction,a=t.head,t=t.tail,f=[],k(o)||e.direction(o),a&&(e.head=a),t&&(e.tail=t),l=!1,r&&0<r.length)for(d=0;d<r.length;d++)k(r[d])||(h=new j(r[d]),e.direction()===ot.forward&&(l=!!h.viewCollapsed||l&&!(h.collapsed=!0)),i[d]=h,e.x2t=!1);else x(n,function(t,n){if(u=n.index,s=n.info,0<=u&&s){for(c=0;c<n.count&&!(u+c>=Y(i));c++)n.info.collapsed&&f.push(n),i[u+c]=new j(s);e.x2t=!1}});for(E(e,!0),d=0;d<f.length;d++)e.K2t(f[d].index,!0)}},s.prototype.toJSON=function(t){var t,t,n,e,i,r,o,a,u,t,s,t=t&&t.ignoreStyle;if(!t){for(n=[],e=(t=this).items,r=-1,o=[],i=0;i<Y(e);i++)a=n[r],(u=e[i])&&(o[i]={level:u.level,collapsed:u.collapsed,viewCollapsed:u.viewCollapsed},0<=r&&i===a.count+a.index&&u.level===a.info.level&&u.collapsed===a.info.collapsed?n[r].count++:n[++r]={index:i,count:1,info:{level:u.level,collapsed:u.collapsed}});return t={items:o,itemsData:n,direction:t.direction(),head:t.head,tail:t.tail},s={},x(t,function(t,n){At(t,n)||(s[t]=n)}),c.isEmptyObject(s)?w:s}},i=s,(f.Outline=i).prototype.direction=T("direction",1),e.Outline=i,c.extend(N.Y8.prototype,{m2t:function(t,n){var e,i,e=this,i=e.G8;i&&(i.originalOutlines||(i.originalOutlines=[]),!t||!n&&i.originalOutlines[0]?t||!n&&i.originalOutlines[1]||(i.originalOutlines[n?3:1]=jt(e.opt)):i.originalOutlines[n?2:0]=jt(e.apt))},upt:function(t,n,e){var i,n,i=this;void 0!==n&&(this.Mf.outlineColumn.NB=n),t&&((n=t[e?2:0])&&Ot(i.apt,n),n=t[e?3:1])&&Ot(i.opt,n)}}),N.Y8.ch(P,{init:function(){var t=this,n=t.Mf;t.opt=new i(t.getColumnCount(),n,!1),t.apt=new i(t.getRowCount(),n,!0)},applyChanges:function(t){var n,e,t,i,n,e=t.changes,t=t.isUndo,i=e&&e.originalOutlines;(i||e.oldOptions)&&this.upt(i,e.oldOptions,!t)},undo:function(t){var n=t.originalOutlines;(n||t.oldOptions)&&(this.upt(n,t.oldOptions),this.Mf.zw())},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&(n.opt&&(n.opt.L0(),n.opt=I),n.apt)&&(n.apt.L0(),n.apt=I)}}),N.Worksheet.ch(P,at={init:function(){var r=this;r.rowOutlines=r.Ut.apt,r.columnOutlines=r.Ut.opt,r.rowOutlines.groupChangeHandler=function(t){var t,n,n,e,i,n,t=t&&t.indexes;t&&r.recalcRows&&(n=r.getCalcService())&&!n.IsSuspended()&&r.recalcRows(t),(n=r.parent)&&r!==n.getActiveSheet()||r.iP(),n=t?(e=t[0],i=t[t.length-1],!0):(e=0,i=r.getRowCount()-1,!1),N.Worksheet.et(r,"onGroupChanged",{start:e,end:i,isRow:!0,fromSetCollapsed:n})},r.columnOutlines.groupChangeHandler=function(t){var n,n,e,i,t,n=r.parent;n&&r!==n.getActiveSheet()||r.rP(),t=(n=t&&t.indexes)?(e=n[0],i=n[n.length-1],!0):(e=0,i=r.getColumnCount()-1,!1),N.Worksheet.et(r,"onGroupChanged",{start:e,end:i,isRow:!1,fromSetCollapsed:t})},r.$L.push(r.rowOutlines),r.nF.push(r.columnOutlines)},dispose:function(t){var n=this;!1!==t.clearCache&&(n.rowOutlines&&(n.rowOutlines.groupChangeHandler=I),n.columnOutlines)&&(n.columnOutlines.groupChangeHandler=I),c(n.Dg()).unbind("mousedown.group")},setHost:function(t){var e;t&&(e=this,t.bind("mousedown.group",function(t){var n,t,n,n=e.uw(),t=mt.call(e,t.pageX-n.left,t.pageY-n.top);t&&((n=t.what)===m||n===d?e.rowOutlines.rpt(e,t):n!==X&&n!==K||e.columnOutlines.rpt(e,t))}))},preProcessMouseDbClick:function(t){var n=this;k(n.sw)||k(n.sw.outlineHitInfo)||(t.r=!0)},onPaintSuspend:function(t){var n=this;t.suspend?(n.rowOutlines.Xst(),n.columnOutlines.Xst()):(n.rowOutlines.$st(),n.columnOutlines.$st())},beforeLayoutChanged:function(t){var n,e;"invalidateLayout"===t.changeType&&(this.k2t=I)},onLayoutChanged:function(t){var n,e,i,r,o,a,t,u,s,c,f,n=this,e=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,t=t.sheetArea,u=n.rowOutlines,s=n.columnOutlines,c=k(t)||3===t,f=this.Ut;"addRows"===e&&c?(f.m2t(!0),Mt(u,i,r),f.m2t(!0,!0)):"deleteRows"===e&&c?(f.m2t(!0),Ct(u,i,r),f.m2t(!0,!0)):"addColumns"===e&&c?(f.m2t(!1),Mt(s,o,a),f.m2t(!1,!0)):"deleteColumns"===e&&c?(f.m2t(!1),Ct(s,o,a),f.m2t(!1,!0)):"invalidateLayout"===e?n.k2t=I:"setColumnCount"===e?(f.m2t(!1),3!==t&&1!==t||s.X2t(a),f.m2t(!1,!0)):"setRowCount"!==e||3!==t&&2!==t||(f.m2t(!0),u.X2t(r),f.m2t(!0,!0))},paint:function(t){var n,t,e,i,r,n=t.ctx,t=t.clipRect,e=this,i=e.rowOutlines,r=e.columnOutlines;i&&i._e(e,n,t,!0),r&&r._e(e,n,t,!1)},fromJson:function(t,n,e){var i,r,o,a,o,a;t&&(i=this,r=void 0,o=t.showRowRangeGroup,a=t.showColumnRangeGroup,o=u(o)?o:t.showRowOutline,a=u(a)?a:t.showColumnOutline,k(o)||i.showRowOutline(o),k(a)||i.showColumnOutline(a),(r=t.rowRangeGroup||t.rowOutlines)&&i.rowOutlines.fromJSON(r,e),r=t.colRangeGroup||t.columnOutlines)&&i.columnOutlines.fromJSON(r,e)},toJson:function(t,n){var e,i,r,o,o,e=this,i=e.rowOutlines,r=e.columnOutlines,o=e.showRowOutline();!0!==o&&(t.showRowOutline=o),!0!==(o=e.showColumnOutline())&&(t.showColumnOutline=o),t.rowOutlines=i?i.toJSON(n):w,t.columnOutlines=r?r.toJSON(n):w},wh:function(t,n,e){var e,e,i,r,o,o,e,o,e,o,a,u,a,s,c,f,l,h,d,v,m,g,p,b,e=e&&!1===e.includeStyles;if(!e){for(i=(e=this).rowOutlines,r=e.columnOutlines,!0!==(o=e.showRowOutline())&&(t.lossless.showRowOutline=o),!0!==(o=e.showColumnOutline())&&(t.lossless.showColumnOutline=o),0!==i.direction()&&0!==r.direction()||((e=_(t,q))||t.c_.push(e={n_:q,c_:[]}),e.c_.push(o={n_:"outlinePr"}),0===i.direction()&&(o.summaryBelow="0"),0===r.direction()&&(o.summaryRight="0")),e=_(t,N.XFileConstants._u),o=i.getMaxLevel(),a=-1!==(a=r.getMaxLevel())?a+1:w,e.outlineLevelRow=u=-1!==o?o+1:w,e.outlineLevelCol=a,s=t.tempCols,c=r.items,f=e.defaultColWidth,l=0;l<c.length;l++)(h=c[l])&&(d=h.viewCollapsed,"1"!==(v=s[l]||{width:f,hidden:w,collapsed:w,outlineLevel:w}).hidden&&!d||(v.hidden="1"),!0===h.collapsed&&(v.collapsed="1"),-1!==h.level&&(v.outlineLevel=h.level+1),s[l]=v);for(m=_(t,$),g=i.items,l=0;l<g.length;l++)(p=g[l])&&(d=p.viewCollapsed,(b=m[l]||{}).v===w&&!1===d&&(b.v=0),b.f=!0===p.collapsed?1:0,b.l=p.level+1,m[l]=b)}},yh:function(t,n,e){var i,i,r,i,o,u,r,r,r,s,c,a,f,l,h,d,v,m,g,p,b,w,y,M,C,S,S,y,y,T,A,I,x,i=e&&!1===e.includeStyles;if(!i&&(t.lossless&&(i=t.lossless.showRowOutline,r=t.lossless.showColumnOutline,k(i)||this.showRowOutline(i),k(r)||this.showColumnOutline(r)),o=(i=this).rowOutlines,u=i.columnOutlines,(r=L(t,q+"&outlinePr"))&&("0"===r.summaryBelow&&o.direction(0),"0"===r.summaryRight)&&u.direction(0),(r=(r=_(t,N.XFileConstants.Eu))&&r.c_)&&0<r.length&&(s=u.items,c=i.getColumnCount(),r.forEach(function(t){var n,e,i,r,o,a;if((0<t.outlineLevel||!k(t.collapsed))&&(u.x2t=!1,n=t.min-1,e=t.max-1,i=+t.outlineLevel||0,r=et(t.hidden,!1),o=et(t.collapsed,!1),0<=n)&&0<=e)for(e===N.MAX_COLUMN_COUNT-1&&(e=Math.max(c,n)),a=n;a<=e;a++)s[a]=new j({level:i-1,collapsed:o,viewCollapsed:r}),c<a+2&&!(i<=0&&(!s[a-1]||s[a-1]&&s[a-1].level<0))&&(c=a+2)}),c>i.getColumnCount())&&i.setColumnCount(c),a=_(t,$))){for(f=i.Ut.Q_(!0),h=[],d=o.items,v=(l={rowItems:[],itemsData:[]}).rowItems,m=l.itemsData,g=a.rowCount,p=0===o.direction(),b=i.getRowCount(),w=0;w<g;w++)(y=a[w])?(M=!!y.f,(0<(C=+y.l||0)||M)&&(v[w]={level:C-1,collapsed:M},(S=m[m.length-1])&&w===S.index+S.count&&S.info.level===C-1&&S.info.collapsed===M?S.count++:m.push({index:w,count:1,info:{level:C-1,collapsed:M}})),S=!!y.v,y=h[w-1]&&h[w-1].hidden,m&&Rt(l,w,C,p,S,y),((y={}).hidden=S)&&0===C&&(y.visible=!1),h.push(y),!N.Util.ko(e)&&!p&&b<+w+2&&(0<C||M)&&(b=+w+2)):h.push({});if(Et(l,a,h,o.direction(),f),T=!1,A=void 0,I=[],v&&0<v.length)for(x=0;x<v.length;x++)k(v[x])||(A=new j(v[x]),o.direction()===ot.forward&&(T=!!A.viewCollapsed||T&&!(A.collapsed=!0)),d[x]=A,o.x2t=!1);for(E(o,!0),x=0;x<I.length;x++)o.K2t(I[x].index,!0);for(b>i.getRowCount()&&i.setRowCount(b),x=0;x<h.length;x++)!1===h[x].visible&&f.R8.push(x)}}}),N.Workbook.ch(P,ut={init:function(){M.Commands.g2t(this.commandManager())},onCultureChanged:function(){(0,f.getSR)()}})},"./dist/plugins/group/group.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/group/group.res.en.js");n.SR={en:e}},"./dist/plugins/group/group.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_GROUP_PROTECTED=n.Exp_GroupInfoIsNull=n.Exp_InvalidLevel=n.Exp_InvalidCount=n.Exp_InvalidIndex=void 0,n.Exp_InvalidIndex="Invalid index",n.Exp_InvalidCount="Invalid count",n.Exp_InvalidLevel="Invalid level",n.Exp_GroupInfoIsNull="groupInfo is null",n.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/hyperlink/hyperlink.js":function(F,t,n){"use strict";var e,b,f,l,u,i,w,a,n,r,y,o,h,L,d,B,s,c,M,P,v,m,g,G,U,H,V,z,Y,Z,W,Q,J,K,p,X,q,C,S,T,A,I,x,$,N,k,tt,nt,et,it,rt,ot,at,_,t,ut,st;function D(t,n){return ut.call(this,t,n)||this}function j(t,n){return st.call(this,t,n)||this}function O(t,n,e,i){return y(i)&&(i=3),!y(t.getHyperlink(n,e,i))}function ct(){var t=i(q);return a(t).css(g,G).css(U,0).css(Y,2).css(Z,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(W,K).css(J,X).css(H,"9pt Arial"),t}function ft(t,n,e){var i,r,o,i,r,o,e;e&&(r=(i=t&&t.qc()).getElementsByClassName(C)[0],o=!1,y(r)&&((r=ct()).className=C,i.insertBefore(r,s),o=!0),i=a(r),!o&&i.isVisible()||(i.text(e),o=(r=t.rt.it()).left+n.x,e=r.top+n.y+20,i.css(z,e).css(V,o),i.show()))}function E(t){var n,t,n,t=(t&&t.qc()).getElementsByClassName(C)[0];y(t)||a(t).hide()}function lt(t,n){y(n)||(n.drawUnderline&&(y(t.textDecoration)?t.textDecoration=1:0!==t.textDecoration&&1!=(1&t.textDecoration)&&(t.textDecoration+=1)),n.isVisited?n.visitedLinkColor===s?t.foreColor="rgba(0,0,0,0)":n.visitedLinkColor===d?t.foreColor=T:t.foreColor=n.visitedLinkColor:y(n.linkColor)?n.linkColor===d&&(t.foreColor||t.foreColor===s)||(t.foreColor=S):t.foreColor=n.linkColor)}function R(t){if(t&&t.cellType){var t=t.cellType.typeName;if(!at[t])return 1}}function ht(t,n,e,i,r,o,a){var u,s,c,t,a,u=0,s=0,c=t.width,t=t.height,a=dt(a);return a&&(c-=a),u=o=o||0,1===i?u=(c-n)/2:2===i?u=c-n-o:5===i&&(u=(c-n)/2),1===r?s=(t-e)/2:2===r&&(s=t-e),a&&(u+=a),{x:u,y:s}}function dt(t){var n={context:t,value:0};return r.et(t.sheet,"getOutlineColumnOffset",n),n.value}function vt(t,n){var e,t,e=wt(n),t=t-3-e;return 5===n.hAlign&&(t-=e),--t}function mt(t,n,e,i){var n,e,n=vt(n,e),e=b.q.Gge(t);return 1===e.length&&0===e[0].prefixSpaceCount?c(0,b.q.Wt(e[0].word,i,!0)):n}function gt(t,n,e,i){var r,o,a,r=u(n),o,a;return{x:0,y:0,width:5===e.hAlign?mt(t,i,e,n):c(0,b.q.Wt(t,n,!0)),height:t.split(/\r\n|\r|\n/).length*r}}function pt(t,n,e,i,r,o){var t,e,t=gt(t,e,n,i.width),e=ht(i,t.width,t.height,n.hAlign,n.vAlign,r,o);return t.x=e.x,t.y=e.y,t}function bt(t,n,e,i,r,o){var a,u,a,s,c,f,l,u,a,u,a,h,d,v,m,g,p,u=r.sheet,a=u.Dn;if(!y(e)){if(e.textOrientation)return!0;if(s=u.getValue(r.row,r.col,r.sheetArea),o=o||u.getText(r.row,r.col,r.sheetArea))for(o=o.replace(/\s+/g," "),c=e&&e.font?e.font:a.Nn(),c=a._n(c),f=[o],l=wt(e),u=null!=(a=u.outlineColumn.xme)?a:0,!e.wordWrap&&5!==e.hAlign||(a=i.width-3-l-u,5===e.hAlign&&(a-=l),o=(f=b.q.un(o,a,c)).join("\r\n")),3===(u=e.hAlign)&&(u=w(u,s,e.formatter||e._autoFormatter),e.hAlign=u),a=pt(o,e,c,i,l,r),h=i.y+a.y,d=0;d<f.length;d++)if(v=pt(f[d],e,c,i,l,r),m=i.x+v.x,g=M(m+v.width,i.x+i.width),h=M((p=h)+v.height,i.y+i.height),m<=t&&t<g&&p<=n&&n<h)return!0}return!1}function wt(t){return 8*(t.textIndent||0)}e=this&&this.__extends||(_=function(t,n){return(_=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}_(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkTargetType=void 0,b=n("Core"),f=n("Common"),l=n("SheetsCalc"),u=b.mt.vt,i=b.mt.En,w=b.mt.gt,a=b.GC$,n=b.Commands.ActionBase,r=b.CellTypes.Base,y=f.Common.lt.ht,o=f.Common.lt.tv,h=f.Common.zf.TY,L=f.Common.ft,d=void 0,B=16,s=null,c=Math.max,M=Math.min,P=Math.floor,v=window.open,m=f.Common.zf.fJ,g="position",G="absolute",U="margin",H="font",V="left",z="top",Y="padding",Z="border",W="box-sizing",Q="pointer",J="background-color",K="content-box",p="default",X="white",q="div",C="gc-spread-hyperlink-tooltip",T="followedHyperlink",A=S="hyperlink",I="openUrl",x="generateHyperlink",$=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,N=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,k=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,(t=tt=t.HyperlinkTargetType||(t.HyperlinkTargetType={}))[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top",b.GC$.extend(b.Y8.prototype,{getHyperlink:function(t,n,e){var i,r,r;return r={row:t,col:n,sheetArea:e=y(e)?3:e,isLinkGet:!1,hyperlink:d},b.Y8.et(i=this,"getHyperlink",r),r.isLinkGet||(r=i.W_(e).J_(t,n))&&!y(r.hyperlink)?r.hyperlink:s},setHyperlink:function(t,n,e,i){var r,o,a,u,u,s,o,c,r=this;if(y(i)&&(i=3),(o=e&&e.url)&&o.match(k)&&0<o.match(k).length?m(o,a="www.")&&(e.url="http://"+o):o&&o.match(N)&&0<o.match(N).length&&(m(o,u="mailto:")||(e.url=u+o)),u=0<r.P8?[["sheetModels",i],d]:d,s=r.W_(i).J_(t,n,!0,u?u[0]:d),y(s))u&&(u.length=0);else{if(o=s.hyperlink,y(e))s.hyperlink=null,delete s.hyperlink;else for(c in s.hyperlink={url:"",linkColor:d,visitedLinkColor:d,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)e[c]!==d&&(s.hyperlink[c]=e[c]);u&&(u[0].push("hyperlink"),u[1]=o,u[2]=s.hyperlink)}u&&0<u.length&&r.G8.push(u)}}),b.GC$.extend(b.Worksheet.prototype,{getHyperlink:function(t,n,e){var i,r;return 0===e?s:(y(e)&&(e=3),r=(i=this).Ut,o(r.getHyperlink(t,n,e)))},setHyperlink:function(t,n,e,i){var r,o,a,u;0===i||(y(i)&&(i=3),a=(o=(r=this).Ut).getRowCount(i),u=o.getColumnCount(i),t<0)||a<=t||n<0||u<=n||(o.do("setHyperlink",t,n,e,i),this.zw())}}),e(D,ut=n),D.prototype.execute=function(){var t,n,e,i,r,o,t,a,a,a,u,a,u,s,s,s,s,c,r,t=this,n=t.Mf,e=!1,i=n.parent,r=n,o=t.tT.url;if(!y(o))if(t=t.tT.target||0,0===o.indexOf(a="sjs://")||"#"===o[0]){if(a=a.length,a="#"===o[0]?o.substr(1):o.substr(a),(u=(u=(0,l.formulaToRanges)(n,a,0,0,!(u=void 0)))&&0===u.length?(0,l.formulaToRanges)(n,a,0,0,!1,!0):u)&&0<u.length){if(a=u[0].sheetName,u=u[0].ranges[0],a!==n.name()&&i.getSheetFromName(a).visible()===b.SheetTabVisible.visible){if(s=i.getSheetFromName(a),i.ki(b.Events.ActiveSheetChanging,s={oldSheet:r,newSheet:s,cancel:!1}),s.cancel)return;i.setActiveSheet(a),s=i.getActiveSheetIndex(),i.w2.Tg(s),r!==(n=i.getActiveSheet())&&i.ki(b.Events.ActiveSheetChanged,{oldSheet:r,newSheet:n})}i.getSheetFromName(a).visible()===b.SheetTabVisible.visible&&(n.OA(u.row,u.col),n.setSelection(u.row,u.col,u.rowCount,u.colCount))}}else y(o)||(s="mailto:",o.match(k)&&0<o.match(k).length?m(o,c="www.")&&(o="http://"+o):o.match(N)&&0<o.match(N).length&&(m(o,s)||(o=s+o)),m(o,s)&&1<f.Common.zf.DU(o,"?")&&(o=(r=o.split("?"))[0]+"?"+r.slice(1).join("%3F")),v(h(o),["_blank","_self","_parent","_top"][t]));return!1},nt=D,b.Commands[I]={canUndo:!1,execute:function(t,n,e){return b.Commands.zA(t,nt,n,e)}},e(j,st=n),j.prototype.execute=function(){var t,n,e,i,r,o,e,a,u,u,t=this,n=t.Mf,e=t.tT,i=e.url,r=e.row,o=e.col,e=e.sheetArea;if(null===i)a=null;else{if("string"!=typeof i)return!1;if(!((u=(!(u=i.match(k))||u.length<1)&&(!(u=i.match(N))||u.length<1)?i.match($):u)&&0<u.length&&0===i.indexOf(u[0])&&i.length===u[0].length))return!1;a={url:i,linkColor:S,visitedLinkColor:T}}return n.Ut.startTransaction(),n.suspendPaint(),n.suspendEvent(),n.setHyperlink(r,o,a,e),n.resumeEvent(),n.resumePaint(),u=b.Commands.TI(n.name()),t.tT[u]=n.Ut.endTransaction(),!0},j.prototype.undo=function(){var t,n,e,t,n=this.Mf;return n.suspendPaint(),n.suspendEvent(),e=b.Commands.TI(n.name()),n.Ut.undo(this.tT[e]),n.resumeEvent(),n.resumePaint(),!0},et=j,b.Commands[x]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,et,n,e)}},b.Workbook.ch(A,it={init:function(){this.commandManager().register(I,b.Commands[I]),this.commandManager().register(x,b.Commands[x])}}),b.Worksheet.ch(A,rt={setHyperlinkWhenEditing:function(t){var n,e,i,t,r,o,n=t.url,e=t.row,i=t.col,t=t.sheetArea,r=this,o=r.getParent();o.options.allowAutoCreateHyperlink&&o.commandManager().execute({cmd:x,sheetName:r.name(),url:n,row:e,col:i,sheetArea:t})}}),r.ch(A,ot={applyHyperlinkStyle:function(t){var n,e,i,r,n,n=t.sheet,e=t.row,i=t.col,r=t.style,n=n.getHyperlink(e,i,t.sheetArea);R(r)||lt(r,n)},getCellTextHitInfo:function(t){var n,e,i,r,o,a,u,s,c,f,l,f,n=t.context.sheetArea,e=t.cellStyle,i=t.context,r=i.sheet,o=i.row,a=i.col;O(r,o,a,n)&&!R(e)&&((u=t.cellRect)&&(s=r.C0(o),c=r.S0(a),f=r.Fi(),l=void 0,r.getSpan(o,a,n)||!y(n)&&3!==n?2===n?l=f.B1(s):1===n&&(l=f.L1(c)):l=f.c9(s,c),l)&&(u=u.getIntersectRect(l)),!y(n)||3===n)&&e&&u&&(f=r.getText(o,a,n),t.paddingHitInfo={row:o,col:a,x:t.x,y:t.y,sheetArea:n,sheet:r,isFocusAware:!0,isReservedLocation:bt(t.x,t.y,e,u,i,f)})},processMouseUpOnCellPadding:function(t){var n,e,i,r,o,e,t,e,t,e,n=t.sheet,e=t.cellStyle,i=t.row,r=t.col,o=t.sheetArea;n&&!n.isEditing()&&O(n,i,r,o)&&!R(e)&&t.isReservedLocation&&(e=n.Dg(),E(n),e&&(e.style.cursor=p),(t=n.Ut.getHyperlink(i,r,o)).isVisited=!0,e=t.command,y(e)||""===e||e===I?n.getParent().commandManager().execute({cmd:I,sheetName:n.name(),url:t.url,target:t.target}):"string"==typeof e?n.getParent().commandManager().execute({cmd:e,row:i,col:r,sheetName:n.name(),sheetArea:o}):"function"==typeof e&&e.call(s,n,i,r,o),t=n.getColumnCount(),e=new b.Range(i,-1,1,t),n.repaint(n.getRangeRect(1,1,e)))},processMouseMoveOnCellPadding:function(t){var n,e,i,r,o,r,n,n=t.row,e=t.col,i=t.sheet,r=t.cellStyle,o=t.sheetArea;!O(i,n,e,o)||R(r)||!i||i.isEditing()&&i.getActiveRowIndex()===n&&i.getActiveColumnIndex()===e||(r=i.Dg(),n=i.getHyperlink(n,e,o),t.isReservedLocation?r&&(ft(i,t,n.tooltip),r.style.cursor=Q):(E(i),r&&(r.style.cursor=p)))},processMouseLeaveOnCellPadding:function(t){var n,e,i,t,e,n=t.sheet,e=t.row,i=t.col,t=t.sheetArea;E(n),O(n,e,i,t)&&n&&(e=n.Dg())&&(e.style.cursor=p)},onUpdateContainer:function(t){var n,e,i,t,n=t.cellStyle,e=t.context.row,i=t.context.col,t=t.context.sheet.getHyperlink(e,i);R(n)||lt(n,t)}}),at={0:!0,1:!0,2:!0,3:!0,4:!0}},"./dist/plugins/inputMask/inputMask.entry.js":function(t,n,e){"use strict";var i,r,o,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.getNamedPatterns=n.namedPattern=n.validatePattern=n.IMCD=void 0,r(e("./dist/plugins/inputMask/integrate.js"),n),o=e("./dist/plugins/inputMask/inputMask/inputMask.js"),r(e("./dist/plugins/inputMask/inputMask/inputMask.ns.js"),n),n.IMCD=o.InputMask,n.validatePattern=o.InputMask.validatePattern,n.namedPattern=o.InputMask.namedPattern,n.getNamedPatterns=o.InputMask.getNamedPatterns},"./dist/plugins/inputMask/inputMask/common.js":function(t,n){"use strict";var o,e,i;function r(t){if("string"==typeof t){if("true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1}return!0===t}function a(t,n,e){var i,r;if(!(e>=t.length))for(i=e;i<t.length;i++)for(r=0;r<n.length;r++)if(t.charAt(i)===n[r])return i;return-1}function u(t,n,e,i){if(n<=0)return"";var r=String(t);if(e!==o)for(;r.length<n;)i?r+=e:r=e+r;else for(;r.length<n;)r+=String(t);return r}function s(t){return t%400==0||t%4==0&&t%100!=0}function c(t,n){if(12<n)t+=parseInt((n/12).toString(),10),n%=12;else if(n<0)return 31;switch(n){case 2:return s(t)||t<0?29:28;case 4:case 6:case 9:case 11:return 30}return 31}function f(){this.OtherChar=0,this.Control=1,this.Numeric=2,this.MathSymbol=3,this.Symbol=4,this.Punctuation=5,this.Space=6,this.UpperCase=7,this.LowerCase=8}function l(){this.Ctype=new e}Object.defineProperty(n,"__esModule",{value:!0}),n.CharProcess=n.CharType=n.daysInMonth=n.fillString=n.indexOfAny=n.checkBool=n.markers=void 0,o=void 0,n.markers={group:["(",")"],groupSeparator:"|",quantifier:["{","}"],quantifierSeparator:",",optional:["[","]"],letter:"a",number:"0",upper:">",lower:"<",escape:String.fromCharCode(92),any:"#",year:"y",month:"M",day:"d",hour:"h",hourIn24:"H",minute:"m",second:"s",range:"-",hourFormat:"t"},n.checkBool=r,n.indexOfAny=a,n.fillString=u,n.daysInMonth=c,e=f,n.CharType=e,l.prototype.getCharType=function(t){var n,e,n=this,e=n.Ctype.OtherChar;return"A"<=t&&t<="Z"?n.Ctype.UpperCase:"a"<=t&&t<="z"?n.Ctype.LowerCase:"0"<=t&&t<="9"?n.Ctype.Numeric:(8216!==t.charCodeAt(0)&&8217!==t.charCodeAt(0)&&8220!==t.charCodeAt(0)&&8221!==t.charCodeAt(0)||(e=n.Ctype.Punctuation),12288===t.charCodeAt(0)?n.Ctype.Space:e)},l.prototype.isLower=function(t){return this.getCharType(t)===this.Ctype.LowerCase},l.prototype.isUpper=function(t){return this.getCharType(t)===this.Ctype.UpperCase},l.prototype.isAlphabet=function(t){return this.isUpper(t)||this.isLower(t)},l.CharEx=new l,n.CharProcess=l},"./dist/plugins/inputMask/inputMask/inputMask.js":function(t,n,e){"use strict";var x,M,C,i,e,e,S,N,e,o,r,a,u,s;function c(t){for(var n,e,i,n=0,e=t.length;n<e;n++)("\\"===(i=t[n])&&"\\"!==t[n+1]||0<=a.indexOf(i)&&"\\"!==t[n-1])&&(t=t.substring(0,n)+"\\"+t.substring(n,e),n++);return t}function f(t){return t===M.markers.letter||t===M.markers.number||t===M.markers.upper||t===M.markers.lower||t===M.markers.group[0]||t===M.markers.optional[0]||t===M.markers.escape||t===M.markers.any||t===M.markers.quantifier[0]||t===M.markers.range||t===M.markers.year||t===M.markers.month||t===M.markers.day||t===M.markers.hourIn24||t===M.markers.hour||t===M.markers.minute||t===M.markers.second||t===M.markers.hourFormat}function T(t,n){for(var e,i,r,o,a,u,s,c,e={result:!1},i=1,r="",o=n.Bse(),a=new C.OptionalRestriction(o);i<t.length-1;){if((u=t[i])===M.markers.escape){if(u=t.charAt(i+1),t[i+2]===M.markers.range&&(!f(t[i+3])||t[i+3]===M.markers.escape)){t[i+3]===M.markers.escape?(s=t[i+4]>u?u:t[i+4],c=t[i+4]>u?t[i+4]:u,a.add(new C.RangeRestriction(s,c,o)),i+=5):(s=t[i+3]>u?u:t[i+3],c=t[i+3]>u?t[i+3]:u,a.add(new C.RangeRestriction(s,c,o)),i+=4);continue}i++,-1===r.indexOf(u)&&(r+=u)}else if(u===M.markers.letter)a.add(new C.RangeRestriction("A","Z",o)),a.add(new C.RangeRestriction("a","z",o));else if(u===M.markers.upper)a.add(new C.RangeRestriction("A","Z",o,x.CaseType.upperCase)),a.add(new C.RangeRestriction("a","z",o,x.CaseType.upperCase));else if(u===M.markers.lower)a.add(new C.RangeRestriction("A","Z",o,x.CaseType.lowerCase)),a.add(new C.RangeRestriction("a","z",o,x.CaseType.lowerCase));else if(u===M.markers.number)a.add(new C.RangeRestriction("0","9",o));else{if(t.length>i+2&&t[i+1]===M.markers.range&&(!f(t[i+2])||t[i+2]===M.markers.escape)){t[i+2]===M.markers.escape?(s=t[i+3]>u?u:t[i+3],c=t[i+3]>u?t[i+3]:u,a.add(new C.RangeRestriction(s,c,o)),i+=4):(s=t[i+2]>u?u:t[i+2],c=t[i+2]>u?t[i+2]:u,a.add(new C.RangeRestriction(s,c,o)),i+=3);continue}if(-1!==r.indexOf(u)){i++;continue}r+=u}i++}return 0<r.length&&a.add(new C.LimitedRestriction(o,r)),e.result=!0,e.restriction=a,e}function A(t,n){var e,i,r,o,a;for(t=t.substring(1,t.length-1),i=e=0;e<t.length;)if(-1===(a=(0,M.indexOfAny)(t,[M.markers.groupSeparator,M.markers.group[1],M.markers.escape,M.markers.group[0]],e))){if(0===(r=t.substring(i)).length)return;n.push(r),e=t.length}else if(t.charAt(a)===M.markers.escape){if((o=t.charAt(a+1))!==M.markers.escape&&o!==M.markers.group[0]&&o!==M.markers.groupSeparator&&o!==M.markers.group[1])return;if((e=a+1)===(t=t.substring(0,a)+t.substring(a+1)).length){if(0===(r=t.substring(i)).length)return;n.push(r)}}else{if(t.charAt(a)!==M.markers.groupSeparator)return;if(0===(r=t.substring(i,a)).length)return;n.push(r),i=e=a+1}return 1}function I(t){var n,e,i,r,o,a,n={min:-1,max:-1,result:!1},e=t.indexOf(M.markers.quantifierSeparator,1);if(-1===e)try{return n.min=+t.substring(1,t.length-1),n.max=n.min,n.result=0<n.max,n}catch(t){return n.result=!1,n}try{return i=t.substring(1,e),r=void 0,r=""===i.trim()?0:+i,n.min=r,o=t.substring(e+1,t.length-1),a=void 0,a=""===o.trim()?Math.pow(2,31):+o,n.max=a,n.result=!(n.min<0||n.max<n.min||0===n.max),n}catch(t){return n.result=!1,n}}function k(t,n){var e,i,r,o,a,u,e={keyLen:0};if(e.keyType=x.KeywordType.unknow,n>=t.length)return e;switch(i=t.charAt(n)){case M.markers.escape:return e.keyLen=2,e.keyType=x.KeywordType.promptChar,e.keyword=t.substring(n+1,n+2),e;case M.markers.any:return e.keyLen=1,e.keyType=x.KeywordType.any,e.keyword=t.substring(n,n+1),e;case M.markers.quantifier[0]:return-1===(r=t.indexOf(M.markers.quantifier[1],n+1))?e.keyword="":(e.keyType=x.KeywordType.quantifier,e.keyLen=r+1-n,e.keyword=t.substring(n,n+e.keyLen)),e;case M.markers.optional[0]:r=n,o=0;do{if(-1===(r=t.indexOf(M.markers.optional[1],r+1)))return e.keyword="",e;for(a=r-1;0<a&&t.charAt(a)===M.markers.escape;a--)o++}while(t.charAt(r-1)===M.markers.escape&&o%2!=0);return e.keyType=x.KeywordType.optional,e.keyLen=r+1-n,e.keyword=t.substring(n,n+e.keyLen),e;case M.markers.group[0]:r=n;do{if(-1===(r=t.indexOf(M.markers.group[1],r+1)))return e.keyword="",e}while(t.charAt(r-1)===M.markers.escape);return e.keyType=x.KeywordType.group,e.keyLen=r+1-n,e.keyword=t.substring(n,n+e.keyLen),e;case M.markers.letter:case M.markers.number:case M.markers.upper:case M.markers.lower:return e.keyLen=1,e.keyType=x.KeywordType.range,e.keyword=i,e;case M.markers.year:case M.markers.month:case M.markers.day:case M.markers.hour:case M.markers.hourIn24:case M.markers.minute:case M.markers.second:case M.markers.hourFormat:for(r=n+1;t.charAt(r)===i;)r++;return e.keyLen=r-n,e.keyType=x.KeywordType.date,e.keyword=t.substring(n,n+e.keyLen),e;default:for(r=n+1;r<t.length&&!f(u=t[r]);r++);return e.keyType=x.KeywordType.promptChar,e.keyLen=r-n,e.keyword=t.substring(n,n+e.keyLen),e}}function _(t,n){return!t[n.uit]&&(t[n.uit]=n,!t[x.RestrictionType.hour24]||!t[x.RestrictionType.hour])&&void 0}function l(t,n){var e=0,i=n.length;2===t.yce&&1===i&&(e=1),t.replace(e,t.length(),n)}function D(t,n,e,i,r,o,a){var u,s,c,f,l;if(o<i){for(c=++o,f=0;o<i;o++)t.zse[o].uit!==x.RestrictionType.prompt&&(e=t.zse[o].delete(e,t.zse[o]._text.length,a));for(l=0;l<c;l++)f+=s=(u=t.zse[l]).length();if(n===f&&u.Jse===u.VUt)for(;c<=i&&(t.zse[c].uit===x.RestrictionType.prompt&&c!==t.DU-1);c++)n+=t.zse[c]._text.length;if(0===r)return n;t.zse[i].uit!==x.RestrictionType.prompt&&t.zse[i].delete(e,r,a)}return n}function j(t){this.Lse=!1,this.Fse=!1;var n=this;n.Hc(t),j.ofe(t.pattern,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.InputMask=void 0,x=e("./dist/plugins/inputMask/inputMask/interface.js"),M=e("./dist/plugins/inputMask/inputMask/common.js"),C=e("./dist/plugins/inputMask/inputMask/restrictions.js"),i=e("Common"),e=e("./dist/plugins/inputMask/inputMask/inputMask.ns.js"),e=new i.Common.ResourceManager(e.SR,"InputMask"),S=e.getResource.bind(e),N=void 0,e=i.Common.lt,o=e.ht,r=e._h,a=["\\","^",".","$","|","(",")","[","]","*","+","?","{","}",","],u=[{type:x.RestrictionType.year,func:function(t,n){var t,e=(t=t.getFullYear().toString()).length,t=n.yce<4?t.substring(e-2,e):t.toString();n.replace(0,n.length(),t)}},{type:x.RestrictionType.month,func:function(t,n){var e;l(n,(t.getMonth()+1).toString())}},{type:x.RestrictionType.day,func:function(t,n){var e;l(n,t.getDate().toString())}},{type:x.RestrictionType.hour,func:function(t,n){var e;l(n,(12<t.getHours()?t.getHours()-12:t.getHours()).toString())}},{type:x.RestrictionType.hour24,func:function(t,n){var e;l(n,t.getHours().toString())}},{type:x.RestrictionType.minute,func:function(t,n){var e;l(n,t.getMinutes().toString())}},{type:x.RestrictionType.second,func:function(t,n){var e;l(n,t.getSeconds().toString())}},{type:x.RestrictionType.hourFormat,func:function(t,n){var e,i=n.getText().length,t,t=1===i?12<t.getHours()?S().hourFormatSingleDesignator[1]:S().hourFormatSingleDesignator[0]:12<t.getHours()?S().hourFormatDesignator[1]:S().hourFormatDesignator[0];n.replace(0,i,t)}}],j.prototype.getValue=function(){for(var t,n,e,i,r,t=this,n="",e=t.Lse,i=0;i<t.DU;i++)r=t.Pse(i),!0===e&&r.uit===x.RestrictionType.prompt||(n+=r.getText());return n=!0===t.Fse?n.replace(new RegExp("\\"+t.Gse,"g"),""):n},j.prototype.Hc=function(t){var n=this;n.Use=0,n.Hse=0,n._text="",n.y4="",n.Gse=t.placeholder&&t.placeholder[0]||"_",n.DU=0,n.zse=[],n.Vse=!0,n.Yse={},n.Lse=t.excludeLiteral,n.Nmt=[],n.kmt=[],n.Fse=t.excludePlaceholder},j.prototype.bh=function(){for(var t,n,e,i,t=this,n=0,e=0;e<t.DU;e++)n+=(i=t.Pse(e)).length();return n},j.prototype.Pse=function(t){return this.zse[t]},j.prototype.Wse=function(t){for(var n,e,i,r,o,a,n=this,e={},i=0,r=0;r<n.DU;r++){if(a=(o=n.zse[r]).length(),t===i&&0===a||i<=t&&t<i+a)return e.index=r,e.offset=t-i,e;i+=a}if(i<=t)return o=n.zse[n.DU-1],e.index=n.DU-1,e.offset=o.length(),e},j.prototype.ZP=function(t){var n=this;t!==N&&(n.zse.push(t),n.Vse=!0,n.DU++)},j.prototype.vfe=function(){var t=this;t.zse=[],t.Yse={},t.DU=0},j.prototype.Bse=function(){return this.Gse},j.prototype.getText=function(t){for(var n,e,i,r,n=this,e="",i=0;i<n.DU;i++)e+=(r=n.Pse(i)).getText();return e=!0===t?e.substring(n.Use,Math.min(n.Hse,e.length)):e},j.prototype.getFirstInputPosition=function(){for(var t,n,e,i,t=this,n=0,e=0;e<t.DU;e++){if((i=t.Pse(e)).uit!==x.RestrictionType.prompt&&i.getStatus()!==x.RestrictionStatus.complete)return n+=i.Jse||0;n+=i.length()}return n},j.prototype.clear=function(){var t=this;return t.Qse(),t.Use=t.Hse=t.getFirstInputPosition(),this},j.prototype.Qse=function(){var t,n,e,t=this;if(0<t.DU)for(n=0;n<t.DU;n++)(e=t.zse[n]).delete(0,e._text.length,!0)},j.prototype.getSelection=function(){var t=this,n=t.getText(),e=t.Hse;return e>n.length&&(e=n.length),{start:t.Use,end:e}},j.prototype.setSelection=function(t){var n,e,t,n=this,e=Math.min(t.start,t.end),t=Math.abs(t.start-t.end);n.Use=e,n.Hse=e+t},j.prototype.undo=function(t){var n,e,i,r,o,a,u,n=this,e=n.Nmt,i=t;if(i||(r=e.pop())&&(i=r.oldState),i){for(n.Use=i.selectionStart,n.Hse=i.selectionEnd,o=n.zse,a=0,u=n.DU;a<u;a++)o[a].undo(i.restrictionsUndoInfo[a]);t||n.kmt.push(r)}},j.prototype.redo=function(){var t,n,e,i,r,o,a,t=this,n,e=t.kmt.pop();if(e&&(i=e.newState)){for(t.Use=i.selectionStart,t.Hse=i.selectionEnd,r=t.zse,o=0,a=t.DU;o<a;o++)r[o].undo(i.restrictionsUndoInfo[o]);t.Nmt.push(e)}},j.prototype.xfe=function(t,n){var e,i,t,r,o,a,e=this,i=e.DU,t={selectionStart:t=t===N?e.Use:t,selectionEnd:n=n===N?e.Hse:n,restrictionsUndoInfo:new Array(i)};if(0<i)for(r=t.restrictionsUndoInfo,o=0;o<i;o++)a=e.zse[o],r[o]=a.saveOldState();return t},j.prototype.addUndoInfo=function(t,n){var e,i;this.Nmt.push({oldState:t,newState:n})},j.namedPattern=function(t,n){if(j.namedPatterns||(j.namedPatterns={}),!o(t)){if(t=c(t),n===N)return j.namedPatterns[t];j.namedPatterns[t]=n}},j.replaceNamedPattern=function(n){return j.namedPatterns||(j.namedPatterns={}),Object.keys(j.namedPatterns).forEach(function(t){o(j.namedPatterns[t])||(n=n.replace(t,j.namedPatterns[t]))}),n},j.getNamedPatterns=function(){j.namedPatterns||(j.namedPatterns={});var e=j.namedPatterns,i=[];return Object.keys(e).forEach(function(t){var n=e[t];o(t)||o(n)||i.push({name:t,pattern:n})}),i},j.validatePattern=function(t){return j.ofe(t)},j.ofe=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,d,v,m,g,p,b,w,y,e={success:!1};if(t){for(n=n||{DU:0,zse:[],Yse:{},Bse:function(){return"_"},Kse:function(t){var n;switch(t.keyword[0]){case M.markers.year:n=x.RestrictionType.year;break;case M.markers.month:n=x.RestrictionType.month;break;case M.markers.day:n=x.RestrictionType.day;break;case M.markers.hour:n=x.RestrictionType.hour;break;case M.markers.hourIn24:n=x.RestrictionType.hour24;break;case M.markers.minute:n=x.RestrictionType.minute;break;case M.markers.second:n=x.RestrictionType.second}if(n)return new C.DateTimeItemRestriction(n,"_",t.keyLen)},ZP:function(t){n.zse.push(t),n.DU++},vfe:function(){n.zse=[],n.DU=0}},o=(r=k(t=j.replaceNamedPattern(t),i=0)).keyword,a=r.keyType,u=r.keyLen,s=x.KeywordType.promptChar,c="",f=x.KeywordType.optional,h=n.Bse();t.length>i;){switch(a){case x.KeywordType.unknow:return n.vfe(),e.message=S().errorMsg.unknownPattern,e;case x.KeywordType.optional:if(!(d=T(o,n)).result)return n.vfe(),e.message=S().errorMsg.invalidOptionalPattern,e;l=d.restriction,s=x.KeywordType.optional;break;case x.KeywordType.group:if(!A(o,d=[]))return n.vfe(),e.message=S().errorMsg.invalidGroupPattern,e;if(1===d.length){s===x.KeywordType.promptChar?c+=d[0]:(c=d[0],s=x.KeywordType.promptChar);break}if(0===d.length)break;(l=new C.EnumRestriction(h)).setItems(d),n.ZP(l),s=x.KeywordType.group,o=(r=k(t,i+=u)).keyword,a=r.keyType,u=r.keyLen;continue;case x.KeywordType.promptChar:s===x.KeywordType.promptChar?c+=o:(c=o,s=x.KeywordType.promptChar);break;case x.KeywordType.quantifier:return n.vfe(),e.message=S().errorMsg.errorQuantifierPattern,e;case x.KeywordType.range:l=new C.OptionalRestriction(h),o===M.markers.letter?(l.add(new C.RangeRestriction("A","Z",h)),l.add(new C.RangeRestriction("a","z",h))):o===M.markers.upper?(l.add(new C.RangeRestriction("A","Z",h,x.CaseType.upperCase)),l.add(new C.RangeRestriction("a","z",h,x.CaseType.upperCase))):o===M.markers.lower?(l.add(new C.RangeRestriction("A","Z",h,x.CaseType.lowerCase)),l.add(new C.RangeRestriction("a","z",h,x.CaseType.lowerCase))):o===M.markers.number&&l.add(new C.RangeRestriction("0","9",h)),s=x.KeywordType.range;break;case x.KeywordType.any:l=new C.AnyCharRestriction(h),s=x.KeywordType.any;break;case x.KeywordType.date:if((l=n.Kse(r))||r.keyword[0]!==M.markers.hourFormat||((l=new C.EnumRestriction(h)).setItems(1===r.keyLen?S().hourFormatSingleDesignator:S().hourFormatDesignator),l.uit=x.RestrictionType.hourFormat),!1===(v=_(n.Yse,l)))return n.vfe(),e.message=S().errorMsg.duplicatedDateTimePattern,e;s=x.KeywordType.date}if(g=m=1,(i+=u)<t.length){switch(o=(r=k(t,i)).keyword,a=r.keyType,u=r.keyLen,a){case x.KeywordType.unknow:return n.vfe(),e.message=S().errorMsg.unknownPattern,e;case x.KeywordType.optional:f=x.KeywordType.optional;break;case x.KeywordType.group:for(p=!0,b=0;b<o.length;b++)if(o[b]===M.markers.groupSeparator&&o[b-1]!==M.markers.escape){p=!1;break}f=p?x.KeywordType.promptChar:x.KeywordType.optional;break;case x.KeywordType.quantifier:if(!(w=I(o)).result)return n.vfe(),e.message=S().errorMsg.invalidQuantifierPattern,e;if(g=w.min,m=w.max,isNaN(g)||isNaN(m))return n.vfe(),e.message=S().errorMsg.invalidQuantifierPattern,e;o=(r=k(t,i+=u)).keyword,a=r.keyType,u=r.keyLen,f=x.KeywordType.quantifier;break;case x.KeywordType.promptChar:f=x.KeywordType.promptChar;break;case x.KeywordType.range:f=x.KeywordType.range;break;case x.KeywordType.any:f=x.KeywordType.any;break;case x.KeywordType.date:f=x.KeywordType.date}if(s===x.KeywordType.promptChar){if(f!==x.KeywordType.promptChar){if(f===x.KeywordType.quantifier)return n.vfe(),e.message=S().errorMsg.errorQuantifierPattern,e;n.ZP(new C.PromptRestriction(c,h))}}else l.init(g,m,(0,M.fillString)(l.getPromptChar(),g),[!1,!1,!1]),l.Jse=0,n.ZP(l)}else s===x.KeywordType.promptChar?n.ZP(new C.PromptRestriction(c,h)):(l.init(1,1),n.ZP(l))}for(y=0;y<n.DU&&n.zse[y].uit===x.RestrictionType.prompt;y++);y===n.DU?(n.vfe(),e.message=S().errorMsg.noEntry):e.success=!0}else e.message=S().errorMsg.emptyPattern;return e},j.prototype.Kse=function(t){var n,e=this;switch(t.keyword[0]){case M.markers.year:n=x.RestrictionType.year;break;case M.markers.month:n=x.RestrictionType.month;break;case M.markers.day:n=x.RestrictionType.day;break;case M.markers.hour:n=x.RestrictionType.hour;break;case M.markers.hourIn24:n=x.RestrictionType.hour24;break;case M.markers.minute:n=x.RestrictionType.minute;break;case M.markers.second:n=x.RestrictionType.second}if(n)return new C.DateTimeItemRestriction(n,e.Gse,t.keyLen)},j.prototype.Xse=function(){var t=this.qse(x.RestrictionType.year);return!(o(t)||3!==t.VUt&&4!==t.VUt)},j.prototype.$se=function(){var t=this.qse(x.RestrictionType.year);return!(o(t)||1!==t.VUt&&2!==t.VUt)},j.prototype.pce=function(){var t,n,t,n,e,i,t=this,n=t.qse(x.RestrictionType.year);return o(n)?x.DateStatus.null:t.Xse()?n.getValue():(t=n.getValue(),n=(new Date).getFullYear(),t!==x.DateStatus.null&&t!==x.DateStatus.inComplete&&(99===t&&(t=100),e=100*parseInt((n/100).toString(),10)+t,i=100*parseInt(((n-99)/100).toString(),10)+t,e<=n&&n-99<=e?t=e:i<=n&&n-99<=i&&(t=i)),t)},j.prototype.setValue=function(t,e){var i,n,i=this;if(i.setSelection({start:0,end:i.bh()}),i.Qse(),void 0===t||""===t||0===t.length)return!0;0!==t.length&&(!o(e)&&e instanceof Date&&!r(i.Yse)?(u.forEach(function(t){var n=i.qse(t.type);n&&t.func(e,n)}),n=i.bh(),i.setSelection({start:n,end:n})):i.paste(t,!0))},j.prototype.qse=function(t){var n,e,i,r,n=this;if(!0===n.Vse){for(e=n.Yse={},i=0;i<n.DU;i++)(r=n.zse[i]).uit!==x.RestrictionType.prompt&&(e[r.uit]=r);n.Vse=!1}return n.Yse[t]},j.prototype.bce=function(){var t,n,e,i,e,t,r,i,t=this,n=t.qse(x.RestrictionType.day),e=t.qse(x.RestrictionType.year),i=t.qse(x.RestrictionType.month);n&&(e=o(e)?x.DateStatus.null:(t.$se()||t.Xse())&&e.getStatus()===x.RestrictionStatus.inComplete?x.DateStatus.inComplete:t.pce(),t=o(i)?x.DateStatus.null:i.getStatus()===x.RestrictionStatus.inComplete?x.DateStatus.inComplete:i.getValue(),r=1,i=(0,M.daysInMonth)(e,t),n.setRange(1,i))},j.prototype.pfe=function(){var t,n,t,n,e,t=this,n=t.qse(x.RestrictionType.hour24),t=t.qse(x.RestrictionType.hourFormat);n&&t&&(n=n.getValue(),e=t.getText().length,12<=n?t.replace(0,e,(1===e?S().hourFormatSingleDesignator:S().hourFormatDesignator)[1]):0<=n&&t.replace(0,e,(1===e?S().hourFormatSingleDesignator:S().hourFormatDesignator)[0]))},j.prototype.bfe=function(t,n,e,i){var r,o,a,u,s,c,f,l,t,h,n,s,u,c,r=this,o;return!(r.DU-1<=t||(a=r.xfe(),u=e-n,c=(s=r.getText()).length,t=(l=(f=r.Pse(t)).getText()).substring(0,n)+i+s.substring(e,s.length),r.setSelection({start:u,end:c}),!1===(h=r.replace(t,!0)).success?(r.undo(a),1):(n=e+i.length,u=(s=r.Wse(n)).index,c=s.offset,u<r.DU-1&&r.zse[u].uit===x.RestrictionType.prompt&&0===c&&(!r.zse[u-1]||r.zse[u-1].satisfy())&&(n+=r.zse[u].length()),r.setSelection({start:n,end:n}),0)))},j.prototype.Eit=function(t,n){var e,i,r,o,a,u,s,e=this,i={};if(i.cursorPos=t,i.text=n,0===e.DU||n===N||""===n||t<0)return i;if(o=(r=e.Wse(t)).index,(a=r.offset)===(u=e.zse)[o].VUt)return i;for(;0!==o&&0===a&&(s=e.zse[o-1]).uit!==x.RestrictionType.prompt&&s._text.length<s.VUt;)if((a=u[--o].Jse)<u[o].yce){if(a=u[o].yce,""===(i=e.wce(o,a,t,n)).text)return i;if(t===a){o++,a=0;break}}return e.wce(o,a,t,n)},j.prototype.wce=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,c,m,r=this,o={},a=t,u=r.DU,s=r.xfe();a<u;a++){if(l=n,!1===(d=(f=r.zse[a]).insert(n,i,h=a===u-1)).success&&n>=f.yce&&r.zse[a+1]&&r.zse[a+1].check(i,0).success&&!0===(v=r.bfe(t,n,e,i)))return{success:!0,cursorPos:r.Use,text:""};if(n!==d.offset&&(f.uit!==x.RestrictionType.year&&f.uit!==x.RestrictionType.month&&f.uit!==x.RestrictionType.day||r.bce(),f.uit===x.RestrictionType.hour24)&&r.pfe(),n=d.offset,i=d.text,o.success=d.success,f.getStatus()!==x.RestrictionStatus.complete&&!1===d.success)break;if(e+=n-l,(n=0)===i.length)break}return u<=a&&""!==i&&0<i.length||(c=(m=r.Wse(e)).index,m=m.offset,a+1<u-1&&r.zse[a+1].uit===x.RestrictionType.prompt&&c===a+1&&0===m&&r.zse[a].satisfy()&&(e+=r.zse[a+1].length())),o.cursorPos=e,o.text=i,!1!==o.success?(c=r.xfe(e,e),r.addUndoInfo(s,c)):r.undo(s),o},j.prototype.backspace=function(){var t,n,n,t=this,n=t.Mce(),n=t.Cce(n.start,n.end-n.start);return t.setSelection({start:n,end:n}),!0},j.prototype.Mce=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.getSelection(),e=n.start,i=n.end-e;if((0!==e||0!==i)&&(r=(u=t.Wse(e)).index,o=u.offset,-1!==r)){if(0===i){if(a=t.Pse(r),0===r&&0===o)return n;for(;(0===o||a.uit===x.RestrictionType.prompt)&&0<r;)i+=o,o=(a=t.Pse(--r)).length(),a.uit===x.RestrictionType.prompt&&(i+=o,o=0);if(a=t.Pse(r),0===r){if(a.uit===x.RestrictionType.prompt)return n;if(0===a.length())return n}if(a.uit!==x.RestrictionType.prompt)e-=i+=1,i=1;else{if(a.uit!==x.RestrictionType.enum&&a.uit!==x.RestrictionType.hourFormat)return n;e=0<(e-=i+=a.length())?e:0}}else{if(s=void 0,-1===(s=(u=t.Wse(e+i)).index))return n;if(0===o&&0!==r&&r--,a=t.Pse(s),r===s&&a.uit===x.RestrictionType.prompt)return n}n.start=e,n.end=e+i}return n},j.prototype.Sce=function(){var t,n,e,i,r,i,o,a,u,i,t,i,t=this,n=t.getSelection(),e,i=t.getText().length,r=t.DU,i=i,o=n.start,a=n.end-o;if((o!==i||0!==a)&&(u=(i=t.Wse(o)).index,i=i.offset,-1!==u)&&0===a){if(t=t.Pse(u),u===r-1&&i===t.Jse)return n;if(t.uit!==x.RestrictionType.prompt)a+=1;else{if(t.uit!==x.RestrictionType.enum&&t.uit!==x.RestrictionType.hourFormat)return n;a+=t.length(),o=0<o?o:0}n.start=o,n.end=o+a}return n},j.prototype.delete=function(){var t,n,n,t=this,n=t.Sce(),n=t.Cce(n.start,n.end-n.start);return t.setSelection({start:n,end:n}),!0},j.prototype.Cce=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,n,e=this;if(0!==e.DU){for(i=e.xfe(),o=(r=e.Wse(t)).index,a=r.offset,e.zse[o].uit===x.RestrictionType.prompt&&n>e.zse[o]._text.length-a&&(t+=e.zse[o]._text.length-a,n-=e.zse[o]._text.length-a,o++,a=0),u=(r=e.Wse(t+n)).index,s=r.offset;0!==u&&0===s&&(c=e.zse[u-1]).uit!==x.RestrictionType.prompt;)s=e.zse[--u]._text.length>e.zse[u].yce?e.zse[u]._text.length:e.zse[u].yce;for(f=o;f<=u;f++)c=e.zse[f],l=a,o===u?a<s?a=c.delete(a,s-a):a-=a-s:f===o?0<(h=c._text.length-a)&&(a=c.delete(a,c._text.length-a)):a=f===u?c.delete(a,s):c.delete(a,c._text.length),a!==N&&(c.uit!==x.RestrictionType.year&&c.uit!==x.RestrictionType.month&&c.uit!==x.RestrictionType.day||e.bce(),c.uit===x.RestrictionType.hour24&&e.pfe(),t+=a-l),a=0;n=e.xfe(t,t),e.addUndoInfo(i,n)}return t},j.prototype.replace=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,u,v,m,g,p,b,w,w,y,y,M,C,S,T,A,u,I,u,u,e=this,i=e.Use,r=e.Hse-i,o=e.Lse,a={};for(a.cursorPos=i,a.text=t,s=(u=e.Wse(i)).index,c=u.offset,f=e.xfe();0!==s&&0===c&&e.zse[s].uit===x.RestrictionType.prompt;)(c=(l=e.zse[--s])._text.length)<l.yce&&(c=l.yce);for(h=(u=this.Wse(i+r)).index,d=u.offset;0!==h&&0===d&&(l=e.zse[h-1]).uit!==x.RestrictionType.prompt&&l._text.length<l.VUt;)d=e.zse[--h]._text.length;for(u=t,v=!0,m=i-c,g=s;g<e.DU;g++)if(l=e.zse[g],g+1<e.DU&&e.zse[g+1].uit===x.RestrictionType.prompt&&-1<(b=(p=e.zse[g+1]).included(t))&&(w=t.substring(0,b),""===(w=l.replace(c,w.length,w,N,n)).text)&&!0===w.success&&l.getStatus()===x.RestrictionStatus.complete)i+=(y=p._text.length)+w.offset-c,m+=(l.yce>l._text.length?l.yce:l._text.length)+y,t=t.substring(b+y,t.length),g++;else{if(y=l._text.length>l.yce?l._text.length:l.yce,""===t){i=D(e,i,c,h,d,g,n);break}if(l.uit===x.RestrictionType.prompt){if(o)m+c===i&&(i+=y-c);else{for(y=(M=l._text.substring(c,y)).length,C=Math.min(t.length,y),S=0;S<C&&t[S]===M[S];S++);t=t.substring(S,t.length),i+=S}m+=l._text.length-c}else{if(T=c,A=g===e.DU-1,w=void 0,v=(t=(c=(h<g?w=l.insert(c,t,A,n):s===h?w=l.replace(c,d-c,t,A,n):g===s?w=l.replace(c,y-c,t,A,n):g===h?(0<d-c?w=l.replace(c,d-c,t,A,n):0<r&&(w=l.replace(c,r,t,A,n)),w):w=l.replace(c,y,t,N,n)).offset,w.text),w.success),l.getStatus()!==x.RestrictionStatus.complete&&!1===v)break;l.uit!==x.RestrictionType.year&&l.uit!==x.RestrictionType.month&&l.uit!==x.RestrictionType.day||e.bce(),l.uit===x.RestrictionType.hour24&&e.pfe(),i+=c-T,m+=l.yce>l._text.length?l.yce:l._text.length}if(c=0,""===t){i=D(e,i,c,h,d,g,n);break}}return a.success=u!==t,I=(u=e.Wse(i)).index,u=u.offset,I<e.DU-1&&e.zse[I].uit===x.RestrictionType.prompt&&0===u&&(!e.zse[I-1]||e.zse[I-1].satisfy())&&(i+=e.zse[I].length()),!1!==a.success?(u=e.xfe(i,i),e.addUndoInfo(f,u)):e.undo(f),a.cursorPos=i,a.text=t,a},j.prototype.dispose=function(){for(var t,n,e,i,r,t=this,n=t.DU,e=t.zse,i=0;i<n;i++)(r=e[i]).dispose();t.zse.length=0,t.Nmt.length=0,t.kmt.length=0,t.Yse=null},j.prototype.input=function(t){var n,t,n=this,t=n.Use!==n.Hse?(0===n.Use&&n.Hse===n.bh()&&(n.Use=n.getFirstInputPosition()),n.replace(t)):n.Eit(n.Use,t);return n.Hse=n.Use=t.cursorPos,t.success},j.prototype.paste=function(t,n){var e,t,e=this,t=e.replace(t,n);return e.setSelection({start:t.cursorPos,end:t.cursorPos}),t.success},j.namedPatterns={},n.InputMask=j},"./dist/plugins/inputMask/inputMask/inputMask.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/inputMask/inputMask/inputMask.res.en.js");n.SR={en:e}},"./dist/plugins/inputMask/inputMask/inputMask.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hourFormatDesignator=n.hourFormatSingleDesignator=n.errorMsg=void 0,n.errorMsg={invalidPattern:"Invalid Pattern",duplicatedDateTimePattern:"Duplicated Date Time Pattern",emptyPattern:"Empty Pattern",unknownPattern:"Parse Unknown Pattern Failure",invalidOptionalPattern:"Parse Optional Pattern Failure",invalidGroupPattern:"Parse Group Pattern Failure",errorQuantifierPattern:"Error Quantifier Position",invalidQuantifierPattern:"Parse Quantifier Pattern Failure",noEntry:"No Restriction Can Be Entered"},n.hourFormatSingleDesignator=["A","P"],n.hourFormatDesignator=["AM","PM"]},"./dist/plugins/inputMask/inputMask/interface.js":function(t,n){"use strict";var e,i,r,o,a,u,u,u,u,u;Object.defineProperty(n,"__esModule",{value:!0}),n.DateStatus=n.CaseType=n.RestrictionStatus=n.KeywordType=n.RestrictionType=void 0,(u=e=n.RestrictionType||(n.RestrictionType={}))[u.normal=0]="normal",u[u.prompt=1]="prompt",u[u.enum=2]="enum",u[u.year=3]="year",u[u.month=4]="month",u[u.day=5]="day",u[u.hour=6]="hour",u[u.hour24=7]="hour24",u[u.minute=8]="minute",u[u.second=9]="second",u[u.hourFormat=10]="hourFormat",(u=i=n.KeywordType||(n.KeywordType={}))[u.unknow=0]="unknow",u[u.octalAscII=1]="octalAscII",u[u.hexAscII=2]="hexAscII",u[u.hexUnicode=3]="hexUnicode",u[u.optional=4]="optional",u[u.group=5]="group",u[u.quantifier=6]="quantifier",u[u.promptChar=7]="promptChar",u[u.range=8]="range",u[u.any=9]="any",u[u.date=10]="date",(u=r=n.RestrictionStatus||(n.RestrictionStatus={}))[u.null=0]="null",u[u.complete=1]="complete",u[u.inComplete=2]="inComplete",(u=o=n.CaseType||(n.CaseType={}))[u.normal=0]="normal",u[u.upperCase=1]="upperCase",u[u.lowerCase=2]="lowerCase",(u=a=n.DateStatus||(n.DateStatus={}))[u.null=-1]="null",u[u.inComplete=-2]="inComplete"},"./dist/plugins/inputMask/inputMask/restrictions.js":function(t,n,e){"use strict";var i,s,b,r,e,r,o,y,e,a,u,c,f,l,h,d,v,R,m,g,p,w,M,C,S,T;function A(t,n,e,i){for(var r=0;r<e&&t[n+r]&&t[n+r]===i;r++);return r}function I(t,n,e){for(var i=n-1;0<=i&&t[i]===e;i--);return i}function x(t,n){var e=this;e.yce=-1,e.VUt=-1,e.Jse=-1,e._text="",e.uit=t,e.yce=0,e.VUt=0,e.Jse=0,e.Gse=n}function N(t){var t,n,t=g.call(this,s.RestrictionType.enum,t)||this,n=t;return n.Tce=-1,n.Jse=0,n.Ice=-1,n.xce=-1,n.yce=Number.MAX_VALUE,n.VUt=Number.MIN_VALUE,n.QG=0,t}function k(t,n){var n=p.call(this,s.RestrictionType.prompt,n)||this;return n.init(t.length,t.length,t),n}function _(t){return w.call(this,s.RestrictionType.normal,t)||this}function D(t,n,e,i){var r=M.call(this,s.RestrictionType.normal,e)||this;return r.Nce=t,r.kce=n,r.Dce=i||s.CaseType.normal,r.init(1,1,e,[]),r}function j(t,n){var t=C.call(this,s.RestrictionType.normal,t)||this;return t._ce=n,t.init(0,1,"",[]),t}function O(t){var t=S.call(this,s.RestrictionType.normal,t)||this;return t.Ece=[],t}function E(t,n,e){var n,i,r,o,a,u,n=T.call(this,t,n)||this,i=n,r=e,o=e;switch(i.Jse=0,t){case s.RestrictionType.year:a=1,u=9999,r=o=e=e<=2?2:4;break;case s.RestrictionType.day:u=31,o=(a=1)===e?1:2,r=2;break;case s.RestrictionType.month:u=12,o=(a=1)===e?1:2,r=2;break;case s.RestrictionType.hour:a=0,u=11,o=1===e?1:2,r=2;break;case s.RestrictionType.hour24:a=0,u=23,o=1===e?1:2,r=2;break;case s.RestrictionType.minute:case s.RestrictionType.second:a=0,u=59,o=1===e?1:2,r=2}return i.VUt=r,i.yce=o,i.jce=a,i.Oce=u,n}i=this&&this.__extends||(m=function(t,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DateTimeItemRestriction=n.OptionalRestriction=n.LimitedRestriction=n.RangeRestriction=n.AnyCharRestriction=n.PromptRestriction=n.EnumRestriction=n.MaskRestriction=void 0,s=e("./dist/plugins/inputMask/inputMask/interface.js"),b=e("./dist/plugins/inputMask/inputMask/common.js"),r=e("Common"),e=e("./dist/plugins/inputMask/inputMask/inputMask.ns.js"),o=(r=new r.Common.ResourceManager(e.SR,"InputMask")).getResource.bind(r),y=void 0,x.prototype.init=function(t,n,e,i){var r,o,a;if(n<t)return!1;if((r=this).yce=t,r.VUt=n,r.Bce=i||[],o=r.Jse=0,r.Bce!==y){for(;r.Bce[o]!==y;)o++;for(a=o;0<=a;a--)if(r.Bce[a]!==y)!1===r.Bce[a]&&r.Jse--;else{if(r.Bce[a]!==y)break;r.Jse--}}return r.clear(),r._text=e||"",!0},x.prototype.getPromptChar=function(){return this.Gse},x.prototype.saveOldState=function(){var t=this;return{bitState:t.Bce&&t.Bce.concat(),text:t._text,realLength:t.Jse}},x.prototype.undo=function(t){var n=this;n.Bce=t.bitState,n.Jse=t.realLength,n._text=t.text},x.prototype.insert=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,r=this,o={};if(o.offset=t,o.text=n,t>r.VUt||""===n||0===n.length)o.success=!1;else{for(o.success=!0,a=[],u=t,s="",c=0,f=r.getPromptChar(),l=0;l<t;l++)a[l]=r.Bce[l];for(;c<n.length;){if(d=(h=r.check(n,c,i)).text,c=h.offset,""===d){o.success=!1;break}if(s+=d,a[u]=!0,u++,t+s.length===r.VUt)break;if(t+s.length>r.VUt){s=s.substring(0,s.length-1);break}}if(0===s.length)o.success=!1;else{if(v=A(r._text,t,s.length,f),(m=(m=r._text.substring(0,t)+s+r._text.substring(t+v,r._text.length)).length>r.VUt?m.substring(0,r.VUt):m).length>t+s.length)for(g=0,p=m.length-t-s.length;g<p;g++)r.Bce[t+g]!==y?a[u]=r.Bce[t+g]:a[u]=!1,u++;for(r.Bce=a,g=(r.Jse=u)-1;0<=g&&(!1===r.Bce[g]||i&&m[g]===f);g--)r.Jse--;if(m.length<r.yce)for(g=0,p=r.yce-m.length;g<p;g++)m+=f;for(b=m.length,w=Math.max(r.yce,r.Jse);w<b&&m[b-1]===f;b--);m=m.substring(0,b),r._text=m,n=c===n.length?"":n.substring(c,n.length),t+=s.length,o.offset=t,o.text=n}}return o},x.prototype.clear=function(){var t,n,e,i,t=this,n="",e=[];if((t.Jse=0)<t.yce){for(i=0;i<t.yce;i++)e[i]=!1;if(t.Bce=e,""!==t.getPromptChar())for(i=0;i<t.yce;i++)n+=t.getPromptChar();else for(i=0;i<t.yce;i++)n+=" ";t._text=n}else t._text="",t.Bce=[]},x.prototype.delete=function(t,n,e){var i,r,o,a,u,s,c,f,i=this;if(!(0===n||t>=i._text.length)){for(t+n>i._text.length&&(n=i._text.length-t),r=[],o=t,a=0;a<t;a++)r[a]=i.Bce[a];if(u=i._text.substring(0,t)+i._text.substring(t+n,i._text.length),t+n<i._text.length)for(s=0,c=i._text.substring(t+n,i._text.length).length;s<c;s++)i.Bce[t+n+s]!==y?r[o]=i.Bce[t+n+s]:r[o]=!1,o++;if(o<i.yce)for(s=o;s<i.yce;s++)r[s]=!1;for(i.Bce=r,s=(i.Jse=o)-1;0<=s&&!1===i.Bce[s];s--)i.Jse--;if(u.length<i.yce)for(f=i.yce-u.length,s=0;s<f;s++)u+=i.getPromptChar();i._text=u}return t},x.prototype.replace=function(t,n,e,i,r){var o,a,o={};return o.offset=t,o.text=e,(a=this).delete(t,n),o=a.insert(t,e,i,r)},x.prototype.getText=function(){var t,n,e,i,r,t=this,n=t._text;if(!n||n.length<t.yce){if((e=t.getPromptChar())===y||""===e)return n;for(i=n.length,r=t.yce;i<r;i++)n+=e}return n},x.prototype.getTextExcludeLiterals=function(t,n){var e,i,r,e=this._text,i=e.length;return r=(r=e.substring(t,n=i<n?i:n)).replace(/[^\d]/g,"")},x.prototype.check=function(t,n,e){var i={success:!1,text:""};return i.offset=n,e&&t===this.getPromptChar()&&(i.success=!0,i.text=t,i.offset=n+1),i},x.prototype.length=function(){var t=this,n=t.getText();return n.length>t.yce?n.length:t.yce},x.prototype.getStatus=function(){var t=this;return 0===t.yce?s.RestrictionStatus.complete:t.Jse<=0?s.RestrictionStatus.null:t.Jse<t.yce?s.RestrictionStatus.inComplete:s.RestrictionStatus.complete},x.prototype.dispose=function(){this.Bce&&(this.Bce.length=0)},x.prototype.satisfy=function(){return this._text.length===this.VUt},n.MaskRestriction=e=x,a=-1,u=-2,i(N,g=e),N.prototype.setItems=function(t){for(var n,e,i,r,o,n=this,e=n.yce,i=n.VUt,r=t.length,o=0;o<r;o++)e=Math.min(e,t[o].length),i=Math.max(i,t[o].length);e===Number.MAX_VALUE&&(e=0),i===Number.MIN_VALUE&&(i=0),n.yce=e,n.VUt=i,n.QG=r,n._items=t,n._text=n.getText()},N.prototype.getText=function(){var t,n,e,i,r,t=this,n=t.Tce;if(-2!==n)return-1===n?t._items[0]:t._items[t.Tce];for(e="",i=t.getPromptChar(),r=0;r<t.yce;r++)e+=i;return e},N.prototype.checkItemValid=function(t,n,e,i){var r,o,a,r={};return r.index1=n,r.index2=i,r.isValid=!1,n>=t.length||(o=t.substring(n,n+1).toLowerCase())===(a=e.substring(i,i+1).toLowerCase())&&(i++,r.index1=++n,r.index2=i,r.isValid=!0),r},N.prototype.insert=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,r={},o=this;for(r.offset=t,r.text=n,r.success=!0,a=t,u="",0!==(a=o.Tce<0?0:a)&&(u=o._items[o.Tce].substring(0,a)),s=o.QG,c=new Array(s),f=new Array(s),l=new Array(s),h=new Array(s),d=0;d<s;d++)c[d]=a,f[d]=0,l[d]=99999,h[d]=[];for(d=0;d<s;d++)if(v=o._items[d],!(0<u.length&&v.substring(0,u.length)!==u))for(;f[d]<n.length&&!(c[d]>=v.length);)m=o.checkItemValid(v,c[d],n,f[d]),c[d]=m.index1,f[d]=m.index2,m.isValid?99999===l[d]&&(l[d]=f[d]):f[d]++;for(b=!1,w=c[g=0],y=p=0;y<o.QG;y++){if(v=o._items[y],c[y]===n.length+a&&n.length===v.length){w=c[g=y],b=!0;break}99999!==l[y]&&l[g]>=l[y]&&(l[g]===l[y]?w<(M=c[y])?(g=y,w=M,p=1):w===M&&p++:(w=c[g=y],p=1))}if(b)0===f[g]?r.success=!1:(n=n.substring(f[g]+1,n.length),t=o._items[g].length,r.success=0===h[g].length,o.Tce=g,o._text=o._items[g].toString(),o.Jse=o._text.length,r.offset=t,r.text=n);else if(w===a)!1===e&&0<=o.Tce&&t===o._items[o.Tce].length?(n=n.substring(f[g],n.length),r.offset=t,r.text=n):r.success=!1;else{for(C=-1,d=0;d<h[g].length;d++)C=0;if(1===p)t=o._items[g].length;else{for(S=o._items[g].length,d=0;d<o.QG;d++)c[d]===w&&S>o._items[d].length&&(S=o._items[d].length,g=d);t=w}-1===C?(n=n.substring(f[g],n.length),r.success=!0):(n=n.substring(f[g],n.length),r.success=!1),o.Tce=g,o._text=o._items[g],o.Jse=o._text.length,r.offset=t,r.text=n}return r},N.prototype.replace=function(t,n,e,i,r){return this.insert(t,e,i,r)},N.prototype.getStatus=function(){return this.Tce<0?s.RestrictionStatus.null:s.RestrictionStatus.complete},N.prototype.delete=function(t,n,e){var i,r,i=this;if(0===n||t>=i._text.length)return t;if(i.Tce=e?-1:-2,i._text="",0<i.yce)for(r=0;r<i.yce;r++)i._text+=i.getPromptChar();return i.Jse=0},N.prototype.saveOldState=function(){var t=g.prototype.saveOldState.call(this);return t.activeItem=this.Tce,t},N.prototype.undo=function(t){g.prototype.undo.call(this,t),this.Tce=t.activeItem},N.prototype.satisfy=function(){return 0<=this.Tce},n.EnumRestriction=N,i(k,p=e),k.prototype.insert=function(t,n,e,i){for(var r,o,a,u,s,c,r=this,o=n.length,a=r._text.length-t,u=0,s=Math.min(o,a);u<s&&n[u]===r._text[t+u];u++);return{text:c=n.substring(u,o),offset:r._text.length,success:0<u}},k.prototype.delete=function(t,n,e){return t},k.prototype.replace=function(t,n,e,i,r){return this.insert(t,e,i,r)},k.prototype.included=function(t){var n,e,n,t;return t?(e=(n=this._text).replace(String.fromCharCode(32),String.fromCharCode(160)),n=t.indexOf(n),t=t.indexOf(e),-1<n?n:-1<t?t:-1):-1},n.PromptRestriction=k,i(_,w=e),_.prototype.insert=function(t,n,e,i){var r,o,o,o,r=this;return t+n.length>r.VUt?(o=n.substring(0,r.VUt-t),r._text=r._text.substring(0,t)+o,r.Sfe(),{text:n.substring(r.VUt-t,n.length),offset:r.VUt,success:!0}):(o=A(r._text,t,n.length,r.getPromptChar()),o=r._text.substring(0,t)+n+r._text.substring(t+o,r._text.length),r._text=o.substring(0,r.VUt),r.Sfe(),{text:"",offset:t+n.length,success:!0})},_.prototype.delete=function(t,n,e){var i=this;return i._text=i._text.substring(0,t)+i._text.substring(t+n,i._text.length),i.Sfe(),t},_.prototype.replace=function(t,n,e,i,r){var o,a,o=this;return t+e.length>o.VUt?(a=e.substring(0,o.VUt-t),o._text=o._text.substring(0,t)+a,o.Sfe(),{text:e.substring(o.VUt-t,e.length),offset:o.VUt,success:!0}):(o._text=o._text.substring(0,t)+e+o._text.substring(t+n,o._text.length),o._text=o._text.substring(0,o.VUt),o.Sfe(),{text:"",offset:t+e.length,success:!0})},_.prototype.Sfe=function(){var t=this,n=t._text;t.Jse=I(n,n.length,t.getPromptChar())+1},n.AnyCharRestriction=_,i(D,M=e),D.prototype.check=function(t,n,e){var i,r,t,n,i=this,r={success:!1,text:""},t=t.substring(r.offset=n,n+1),n=i.Dce;return(t>=i.Nce&&t<=i.kce||e&&t===i.getPromptChar())&&(n===s.CaseType.upperCase?t=t.toUpperCase():n===s.CaseType.lowerCase&&(t=t.toLowerCase()),r.offset++,r.text=t,r.success=!0),r},n.RangeRestriction=D,i(j,C=e),j.prototype.check=function(t,n,e){var i=this,t=t[n],r={success:!0};return r.text=t,r.offset=n+1,""!==i._ce&&-1<i._ce.indexOf(t)||e&&t===i.getPromptChar()||(r.success=!1,r.text="",r.offset=n),r},n.LimitedRestriction=j,i(O,S=e),O.prototype.add=function(t){t!==y&&this.Ece.push(t)},O.prototype.check=function(t,n,e){var i,r,o,a,u,s,c,i,r=this.Ece,o={},a=t[n];if(o.success=!1,o.text="",o.offset=n,0!==r.length)for(u=0,s=r.length;u<s;u++)if(!0===(c=r[u].check(a,0,e)).success&&""!==c.text)return o.offset=n+1,o.success=!0,o.text=c.text,o;return o},O.prototype.dispose=function(){var t,n,e,i;for(S.prototype.dispose.call(this),e=0,i=(n=(t=this).Ece).length;e<i;e++)n[e].dispose();t.Ece.length=0},n.OptionalRestriction=O,i(E,T=e),E.prototype.init=function(t,n,e,i){return!0},E.prototype.getText=function(){var t=this,n=t.getValue();return 0<=n&&n>t.Oce&&(t._text=""+t.Oce),-1===n&&(t._text=(0,b.fillString)(t.getPromptChar(),t.yce)),t._text},E.prototype.getValue=function(){var t=this.getStatus();return t===s.RestrictionStatus.null?s.DateStatus.null:t===s.RestrictionStatus.inComplete?s.DateStatus.inComplete:parseInt(this._text,10)},E.prototype.getStatus=function(){for(var t,n,e,i,r,o,a,t=this,n=t.getPromptChar(),e=t.yce,i=t._text,r=i.length,o=0,a=0;a<r;a++)i[a]!==n&&o++;return 0===o?s.RestrictionStatus.null:o<e?s.RestrictionStatus.inComplete:s.RestrictionStatus.complete},E.prototype.check=function(t,n,e){var e,i,e="0"<=t&&t<="9"||e&&t===this.getPromptChar();return{success:e,text:i=e?t:"",offset:n=e?n+1:n}},E.prototype.rightShiftNumber=function(t,n){for(var e=0;0<t&&e<n;e++)t=parseInt((t/10).toString(),10);return t},E.prototype.Lce=function(t){for(var n,e,i,n=this,e="",i=t;i<n.VUt;i++)e+=n.getPromptChar();n._text=n._text.substring(0,t)+e},E.prototype.delete=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,n,i=this,r=i.VUt;if(!(r<t+n)){for(o=i._text,a=i.jce,u=i.Oce,s=(0,b.fillString)(a,i.VUt,"0"),c=o.substring(0,t),f=o.substring(0,t)+o.substring(t+n,o.length),h=l=0;h<t;h++)l=(l*=10)+parseFloat((o[h]===i.getPromptChar()?s:o)[h]);for(g=!1,h=m=t;h<f.length&&f[h]!==i.getPromptChar();h++)l=(l*=10)+parseFloat(f[h]),d=i.rightShiftNumber(a,r-m-1),v=i.rightShiftNumber(u,r-m-1),d<=l&&l<=v?(c+=f[h],m++):(l=(l-parseFloat(f[h]))/10,g=!0);0===t&&0===l&&g?i.Lce(0):(0<(n=i.yce-c.length)&&(c+=(0,b.fillString)(i.getPromptChar(),n)),i._text=c),i.Sfe()}return t},E.prototype.Sfe=function(){var t=this,n=t._text;t.Jse=I(n,n.length,t.getPromptChar())+1},E.prototype.Fce=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,i,r=this,o=r.VUt,a=r.jce,u=r.getPromptChar(),s=r.Oce,c={};if(c.offset=t,c.success=!1,i&&n===u)r._text=r._text.substring(0,t)+n+r._text.substring(t+1,r._text.length),c.offset=t+1,c.success=!0;else if(r.check(n,t,i).success){for(f=(0,b.fillString)(a,o,"0"),h=r._text,v=d=l=0;v<t;v++)l*=10,h[v]!==u?l+=parseFloat(h[v]):l<r.rightShiftNumber(a,o-v-1)?(h=h.substring(0,v)+f[v]+h.substring(v+1,h.length),l+=parseFloat(f[v])):h=h.substring(0,v)+"0"+h.substring(v+1,h.length);if(l=(l*=10)+parseFloat(n),m=r.rightShiftNumber(a,i=o-t-1),g=r.rightShiftNumber(s,i),m<=l&&l<=g){for(e?t>=h.length?h+=n:h=h.substring(0,t)+n+h.substring(t,h.length-1):h=h.substring(0,t)+n+h.substring(t+1,h.length),v=++t;v<o;v++){if(l*=10,h[v]===u){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}if(l+=parseFloat(h[v]),m=r.rightShiftNumber(a,o-v-1),(g=r.rightShiftNumber(s,o-v-1))<l||l<m){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}}if(r.VUt!==r.yce){for(;d<h.length-r.yce&&"0"===h[d];d++)t--;h=h.substring(d,h.length)}r._text=h}else{if(l!==parseFloat(n)||"0"===n)return c;if("0"!==f[t])return 0!==t&&(c.success=!0,c.offset=t),c;for(;(g<l||l<m)&&(e?t>=h.length?h+="0":h=h.substring(0,t)+"0"+h.substring(t,h.length-1):h=h.substring(0,t)+"0"+h.substring(t+1,h.length),m=r.rightShiftNumber(a,o-++t-1),g=r.rightShiftNumber(s,o-t-1),!(t>=h.length-1)););for(l=0,p=t;p<o;p++){if(l=(l*=10)+parseFloat(n),m=r.rightShiftNumber(a,o-p-1),!((g=r.rightShiftNumber(s,o-p-1))<l||l<m)){for(e?p>=h.length?h+=n:h=h.substring(0,p)+n+h.substring(p,h.length-1):h=h.substring(0,p)+n+h.substring(p+1,h.length),v=++p;v<o;v++){if(l*=10,h[v]===u){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}if(l+=parseFloat(h[v]),m=r.rightShiftNumber(a,o-v-1),(g=r.rightShiftNumber(s,o-v-1))<l||l<m){h=h.substring(0,v)+(0,b.fillString)(u,o-v);break}}if(r.VUt!==r.yce){for(;d<h.length-r.yce&&"0"===h[d];d++)p--;h=h.substring(d,h.length)}r._text=h,t=p;break}if(l-=parseFloat(n),"0"!==h[p])return 0!==t&&(c.success=!0,c.offset=t),c;if(e?p>=h.length?h+="0":h=h.substring(0,p)+"0"+h.substring(p,h.length-1):h=h.substring(0,p)+"0"+h.substring(p+1,h.length),p===h.length-1)return c.success=!1,c}}c.offset=t,c.success=!0}return c},E.prototype.insert=function(t,n,e,i){var r,o,a,u,s,c,r=this,o={success:!0};if(o.offset=t,o.text=n,a=r._text,t!==r.VUt){for(u=t,s=0;s<n.length;s++)if((c=r.Fce(u,n[s],!0,i)).success){if((u=c.offset)===r.VUt)break}else o.success=!1;r.Sfe(),t===u&&a===r._text||(n=s+1<n.length?n.substring(s+1,n.length):"",o.offset=u,o.text=n)}return o},E.prototype.replace=function(t,n,e,i,r){var o,a,u,s,c,f,s,l,o=this,a=t,u={success:!0};if(u.offset=a,u.text=e,s=o._text,a!==o.VUt){for(c=0;c<e.length;c++)if((f=o.Fce(a,e[c],n<=c,r)).success){if((a=f.offset)===o.VUt)break}else u.success=!1;o.Sfe(),t===a&&s===o._text||(s=n+t-a,(l=o._text).length>=t+n&&0<s&&(o._text=l.substring(0,a)+l.substring(t+n,l.length)+(0,b.fillString)(o.getPromptChar(),s)),e=c+1<e.length?e.substring(c+1,e.length):"",u.offset=a,u.text=e)}return u},E.prototype.setRange=function(t,n){this.jce=t,this.Oce=n},E.prototype.satisfy=function(){var t,n,e,i,r,o,a,t=this,n=t._text,e=t.VUt;if(n.length===e)return!0;switch(i=t.getValue(),r=t.yce,o=t.uit){case s.RestrictionType.year:return n.length===e;case s.RestrictionType.day:return a=Math.floor(t.Oce/10),1===r&&a<i;case s.RestrictionType.month:case s.RestrictionType.hour:return 1===r&&1<i;case s.RestrictionType.hour24:return 1===r&&2<i;case s.RestrictionType.minute:case s.RestrictionType.second:return 1===r&&5<i;default:return!1}},n.DateTimeItemRestriction=E},"./dist/plugins/inputMask/integrate.js":function(t,n,e){"use strict";var i,n,r,o,a,u,s,c,f,l;function h(t){return!a(t)&&!a(t.pattern)&&0<t.pattern.length&&o.InputMask.validatePattern(t.pattern).success}function d(t){return t=t&&0<t.length&&0<=(t=t.replace(c,"\n")).indexOf("\xa0")?t.replace(new RegExp("\xa0","g")," "):t}function v(t){return t=t&&0<t.length&&0<=(t=t.replace(/\n/g,"\n\u200b")).indexOf(" ")?t.replace(new RegExp(" ","g"),"\xa0"):t}Object.defineProperty(n,"__esModule",{value:!0}),i=e("Core"),n=e("Common"),r=e("Core"),o=e("./dist/plugins/inputMask/inputMask/inputMask.js"),a=n.Common.lt.ht,u="\xa0",s="\u200b",c=new RegExp("\n\u200b","g"),f=" ",i.CellTypes.Text.ch("inputMask",l={activateEditor:function(t){var n,t,t,n=t.editor,t=t.mask;h(t)&&(t=new o.InputMask(t),n.Rse=t)},setEditorValue:function(t){var n,e,i,r,i,n,e=t.editor.Rse,i=t.editorValue,r=t.originValue;e&&(t.startEditByKeydown||a(i)||(i=d(i),e.setValue(i,r)),i=e.getFirstInputPosition(),e.setSelection({start:i,end:i}),e.addPercent=t.addPercent,t.editorValue=v(e.getText()+(t.startEditByKeydown&&e.addPercent?"%":"")),t.caret=e.getSelection(),t.cancel=!0)},afterSetEditorFocus:function(t){var n,e=t.editor.Rse;e&&(t.caret=e.getSelection(),t.cancel=!0)},deactivateEditor:function(t){var t=t.editor,n=t.Rse;n&&(n.dispose(),t.Rse=null)},getEditorValue:function(t){var n,e=t.editor.Rse;e&&(t.editorValue=e.getValue()+(e.addPercent?"%":""))},editorInput:function(t){var n=t.editor,e=t.value,i=t.caret,n=n.Rse;n&&(t.isImeInputting&&(i.start=i.start-e.length,i.end=i.end-e.length),n.setSelection(i),n.input(e),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorBackspace:function(t){var n=t.editor,e=t.caret,n=n.Rse;n&&(n.setSelection(e),n.backspace(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorDelete:function(t){var n=t.editor,e=t.caret,n=n.Rse;n&&(n.setSelection(e),n.delete(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorCut:function(t){var n,e,i,r,n,e,n=t.editor,e=t.caret,i=t.clipboardData,r=t.dataName,n=n.Rse;n&&(n.setSelection(e),e=n.getText(!0),i.setData(r,e),n.backspace(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection())},editorPaste:function(t){var n=t.editor,e=t.caret,i=t.pasteValue,n=n.Rse;n&&(n.setSelection(e),n.paste(i),t.pasteValue=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorUndo:function(t){var n=t.editor,e=t.caret,n=n.Rse;n&&(n.setSelection(e),n.undo(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},editorRedo:function(t){var n=t.editor,e=t.caret,n=n.Rse;n&&(n.setSelection(e),n.redo(),t.value=v(n.getText()+(n.addPercent?"%":"")),t.caret=n.getSelection(),t.cancel=!0)},onCreateEventArg:function(t){var n=t.eventArg,e;n.sheet.getActualStyle(n.row,n.col).mask&&t.eventName===i.Events.EnterCellInternal&&(n.readonly=!0)}}),r.Workbook.ch("inputMask",{fromJson:function(t,n,e){o.InputMask.namedPatterns=t.namedPatterns||{}},toJson:function(t,n){t.namedPatterns=o.InputMask.namedPatterns},yh:function(t,n,e){t.workbook.lossless&&(o.InputMask.namedPatterns=t.workbook.lossless.namedPatterns||{})},wh:function(t,n,e){t.workbook.lossless||(t.workbook.lossless={}),t.workbook.lossless.namedPatterns=o.InputMask.namedPatterns}})},"./dist/plugins/namebox/namebox-actions.js":function(t,n,e){"use strict";var i,n,l,h,d,e,r,v,m,n,g,p,o,a,u,s,c,f,b;function w(t,n){return f.call(this,t,n)||this}function y(t,n){return b.call(this,t,n)||this}i=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),l=e("Core"),h=e("SheetsCalc"),d=e("./dist/plugins/namebox/namebox.js"),e=e("./dist/plugins/namebox/namebox.ns.js"),r=l.Commands.ActionBase,v=n.Common.zf,m=n.Common.lt.ht,n=new n.Common.ResourceManager(e.SR,"NameBox"),g=n.getResource.bind(n),p=void 0,o="addCustomName",a="navigateToRange",i(w,f=r),w.prototype.execute=function(){var t,n,e,i,t,r,t,o,a,u,s,c,f,l,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).getParent(),r=(t=t.tT).nameBox,t=t.selectorValue;try{if(o=e.getSelections(),m(o)||0===o.length)return;if(t.toLowerCase()===d.PRINT_AREA&&e.printInfo)return a=o[0],(u=e.printInfo()).rowStart(a.row),u.rowEnd(a.row+a.rowCount-1),u.columnStart(a.col),u.columnEnd(a.col+a.colCount-1),!0;for(s=e.name(),v.fJ(s,"'")&&v.dT(s,"'")||(s="'"+s+"'"),c=[],f=void 0,l=0;l<o.length;l++)c.push(s+"!"+(0,h.rangeToFormula)(o[l],e.getActiveRowIndex(),e.getActiveColumnIndex(),p,!!i.options.referenceStyle));f=c.join(","),i.addCustomName(t,f,e.getActiveRowIndex(),e.getActiveColumnIndex(),""),n=!0}catch(t){e.jT(15,g().invalidName),r.updateNameRangeSelectorValue()}}return n},u=w,l.Commands[o]={canUndo:!1,execute:function(t,n){l.Commands.zA(t,u,n)}},i(y,b=r),y.prototype.execute=function(){var t,n,e,i,t,r,o,a,t,u,s,c,f,i,t=this,n=!1;if(t.canExecute()){if(i=(e=t.Mf).getParent(),r=(t=t.tT).nameBox,o=t.selectorValue,a=t.selections,t=t.sheetName,u=i.getSheetFromName(t),(s=i.getActiveSheet())!==u&&(i.I2(i.getSheetIndex(t),1,!1,!0),s.b2(!1,!0),u.b2(!0,!0)),u.clearSelection(),c=a[0],m(c))return;for(u.setSelection(c.row,c.col,c.rowCount,c.colCount),f=1;f<a.length;f++)c=a[f],u.addSelection(c.row,c.col,c.rowCount,c.colCount);r.selector.val(o),r.cpt=r.selector.val(),i={sheet:e,sheetName:e.name(),row:c.row,col:c.col},e.ki(l.Events.EnterCellInternal,i),n=!0}return n},s=y,l.Commands[a]={canUndo:!1,execute:function(t,n){l.Commands.zA(t,s,n)}},l.Commands.fpt=function(t){t.register(o,l.Commands[o]),t.register(a,l.Commands[a])}},"./dist/plugins/namebox/namebox-list.js":function(t,n,e){"use strict";var i,e,r,o,a;function u(t,n){var t=a.call(this,t)||this;return n&&t.setNameList(n),t}i=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.NameBoxList=void 0,e=e("CellTypes"),a=e.List,i(u,a),u.prototype.setNameList=function(t){var n=this;n.setOptions({items:n.lpt(t),textEllipsis:!0})},u.prototype.lpt=function(t){return t.map(function(t){return{text:t,value:t}})},u.CustomNameChange="CustomNameChange",n.NameBoxList=u},"./dist/plugins/namebox/namebox.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=n.NameBox=void 0,e("./dist/plugins/namebox/namebox-actions.js"),o=e("Core"),a=e("./dist/plugins/namebox/namebox.js"),Object.defineProperty(n,"NameBox",{enumerable:!0,get:function(){return a.NameBox}}),r(e("./dist/plugins/namebox/namebox.ns.js"),n),n.findControl=u=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data("name-box")}},"./dist/plugins/namebox/namebox.js":function(F,h,t){"use strict";var d,s,v,o,a,r,t,u,n,m,c,e,f,l,g,i,p,b,w,y,M,C,S,T,A,t,I,x,N,L;function k(t,n,e){var i,r;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.cpt="",this.hpt=!1,t&&n&&(t instanceof HTMLElement?i=t:"string"==typeof t&&(i=document.getElementById(t)),i)&&((r=this).hpt=!0,r.Ti=i,u(i).data(g,r),r.options=A(N,function(t,n,e){r.Ob(t,n,e)}),r.Zp(e),r.dpt(),r.hpt=!1,r.bind(n))}function _(t,n){var e,i,r,o,n,o,e="",i=n.rowCount,r=n.colCount,o=n.row+1,n=n.col+1;return 1===i&&1===r?e=j(t,o,n):i<0&&0<r?e=r+"C":r<0&&0<i?e=i+"R":i<0&&r<0?(o=R(t))&&(e=o.getRowCount()+"R x "+o.getColumnCount()+"C"):e=i+"R x "+r+"C",e}function D(t,n){var e,i,r,e=!1,i=n.getSpans();if(i)for(r=0;r<i.length;r++)if(i[r].row===t.row&&i[r].col===t.col&&i[r].rowCount===t.rowCount&&i[r].colCount===t.colCount){e=!0;break}return e}function j(t,n,e,i){var r,o,a,u,s,c,f,l,h;if(n<1||e<1)return null;if(r="",a=(o=R(t))&&o.name(),i&&o){if(u=D(i,o),(s=t.getCustomNames())!==m)for(c=0;c<s.length;c++)if((f=s[c].getExpression())&&f.type===d.ExpressionType.reference&&f.source&&f.source.getName&&a===f.source.getName()&&null!==(l=f.getRange(0,0))&&l!==m&&(l.row===i.row&&l.col===i.col&&l.row+l.rowCount===i.row+i.rowCount&&l.col+l.columnCount===i.col+i.colCount||l.row===i.row&&l.col===i.col&&u)){r=s[c].getName();break}if(""===r&&s!==m)for(c=0;c<s.length;c++)(f=s[c].getExpression())&&f.type===d.ExpressionType.reference&&((l=f.getRange(0,0)).row===i.row&&l.column===i.col&&l.row+l.rowCount===i.row+i.rowCount&&l.column+l.columnCount===i.col+i.colCount||l.row===i.row&&l.column===i.col&&u)&&(r=s[c].getName())}if(""===r)switch(t.options.referenceStyle){case 0:for(;0<e;)0==(h=e%26)?(r="Z"+r,e--):r=String.fromCharCode("A".charCodeAt(0)+h-1)+r,e=parseInt((e/26).toString(),10);r+=n.toString();break;case 1:r="R"+n.toString()+"C"+e.toString()}return r}function O(t,n,e){var i,r,r;if(void 0===e&&(e=!1),!(i=n.getActiveSheet())){if((r=n.getActiveSheetTab())&&r._gi===s.SheetType.reportSheet)return!1;i=r.getSheet&&r.getSheet()||r.Mf}return!!i&&!(!(r=t.getExpression())||e&&!G(r,n,i))&&(-1<x.indexOf(r.type)||r.type===d.ExpressionType.operator&&16===r.operatorType)}function B(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return-1!==n&&-1!==i||(i=n=-1),-1!==e&&-1!==t||(t=e=-1),new s.Range(n,e,i,t)}function E(t){if(t)return t.row+"_"+t.col+"_"+t.rowCount+"_"+t.colCount}function P(n,e){var i,t;try{i=(t=r.Common.CultureManager.getCultureInfo()).localeCompare?t.localeCompare(n,e):n.localeCompare(e,"en")}catch(t){i=n.localeCompare(e)}return i}function G(t,n,e){var i,r,o,a,u;try{if(i=!!n.options.referenceStyle,!(r=(0,v.formulaToRanges)(e,(0,v.expressionToFormula)(n,t,e.getActiveRowIndex(),e.getActiveColumnIndex(),i),m,m,m,i))||r.length<1)return;for(o=0,a=r;o<a.length;o++)if(u=a[o],!(n.getSheetFromName(u.sheetName)||n.getSheetTab(u.sheetName)&&n.getSheetTab(u.sheetName)._gi!==s.SheetType.reportSheet))return}catch(t){return}return 1}function U(t){return new RegExp(/[^A-Za-z0-9_.!?'",:\u0080-\uFFFF\\$]+/g).test(t)}function R(t){var n,t,n=t.getActiveSheet();return n=n||(t=t.getActiveSheetTab())&&(t.getSheet&&t.getSheet()||t.Mf)}Object.defineProperty(h,"__esModule",{value:!0}),h.getActiveSheet=h.NameBox=h.PRINT_AREA=void 0,d=t("CalcEngine"),s=t("Core"),v=t("SheetsCalc"),o=t("CellTypes"),a=t("./dist/plugins/namebox/namebox-list.js"),r=t("Common"),t=t("./dist/plugins/namebox/namebox.ns.js"),u=s.GC$,n=null,m=void 0,c="A1",e=".gc-name-box",f="div",l="input",g="name-box",i="_",p="invalid",b="gc-name-box-",w="container",y="selector",M="dropdown",C=r.Common.lt.ht,S=r.Common.zf,T=s.util.En,A=s.util.b0,t=new r.Common.ResourceManager(t.SR,"NameBox"),I=t.getResource.bind(t),h.PRINT_AREA="print_area",x=[d.ExpressionType.reference,d.ExpressionType.name,d.ExpressionType.structReference],N={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},Object.defineProperty(k.prototype,"selector",{get:function(){return u("."+b+y,this.Ti)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"dropdown",{get:function(){return u("."+b+M,this.Ti)},enumerable:!1,configurable:!0}),k.prototype.getHost=function(){return this.Ti},k.prototype.getCustomNameList=function(t){var n,e,e,i,r,o,e,a,u,s,c,f,l,h,d,v,m;if(void 0===t&&(t=!1),!(e=(n=this).vpt))return[];if(!(e=R(e)))return[];for(i=[],r=n.mpt(e,t),o=n.gpt(t),e=r,a=function(t){return t.getName().toLowerCase()},u=function(t){var n=o[t];r.find(function(t){return a(t)===a(n)})&&o.splice(t,1)},s=o.length-1;-1<s;s--)u(s);for(c=0,f=e=e.concat(o);c<f.length;c++)l=f[c],i.push(l.getName());for(d=0,v=h=n.ppt();d<v.length;d++)m=v[d],i.push(m.name);return i},k.prototype.bind=function(t){var n=this;n.unbind(),t&&(n.vpt=t,n._id=t.bpt()),n.rebuild()},k.prototype.unbind=function(){var t=this;t.ypt(),t.wY=n,t.wpt(),t.vpt=n,t._id=n},k.prototype.refresh=function(){this.updateNameRangeSelectorValue()},k.prototype.rebuild=function(){var t=this;t.hpt||(t.wpt(),t.dpt(),t.v7(),t.Mpt(),t.refresh())},k.prototype.executeCommand=function(t,n,e){var i,r,o,i=this,r=i.vpt,o=R(r);o&&r.commandManager().execute({cmd:t,sheetName:e||o.name(),nameBox:i,selectorValue:i.selector.val(),selections:n||o.getSelections()})},k.prototype.dispose=function(){var t=this;t.unbind(),t.wY&&t.wY.dispose(),t.wY=n,t.Cpt&&t.Cpt.close(),t.Cpt=n,u(t.Ti).data(g,n),t.Ti.innerHTML="",t.Ti=n},k.prototype.Ob=function(t,n,e){var i=this;if(n!==e&&(i.options[t]=n,!i.hpt))switch(t){case"dropDownMaxHeight":case"showCustomNameList":i.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":i.refresh()}},k.prototype.Zp=function(t){var e,t,e=this.options,t=t||{};t=u.extend(!0,{},N,t),u.each(t,function(t,n){e.hasOwnProperty(t)&&(e[t]=n)})},k.prototype.Mpt=function(){var t=this;t.wY&&t.wY.setNameList(t.Spt())},k.prototype.Spt=function(){var e=this.getCustomNameList(!0),e;return e=e.filter(function(t,n){return e.indexOf(t)===n}).sort(P)},k.prototype.ypt=function(){var t=this;t.Cpt&&(t.Cpt.close(),t.Cpt=n,t.wY=n)},k.prototype.Tpt=function(){var t,n,e,e,e,i,r,t=this;t.ypt(),(e=R(n=t.vpt))&&!e.isReportTemplateSheet&&(e=T(f),e=new a.NameBoxList(e,t.Spt()),i=new o.PopupControl(e.getContainer(),t.Ti,{align:s.DropDownAlignment.Near,hostElement:t.vpt.getHost(),direction:s.DropDownDirection.Down,Oue:t.vpt&&t.vpt.options.enableAccessibility}),r=+t.options.dropDownMaxHeight||N.dropDownMaxHeight,u(e.getContainer()).css(["width","maxHeight"],[u(t.Ti).width(),r+"px"]).addClass("gc-name-box-list"),i.open(),t.wY=e,t.Cpt=i)},k.prototype.dpt=function(){var t,n,e,i,r,t=this,n=t.Ti;n.innerHTML="",(e=T(f)).classList.add(b+w),i=T(l),t.vpt&&t.vpt.options.enableAccessibility&&(i.setAttribute("aria-label",I().nameBox),i.setAttribute("role","combobox"),i.setAttribute("aria-expanded","false"),i.setAttribute("aria-autocomplete","list")),i.classList.add(b+y),t.options.showCustomNameList&&(r=T(f)).classList.add(b+M),e.appendChild(i),r&&e.appendChild(r),n.appendChild(e)},k.prototype.jf=function(t){var n;if(t=t||this.vpt)return(n=R(t))||void 0},k.prototype.Apt=function(){return e+(this._id||"")},k.prototype.v7=function(){var i,e,t,n,i=this,e=i.vpt,t=i.Ti,n=i.Apt();e.bind(s.Events.SelectionChanging+n,t,function(){var t,t,t,t,t=i.jf();t&&t.getSelections&&null!==(t=(t=t.getSelections())[t.length-1])&&t!==m&&(t=_(e,t),i.selector.val(t||""),i.cpt=t||"")}),e.bind(s.Events.InternalSelectionChanging+n,t,function(t,n){var n,n,n=n.newSelections;null!==n&&n!==m&&(n=_(e,n),i.selector.val(n||""),i.cpt=n||"")}),e.bind(s.Events.SelectionChanged+n,function(t,n){var e=i.Ipt();i.updateNameRangeSelectorValue(e,n.shiftKey)}),e.bind(s.Events.DragDropBlockCompleted+n,function(){i.updateNameRangeSelectorValue()}),e.bind(s.Events.ActiveSheetChanged+n,function(){i.updateNameRangeSelectorValue()}),e.bind(s.Events.ActiveSheetChangedInternal+n,function(){i.updateNameRangeSelectorValue()}),e.bind(s.Events.EnterCellInternal+n,function(){i.updateNameRangeSelectorValue()}),e.bind(s.Events.ClipboardPasted+n,function(){i.updateNameRangeSelectorValue()}),e.bind(s.Events.ShapeSelectionChanged+n,function(){i.I2t||i.updateNameRangeSelectorValue()}),e.bind(s.Events.FloatingObjectSelectionChanged+n,function(){i.I2t||i.updateNameRangeSelectorValue()}),i.selector.bind("blur"+n,i.xpt.bind(i)),i.selector.bind("keydown"+n,i.Npt.bind(i)),i.selector.bind("focus"+n,function(){i.selector[0].select()}),i.dropdown.bind("mousedown"+n,i.kpt.bind(i))},k.prototype.wpt=function(){var t,n,e,t=this,n=t.vpt,e=t.Apt();n&&n.unbind(e),t.selector.unbind(e),t.dropdown.unbind(e),u(document).unbind(e)},k.prototype.updateNameRangeSelectorValue=function(t,n){var e,i,t,i,t,i,r,o,a,e=this;!C(t)&&e.selector?(e.selector.val(t||""),e.cpt=e.selector.val()):0<(i=(t=e.Dpt()).length)?(i=1===i?t[0].name():"",e.selector&&(e.selector.val(i),e.cpt=e.selector.val())):(t=e.Ipt(),C(t)?(r=R(i=e.vpt))?null!==(o=r.getSelections()[r.getSelections().length-1])&&o!==m&&(a=void 0,a=n?_(i,o):j(i,r.getActiveRowIndex()+1,r.getActiveColumnIndex()+1,o),e.selector)&&(e.selector.val(a||""),e.cpt=e.selector.val()):e.selector.val(c):(e.selector.val(t),e.cpt=e.selector.val()))},k.prototype.Ipt=function(){var t,n,e,i,r,o,r,a,t=this,n,e=R(t.vpt),i="";if(e)return r=e.getSelections(),o=e.name(),1===r.length?(i=E(B(r=r[0])),a="",D(r,e)&&(a=E(new s.Range(r.row,r.col,1,1))),t._pt(i)||t.Ept(i,a,o)):void 0},k.prototype.Ept=function(t,n,e){var i,r,o,a,u,s,c,f,l,f,l;if(t||n)for(a=0,u=o=(i=this).mpt().concat(i.gpt());a<u.length;a++)if(f=(c=(s=u[a]).getName()).toLowerCase()===h.PRINT_AREA,l=(r=s.WK)&&r.source,(f&&!l||l&&l instanceof v.SheetSource&&l.getName()===e)&&(f=r.getRange(s.FY||0,s.jpt||0))&&(t===(l=E(f))||n===l))return c},k.prototype._pt=function(t){var n,e,i,r;if(t)for(e=0,i=n=this.ppt();e<i.length;e++)if(t===E((r=i[e]).range))return r.name},k.prototype.mpt=function(t,n){var e,i;return void 0===n&&(n=!1),e=this.vpt,i=[],(i=(t=t||e&&R(e))?t.getCustomNames():i).filter(function(t){return O(t,e,n)})},k.prototype.gpt=function(n){var e,t;return void 0===n&&(n=!1),t=[],(t=(e=this.vpt)&&e.getCustomNames()).filter(function(t){return O(t,e,n)})},k.prototype.ppt=function(){for(var t,n,e,i,r,o,a,u,s,c,t,n,e=[],i=[],r=0,o=this.vpt.sheets;r<o.length;r++)(a=o[r]).tables&&(i=i.concat(a.tables.all()));for(u=0,s=i;u<s.length;u++)c=s[u],e.push({name:c.name(),range:c.dataRange()});return e},k.prototype.Dpt=function(){var n,t,e,n=[],t,e;return this.Opt().forEach(function(t){t.isSelected()&&n.push(t)}),n},k.prototype.Opt=function(t){var n,t,n,e,i,t,n=this.vpt,t=t||R(n);return t?(n=t.shapes&&t.shapes.all()||[],e=t.floatingObjects&&t.floatingObjects.all()||[],i=[],t.charts&&t.charts.tIe&&(i=t.charts.all()),t=t.pictures&&t.pictures.all()||[],n.concat(i).concat(t).concat(e)):[]},k.prototype.Kfe=function(t){var n,e,i,r,o,a,u;if(t){for(e=(n=this).Opt(),i=t.split(",").map(function(t){return t.trim()}),o=function(t){var n,t,n=i[t],t=e.find(function(t){return t.name()===n});if(!t)return{value:void 0};(r=r||[]).includes(t)||r.push(t)},a=0;a<i.length;a++)if("object"==typeof(u=o(a)))return u.value;return r}},k.prototype.xpt=function(){var t,n,e,i,r,i,t=this,n=t.selector.val(),i=t.Kfe(n);if(i)t.Bpt(),i.forEach(function(t){return t.isSelected(!0)});else if(!n||0<t.Dpt().length)t.Jfe||t.I2t||t.Bpt(),t.updateNameRangeSelectorValue(n);else if(t.cpt.toLocaleUpperCase()!==n.toLocaleUpperCase()){i=R(r=t.vpt);try{e=t.Lpt()}catch(t){if(t.message===p&&i)return void i.jT(15,I().invalidName)}e&&e.sheetName?t.options.enableNavigateToRange&&0<e.ranges.length&&(t.Bpt(e.sheetName),t.executeCommand(t.navigateToRangeCommand,e.ranges,e.sheetName)):t.options.enableAddCustomName&&!i.isReportTemplateSheet&&t.executeCommand(t.addCustomNameCommand)}},k.prototype.Npt=function(t){var n,e,i,n=this,e=n.selector.val();"Enter"===t.key&&(n.Jfe=!1,(i=n.Kfe(e))?(n.Bpt(),n.I2t=!0,i.forEach(function(t){return t.isSelected(!0)}),n.updateNameRangeSelectorValue(),n.I2t=!1,n.Jfe=!0):0<n.Dpt().length&&e&&(n.Dpt()[0].name(e),n.Jfe=!0),t.currentTarget.blur(),n.Jfe=!1,n.vpt)&&n.vpt.focus(!0),t&&t.stopPropagation&&t.stopPropagation()},k.prototype.kpt=function(){var e=this;e.Tpt(),e.wY&&e.wY.on("ValueChangedEvent",function(t){var t,n,t=t.value;C(t)&&!t||(n=e.selector.val(),e.updateNameRangeSelectorValue(t),e.cpt=n,e.xpt()),e.ypt()})},k.prototype.Bpt=function(t){var n,e,t,i,r,o,a,n=this,e=n.vpt,t=e.getSheetFromName(t)||R(e);if(t)for(r=0,o=i=n.Opt(t);r<o.length;r++)(a=o[r]).isSelected()&&a.isSelected(!1)},k.prototype.Lpt=function(){var t,n,e,i,r,o,a,u,s,c,c,f,c,t=this,n=t.selector.val(),i=t.vpt,r=R(i);if(U(n=n.replace(/, /g,",")))throw new Error(p);if(o=n.split(","),a={ranges:[],sheetName:""},r)for(u=0,s=o;u<s.length;u++)if(c=s[u],e=(0,v.formulaToRanges)(r,c,r.getActiveRowIndex(),r.getActiveColumnIndex()),C(e)||0===e.length){if(1<o.length)throw new Error(p);r.isReportTemplateSheet&&(f=(c=i.getCustomName(c))&&c.WK)&&(a.ranges.push(f.getRange(c.getRow()||0,c.getColumn()||0)),a.sheetName=f.source.getName())}else if(1===e.length){if(c=e[0],a.sheetName&&c.sheetName!==a.sheetName)throw new Error(p);if(!i.getSheetFromName(c.sheetName))throw new Error(p);a.ranges=a.ranges.concat(c.ranges),a.sheetName=c.sheetName}return a},h.NameBox=k,s.Workbook.ch("nameBox",{init:function(){s.Commands.fpt(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){I()}}),u.extend(s.Workbook.prototype,{bpt:function(){var t=this.curNameBoxId+(new Date).getTime().toString();return this.curNameBoxId+=1,t}}),h.getActiveSheet=R},"./dist/plugins/namebox/namebox.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/namebox/namebox.res.en.js");n.SR={en:e}},"./dist/plugins/namebox/namebox.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.nameBox=n.invalidName=void 0,n.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection.",n.nameBox="Name Box"},"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(t,n,e){"use strict";var i,a,u,e,d,r,o,s,c,f,l,h,v,m,g,p,b,w,y,M;function C(t,n,e,i){return T(t,n,e,i)}function S(t,n,e,i){t.ki(u.Events.OutlineColumnCheckStatusChanged,{sheet:t,sheetName:t.name(),row:n,col:e,status:i})}function T(t,n,e,i){var i,r,o,a,u,s,c,f,l,h,h,i=d(i)?t.getActiveColumnIndex():i;if(!t.outlineColumn.Un(i))return null;if(r=n?1:-1,o=t.getActiveRowIndex(),a=t.getSelections()[0].rowCount,s=!0,d(e))for(s=!(e={}),u=o;u<a+o;u++)0===u||(c=t.rowOutlines.getLevel(u),n&&(f=t.rowOutlines.getLevel(u-1))<c&&!e[u-1])||(l=c+r,h=t.outlineColumn.options(),(h=(d(h.maxLevel)?t.outlineColumn.Fpt():h).maxLevel)&&h<l+1)||l+1<0||(e[u]={row:u,original:c+1,current:l+1},s=!0);return s?e:null}function A(t,n,e){var i,r,o;if(n){for(r in i=d(e)?t.getActiveColumnIndex():e,t.outlineColumn.Xst(),t.suspendPaint(),n)a.Common.kh(n,r)&&(o=n[r],t.getCell(o.row,i).textIndent(o.current));t.resumePaint(),t.outlineColumn.$st()}}function I(t,n,e,i){var r,o,a,u,s,c,f,l,r=0,o=0,u=t.rowOutlines.getLevel(n);if(t.outlineColumn.mst.updateCheckStatus(n,i),null!==(s=n<=t.getRowCount()-2?t.rowOutlines.find(n+1,u+1):null)&&null!==i)for(c=s.start;c<s.end+1;c++)t.outlineColumn.mst.updateCheckStatus(c,i);for(s=t.rowOutlines.find(n,u);null!==s&&null!==s.parent;){if(0<s.start){for(r=s.start-1,o=t.rowOutlines.getLevel(r),t.outlineColumn.mst.updateCheckStatus(r,i),c=(a=t.rowOutlines.find(1+r,o+1)).start;c<a.end+1;c++)if((f=t.outlineColumn.mst.vst[c].checkBox.checkStatus)!==i){t.outlineColumn.mst.updateCheckStatus(r,l="number"==typeof f&&"number"==typeof i&&3);break}c===a.end+1&&!0===i&&t.outlineColumn.mst.updateCheckStatus(r,!0)}s=s.parent}}function x(t){var n=t.Mf,e=u.Commands.TI(n.name()),t=t.tT[e];n.Ut.undo(t)}function N(t,n){return b.call(this,t,n)||this}function k(t,n){return w.call(this,t,n)||this}function _(t,n){return y.call(this,t,n)||this}function D(t,n){return M.call(this,t,n)||this}i=this&&this.__extends||(p=function(t,n){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.setCheckStatus=n.outlineColumnCheckStatus=n.commands=void 0,a=e("Common"),u=e("Core"),Object.defineProperty(n,"commands",{enumerable:!0,get:function(){return u.Commands}}),e=u.Commands.ActionBase,d=a.Common.lt.ht,r="increaseCellIndent",o="decreaseCellIndent",s="updateOutlineColumnCheckStatus",c="updateOutlineColumnOption",n.outlineColumnCheckStatus=f="outlineColumnCheckStatus",l=u.Commands.zA,n.setCheckStatus=I,i(N,b=e),N.prototype.canExecute=function(){return!!C(this.Mf,!0,this.tT.changingRows,this.tT.changingColumns)},N.prototype.canUndo=function(){return!0},N.prototype.execute=function(){var t,n;return!!this.canExecute()&&((t=this.Mf).Ut.startTransaction(),t.outlineColumn.mst.Ppt(),d(this.tT.changingColumns)&&(this.tT.changingColumns=t.getActiveColumnIndex()),this.tT.changingRows=T(t,!0,this.tT.changingRows,this.tT.changingColumns),A(this.Mf,this.tT.changingRows,this.tT.changingColumns),n=u.Commands.TI(t.name()),this.tT[n]=t.Ut.endTransaction(),!0)},N.prototype.undo=function(){var t,n,e,t,t=this,n=t.Mf,e=u.Commands.TI(n.name()),t=t.tT[e];return n.Ut.undo(t),!0},h=N,i(k,w=e),k.prototype.canExecute=function(){return!!C(this.Mf,!1,this.tT.changingRows,this.tT.changingColumns)},k.prototype.canUndo=function(){return!0},k.prototype.execute=function(){var t,n;return!!this.canExecute()&&((t=this.Mf).Ut.startTransaction(),t.outlineColumn.mst.Ppt(),d(this.tT.changingColumns)&&(this.tT.changingColumns=t.getActiveColumnIndex()),this.tT.changingRows=T(t,!1,this.tT.changingRows,this.tT.changingColumns),A(t,this.tT.changingRows,this.tT.changingColumns),n=u.Commands.TI(t.name()),this.tT[n]=t.Ut.endTransaction(),!0)},k.prototype.undo=function(){return x(this),!0},v=k,i(_,y=e),_.prototype.canExecute=function(){return!0},_.prototype.canUndo=function(){return!0},_.prototype.execute=function(){var t,n,t,e,i,e,t=this,n=t.Mf,t=t.tT,e=t.options,i=JSON.parse(JSON.stringify(n.outlineColumn.NB));return n.Ut.startTransaction(),n.outlineColumn.NB=e,n.outlineColumn.refresh(),t[e=u.Commands.TI(n.name())]=n.Ut.endTransaction(),t[e].oldOptions=i,!0},_.prototype.undo=function(){return x(this),this.Mf.outlineColumn.refresh(),!0},m=_,i(D,M=e),D.prototype.canExecute=function(){return!0},D.prototype.canUndo=function(){return!0},D.prototype.execute=function(){var t,n,t,e,i,r,o,t=this,n=t.Mf,t=t.tT,e=t.row,i=t.col,r=t.status;return n.Ut.startTransaction(),I(n,e,i,r),n.outlineColumn.refresh(),t[o=u.Commands.TI(n.name())]=n.Ut.endTransaction(),S(n,e,i,r),!0},D.prototype.undo=function(){return x(this),this.Mf.outlineColumn.refresh(),!0},g=D,u.Commands[r]={canUndo:!0,execute:function(t,n,e){return n.cmd=r,l(t,h,n,e)}},u.Commands[o]={canUndo:!0,execute:function(t,n,e){return n.cmd=o,l(t,v,n,e)}},u.Commands[c]={canUndo:!0,execute:function(t,n,e){return n.cmd=c,l(t,m,n,e)}},u.Commands[s]={canUndo:!0,execute:function(t,n,e){return n.cmd=s,l(t,g,n,e)}},u.Commands.Gpt=function(t){var n=u.mt.Qf(),e=!n,n=n;t.register(r,u.Commands[r],221,e,!1,!0,n),t.register(o,u.Commands[o],219,e,!1,!0,n),t.register(s,u.Commands[s]),t.register(c,u.Commands[c])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/outlineColumn/outlineColumn.js"),n),r(e("./dist/plugins/outlineColumn/outlineColumn-actions.js"),n),r(e("./dist/plugins/outlineColumn/outlineColumn.ns.js"),n)},"./dist/plugins/outlineColumn/outlineColumn.js":function(F,t,n){"use strict";var u,e,i,n,r,o,s,a,f,l,h,m,g,c,p,d,v,b,w,y,M,C,r,S,T,A,I,L,B,P;function G(t){return t.expandIndicator||t.collapseIndicator}function x(t,n){return t&&t.outlineColumn&&t.outlineColumn.options()&&t.outlineColumn.options().columnIndex===n}function U(t,n,e){var i,r,o,a,i=n.x+e.x,r=e.y+e.height/2-n.height/2,o=n.height,a=n.width;e.x+e.width<i+a||(t.save(),t.beginPath(),t.strokeStyle="black",t.strokeRect(i,r,a,o),t.fillStyle="white",t.fillRect(i,r,a,o),3===n.checkStatus?(t.beginPath(),t.fillStyle="black",t.rect(i+a/5,r+o/5,a-.4*a,o-.4*o),t.fill()):!0!==n.checkStatus&&1!==n.checkStatus||(t.beginPath(),t.lineWidth=a/5,t.moveTo(i+a/6,r+o/2),t.lineTo(i+2*a/5,r+5/7*o),t.lineTo(i+5/6*a,r+o/6),t.stroke()),t.restore())}function H(t,n,e,i){var r,o,a,u,s,r=n.collapsed,o=n.x+e.x,a=e.y+e.height/2-n.height/2,u=n.height,s=n.width;e.x+e.width<o+s||(r?n.expandIndicator?N(t,n.expandIndicator,n,e,i):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(o,a),t.lineTo(o,a+u),t.lineTo(o+s,a+u/2),t.fill(),t.restore()):n.collapseIndicator?N(t,n.collapseIndicator,n,e,i):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(o,a+u),t.lineTo(o+s,a+u),t.lineTo(o+s,a),t.fill(),t.restore()))}function N(t,n,e,i,r){var o,a,u,e,s,o=e.x+i.x,a=i.y+i.height/2-e.height/2,u=e.width,e=e.height;if(!(i.x+i.width<o+u)&&n&&"none"!==n&&r)try{r.getState(n)?(s=r.getImage(n),t.drawImage(s,0,0,s.width,s.height,o,a,u,e)):r.addImage(n)}catch(t){}}function k(t,n,e,i){var t={sheet:t,sheetName:t.name(),isRowGroup:!0,index:n,level:e};return i&&(t.cancel=!1),t}function _(t,n,e){var i,r,i,o,i=t.options,r;t.isActualProtected()&&!i.protectionOptions.allowOutlineRows?t.jT(u.InvalidOperationType.groupProtected,S().Exp_GROUP_PROTECTED):(i=t.rowOutlines.getLevel(n),h(e)&&(e=!t.rowOutlines.getCollapsed(n)),o=k(t,n+1,i+1,!0),t.ki(u.Events.RangeGroupStateChanging,o),o&&!1===o.cancel&&(t.Qy().execute({cmd:"expandRowOutline",sheetName:t.name(),index:n,level:i+1,collapsed:e}),t.ki(u.Events.RangeGroupStateChanged,k(t,n+1,i+1,!1))))}function D(t,n,e,i){var e,n,n={cmd:"updateOutlineColumnCheckStatus",row:n,col:e,status:i=h(i)?typeof(e=t.outlineColumn.getCheckStatus(n))===M?1===e?2:1:!e:i,sheetName:t.name()};t.Qy().execute(n)}function V(t,n,e){var i,r,o,a,i=t.getLevel(n);if(e!==i+1)for(r=e-(i+1),o=0,a=Math.abs(r);o<a;o++)0<r?t.group(n,1):t.ungroupRange(n,1)}function z(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,e,u;j(e,"showIndicator")?(s=t.zoom(),c=t.getRowCount(),f=!!t.rowOutlines.isCollapsed(n+1),l=m*s,h=g*s,v=d=null,e.expandIndicator&&(d=e.expandIndicator,f)&&(l=b*s,h=w*s),e.collapseIndicator&&(v=e.collapseIndicator,f||(l=b*s,h=w*s)),n<c-1&&((e=t.getActualStyle(n+1,i))&&e.textIndent>r?a.indicator={x:o.value+p*s,y:-h/2,width:l,height:h,collapsed:f,collapseIndicator:v,expandIndicator:d}:delete a.indicator),o.value+=2*p*s+l):delete a.indicator}function j(t,n){return(h(t[n])?T:t)[n]}function O(t,n,e){for(var i,r,o,a,u,i=-1,r=0,o=t.children,a=t.start;a<=t.end;a++)if(u=void 0,o&&o[r]&&o[r].start-1===a?(u=O(o[r],n,e),a=o[r].end,r++):u=n[a]&&n[a].checkBox&&n[a].checkBox.checkStatus,-1===i)i=u;else if(i!==u){i=typeof u===M&&typeof i===M&&3;break}for(;r<t.children.length;r++)O(o[r],n,e);return e.updateCheckStatus(t.start-1,i),i}function Y(t){var n,e,t,n=t.rowOutlines,e=t.outlineColumn.mst,t=n.find(0,-1);t.children&&t.children.forEach(function(t){O(t,e.vst,e)})}function Z(t,n,e,i,r,o){var a,e,t,a;(h(e.showCheckBox)?T:e).showCheckBox?(e=!h(o.checkBox)&&1!==o.checkBox&&o.checkBox.checkStatus,t=t.zoom(),o.checkBox={x:r.value+p*t,y:-c*t,width:2*c*t,height:2*c*t,checkStatus:e},r.value+=2*p*t+2*c*t):delete o.checkBox}function W(t,n,e,i,r){var o,e,t,e,n,a,o;(h(e.showImage)?T:e).showImage&&(e=e.images,t=t.zoom(),e)&&e.length?(e=n>e.length-1?e[e.length-1]:e[n],n=i.value+p*t,r.images={image:e,x:n,y:a=0,width:d*t,height:v*t},i.value+=2*p*t+d*t):delete r.images}function Q(t,n,e){var i,r,o,a,u,u,u,i=t.outlineColumn.options(),r=i&&i.columnIndex;h(r)||(o={value:0},a=0,(u=t.getActualStyle(n,r))&&u.textIndent&&(a=u.textIndent),0!==n&&3<=a-(u=t.rowOutlines.getLevel(n-1))&&(a=u+2),o.value+=8*a,u=o.value,V(t.rowOutlines,n,a),z(t,n,i,r,a,o,e),Z(t,n,i,r,o,e),W(t,a,i,o,e),t.outlineColumn.xme=o.value-u,e.cellContent={left:o.value,x:o.value,y:0,width:-o.value,height:0})}function E(t){this.Mf=t,this.NB={},this.Upt=0}function R(t){var n=this;n.Mf=t,n.vst={}}function J(t,n){var e,i,r,o,a,u,s;function c(t,n){var e;return T[t]===n}if(e=t.NB,i=t.mst.vst,!h(e)){if(r={},f(T,function(t){o=e[t],h(o)||c(t,o)||(r[t]=o)}),a={},e.showCheckBox)for(u in i)i.hasOwnProperty(u)&&(s=i[u].checkBox.checkStatus)&&(a[u]={checked:s});l(a)||(r.data=a),n.outlineColumnOptions=r}}function K(t,n){var e,i,r;if(n){if(i=void 0,e=n.data){for(r in i={},n)"data"!==r&&(i[r]=n[r]);t.Hpt(e)}t.options(h(i)?n:i),t.refresh()}}Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineColumn=void 0,u=n("Core"),e=n("Common"),i=n("./dist/plugins/outlineColumn/outlineColumn-actions.js"),n=n("./dist/plugins/outlineColumn/outlineColumn.ns.js"),r=e.Common.Uf,o=r.tR,s=e.Common.J8,a=e.Common.X8,f=u.GC$.each,l=u.GC$.isEmptyObject,h=e.Common.lt.ht,m=5,c=g=6,p=3,w=b=v=d=16,y=void 0,M="number",C=null,r=new e.Common.ResourceManager(n.SR,"OutlineColumn"),S=r.getResource.bind(r),T={columnIndex:y,showCheckBox:!1,showImage:!1,images:y,showIndicator:!0,expandIndicator:y,collapseIndicator:y,maxLevel:10},E.prototype.L0=function(){var t=this;t.Mf=C,t.mst=C,t.NB=C},E.prototype.a7=function(t,n){return this.NB&&this.NB.columnIndex===n?this.mst.vst[t].cellContent.left:null},E.prototype.options=function(t){var n,e,n=this,e=n.NB;return o(arguments)?(n.NB=t,n.refresh(),n):e},E.prototype.refresh=function(){var t=this.Mf;h(this.NB)||h(this.NB.columnIndex)||0===this.Upt&&(t.suspendPaint(),t.outlineColumn.mst.updateModel(),t.resumePaint())},E.prototype.setCheckStatus=function(t,n){var e=this.NB.columnIndex;h(e)||D(this.Mf,t,e,n)},E.prototype.dst=function(t){this.Mf.outlineColumn.mst.setAllTiemCheckStatus(t),this.refresh()},E.prototype.getCheckStatus=function(t){var n,e;if(o(arguments))return this.Mf.outlineColumn.mst.getCheckStatus(t);for(n=[],e=this.Mf.getRowCount(),t=0;t<e;t++)n[t]=this.Mf.outlineColumn.mst.getCheckStatus(t);return n},E.prototype.setCollapsed=function(t,n){_(this.Mf,t,n)},E.prototype.getCollapsed=function(t){var n,e;if(o(arguments))return this.Mf.outlineColumn.mst.getCollapsed(t);for(n=[],e=this.Mf.getRowCount(),t=0;t<e;t++)n[t]=this.Mf.outlineColumn.mst.getCollapsed(t);return n},E.prototype.reset=function(){var t;h(this.NB)||h(this.NB.columnIndex)||(t=this.Mf,this.NB=T,t.suspendPaint(),t.outlineColumn.mst.updateModel(),t.resumePaint())},E.prototype.Un=function(t){return this.NB&&this.NB.columnIndex===t},E.prototype.xB=function(){return this.NB&&!h(this.NB.columnIndex)},E.prototype.Xst=function(){this.Upt++},E.prototype.$st=function(){0<this.Upt&&this.Upt--,0===this.Upt&&this.refresh()},E.prototype.zpt=function(t,n){this.Mf.outlineColumn.mst.insertRows(t,n)},E.prototype.yE=function(t,n){this.Mf.outlineColumn.mst.deleteRows(t,n)},E.prototype.Fpt=function(){return T},E.prototype.Vpt=function(){return{TRIANGLE_HEIGHT:m,TRIANGLE_BASE:g,CHECKBOX_RADIUS:c,GAP:p,IMAGE_WIDTH:d,IMAGE_HEIGHT:v,INDICATOR_IMAGE_WIDTH:b,INDICATOR_IMAGE_HEIGHT:w}},E.prototype.Hpt=function(t){var n,e,i,n=this;for(e in t)t.hasOwnProperty(e)&&((i=n.mst.vst[e]=n.mst.vst[e]||{}).checkBox={checkStatus:t[e].checked})},E.prototype.ect=function(t,n){var e=this.NB.columnIndex;h(e)||(0,i.setCheckStatus)(this.Mf,t,e,n)},E.prototype.ost=function(){return this.mst.vst},A=E,t.OutlineColumn=A,R.prototype.L0=function(){this.Mf=C},R.prototype.updateIndicatorCollapsed=function(t,n){var e=this;h(e.vst[t])||h(e.vst[t].indicator)||(e.vst[t].indicator.collapsed=n)},R.prototype.updateCheckStatus=function(t,n){var e,i,e=this;e.Ppt(t),h(e.vst[t])||((i=e.vst[t].checkBox)&&(i.checkStatus=n),e.Ppt(t,!0))},R.prototype.setAllTiemCheckStatus=function(t){var n,e,i,r,n,e=this.vst;for(i in e)e.hasOwnProperty(i)&&(r=e[i].checkBox)&&(r.checkStatus=t)},R.prototype.getCheckStatus=function(t){var n=this;return h(n.vst[t])||h(n.vst[t].checkBox)?null:n.vst[t].checkBox.checkStatus},R.prototype.getCollapsed=function(t){var n=this;return!h(n.vst[t])&&!h(n.vst[t].indicator)&&n.vst[t].indicator.collapsed},R.prototype.updateModel=function(){var t,n,e,i,r,o,r,a,t=this,n=t.Mf,e=n.getRowCount();for(n.rowOutlines.direction(0),i=0;i<e;i++)t.vst[i]=t.vst[i]||{},Q(n,i,t.vst[i]);r=n.outlineColumn.options(),(o=(h(r.showCheckBox)?T:r).showCheckBox)&&Y(n),(r=n.NMi)&&r.options.allowAddNew&&delete t.vst[a=e-1]},R.prototype.insertRows=function(t,n){var e=this;e.Ypt(t,n),e.Zpt(t,n)},R.prototype.Ypt=function(t,n){var e,i,i,r,o,e=this.Mf,i=e.outlineColumn.options();h(i)||(i=i.columnIndex,h(i))||(o=0,(r=e.getActualStyle(t-1,i))&&r.textIndent&&(o=r.textIndent),e.getRange(t,i,n,1).textIndent(o))},R.prototype.Zpt=function(t,n){var e,i,r,o,r,a,e=this,i=e.vst,r=i[t-1],o=r&&r.checkBox,r=e.Mf.getRowCount();for(s(i,r,t,n),a=0;a<n;a++)i[t+a]={checkBox:{checkStatus:o&&o.checkStatus}}},R.prototype.deleteRows=function(t,n){this.Wpt(t,n)},R.prototype.Wpt=function(t,n){var e,i,e,e=this,i=e.vst,e=e.Mf.getRowCount();a(i,e,t-1,n)},R.prototype.Qpt=function(t,n){var e,e,e=this.vst[n];e&&!t[n]&&(e=e.checkBox,t[n]={checked:e&&e.checkStatus})},R.prototype.Kpt=function(t){var n,e,i,n=this,e=this.vst;for(i in e)e.hasOwnProperty(i)&&n.Qpt(t,i)},R.prototype.Jpt=function(t){var n,e,n=this.vst;for(e in t)h(t[e].checked)||(n[e].checkBox.checkStatus=t[e].checked)},R.prototype.Xpt=function(t){var n=this.Mf.Ut.G8;return n?(n.outlineColumnChanges||(n.outlineColumnChanges={items:{}}),n.currentOutlineColumnChanges||(n.currentOutlineColumnChanges={items:{}}),t?n.currentOutlineColumnChanges:n.outlineColumnChanges):y},R.prototype.Ppt=function(t,n){var e=this,n=e.Xpt(n);n&&!n.all&&(h(t)?(n.all=!0,e.Kpt(n.items)):e.Qpt(n.items,t))},R.prototype.qpt=function(t){this.Jpt(t.items)},I=R,u.GC$.extend(u.Y8.prototype,{qpt:function(t){var n=this,e=n.$pt,i=e.mst;e.xB()&&(i.updateModel(),t&&i.qpt(t),n.Mf.zw())}}),u.Y8.ch("outlineColumn",{init:function(){var t=this,n=t.Mf;t.$pt=new A(n),t.$pt.mst=new I(n)},applyChanges:function(t){var n,t,e,e,n=t.changes,t=t.isUndo;n&&((e=n.outlineColumnOption)&&this.$pt.options(t?e.oldValue:e.value),e=t?n.outlineColumnChanges:n.currentOutlineColumnChanges)&&this.qpt(e)},undo:function(t){var n=t.outlineColumnChanges;n&&!t.oldOptions&&this.qpt(n)},dispose:function(t){var n=this,e;!1!==(t&&t.clearCache)&&n.$pt&&(n.$pt.mst&&(n.$pt.mst.L0(),n.$pt.mst=C),n.$pt.L0(),n.$pt=C)}}),u.Worksheet.ch("outlineColumn",L={init:function(){var t=this;t.outlineColumn=t.Ut.$pt},dispose:function(t){var t,n;!1!==t.clearCache&&(n=(t=this).outlineColumn)&&(n.L0(),t.outlineColumn=C)},toJson:function(t){J(this.outlineColumn,t)},fromJson:function(t){K(this.outlineColumn,t.outlineColumnOptions)},wh:function(t){t.lossless||(t.lossless={}),J(this.outlineColumn,t.lossless)},yh:function(t){K(this.outlineColumn,t&&t.lossless&&t.lossless.outlineColumnOptions)},onLayoutChanged:function(t){var n,e,i,r,o,t,t,a,u,n=this,e=n.outlineColumn,i=t.changeType,r=t.row,o=t.rowCount,t=t.sheetArea,t=h(t)||3===t;if("addRows"===i&&t)e.mst.Ppt(),e.zpt(r,o),e.mst.Ppt(null,!0),e.refresh();else if("deleteRows"===i&&t)e.mst.Ppt(),e.yE(r,o),e.mst.Ppt(null,!0),e.refresh();else if("zoomSheet"===i)e.refresh();else if("invalidateLayout"===i&&e.mst.vst&&!l(e.mst.vst)&&n.rowOutlines.items&&!l(n.rowOutlines.items))for(u in a=n.rowOutlines.items)a.hasOwnProperty(u)&&e.mst.updateIndicatorCollapsed(parseInt(u,10),n.rowOutlines.isCollapsed(parseInt(u,10)+1))},sortRangeChanged:function(t){for(var n,e,i,r,n=this.outlineColumn,e=t.column,i=t.columnCount,r=e;n.Un(r)&&r<=e+i;)n.refresh(),r+=1}}),u.CellTypes.Base.ch("outlineColumn",B={paintCellPadding:function(t){var n,e,i,r,o,a,o,n=t.options.rect,e=t.options.context.sheet,i=t.options.context,r=i.row,o=i.col,a=t.ctx;x(e,o)&&0<n.width&&0<n.height&&(t.options.context.sheetArea!==u.SheetArea.colHeader||!e.NMi)&&(o=e.outlineColumn.mst.vst[r])&&(a.save(),o.indicator&&H(a,o.indicator,n,i.imageLoader),o.checkBox&&U(a,o.checkBox,n),o.images&&N(a,o.images.image,o.images,n,i.imageLoader),a.restore(),o.cellContent)&&(n.x+=o.cellContent.left,n.width-=o.cellContent.left)},getCellPaddingRect:function(t){var n,e,t,i,r,t,n=t.options.rect,e=t.options.context.sheet,t=t.options.context,i=t.row,r;x(e,t.col)&&0<n.width&&0<n.height&&(t=e.outlineColumn.mst.vst[i])&&t.cellContent&&(n.x+=t.cellContent.left,n.width-=t.cellContent.left)},getCellPaddingHitInfo:function(t){var n,e,i,r,o,a,u,s,c,u,f,n=t.context.sheet,e=t.context.col,i=t.context.row,r=t.x,o=t.y,a=t.cellRect,u=n.outlineColumn;if(t.paddingHitInfo=null,u&&u.NB){for(s=u.mst.vst[i],c=u.NB.columnIndex,a=a.clone();c<e;)a.x-=n.getColumnWidth(--e);s&&e===c&&(f=u=void 0,s.indicator&&(u=s.indicator.x,(f=s.indicator.x+a.x)<=r)&&r<f+s.indicator.width&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{indicator:!0}}),s.checkBox&&(u=u||s.checkBox.x,(f=s.checkBox.x+a.x)<=r)&&r<f+s.checkBox.width&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{checkBox:!0}}),s.images&&(u=u||s.images.x,(f=s.images.x+a.x)<=r)&&r<f+s.images.width&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{image:!0}}),u)&&r>=a.x&&r<a.x+u&&(t.paddingHitInfo={x:r,y:o,row:i,col:e,outlineColumnHitInfo:{blank:!0}})}},processMouseDownOnCellPadding:function(t){var n,e,i,t,n=t.sheet,e=t.row,i=t.col,t=t.outlineColumnHitInfo;h(t)||(t.indicator?_(n,e):t.checkBox?D(n,e,i):t.image||t.blank)},getOutlineColumnOffset:function(t){var n,e,n,n=t.context.sheet,e;x(n,t.context.col)&&(j(n=n.outlineColumn.options(),"showIndicator")&&(t.value+=p,G(n)?t.value+=b:t.value+=m,t.value+=p),j(n,"showCheckBox")&&(t.value+=p,t.value+=2*c,t.value+=p),j(n,"showImage"))&&(t.value+=p,t.value+=d,t.value+=p)}}),u.Workbook.ch("outlineColumn",P={init:function(){i.commands.Gpt(this.commandManager())},onCultureChanged:function(){S()}})},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/outlineColumn/outlineColumn.res.en.js");n.SR={en:e}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_GROUP_PROTECTED=void 0,n.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/search/search.entry.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SearchFoundFlags=n.SearchOrder=n.SearchFlags=n.SearchCondition=n.SearchResult=void 0;var i=e("./dist/plugins/search/search.js");Object.defineProperty(n,"SearchResult",{enumerable:!0,get:function(){return i.SearchResult}}),Object.defineProperty(n,"SearchCondition",{enumerable:!0,get:function(){return i.SearchCondition}}),Object.defineProperty(n,"SearchFlags",{enumerable:!0,get:function(){return i.SearchFlags}}),Object.defineProperty(n,"SearchOrder",{enumerable:!0,get:function(){return i.SearchOrder}}),Object.defineProperty(n,"SearchFoundFlags",{enumerable:!0,get:function(){return i.SearchFoundFlags}})},"./dist/plugins/search/search.js":function(t,n,e){"use strict";var b,i,e,w,u,y,M,C,r,S,o,a,s,e,i,e;function T(t,n,e){var i,r,o,a;return t&&(t=t.toString(),n=n.toString(),0===e?-1<t.indexOf(n):(i=0<(2&e),r=0<(1&e),0<(4&e)?(n=(a=i?u.tbt(n,!1,!0):u.jJ(n))||n,(a=r?u.OJ(n):u.qT(n)).test(t)):(r&&(n=n.toLowerCase(),t=t.toLowerCase()),i?n===t:0<=t.indexOf(n))))}function A(t,n,e,i,r,o,a,u){var s=y,c=t+1,f=n+1;return 0===e?0<=f&&f<=u?s={r:t,c:f}:0<=c&&c<=o&&(s={r:c,c:i?a:0}):c<=o?s={r:c,c:n}:f<=u&&(s={r:i?r:0,c:f}),s}function c(){this.startSheetIndex=-1,this.endSheetIndex=-1,this.searchString=y,this.searchFlags=0,this.searchOrder=0,this.searchTarget=1,this.sheetArea=3,this.rowStart=-1,this.columnStart=-1,this.rowEnd=-1,this.columnEnd=-1,this.findBeginRow=-1,this.findBeginColumn=-1}function f(){this.foundColumnIndex=-1,this.foundRowIndex=-1,this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundString=y}Object.defineProperty(n,"__esModule",{value:!0}),n.SearchFoundFlags=n.SearchOrder=n.SearchFlags=n.SearchResult=n.SearchCondition=void 0,b=e("Core"),i=e("Common"),e=e("CalcEngine"),w=!!e,u=i.Common.$T,y=null,M=Math.max,C="string",b.Worksheet.prototype.search=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,a,u,v,m,g,p,g;if(!t)return y;if(e=t.sheetArea,i=t.searchString,r=t.searchTarget,o=t.searchFlags,a=(n=this).getRowCount(e),u=n.getColumnCount(e),s=new S,i&&0!==r&&!(a<=0&&u<=0))for(c=M(0,t.rowStart),f=M(0,t.columnStart),d=0<(8&o),((l=t.rowEnd)<0||!d)&&(l=a-1),((h=t.columnEnd)<0||!d)&&(h=u-1),v=(a=t.findBeginRow)<0?c:a,m=(u=t.findBeginColumn)<0?f:u;0<=v&&0<=m;){if(g=n.getCell(v,m,e),p=void 0,0<(1&r)&&""!==(p=t.callback?t.callback(g,n):g.text())&&T(p,i,o)&&(s.searchFoundFlag|=1,s.foundString=p),w&&0<(8&r)&&typeof(p=b.util.f0(n,v,m))==C&&""!==p&&T(p,i,o)&&(s.searchFoundFlag|=8,s.foundString=p),0<(4&r)&&typeof(p=g.tag())==C&&""!==p&&T(p,i,o)&&(s.searchFoundFlag|=4,s.foundString=p),0!==s.searchFoundFlag)return s.foundRowIndex=v,s.foundColumnIndex=m,s;if(!(g=A(v,m,t.searchOrder,d,c,l,f,h)))break;v=g.r,m=g.c}return s},b.Workbook.prototype.search=function(t){var n,e,i,r,o,a,a,u,s;if(!t)return y;if(e=0,i=(n=this).getSheetCount(),r=new S,t.searchString&&0!==t.searchTarget&&!(i<=0)&&(-1===t.startSheetIndex&&(t.startSheetIndex=0),-1===t.endSheetIndex&&(t.endSheetIndex=i-1),(u=t.startSheetIndex)<=(s=t.endSheetIndex))&&0<=u&&u<i&&0<=s&&s<i)for(o=u;o<=s;o++)if((a=n.getSheet(o)).visible()===b.SheetTabVisible.visible&&(a=a.search(t))&&0!==a.searchFoundFlag)return a.foundSheetIndex=o,a;return r},n.SearchCondition=c,S=f,n.SearchResult=S,(e=o=n.SearchFlags||(n.SearchFlags={}))[e.none=0]="none",e[e.ignoreCase=1]="ignoreCase",e[e.exactMatch=2]="exactMatch",e[e.useWildCards=4]="useWildCards",e[e.blockRange=8]="blockRange",(i=a=n.SearchOrder||(n.SearchOrder={}))[i.zOrder=0]="zOrder",i[i.nOrder=1]="nOrder",(e=s=n.SearchFoundFlags||(n.SearchFoundFlags={}))[e.none=0]="none",e[e.cellText=1]="cellText",e[e.cellTag=4]="cellTag",e[e.cellFormula=8]="cellFormula"},"./dist/plugins/sheetsCalc/calc-extra-save.js":function(t,n,e){"use strict";var c,u,r,i,s,f,l,h,d,v,m;function o(t){var n,e,i,r;if(Array.from)return Array.from(t.keys());for(n=[],e=0,i=t.keys();e<i.length;e++)r=i[e],n.push(r);return n}function a(o,a,u){for(var s,t,n,t=function(t){var n,t,r,e,i,n=a[t];if(n.l)for(t=g(n.k),r=o.oT(t[1],t[2],!0),n.v&&o.nbt(r),n.b,r.aT=n.l.map(function(t){return parseInt(t,10)}),e=function(t){var i=n.l[t];r[i]=(0,c.createMap)(),null!=(s=n[i])&&s.map(function(t){var n,e,e,n=g(t),e=n[0];"?"!==e[0]&&"!"!==e[0]||(e=e.slice(1)),e=u[e],r[i].set(t,e.oT(n[1],n[2],!0))})},i=0;i<n.l.length;i++)e(i)},n=0;n<a.length;n++)t(n)}function g(t){return t.split(",").map(function(t,n){return t=0<n?parseInt(t,10):t})}function p(t,n,e){var i,r,o,a,u,s,c,f,l,f,i=t.uT(!0);for(r in n.l)if(n.l.hasOwnProperty(r))for(a in o=n[r])if(o.hasOwnProperty(a))for(u=a.split(",").map(function(t,n){return"?"!==t[0]&&"!"!==t[0]||(t=t.slice(1)),parseInt(t,10)}),s=0;s<o[a].length;s++)f=(l=e[f="?"!==(f=(c=g(o[a][s]))[0])[0]&&"!"!==f[0]?f:f.slice(1)]).oT(c[1],c[2],!0),i.processListener(parseInt(r,10),u[0],u[1],u[2],u[3],f,!0)}function b(t){var n,e,n=null;return(t.isVolatile||t.ebt||t.aT&&0<t.aT.length)&&((n={}).k=t.getKey(),t.isVolatile&&(n.v=!0),t.ebt&&(n.b=!0),t.aT)&&t[0]&&(e="0",n[0]=o(t[0]),n.l=t.aT),n}function w(t){var n,e,i,r,o,a,i,t,n=[],e=t.dataTable;for(o in e)if(e.hasOwnProperty(o)&&(a=e[o]))for(r in a)a.hasOwnProperty(r)&&(i=a[r])&&(i=b(i.calc))&&n.push(i);return(t=y(t))&&n.push(t),n}function y(t){var t,n,e,i,r,t=t.uT();if(t)return n={k:"rangeCalc"},e="0",i=t[0],r={},i&&i.forEach(function(t,n){r[n]=o(t.content)}),n[0]=r,n.l=t.aT,n}function M(t,n){var e,i,r,o,a,u,e={};if(n&&n.idMap){for(o in r={},i=t.rO)i.hasOwnProperty(o)&&(r[i[o].getSource().getName()]=i[o]);for(o in a=n.idMap)a.hasOwnProperty(o)&&(u=a[o],e[o]=r[u])}return e}function C(t){var n,e,i,n=t.rO,e={};for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getSource().getName());return e}function S(t,n){return T(t,n)}function T(t,n){var e,i,r,o,a,e,e,i=t.t;if(4===i||2===i||3===i||8===i||100===i)(r=new c.Expression(i)).value=t.v;else{if(5===i)(r=new c.Expression(5)).value=c.CalcError.ibt(t.v);else if(6===i)(r=new c.Expression(6)).value=new c.CalcArray(t.v);else if(9===i)r=(0,c.rbt)(t.o,T(t.v,n),t.w&&T(t.w,n));else if(10===i)(r=new c.Expression(10)).value=T(t.v,n);else if(11===i)r=new c.Expression(11);else if(7===i)for(r=new c.Expression(7),t.f&&(r.function=T(t,n)),t.n&&(r.function=n.getFunction(t.n),r.functionName=t.n),o=r.arguments=[],a=0;a<t.p.length;a++)t.p[a]&&(o[a]=T(t.p[a],n));else 1===i?(r=new c.ReferenceExpression(1),(e=t.v.split("*"))[0]&&(r.source=n.getExternalSource("",e[0])),e[1]&&(r.endSource=n.getExternalSource("",e[1])),e[2]&&(r.row=parseInt(e[2],10)),e[3]&&(r.column=parseInt(e[3],10)),e[4]&&(r.endRow=parseInt(e[4],10)),e[5]&&(r.endColumn=parseInt(e[5],10)),e=parseInt(e[6],10),r.rowRelative=!!(e&s),r.columnRelative=!!(e&f),r.endRowRelative=!!(e&l),r.endColumnRelative=!!(e&h),r.isFullRow=!!(e&d),r.isFullColumn=!!(e&v),r.isArrayReference=!!(e&m),r.isFullRow&&(r.column=r.endColumn=c.BAND_INDEX_CONST),r.isFullColumn&&(r.row=r.endRow=c.BAND_INDEX_CONST)):13===i?(r=new u.obt,e=t.v,r.abt=e[0],r.source=e[1],r.ubt=e[2],r.sbt=e[3],r.cbt=e[4],r.fbt=e[5],r.lbt=e[6],r.hbt=e[7],r.source=n.getExternalSource("",r.source),r.abt=n.getTableByName(r.abt)):r&&r.type;t.es&&(r.ensureSingle=!0)}return r}function A(t){return I(t)}function I(t){var n,e,i,i;if(!t)return t;if(n={t:t.type},t.ensureSingle&&(n.es=1),4===t.type||2===t.type||3===t.type||8===t.type||100===t.type)n.v=t.value;else if(5===t.type)n.v=t.value._code;else if(6===t.type)n.v=t.value.array;else if(9===t.type)n.o=t.operatorType,n.v=I(t.value),n.w=t.value2&&I(t.value2);else if(10===t.type)n.v=I(t.value);else if(7===t.type)for((0,c.isExpression)(t.function)?n.f=I(t.function):t.functionName&&(n.n=t.functionName),n.p=[],e=0;e<t.arguments.length;e++)n.p[e]=I(t.arguments[e]);else 1===t.type?(i=(t.rowRelative&&s)|(t.columnRelative&&f)|(t.endRowRelative&&l)|(t.endColumnRelative&&h)|(t.isFullRow&&d)|(t.isFullColumn&&v)|(t.isArrayReference&&m),i=[t.source&&t.source.getName(),t.endSource&&t.endSource.getName(),t.row,t.column,t.endRow,t.endColumn,i],t.isFullRow&&(i[3]=i[5]=r),t.isFullColumn&&(i[2]=i[4]=r),n.v=i.join("*")):13===t.type?n.v=[t.abt.name(),t.source.getName(),t.ubt,t.sbt,t.cbt,t.fbt,t.lbt,t.hbt]:t.type;return n}Object.defineProperty(n,"__esModule",{value:!0}),n.exprToJSON=n.exprFromJSON=n.dbt=n.vbt=n.mbt=n.gbt=n.pbt=void 0,c=e("CalcEngine"),u=e("./dist/plugins/sheetsCalc/parser-sheets.js"),r=null,i=void 0,s=1,f=2,l=4,h=8,d=16,v=32,m=64,n.pbt=a,n.gbt=p,n.mbt=w,n.vbt=M,n.dbt=C,n.exprFromJSON=S,n.exprToJSON=A},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(A,t,n){"use strict";var e,H,i,w,y,V,g,W,I,R,s,M,F,L,B,P,G,U,C,z,Q,Y,J,K,S,x,N,k,_,T,n,n,r,D,u,c,f,j,O,E,o,r,X,a,l,q,$;function h(t,n,e,i,r,o){var a=this;a.Zc=t,a.FY=e,a.jpt=i,a.WK=n,z(r)||(a.TZ=r),a.t1e="boolean"==typeof o&&o}function d(t,n,e,i,r,o,a){var t,i,t=X.call(this,t,i,r,o,a)||this,i=t;return i.bbt=n,i.ybt=e,t}function tt(t){var n=a.call(this,L)||this;return n.references=t,n}function nt(t){var n,e,i,r,o,a;if(!(t<0||(n=c[t]))){for(e=t,r=(i="").length,t+=1;0<t;t=Math.floor((t-1)/26))o=i.substring(0,r),a=i.substring(r),i=o+String.fromCharCode(65+(t-1)%26)+a;n=i.toString(),c[e]=n}}function v(t,n,e,i){var r,n,o,a;for(void 0===i&&(i={}),r=l.call(this,t&&t.Uw(i.sheetArea),n,e,i)||this,t||(t=v.wbt=v.wbt||new H.Worksheet,r.source)||(r.source=t.Uw(i.sheetArea)),r.Mf=t,r.row=e&&e.row||0,r.column=e&&e.col||0,o=(n=t.getCalcService()).getResolvers(),a=0;a<o.length;a++)if(o[a]instanceof y.SheetReferenceResolver)return r;return n.addResolver(new y.SheetReferenceResolver(t)),n.addResolver(new y.StructureReferenceResolver(t)),r}function et(t){t.indexOf("LET(")}function m(t,n,e){var e=q.call(this,e)||this;return e.getCalcSourceModel=function(){return this.Mbt},e.createSourceModel=function(t){var t=new V.CalcSourceModel(t,this);return t.usedRange=new H.BaseUsedRange,t},e.getRangeKey=function(t,n){return t.id+","+n.row+","+n.col+","+n.rowCount+","+n.colCount},e.getSheetRangeReference=function(t){var n,n,e,i,r,o,a,n=this.Mf,n=n&&n.parent;if(t.endSource&&n&&n.sheets&&t.endSource instanceof m){for(e=n.sheets,i=!1,r=void 0,o=[],a=0;a<e.length;a++){if((r=e[a].Uw())===this)i=!0;else if(r===t.endSource){o.push(r.getReference(t));break}i&&o.push(r.getReference(t))}return new u(o)}},e.Mf=t,e.t8=new I.Z8(e),e.nT=n||3,e}function p(t){var n=$.call(this,L)||this;return n.createSourceModel=function(t){return new V.CalcSourceModel(t,this)},n.vpt=t,n.Cbt={},n}function it(t,n,e,i,r,o){var t,a,t,t=t&&t instanceof H.Worksheet&&t,a=new V.Parser;return e=e===B?0:e,i=i===B?0:i,t=new f(t,!!r,(0,V.eV)(e,i)),o&&(t.culture=!0),a.parse(t,n)}function Z(t,n,e,i,r,o){var t,a,r,t=t&&t instanceof H.Worksheet&&t,a=new V.Parser;return e=e===B?0:e,i=i===B?0:i,(r=new f(t,!!r,(0,V.eV)(e,i))).Sbt=o,r.Nme=t&&t.vle,a.unparse(r,n)}function rt(t,n,e,i,r){var o;return ot(t,it(t,n,e=e===B?0:e,i=i===B?0:i,r,!0),e,i)}function ot(t,n,e,i,r){var o,a,t,o=t.op();return e===B&&(e=t.getActiveRowIndex()),i===B&&(i=t.getActiveColumnIndex()),a=!0,r&&r.convertNullToZero!==B&&(a=r.convertNullToZero),t=t.Uw(r&&r.sheetArea),o.evaluateParsedFormula(t,n,(0,V.eV)(e,i),!1,a)}function at(t,n,e,i,r){var o,a,r,t,o=t.op();return e===B&&(e=t.getActiveRowIndex()),i===B&&(i=t.getActiveColumnIndex()),a=!0,r&&r.convertNullToZero!==B&&(a=r.convertNullToZero),r=t.Uw(),(t=(0,V.eV)(e,i)).Tbt=Math.random().toString(36).substring(2),o.Abt(r,n,t,a)}function b(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,o=t.row,a=t.col,u=t.row+t.rowCount-1,s=t.col+t.colCount-1,c=!1,f=!1,l=!1,h=!1;return 4<=arguments.length&&(o-=(c=0!=(1&i))?n:0,u-=(f=0!=(4&i))?n:0,a-=(l=0!=(2&i))?e:0,s-=(h=0!=(8&i))?e:0),r&&(v=st(t,r,n),m=ct(t,r,n),v)&&m?y.StructureReferenceResolver.create(r,v,m,t.col-r.dataRange().col,t.col+t.colCount-r.dataRange().col-1):1===t.rowCount&&1===t.colCount?(0,V.knt)(L,L,o,a,c,l):(t.row<0&&(o=u=g.BAND_INDEX_CONST),t.col<0&&(a=s=g.BAND_INDEX_CONST),(0,V.lJ)(L,L,o,a,u,s,c,l,f,h,n,e))}function ut(t){return 0<=t.indexOf("[")&&1<t.indexOf("]")}function st(t,n,e){if(1===t.rowCount){if(n.hasHeadersRow()&&t.row===n.startRow())return 2;if(n.hasTotalsRow()&&t.row===n.endRow())return 8;if(e===t.row)return 1}else{if(n.hasHeadersRow()&&t.row===n.startRow()){if(t.rowCount===n.dataRange().rowCount+1)return 6;if(n.hasTotalsRow()&&t.rowCount===n.dataRange().rowCount+1+1)return 14}if(t.row===n.dataRange().row){if(t.rowCount===n.dataRange().rowCount)return 3;if(n.hasTotalsRow()&&t.rowCount===n.dataRange().rowCount+1)return 12}}return B}function ct(t,n,e){return t.col===n.startColumn()&&t.colCount===n.dataRange().colCount?1:1===t.colCount?2:t.col>=n.startColumn()&&t.col+t.colCount-1<=n.endColumn()?4:B}function ft(t,n,e,i,r){var t,i,o,r,t=b(t,n,e,i),i=new f(L,!!r,(0,V.eV)(n,e)),o,r=(new V.Parser).unparse(i,t);return i.L0(),r}function lt(t,n,e,i,r,o,a){var n,r,u,n=b(n,e,i,r,a),r=new f(t,!!o,(0,V.eV)(e,i)),u;return(new V.Parser).unparse(r,n)}function ht(t,n,e,i){var r,n,o,a,u,s,c,f,l,u,s;if(!n)return null;if(e=e||0,i=i||0,a=!1,(n=(r=t.op()).parse(t.Uw(),n,e,i,!0,!0))&&(7===n.type&&"ANCHORARRAY"===n.functionName&&(n=n.arguments[0],a=!0),!(o=n.source)||13!==n.type)&&1===n.type&&n.endSource){for(u=n.source,s=n.endSource,c=u.getSources(s),f=!1,l=0;l<c.length;l++)if(c[l]===t.Uw()){f=!0;break}n=f&&n}return n&&n.getRange&&(!o||o===t.Uw())&&(u=n.getRange(e,i))?(a&&(s=new V.CalcReference(t.qgt,[u]).getSpillRef())&&s.$gt&&(u=s.$gt[0]),new H.Range(u.row,u.col,u.rowCount,u.colCount)):null}function dt(t,n,e,i,r,o,a){var u,s,c,f,l,a,h,d,v,m,g,p,b,w,u=[],s=[];if(n)if(e=e||0,i=i||0,a)try{c=it(t,n,e,i),(f=t.Lp.evaluateExpression(t.qgt,c,{row:e,col:i},!1,!0))&&f.$gt&&(f.$gt.forEach(function(t){s.push(new H.Range(t.row,t.col,t.rowCount,t.colCount))}),u.push({sheetName:f.rT.getName(),ranges:s}))}catch(t){}else for(l={},a=new V.Parser,h=y.Vgt(a,n,t,e,i,B,r,o),d=0;d<h.length;d++)if((v=h[d].sheetRanges)&&!F(v))for(m=0;m<v.sheets.length;m++)for(g=v.sheets[m],(s=l[g])||(l[g]=s=[],u.push({sheetName:g,ranges:s})),p=v[g],b=0;b<p.length;b++)w=p[b],z(w)||s.push(new H.Range(w.row,w.col,w.rowCount,w.colCount));return u}function vt(t,n,e,i,r){var o,r,o,o=new V.Parser,r=new f(L,!!r,(0,V.eV)(n,e)),o=mt(o,r,t,n,e,i);return r.L0(),o}function mt(t,n,e,i,r,o,a){for(var u,s,c,c,f,u="",s=0;s<e.length;s++)c=b(e[s],i,r,o),c=t.unparse(n,c),u+=0<s?(f=a&&w.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+c:c;return u}function gt(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,u=i.mL(n,e,B,B,!0),d=!1,v=100,m=.001,g=.01,c=(S(u)?+u:0)-a,s=i.mL(r,o,B,B,!0),l=(S(s)?+s:0)-a;if(S(s)&&Math.abs(l)<m)d=!0;else if(C(s))d=!1;else for(f=c+(0===c?.01:.01*c),p=0;!d&&p<100;p++)f=w.Common.st.E8(f,13),t.setValue(n,e,f),s=i.mL(r,o,B,B,!0),h=(S(s)?+s:0)-a,S(s)&&Math.abs(h)<m?d=!0:f=C(s)?(c+f)/2:c-f==0?c+(0===c?.01:.01*c):l-h==0?c+2*(f-c):(b=f-h*(c-f)/(l-h),c=f,l=h,b);return d||t.setValue(n,e,u),d}e=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.goalSeek=t.RangeReferenceRelative=t.Ibt=t.rangesToFormula=t.formulaToRanges=t.formulaToRange=t.rangeToFormulaWithStructReference=t.rangeToFormula=t.isValidExternalReference=t.rangeToExpression=t.xbt=t.evaluateExpression=t.evaluateFormula=t.expressionToFormula=t.formulaToExpression=t.SpreadSource=t.SheetSource=t.SheetParserContext=t.SheetRangeReference=t.FormatterNameInfo=t.NameInfo=t.ReferenceStyle=void 0,H=n("Core"),i=n("Core"),w=n("Common"),y=n("./dist/plugins/sheetsCalc/parser-sheets.js"),V=n("CalcEngine"),g=n("./dist/plugins/sheetsCalc/calc.ns.js"),W=n("./dist/plugins/sheetsCalc/calc-extra-save.js"),I=n("./dist/plugins/sheetsCalc/dynamic-array.js"),R=w.Common.lt,s=w.Common.zf,M=R.Dh,F=R._h,L=null,B=void 0,(P=["v","n","s","b","d","sn"])[11]="an",G=V.Errors.Value,U=w.Formatter&&w.Formatter.GeneralFormatter,C=V.Convert.BJ,z=R.ht,Q=H.mt.xr,Y=H.range_parser.jc,J=H.mt.vo,K=H.Util.addXLFNPrefix,S=function(t){return V.Convert.q8(t,!0)},x=H.Range.prototype.contains,N=s.Gmt,k="number",_=H.UsedRangeUtil.updateUsedRangeByData,T="__hyperlink__",(n=V.CalcSource.prototype).referenceToArray=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,s=this,l=1,h=1,g=[],m=t.getRangeCount();if(0===m)g.isError=!0;else{for(w=s.getRowCount(),y=s.getColumnCount(),e=e===B||e,M=0;M<m;M++){if(e||g.push(b=[]),0===(l=t.getRowCount(M)))return g.isError=!0,g;if(0===(h=t.getColumnCount(M)))return g.isError=!0,g;if(d=t.getRow(M),v=t.getColumn(M),2!==e){if(w<=d||y<=v)return(g=[L]).rowCount=1,g.colCount=1,g.rangeCount=1,g;y<v+h&&(h=y-v)}for(w<d+l&&(l=w-d),C=void 0,S=0;S<l;S++)for(c=d+S,e||b.push(C=[]),T=0;T<h;T++){if(p=s.getValue(c,f=v+T),i&&V.Convert.BJ(p))return(g=[p]).isError=!0,g;if(p=V.Convert.Nbt(p,n,!V.ExcelCompatibleCalcMode,o,u),r&&p===V.Convert.CalcConvertedError)return(g=[G]).isConvertError=!0,g;p===L&&o||(2===e?g[S*h+T]=p:(e?g:C).push(p))}}(g=e||1!==m?g:g[0]).rowCount=l,g.colCount=h,g.rangeCount=m}return g},n.getSheetReference=function(){var t=this;return t.kbt=t.kbt||new V.CalcReference(t),t.kbt},(r=n=t.ReferenceStyle||(t.ReferenceStyle={}))[r.a1=0]="a1",r[r.r1c1=1]="r1c1",i.ReferenceStyle=n,h.prototype.getName=function(){return this.Zc},h.prototype.getRow=function(){return this.FY},h.prototype.getColumn=function(){return this.jpt},h.prototype.getExpression=function(){return this.WK},h.prototype.getComment=function(){return this.TZ},h.prototype.SB=function(t,n){n&&n.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=t},h.prototype.isReadOnly=function(t){return"boolean"==typeof t&&(this.t1e=t),this.t1e},t.NameInfo=r=h,i.NameInfo=r,e(d,X=r),d.prototype.getFormatter=function(){return this.bbt},d.prototype.getSheetTabName=function(){return this.ybt},t.FormatterNameInfo=d,V.CalcSource.prototype.createSourceModel=function(t){return new V.CalcSourceModel(t,this)},a=V.CalcReference,e(tt,a),tt.prototype.toArray=function(t,n,e,i,r){for(var o,a,u,s,o=this.references,a=[],u=0;u<o.length;u++){if((s=o[u].rT.referenceToArray(o[u],t,n,e,i,r)).isError&&e)return s;n?Array.prototype.push.apply(a,s):a.push(s),u||(a.rowCount=s.rowCount,a.colCount=s.colCount)}return a.rangeCount=o.length,a},u=tt,t.SheetRangeReference=u,c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],l=V.ParserContext,e(v,l),v.prototype.getExternalSource=function(t,n){var e,i,r,o,a,u,e=this,i=e.Mf.parent,r=e.Mf.Uw();if(t&&(!i||i.name!==t))return L;if(!i)return s.Dbt(e.Mf.name(),n)?r:L;if(ut(n))return i._p.parseSource(n,r.G3);if((o=i.sheets)&&0<o.length)for(a=0;a<o.length;a++)if(u=o[a],s.Dbt(u.name(),n))return u.Uw();return V.ParserContext.prototype.getExternalSource.call(this,t,n)},v.prototype.getExternalSourceToken=function(t){return t.getName(this)},v.prototype.getTableByName=function(t){var n,e,i,r,o,n=this.Mf.tables,e=!0,i=n?n._bt(t,!0):L;if(!i&&(r=this.Mf.parent&&this.Mf.parent.sheets))for(o=0;o<r.length&&(!(n=r[o].tables)||!(i=n._bt(t,!0)));o++);return i||this.Mf.parent&&this.Mf.parent.Ofe(t)},v.prototype.getTableByIndex=function(t,n){var e=this.Mf.tables;return e?e.Hq(t,n,!0):L},v.prototype.setSource=function(t){var t=this.source=t;t&&t.getSheet&&(this.Mf=t.getSheet())},v.prototype.L0=function(){this.Mf&&this.Mf!==v.wbt&&this.Mf.L0(),this.Mf=L},f=v,t.SheetParserContext=f,j=new w.Common.ResourceManager(H.SR),q=V.CalcSource,e(m,q),m.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},m.prototype.addReferenceSheetName=function(t){var n=this;n.Ebt||(n.Ebt={}),n.Ebt[t]=1},m.prototype.setReferenceSheetNames=function(t){this.Ebt=t},m.prototype.startCalculation=function(){this.jbt||(this.Obt(),this.K5=[])},m.prototype.endCalculation=function(t){this.jbt=L,this.Rbt=L,!1!==t&&this.Bbt(),this.K5=L},m.prototype._F=function(){var t=this;t.Fbt?t.K5&&(t.Pbt=t.Pbt.concat(t.K5),t.K5=[]):(t.Pbt=t.K5||[],t.Fbt=setTimeout(function(){t.Bbt(t.Pbt),delete t.Pbt,delete t.Fbt},0))},m.prototype.Bbt=function(t){var n,t,e,n,t=t||this.K5;t&&0<t.length&&(n=null==(n=(e=this.Mf).Ut)?void 0:n.W_(3).B8,e.Ut)&&e.ki(H.Events.RangeChanged,{isUndo:!z(n&&n.vE),sheet:e,sheetName:e.name(),row:0,col:0,rowCount:e.getRowCount(),colCount:e.getColumnCount(),changedCells:t,action:6},e.QI)},m.prototype.clearValueCache=function(){this.Obt()},m.prototype.Obt=function(){var t=this.getRowCount(),n=this.getColumnCount();this.jbt={rowCount:t,colCount:n},this.Rbt={arrayInfo:[]}},m.prototype.Gw=function(){this.jbt=L,this.Rbt=L,this.K5=L},m.prototype.getValue=function(t,n){for(var e,i,r,o,a,u,s,t,c,f,l,h,d,v,m,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];if(o=(r=this).Mf,typeof t==k)a=t,u=arguments[1],n=arguments[2],s=arguments[3];else if(t.row!==B)a=t.row,u=t.col;else if(t.name)return null;return t=r.nT,a<0||u<0?G:o.Gbt&&o.Ubt===a&&o.Hbt===u?o.zbt:(c=r.jbt,f=P[n=n||0],c?(l=c.rowCount,h=c.colCount,m=v=d=void 0,l<=a||h<=u?L:((m=(v=(v=(d=(d=c[a])||(c[a]={}))[u])||(d[u]={v:s?o.getValueIgnoreDefault(a,u,t,B,!0):r.Mf.mL(a,u,t,B,!0)}))[f])===B&&(m=V.Convert.Nbt(v.v,n,!V.ExcelCompatibleCalcMode),v[f]=m),H.mt.V0(m))):a>=r.getRowCount()||u>=r.getColumnCount()?L:s?r.Mf.getValueIgnoreDefault(a,u,t,B,!0):r.Mf.mL(a,u,t,B,!0))},m.prototype.getIdentity=function(t,n){var e,i,r,o,n,e=this,i=n.row,r=n.rowCount||1,o=n.column,n=n.columnCount||1;return-1===i&&(i=0,r=e.getRowCount()),-1===o&&(o=0,n=e.getColumnCount()),e.getName()+"."+i+"."+r+"."+o+"."+n},m.prototype.getReference=function(t){var n=this,e=t.row,i=t.col;return-1===e&&(t.row=0,t.rowCount=n.getRowCount(),t.rowUndefine=!0),-1===i&&(t.col=0,t.colCount=n.getColumnCount(),t.colUndefine=!0),new V.CalcReference(n,[t])},m.prototype.getSources=function(t){var n,e,i,r,o;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&t instanceof m){for(n=this.Mf.parent.sheets,e=!1,i=void 0,r=[],o=0;o<n.length;o++){if((i=n[o].Uw())===this&&(e=!0),i===t){r.push(i);break}e&&r.push(i)}return r}},m.prototype.Vbt=function(i,r){var t,o,a,u,t,o=this.Rbt,a=o&&o.arrayInfo;a&&(u=!1,a.forEach(function(t,n){var e,t;t&&(e=t.reference,t=t.key,x.call(e.$gt[0],i,r))&&(delete o[t],a[n]=B,u=!0)}),u)&&(o.arrayInfo=[],a.forEach(function(t){t&&o.arrayInfo.push(t)}))},m.prototype.referenceToArray=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,E,h=l=1,g=[],w=(s=this).Mf,y=s.jbt,M=s.Rbt,T=P[n=n||0];if(0===(m=t.getRangeCount()))g.isError=!0;else{if(M&&(p=M[S=t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+n+"_"+e]))return p;for(A=this.getRowCount(),I=this.getColumnCount(),e=e===B||e,x=0;x<m;x++){if(e||g.push(b=[]),0===(l=t.getRowCount(x)))return g.isError=!0,g;if(0===(h=t.getColumnCount(x)))return g.isError=!0,g;if(d=t.getRow(x),v=t.getColumn(x),2!==e){if(A<=d||I<=v)return(g=e?[L]:[[L]]).rowCount=1,g.colCount=1,g.rangeCount=1,g;I<v+h&&(h=I-v)}for(A<d+l&&(l=A-d),k=N=void 0,_=w.Gbt,D=0;D<l;D++)for(c=d+D,e||b.push(N=[]),y&&(y[c]||(y[c]={}),C=y[c]),j=0;j<h;j++){if(f=v+j,_&&w.Ubt===c&&w.Hbt===f)p=w.zbt,_=!1;else{if(y?(k=C[f])?p=k.v:(p=w.mL(c,f,s.nT,B,!0),k=C[f]={v:p}):p=w.mL(c,f,s.nT,B,!0),a&&(E=void 0,"@"===(E=(O=w.getFormatter())instanceof U?O.formatString():O)?p=w.getText(c,f):p instanceof Date&&(p=R.uJ(p)),F(k)||(k=C[f]={v:p})),i&&V.Convert.BJ(p))return(g=[p]).isError=!0,g;if(k&&k[T]!==B)p=k[T];else if(p=V.Convert.Nbt(p,n,!V.ExcelCompatibleCalcMode,o,u),k&&(k[T]=p),r&&k===p)return(g=[G]).isConvertError=!0,g}V.Convert.Ybt(p,o)||(2===e?g[D*h+j]=p:(e?g:N).push(p))}}(g=e||1!==m?g:g[0]).rowCount=l,g.colCount=h,g.rangeCount=m,M&&(t.Zbt&&M.arrayInfo.length<200||!isNaN(m)&&!isNaN(l)&&!isNaN(h)&&100<m*l*h&&m*l*h<1e6&&M.arrayInfo.length<50)&&(M[S]=g,M[S].rowCount=l,M[S].colCount=h,M[S].rangeCount=m,M.arrayInfo.push({reference:t,key:S}))}return g},m.prototype.getColumnCount=function(){var t=this.Mf;return t.xT?0:t.getColumnCount(this.nT)},m.prototype.getRowCount=function(){var t=this.Mf;return t.xT?0:t.getRowCount(this.nT)},m.prototype.isHiddenRow=function(t,n){var e=this.Mf,i;return!!(e.iA&&e.iA()||!n)&&0===e.getRowHeight(t)},m.prototype.getName=function(){var t,n,t=this.nT,n=z(this.Wbt)?this.Mf.name():this.Wbt;return t===H.SheetArea.colHeader?n+"CH":t===H.SheetArea.rowHeader?n+"RH":n},m.prototype.setArray=function(t,n,e,i,r){return this.t8.setArray(t,n,e,i,r)},m.prototype.updateItem=function(t,n,e){return this.t8.updateItem(this,t,n)},m.prototype.HE=function(t,n){this.t8.HE(t,n)},m.prototype.setValue=function(t,n,e,i,r,o){var a,u,s,c,f,l,l,f,h,d,d,v,m,v,d,m,g,c,c,g,p,b,a=this,u=a.Mf,s=a.nT,c=a.jbt;c&&(f=c[t])&&(l=f[n])&&(z(e&&e[T])?(l.v=e,l.b!==B&&(l.b=B),l.d!==B&&(l.d=B),l.n!==B&&(l.n=B),l.s!==B&&(l.s=B),l.sn=B,l.an=B):delete f[n]),l=H.mt.Z0(e),f=u.Ut,h=!1,d=(d=u.tables)&&d.find(t,n),3===s&&d&&(v=d.showHeader()&&t===d.headerIndex(),m=d.showFooter()&&t===d.footerIndex(),v||m||(h=d.Kbt(t,n,l))),v=u.H3,3===s&&!h&&v&&v._dataSource&&(m=!1,(d=v.getValue(t,n)).hasBinding&&(g=void 0,g=c?(g=(c=c.bindingRows=c.bindingRows||{})[t])||(c[t]=M({},u.getDataItem(t))):M({},u.getDataItem(t)),f.dE(t,n,{gE:g,d6:d.value}),m=v.setValue(t,n,l,f.G8)),h="dataManagerBindingSource"===v.K$?m:d.hasBinding),c=u.pivotTables,3===s&&!h&&c&&(h=c.eJt(t,n,l)),!a.Qpe||o?(h||(!z(l)&&l[T]&&(g=l[T],f.setHyperlink&&f.do("setHyperlink",t,n,p={url:g}),l=l.toString()),f.do("setValue",t,n,l,s,!0,!0,r,!0,!0)),u.iL=!0,this.K5?this.K5.push({row:t,col:n,sheetArea:s}):u.ki(H.Events.CellChanged,{sheet:u,sheetName:u.name(),row:t,col:n,sheetArea:s,propertyName:"value",oldValue:i,newValue:e,KO:!0})):a.Qpe[b=s+" "+t+" "+n]=[t,n,s,l]},m.prototype.startIterativeCalc=function(){this.Qpe={}},m.prototype.endIterativeCalc=function(){var t,n,e,i,r,o,a,u,r,s,c,t=this,n=t.Mf,e=n.Ut;for(i in t.Qpe)Object.prototype.hasOwnProperty.call(t.Qpe,i)&&(o=(r=t.Qpe[i])[3],a=r[0],u=r[1],r=r[2],!z(o)&&o[T]&&(s=o[T],e.setHyperlink&&e.do("setHyperlink",a,u,c={url:s}),o=o.toString()),e.do("setValue",a,u,o,r,!0,!0,!1,!0,!0),n.iL=!0,this.K5?this.K5.push({row:a,col:u,sheetArea:r}):n.ki(H.Events.CellChanged,{sheet:n,sheetName:n.name(),row:a,col:u,sheetArea:r,propertyName:"value",KO:!0}));delete t.Qpe},m.prototype.getCustomFunction=function(t){return this.Mf?this.Mf.Jbt(t):L},m.prototype.getCustomName=function(t){var t=this.getCustomNameInfo(t);return t?t.getExpression():L},m.prototype.getCustomNameInfo=function(t){return t=N(t),this.Mf?this.Mf.getCustomName(t):L},m.prototype.getSheet=function(){return this.Mf},m.prototype.setFormula=function(t,n,e,i,r){var o,a,u,s,c,a,c,o=this;o.Mf.Ut.G8&&(s=o.Mf.Ut.G8.formulas,u=o.getCalcSourceModel(),s=s||(o.Mf.Ut.G8.formulas={}),-1<=t)&&-1<=n&&((c=o.getCalcService()).backupR1C1Formula&&(a=o.Mbt.pB(t,n),e=Z(o.Mf,a,t,n,!0,!1)),!i&&c.allowDynamicArray&&(i=o.Mbt.sT(t,n)),a=(a=s[t])||(s[t]={}),e&&"="===e[0]&&(e=e.substring(1)),c=a[n]&&a[n].formula,r?a[n]&&void 0!==a[n].oldFormula||(i=M({},i),a[n]=M({},a[n],{oldFormula:e,oldArrayInfo:i}),e)||delete a[n].oldArrayInfo:(a[n]=M({},a[n],{formula:e,arrayInfo:i}),e||delete a[n].arrayInfo,u.usedRange&&_(u.usedRange,t,n,c,e)))},m.prototype.setArrayFormula=function(t,n,e,i,r){var o;this.setFormula(t,n,r,{row:t,col:n,rowCount:e,colCount:i})},m.prototype.setFormulaByName=function(t,n,e){var i,r,i,i=this;i.Mf.Ut.G8&&((i=(i=(r=(r=i.Mf.Ut.G8.formulas)||(i.Mf.Ut.G8.formulas={})).names)||(r.names={}))[t]=M({},i[t],{formula:n,oldFormula:e}))},m.prototype.refresh=function(){var t=this.Mf.parent;t&&t.repaint()},m.prototype.toJSON=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,f,S,T,A,I,x,N,k,_,D,D,j,a=n,l=this.Mf,h=t.data||{},d=!0,v=this.op(),m=this===l.qgt,b=0;for(m&&(g=(0,V.createMap)(),l.Xbt=p={}),w=v.forceR1C1Formula,y=0;y<=e;y++)if(o=h.dataTable||{},u=a[y]){for(d=!(c=o[y]),c=c||{},M=0;M<=i;M++)if(C=(s=u[M])&&s.WK,f=s&&s.calc&&s.calc.isDefault(),s&&!f&&(C||s.qbt)){f=c[M]||{};try{T=S=void 0,m&&C&&!s.$bt&&(A=C.tyt=C.tyt||Z(l,C,y,M,!0,!1)).indexOf("!")<0&&(!(I=g.get(A))||I.baseColumn>M?(T=v.unparse(this,s.WK,y,M,!1,!0)).indexOf("[")<0&&(w&&(T=A),g.set(A,{formula:T,baseRow:y,baseColumn:M})):(S=I.obj)?((N=p[S.si]).lastRow=y,N.lastColumn=Math.max(M,N.lastColumn)):(S=I.obj={si:b},p[b]={formula:I.formula,baseRow:I.baseRow,baseColumn:I.baseColumn,lastRow:y,lastColumn:M},(x=y===I.baseRow?c:o[I.baseRow])[I.baseColumn].formula=I.obj,b++)),T=w&&C?S||C.tyt||Z(l,C,y,M,!0,!1):s.qbt||S||T||v.unparse(this,C,y,M,!1,!0),s.$bt?s.$bt.row===y&&s.$bt.col===M&&(f.arrayInfo=s.$bt,f.formula=T):f.formula=T,d=!1,c[M]=f}catch(t){}}if(d){if(o!==h.dataTable)continue}else o[y]=c;h.dataTable=o}if(p&&(p.nextIndex=b),r){for(k=h.columnDataArray||[],_=0;_<r.length;_++)(D=r[_])&&D.WK&&(D=this.op().unparse(this,D.WK,0,_,!1,!0),(j=k[_]||{}).formula=D,k[_]=j);0<k.length&&(h.columnDataArray=k)}F(h)||(t.data=h)},m.prototype.wh=function(t,F,L,B,P,n){var i,e,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,G,U,M,C,S,T,A,I,x,N,k,_,D,j,O,E,R,i=Q(t,H.XFileConstants.bo),e=this.op();for(e.nyt=!0,s=H.Util.ko(n),d=0,(f=this===(c=this.Mf).qgt)&&(l=(0,V.createMap)(),c.Xbt=h={}),v=t.lossless.exprs=[],m=[],t.richValueDataArray=[],g=0;g<=L;g++)if(r=F[g],a=i[g],r)for(a=a||(i[g]={}),p=0;p<=B;p++)if(o=r[p],u=a[p],b=o&&o.WK,y=!(w=[]),G=o&&o.calc&&o.calc.isDefault(),o&&!G&&b){u=u||{},s||7!==b.type||"IMAGE"!==b.functionName||(y=!0,3<(U=b.arguments).length&&(w=b.arguments.splice(5)));try{S=C=M=void 0,T=-1,(A=o.$bt)||(I=this.t8.Pme(g,p))&&(A={row:g,rowCount:I.maxX-g+1,col:p,colCount:I.maxY-p+1,isDynamicArray:!0},I.isValid||(A.isInvalid=!0)),f&&!A&&(x=b.tyt=b.tyt||Z(c,b,g,p,!0,!1),s||x.indexOf("!")<0)&&(!(N=l.get(x))||N.baseColumn>p?(C=e.unparse(this,b,g,p,!1,!0)).indexOf("[")<0&&l.set(x,{formula:C,baseRow:g,baseColumn:p}):((M=N.obj)?((k=h[M.si]).lastRow=g,k.lastColumn=Math.max(p,k.lastColumn)):(M=N.obj={si:d},h[d]={formula:N.formula,baseRow:N.baseRow,baseColumn:N.baseColumn,lastRow:g,lastColumn:p},d++),S=M.si,C=void 0)),z(S)&&(C=o.qbt||C||e.unparse(this,b,g,p,!1,!0),n&&n.includeCalcModelCache&&(_=(0,W.exprToJSON)(b),o.eyt||(_.nw=1),v.push(_),T=v.length-1),C=J(K(C))),A?(A.row===g&&A.col===p&&(D=Y(A),(A.isInvalid||!A.rowCount)&&0<D.indexOf(":")&&(D=D.substring(0,D.indexOf(":"))),u.f=C,u.r=D),A.isDynamicArray&&(u.a="1",A.isInvalid||n.fileType!==H.OpenSaveFileType.excel||m.push(A))):(u.f=C,u.g=S,u.c=1,y&&(j=u.v&&u.v.value.imageBase64Data,z(j)||(O={url:b.arguments[0]&&b.arguments[0].value,ref:H.IndexHelper.nr(p)+(g+1),f:C,structureMap:{}},b.arguments[1]&&!z(b.arguments[1].value)&&(O.structureMap.a=b.arguments[1].value),b.arguments[2]&&!z(b.arguments[2].value)&&(O.structureMap.s=b.arguments[2].value),b.arguments[3]&&!z(b.arguments[3].value)&&(O.structureMap.h=b.arguments[3].value),b.arguments[4]&&!z(b.arguments[4].value)&&(O.structureMap.w=b.arguments[4].value),O.imageBase64Data=j,t.richValueDataArray.push(O)),u.v="#VALUE!",u.t="e")),-1!==T&&(u.x=T)}catch(t){}y&&0<w.length&&(b.arguments=b.arguments.concat(w)),a[p]=u}for(E in h)Object.prototype.hasOwnProperty.call(h,E)&&(R=h[E],D=Y(new H.Range(R.baseRow,R.baseColumn,R.lastRow-R.baseRow+1,R.lastColumn-R.baseColumn+1)),(u=i[R.baseRow][R.baseColumn]).r=D,u.g=parseInt(E,10));m.forEach(function(t){for(var n,e,n=t.row;n<t.row+t.rowCount;n++)for(e=t.col;e<t.col+t.colCount;e++)(u=i[n]&&i[n][e])&&(u.t2=!0)}),delete e.nyt},(t.SheetSource=O=m).prototype.getParserContext=function(t,n,e){return n=n||(0,V.eV)(0,0),new f(this.Mf,t,n,e)},$=V.CalcSource,e(p,$),p.prototype.addUsedCustomName=function(t){this.Cbt[t]=1},p.prototype.getUsedCustomNames=function(){return this.Cbt||{}},p.prototype.getCustomFunction=function(t){return this.vpt?this.vpt.getCustomFunction(t):L},p.prototype.getCustomName=function(t){var t=this.getCustomNameInfo(t);return t?t.getExpression():L},p.prototype.getCustomNameInfo=function(t){return this.vpt?this.vpt.getCustomName(t)||this.vpt.xO(t):L},t.SpreadSource=p,t.formulaToExpression=it,t.expressionToFormula=Z,t.evaluateFormula=rt,t.evaluateExpression=ot,t.xbt=at,t.rangeToExpression=b,t.isValidExternalReference=ut,t.rangeToFormula=ft,t.rangeToFormulaWithStructReference=lt,t.formulaToRange=ht,t.formulaToRanges=dt,t.rangesToFormula=vt,t.Ibt=mt,t.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},t.goalSeek=gt},"./dist/plugins/sheetsCalc/calc.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_COLUMN_COUNT=n.MAX_ROW_COUNT=n.BAND_INDEX_CONST=void 0;var e=e("Core");n.BAND_INDEX_CONST=-2147483648,n.MAX_ROW_COUNT=e.XmlConstants.Io,n.MAX_COLUMN_COUNT=e.XmlConstants.xo},"./dist/plugins/sheetsCalc/dynamic-array.js":function(t,n,e){"use strict";var m,i,h,d,r,g,p,o;function c(t){return t.isValid}function a(t){return{row:t.minX,col:t.minY,rowCount:t.maxX-t.minX+1,colCount:t.maxY-t.minY+1,isValid:t.isValid}}function u(t){this.Gme=new i.Common.rbush,this.rT=t}Object.defineProperty(n,"__esModule",{value:!0}),n.Z8=void 0,m=e("Core"),i=e("Common"),h=e("CalcEngine"),d=e("CalcEngine"),r=null,g=void 0,p=i.Common.lt.ht,u.prototype.Ume=function(){return this.rT.Mf.Ut},u.prototype.L0=function(){this.rT=r,this.Gme=r},u.prototype.Fme=function(){var t=this.Gme.data;if(t&&isFinite(t.minX))return{minRow:t.minX,minCol:t.minY,maxRow:t.maxX,maxCol:t.maxY}},u.prototype.jme=function(t,n,e,i){return this.Gme.search({minX:t,minY:n,maxX:t+(e=void 0===e?1:e)-1,maxY:n+(i=void 0===i?1:i)-1})},u.prototype.Pme=function(n,e){return this.jme(n,e).filter(function(t){return t.minX===n&&t.minY===e})[0]},u.prototype.Hme=function(t,n){return this.jme(t,n).filter(c)[0]},u.prototype.zme=function(){var t,t,t=this.Ume();return t.G8?(t.G8.calc=t.G8.calc||[],(t=t.G8.calc).Vme=t.Vme||[],t.Vme):[]},u.prototype.Fgt=function(n,e,i,r){var o,a,u,t,s,o=this;void 0===i&&(i=1),void 0===r&&(r=1),a=this.jme(n,e,i,r),u=this,t=a.filter(function(t){return t.minX>=n&&t.minX<n+i&&t.minY>=e&&t.minY<e+r}),s=this.b3(),t.forEach(function(t){t.isValid&&s.gF(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1),u.Rme(t),u.Lme(t,!0)}),a.filter(c).forEach(function(t){u.Rme(t),a=a.concat(o.jme(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1))}),a.forEach(function(t){t.isValid||(u.Yme(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1)?s.gF(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1):s.gF(t.minX,t.minY,1,1))})},u.prototype.getAnchorCell=function(n,e){var t=this.jme(n,e).filter(function(t){return t.minX===n&&t.minY===e})[0];return t&&a(t)},u.prototype.getAnchorInfo=function(n,e,t){var i,i,i=this.jme(n,e),i=i.filter(function(t){return t.minX===n&&t.minY===e})[0]||i.filter(c)[0];return i&&a(i)},u.prototype.setValue=function(t,n,e,i){i?this.Ume().setValue(t,n,e,3,!0,!0,!1,!1,!0):this.pBt().setValue(t,n,e)},u.prototype.b3=function(){return this.rT.Mbt},u.prototype.pBt=function(){return this.rT},u.prototype.Rme=function(t,n,e,i){var r,o;if(t){if(t.isValid){for(r=t.minX;r<=t.maxX;r++)for(o=t.minY+(r===t.minX?1:0);o<=t.maxY;o++)this.setValue(r,o,g,e);t.isValid=!1,e&&this.zme().push([t,"isValid",!0]),n||this.setValue(t.minX,t.minY,d.Errors.Spill,e)}n&&(this.Lme(t,e),i||this.setValue(t.minX,t.minY,g,e))}},u.prototype.Lme=function(t,n){this.Gme.remove(t),n&&this.zme().push([t])},u.prototype.Bme=function(t,n){this.Gme.insert(t),n&&this.zme().push([g,t])},u.prototype.HE=function(t,n){this.Pme(t,n).isValid=!1},u.prototype.Yme=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,f,h,d,v,o=this.Gme.search({minX:t,minY:n,maxX:t+e-1,maxY:n+i-1}),a=this.pBt(),u=this.b3(),s=0;s<o.length;s++)if((c=o[s]).isValid&&(c.minX!==t||c.minY!==n))return!1;if(n+i>a.getColumnCount()||t+e>a.getRowCount())return!1;if(f=(0,m.Ec)(t,n,e,i),(l=a.Mf).Ut.getSpans(f).length)return!1;if((f=l.tables)&&f.Pl&&f.Pl(t,n,e,i))return!1;for(h=t;h<t+e;h++)for(d=n+(h!==t||r?0:1);d<n+i;d++)if(v=a.getValue(h,d,g,!0),!p(v)||u.hasFormula(h,d,!0))return!1;return!0},u.prototype.Zme=function(t,n,e,i,r){var o;this.Gme.insert({minX:t,minY:n,maxX:t+e-1,maxY:n+i-1,isValid:r})},u.prototype.setArray=function(t,n,e,i,r,o,a){var u,s,c,f,l,u=this,s=this.Pme(t,n);if(s&&s.maxX===t+e-1&&s.maxY===n+i-1&&s.isValid||(u.Rme(s,!0,a),s={minX:t,minY:n,maxX:t+e-1,maxY:n+i-1,isValid:!0},o||(s.isValid=u.Yme(t,n,e,i)),u.Bme(s,a)),s.isValid)for(c=t;c<t+e;c++)for(f=n;f<n+i;f++)r&&r[c-t]&&(l=r[c-t][f-n],p(l)?l=0:(h.Convert.Nh(l)||h.Convert.LE(l))&&(l=1===l.getRowCount()&&1===l.getColumnCount()?h.Convert.Nh(l)?l.getValue(0,0):l.getValue(0,0,0):d.Errors.Calc),this.setValue(c,f,l,a));else this.setValue(t,n,d.Errors.Spill,a);return s.isValid},u.prototype.updateItem=function(t,n,e){var n=this.Pme(n,e);if(n)return this.Rme(n,!0),!0},u.prototype.rE=function(i,r){var o=this,t;o.jme(i,-1,h.MAX_ROW_COUNT,-1).forEach(function(t){var n,e;if(t.minX>=i)o.Gme.remove(t),t.minX+=r,t.maxX+=r,o.Gme.insert(t);else if(t.maxX>=i)if(t.isValid){for(n=i;n<=t.maxX;n++)for(e=t.minY;e<=t.maxY;e++)o.pBt().setValue(n,e,o.pBt().getValue(n+r,e));for(n=t.maxX+1;n<=t.maxX+r;n++)for(e=t.minY;e<=t.maxY;e++)o.pBt().setValue(n,e,g)}else o.b3().Gde(t.minX,t.minY)})},u.prototype.aE=function(o,a,u){var s=this,t;s.jme(o,-1,h.MAX_ROW_COUNT,-1).forEach(function(t){var n,e,i,r;if(t.minX>=o+a)s.Gme.remove(t),t.minX-=a,t.maxX-=a,s.Gme.insert(t);else if(t.minX>=o)s.Rme(t,!0,u);else if(t.maxX>=o&&t.isValid)if(n=t.maxX>o+a-1?t.maxX+1:o+a,e=t.maxX>o+a-1?a:t.maxX-o+1,s.Yme(n,t.minY,e,t.maxY-t.minY+1,!0))for(i=t.maxX;o<=i;i--)for(r=t.minY;r<=t.maxY;r++)s.setValue(i+a,r,s.pBt().getValue(i,r),u);else s.Rme(t,!1,u)})},u.prototype.Eme=function(n,e){var i=this,t;i.jme(n,-1,h.MAX_ROW_COUNT,-1).forEach(function(t){t.minX>=n&&(i.Gme.remove(t),t.minX+=e,t.maxX+=e,i.Gme.insert(t))})},u.prototype.oE=function(i,r){var o=this,t;this.jme(-1,i,-1,h.MAX_COLUMN_COUNT).forEach(function(t){var n,e;if(t.minY>=i)o.Gme.remove(t),t.minY+=r,t.maxY+=r,o.Gme.insert(t);else if(t.maxY>=i)if(t.isValid){for(n=t.minX;n<=t.maxX;n++)for(e=i;e<=t.maxY;e++)o.pBt().setValue(n,e,o.pBt().getValue(n,e+r));for(n=t.minX;n<=t.maxX;n++)for(e=t.maxY+1;e<=t.maxY+r;e++)o.pBt().setValue(n,e,g)}else o.b3().Gde(t.minX,t.minY)})},u.prototype.uE=function(o,a,u){var s=this,t;this.jme(-1,o,-1,h.MAX_COLUMN_COUNT).forEach(function(t){var n,e,i,r;if(t.minY>=o+a)s.Gme.remove(t),t.minY-=a,t.maxY-=a,s.Gme.insert(t);else if(t.minY>=o)s.Rme(t,!0,u);else if(t.maxY>=o&&t.isValid)if(n=t.maxY>o+a-1?t.maxY+1:o+a,e=t.maxY>o+a-1?a:t.maxY-o+1,s.Yme(t.minX,n,t.maxX-t.minX+1,e,!0))for(i=t.minX;i<=t.maxX;i++)for(r=t.maxY;o<=r;r--)s.setValue(i,r+a,s.pBt().getValue(i,r),u);else s.Rme(t,!1,u)})},u.prototype.Ome=function(n,e){var i=this,t;this.jme(-1,n,-1,h.MAX_COLUMN_COUNT).forEach(function(t){t.minY>=n&&(i.Gme.remove(t),t.minY+=e,t.maxY+=e,i.Gme.insert(t))})},u.prototype.Wme=function(t){for(var n,e,i,r,i,n=this,e=t.length-1;0<=e;e--)r=(i=t[e])[0],2<i.length?r[i[1]]=i[2]:1<i.length?n.Gme.remove(i[1]):(i=n.Pme(r.minX,r.minY),n.Rme(i,!0),n.Gme.insert(r))},n.Z8=u},"./dist/plugins/sheetsCalc/external-reference.js":function(t,n,e){"use strict";var i,A,l,N,a,e,I,x,k,_,D,h,j,O,r,o,u,s,c;function d(t,n){var e,i;if(Array.isArray(t))t.forEach(n);else if("object"==typeof t)for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n(i=t[e],e)}function v(t){return t}function m(t){var t,n,t=t.value;return t&&t.richText?(n="",t.richText.forEach(function(t){n+=t.text}),n):t}function f(t,n,e){var i,t,r,e,i=c.call(this,_)||this;return i.getSheetRangeReference=function(t){var n,e,i,r,o,n=this.rT.sheetNames;if(t.endSource&&n&&t.source instanceof f){for(e=!1,i=[],r=0;r<n.length&&((e=n[r]===t.source.oyt?!0:e)&&(o=new f("["+this.rT.i+"]"+n[r],this.ayt,!0),i.push(o.getReference(t))),n[r]!==t.endSource.oyt);r++);return new a.SheetRangeReference(i)}return N.Errors.Name},t=t.split("]"),e&&(r=t[0].substring(1)),n.iyt[r]?i.rT=n.iyt[r]:(e=t[0].indexOf("["),i.rT=n.ryt(t[0].substring(e+1),t[0].substring(0,e),!0)),i.oyt=t[1],i.ayt=n,i}function g(t,n){var e,i,r;if(t)for(e in t)D(t,e)&&(r=(i=t[e]).getExpression())&&r.forEachNodes(function(t){(1===t.type||5===t.type||8===t.type)&&t.source instanceof o&&(n[t.source.rT.i]=!0)})}function p(t,n){var n=t.getRange(n.row,n.column);return n.sheetName=t.source.oyt,n}function b(t){this.iyt=t||{},this.uyt={},this.syt()}i=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ExternalReferenceManager=n.ExternalSource=void 0,A=e("Core"),l=e("Common"),N=e("CalcEngine"),a=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),e=l.Common.lt,I=A.XFileConstants.Rr,x=A.XFileConstants.Lr,k=void 0,_=null,D=l.Common.kh,h=e.ht,j=A.Util.wr,O=A.Util.Mr,r=/^'?\[\d+\]/,c=N.CalcSource,i(f,c),f.prototype.cyt=function(t,n,e){var i,r,i=t.getKey();this.rT=this.ayt.fyt(this.rT),this.eme(),r=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},n?r[i]?r[i][1].push(e):r[i]=[t,[e]]:r[i]&&delete r[i]},f.prototype.eme=function(){this.rT.data=this.rT.data||{};var t=this.rT.data[this.oyt];return t||(this.rT.sheetNames.push(this.oyt),t=this.rT.data[this.oyt]={isNew:!0}),t},f.prototype.getValue=function(t,n){var e,t,e,e=this.eme(),t=e[t];return!t||h(t[n])?e.isNew?N.Errors.Reference:0:(e=t[n])&&e._code&&(e._error||e._calcError)?new N.CalcError(e._error||e._calcError):e},f.prototype.getRowCount=function(){return N.MAX_ROW_COUNT},f.prototype.getColumnCount=function(){return N.MAX_COLUMN_COUNT},f.prototype.createSourceModel=function(){return _},f.prototype.getCalcSourceModel=function(){return _},f.prototype.setCalcSourceModel=function(){},f.prototype.getPeerSource=function(t){return new f("["+this.rT.i+"]"+t,this.ayt,!0)},f.prototype.getSources=function(t){var n,e,i,r,o,n=this.rT.sheetNames,e=[];if(t&&n&&t.oyt)for(i=!1,r=0;r<n.length&&((i=n[r]===this.oyt?!0:i)&&(o=new f("["+this.rT.i+"]"+n[r],this.ayt,!0),e.push(o)),n[r]!==t.oyt);r++);return e},f.prototype.referenceToArray=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,s=this,l=1,h=1,g=[],w=s.rT.Rbt,y=s.oyt+t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+n+"_"+e;if(w){if(w.has(y))return w.get(y)}else w=s.rT.Rbt=(0,N.createMap)();if(0===(m=t.getRangeCount()))g.isError=!0;else if(M=Math.max.apply(null,Object.keys(s.eme()))+1,C=s.getColumnCount(),isNaN(M))(g=[N.Errors.Reference]).isError=!0;else{for(e=e===k||e,S=0;S<m;S++){if(e||g.push(b=[]),d=t.getRow(S),v=t.getColumn(S),0===(l=t.getRowCount(S)))return g.isError=!0,g;if(-1===l&&(d=0,l=M),0===(h=t.getColumnCount(S)))return g.isError=!0,g;if(-1===h&&(v=0,h=C),M<=d||C<=v)return(g=e?[_]:[[_]]).rowCount=1,g.colCount=1,g.rangeCount=1,g;for(M<d+l&&(l=M-d),C<v+h&&(h=C-v),T=void 0,A=!1,I=0;I<l;I++)for(c=d+I,e||b.push(T=[]),x=0;x<h;x++)p=s.getValue(c,f=v+x),A||(p=N.Convert.Nbt(p,n,!N.ExcelCompatibleCalcMode,o,u),i&&N.Convert.BJ(p)&&(A=(g=[p]).isError=!0),N.Convert.Ybt(p,o))||(e?g:T).push(p);if(A)return g}(g=e||1!==m?g:g[0]).rowCount=l,g.colCount=h,g.rangeCount=m,w&&w.set(y,g)}return g},f.prototype.getName=function(t){var t,t=this.Dfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||t&&t.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return t+this.oyt},f.prototype.getIdentity=function(t,n){var e,i,r,o,n,e=this,i=n.row,r=n.rowCount||1,o=n.column,n=n.columnCount||1;return-1===i&&(i=0,r=e.getRowCount()),-1===o&&(o=0,n=e.getColumnCount()),e.getName(t)+"."+i+"."+r+"."+o+"."+n},o=f,n.ExternalSource=o,b.prototype.parseSource=function(t,n){return new o(t,this,n)},b.prototype.ryt=function(t,n,e,i){var r,o;for(r in this.iyt)if(D(this.iyt,r)&&(o=this.iyt[r])&&o.option.name===t&&o.option.path===n)return o;if(!e)for(r in this.iyt)if(D(this.iyt,r)&&(o=this.iyt[r]).option.name===t&&""===n)return o;return i?k:{option:{name:t,path:n},sheetNames:[],data:{}}},b.prototype.syt=function(){for(var t in this.iyt)this.iyt[t]&&(this.iyt[t].i=t)},b.prototype.fyt=function(t){var n,n,n=this.ryt(t.option.name,t.option.path,!0,!0);return n||(n=Object.keys(this.iyt).length+1,(this.iyt[n]=t).i=n,t)},b.prototype.Ep=function(t){var n,e,i,r,o,a,e={},i={},r=1;for(o in this.iyt)D(this.iyt,o)&&(this.uyt[o]&&!A.GC$.isEmptyObject(this.uyt[o])||(n||(n={},g(t.hyt,n),t.sheets.forEach(function(t){g(t.hyt,n)})),n[o]))&&(e[(a=this.iyt[o]).i=r]=a,i[r]=this.uyt[o],r++);this.iyt=e,this.uyt=i},b.prototype.toJSON=function(){var t,n,e,t={};for(n in this.iyt)D(this.iyt,n)&&(e=this.iyt[n],t[n]={option:{name:e.option.name,path:e.option.path},sheetNames:e.sheetNames,data:e.data});return t},b.prototype.wh=function(t){var y,M,n,C,S,T,e,i,y=this.iyt,M=[],n={n_:"externalReferences",c_:M},C={},S=t.workbook.rels,T=0,e=function(t){var n,e,i,t,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w;if(D(y,t)){for(T++,e=(n=y[t]).option.id=I+j(S),S.c_.push({n_:x,Id:e,Type:A.RelationshipConstants.uc,Target:O(A.XFileConstants.nu+"/"+A.XFileConstants.tu+t)}),M.push({n_:"externalReference","r:id":e}),t={n_:"sheetNames",c_:i=[]},r={n_:"sheetDataSet",c_:[]},(o=n.sheetNames)&&o.forEach(function(t){i.push({n_:"sheetName",val:A.mt.Nfe(t)})}),a=n.data,u=0,s=o.length;u<s;u++)if(c=a&&a[o[u]]){for(h in f={n_:A.XFileConstants.bo,sheetId:u},c.isNew&&(f.refreshError=1),l=[],c)if(c.hasOwnProperty(h)&&(d=parseInt(h,10)+1,!isNaN(d))){for(p in g={n_:"row",r:d,c_:m=[]},v=c[h])v.hasOwnProperty(p)&&v[p]!==k&&(b=v[p],(w={n_:"cell"}).r=A.IndexHelper.nr(parseInt(p,10))+d,"string"==typeof b?w.t="str":"boolean"==typeof b?(w.t="b",b=b?"1":"0"):b&&b.code&&(w.t="e","#SPILL!"!==(b=b._calcError||b.error)&&"#CALC!"!==b||(b="#VALUE!")),w.c_=[{n_:"v",c_:[b]}],m.push(w));l.push(g)}f.c_=l,r.c_.push(f)}C[e]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[t,0<r.c_.length?r:_]}],option:n.option}}};for(i in y)e(i);return{externalReferencesNode:n,externalLinks:C,count:T}},b.prototype.dyt=function(t,e,n,r){var i,o,a,i,t,u,s,c,f,i=e&&e.sheets&&Object.keys(e.sheets),o=i&&e.sheets[i[0]].data&&e.sheets[i[0]].data.dataTable,a=o?m:v,i=this.ryt(t,n||"",k,!0);if(!h(i)){for(f in t=i.i,delete(u=this.iyt[t]).Rbt,s=this.uyt[t]||{},u.ime=new l.Common.rbush,c=function(t){var n;D(s,t)&&((n=s[t][0]).vyt(),s[t][1].forEach(function(t){var t=t.getRange(n.row,n.column);u.ime.insert({minX:t.row,minY:t.col,maxX:t.row+t.rowCount-1,maxY:t.col+t.colCount-1})}))},s)c(f);u.sheetNames.forEach(function(t){var n,i,n=o?e.sheets[t]&&e.sheets[t].data.dataTable:e&&e[t];n&&(u.data[t]&&r||(u.data[t]={}),i=u.data[t],d(n,function(t,e){u.ime.collides({minX:e,minY:-1,maxX:e,maxY:-1})&&(i[e]=i[e]||{},d(t,function(t,n){u.ime.collides({minX:e,minY:n,maxX:e,maxY:n})&&(i[e][n]=a(t))}))}))})}},b.prototype._6=function(n,t,e,i){var r,o,r=this;"string"==typeof n?r.dyt(n,t,e,i):n&&(o=r.myt(!0)).forEach(function(t){n[t.filePath+t.name]&&r.dyt(t.name,n[t.filePath+t.name],t.filePath,i)})},b.prototype.myt=function(t){var n,e,i,r,o,a,u,n=[];for(e in this.iyt)if(D(this.iyt,e)){if(i=this.iyt[e],r={name:i.option.name,filePath:i.option.path},t)for(u in o=this.uyt[e]||{},r.items=[],a=function(t){var n,e,t,t;D(o,t)&&(e={row:(n=o[t][0]).row,col:n.column,sheetName:n.w3.rT.getName()},t=1===(t=o[t][1]).length?p(t[0],n):t.map(function(t){return p(t,n)}),r.items.push({target:e,source:t}))},o)a(u);n.push(r)}return n},n.ExternalReferenceManager=b},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(o,t,n){"use strict";var et,u,it,A,S,rt,P,n,N,ot,m,at,ut,p,y,j,L,c,e,a,g,n;function f(t,n){var e,i,r,t,e=m(t.row,(n=n||this).row),i=m(t.column,n.column),r=ot(t.row+t.rowCount,n.row+n.rowCount),t=ot(t.column+t.columnCount,n.column+n.columnCount);return r<=e||t<=i?ut:{row:e,column:i,rowCount:r-e,columnCount:t-i,intersectWith:f}}function i(t,n,e,i,r,o,a,u){var s=this;s.gyt=t,s.pyt=n,s.byt=e,s.yyt=i,s.wyt=r,s.Myt=o,s.Sx=a,s.Cyt=u}function O(t,n,e,i){return(!i||t<n)&&e}function V(t){return[t.row,t.col,t.rowCount,t.colCount].join(",")}function B(t,n,e,i,r){var n=n.rT.id+" "+e+" "+i;t.set(n,r)}function G(t,n,e,i){var n;if(0!==t.size)return n=n.rT.id+" "+e+" "+i,t.has(n)}function s(t,n){var n=new et.Expression(n);return n.value=t,n}function r(t,n){if(t){for(;10===t.type||12===t.type;)t=t.value;if(1===t.type||13===t.type)n(t);else if(9===t.type)r(t.value,n),t.value2&&r(t.value2,n);else if(7===t.type)for(var e=0;e<t.arguments.length;e++)r(t.arguments[e],n)}}function ct(t,n,e,i,r){var o,a,o,a,t,o=!t&&P(n),a=!e&&P(i);if(o&&!a&&(n=0),a&&!o&&(i=0),!o||!a)return n instanceof Date&&(n=u.Common.ct.o0(n)),i instanceof Date&&(i=u.Common.ct.o0(i)),o=t&&!r.useValue?s(t,et.ExpressionType.parentheses):s(n,et.ExpressionType.number),a=e?s(e,et.ExpressionType.parentheses):s(i,et.ExpressionType.number),(t=new et.Expression(et.ExpressionType.operator)).operatorType=c(r.option),t.value=a,t.value2=o,t}function ft(t){r(t,function(t){var n,n,n,n,n;1===t.type&&(t.rowRelative&&t.columnRelative||t.endRowRelative&&t.endColumnRelative)&&(n=[t.row,t.column],t.column=n[0],t.row=n[1],n=[t.endColumn,t.endRow],t.endRow=n[0],t.endColumn=n[1],n=[t.columnRelative,t.rowRelative],t.rowRelative=n[0],t.columnRelative=n[1],n=[t.endColumnRelative,t.endRowRelative],t.endRowRelative=n[0],t.endColumnRelative=n[1],n=[t.isFullColumn,t.isFullRow],t.isFullRow=n[0],t.isFullColumn=n[1])})}function st(){}function k(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,t;return 0<=e||!r?(h=i+(r?e:0),d=o+(a?e:0),v=f&&b(u,t,f),t=!f&&b(u,t,f),l&&-1===o?r?s+c<=h&&s<=e&&e<s+c?e-s+s+c<=h&&(h+=c):s<=h&&!(s<=e&&e<s+c)&&(h+=c):s<=h&&(h+=c):((v||t)&&(!l&&s+c<=e||l&&s<=e)&&(h-=r?c:0,d-=a?c:0),v=f&&b(u,n,f),t=!f&&b(u,n,f),(v||t)&&(!l&&s<=h||l&&(r&&s<=e+i||!r&&s<=i)?(h+=c,d+=c):(!l&&s<=d||l&&(a&&s<=e+o||!a&&s<=o))&&(d+=c)),l&&s+c<=e&&(h+=r?c:0,d+=a?c:0)),{index:h-=r?e:0,endIndex:d-=a?e:0}):{index:i,endIndex:o}}function _(t,n,e,i,r,o,a,u,s,c,f,l,h){var h,d,v,m,g;if(n&&!h){if(h=s?r.row:r.column,d=s?r.rowRelative:r.columnRelative,v=void 0,m=r.row+(r.rowRelative&&e),g=r.column+(r.columnRelative&&i),l&&!l(m,g))return r;if(r.rowRelative&&r.columnRelative&&0===r.row&&0===r.column&&0===a&&f&&(s&&f.Tge||!s&&f.Age))return r;if(s&&0<=e||!s&&0<=i||!d){if(c)v=k(t,n,s?e:i,h,d,-1,!1,o,a,u,s,l).index;else if(v=Z(t,n,s?e:i,h,d,o,a,u,s,l),p(v))return(0,et.Syt)(v);v!==h&&(r=r.offset(s?v-h:0,s?0:v-h,!0))}}return r}function D(t,n,e,i,r,o,a,u,s,c,f,l){var l,l,h,d,v,m,c,t;if(n&&!l){if(3===(l=r.Tyt())||s&&2===l||!s&&1===l)return r;if(l=s?r.rowRelative:r.columnRelative,h=s?r.endRowRelative:r.endColumnRelative,d=s?r.row:r.column,v=s?r.endRow:r.endColumn,m=void 0,s&&0<=e||!s&&0<=i||!l||!h){if(c)m=k(t,n,s?e:i,d,l,v,h,o,a,u,s,f);else if(m=W(t,n,s?e:i,d,l,v,h,o,a,u,s,f),p(m))return(0,et.Syt)(m);c=m.index,t=m.endIndex,c===d&&t===v||(r=r.offset2(s?c-d:0,s?0:c-d,s?t-v:0,s?0:t-v,e,i))}}return r}function R(t,n,e,i,r,o,a,u,s,c){if(n){var n=r;if(n&&o===n.source)return n.offsetWhenInsertRemoveColumn(a,u,s,c)}return r}function C(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,g,p,b,w,y,M,h=C,d=i;if(i){if(1===i.type&&i.hmt())d=_(t,i.source||t,n,e,i,r,o,a,u,s,c,f,l);else if(1===i.type)d=D(t,i.source||t,n,e,i,r,o,a,u,s,f,l);else if(10===i.type)(v=h(t,n,e,i.value,r,o,a,u,s,c,f,l))!==i.value&&(d=(0,et.Ayt)(v));else if(9===i.type)m=h(t,n,e,i.value,r,o,a,u,s,c,f,l),g=i.value2&&h(t,n,e,i.value2,r,o,a,u,s,c,f,l),m===i.value&&g===i.value2||(d=(0,et.rbt)(i.operatorType,m,g));else if(7===i.type){for(p=ut,w=b=void 0,M=(y=i).arguments.length,w=0;w<M;w++)if((v=h(t,n,e,b=y.arguments[w],r,o,a,u,s,c,f,l))!==b){(p=[])[w]=v;break}if(p){for(w=0;w<M;w++)b=y.arguments[w],p[w]!==at&&p[w]!==ut||(p[w]=h(t,n,e,b,r,o,a,u,s,c,f,l));d=(0,et.YJ)(y,p)}}else f&&!t.Iyt||u||13!==i.type||(d=R(t,t,n,e,i,r,o,a,s,f));return i.ensureSingle&&(d.ensureSingle=!0),d}}function l(o,a,u,s,t,n,e,i,c,f,l){var r,h,d,h,r=function(t,n,e,i,r){return a.call(this,t,e,i,n,o,u,s,c,f,r,l)},h=o.getSheet();h&&(d=h.b8&&(h.parent||h).xyt(),h=h.Ut&&h.Ut.pj(),v(d,r,c,h))}function v(t,n,e,i){var r,r,o,a,u,s,c,f,l,h,d,v,m,u,g,p,b,w,y,M,C;if(t)for(s=0;s<t.length;s++){for(f=c=!0,l=S.maxRowCount-1,h=S.maxColumnCount-1,v=0,m=(d=(r=t[s].validator)._S).length;v<m&&(g=(u=d[v]).rowCount,p=u.colCount,a=u.row,u=u.col,-1!==g&&(f=!1,l=a<l?a:l),-1!==p&&(c=!1,h=u<h?u:h),c||f);v++);if(!(e&&f||!e&&c)&&(b=(o=t[s].sheet).Uw(),r=r.condition(),w=void 0,d&&d[0]&&(-1===d[0].row&&(w={Tge:1}),-1===d[0].col)&&(w={Age:1}),(y=r.getExpressions())&&0<y.length)){for(M=0;M<y.length;M++)C=y[M],y[M]=n(b,C,l,h,w);r.setExpressions(y,i)}}}function h(t){var e,n,i,t,r,o,a,e=[],n=t.parent,i=[].concat(n&&n.sheets||[t]),t=null==n?void 0:n.mp;if(t&&t.length)for(r=0,o=t;r<o.length;r++)(a=o[r])&&a.getSheet&&a.getSheet()&&i.push(a.getSheet());return i.forEach(function(n){var t=n.conditionalFormats,t=t&&t.getRules();t&&t.length&&t.forEach(function(t){t.KK&&e.push({rule:t,sheet:n})})}),e}function d(o,a,u,s,c,f){var t,n,e,i,t=function(t,n,e,i,r){return a.call(this,t,e,i,n,o,u,s,c,f,r)},n=o.getSheet();n&&F(e=h(n),t,i=n.Ut&&n.Ut.pj(),c,f)}function F(t,n,e,i,r){var o,a,u,s,c,f,l,c,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,T,N,k,_,D;if(t)for(o=0,a=t.length;o<a;o++){if(s=(u=t[o].rule).ranges(),f=(c=j(s)).r,l=c.c,h=(c=t[o].sheet).Uw(),d=u.condition(),(v=c.tables)&&s&&1===s.length&&(g=(m=s[0]).row,p=m.col,b=m.rowCount,w=m.colCount,y=void 0,r&&i?y=v.AJ(g,p,b,w):c.EB&&c.Nyt&&(y=[c.Nyt]),y)&&y.length){for(M=!1,C=0,S=y.length;C<S;C++)if(A=(T=y[C]).row,I=T.col,x=T.rowCount,T=T.colCount,g===A&&b===x&&I<=p&&p+w<=I+T){M=!0;break}if(M)continue}if(d||(u.initCondition(),d=u.condition()),N=d&&d.getExpressions(),k=void 0,s&&s[0]&&(-1===s[0].row&&(k={Tge:1}),-1===s[0].col)&&(k={Age:1}),N&&0<N.length){for(_=0;_<N.length;_++)D=N[_],N[_]=n(h,D,f,l,k);d.setExpressions(N,e)}}}function z(t,r,o){var n,t,e,n=function(t,n,e,i){return U.call(this,t,e,i,n,r,o)},t=t.getSheet(),e;F(h(t),n,t.Ut.pj())}function Y(t,n,e,i,r,o,a){var u,s,a,c,f,l,h,d,v,m,g,p,b,d,b;if(!a&&(c=(a=(s=(u=t.getSheet()).Ut)&&s.yle())&&a.gle()))for(f in c)if(c.hasOwnProperty(f)&&(l=c[f]))for(h in l)l.hasOwnProperty(h)&&(v=+f,m=+h,d=l[h])&&d.expr&&!P(u.getValueIgnoreDefault(v,m))&&(g=u.op(),p=d.expr,b=d.oldRow,d=d.oldCol,g)&&b&&d&&p&&(p=n.call(self,t,v,m,p,t,e,i,r,o,at),b=g.unparse(t,p,v,m),s.setDefaultValue(v,m,b,ut,rt.DefaultChangeValueType.Expression,ut,!0))}function Z(t,n,e,i,r,o,a,u,s,c){var f,l,t;if(0<=e||!r){if(f=i+(r?e:0),c&&f<e&&f<a)return i;if(l=s&&b(o,t,s),t=!s&&b(o,t,s),(l||t)&&a<=e&&(f+=r?u:0),l=s&&b(o,n,s),t=!s&&b(o,n,s),l||t)if(a+u<=f)f-=u;else if(a<=f)return y;return c&&a<=e&&r&&a<(f-=u)+u&&f<a?y:f-=r?e:0}return i}function b(t,n,e){var e=e?{2:!0}:{1:!0};return t===n||t.Mf===n.Mf&&(3===t.nT&&e[n.nT]||e[t.nT]&&3===n.nT)}function W(t,n,e,i,r,o,a,u,s,c,f,l){var h,d,v,m,t,u,n;if(0<=e||!r){if(h=i+(r?e:0),d=o+(a?e:0),v=s+c-1,m=f&&b(u,t,f),t=!f&&b(u,t,f),(m||t)&&s<=e&&(h+=r?c:0,d+=a?c:0),m=f&&b(u,n,f),t=!f&&b(u,n,f),m||t)if(u=e+i,n=e+o,!l&&v<h||l&&v<u)h-=c,d-=c;else{if(!l&&s<=h&&d<=v||l&&s<=u&&n<=v)return y;!l&&d<s||l&&n<s||(!l&&v<=d||l&&v<=n?(h=!l&&h<=s||l&&u<=s?h:s,d-=c):d=s-1)}return h-=r?e:0,d-=a?e:0,l&&s<=e&&(h-=r?c:0,d-=r?c:0),{index:h,endIndex:d}}return{index:i,endIndex:o}}function Q(t,n,e){var i,r,o,a,u,s,c,f,c,c,f,c,l,h,f,c,d,v,i=Q,r=n;if(n)if(n.source)if(s=n.source,(c=n.endSource)&&s!==c){if(!(f=s.Mf&&s.Mf.parent))return et.kyt;c===e?(c=e.S3,r.endSource=f.getSheet(c-1).Uw()):s===e&&(c=e.S3,r.source=f.getSheet(c).Uw()),delete e.S3,r.source===r.endSource&&delete r.endSource}else(t!==e&&s===e||t===e&&s!==e)&&(r=et.kyt);else if(10===n.type)(o=i(t,n.value,e))!==n.value&&(r=(0,et.Ayt)(o));else if(9===n.type)f=i(t,n.value,e),c=n.value2&&i(t,n.value2,e),f===n.value&&c===n.value2||(r=(0,et.rbt)(n.operatorType,f,c));else if(7===n.type){for(l=ut,h=n.arguments.length,u=0;u<h;u++)if((o=i(t,a=n.arguments[u],e))!==a){(l=[])[u]=o;break}if(l){for(u=0;u<h;u++)a=n.arguments[u],l[u]!==at&&l[u]!==ut||(l[u]=i(t,a,e));r=(0,et.YJ)(n,l)}}else 8===n.type&&(f=t||e,c=N(n.value),s=(d=f.getCustomName(c))&&d.source||(d=(v=f.Lbt.getGlobalSourceModel()||f.getCalcSourceModel()).getSource().getCustomName(c))&&d.source?d.source:s)&&(t!==e&&s===e||t===e&&s!==e)&&(r=et.kyt);return n.ensureSingle&&(r.ensureSingle=!0),r}function E(t,n,e,i,r){return Q(t,i,r)}function J(t,n){return t.yyt===t.gyt&&n!==t.yyt}function K(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,h,m,g,p,g,m,p,v,a=!!i.source,u=i.source||t,s=i.rowRelative,c=i.columnRelative,v=n,h=e,m=r.yyt.Mf;if(r.R0i&&(g=i.row,p=i.column,v=r.wyt+(g-r.pyt)+m.lT(r.wyt,g-r.pyt+1,!0),h=r.Myt+(p-r.byt)+m.lT(r.Myt,p-r.byt+1)),g=r.Dyt(v),m=r._yt(h),(0<=n||!s)&&(0<=e||!c)){if(f=i.row+(s?n:0),l=i.column+(c?e:0),o&&o.isNameID||t===r.gyt&&(d=t===r.yyt?r.Eyt(r.yyt,n,e,1,1)&&!r.R0i:(p=n,v=e,o&&o.crossSheetMoved&&(p-=g,v-=m),r.jyt(r.gyt,p,v,1,1))),u===r.yyt&&r.Eyt(u,f,l,1,1)&&!r.jyt(u,f,l,1,1)&&(!s&&!c||!d))return et.kyt;if(h=(a&&u===r.gyt||!a&&t===r.gyt)&&(!d&&r.jyt(r.gyt,f,l,1,1)||d&&r.Eyt(r.yyt,s?f:f+g,c?l:l+m,1,1)),d&&(f-=s?g:0,l-=c?m:0),h&&(f+=g,l+=m),l-=c?e:0,u=i.source,r.gyt!==r.yyt&&(h&&d?a&&(u=r.yyt):h?u=r.yyt:d&&!a&&(u=r.gyt)),(f-=s?n:0)!==i.row||l!==i.column||u!==i.source)return(0,et.knt)(u,ut,f,l,s,c)}else if((0<=n||!s)&&-1===e){if(f=i.row+(s?n:0),r.Eyt(t,n,e,1,1)&&(f-=s?g:0),r.jyt(u,f,-1,1,-1))f+=g;else if(r.Eyt(u,f,-1,1,-1))return et.kyt;if((f-=s?n:0)!==i.row)return(0,et.knt)(i.source,ut,f,i.column,s,i.columnRelative)}else if(-1===n&&0<=e&&!c){if(l=i.column+(c?e:0),r.Eyt(t,n,e,1,1)&&(l-=c?m:0),r.jyt(u,f,l,1,1))l+=m;else if(r.Eyt(u,f,l,1,1))return et.kyt;if(l-=c?e:0,f!==i.row||l!==i.column)return(0,et.knt)(i.source,i.endSource,i.row,l,i.rowRelative,c)}return i}function M(t,n){var e,i,r,o;return(n=t.getIntersect(n,0,0))?(e=t.row,i=t.col,r=t.rowCount,o=t.colCount,t.rowCount===n.rowCount&&t.colCount===n.colCount||(t.rowCount===n.rowCount?(t.col===n.col&&(i=t.col+n.colCount),o=t.colCount-n.colCount):t.colCount===n.colCount&&(t.row===n.row&&(e=t.row+n.rowCount),r=t.rowCount-n.rowCount)),(0,rt.Ec)(e,i,r,o)):ut}function X(t,n,e,i,r){var t,o;return n&&t&&(!(t=n.getIntersect(t,0,0))&&(o=n.getIntersect(e,0,0))||!!(t&&t.rowCount===n.rowCount&&0!==r||t.colCount===n.colCount&&0!==i))}function q(t,n,e){var t=t.getRange(n,e);return(0,rt.Ec)(t.row,t.col,t.rowCount,t.colCount)}function T(t,n,e,i){var n,r,n=M(t,n);return n?(r=n.union(e),i?(r.col=t.col,r.colCount=t.colCount):(r.row=t.row,r.rowCount=t.rowCount)):r=e,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function I(t,n,e,i,r){var o,t,n,o=M(t,n),t=t.getIntersect(n,0,0);return t?(t.row+=i,t.col+=r,{startRow:(n=o?o.union(t):e).row,endRow:n.row+n.rowCount-1,startColumn:n.col,endColumn:n.col+n.colCount-1}):ut}function $(t,n){var e,i,r,t,o,a,u,n,e=t.row,i=t.col,r=t.rowCount,t=t.colCount,o=n.row,a=n.col,u=n.rowCount,n=n.colCount;return 1===r&&1!==t?a<i&&i<=a+n-1||a<=i+t-1&&i+t-1<a+n-1:1!==t||1===r||o<e&&e<=o+u-1||o<=e+r-1&&e+r-1<o+u-1}function tt(t,n,e,i,r,o){var i,r,o,a,u,s,c,f,l,h,d,v,t,m,g,p,b,w,i=q(i,r,o),r=i.row,o=i.row+i.rowCount-1,a=i.col,u=i.col+i.colCount-1,s=t.pyt,c=s+t.Sx-1,f=t.byt,l=f+t.Cyt-1,h=t.wyt,d=t.Myt,v=(0,rt.Ec)(s,f,t.Sx,t.Cyt),t=(0,rt.Ec)(h,d,t.Sx,t.Cyt),m=i.getIntersect(t,0,0);if(X(v,i,t,n,e))if(w=b=void 0,p=0!==n)if(w=s<=o&&o<=c,(b=s<=r&&r<=c)&&w)r+=n,o+=n;else if(b&&!w){if(n<=0)r+=n;else if(!(o<s+n)){if(!(c+n<o))return I(i,v,t,n,e);if(s===r)return T(i,v,t,p);r+=n}}else if(!b&&w){if(0<=n)o+=n;else if(!(c+n<r)){if(!(r<h))return I(i,v,t,n,e);if(c===o)return T(i,v,t,p);o+=n}}else m&&!m.equals(t)&&$(i,t)&&(r=(g=M(i,m)).row,o=g.row+g.rowCount-1,a=g.col,u=g.col+g.colCount-1);else if(w=f<=u&&u<=l,(b=f<=a&&a<=l)&&w)a+=e,u+=e;else if(b&&!w){if(e<0)a+=e;else if(!(u<f+e)){if(!(l+e<u))return I(i,v,t,n,e);if(f===a)return T(i,v,t,p);a+=e}}else if(!b&&w){if(0<e)u+=e;else if(!(l+e<a)){if(!(a<d))return I(i,v,t,n,e);if(l===u)return T(i,v,t,p);u+=e}}else m&&!m.equals(t)&&$(i,t)&&(r=(g=M(i,m)).row,o=g.row+g.rowCount-1,a=g.col,u=g.col+g.colCount-1);return{startRow:r,endRow:o,startColumn:a,endColumn:u}}function nt(t,n,e,i){return n<e||e+i-1<t}function lt(t,n,e,i){return e<=t&&n<=e+i-1}function ht(t,n,e,i){return t<e&&e+i-1<n}function dt(t,n,e,i){return e===t&&e+i-1<n||t<e&&e+i-1===n}function vt(t,n,e,i){return e<t&&t<=e+i-1&&e+i-1<n||t<e&&e<=n&&n<e+i-1}function w(t,n,e,i,r){return e<=t&&r<=t||n<=e+i-1&&n<=r+i-1}function mt(t,n,e,i,r){for(var o,a,u,o=[nt,lt,ht,dt,vt],u=0;u<o.length;u++)if(o[u](t,n,e,i)){a=u+"_";break}if(e===r)a+="9";else for(u=0;u<o.length;u++)if(e!==r&&o[u](t,n,r,i)){a+=u;break}return a}function gt(t,n,e,i,r){return{row:m(t.startRow,n),col:m(t.startColumn,e),endRow:ot(t.endRow,i),endCol:ot(t.endColumn,r)}}function pt(t,n,e,i,r){return!r.R0i&&t===r.yyt&&r.wyt<=n&&n<=r.Sx+r.wyt-1&&r.Myt<=e&&e<=r.Cyt+r.Myt-1&&(n=n+r.pyt-r.wyt,e=e+r.byt-r.Myt),{startRow:i.row+(i.rowRelative?n:0),endRow:i.endRow+(i.endRowRelative?n:0),startColumn:i.column+(i.columnRelative?e:0),endColumn:i.endColumn+(i.endColumnRelative?e:0)}}function x(t,n,e,i,r,o,a,u,s){return P(o)&&(o=n.startRow),P(a)&&(a=n.startColumn),P(u)&&(u=n.endRow),P(s)&&(s=n.endColumn),(0,et.lJ)(r||t.source,ut,t.rowRelative?o-e:o,t.columnRelative?a-i:a,t.endRowRelative?u-e:u,t.endColumnRelative?s-i:s,t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative,e,i)}function bt(t,n,e,i,r){var o,t,a,u,t,s,c,f,l,h,d,v,o=pt(t,n,e,i,r),t=i.source||t;if(r.gyt===t&&r.yyt===t)switch(t=(a=mt(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))+"-"+(u=mt(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt)),s=r.wyt-r.pyt,c=r.Myt-r.byt,f=gt(o,r.pyt,r.byt,r.pyt+r.Sx-1,r.byt+r.Cyt-1),v=d=h=l=void 0,t){case g.outToCover+"-"+g.outToCover:case g.crossToCover+"-"+g.outToCover:case g.outToCover+"-"+g.crossToCover:case g.crossToCover+"-"+g.crossToCover:case g.coverToCover+"-"+g.outToCover:case g.outToCover+"-"+g.coverToCover:case g.coverNoMove+"-"+g.outToCover:case g.outToCover+"-"+g.coverNoMove:return et.kyt;case g.outToCross+"-"+g.outToCover:case g.coverToCross+"-"+g.outToCover:case g.insideToCross+"-"+g.outToCover:case g.partToCross+"-"+g.outToCover:case g.crossToCross+"-"+g.outToCover:case g.crossNoMove+"-"+g.outToCover:case g.outToCross+"-"+g.coverNoMove:case g.outToCross+"-"+g.coverToCover:case g.outToCross+"-"+g.crossToCover:case g.insideToCross+"-"+g.coverNoMove:case g.insideToCross+"-"+g.coverToCover:case g.insideToCross+"-"+g.crossToCover:return r.wyt<=o.startRow?x(i,o,n,e,ut,r.wyt+r.Sx):x(i,o,n,e,ut,ut,ut,r.wyt-1);case g.outToCover+"-"+g.outToCross:case g.outToCover+"-"+g.coverToCross:case g.outToCover+"-"+g.insideToCross:case g.outToCover+"-"+g.partToCross:case g.outToCover+"-"+g.crossToCross:case g.outToCover+"-"+g.crossNoMove:case g.coverNoMove+"-"+g.outToCross:case g.coverToCover+"-"+g.outToCross:case g.crossToCover+"-"+g.outToCross:case g.coverNoMove+"-"+g.insideToCross:case g.coverToCover+"-"+g.insideToCross:case g.crossToCover+"-"+g.insideToCross:return r.Myt<o.startColumn?x(i,o,n,e,ut,ut,r.Myt+r.Cyt):x(i,o,n,e,ut,ut,ut,ut,r.Myt-1);case g.partToOut+"-"+g.coverNoMove:case g.crossToOut+"-"+g.coverNoMove:if(!w(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))return x(i,o,n,e);case g.coverNoMove+"-"+g.partToOut:case g.coverNoMove+"-"+g.crossToOut:if(a===g.coverNoMove&&!w(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt))return x(i,o,n,e);case g.crossToInside+"-"+g.coverNoMove:case g.coverNoMove+"-"+g.crossToInside:return o.startRow>=r.pyt&&u===g.coverNoMove||o.startColumn>=r.byt&&a===g.coverNoMove?x(i,o,n,e,ut,f.row+s,f.col+c):x(i,o,n,e,ut,ut,ut,f.endRow+s,f.endCol+c);case g.partToInside+"-"+g.coverNoMove:return o.startRow>=r.pyt?x(i,o,n,e,ut,ot(f.row+s,f.endRow+1)):x(i,o,n,e,ut,ut,ut,m(f.endRow+s,f.row-1));case g.coverNoMove+"-"+g.partToInside:return o.startColumn>=r.byt&&a===g.coverNoMove?x(i,o,n,e,ut,ut,ot(f.col+c,f.endCol+1)):x(i,o,n,e,ut,ut,ut,ut,m(f.endCol+c,f.col-1));case g.partToCross+"-"+g.coverNoMove:case g.crossToPart+"-"+g.coverNoMove:case g.crossToCross+"-"+g.coverNoMove:if(w(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))return o.startRow>=r.pyt?x(i,o,n,e,ut,f.row+s):x(i,o,n,e,ut,ut,ut,f.endRow+s);case g.crossToCover+"-"+g.coverNoMove:case g.partToPart+"-"+g.coverNoMove:return r.pyt<r.wyt?x(i,o,n,e,ut,ot(f.row+s,f.endRow+1),ut,f.endRow+s):x(i,o,n,e,ut,f.row+s,ut,m(f.endRow+s,f.row-1));case g.coverNoMove+"-"+g.partToCross:case g.coverNoMove+"-"+g.crossToPart:case g.coverNoMove+"-"+g.crossToCross:if(w(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt))return o.startColumn>=r.byt?x(i,o,n,e,ut,ut,f.col+c):x(i,o,n,e,ut,ut,ut,ut,f.endCol+c);case g.coverNoMove+"-"+g.crossToCover:case g.coverNoMove+"-"+g.partToPart:return r.byt<r.Myt?x(i,o,n,e,ut,ut,ot(f.col+c,f.endCol+1),ut,f.endCol+c):x(i,o,n,e,ut,ut,f.col+c,ut,m(f.endCol+c,f.col-1));case g.crossToCross+"-"+g.coverToCover:case g.crossToPart+"-"+g.coverToCover:case g.partToCross+"-"+g.coverToCover:if(w(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt))return x(i,o,n,e);case g.coverToCover+"-"+g.crossToCross:case g.coverToCover+"-"+g.crossToPart:case g.coverToCover+"-"+g.partToCross:if(a===g.coverToCover&&w(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt))return x(i,o,n,e);case g.coverToCover+"-"+g.partToPart:case g.partToPart+"-"+g.coverToCover:case g.coverToCover+"-"+g.crossToCover:case g.crossToCover+"-"+g.coverToCover:return x(i,o,n,e,ut,f.row+s,f.col+c,f.endRow+s,f.endCol+c);case g.partToPart+"-"+g.crossToCover:case g.partToCross+"-"+g.crossToCover:case g.crossToPart+"-"+g.crossToCover:case g.crossToCross+"-"+g.crossToCover:return w(o.startRow,o.endRow,r.pyt,r.Sx,r.wyt)?x(i,o,n,e):(h=f.row===o.startRow?f.col===o.startColumn?(d=o.endColumn,v=f.col+c,l=f.endRow+s,f.row+s):(d=o.startColumn,v=f.endCol+c,l=a===g.partToCross||a===g.crossToCross?r.pyt+s-1:o.endRow,o.startRow):f.col===o.startColumn?(d=o.endColumn,v=f.col+c,l=o.endRow,a===g.partToCross||a===g.crossToCross?r.pyt+r.Sx-1+s+1:o.startRow):(d=o.startColumn,v=f.endCol+c,l=a===g.partToCross||a===g.crossToCross?f.row+s:o.startRow,f.endRow+s),x(i,o,n,e,ut,ot(l,h),ot(d,v),m(l,h),m(d,v)));case g.crossToCover+"-"+g.partToPart:case g.crossToCover+"-"+g.partToCross:case g.crossToCover+"-"+g.crossToPart:case g.crossToCover+"-"+g.crossToCross:return w(o.startColumn,o.endColumn,r.byt,r.Cyt,r.Myt)?x(i,o,n,e):(h=f.row===o.startRow?(l=(v=f.col===o.startColumn?(d=f.endCol+c,f.col+c):(d=o.endColumn,u===g.partToCross||u===g.crossToCross?r.byt+r.Cyt-1+c+1:o.startColumn),o.endRow),f.row+s):f.col===o.startColumn?(d=o.startColumn,v=u===g.partToCross||u===g.crossToCross?r.byt+c-1:o.endColumn,l=f.endRow+s,o.startRow):(d=u===g.partToCross||u===g.crossToCross?f.col+c:o.startColumn,v=f.endCol+c,l=o.startRow,f.endRow+s),x(i,o,n,e,ut,ot(l,h),ot(d,v),m(l,h),m(d,v)));case g.coverToOut+"-"+g.coverToOut:case g.coverToOut+"-"+g.coverToCross:case g.coverToOut+"-"+g.coverToCover:case g.coverToOut+"-"+g.coverNoMove:case g.coverToCross+"-"+g.coverToOut:case g.coverToCross+"-"+g.coverToCross:case g.coverToCross+"-"+g.coverToCover:case g.coverToCross+"-"+g.coverNoMove:case g.coverToCover+"-"+g.coverToOut:case g.coverToCover+"-"+g.coverToCross:case g.coverToCover+"-"+g.coverToCover:case g.coverToCover+"-"+g.coverNoMove:case g.coverNoMove+"-"+g.coverToOut:case g.coverNoMove+"-"+g.coverToCross:case g.coverNoMove+"-"+g.coverToCover:return x(i,o,n,e,ut,o.startRow+s,o.startColumn+c,o.endRow+s,o.endColumn+c);default:return x(i,o,n,e)}}function wt(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,y,k,_,y,M,D,j,o,y,M,C,D,j,o,M,C,s=!!i.source,c=s?i.source:t,y=o&&o.isDataValidator,M=J(r,t),C=!1,f=i.rowRelative,l=i.columnRelative,h=i.endRowRelative,d=i.endColumnRelative;if(0<=n||!f||!h||0<=e||!l||!d){if(v=i.row+(f?n:0),m=i.endRow+(h?n:0),g=i.column+(l?e:0),b=m-v+1,w=(p=i.endColumn+(d?e:0))-g+1,!y&&M){if(_=r.jyt(c,v,g,b,w))return i.offset(a,u,!0,n,e);if(r.Eyt(c,v,g,b,w))return et.kyt;if(c!==r.gyt||c!==r.yyt||0!==a&&0!==u)return i;C=!0}if(o&&o.isNameID||t===r.gyt&&(k=t===r.yyt?r.Eyt(r.yyt,n,e,1,1):(y=n,M=e,o&&o.crossSheetMoved&&(y-=a,M-=u),r.jyt(r.gyt,y,M,1,1))),(C||t===c&&t===r.gyt&&t===r.yyt)&&(D=n,j=e,k&&(D-=a,j-=u),0===a||0===u)){if(!(o=tt(r,a,u,i,D,j)))return et.kyt;if(0===u&&a&&o.endColumn>=p&&o.startColumn<=g||0===a&&u&&o.endRow>=m&&o.startRow<=v)return y=o.startRow,M=o.startColumn,C=o.endRow,D=o.endColumn,y===v&&C===m&&M===g&&D===p?i:(f&&(y-=n),h&&(C-=n),l&&(M-=e),d&&(D-=e),(0,et.lJ)(i.source,ut,y,M,C,D,f,l,h,d,n,e))}if(k&&(j=r.wyt-r.pyt,o=r.Myt-r.byt,b+=(f?-j:0)+(h?j:0),w+=(l?-o:0)+(d?o:0)),c===r.yyt&&r.Eyt(c,v,g,b,w)&&!w&&(!f&&!l&&!h&&!d||!k))return et.kyt;if(y=(s&&c===r.gyt||!s&&t===r.gyt)&&(!k&&r.jyt(r.gyt,v,g,b,w)||k&&r.Eyt(r.yyt,f?v:v+a,l?g:g+u,b,w)),k&&(v-=A=f?a:0,m-=I=h?a:0,g-=x=l?u:0,p-=N=d?u:0),M=!1,y)v+=a,m+=a,g+=u,p+=u;else if(r.Eyt(c,v,g,b,w)){if(!(C=r.intersectWith(c,v,g,b,w))||C.rowCount!==b&&C.colCount!==w)return et.kyt;v=C.row+a,g=C.col+u,m=v+C.rowCount,p=g+C.colCount,M=!0}return m-=h?n:0,g-=l?e:0,p-=d?e:0,r.gyt===r.yyt?c=s?i.source:at:(c=i.source,y&&k&&s?c=r.yyt:y&&k||(y?c=r.yyt:k&&!s&&(c=r.gyt))),(v-=f?n:0)!==i.row||g!==i.column||m!==i.endRow||p!==i.endColumn||M||c!==i.source?(0,et.lJ)(c,ut,v,g,m,p,f,l,h,d,n,e):void 0}}function yt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,d,v,b,w,y,w,b,y,o,y,M,C,g,S,M,C,S,M,y,d,o,v,a,u=!!i.source?i.source:t,s=i.Tyt(),d=n,v=e,b=r.yyt.Mf;if(r.R0i&&(w=i.row,y=i.column,d=r.wyt+(w-r.pyt)+b.lT(r.wyt,w-r.pyt+1,!0),v=r.Myt+(y-r.byt)+b.lT(r.Myt,y-r.byt+1)),w=r.Dyt(d),b=r._yt(v),0===s){if(y=!r.Oyt&&bt(t,n,e,i,r))return y;if(y=wt(t,n,e,i,r,o,w,b))return y}else if(1===s){if(c=i.rowRelative,l=i.endRowRelative,0<=n||!c||!l){if(d=i.row+(c?n:0),(v=i.endRow+(l?n:0))<d)return et.kyt;if(p=t===r.gyt&&t===r.yyt&&r.Eyt(r.yyt,n,e,1,1),u===r.gyt&&u===r.yyt&&0===r.byt&&0===r.Myt&&r.Cyt===u.getColumnCount()){if(o=r.pyt,y=r.wyt,p&&(d-=w,v-=w),C=o+(M=r.Sx),S=o<=v&&v<C,(g=o<=d&&d<C)&&S)return p?i:i.offset(w,b,!0,n,e);if(M=y+M,g&&y<=v?(d+=w,v<M&&y<=v&&(v=M-1,d=C)):S&&d<=M&&(v+=w,y<=d)&&m<M&&(d=y,v=o-1),v-=l?n:0,(d-=c?n:0)!==i.row||v!==i.endRow)return(0,et.lJ)(i.source,i.endSource,d,A.BAND_INDEX_CONST,v,A.BAND_INDEX_CONST,c,f,l,h,n,e)}if(p)return i.offset(-w,b,!0,n,e)}}else if(2===s&&(f=i.columnRelative,h=i.endColumnRelative,0<=e||!f||!h)){if(m=i.column+(f?e:0),(g=i.endColumn+(h?e:0))<m)return et.kyt;if(p=t===r.gyt&&t===r.yyt&&r.Eyt(r.yyt,n,e,1,1),u===r.gyt&&u===r.yyt&&0===r.pyt&&0===r.wyt&&r.Sx===u.getRowCount()){if(C=r.byt,S=r.Myt,p&&(m-=b,g-=b),y=C+(M=r.Cyt),o=C<=g&&g<y,(d=C<=m&&m<y)&&o)return p?i:i.offset(w,b,!0,n,e);if(v=S+M,d&&S<=g?(m+=b,g<v&&S<=g&&(g=v-1,m=y)):o&&m<=v&&(g+=b,S<=m)&&m<v&&(m=S,g=C-1),g-=h?e:0,(m-=f?e:0)!==i.column||g!==i.endColumn)return(0,et.lJ)(i.source,i.endSource,A.BAND_INDEX_CONST,m,A.BAND_INDEX_CONST,g,c,f,l,h,n,e)}if(p)return i.offset(w,-b,!1,n,e)}return i}function U(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,u=U,s=i;if(1===i.type&&i.hmt())s=o?K(t,n,e,i,r,a):Ct(t,n,e,i,r);else if(1===i.type)s=o?yt(t,n,e,i,r,a):St(t,n,e,i,r);else if(10===i.type)(c=u(t,n,e,i.value,r,o,a))!==i.value&&(s=(0,et.Ayt)(c));else if(9===i.type)f=u(t,n,e,i.value,r,o,a),l=i.value2&&u(t,n,e,i.value2,r,o,a),f===i.value&&l===i.value2||(s=(0,et.rbt)(i.operatorType,f,l));else if(7===i.type){for(h=ut,v=d=void 0,m=i.arguments.length,v=0;v<m;v++)if((c=u(t,n,e,d=i.arguments[v],r,o,a))!==d){(h=[])[v]=c;break}if(h){for(v=0;v<m;v++)d=i.arguments[v],h[v]!==at&&h[v]!==ut||(h[v]=u(t,n,e,d,r,o,a));s=(0,et.YJ)(i,h)}(0,et.isExpression)(i.function)&&(s.function=u(t,n,e,i.function,r,o,a))}return i.ensureSingle&&(s.ensureSingle=!0),s}function Mt(t,n,e){var i,r,o,a,u,u,s,c,f,l,u,h,d,v,i=n.gyt.getSheet();if(!0!==i.EB)for(r=i.Ut.pj(),o=0;o<t.length;o++)if((a=t[o].validator).Epe)delete a.Epe;else if(u=a._S,s=(u=j(u)).r,c=u.c,l=(f=t[o].sheet).Uw(),(h=(u=a.condition()).getExpressions())&&0<h.length){for(d=0;d<h.length;d++)v=h[d],h[d]=U(l,s,c,v,n,e,{isDataValidator:!0});u.setExpressions(h,r)}}function Ct(t,n,e,i,r){var o,a,u,s,c,f,l,o=i.source||t,a=i.rowRelative,u=i.columnRelative,f=r.Dyt(n),l=r._yt(e);if((0<=n||!a)&&(0<=e||!u)){if(s=i.row+(a?n:0),c=i.column+(u?e:0),r.Eyt(t,n,e,1,1)?(s-=a?f:0,c-=u?l:0):r.jyt(t,s,c,1,1)&&(s+=a?f:0,c+=u?l:0),r.jyt(o,s,c,1,1)?(s+=f,c+=l):r.Eyt(o,s,c,1,1)&&(s-=f,c-=l),c-=u?e:0,(s-=a?n:0)!==i.row||c!==i.column)return(0,et.knt)(i.source,ut,s,c,a,u)}else if((0<=n||!a)&&-1===e){if(s=i.row+(a?n:0),r.Eyt(t,n,-1,1,-1)?s-=a?f:0:r.jyt(t,s,-1,1,-1)&&(s+=a?f:0),r.jyt(o,s,-1,1,-1)?s+=f:r.Eyt(o,s,-1,1,-1)&&(s-=f),(s-=a?n:0)!==i.row||c!==i.column)return(0,et.knt)(i.source,ut,s,i.column,a,i.columnRelative)}else if(-1===n&&0<=e&&!u&&(c=i.column+0,r.Eyt(t,-1,e,-1,1)?c-=0:r.jyt(t,-1,c,-1,1)&&(c+=0),r.jyt(o,-1,c,-1,1)?c+=l:r.Eyt(o,-1,c,-1,1)&&(c-=l),c-=0,s!==i.row||c!==i.column))return(0,et.knt)(i.source,ut,i.row,c,i.rowRelative,u);return i}function St(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,o=i.source||t,a=i.Tyt(),S=r.Dyt(n),T=r._yt(e);if(0===a){if(d=i.rowRelative,v=i.columnRelative,m=i.endRowRelative,g=i.endColumnRelative,!(0<=n)&&d&&m||!(0<=e)&&v&&g)if(!(0<=n)&&d&&m||-1!==e){if(-1===n&&(0<=e||!v||!g)){if((c=i.column+(v?e:0))<(f=i.endColumn+(g?e:0)))return et.kyt;if(r.Eyt(t,-1,e,-1,1)?(c-=y=v?T:0,f-=C=g?T:0):r.jyt(t,-1,e,-1,1)&&(c+=y=v?T:0,f+=C=g?T:0),r.jyt(o,-1,c,-1,h=f-c)?(c+=b=T,f+=b):r.Eyt(o,-1,c,-1,h)&&(c-=b=T,f-=b),f-=g?e:0,(c-=v?e:0)!==i.column||f!==i.endColumn)return(0,et.lJ)(i.source,ut,c,i.endRow,f,i.rowRelative,v,i.endRowRelative,g,n,e)}}else{if((u=i.row+(d?n:0))<(s=i.endRow+(m?n:0)))return et.kyt;if(r.Eyt(t,n,-1,1,-1)?(u-=w=d?S:0,s-=M=d?S:0):r.jyt(t,n,-1,1,-1)&&(u+=w=d?S:0,s+=M=d?S:0),r.jyt(o,u,-1,l=s-u,-1)?(u+=p=S,s+=p):r.Eyt(o,u,-1,l,-1)&&(u-=p=S,s-=p),s-=m?n:0,(u-=d?n:0)!==i.row||s!==i.endRow)return(0,et.lJ)(i.source,ut,u,i.column,s,i.endColumn,d,i.columnRelative,m,i.endColumnRelative,n,e)}else if(u=i.row+(d?n:0),s=i.endRow+(m?n:0),c=i.column+(v?e:0),l=s-u,h=(f=i.endColumn+(g?e:0))-c,r.Eyt(t,n,e,1,1)?(u-=w=d?S:0,s-=M=m?S:0,c-=y=v?T:0,f-=C=g?T:0):r.jyt(t,u,c,l,h)&&(u+=w=d?S:0,s+=M=m?S:0,c+=y=v?T:0,f+=C=g?T:0),r.jyt(o,u,c,l,h)?(u+=p=S,s+=p,c+=b=T,f+=b):r.Eyt(o,u,c,l,h)&&(u-=p=S,s-=p,c-=b=T,f-=b),s-=m?n:0,c-=v?e:0,f-=g?e:0,(u-=d?n:0)!==i.row||c!==i.column||s!==i.endRow||f!==i.endColumn)return(0,et.lJ)(i.source,ut,u,c,s,f,d,v,m,g,n,e)}else if(1===a){if(d=i.rowRelative,m=i.endRowRelative,0<=n||!d||!m){if((u=i.row+(d?n:0))<(s=i.endRow+(m?n:0)))return et.kyt;if(r.Eyt(t,n,-1,1,-1)?(u-=w=d?S:0,s-=M=m?S:0):r.jyt(t,n,-1,1,-1)&&(u+=w=d?S:0,s+=M=m?S:0),r.jyt(o,u,-1,l=s-u,-1)?(u+=p=S,s+=p):r.Eyt(o,u,-1,l,-1)&&(u-=p=S,s-=p),s-=m?n:0,(u-=d?n:0)!==i.row||s!==i.endRow)return(0,et.lJ)(i.source,ut,u,A.BAND_INDEX_CONST,s,A.BAND_INDEX_CONST,d,!1,m,!1,n,e)}}else if(2===a){if(v=i.columnRelative,g=i.endColumnRelative,c=i.column+(v?e:0),(f=i.endColumn+(g?e:0))<c)return et.kyt;if(r.Eyt(t,-1,e,-1,1)?(c-=y=v?T:0,f-=C=g?T:0):r.jyt(t,-1,e,-1,1)&&(c+=y=v?T:0,f+=C=g?T:0),r.jyt(o,-1,c,-1,h=f-c)?(c+=b=T,f+=b):r.Eyt(o,-1,c,-1,h)&&(c-=b=T,f-=b),f-=g?e:0,(c-=v?e:0)!==i.column||f!==i.endColumn)return(0,et.lJ)(i.source,ut,A.BAND_INDEX_CONST,c,A.BAND_INDEX_CONST,f,!1,v,!1,g,n,e)}return i}function H(t,n,e,i,r,o){t.Ryt(n,e,i,r,!0,!1,o)}function Tt(t,n,e){var i,r,o,a,u,s,c,f,l,i=Tt,r=n;if(8===n.type){if(n.value===e&&(!n.source||n.source===t.getSource()))return(0,et.Syt)(y,n.source)}else if(10===n.type)(o=i(t,n.value,e))!==n.value&&(r=(0,et.Ayt)(o));else if(9===n.type)s=i(t,n.value,e),c=n.value2&&i(t,n.value2,e),s===n.value&&c===n.value2||(r=(0,et.rbt)(n.operatorType,s,c));else if(7===n.type){for(f=ut,l=n.arguments.length,u=0;u<l;u++)if((o=i(t,a=n.arguments[u],e))!==a){(f=[])[u]=o;break}if(f){for(u=0;u<l;u++)a=n.arguments[u],f[u]!==at&&f[u]!==ut||(f[u]=i(t,a,e));r=(0,et.YJ)(n,f)}}return n.ensureSingle&&(r.ensureSingle=!0),r}Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOnMoveSwap=t.CalcOperatorAdjustor=t.MoveSwapInfo=void 0,et=n("CalcEngine"),u=n("Common"),it=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),A=n("./dist/plugins/sheetsCalc/calc.ns.js"),S=n("./dist/plugins/sheetsCalc/parser-sheets.js"),rt=n("Core"),P=u.Common.lt.ht,n=u.Common.zf,N=n.Gmt,ot=Math.min,m=Math.max,at=void 0,ut=null,p=et.Convert.BJ,y=et.Errors.Reference,j=rt.util.z0,i.prototype.Dyt=function(t){var n,e,t,e,n=this,e=n.yyt.Mf;return n.Oyt=e&&e.o5(),n.Oyt&&0<=t?(t=t-n.wyt+1,e=e.ix(n.wyt,t,!0),n.wyt-n.pyt+e):n.wyt-n.pyt},i.prototype._yt=function(t){var n,e,t,e,n=this,e=n.yyt.Mf;return n.Oyt=e&&e.o5(),n.Oyt&&0<=t?(t=t-n.Myt+1,e=e.ix(n.Myt,t),n.Myt-n.byt+e):n.Myt-n.byt},i.prototype.jyt=function(t,n,e,i,r){var o=this;return o.gyt===t&&(-1===o.pyt||o.pyt<=n&&n+i<=o.pyt+o.Sx)&&(-1===o.byt||o.byt<=e&&e+r<=o.byt+o.Cyt)},i.prototype.Eyt=function(t,n,e,i,r){var o,a,u,s,c,f,l,o=this,a=o.yyt.Mf,u=a&&a.o5(),s=o.wyt,c=o.Myt,f=o.Sx,l=o.Cyt;return u&&(f+=a.lT(s,f,!0),l+=a.lT(c,l)),o.yyt===t&&(-1===s||s<=n&&n+i<=s+f)&&(-1===c||c<=e&&e+r<=c+l)},i.prototype.intersectWith=function(t,n,e,i,r){var o,n,a,o=this;return o.yyt!==t?ut:(n=o.Byt(t,n,e,i,r),(a=o.Byt(t,o.pyt,o.byt,i,r)).intersectWith(n))},i.prototype.Byt=function(t,n,e,i,r){var o,a,u,s,o,a,u,s;return{row:-1===n?0:n,column:-1===e?0:e,rowCount:-1===n||-1===i?t.rowCount:i,columnCount:-1===e||-1===r?t.colCount:r,intersectWith:f}},L=i,t.MoveSwapInfo=L,c=function(t){switch(t){case rt.PasteOperationOptions.add:return 3;case rt.PasteOperationOptions.subtract:return 4;case rt.PasteOperationOptions.multiply:return 5;case rt.PasteOperationOptions.divide:return 6}},st.gB=function(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,b,w,l=e,h=st,d=this.gB;if(e){if(10===(g=e.type))l=(0,et.Ayt)(d.call(h,t,n,e.value,i,r,o,a,u,s,c,f));else if(1===g&&e.hmt()){if(v=ot((e.source||n).getRowCount(),A.MAX_ROW_COUNT),m=ot((e.source||n).getColumnCount(),A.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+i<0||e.row+i>=v)||e.columnRelative&&(e.column+r<0||e.column+r>=m))return(0,et.Syt)(y,e.source);l=e.offset(0,0,!1)}else if(1===g){if(v=ot((e.source||n).getRowCount(),A.MAX_ROW_COUNT),m=ot((e.source||n).getColumnCount(),A.MAX_COLUMN_COUNT),e.rowRelative&&!e.isFullColumn&&(e.row+i<0||e.row+i>v)||e.columnRelative&&!e.isFullRow&&(e.column+r<0||e.column+r>m)||e.endRowRelative&&!e.isFullColumn&&(e.endRow+i<0||e.endRow+i>v)||e.endColumnRelative&&!e.isFullRow&&(e.endColumn+r<0||e.endColumn+r>m))return(0,et.Syt)(y,e.source,e.endSource);l=e.offset(0,0,!1,i,r)}else if(9===e.type)l=(0,et.rbt)(e.operatorType,d.call(h,t,n,e.value,i,r,o,a,u,s,c,f),e.value2&&d.call(h,t,n,e.value2,i,r,o,a,u,s,c,f));else if(7===g){if(b=[],e.arguments&&0<e.arguments.length)for(w=0;w<e.arguments.length;w++)b[w]=d.call(h,t,n,e.arguments[w],i,r,o,a,u,s,c,f);l=(0,et.YJ)(e,b)}else 13===g&&(l=e.offsetWhenCopy(t,n,i,r,o,a,u,s,c,f));e.ensureSingle&&(l.ensureSingle=!0)}return l},st.copyFormula=function(F,L,t,n,e,i,B,P,G,U,H,r){var o,a,V,u,z,s,Y,c,f,l,h,d,v,m,g,p,b,w,y,M,C,Z,W,Q,J,K,X,q,$,S,T,A,tt,nt,I,x,N,k,k,k,k,_,D,k,j,O,j,O,E,R,R,o=F.b3(),a=n.b3(),V=o.getSource(),u=a.getSource(),z=st;if(o&&a){for(r&&(s=r.transpose,Y=r.operationOptions),c=u&&u.getSheet().Ut.pj(),l=t,h=e,d=i,v=B,m=P,(f=L)<0&&(f=0,v=ot(o.rC(),a.rC())),t<0&&(l=0,m=ot(o.cC(),a.cC())),e<0&&(h=0),i<0&&(d=0),g=new et.CalcSourceModel(o.op(),V),M=u.getSheet(),C=!U&&M.o5(),Z=v,W=m,Q=M.getRowCount(),J=M.getColumnCount(),p=0;p<v;p++)for(b=0;b<m;b++)K=p+f,X=b+l,s&&(K=f+b,X=l+p),o.Lyt(g,K,X,p,b);for(q={},$=a.op(),w=p=0;p<v&&p+h<Q;p++)if(S=p+h,C&&0===M.getRowHeight(S))v++;else{if(!G||!u.isHiddenRow(S,!0))for(y=b=0,m=W;b<m&&b+d<J;b++)if(T=b+d,C&&0===M.getColumnWidth(T))m++;else{if((A=g.pB(w,y))||r){if(A===q)continue;if(A=z.gB(V,u,A,S,T,tt=e+p-L-w,nt=i+b-t-y,e,i,Z,W),I=g.sT(w,y),u){if(C&&I)continue;if(I&&!I.isDynamicArray){for(x=I.rowCount,N=I.colCount,0<(k=f-I.row)&&(x-=k),(k=v-p)<x&&(x=k),0<(k=l-I.col)&&(N-=k),(k=m-b)<N&&(N=k),_=0;_<x;_++)for(D=0;D<N;D++)g.bB(p+_,b+D,q);a.setArrayFormula(S,T,x,N,$.unparse(u,A,S,T),at,c)}else{if(k=g.Ile(w,y),H&&M&&k&&(M.vle=k),Y&&(j=w+f,O=y+l,s&&(j=y+f,O=w+l),A=ct(A,F.getValue(j,O),a.pB(S,T),n.getValue(S,T),Y))&&A.value.type===et.ExpressionType.number&&A.value2.type===et.ExpressionType.number){(j=(0,it.evaluateExpression)(n,A))instanceof et.CalcError||n.setValue(S,T,j),y++;continue}A&&s&&ft(A),O=A?$.unparse(u,A,S,T):at,u.setFormula(S,T,O,at),k&&M.Ut.setDefaultValue(S,T,O,ut,rt.DefaultChangeValueType.Expression,ut,!0),(E=g.Fyt(w,y))&&(R=new et.EvaluateContext(u,(0,et.eV)(S,T),!1),E=(E=a.Lbt.allowDynamicArray?(0,et.h0t)(R,A,!1,0,0,!0,!0):(0,et.Pyt)(R,A,!1,0,0,!1,!1))===A?at:E),a.Gyt(S,T,A,E,I,c),k&&(delete M.vle,R=a.oT(S,T))&&R.isDefault(k)}}else a.bB(S,T,A),a.Uyt(S,T,I)}else a&&a.pB(S,T)&&a.Gyt(S,T,at,at,at,c);y++}w++}}},st.moveFormula=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,F,d,v,m,g,t,p,b,w,y,M,C,S,T,A,L,I,x,N,k,_,B,D,j,O,E,R,E,g,t,s=t.b3(),c=i.b3(),f=s.op();if(s&&c){for(l=i.getRowCount(),h=i.getColumnCount(),F=s.pj(),d=c.pj(),v=f.Hyt(),n<0&&(n=0,a=ot(t.getRowCount(),l)),r<0&&(r=0),e<0&&(e=0,u=ot(t.getColumnCount(),h)),o<0&&(o=0),m=!(t===i&&t.name()===i.name()),t=u,p=g=a,(w=i.o5())&&(g+=i.lT(r,a,!0),t+=i.lT(o,u)),s.mF(n,e,a,u),H(s,n,e,a,u),c.mF(r,o,g,t),H(c,r,o,g,t),y=[],M=0;M<a;M++)for(k=M+n,C=0;C<u;C++)S=s.pB(k,_=C+e),T=s.sT(k,_),A=s.Fyt(k,_),I=(L=s.oT(k,_))&&L.isDefault(),S&&(y[M*u+C]={WK:S,$bt:T,eyt:A,xle:I},s.zyt(k,_,F),T&&(k!==T.row||_!==T.col)||s.rT.setFormula(k,_,ut,at));for(D=m?{}:null,x=M=0;M<p&&M+r<l;M++)if(j=M+r,w&&0===i.getRowHeight(j))p++;else{for(N=C=0,b=u;C<b&&o+C<h;C++)if(O=C+o,w&&0===i.getColumnWidth(O))b++;else{if(E=y[x*u+N]){if(S=E.WK,T=E.$bt,w&&T){N++;continue}f&&T&&!T.isDynamicArray&&T.row===n+M&&T.col===e+C&&(B=(0,rt.Ec)(j,O,T.rowCount,T.colCount)),R=T&&!T.isDynamicArray?B:at,A=E.eyt,(I=E.xle)&&(i.vle=I),c.Vyt(d,j,O),c.bB(j,O,S),c.Uyt(j,O,R),c.Yyt(j,O,A),c.Nle(j,O,I),(!R||R.row===j&&R.col===O)&&(E=c.getFormula(j,O),c.rT.setFormula(j,O,E,R),I)&&i.Ut.setDefaultValue(j,O,E,ut,rt.DefaultChangeValueType.Expression,ut,!0),m&&(D[j+", "+O]=S),I&&delete i.vle}else P(c.pB(j,O))||(c.Vyt(d,j,O),c.bB(j,O,at),c.Uyt(j,O,at));N++}x++}v.Zyt(s,n,e,a,u),v.Zyt(c,r,o,g,t),t=(g=s.getSource().getSheet()).b8&&(g.parent||g).xyt(),v.Wyt(t,s.getSource(),n,e,c.getSource(),r,o,a,u,!0,D),!0==m&&v.Wyt(t,s.getSource(),n,e,c.getSource(),r,o,a,u,!0,D)}},st.prototype.isAdjustCell=function(t){return t.preAdj||this.y3&&t===this.y3[0]},st.prototype.isAdjust=function(t){return t.preAdj||this.y3&&t===this.y3[0]},st.prototype.Qyt=function(t,n){var e=this,i,r;isNaN(n)||(e.y3||(e.y3={},e.Kyt={}),i=e.y3[n],r=e.Kyt[n],t&&!t.preAdj&&t!==i&&(i?r.nextAdj=t:e.y3[n]=t,t.preAdj=r,t.nextAdj=ut,e.Kyt[n]=t))},st.prototype.Jyt=function(t,n){var e,i,i,r,e=this;isNaN(n)||(i=e.y3&&e.y3[n],t&&(t.preAdj||t===i)&&(i=t.preAdj,r=t.nextAdj,i?i.nextAdj=r:e.y3[n]=r,r?r.preAdj=i:e.Kyt[n]=i,t.preAdj=ut,t.nextAdj=ut))},st.prototype.Xyt=function(t,n,e,i,r,o,a){this.qyt(t,C,n,e,i,r,o,a);var u=0,s=0,c=0,f=0;0===n&&(i&&r?c=e:i?u=e:r?f=e:s=e),l(t,C,n,e,u,s,c,f,i,r,o),d(t,C,n,e,i,r),Y(t,C,n,e,i,r,a)},st.prototype.qyt=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,y,s,S,T,A,I,x,N,k,_,D,c=this,f=c.y3;if(f){for(b=(0,et.createMap)();f[0];){if(p=(l=(m=f[0]).w3).pj(),g=l.getSource(),G(b,l,h=m.row,d=m.column));else{if(!(v=l.pB(h,d))||n===E&&g===t)(l.getRowExpression&&l.getRowExpression(h)||l.getColumnExpression&&l.getColumnExpression(d))&&l.gF(h,d,1,1);else if(v=n.call(c,g,h,d,v,t,e,i,r,o,at,a,u),w=l.sT(h,d)){if(g===t&&(y=o?i:-i,r?e<=w.row&&(w.row+=y):e<=w.col&&(w.col+=y)),h===w.row&&d===w.col)if(w.isDynamicArray)l.SB(h,d,v,w,!0,O(r?h:d,e,p,t.id===g.id));else for(M=h;M<h+w.rowCount;M++)for(C=d;C<d+w.colCount;C++)l.SB(M,C,v,w,M===h&&C===d,O(r?M:C,e,p,t.id===g.id)),B(b,l,M,C,!0)}else y=g.Mf,(s=!u&&(null==(s=l.oT(h,d))?void 0:s.isDefault()))&&(y.vle=s),l.SB(h,d,v,w,!0,O(r?h:d,e,p,t.id===g.id),ut,ut,u),s&&(S=g.nT,T=l.op().unparse(g,v,h,d),y.Ut.setDefaultValue(h,d,T,S,rt.DefaultChangeValueType.Expression,ut,!0),delete y.vle)}c.Jyt(m,0)}for(;f[1];)p=(l=(m=f[1]).w3).pj(),h=m.row,l.getRowExpression&&(v=l.getRowExpression(h))&&l.SB&&(g=l.getSource(),l.SB(h,-1,n.call(c,g,h,-1,v,t,e,i,r,o),at,!0,O(h,e,p,t.id===g.id))),c.Jyt(m,1);for(;f[2];)p=(l=(m=f[2]).w3).pj(),d=m.column,l.getColumnExpression&&(v=l.getColumnExpression(d))&&l.SB&&(g=l.getSource(),l.SB(-1,d,n.call(c,g,-1,d,v,t,e,i,r,o),at,!0,O(d,e,p,t.id===g.id))),c.Jyt(m,2);for(;f[3];)I=(A=f[3]).name,v=(l=A.w3).$yt(I),x=n.call(c,l.getSource(),0,0,v,t,e,i,r,o,{isNameID:!0}),l.twt(I,x),c.Jyt(A,3);for(N in f)if(3<(k=+N)&&f.hasOwnProperty(N))for(;f[N];)D=(_=f[N]).w3,v=n.call(c,D,0,0,_.expression,t,e,i,r,o),D.setExpression(_.id,_.name,v),c.Jyt(_,k)}},st.prototype.nwt=function(t){var n=this,e,i,r;H(t.getCalcSourceModel(),0,0,t.getRowCount(),t.getColumnCount()),n.qyt(t,E),l(t,E,0,0,0,0,0,0,!0,!1),d(t,E,0,0,!0,!1)},st.prototype.Wyt=function(t,n,e,i,r,o,a,u,F,s,c){var f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,T,I,x,T,f,N,k,_,D,j,O,E,R,l=this,h=U,d=new L(n,e,i,r,o,a,u,F),w=(0,et.createMap)();if(t&&Mt(t,d,s),z(n,d,s),S={},M=l.y3){for(;M[0];){if(v=(m=M[0]).w3,g=m.row,p=m.column,y=v.pj(),G(w,v,g,p));else{if(b=v.pB(g,p),C=v.getSource(),b)if(T=at,c&&c[g+", "+p]&&(C=n,T={crossSheetMoved:!0}),b=h.call(l,C,g,p,b,d,s,T),T=void 0,(A=v.sT(g,p))&&!A.isDynamicArray)if(T=V(A),g===A.row&&p===A.col)for(S[T]=!0,I=g;I<g+A.rowCount;I++)for(x=p;x<p+A.colCount;x++)v.SB(I,x,b,A,I===g&&x===p,y),B(w,v,I,x,!0);else S[T]||(v.SB(g,p,b,A,!1,y),B(w,v,g,p,!0));else T=r.Mf,(f=null==(f=v.oT(g,p))?void 0:f.isDefault())&&(T.vle=f),v.SB(g,p,b,A,!0,y),f&&delete T.vle;else(v.getRowExpression&&v.getRowExpression(g)||v.getColumnExpression&&v.getColumnExpression(p))&&v.gF(g,p,1,1)}l.Jyt(m,0)}for(;M[1];)v=(m=M[1]).w3,g=m.row,y=v.pj(),v.getRowExpression&&(b=v.getRowExpression(g))&&v.ewt&&v.ewt(g,h.call(l,C,g,-1,b,d,s),at,y),l.Jyt(m,1);for(;M[2];)v=(m=M[2]).w3,p=m.column,y=v.pj(),v.getColumnExpression&&(b=v.getColumnExpression(p))&&v.iwt&&v.iwt(p,h.call(l,C,-1,p,b,d,s),at,y),l.Jyt(m,2);for(;M[3];)k=(N=M[3]).name,b=(v=N.w3).$yt(k),_=h.call(l,C,0,0,b,d,s),v.twt(k,_),l.Jyt(N,3);for(D in M)if(3<(j=+D)&&M.hasOwnProperty(D))for(;M[D];)R=(E=(O=M[D]).w3).getSource(),b=h.call(l,R,0,0,O.expression,d,s),E.setExpression(O.id,O.name,b),l.Jyt(O,j)}},st.prototype.Zyt=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=this,a=n+i,u=e+r,f=n;f<a;f++)if(t.dataTable[f])for(l=e;l<u;l++)s=t.rwt(f,l),c=t.pB(f,l),(s||c)&&(o.Jyt(s,0),h=this.zCe(t,s,f,l),s&&c&&(s.row!==h.row||s.column!==h.column||s.isDefault())&&(h.oldRow=s.row,h.oldColumn=s.column,h.isDefault(s.isDefault())),o.Qyt(h,0))},st.prototype.zCe=function(t,n,e,i){var r,n;return n&&n.aT&&n[3]&&(r={aT:[3],3:n[3]}),t.owt(e,i,0),n=t.oT(e,i,!0),r&&(n[3]=r[3],n.aT=r.aT),n},st.prototype.awt=function(t,n,e){for(var i,r,o,i=this,r=n;-1!==r&&r<n+e;r++)(t.rwt(-1,r)||t.pB(-1,r))&&(t.owt(-1,r,2),o=t.uwt(r,!0),i.Qyt(o,2))},st.prototype.swt=function(t,n,e){for(var i,r,o,i=this,r=n;-1!==r&&r<n+e;r++)(t.rwt(r,-1)||t.pB(r,-1))&&(t.owt(r,-1,1),o=t.cwt(r,!0),i.Qyt(o,1))},st.prototype.fwt=function(t){for(var n,e,i,r,o,a,u,n=this,e=t.op().getAllSourceModels(),o=0;o<e.length;o++)if((a=e[o]).lwt)for(i=a.lwt(),u=0;u<i.length;u++)(r=i[u])&&r.isVolatile&&r instanceof et.CellCalc&&!n.isAdjustCell(r)&&n.Qyt(r,0)},st.prototype.onBeforeAddRemoveRows=function(t,i,n){[t,n].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),t.mF(i,0,n-i,e),t.hwt(i,n-i),H(t,i,-1,n-i,-1,!0))})},st.prototype.onAfterAddRemoveRows=function(t,i,r,o,n,e){var a=this;[t,e].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),o?t.gF(i,0,r,e):n+=r,a.Zyt(t,i,0,n-i,e),a.swt(t,i,n-i),a.fwt(t))}),a.Xyt(t.getSource(),i,r,!0,o,at,n),1!==t.op().calculationMode&&t.op().recalculateAll(!1)},st.prototype.onAfterAddRemoveColumns=function(t,i,r,o,n,e){var a=this;[t,e].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),o?t.gF(0,i,n,r):e+=r,a.Zyt(t,0,i,n,e-i),a.awt(t,i,e-i),a.fwt(t))}),a.Xyt(t.getSource(),i,r,!1,o,at,n),1!==t.op().calculationMode&&t.op().recalculateAll(!1)},st.prototype.onBeforeAddRemoveColumns=function(t,i,n){[t,n].forEach(function(t){var n,e;t&&(n=t.rC(),e=t.cC(),t.mF(0,i,n,e-i),t.dwt(i,e-i),H(t,-1,i,-1,e-i,!0))})},st.prototype.onAfterRemoveName=function(t,n){var t=t.vwt(n,!1);t&&(t.updateListening(!0,!1),t.vyt(),t.updateListeningOnRemoved())},st.prototype.adjustFormulaOnRemoveName=Tt,st.prototype.invalidName=function(t,n){var e,t;n&&(t=(e=t.getCalcSourceModel()).vwt(n.toUpperCase(),!0))&&t.mB()},st.prototype.onAfterRemoveTable=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,u=0;u<t.length;u++)H((s=t[u]).source().getCalcSourceModel(),s.startRow(),s.startColumn(),s.endRow()-s.startRow()+1,s.endColumn()-s.startColumn()+1);if(c=e.y3)for(f=(0,et.createMap)();c[0];){if(G(f,i=(l=c[0]).w3,r=l.row,o=l.column));else{if(a=i.pB(r,o))if(a=st.adjustExpressionOnRemoveTable(a,t,r,o,n),(h=i.sT(r,o))&&!h.isDynamicArray)for(h=(0,rt.Ec)(r,o,h.rowCount,h.colCount),d=r;d<r+h.rowCount;d++)for(v=o;v<o+h.colCount;v++)i.SB(d,v,a,h,d===r&&v===o),B(f,i,d,v,!0);else i.SB(r,o,a,h,!0);else(i.getRowExpression&&i.getRowExpression(r)||i.getColumnExpression&&i.getColumnExpression(o))&&i.gF(r,o,1,1)}e.Jyt(l,0)}},st.adjustExpressionOnRemoveTable=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,a,u,g,p,b,w,y,o=st.adjustExpressionOnRemoveTable;if(9===t.type){if(a=t.value,u=t.value2,s=o(a,n,e,i,r),c=u&&o(u,n,e,i,r),a!==s||u!==c)return(0,et.rbt)(t.operatorType,s,c)}else if(7===t.type){for(f=!1,l=[],h=0;h<t.arguments.length;h++)v=o(d=t.arguments[h],n,e,i,r),f=f||d!==v,l.push(v);if(f)return(0,et.YJ)(t,l)}else if(10===t.type){if((a=t.value)!==(u=o(a,n,e,i,r)))return(0,et.Ayt)(u)}else if(13===t.type)for(g=t,h=0;h<n.length;h++)if(g.baseTable===n[h])return r?et.kyt:(p=g.getRange(-1===e?0:e,-1===i?0:i,!0),b=-1===e||1===g.referencePortions(),w=1===p.rowCount&&1===p.colCount,y=g.source,w?(0,et.knt)(y,ut,b?p.row-e:p.row,p.col,b,!1):(0,et.lJ)(y,ut,b?p.row-e:p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1,b,!1,b,!1));return t},e=st,t.CalcOperatorAdjustor=e,(a=et.CalcService.prototype).mwt=function(){return new e},(n=g=g||{}).outToOut="0_0",n.outToCover="0_1",n.outToInside="0_2",n.outToPart="0_3",n.outToCross="0_4",n.outNoMove="0_9",n.coverToOut="1_0",n.coverToCover="1_1",n.coverToCross="1_4",n.coverNoMove="1_9",n.insideToOut="2_0",n.insideToInside="2_2",n.insideToPart="2_3",n.insideToCross="2_4",n.insideNoMove="2_9",n.partToOut="3_0",n.partToInside="3_2",n.partToPart="3_3",n.partToCross="3_4",n.partNoMove="3_9",n.crossToOut="4_0",n.crossToCover="4_1",n.crossToInside="4_2",n.crossToPart="4_3",n.crossToCross="4_4",n.crossNoMove="4_9",t.adjustFormulaOnMoveSwap=U},"./dist/plugins/sheetsCalc/parser-sheets.js":function(F,v,t){"use strict";var n,d,M,k,g,C,S,T,e,t,i,m,p,A,f,b,L,a,u,c,B,l,r,o,t,t,s,h;function P(t){return e(t+1).split("")}function w(t,n){var e=n+1;return t<0?t%e+e:n<t?t%e:t}function G(t){return new k.ErrorSource(t)}function U(t,n,e,i,r,o,a){return 3===a||0<=e&&0<=i||1===a&&0<=e||2===a&&0<=i}function H(t,n,e,i,r){var o,o,a,a,a,o=C.BAND_INDEX_CONST,o={Ky:o,iw:o,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},a=n?Z(t,e,i,0):Y(t,0,r);if(a.DX?(o.Ky=a.Mwt,o.gwt=a.Cwt):(o.iw=a.Mwt,o.pwt=a.Cwt),o.ywt=a.ywt,o.bwt=a.bwt,a.bwt&&!(a.ywt>=t.length)){if(!n&&a.DX||n&&!a.DX)return{bwt:!1};if(a=t[o.ywt],(n||!(0,k.isNumber)(a)&&"$"!==a)&&(!n||"C"!==a&&"c"!==a))return{bwt:!1};a=n?Z(t,e,i,o.ywt):Y(t,o.ywt,r),o.ywt=a.ywt,!a.bwt||!n&&!a.DX||n&&a.DX?o.bwt=!1:(o.ywt<t.length&&(o.wwt=!1),n?(o.iw=a.Mwt,o.pwt=a.Cwt):(o.Ky=a.Mwt,o.gwt=a.Cwt),o.bwt=!0)}return o}function V(t){return(0,k.Swt)(t)||95===t.charCodeAt(0)}function z(t,n,e){for(var i=t,r=n[t],t=!1;i<e&&!V(r);)++i<e&&(r=n[i]);if(i<e){for(;i<e&&V(r);)++i<e&&(r=n[i]);i<e&&(t=!0)}return t}function Y(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i={Cwt:!0,bwt:!1},r=t.length;if(!(r<=n||("$"===t[n]&&(i.Cwt=!1,n++),r<=n)))if(u=t[o=n],(a=0,k.isNumber)(u)&&"0"!==u){for(i.DX=!0;o<r&&(0,k.isNumber)(u);)++o<r&&(u=t[o]);if(7<o-n)return i;for(s=o-1,c=0;n<=s;s--,c++)a+=(t[s].charCodeAt(0)-48)*b[c];if(a<=v.maxRowCount)i.Mwt=a-1,i.ywt=o,i.bwt=!0}else if((0,k.Swt)(u)){for(i.DX=!1;o<r&&(0,k.Swt)(u);)++o<r&&(u=t[o]);if(3<(f=o-n)||z(o,t,r))return i;for(h=l=o-1;n<=h;h--){if(!(65<=(d=t[h].charCodeAt(0))&&d<=90||97<=d&&d<=122))return i;a+=((32|d)-96)*m[l-h]}if(a<=v.maxColumnCount)i.Mwt=a-1,i.ywt=o,i.bwt=!0}return i}function Z(t,n,e,i){var r,o,a,u,s,c,n,e,r,o={ywt:i,Mwt:C.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},a=t.length;if(a<=i)return o;if("R"===(s=t[u=i])||"r"===s)o.DX=!0,c=n;else{if("C"!==s&&"c"!==s)return o;o.DX=!1,c=e}if(u++,a<=++i)return o.ywt=i,o.Mwt=c,o.Cwt=!0,o.bwt=!0,o;if("["===(s=t[u])&&(i++,u++,o.Cwt=!0),a<=i)return o;if(n=!1,s=t[u],o.Cwt&&"-"===s&&(i++,u++,n=!0),a<=i)return o;if(s=t[u],!(0,k.isNumber)(s))return o.Cwt||(o.ywt=i,o.Mwt=c,o.Cwt=!0,o.bwt=!0),o;for(;u<a&&(0,k.isNumber)(s);)++u<a&&(s=t[u]);if(e=parseInt(t.slice(i,u).join(""),10),o.Cwt){if(a<=u||"]"!==t[u])return o;u++}return e<(o.DX?v.maxRowCount:v.maxColumnCount)?(o.Mwt=o.Cwt?(e=n?-e:e)+c:e-1,o.ywt=u,o.bwt=!0,o):void 0}function W(t,n,e,i){var r,o,a,u,r=t.row||0,o=t.column||0,a=e.type;if(e.source){if(!(u=J(t,i,e.source,e.endSource)))return void i.push("#","R","E","F","!")}else!e.source&&t.addSheetName&&1===a&&(2===t.addSheetName?i.push("!"):J(t,i,t.source,p));8===a||5===a||e.value&&e._error?i.push(e.value.toString()):e.hmt()?y(t.useR1C1,r,o,e.row,e.column,e.rowRelative,e.columnRelative,i):Q(t.source,t.useR1C1,r,o,e.row,e.column,e.endRow,e.endColumn,e.rowRelative,e.columnRelative,e.endRowRelative,e.endColumnRelative,i,e.Tyt())}function y(t,n,e,i,r,o,a,u,s){var c,c,c=v.maxRowCount-1;(0===(s=s||0)||1===s)&&-c<i&&i<=2*c&&(i=w(i+=o?n:0,c)),c=v.maxColumnCount-1,U(n,e,i,r=(0===s||2===s)&&-c<r&&r<=2*c?w(r+=a?e:0,c):r,o,a,s)?t?2!==s&&(u.push("R"),0<=i&&(n!==i||!o)&&(o?u.push("["+(i-n)+"]"):u.push(++i+"")),r<0)||1!==s&&(u.push("C"),e===r&&a||(a?u.push("["+(r-e)+"]"):u.push(++r+""))):(0<=r&&(a||u.push("$"),u.push.apply(u,P(r))),i<0||(i++,o||u.push("$"),u.push(i+""))):u.push(k.Errors.Reference.toString())}function Q(t,n,e,i,r,o,a,u,s,c,f,l,h,d){3===(d=d||0)&&(r=0,a=v.maxRowCount-1,d=1),y(n,e,i,r,o,s,c,h,d);var s=C.BAND_INDEX_CONST;n&&r===a&&o===u&&(a===s||u===s)||a===s&&u===s||(h.push(":"),y(n,e,i,a,u,f,l,h,d))}function J(t,n,e,i){if(t.getExternalSourceToken){if(e){var e=(0,k.Mge)(t,t.getExternalSourceToken(e).split(""),i&&t.getExternalSourceToken(i).split(""));if(!(0<e.length))return!1;n.push.apply(n,e)}return n.push("!"),!0}return!1}function I(t){var n=new k.Expression(8);return n.value=t,n}function K(t){var n=t;return n=t&&3<=t.length&&"["===t[0]&&"0"===t[1]&&"]"===t[2]?3===t.length?"":t.substring(3):n}function X(t,n,e){var i,t,r,o,a,u,t=t.source;return i=t&&(r=t.G3,o=t.S8,a=t.T8,r)&&(u=0<=n&&n<o&&a<=e||o<=n&&0<=e&&e<a)?t:i}function x(t){var n=o.call(this,8e3)||this;return n.Mf=t,n}function q(t,n,e,i,r){return 0===n.uit&&0===n.Twt||!i&&0===n.uit&&4===n.Twt&&(!r||e<t.length-2&&":"===t[e+1].Awt&&0===t[e+2].uit&&4===t[e+2].Twt)}function $(t,n,e,i,r){return n<=t.startRow()&&e<=t.startColumn()&&n+i>t.endRow()&&e+r>t.endColumn()}function N(){return s.call(this,13)||this}function tt(t,n){this.abt.Iwt(t,this,n)}function _(t){var n=h.call(this,7900)||this;return n.Mf=t,n}function nt(t,n,e){var i,r,o,e,a,u,a,s,c,f,l,h,d,d,v,i=e,r=0,o=n[r],e=lt(t,n,r,o),a=e.nM;if(!a){if(u=t.keepUnknownFormulas)return;O()}for(i.baseTable=a,r=e.xwt,o=n[++r],a=r;" "===o;)o=n[++r];for("@"!==o&&"["!==o&&(o=n[r=a]),f=c=!(s=1),l=n.length;0!==s&&r<l;)if("["===o&&(s++,o=n[++r]),"#"===o)c&&s<=1&&O(),d=(h=ft(n,r,o,s)).Nwt,r=h.xwt,o=h.kwt,s=h.Dwt,c?2===i.hbt&&3===d||2===d&&3===i.hbt?i.hbt=6:3===i.hbt&&8===d||3===d&&8===i.hbt?i.hbt=12:O():i.hbt=d,c=!0;else if("@"===o){for((1<s||c)&&O(),c=!0,i.hbt=1,o=n[++r];" "===o;)o=n[++r];"["===o&&"#"===n[r+1]&&"this row"===D(n,r+2,r+10).toLowerCase()&&(c=!1),","===o&&O()}else{for(d=r;!T(o)&&"]"!==o&&"["!==o;)if("'"===o&&r++,","===o){for(o=n[++r],v=r;" "===o;)o=n[++r];if("["===o){r=v,o=",";break}}else o=n[++r];if(d<r&&((f||"["===o&&1<s)&&O(),r=(h=et(i,n,r,o,s,d)).xwt,o=h.kwt,s=h.Dwt,f=!0),"]"===o){if(0===--s)break;r>=n.length&&O(),o=n[++r]}","===o&&(o=n[++r])}c||(i.hbt=t._wt?1:16),f||(i.cbt=0,i.fbt=i.abt.endColumn()-i.abt.startColumn(),i.lbt=1)}function D(t,n,e){return t.slice(n,e).join("")}function et(t,n,e,i,r,o){var t,a,u,s,c,f,l,l,o,h,l,t=t,a=[],s=!1,c=!1;if(1<r)s=!0,r--,a=n.slice(o,e),":"===(i=n[++e])&&(c="["===(i=n[++e]),u=(l=st(n,e,i,r)).sbt,e=l.xwt,i=l.kwt,r=l.Dwt);else if("["===i){for(c=!0,i=n[f=e-1];" "===i;)i=n[--f];":"!==i&&O(),a=it(a=n.slice(o,f)),u=(l=st(n,e,i=n[e],r)).sbt,e=l.xwt,i=l.kwt,r=l.Dwt}else t.hbt!==p&&16!==t.hbt||(s=!0),0<(f=(l=n.slice(o,e)).indexOf(":"))?(a=l.slice(0,f),"["!==(u=l.slice(f+1))[0]&&O()):a=l;if(o=ot(t,a,s),t.ubt=a.join(""),t.sbt=t.ubt,u?(h=ot(t,u,c),t.lbt=4,t.sbt=u.join("")):(h=o,t.lbt=2),h<o&&(l=o,o=h,h=l),t.cbt=o,t.fbt=h,++e<n.length)for(i=n[e];" "===i;)i=n[++e];return{xwt:e,kwt:i,Dwt:r}}function it(t){for(var n=t.length-1;0<=n&&" "===t[n];)n--;for(;0<=n&&" "!==t[n];)n--;return 0<=n?t.slice(n+1,t.length-n-1):t}function rt(t){for(var n=0,e=t.length,i=0;n<e&&" "===t[n];)n++;for(i=n,n=e-1;i<n&&" "===t[n];)n++;return i<=n?t.slice(i,n+1):t}function ot(t,n,e){var i,r,o,e;if(n&&at(n,e)){for(i=[],r=0,o=n.length;r<o;r++)"'"===n[r]&&r<o-1&&r++,i.push(n[r]);return n=i,(e=t.abt.getColumnIndexInTable(n.join("")))<0&&O(),e}return-1}function at(t,n){var e,i,r;if(n)return 1;if(e="","#"!==(i=e=t[0])&&"@"!==e&&" "!==e&&","!==e&&":"!==e&&"["!==e&&"]"!==e){for(r=1;r<t.length;r++){if(","===(e=t[r])||":"===e||"["===e&&"'"!==i||"]"===e&&"'"!==i||"@"===e&&"'"!==i||"#"===e&&"'"!==i)return;i=e}return 1}}function j(t){for(var n,e,i,n=[],i=0;i<t.length;i++)"["!==(e=t[i])&&"]"!==e&&"@"!==e&&"#"!==e&&"'"!==e||n.push("'"),n.push(e);return n.join("")}function ut(t){var n,e,n="";if("#"===(n=t[0])||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return 1;for(e=1;e<t.length;e++)if(" "===(n=t[e])||","===n||":"===n||"["===n||"]"===n||"@"===n||"#"===n)return 1}function st(t,n,e,i){var r,o,o,r=!1;if("["===e)for(r=!0,i++,e=t[++n];" "===e;)e=t[++n];for(o=n;"]"!==e&&(","!==e||1<i);)"'"===e&&n++,e=t[++n];return n<=o&&O(),o=t.slice(o,n),1<i&&i--,{sbt:o=r?o:rt(o),xwt:n,kwt:e,Dwt:i}}function ct(t){var n,e,n=(0,k.getMapping)()&&(0,k.getMapping)().tableFunctionsMapping;if(!T(n))for(e in n)if(n[e].toLowerCase()===t)return e.toLowerCase();return t}function ft(t,n,e,i){for(var r,o,a,u,s,c,r=14,o=n;"]"!==e;)"'"===e&&n++,e=t[++n];for(a=ct(a=D(t,o,n).toLowerCase().trim()),u=!1,s=0;s<f.length;s++)if(a===(c=f[s])){r=l[a],u=!0;break}if(u||O(),++n>=t.length)i--;else{for(e=t[n];" "===e;)e=t[++n];if(","===e){for(i<=1&&O(),e=t[++n];" "===e;)e=t[++n];"["===e&&(i++,e=t[++n])}1<i&&i--}return{Nwt:r,xwt:n,kwt:e,Dwt:i}}function lt(t,n,e,i){for(var r,o,a,u,o=0,a=n.length;"["!==i&&e<a;)i=n[++e];return{nM:r=0<e?(u=D(n,0,e),t.getTableByName(u)):t.getTableByIndex(t.row,t.column),xwt:e,kwt:i}}function O(){throw i().Exp_FormulaInvalid}function ht(t,n,e){var i,r,o,a,u,s,c,i=(0,k.getMapping)()&&(0,k.getMapping)().tableFunctionsMapping,r=(0,k.sR)().d2t,o=i?i["#All"]:r.All.name,a=i?i["#This row"]:r.thisRow.name,u=i?i["#Headers"]:r.Headers.name,s=i?i["#Data"]:r.Data.name,c=i?i["#Totals"]:r.Totals.name;switch(t){case 1:return e?"["+a+"]":"@";case 2:return n?"["+u+"]":u;case 3:return n?"["+s+"]":s;case 8:return n?"["+c+"]":c;case 6:return"["+u+"], ["+s+"]";case 12:return"["+s+"], ["+c+"]"}return n?"["+o+"]":o}function dt(t,n){var e,i,r,o,a,u,s,c,e,f,l;for(t.unshift(new k.FormulaToken("=",1,0,0,0)),o=[],a=0,r=t.length-1;0<r;r--)t[r].lp===t[r-1].lp&&t[r].Awt===t[r-1].Awt||(o[a]=t[r],a++);for(o[a]=t[r],o.reverse(),u=[],c=s=0;c<o.length;c++,s++)i=vt(o[c]),u[s]=o[c],(e=c+1<o.length?o[c+1].lp:n.length)>o[c].lp+i&&(e=new k.FormulaToken(n.slice(o[c].lp+i,e),7,o[c].lp+i),o[c].ywt=o[c].lp+i-1,u[++s]=e);for(f=0;f<u.length;f++)l=u[f].Awt.trim(),3===u[f].Twt?u[f].Awt='"'+u[f].Awt+'"':"("===l||"{"===l?(u[f].uit=1,u[f].Twt=1):")"!==l&&"}"!==l||(u[f].uit=1,u[f].Twt=2);return u}function vt(t){return 1===t.uit&&"ARRAY"===t.Awt?1:0===t.uit&&3===t.Twt?(t.Ewt||t.Awt).length+2:0===t.uit&&12===t.Twt?t.Awt.length+3:t.Awt.length}function E(t,n,e){var n,i;t&&n&&((i=t[n=n.getName&&n.getName()||"!"])||(i=t[n]=[],t.sheets||(t.sheets=[]),t.sheets.push(n)),i.push(e))}function R(t,n,e,i,r,o){var a,u,a,s;if(t){for(;10===t.type;)t=t.value;if(!(2<=(t=12===t.type?t.value:t).type&&t.type<=6))if(1===t.type)a=t.getRange(r,o),!i.source||t.source&&t.source!==i.source||n.push(a),E(e,t.source||i.source,a);else if(13===t.type)a=t.getRange(r,o),t.source===i.source&&a&&n.push(a),E(e,t.source||i.source,a);else if(8===t.type)t.jwt||(t.jwt=!0,a=A,t.source?t.source.op()&&(a=new k.EvaluateContext(t.source,(0,k.eV)(r,o))):a=i,R(a.getName(t.value),n,e,a,r,o),t.jwt=p);else if(9===t.type)R(t.value,n,e,i,r,o),t.value2&&R(t.value2,n,e,i,r,o);else if(7===t.type)for(s=0;s<t.arguments.length;s++)R(t.arguments[s],n,e,i,r,o)}}function mt(t,n,e,i,r,o,a,u,s){var o,n,c,f;t.setParserOption(o),o=[],n=n.split(""),T(s)&&(s=d.SheetArea.viewport);try{c=!!u||e.op().useR1C1,f=e.Uw(s).getParserContext(!a&&c,(0,k.eV)(i,r),{sheetArea:s}),o=t.parseToTokens(f,n,!1)}catch(t){}return gt(t,o=dt(o,n),n,e,i,r,a,u,s)}function gt(t,n,e,i,r,o,a,u,s){var c,f,l,h,u;return void 0===s&&(s=d.SheetArea.viewport),f=p,l=i.Uw(s),h=i.op(),u=!!u||h.useR1C1,h?(c=new g.SheetParserContext(i,!a&&u,(0,k.eV)(r,o),{sheetArea:s}),f=new k.EvaluateContext(l,(0,k.eV)(r,o),!1)):c=new k.ParserContext(A,!1,(0,k.eV)(0,0)),c.ignoreError=!0,pt(t,l,c,f,n,e,r,o)}function pt(t,n,e,i,r,o,a,u){for(var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,s=[],f=0;f<r.length;f++)try{if("["===(c=r[f]).Awt||"#"===c.y4[0]||3===c.Twt)s.push({index:c.lp,endIndex:c.ywt,text:c.Ewt||c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt});else if(f=bt(t,e,r,f,l=[]),v=d=h=void 0,0<l.length){for(m=0;m<l.length;m++)if((g=l[m])instanceof k.FormulaToken)s.push({index:g.lp,endIndex:g.ywt,text:o.slice(g.lp,g.ywt+1).join(""),type:g.uit,subType:g.Twt,canDrag:h,ranges:[],value:g.Awt});else if(g.WK){if(b=(p=g.WK).type,w=p.source,y=o.slice(g.lp,g.ywt+1).join(""),M=[],C={},h=!0,S=p.getRange&&p.getRange(a,u),8===b)v=d=!(h=!1),i&&(T=i,R(A=(T=p.source?new k.EvaluateContext(p.source,(0,k.eV)(a,u),!1):T).getName(p.value),M,C,i,a,u));else if(13===b||22===b)v=!(h=!1),w&&n&&w.Mf===n.Mf&&S?M.push(S):M=null,E(C,w,S);else if(1===b)if(v=!0,p.endSource)for(x=p.endSource,N=w.getSources(x),m=0;m<N.length;m++){if(N[m]===n){M.push(S);break}E(C,N[m],S)}else E(C,w||n,S),(!w||n&&w.Mf===n.Mf)&&M.push(S);else v=!1,M=null;M&&0<M.length||v?s.push({index:g.lp,endIndex:g.ywt,text:y,type:0,subType:7,canDrag:h,ranges:M,value:y,sheetRanges:C,sheetArea:w&&w.nT||n.nT,isName:d}):s.push({index:g.lp,endIndex:g.ywt,text:y,type:c.uit,subType:c.Twt,canDrag:h,ranges:M,value:y,sheetRanges:C,isName:d})}}else s.push({index:c.lp,endIndex:c.ywt,text:c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt})}catch(t){s.push({index:c.lp,endIndex:c.ywt,text:c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt})}return s}function bt(t,n,e,i,r){var o,t,n,t,a,a,e,o=e[i];return o&&"function"!=typeof o&&0===o.uit&&(n=t.resolveToken(n,e,t=[],i)-1,1===(a=(t=t[0]).type)||13===a||8===a||5===a||22===a&&t.source)?(a=e[n],e={lp:o.lp,ywt:a.ywt,WK:t},r.push(e),n):i}n=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(v,"__esModule",{value:!0}),v.getExpressTokenImp=v.Vgt=v.fillBlankToTokens=v.getValidaColumnName=v.StructureReferenceResolver=v.obt=v.StructReferenceColumnSpecifier=v.StructReferencePortions=v.SheetReferenceResolver=v.validateSheetName=v.maxColumnCount=v.maxRowCount=void 0,d=t("Core"),M=t("Common"),k=t("CalcEngine"),g=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),C=t("./dist/plugins/sheetsCalc/calc.ns.js"),S=t("./dist/plugins/sheetsCalc/external-reference.js"),T=M.Common.lt.ht,e=d.util.Vf,t=new M.Common.ResourceManager(d.SR),i=t.getResource.bind(t),v.maxRowCount=d.XmlConstants.Io,v.maxColumnCount=d.XmlConstants.xo,m=[1,26,676],p=void 0,A=null,f=["#all","#data","#headers","#totals","#this row"],b=[1,10,100,1e3,1e4,1e5,1e6,1e6],v.validateSheetName=k.Cmt,o=k.TokenResolver,n(x,o),x.prototype.resolveToken=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,l,g,p,m,p,h,l,g,h,m,l,b,w,y,r=t.useR1C1,o=t.row||0,a=t.column||0,s=e.length,c=e[i],f=c.Awt,l=c.uit,h=c.Twt;if(0!==l&&6!==h)return!1;if(0===l&&0===h&&i<s-2&&":"===e[i+1].Awt&&12===e[i+2].Twt&&e[i+2].Awt.indexOf(":")<0||0===l&&12===h){if(g=l=void 0,p=f.lastIndexOf(":"),m=f.lastIndexOf("]"),(f=M.Common.zf.fJ(f,"'")&&M.Common.zf.dT(f,"'")?f.substring(1,f.length-1):f)&&(m<p?(l=f.substring(0,p-1),g=f.substring(p)):("'"===(l=f).charAt(0)&&(l=l.substring(1,l.length-1)),0===h&&(g=e[i+2].Awt,i+=2,"'"===g.charAt(0))&&(g=g.substring(1,g.length-1)))),i++,m=!!l,(l=K(l))&&(d=(d=t.getExternalSource("",l))||G(l),g=K(g))&&(d instanceof S.ExternalSource?(v=d.getPeerSource(g)).Dfe=!0:v=(v=t.getExternalSource("",g))||G(g)),(c=e[i])&&"["===c.y4[0])return!1;if(!c)return I(f);f=c.Awt}if(p=i===s-1?A:e[i+1],q(e,c,i,r,!0)){if(h=t&&t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray,!(l=H(c.y4,r,o,a,h)).bwt&&!m)return!1;if(c.Twt=7,l.bwt&&l.wwt){if(g=l.Ky,h=l.iw,m=l.gwt,l=l.pwt,i<s-2&&5===p.uit&&":"===p.Awt&&q(e,p=e[i+2],i+2,r,!1)&&(b=H(p.y4,r,o,a)).bwt&&g===C.BAND_INDEX_CONST==(b.Ky===C.BAND_INDEX_CONST)&&h===C.BAND_INDEX_CONST==(b.iw===C.BAND_INDEX_CONST))return o=g===C.BAND_INDEX_CONST?0:o,a=h===C.BAND_INDEX_CONST?0:a,{index:i+3,expr:(0,k.lJ)(d,v,g-(m?o:0),h-(l?a:0),b.Ky-(b.gwt?o:0),b.iw-(b.pwt?a:0),m,l,b.gwt,b.pwt,o,a)};if(g===C.BAND_INDEX_CONST||h===C.BAND_INDEX_CONST){if(r)return g-=g!==C.BAND_INDEX_CONST&&m?o:0,h-=h!==C.BAND_INDEX_CONST&&l?a:0,{index:i+1,expr:(0,k.lJ)(d,v,g,h,g,h,m,l,m,l,o,a)};if(!d)return!1;u=I(f)}if(!u)return T(d)&&(d=X(t,o,a)),{index:i+1,expr:u=(0,k.knt)(d,v,w=g-(m?o:0),y=h-(l?a:0),m,l)}}else u=I(f)}else if(6===c.Twt)(u=new k.Expression(5)).value=k.CalcError.parse(c.Awt);else{if(!d||1===c.uit)return!1;u=I(f)}return d&&(u.source=d),v&&(u.endSource=v),{index:i+1,expr:u}},x.prototype.unparse=function(t,n,e,i){var r=e&&e.type;return(1===r||8===r||5===r)&&(W(t,n,e,i),!0)},v.SheetReferenceResolver=x,(t=a=v.StructReferencePortions||(v.StructReferencePortions={}))[t.ThisRow=1]="ThisRow",t[t.Headers=2]="Headers",t[t.Data=3]="Data",t[t.Totals=8]="Totals",t[t.HeadersAndData=6]="HeadersAndData",t[t.DataAndTotals=12]="DataAndTotals",t[t.All=14]="All",t[t.NotSpecific=16]="NotSpecific",(t=u=v.StructReferenceColumnSpecifier||(v.StructReferenceColumnSpecifier={}))[t.All=1]="All",t[t.NotSpecific=1]="NotSpecific",t[t.SingleColumn=2]="SingleColumn",t[t.ColumnRange=4]="ColumnRange",s=k.Expression,n(N,s),N.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(N.prototype,"baseTable",{get:function(){return this.abt},set:function(t){this.abt=t,this.source=t.source()},enumerable:!1,configurable:!0}),N.prototype._K=function(){this.Owt=this.abt.startColumn()},N.prototype.columnReferenceStart=function(){return this.cbt+this.abt.startColumn()},N.prototype.columnReferenceEnd=function(){return this.fbt+this.abt.startColumn()},N.prototype.referencePortions=function(){return this.hbt},N.prototype.referenceColumnSpecifier=function(){return this.lbt},N.prototype.getRange=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,r,i=this,r=i.abt;switch(i._K(),l=r.startRow(),h=r.endRow(),d=r.hasTotalsRow(),v=r.hasHeadersRow(),i.hbt){case 3:case 16:o=v?l+1:l,u=d?h-1:h;break;case 2:if(v)u=o=l;else{if(!e)return A;u=o=l-1}break;case 8:if(d)u=o=h;else{if(!e)return A;u=o=h+1}break;case 1:u=o=t;break;case 6:o=l+(e&&!v?-1:0),u=d?h-1:h;break;case 12:o=v?l+1:l,u=h+(e&&!d?1:0);break;default:o=l+(e&&!v?-1:0),u=h+(e&&!d?1:0)}if(22===i.type){if(a=i.abt.getColumnIndexInTable(i.ubt),s=i.abt.getColumnIndexInTable(i.sbt),-1===a||-1===s)return A}else a=i.columnReferenceStart(),s=i.columnReferenceEnd();return r=r.endColumn(),1===i.lbt&&(s=r),r<a||r<s?(i._error=!0,A):u<o||!e&&o<l||!e&&h<u?A:(0,k.Rwt)(o,a,c=u-o+1,f=s-a+1)},N.prototype.offsetWhenInsertRemoveColumn=function(t,n,e,i){var r,o,i,e,r=this,o=r.Owt;return T(o)&&(r._K(),o=r.Owt),T(o)||t<o||t===o&&e&&!i||t>r.fbt+o?r:(n=e?n:-n,i=t-o,(e=new N).baseTable=r.abt,e.fbt=r.fbt+n,e.cbt=r.cbt,t<=o+r.cbt&&(e.cbt+=n,e.cbt<i)&&(e.cbt=i),e.lbt=r.lbt,e.hbt=r.hbt,e.fbt<e.cbt?k.kyt:e)},N.prototype.offsetWhenCopy=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,e,i,r,o,v,m,f=this,l=new g.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,k.eV)(e,i)),h=l.getTableByIndex(e,i),d=f.offset();return h&&(e=e-r,i=i-o,r=a-r,o=u-o,v=void 0,(v=(t===n?l:m=new g.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,k.eV)(e,i))).getTableByIndex(e,i))!==h)&&v===f.abt&&$(v,r,o,s,c)&&$(h,a,u,s,c)&&(d.baseTable=h),d},N.prototype.Bwt=function(t){var n,e,i,n=this,e=new N;return e.baseTable=n.abt,e.fbt=n.fbt,e.cbt=n.cbt,2===n.lbt&&t&&(i=n.abt.endColumn()-n.abt.startColumn()+1,e.cbt+=t%=i,e.cbt<0&&(e.cbt+=i),e.fbt=e.cbt),e.lbt=n.lbt,e.hbt=n.hbt,e},N.prototype.offset=function(t,n,e){var i,r,i=this,r=new N;return r.baseTable=i.baseTable,r.hbt=i.hbt,r.cbt=i.cbt,r.fbt=i.fbt,r.lbt=i.lbt,r},N.prototype.Lwt=function(t,n){var e=this.abt;return t>=e.startRow()&&n>=e.startColumn()&&t<=e.endRow()&&n<=e.endColumn()},N.prototype.Fwt=function(t,n,e){this.abt.Pwt(t,n,e)},c=N,v.obt=c,h=k.TokenResolver,n(_,h),_.prototype.resolveToken=function(t,n,e,i){var r,e,o,a,r,u,s,r,r=e[i],e=e[i+1];if(0===r.uit){if(a=o=void 0,0===r.Twt||7===r.Twt)o=r.Awt;else{if(12!==r.Twt||!e||0!==e.uit||0!==e.Twt||"["!==e.y4[0])return A;o=(r="'"===(r=r.Awt)[0]?r.substr(1,r.length-2):r)+e.Awt,a=!0}if("]"===o.charAt(o.length-1))try{return u=new c,nt(t,o.split(""),u),u.baseTable?(u.abt.Mf.NMi&&((s=u).type=22,s.Iwt=tt),a?{index:i+2,expr:u}:u):new k.Expression(0)}catch(t){}else if(r=t.getTableByName&&t.getTableByName(o))return _.create(r)}return A},_.prototype.unparse=function(t,n,e,i){var r,o,a,u,s,c,n,f,u,a,o,a,u;if(13!==e.type&&22!==e.type)return!1;if(o=(r=e).abt.Gwt,a=T(o)?r.abt.tableName():o,t.Sbt)u=r.getRange(t.row,t.column,!0),W(t,n,s=(0,k.lJ)(r.source,A,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1,!1,!1,!1,!1),i);else{if(n=i.length,22===r.type&&r.baseTable.Mf.xT)c=!0;else if(16===r.hbt&&1===r.lbt)return i.push(a),void(t.lyt&&i.push("[]"));(f=t.source===r.abt.source()&&r.Lwt(t.row,t.column))&&!t.lyt&&!r.abt.Mf.NMi||(u=T(o)?r.abt.tableName():o,(a=r.abt.Mf)&&a.NMi&&!(0,k.Cmt)(u.split(""))&&(u=(0,k.Mge)(t,u.split(""),null).join("")+"!"),i.push(u)),i.push("["),16!==r.hbt&&(o=ht(r.hbt,1!==r.lbt,t.lyt),i.push(o)),1!==r.lbt&&(1===r.hbt&&!t.lyt||16===r.hbt||i.push(", "),(a=22===e.type?r.abt.getColumnName(r.cbt)||r.ubt:r.abt.getColumnName(r.cbt))?a=j(a):c=!0,c||(4===r.lbt?(u=22===e.type?r.abt.getColumnName(r.fbt)||r.sbt:r.abt.getColumnName(r.fbt))?(u=j(u),i.push("[",a,"]:[",u,"]")):c=!0:1===r.hbt&&!t.lyt&&!ut(a)||16===r.hbt?i.push(a):i.push("[",a,"]"))),c?(i.length=n,i.push("#REF!")):i.push("]")}return!0},_.create=function(t,n,e,i,r){void 0===n&&(n=a.NotSpecific),void 0===e&&(e=u.NotSpecific),void 0===i&&(i=0),void 0===r&&(r=t.endColumn()-t.startColumn());var o=new c;return o.baseTable=t,o.hbt=n,o.cbt=i,o.fbt=r,o.lbt=e,o},v.StructureReferenceResolver=_,v.getValidaColumnName=j,l={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},v.fillBlankToTokens=dt,v.Vgt=mt,v.getExpressTokenImp=pt},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/sheetsCalc/calc.ns.js"),n),r(e("./dist/plugins/sheetsCalc/parser-sheets.js"),n),r(e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),n),r(e("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),n),r(e("./dist/plugins/sheetsCalc/worksheet-formula.js"),n),e("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(t,n,e){"use strict";var G,n,i,m,l,U,C,T,r,h,e,S,A,I,x,v,N,H,V,k,z,_,D,o,j,f,O,Y,e;function E(t){t.forEach(function(t){var n;delete t.Uw().G3})}function g(t,c,f,l){G.GC$.each(t,function(t,n){var e,i,r,o,a,u,n,s,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),a=n.getComment(),u=n.getFormatter&&n.getFormatter(),n=n.getSheetTabName&&n.getSheetTabName();o&&(e={name:e,formula:s=u||c.unparse(f,o,i,r,!1,!0),sheetTabName:n,row:i,col:r},a&&(e.comment=a),l.push(e))})}function Z(t,n){var t,e,i,t=N(t);if("str"===n)e=t;else if("b"===n)e="1"===t;else if("e"===n){switch(i=I,t){case"#DIV/0!":i=7;break;case"#N/A":i=42;break;case"#NAME?":i=29;break;case"#NULL!":i=0;break;case"#NUM!":i=36;break;case"#REF!":i=23;break;case"#VALUE!":i=15}e=i!==I?{error:t,code:i}:I}else e=t===I?I:parseFloat(t);return e}Object.defineProperty(n,"__esModule",{value:!0}),G=e("Core"),n=e("Common"),i=e("CalcEngine"),m=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),U=e("./dist/plugins/sheetsCalc/external-reference.js"),C=e("./dist/plugins/sheetsCalc/calc-extra-save.js"),T=e("./dist/plugins/sheetsCalc/worksheet-formula.js"),r=m.SpreadSource,h=n.Common.zf.Gmt,e=new n.Common.ResourceManager(G.SR),S=e.getResource.bind(e),A=void 0,I=null,x=n.Common.lt.ht,v=G.mt.o1,N=G.mt.c1,H=G.mt.xr,V=G.mt.go,k=G.Util.Sr,z=G.IndexHelper.$i,_=G.Util.mr,D=G.mt.n1,o=G.mt.vo,j=G.Util.io,f=G.mt.St,O=G.XFileConstants.mo,Y=G.XFileConstants.Ki,(e=G.Workbook.prototype).Qp=function(t){var n,e,n=this,e=n.Lp;n.Lp=new i.CalcService,n.Lp.useR1C1=1===n.options.referenceStyle,n.Lp.allowDynamicArray=n.options.allowDynamicArray,n.Lp.iterativeCalculation=n.options.iterativeCalculation,n.Lp.iterativeCalculationMaximumIterations=n.options.iterativeCalculationMaximumIterations,n.Lp.calculationMode=n.options.calculationMode,n.Lp.iterativeCalculationMaximumChange=n.options.iterativeCalculationMaximumChange,t&&e&&n.Lp.cloneFrom(e),n.yC=new r(n),n.wC=n.Lp.getGlobalSourceModel(n.yC)},e.addCustomFunction=function(t){this.Uwt(t)},e.Uwt=function(t){if(!(t&&t instanceof i.Functions.Function))throw new Error(S().Exp_InvalidCustomFunction);t.name=h(t.name),this.Amt[t.name]=t},e.getCustomFunction=function(t){return t?this.Amt[h(t)]:A},e.removeCustomFunction=function(t){t&&delete this.Amt[h(t)]},e.clearCustomFunctions=function(){this.Amt={}},e.addCustomName=function(t,n,e,i,r,o){this.zwt(this.hyt,t,n,e,i,!1,r,o)},e.Vwt=function(t){return!this.hyt[h(t)]},e.isValidCustomName=function(t){return t&&G.mt.P0(t)&&this.Vwt(t)},e.pp=function(t,n,e,i,r,o,a,u){var s,c,s=this;if(!n||!e)throw new Error(S().Exp_InvalidCustomName);u&&s.Lp&&f(e)?(c=u.Ywt(e,i,r),t[h(n)]=new l.FormatterNameInfo(n,e,u.name(),c,i,r)):s.zwt(t,n,e,i,r,o,a)},e.zwt=function(t,n,e,i,r,o,a,u){var s,c,c,f,s,s=this;if(!n||!e||!o&&!s.isValidCustomName(n))throw new Error(S().Exp_InvalidCustomName);if(s.Lp){if(c=(c=(0,G.jf)(this))?c.Uw():I,f=void 0,o)try{f=s.Lp.parse(c,e,i,r,!1,!0,!0)}catch(t){}else f=s.Lp.parse(c,e,i,r);t[h(n)]=new l.NameInfo(n,f,i,r,a,u),o||((s={})[n]=n,this.Zwt(s,!0))}},e.Wwt=function(t,n,e,i,r,o,a,u){var s,e,s=this;if(!n||!e||!a&&!s.isValidCustomName(n))throw new Error(S().Exp_InvalidCustomName);s.Lp&&(t[h(n)]=new l.NameInfo(n,i,r,o,u),a||((e={})[n]=n,this.Zwt(e,!0)))},e.getCustomName=function(t){return t?this.hyt[h(t)]:A},e.xO=function(t){return t?this.bp[h(t)]:A},e.getCustomNames=function(){var e=[];return G.GC$.each(this.hyt,function(t,n){e.push(n)}),e},e.Qwt=function(){var e=[];return G.GC$.each(this.bp,function(t,n){e.push(n)}),e},e.removeCustomName=function(t){var n;t&&(delete this.hyt[h(t)],(n={})[t]=t,this.Zwt(n,!1))},e.o3=function(t){var n;t&&(delete this.bp[h(t)],(n={})[t]=t,this.Zwt(n,!1))},e.clearCustomNames=function(){var t=this.hyt;this.hyt={},this.Zwt(t,!1)},e.getNameInfos=function(){return this.hyt},e.setNameInfos=function(t){x(t)||(this.hyt=t)},e.Kwt=function(){var t=this.bp;this.bp={},this.Zwt(t,!1)},e.Zwt=function(t,n){var e,i,t;if(t){for(i in e=this.wC,t)e&&e.updateNameCalc(i,n);this.Lp&&!this.Lp.IsSuspended()&&(t=this.getActiveSheet())&&(t.suspendPaint(),this.Lp.recalculateAll(!1),t.resumePaint()),this.ki(G.Events.CustomNameChangedInternal,{})}},e.calculate=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,t,e=this,i=e.op();if(i){switch(o=!(r=A),t){case G.CalculationType.rebuild:r=!0;break;case G.CalculationType.minimal:o=r=!1;break;case G.CalculationType.regular:r=!1}if(this.suspendPaint(),x(n)){if(i.suspend(!0),r)for(a=void 0,a=e.sheets||[],(0,T.resetCustomName)(e&&e.hyt,I,i),u=0;u<a.length;u++)for(c=(s=a[u]).Uw(),(0,T.resetCustomName)(s.hyt,c,i),l=(f=c.getCalcSourceModel()).getAllNodes(),h=0;h<l.length;h++)(v=(d=l[h]).calc)&&d.WK&&(0,T.adjustOneFormula)(i,v);i.resume(r,!o,!0)}else(s=e.getSheetFromName(n))?s.c3n(r,o):0<e.sheets.length&&(t=m.formulaToRanges(e.sheets[0],n,0,0,!0)[0]||m.formulaToRanges(e.sheets[0],n,0,0)[0])&&(s=e.getSheetFromName(t.sheetName)).c3n(r,o,t.ranges[0]);this.resumePaint()}},e.getCalcService=function(){return this.Lp},e.op=function(){return this.Lp},e.suspendCalcService=function(t){this.Lp&&this.Lp.suspend(t)},e.resumeCalcService=function(t){this.Lp&&this.Lp.resume(t)},e.getCircularReference=function(){return this.Lp.MTe()},e.updateExternalReference=function(t,n,e,i){this.suspendPaint(),this.suspendCalcService(),this._p._6(t,n,e,i),this.resumeCalcService(!1),this.resumePaint()},e.getExternalReferences=function(t){return this._p.myt(t)},G.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new U.ExternalReferenceManager},toJson:function(t){var n,e,e,s,e,i,r,c,n,f,n=this,e=n.Amt;G.GC$.isEmptyObject(e)||(t.customFunctions=e),e=n._p.toJSON(n),G.GC$.isEmptyObject(e)||(t.externalReference=e),s=[],e=[],i=n.getCustomNames(),r=n.Qwt(),c=n.Lp,n=(0,G.Sp)(this),f=n?n.Uw():I,i&&c&&(G.GC$.each(i,function(t,n){var e,i,r,o,a,n,u,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),a=n.isReadOnly(),n=n.getComment();o&&(e={name:e,formula:u=c.unparse(f,o,i,r,!1,!0,2),row:i,col:r},n&&(e.comment=n),"boolean"==typeof a&&(e.isReadOnly=a),s.push(e))}),g(r,c,f,e),0<s.length&&(t.names=s),0<e.length)&&(t.formatStringNames=e)},wh:function(t,n,u){var e,i,i,r,o,a,s,i,r,c,o,f,o,l,h,d,o,i,e=this,i=e.Amt;G.GC$.isEmptyObject(i)||(t.workbook.lossless.customFunctions=i),e._p&&(r=(i=e._p.wh(t)).externalReferencesNode,o=i.externalLinks,0<(a=i.count))&&(t.workbook.c_.push(r),t.externalLinks=o),s=[],i=v(t.workbook,"definedNames"),r=e.getCustomNames(),c=e.Lp,o=(0,G.Sp)(this),f=o?o.Uw():I,o=e.yC,l=o&&o.getUsedCustomNames()||{},r&&0<r.length&&c&&(i||t.workbook.c_.push(i={n_:"definedNames",c_:[]}),h=i.c_,d=!u||!1!==u.includeUnusedNames,G.GC$.each(r,function(t,n){var e,i,r,o,a,n,i,r,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),a=n.isReadOnly(),n=n.getComment();o&&(d||l[e])&&(i=c.unparse(f,o,i,r,!1,!0,2),r=G.Util.Oge({name:e,comment:n,isReadOnly:a},i),u&&u.includeCalcModelCache&&(e=(0,C.exprToJSON)(o),s.push(e),r.e=s.length-1),h.push(r))})),0<s.length&&(t.workbook.lossless.exprs=s),o=[],(i=e.Qwt())&&0<i.length&&c&&(g(i,c,f,o),0<o.length)&&(t.workbook.lossless.formatStringNames=o),t.workbook.lossless.idMap=(0,C.dbt)(c)},preFromSJSFormat:function(t,F,L){var n,e,i,r,o,a,u,s,c,f,l,h,d,u,v,m,g,p,b,w,y,M,C,S,T,A,B,I,x,N,k,_,D,j,j,_,O,E,R,P,n=H(t.workbook,"externalReferences"),e=t.externalLinks;if(n&&e&&n.c_&&0<n.c_.length){for(r in i={},e)if(e.hasOwnProperty(r)){if(o=e[r],a={},u=H(o,"externalBook")){if(c=[],(s=H(u,"sheetNames"))&&s.c_&&s.c_.length){for(f=0,l=s.c_.length;f<l;f++)(h=s.c_[f])&&(d=h.val)&&(d=G.mt.kfe(d),c.push(d));a.sheetNames=c}if(u=H(u,"sheetDataSet")){if(v={},m=V(u,G.XFileConstants.bo))for(g=0,p=m.length;g<p;g++)if(w=+(b=m[g]).sheetId,y=!!b.refreshError,M=v[d=c[w]]={},y&&(M.isNew=!0),C=V(b,"row"))for(S=0,T=C.length;S<T;S++)if((A=C[S])&&(I=M[B=A.r-1]={},x=V(A,"cell")))for(N=0,k=x.length;N<k;N++)D=void 0,(_=x[N])&&((j=_.r)&&(D=z(j)),j=_.t,O=void 0,(_=H(_,"v"))&&(O=Z(_,j)),I[D]=O);a.data=v}}a.option=o.option,i[r]=a}for(E={},P=(R=n.c_).length,f=0;f<P;f++)E[f+1]=i[R[f][Y]];this._p=new U.ExternalReferenceManager(E)}},yh:function(r,e,i){var o,n,a,u,t,s,c,f,l,h,d,v,m,g,p,p,b,w,y;function M(){var t,t;return n||(t=(t=(0,G.jf)(o)||o.sheets[0])?t.Uw():I,n=t&&t.getParserContext(!1)),n}if(a=(o=this).Lp,u=i&&!i.fullRecalc,t=G.Util.wo(i,o.v2),a&&(a.suspend(),a.lb=u),o.clearCustomNames(),(s=o.sheets).forEach(function(t){t.Uw().G3=!0}),c=r.workbook.lossless,i&&(i.$wt=(0,C.vbt)(a,c)),(f=e.workbookNames)&&0<f.length&&f.forEach(function(t){var n=D(t.name),e=N(t),i=D(t.comment),r=t.isReadOnly;c&&c.exprs&&c.exprs[t.e]?o.Wwt(o.hyt,(0,T.convertBuiltInNameToDisplayName)(n),""+_(D(e)),(0,C.exprFromJSON)(c.exprs[t.e],M()),0,0,!0,i,!0):e&&o.zwt(o.hyt,(0,T.convertBuiltInNameToDisplayName)(n),""+_(D(e)),0,0,!0,i,r)}),o.Kwt(),l=c&&c.formatStringNames)for(h=0;h<l.length;h++)d=l[h],x(d.sheetTabName)&&o.pp(this.bp,d.name,d.formula,d.row,d.col,!0,d.comment,A,!0);if(o.clearCustomFunctions(),v=c&&c.customFunctions)for(m in v)v.hasOwnProperty(m)&&(g=v[m],p=(0,G.getTypeFromString)(g.typeName))&&((p=new p).fromJSON(g),o.Uwt(p));t||(b=[],w=r.workbook.rels&&r.workbook.rels.c_,(y=H(r.workbook,O).c_).forEach(function(t){var n,n,t,t,t,e,i,n=j(D(t.name)),n=o.getSheetFromName(n)||o.Gm(n),t=t[Y],t=k(w,t),t=t&&t.Target;n&&t&&(e=o.getSheetRelsName(t),i=void 0,i=(-1<t.indexOf("xl/chartsheets")?r.chartsheets:r.sheets)[e],b.push({sheet:3===n._gi?n.getTemplate():n,sheetData:i}))}),b.forEach(function(t){var n=t.sheet,t=t.sheetData;n&&n.nameFunctionFromSJSFormat&&n.nameFunctionFromSJSFormat(t,e,i)}),b.forEach(function(t){var n=t.sheet,t=t.sheetData;n&&n.formulaFromSJSFormat&&n.formulaFromSJSFormat(t,e,i)})),i.incrementLoadTask.addTask(function(t,n,e){a&&(u?a.resumeWithoutCalc():a.resume(!1,!1,!a.calcOnDemand),delete a.lb),E(s)},[a,r,i],u?A:S().STEP.startCalc,function(){return u?G.STEP_RATE.end:G.STEP_RATE.loadFileData+G.STEP_RATE.parseFile+G.STEP_RATE.loadSheetDataWithCalc+G.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(r,e,i){var o,a,u,t,s,n,c,f,l,h,d,v,m,g,g,p,b,w,o=this,a=o.Lp,u=i&&!i.fullRecalc,t=G.Util.wo(i,o.v2);if(a&&(a.suspend(),a.lb=u),o.clearCustomNames(),(s=o.sheets).forEach(function(t){t.Uw().G3=!0}),n=r.workbook.lossless,(c=e.workbookNames)&&0<c.length&&c.forEach(function(t){var n=D(t.name),e=N(t),i=D(t.comment),t=t.isReadOnly;e&&o.zwt(o.hyt,(0,T.convertBuiltInNameToDisplayName)(n),""+_(D(e)),0,0,!0,i,t)}),o.Kwt(),f=n&&n.formatStringNames)for(l=0;l<f.length;l++)h=f[l],x(h.sheetTabName)&&o.pp(this.bp,h.name,h.formula,h.row,h.col,!0,h.comment,A,!0);if(o.clearCustomFunctions(),d=n&&n.customFunctions)for(v in d)d.hasOwnProperty(v)&&(m=d[v],g=(0,G.getTypeFromString)(m.typeName))&&((g=new g).fromJSON(m),o.Uwt(g));t||(p=[],b=r.workbook.rels&&r.workbook.rels.c_,(w=H(r.workbook,O).c_).forEach(function(t){var n,n,t,t,t,e,i,n=j(D(t.name)),n=o.getSheetFromName(n)||o.Gm(n),t=t[Y],t=k(b,t),t=t&&t.Target;n&&t&&(e=o.getSheetRelsName(t),i=void 0,i=(-1<t.indexOf("xl/chartsheets")?r.chartsheets:r.sheets)[e],p.push({sheet:3===n._gi?n.getTemplate():n,sheetData:i}))}),p.forEach(function(t){var n=t.sheet,t=t.sheetData;n&&n.nameFunctionFromSJSFormat&&n.nameFunctionFromSJSFormat(t,e,i)}),p.forEach(function(t){var n=t.sheet,t=t.sheetData;n&&n.formulaFromSJSFormat&&n.formulaFromSJSFormat(t,e,i)})),i.incrementLoadTask.addTask(function(t,n,e){var i;a&&(u?a.resumeWithoutCalc():(a.resume(!1,!1,!a.calcOnDemand),delete a.tMt,(i=o.getActiveSheet())&&i.zw()),delete a.lb),E(s)},[a,r,i])},preFromJson:function(t,n,e){this._p=new U.ExternalReferenceManager(t.externalReference)},fromJson:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,y,M,C,S,i=this,r=i.Lp,o=t.noRecalc||e&&e.doNotRecalculateAfterLoad;if(r&&(r.suspend(),r.lb=o),i.clearCustomNames(),c=[],s=t.sheets)for(l in s)"string"==typeof l&&(h=s[l],u=i.getSheetFromName(h.name||l))&&(u.Uw().G3=!0);if(d=t.names)for(v=0;v<d.length;v++)m=d[v],i.zwt(this.hyt,(0,T.convertBuiltInNameToDisplayName)(m.name),m.formula,m.row,m.col,!0,m.comment,m.isReadOnly);if(i.Kwt(),g=t.formatStringNames)for(v=0;v<g.length;v++)m=g[v],x(m.sheetTabName)&&i.pp(this.bp,m.name,m.formula,m.row,m.col,!0,m.comment);if(i.clearCustomFunctions(),p=t.customFunctions)for(b in p)p.hasOwnProperty(b)&&(w=p[b],y=(0,G.getTypeFromString)(w.typeName))&&((y=new y).fromJSON(w,n),i.Uwt(y));if(s){for(l in a=0,s)"string"==typeof l&&(h=s[l],u=i.getSheetFromName(h.name||l))&&(c.push(u),u.nameFunctionsFromJSON(h,n,e),a++);for(f=c.length,a=0;a<f;a++)(u=c[a]).formulaFromJSON(s[u.name()],n,e)}for(r&&(o?r.resumeWithoutCalc():(r.resume(!1,!1,!r.calcOnDemand),delete r.tMt),delete r.lb),M=0,C=c;M<C.length;M++)delete(S=(u=C[M]).Uw()).G3},Yp:function(t,n,e){var u,s,c,i,f,r,l,o,a,h,d,v,m,g,p,b,w,y,y,u=this,s=u.Lp,c=t.noRecalc||e&&e.doNotRecalculateAfterLoad;if(s&&(s.suspend(),s.lb=c),u.clearCustomNames(),r=t.sheets,l=[],r)for(a in r)"string"==typeof a&&(h=r[a],f=u.getSheetFromName(h.name||a))&&(f.Uw().G3=!0);if(d=t.names)for(v=0;v<d.length;v++)m=d[v],u.zwt(this.hyt,(0,T.convertBuiltInNameToDisplayName)(m.name),m.formula,m.row,m.col,!0,m.comment,m.isReadOnly);if(u.Kwt(),g=t.formatStringNames)for(v=0;v<g.length;v++)m=g[v],x(m.sheetTabName)&&u.pp(this.bp,m.name,m.formula,m.row,m.col,!0,m.comment);if(u.clearCustomFunctions(),p=t.customFunctions)for(b in p)p.hasOwnProperty(b)&&(w=p[b],y=(0,G.getTypeFromString)(w.typeName))&&((y=new y).fromJSON(w,n),u.Uwt(y));if(r){for(a in i=0,r)"string"==typeof a&&(h=r[a],f=u.getSheetFromName(h.name||a))&&(l.push(f),f.nameFunctionsFromJSON(h,n,e),i++);for(o=l.length,i=0;i<o;i++)(f=l[i]).formulaFromJSON(r[f.name()],n,e)}e.incrementLoadTask.addTask(function(t,n,e){var i,r,o,a;for(s&&(c?s.resumeWithoutCalc():(s.resume(!1,!1,!s.calcOnDemand),delete s.tMt,(i=u.getActiveSheet())&&i.zw()),delete s.lb),r=0,o=l;r<o.length;r++)delete(a=(f=o[r]).Uw()).G3},[s,t,e])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(r,t,n){"use strict";var e,y,i,k,l,w,m,_,M,p,h,C,n,S,T,o,G,a,U,H,g,b,A,I,n,s;function u(t){return"="===t.charAt(0)}function V(t){var n,e;return{left:t.indexOf("["),right:t.indexOf("]")}}function z(t){var t=V(t),n=t.left,t=t.right;return 0<=n&&n<t}function Y(t){var n=V(t),e=n.left,n=n.right,t=t.indexOf("@");return e<t&&t<n}function Z(t){return u(t)&&Y(t)}function W(t){return u(t)&&z(t)}function Q(t,n){var e,i;if(t.NMi){if(W(n=n.trim()))return 1;if(0<=n.indexOf("{{")&&0<=n.indexOf("}}"))for(e=n.split(/{{|}}/),i=0;i<e.length;i++)if(W(e[i].trim()))return 1}}function J(t,n,e,i){return e===M&&(e=t.getActiveRowIndex()),t.NMi.nMt(n,e,i)}function K(t){return t.columnRelative}function X(t){return t.endColumnRelative}function q(t){return t.rowRelative}function $(t){return t.endRowRelative}function x(t){return t.op()}function tt(t){t.column}function d(t){return t.toUpperCase()===o?a:t}function nt(){var t=this;t.eMt?t.eMt=!1:(t.Amt={},t.hyt={},t.iMt?t.iMt.clearAll():t.T3=new l.SheetSource(t,y.SheetArea.colHeader),t.rMt?t.rMt.clearAll():t.A3=new l.SheetSource(t,y.SheetArea.rowHeader),t.oMt?t.oMt.clearAll():t.qgt=new l.SheetSource(t,y.SheetArea.viewport))}function et(t,n){var t,e,t=t.Uw(),e;(t&&t.t8.jme(-1,-1,-1,-1)).forEach(function(t){t.isValid||(n.spillCells=n.spillCells||{},n.spillCells[t.minX+","+t.minY]=1)})}function c(t,n,e,i,r,o){var t=t.iT(n,e,i,r,o),n=t&&t.formulas;return n&&0<n.length}function it(t,n,e,i,r,o,a){var u=c(t,n,e,i,r,3);return!u&&o&&(r=t.getColumnCount(2),u=c(t,n,0,i,r,2)),!u&&a&&(i=t.getRowCount(1),u=c(t,0,e,i,r,1)),u}function rt(t){for(var n,e,i,r,o,n=[],e=[],i=0;i<t.length;i++)o=""+(r=t[i]).row+r.col+r.rowCount+r.colCount+r.sheetName,n.indexOf(o)<0&&(n.push(o),e.push(r));return e}function ot(t,n){var t=t.formulaLoad/t.total;return n?.4*t+.5:.3*t+.4}function at(t,n,e,i,r,o){var a,u,s,c,f,c,f,a=i.Uw(),u=t&&t.formula;u&&(s=void 0,"object"==typeof u&&(c=i.b3(o),(f=i.Xbt[u.si]).baseRow===n&&f.baseColumn===e?(u=f.formula,f.$fe=!0):f.$fe?(s=c.pB(f.baseRow,f.baseColumn))?(s.aMt=u.si,i.Lp.tMt&&i.Lp.tMt[a.id+","+f.baseRow+","+f.baseColumn]&&(i.Lp.tMt[a.id+","+n+","+e]={id:a.id,row:n,col:e})):(u=f.formula,f.baseRow=n,f.baseColumn=e):(u=f.formula,f.$fe=!0,f.baseRow=n,f.baseColumn=e)),(c=t.arrayInfo)&&!c.isDynamicArray?i.uMt(n,e,A(c.rowCount,10),A(c.colCount,10),u,!0,o):(f=a.getCalcSourceModel(),c&&a.t8.Zme(c.row,c.col,c.rowCount,c.colCount,!c.isInvalid),i.zI(n,e,u,s,!0,o,!0,!c,M,!0),c&&f.Uyt(n,e,c)))}function N(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,u,o,u=r&&r.incrementLoadTask;if(u&&!u.isTerminated){for(s=u.isBusyFunc,c=o=o||0,t.suspendPaint(),f=30,l=new Date;c<e;){if(h=n[c])for(d=0;d<i;d++)at(h[d],c,d,t,!0,a);if(c++,s&&s())break;if(30<(v=new Date)-l)break}t.resumePaint(),(u=(r=r||{})&&r.incrementalLoading)&&(u.loadStatus.formulaLoad+=c-o,o=ot(u.loadStatus,r.doNotRecalculateAfterLoad),t.parent&&t.parent.ki(y.Events.ProgressChanged,{loadStatus:u.loadStatus,progress:o,sheet:t}),u.loading)&&u.loading(o,{sheet:t}),c<e&&r.incrementLoadTask.pushTask(N,[t,n,e,i,r,c])}}function f(t,n,e,i,r){for(var o,a,u,o=0;o<e;o++)if(a=n[o])for(u=0;u<i;u++)at(a[u],o,u,t,!0,r)}function ut(t,n){var e,i,r,o,a,u;if(n)for(e in n)if(n.hasOwnProperty(e))for(r in i=n[e])i.hasOwnProperty(r)&&(a=+e,u=+r,(o=i[r]).f)&&T(t.getValueIgnoreDefault(a,u))&&!t.getFormula(a,u)&&!t.getBindingPath(a,u)&&t.Ut.setDefaultValue(a,u,g(o.f),M,y.DefaultChangeValueType.Expression)}function st(t,n,e,i,r,o,a){var u,s,c,s,f,l,h,d,v,h,h,u=t.Uw(),s=t.Ut,c=s.ap||0,s=s.fp||0;n===M||(f=g(n.f),l=n.g,(h=n.r)!==M&&(d=H(h).toJSON()),0<=l&&(f=(f&&(h={formula:f},d&&(h.lastRow=d.rowCount+d.row-1,h.lastColumn=d.colCount+d.col-1,h.baseRow=d.row,h.baseColumn=d.col,d=_),o[l]||(o[l]=h,o.nextIndex=Math.max(o.nextIndex,l+1))),{si:l}),(h=t.Xbt[f.si]).baseRow===e&&h.baseColumn===i?(f=h.formula,h.$fe=!0):h.$fe?(v=r.pB(h.baseRow,h.baseColumn))?(v.aMt=f.si,t.Lp.tMt&&t.Lp.tMt[u.id+","+h.baseRow+","+h.baseColumn]&&(t.Lp.tMt[u.id+","+e+","+i]={id:u.id,row:e,col:i})):(f=h.formula,h.baseRow=e,h.baseColumn=i):(f=h.formula,h.$fe=!0,h.baseRow=e,h.baseColumn=i)),T(f))||(1==+n.a&&d&&(d.isDynamicArray=!0,a)&&a.spillCells&&a.spillCells[e+","+i]&&(d.isInvalid=!0),f=b(f),d&&!d.isDynamicArray?c<=e&&i<s?t.uMt(e,i,A(d.rowCount,10),A(d.colCount,10),f,!0,2):e<c&&s<=i?t.uMt(e,i,A(d.rowCount,10),A(d.colCount,10),f,!0,1):c<=e&&s<=i&&t.uMt(e,i,A(d.rowCount,10),A(d.colCount,10),f,!0,3):(d&&u.t8.Zme(d.row,d.col,d.rowCount,d.colCount,!d.isInvalid),!v&&a&&a.exprs&&a.exprs[n.x]&&(v=(0,m.exprFromJSON)(a.exprs[n.x],u.getParserContext(!1)),a.exprs[n.x].nw)&&(v.sMt=!0),c<=e&&i<s?t.zI(e,i,f,v,!0,2,!0,!d):e<c&&s<=i?t.zI(e,i,f,v,!0,1,!0,!d):c<=e&&s<=i&&t.zI(e,i,f,v,!0,3,!0,!d,M,!0),d&&r.Uyt(e,i,d)))}function D(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,a,a,s,c=(o&&o.incrementLoadTask).isBusyFunc,f=a=a||0;for(t.suspendPaint(),t.suspendCalcService(),h=30,(l=o.openMode===y.OpenMode.incremental)&&(d=new Date),v=t.Xbt=t.Xbt||{nextIndex:0},m=t.b3(3);f<e;){if(g=n[f])for(p=0;p<i;p++)st(t,g[p],f,p,m,v,r);if(f++,!u&&c&&c())break;if(l&&(b=new Date,!u)&&30<b-d)break}t.resumeCalcService(),t.resumePaint(),o.loadStatus.formulaLoad+=f-a,l&&(a=o.loadStatus.formulaLoad/o.loadStatus.total,a=+(o.fullRecalc?.3*a+.5:.4*a+.6).toFixed(5),o.incrementLoadTask.progress)&&o.incrementLoadTask.progress({progress:a,sheetName:t.name(),step:C.I5(S().STEP.loadSheetFormula,[t.name()])}),f<e&&o.incrementLoadTask.pushTask(D,[t,n,e,i,r,o,f])}function ct(e,i,r,o){var t=y.Worksheet.fh;t&&p(t,function(t,n){var n=n.fromJsonAfterFormula;n&&n.call(e,i,r,o)})}function ft(e,i,r,o){var t=y.Worksheet.fh;t&&p(t,function(t,n){var n=n.fromJsonAfterSJSFormula;n&&n.call(e,i,r,o)})}function lt(n,e,i,t,r,o){var a,u,s,c,f,l,h,d,a=y.Worksheet.fh,u=!1,s=[],c=t.getReferenceSheetNames(),f=n&&n.v2,l=function(t,n){return t[n]===M||0===t[n]},h=function(t){var i;c.hasOwnProperty(t)&&(u=!0,i=(0,y._f)(n,t),l(f.sheetsState,t))&&l(f.refSheetsState,t)&&i&&(f.refSheetsState[t]=1,f.getSheet(t,function(e){var t,t,t=i.NMi;t?(t.yh(e,r,o),T(e.order)||(t.E0i=e.order),(t=(0,y.Ip)(t,e.lossless.addition,n.dataManager()))&&s.push(t)):(i.yh(e,r,o,!0),T(e.order)||(i.E0i=e.order)),a&&p(a,function(t,n){n.refSheetLazyLoaded&&n.refSheetLazyLoaded.call(i,e,r,o)})}))};for(d in c)h(d);u&&a&&p(a,function(t,n){n.afterRefSheetLazyLoaded&&n.afterRefSheetLazyLoaded.call(e,i,r,o)}),0<s.length&&o&&o.fullRecalc&&Promise.all(s).then(function(){n.suspendPaint(),n.mp[0].Mf.recalcAll(!0),n.resumePaint()})}function v(t,n,e){var i,r,o,o;if(t)for(i in t)(o=(r=t[i]).WK)!==M&&(o=e.unparse(n,o,0,0),r.WK=e.parse(n,o,0,0))}function ht(i,r){return function(t){var n,e,n,n=t.w3.rT;n&&n.Mf.xT||(e=(n?n.Mf:r).name(),n=(n?n.Mf:r)._id,i[n+" "+t.row+" "+t.column]={row:t.row,col:t.column,rowCount:1,colCount:1,sheetName:e})}}function dt(t){var n,e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}function j(t,r,n,e,o,i,a,u){var i,n;i&&t.lossless&&([t.lossless.colHeaderData,t.lossless.rowHeaderData].forEach(function(t,n){var n,t,e,i;t&&t.dataTable&&(t=t.dataTable,e=r.getRowCount(n=n+1),i=r.getColumnCount(n),a&&!u?N(r,t,e,i,o,0,n):f(r,t,e,i,n))}),t.lossless.defaultData)&&ut(r,t.lossless.defaultData),i&&n.cMt&&t.lossless.tree&&0<t.lossless.tree.length&&(delete n.cMt,i=null,"rangeCalc"===(n=t.lossless.tree)[n.length-1].k&&(i=n.pop()),(0,m.pbt)(r.b3(),n,o.$wt),i)&&(0,m.gbt)(r.b3(),i,o.$wt),a&&!u?o.incrementLoadTask.pushTask(ft,[r,t,e,o]):ft(r,t,e,o),y.Util.ume(r,e)}function O(t,n,e){t&&"function"==typeof t.onCustomNameFormulaChanged&&t.onCustomNameFormulaChanged([{nameInfo:n.nameInfo,oldExpr:e,newExpr:n.expr}])}function vt(t){var n=e([],t.sheets,!0);return t.mp&&0<t.mp.length&&t.mp.forEach(function(t){t.Mf&&n.push(t.Mf)}),n}function E(t,n,e,i){var r,o,a,a,u,a=null==t?void 0:t.baseTable;t&&a&&16===t.hbt&&1===t.lbt?(r=a.range(),o=a.Mf&&a.Mf.name()):9===t.type?(E(t.value,n,e,i),E(t.value2,n,e,i)):(a=e.MX.evaluateExpression(t,n.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof k.CalcReference&&(o=a.getSource().getName(),0<a.getRangeCount())&&(r=(0,y.Ec)(a.getRow(u=0),a.getColumn(0),a.getRowCount(0),a.getColumnCount(0))),r&&i.push({sheetName:o,range:r})}function R(t,n){var e,i,r,t;return!n||(e=t.getRow(),i=t.getColumn(),(t=t.getExpression().getRange(e,i))&&!(t=t instanceof y.Range?t:new y.Range(t.row,t.col,t.rowCount,t.colCount)).containsRange(n))}function F(r,o,a,u,s,c){var t,f,l,h,d,v,n,e,i,m,g,h=!u&&r.Ut.pj(),d=!!c;if(r.parent&&r.parent.sheets)for(v=vt(r.parent),n=r.parent.getCustomNames(),e=r.parent.Qwt(),i=!T(r.parent.fMt)&&r.parent.wJt(),n&&p(n,function(t,n){R(n,c)&&(f=n.getExpression(),(l=L(null,r,o,a,u,s,f,d))!==f)&&n.SB(l,h)}),e&&p(e,function(t,n){R(n,c)&&(f=n.getExpression(),(l=L(null,r,o,a,u,s,f,d))!==f)&&n.SB(l,h)}),i&&p(i,function(t,n){R(n,c)&&(f=n.getExpression(),(l=L(null,r,o,a,u,s,f,d))!==f)&&n.SB(l,h)}),m=function(e){var i;(t=v[e].getCustomNames())&&(i=[],p(t,function(t,n){R(n,c)&&(f=n.getExpression(),(l=L(v[e],r,o,a,u,s,f,d))!==f)&&(n.SB(l,h),i.push({nameInfo:n,oldExpr:f,newExpr:l}))}),0<i.length)&&"function"==typeof v[e].onCustomNameFormulaChanged&&v[e].onCustomNameFormulaChanged(i)},g=0;g<v.length;g++)m(g);else(t=r.getCustomNames())&&p(t,function(t,n){R(n,c)&&(f=n.getExpression(),(l=L(r,r,o,a,u,s,f,d))!==f)&&n.SB(l,h)})}function L(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,l,d,h,v,h,v,l,d,y,M,C,S,T,A,I,x,c,A,N;if(a){if(s=n.Uw(),c=(0,k.Syt)(k.Errors.Reference,s),9===a.type){if(l=a.value,h=a.value2,d=L(t,n,e,i,r,o,l,u),v=h&&L(t,n,e,i,r,o,h,u),l!==d||h!==v)return(0,k.rbt)(a.operatorType,d,v)}else if(7===a.type){for(m=!1,g=[],p=void 0,b=0;b<a.arguments.length;b++)w=L(t,n,e,i,r,o,p=a.arguments[b],u),m=m||p!==w,g.push(w);if(m)return(0,k.YJ)(a,g)}else if(1===a.type&&a.hmt()){if(f=a.source||t&&t.Uw(),h=l=a.row,v=d=a.column,f&&f===s&&(o&&!a.rowRelative||!o&&!a.columnRelative)){if(o&&r)l+=e<=l?i:0;else if(!o&&r)d+=e<=d?i:0;else if(o){if(e+i<=l)l-=i;else if(e<=l)return c}else if(e+i<=d)d-=i;else if(e<=d)return c;if(l!==h||d!==v)return(0,k.knt)(s,_,l,d,a.rowRelative,a.columnRelative)}}else if(1===a.type){if(f=a.source||t&&t.Uw(),h=a.row,v=a.column,l=a.endRow,d=a.endColumn,y=a.rowRelative,M=a.columnRelative,C=a.endRowRelative,S=a.endColumnRelative,T=h,A=v,I=l,x=d,f&&f===s){if(o&&r)h+=!y&&e<=h?i:0,l+=!C&&e<=l?i:0;else if(!o&&r)v+=!M&&e<=v?i:0,d+=!S&&e<=d?i:0;else if(o&&!r){if(!y&&e<=h&&!C&&l<e+i)return c;if(y&&C||l<e)return a;if(!y)if(e+i<=h)h-=i;else if(!(h<e)){if(C)return c;e<h&&(h=e)}if(!C)if(e+i<=l)l-=i;else{if(y)return c;l<e+i&&(l=e-1)}}else{if(!M&&e<=v&&!S&&d<e+i)return c;if(M&&S||d<e)return a;if(!M)if(e+i<=v)v-=i;else if(!(v<e)){if(S)return c;e<v&&(v=e)}if(!S)if(e+i<=d)d-=i;else{if(M)return c;d<e+i&&(d=e-1)}}if(v!==A||d!==x||h!==T||l!==I)return(0,k.lJ)(s,_,h,v,l,d,y,M,C,S)}}else if(10===a.type){if((c=a.value)!==(A=L(t,n,e,i,r,o,c,u)))return(0,k.Ayt)(A)}else 13===a.type&&(f=a.source||t&&t.Uw())&&f===s&&!o&&(a=a.offsetWhenInsertRemoveColumn(e,i,r,u));return a}}function B(t,n){var e,i,r,o,a,u,s,c,n,f,i,e=n.w3,i=e.getSource(),a=-1,u=-1;n.name?(o=n.name,c=n.id,T(c)?r=e.getNodeByName(o):(r={WK:n.expression},s=!0)):(a=n.row,u=n.column,r=e.getNode(a=void 0===a?-1:a,u=void 0===u?-1:u)),n=r.WK,f=r.$bt,i=t.unparse(i,n,a<0?0:a,u<0?0:u),f&&(!0!==t.allowDynamicArray||!0===t.allowDynamicArray&&!f.isDynamicArray)?a===f.row&&u===f.col&&e.setArrayFormula(f.row,f.col,f.rowCount,f.colCount,i):o?s?e.setFormula(c,o,i):e.setFormulaByName(o,i):e.setFormula(a,u,i,null,!0,!0),r.WK.lMt=n.lMt}function mt(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=x(t),e,i,r,o=[t.b3(y.SheetArea.colHeader),t.b3(y.SheetArea.rowHeader),t.b3(y.SheetArea.viewport)],a=0;a<o.length;a++){if(!(u=o[a]))return;for(s=u.getAllNodes(),c=0;c<s.length;c++)if(l=(f=s[c]).calc)for(h=l.aT,d=void 0,v=0;v<h.length;v++)(m=l[h[v]])&&m.forEach(function(t){t&&t instanceof k.PathCalc&&B(n,t)})}}function gt(t,n,e,i,r,o,a,u,s,c,f,l){w.CalcOperatorAdjustor.copyFormula(t,n,e,i,r,o,a,u,s,c,f,l)}function pt(t,n){var t=t.offset(0,0,!1,0,0);return t.rowRelative=t.endRowRelative=t.columnRelative=t.endColumnRelative=n,t}function P(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,b,f,l,h,d,f,l,d,h,f;if(c){if(9===c.type){if(f=c.value,l=c.value2,h=P(t,n,e,i,r,o,a,u,s,f),d=l&&P(t,n,e,i,r,o,a,u,s,l),f!==h||l!==d)return(0,k.rbt)(c.operatorType,h,d)}else if(7===c.type){for(v=!1,m=[],g=void 0,p=0;p<c.arguments.length;p++)b=P(t,n,e,i,r,o,a,u,s,g=c.arguments[p]),v=v||g!==b,m.push(b);if(v)return(0,k.YJ)(c,m)}else if(1===c.type){if(f=!q(c)&&!K(c),l=!$(c)&&!X(c),h=n.Uw(),(!c.source||c.source===h)&&f&&l)return d=r.Uw(),f=new w.MoveSwapInfo(h,e,i,d,o,a,u,s),l=pt(c,!0),f.R0i=!0,(d=(0,w.adjustFormulaOnMoveSwap)(h,0,0,l,f,!0))===l?c:1===d.type&&pt(d,!1)||d}else if(10===c.type&&(h=c.value)!==(f=P(t,n,e,i,r,o,a,u,s,h)))return(0,k.Ayt)(f);return c}}function bt(t,n){var e,i,r,o,a,u,s,c,e=t.printInfo&&t.printInfo();if(e)for(i=n.split(","),r=0;r<i.length;r++)for(o=(0,l.formulaToRanges)(t,i[r],0,0),a=0;a<o.length;a++)for(u=o[a].ranges,s=0;s<u.length;s++)-1===(c=u[s]).col||-1===c.colCount?(e.repeatRowStart(c.row),e.repeatRowEnd(c.row+c.rowCount-1)):-1!==c.row&&-1!==c.rowCount||(e.repeatColumnStart(c.col),e.repeatColumnEnd(c.col+c.colCount-1))}function wt(t,n,e,i,r){var t=t[n];t&&(i=t.rT,T(r)||(i.Wbt=r),t.toJSON({data:e}),delete i.Wbt)}function yt(t,n,e,i,r,o){t&&(n&&!n.fullRecalc?t.resumeWithoutCalc():t.resume(!1,!1,!t.calcOnDemand),delete t.lb),delete e.G3,o.resumePaint()}e=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.QB=t.XB=t.adjustOneFormula=t.hMt=t.resetCustomName=t.dMt=t.convertBuiltInNameToDisplayName=void 0,y=n("Core"),i=n("Common"),k=n("CalcEngine"),l=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),w=n("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),m=n("./dist/plugins/sheetsCalc/calc-extra-save.js"),_=null,M=void 0,p=y.GC$.each,h=i.Common.zf.Gmt,C=i.Common.zf,n=new i.Common.ResourceManager(y.SR),S=n.getResource.bind(n),T=i.Common.lt.ht,o="_XLNM.PRINT_AREA",G="PRINT_AREA",a="Print_Area",U=y.mt.xr,H=y.range_parser._c,g=y.mt.n1,b=y.Util.mr,A=parseInt,I=y.UsedRangeUtil.updateUsedRangeByData,t.convertBuiltInNameToDisplayName=d,t.dMt=f,(n=y.Worksheet.prototype).resetCalc=function(){nt.call(this),this.eMt=!0},n.c3n=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=this,r=x(i);if(r){if(this.suspendPaint(),r.suspend(!0),o=this.Uw().getCalcSourceModel(),T(e)){if(t)for(v(i.hyt,i.Uw(),r),a=o.getAllNodes(),u=0;u<a.length;u++)(c=(s=a[u]).calc)&&s.WK&&B(r,c);i.oMt.Bde(t,!n),i.iMt.Bde(t,!n),i.rMt.Bde(t,!n)}else if(!1!==t||n)for(-1===e.row&&(e.row=0,e.rowCount=i.getRowCount()),-1===e.col&&(e.col=0,e.colCount=i.getColumnCount()),f=0;f<e.rowCount;f++)for(l=0;l<e.colCount;l++)(c=(s=o.getNode(f+e.row,l+e.col))&&s.calc)&&s.WK&&(t&&B(r,c),!1!==t||n&&c.isVolatile)&&c.vyt();h=!1,1===r.calculationMode&&(h=e?function(t){return t.w3===i.oMt&&e.contains(t.row,t.column)}:function(t){return t.w3===i.oMt||t.w3===i.iMt||t.w3===i.rMt}),r.resume(!1,!0,h),this.resumePaint()}},n.recalcAll=function(t){var n,e,i,r,o,a,u,s,c,f,l,n=x(this);if(n){if(this.suspendPaint(),n.suspend(!0),t)for(i=void 0,i=(e=this.parent)&&e.sheets||[this],v(e&&e.hyt,this.Uw(),n),r=0;r<i.length;r++)for(a=(o=i[r]).Uw(),v(o.hyt,a,n),s=(u=a.getCalcSourceModel()).getAllNodes(),c=0;c<s.length;c++)(l=(f=s[c]).calc)&&f.WK&&B(n,l);n.resume(t),this.resumePaint()}},t.resetCustomName=v,n.recalcRange=function(t,n,e,i){var r=x(this);r&&r.recalcRange(this.Uw(),t,n,e,i)},n.recalcRows=function(t){var n,e,n=x(this);if(n&&!n.ignoreDirty()){for(n.suspend(),e=0;e<t.length;e++)n.recalculate(this.qgt,t[e],-1);n.resume(!1)}},n.recalcCols=function(t){var n,e,n=x(this);if(n&&!n.ignoreDirty()){for(n.suspend(),e=0;e<t.length;e++)n.recalculate(this.qgt,-1,t[e]);n.resume(!1)}},n.gL=function(t,n,e){var i,r,i=x(this);i&&!i.ignoreDirty()&&(r=this.qgt,1===e?r=this.T3:2===e&&(r=this.A3),i.recalculate(r,t,n))},n.getCalcService=function(){return this.Lp||(this.Lp=new k.CalcService,this.Uw(y.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(y.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},n.op=function(){return this.getCalcService()},n.suspendCalcService=function(t){var n=x(this);n&&n.suspend(t)},n.resumeCalcService=function(t){var n=x(this);n&&n.resume(t)},n.Uw=function(t){return T(t)||3===t?this.qgt:1===t?this.T3:2===t?this.A3:_},n.b3=function(t){var n=this;return 1===t?(!n.iMt&&n.T3&&(n.iMt=n.op().getSourceModel(n.T3)),n.iMt):2===t?(!n.rMt&&n.A3&&(n.rMt=n.op().getSourceModel(n.A3)),n.rMt):(!n.oMt&&n.qgt&&(n.oMt=n.op().getSourceModel(n.qgt)),n.oMt)},n.vMt=function(t,n,e,i,r){var r=this.b3(r);return r&&r.mMt(t,n,e,i,!0,!0)},n.KT=function(t,n,e,i,r,o){var a=this.vMt(t,n,e,i,3);return!a&&r&&(i=this.getColumnCount(2),a=this.vMt(t,0,e,i,2)),!a&&o&&(e=this.getRowCount(1),a=this.vMt(0,n,e,i,1)),a},n.iT=function(t,n,e,i,r){var r=this.b3(r);return r&&r.mMt(t,n,e,i,!1,!0)},n.mT=function(t,n,e,i,r,o,a){var u,r,u=(r=void 0===r?!0:r)&&this.KT(t,n,e,i,o,a),r=!r&&it(this,t,n,e,i,o,a);return!u&&!r||(this.jT(4,S().Exp_ChangePartOfArray),!1)},n.addCustomFunction=function(t){this.Uwt(t),this.recalcAll()},n.Uwt=function(t){if(!(t&&t instanceof k.Functions.Function))throw new Error(S().Exp_InvalidCustomFunction);t.name=h(t.name),this.Amt[t.name]=t},n.getCustomFunction=function(t){return t?this.Amt[h(t)]:_},n.removeCustomFunction=function(t){t&&(delete this.Amt[h(t)],this.recalcAll())},n.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},n.Jbt=function(t){var n,e,n;return t?(e=(n=this).parent,!(n=n.getCustomFunction(t))&&e&&e.getCustomFunction?e.getCustomFunction(t):n):_},n.addCustomName=function(t,n,e,i,r,o){this.zwt(t,n,e,i,!1,r,o)},n.getCustomName=function(t){return t?this.hyt[h(t)]:M},n.getCustomNames=function(){var e=[];return p(this.hyt,function(t,n){e.push(n)}),e},n.removeCustomName=function(t){var t,n;t&&(t=h(t),delete this.hyt[t],(n={})[t]=t,this.Zwt(n,!1))},n.clearCustomNames=function(){var t,n,t=this,n=t.hyt;t.hyt={},this.Zwt(n,!1)},n.createNameInfo=function(t,n,e,i,r){var o,a,o,a,o=this,a=x(o),o=o.Uw();return a&&o?(a=a.parse(o,n,i,r),new l.NameInfo(t,a,i,r,e)):_},n.getNameInfos=function(){return this.hyt},n.setNameInfos=function(t){T(t)||(this.hyt=t)},n.Vwt=function(t){var n,e,n,n=this,e=!n.hyt[h(t)];return e=e&&(n=n.tables)?!n.findByName(t):e},n.isValidCustomName=function(t){return t&&y.mt.P0(t)&&this.Vwt(t)},n.zwt=function(t,n,e,i,r,o,a){var u,s,c,f,s,u=this;if(!t||!n||!r&&!u.isValidCustomName(t))throw new Error(S().Exp_InvalidCustomName);if(s=x(u),c=u.Uw(),s&&c){if(f=void 0,r)try{f=s.parse(c,n,e,i,!1,!0,!0)}catch(t){}else f=s.parse(c,n,e,i);u.hyt[h(t)]=new l.NameInfo(t,f,e,i,o,a),r||((s={})[t]=t,this.Zwt(s,!0))}},n.Wwt=function(t,n,e,i,r,o,a,u){var s,n,c,n,s=this;if(!t||!n||!o&&!s.isValidCustomName(t))throw new Error(S().Exp_InvalidCustomName);n=x(s),c=s.Uw(),n&&c&&(s.hyt[h(t)]=new l.NameInfo(t,e,i,r,a),o||((n={})[t]=t,this.Zwt(n,!0)))},n.Zwt=function(t,n){var e,i,e=this.b3();if(e){for(i in t)e.updateNameCalc(i,n);this.recalcAll(!1)}this.ki(y.Events.CustomNameChangedInternal,{})},n.gMt=function(t){var n,e,n;return t?(e=(n=this).parent,!(n=n.getCustomName(t))&&e&&e.getCustomName?e.getCustomName(t):n):_},n.setFormula=function(t,n,e,i){this.zI(t,n,e,_,!1,i)},n.zI=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,g,p,m,l,h,u,g,c,d,i,f=this;T(o)&&(o=3),t<0||t>=f.getRowCount(o)||n<0||n>=f.getColumnCount(o)?f.jT(0,S().Exp_IndexOutOfRange):(l=0<=t?t:0,h=0<=n?n:0,d=f.Uw(o),v=f.options.keepUnknownFormulas,(m=f.Lp).forceR1C1Formula?(g=m.useR1C1,m.useR1C1=!0,i=i||(e&&m?m.parse(d,e,l,h,!1,r,!1,v):_),m.useR1C1=g):i=i||(e&&m?m.parse(d,e,l,h,!!f.OTe,r,r,v):_),i&&u&&(i.ensureSingle=!0),g=f.tables,3===o&&0<=t&&0<=n&&g&&!(p=g.pMt(t,n,1,1,e,i))||(m=v&&e&&!i,l=f.b3(o),h=f.conditionalFormats,l&&(u=l.getFormula(t,n,M,!0),g=f.Ut,c||d.t8.Fgt(t,n),(c=T(f.vle)&&!e)&&(f.vle=!(e||f.Sge&&f.Sge(t,n))),l.FE=!0,d=f.vle&&e===_,l.setFormula(t,n,e,i,r,d,g.pj(),s,v),c&&delete l.FE,delete f.vle,l.usedRange&&I(l.usedRange,t,n,u,e),m&&(i=l.getNode(t,n,!0))&&(i.qbt=e),h&&h.dl(),f.hasFormula(t,n,o)&&g.JE(t,n,o),a?f.Lj(f,[{row:t,col:n}],0):f.Rj("formula",t,n,o,u,e)),f.Q1i&&f.Q1i(t,n,1,1,o),f.zw()))},n.eL=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,s=this,c=this.op();if(t<0||t>=s.getRowCount()||n<0||n>=s.getColumnCount())s.jT(0,S().Exp_IndexOutOfRange);else if(l=s.b3(a))for(h=t;h<e+t;h++)for(d=n;d<i+n;d++)h===t&&d===n&&(s.zI(t,n,r,_,!1,a),f=l.pB(t,n),s.Xbt=s.Xbt||{nextIndex:0},v=s.Xbt.nextIndex,s.Xbt[v]={formula:c.unparse(this.qgt,f,t,n,!1,!0),baseRow:t,baseColumn:n,lastRow:t+e-1,lastColumn:n+i-1},s.Xbt.nextIndex++,f.aMt=v),s.zI(h,d," ",f,!0,a,!0,!0)},n.setArrayFormula=function(t,n,e,i,r,o){this.uMt(t,n,e,i,r,!1,o)},n.uMt=function(t,n,e,i,r,o,a,u){var s,c,f,l,c,h,d,v,m;if(void 0===a&&(a=3),s=this,t<0||t+e>s.getRowCount()||n<0||n+i>s.getColumnCount())s.jT(0,S().Exp_IndexOutOfRange);else if(s.Ut.eE(t,n,e,i))s.jT(0,S().Exp_ArrayFormulaSpan);else if(c=s.tables,!(3===a&&0<=t&&0<=n&&c)||(f=c.pMt(t,n,e,i,r))){if(l=s.b3(a),c=s.conditionalFormats,l){for(h=[],d=t;d<t+e;d++)for(h[d]=[],v=n;v<n+i;v++)h[d][v]=l.getFormula(d,v);for(l.setArrayFormula(t,n,e,i,r,o,s.Ut.pj(),u,!1),d=t;d<t+e;d++)for(v=n;v<n+i;v++)l.usedRange&&I(l.usedRange,d,v,h[d][v],r);if(c&&c.dl(),s.vf<1){for(m=[],d=t;d<t+e;d++)for(v=n;v<n+i;v++)m.push({row:d,col:v});s.SI(t,n,e,i,m,5,a,r)}}s.zw()}},n.getFormula=function(t,n,e,i){var e,r,e=this.b3(e);return!e||(r=e.oT(t,n))&&r.isDefault()?_:e.getFormula(t,n,i)},n.bMt=function(t,n,e){var e=this.b3(e);return e?e.pB(t,n):_},n.getFormulaInformation=function(t,n,e,i){var r,e,o,a,o,u,u,s,c,r={},e=this.b3(e);if(e){if(a=(o=e.oT(t,n))&&o.isDefault())return r;(o=e.pB(t,n))?(u=e.sT(t,n),r.hasFormula=!0,u&&(r.baseRange=new y.Range(u.row,u.col,u.rowCount,u.colCount)),r.isArrayFormula=u&&!u.isDynamicArray,t=u?u.row:t,n=u?u.col:n,i||(r.formula=this.Lp.unparse(this.qgt,o,t,n),r.formulaWithCulture=this.Lp.unparse(this.qgt,o,t,n,!0)),r.hasFormula=!!r.formula):(u=this.Uw().t8.getAnchorInfo(t,n))&&u.isValid&&(s=u.row,c=u.col,r.baseRange=new y.Range(u.row,u.col,u.rowCount,u.colCount),t===s&&n===c||(o=e.pB(s,c),i||(r.formulaWithCulture=this.Lp.unparse(this.qgt,o,s,c,!0)),r.hasFormula=!0,r.isDynamicArray=!0))}return r},n.VI=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p;for(e||(e=this,i=t,r=n,o=[]),a=e.qwt(i,r),u=this.name(),s=0;s<a.length;s++){if(o[f=(c=a[s]).sheetName+"_"+c.row+"_"+c.col+"_"+c.rowCount+"_"+c.colCount])return!1;if(o[f]=!0,(c.row<=t&&t<c.row+c.rowCount||-1===c.rowCount)&&(c.col<=n&&n<c.col+c.colCount||-1===c.colCount)&&u===c.sheetName)return!0;for(l=c.sheetName===u?e:e.parent.getSheetFromName(c.sheetName),h=c.rowCount,d=c.row,v=c.colCount,m=c.col,-1===h&&(h=l.getRowCount(),d=0),-1===v&&(v=l.getColumnCount(),m=0),g=d;g<h+d;g++)for(p=m;p<v+m;p++)if(this.VI(t,n,l,d,m,o))return!0}return!1},n.getCrossSheetReferences=function(i){for(var t,r,n,e,o,a,u,s,c,f,l,h,d,v,t=this,r=(0,k.createMap)(),n=t.getRowCount(),e=t.getColumnCount(),o=t.b3(),a=o.rT.id,s=function(t,n){var e,e,e=t.w3.getSource();e&&e.id!==a&&(i?(e=e.getName())&&0<e.length&&r.set(e,!0):r.set(n,t))},c=0;c<n;c++)for(f=0;f<e;f++)if((l=o.oT(c,f))&&l.aT)for(u=l.aT,h=0;h<u.length;h++)(d=l[u[h]])&&d.forEach(s);if((v=o.uT())&&v.aT)for(u=v.aT,h=0;h<u.length;h++)(d=v[u[h]])&&d.forEach(function(t){t&&t.content.forEach(s)});return r},n.getPrecedents=function(t,n){var e,i,i,r,o,t,o,e=[],i=this.b3();return i&&(i=i.Fyt(t,n)||i.pB(t,n),t=(o=(r=this.getFormulaInformation(t,n,3,!0)).baseRange)?o.row:t,o=o?o.col:n,this.yMt(i,t,o,e),e=rt(e)),e},n.getDependents=function(c,f){var l,t,h,l=[],t=this.parent&&this.parent.sheets||[this],h=this.name();return t.forEach(function(t){for(var n,e,i,r,o,a,u,s,n=t.getRowCount(),e=t.getColumnCount(),i=t.name(),r=0;r<n;r++)for(o=0;o<e;o++)for(a=t.getPrecedents(r,o),u=0;u<a.length;u++)if((s=a[u]).sheetName===h&&(-1===s.row||s.row<=c&&c+1<=s.row+s.rowCount)&&(-1===s.col||s.col<=f&&f+1<=s.col+s.colCount)){l.push({row:r,col:o,rowCount:1,colCount:1,sheetName:i});break}}),l},s={},n.qwt=function(t,n){var e,i,r,i,i,o,a,u,e={},i=this.b3().oT(t,n),r=this.b3().uT();if(i&&(i=i[0])&&i.forEach(ht(e,this)),r&&r[0])for(i=r["0c"],s.minX=n,s.minY=t,s.maxX=n,s.maxY=t,o=i.search(s),a=0;a<o.length;a++)(u=o[a].content).forEach(ht(e,this));return dt(e)},n.yMt=function(t,n,e,i){var r,o,o,a,u,s;if(t)switch(r=t.type){case k.ExpressionType.reference:case k.ExpressionType.structReference:o=t.getRange(n,e),i.push({row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount,sheetName:(t.source&&t.source.Mf?t.source.Mf:this).name()});break;case k.ExpressionType.operator:this.yMt(t.value,n,e,i),this.yMt(t.value2,n,e,i);break;case k.ExpressionType.expand:case k.ExpressionType.parentheses:this.yMt(t.value,n,e,i);break;case k.ExpressionType.name:o=this.gMt(t.value),this.yMt(o.getExpression(),n,e,i);break;case k.ExpressionType.function:for(a=t.arguments,u=0;u<a.length;u++)s=a[u],this.yMt(s,n,e,i)}},n.hasFormula=function(t,n,e,i){var e=this.b3(e);return!!e&&e.hasFormula(t,n,i)},n.wMt=function(){var t=this.b3();t&&t.MMt(function(t){t.CMt(),t.yB()})},n.clearFormula=function(t,n,e,i,r){var o,a,u,o=this;for(t<0&&(t=0,e=o.getRowCount()),n<0&&(n=0,i=o.getColumnCount()),a=0;a<e;a++)if(r(o,a+t))for(u=0;u<i;u++)o.setFormula(a+t,u+n,_)},n.nameFunctionsFromJSON=function(t,n,e,i){var r,o,a,u,s,s,c,f,l;if(t){if(r=this,o=t.customFunctions)for(a in o)o.hasOwnProperty(a)&&(u=o[a],s=(0,y.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u,n),r.Uwt(s));if((c=t.names)&&0<c.length){for(f=0;f<c.length;f++)l=c[f],r.zwt(d(l.name),l.formula,l.row,l.col,!0,l.comment,l.isReadOnly);r.wMt()}i&&i()}},n.formulaFromJSON=function(t,n,r){var o,a,u;t&&((o=this).Xbt=t.sharedFormulas,a=r&&r.ignoreFormula,u=r&&r.incrementalLoading,[t.colHeaderData,t.rowHeaderData,t.data].forEach(function(t,n){var n,t,e,i;t&&!a&&t.dataTable&&(t=t.dataTable,e=o.getRowCount(n=n+1),i=o.getColumnCount(n),u?N(o,t,e,i,r,0,n):f(o,t,e,i,n))}),t.defaultData&&ut(o,t.defaultData),u?r.incrementLoadTask.pushTask(ct,[o,t,n,r]):ct(o,t,n,r))},n.formulaFromSJSFormat=function(t,n,e,i){var r,o,a,u,s,c,o,f,l,r=this,o=r.Uw(),a=!e||!1!==e.includeFormulas,u=y.Util.Mo(e),s=y.Util.wo(e,r.parent&&r.parent.v2),c=r.b3(3);o.G3=!0,a&&t.lossless&&t.lossless.tree&&e.$wt&&(c.cMt=!0,o.setReferenceSheetNames(t.lossless.referenceSheetNames)),(o=U(t,y.XFileConstants.bo))?(f=o.rowCount,l=o.colCount,i?(a&&D(r,o,f,l,t.lossless,e,0,i),j(t,r,c,n,e,a,u,i)):(a&&e.incrementLoadTask.addTask(D,[r,o,f,l,t.lossless,e,0],C.I5(S().STEP.loadSheetFormula,[r.name()]),function(){var t=e.loadStatus.formulaLoad/e.loadStatus.total;return e.fullRecalc?s?.5:t*y.STEP_RATE.loadSheetFormulaWithCalc+y.STEP_RATE.loadSheetDataWithCalc+y.STEP_RATE.parseFile+y.STEP_RATE.loadFileData:s?.6:t*y.STEP_RATE.loadSheetFormula+y.STEP_RATE.loadSheetData+y.STEP_RATE.parseFile+y.STEP_RATE.loadFileData},r.name()),e.incrementLoadTask.addTask(j,[t,r,c,n,e,a,u]))):i?j(t,r,c,n,e,a,u,i):e.incrementLoadTask.addTask(j,[t,r,c,n,e,a,u])},n.nameFunctionFromSJSFormat=function(t,n,e){var r,o,i,a,u,s,s,c,f,r=this,o=r?r.Uw():_,i=t.lossless&&t.lossless.customFunctions;if(i)for(a in i)i.hasOwnProperty(a)&&(u=i[a],s=(0,y.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u),r.Uwt(s));c=t.lossless&&t.lossless.definedNames,f=t.lossless&&t.lossless.nExpr,c&&0<c.length&&(c.forEach(function(t){var n=""+t.c_[0],e=g(t.name),i=g(t.comment);"_xlnm.Print_Titles"===e?bt(r,n):f&&f[t.e]?r.Wwt(d(e),b(g(n)),(0,m.exprFromJSON)(f[t.e],o.getParserContext(!1)),0,0,!0,i,"_xlnm.Print_Area"!==e):r.zwt(d(e),b(g(n)),0,0,!0,i,t.isReadOnly)}),r.wMt())},n.SMt=function(t){var n=this,e=n.Lp;e&&!t||(n.Lp=t||new k.CalcService,n.Uw(y.SheetArea.colHeader).setCalcService(n.Lp),n.Uw(y.SheetArea.rowHeader).setCalcService(n.Lp),n.Uw(y.SheetArea.viewport).setCalcService(n.Lp),n.Lp.initParserContext(n.Uw()),e?(t.setSourceModel(n.T3,e.getSourceModel(n.T3)),t.setSourceModel(n.A3,e.getSourceModel(n.A3)),t.setSourceModel(n.qgt,e.getSourceModel(n.qgt))):(n.iMt=n.Lp.getSourceModel(n.T3),n.rMt=n.Lp.getSourceModel(n.A3),n.oMt=n.Lp.getSourceModel(n.qgt)),n.oMt.usedRange=new y.BaseUsedRange)},n.setCalc=function(t,n){this.Lp=t,this.qgt=n||this.qgt,this.oMt=t.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=t)},n.YA=function(){this.ol(!1,1)},n.TMt=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,e=this,i=t.changeType,r=t.row,o=t.rowCount,a=t.col,u=t.colCount,s=t.sheetArea,c=T(s)||s===y.SheetArea.viewport,f=e.b3(s),l=f.usedRange;f&&(d=(h=e.Ut).pj(),v=x(f),m=f.rT,g=v.Hyt(),p=v.MX.asyncManager,"addingRows"===i?e.mT(r,0,0,e.getColumnCount(),void 0,!0,!1)?(b=c?e.b3(2):M,g.onBeforeAddRemoveRows(f,r,b),F(e,r,o,!0,!0),[f,b].forEach(function(t){t&&t.addRows(r,o)}),p.addRows(m,r,o)):t.canAdd=!1:"addRows"===i?(v.suspend(),b=c?e.b3(2):M,g.onAfterAddRemoveRows(f,r,o,!0,n,b),v.resume(!1),d&&d.push({type:"addRows",row:r,rowCount:o,sheetArea:s}),l&&l.addHeadInfo(r,o,!0)):"deletingRows"===i?e.mT(r,0,o,e.getColumnCount(),void 0,!0,!1)?(b=c?e.b3(2):M,g.onBeforeAddRemoveRows(f,r,b),F(e,r,o,!1,!0),[f,b].forEach(function(t){t&&t.deleteRows(r,o,n)}),p.deleteRows(m,r,o)):t.canDelete=!1:"setRowCount"===i&&o!==r?(v.suspend(),b=e.b3(2),r<o?(f.gF(r+1,0,o-r,e.getColumnCount()),b.gF(r+1,0,o-r,e.getColumnCount()),f.rT.t8.Fgt(r+1,-1,o-r,-1)):(f.gF(o+1,0,r-o,e.getColumnCount()),b.gF(o+1,0,r-o,e.getColumnCount()),f.rge(o,r),b.rge(o,r)),v.AMt(2),v.resume(!1)):"setColumnCount"===i&&u!==a?(v.suspend(),w=e.b3(1),a<u?(f.gF(0,a+1,e.getRowCount(),u-a),w.gF(0,a+1,e.getRowCount(),u-a),f.rT.t8.Fgt(-1,a+1,-1,u-a)):(f.gF(0,u+1,e.getRowCount(),a-u),w.gF(0,u+1,e.getRowCount(),a-u),f.oge(u,a),w.oge(u,a)),v.AMt(3),v.resume(!1)):"deleteRows"===i?(v.suspend(),b=c?e.b3(2):M,g.onAfterAddRemoveRows(f,r,o,!1,n,b),v.resume(!1),d&&d.push({type:"deleteRows",row:r,rowCount:o,sheetArea:s}),l&&l.removeHeadInfo(r,o,!0)):"addingColumns"===i?e.mT(0,a,e.getRowCount(),0,void 0,!1,!0)?(w=c?e.b3(1):M,g.onBeforeAddRemoveColumns(f,a,w),F(e,a,u,!0,!1),[f,w].forEach(function(t){t&&t.addColumns(a,u)}),p.addColumns(m,r,o)):t.canAdd=!1:"addColumns"===i?(v.suspend(),w=c?e.b3(1):M,g.onAfterAddRemoveColumns(f,a,u,!0,n,w),v.resume(!1),d&&d.push({type:"addColumns",col:a,colCount:u}),l&&l.addHeadInfo(a,u,!1)):"deletingColumns"===i?e.mT(0,a,e.getRowCount(),u,void 0,!1,!0)?(w=c?e.b3(1):M,g.onBeforeAddRemoveColumns(f,a,w),F(e,a,u,!1,!1),[f,w].forEach(function(t){t&&t.deleteColumns(a,u,n)}),p.deleteColumns(m,r,o)):t.canDelete=!1:"deleteColumns"===i&&(v.suspend(),w=c?e.b3(1):M,g.onAfterAddRemoveColumns(f,a,u,!1,n,w),v.resume(!1),d&&d.push({type:"deleteColumns",col:a,colCount:u,sheetArea:s}),l)&&l.removeHeadInfo(a,u,!1))},n.IMt=function(t,n,e,i){var r,o,a,u,s,c,r=e.type,o=this;if(i){if("addRows"===r)e.changeType="addingRows",o.TMt(e),e.changeType="addRows",o.TMt(e);else if("deleteRows"===r)e.changeType="deletingRows",o.TMt(e),e.changeType="deleteRows",o.TMt(e);else if("addColumns"===r)e.changeType="addingColumns",o.TMt(e),e.changeType="addColumns",o.TMt(e);else if("deleteColumns"===r)e.changeType="deletingColumns",o.TMt(e),e.changeType="deleteColumns",o.TMt(e);else if("customName"===r)a=t.parse(o,e.newFormula,0,0),u=e.nameInfo.getExpression(),e.nameInfo.SB(a),O(o,e,u);else if("condition"===r){for(s=[],c=0;c<e.newFormulas.length;c++)a=t.parse(o,e.newFormulas[c],0,0),s.push(a);e.condition.setExpressions(s)}}else if("addRows"===r)e.changeType="deletingRows",o.TMt(e,!0),e.changeType="deleteRows",o.TMt(e,!0);else if("deleteRows"===r)e.changeType="addingRows",o.TMt(e,!0),e.changeType="addRows",o.TMt(e,!0);else if("addColumns"===r)e.changeType="deletingColumns",o.TMt(e,!0),e.changeType="deleteColumns",o.TMt(e,!0);else if("deleteColumns"===r)e.changeType="addingColumns",o.TMt(e,!0),e.changeType="addColumns",o.TMt(e,!0);else if("customName"===r)a=t.parse(o,e.formula,0,0),u=e.nameInfo.getExpression(),e.nameInfo.SB(a),O(o,e,u);else if("condition"===r){for(s=[],c=0;c<e.formulas.length;c++)a=t.parse(o,e.formulas[c],0,0),s.push(a);e.condition.setExpressions(s)}},n.xMt=function(t,n,e){var i,r,o,i=e.type,r=this;"addRows"===i?(e.changeType="deletingRows",r.TMt(e,!0),e.changeType="deleteRows",r.TMt(e,!0)):"deleteRows"===i?(e.changeType="addingRows",r.TMt(e,!0),e.changeType="addRows",r.TMt(e,!0)):"addColumns"===i?(e.changeType="deletingColumns",r.TMt(e,!0),e.changeType="deleteColumns",r.TMt(e,!0)):"deleteColumns"===i?(e.changeType="addingColumns",r.TMt(e,!0),e.changeType="addColumns",r.TMt(e,!0)):"customName"===i?(o=e.nameInfo.getExpression(),e.nameInfo.SB(e.expr),O(r,e,o)):"condition"===i&&e.condition.setExpressions(e.expressions)},n.NMt=function(t,n){var e,i,r,o,a,e=this,i=x(e),r=e.b3();if(i.suspend(),n)for(o=0;o<t.length;o++)(a=t[o]).type?e.IMt(i,r,a,n):a.newValue&&e.setFormula(a[0],a[1],a.formula);else for(o=t.length-1;0<=o;o--)(a=t[o]).type?e.IMt(i,r,a,n):a.newValue||e.setFormula(a[0],a[1],a.formula);i.resume(!1)},n.xj=function(t){var n,n,e,i,r,o,a,u,s,c,f,l,h,d,v,n=t[t.length-1],n=n&&n.sheetArea,e=T(n)||n===y.SheetArea.viewport,i=x(this),r=this.b3(n),o=this.Uw(n);for(i.suspend();t.length;){if(u=(a=t.pop())[0],s=a[1],c=r.pB(u,s),l=[],f=e&&o.t8.getAnchorInfo(u,s)){for(h=f.row;h<f.row+f.rowCount;h++)for(l[h]=[],d=f.col;d<f.col+f.colCount;d++)l[h][d]=this.getValue(h,d);!f.isValid||a[2]||a[3]||o.t8.Rme(o.t8.Pme(u,s),!0,!1,!0)}if(a.type?this.xMt(i,r,a):r.kMt.apply(r,a),(v=e&&r&&r.usedRange)&&(I(v,a[0],a[1],c,a[2]),f))for(h=f.row;h<f.row+f.rowCount;h++)for(d=f.col;d<f.col+f.colCount;d++)h===a[0]&&d===a[1]||I(v,h,d,l[h][d],a[2])}t&&t.Vme&&o.t8.Wme(t.Vme),i.resume(!1)},n.getReferenceRange=function(t){var n,e,i,r,o,a,t,u,n=this.Uw(),e=this.getCalcService(),i=e.parse(n,t,0,0,void 0,!0),a=i.baseTable;return i&&a&&t===a.name()?(r=a.range(),o=a.Mf&&a.Mf.name()):(t=e.MX.evaluateExpression(i,n.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof k.CalcReference&&(o=t.getSource().getName(),0<t.getRangeCount())&&(r=(0,y.Ec)(t.getRow(u=0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))),{sheetName:o,range:r}},n.sCe=function(t){var n,e,t,i,r,o,n=this.Uw(),e=this.getCalcService(),t=e.parse(n,t,0,0,void 0,!0),i=[],r=[],o={};return E(t,n,e,i),i.forEach(function(t){var n=t.sheetName,t=t.range;o[n]||(o[n]={sheetName:n,ranges:[]},r.push(o[n])),o[n].ranges.push(t)}),r},n.dL=function(t,n,e,i){var r,o,o,r=this,o="string"==typeof i&&r.parent&&r.parent.xO(i);return o&&-1!==t&&-1!==n?(o=o.getExpression(),Q(r,i)?J(r,o,t,n):(0,l.evaluateExpression)(r,o,t,n,{sheetArea:e})):M},n.TL=function(t,n,e){var i,r,o,a,o,u,s,c,f,i=this,r=!!i.NMi,o=i.getCell(t=-1===t?0:t,n=-1===n?0:n,3),a=(0,l.rangeToFormula)(o,t,n,3);if(0<=(o="="===(o=e.trim()).charAt(0)&&0<=o.indexOf("@")&&!Z(o)?o.replace(/@/g,a):o).indexOf("{{")&&0<=o.indexOf("}}")){for(""===(u=o.split(/{{|}}/))[0]&&u.shift(),""===u[u.length-1]&&u.pop(),s=0;s<u.length;s++)-1===u[s].indexOf("=")?u[s]='"'+u[s]+'"':(!r||!Z(u[s]))&&(0<=u[s].indexOf("@")&&(u[s]=u[s].replace(/@/g,a)),(c=(0,l.evaluateFormula)(i,u[s]))instanceof k.CalcError)?u[s]='"'+c.toString()+'"':u[s]=u[s].replace(/=/g,"");o="=CONCAT("+u.join(",")+")"}(f=i.parent).xO(e)||f.pp(f.bp,e,o,t,n,!0,"",i.NMi)},n.NO=function(t,n,e,i){var r=this;return(Q(r,t)?J:(0,l.evaluateExpression))(r,n,e,i)},t.hMt=F,t.adjustOneFormula=B,t.XB=gt,t.QB=P,y.Worksheet.ch("calc",{priority:1e3,init:nt,dispose:function(t){var n,e,e,e,n=this;!1!==t.clearCache&&(n.qgt=_,n.A3=_,n.T3=_,n.Lp=_,(e=n.oMt)&&(!0===t.isSheetDestroy?e.DMt():e._Mt(),n.oMt=_),(e=n.rMt)&&(!0===t.isSheetDestroy?e.DMt():e._Mt(),n.rMt=_),e=n.iMt)&&(!0===t.isSheetDestroy?e.DMt():e._Mt(),n.iMt=_)},attach:function(t){var n=this;t instanceof y.Workbook?n.SMt(t.Lp):n.SMt()},onLayoutChanged:function(t){this.op().isAdjustSuspended()||this.TMt(t)},toJson:function(t,n){var s,e,i,c,e,f,r,o,a,u,s=this,e=s.Amt;y.GC$.isEmptyObject(e)||(t.customFunctions=e),i=n&&n.newWorkSheetName,c=[],e=s.getCustomNames(),f=x(s),r=s.b3(),o=r.rT,e&&f&&(!T(i)&&r&&o&&(o.Wbt=i),p(e,function(t,n){var e,i,r,o,a,n,u,e,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),a=n.isReadOnly(),n=n.getComment();o&&(e={name:e,formula:u=f.unparse(s.Uw(),o,i,r,!1,!0,1),row:i,col:r},n&&(e.comment=n),"boolean"==typeof a&&(e.isReadOnly=a),c.push(e))}),0<c.length&&(t.names=c),delete o.Wbt),(a=n&&n.ignoreFormula)||(u=[s.oMt,s.iMt,s.rMt],[t.data,t.colHeaderData,t.rowHeaderData].forEach(function(t,n){wt(u,n,t,o,i)}),s.Xbt&&0<s.Xbt.nextIndex&&(t.sharedFormulas=s.Xbt))},fromJson:function(t,n,e,i){var r,o,r=this,o;e&&e.incrementalLoading||(r.clearCustomFunctions(),r.clearCustomNames()),i&&(r.nameFunctionsFromJSON(t,n,e),r.formulaFromJSON(t,n,e))},wh:function(t,n,s){var c,e,i,f,l,e,h,r,o,d,a,v,a,r,u,c=this,e=c.Amt;y.GC$.isEmptyObject(e)||(t.lossless.customFunctions=e),i=s&&s.newWorkSheetName,f=[],l=[],e=c.getCustomNames(),h=x(c),r=c.b3(),o=r.rT,d={},c.parent&&(a=c.parent.yC,d=a&&a.getUsedCustomNames()||{}),e&&h&&!c.NMi&&(!T(i)&&r&&o&&(o.Wbt=i),v=!s||!1!==s.includeUnusedNames,p(e,function(t,n){var e,i,r,o,a,n,u,e,n,e=n.getName(),i=n.getRow(),r=n.getColumn(),o=n.getExpression(),a=n.isReadOnly(),n=n.getComment();e.toUpperCase()!==G&&o&&(v||d[e])&&(e={name:e,comment:n,isReadOnly:a,formula:u=h.unparse(c.Uw(),o,i,r,!1,!0,1)},s&&s.includeCalcModelCache&&!c.ctr&&(n=(0,m.exprToJSON)(o),f.push(n),e.e=f.length-1),l.push(e))}),0<l.length&&(t.lossless.definedNames=l),0<f.length&&(t.lossless.nExpr=f),delete o.Wbt),(a=s&&!1===s.includeFormulas)||((r=c.oMt)&&(o=r.rT,T(i)||(o.Wbt=i),r.wh(t,s),delete o.Wbt),u=[c.iMt,c.rMt],t.lossless&&[t.lossless.colHeaderData,t.lossless.rowHeaderData].forEach(function(t,n){wt(u,n,t,o,i)})),!a&&y.Util.ko(s)&&(s&&s.includeCalcModelCache&&!c.ctr&&(t.lossless.tree=(0,m.mbt)(c.b3())),o=c.Uw(),t.lossless.referenceSheetNames=o&&o.getReferenceSheetNames(),et(c,t.lossless))},yh:function(t,n,e,i){var r,o,a,u,s,c,f,r=this,o=r.parent,u=y.Util.wo(e,r.parent&&r.parent.v2),s=e&&!e.fullRecalc,c=r.Uw();r.suspendPaint(),o&&o.Lp&&((a=o.Lp).suspend(),a.lb=s),(f=y.Util.Mo(e))||(r.clearCustomFunctions(),r.clearCustomNames()),u&&(c.G3=!0,r.nameFunctionFromSJSFormat(t,n,e),r.formulaFromSJSFormat(t,n,e,i),i?lt(o,r,t,c,n,e):e.incrementLoadTask.addTask(lt,[o,r,t,c,n,e])),i?yt(a,e,c,u,s,r):e.incrementLoadTask.addTask(function(t,n,e,i,r,o){yt(t,n,e,i,r,o)},[a,e,c,u,s,r])},setName:function(t){var n,e,i;mt(this),(i=(e=x(n=this.b3())).MX.asyncManager).changeSourceName(t.oldName,t.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()},canAddingSpan:function(t){var n,e,i,r,o,a,n=this,e=t.sheetArea,i=t.row,r=t.col,o=t.rowCount,a=t.colCount;3!==e&&!T(e)||n.mT(i,r,o,a,!1)||(t.isAllow=!1)}}),y.Y8.ch("calc",{isInvalidFormula:function(n){var t,e,t=_,e=M;try{n.allowDynamicArray&&(T(l.SheetParserContext.wbt)&&(l.SheetParserContext.wbt=new y.Worksheet),(t=l.SheetParserContext.wbt).getCalcService())&&(e=t.getCalcService().allowDynamicArray,t.getCalcService().allowDynamicArray=!0),(0,l.formulaToExpression)(t,n.value)}catch(t){n.isInvalid=!0}finally{T(t)||T(e)||!t.getCalcService()||t.getCalcService().allowDynamicArray===e||(t.getCalcService().allowDynamicArray=e)}}})},"./dist/plugins/sparkline/functions-sparkline.js":function(F,t,h){"use strict";var n,T,y,l,b,L,d,B,w,M,r,o,A,P,e,G,e,U,g,I,H,V,s,C,a,i,z,x,S,Y,N,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,p,vt,u,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,v,kt,_t,Dt,jt,Ot,Et,n,c,Rt,u,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,rn;function f(t){return 0===t}function k(t){return 0===t||2===t}function on(t){return k(t)||8===t}function an(t){return 0===t||1===t}function un(t){return 0<=t&&t<=2}function sn(t){return 2===t||3===t}function cn(t){return 1===t||2===t}function m(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=[];if(w(t))for(i=0,r=t.getRangeCount();i<r;i++)for(o=t.getRowCount(i),a=t.getColumnCount(i),u=0;u<o;u++)for(s=0;s<a;s++)e.push(t.getValue(i,u,s));else if(n&&M(t))for(c=t.getRowCount(),f=t.getColumnCount(),l=0;l<c;l++)for(h=0;h<f;h++)e.push(t.getValue(l,h));return e=t instanceof T.TwoDimensionalCalcArray&&1===e.length&&Array.isArray(e[0])?e[0]:e}function _(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=[];if(w(t)){if(n<(r=t.getRangeCount()))for(o=t.getRowCount(n),a=t.getColumnCount(n),u=0;u<o;u++)for(i[u]=[],s=0;s<a;s++)i[u].push(t.getValue(n,u,s))}else if(e&&M(t))for(c=t.getRowCount(),f=t.getColumnCount(),l=0;l<c;l++)for(i[l]=[],h=0;h<f;h++)i[l][h]=t.getValue(l,h);return i=t instanceof T.TwoDimensionalCalcArray&&1===i.length&&Array.isArray(i[0])?i[0]:i}function D(t){var n;return w(t)?n=t.getValue(0,0,0):A(t)||(n=t),n}function fn(t,n){this.name=t,this.value=n,this.typeName="SparklineExValue"}function j(){var t,n,e,t=this.createFunction();t&&(n=t.name,e=t.evaluate,t.evaluate=function(){var t=e.call(this,arguments);return t instanceof T.CalcError?t:t?new vt(n,t):i},this.Zc=n)&&!T.Functions.findGlobalFunction(n)&&(T.Functions.Tmt[n]=t),this.typeName=""}function ln(){return Ft.call(this)||this}function hn(){return Lt.call(this)||this}function dn(){return Bt.call(this)||this}function vn(){return Pt.call(this)||this}function mn(){return Gt.call(this)||this}function gn(){return Ut.call(this)||this}function pn(){return Ht.call(this)||this}function bn(){return Vt.call(this)||this}function wn(){return zt.call(this)||this}function yn(){return Yt.call(this)||this}function Mn(t){var n=t.plannedValue,e=t.actualValue,i=t.index,r=t.reference,o=t.mini,a=t.maxi,t=t.tickUnit;return!x(i)&&!(0===n.length||0===e.length||i<0||i>=n.length||i>=e.length||a<=o||A(n)||A(e)||x(e[i])||x(n[i])||r&&x(r)||o&&x(o)||a&&x(a)||t&&x(t))}function Cn(){return Zt.call(this)||this}function Sn(){return Wt.call(this)||this}function Tn(){return Qt.call(this)||this}function An(){return Jt.call(this)||this}function O(){return Kt.call(this)||this}function In(){return Xt.call(this)||this}function xn(){return qt.call(this)||this}function Nn(t,v){function m(t){var n,e,i,r,o,a,u,s,c,f,n={},e=!1,i=!0,r="",o="";if(t){for(a=0,u=(t=t.substr(1,t.length-2)).length;a<u;a++)":"===(s=t.charAt(a))?i=!1:","!==s||e?"'"!==s&&'"'!==s&&("("===s?e=!0:")"===s&&(e=!1),i?r+=s:o+=s):(n[r]=o,i=!(o=r=""));for(c in r&&(n[r]=o),n)!n.hasOwnProperty(c)||A(f=n[c])||("TRUE"===f.toUpperCase()?n[c]=!0:"FALSE"===f.toUpperCase()?n[c]=!1:!x(f)&&isFinite(f)&&(n[c]=S(f)))}return n}function g(t){return new y.Range(t.getRow(0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))}function p(t){return new y.Range(0,0,t.getRowCount(),t.getColumnCount())}var t=new r(t,2,5);return t.evaluate=function(t){var n,e,i,r,e,o,a,u,s,c,f,l,h,d,f,t,n=t[0],e=M(n);if((w(n)||e)&&0<(i=e?1:n.getRangeCount())){for(d in r=(e?p:g)(n),e=e?"":n.getSource().getSheet().name(),o=t[1],a=t[2],c=s=u=void 0,f=M(a),(w(a)||f)&&(c=f?"":a.getSource().getSheet().name(),0<(i=f?1:a.getRangeCount()))&&(u=(f?p:g)(a),s=t[3]),l=m(t[4]||"{}"),h={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})h.hasOwnProperty(d)&&l.hasOwnProperty(d)&&(l[h[d]]=l[d]);return 1===(t=(f=new b.SparklineSetting(l)).options).maxAxisType&&(t.maxAxisType=0),1===t.minAxisType&&(t.minAxisType=0),{data:r,dataSheetName:e,dataOrientation:o,dateAxisData:u,dateAxisDataSheetName:c,dateAxisOrientation:s,sparklineType:v,displayDateAxis:u&&!A(s),setting:f,values:_(n,0,!0),dateValues:_(a,0,!0)}}},t.u9t=1,t.acceptsReference=k,t.acceptsArray=k,t}function kn(t,n,e,i,r,o,a){var u,s,c,f,l,h,a,u=b.Sparkline.EMt,s=a.sheet,c=s.parent.getSheetFromName(n.dataSheetName),f=s.parent.getSheetFromName(n.dateAxisDataSheetName),l=n.setting,h=(l=l&&l.options?l:new b.SparklineSetting(l)).options.displayHidden,a={sparklineType:n.sparklineType,displayDateAxis:n.displayDateAxis,zoomFactor:a.zoomFactor,values:u(n.values,c||s,h,n.data,n.dataOrientation),dateValues:u(n.dateValues,f||s,h,n.dateAxisData,n.dateAxisOrientation,!0),settings:l,getColor:function(t){if(s&&t){var n=y.Pf.vl(s,t);if(n)return n}return t}};(new U).paint(t,a,e,i,r,o)}function _n(){return $t.call(this)||this}function Dn(){return tn.call(this)||this}function jn(){return nn.call(this)||this}function On(){return en.call(this)||this}function En(){return rn.call(this)||this}function Rn(t,n,e,i,r,o,a,u){if(!(A(t)||A(n)||A(e)||A(i))&&!(x(t)||x(n)||x(e)||x(i))&&!(i<=e||n<e||i<n||t<e||i<t)&&(A(a)||0===a||1===a||2===a)){if(0===a||A(a)){if(!A(r)&&!A(o)&&(x(o)||x(r)||o<=r||r<-180||180<o))return;if(!A(u)&&(x(u)||1<u||u<0))return}return 1}}function E(t,n,e){return{value:t,font:n,label:e,normalFontHeight:H(n),normalFontWidth:V(e,n),fontAfterZoom:null}}function R(t){t&&(c[t.name()]=t)}n=this&&this.__extends||(Rt=function(t,n){return(Rt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Rt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.jMt=t.GaugeKPISparkline=t.RangeBlockSparkline=t.WinlossSparkline=t.ColumnSparkline=t.LineSparkline=t.ImageSparkline=t.HistogramSparkline=t.YearSparkline=t.MonthSparkline=t.ParetoSparkline=t.CascadeSparkline=t.BoxPlotSparkline=t.LollipopVariSparkline=t.VariSparkline=t.VBarSparkline=t.HBarSparkline=t.StackedSparkline=t.SpreadSparkline=t.BulletSparkline=t.ScatterSparkline=t.AreaSparkline=t.PieSparkline=t.SparklineEx=t.SparklineExValue=void 0,T=h("CalcEngine"),y=h("Core"),l=h("Common"),b=h("./dist/plugins/sparkline/sparkline-wrapper.js"),w=T.Convert.LE,M=T.Convert.Nh,r=T.Functions&&T.Functions.Function,o=T.Functions&&T.Functions.Mmt,A=l.Common.lt.ht,P=l.Common.lt.OMt,G=(e=y.GC$).inherit,e=e.extend,U=l.Sparklines.SparklineRender,g=l.Sparklines.SparklineExRenders,I=T.Errors.Value,H=y.util.vt,V=y.q.Wt,s=y.W.V,C=Math.floor,a=Math.min,i=null,z=void 0,x=isNaN,S=parseFloat,Y=NaN,N="12px Calibri",Z="PIESPARKLINE",W="AREASPARKLINE",Q="SCATTERSPARKLINE",J="BULLETSPARKLINE",K="SPREADSPARKLINE",X="STACKEDSPARKLINE",q="HBARSPARKLINE",$="VBARSPARKLINE",tt="VARISPARKLINE",nt="LOLLIPOPVARISPARKLINE",et="BOXPLOTSPARKLINE",it="CASCADESPARKLINE",rt="PARETOSPARKLINE",ot="MONTHSPARKLINE",at="YEARSPARKLINE",ut="LINESPARKLINE",st="COLUMNSPARKLINE",ct="WINLOSSSPARKLINE",ft="RANGEBLOCKSPARKLINE",lt="GAUGEKPISPARKLINE",ht="HISTOGRAMSPARKLINE",dt="IMAGE",(u=p=p||{})[u.fit=0]="fit",u[u.entireFit=1]="entireFit",u[u.originFit=2]="originFit",u[u.custom=3]="custom",fn.prototype.toString=function(){return this.name===dt?this.value.altText+"":""},vt=fn,t.SparklineExValue=vt,j.prototype.name=function(){return this.Zc},j.prototype.createFunction=function(){return i},j.prototype.paint=function(t,n,e,i,r,o,a){},j.prototype.toJSON=function(){var t,n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},j.prototype.fromJSON=function(t){if(t)for(var n in t)A(t[n])||(this[n]=t[n])},t.SparklineEx=u=j,n(ln,Ft=u),e((t.PieSparkline=mt=ln).prototype,{createFunction:function(){var t=new r(Z,1,255);return t.evaluate=function(t){var n,e,n=t[0],e=m(n,!0);return e.length<=0&&!A(n)&&e.push(n),{values:e,colors:Array.prototype.slice.call(t,1)}},t.acceptsReference=f,t.acceptsArray=f,t.u9t=1,t},paint:g[Z]}),n(hn,Lt=u),e((t.AreaSparkline=gt=hn).prototype,{createFunction:function(){var t=new r(W,1,7);return t.evaluate=function(t){return{points:m(t[0],!0),mini:t[1],maxi:t[2],line1:t[3],line2:t[4],colorPositive:t[5],colorNegative:t[6]}},t.acceptsReference=f,t.acceptsArray=f,t.u9t=1,t},paint:g[W]}),n(dn,Bt=u),e((t.ScatterSparkline=pt=dn).prototype,{createFunction:function(){var t=new r(Q,1,18);return t.evaluate=function(t){var n,e;return{points1:_(t[0],0,!0),points2:_(t[1],0,!0),minX:t[2],maxX:t[3],minY:t[4],maxY:t[5],hLine:t[6],vLine:t[7],xMinZone:t[8],xMaxZone:t[9],yMinZone:t[10],yMaxZone:t[11],tags:t[12],drawSymbol:t[13],drawLines:t[14],color1:t[15],color2:t[16],dash:t[17]}},t.acceptsReference=an,t.acceptsArray=an,t.u9t=1,t},paint:g[Q]}),n(vn,Pt=u),e((t.BulletSparkline=bt=vn).prototype,{createFunction:function(){var t=new r(J,3,17);return t.evaluate=function(t){return{measure:D(t[0]),target:D(t[1]),maxi:D(t[2]),good:D(t[3]),bad:D(t[4]),forecast:D(t[5]),tickUnit:D(t[6]),colorScheme:t[7],vertical:t[8],measureColor:t[9],targetColor:t[10],maxiColor:t[11],goodColor:t[12],badColor:t[13],forecastColor:t[14],allowMeasureOverMaxi:t[15],barSize:t[16]}},t.acceptsReference=function(t){return 0<=t&&t<=6},t.u9t=1,t},paint:g[J]}),n(mn,Gt=u),e((t.SpreadSparkline=wt=mn).prototype,{createFunction:function(){function l(t){for(var n,e,i,r,o,n=[],i=0,r=0,o=t.length;i<o;i++)e=S(t[i]),!x(e)&&isFinite(e)&&(n[r]=e,r++);return n}function h(t){for(var n,e,i,r,o,a,n={},e=0,i=void 0,r=t.length;e<r;e++)n[i=t[e]]?n[i]++:n[i]=1;for(a in o=[],n)n.hasOwnProperty(a)&&o.push({key:S(a),value:n[a]});return o.sort(function(t,n){return t.key-n.key})}var t=new r(K,1,7);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,f,n=m(t[0],!0),i=[];if(!A(n)&&(i=h(n=l(n)),3===(e=t[4])))for(r=0,o=i.length;r<o;r++){for(u=(a=i[r]).value,s=[],c=Math.max(100,10*u),f=0;f<c+u-1;f++)s.push(Math.random());a.randomNumbers=s}return{spreadData:i,showAverage:t[1],scaleStart:t[2],scaleEnd:t[3],style:e,colorScheme:t[5],vertical:t[6]}},t.acceptsReference=f,t.acceptsArray=f,t.u9t=1,t},paint:g[K]}),n(gn,Ut=u),e((t.StackedSparkline=yt=gn).prototype,{createFunction:function(){var t=new r(X,1,13);return t.evaluate=function(t){return{points:m(t[0],!0),colorRange:m(t[1],!0),labelRange:m(t[2],!0),maximum:t[3],targetRed:t[4],targetGreen:t[5],targetBlue:t[6],targetYellow:t[7],color:t[8],highlightPosition:t[9],vertical:t[10],textOrientation:t[11],textSize:t[12]}},t.acceptsReference=un,t.acceptsArray=un,t.u9t=1,t},paint:g[X]}),n(pn,Ht=u),e((t.HBarSparkline=Mt=pn).prototype,{createFunction:function(){var t=new r(q,1,4);return t.evaluate=function(t){return{value:D(t[0]),colorScheme:t[1],axisVisible:t[2],barHeight:t[3]}},t.acceptsReference=f,t.u9t=1,t},paint:g[q]}),n(bn,Vt=u),e((t.VBarSparkline=Ct=bn).prototype,{createFunction:function(){var t=new r($,1,4);return t.evaluate=function(t){return{value:D(t[0]),colorScheme:t[1],axisVisible:t[2],barWidth:t[3]}},t.acceptsReference=f,t.u9t=1,t},paint:g[$]}),n(wn,zt=u),e((t.VariSparkline=St=wn).prototype,{createFunction:function(){var t=new r(tt,1,10);return t.evaluate=function(t){return{variance:D(t[0]),reference:D(t[1]),mini:D(t[2]),maxi:D(t[3]),mark:D(t[4]),tickUnit:D(t[5]),legend:t[6],colorPositive:t[7],colorNegative:t[8],vertical:t[9]}},t.acceptsReference=function(t){return 0<=t&&t<=5},t.u9t=1,t},paint:g[tt]}),n(yn,Yt=u),e((t.LollipopVariSparkline=Tt=yn).prototype,{createFunction:function(){var t=new r(nt,3,13);return t.evaluate=function(t){var t={plannedValue:m(t[0],!0),actualValue:m(t[1],!0),index:D(t[2]),absolute:D(t[3]),reference:D(t[4]),mini:D(t[5]),maxi:D(t[6]),tickUnit:D(t[7]),legend:t[8],colorPositive:t[9],colorNegative:t[10],lollipopHeaderColor:t[11],vertical:t[12]};return Mn(t)?t:I},t.acceptsReference=function(t){return 2!==t&&0<=t&&t<=7},t.acceptsArray=an,t.u9t=1,t},paint:g[nt]}),n(Cn,Zt=u),e((t.BoxPlotSparkline=At=Cn).prototype,{createFunction:function(){function e(t,n){return w(t)&&!x(n)&&0<=n&&n<=100?o.PERCENTILE.evaluate(t,n/100):NaN}function i(t){return w(t)?o.STDEVP.evaluate(t):NaN}var t=new r(et,1,10);return t.evaluate=function(t){var n=t[0];return{points:m(n,!0),boxPlotClass:t[1],showAverage:t[2],scaleStart:D(t[3]),scaleEnd:D(t[4]),acceptableStart:D(t[5]),acceptableEnd:D(t[6]),colorScheme:t[7],style:t[8],vertical:t[9],perc02:e(n,2),perc09:e(n,9),perc10:e(n,10),perc90:e(n,90),perc91:e(n,91),perc98:e(n,98),q1:e(n,25),q3:e(n,75),median:e(n,50),stDev:i(n)}},t.acceptsReference=f,t.acceptsArray=f,t.u9t=1,t},paint:g[et]}),n(Sn,Wt=u),e((t.CascadeSparkline=It=Sn).prototype,{createFunction:function(){var t=new r(it,1,10);return t.evaluate=function(t){return{points:m(t[0],!0),pointIndex:D(t[1]),labels:m(t[2],!0),minimum:D(t[3]),maximum:D(t[4]),colorPositive:t[5],colorNegative:t[6],vertical:t[7],itemTypeRange:m(t[8],!0),colorTotal:t[9]}},t.acceptsReference=on,t.acceptsArray=on,t.u9t=1,t},paint:g[it]}),n(Tn,Qt=u),e((t.ParetoSparkline=xt=Tn).prototype,{createFunction:function(){var t=new r(rt,2,12);return t.evaluate=function(t){return{points:m(t[0],!0),pointIndex:D(t[1]),colorRange:m(t[2],!0),target:D(t[3]),target2:D(t[4]),highlightPosition:D(t[5]),label:t[6],vertical:t[7],targetColor:t[8],target2Color:t[9],labelColor:t[10],barSize:t[11]}},t.acceptsReference=k,t.acceptsArray=k,t.u9t=1,t},paint:g[rt]}),n(An,Jt=u),e((t.MonthSparkline=Nt=An).prototype,{createFunction:function(){var t=new r(ot,3,7);return t.evaluate=function(t){var n,e,i,r,i,o,a,u,s,c,f,l,l,n=t[0],e=t[1],i=t[2],r=i;for((w(i)||M(i))&&(r=_(i,0,!0)),i=t[3],o=[],(w(i)||M(i))&&(o=_(i,0,!0)),a=[],u=[],s=0,c=r.length;s<c;s++)(f=r[s])&&(l="string"==typeof(l=f[0])?new Date(l):l)&&l.getFullYear()===n&&l.getMonth()+1===e&&(a[l=l.getDate()-1]=f[1],0<o.length)&&(u[l]=o[s][0]);return 0<o.length?{year:n,month:e,values:a,colors:u}:{year:n,month:e,values:a,emptyColor:i,startColor:t[4],middleColor:t[5],endColor:t[6]}},t.acceptsReference=sn,t.acceptsArray=sn,t.u9t=1,t},paint:g[ot]}),n(O,Kt=u),O.daysOfMonth=function(t,n){switch(n){case 2:var e;return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},O.dayInYear=function(t){for(var n,e,i,r,n=t.getFullYear(),e=t.getMonth(),i=t.getDate(),r=1;r<e+1;r++)i+=O.daysOfMonth(n,r);return i},v=O,e((t.YearSparkline=v).prototype,{createFunction:function(){var t=new r(at,2,6);return t.evaluate=function(t){var n,e,i,e,r,o,a,u,s,c,f,f,n=t[0],e=t[1],i=e;for((w(e)||M(e))&&(i=_(e,0,!0)),e=t[2],r=[],(w(e)||M(e))&&(r=_(e,0,!0)),o=[],a=[],u=0,s=i.length;u<s;u++)(c=i[u])&&(f="string"==typeof(f=c[0])?new Date(f):f)&&f.getFullYear()===n&&(o[f=v.dayInYear(f)-1]=c[1],0<r.length)&&(a[f]=r[u][0]);return 0<r.length?{year:n,values:o,colors:a}:{year:n,values:o,emptyColor:e,startColor:t[3],middleColor:t[4],endColor:t[5]}},t.acceptsReference=cn,t.acceptsArray=cn,t.u9t=1,t},paint:g[at]}),n(In,Xt=u),e((t.HistogramSparkline=kt=In).prototype,{createFunction:function(){var f,t,f=this,t=new r(ht,1,9);return t.acceptsArray=function(){return!0},t.evaluate=function(t){var n,e,n,i,r,o,a,u,s,t,c,n=t[0],e=[];if(!(n instanceof T.CalcArray||n instanceof T.CalcReference))throw T.CalcError;if(e=f.RMt(n),n=t[1],A(n)&&(n=!0),i=!0===t[2],r=t[3],(r=A(r)?1:r)<=0)throw T.CalcError;if(o=t[4],1<(o=A(o)?1:o)||o<=0)throw T.CalcError;return a=t[5]||"#5B9BD5",u=t[6],s=t[7]||"#000000",t=t[8]||"#C0C0C0",{values:c=n?f.BMt(e,r):f.LMt(e),continuous:n,paintLabel:i,barWidth:o,barColor:a,labelFontStyle:u,labelColor:s,edgeColor:t}},t.acceptsReference=function(t){return 0===t},t.u9t=1,t},RMt:function(t){var n,e,i,n=[];if(t instanceof T.CalcArray)for(e=t.toArray(1),i=0;i<e.length;i++)n.push(e[i]);else(e=_(t,0)).forEach(function(t){t.forEach(function(t){A(t)||"number"!=typeof t||isNaN(t)||n.push(t)})});return n},BMt:function(t,n){var e,i,r,o,a,u,s,t,c,f,e=[],i=0,r=this;for(t.forEach(function(t){e[i]=t,i++}),o=[],a=s=e[0],e.forEach(function(t){a=Math.min(t,a),s=Math.max(t,s)}),u=C(a/n)*n,t=Math.ceil(s/n)*n,c=1!==e.length?Math.round((t-u)/n):1,i=0;i<c;i++)o[i]=l.Common.st.E8(i*n+u,15);for(o[i-1]<=s&&(o[i]=o[i-1]+n),f=[],i=0,c=o.length-1;i<c;i++)f[i]={value:0};for(0<f.length&&(f[0].axis="["+o[0]+","+o[1]+"]"),i=1;i<o.length-1;i++)A(o[i+1])?f[i].axis="("+o[i]+","+(o[i]+n)+"]":f[i].axis="("+o[i]+","+o[i+1]+"]";return e.forEach(function(t){var t=r.FMt(o,t);f[t].value++}),0<f.length&&0===f[0].value&&f.splice(0,1),f},LMt:function(t){for(var n,e,i,r,o,n,n=this,e={},i=0,r=t.length;i<r;++i)o=t[i],void 0===e[o]?e[o]=1:e[o]++;return(n=n.PMt(e)).sort(function(t,n){return t-n}),n.map(function(t){return{axis:t,value:e[t]}})},PMt:function(t){var n,e,n=[];for(e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&null!==t[e]&&n.push(e);return n},FMt:function(t,n){var e,i,r,o,a,e=t.length;if(t[0]===n)return 0;if(0===e)return 0;i=0,o=C((r=e-1)/2);do{if(n>t[a=o]&&n<=t[o+1])return o}while(n<=t[o]?o=C(((r=o)+i)/2):n>t[o+1]&&(o=C(((i=o)+r)/2)),a!==o)},paint:function(t,n,e,i,r,o,a){var u,s,u,s,u=n.labelFontStyle,s=a.zoomFactor;A(u)&&(u=t.font),u=y.W.V(u,s),s=y.W.Ne(u.font),n.afterZoomFontStyle={fontStyle:s.fontStyle,fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight,fontPixelSize:u.fontSize},g[ht](t,n,e,i,r,o,a)}}),n(xn,qt=u),e((t.ImageSparkline=_t=xn).prototype,{createFunction:function(){var t=new r(dt,1,11);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,f,t,l,n=t[0],e=t[1],i=t[2],r=t[3],o=t[4],a=t[5]||0,u=t[6]||0,s=t[7],c=t[8],f=t[9],t=t[10];if("string"!=typeof(e=A(e)?"":e)&&(e=""+e),-1===[0,1,2].indexOf(f)&&(f=void 0),-1===[0,1,2].indexOf(t)&&(t=void 0),i===p.custom){if(A(r)&&A(o))throw T.CalcError}else if(!A(r)||!A(o))throw T.CalcError;if(r<0||o<0)throw T.CalcError;return u=u<0?0:u,a=a<0?0:a,s=s<0?0:s,c=c<0?0:c,-1===[0,1,2,3].indexOf(i)&&(i=0),l={url:n,altText:e,drawType:i,height:r,width:o,clipY:a,clipX:u,clipWidth:c,clipHeight:s,vAlign:f,hAlign:t,imageBase64Data:void 0},y.oCe.isBase64ImageStr(n)?l.imageBase64Data=n:y.oCe.loadBase64ImageByUrl(n,function(t){l.imageBase64Data=t}),l},t},GMt:function(t,n,e,i,r){var o,a,u,s,t,c,f,l,t,n,h,d,e,v,m,o=t.width,a=t.height,u=t.x,s=t.y,t=n.width,c,f={clipX:0,clipY:0,clipHeight:n.height,clipWidth:t,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if((l=o/a)<(t=(f=this.UMt(f,n,e)).clipWidth/f.clipHeight))switch(n=i.vAlign,f.paintWidth=o,f.paintHeight=h=o/t,f.paintX=u,n){case y.VerticalAlign.top:f.paintY=s;break;case y.VerticalAlign.center:f.paintY=s+(d=a-h)/2;break;case y.VerticalAlign.bottom:f.paintY=s+a-h}else switch(e=i.hAlign,f.paintHeight=a,f.paintWidth=v=a*t,f.paintY=s,e){case y.HorizontalAlign.left:f.paintX=u;break;case y.HorizontalAlign.center:f.paintX=u+(m=o-v)/2;break;case y.HorizontalAlign.right:f.paintX=u+o-v}return f},HMt:function(t,n,e,i,r){var t={cutX:0,cutY:0,cutHeight:n.width,cutWidth:n.height,paintX:t.x,paintY:t.y,paintHeight:t.height,paintWidth:t.width};return this.UMt(t,n,e)},UMt:function(t,n,e){var i,n,r,o,i=n.width,n=n.height,r=e.clipX||0,o=e.clipY||0;return A(e.clipX)||(t.clipX=a(e.clipX,i)),A(e.clipY)||(t.clipY=a(e.clipY,n)),A(e.clipWidth)?t.clipWidth=i-t.clipX:t.clipWidth=e.clipWidth+r>i?i-r:e.clipWidth,A(e.clipHeight)?t.clipHeight=n-t.clipY:t.clipHeight=e.clipHeight+o>n?n-o:e.clipHeight,t},zMt:function(t,n,e,i,r){var o,a,u,s,c,t,n,e,f,r,l,h,d,i,v,m,g,p,o=t.width,a=t.height,u=t.x,s=t.y,c={imgWidth:n.width,imgHeight:n.height,offsetX:0,offsetY:0},t=(c=this.VMt(c,n,e)).imgWidth,n=c.imgHeight,e=c.offsetX,f=c.offsetY,l=n*r,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},d=i.hAlign,i=i.vAlign;if(o<(r=t*r)){switch(h.paintWidth=o,h.paintX=u,v=(r-o)/r*t,d){case y.HorizontalAlign.left:h.clipX=c.offsetX;break;case y.HorizontalAlign.center:h.clipX=c.offsetX+v/2;break;case y.HorizontalAlign.right:h.clipX=c.offsetX+v}h.clipWidth=o}else{switch(h.clipWidth=t,h.clipX=0,m=o-(h.paintWidth=r),d){case y.HorizontalAlign.general:case y.HorizontalAlign.left:h.paintX=u;break;case y.HorizontalAlign.center:h.paintX=u+m/2;break;case y.HorizontalAlign.right:h.paintX=u+m}h.clipX+=e}if(a<l){switch(h.paintY=s,g=(l-(h.paintHeight=a))/l*n,i){case y.VerticalAlign.top:h.clipY=c.offsetY;break;case y.VerticalAlign.center:h.clipY=c.offsetY+g/2;break;case y.VerticalAlign.bottom:h.clipY=c.offsetY+g}h.clipHeight=a}else{switch(h.clipHeight=n,h.clipY=0,p=a-(h.paintHeight=l),i){case y.VerticalAlign.top:h.paintY=s;break;case y.VerticalAlign.center:h.paintY=s+p/2;break;case y.VerticalAlign.bottom:h.paintY=s+p}h.clipY+=f}return h},YMt:function(t,n,e,i,r){var o,a,a,r,u,s,c,f,l,t,n,h,d,v,i,m,g,p,m,b,w,o={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},a=n.width/n.height;if(A(n.customWidth)?n.customWidth=C(n.customHeight*a):A(n.customHeight)&&(n.customHeight=C(n.customWidth/a)),a=n.customWidth*r,r=n.customHeight*r,!(null===a||a<0||null===r||a<0)){if(u=t.width,s=t.height,c=t.x,f=t.y,l={imgWidth:n.width,imgHeight:n.height,offsetX:0,offsetY:0},t=(l=this.VMt(l,n,e)).imgWidth,n=l.imgHeight,h=l.offsetX,d=l.offsetY,v=i.hAlign,i=i.vAlign,u<a){switch(o.paintWidth=u,o.paintX=c,g=(m=(a-u)/a)*t,v){case y.HorizontalAlign.left:o.clipX=l.offsetX;break;case y.HorizontalAlign.center:o.clipX=l.offsetX+g/2;break;case y.HorizontalAlign.right:o.clipX=l.offsetX+g}o.clipWidth=l.imgWidth*(1-m)}else{switch(o.clipWidth=t,o.clipX=0,p=u-(o.paintWidth=a),v){case y.HorizontalAlign.general:case y.HorizontalAlign.left:o.paintX=c;break;case y.HorizontalAlign.center:o.paintX=c+p/2;break;case y.HorizontalAlign.right:o.paintX=c+p}o.clipX+=h}if(s<r){switch(o.paintY=f,b=(m=(r-(o.paintHeight=s))/r)*n,i){case y.VerticalAlign.top:o.clipY=l.offsetY;break;case y.VerticalAlign.center:o.clipY=l.offsetY+b/2;break;case y.VerticalAlign.bottom:o.clipY=l.offsetY+b}o.clipHeight=l.imgHeight*(1-m)}else{switch(o.clipHeight=A(e.clipHeight)?n:l.imgHeight,o.clipY=0,w=s-(o.paintHeight=r),i){case y.VerticalAlign.top:o.paintY=f;break;case y.VerticalAlign.center:o.paintY=f+w/2;break;case y.VerticalAlign.bottom:o.paintY=f+w}o.clipY+=d}}return o},VMt:function(t,n,e){var i=n.width,n=n.height;return A(e.clipX)||(t.offsetX=a(i,e.clipX)),A(e.clipY)||(t.offsetY=a(n,e.clipY)),A(e.clipWidth)?t.imgWidth=i-t.offsetX:t.imgWidth=e.clipWidth+t.offsetX>i?i-t.offsetX:e.clipWidth,A(e.clipHeight)?t.imgHeight=n-t.offsetY:t.imgHeight=e.clipHeight+t.offsetY>n?n-t.offsetY:e.clipHeight,t},paint:function(t,n,e,i,r,o,a){var u,s,e,i,c;if(!A(n)&&!A(n.url)&&P(n.url)&&""!==n.url.trim()){u=this,e={x:e,y:i,width:r,height:o},i=(s=a.sheet).BO();try{c=n.imageBase64Data||n.url,i.getState(c)?u.ZMt(t,n,e,a):i.addImage(c)}catch(t){}}},ZMt:function(t,n,e,i){var r,r,o,r,a,o,u,s,c,c,f,l,o,u,o,h,d,v,m,a=this,o=n.imageBase64Data||n.url,u=i.sheet,s=n.drawType,c=u.MC;if(o&&"string"==typeof o&&c.qh(o)){switch(f={width:(c=c.getImage(o)).width,height:c.height},l={clipY:n.clipY,clipX:n.clipX,clipWidth:n.clipWidth,clipHeight:n.clipHeight},u=(o=u.getActualStyle(i.rowIndex,i.columnIndex)).hAlign,o=o.vAlign,u===y.HorizontalAlign.general&&(u=y.HorizontalAlign.left),h={vAlign:null!=(r=null!=(r=n.vAlign)?r:o)?r:y.VerticalAlign.bottom,hAlign:null!=(r=null!=(o=n.hAlign)?o:u)?r:y.HorizontalAlign.left},v=i.zoomFactor,s){case p.fit:d=a.GMt(e,f,l,h,v);break;case p.entireFit:d=a.HMt(e,f,l,h,v);break;case p.originFit:d=a.zMt(e,f,l,h,v);break;case p.custom:f.customWidth=n.width,f.customHeight=n.height,d=a.YMt(e,f,l,h,v)}d.img=c,g[m="IMAGESPARKLINE"](t,d,e.x,e.y,e.width,e.height,i)}}}),n(_n,$t=u),e((t.LineSparkline=Dt=_n).prototype,{createFunction:function(){return Nn(ut,0)},paint:kn}),n(Dn,tn=u),e((t.ColumnSparkline=jt=Dn).prototype,{createFunction:function(){return Nn(st,1)},paint:kn}),n(jn,nn=u),e((t.WinlossSparkline=Ot=jn).prototype,{createFunction:function(){return Nn(ct,2)},paint:kn}),n(On,en=u),e((t.RangeBlockSparkline=Et=On).prototype,{createFunction:function(){var t=new r(ft,2,2);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,r,e,e,n,n=t[0],e=n.source,i=e&&e.getSheet(),r=t[1],o=0,a=r.getSource().getSheet(),u=r.getRow(0),s=r.getColumn(0),c=r.getRowCount(0),r=r.getColumnCount(0),e=e&&e.getBaseRowCol?(e=e.getBaseRowCol(),new y.Range(e.row,e.col,1,1)):new y.Range(n.row,n.column,1,1),n=new y.Range(u,s,c,r);if(i&&i.name()===a.name()&&n.containsRange(e))throw T.CalcError;return{templateSheetName:a.name(),templateRange:{row:u,col:s,rowCount:c,colCount:r},bindingObject:t[2]}},t.isContextSensitive=function(){return!0},t.acceptsReference=f,t.u9t=1,t},paint:function(t,n,e,i,r,o,a){var u,s,c,f,l,f,u,f,u,u=n.templateSheetName,s=n.templateRange;if(u&&(l=!(l=(f=(c=a.sheet).parent)&&f.getSheetFromName(u))&&f?(f=f.getSheetTab(u))&&f.getSheet&&f.getSheet():l)){if(!d){if(!(u=h("CellTypes")))return;d=u.qY,L=u.$Y,B=u.paintRangeTemplate}f=(new d).yN(l,s),u=(new L).yN(l,s),B(t,{x:e,y:i,width:r,height:o},n.bindingObject,a,f,u.tZ)}}}),n(En,rn=u),e((t.GaugeKPISparkline=n=En).prototype,{createFunction:function(){var t=new r(lt,4,255);return t.evaluate=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,u,b,S,i,n=[],e=t.length,f=D(t[0]),l=D(t[1]),h=D(t[2]),d=D(t[3]),v=D(t[5]),m=D(t[6]),g=D(t[7]),p=D(t[8]),b=D(t[10]),w=D(t[11]),y=D(t[12]),M=t[4],C=t[13];if(!Rn(f,l,h,d,b,w,C,y))return I;for(t[9]instanceof T.CalcArray&&(r=(u=t[9].toArray(2))[0],o=u[1],a=u[2],u=u[3]),r=r||"16px Calibri",o=o||"bold 22px Calibri",a=a||N,u=u||N,v=A(v)?f:v,m=A(m)?l:m,g=A(g)?h:g,p=A(p)?d:p,b={minAngle:A(b)?-90:b,maxAngle:A(w)?90:w,radiusRatio:A(y)?0:y,targetValueOption:E(f,r,v),currentValueOption:E(l,o,m),minValueOption:E(h,a,g),maxValueOption:E(d,u,p),gaugeType:A(C)?0:C,ranges:void 0,showLabel:!!A(M)||Boolean(M)},S=14;S<e;S++)if((i=t[S])instanceof T.CalcArray){if(s=(i=i.toArray(0))[0],c=i[1],A(s)||A(c)||x(s)||x(c)||c<s||s<h||d<s||d<c||c<h)return I;n.push({start:s,end:c,color:i[2]})}return b.ranges=n,b},t.acceptsArray=function(t){return 9===t||14<=t},t.acceptsReference=function(t){return t<=3&&0<=t||5<=t&&t<=8||10<=t&&t<=12},t.u9t=1,t},paint:function(t,n,e,i,r,o,a){var u=a.zoomFactor;n.currentValueOption.fontAfterZoom=s(n.currentValueOption.font,u).font,n.targetValueOption.fontAfterZoom=s(n.targetValueOption.font,u).font,n.minValueOption.fontAfterZoom=s(n.minValueOption.font,u).font,n.maxValueOption.fontAfterZoom=s(n.maxValueOption.font,u).font,g[lt](t,n,e,i,r,o,a)}}),c={},t.jMt=c,r&&(R(new mt),R(new gt),R(new pt),R(new bt),R(new wt),R(new yt),R(new Mt),R(new Ct),R(new St),R(new Tt),R(new At),R(new It),R(new xt),R(new Nt),R(new v),R(new Dt),R(new jt),R(new Ot),R(new Et),R(new n),R(new kt),R(new _t)),e(y.Workbook.prototype,{addSparklineEx:function(t){this.WMt||(this.WMt={});var n=this.WMt;t&&(n[t.name()]=t)},getSparklineEx:function(t){var n,n,n=c[t];return n||(n=this.WMt)&&n[t]},removeSparklineEx:function(t){var n=this.WMt;n&&(n[t]=void 0)}}),y.Workbook.ch("sparklineEx",{toJson:function(t){var n,e,i,r,o,n=this.WMt,e=[];if(n){for(i in n)n.hasOwnProperty(i)&&(o=(r=n[i]).toJSON())&&o.typeName&&e.push(o);0<e.length&&(t.sparklineExs=e)}},fromJson:function(t){var n,e,i,r,r,n=t.sparklineExs;if(n)for(e=0;e<n.length;e++)i=n[e],(r=(0,y.getTypeFromString)(i.typeName))&&((r=new r).fromJSON(i),this.addSparklineEx(r))},wh:function(t,n,e){var i,r,o,a,u,i=this.WMt,r=[];if(i){for(o in i)i.hasOwnProperty(o)&&(u=(a=i[o]).toJSON())&&u.typeName&&r.push(u);0<r.length&&(t.workbook.lossless.sparklineExs=r)}},yh:function(t,n,e){var t,i,r,o,a,a,t=t.workbook.lossless,i=t&&t.sparklineExs;if(i)for(r=0;r<i.length;r++)o=i[r],(a=(0,y.getTypeFromString)(o.typeName))&&((a=new a).fromJSON(o),this.addSparklineEx(a))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(t,n,e){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.Sparkline=n.DataOrientation=n.SparklineType=n.SparklineSetting=n.SparklineAxisMinMax=n.EmptyValueStyle=n.ImageSparkline=n.HistogramSparkline=n.SparklineExValue=n.SparklineEx=n.GaugeKPISparkline=n.RangeBlockSparkline=n.WinlossSparkline=n.ColumnSparkline=n.LineSparkline=n.YearSparkline=n.MonthSparkline=n.ParetoSparkline=n.CascadeSparkline=n.BoxPlotSparkline=n.LollipopVariSparkline=n.VariSparkline=n.VBarSparkline=n.HBarSparkline=n.StackedSparkline=n.SpreadSparkline=n.BulletSparkline=n.ScatterSparkline=n.AreaSparkline=n.PieSparkline=n.jMt=void 0,i=e("./dist/plugins/sparkline/functions-sparkline.js"),Object.defineProperty(n,"jMt",{enumerable:!0,get:function(){return i.jMt}}),Object.defineProperty(n,"PieSparkline",{enumerable:!0,get:function(){return i.PieSparkline}}),Object.defineProperty(n,"AreaSparkline",{enumerable:!0,get:function(){return i.AreaSparkline}}),Object.defineProperty(n,"ScatterSparkline",{enumerable:!0,get:function(){return i.ScatterSparkline}}),Object.defineProperty(n,"BulletSparkline",{enumerable:!0,get:function(){return i.BulletSparkline}}),Object.defineProperty(n,"SpreadSparkline",{enumerable:!0,get:function(){return i.SpreadSparkline}}),Object.defineProperty(n,"StackedSparkline",{enumerable:!0,get:function(){return i.StackedSparkline}}),Object.defineProperty(n,"HBarSparkline",{enumerable:!0,get:function(){return i.HBarSparkline}}),Object.defineProperty(n,"VBarSparkline",{enumerable:!0,get:function(){return i.VBarSparkline}}),Object.defineProperty(n,"VariSparkline",{enumerable:!0,get:function(){return i.VariSparkline}}),Object.defineProperty(n,"LollipopVariSparkline",{enumerable:!0,get:function(){return i.LollipopVariSparkline}}),Object.defineProperty(n,"BoxPlotSparkline",{enumerable:!0,get:function(){return i.BoxPlotSparkline}}),Object.defineProperty(n,"CascadeSparkline",{enumerable:!0,get:function(){return i.CascadeSparkline}}),Object.defineProperty(n,"ParetoSparkline",{enumerable:!0,get:function(){return i.ParetoSparkline}}),Object.defineProperty(n,"MonthSparkline",{enumerable:!0,get:function(){return i.MonthSparkline}}),Object.defineProperty(n,"YearSparkline",{enumerable:!0,get:function(){return i.YearSparkline}}),Object.defineProperty(n,"LineSparkline",{enumerable:!0,get:function(){return i.LineSparkline}}),Object.defineProperty(n,"ColumnSparkline",{enumerable:!0,get:function(){return i.ColumnSparkline}}),Object.defineProperty(n,"WinlossSparkline",{enumerable:!0,get:function(){return i.WinlossSparkline}}),Object.defineProperty(n,"RangeBlockSparkline",{enumerable:!0,get:function(){return i.RangeBlockSparkline}}),Object.defineProperty(n,"GaugeKPISparkline",{enumerable:!0,get:function(){return i.GaugeKPISparkline}}),Object.defineProperty(n,"SparklineEx",{enumerable:!0,get:function(){return i.SparklineEx}}),Object.defineProperty(n,"SparklineExValue",{enumerable:!0,get:function(){return i.SparklineExValue}}),Object.defineProperty(n,"HistogramSparkline",{enumerable:!0,get:function(){return i.HistogramSparkline}}),Object.defineProperty(n,"ImageSparkline",{enumerable:!0,get:function(){return i.ImageSparkline}}),r=e("./dist/plugins/sparkline/sparkline-wrapper.js"),Object.defineProperty(n,"EmptyValueStyle",{enumerable:!0,get:function(){return r.EmptyValueStyle}}),Object.defineProperty(n,"SparklineAxisMinMax",{enumerable:!0,get:function(){return r.SparklineAxisMinMax}}),Object.defineProperty(n,"SparklineSetting",{enumerable:!0,get:function(){return r.SparklineSetting}}),Object.defineProperty(n,"SparklineType",{enumerable:!0,get:function(){return r.SparklineType}}),Object.defineProperty(n,"DataOrientation",{enumerable:!0,get:function(){return r.DataOrientation}}),Object.defineProperty(n,"Sparkline",{enumerable:!0,get:function(){return r.Sparkline}})},"./dist/plugins/sparkline/sparkline-wrapper.js":function(F,t,n){"use strict";var A,s,L,p,n,a,B,u,e,i,r,o,c,f,x,I,l,g,M,P,G,U,T,C,S,h,H,V,z,d,v,m,Y,Z,W,Q,J,n,l,b,w,K,X,y,N,l,n,l,n,l,n,l;function q(t,n,e,i){var r,t,n,r,t=p.formulaToRanges(t,n,e,i)[0],n=t&&t.ranges&&t.ranges[0];return n?{range:n,sheetName:t.sheetName}:T}function $(t){var n,e,t,n=t.lastIndexOf("!");return-1===n?[t]:(e=t.substring(0,n),t=t.substring(n+1),[e=tt(e)?e.substring(1,e.length-1):e,t])}function tt(t){return 2<=t.length&&"'"===t[0]&&"'"===t[t.length-1]}function nt(t,n,e,i){var r,o,r=this,o=r.RB;o._K(t,n,i),i&&o.add(i.group()),r.Rj("sparkline",t,n,3,e,i)}function k(t){this.QMt=[],this.Mf=t,this.cE={},this.KMt=[],this.JMt=[]}function et(t,n){return t+"_"+n}function it(t,n,e){return e?t>e.row+e.rowCount-1?e:t>e.row?x(e.row,e.col,e.rowCount+n,e.colCount):x(e.row+n,e.col,e.rowCount,e.colCount):T}function rt(t,n,e){return e?t>e.col+e.colCount-1?e:t>e.col?x(e.row,e.col,e.rowCount,e.colCount+n):x(e.row,e.col+n,e.rowCount,e.colCount):T}function ot(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,o=new A.Rf,a=0;a<t.length;a++){if(s=(u=t[a]).XMt,u.displayDateAxis){if(I(u.dateAxisData())&&u.dateAxisData(u.qMt),c=void 0,(f=u.dateAxisData())instanceof A.Range)c=_(n,e,i,f);else for(l=0;l<f.length;l++)c.push.apply(c,_(n,e,i,f[l]));u.dateAxisData(c)}for(l=0;l<s.length;l++)h=s[l],n<=(d=i?h.row:h.column)&&(o.set(a,l,h),r._K(h.row,h.column,T),i?h.row+=e:h.column+=e),I(h.data())&&h.data(h.gI),v=void 0,(m=h.data())instanceof A.Range?(v=_(n,e,i,m),h.data(v)):h.data(h.gI)}for(g=0;g<t.length;g++)for(b=(p=t[g]).XMt,w=0;w<b.length;w++)r.$Mt(o.get(g,w))}function at(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,w,a=0;a<i.length;a++)if((u=i[a]).displayDateAxis){if(c=(s=u.tCt()).Ut,f=!1,o&&!c.G8&&(c.G8=[],f=!0),I(u.dateAxisData())&&u.dateAxisData(u.qMt),l=void 0,(h=u.dateAxisData())instanceof A.Range)l=_(t,n,e,h);else for(d=0;d<h.length;d++)l.push.apply(l,_(t,n,e,h[d]));u.dateAxisData(l),f&&(o.push({sheetName:s.name(),changes:c.G8}),c.G8=C)}for(d=0;d<r.length;d++)g=(m=(v=r[d]).Tp()).Ut,p=!1,o&&!g.G8&&(g.G8=[],p=!0),I(v.data())&&v.data(v.gI),b=void 0,(w=v.data())instanceof A.Range?(b=_(t,n,e,w),v.data(b)):v.data(v.gI),p&&(o.push({sheetName:m.name(),changes:g.G8}),g.G8=C)}function _(t,n,e,i){var e,e=(e?it:rt)(t,n,i);return e}function ut(t,n,e){var t=ct(e.col,e.col+e.colCount-1,t,t+n-1);return t?x(e.row,t.start,e.rowCount,t.end-t.start+1):T}function st(t,n,e){var t=ct(e.row,e.row+e.rowCount-1,t,t+n-1);return t?x(t.start,e.col,t.end-t.start+1,e.colCount):T}function ct(t,n,e,i){var r,o,a,u,u,s,c,r=-1;if(i<t)return{start:r=t-(u=i-e+1),end:o=n-u};if(n<e)return{start:r=t,end:o=n};if(e<=t){for(u=n-t+1,s=0,a=t;a<=i&&a<=n;a++)s++;return{start:r=e,end:o=r+u-s-1}}for(c=0,a=t;a<=n;a++)-1===r&&(a<e||i<a)&&(r=a),(a<e||i<a)&&c++;return-1!==r&&0<c?{start:r,end:o=r+c-1}:T}function ft(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,m,g,g,p,b,w,y,o=new A.Rf,a=t.length,u=0,s=a-1;-1<s;s--){if((c=t[s]).displayDateAxis){if(I(c.dateAxisData())&&c.dateAxisData(c.qMt),f=void 0,(l=c.dateAxisData())instanceof A.Range)f=D(n,e,i,l);else for(h=0;h<l.length;h++)f.push.apply(f,D(n,e,i,l[h]));if(I(f)){c.clear(),r.remove(c);continue}c.dateAxisData(f)}for(d=(d=[]).concat(c.XMt),v=M(d),u=S(v,u),h=v-1;-1<h;h--)m=d[h],n<=(g=i?m.row:m.column)&&g<n+e&&I(m.gI)?(c.remove(m),r._K(m.row,m.column,T)):(n<=g&&(r._K(m.row,m.column,T),i?m.row-=e:m.column-=e,o.set(s,h,m)),I(m.data())&&m.data(m.gI),g=void 0,g=(p=m.data())instanceof A.Range?D(n,e,i,p):(m.data(m.gI),m.data()),I(g)?c.remove(m):m.data(g));c.count()<=0&&r.remove(c)}for(w=0;w<a;w++)for(y=0;y<u;y++)(b=o.get(w,y))&&r.$Mt(b)}function D(t,n,e,i){var e,e=(e?st:ut)(t,n,i);return e}function lt(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,M,a,u=i.length-1;-1<u;u--)if((s=i[u]).displayDateAxis){if(f=(c=s.tCt()).Ut,l=!1,o&&!f.G8&&(f.G8=[],l=!0),I(s.dateAxisData())&&s.dateAxisData(s.qMt),h=void 0,(d=s.dateAxisData())instanceof A.Range)h=D(t,n,e,d);else for(v=0;v<d.length;v++)h.push.apply(h,D(t,n,e,d[v]));I(h)?(s.clear(),s.RB.remove(s)):s.dateAxisData(h),l&&(o.push({sheetName:c.name(),changes:f.G8}),f.G8=C)}for(v=(m=r.length)-1;-1<v;v--)b=(p=(g=r[v]).Tp()).Ut,w=!1,o&&!b.G8&&(b.G8=[],w=!0),I(g.data())&&g.data(g.gI),y=void 0,y=(M=g.data())instanceof A.Range?D(t,n,e,M):(g.data(g.gI),g.data()),I(y)?((M=g.group()).remove(g),M.count()<=0&&M.RB.remove(M)):g.data(y),w&&(o.push({sheetName:p.name(),changes:b.G8}),b.G8=C)}function j(t){var n,e,n=this;for(e in n.options={},b)b.hasOwnProperty(e)&&(n.options[e]=(t&&t[e]?t:b)[e]);n.eJ=T}function O(t,n){var e=this;e.displayDateAxis=!1,e.RB=T,e.XMt=[],e.nCt=T,e.eCt=1,e.qMt=T,e.setting=n,e.sparklineType=t}function ht(t,n){var e=!1;return"setting"===t||"axisReference"===t?e=n===T:"displayDateAxis"===t?e=!1===n:"axisOrientation"===t?e=1===n:"sparklines"===t&&(e=0===n.length),e}function E(t,n,e,i,r,o,a){var u=this;u.row=t,u.column=n,u.iCt=i,u._data=e,u.rCt=new y(r,o),u.rCt.add(u),u.gI=a}function dt(t,n){var e,n,e=t.parent,n=t.getCustomName(n)||e.getCustomName(n);if(!I(n))return p.formulaToRanges(t,p.expressionToFormula(t,n.getExpression()),0,0,1===e.options.referenceStyle)}function R(t){var e,i,e=[],i=[];return t.forEach(function(t){e=e.concat(t.ranges);for(var n=0;n<t.ranges.length;n++)i.push(t.sheetName)}),{ranges:e,sheetName:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.Sparkline=t.DataOrientation=t.SparklineType=t.SparklineSetting=t.SparklineAxisMinMax=t.EmptyValueStyle=void 0,A=n("Core"),s=n("Common"),L=n("CalcEngine"),p=n("SheetsCalc"),n=A.mt,a=n.xr,B=n.Hue,u=A.range_parser.Dc,e=A.NodeHelper.ar,i=A.NodeHelper.ur,r=n.d1,o=n.h1,c=A.range_parser.Oc,f=A.GC$.isEmptyObject,x=A.Ec,I=s.Common.lt.ht,l=s.Common.Uf,g=l.VP,M=l.tR,P=l.OS,G=s.Sparklines.oCt,U=s.Sparklines.SparklineRender,T=null,C=void 0,S=Math.max,h=Number.MAX_VALUE,H=A.UsedRangeUtil.vh,V=n.vo,z=n.n1,(l=d=d||{})[l.line=0]="line",l[l.column=1]="column",l[l.stacked=2]="stacked",(n=v=v||{})[n.span=2]="span",n[n.gap=0]="gap",n[n.zero=1]="zero",(l=m=m||{})[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",A.GC$.extend(A.Y8.prototype,{aCt:function(t){var n,e,i,r,o,a,n,e=this.G8,i=arguments[1];if(e){switch(e.originalSparklines||(e.originalSparklines=[]),r={type:t},t){case 0:a=void 0,a=i&&i.sparkline?i.sparkline:T,r.changeInfo={row:i.row,col:i.col,sparkline:a};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:r.changeInfo=i}e.originalSparklines.push(r)}},uCt:function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,n=this,e=t.changeInfo;switch(t.type){case 12:e.sparkline?(e.sparkline.row=e.row,e.sparkline.column=e.col,n.RB._K(e.row,e.col,e.sparkline)):n.RB._K(e.row,e.col,T);break;case 0:n.RB._K(e.row,e.col,e.sparkline),e.sparkline&&!n.RB.contains(e.sparkline.group())&&n.RB.add(e.sparkline.group());break;case 1:for(a=o=r=void 0,u=M(e),s=0;s<u;s++)r=e[s].row,o=e[s].col,a=n.RB.sCt(r,o),0===s&&a.rCt.count()===u&&n.RB.remove(a.rCt),this.RB.add(a.group(e[s].group).rCt);break;case 2:for(c=[],f=0;f<M(e);f++)c.push(n.RB.sCt(e[f].row,e[f].col));n.RB.Mf.groupSparkline(c);break;case 3:(i=n.RB.sCt(e.row,e.col)).sparklineType(e.sparklineType);break;case 4:(i=n.RB.sCt(e.row,e.col)).setting(e.setting);break;case 5:e.sparkline.data(e.data);break;case 15:(i=n.RB.sCt(e.row,e.col)).dataSheetName(e.dataSheetName);break;case 6:(i=n.RB.sCt(e.row,e.col)).dataOrientation(e.dataOrientation);break;case 7:(i=n.RB.sCt(e.row,e.col)).displayDateAxis(e.displayDateAxis);break;case 8:l=void 0,l=(h=e.rangeInfo)&&x(h.row,h.col,h.rowCount,h.colCount),e.group.dateAxisData(l);break;case 16:e.group.dateAxisDataSheetName(e.dateAxisDataSheetName);break;case 9:e.group.dateAxisOrientation(e.dateAxisOrientation);break;case 10:for((d=e.group.XMt).forEach(function(t){n.RB.cCt(t)}),e.group.XMt=e.innerList,v=e.group.XMt,m=0;m<M(v);m++)v[m].group(e.group);v.forEach(function(t){n.RB.fCt(t)});break;case 11:(i=n.RB.sCt(e.row,e.col)).group(e.group);break;case 13:g(n.RB.groups(),e),n.RB.lCt(e);break;case 14:n.RB.groups().push(e),n.RB.hCt(e)}},dCt:function(t){for(var n,e,n,e=M(t)-1;0<=e;e--)this.uCt(t[e])},vCt:function(t,n){this.RB.JO(t,n)},mCt:function(t,n){this.RB.xP(t,n)},gCt:function(t,n){this.RB.qO(t,n)},pCt:function(t,n){this.RB.NP(t,n)},bCt:function(t,n,e,i){this.RB.clear(t,n,e,i)},yCt:function(){var t=this.G8;return t?(t.wCt||(t.wCt=[]),t.wCt):T}}),A.Y8.ch("sparkline",{init:function(){var t=this.Mf;this.RB=new W(t)},undo:function(t){var n,e,n,n=t.originalSparklines;n&&this.dCt(n),e=this.Mf,(n=t.wCt)&&n.forEach(function(t){var n;e.parent.getSheetFromName(t.sheetName).Ut.undo(t.changes)})}}),A.Worksheet.ch("sparkline",Y={init:function(){this.RB=this.Ut.RB},getUsedRange:function(t){var n,e,i;t.type&A.UsedRangeType.sparkLine&&(i=(e=(n=this).RB).getUsedRange(),H(t.range,i))},dispose:function(t){var t;!1!==t.clearCache&&((t=this).RB&&(t.RB.Mf=T,t.RB.evaluator=T,t.RB=T),t.Ut)&&(t.Ut.RB=T)},onLayoutChanged:function(t){var n,e,i,r,o,a,n;!I(t.sheetArea)&&3!==t.sheetArea||(n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=this.Ut,"addRows"===n?a.vCt(e,i):"deleteRows"===n?a.mCt(e,i):"addColumns"===n?a.gCt(r,o):"deleteColumns"===n?a.pCt(r,o):"clear"===n&&(n=t.type,3===t.sheetArea)&&16==(16&n)&&a.bCt(e,r,i,o))},toJson:function(t,n){var e;n&&n.ignoreStyle||(t.sparklineGroups=this.RB.toJSON())},wh:function(t,n,e){var i,e,t,i;(!e||!1!==e.includeStyles)&&(e=this.RB.wh(),t=a(t,A.XFileConstants.Au),0<e.c_.length)&&t.c_.push({n_:"ext",c_:[e],r_:[0,1]})},fromJson:function(t,n,e){var e,i,r,o,o,e=e&&e.ignoreStyle,i,r=this.RB,o=t.sparklineGroupManager,o=n?o&&o.groups:t.sparklineGroups;o&&!e&&r.AP(o,n)},yh:function(t,n,e){var i,r,o,t,t,i=e&&!1===e.includeStyles,r,o=this.RB,t=B(a(t,"extLst"),"sparklineGroups"),t=t&&t.c_;t&&!i&&(o.MCt(t,e),o.groups().forEach(function(t){t.XMt.forEach(function(t){o.$Mt(t)})}))},setName:function(t){var n=t.oldName,t=t.newName;this.RB.CCt(n,t)}}),A.GC$.extend(A.Worksheet.prototype,Z={getSparkline:function(t,n){return this.RB?this.RB.sCt(t,n):T},setSparkline:function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,f,m,g,h,e,i,r,o,s=this,c;if(!s.RB)return T;if("string"==typeof e&&(h=q(s,e,t,n),d=s.getCustomName(e)||s.parent.getCustomName(e),v=void 0,(v=I(d)?v:p.formulaToRanges(s,p.expressionToFormula(s,d.getExpression(),t,n,1===s.parent.options.referenceStyle)))?(l=e,e=m=(f=R(v)).ranges,f=g=f.sheetName):h&&(e=h.range,f=h.sheetName),!h)&&!v)return T;if(h=new N(t,n,e,i,r,o,l),f&&f!==s.name()&&h.dataSheetName(f),a&&!I(u)){if(e=void 0,"string"==typeof a&&(i=q(s,a,t,n),d=s.getCustomName(a)||s.parent.getCustomName(a),v=void 0,(v=I(d)?v:p.formulaToRanges(s,p.expressionToFormula(s,d.getExpression(),t,n,1===s.parent.options.referenceStyle)))?(h.group().qMt=a,a=m=(r=R(v)).ranges,e=g=r.sheetName):i&&(a=i.range,e=i.sheetName),!i)&&!v)return T;h.dateAxisData(a),e&&e!==s.name()&&h.dateAxisDataSheetName(e),h.dateAxisOrientation(u),h.group().displayDateAxis=!0}return o=s.getSparkline(t,n),s.removeSparkline(t,n),nt.call(s,t,n,o,h),s.zw(),h},SCt:function(t,n,e){var i,r=this.getSparkline(t,n);nt.call(this,t,n,r,e)},removeSparkline:function(t,n){var e,i,r,o,a,e=this,i=e.RB;i&&(r=e.getSparkline(t,n),e.Ut.aCt(0,o={row:t,col:n,sparkline:r}),r&&((a=r.group()).remove(r),a.count()<=0&&i.remove(a),nt.call(e,t,n,r,T)),e.zw())},groupSparkline:function(t){var n,e,i,r,o,a,u,s,n=this,e=n.RB;if(!e)return T;for(i=T,r=[],o=n.Ut.G8!==C,a=0;a<t.length;a++)(u=t[a])&&(o&&r.push({group:u.group().clone(),row:u.row,col:u.column}),i?((s=u.group()).remove(u),i.add(u),s.count()<=0&&e.remove(s)):i=u.group());return n.zw(),n.Ut.aCt(1,r),i},ungroupSparkline:function(t){var n,e,i,r,o,a,u,s,n=this,e=n.RB;if(e&&t){for(r=[],o=n.Ut.G8!==C,i=(i=[]).concat(t.XMt),a=0;a<i.length;a++)(u=i[a])&&(o&&r.push({row:u.row,col:u.column}),t.remove(u),(s=t.clone()).add(u),e.add(s));e.remove(t),n.Ut.aCt(2,r),n.zw()}}}),k.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.cE,e={};if(n)for(a=o=r=void 0,u=0,s=i=Object.keys(n);u<s.length;u++)o=(r=n[c=s[u]]).row,a=r.column,H(e,{minRow:o,minCol:a,maxRow:o,maxCol:a});return e},k.prototype.AP=function(t,n){var e=this;e.fromJSON(t,n),e.groups().forEach(function(t){t.XMt.forEach(function(t){e.$Mt(t)})})},k.prototype.MCt=function(t,n){var e,i,e=this,i=e.Mf;e.yh(t,n),e.groups().forEach(function(t){t.XMt.forEach(function(t){e.$Mt(t),t.row>=i.getRowCount()&&i.setRowCount(t.row+1),t.column>=i.getColumnCount()&&i.setColumnCount(t.column+1)})})},k.prototype.$Mt=function(t){t&&this._K(t.row,t.column,t)},k.prototype._K=function(t,n,e){var i;this.Mf.Ut.G8&&(i={row:t,col:n,sparkline:this.sCt(t,n),newSparkline:e},this.Mf.Ut.aCt(12,i)),e?this.cE[t+"_"+n]=e:delete this.cE[t+"_"+n]},k.prototype.sCt=function(t,n){return this.cE[t+"_"+n]||T},k.prototype.groups=function(t){if(0===arguments.length)return this.QMt;this.QMt=t},k.prototype.add=function(t){var n=this;n.Mf.Ut.aCt(13,t),n.groups().push(t),t.RB=n,t.TCt(),n.hCt(t)},k.prototype.hCt=function(t){var n=this;n.ACt(t),t.all().forEach(function(t){n.fCt(t)})},k.prototype.remove=function(t){var n=this;n.Mf.Ut.aCt(14,t),g(n.groups(),t),n.lCt(t)},k.prototype.lCt=function(t){var n=this;n.ICt(t),t.all().forEach(function(t){n.cCt(t)})},k.prototype.contains=function(t){return P(this.groups(),t)},k.prototype.count=function(){return this.groups().length},k.prototype.JO=function(t,n){ot(this.QMt,t,n,!0,this),at(t,n,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.qO=function(t,n){ot(this.QMt,t,n,!1,this),at(t,n,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.xP=function(t,n){ft(this.QMt,t,n,!0,this),lt(t,n,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.NP=function(t,n){ft(this.QMt,t,n,!1,this),lt(t,n,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},k.prototype.CCt=function(n,e){this.JMt.forEach(function(t){t.dateAxisDataSheetName()===n&&t.dateAxisDataSheetName(e)}),this.KMt.forEach(function(t){t.dataSheetName()===n&&t.dataSheetName(e)})},k.prototype.fCt=function(t){var n,e,n,e,n=this.Mf,e=t.dataSheetName();e&&e!==n.name()&&(n=n.parent&&n.parent.getSheetFromName(e))&&(e=n.RB.KMt).indexOf(t)<0&&e.push(t)},k.prototype.cCt=function(t){var n,n,n,t,n=t.dataSheetName();n&&(n=this.Mf.parent.getSheetFromName(n))&&0<=(t=(n=n.RB.KMt).indexOf(t))&&n.splice(t,1)},k.prototype.ACt=function(t){var n,e,n,e,n=this.Mf,e=t.dateAxisDataSheetName();e&&e!==n.name()&&(n=n.parent.getSheetFromName(e))&&(e=n.RB.JMt).indexOf(t)<0&&e.push(t)},k.prototype.ICt=function(t){var n,n,n,t,n=t.dateAxisDataSheetName();n&&(n=this.Mf.parent.getSheetFromName(n))&&0<=(t=(n=n.RB.JMt).indexOf(t))&&n.splice(t,1)},k.prototype.clear=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,r=this;if(0===arguments.length){for(o=r.QMt,a=M(o)-1;-1<a;a--)if(u=o[a]){for(s=u.count()-1;-1<s;s--)c=u.XMt[s],r._K(c.row,c.column,T),u.remove(c);r.remove(u)}}else for(f=t;f<t+e;f++)for(l=n;l<n+i;l++)(h=r.Hq(f,l))&&(r._K(h.row,h.column,T),(d=h.group()).remove(h),0===d.count())&&r.remove(d)},k.prototype.Hq=function(t,n){for(var e,i,r,o,a,e=this.QMt,i=0;i<e.length;i++)for(r=e[i],o=0;o<r.count();o++)if((a=r.XMt[o])&&a.row===t&&a.column===n)return a;return T},k.prototype.tE=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,S,T,T,s=this,c=s.Mf;if(c){for(f=new A.Rf,l=e-t,h=i-n,m=c.getRowCount(),g=c.getColumnCount(),w=r,y=o,M=c.RB,C=!u&&c.o5(),p=d=0;d<r&&e+d<m;d++)if(C&&0===c.getRowHeight(e+d))r++;else{if(!(a&&c.XT&&c.XT(e+d)))for(b=v=0,o=y;v<o&&i+v<g;v++)C&&0===c.getColumnWidth(i+v)?o++:((S=c.getSparkline(t+p,n+b))&&((S=S.clone()).row=e+d,S.column=i+v,I(S.dateAxisData())&&S.dateAxisData(S.group().qMt),T=S.dateAxisData(),C&&(l=e-t+d-p,h=i-n+v-b),!I(T)&&s.xCt(T,l,h,m,g)&&I(S.group().customName)&&S.dateAxisData(T.offset(h,l)),I(S.data())&&S.data(S.gI),T=S.data(),!I(T)&&s.xCt(T,l,h,m,g)&&I(S.gI)&&S.data(T.offset(h,l)),s.add(S.group()),f.set(d,v,S)),b++);p++}for(d=0,r=w;d<r&&e+d<m;d++)if(C&&0===c.getRowHeight(e+d))r++;else if(!(a&&c.XT&&c.XT(e+d)))for(v=0,o=y;v<o&&i+v<g;v++)C&&0===c.getColumnWidth(i+v)?o++:M._K(e+d,i+v,f.get(d,v))}},k.prototype.xCt=function(t,n,e,i,r){var t,o,a,u,t,t=this.NCt(t);return!(!t||(o=S(t.row,0),a=S(t.col,0),u=t.row<0?i:t.rowCount,t=t.col<0?r:t.colCount,o+n<0)||a+e<0||i<o+u+n||r<a+t+e)},k.prototype.iE=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,a=this.Mf;if(a){for(c=a.o5(),f=o,l=r,this.kCt(t,n,e,i,r,o),h=a.RB,d=new A.Rf,g=a.getRowCount(),p=a.getColumnCount(),u=v=0;v<r&&v+e<g;v++)if(c&&0===a.getRowHeight(e+v))r++;else{for(s=m=0,o=f;m<o&&i+m<p;m++)c&&0===a.getColumnWidth(i+m)?o++:((b=a.getSparkline(t+u,n+s))&&(b.row=e+v,b.column=i+m,d.set(u,s,b)),h._K(t+u,n+s,T),s++);u++}for(u=v=0,r=l;v<r&&v+e<g;v++)if(c&&0===a.getRowHeight(e+v))r++;else{for(s=m=0,o=f;m<o&&i+m<p;m++)c&&0===a.getColumnWidth(i+m)?o++:(a.removeSparkline(e+v,i+m),h._K(e+v,i+m,d.get(u,s)),s++);u++}}},k.prototype.kCt=function(t,n,e,i,r,o,a){var u,s,a,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,u=this,a=(s=(u=a?a:u).Mf).o5(),c=x(t,n,r,o),h=o,p=s.getRowCount(),b=s.getColumnCount(),w=u.QMt;if(a)for(g=v=0;v<r&&v+e<p;v++)if(0===s.getRowHeight(e+v))r++;else{for(m=d=0,o=h;d<o&&d+i<b;d++)if(0===s.getColumnWidth(i+d))o++;else{if(y=s.getSparkline(t+g,n+m))for(f=e-t+v-g,l=i-n+d-m,C=(M=y.rCt).XMt,S=0;S<C.length;S++)(T=C[S])&&u.DCt(T,f,l,c);m++}g++}else for(f=e-t,l=i-n,S=0;S<w.length;S++)for(C=(A=w[S]).XMt,I=0;I<C.length;I++)(y=C[I])&&u.DCt(y,f,l,c)},k.prototype.DCt=function(t,n,e,i){var r,o,a,a,o,r=this;I(t.dateAxisData())&&t.dateAxisData(t.group().qMt),o=t.dateAxisData(),(a=r.NCt(o))&&i.containsRange(a)&&i.contains(t.row,t.column)&&t.dateAxisData(o.offset(e,n)),I(t.data())&&t.data(t.gI),a=t.data(),(o=r.NCt(a))&&i.containsRange(o)&&i.contains(t.row,t.column)&&t.data(a.offset(e,n))},k.prototype.NCt=function(t){return t},k.prototype.LB=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,m,g,p,b,w,y,M,C,C,S,S,c=this,f=c.Mf;if(f)if(t===f)c.tE(n,e,i,r,o,a);else for(l=i-n,h=r-e,d=f.RB,v=!s&&f.o5(),m=f.getRowCount(),g=f.getColumnCount(),p=a,y=b=0;b<o&&i+b<m;b++)if(v&&0===f.getRowHeight(i+b))o++;else{if(!(u&&f.XT&&f.XT(i+b)))for(M=w=0,a=p;w<a&&r+w<g;w++)v&&0===f.getColumnWidth(r+w)?a++:((C=t.getSparkline(n+y,e+M))?((C=C.clone()).row=i+b,C.column=r+w,I(C.dateAxisData())&&C.dateAxisData(C.group().qMt),S=C.dateAxisData(),v&&(l=i+b-n-y,h=r-e+w-M),!I(S)&&c.xCt(S,l,h,m,g)&&C.dateAxisData(S.offset(h,l)),I(C.data())&&C.data(C.gI),S=C.data(),!I(S)&&c.xCt(S,l,h,m,g)&&C.data(S.offset(h,l)),c.add(C.group()),d._K(i+b,r+w,C)):d._K(i+b,r+w,T),M++);y++}},k.prototype.BB=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,u=this,s=u.Mf;if(s)if(t===s)u.iE(n,e,i,r,o,a);else for(c=s.o5(),f=a,l=t.RB,h=s.RB,p=s.getRowCount(),b=s.getColumnCount(),u._Ct(t,n,e,i,r,o,a),m=d=0;d<o&&i+d<p;d++)if(c&&0===s.getRowHeight(i+d))o++;else for(g=v=0,a=f;v<a&&r+v<b;v++)c&&0===s.getColumnWidth(r+v)?a++:((w=t.getSparkline(n+0,e+0))?(w.row=i+d,w.column=r+v,M=(y=w.group()).clone(),y.remove(w),y.count()<=0&&l.remove(y),M.add(w),u.add(M),h._K(i+d,r+v,w)):h._K(i+d,r+v,T),l._K(n+0,e+0,T))},k.prototype._Ct=function(t,n,e,i,r,o,a){var u,s,u=this,s=u.Mf;t&&s&&u.kCt(n,e,i,r,o,a,t.RB)},k.prototype.toJSON=function(){for(var t,n,e,t=this.QMt,n=[],e=0;t&&e<t.length;e++)n.push(t[e].toJSON());return 0===n.length?C:n},k.prototype.wh=function(){for(var t,n,e,i,r,t=this.QMt,n={n_:"sparklineGroups",c_:[],r_:[2]},e=0;t&&e<t.length;e++)r=(i=t[e]).wh(),n.c_.push(r);return n},k.prototype.fromJSON=function(t,n){var e,i,r;for(this.QMt.length=0,this.cE={},e=0;t&&e<t.length;e++)i=t[e],(r=new y).fromJSON(i,n),this.add(r)},k.prototype.yh=function(t,n){var e,i,r;for(this.QMt.length=0,this.cE={},e=0;t&&e<t.length;e++)i=t[e],(r=new y).yh(i,n),this.add(r)},W=k,(n=Q=t.EmptyValueStyle||(t.EmptyValueStyle={}))[n.gaps=0]="gaps",n[n.zero=1]="zero",n[n.connect=2]="connect",(l=J=t.SparklineAxisMinMax||(t.SparklineAxisMinMax={}))[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",n=s.Common.ft.j(255,149,179,215),l=s.Common.ft.j(255,36,64,98),b={axisColor:"black",firstMarkerColor:n,highMarkerColor:"Blue",lastMarkerColor:n,lowMarkerColor:"Blue",markersColor:l,negativeColor:"Brown",seriesColor:l,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},j.prototype.clone=function(){return new j(this.options)},j.prototype.toJSON=function(){var t,n,e,i,t,n=this.options,e={};for(i in n)b[i]!==n[i]&&(e[i]=n[i]);return f(e)?C:e},w=j,t.SparklineSetting=w,(n=K=t.SparklineType||(t.SparklineType={}))[n.line=0]="line",n[n.column=1]="column",n[n.winloss=2]="winloss",(l=X=t.DataOrientation||(t.DataOrientation={}))[l.vertical=0]="vertical",l[l.horizontal=1]="horizontal",O.prototype.tCt=function(){var t=this,n;return n=t.RB?t.RB.Mf:n},O.prototype.ECt=function(){var t,n,t,t=this,n=t.tCt();n&&n.Ut.G8&&(t={group:t,innerList:t.XMt.concat()},n.Ut.aCt(10,t))},O.prototype.add=function(t){var n,e,n=this;t&&(n.ECt(),n.XMt.push(t),t.group(n),n.TCt(),(e=n.RB)&&e.fCt(t),n.onGroupChanged())},O.prototype.clear=function(){this.ECt();var n=this.RB;n&&this.XMt.forEach(function(t){n.cCt(t)}),this.XMt=[]},O.prototype.all=function(){return this.XMt},O.prototype.remove=function(t){var n,e,i,n=this,e=n.XMt;return n.ECt(),g(e,t),t.onSparklineChanged(),t.rCt=n.clone(),n.TCt(),(i=n.RB)&&i.cCt(t),n.onGroupChanged(),e},O.prototype.contains=function(t){return P(this.XMt,t)},O.prototype.onGroupChanged=function(){var t,n,e,t=this.XMt;if(t)for(n=0;n<t.length;n++)(e=t[n])&&e.onSparklineChanged()},O.prototype.clone=function(){var t,n,n,t=this,n=t.setting?t.setting.clone():T,n=new O(t.sparklineType,n);return n.displayDateAxis=t.displayDateAxis,n.qMt=t.qMt,n.nCt=t.nCt,n.jCt=t.jCt,n.eCt=t.eCt,n},O.prototype.dateAxisData=function(t){var n,e,i,i,i,r,i,r,i,o,a,n=this;if(I(n.qMt)||n.OCt(),0===arguments.length)return n.nCt;if((e=n.tCt())&&e.Ut.G8){if("string"==typeof t){if(i=e.getCustomName(t)||e.parent.getCustomName(t),I(i))return n.nCt;i=p.formulaToRanges(e,p.expressionToFormula(e,i.getExpression()),0,0,1===n.tCt().parent.options.referenceStyle),n.qMt=t,r=(i=R(i)).ranges,i=i.sheetName,t=r,n.jCt=i}i=r=void 0,r=n.nCt?{row:n.nCt.row,col:n.nCt.col,rowCount:n.nCt.rowCount,colCount:n.nCt.colCount}:T,i=t?{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}:T,e.Ut.aCt(8,o={group:n,rangeInfo:r,newRangeInfo:i})}(a=n.nCt)!==(n.nCt=t)&&n.onGroupChanged()},O.prototype.OCt=function(){var t,n,n,e,n,t=this;I(t.tCt())||(n=dt(t.tCt(),t.qMt),I(n))||(e=(n=R(n)).ranges,n=n.sheetName,t.nCt=e,t.jCt=n)},O.prototype.dateAxisDataSheetName=function(t){var n,e,i,r,n=this;return 0===arguments.length?n.jCt:(e=n.jCt,(i=n.tCt())&&i.Ut.G8&&i.Ut.aCt(16,r={group:n,dateAxisDataSheetName:e,newDateAxisDataSheetName:t}),e!==t&&(e&&i&&i.RB.ICt(n),(n.jCt=t)&&i&&i.RB.ACt(n),n.onGroupChanged()),n)},O.prototype.dateAxisOrientation=function(t){var n,e,i,r,n=this;if(0===arguments.length)return n.eCt;(e=n.tCt())&&e.Ut.G8&&(i={group:n,dateAxisOrientation:n.eCt,newDateAxisOrientation:t},e.Ut.aCt(9,i)),(r=n.eCt)!==(n.eCt=t)&&n.onGroupChanged()},O.prototype.count=function(){return this.XMt.length},O.prototype.TCt=function(){var t,n,e,i,r,o,a,u,u,s,u,t=this,n=t.setting,e=t.XMt;if(n&&((i=n.options).groupMaxValue=-h,i.groupMinValue=h,r=1===i.maxAxisType,o=1===i.minAxisType,r||o))for(a=0;a<e.length;a++)u=e[a],s=(u=t.RCt(u)).min,u=u.max,r&&i.groupMaxValue<u&&(i.groupMaxValue=u),o&&i.groupMinValue>s&&(i.groupMinValue=s)},O.prototype.RCt=function(t){var n,e,i,r,o,a,u,s,c,n=-h,e=h;if(I(t.data())&&t.data(t.gI),i=t.data())for(o=(r=t.Tp())&&r.parent.getSheetFromName(t.dataSheetName()),a=t.BCt(i,t.dataOrientation(),!1,o||r),u=0;u<a.length;u++)"number"==typeof(s=(s=a[u])===G?0:s)&&(n=n<s?s:n,e=s<e?s:e);return{min:e,max:n}},O.prototype.toJSON=function(){var t,n,e,i,r,o,a,t=this,n={setting:t.setting?t.setting.toJSON():T,displayDateAxis:t.displayDateAxis,sparklineType:t.sparklineType,axisOrientation:t.eCt,sparklines:t.XMt.map(function(t){return t.toJSON()})},e=t.nCt,i=t.qMt;for(o in i?n.axisReference=i:e&&(n.axisReference={row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount,sheetName:t.jCt}),r={},n)!n.hasOwnProperty(o)||ht(o,a=n[o])||(r[o]=a);return f(r)?C:r},O.prototype.wh=function(){var t,n,e,i,i,e,t={n_:"sparklineGroup"},n=this,e=n.tCt();return I(n.sparklineType)||(t.type=d[n.sparklineType]),n.displayDateAxis&&(t.dateAxis="1"),i=n.setting.options,!I(i.lineWeight)&&.001<3*i.lineWeight.toString()/4-.75&&(t.lineWeight=3*i.lineWeight.toString()/4),i.displayEmptyCellsAs?t.displayEmptyCellsAs=v[i.displayEmptyCellsAs]:t.displayEmptyCellsAs=v[0],i.showMarkers&&(t.markers="1"),i.showHigh&&(t.high="1"),i.showLow&&(t.low="1"),i.showFirst&&(t.first="1"),i.showLast&&(t.last="1"),i.showNegative&&(t.negative="1"),i.displayXAxis&&(t.displayXAxis="1"),i.displayHidden&&(t.displayHidden="1"),i.rightToLeft&&(t.rightToLeft="1"),i.minAxisType&&(t.minAxisType=m[i.minAxisType]),i.maxAxisType&&(t.maxAxisType=m[i.maxAxisType]),i.manualMin&&(t.manualMin=i.manualMin),i.manualMax&&(t.manualMax=i.manualMax),t.c_=[o(i.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),o(i.negativeColor||"brown",!1,"colorNegative"),o(i.axisColor||"black",!1,"colorAxis"),o(i.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),o(i.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),o(i.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),o(i.highMarkerColor||"blue",!1,"colorHigh"),o(i.lowMarkerColor||"blue",!1,"colorLow")],(i=n.nCt)&&t.c_.push({n_:"f",c_:[(n.jCt?(0,A.i2e)(n.jCt):e.name())+"!"+c([x(i.row,i.col,i.rowCount,i.colCount)])]}),e={n_:"sparklines",c_:n.XMt.map(function(t){return t.wh()})},t.c_.push(e),t},O.prototype.fromJSON=function(t,n){var e,i,r,o,a,u,s,c,f;if(t&&(i=t.displayDateAxis,r=t.sparklineType,o=t.axisReference,a=t.axisOrientation,u=t.sparklines,(e=this).setting=new w(t.setting),I(i)||(e.displayDateAxis=i),I(r)||(e.sparklineType=r),I(o)||("string"==typeof o?e.qMt=o:(e.nCt=x(o.row,o.col,o.rowCount,o.colCount),e.jCt=o.sheetName)),I(a)||(e.eCt=a),u))for(e.XMt=[],s=0,c=u.length;s<c;s++)(f=new N).fromJSON(u[s]),e.add(f)},O.prototype.yh=function(t,e){var i,n,n,r,n,r,n,r,n,r,i=this,n=i.LCt(t);i.setting=new w(n),n="1"===t.dateAxis,r=d[t.type]||0,I(n)||(i.displayDateAxis=n),I(r)||(i.sparklineType=r),(n=a(t,"f"))&&(n=(r=n.c_&&n.c_[0])&&$(r))&&(r=u(n[1])[0]||T,I(r)||(i.nCt=x(r.row,r.col,r.rowCount,r.colCount)),n=1===r.rowCount?1:0,I(n)||(i.eCt=n)),(r=a(t,"sparklines"))&&(i.XMt=[],r.c_.forEach(function(t){var n=new N;n.yh(t,e),i.add(n)}))},O.prototype.LCt=function(t){var n={};return I(t.manualMax)||(n.manualMax=e(t.manualMax,0)),I(t.manualMin)||(n.manualMin=e(t.manualMin,0)),I(t.lineWeight)||(n.lineWeight=4*e(t.lineWeight,1)/3),I(t.displayEmptyCellsAs)||(n.displayEmptyCellsAs=v[t.displayEmptyCellsAs]||0),I(t.markers)||(n.showMarkers=i(t.markers,!1)),I(t.high)||(n.showHigh=i(t.high,!1)),I(t.low)||(n.showLow=i(t.low,!1)),I(t.first)||(n.showFirst=i(t.first,!1)),I(t.last)||(n.showLast=i(t.last,!1)),I(t.negative)||(n.showNegative=i(t.negative,!1)),I(t.displayXAxis)||(n.displayXAxis=i(t.displayXAxis,!1)),I(t.displayHidden)||(n.displayHidden=i(t.displayHidden,!1)),I(t.rightToLeft)||(n.rightToLeft=i(t.rightToLeft,!1)),I(t.minAxisType)||(n.minAxisType=m[t.minAxisType]||0),I(t.maxAxisType)||(n.maxAxisType=m[t.maxAxisType]||0),t.c_.forEach(function(t){"colorSeries"===t.n_&&(n.seriesColor=r(t)||"rgba(36,64,98,255)"),"colorNegative"===t.n_&&(n.negativeColor=r(t)||"Brown"),"colorAxis"===t.n_&&(n.axisColor=r(t)||"Black"),"colorMarkers"===t.n_&&(n.markersColor=r(t)||"rgba(36,64,98,255)"),"colorFirst"===t.n_&&(n.firstMarkerColor=r(t)||"rgba(149,179,215,255)"),"colorLast"===t.n_&&(n.lastMarkerColor=r(t)||"rgba(149,179,215,255)"),"colorHigh"===t.n_&&(n.highMarkerColor=r(t)||"Blue"),"colorLow"===t.n_&&(n.lowMarkerColor=r(t)||"Blue")}),n},y=O,E.prototype.group=function(t){var n,e,e,i,r,n=this;return 0===arguments.length?((e=n.rCt)||((e=new y).add(n),n.rCt=e),e):(e=n.rCt,(i=n.Tp())&&i.Ut.G8&&(r={row:n.row,col:n.column,group:e,newGroup:t},i.Ut.aCt(11,r)),t!==e&&(e&&e.remove(n),(n.rCt=t)&&!t.contains(n)&&t.add(n),n.onSparklineChanged()),i&&i.zw(),n)},E.prototype.sparklineType=function(t){var n,e,i,e,i,n=this;return 0===arguments.length?n.group().sparklineType:((i=(e=n.group()).sparklineType)!==t&&(e.sparklineType=t,(e=n.Tp())&&e.Ut.G8&&(i={row:n.row,col:n.column,sparklineType:i,newSparklineType:t},e.Ut.aCt(3,i)),n.onSparklineChanged(),e)&&e.zw(),n)},E.prototype.onSparklineChanged=function(){var t,n,t=this,n=t.Tp();n&&n.ki(A.Events.SparklineChanged,{sheet:n,sheetName:n.name(),sparkline:t})},E.prototype.setting=function(t){var n,e,i,r,o,r,n=this,e=n.group(),i=n.Tp(),r=i&&i.Ut.G8;return 0===arguments.length?(o=void 0,r?A.GC$.extend(!0,{},e.setting):e.setting):(r&&(r={row:n.row,col:n.column,setting:A.GC$.extend(!0,{},e.setting),newSetting:A.GC$.extend(!0,{},t)},i.Ut.aCt(4,r)),e.setting=t,i&&i.zw(),n)},E.prototype.data=function(t){var n,e,i,r,i,r,i,r,n=this;if(I(n.gI)||n.FCt(),e=n.Tp(),0===arguments.length)return I(n.gI)?n._data:I(e)||(i=e.getCustomName(n.gI)||e.parent.getCustomName(n.gI),I(i))?[]:((r=p.formulaToRanges(e,p.expressionToFormula(e,i.getExpression()),n.row,n.column,1===e.parent.options.referenceStyle))[0]&&n._data!==r[0].ranges&&(n._data=r[0].ranges,n.onSparklineChanged()),n._data);if("string"==typeof t){if(n.gI=t,!e)return n;if(i=e.getCustomName(t)||e.parent.getCustomName(t),r=void 0,I(i))return n;r=(i=R(r=p.formulaToRanges(e,p.expressionToFormula(e,i.getExpression()),n.row,n.column,1===e.parent.options.referenceStyle))).ranges,i=i.sheetName,t=r,n.ZY=i}return e&&e.Ut.G8&&(r={row:n.row,col:n.column,sparkline:n,data:A.GC$.extend(!0,{},n._data),newData:A.GC$.extend(!0,{},t)},e.Ut.aCt(5,r)),n._data!==t&&(n._data=t,n.onSparklineChanged()),e&&e.zw(),n},E.prototype.dataSheetName=function(t){var n,e,i,r,n,e=this;return 0===arguments.length?e.ZY:(i=e.ZY,(r=e.Tp())&&(null==(n=r.name)?void 0:n.call(r))===t||(r&&r.Ut.G8&&(n={row:e.row,col:e.column,dataSheetName:i,newDataSheetName:t},r.Ut.aCt(15,n)),i!==t&&(i&&r&&r.RB.cCt(e),(e.ZY=t)&&r&&r.RB.fCt(e),e.onSparklineChanged())),e)},E.prototype.dataOrientation=function(t){var n,e,i,n=this;return 0===arguments.length?n.iCt:((e=n.Tp())&&e.Ut.G8&&(i={row:n.row,col:n.column,dataOrientation:n.iCt,newDataOrientation:t},e.Ut.aCt(6,i)),n.iCt!==t&&(n.iCt=t,n.onSparklineChanged()),e&&e.zw(),n)},E.prototype.dateAxisData=function(t){var n=this,e=n.group();return 0===arguments.length?(I(e.dateAxisData())&&e.dateAxisData(e.qMt),e.dateAxisData()):(e.dateAxisData(t),n)},E.prototype.dateAxisDataSheetName=function(t){var n=this,e=n.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(t),n)},E.prototype.dateAxisOrientation=function(t){var n=this,e=n.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(t),n)},E.prototype.displayDateAxis=function(t){var n,e,i,r,n=this,e=n.group();return 0===arguments.length?e.displayDateAxis:((i=n.Tp())&&i.Ut.G8&&(r={row:n.row,col:n.column,displayDateAxis:e.displayDateAxis,newDisplayDateAxis:t},i.Ut.aCt(7,r)),e.displayDateAxis=t,n)},E.prototype.clone=function(){var t,n,t=this,n=new E;return n.row=t.row,n.column=t.column,I(t.gI)?n.data(t.data()):n.gI=t.gI,n.dataSheetName(t.dataSheetName()),n.dataOrientation(t.dataOrientation()),n.group(t.group().clone()),n},E.prototype.paintSparkline=function(t,n,e,i,r){var o,a,u,s,c,f,c,o=this,a=o.Tp();this.XY&&(a=this.XY),I(o.data())&&o.data(o.gI),I(o.dateAxisData())&&o.dateAxisData(o.group().qMt),c=o.PCt(!0),f=o.PCt(!1),c={sparklineType:o.sparklineType(),displayDateAxis:o.displayDateAxis(),zoomFactor:a.zoom(),values:c,dateValues:f,settings:o.setting(),getColor:function(t){if(a&&t){var n=A.Pf.vl(a,t);if(n)return n}return t}},(new U).paint(t,c,n,e,i,r)},E.prototype.PCt=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=this,e=[],i=t?n.dataSheetName():n.dateAxisDataSheetName(),r=t?n.WY:n.KY,o=t?n.dataOrientation():n.dateAxisOrientation(),a=t?n.data():n.dateAxisData(),s=n.Tp();if(this.XY&&(s=this.XY),r)e=r;else if("string"==typeof i)c=n.GCt(s,i),e=n.BCt(a,o,!t,c||s);else if("object"==typeof i)for(f=i,l=0;l<f.length;l++)c=n.GCt(s,f[l]),h=n.BCt(a[l],o,!t,c||s),e=e.concat(h);else I(i)&&(e=n.BCt(a,o,!t,s));return e},E.prototype.GCt=function(t,n){var e,t,i=/^\[\d+\].+/g,e=t.parent.getSheetFromName(n),t=t.parent._p;return e=i.test(n)&&t?t.parseSource(n,!0):e},E.prototype.QY=function(t){var n=this;return I(n.data())&&n.data(n.gI),n.BCt(n.data(),n.dataOrientation(),!1,t)},E.prototype.JY=function(t){var n=this;return I(n.dateAxisData())&&n.dateAxisData(n.group().qMt),n.BCt(n.dateAxisData(),n.dateAxisOrientation(),!0,t)},E.prototype.BCt=function(t,n,e,i){var r,o=this.setting().options.displayHidden;return E.EMt(C,i,o,t,n,e)},E.prototype.Tp=function(){var t=this.group(),t=t&&t.RB;return t?t.Mf:T},E.prototype.toJSON=function(){var t,n,t=this,n=I(t.gI)?{row:t._data.row,rowCount:t._data.rowCount,col:t._data.col,colCount:t._data.colCount,sheetName:t.ZY}:t.gI;return{row:t.row,col:t.column,orientation:t.iCt,data:n}},E.prototype.wh=function(){var t,n,e,n,i,t=this,n=t.Tp(),e=t._data,n=I(t.gI)?(i=(0,A.i2e)(t.ZY||n.name()))+"!"+c([x(e.row,e.col,e.rowCount,e.colCount)]):t.gI;return{n_:"sparkline",c_:[{n_:"f",c_:[V(n)]},{n_:"sqref",c_:[c([x(t.row,t.column,1,1)])]}],lossless:{iCt:t.iCt}}},E.prototype.fromJSON=function(t){var n,e,i,r,t,e;t&&(n=this,e=t.row,i=t.col,r=t.orientation,t=t.data,I(e)||(n.row=e),I(i)||(n.column=i),I(r)||(n.iCt=r),t)&&("string"==typeof t?n.gI=t:(n._data=x((e=t).row,e.col,e.rowCount,e.colCount),n.ZY=e.sheetName))},E.prototype.yh=function(t,n){var e,i,r,o,n,e=this,n=A.Util.ko(n)?void 0:1;t.c_.forEach(function(t){"f"===t.n_&&(1===(o=$(z(t.c_[0]))).length?e.gI=o[0]:i=u(o[1])[0]||T),"sqref"===t.n_&&(r=u(t.c_[0])[0]||T)}),I(r)||(I(r.row)||(e.row=r.row),I(r.col)||(e.column=r.col),i&&(n=1===i.rowCount?1:0,e._data=x(i.row,i.col,i.rowCount,i.colCount),e.ZY=o[0])),I(n)||(e.iCt=n),t.lossless&&(e.iCt=t.lossless.iCt)},E.prototype.FCt=function(){var t,n,n,e,n,t=this;I(t.Tp())||(n=dt(t.Tp(),t.gI),I(n))||(e=(n=R(n)).ranges,n=n.sheetName,t._data=e,t.ZY=n)},E.EMt=function(t,n,e,i,r,o){var a,u,a=[];if(!I(i)){if(!(i instanceof Array))return E.UCt(t,n,e,i,r,o);for(u=0;u<i.length;u++)a.push.apply(a,E.UCt(t,n,e,i[u],r,o,!0))}return a},E.UCt=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m;if(0<(null==t?void 0:t.length)&&!Array.isArray(t[0]))return t;if(u=[],s=1===r,n&&i)for(c=0,f=a?s?i.rowCount:i.colCount:1;c<f;c++)for(l=0,h=s?i.colCount:i.rowCount;l<h;l++)d=s?c:l,v=s?l:c,m=t?t[d][v]:n.getValue(i.row+d,i.col+v),m=E.HCt(n,m,i,d,v,e,o),u.push(m);return u},E.HCt=function(t,n,e,i,r,o,a){var u="number";return n instanceof L.CalcError?C:(!o&&t.getRowHeight&&(t.getRowHeight(e.row+i)<=0||t.getColumnWidth(e.col+r)<=0)?n=NaN:I(n)||(a?n=typeof n==u?s.Common.ct.Y0(n):Date.parse(n):typeof n!=u&&(n=G)),n)},N=E,t.Sparkline=N},"./dist/plugins/statusBar/baseStatusBar.js":function(t,n,e){"use strict";var i,r,o,a,l,u,h,s;function c(t){this.zCt=[],this.VCt=[],this.YCt=[],this.lp=0,this.Ti=l,this.TW=t,this.ZCt()}Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStatusBar=void 0,i=e("Core"),r=e("./dist/plugins/statusBar/statusItem.js"),o=i.GC$,a="statusItem",l=null,u="left",h="right",c.prototype.ZCt=function(){var t=this.Ti,n=this.WCt;t||(t=this.Ti=document.createElement("div"),n=this.WCt=document.createElement("div")),this.TW.appendChild(t),this.TW.appendChild(n)},c.prototype.QCt=function(t){t.name||(t.name=a+this.lp,this.lp++)},c.prototype.dU=function(t,n){return t instanceof r.StatusItem&&!this.q_(t.name)&&(this.QCt(t),0<=n&&n<this.zCt.length?this.zCt.splice(n,0,t):this.zCt.push(t),t.align=t.align||u,t.KCt(this.TW),!0)},c.prototype.JCt=function(n,t){var e,i,r,o,a,r,u,s,c,f,e=!1,i=this.zCt,r=0<=t&&t<i.length,o=l,a=l;if(r&&(a=(o=i[t]).XCt()),this.dU(n,t)){r=n.align===h;try{(r?(s=(u=this.YCt).indexOf(o),f=(c=u.length)-1,a&&0<=s&&s<f?a=u[s+1].XCt():a===l?a=u[0].XCt():(a&&s<0||s===f)&&(a=l),this.YCt):this.VCt).push(n),this.Ti.insertBefore(n.XCt(),a),this.DJ&&n.onBind(this.DJ),e=!0}catch(t){r?this.YCt.splice(this.YCt.indexOf(n),1):this.VCt.splice(this.VCt.indexOf(n),1),this.zCt.splice(this.zCt.indexOf(n),1)}}return e},c.prototype.qCt=function(t){for(var n=this.zCt,e=!1,i,r,i=0;i<n.length;i++)if(t===(r=n[i]).name){e=!0;break}return!!e&&(r.onUnbind(),r.align===h?this.YCt.splice(this.YCt.indexOf(r),1):this.VCt.splice(this.VCt.indexOf(r),1),this.zCt.splice(i,1),this.Ti.removeChild(r.XCt()),!0)},c.prototype.q_=function(t){for(var n=this.zCt,e,i,e=0;e<n.length;e++)if(t===(i=n[e]).name)return i;return l},c.prototype.$Ct=function(n){this.DJ=n,this.zCt.forEach(function(t){t.onBind(n),t.onUpdate()})},c.prototype.Yoe=function(){this.zCt.forEach(function(t){t.Zoe()})},c.prototype.c5=function(){this.VCt=[],this.YCt=[],o(this.Ti).empty()},c.prototype.t3t=function(){var n=this,e=this.Ti,i=u,r;this.c5(),this.zCt.forEach(function(t){i=t.align,((r=t.XCt()).style.float=i)===h?n.YCt.unshift(t):(n.VCt.unshift(t),e.appendChild(r))}),this.YCt.forEach(function(t){e.appendChild(t.XCt())})},c.prototype.n3t=function(){this.zCt.forEach(function(t){t.onUpdate()}),this.t3t()},c.prototype.e3t=function(){var n=[];return this.zCt.forEach(function(t){n.push(t.i3t())}),n},c.prototype.r3t=function(t){for(var n=this.zCt,e=t.name,i,r,i=0;i<n.length;i++)if((r=n[i]).name===e){r.r3t(t);break}},c.prototype.o3t=function(){return this.zCt},c.prototype.a3t=function(){var t,n=this.zCt,e,i;for(this.DJ=l,e=0;e<n.length;e++)(i=n[e]).onUnbind()},c.prototype.L0=function(){var t=this,n=t.zCt,e,i;if(this.Ti){for(e=0;e<n.length;e++)i=n[e],t.Ti.removeChild(i.u3t),i.onDispose();this.Ti.parentElement&&this.Ti.parentElement.removeChild(this.Ti),this.WCt.parentElement&&this.WCt.parentElement.removeChild(this.WCt),this.Ti=l,this.WCt=l}this.lp=l,this.zCt=l,this.VCt=l,this.YCt=l},n.BaseStatusBar=c},"./dist/plugins/statusBar/statusBar.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=n.StatusItem=n.StatusBar=void 0,o=e("Core"),a=e("./dist/plugins/statusBar/statusBar.js"),Object.defineProperty(n,"StatusBar",{enumerable:!0,get:function(){return a.StatusBar}}),u=e("./dist/plugins/statusBar/statusItem.js"),Object.defineProperty(n,"StatusItem",{enumerable:!0,get:function(){return u.StatusItem}}),r(e("./dist/plugins/statusBar/statusBar.ns.js"),n),n.findControl=s=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data("statusbar")}},"./dist/plugins/statusBar/statusBar.js":function(F,L,t){"use strict";var n,f,i,u,s,e,B,r,P,h,t,d,G,t,U,p,t,b,w,c,H,o,a,V,z,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,v,it,rt,ot,at,ut,st,ct,ft,lt,m,ht,g,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,l,Et,y,Rt,Ft,Lt,Bt,M,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,C,S,Xt,qt,a,T,$t,A,tn,nn,en,rn,on,an,un,I,sn,cn,fn,ln;function x(t,n){var e=i.Common.CultureManager.Fe().NumberFormat.listSeparator;return Kt+Zt+t+e+n+Wt}function hn(t,n){t.splice(n,1)}function dn(t,n){var e,i,r,o,e=n,i=n.length,r=[];if(1<i){for(r.push(n[0]),o=1;o<i;o++)r=vn(t,n[o],r);return r}return e}function vn(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=t.getRowCount(3),r=t.getColumnCount(3),o=[],a=[];for(o.push(n),f=e.length,l=0;l<f;l++)for(u=e[l],h=0;h<o.length;)(c=(s=o[h]).getIntersect(u,i,r))?(a=t.BR(s,c,i,r),hn(o,h),o=a.concat(o),h+=a.length):h++;return o.concat(e)}function mn(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,n=t.getActiveRowIndex(),e=t.getActiveColumnIndex(),i=t.getValue(n,e);if("number"!=typeof i)for(s=0,c=r=t.getSelections();s<c.length;s++)for(f=c[s],l=0,h=(f=t.JS(f)).rowCount;l<h;l++)for(d=0,v=f.colCount;d<v;d++)if(o=f.row+l,a=f.col+d,"number"==typeof(u=t.getValue(o,a)))return{row:o,col:a};return{row:n,col:e}}function gn(t,n,e){var i,i;return i=(i=t.l0(n,e,Qt))||t.l0(n,e,Jt)}function pn(t,n,e){var i;t&&t.parent&&t.parent.options.allowUserZoom&&(i={sheet:t,sheetName:t.name(),newZoomFactor:n,oldZoomFactor:e,cancel:!1},t.ki(f.Events.ViewZooming,i),!0!==i.cancel)&&(n=i.newZoomFactor)!==e&&t.Qy().execute({cmd:l,sheetName:t.name(),newZoomFactor:n,oldZoomFactor:e})}function bn(t){for(var n,e,t,i,t,n={top:t.offsetTop,left:t.offsetLeft},e=t.offsetParent;e;)n.top+=e.offsetTop,n.left+=e.offsetLeft,e=e.offsetParent;return i=(t=document.body).clientTop,t=t.clientLeft,isNaN(i)||(n.top+=i),isNaN(t)||(n.left+=t),n}function wn(t){return""!==t}function N(t,n){var t=un.call(this,t,n)||this;return t.s3t=M+t.name,t}function k(t,n){var t=I.call(this,t,n)||this;return t.c3t=": ",t.FJ=!1,t.vit=n.prefix,t.s3t=M+t.name,t.f3t=Number.MAX_VALUE,t}function _(t,n,e){var a=sn.call(this,n,e)||this;return a.min=25,a.max=400,a.middle=100,a.step=10,a.h3t=1,a.d3t=4,a.v3t=120,a.m3t=Math.round((a.v3t+a.h3t)/2),a.g3t=Math.round((a.v3t+a.d3t)/2),a.p3t=!1,a.Afe=function(t){a.p3t=!1},a.Ife=function(t){var n,e,t,i,e,r,o,n=a;n.p3t&&(e=a.P3t,t=t.pageX,i=bn(e).left,e=e.offsetWidth,r=n.d3t,n.H3t(o=i+e+r-t))},a.b3t=t,a.s3t=M+a.name,a}function D(t,n){var t=cn.call(this,t,n)||this;return t.s3t=M+t.name,t}function j(t,n){var t=fn.call(this,t,n)||this;return t.s3t=M+t.name,t.YC=120,t.y4=0,t}function yn(t,n,e){t.ki(f.Events.UserZooming,{sheet:t,sheetName:t.name(),oldZoomFactor:e,newZoomFactor:n}),t.ki(f.Events.ViewZoomed,{sheet:t,sheetName:t.name(),oldZoomFactor:e,newZoomFactor:n})}function Mn(t,n){(t.DJ=n).bind(f.Events.ActiveSheetChanged+t.s3t,function(){t.onUpdate()})}function Cn(t){var n,n;r.StatusItem.prototype.onUpdate.call(t),n=(n=(0,f.jf)(t.DJ))?n.zoom():1,t.Xe(n)}function Sn(t){t.DJ&&(t.DJ.unbind(f.Events.ActiveSheetChanged+t.s3t),t.DJ=w)}function O(t,n){var e,i;t&&(i=(e=this).y3t=new P.BaseStatusBar(t),e.w3t(i,n),e.Ti=i.Ti,this.WCt=i.WCt,e.M3t={},e.C3t(t),e.maxCalcCells=5e4,h(t).data("statusbar",e))}function Tn(){S&&Xt.call(this)}function E(t,n){var e=ln.call(this)||this;return e.Mf=t,e.S3t=n,e}function An(t){var t=t.b3t;t&&t.Yoe()}function R(t,n,e,i,r){var n,r,o,a;return e===c&&(e=0),i===c&&(i=0),n=s.formulaToExpression(t,n,e,i,r,!0),r=t.op(),e===c&&(e=t.getActiveRowIndex()),i===c&&(i=t.getActiveColumnIndex()),o=!0,a={sheetSource:t.Uw()},f.Worksheet.et(t,"getStatusBarSheetSource",a),r.evaluateParsedFormula(a.sheetSource,n,(0,u.eV)(e,i),!1,!0)}n=this&&this.__extends||(an=function(t,n){return(an=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}an(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(L,"__esModule",{value:!0}),L.StatusBar=void 0,f=t("Core"),i=t("Common"),u=t("CalcEngine"),s=t("SheetsCalc"),e=t("ContextMenu"),B=t("./dist/plugins/statusBar/statusBar.ns.js"),r=t("./dist/plugins/statusBar/statusItem.js"),P=t("./dist/plugins/statusBar/baseStatusBar.js"),h=f.GC$,t=f.mt,d=t.En,G=t.vi,t=i.Common.lt,U=i.Common.zf.I5,p=t.ht,t=f.Commands.ActionBase,b=u.Convert.BJ,w=null,c=void 0,H=h.inherit,V=(o="gc-statusbar-")+(a="slider-")+"btn",z=o+a+"add-btn",Y=o+a+"back-progress",Z=o+a+"back",W=o+a+"middle-line",Q=o+a+"drag-bar",J=o+"zoom-panel",K=o+a+"btn-container",X=o+a+"add-btn-container",q="gc-statusbar",$=o+"menu-host",tt="gc.spread.",nt="100",et="%",v="px",it="cellMode",ft="zoomSlider",lt="zoomPanel",m="div",ht="span",g="none",dt="inline",vt="inline-block",mt=15,gt=25,pt=400,wt=bt=100,Mt=1,Ct=4,St=120,Tt=.7,At=8,It=yt=10,xt=o+"progress-item-item-container",Nt=o+"progress-item-wrapper",kt=o+"progress-item-bar",_t=o+"progress-item-status",Dt=o+"progress-item-sheet-name",jt="progress",Ot="right",l="statusbarZoom",Et="statusBar",y="click",Rt="mousedown",Ft="mouseup",Lt="mousemove",Bt="contextmenu",M=".statusbar",Pt="invalidateLayout",Gt=101,Ut=103,Ht=102,Vt=105,zt=104,Yt=109,Zt="(",Wt=")",Qt="formatter",Jt="_autoFormatter",Kt="_SUBTOTALFORSTATUSBAR",C=[rt="average",ot="count",at="numericalCount",ut="min",st="max",ct="sum"],S=!!e,e&&(Xt=e.MenuView,qt=e.XX),a=new i.Common.ResourceManager(B.SR,"StatusBar"),T=a.getResource.bind(a),un=r.StatusItem,n(N,un),N.prototype.onBind=function(t){var e=this,i;(e.DJ=t).bind(f.Events.EditorStatusChanged+e.s3t,function(t,n){i=e.T3t(n.newStatus),e.A3t(i)}),t.bind(f.Events.ActiveSheetChanged+e.s3t,function(){e.onUpdate()})},N.prototype.onUpdate=function(){var t,t,t;un.prototype.onUpdate.call(this),(t=(0,f.jf)(this.DJ))&&(t=t.editorStatus(),t=this.T3t(t),this.A3t(t))},N.prototype.T3t=function(t){var n;switch(t){case 0:n=T().cellModeReady;break;case 1:n=T().cellModeEnter;break;case 2:n=T().cellModeEdit}return n},N.prototype.A3t=function(t){var t;t!==this.value&&(this.value=t,this.tipText=U(T().toolTipCellMode,[t]),t=this.I3t)&&(t.parentElement.title=this.tipText,p(this.value)||(t.innerText=this.value+""))},N.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(f.Events.EditorStatusChanged+this.s3t),this.DJ.unbind(f.Events.ActiveSheetChanged+this.s3t),this.DJ=w)},$t=N,I=r.StatusItem,n(k,I),k.prototype.Zoe=function(){this.l3t={}},k.prototype.onBind=function(t){var r=this;r.DJ=t,r.Zoe(),t.bind(f.Events.SelectionChanging+r.s3t,function(t,n){r.x9=n.newSelections,r.x3t(n)}),t.bind(f.Events.SelectionChanged+r.s3t,function(t,n){var e=r.x9||[],i=n.newSelections;JSON.stringify(e)!==JSON.stringify(i)&&r.x3t(n),r.x9=w}),t.bind(f.Events.ValueChanged+r.s3t,function(t,n){var e=n.sheet,i=n.row,n=n.col;e.ni(i,n)&&r.onUpdate()}),t.bind(f.Events.RangeChanged+r.s3t,function(){r.onUpdate()}),t.bind(f.Events.DragFillBlockCompleted+r.s3t,function(){r.onUpdate()}),t.bind(f.Events.ActiveSheetChanged+r.s3t,function(){r.onUpdate()}),t.bind(f.Events.EditEnded+r.s3t,function(){r.Zoe()}),t.bind(f.Events.TopRowChanged+r.s3t,function(){r.N3t(!0)}),t.bind(f.Events.ColumnWidthChanged+r.s3t,function(){r.N3t(!0)}),t.bind(f.Events.RowHeightChanged+r.s3t,function(){r.N3t(!0)}),t.bind(f.Events.RowChanged+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.ColumnChanged+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.RangeFiltered+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.TableFiltered+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.TableFilterCleared+r.s3t,function(){r.N3t(!1)}),t.bind(f.Events.RangeFilterCleared+r.s3t,function(){r.N3t(!1)})},k.prototype.N3t=function(t){this.FJ=t},k.prototype.k3t=function(t){var n,e,n=(0,f.jf)(this.DJ),e=0;return t.forEach(function(t){var t=n.JS(t);e+=t.rowCount*t.colCount}),e<this.f3t},k.prototype.x3t=function(t){var n,e,t,i,t,n=this,e=t.sheet,t=t.newSelections;n.k3t(t)?1===t.length&&1===t[0].rowCount&&1===t[0].colCount?(i=n.D3t(e,w),n.A3t(i[n.name])):""!==(t=n._3t(dn(e,t)))?(i=n.D3t(e,t),n.A3t(i[n.name])):p(n.value)&&n.E3t(!1):n.A3t(w)},k.prototype.D3t=function(t,n){var e,i,r,o,a,u,s,c,f,e,l,h,d,v,m,v,g,m,v,e,t,e=this,i=0,r=w,o=w,a=w,u=w,s=w;return n&&(f=(c=e.l3t)[n],!e.FJ||p(f)?(e.N3t(!1),1<(i=R(t,x(103,n)))&&0<(r=R(t,x(102,n)))&&(e=R(t,x(101,n)),l=R(t,x(105,n)),h=R(t,x(104,n)),d=R(t,x(109,n)),b(e)||b(l)||b(h)||b(d)||(m=(v=mn(t)).row,v=v.col,g=t.getCellType(m,v),m=gn(t,m,v),a=g.format(e,m,v={},e={sheet:t}),u=g.format(l,m,v,e),s=g.format(h,m,v,e),o=g.format(d,m,v,e))),c[n]={average:a,numericalCount:r,minimum:u,maximum:s,sum:o,count:i}):(a=f.average,r=f.numericalCount,u=f.minimum,s=f.maximum,o=f.sum,i=f.count)),(t={}).average=a,t.numericalCount=0<r?r:w,t.min=u,t.max=s,t.sum=o,t.count=1<i?i:w,t},k.prototype.E3t=function(t){this.u3t&&(this.u3t.style.display=t?vt:g)},k.prototype.A3t=function(t){var n=this.c3t,e=this.I3t,i=this.vit,r=this.visible,o=!1;this.value=t,e.innerText=i+n+t,!p(t)&&r&&(o=!0),this.E3t(o)},k.prototype.FM=function(t){var n,t;t&&(n=t.menuContent,t=t.tipText,this.menuContent=n,this.vit=n,this.tipText=t,this.u3t.title=t)},k.prototype.onUpdate=function(){var t,n,e,i,e,n;I.prototype.onUpdate.call(this),(n=(0,f.jf)((t=this).DJ))&&(e=n.getSelections(),t.k3t(e))?1===e.length&&1===e[0].rowCount&&1===e[0].colCount?(i=t.D3t(n,w),t.A3t(i[t.name])):""!==(e=t._3t(dn(n,e)))?(t.N3t(!1),n=(i=t.D3t(n,e))[t.name],!p(n)&&n===t.value||(t.value=n,t.A3t(n))):p(t.value)&&t.E3t(!1):t.A3t(w)},k.prototype.onUnbind=function(){var t=this.DJ,n=this.s3t;t&&(t.unbind(f.Events.SelectionChanging+n),t.unbind(f.Events.SelectionChanged+n),t.unbind(f.Events.ValueChanged+n),t.unbind(f.Events.RangeChanged+n),t.unbind(f.Events.DragFillBlockCompleted+n),t.unbind(f.Events.ActiveSheetChanged+n),t.unbind(f.Events.EditEnded+n),t.unbind(f.Events.TopRowChanged+n),t.unbind(f.Events.ColumnWidthChanged+n),t.unbind(f.Events.RowHeightChanged+n),t.unbind(f.Events.RowChanged+n),t.unbind(f.Events.ColumnChanged+n),t.unbind(f.Events.RangeFiltered+n),t.unbind(f.Events.TableFiltered+n),t.unbind(f.Events.TableFilterCleared+n),t.unbind(f.Events.RangeFilterCleared+n),this.DJ=w)},k.prototype._3t=function(t,n,e,i,r){var o,a,o=this.j3t;return o=o||(this.j3t=new u.Parser),a=(a=this.x3)||(this.x3=new s.SheetParserContext(w,!!r,(0,u.eV)(n,e))),s.Ibt(o,a,t,n,e,i,!0)},k.prototype.onDispose=function(){I.prototype.onDispose.call(this),this.j3t=w,this.l3t=w,this.x3&&(this.x3.L0(),this.x3=w)},A=k,sn=r.StatusItem,n(_,sn),_.prototype.onCreateItemView=function(t){var i,n,e,r,o,a,u,s,c,f,l,i=this,n=i.ZC,e=n+v;t.style.display=this.visible?dt:g,r=(r=this.O3t)||(this.O3t=d(m)),h(r).addClass(K),r.style.height=e,r.style.lineHeight=e,(o=(o=this.R3t)||(this.R3t=d(m))).title=T().toolTipZoomOut,h(o).addClass(V),o.style.height=e,h(o).bind(y,function(){i.B3t(!1)}),a=(a=this.L3t)||(this.L3t=d(m)),h(a).addClass(X),a.style.height=e,a.style.lineHeight=e,(u=(u=this.F3t)||(this.F3t=d(m))).title=T().toolTipZoomIn,h(u).addClass(z),u.style.height=e,h(u).bind(y,function(){i.B3t(!0)}),s=(s=this.P3t)||(this.P3t=d(m)),h(s).addClass(Y),s.style.marginTop=Math.floor(n/2+1)+v,h(s).bind(y,function(){return!1}),c=(c=this.G3t)||(this.G3t=d(m)),h(c).addClass(W),c.style.top=Math.floor((n-8)/2+1)+v,c.style.left=i.m3t+v,(f=(f=this.U3t)||(this.U3t=d(m))).title=T().toolTipSlider,h(f).addClass(Q),f.style.top=Math.floor((n-10)/2+1)+v,f.style.right=i.g3t+v,h(f).bind(Rt,function(){i.p3t=!0}),document.addEventListener(Ft,i.Afe),document.addEventListener(Lt,i.Ife),(l=(l=this.z3t)||(this.z3t=d(m))).title=T().toolTipSlider,h(l).addClass(Z),l.style.height=e,l.style.lineHeight=e,h(l).bind(y,function(t){var n,t,n,e,n=t.target;n!==f&&(t=n===c?i.g3t:(n=t.offsetX,(e=l.offsetWidth)-n),i.H3t(t))}),r.appendChild(o),t.appendChild(r),l.appendChild(c),l.appendChild(s),l.appendChild(f),t.appendChild(l),a.appendChild(u),t.appendChild(a)},_.prototype.ZS=function(){this.DJ&&this.DJ.focus()},_.prototype.onBind=function(t){Mn(this,t)},_.prototype.onUpdate=function(){Cn(this)},_.prototype.B3t=function(t){var n,e,i,n=this,e=this.value;e%10==0?e=t?e+this.step:e-this.step:(i=e/10,e=t?Math.ceil(i):Math.floor(i),e*=10),e=(e=e>this.max?this.max:e)<this.min?this.min:e,n.V3t(e)},_.prototype.H3t=function(t){var n,t,e,i,r,o,a,u,s,r,c,n=this;(t=t<0?0:t)>n.v3t&&(t=n.v3t+n.d3t),e=n.value/100,i=n.g3t,r=n.v3t,o=3*n.d3t/2,a=n.min,u=n.middle,s=n.max,(r=t<=i?(i-t)/i*(s-u)+u:(r-t+o)/i*(u-a)+a)<=a+5?r=a:s-5<=r&&(r=s),t=r/100,pn(c=(0,f.jf)(this.DJ),t,e),n.ZS()},_.prototype.V3t=function(t){var n;t&&(t=f.mt.ige(t/100),pn((0,f.jf)(this.DJ),t,this.value/100),this.ZS())},_.prototype.Y3t=function(t){var n=this,e=n.min,i=n.middle,r=n.max,o=n.d3t,a=n.g3t,n=n.v3t,e,e=t<=i?(t-e)/(i-e)*a-o/2:(t-i)/(r-i)*a+a-o/2;this.Z3t(e=n-e)},_.prototype.Z3t=function(t){var n,e,i,r,n=this,e=n.d3t/2,i=n.d3t;t<=i?t+=i:t<n.v3t&&(t+=e),(r=n.U3t).style.right=t+v},_.prototype.Xe=function(t){(t=t&&Math.round(100*f.mt.ige(t)))!==this.value&&(this.value=parseInt(t+"",10),this.Y3t(this.value))},_.prototype.W3t=function(t){return t===this.P3t||t===this.G3t||t===this.U3t||t===this.z3t},_.prototype.Q3t=function(t){var t=t.target;this.W3t(t)&&this.K3t(.7)},_.prototype.J3t=function(t){var t=t.target;this.W3t(t)&&this.K3t(1)},_.prototype.K3t=function(t){this.U3t.style.opacity=t+""},_.prototype.FM=function(t){var n;t&&(n=t.tipText,this.menuContent=t.menuContent,this.tipText=n,this.R3t.title=n[0],this.F3t.title=n[1],this.U3t.title=n[2],this.z3t.title=n[2])},_.prototype.onUnbind=function(){Sn(this)},_.prototype.onDispose=function(){this.b3t=w,h(this.F3t).unbind(y),h(this.R3t).unbind(y),h(this.U3t).unbind(Rt),h(this.P3t).unbind(y),h(this.z3t).unbind(y),document.removeEventListener(Ft,this.Afe),document.removeEventListener(Lt,this.Ife),r.StatusItem.prototype.onDispose.call(this)},tn=_,cn=r.StatusItem,n(D,cn),D.prototype.onCreateItemView=function(t){t.style.display=this.visible?dt:g;var n,n=(n=this.X3t)||(this.X3t=d(ht));h(n).addClass(J),n.innerText="100%",t.appendChild(n)},D.prototype.onBind=function(t){Mn(this,t)},D.prototype.onUpdate=function(){Cn(this)},D.prototype.Xe=function(t){var n;(n=t?Math.round(100*f.mt.ige(t)):n)!==parseInt(this.value+"",10)&&(n=parseInt(n,10),this.value=n+"%",this.q3t(n))},D.prototype.q3t=function(t){var n=this.X3t;n&&(n.innerText=t+"%")},D.prototype.onUnbind=function(){Sn(this)},nn=D,fn=r.StatusItem,n(j,fn),j.prototype.onBind=function(t){var e=this;(e.DJ=t).bind(f.Events.ProgressChanged+e.s3t,function(t,n){e.oyt=n.sheetName,e.onUpdate(n.progress)})},j.prototype.onUpdate=function(t){var n,e,i,r,o,a,u;void 0!==t&&(e=(n=this).$3t,i=n.t4t,r=n.y4,o=n.visible,a=n.n4t,u=n.oyt,t&&1!==t&&r!==t&&o?(n.u3t.style.display=vt,h(e).width(n.YC*t),i.innerHTML=(100*t).toFixed(2)+"%",a.innerText=u?"("+u+")":""):(t<=0||1<=t||!1===o)&&(n.u3t.style.display=g,h(i).empty(),h(a).empty()),n.y4=t)},j.prototype.onCreateItemView=function(t){var n,e,i,r,o,a,n=this,e=d(m);h(e).addClass(xt),i=d(m),h(i).addClass(Nt),h(i).width(n.YC),e.appendChild(i),r=this.$3t=d(m),h(r).addClass(kt),o=this.t4t=d(m),h(o).addClass(_t),a=this.n4t=d(m),h(a).addClass(Dt),i.appendChild(r),e.appendChild(o),e.appendChild(a),t.appendChild(e),n.u3t.style.display=g},j.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(f.Events.ProgressChanged+this.s3t),this.DJ=w)},en=j,Object.defineProperty(O.prototype,"maxCalcCells",{get:function(){return this.f3t},set:function(n){var t;this.f3t=n,this.y3t.o3t().forEach(function(t){t instanceof A&&(t.f3t=n)})},enumerable:!1,configurable:!0}),O.prototype.w3t=function(t,n){var i,r,e,o,a,u,e,s,c,f,l,h,d,i=["formulaAverage","formulaCount","formulaNumericalCount","formulaMin","formulaMax","formulaSum"],r=["toolTipFormulaAverage","toolTipFormulaCount","toolTipFormulaNumericalCount","toolTipFormulaMin","toolTipFormulaMax","toolTipFormulaSum"],e=[T().formulaAverage,T().formulaCount,T().formulaNumericalCount,T().formulaMin,T().formulaMax,T().formulaSum],o=[T().toolTipFormulaAverage,T().toolTipFormulaCount,T().toolTipFormulaNumericalCount,T().toolTipFormulaMin,T().toolTipFormulaMax,T().toolTipFormulaSum],a=[!0,!0,!1,!1,!1,!0],u=[];for(e.forEach(function(t,n){var e={};e.menuContent=t,e.prefix=t,e.align=Ot,e.tipText=o[n],e.visible=a[n],e.e4t=i[n],e.i4t=r[n],u.push(e)}),e={menuContent:T().cellMode,value:T().cellModeReady,tipText:U(T().toolTipCellMode,[T().cellModeReady]),e4t:"cellMode",i4t:"toolTipCellMode"},s={value:100,menuContent:T().zoomSlider,showStatusInContexMenu:!1,align:Ot,e4t:"zoomSlider",i4t:["toolTipZoomOut","toolTipZoomIn","toolTipSlider"]},c={value:"100%",tipText:T().toolTipZoomPanel,menuContent:T().zoom,align:Ot,e4t:"zoom",i4t:"toolTipZoomPanel"},f={value:0,menuContent:T().progressItem,showStatusInContexMenu:!1,e4t:jt,i4t:jt},l=[new $t(it,e),new en(jt,f),new A(C[0],u[0]),new A(C[1],u[1]),new A(C[2],u[2]),new A(C[3],u[3]),new A(C[4],u[4]),new A(C[5],u[5]),new tn(this,ft,s),new nn(lt,c)],n&&n.items instanceof Array&&(l=l.concat(n.items)),d=0;d<l.length;d++)h=l[d],t.dU(h);t.t3t()},O.prototype.C3t=function(t){var n,e,i,n,n=this.Ti,e=this.WCt,i=t.clientHeight;n&&(h(n).addClass(q),h(e).addClass($),(n=i)<15&&(t.style.minHeight="15px",n=15),e.style.top="-"+n+v)},O.prototype.r4t=function(){var t=this.Ti;t&&(this.o4t=this.a4t.bind(this),t.addEventListener(Bt,this.o4t))},O.prototype.a4t=function(t){var n,e,i,r,o,a;G(t),e=(n=this).M3t,i=n.DJ,S&&i&&(n.rq||(n.rq=new qt(n.WCt,h(n.DJ.oM))),r=e.menuView,a=bn(o=n.Ti).left,r.hostInfo={top:o.getBoundingClientRect().top,left:o.getBoundingClientRect().left,width:o.clientWidth,height:o.clientHeight},e.menuData=n.y3t.e3t(),n.rq.rQ(r,e.menuData,t.clientX-a,t.offsetY,i))},O.prototype.u4t=function(t){var n;S&&(n=new Tn,this.M3t.menuView=n,this.oq(t))},O.prototype.oq=function(t){var e,n,i,e=this,n,i;t.commandManager().register(tt+Et,{canUndo:!1,execute:function(t,n){var n=n.commandOptions;e.y3t.r3t(n)}})},O.prototype.Yoe=function(){this.y3t.Yoe()},O.prototype.bind=function(t){this.unbind(),t&&(((this.DJ=t).b3t=this).y3t.$Ct(t),this.u4t(t),this.r4t())},O.prototype.unbind=function(){this.y3t&&this.y3t.a3t(),this.DJ&&(this.DJ.b3t=w,this.DJ=w),this.Ti&&(this.Ti.removeEventListener(Bt,this.o4t),this.o4t=w),this.rq&&(this.rq.close(),this.rq=w)},O.prototype.add=function(t,n){return this.y3t.JCt(t,n)},O.prototype.remove=function(t){return this.y3t.qCt(t)},O.prototype.get=function(t){return this.y3t.q_(t)},O.prototype.all=function(){return this.y3t.o3t()},O.prototype.update=function(){this.y3t.n3t()},O.prototype.dispose=function(){this.unbind(),this.M3t=w,this.rq=w,this.y3t&&(h(this.y3t.TW).data("statusbar",w),this.y3t.L0(),this.y3t=w),this.Ti&&(this.Ti=w)},L.StatusBar=O,S&&H(Tn,Xt),Tn.prototype.getCommandOptions=function(t){return t},n(E,ln=t),E.prototype.canExecute=function(){return!0},E.prototype.execute=function(){var t,n,t,e,i,r,t=this,n=t.Mf,t=t.S3t,e=t.newZoomFactor;if(this.canExecute()){n.Ut.startTransaction();try{e!==(i=n.zoom())&&(n.zoom(e),yn(n,e,i))}finally{t[r=f.Commands.TI(n.name())]=n.Ut.endTransaction()}return!0}return!1},E.prototype.canUndo=function(){return!0},E.prototype.undo=function(){var t=this,n=t.Mf,e,i,t=t.S3t[f.Commands.TI(n.name())][0].value,r=n.zoom();return t!==r&&(n.zoom(t),yn(n,t,r)),!0},on=E,f.Commands[l]={canUndo:!0,execute:function(t,n,e){return f.Commands.zA(t,on,n,e)}},f.Worksheet.ch(l,{setHost:function(t){var t;!t||(t=this.Qy())[l]||t.register(l,f.Commands[l])},onLayoutChanged:function(t){var n,t,t;t.changeType===Pt&&(t=this.parent)&&!t.isPaintSuspended()&&(t=t.b3t)&&t.update()}}),f.Workbook.ch(Et,{onCultureChanged:function(){var t=this.b3t,n=T(),e=[],i,r;t&&t.y3t&&t.y3t.o3t().forEach(function(t){i=t.i4t,r=n[i],i instanceof Array&&(i.forEach(function(t){e.push(n[t])}),r=e),t.FM({menuContent:n[t.e4t],tipText:r})})},preFromJson:function(){An(this)},preFromSJSFormat:function(){An(this)}})},"./dist/plugins/statusBar/statusBar.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/statusBar/statusBar.res.en.js");n.SR={en:e}},"./dist/plugins/statusBar/statusBar.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.progressItem=n.toolTipZoomPanel=n.toolTipSlider=n.toolTipZoomIn=n.toolTipZoomOut=n.toolTipFormulaSum=n.toolTipFormulaMax=n.toolTipFormulaMin=n.toolTipFormulaNumericalCount=n.toolTipFormulaCount=n.toolTipFormulaAverage=n.toolTipCellMode=n.zoom=n.zoomSlider=n.formulaSum=n.formulaMax=n.formulaMin=n.formulaNumericalCount=n.formulaCount=n.formulaAverage=n.cellModeEdit=n.cellModeEnter=n.cellModeReady=n.cellMode=void 0,n.cellMode="Cell Mode",n.cellModeReady="Ready",n.cellModeEnter="Enter",n.cellModeEdit="Edit",n.formulaAverage="Average",n.formulaCount="Count",n.formulaNumericalCount="Numerical Count",n.formulaMin="Min",n.formulaMax="Max",n.formulaSum="Sum",n.zoomSlider="Zoom Slider",n.zoom="Zoom",n.toolTipCellMode="In {0} mode",n.toolTipFormulaAverage="Average of selected cells",n.toolTipFormulaCount="Number of selected cells that contain data",n.toolTipFormulaNumericalCount="Number of selected cells that contain numerical data",n.toolTipFormulaMin="Minimum value in selection",n.toolTipFormulaMax="Maximum value in selection",n.toolTipFormulaSum="Sum of selected cells",n.toolTipZoomOut="Zoom Out",n.toolTipZoomIn="Zoom In",n.toolTipSlider="Zoom",n.toolTipZoomPanel="Zoom level",n.progressItem="Progress"},"./dist/plugins/statusBar/statusItem.js":function(t,n,e){"use strict";var i,e,r,o,i,s,a,u,c,f,l,h,d,v,m,g,p,b,w,y,M,C;function S(t,n,e,i){return{name:t,menuContent:n,visible:e,status:i,command:p+b}}function T(t,n){var t,e,i,r,o,a,u,n;this._marginLeft=0,this._marginRight=0,this.YC=g,this.u3t=v,this.I3t=v,this.name=t,n&&(t=n.align,e=n.menuContent,i=n.tipText,r=n.visible,o=n.showStatusInContexMenu,a=n.value,u=n.e4t,n=n.i4t,this.align=s(t)?m:t,this.menuContent=s(e)?v:e,this.tipText=s(i)?"":i,this.visible=!!s(r)||r,this.showStatusInContexMenu=!!s(o)||o,this.value=s(a)?v:a,this.e4t=s(u)?v:u,this.i4t=s(n)?v:n)}Object.defineProperty(n,"__esModule",{value:!0}),n.StatusItem=void 0,i=e("Core"),e=e("Common"),r=i.mt.En,o=i.GC$,i=e.Common.lt,s=i.ht,a="gc-statusbar-statusitem-container",u="div",c="span",f="none",l="inline-block",h="mousemove",d="mouseout",v=null,m="left",g="auto",p="gc.spread.",b="statusBar",w="10px",y="px",M=15,T.prototype.KCt=function(t){var n,n,t,n=this.align===m;this._marginLeft=n?w:0,this._marginRight=n?0:w,n=t.clientHeight,this.ZC=15<n?n:15,t=this.s4t(),this.u3t=t,this.onCreateItemView(t),this.aY(t)},T.prototype.s4t=function(){var t=this.u3t,n=this.ZC&&this.ZC+y;return t||((t=this.u3t=r(u)).title=this.tipText,o(t).addClass(a),o(t).css({height:n,lineHeight:n,float:this.align,marginLeft:this._marginLeft+"",marginRight:this._marginRight+""}),!1===this.visible&&(t.style.display=f)),t},T.prototype.onCreateItemView=function(t){var n=this.I3t;n||((n=this.I3t=r(c)).innerText=s(this.value)?"":this.value+""),t.appendChild(n)},T.prototype.Zoe=function(){},T.prototype.onBind=function(t){},T.prototype.aY=function(t){t.addEventListener(h,this.Q3t.bind(this)),t.addEventListener(d,this.J3t.bind(this))},T.prototype.XCt=function(){return this.u3t},T.prototype.Q3t=function(t){},T.prototype.J3t=function(t){},T.prototype.i3t=function(){var t=this.c4t();return t.type=b,t.workArea=b,t},T.prototype.r3t=function(t){this.visible=!t.visible,this.onUpdate()},T.prototype.c4t=function(){var t=this.showStatusInContexMenu?this.f4t():null;return S(this.name,this.menuContent,this.visible,t)},T.prototype.f4t=function(){return this.value},T.prototype.Yct=function(){this.u3t&&(this.u3t.style.display=this.visible?l:f)},T.prototype.FM=function(t){t&&(this.menuContent=t.menuContent,this.tipText=t.tipText,this.u3t.title=this.tipText)},T.prototype.onUpdate=function(t){t&&this.I3t&&(this.I3t.innerHTML=t),this.Yct()},T.prototype.onUnbind=function(){},T.prototype.onDispose=function(){this.onUnbind(),this.I3t=v,this.u3t&&(this.u3t.removeEventListener(h,this.Q3t),this.u3t.removeEventListener(d,this.J3t),o(this.u3t).empty(),this.u3t=v)},n.StatusItem=T},"./dist/plugins/table/table-action.js":function(F,t,n){"use strict";var e,m,t,i,L,g,f,d,B,i,v,r,l,p,h,c,o,a,u,s,b,w,y,M,C,S,T,A,P,n,t,G,U,H,V,I,z,Y,x,N,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at;function k(t,n){n.message===G().Exp_TableAddRowIntersectTable&&t.jT(6,G().Exp_TableAddRowIntersectTable)}function _(t,n,e,i,r){var r=r-i;r<0?f(t,n,c,e+r,Math.abs(r)):0<r&&f(t,n,h,e,r,!0)}function D(t,n){var t=K.call(this,t)||this;return t.l4t=n,t.h4t=n.tableName,t.d4t=n.resizeToRange,t.lCe=n.backupTableResizedArgs,t.Cge=n.ignoreEventSuspend,t}function j(t,n){var t=X.call(this,t)||this;return t.bTe=n,t.h4t=n.tableName,t.Pku=n.isAuto,t.d4t=n.resizeToRange,t.BSt=n.columns,t}function O(t,n){var t=q.call(this,t)||this;return t.wTe=n,t.h4t=n.tableName,t}function E(t,n){var t=$.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function R(t,n){var t=tt.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function ut(t,n){var t=nt.call(this,t)||this;return t.g4t=n,t.h4t=n.tableName,t.p4t=n.changeRows,t}function st(t,n){var t=et.call(this,t)||this;return t.b4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t.m4t=n.isAfter,t}function ct(t,n){var t=it.call(this,t)||this;return t.y4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t}function ft(t,n){var t=rt.call(this,t)||this;return t.w4t=n,t.h4t=n.tableName,t}function lt(t,n){var t,e,t=ot.call(this,t)||this,e=t;return e.M4t=n,e.Ky=n.row,e.iw=n.col,e.D5=n.newValue,t}function ht(t,n){var t,e,t=at.call(this,t)||this,e;return t.C4t=n,t.h4t=n.tableName,t}e=this&&this.__extends||(J=function(t,n){return(J=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}J(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),m=n("Core"),t=n("Common"),i=n("./dist/plugins/table/table-util.js"),L=i.Util.S4t,g=i.Util.jj,f=i.Util.Ej,d=i.Util._getTable,B=i.Util.T4t,i=m.Commands.ActionBase,v=t.Common.lt.ht,r="tableResize",l="tableInsertRows",p="tableDeleteRows",h="tableInsertColumns",c="tableDeleteColumns",o="tableToRange",a="tableTotalRowFormula",u="DoInsertRows",s="tableShowFooter",b="bindingTableAddColumn",w="tableAutoBind",y="tableInsertRowsAboveForContextMenu",M="tableInsertRowsBelowForContextMenu",C="tableDeleteRowsForContextMenu",S="tableInsertColumnsLeftForContextMenu",T="tableInsertColumnsRightForContextMenu",A="tableDeleteColumnsForContextMenu",P=void 0,n=n("./dist/plugins/table/table.ns.js"),t=new t.Common.ResourceManager(n.SR,"Tables"),G=t.getResource.bind(t),e(D,K=i),D.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.l4t,i.startTransaction(),t.X5(e,!0);try{(a=e.tables.findByName(r))&&(u=a.range(),s=t.d4t,c=t.lCe,e.tables.resize(a,s),null!=c&&c.push({sheet:e,table:a,oldRange:s,newRange:u}),L(e,a,u,s,t.Cge),n=!0)}finally{t.q5(e,!0),o[f=m.Commands.TI(e.name())]=i.endTransaction()}}return n},D.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=t.h4t,i=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.l4t,o=n.Ut,a=n.tables.findByName(e),(s=r[u=m.Commands.TI(n.name())])&&(o.undo(s),L(n,a,r.resizeToRange,a.range(),t.Cge),i=!0)}finally{t.q5(n,!0)}}return i},U=D,m.Commands[r]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,U,n,e)}},e(j,X=i),j.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.d4t,i.startTransaction(),t.X5(e,!0);try{(a=e.tables.findByName(r))&&(u=a.Tx,s=a.endColumn(),a.autoGenerateColumns(t.Pku),o.colCount!==u&&(e.tables.resize(a,o),_(e,a,s,u,a.Tx),a.bind(t.BSt)),n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.bTe[r]=i.endTransaction()}}return n},j.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t.Mf,e=t.h4t,i=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.bTe,o=n.Ut,a=n.tables.findByName(e),(s=r[u=m.Commands.TI(n.name())])&&(c=a.Tx,f=a.endColumn(),o.undo(s),_(n,a,f,c,a.Tx),i=!0)}finally{t.q5(n,!0)}}return i},H=j,m.Commands[b]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,H,n,e)}},e(O,q=i),O.prototype.execute=function(){var t,n,e,i,r,o,a,u,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,i.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(r))&&(a=o.Tx,u=o.endColumn(),o.autoGenerateColumns(!0),o.autoBind(),_(e,o,u,a,o.Tx),n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.wTe[r]=i.endTransaction()}}return n},O.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t.Mf,e=t.h4t,i=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.wTe,o=n.Ut,a=n.tables.findByName(e),(s=r[u=m.Commands.TI(n.name())])&&(c=a.Tx,f=a.endColumn(),o.undo(s),_(n,a,f,c,a.Tx),i=!0)}finally{t.q5(n,!0)}}return i},V=O,m.Commands[w]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,V,n,e)}},e(E,$=i),E.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=!1;if(t.canExecute()){e=t.Mf,i=t.h4t,r=t.Ky,o=t.DU,a=t.m4t,m.Commands.II((0,m.hCe)(e)),t.X5(e,!0);try{(u=e.tables.findByName(i))&&(s=u.Sx,u.zpt(r,o,a),n=!0,(c=u.Sx)-s===o)&&g(e,u,l,r,o,a)}catch(t){k(e,t)}finally{t.q5(e,!0),m.Commands.xI(e.parent.i4(),t.v4t)}}return n},E.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{o=(i=t.v4t)[r=m.Commands.TI(n.name())],a=i.row,u=i.count,s=i.isAfter,o&&(m.Commands.NI(n.parent.i4(),i),(c=n.tables.findByName(t.h4t))&&(f=s?a+1:a,c.A4t(f,u),c.I4t(),c.x4t(f,u,B(!0)),g(n,c,p,a,u,P,c.tq())),e=!0)}finally{t.q5(n,!0)}}return e},I=E,m.Commands[l]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,I,n,e)}},e(R,tt=i),R.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,o=t.Ky,a=t.DU,u=t.m4t,i.startTransaction(),t.X5(e,!0);try{(s=e.tables.findByName(r))&&(s.N4t(o,a,u,!1),g(e,s,l,o,a,u),t.v4t.row=o,t.v4t.count=a,n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.v4t[r]=i.endTransaction()}}return n},R.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.v4t,r=n.Ut,a=i[o=m.Commands.TI(n.name())],u=i.row,s=i.count,c=i.isAfter,a&&(l=(f=n.tables.findByName(t.h4t))&&f.z3(),h=void 0,d=c?u+1:u,l&&(v=f.dataRange(),h=l.slice(d-v.row,d-v.row+s)),r.undo(a),f&&(f.A4t(d,s),f.I4t(),f.x4t(d,s,B(!0)),g(n,f,p,u,s,c,h||f.tq())),e=!0)}finally{t.q5(n,!0)}}return e},z=R,m.Commands[u]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,z,n,e)}},e(ut,nt=i),ut.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=!1;if(t.canExecute()){e=t.Mf,i=t.h4t,r=t.p4t,m.Commands.II((0,m.hCe)(e)),t.X5(e,!0);try{if(o=e.tables.findByName(i))for(a=r.length-1;0<=a;a--)u=r[a].row,s=r[a].count,c=o.Sx,o.yE(u,s),n=!0,c-(f=o.Sx)===s&&g(e,o,p,u,s,P,o.tq())}catch(t){k(e,t)}finally{t.q5(e,!0),m.Commands.xI(e.parent.i4(),t.g4t)}}return n},ut.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,c,f,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{if(o=(i=t.g4t)[r=m.Commands.TI(n.name())],a=t.p4t,o)for(m.Commands.NI(n.parent.i4(),i),(u=n.tables.findByName(t.h4t))&&u.I4t(),e=!0,s=a.length-1;0<=s;s--)c=a[s].row,f=a[s].count,g(n,u,l,c,f,!1)}finally{t.q5(n,!0)}}return e},Y=ut,m.Commands[p]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,Y,n,e)}},e(st,et=i),st.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=!1;if(t.canExecute()){e=t.Mf,i=t.h4t,r=t.iw,o=t.DU,a=t.m4t,m.Commands.II((0,m.hCe)(e)),t.X5(e,!0);try{(u=e.tables.findByName(i))&&(s=u.Tx,u.k4t(r,o,a),n=!0,(c=u.Tx)-s===o)&&f(e,u,h,r,o,a)}catch(t){k(e,t)}finally{t.q5(e,!0),m.Commands.xI(e.parent.i4(),t.b4t)}}return n},st.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{o=(i=t.b4t)[r=m.Commands.TI(n.name())],a=i.col,u=i.count,o&&(m.Commands.NI(n.parent.i4(),i),(s=n.tables.findByName(t.h4t))&&s.I4t(),e=!0,f(n,s,c,a,u))}finally{t.q5(n,!0)}}return e},x=st,m.Commands[h]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,x,n,e)}},e(ct,it=i),ct.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,t=this,n=!1;if(t.canExecute()){e=t.Mf,i=t.h4t,r=t.iw,o=t.DU,m.Commands.II((0,m.hCe)(e)),t.X5(e,!0);try{(a=e.tables.findByName(i))&&(u=a.Tx,a.wE(r,o),n=!0,u-(s=a.Tx)===o)&&f(e,a,c,r,o)}catch(t){k(e,t)}finally{t.q5(e,!0),m.Commands.xI(e.parent.i4(),t.y4t)}}return n},ct.prototype.undo=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{o=(i=t.y4t)[r=m.Commands.TI(n.name())],a=i.col,u=i.count,o&&(m.Commands.NI(n.parent.i4(),i),(s=n.tables.findByName(t.h4t))&&s.I4t(),f(n,s,h,a,u,!(e=!0)))}finally{t.q5(n,!0)}}return e},N=ct,m.Commands[c]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,N,n,e)}},e(ft,rt=i),ft.prototype.execute=function(){var t,n,e,i,r,o,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,i.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(r))&&(e.tables.remove(o,3),n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.w4t[r]=i.endTransaction()}}return n},ft.prototype.undo=function(){var t,n,e,i,r,o,a,u,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.w4t,r=n.Ut,(a=i[o=m.Commands.TI(n.name())])&&(r.undo(a),(u=n.tables.findByName(t.h4t))&&u.I4t(),e=!0)}finally{t.q5(n,!0)}}return e},Z=ft,m.Commands[o]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,Z,n,e)}},e(lt,ot=i),lt.prototype.execute=function(){var t,n,e,i,r,o,a,u,s,c,f,a,t=this,n=!1;if(t.canExecute()){(i=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{r=t.Ky,o=t.iw,a=t.D5,e.setFormula(r,o,a),a?a.startsWith("=SUBTOTAL(103")||a.startsWith("=SUBTOTAL(102")||(u=e.getFormatter(r,o))&&"GENERAL"!==u.toUpperCase()||(f=(c=(s=e.tables.find(r,o))&&s.BSt[o-s.startColumn()])&&c.formatter(),(0,m.Ffe)(e,r,o,f)):e.setValue(r,o,null),n=!0}finally{t.q5(e,!0),a=m.Commands.TI(e.name()),t.M4t[a]=i.endTransaction()}}return n},lt.prototype.undo=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.M4t,r=n.Ut,(a=i[o=m.Commands.TI(n.name())])&&(r.undo(a),e=!0)}finally{t.q5(n,!0)}}return e},W=lt,m.Commands[a]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,W,n,e)}},e(ht,at=i),ht.prototype.execute=function(){var t,n,e,i,r,o,r,t=this,n=!1;if(t.canExecute()){i=(e=t.Mf).Ut,r=t.h4t,i.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(r))&&(o.showFooter(!0),n=!0)}finally{t.q5(e,!0),r=m.Commands.TI(e.name()),t.C4t[r]=i.endTransaction()}}return n},ht.prototype.undo=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.C4t,r=n.Ut,(a=i[o=m.Commands.TI(n.name())])&&(r.undo(a),e=!0)}finally{t.q5(n,!0)}}return e},Q=ht,m.Commands[s]={canUndo:!0,execute:function(t,n,e){return m.Commands.zA(t,Q,n,e)}},m.Commands[y]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s,r;return n.cmd=y,v(n.row)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.row,s=o.rowCount,r=a.footerIndex()===u,n.row=r?u-1:u,n.count=s,n.tableName=a.name(),n.isAfter=r),m.Commands.zA(t,I,n,e))):m.Commands.zA(t,I,n,e)}},m.Commands[M]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=M,v(n.row)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.row,s=o.rowCount,n.row=u,n.count=s,n.tableName=a.name(),n.isAfter=!0),m.Commands.zA(t,I,n,e))):m.Commands.zA(t,I,n,e)}},m.Commands[C]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s,c,f,l,h;if(n.cmd=C,v(n.changeRows)){for(i=m.Commands.Tp(t,n),r=n.selections,u=a=o=void 0,n.changeRows=[],s=0;s<r.length;s++){if(c=r[s],!(f=d(i,c)))return!1;if(o){if(o!==f)return!1}else o=f}for(s=0;s<r.length;s++)for(l=s+1;l<r.length;l++){if(c=r[s],h=r[l],c.row>=h.row&&c.row<=h.row+h.rowCount-1)return!1;if(c.row+c.rowCount-1>=h.row&&c.row+c.rowCount-1<=h.row+h.rowCount-1)return!1;if(c.row<=o.Ky||c.row+c.rowCount>o.Ky+o.Sx)return!1;if(h.row<=o.Ky||h.row+h.rowCount>o.Ky+o.Sx)return!1}for(r.sort(function(t,n){return t.row-n.row}),s=0;s<r.length;s++)a=(c=r[s]).row,u=c.rowCount,n.changeRows.push({row:a,count:u});n.tableName=o.name()}return m.Commands.zA(t,Y,n,e)}},m.Commands[S]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=S,v(n.col)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.col,s=o.colCount,n.col=u,n.count=s,n.tableName=a.name(),n.isAfter=!1),m.Commands.zA(t,x,n,e))):m.Commands.zA(t,x,n,e)}},m.Commands[T]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=T,v(n.col)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.col,s=o.colCount,n.col=u,n.count=s,n.tableName=a.name(),n.isAfter=!0),m.Commands.zA(t,x,n,e))):m.Commands.zA(t,x,n,e)}},m.Commands[A]={canUndo:!0,execute:function(t,n,e){var i,r,o,a,u,s;return n.cmd=A,v(n.col)&&v(n.count)?(i=m.Commands.Tp(t,n),s=u=a=o=void 0,1===(r=n.selections).length&&(o=r[0],(a=d(i,o))&&(u=o.col,s=o.colCount,n.col=u,n.count=s,n.tableName=a.name()),m.Commands.zA(t,N,n,e))):m.Commands.zA(t,N,n,e)}},m.Commands.D4t=function(t){t.register(r,m.Commands[r]),t.register(b,m.Commands[b]),t.register(w,m.Commands[w]),t.register(l,m.Commands[l]),t.register(u,m.Commands[u]),t.register(p,m.Commands[p]),t.register(h,m.Commands[h]),t.register(c,m.Commands[c]),t.register(o,m.Commands[o]),t.register(a,m.Commands[a]),t.register(s,m.Commands[s]),t.register(y,m.Commands[y]),t.register(M,m.Commands[M]),t.register(C,m.Commands[C]),t.register(S,m.Commands[S]),t.register(T,m.Commands[T]),t.register(A,m.Commands[A])}},"./dist/plugins/table/table-event.js":function(t,n,e){"use strict";var g,n,p,i,e,f,h,s,r,o,n,b,w,y,a;Object.defineProperty(n,"__esModule",{value:!0}),g=e("Core"),n=e("Common"),p=e("./dist/plugins/table/table.js"),i=e("./dist/plugins/table/table.ns.js"),e=e("./dist/plugins/table/table-util.js"),f=n.Common.lt.ht,h=null,s=Math.abs,r=10,o="tableResize",n=new n.Common.ResourceManager(i.SR,"Tables"),b=n.getResource.bind(n),w=e.Util._4t,y=e.Util.E4t,a=e.Util.j4t,g.GC$.extend(g.nk.prototype,{mk:function(t,n){var t,e,t=this.Tk(t,n);t&&((e=this).I9=e.x9=n.Ut.getSelections(),n.setSelection(t.row,t.col,t.rowCount,t.colCount))},Tk:function(t,n){var e,i,r,o,a,u,i,n,n,s,c,n,e=n.getSelections(),i=t.tableSelectInfo,r=i.table,o=0,a=0;if(r.oL&&(o=1),r.jO&&(a=1),u=h,i=i.action,n=(n=n.Nde)&&n.Ymt(),!f(n)&&0<n.length&&(e=n),i===p.TableSelectionType.TABLE_ROW_SELECT)u=(0,g.Ec)(t.row,r.iw,1,r.Tx);else if(i===p.TableSelectionType.TABLE_COL_SELECT){for(s=0;s<e.length;s++)if((c=e[s]).col===t.col&&c.row===r.Ky+a&&1===c.colCount&&c.rowCount===r.Sx-a-o){u=(0,g.Ec)(r.Ky,t.col,r.Sx,1);break}n=!u&&-1===t.rowViewportIndex&&e&&e[0]&&e[0].col===t.col&&e[0].rowCount===r.Sx,f(u)&&!n&&(u=(0,g.Ec)(r.Ky+a,t.col,r.Sx-a-o,1))}else if(i===p.TableSelectionType.TABLE_CORNER_SELECT){for(s=0;s<e.length;s++)if((c=e[s]).col===r.iw&&c.row===r.Ky+a&&c.colCount===r.Tx&&c.rowCount===r.Sx-a-o){u=(0,g.Ec)(r.Ky,r.iw,r.Sx,r.Tx);break}f(u)&&(u=(0,g.Ec)(r.Ky+a,r.iw,r.Sx-a-o,r.Tx))}else i===p.TableSelectionType.TABLE_SELECT&&(u=(0,g.Ec)(r.Ky,r.iw,r.Sx,r.Tx));return u},KL:function(t,n){var e,i,r,o,a,u,s,t,c,f,c,f,e,r,l,s,o,e=this.Mf,i=h;return i=e&&!e.isActualProtected()&&!e.isEditing()&&n&&n.showResizeHandle()&&(r=t.row,o=t.col,a=t.x,u=t.y,s=t.rowViewportIndex,t=t.colViewportIndex,c=w(e,n),f=y(e,n),r===c)&&o===f&&(f=(c=e.getCellRect(r,o,s,t)).x,e=c.y,r=c.width,o=e+(l=c.height),(s=f+r)-10<=a)&&a<=s&&o-10<=u&&u<=o?{x:a,y:u,table:n}:i},Sk:function(t){var n,e,i,i,r,o,n=this;!0!==n.$k&&!0!==n.rb&&(e=n.Mf,i=(i=t.resizeTableHitInfo)&&i.table)&&!i.QL()&&(n.$k=!0,n.rb=!0,n.O4t=i,n.R4t=i.Ky,n.B4t=i.iw,n.L4t=i.Sx,n.F4t=i.Tx,r=n.R4t+n.L4t-1,o=n.B4t+n.F4t-1,n.P4t=e.getCellRect(r,o),n.G4t=i.range(),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},t9:function(){var t,n,e,t=this,n=t.Mf;t.Rk&&t.$k&&t.rb&&t.O4t&&(t.U4t(),t.H4t()&&(t.z4t=t.V4t(),t.Y4t(),t.Z4t(),(e=(e=t.W4t)||t.Q4t()).equals(t.K4t)||(t.W4t=(0,g.Ec)(t.K4t.row,t.K4t.col,t.K4t.rowCount,t.K4t.colCount),a(n,t.O4t,t.Q4t(),t.K4t))),t.a9())},OD:function(){var t,n,e,t=this,n=t.Mf;t.l9(),t.$k&&t.rb&&t.K4t&&t.O4t?(t.$k=!1,t.rb=!1,t.J4t()?(e=t.Q4t(),t.X4t(),e.equals(t.K4t)?n.Dn.q4t():n.Qy().execute({cmd:o,sheetName:n.name(),tableName:t.O4t.name(),resizeToRange:t.K4t}),t.$4t()):(t.$4t(),n.Dn.q4t())):t.$4t()},Q4t:function(){var t=this.O4t;return(0,g.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},U4t:function(){var t=this,n=t.Q9(),e=t.K9();t.tSt=n,t.nSt=e},H4t:function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.R4t,e=t.B4t,i=t.tSt,r=t.nSt,o,a,u,s;return(t.O4t.jO?n+1:n)<=i&&e<=r},V4t:function(){var t,n,e,t,i,t,r,e,n,o,t=this,e=t.fk,t=t.P4t,i=t.x+t.width,t=t.y+t.height,r=e.x,e=e.y,n=s(t-e),o,n=s(i-r)<=n?e<t?2:3:r<i?0:1;return n},Y4t:function(){var t,n,e,i,r,o,a,u,t=this,n=t.R4t,e=t.B4t,i=t.tSt,r=t.nSt,o=t.z4t,a=t.L4t,u=t.F4t;switch(o){case 0:case 1:u=s(r-e)+1;break;case 2:case 3:a=s(i-n)+1}t.K4t?(t.K4t.rowCount=a,t.K4t.colCount=u):t.K4t=(0,g.Ec)(n,e,a,u)},Z4t:function(){var t=this,n;t.Mf.Dn.q4t(),t.G4t=t.eSt()},eSt:function(){var t,n,e,i,r,n,t,n=this.K4t,e=n.row,i=n.col,r=n.rowCount,n=n.colCount;return(0,g.Ec)(e,i,r,n)},X4t:function(){var t=this,n=t.O4t,e;2===t.z4t&&n.oL&&(t.K4t.rowCount+=1)},J4t:function(){var t,n,e,i,r,o,a,u,s,c,a,f,l,h,d,v,m,t=this,n=t.Mf,e=!1,i=n.Ut,r=n.tables,o=t.O4t,a=t.K4t,u=a.row,s=a.col,c=a.rowCount,a=a.colCount,f=t.tSt,l=t.nSt,h=w(n,o),d=y(n,o),v=t.z4t,m=o.IB;return h&&d&&((0,p.hasRowFilter)(n,new g.Range(u,s,c,a))||(i.eE(u,s,c,a)||i.GT(u,s,c,a)?n.jT(6,b().Exp_TableResizeToSpan):m&&m.isFiltered()?2===v?n.jT(6,b().Exp_TableResizeWithHidden):3===v&&o.oL?n.jT(6,b().Exp_TableResizeWithFilter):e=!0:2===v&&t.iSt(h,f)||0===v&&t.rSt(d,l)?n.jT(6,b().Exp_TableResizeWithHidden):1===v&&(r.Pl(u,d+1,c,l-d)||r.oSt(u,d+1,c,l-d))||3===v&&(r.Pl(h+1,s,f-h,a)||r.oSt(h+1,s,f-h,a))?n.jT(6,b().Exp_TableResizeToTable):e=!0)),e},iSt:function(t,n){for(var e,i=this.Mf,r,o=!1,r=t;n<r;r--)if(i.getRowHeight(r)<=0){o=!0;break}return o},rSt:function(t,n){var e,i=this.Mf,r,o=!1;if(!o)for(r=t;n<r;r--)if(i.getColumnWidth(r)<=0){o=!0;break}return o},$4t:function(){var t=this;t.$k=!1,t.rb=!1,t.Rk=h,t.K4t=h,t.W4t=h}})},"./dist/plugins/table/table-render.js":function(t,n,e){"use strict";var e,i,n;function r(t,n,e,i){var r,o,e,r,o=t.rt.K4t,e=t.getRangeRect(e,i,o);n.strokeStyle=t.getSelectionBorderColor(),n.strokeRect(e.x,e.y,e.width,e.height)}Object.defineProperty(n,"__esModule",{value:!0}),n="tableRender",(i=(e=e("Core")).GC$.extend)(e.g7.prototype,{q4t:function(){var t,n,t=this,n;0<t.Mf.My||t.E1()}}),e.Worksheet.ch(n,{paintAdornment:function(t){var n,t,e,n=this,t=t.ctx,e=n.rt;e&&e.Rk&&e.$k&&r(n,t,e.nD(),e.eD())}})},"./dist/plugins/table/table-theme.js":function(F,t,L){"use strict";var s,g,B,p,P,G,e,U,H,V,z,Y,c,f,u,l,h,d,v,m,Z,b,W,Q,J,K,X,w,q,$,tt,nt,y,L,et,it,rt,ot,at,a,M,C,S,T,A,I,ut,st,x,N,k,_,D,n,ct,i,r,o,o,i;function ft(){for(var t,n,t={},n=1;n<=28;n++)n<=21&&(t["TABLESTYLELIGHT"+n]=!0),n<=11&&(t["TABLESTYLEDARK"+n]=!0),t["TABLESTYLEMEDIUM"+n]=!0;return t}function j(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v=this,m=arguments;g(I,function(t,n){v[n]=1<t?m[t+1]:m[t]}),p(e)&&(v.font=e)}function lt(i,r){i.name(r.name()),g(y,function(t,n){i[n](r[n]())}),g(w,function(t,n){var e=r[n]();i[n](e?e.Gf():f)}),i.builtInName(r.builtInName(),!1)}function ht(){}function O(t,n){return isNaN(n)?n:new s.LineBorder(t,n)}function E(t,n,e,i,r,o,a,u,s,c){var f=new x;return n&&(f.backColor=n),e&&(f.foreColor=e),i&&(f.cpe=it,f.lre=rt,f.lpe=ot,f._font=et),r&&(f.borderLeft=O(t,r)),o&&(f.borderTop=O(t,o)),a&&(f.borderRight=O(t,a)),u&&(f.borderBottom=O(t,u)),s&&(f.borderHorizontal=O(t,s)),c&&(f.borderVertical=O(t,c)),f}function R(t){return 0===t?"Text 1":"Accent "+t}function dt(t){var t,n,e,t=R(t),n=t+" 80",e=new N;return e[u](E(t,0,t,1,0,0,0,1)),e[h](E(t,0,t,0,0,1,0,1)),e[m](E(t,n)),e[v](E(t,0,t,1)),e[d](E(t,0,t,1)),e[b](E(t,n)),e[l](E(t,0,t,1,0,1)),e}function vt(t){var t,n,t=R(t),n=new N;return n[u](E(t,t,k,1)),n[h](E(t,0,0,0,1,1,1,1)),n[m](E(t,0,0,0,0,1)),n[Z](E(t,0,0,0,0,1)),n[b](E(t,0,0,0,1)),n[W](E(t,0,0,0,1)),n[v](E(t,0,0,1)),n[d](E(t,0,0,1)),n[l](E(t,0,0,1,0,6)),n}function mt(t){var t,n,e,t=R(t),n=t+" 80",e=new N;return e[u](E(t,0,0,1,0,0,0,2)),e[h](E(t,0,0,0,1,1,1,1,1,1)),e[m](E(t,n)),e[b](E(t,n)),e[v](E(t,0,0,1)),e[d](E(t,0,0,1)),e[l](E(t,0,0,1,0,6)),e}function gt(t){var t,n,e,t,i,t=R(t),n=t+" 20",e=t,t=t+" 80",i=new N;return i[u](E(n,e,k,1)),i[h](E(n,0,0,0,1,1,1,1,1)),i[m](E(n,t)),i[b](E(n,t)),i[v](E(n,0,0,1)),i[d](E(n,0,0,1)),i[l](E(n,0,_,1,0,6)),i}function pt(t){var t,n,e,i,t,r,t=R(t),n=k,e=t,i=t+" 60",t=t+" 80",r=new N;return r[u](E(n,e,k,1,0,0,0,2,0,1)),r[h](E(n,t,0,0,0,0,0,0,1,1)),r[m](E(n,i)),r[b](E(n,i)),r[v](E(n,e,k,1)),r[d](E(n,e,k,1)),r[l](E(n,e,k,1,0,2,0,0,0,1)),r}function bt(t){var n,e,i,r,e,o,n,e="#D3D3D3",i=R(t),r=e,e=0===t?_:e,o=new N;return o[u](E(_,i,k,1,0,2,0,2)),o[h](E(e,0,0,0,1,new s.LineBorder(_,2),1,new s.LineBorder(_,2),0===t?1:0,1)),o[m](E(e,r)),o[b](E(e,r)),o[v](E(e,i,k)),o[d](E(e,i,k)),o[K](E(e,i,k,1)),o[X](E(e,i,k,1)),o[l](E(_,0,_,0,0,6)),o}function wt(t){var t,n,e,i,r,t,o,t=R(t),n=t,e=t+" 40",i=t+" 80",r=t+" 60",t=t+" 80",o=new N;return o[u](E(e,i,_,1,1,1,1,1,0,1)),o[h](E(e,i,0,0,1,1,1,1,1,1)),o[m](E(e,r)),o[b](E(e,r)),o[v](E(e,0,0,1)),o[d](E(e,0,0,1)),o[l](E(e,t,_,1,1,new s.LineBorder(n,2),1,1,0,1)),o}function yt(t){var n,e,i,r,t,o,n=R(t),e=_,i=0===t?n+" 25":n+" -25",r=0===t?n+" 50":n,t=0===t?n:n+" -50",o=new N;return o[u](E(k,e,k,1,0,0,0,2)),o[h](E(n,r,k)),o[m](E(n,i)),o[b](E(n,i)),o[v](E(k,i,k,1,0,0,2)),o[d](E(k,i,k,1,2)),o[l](E(k,t,k,1,0,2)),o}function Mt(t){var n,e,i,t,r,o;function a(t,n){var e;return t<0||3<t?"":{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[n][t]}return n=R(t),e=a(t,"headerColor"),i=a(t,"stripColor"),r=t=a(t,"tableBackground"),(o=new N)[u](E(n,e,k)),o[h](E(n,t)),o[m](E(n,i)),o[b](E(n,i)),o[v](E(n,0,0,1)),o[d](E(n,0,0,1)),o[l](E(_,r,0,1,0,6)),o}function Ct(){}for(Object.defineProperty(t,"__esModule",{value:!0}),t.TableThemes=t.TableTheme=t.TableStyle=void 0,s=L("Core"),g=s.GC$.each,B=s.GC$.isEmptyObject,p=s.mt.T1,P=JSON.stringify,G=JSON.parse,e=s.mt.p0,U=s.mt.go,H=s.mt.vo,V=s.mt.n1,z=s.NodeHelper.sr,Y=Math.floor,c=void 0,f=null,w=[u="headerRowStyle",l="footerRowStyle",h="wholeTableStyle",d="highlightLastColumnStyle",v="highlightFirstColumnStyle",m="firstRowStripStyle",Z="secondRowStripStyle",b="firstColumnStripStyle",W="secondColumnStripStyle",Q="firstHeaderCellStyle",J="lastHeaderCellStyle",K="firstFooterCellStyle",X="lastFooterCellStyle"],y=[q="firstRowStripSize",$="secondRowStripSize",tt="firstColumnStripSize",nt="secondColumnStripSize"],L="name",et="bold 14.667px calibri",it="bold",rt="14.667px",ot="calibri",at={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},I=["backColor","foreColor",a="borderLeft",M="borderTop",C="borderRight",S="borderBottom",T="borderHorizontal",A="borderVertical","textDecoration","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"],ut=s.W.upe,st=ft(),Object.defineProperty(j.prototype,"font",{get:function(){return this._font},set:function(t){s.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"fontSize",{get:function(){return this.lre},set:function(t){s.W.dpe(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"fontStyle",{get:function(){return this.spe},set:function(t){var n=this;n.spe=t,n._font=ut(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"fontWeight",{get:function(){return this.cpe},set:function(t){var n=this;n.cpe=t,n._font=ut(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"fontFamily",{get:function(){return this.lpe},set:function(t){var n=this;n.lpe=t,n._font=ut(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)},enumerable:!1,configurable:!0}),j.prototype.h5=function(e,t,n,i,r){var o=this;n&&p(o[a])&&!p(e[a])&&(e[a]=o[a],e[a].level=20),t&&p(o[M])&&!p(e[M])&&(e[M]=o[M],e[M].level=20),r&&p(o[C])&&!p(e[C])&&(e[C]=o[C],e[C].level=20),i&&p(o[S])&&!p(e[S])&&(e[S]=o[S],e[S].level=20),t||!p(o[T])||p(e[M])||(e[M]=o[T],e[M].level=20),i||!p(o[T])||p(e[S])||(e[S]=o[T],e[S].level=20),n||!p(o[A])||p(e[a])||(e[a]=o[A],e[a].level=20),r||!p(o[A])||p(e[C])||(e[C]=o[A],e[C].level=20),g(I,function(t,n){0<=n.indexOf("border")||p(o[n])&&!p(e[n])&&(e[n]=o[n])})},j.prototype.Gf=function(){var t,n,t=new j,n=P(this.toJSON());return t.fromJSON(G(n)),t},j.prototype.toJSON=function(){var i,r,i=this,r={};return g(I,function(t,n){var e,e,e=i[n],e=e&&e.toJSON?e.toJSON():e;r[n]=e!==f&&B(e)?c:e}),r.font=i.font,r},j.prototype.fromJSON=function(r,o){var a;r&&(a=this,g(I,function(t,n){var e,i,e=r[n];p(e)&&(0<=n.indexOf("border")?((i=new s.LineBorder).fromJSON(e,o),a[n]=i):a[n]=e)}),r.font)&&(a.font=r.font)},x=j,t.TableStyle=x,s.GC$.extend(s.StyleManager.prototype,{addTableTheme:function(t){var n=this,e,e;(e=(e=n.aSt)||(n.aSt={}))[t.name()]=t},getTableTheme:function(t){var n,e,i,r,n=this,e=n.aSt;return e=e||(n.aSt={}),st[t.toUpperCase()]?e[i=t.substr(10).toLowerCase()]?e[i]:(lt(r=new N,D[i]),n.addTableTheme(r),r):e[t]}}),ht.prototype.toJSON=function(){var e,t,i,r,e=this,t=e.builtInName();return t?{buildInName:t}:(i={name:e.name()},g(w,function(t,n){(r=e[n]())&&(i[n]=r.toJSON())}),g(y,function(t,n){1!==(r=e[n]())&&(i[n]=r)}),B(i)?c:i)},ht.prototype.fromJSON=function(r,o){var a,t,t,t;r&&(a=this,(t=r.buildInName)?lt(a,D[t.toLowerCase()]):(t=r.name,t=p(t)?t:r.Zc,p(t)&&a.name(t,!1),g(y,function(t,n){var e=r[n]!==c?r[n]:r["_"+n];e&&a[n](e,!1)}),g(w,function(t,n){var e,i,e=r[n]!==c?r[n]:r["_"+n];e&&((i=new x).fromJSON(e,o),a[n](i,!1))})))},ht.prototype.yh=function(t,a){var u,n,e,i,r,o,u=this;for(u.name(V(t.name)),e=function(t){var n,e,i,r,o,n=z(t.dxfId,0),e=t.type,i=z(t.size,1),r=new x,o=at[e||"wholeTable"];"function"==typeof u[o]&&void 0!==t.dxfId&&(a.getDxf(n,r,!0),g(I,function(t,n){0<=n.indexOf("border")&&r[n]===f&&(r[n]=new s.LineBorder)}),u[o](r,!1)),"firstRowStripe"!==e&&"secondRowStripe"!==e&&"firstColumnStripe"!==e&&"secondColumnStripe"!==e||u[e.substr(0,e.length-1)+"Size"](i,!1)},i=0,r=n=U(t,"tableStyleElement");i<r.length;i++)e(o=r[i]);a.addTableTheme(u)},ht.prototype.wh=function(i){var r,o,t,n,a,u,r=this,o=[],t={n_:"tableStyle",c_:o},n=r.builtInName();return n!==f&&n!==c?t.name="TableStyle"+n:(t.name=H(r.name()),a=0,g(w,function(t,n){var e;(u=r[n]())&&(e=i.getDxfIndex(u))!==c&&(a++,o.push({n_:"tableStyleElement",type:s.SJSStylePropsToStyleProps[n],dxfId:e}))}),g(y,function(t,n){(u=r[n]())&&(a++,o.push({n_:"tableStyleElement",type:n.replace("Size","e"),size:u}))}),t.count=a,t.pivot="0"),t},N=ht,(t.TableTheme=N).prototype.name=e(L),N.prototype.builtInName=e("builtInName"),g(w,function(t,n){N.prototype[n]=e(n)}),g(y,function(t,n){N.prototype[n]=e(n,1)}),k="white",_="black",D=Ct,t.TableThemes=D,n=1;n<=28;n++)i=Y((ct=n-1)/7),n<=21&&0<=i&&i<3&&(o="Light"+n,(r=[dt,vt,mt][i](ct%7)).name&&r.name(o),r.builtInName&&r.builtInName(o),D["light"+n]=r),n<=11&&0<=i&&i<2&&((r=[yt,Mt][i](ct%7)).name(o="Dark"+n),r.builtInName(o),D["dark"+n]=r),0<=i&&i<4&&((r=[gt,pt,bt,wt][i](ct%7)).name(i="Medium"+n),r.builtInName(i),D["medium"+n]=r)},"./dist/plugins/table/table-util.js":function(F,t,n){"use strict";var l,o,a,e,i,p,u,b,h,f,d,r,n,v;function m(t){throw new Error(t)}function s(t,n,e,i,r){a&&(!i&&r&&(i=k(t,r,n,e)),t.zI(n,e,i,r))}function c(t,n,e,i){t.setValue(n,e,i)}function g(t){t.suspendPaint()}function w(t){t.resumePaint()}function y(t){return t.op().Hyt()}function M(t){a&&t.suspendCalcService()}function C(t,n){a&&t.resumeCalcService(n)}function S(t){t&&(g(t),t.suspendEvent(),M(t))}function T(t){t&&(C(t),t.resumeEvent(),w(t))}function A(t){return t.rowCount}function I(t){return t.colCount}function x(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)}function N(t,n,e,i,r,o){var a,r;return n?((a=t.Uw())._wt=r,r=t.Lp.parse(a,n,e,i,!1,o,!1,t.options.keepUnknownFormulas),delete a._wt,r):b}function k(t,n,e,i,r){return r=r===h||r,t.Lp.unparse(t.Uw(),n,e,i,!1,r)}function _(t){var n,e,i,e;return!(!t||(x(t)||m(v().Exp_TableNameInvalid),e=(n=this).name(),i=n.jS,t===e)||i&&(e=i.findByName(t))&&n!==e)}function D(t,n,e,i,r){for(var o,a,u,s,o=e;n<=o;o--)for(u=i;u<=r;u++){if(O(a=t.Z_(o,u)))return o;if(j(t,o,u))return o;if(s=t.Ut.findSpan(o,u))return s.row+s.rowCount-1}return-1}function L(t,n,e,i,r){for(var o,a,u,s,a=r;i<=a;a--)for(o=n;o<=e;o++){if(O(u=t.Z_(o,a)))return a;if(j(t,o,a))return a;if(s=t.Ut.findSpan(o,a))return s.col+s.colCount-1}return-1}function j(t,n,e){var i=t.getValue(n,e),r,o;return i!==b&&u(i)||(r=t.getSparkline&&t.getSparkline(n,e))||O(o=t.Z_(n,e))}function O(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.cellType||t.diagonalDown||t.diagonalUp))}function B(t,n,e,i,r,o,a,u){return r<=t&&!(n===a&&n+i-1===u)&&(n<a&&a<n+i||a<=n&&n<=u&&u<n+i-1)}function P(t,n,e,i,r,o,a,u){return a<=n&&!(t===r&&t+e-1===o)&&(t<r&&r<t+e||r<=t&&t<=o&&o<t+e-1)}function G(t,n,e){return{col:n,leadingCellRow:e,row:t}}function U(t,n,e){var i,r,o,i=b,r=n.Ky,o=n.endRow();for(e&&(o-=n.oL?1:0);r<=o&&t.getRowHeight(o)<=0;)o--;return i=r<=o?o:i}function H(t,n){for(var e,i,r,e=b,i=n.iw,r=n.endColumn();i<=r&&t.getColumnWidth(r)<=0;)r--;return e=i<=r?r:e}function V(t){for(var n,e,i,n,r,o,a,u,s,c,n=t.Ut,e=n.W_(3).dataTable,i=n.getLastNonNullRow(3,!0),n=t.getRowCount(),r=t.getColumnCount(),o=-1,s=n-1;-1<s;s--)if(a=e[s])for(c=0;c<r;c++)if((u=a[c])&&!d(u.value))return f(s,i);return f(-1,i)}function z(t,n){var e,i,r,o,a,n,u,s,c,s,o,e=n.jS,i,r,o=n.Ky+n.Sx-1,a=n.iw,n=a+n.Tx-1,u=V(t),s=e?e.uSt():-1;return(c=o)<(u=f(u,s))&&(o=new l.Range(s=1+o,a,u-o,n-a+1),c=f(D(t,s,u,a,n),e.uSt(o))),c}function Y(t){for(var n,e,i,r,o,a,u,u,s,c,n=t.Ut,e=n.W_(3).dataTable,i=n.getLastNonNullCol(3,!0),r=t.getRowCount(),o,a=-1,s=t.getColumnCount()-1;-1<s;s--)for(c=0;c<r;c++)if((u=(u=e[c])&&u[s])&&!d(u.value))return f(s,i);return f(-1,i)}function Z(t,n){var e,i,r,o,a,n,u,s,c,s,n,e=n.jS,i=n.Ky,r=i+n.Sx-1,o,a,n=n.iw+n.Tx-1,u=Y(t),s=e?e.sSt():-1;return(c=n)<(u=f(u,s))&&(n=new l.Range(i,s=1+n,r-i+1,u-n),c=f(L(t,i,r,s,u),e.sSt(n))),c}function W(t,n,r,o,a,u,e,i,s,c){var f,l,t,n,h,i,f=t.getRowCount()-1,l=t.getColumnCount()-1,t=t.Ut.getSpans(),n=n.jS&&n.jS.U3;return!i&&(!s&&f-o<e||s&&l-u<e)?(c||m(v().Exp_TableAddRowNoEnoughRoom),!0):(h=s?P:B,(i=t.some(function(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return h(n,e,i,t,r,o,a,u)}))?c||m(v().Exp_TableAddRowIntersectSpan):n&&(i=n.some(function(t){var n=t.Ky,e=t.iw,i=t.Sx,t=t.Tx;return h(n,e,i,t,r,o,a,u)}))&&!c&&m(v().Exp_TableAddRowIntersectTable),i)}function Q(t,n,e){for(var i,r,o,a,u,s,c,f,i=n.row,r=n.col,o=i+n.rowCount,a=r+n.colCount,u=i;u<o;u++)for(s=r;s<a;s++)if(f=(c=t.getCell(u,s)).value(),(!d(f)&&""!==f||t.Ut.findSpan(u,s))&&(!e||!e.equals(new l.Range(c.row,c.col,1,1))))return new l.Range(u,s,1,1);return h}function E(t,n,e,i,r,o,a){for(var u,s,c,u=n;u<=e;u++)for(s=i;s<=r;s++)if(c=t.l0(u,s,"locked"),o&&!c||a&&c)return;return 1}function J(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g;if(r){if(!o&&!a)return b;if(u=t.Mf,c=s=0,t.oL&&(s=1),t.jO&&(c=1),n===p.TableSelectionType.TABLE_ROW_SELECT){if(!E(u,e,e,t.iw,t.endColumn(),o,a))return b}else if(n===p.TableSelectionType.TABLE_COL_SELECT){for(l=!0,h=0,d=f=u.getSelections();h<d.length;h++)if((v=d[h]).col===i&&v.row===t.Ky+c&&1===v.colCount&&v.rowCount===t.Sx-c-s){if(!E(u,t.Ky,t.endRow(),i,i,o,a))return b;l=!1}if(l&&!E(u,t.Ky+c,t.endRow()-s,i,i,o,a))return b}else if(n===p.TableSelectionType.TABLE_CORNER_SELECT){for(l=!0,m=0,g=f=u.getSelections();m<g.length;m++)if((v=g[m]).col===t.iw&&v.row===t.Ky+c&&v.colCount===t.Tx&&v.rowCount===t.Sx-c-s){if(!E(u,t.Ky,t.endRow(),t.iw,t.endColumn(),o,a))return b;l=!1}if(l&&!E(u,t.Ky+c,t.endRow()-s,t.iw,t.endColumn(),o,a))return b}else if(n===p.TableSelectionType.TABLE_SELECT&&!E(u,t.Ky,t.endRow(),t.iw,t.endColumn(),o,a))return b}return{action:n,table:t}}function R(t,n){var e=t.Ky;return n-(t.jO?e+1:e)}function K(t,n){var e;return n-t.iw}function X(t){var n=r;return t&&r++,n}function q(t){return"string"==typeof t}function $(t,n,e,i){var r;t.ki(l.Events.TableResizing,{sheet:t,table:n,oldRange:e,newRange:i})}function tt(t,n,e,i,r){var o;t.ki(l.Events.TableResized,{sheet:t,table:n,oldRange:e,newRange:i},r)}function nt(t,n,e,i,r,o,a){var e={sheet:t,table:n,propertyName:e,row:R(n,i),count:r};d(o)||(e.isAfter=o),a&&(e.deletedItem=a),t.ki(l.Events.TableRowsChanged,e)}function et(t,n,e,i,r,o){var e={sheet:t,table:n,propertyName:e,col:i-n.iw,count:r};d(o)||(e.isAfter=o),t.ki(l.Events.TableColumnsChanged,e)}function it(t,n,e){var i=0;if(t.cSt(n,e))for(i=2;t.cSt(n+i,i);)i++;return 0<i&&(n+=i),n}function rt(t){return t&&"="===t[0]}function ot(t){var n,e,i,r,n=-1;if(t)for(e=t.arguments,i=void 0,r=0;r<e.length;r++)if((i=e[r])instanceof o.obt){n=r;break}return n}function at(t,n,e){var t,i,t,r,t=t.dataRange(),i=t.row,t=t.col,r;return(e?i:t)+n}function ut(t){var n=t;return n=t&&"="===t[0]?t.slice(1):n}function st(t,n){for(var e,i,i=0;i<t.length;i++)if((e=t[i])&&n===e.col)return e;return b}function ct(t,n){var e,i,r;if(n)for(e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(t.tables&&(r=t.tables.find(e,i)))return r;return null}function ft(t,n){return n?t.tables.AB(n.row,n.col,n.rowCount,n.colCount):null}function lt(t){return d(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t}function ht(t){return t===h}Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,l=n("Core"),o=n("SheetsCalc"),a=n("CalcEngine"),e=n("Common"),i=n("./dist/plugins/table/table.ns.js"),p=n("./dist/plugins/table/table.js"),u=l.mt.T1,b=null,h=void 0,f=Math.max,d=e.Common.lt.ht,r=0,n=new e.Common.ResourceManager(i.SR,"Tables"),v=n.getResource.bind(n),t.Util={throwError:m,setFormulaToSheet:s,setValue:c,suspendPaint:g,resumePaint:w,Hyt:y,suspendCalcService:M,resumeCalcService:C,fSt:S,lSt:T,getRowCount:A,getColCount:I,isValidTableName:x,formulaToExpression:N,expressionToFormula:k,checkTableName:_,hSt:G,_4t:U,E4t:H,dSt:z,vSt:Z,mSt:W,gSt:Q,pSt:J,bSt:R,ySt:K,T4t:X,wSt:q,j4t:$,S4t:tt,jj:nt,Ej:et,MSt:it,kf:rt,CSt:ot,SSt:at,TSt:ut,ASt:st,_getTable:ct,ISt:ft,xSt:lt,NSt:ht}},"./dist/plugins/table/table.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/table/table.interface.js"),e("./dist/plugins/table/table-event.js"),e("./dist/plugins/table/table-render.js"),e("./dist/plugins/table/table-action.js"),e("./dist/plugins/table/table-util.js"),r(e("./dist/plugins/table/table-theme.js"),n),r(e("./dist/plugins/table/table.js"),n),r(e("./dist/plugins/table/table.ns.js"),n)},"./dist/plugins/table/table.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(u,A,t){"use strict";var s,f,D,Z,l,w,h,I,n,W,t,e,x,d,b,y,m,j,Q,J,g,_,K,p,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,O,N,M,C,S,dt,vt,mt,E,R,i,gt,k,T,v,pt,bt,wt,yt,Mt,F,L,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,B,P,G,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn,dn,vn,mn,gn,pn,bn,wn,yn,Mn,Cn,Sn,r,Tn,An,In,xn,t,Nn,kn,_n,Dn,jn,On,En,Rn,Fn,Ln,Bn,Pn,Gn,Un,Hn,Vn,zn,Yn,Zn,Wn,Qn,Jn,U,Kn,Xn,qn,$n,te,ne,ee,ie,re,oe,ae,ue,se,ce,fe,le,n,H,he,de,ve,me,ge,pe,be,V,we,n,ye,z,Me,Ce,Se,n,n,Te,i;function Y(t){return typeof t===an}function Ae(t,n){return t&&n&&t.color===n.color&&t.type===n.type||!t&&!n}function Ie(t,n){var e,i,r,e=!1;if(j(t[n]))e=!0;else for(r=t.length-1;n<r;r--)if(j(t[i=r-1])){e=!0;break}return e}function xe(t,n){return it(ot(t,n))}function Ne(t){return et(at(t))}function ke(o,e,a){var t=o.parent,u=dt(o);function i(t,r){y(t,function(t,n){var e,i,e=n.getExpression(),i=Z.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(e,r,-1,-1,a);i!==e&&(n.SB(i),u.invalidName(o.Uw(),n.getName()))})}t?(i(t.getCustomNames(),e),y(t.sheets,function(t,n){i(n.getCustomNames(),e)})):i(o.getCustomNames(),e),u.onAfterRemoveTable(e,a)}function _e(t,n){var e,i,n,r,e={position:D.ButtonPosition.right,imageType:D.ButtonImageType.dropdown,visibility:D.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},i,n={items:[{text:H().Table_None,value:null},{text:H().Table_Average,value:"=SUBTOTAL(101,[".concat(n,"])")},{text:H().Table_Count,value:"=SUBTOTAL(103,[".concat(n,"])")},{text:H().Table_Count_Numbers,value:"=SUBTOTAL(102,[".concat(n,"])")},{text:H().Table_Max,value:"=SUBTOTAL(104,[".concat(n,"])")},{text:H().Table_Min,value:"=SUBTOTAL(105,[".concat(n,"])")},{text:H().Table_Sum,value:"=SUBTOTAL(109,[".concat(n,"])")},{text:H().Table_StdDev,value:"=SUBTOTAL(107,[".concat(n,"])")},{text:H().Table_Var,value:"=SUBTOTAL(110,[".concat(n,"])")}]},r=new D.Style;return r.cellButtons=[e],r.dropDowns=[{type:D.DropDownType.list,option:n,submitCommand:"tableTotalRowFormula"}],r}function De(t){var n;t.tables.all().forEach(function(t){t.formulaFromJSON()})}function je(t,n,e,i,r,o,a,u,s){var t,n;t&&0<t.length&&(t=t[n])&&(n=t[r]())&&("string"==typeof n&&e&&(n=e.u8(n)),e&&(0,D.composeParentStyle)(n,n,e,!1,10,!0),ti(n,i,o,a,u,s))}function Oe(t){var t,n,n,e,t,t=t.c_[0],n=t&&t.c_&&t.c_[0];if(n)return n={kSt:{altText:n.altText,altTextSummary:n.altTextSummary}},e=t["xmlns:x14"],(t={kSt:{uri:t.uri}})["x14:table"]=n,t.kSt["xmlns:x14"]=e,{ext:t,attr:{}}}function Ee(t){if(t&&t.c_)return Oe(t)}function Re(t,n){var e,i;for(e in ve)!ve.hasOwnProperty(e)||j(t[e])||(0===(i=ve[e])?t[e]===n[e]&&(t[e]=P):1===i?Ae(t[e],n[e])&&(t[e]=P):2===i&&D.util.rfe(t[e],n[e])&&(t[e]=P))}function Fe(t,n,e,i,r,o,a){var n,e,u,t;t.Ut&&(e=(n=t.Ut.sheetModels[3].J_(n,e))&&n.style)&&o&&"string"==typeof e&&(r[e]?n.style=r[e]:(u=o.i3(e))&&((u=ni(t,u,!1,10,!0)).parentName=P,Re(u,i),t=a.Xd+a.$d+e,a.$d++,u.name=t,o.$p(u),n.style=t,r[e]=t))}function Le(t,n,e){if(t&&n){if("string"==typeof t){if(!e)return t;t=e.u8(t)}t&&((t=ni(e,t,!1,10,!0)).parentName=P,Re(t,n))}return t}function Be(t,n,e){return t[n]&&t[n][e]&&t[n][e].s}function Pe(t,n,e,i){var r=t[n]&&t[n][e];t[n]||(t[n]={}),(r=t[n][e]?r:t[n][e]={}).s=i}function Ge(t,n,e,i,r,o,a,u,s){var c,f,l,s,c,h,c,u,c=t.getStyle(e,i),f=(c&&a.lv(c))+","+(u&&u._id)+","+(s&&s._id);if(o[f])Pe(n,e,i,o[f]);else if(l=new D.Style,c||u||s){for(h in c&&l.compose(c),u&&l.compose(u),s&&l.compose(s),ve)ve.hasOwnProperty(h)&&j(l[h])&&(l[h]=r[h]);c=a.Xd+a.$d+l._id,a.$d++,l.name=c,Pe(n,e,i,u=a.getStyleIndex(l)),o[f]=u}else s=!1,Be(n,e,i)!==P&&(c=t.getValue(e,i),j(c)||(t.getStyle(-1,i)||t.getStyle(e,-1))&&(s=!0),s||Pe(n,e,i,P))}function Ue(t,n){var e,n;if(!t)return t;if(Y(t)){if(!n)return P;e=(e=n.i3(t,!1))||(n=n.parent)&&n.i3(t,!1)}else e=t;return e}function He(t,n,e,i,r,o){n&&(n.table(t),(e=e||{lossless:{}})&&(e.lossless||(e.lossless={}),!1===t.showHeader()&&(e.lossless.showTableHeader=!1),e.ref||(e.lossless.showFilterButton=!1),e.lossless.range={row:t.Ky+1,col:t.iw,rowCount:t.Sx-1-(t.showFooter()?1:0),colCount:t.Tx},n.yh(e,i,r)),t.IB!==n&&(t.IB=n),o?t.IB.reFilter():(t.DSt=!0,t._St()))}function Ve(){var t=0;return function(){return++t}}function ze(t,n){var e=t;return typeof n[t]===$n?(n[t]++,e+="_".concat(n[e])):n[t]=0,e}function Ye(t,n,e){var n,i;n[e]&&(Y(n=n[e])?t[e](n):((i=new D.Style).fromJSON(n,!1,void 0),t[e](i)))}function Ze(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,e,n,o=e.id(),a=e.name(),u=e.dataField(),s=e.value(),c=e.footerValue(),f=e.dataAreaFormula(),l=e.footerFormula(),h=e.x5t,d=e.hTt,v=e.cellType(),m=e.formatter(),g=e.dataStyle(),p=e.headerStyle(),e=e.footerStyle(),n=Dt(n,a,r);i.id(o),i.name(n),i.dataField(u),i.footerValue(c),i.dataAreaFormula(f),i.footerFormula(l),i.x5t=h,i.hTt=d,i.value(s),i.headerStyle(p),i.footerStyle(e),(x(v)||x(m))&&(g?Y(g)&&t&&(g=t.u8(g)):g=new D.Style,v!==P&&(g.cellType=v),m!==P)&&(g.formatter=m),i.dataStyle(g)}function We(t){return t&&"string"!=typeof t&&t.clone?t.clone():t}function Qe(t,n,e,i){var r,r,i;t&&(r=t.getStyle(n,e))&&i&&(r=ni(t,r),(i=ni(t,i)).borderTop=r.borderTop!==P?i.borderTop:P,i.borderBottom=r.borderBottom!==P?i.borderBottom:P,i.borderLeft=r.borderLeft!==P?i.borderLeft:P,i.borderRight=r.borderRight!==P?i.borderRight:P,i.compose(r),t.setStyle(n,e,i))}function Je(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,u=o.layoutStyle(),s=o.headerIndex(),c=o.footerIndex(),f=o.startColumn(),l=e;l<=r;l++)for(a=o.columnLayoutStyle(l-f),h=n;h<=i;h++)h===s?(u.header&&Qe(t,h,l,u.header),null!=a&&a.header&&Qe(t,h,l,a.header)):h===c?(u.footer&&Qe(t,h,l,u.footer),null!=a&&a.footer&&Qe(t,h,l,a.footer)):(u.data&&Qe(t,h,l,u.data),null!=a&&a.data&&Qe(t,h,l,a.data))}function Ke(t,n,e){var i;13===n.type&&(null==(i=n.baseTable)?void 0:i.name())===e&&(n.baseTable=t)}function Xe(n,t,e){var t;Ke(n,t,e),null!=(t=t.arguments)&&t.forEach(function(t){Xe(n,t,e)})}function qe(t,n,e,i,r,o,a){t.borderLeft=n,t.borderTop=e,t.borderRight=i,t.borderBottom=r,t.borderHorizontal=o,t.borderVertical=a}function $e(t,n,e){t[n]===P&&e!==P&&(t[n]=e)&&"object"==typeof e&&(t[n].level=20)}function ti(t,n,e,i,r,o){var a=t[re],u=t[ae],s=t[oe],c=t[ue],f=t[se],l=t[ce];qe(t),n.h5(t),i&&$e(n,re,a),e&&$e(n,oe,s),o&&$e(n,ae,u),r&&$e(n,ue,c),$e(n,oe,f),$e(n,ue,f),$e(n,re,l),$e(n,ae,l),qe(t,a,s,u,c,f,l)}function ni(t,n,e,i,r){var o=new D.Style;return(n=n&&n.charAt?t.u8(n):n)&&(o.h5(n),(0,D.composeParentStyle)(n,o,t,e,i,r)),o}function ei(t,n,e,i,r,o,a){i&&t?(Y(t)&&(t=ni(o,t)),(n=Y(n)?ni(o,n):n)?(n=n.clone()).compose(t):n=t,r[e+fe]=a.getDxfIndex(n,!0)):n&&(Y(n)?r[e+le]=n:(r[e+fe]=a.getDxfIndex(n,!0),n.parentName&&(r[e+le]=n.parentName)))}function c(t,n,e,i,r,o,a){var u,s,u=this;for(u.jO=!a||a.showHeader===P||a.showHeader,u.oL=!(!a||a.showFooter===P)&&a.showFooter,u.ESt=!(!a||a.useFooterDropDownList===P)&&a.useFooterDropDownList,u.jSt=!(!a||a.showResizeHandle===P)&&a.showResizeHandle,u.OSt=[],u.H3=B,u.IB=B,u.jS=B,u.RSt=!1,x(t)&&u.name(t),u.Ky=x(n)?n:-1,u.iw=x(e)?e:-1,u.Sx=x(i)?i:-1,u.Tx=x(r)?r:-1,x(o)&&u.style(o),u.BSt=[],s=0;s<u.Tx;s++)u.BSt.push(new z(s+1));u.LSt=B,u.FSt={},u.PSt=[],u.aj=[],u.GSt=[],u.USt=[],u.HSt=[],u.zSt=[],u.VSt=!0}function ii(t,n){var t,e,t=t&&t.rowFilter&&t.rowFilter();return!j(t)&&(e=t.range).intersect(n.row,n.col,n.rowCount,n.colCount)}function ri(r){return function(t,n){var e=this,i=e.Mf;i&&t!==n&&(V.et(i,"tableNameChanged",{oldName:n,newName:t}),i.Ut.YSt(e,r,n,t),i.repaint())}}function oi(t,n){var e=this;e.dl(),ri("style").call(e,t,n)}function ai(t,n,e,i,r){t.Qy().execute({cmd:Bn,sheetName:t.name(),tableName:n.name(),row:e,count:i,isAfter:r})}function ui(t,n,e,i,r){t.Qy().execute({cmd:Pn,sheetName:t.name(),tableName:n.name(),row:e,count:i,isAfter:r})}function si(t,n){t.Qy().execute({cmd:Gn,sheetName:t.name(),tableName:n.name()})}function ci(t){var n,n;if(!j(t))return n=/\[\S[\S\s]*\S\]/,"SUBTOTAL("!==(t=t.trim()).substr(0,9)||!n.test(t)||t.indexOf("[[")?"custom":(n=t.substring(9,12),we[n]||ne)}function fi(t){return-1<t.indexOf("LET(")}function o(t){var n,e,n=Te.call(this)||this,e=n;return e.table(t),e.act=!1,n}function li(t){var n=t.dataStyle();return n||(n=new D.Style,t.dataStyle(n)),n}function hi(t,n,e,i,r,o,a,u,s){var c=this;c.id(t),c.dataField(n),c.name(e||n||Tn+c.id()),c.dataStyle(u),x(i)&&c.formatter(i),x(r)&&c.cellType(r),c.value(o),c.headerStyle(a),c.footerStyle(s)}function di(t,n){for(var e,i,e=n.row;e<n.row+n.rowCount;e++)for(i=n.col;i<n.col+n.colCount;i++)if(!j(t.getValue(e,i)))return;return 1}function a(t){this.Mf=t,this.U3=[],this.xl=[],this.Nl=[]}function vi(t,n){var t,e;return"Object"===n.constructor.name&&(t=t.findByName(n.tableName))&&(t.H3?n=t.H3:((e=new I.$$).fromJSON(n),t.H3=n=e)),n}function mi(t,n,e,i,r){for(var r,o,a,u,s,r=0===r,o=r?t.aj:t.GSt,a=-1,s=0;s<o.length;s++)if((u=o[s])&&u.key===i){a=s;break}-1<a&&o.splice(a,j(e)?1:e),r&&t.ZSt()}function gi(t,n){var n,e,i,t,n;n.refresh(),t&&(n=t.table,e=t.row,i=t.count,t=t.stateType,n=n.getSlicerData())&&(0===t?n.onRowsAdded(e,i):n.onRowsRemoved(e,i))}function pi(t,n,e){var i,r,o;if(n)for(i=n.length-1;0<=i;i--)o=vi(t,(r=n[i]).bindingManager),e?o.wtt(r):o.Mtt(r)}function bi(t,n){var e=new V;return e.Sg(t),e.fromJSON(n),e}function wi(t,n){var e,i;if(n)for(e=0;e<n.length;e++)(i=n[e])&&"Object"===i.constructor.name&&(n[e]=t.findByName(i.name),n[e]||(n[e]=bi(t,i)))}function yi(t,n){for(var e,i,e=0;e<n.length;e++)(i=n[e]).table&&"Object"===i.table.constructor.name&&(i.table=t.findByName(i.table.name)),wi(t,i.tableList),wi(t,i.changedTables)}s=this&&this.__extends||(Se=function(t,n){return(Se=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Se(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(A,"__esModule",{value:!0}),A.TableRemoveOptions=A.TableManager=A.TableColumn=A.WSt=A.hasRowFilter=A.Table=A.TableSelectionType=void 0,D=t("Core"),Z=t("SheetsCalc"),l=t("Common"),w=t("CalcEngine"),h=t("Filters"),I=t("Bindings"),n=t("./dist/plugins/table/table.ns.js"),W=t("./dist/plugins/table/table-theme.js"),t=t("./dist/plugins/table/table-util.js"),e=D.mt.p0,x=D.mt.T1,d=D.mt.j,b=D.GC$.inArray,y=D.GC$.each,m=D.GC$.isEmptyObject,j=l.Common.lt.ht,Q=l.Common.ct,J=l.Common.Uf.OS,g=l.Common.kh,_=D.mt.xr,K=D.mt.go,p=D.mt.c1,X=D.mt.St,q=D.CopyToOptions.all,$=D.StorageType.data|D.StorageType.style|D.StorageType.comment|D.StorageType.tag|D.StorageType.sparkline|D.StorageType.axis|D.StorageType.bindingPath|D.StorageType.hyperlink|D.StorageType.altText,tt=D.NodeHelper.sr,nt=D.NodeHelper.ur,et=D.mt.n1,it=D.mt.vo,rt=D.Util.gr,ot=D.Util.pr,at=D.Util.io,ut=D.Util.mr,st=D.Util.addXLFNPrefix,ct=D.Util.wr,ft=D.Util.Sr,lt=D.Util.po,ht=D.Util.yo,O=t.Util.throwError,N=t.Util.setFormulaToSheet,M=t.Util.setValue,C=t.Util.suspendPaint,S=t.Util.resumePaint,dt=t.Util.Hyt,vt=t.Util.suspendCalcService,mt=t.Util.resumeCalcService,E=t.Util.getRowCount,R=t.Util.getColCount,i=t.Util.checkTableName,gt=t.Util.isValidTableName,k=t.Util.formulaToExpression,T=t.Util.expressionToFormula,v=t.Util.hSt,pt=t.Util._4t,bt=t.Util.E4t,wt=t.Util.dSt,yt=t.Util.vSt,Mt=t.Util.mSt,F=t.Util.gSt,L=t.Util.pSt,Ct=t.Util.bSt,St=t.Util.ySt,Tt=t.Util.T4t,At=t.Util.wSt,It=t.Util.fSt,xt=t.Util.lSt,Nt=t.Util.jj,kt=t.Util.Ej,_t=t.Util.S4t,Dt=t.Util.MSt,jt=t.Util.kf,Ot=t.Util.CSt,Et=t.Util.SSt,Rt=t.Util.TSt,Ft=t.Util.ASt,Lt=t.Util.ISt,Bt=t.Util.xSt,Pt=t.Util.NSt,Gt=D.range_parser.getRangeString,Ut=D.range_parser.Dc,Ht=D.range_parser.jc,B=null,P=void 0,G=Math.min,Vt=Math.ceil,zt=Math.max,Yt=JSON.stringify,Zt=JSON.parse,Xt="highlightFirstColumn",qt="highlightLastColumn",$t="bandRows",tn="bandColumns",nn="autoGenerateColumns",un="headerRowStyle",sn="footerRowStyle",cn="wholeTableStyle",fn="highlightLastColumnStyle",ln="highlightFirstColumnStyle",hn="firstRowStripStyle",dn="secondRowStripStyle",vn="firstColumnStripStyle",mn="secondColumnStripStyle",gn="firstHeaderCellStyle",pn="lastHeaderCellStyle",bn="firstFooterCellStyle",wn="lastFooterCellStyle",yn="firstRowStripSize",Mn="secondRowStripSize",Cn="firstColumnStripSize",Sn="secondColumnStripSize",r=".table",Tn="Column",t="dataAreaFormulaStr",Nn="isArrayFormula",Dn="footerRowStyles",jn=[An="id",Wt="name",Qt="cellType",Jt="value",Kt="formatter",In="dataField",xn="footerFormula",kn="dataAreaFormula",_n="footerValue",rn="headerStyle",en="dataStyle",on="footerStyle"],On=4,En=2,Rn="table",Fn="tableResize",Ln="#485DB1",Bn="tableInsertRows",Pn="DoInsertRows",Gn="tableShowFooter",Un="tableDeleteRows",Hn="tableInsertColumns",Vn="tableDeleteColumns",zn="collection",Yn="tableColumn",Zn="property",Wn="dataSource",Qn="rowsChange",Jn="showFooter",U="range",Kn="columns",Xn="tableExpression",qn="sheetExpression",$n="number",te=an="string",ne="custom",ee=D.XFileConstants.Ki,ie=D.XFileConstants.Bu,re="borderLeft",oe="borderTop",ae="borderRight",ue="borderBottom",se="borderHorizontal",ce="borderVertical",fe="DxfId",le="CellStyle",n=new l.Common.ResourceManager(n.SR,"Tables"),H=n.getResource.bind(n),he=D.UsedRangeUtil.hh,de=D.UsedRangeUtil.vh,ve={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},me=D.W.upe,(n=ge=A.TableSelectionType||(A.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",n.TABLE_COL_SELECT="tableColSelect",n.TABLE_CORNER_SELECT="tableCornerSelect",n.TABLE_SELECT="tableSelect",(n=pe=pe||{})[n.deleted=0]="deleted",n[n.dirty=1]="dirty",D.Worksheet.ch(Rn,{priority:2e3,getUsedRange:function(t){var n,e,i;t.type&D.UsedRangeType.table&&(i=(e=(n=this).tables).getUsedRange(),de(t.range,i))},init:function(){var d=this;d.tables=d.Ut.QSt,d.unbind(r),d.bind(D.Events.BeforeDragDrop+r,function(t,n){var e,i,r,o,a,u,s,e,c,e,f,l,h,f,e=d,i=d.tables,r=H().Exp_DragDropChangePartOfTable,o=n.fromRow,a=n.fromColumn,u=E(n),s=n.columnCount,e=e.rt.q6,c=e.row,e=e.col,f=n.isDragInsert,l=n.isDragCopy,h=B;!f||-1!==o&&-1!==a||(0<=a?(d.isDragCopy&&(e<=a||a+s<=e)||!l&&(e<a||a+s<e))&&(f=!1,i.oSt(-1,e,-1,1)&&(f=!0,h=H().Exp_DragDropShiftTableCell),f||l||!i.oSt(-1,a,-1,s)||(h=r)):0<=o&&a<0&&(l&&(c<=o||o+u<=c)||!l&&(c<o||o+u<c))&&!l&&i.oSt(o,-1,u,-1)&&(h=r)),n.invalidMessage=h}),d.bind(D.Events.RowChanged+r,function(t,n){var e,i,r,e=d.tables,i=e.xl,r=n.propertyName;"isVisible"===r?(!1===n.newValue?i[n.row]=0:i[n.row]=P,e.KSt(n.row)):"height"===r&&(i[n.row]=P,e.KSt(n.row))}),d.bind(D.Events.RowHeightChanged+r,function(t,n){for(var e,i,r,o,a,u,s,e=d.tables,i=e.xl,r=0,o=n.rowList;r<o.length;r++)i[a=o[r]]=P,s=(u=n.sheet).getRowHeight(a),e.KSt(a,0<s)}),d.bind(D.Events.ColumnChanged+r,function(t,n){var e,i,e=d.tables,i=e.Nl;"isVisible"===n.propertyName?(!1===n.newValue?i[n.col]=0:i[n.col]=P,e.JSt(n.col)):"width"===n.propertyName&&(i[n.col]=P,e.JSt(n.col))}),d.bind(D.Events.ColumnWidthChanged+r,function(t,n){for(var e,i,r,o,a,e=d.tables,i=e.Nl,r=0,o=n.colList;r<o.length;r++)i[a=o[r]]=P,e.JSt(a)}),d.bind(D.Events.RangeFiltered+r,function(t,n){for(var e,i,r,o,e=d.tables,i=e.xl,r=n.sheet.IB.range,o=0;o<r.rowCount;o++)i[r.row+o]=P,e.KSt(r.row+o)}),d.bind(D.Events.TableFiltered+r,function(t,n){for(var e,i,r,o,e=d.tables,i=e.xl,r=n.table.range(),o=0;o<r.rowCount;o++)i[r.row+o]=P,e.KSt(r.row+o)}),d.bind(D.Events.TableFilterCleared+r,function(t,n){var e;d.tables.dl()}),d.Q1i&&d.bind(D.Events.RangeChanged+r,function(t,n){var e,i,r,e=n.changedCells;if(e){if(d.pmi(),1500<e.length)d.tSe(e);else for(i=0;i<e.length;i++)r=e[i],d.Q1i(r.row,r.col,1,1,r.sheetArea);d.Smi()}})},resetBinding:function(t){this.tables.XSt()},initBinding:function(t){var n,e,i,r,o,a,n=this,e=n.tables;for(e.XSt(),vt(n),r=0,o=(i=e.all()).length;r<o;r++)(a=i[r])&&a.qSt();mt(n)},dispose:function(t){!1!==t.clearCache&&(this.unbind(r),this.tables)&&(this.tables.L0(),this.tables=null)},clearPendingChanges:function(){var t=this.tables;t&&t.$St()},onGroupChanged:function(t){var n,e,i,r,n,e=this.tables;if(t.fromSetCollapsed)for(i=t.isRow?e.xl:e.Nl,r=t.start;r<=t.end;r++)i[r]=P,t.isRow?e.KSt(r):e.JSt(r)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea,u,s=this.tables;"setRowCount"===n||"setColumnCount"===n?s.dl():!j(a)&&3!==a||("addRows"===n?(s.JO(e,i),s.dl()):"addRows2"===n?s.t5t(e,i):"deleteRows"===n?(s.xP(e,i),s.dl()):"addColumns"===n?(s.qO(r,o),s.dl()):"deleteColumns"===n?(s.NP(r,o),s.dl()):"addColumns2"===n||"deleteColumns2"===n?s.n5t(r):"clear"!==n||t.ignoreTable||s.d5(e,r,i,o,t.type))},toJson:function(t,n){var e,i,r,o,r;function a(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,w,e=t.tables.all(),i=0,r=e.length;i<r;i++)if(a=(o=e[i]).z3(),s=(u=o.dataRange()).row,c=u.col,f=s+E(u)-1,l=c+R(u)-1,a){if(h=[],(d=o.BSt)&&0<d.length)for(v=0;v<d.length;v++)g=(m=d[v]).formatter(),j(g)||X(g)||((p=new D.Style).formatter=g,h[v]=p);for(b=s;b<=f;b++)for(v=c;v<=l;v++)(w=o.Sl(b,v)).e5t&&(w=w.y4,Q.W0(w)&&(w=Q.Q0(w)),t.s8(n,b,v,w,P,h[v-c]))}}i=(e=this).tables,r=n&&n.ignoreStyle,o=n&&n.newWorkSheetName,r||(i&&(t.tables=i.toJSON(o,n)),n&&n.includeBindingSource&&((r=t.data).dataTable=r.dataTable||{},a(e,r.dataTable)))},wh:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,T,A,I,x,N,k,i=this,r=i.tables,o=e&&!1===e.includeStyles,a=n.styleManager;if(r&&!o){if(r.wh(t),e&&e.includeBindingSource)for(s=0,c=(u=r.all()).length;s<c;s++)if(l=(f=u[s]).z3(),d=(h=f.dataRange()).row,v=h.col,m=d+E(h)-1,g=v+R(h)-1,l){if(p=[],(b=f.BSt)&&0<b.length)for(w=0;w<b.length;w++)M=(y=b[w]).formatter(),j(M)||X(M)||((C=new D.Style).formatter=M,p[w]=a.getStyleIndex(C));for(S=d;S<=m;S++)for(w=v;w<=g;w++)(T=f.Sl(S,w)).e5t&&(T=T.y4,Q.W0(T)&&(T=Q.Q0(T)),i.c8(t,S,w,T,n.sharedStrings,A=p[w-v]))}if(e&&D.OpenSaveFileType.excel===e.fileType&&(x=(I=r.U3).length,N=_(t,"sheetData"),k=n.defaultStyle,N)&&k)for(s=0;s<x;s++)(f=I[s]).M1e(N,k,a,i)}},fromJson:function(t,n,e){var i,r,o,o,e,i,r=this.tables,o=t.tableManager,o=n?o&&o.tables:t.tables,e=e&&e.ignoreStyle;x(o)&&!e&&r&&r.fromJSON(o,n,t.isApplyRefilter)},fromJsonAfterFormula:function(t,n,e){De(this)},fromJsonAfterSJSFormula:function(t){De(this)},yh:function(t,n,e){var i,r=e&&!1===e.includeStyles,o=this.tables,a=_(t,ie),t=t.rels;x(a)&&x(t)&&!r&&o&&o.yh(a,t,n,e)},lastNonNullRowAndCol:function(){var t,n,e,i,r,o,a,u,u,s,s,t,n,e=0,i=0,r=this.tables.all();if(r)for(o=0,a=r.length;o<a;o++)(u=r[o])&&(e<(s=(u=u.range()).row+E(u)-1)&&(e=s),i<(s=u.col+R(u)-1))&&(i=s);return{lastNonNullRow:e,lastNonNullCol:i}},paintCell:function(t){var n,e,i,t,r,o,e,a,e,r,a,o,e,t,n,t,u,s,n=this;t.isPrinting||t.sheetArea!==D.SheetArea.viewport||n.isActualProtected()||(e=n.tables,i=t.ctx,r=(t=t.cell).row,o=t.col,(e=e.find(r,o))&&e.showResizeHandle()&&!e.QL()&&(a=pt(n,e),e=bt(n,e),r===a)&&o===e&&(r=t.x,a=t.y,o=t.width,e=t.height,t=n.zoom(),n=Vt(4*t),t=Vt(2*t),u=r+o,s=a+e,i)&&0<o&&0<e&&(i.save(),i.rect(r,a,o,e),i.clip(),i.fillStyle=Ln,i.beginPath(),i.moveTo(u-n,s),i.lineTo(u,s),i.lineTo(u,s-t),i.lineTo(u-n,s-t),i.fill(),i.beginPath(),i.moveTo(u,s-t),i.lineTo(u-t,s-t),i.lineTo(u-t,s-n),i.lineTo(u,s-n),i.fill(),i.restore()))},composeTableFooterList:function(t){var n=t.table,e=t.row,i=t.col,t=t.style;n.i5t(e,i,t)},refSheetLazyLoaded:function(t,o,a){var n,e,t,i,u,n,e=this.tables.all();0<e.length&&A.WSt&&(t=t.rels.c_.filter(function(t){return t.Type===D.RelationshipConstants.lc}).map(function(t){return D.Util.vr(t.Target)}),i=o.tables,u={},D.GC$.each(t,function(t,n){var n=i[n];n&&(u[n.name]=n)}),D.GC$.each(e,function(t,n){var e,i,e,r,e=u[n.name()];e&&(i=_(e,"autoFilter"),e=_(e,"sortState"),He(n,r=n.IB||new A.WSt,i,e,o.styleManager),a.isApplyRefilter)&&n.IB.reFilter()}))}}),D.Worksheet.prototype.jj=function(t,n,e,i,r,o){var o=o?P:t.tq();Nt(this,t,n,e,i,r,o)},D.Worksheet.prototype.Ej=function(t,n,e,i,r){kt(this,t,n,e,i,r)},D.Worksheet.prototype.S4t=function(t,n,e){_t(this,t,n,e,!0)},D.Workbook.prototype.r5t=function(t){var n,e,e,i,n=this.sheets;if(n)for(i=0;i<n.length;i++)if((e=n[i].tables)&&(e=e.findByName(t)))return e;return B},be=Ve(),c.prototype.L0=function(){var t=this;t.BSt=[],t.OSt=[],t.aj=[],t.GSt=[],t.USt=[],t.FSt={},t.PSt=[],t.Mf=B,t.jS=B,t.IB&&(t.IB.L0(),t.IB=B),t.dl()},c.prototype.dl=function(){this.HSt=[],this.zSt=[]},c.prototype.range=function(){var t=this;return(0,D.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},c.prototype.dataRange=function(){var t,n,e,t=this,n=t.jO?t.Ky+1:t.Ky,e=t.jO?t.Sx-1:t.Sx;return t.oL&&e--,(0,D.Ec)(n,t.iw,e,t.Tx)},c.prototype.headerIndex=function(){return this.jO?this.Ky:-1},c.prototype.footerIndex=function(){return this.oL?this.Ky+this.Sx-1:-1},c.prototype.showHeader=function(t){var n,e,n=this;return 0===arguments.length?n.jO:(n.jO!==t&&((e=n.Mf)&&e.suspendPaint(),n.o5t(t),e)&&e.resumePaint(),n)},c.prototype.layoutStyle=function(t){var n,e,i,r,o,a,u,t,s,c,n=this,e=n.Kpe,i=n.Jpe,r=n.Xpe;return 0===arguments.length?{data:We(e),header:We(i),footer:We(r)}:((o=n.Mf).suspendPaint(),t=t?(u=t.data,a=t.header,t.footer):a=u=B,!o||i===a&&e===u&&r===t||(o.Ut.YSt(n,"layoutStyle",s={data:e,header:i,footer:r},c={data:u,header:a,footer:t}),n.Jpe=a,n.Kpe=u,n.Xpe=t),o.resumePaint(),n)},c.prototype.o5t=function(t){var n,e,i,r,n=this,e=n.Mf;e&&e.Ut.YSt(n,"showHeader",n.jO,t),(i=n.jO=t)?(0<n.Ky&&(n.Ky=n.Ky-1,n.Sx+=1),n.a5t()):(r=n.Ky,n.Ky=n.Ky+1,--n.Sx,n.u5t(r),n.s5t()),e&&w&&e.recalcRange(n.Ky+(t?0:-1),n.iw,1,n.Tx)},c.prototype.showFooter=function(t,n){var e,i,e=this;if(0===arguments.length)return e.oL;if(e.oL!==t){(i=e.Mf)&&i.suspendPaint();try{e.c5t(t,n||!1)}finally{i&&i.resumePaint()}}return e},c.prototype.expandBoundRows=function(t){var n=this;return 0===arguments.length?n.RSt:(n.RSt!==t&&(n.RSt=t),n)},c.prototype.c5t=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,i=e.Mf;if(i&&i.Ut.YSt(e,Jn,e.oL,t),r=e.Sx,t){if((!i||e.Ky+r<i.getRowCount())&&(!n||e.f5t(!0,r)))for(e.oL=t,e.Sx+=1,a=(o=e.BSt).length,u=e.footerIndex(),s=e.iw,c=0;c<a;c++)h=s+c,(l=(f=o[c])&&f.footerFormula())&&(d=T(i,l,u,h))&&(l=k(i,d,u,h),f.footerFormula(l));e.l5t()}else e.oL=t,v=e.Ky+r-1,--e.Sx,e.u5t(v),e.I4t(),e.cL(0),n&&e.f5t(!1,r);i&&w&&i.recalcRange(e.Ky+e.Sx+(t?-1:0),e.iw,1,e.Tx)},c.prototype.f5t=function(t,n){var e,i,n,r,o,a,u,s,c,e=this,i=e.Mf,n=e.Ky+n,r=e.iw,o=e.Tx,a=r+o-1,u=wt(i,e),s=n<=u;return!(t&&Mt(i,e,n,u,r,a,1)||(s&&i.moveTo(n,r,c=t?n+1:n-1,r,u-n+1,o,q),0))},c.prototype.h5t=function(t){for(var n,e,i,r,o,a,u,s,c,f,n=this,e=n.BSt,i=e.length,r=n.iw,o=[],a=n.name(),u=0;u<i;u++)s=r+u,c=n.getColumnName(u),o.push(_e(a,c)),t||(0===u?n.d5t(s,H().Table_Total,!0):u!==i-1||(f=e[u].footerFormula())||(n.v5t(s)?n.m5t(u,"=SUBTOTAL(109,".concat(a,"[").concat(c,"])")):n.m5t(u,"=SUBTOTAL(103,".concat(a,"[").concat(c,"])"))));n.OSt=o},c.prototype.v5t=function(t){for(var n,e,n,i,r,o,a,u,n=this,e=n.Mf,n=n.dataRange(),i=!0,r=n.rowCount,o=n.row,a=0;a<r;a++)if(u=e.getValue(o+a,t),!j(u)&&typeof u!==$n){i=!1;break}return i},c.prototype.g5t=function(){return this.OSt&&0<this.OSt.length},c.prototype.p5t=function(t,n,e){var i=this,r=this.Mf;i.g5t()&&(r&&r.Ut.YSt(i,Dn,i.b5t(),e),0<=n)&&(e?i.OSt.splice(t,n,e):i.OSt.splice(t,n))},c.prototype.b5t=function(){var t,n=this.OSt,e=[];return n.forEach(function(t){t&&e.push(t.clone())}),e},c.prototype.y5t=function(t,n,e){var i=this,e=x(e)?_e(i.name(),e):B;i.g5t()&&i.p5t(t,n,e)},c.prototype.useFooterDropDownList=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.ESt:(e&&(e.suspendPaint(),n.ESt!==t&&(e.Ut.YSt(n,"useFooterDropDownList",n.ESt,t),n.ESt=t,n.ESt)&&!n.g5t()&&(n.h5t(),n.w5t()),e.resumePaint()),n)},c.prototype.showResizeHandle=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.jSt:(e&&(e.suspendPaint(),n.jSt!==t&&(e.Ut.YSt(n,"showResizeHandle",n.jSt,t),n.jSt=t),e.resumePaint()),n)},c.prototype.rowFilter=function(){var t=this;return!t.IB&&A.WSt&&(t.IB=new A.WSt(t),t.IB.Uct(t.dataRange())),t.IB},c.prototype.bindColumns=function(t){var n,e,i,r,o,a,u,s,n=this,e=n.Mf,i=[];if(t){for(r=t.length,n.autoGenerateColumns()||(r=G(n.Tx,t.length)),n.jO&&e.KI(n.Ky,n.iw,1,r,3,17,P,!0),o=0;o<r;o++)(a=n.BSt[o])||(a=new z(n.M5t()),n.BSt[o]=a),Ze(e,n,t[o],a,o),u=a.dataField(),s={name:a.name(),value:a.value(),dataField:u},u&&i.push(s),n.y5t(o,1,a.name());n.vTt()}n.C5t=i,n.gTe(i)},c.prototype.bindingPath=function(t){var n=this;return 0===arguments.length?n.S5t:(n.S5t=t,n.qSt(),n)},c.prototype.bind=function(t,n,e){var i,r,i=this,r=e;return j(t)||i.bindColumns(t),j(e)&&(r=i.z3()),n&&(i.S5t=n,r=(0,I.q$)(r,n)),I.$$&&r&&i.T5t(r),i},c.prototype.getColumn=function(n){return this.BSt.find(function(t){return t.name()===n})},c.prototype.getColumnName=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.name())!==B?d(t):t:B},c.prototype.setColumnName=function(t,n){var e,i,i,r,o,e=this;return e.cSt(n)||(i=e.BSt)&&0<=t&&t<i.length&&(r=(i=(i=i[t])||(e.BSt[t]=new z(e.M5t()))).name(),o=e.Mf,r!==n&&o&&(o.Ut.A5t(e,i,"name",r,n),i.name(n)),e.jO&&o&&o.setText(e.headerIndex(),e.iw+t,n),e.I5t(r,i.name(),t)),e},c.prototype.I5t=function(t,n,e){var i,r,o,i,i=this,r,o=i.BSt[e];i.y5t(e,1,o.name()),(i=this.LSt)&&i.onColumnNameChanged(t,n)},c.prototype.autoBind=function(){var t=this,n=t.z3();t.gTe(B),I.$$&&n&&(t.yTe=!0,t.T5t(n),delete t.yTe)},c.prototype.refreshBinding=function(){var t,n,e,e,i,i,t=this;t.QL()&&(n=t.dataRange(),0<(e=t.pTt()))&&e!==E(n)&&(e=e,t.showHeader()&&(e+=1),t.showFooter()&&(e+=1),i=t.range(),i=(0,D.Ec)(i.row,i.col,e,R(n)),t.K5t(i,!0))},c.prototype.gTe=function(t,n){var e,n,e,i,e=this,n=n||e.H3;n&&(i=void 0,(e=e.Mf.Ut.G8)&&!(i=e.tableChanges)&&(e.tableChanges=i=[]),n.gTe(t,i))},c.prototype.setColumnDataField=function(t,n){var e,i,i,t,r,t,e=this,i=e.BSt;return i&&0<=t&&t<i.length&&(i=(i=i[t])||(e.BSt[t]=new z(e.M5t())),t=e.Mf,r=i.dataField(),t&&n!==r&&t.Ut.A5t(e,i,"dataField",r,n),i.dataField(n),t=e.z3(),I.$$)&&t&&e.T5t(t),e},c.prototype.getColumnDataField=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.dataField())!==B?d(t):t:B},c.prototype.getColumnFormula=function(t){var n,e,n,i,t,n,n=this.BSt,e=this.Mf;return n&&e&&0<=t&&t<n.length&&(n=n[t])?(i=this.footerIndex(),t=this.iw+t,(n=n.footerFormula())&&T(e,n,i,t,!1)):B},c.prototype.setColumnFormula=function(t,n){return this.m5t(t,n),this},c.prototype.setColumnDataFormula=function(t,n){var e,i,i,r,o,a,u,s,c,f,l,h,t;if(w){if((i=(e=this).BSt)&&0<=t&&t<i.length&&(i=i[t])){r=e.Mf,C(r),vt(r),o=t+e.iw,a=e.Ky,u=e.Sx;try{for(e.showHeader()&&(a++,u--),e.showFooter()&&u--,s=k(r,n,a,o,!0),c=i.dataAreaFormula(),r&&s!==c&&r.Ut.A5t(e,i,"dataAreaFormula",c,s),i.x5t(n),i.dataAreaFormula(s),f=a;f<a+u;f++)l=r.getFormula(f,o),N(r,f,o,n,s),n||(h=c&&T(r,c,f,o),(l=l&&T(r,k(r,l,f,o),f,o))===h&&r.Ut.setValue(f,o,B))}finally{r.Lp.resume(!(t=function(t){return t.w3===r.oMt&&t.row>=a&&t.row<a+u&&t.column===o}),P,t),S(r)}}return e}},c.prototype.getColumnValue=function(t){var n,e,e,i,n=this,e=n.BSt;return e&&0<=t&&t<e.length&&(e=e[t])?n.oL&&e.footerFormula()&&(i=n.Mf)?i.getValue(n.footerIndex(),n.iw+t):e.footerValue():B},c.prototype.setColumnValue=function(t,n){var e,i,r,i,o,e=this,i=e.BSt,r=e.Mf;return i&&0<=t&&t<i.length&&((i=i[t])&&(o=i.footerValue(),r&&n!==o&&r.Ut.A5t(e,i,"footerValue",o,n),i.footerValue(n)),e.oL)&&r&&M(r,e.footerIndex(),e.iw+t,n),e},c.prototype.columnLayoutStyle=function(t,n){var e,i,i,t,r,o,a,u,s,c,e=this,i=e.BSt;return!(j(t)||t<0||t>=i.length)&&(i=i&&i[t])?(t=i.headerStyle(),r=i.dataStyle(),o=i.footerStyle(),n===P?{header:We(t),data:We(r),footer:We(o)}:(c=s=u=void 0,(a=e.Mf).suspendPaint(),c=n?(u=n.header,s=n.data,n.footer):s=u=n,!a||t===u&&r===s&&o===c||(a.Ut.A5t(e,i,rn,t,u),a.Ut.A5t(e,i,en,r,s),a.Ut.A5t(e,i,on,o,c),i.headerStyle(u),i.dataStyle(s),i.footerStyle(c)),a.resumePaint(),e)):e},c.prototype.filterButtonVisible=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.Mf,r=e.rowFilter(),o=e.Tx,a=arguments;switch(a.length){case 0:return r&&r.filterButtonVisible();case 1:if("number"==(s=typeof(u=a[0])))return u<0||o<=u?void 0:r&&r.filterButtonVisible(u);if("boolean"==s&&r){for(C(i),c=0;c<e.Tx;c++)r.filterButtonVisible(c,u);S(i)}return e;case 2:return t<0||o<=t?void 0:(r&&r.filterButtonVisible(t,n),e)}},c.prototype.allowAutoExpand=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.VSt:(n.VSt!==t&&(e.Ut.YSt(n,"allowAutoExpand",n.VSt,t),n.VSt=t),n)},c.prototype.N5t=function(){return!!this.LSt},c.prototype.Sg=function(t){var n=this,e=n.jS;n.k5t(t),n.Mf&&n.Mf.Ut&&n.Mf.Ut.D5t(n,e)},c.prototype.k5t=function(t){var n,e,n=this;n.jS=t,n.Mf=t&&t.Mf,e=n.IB,t&&e&&e.Mf!==t.Mf&&e.table(n)},c.prototype._5t=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,n=this,e=n.Mf,i=e.getDefaultStyle(),r=n.Ky,o=n.iw,a=n.Sx,u=n.Tx,s={},c=e.parent,f=n.jO?1:0,l=f+(n.oL?1:0),h=0;h<u;h++)for(d=h+o,n.jO&&Fe(e,r,d,i,s,c,t),n.oL&&Fe(e,n.footerIndex(),d,i,s,c,t),v=0;v<a-l;v++)Fe(e,v+r+f,d,i,s,c,t)},c.prototype.M1e=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,r=this,o=r.Ky,a=r.iw,u=r.Sx,s=r.Tx,c={},f=r.jO?1:0,l=f+(r.oL?1:0),h=r.layoutStyle();for(h&&(d=Ue(h.header,i),v=Ue(h.data,i),m=Ue(h.footer,i)),g=0;g<s;g++)for(p=g+a,M=y=w=void 0,(b=r.columnLayoutStyle(g))&&(w=Ue(b.header,i),y=Ue(b.data,i),M=Ue(b.footer,i)),r.jO&&Ge(i,t,o,p,n,c,e,w,d),r.oL&&Ge(i,t,r.footerIndex(),p,n,c,e,M,m),C=0;C<u-l;C++)Ge(i,t,C+o+f,p,n,c,e,y,v)},c.prototype.E5t=function(t){var n=this,i=[];y(n.BSt,function(t,n){var e=n.dataField();e&&i.push({name:n.name(),value:n.value(),dataField:e})}),0<i.length&&(n.C5t=i,n.gTe(i,t))},c.prototype.Woe=function(t){var n,e,i,r,i,t,o,n=this,e=n.Mf,i=n.dataRange(),r=i.row,i=E(i),t=t.getRowCount();i<t?n.RSt?(n.cue=!0,e.addRows(r+i,t-i),delete n.cue):((o=e.H3)&&o.Ctt&&(o.Stt=!0),n.mTt=!0,0===i?n.zpt(r,t,P,!0,!0):n.zpt(r+i-1,t-i,!0,!0,!0),delete n.mTt):t<i&&(n.RSt?e.deleteRows(r+t,i-t):(n.mTt=!0,n.yE(r+t,i-t,!0),delete n.mTt))},c.prototype.D3=function(t){var n,e,i,r,o,a,u,u,s,c,f,l,e,n=this,e=n.autoGenerateColumns(),i=n.IB&&n.IB.srt;if(n.s5t(),(r=n.Mf)&&(o=n.dataRange(),a=r.Ut,e?a.RCe(o.row,o.col,E(o),R(o),17,3):y(n.BSt,function(t,n){var e;n.dataField()&&a.RCe(o.row,o.col+t,E(o),1,17,3)})),e&&(u=n.range(),n.d5(u.row,u.col,E(u),R(u)),n.l5t(u.col,R(u),!0)),e||n.E5t(t),t){if(u={row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx},n.Woe(t),n.H3=t,e){for(n.Tx=t.getColumnCount(),n.BSt=[],s=t.ltt(),c=0;c<n.Tx;c++)f=new z(c+1),n.BSt[c]=f,s&&(f.name(s[c]),f.dataField(s[c]));n.ESt&&(n.OSt=[],n.j5t(n.iw))}else l=[],n.BSt.forEach(function(t){var t=t.dataField();t&&l.push(t)}),t.htt(l);r&&((e=r.Ut).YSt(n,U,u,{row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx}),e.yge(n.Ky,n.iw,n.Sx,n.Tx))}else n.H3=t;n.IB&&(n.IB.Uct(n.dataRange()),n.IB.srt=i)},c.prototype.O5t=function(t){var n,e,i,e,r,o,a,n=this,e=n.H3;if(e&&(i=e.ltt()))for(r=(e=n.BSt[t-n.startColumn()])&&e.dataField(),o=0,a=i.length;o<a;o++)if(i[o]===r)return o;return-1},c.prototype.Sl=function(t,n){var e,i,r,o,t,r,e=!1,i=P,r=this,o=r.H3,t=t-r.dataRange().row;return o&&t<o.getRowCount()&&0<=(r=r.O5t(n))&&(e=!0,i=o.getValue(t,r).value),{e5t:e,y4:i}},c.prototype.Kbt=function(t,n,e,i){var r,o,a,u,s,c,u,i,f,f,i,r=this,o=r.H3,a=Ct(r,t),u=r.IB,c=!1;return o&&0<=(s=r.O5t(n))&&(i&&u&&u.isRowFilteredOut(t)||(u=(i=o.getValue(a,s)).value,(f=(f=r.Mf)&&f.Ut)&&i.hasBinding&&u!==e&&(i=Tt(!0),r.R5t(t,a,i),f.B5t(r,t,B,i,pe.dirty),f.dE(t,n,{d6:u})),o.setValue(a,s,e,f&&f.G8)),c=!0),r.DSt=!0,c},c.prototype.ML=function(t,n,e){var i=new D.Style;return this.h5(t,n,i,e),i},c.prototype.L5t=function(t){var n,e,i,n=this.jS.xl,e=n[t];return e===P&&(i=this.Mf,e=n[t]=i.getRowHeight(t)),e},c.prototype.F5t=function(t){var n;return this.Mf.getColumnWidth(t)},c.prototype.qpe=function(t,n,e,i,r,o,a){var u,s,c,f,u=this,s=u.Mf,c;je(u.BSt,t-u.iw,s,n,e,i,!0,o,!0),e===rn?f=u.Jpe:e===en?f=u.Kpe:e===on&&(f=u.Xpe),(f=f&&("string"==typeof f&&s?s.u8(f):f))&&ti(f,n,i,r,o,a)},c.prototype.h5=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,f,b,w,y,u,u,u,u,s,u,s,u,m,b,g,w,M,C,c,S,T,A,I,x,i,r=this,o=r.style(),a=r.Mf,u=r.headerIndex(),s=r.footerIndex(),c=r.jO,f=r.oL,l=c?t===r.Ky+1:t===r.Ky,h=f?t===r.Ky+r.Sx-2:t===r.Ky+r.Sx-1,d=n===r.iw,v=n===r.iw+r.Tx-1;if(u!==t&&s!==t?r.qpe(n,e,en,l,d,h,v):t===u?r.qpe(n,e,rn,!0,d,!0,v):t===s&&r.qpe(n,e,on,!0,d,!0,v),o){if(m=r.highlightLastColumn(),g=r.highlightFirstColumn(),p=c?t===u:t===r.Ky,f=f?t===s:t===r.Ky+r.Sx-1,b=o[fn](),w=o[ln](),y=new D.Style,u===t)u=o[pn](),v&&m&&u&&u.h5(y,!0,!0,!0,!0),u=o[gn](),d&&g&&u&&u.h5(y,!0,!0,!0,!0),(u=o[un]())&&u.h5(y,!0,d,!0,v),v&&m&&b&&b.h5(y,!0,!0,!1,!0),d&&g&&w&&w.h5(y,!0,!0,!1,!0);else if(s===t)u=o[wn](),v&&m&&u&&u.h5(y,!0,!0,!0,!0),s=o[bn](),d&&g&&s&&s.h5(y,!0,!0,!0,!0),(u=o[sn]())&&u.h5(y,!0,d,!0,v),v&&m&&b&&b.h5(y,!1,!0,!0,!0),d&&g&&w&&w.h5(y,!1,!0,!0,!0);else{if(v&&m&&b&&b.h5(y,p,!0,f,!0),d&&g&&w&&w.h5(y,p,!0,f,!0),s=c?t-r.Ky-1:t-r.Ky,C=M=w=g=b=m=u=void 0,c=!i||"cellType"!==i&&"formatter"!==i,r.bandRows()&&c&&0<(m=(u=o[yn]())+o[Mn]())){if(void 0===(b=r.HSt[t])){if(D.Be.Fl&&D.Be.Gl){for(S=D.Be.Gl,T=r.dataRange().row;-1===S[T];)T++;if(t<T)return;s=S[t]-S[T]}else if(a){for(A=0,T=r.dataRange().row;T<t;T++)0<r.L5t(T)&&A++;s=A}b=r.HSt[t]=s%m}g=o[hn](),w=o[dn](),b<u&&g?g.h5(y,M=0===b,d,C=h||b===u-1,v):u<=b&&w&&w.h5(y,M=b===u,d,C=h||b===m-1,v)}if(r.bandColumns()&&c&&0<(m=(u=o[Cn]())+o[Sn]())){if(void 0===(b=r.zSt[n])){if(I=0,a)for(x=r.iw;x<n;x++)0<r.F5t(x)&&I++;b=r.zSt[n]=I%m}g=o[vn](),w=o[mn](),b<u&&g?g.h5(y,l,M=0===b,h,C=v||b===u-1):u<=b&&w&&w.h5(y,l,M=b===u,h,C=v||b===m-1)}}(i=o[cn]())&&i.h5(y,p,d,f,v),r.P5t(e,y)}},c.prototype.i5t=function(t,n,e){var i,r,o,a,u,t,r,n,i=this,r=i.oL,o=i.ESt,a,u;i.footerIndex()===t&&r&&i.g5t()&&(t=i.OSt[n-i.iw])&&o&&(r=e.cellButtons,n=e.dropDowns,j(r)&&(r=[]),e.cellButtons=r.concat(t.cellButtons),j(n)&&(n=[]),e.dropDowns=n.concat(t.dropDowns))},c.prototype.P5t=function(t,n){var t=t,e=20,i,i,i,i;j(t.backColor)&&(t.backColor=n.backColor),Pt(t.foreColor)&&(t.foreColor=n.foreColor),j(t.themeFont)&&j(t.lpe)&&(t.themeFont=n.themeFont),j(t.lpe)&&(t.lpe=n.lpe),Pt(t.lre)&&(t.lre=n.lre,t.Uge=n.Uge,t.fpe=n.fpe),Pt(t.spe)&&(t.spe=n.spe),Pt(t.cpe)&&(t.cpe=n.cpe),t.b2e===P&&(t.b2e=n.b2e),t.y2e===P&&(t.y2e=n.y2e),t.w2e===P&&(t.w2e=n.w2e),t._font=me(t.spe,t.cpe,t.lre,t.lpe,t.b2e,t.y2e,t.w2e),j(t.borderLeft)&&(i=n.borderLeft,t.borderLeft=i&&i.Gf()||i,t.borderLeft)&&(t.borderLeft.level=20),j(t.borderTop)&&(i=n.borderTop,t.borderTop=i&&i.Gf()||i,t.borderTop)&&(t.borderTop.level=20),j(t.borderRight)&&(i=n.borderRight,t.borderRight=i&&i.Gf()||i,t.borderRight)&&(t.borderRight.level=20),j(t.borderBottom)&&(i=n.borderBottom,t.borderBottom=i&&i.Gf()||i,t.borderBottom)&&(t.borderBottom.level=20),j(t.textDecoration)&&(t.textDecoration=n.textDecoration),j(t.cellType)&&(t.cellType=n.cellType),j(t.formatter)&&(t.formatter=n.formatter)},c.prototype.G5t=function(t,n){var e,i,r,o,a,u,e=this;if((t!==e.Ky||n!==e.iw)&&(i=e.Mf)){if((t<0||i.getRowCount()<t+e.Sx||n<0||i.getColumnCount()<n+e.Tx)&&O(H().Exp_TableMoveOutOfRange),a=o=void 0,r=e.jS)for(a=0,u=(o=r.U3).length;a<u;a++)if(o[a]===e){o.splice(a,1),e.U5t();break}i.moveTo(e.Ky,e.iw,t,n,e.Sx,e.Tx,3),o&&a<=u&&(e.H5t(t,n),o.splice(a,0,e),e.z5t()),i.Ut.Spe(),this.cL(1)}},c.prototype.H5t=function(t,n){var e,i,e=this,i=e.Mf;i&&i.Ut.YSt(e,U,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},{row:t,col:n,rowCount:e.Sx,colCount:e.Tx}),e.Ky=t,e.iw=n,e.V5t(),e.dl()},c.prototype.U5t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,i=this,r=i.Mf;if(r&&w){for(o=i.BSt,a=i.footerIndex(),u=i.range(),c=(s=i.dataRange()).row,f=E(s),j(t)&&(t=0,n=o.length);t<n;t++)if(l=o[t],h=u.col+t,l){for(l.footerFormula()&&0<=a&&(N(r,a,h,B),M(r,a,h,B)),d=l.x5t(),v=Rt(d),g=m=void 0,p=0;p<f;p++)m=r.getFormula(g=c+p,h),j(m)||(j(i.Y5t)&&(i.Y5t=[]),i.Y5t.push({row:g,col:h,formula:m})),j(m)||!j(v)&&T(r,k(r,v,i.Ky,h),g,h)===m||(j(i.Z5t)&&(i.Z5t=[]),b=Ft(i.Z5t,h),j(b)?((b={}).col=h,b.rowIndexes=[],b.rowIndexes.push(g),i.Z5t.push(b)):b.rowIndexes.push(g));if(l.x5t(P),l.dataAreaFormula())for(p=0;p<f;p++)N(r,g=c+p,h,B),M(r,g,h,B)}!0===e&&(i.Y5t=[])}},c.prototype.W5t=function(t,n,e){var i,r,o,a,u,s,c,f,u,i=this,r=i.Mf,o=i.Y5t;if(o&&0<o.length){for(s=0;s<o.length;s++)a=!0,(u=o[s])&&(c=u.row,f=u.col,u=u.formula,t<=c&&(!0===e&&(c+=n),!1===e)&&(c<t+n?a=!1:c-=n),a)&&N(r,c,f,u);i.Y5t=[]}i.Xyt(t,n,!0,e)},c.prototype.Q5t=function(t,n,e){var i,r,o,a,u,s,c,f,u,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,g,i=this,r=i.Mf,o=i.Y5t;if(o&&0<o.length){for(s=0;s<o.length;s++)a=!0,(u=o[s])&&(c=u.row,f=u.col,u=u.formula,t<=f&&(!0===e&&(f+=n),!1===e)&&(f<t+n?a=!1:f-=n),a)&&N(r,c,f,u);for(l=i.Z5t||[],h=void 0,s=0;s<l.length;s++)(h=l[s])&&t<=(d=h.col)&&(!0===e&&(h.col+=n),!1===e)&&t+n<=d&&(h.col-=n);for(i.Xyt(t,n,!1,e),m=(v=i.BSt).length,p=(g=i.dataRange()).row,b=g.col,w=g.rowCount,T=S=C=M=y=void 0,s=0;s<m;s++)if(T=b+s,(M=v[s])&&(C=M.dataAreaFormula())){for(y=p,A=0;A<l.length;A++)if((h=l[A])&&h.col===T){for(;-1<h.rowIndexes.indexOf(y)&&y<p+w;)y++;break}y<p+w&&(S=r.getFormula(y,T))&&M.dataAreaFormula(k(r,S,p,T))}i.Y5t=[],i.Z5t=[]}else(g=r.b8&&(r.parent||r).xyt())&&0<g.length&&i.Xyt(t,n,!1,e,P,!0)},c.prototype.Xyt=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,g,p,b,w,y,M,C,S,a=this,u=a.Mf,s=a.BSt,c=a.footerIndex(),f=a.dataRange(),l=f.row,h=f.col,d=f.rowCount,v=f.colCount,m=u.b3(),g=u.Lp;if(g&&m&&(g=g.Hyt()))if(M=m.rT,C=function(t,n){return e?t=l:n=h,f.contains(t,n)},o)M.Iyt=!0,g.Xyt(M,t,n,e,i,C),delete M.Iyt;else if(r||(g.Zyt(m,l,h,d,v),g.Xyt(M,t,n,e,i,C)),a.oL)for(r||(g.Zyt(m,c,h,1,v),g.Xyt(m.rT,t,n,e,i,!1)),S=0;S<v;S++)(p=s[S])&&(b=p.footerFormula(),y=h+S,b)&&(w=u.getFormula(c,y))&&(u&&u.Ut.A5t(a,p,"footerFormula",b,w),p.footerFormula(k(u,w,c,y)))},c.prototype.z5t=function(){var t,u,s,c,f,t=this,u=t.Mf;u&&w&&(s=t.footerIndex(),c=t.range(),f=t.dataRange(),y(t.BSt,function(t,n){var e,t,i,r,o,a,e=c.col+t,t=n.footerFormula(),i=n.dataAreaFormula();if(t&&0<=s&&N(u,s,e,B,t),i)for(r=0,o=E(f);r<o;r++)a=f.row+r,N(u,a,e,B,i)}))},c.prototype.K5t=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,l,p,b,r,w,o,u,y,y,M,C,S,s,o,u,y,f,w,r,o,s,o,r,e=this,i=e.dataRange();if(!t.equals(e.range())){if(r=t.row,o=t.col,a=E(t),u=R(t),s=e.jO,c=e.oL,f=e.ESt,l=0,h=1,s&&(l+=1),c&&(l+=1),(m=e.Mf)&&((a<l||u<1||r+a>m.getRowCount()||o+u>m.getColumnCount())&&O(H().Exp_TableResizeOutOfRange),r===e.Ky&&t.intersect(e.Ky,e.iw,e.Sx,e.Tx)||O(H().Exp_TableResizeInvalidRange),v={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},d=e.BSt.slice()),g=e.BSt,p=(l=o)+u-1,b=e.iw,r=e.iw+e.Tx-1,w=e.Tx,e.iw=o,e.Tx=u,o=e.layoutStyle(),u=v.row===e.headerIndex()?v.row+1:v.row,y=(y=v.row+v.rowCount-1)===e.footerIndex()?y-1:y,l<b){for(M=0,C=l;C<b;C++)S=new z(e.M5t()),g.splice(M,0,S),M++;s&&e.a5t(0,b-l,P,P,!0),c&&e.l5t(0,b-l,P,!0),v&&o.data&&Je(m,u,l,y,b-1,e)}else l<=r&&(e.U5t(b,l),g.splice(0,l-b));if(r<p){for(C=1+r;C<=p;C++)S=new z(e.M5t()),g.push(S);s&&e.a5t(w,p-r,P,P,!0),c&&e.l5t(w,p-r,P,!0),v&&o.data&&Je(m,u,1+r,y,p,e),f&&e.j5t(w)}else b<=p&&(e.U5t(p,r),g.splice(g.length-(r-p),r-p));a!==e.Sx&&(s=e.H3,u=(o=e.dataRange()).row,y=E(o),s?a>e.Sx?(f=u+y-1,w=a-e.Sx,m&&((o=F(m,new D.Range(r=f+w+1,l,m.getRowCount()-r,p)))&&o.row<r||e.N4t(f,w,!0,!1,B,B,n),Je(m,f,l,f+w-1,p,e))):m&&(s=e.Sx-a,e.yE(u+y-s,s)):(o=void 0,c&&(e.l5t(),o=e.footerIndex(),e.eTt=!0,e.u5t(o),delete e.eTt),r=e.Sx,e.Sx=a,v&&(v.row>t.row&&Je(m,t.row,l,v.row-1,p,e),v.row+v.rowCount-1<t.row+t.rowCount-1)&&Je(m,v.row+v.rowCount,l,t.row+t.rowCount-1,p,e),e.J5t(v.row+r-(c?1:0),a-r,r<a),c&&e.w5t())),m&&(m.Ut.YSt(e,U,v,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),m.Ut.YSt(e,Kn,d,e.BSt.slice())),e.dl(),e.V5t(!1),e.X5t(i,e.dataRange()),e.I4t(),e.cL(0)}},c.prototype.X5t=function(t,n){var e,i,r,o,a,u,s,c,t,f,n,l,e,i=this.LSt;i&&(r=t.col,o=E(t),a=R(t),u=n.col,s=E(n),c=R(n),t=t.row+o,f=r+a,l=u+c,(n=n.row+s)<t&&i.onRowsRemoved(s,t-n),t<n&&i.onRowsAdded(o,n-t),r<u&&i.onColumnsRemoved(0,u-r),l<f&&i.onColumnsRemoved(c,f-l),u<r&&i.onColumnsAdded(0,r-u),f<l)&&i.onColumnsAdded(r+a-u,l-f)},c.prototype.V5t=function(t){var n=this,e=n.IB;e&&(e.Uct(n.dataRange()),!1!==t)&&e.reFilter()},c.prototype.s5t=function(){var t=this.IB;t&&(t.unfilter(),t.reset())},c.prototype.cSt=function(t,n){var e,i;for(t!==B&&(t=d(t)),e=0;e<this.Tx;e++)if(e!==n&&t===(i=this.getColumnName(e)))return!0;return!1},c.prototype.q5t=function(t){var n,e,t,n,e,n=this,e=n.BSt;return n.jO&&e&&0<=(t=t-n.iw)&&t<e.length&&(n=e[t])?(e=n.name(),j(e)?e:d(e)):B},c.prototype.$5t=function(t,n){var e,i,r,t,r,i,o,e=this,i=e.BSt;e.jO&&i&&(r=i.length,0<=(t=t-e.iw))&&t<r&&(r=i[t])&&(i=r.name(),(o=e.Mf)&&n!==i&&o.Ut.A5t(e,r,"name",i,n),r.name(n),e.I5t(i,r.name(),t))},c.prototype.m5t=function(t,n,e){var i,r,o,a,u,r,t,i=this,r=i.BSt,o=i.footerIndex(),a=i.iw+t,u=i.Mf;w&&0<=t&&t<r.length&&(r=r[t],n&&!e&&u&&(e=k(u,n,o,a),i.oL)&&N(u,o,a,n,e),r)&&(t=r.footerFormula(),u&&e!==t&&u.Ut.A5t(i,r,"footerFormula",t,n),r.footerFormula(e))},c.prototype.d5t=function(t,n,e){var i,r,e,r,e,o,i=this,r=i.BSt;(e||i.oL)&&r&&0<=(e=t-i.iw)&&e<r.length&&(r=r[e])&&(n!==(e=r.footerValue())&&(o=i.Mf)&&(o.Ut.A5t(i,r,"footerValue",e,n),o.Ut.dE(i.Ky+i.Sx-1,t,{d6:r.footerValue()})),r.footerValue(n))},c.prototype.M5t=function(){for(var t,n,e,i,r,t=this.BSt,n=t&&t.length,e=[],r=0;r<n;r++)(i=t[r])&&i.tTt()&&e.push(i.id());if(e.sort(function(t,n){return t-n}),0<(n=e.length)){for(r=0;r<n;r++)if(e[r]!==r+1)return r+1;return n+1}return 1},c.prototype.nTt=function(t,n){var e,i,r,n;if(!j(t)&&!this.cSt(t,n))return t;if(i=Tn,r=0,t)i=t,r=1;else if(0<n&&(t=this.BSt[n-1].name(),n=/[0-9]+$/.exec(t))){if(i=t.substr(0,n.index),r=parseInt(t.substr(n.index),10),!this.cSt(e=i+(r+1)))return e;i=t,r=1}for(;;)if(!this.cSt(e=i+ ++r))return e},c.prototype.a5t=function(t,n,e,i,r){var o,a,u,s,o,c,f,l,h,d,v,m,g,p,g,a=this,u=a.BSt,s=a.Mf;if(a.jO&&u&&s)for(o=u.length,c=a.headerIndex(),f=a.iw,j(t)&&(t=0),j(n)&&(n=o),h=G(o,t+n),v=null==(o=a.layoutStyle())?void 0:o.header,m=t;m<h;m++)(l=u[m])&&(g=a.jS.U3,-1<(p=b(a,g))&&g.splice(p,1),d=Bt(s.getValue(c,f+m)),-1<p&&g.splice(p,0,a),a.Mf.Ut.Spe(),N(s,c,f+m,B),d&&(e?(a.eTt=e,s.setText(c,f+m,l.name()),delete a.eTt):((g=i?d:a.nTt(d,m))===d?(s.Ut.A5t(a,l,"name",l.name(),d),l.name(d)):s.setText(c,f+m,g),w&&s.gL(c,f+m))),r)&&Qe(s,c,f+m,v)},c.prototype.j5t=function(t){for(var n,e,i,n=this.BSt,e=t;e<n.length;e++)i=_e(this.name(),n[e].name()),this.OSt.push(i)},c.prototype.l5t=function(t,n,e,i){var r,o,a,u,r,s,c,f,l,h,d,v,m,h,d,g,o=this,a=o.BSt,u=o.Mf;if(o.oL&&a&&u)for(o.useFooterDropDownList()&&!o.g5t()&&o.h5t(),r=a.length,s=o.footerIndex(),c=o.iw,j(t)&&(t=0),j(n)&&(n=r),j(e)&&(e=o.iTt),l=G(r,t+n),v=null==(r=o.layoutStyle())?void 0:r.footer,m=t;m<l;m++)(f=a[m])&&(d=u.getValue(s,c+m),j(d)||e?(o.eTt=e,M(u,s,c+m,f.footerValue()),delete o.eTt):(d!==(h=f.footerValue())&&u.Ut.A5t(o,f,"footerValue",h,d),f.footerValue(d)),(h=u.bMt&&u.bMt(s,c+m))&&!e?(h!==(d=f.dataAreaFormula())&&(g=T(u,h,s,c+m),u.Ut.A5t(o,f,"dataAreaFormula",d,g)),f.footerFormula(h)):o.rTt||(o.eTt=e,N(u,s,c+m,B,f.footerFormula()),delete o.eTt),i)&&Qe(u,s,c+m,v)},c.prototype.oTt=function(t,n){var e,i,r,o,a,u,s,c,e=this,i=e.BSt;if(e.jO&&i)for(r=i.length,j(t)&&(t=0),j(n)&&(n=r),a=G(r,t+n),u=t;u<a;u++)(o=i[u])&&(s=o.name(),(c=e.Mf)&&s!==B&&c.Ut.A5t(e,o,"name",s,P,e.yTe?u:P),o.name(B),e.I5t(s,o.name(),u))},c.prototype.aTt=function(t){var n,e,i,r,o,a,u,s,c,t,n=this,e=n.dataRange();if(e.containsRange(t)){for(i=t.row,r=t.col,o=E(t),a=R(t),u=[],s=0;s<o;s++)for(c=0;c<a;c++)n.Kbt(i+s,r+c,B,!0),u.push({columnName:n.getColumnName(r+c-e.col),row:i+s-e.row,data:""});(t=n.LSt)&&t.onDataChanged(u)}},c.prototype.uTt=function(t,n){var e,i,r,o,a,u,s,s,e=this,i=e.BSt;if(e.oL&&i)for(j(t)&&(t=0),j(n)&&(n=i.length),o=G(i.length,t+n),a=t;a<o;a++)(r=i[a])&&(u=e.Mf,s=r.footerFormula(),u&&B!==s&&u.Ut.A5t(e,r,"footerFormula",s),r.footerFormula(B),s=r.footerValue(),u&&B!==s&&u.Ut.A5t(e,r,"footerValue",s),r.footerValue(B))},c.prototype.w5t=function(){var t,n,e,i,r,o,a,u,s,t=this,n=t.BSt;if(t.oL&&n&&(e=t.Mf))for(i=n.length,o=t.iw,u=t.footerIndex(),s=0;s<i;s++)(r=n[s])&&(M(e,u,a=o+s,r.footerValue()),N(e,u,a,B,r.footerFormula()))},c.prototype.u5t=function(t){var n,e,i,r,o,a,n=this,e=n.Mf;if(e&&!(t<0||e.getRowCount()<=t))for(i=n.iw,r=n.Tx,a=0;a<r;a++)N(e,t,o=i+a,B),M(e,t,o,B)},c.prototype.JO=function(t,n,e,i,r,o){var a,u,e,s,c,f,l,o,e,a=this,u=!1,e=e?1:0,s=a.jO&&1===a.Sx;return!s&&t>=a.Ky+a.Sx+e||((c=a.Mf)&&(f=c.Ut,l={row:a.Ky,col:a.iw,rowCount:a.Sx,colCount:a.Tx}),o||a.sTt(t,n,!1),o=a.Ky,e=a.Ky+a.Sx-1+e,t<=o&&!r?a.Ky+=n:(t<=e||s)&&(i||(u=a.cTt(t,n)),a.Sx+=n),c&&f.YSt(a,U,l,{row:a.Ky,col:a.iw,rowCount:a.Sx,colCount:a.Tx})),u},c.prototype.t5t=function(t,n,e){var i,r,r,o,e,a,a,i=this,r=i.Ky+i.Sx-1;!e&&t>=i.Ky&&t<=r&&i.J5t(t,n,!0),e||(i.Xyt(t,n,!0,!0,!0),i.fTt()),r=i.LSt,e=(o=i.dataRange()).row,a=i.endRow(),e<=t&&t<=a&&r&&r.onRowsAdded(t-e,n),(a=i.IB)&&(i.DSt=!0,a.JO(t,n),i.lTt)&&i.Mf.filterRowsVisibleInfo.rE(t,n)},c.prototype.cTt=function(t,n){var e,i,r,r,o,e=this,i=e.H3;return!!i&&(o=void 0,(r=(r=this.Mf)&&r.Ut.G8)&&!(o=r.tableChanges)&&(r.tableChanges=o=[]),i.kE(Ct(e,t),n,o),!0)},c.prototype.J5t=function(o,a,u){var s,c,t;w&&(c=(s=this).Mf,t=s.dataRange(),j(o)&&(o=t.row),j(a)&&(a=t.rowCount),vt(c),y(s.BSt,function(t,n){var e,i,r,e=n.dataAreaFormula();if(e)for(i=t+s.iw,r=o;r<o+a;r++)(u&&o<=r&&r<o+a||!j(c.getValue(r,i))&&c.getFormula(r,i)===T(c,e,r,i))&&N(c,r,i,B,e)}),mt(c,!1))},c.prototype.fTt=function(){var a,t,u,n,s,c;w&&(t=(a=this).Mf,u=t.b3(),n=a.dataRange(),j(s)&&(s=n.row),j(c)&&(c=n.rowCount),vt(t),y(a.BSt,function(t,n){var n,e,i,r,o,n=n.hTt();if(n&&n.isArrayFormula)for(e=n.isDynamicArray,i=t+a.iw,r=s;r<s+c;r++)j(u.sT(r,i))&&u.Uyt(r,i,o={row:r,col:i,rowCount:1,colCount:1,isDynamicArray:e})}),mt(t,!1))},c.prototype.qO=function(t,n,e,i,r){var o,e,a,u,s,c,f,l,h,d,v,m,v,v,r,o=this,e=e?1:0;if(!(t>=o.iw+o.Tx+e)){if(u=o.iw,(f=o.Mf)&&(c={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},s=o.BSt.slice()),t<=o.iw&&!r)o.iw+=n;else if(t<o.iw+o.Tx+e&&(a=!0,o.Tx+=n,l=o.BSt)){for(h=t-o.iw,d=0;d<n;d++)v=o.M5t(),m=h+d,(v=new z(v)).name(o.nTt(B,m)),l.splice(m,0,v),v=o.getColumnName(m),o.y5t(m,0,v);i&&o.a5t(h,P,!0,!1)}o.IB&&o.IB.qO(t,n,a),u<=t&&(r=o.LSt)&&r.onColumnsAdded(t-u,n),f&&(f.Ut.YSt(o,U,c,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx}),f.Ut.YSt(o,Kn,s,o.BSt.slice()))}},c.prototype.n5t=function(){var t,n,e,i,r,o,a,t=this,n,e=t.Mf.b3();e&&t.oL&&(i=t.BSt,r=t.footerIndex(),o=t.iw,i.forEach(function(t,n){a=e.pB(r,o+n),j(a)||t.footerFormula(a)}))},c.prototype.xP=function(t,n,e,i,r){var o,a,u,s,u,c,f,l,h,l,d,v,m,g,p,l,b,w,y,o=this,a=!1;if(!(t>=o.Ky+o.Sx)&&(s=(u=o.dataRange()).row,u=E(u),c=o.Ky,f=o.Ky+o.Sx-1,l=o.Mf,h=o.H3,m=[],p="_backupRowsChange",l&&(d=l.Ut)&&(g={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},m.push(U),l=d.G8)&&!(v=l.tableChanges)&&(l.tableChanges=v=[]),r||o.sTt(t,n,!0),t<c?t+n<=c&&(o.Ky-=n):t===c?o.jO||(o.Sx-=G(f-t+1,n),!e&&h&&(m.push(p),h.btt(Ct(o,t),G(f-t+1,n),v),a=!0)):t<=f&&(o.Sx-=G(f-t+1,n),!e&&h&&(m.push(p),h.btt(Ct(o,t),G(f-t+1,n),v),a=!0),t===f)&&o.oL&&(m.push(Jn),o.oL=!1),o.IB&&(o.DSt=!0,o.IB.xP(t,n)),s<=t&&t<s+u&&(l=o.LSt)&&l.onRowsRemoved(t-s,n),d)&&m&&0<m.length)for(b=0,w=m;b<w.length;b++)switch(y=w[b]){case U:d.YSt(o,U,g,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx});break;case Jn:d.YSt(o,Jn,o.oL);break;case p:d.B5t(o,t,n,i,pe.deleted)}return a},c.prototype.NP=function(t,n){var e,i,r,o,a,u,s,c,i,e=this,i=e.BSt;t>=e.iw+e.Tx||((r=e.Mf)&&(o={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},a=e.BSt.slice()),u=e.iw,s=e.iw,c=e.iw+e.Tx-1,t<s?t+n<=s?e.iw-=n:(e.iw=t,e.Tx-=t+n-s,i&&(i.splice(0,t+n-s),e.y5t(0,t+n-s))):(e.Tx-=G(c-t+1,n),i&&(i.splice(t-s,G(c-t+1,n)),e.y5t(t-s,G(c-t+1,n)))),e.IB&&e.IB.NP(t,n),u<=t&&(i=e.LSt)&&i.onColumnsRemoved(t-u,n),r&&(r.Ut.YSt(e,U,o,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),r.Ut.YSt(e,Kn,a,e.BSt.slice())))},c.prototype.d5=function(t,n,e,i){var r,o,a,u,u,s,c,f,l,h,h,d,h,h,h,u,r=this,o=e,a=i,u=r.Mf;u&&(o=u.getRowCount(),a=u.getColumnCount()),l=(0,D.Ec)(u=t<0?0:t,s=n<0?0:n,c=t<0?o:e,f=n<0?a:i),h=r.headerIndex(),r.jO&&u<=h&&h<u+c&&(h=(0,D.Ec)(h,r.iw,1,r.Tx),d=l.getIntersect(h,o,a))&&r.oTt(d.col-r.iw,R(d)),h=r.dataRange(),(h=l.getIntersect(h,o,a))&&r.aTt(h),h=r.footerIndex(),r.oL&&u<=h&&h<u+c&&(u=(0,D.Ec)(h,r.iw,1,r.Tx),d=l.getIntersect(u,o,a))&&r.uTt(d.col-r.iw,R(d)),r.IB&&r.IB.d5(t,n,e,i)},c.prototype.toJSON=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,i=e.style(),r=e.rowFilter(),o="columns";for(j(t)?a=e.name():e.Gwt=a=t,u={name:[a,B],row:[e.Ky,-1],col:[e.iw,-1],rowCount:[e.Sx,-1],colCount:[e.Tx,-1],showHeader:[e.jO,!0],showFooter:[e.oL,!1],useFooterDropDownList:[e.ESt,!1],showResizeHandle:[e.jSt,!1],highlightFirstColumn:[e.highlightFirstColumn(),!1],highlightLastColumn:[e.highlightLastColumn(),!1],bandRows:[e.bandRows(),!0],expandBoundRows:[e.expandBoundRows(),!1],bandColumns:[e.bandColumns(),!1],style:[i?i.toJSON():B,B],autoGenerateColumns:[e.autoGenerateColumns(),!0],bindingPath:[e.bindingPath(),P],rowFilter:[r?r.toJSON():B,B],reservedElement:[Ee(e.dTt),B],allowAutoExpand:[e.VSt,!0],headerStyle:[e.Jpe&&e.Jpe.toJSON?e.Jpe.toJSON():e.Jpe,P],dataStyle:[e.Kpe&&e.Kpe.toJSON?e.Kpe.toJSON():e.Kpe,P],footerStyle:[e.Xpe&&e.Xpe.toJSON?e.Xpe.toJSON():e.Xpe,P],columns:[[]]},s=0;s<e.BSt.length;s++)f=(c=e.BSt[s].toJSON())[xn],l=c[kn],f&&(n&&n.ignoreFormula?(delete c[xn],c[_n]=e.Mf.getValue(e.Ky+e.Sx-1,e.iw+s)):c[xn]=T(e.Mf,f,e.footerIndex(),s+e.iw)),l&&(c[kn]=T(e.Mf,l,e.dataRange().row,s+e.iw)),u[o][0][s]=c;for(d in u[o][1]=B,h={},u)(v=u[d])[0]!==v[1]&&(h[d]=v[0]);return m(h)?P:h},c.prototype.wh=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,e,v,m,g,p,b,w,y,M,C,C,M,e,S,r,c,e,s,T,A,o=this,a=o.Mf,u=a.name(),s=o.style(),c=o.rowFilter(),f=o.BSt,l=e.styleManager,h=e.sharedStrings,d=!D.Util.ko(i);if(t.xmlns=D.XFileConstants.Qu,t.id=o._id,t.c_=[],t.n_=D.XFileConstants.du,(e=o.name()||B)&&(e=e.split(" ").join("_"),t.name=e,t.displayName=ze(e.split("-").join("_"),r)),t.ref=Gt([o.range()]),!0!==o.jO&&(t.headerRowCount=0),!1!==o.oL&&(t.totalsRowCount=1),c&&!a.NMi&&c.wh(t,l,i),f&&0<f.length){for(v=[],m=o.footerIndex(),g=o.dataRange().row,p=o.iw,w=b=void 0,y=0;y<f.length&&!(d&&y>=o.Tx);y++)C=(M=f[y]).name(),w=y+o.iw,o.jO&&!j(C)&&(j(b)&&(b=lt(n,u)),ht(b,o.Ky,w,""+C,h)),v.push(M.wh(a,o,g,m,y+p,i,C={},l,o.jO)),M=C.v,o.oL&&!j(M)&&(j(b)&&(b=lt(n,u)),ht(b,o.Ky+o.Sx-1,w,""+M,h));i&&i.fileType===D.OpenSaveFileType.excel&&b&&b.colCount<w+1&&(b.colCount=w+1),e={n_:"tableColumns",count:f.length,c_:v},t.c_.push(e)}s&&(s.builtInName()?S="TableStyle"+s.builtInName():(S=s.name(),j(S)&&(S="CustomTableStyle_"+be(),s.name(S)))),r=o.Kpe,j(r)||("string"==typeof r?t.dataCellStyle=r:(t.dataDxfId=l.getDxfIndex(r),r.parentName&&(t.dataCellStyle=r.parentName))),c=o.Jpe,j(c)||("string"==typeof c?t.headerRowCellStyle=c:(t.headerRowDxfId=l.getDxfIndex(c),c.parentName&&(t.headerRowCellStyle=c.parentName))),e=o.Xpe,j(e)||("string"==typeof e?t.totalsRowCellStyle=e:(t.totalsRowDxfId=l.getDxfIndex(e),e.parentName&&(t.totalsRowCellStyle=e.parentName))),(s={n_:"tableStyleInfo",name:it(S)}).showFirstColumn=!1!==o.highlightFirstColumn()?"1":"0",s.showLastColumn=!1!==o.highlightLastColumn()?"1":"0",s.showRowStripes=!0!==o.bandRows()?"0":"1",s.showColumnStripes=!1!==o.bandColumns()?"1":"0",t.c_.push(s),T={useFooterDropDownList:[o.ESt,!1],showResizeHandle:[o.jSt,!1],expandBoundRows:[o.expandBoundRows(),!1],autoGenerateColumns:[o.autoGenerateColumns(),!0],bindingPath:[o.bindingPath(),P],extLst:[o.dTt,B],allowAutoExpand:[o.VSt,!0]},A=t.lossless={},Object.keys(T).forEach(function(t){var n=T[t];n[0]!==n[1]&&(A[t]=n[0])})},c.prototype.fromJSON=function(e,t,n){var i,r,o,a,u,s,o,a,u,s,o,a,c,u,s,o,a,u,s,c,o,a,u,f,l,h,d,v,m,g,p,b,s,o,c,a;if(e){if(r=(i=this).Mf,y([Wt,Xt,qt,$t,tn,nn],function(t,n){x(e[n])&&i[n](e[n],!1)}),o=e.row,x(o)&&(i.Ky=o),a=e.col,x(a)&&(i.iw=a),u=e.rowCount,x(u)&&(i.Sx=u),s=e.colCount,x(s)&&(i.Tx=s),ii(r,new D.Range(o,a,u,s))&&(r.rowFilter().reset(),r.rowFilter(void 0)),o=e.showHeader,x(o)&&(i.jO=o),a=e.showFooter,x(a)&&(i.oL=a),u=e.expandBoundRows,x(u)&&(i.RSt=u),s=e.useFooterDropDownList,x(s)&&(i.ESt=s),o=e.showResizeHandle,x(o)&&(i.jSt=o),a=e.headerStyle,x(a)&&(Y(a)?i.Jpe=a:((c=new D.Style).fromJSON(a,P,P),i.Jpe=c)),u=e.dataStyle,x(u)&&(Y(u)?i.Kpe=u:((c=new D.Style).fromJSON(u,P,P),i.Kpe=c)),s=e.footerStyle,x(s)&&(Y(s)?i.Xpe=s:((c=new D.Style).fromJSON(s,P,P),i.Xpe=c)),(o=e.style)&&((a=new W.TableTheme).fromJSON(o,t),i.style(a)),u=e.dataSource,s=e.dataBinding,c=e.bindingPath,t?(u&&I.$$&&(i.H3=new I.$$,i.H3.bind(u)),s&&I.$$&&(i.H3=new I.$$,i.H3.fromJSON(s))):c&&(i.S5t=c,o=r&&r.getDataSource&&r.getDataSource(),I.CellBindingSource)&&o instanceof I.CellBindingSource&&(a=(0,I.q$)(o.getSource(),c))&&(i.H3=new I.$$,i.H3.bind(a)),u=e.columns){for(l=(f=u).length,h=i.BSt=[],m=v=d=void 0,g=0;g<l;g++)m=f[g],d=new z,v=new z(i.M5t()),d.fromJSON(m),Ze(r,i,d,v,g),p=v.name(),b=i.nTt(p,g),h.push(v),b!==p&&i.setColumnName(g,b);i.vTt()}i.ESt&&i.h5t(!0),(s=e.rowFilter)&&(o=A.WSt&&new A.WSt)&&(o.table(i),o.fromJSON(s,t),i.IB=o,n?i.IB.reFilter():(i.DSt=!0,i._St())),(c=e.reservedElement)&&(i.dTt=c),a=e.allowAutoExpand,x(a)&&(i.VSt=a)}},c.prototype.yh=function(t,n,e){var i,r,o,e,a,r,r,u,s,c,f,l,l,l,c,c,c,l,c,t,h,d,v,l,m,m,g,p,b,w,y,M,C,C,S,T;if(t){if(r=t.ref,o=e&&e.onlyTableData,e=e&&e.isApplyRefilter,a=(i=this).Mf,i.name(t.name),j(r)||(r=Ut(r,!0)[0],i.Ky=r.row,i.iw=r.col,i.Sx=r.rowCount,i.Tx=r.colCount),i.jO=1<=tt(t.headerRowCount,1),i.oL=1<=tt(t.totalsRowCount,-1),r=_(t,"tableColumns"),u=_(t,"autoFilter"),s=_(t,"sortState"),c=_(t,"tableStyleInfo"),f=_(t,"extLst"),o||(c&&(l=et(c.name),j(l)||(l=n.getTableTheme(l),i.style(l)),j(c.showFirstColumn)||i.highlightFirstColumn(nt(c.showFirstColumn,!1)),j(c.showLastColumn)||i.highlightLastColumn(nt(c.showLastColumn,!1)),j(c.showRowStripes)||i.bandRows(nt(c.showRowStripes,!1)),j(c.showColumnStripes)||i.bandColumns(nt(c.showColumnStripes,!1))),l=a.getDefaultStyle(),c=void 0,!j(t.dataDxfId)&&n&&(c=n.getDxf(+t.dataDxfId,P,!0,!0)),j(t.dataCellStyle)||(c?c.parentName=t.dataCellStyle:c=t.dataCellStyle),c=c&&Le(c,l,a),i.Kpe=c,c=void 0,!j(t.headerRowDxfId)&&n&&(c=n.getDxf(+t.headerRowDxfId,P,!0,!0)),j(t.headerRowCellStyle)||(c?c.parentName=t.headerRowCellStyle:c=t.headerRowCellStyle),c=c&&Le(c,l,a),i.Jpe=c,c=void 0,!j(t.totalsRowDxfId)&&n&&(c=n.getDxf(+t.totalsRowDxfId,P,!0,!0)),j(t.totalsRowCellStyle)||(c?c.parentName=t.totalsRowCellStyle:c=t.totalsRowCellStyle),c=c&&Le(c,l,a),i.Xpe=c),l=t.lossless,o||j(l)||(c=l.bindingPath,t=l.autoGenerateColumns,h=l.expandBoundRows,d=l.useFooterDropDownList,v=l.showResizeHandle,l=l.allowAutoExpand,c&&(i.S5t=c,m=a&&a.getDataSource&&a.getDataSource(),I.CellBindingSource)&&m instanceof I.CellBindingSource&&(m=(0,I.q$)(m.getSource(),c))&&(i.H3=new I.$$,i.H3.bind(m)),x(t)&&i.autoGenerateColumns(t),x(h)&&(i.RSt=h),x(d)&&(i.ESt=d),x(v)&&(i.jSt=v),x(l)&&(i.VSt=l)),r&&(g=K(r,"tableColumn"),!j(g))){for(p=i.BSt=[],w=b=void 0,y=0,M=g.length;y<M;y++)C=g[y],w=new z(i.M5t()),(b=new z).yh(C,o,n,a),Ze(a,i,b,w,y),C=w.name(),(S=i.nTt(C,y))!==C&&w.name(S),p.push(w);i.vTt()}o||(i.ESt&&i.h5t(!0),He(i,T=A.WSt&&new A.WSt,u,s,n,e),f&&(i.dTt=f))}},c.prototype._St=function(){var t,n,e,i,r,o,a,u,t=this,n=t.IB,e=t.Mf.filterRowsVisibleInfo.rowsVisibleInfo,i=n.range;if(!j(i))for(r=0;r<i.rowCount;r++)if(!1!==e[o=i.row+r])for(a=0;a<i.colCount;a++)u=i.col+a,n.isFiltered(u)&&n.jct(o,u)},c.prototype.formulaFromJSON=function(){for(var t,n,e,i,r,o,a,u,s,c,f,f,l,t=this,n=t.Mf,e=n.b3(),i=t.BSt,o=t.footerIndex(),a=t.dataRange().row,u=t.iw,c=0;c<i.length;c++)s=c+u,(f=(r=i[c]).footerFormula())&&typeof f==te&&r.footerFormula(k(n,f,o,s,P,!0)),(f=r.dataAreaFormula())&&e&&(l=e.sT(a,s),j(l)||r.hTt({isArrayFormula:!0,isDynamicArray:l.isDynamicArray})),f&&typeof f==te&&r.dataAreaFormula(k(n,f,a,s,P,!0))},c.prototype.vTt=function(){for(var t,n,e,i,r,o,t=this,n=t.BSt,e=n.length,o=0;o<e;o++)(r=(i=n[o]).id())<1&&i.id(t.M5t())},c.prototype.startRow=function(){return this.Ky},c.prototype.startColumn=function(){return this.iw},c.prototype.endRow=function(){return this.Ky+this.Sx-1},c.prototype.endColumn=function(){return this.iw+this.Tx-1},c.prototype.hasHeadersRow=function(){return this.jO},c.prototype.hasTotalsRow=function(){return this.oL},c.prototype.tableName=function(){return this.name()},c.prototype.getColumnIndexInTable=function(e){e=e.toLowerCase().replace(/\u00A0/g," ");var i=-1,r=l.Common.zf.Vi(e,"\r\n","\n");return j(e)||y(this.BSt,function(t,n){var n=n.name().toString().toLowerCase().replace(/\u00A0/g," ");if(n===e||n===r)return i=t,!1}),i},c.prototype.source=function(){var t=this.Mf;return t&&t.Uw&&t.Uw()},c.prototype.qSt=function(){var t,n,e,n,n,t=this,n=t.Mf;n&&(e=t.bindingPath())&&(n=n.getDataSource&&n.getDataSource(),I.CellBindingSource)&&n instanceof I.CellBindingSource&&(n=(0,I.q$)(n.getSource(),e),t.T5t(n))},c.prototype.T5t=function(t){var n,e,i,r,o,a,u,n,u,s,e=this,i=e.Mf;if(t&&!(e.autoGenerateColumns()&&(r=Object.keys(t[0]||[]).length)!==(o=e.BSt.length)&&(a=e.Sx,u=(0,D.Ec)(e.Ky,e.iw,a,r),1<(null==(n=null==(n=e.jS)?void 0:n.AB(u.row,u.col,a,r))?void 0:n.length)))){(u=e.H3||new I.$$).bind(t,i.Ut.G8);try{C(i),e.H3=B,e.D3(u),c.et(i,"setBindingPath",{tableName:e.name()}),(s=w&&i.op())&&!s.IsSuspended()&&i.recalcAll()}finally{S(i)}}},c.prototype.clone=function(){var t,n,e,t=this,n=new c,e=Yt(t.toJSON());return n.Sg(t.jS),n.fromJSON(Zt(e)),n},c.prototype.V3=function(t){var n=new I.$$;n.bind(t),this.H3=n},c.prototype.gTt=function(t){var t;t&&!t.bindingPath()&&(t=t.H3)&&this.V3(t.getSource())},c.prototype.z3=function(){var t=this.H3;return t?t.getSource():B},c.prototype.pTt=function(){var t=this.H3;return t?t.getRowCount():0},c.prototype.bTt=function(t,n){var e,n,e=this.PSt;n?e.push(t):-1!==(n=e.indexOf(t))&&e.splice(n,1)},c.prototype.cL=function(n){var e=this;e.PSt.forEach(function(t){t.Pen(e,n)}),2===n&&(e.PSt=[])},c.prototype.Pwt=function(t,n,e){var i,i,r,o,i=this;i.yTt||((r=(r=(i=i.FSt)[e])||(i[e]={}))[o=[t,n].join(",")]=!0)},c.prototype.I4t=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,h,v,i=this,r=i.Mf,o=r&&r.getCalcService&&r.getCalcService();if(i.yTt=!0,o)for(u in u=void 0,a=i.FSt)if(s=o.rO[u])for(l in c=s.pj(),f=a[u])d=+(h=l.split(","))[0],h=+h[1],(v=s.pB(d,h))?(i.wTt(d,h)||i.MTt(v,t,n,e,!1,d,h),s.SB(d,h,v,void 0,!1,c)):delete f[l];else delete a[u];delete i.yTt},c.prototype.CTt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,l,d,h,i=this,r=i.Mf,o=r&&r.getCalcService();if(i.yTt=!0,o)for(u in u=void 0,a=i.FSt)for(f in s=o.rO[u],c=a[u])h=+(l=f.split(","))[0],l=+l[1],(d=s.pB(h,l))&&t===h&&n===l&&-1<(h=Ot(d))&&(d.arguments[h]=e);delete i.yTt},c.prototype.wTt=function(t,n){var e,i,r,t,i,e=this,i=e.footerIndex(),r=!1;return-1<i&&t===i&&(i=(t=e.iw)+e.Tx,r=t<=n&&n<i),r},c.prototype.sort=function(t,n){var e=this,i=e.Mf,r=e.dataRange(),e=e.rowFilter();i&&0<=t&&t<r.colCount&&(i.suspendPaint(),i.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:t+r.col,ascending:n}]),e&&(e.nrt={index:t+r.col,ascending:n}),i.resumePaint())},c.prototype.QL=function(){return!!this.H3},c.prototype.N4t=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,u=this,s=u.Mf,c=u.jS,f=u.Ky,l=u.iw,h=u.Sx,d=u.Tx,v=f+h-1,m=u.dataRange(),g=e&&0<m.rowCount?t+1:t,p=g+n;It(s);try{b=u.QL(),u.lTt=!0,u.sL(!1),u.STt(),(c.zB=u).JO(g,n,e,!!a,!0,o),u.I4t(),w=D.CopyToOptions.value|D.CopyToOptions.formula|D.CopyToOptions.comment|D.CopyToOptions.outline|D.CopyToOptions.sparkline|D.CopyToOptions.span|D.CopyToOptions.style|D.CopyToOptions.tag|D.CopyToOptions.bindingPath|D.CopyToOptions.hyperlink|D.CopyToOptions.altText,i&&!u.TTt&&(M=(y=1+v)+n,C=r-y+1,s.moveTo(y,l,M,l,C,d,w)),S=v-g+1,(!e||t!==v)&&0<S&&(s.EB=!0,s.Nyt=m,b&&!u.oL?u.BSt.forEach(function(t,n){var n=l+n;t.dataField()?s.moveTo(g,n,p,n,S,1,D.CopyToOptions.style):s.moveTo(g,n,p,n,S,1,w)}):s.moveTo(g,l,p,l,S,d,w),delete s.Nyt,delete s.EB),T=e?1:0,A=u.jO&&1===h,(g<=(I=f+h-1+T)||A)&&Je(s,g,u.iw,g+n-1,u.iw+u.Tx-1,u),x=s.Ut,N=u.dataRange(),x.bJ&&x.bJ(g,n,[N],!0),x.ATt&&x.ATt(g,n,[N],!0),c.zB=P,u.ITt(),u.t5t(g,n,!0),u.J5t(g,n,!0),u.W5t(g,n,!0),u.fTt(),u.jS.dl()}finally{u.lTt=P,u.sL(!0),xt(s),u.cL(0),s.recalcAll(!0)}},c.prototype.sL=function(t){this.Mf.sL(t)},c.prototype.insertRows=function(t,n,e){var i;j(t)||j(n)||n<=0||(t=Et(i=this,t,!0),i.zpt(t,n,e))},c.prototype.zpt=function(t,n,e,i,r){var o,a,u,s,u,c,s,u,f,l,s,h,f,d;j(t)||j(n)||n<=0||(a=(o=this).Mf,s=(u=o.dataRange()).row,0===(u=u.rowCount)&&t===s||!(t<s||(c=s+u)<=t)||O(H().Exp_RowParamOutOfRange),s=o.Ky,u=o.iw,f=o.Sx,h=u+(l=o.Tx)-1,d=(s=s+f-1)<(f=wt(a,o)),Mt(a,o,1+s,f,u,h,n))||o.N4t(t,n,e,d,f,i,r)},c.prototype.deleteRows=function(t,n){var e;j(t)||j(n)||n<=0||(t=Et(e=this,t,!0),e.yE(t,n))},c.prototype.yE=function(e,i,t){var n,r,o,a,o,u,s,c,f,l,h,a,o,d,v,m,g,p,b,w,y,M,C,S;if(!(j(e)||j(i)||i<=0||(r=(n=this).Mf,a=(o=n.dataRange()).row,o=o.rowCount,(e<a||a+o<=e)&&O(H().Exp_RowParamOutOfRange),u=n.Ky,s=n.iw,c=n.Sx,f=n.Tx,l=u+c-1,h=s+f-1,(c<=1||e===a&&!n.jO&&!n.oL&&o<=i)&&O(H().Exp_TableDeleteCountInvalid),o=l<(a=wt(r,n)),Mt(r,n,1+l,a,s,h,i,!0)))){It(r);try{n.sL(!1),d=n.QL(),v=void 0,d&&(v=Tt(!0),n.x4t(e,i,v)),n.STt(),(m=n.jS).zB=n,m.zB.VB=new D.Range(u,s,c,f),n.xP(e,i,P,v,t),n.I4t(),g=G(i,l-e+1),r.clear(e,s,g,f,3,$),p=D.CopyToOptions.value|D.CopyToOptions.formula|D.CopyToOptions.comment|D.CopyToOptions.outline|D.CopyToOptions.sparkline|D.CopyToOptions.span|D.CopyToOptions.style|D.CopyToOptions.tag|D.CopyToOptions.bindingPath|D.CopyToOptions.hyperlink|D.CopyToOptions.altText,e+i<=l&&(b=l-i-e+1,d&&!n.oL?n.BSt.forEach(function(t,n){var n=s+n;t.dataField()?r.moveTo(e+i,n,e,n,b,1,D.CopyToOptions.style):r.moveTo(e+i,n,e,n,b,1,p)}):r.moveTo(e+i,s,e,s,b,f,p)),o&&(y=(w=1+l)-g,M=a-w+1,r.moveTo(w,s,y,s,M,f,p)),C=r.Ut,S=n.dataRange(),C.yJ&&C.yJ(e,i,[S],!0),delete m.zB.VB,m.zB=P,n.ITt(),n.J5t(),n.W5t(e,i,!1),n.jS.dl()}finally{n.sL(!0),xt(r),n.cL(0),r.recalcAll(!0)}}},c.prototype.insertColumns=function(t,n,e){var i;j(t)||j(n)||n<=0||(t=Et(i=this,t,!1),i.k4t(t,n,e))},c.prototype.k4t=function(t,n,e){var i,r,o,a,u,s,c,u,f,c,l,h,d,v,m,g,h,p,b,w,y,M,C,S,T,A,I,x,N,k,_;if(!(j(t)||j(n)||n<=0||(r=(i=this).Mf,a=(o=i.dataRange()).row,u=o.col,s=o.rowCount,c=o.colCount,(t<u||u+c<=t)&&O(H().Exp_ColParamOutOfRange),u=i.Ky,f=i.iw,h=u+(c=i.Sx)-1,m=(d=f+(l=i.Tx)-1)<(v=yt(r,i)),Mt(r,i,u,h,1+d,v,n,!1,!0)))){h=(g=e?t+1:t)+n,It(r);try{if(i.sL(!1),i.STt(),w=!(b=((p=i.jS).zB=i).QL()),M=(y=1+d)+n,C=v-y+1,S=D.CopyToOptions.value|D.CopyToOptions.formula|D.CopyToOptions.comment|D.CopyToOptions.outline|D.CopyToOptions.sparkline|D.CopyToOptions.span|D.CopyToOptions.style|D.CopyToOptions.tag|D.CopyToOptions.bindingPath|D.CopyToOptions.hyperlink|D.CopyToOptions.altText,m&&r.moveTo(u,y,u,M,c,C,S),i.qO(g,n,e,w,!0),i.xTt(g,n,!0),i.I4t(g,n,!0),!e||t!==d){if(r.EB=!0,T=i.oL?1:0,b&&!i.oL)for(A=i.BSt,I=l-1;g-f<=I;I--)x=A[I],N=f+I,x.dataField()?r.moveTo(a,N,a,N+n,s+T,1,D.CopyToOptions.style):r.moveTo(a,N,a,N+n,s+T,1,S);else r.moveTo(a,g,a,h,s+T,d-g+1,S);delete r.EB}k=r.Ut,_=i.dataRange(),k.wJ&&k.wJ(g,n,[_],!0),k.NTt&&k.NTt(g,n,[_]),p.zB=P,i.ITt(P,!0),i.J5t(),i.Q5t(g,n,!0),(0,Z.hMt)(r,g,n,!0,!1,o),i.jS.dl()}finally{i.sL(!0),xt(r),i.cL(0),r.recalcAll(!0)}}},c.prototype.deleteColumns=function(t,n){var e;j(t)||j(n)||n<=0||(t=Et(e=this,t,!1),e.wE(t,n))},c.prototype.wE=function(t,n){var e,i,r,o,a,u,s,c,a,o,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I;if(!(j(t)||j(n)||n<=0||(i=(e=this).Mf,o=(r=e.dataRange()).col,a=r.colCount,(t<o||o+a<=t)&&O(H().Exp_ColParamOutOfRange),u=e.Ky,s=e.iw,o=u+(c=e.Sx)-1,f=s+(a=e.Tx)-1,l=e.oL?1:0,(a<=1||t===s&&a<=n)&&O(H().Exp_TableDeleteCountInvalid),d=f<(h=yt(i,e)),Mt(i,e,u,o,1+f,h,n,!0,!0)))){It(i);try{if(e.sL(!1),e.STt(),v=e.jS,m=e.QL(),v.zB=e,v.zB.VB=new D.Range(u,s,c,a),e.NP(t,n),e.xTt(t,n,!1),e.I4t(t,n,!1),g=G(n,f-t+1),i.clear(u,t,c,g,3,$),p=D.CopyToOptions.value|D.CopyToOptions.formula|D.CopyToOptions.comment|D.CopyToOptions.outline|D.CopyToOptions.sparkline|D.CopyToOptions.span|D.CopyToOptions.style|D.CopyToOptions.tag|D.CopyToOptions.bindingPath|D.CopyToOptions.hyperlink|D.CopyToOptions.altText,t+n<=f){if(i.EB=!0,m&&!e.oL)for(b=e.BSt,w=t-s+n-1;w<e.Tx;w++)y=b[w],M=s+w,y.dataField()?i.moveTo(u,M,u,M-n,c-l,1,D.CopyToOptions.style):i.moveTo(u,M,u,M-n,c-l,1,p);else i.moveTo(u,t+n,u,t,c-l,f-n-t+1,p);delete i.EB}d&&(S=(C=1+f)-g,T=h-C+1,i.moveTo(u,C,u,S,c,T,p)),A=i.Ut,I=e.dataRange(),A.MJ&&A.MJ(t,n,[I],!0),A.kTt&&A.kTt(t,n),delete v.zB.VB,v.zB=P,e.ITt(!0),e.J5t(),e.Q5t(t,n,!1),(0,Z.hMt)(i,t,n,!1,!1,r),e.jS.dl()}finally{e.sL(!0),xt(i),e.cL(0),i.recalcAll(!0)}}},c.prototype.STt=function(){try{var t=this,n=t.Mf,e,i=t.jS.U3;n&&n.Ut.DTt([t],[],2),i.splice(i.indexOf(t),1),t.U5t()}catch(t){}},c.prototype.ITt=function(t,n){var e=this;e.mTt=!0,e.iTt=t,e.jS.WB(e,P,n),delete e.iTt,delete e.mTt},c.prototype.xTt=function(t,n,e){for(var i,r,o,a,u,s,c,f,i=this,r=i.BSt,o=r.length,a=St(i,t),c=a;c<o;c++)f=void 0,e?a+n-1<c&&(f=c-n):a<=c&&(f=c+n),(s=(u=r[c]).footerFormula())&&i.MTt(s,t,n,e,!0,f)},c.prototype.MTt=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,u=this,s=u.Mf;if(0<e&&t&&t.arguments)for(c=t.arguments,l=f=void 0,h=0;h<c.length;h++)(f=c[h])instanceof Z.obt&&(s&&(r?s.Ut._Tt(this,f,o):s.Ut.ETt(u,f,o,a)),f._K(),l=f.offsetWhenInsertRemoveColumn(n,e,i,r),c[h]=l)},c.prototype.rCe=function(n){var e=this,t;e.BSt.forEach(function(t){var t=t.footerFormula();t&&Xe(e,t,n)})},c.prototype.ftt=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,n=this,e=n.H3,i=n.Mf,r=n.jO?1:0,o=n.Ky+r+t,a=n.iw;if(!e||0===e.getRowCount())return B;if(u=n.Tx,s={},c=e.ftt(t))for(f in c)g(c,f)&&"function"!=typeof f&&(s[f]=c[f]);for(l=0;l<u;l++)d=(h=n.BSt[l])&&h.dataField(),h&&d&&0<d.length&&j(s[d])&&(s[d]=i.getValue(o,a+l));return s},c.prototype.x4t=function(t,n,e){var i,r,o,a,u,s,c,f,i=this,r=[],o=i.H3;if(o)for(s=o.getRowCount(),c=0;c<n;c++)f=B,(u=Ct(i,a=t+c))<s&&(f=i.ftt(u)),r.push({key:e,data:f});i.aj=r},c.prototype.tq=function(){var e=[],t=this.aj;return t&&y(t,function(t,n){n&&!D.GC$.isFunction(n)&&e.push(n.data)}),e},c.prototype.R5t=function(t,n,e){var i,r,o,a,u,s,i=this;0<i.Mf.lE||(r=i.GSt,(o=i.H3)&&(a=B,n<(u=o.getRowCount())&&(a=i.ftt(n)),r[t]=s={key:e,data:a}))},c.prototype.sTt=function(t,n,e){var i,r,e,o,i=this;if(!(0<i.Mf.lE))if(r=i.GSt,e)e=r.splice(t,n),i.USt.push({rowIndex:t,count:n,deletedDirtyItems:e});else for(o=0;o<n;o++)r.splice(t,0,B)},c.prototype.A4t=function(t,n){this.GSt.splice(t,n)},c.prototype.ZSt=function(){var t,n,n,e,i,r,o,a,t=this,n=t.USt;if(n&&0<n.length)for(e=(n=n.pop()).rowIndex,i=n.count,r=n.deletedDirtyItems,o=0;o<i;o++)a=r[o],t.GSt[e+o]=f({},a)},c.prototype.getDirtyRows=function(){for(var t,n,e,i,r,o,t=this,n=t.GSt,e=[],o=0;o<n.length;o++)i=n[o],j(i)||(r=Ct(t,o),e.push({row:r,originalItem:i.data,item:t.ftt(r)}));return e},c.prototype.clearPendingChanges=function(){this.GSt=[]},c.prototype.footerRowDropDowns=function(t,n){var e,t,t,i,r,n,e=this,t=e.OSt[t];if(t)return 1===arguments.length?t.dropDowns&&t.dropDowns.slice():(t=t.dropDowns[0],n?(i=n.listOption,r=n.submitCommand,n=n.type,i&&(t.option=i),r&&(t.submitCommand=r),x(n)&&(t.type=n),e):void 0)},c.prototype.checkTableLastRow=function(t){var n=this,e=n.dataRange();return n.headerIndex()===t||e.row+e.rowCount-1!==t},c.prototype.checkTableLastCol=function(t){var n,e=this.dataRange();return e.col+e.colCount-1!==t},c.prototype.jj=function(t,n,e,i,r){var o,a,i,r,a,o=this,a=o.Mf;Nt(a,o,e?Un:Bn,t,n,i,r),i=a.Ut,r=e?Bn:Un,a=!e&&P,i&&i.ZI(["tableRowsChanged",o,r,t,n,a,e])},c.prototype.Ej=function(t,n,e,i){var r,o,i,a,o,r=this,o=r.Mf;kt(o,r,e?Vn:Hn,t,n,i),i=o.Ut,o=!e&&P,i&&i.ZI(["tableColumnsChanged",r,a=e?Hn:Vn,t,n,o])},V=c,A.Table=V,A.hasRowFilter=ii,(0,D.$e)(V),we={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"},V.prototype.name=e(Wt,"",ri(Wt),i),V.prototype.bandRows=e($t,!0,ri($t)),V.prototype.bandColumns=e(tn,!1,ri(tn)),V.prototype.highlightFirstColumn=e(Xt,!1,ri(Xt)),V.prototype.highlightLastColumn=e(qt,!1,ri(qt)),V.prototype.style=e("style",P,oi),V.prototype.autoGenerateColumns=e(nn,!0,ri(nn)),h&&h.HideRowFilter&&(n=h.HideRowFilter,s(o,Te=n),o.prototype.pct=function(){return 0},o.prototype.bct=function(){return this.range.colCount},o.prototype.table=function(t){var n=this;if(0===arguments.length)return n.nM;(n.nM=t)&&(n.Mf=t.Mf)},o.prototype.unfilter=function(t,n){var e,i,t,e=this,i=e.Mf;i&&i.suspendPaint(),Te.prototype.unfilter.call(this,t,n),(t=e.nM)&&t.jS&&t.jS.dl(),i&&i.resumePaint()},o.prototype.JO=function(t,n){var e=this,i=e.nM;Te.prototype.JO.call(this,t,n),i&&e.Fct(i.dataRange())},o.prototype.xP=function(t,n){var e=this,i=e.nM;Te.prototype.xP.call(this,t,n),i&&e.Fct(i.dataRange())},o.prototype.ert=function(t,n,e,i,r){var o,a,u,o,a=this.nM;Te.prototype.ert.call(this,t,n,e,i,r),a&&a.N5t()&&(u=a.getSlicerData()).refresh()},o.prototype.toJSON=function(){var t,n,t,t=this,n=Te.prototype.toJSON.call(t),t=t.nM;return t&&(n.tableName=t.name()),n},o.prototype.L0=function(){this.nM=B,this.Mf=B},A.WSt=o),hi.prototype.tTt=function(){return 0<this.id()},hi.prototype.toJSON=function(){var i,r,o,i=this,r={};return x(i.cellType())&&Y(o=li(i))&&(o.cellType=i.cellType()),x(i.formatter())&&!Y(o=li(i))&&(o.formatter=i.formatter()),y(jn,function(t,n){var e=i[n]();j(e)||(!o||Y(o)||n!==Qt&&n!==Kt)&&(e.toJSON&&"function"==typeof e.toJSON?r[n]=e.toJSON():r[n]=e)}),m(r)?P:r},hi.prototype.wh=function(t,n,e,i,r,o,a,u,s){var c,f,f,l,h,d,v,i,l,v,a,h,m,e,r,l,c=this,f=c.name();return f=rt(f,"\r",""),f={n_:"tableColumn",id:c.id(),name:xe(f)},l=c.footerFormula(),h=c.footerValue(),l&&(o&&!1===o.includeFormulas?(l=P,h=t.getValue(i,r)):v=ci(d=T(t,l,i,r))),(i=v===ne)?f.totalsRowFunction=ne:l?f.totalsRowFunction=v:j(h)||(f.totalsRowLabel=xe(h.toString()),a.v=h),l=c.dataAreaFormula(),j(l)||fi(l=T(t,l,e,r))||(j(f.c_)&&(f.c_=[]),v={n_:"calculatedColumnFormula",c_:[it(st(l))]},f.c_.push(v)),i&&!j(d)&&(a={n_:"totalsRowFormula",c_:[it(d)]},j(f.c_)&&(f.c_=[]),f.c_.push(a)),h=f.lossless,j(c.value())||((h=j(h)?f.lossless={}:h)[Jt]=c.value()),j(c.dataField())||((h=j(h)?f.lossless={}:h)[In]=c.dataField()),e=c.cellType(),r=c.formatter(),x(e)&&(m=li(c),(h=j(h)?f.lossless={}:h)[Qt]=null!=e&&e.toJSON?e.toJSON():e,Y(m)||(m.cellType=e)),x(r)&&(Y(m=li(c))?(h=j(h)?f.lossless={}:h)[Kt]=r:m.formatter=r),l=!D.Util.ko(o),ei(n.Kpe,c.dataStyle(),"data",l,f,t,u),l&&!1!==s||ei(n.Jpe,c.headerStyle(),"headerRow",l,f,t,u),ei(n.Xpe,c.footerStyle(),"totalsRow",l,f,t,u),f},hi.prototype.fromJSON=function(o){var a;o&&(a=this,y(jn,function(t,n){var e,i,r,r,i,e=o[n]!==P?o[n]:o["_"+n];j(e)||(n===Qt?(i=e.typeName,(r=(r=D.CellTypes&&D.CellTypes.ti)&&r[i]||r[e.type]||(0,D.getTypeFromString)(i))&&((i=new r).fromJSON(e,!1),e=i),x(e)&&a.cellType(e)):n===Kt&&x(e)&&a.formatter(e),a[n](e,!1))}),Ye(a,o,en),Ye(a,o,rn),Ye(a,o,on))},hi.prototype.yh=function(t,n,e,i){var r,o,o,o,o,n,o,o,e,n,i,o,e,n,i,o,t,t,o,t,o,i;t&&((r=this).id(tt(t.id,0)),o=t.name,j(o)||(o=rt(o,"_x000d__x000a_","\n"),r.name(Ne(o))),o=t.totalsRowLabel,j(o)||(o=rt(o,"_x000d__x000a_","\n"),r.footerValue(Ne(o))),n||(o=void 0,n=i&&i.getDefaultStyle(),!j(t.dataDxfId)&&e&&(o=e.getDxf(+t.dataDxfId,P,!0,!0)),j(t.dataCellStyle)||(o?o.parentName=t.dataCellStyle:o=t.dataCellStyle),o=o&&Le(o,n,i),r.dataStyle(o),o=void 0,!j(t.headerRowDxfId)&&e&&(o=e.getDxf(+t.headerRowDxfId,P,!0,!0)),j(t.headerRowCellStyle)||(o?o.parentName=t.headerRowCellStyle:o=t.headerRowCellStyle),o=o&&Le(o,n,i),r.headerStyle(o),o=void 0,!j(t.totalsRowDxfId)&&e&&(o=e.getDxf(+t.totalsRowDxfId,P,!0,!0)),j(t.totalsRowCellStyle)||(o?o.parentName=t.totalsRowCellStyle:o=t.totalsRowCellStyle),o=o&&Le(o,n,i),r.footerStyle(o),e=t.totalsRowFunction,j(e)||((n=e)===ne&&(n=et(p(_(t,"totalsRowFormula")))),r.footerFormula(n)),i=_(t,"calculatedColumnFormula"),j(i)||(o=""+p(i),r.dataAreaFormula(et(ut(o)))),e=t.lossless,n=void 0,j(e))||(i=e[Qt],j(i)||(o=i.typeName,(t=(t=D.CellTypes&&D.CellTypes.ti)&&t[o]||t[i.type]||(0,D.getTypeFromString)(o))&&((o=new t).fromJSON(i),i=o),j(i))||(Y(n=li(r))?r.cellType(i):n.cellType=i),t=e[Jt],j(t)||r.value(t),o=e[Kt],j(o)||(Y(n=li(r))?r.formatter(o):n.formatter=o),i=e[In],j(i))||r.dataField(i))},hi.prototype.cellType=function(t){var n=this,e=n.dataStyle();if(0===arguments.length)return e&&e.cellType;e||(e=new D.Style,n.dataStyle(e)),e.cellType=t},hi.prototype.formatter=function(t){var n=this,e=n.dataStyle();if(0===arguments.length)return e&&e.formatter;e||(e=new D.Style,n.dataStyle(e)),e.formatter=t},z=hi,(A.TableColumn=z).prototype.id=function(t){var n=e(An,P,function(t){var n=this;n.name()||n.name(Tn+t)});return 0===arguments.length?n.call(this):j(t)?this:n.call(this,t)},z.prototype.name=e(Wt,P,function(t){var n,e,n=this;t?(e=D.util.V0(t="string"!=typeof t?""+t:t))!==t&&e.toLocaleDateString&&n.name(e.toLocaleDateString()):n.name(Tn+n.id())}),z.prototype.dataStyle=e(en),z.prototype.headerStyle=e(rn),z.prototype.footerStyle=e(on),z.prototype.value=e(Jt),z.prototype.dataField=e(In),z.prototype.footerValue=e(_n),z.prototype.dataAreaFormula=e(kn),z.prototype.footerFormula=e(xn),z.prototype.x5t=e(t),z.prototype.hTt=e(Nn),a.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,t,n=this.all(),e={};if(n)for(i=void 0,r=0,o=n;r<o.length;r++)a=o[r],de(e,he(a.range()));return e},a.prototype.L0=function(){for(var t,n,e,i,r,t=this,n=t.U3,e=n.length,r=0;r<e;r++)(i=n[r])&&i.L0();t.U3=[],t.zB=P,t.dl(),t.Mf=B},a.prototype.dl=function(){var t,n,e,i,r,t=this;for(t.xl=[],t.Nl=[],e=(n=t.U3).length,r=0;r<e;r++)(i=n[r]).dl()},a.prototype.KSt=function(t,n){for(var e,i,r,o,a,e,i=this.U3,r=i.length,a=0;a<r;a++)o=i[a],!n&&Ie(o.HSt,t)?o.HSt=[]:j(o.HSt[t])||(o.HSt[t]=P)},a.prototype.JSt=function(t){for(var n,e,i,r,o,n,e=this.U3,i=e.length,o=0;o<i;o++)Ie((r=e[o]).zSt,t)?r.zSt=[]:j(r.zSt[t])||(r.zSt[t]=P)},a.prototype.add=function(t,n,e,i,r,o,a){return this._Qt(t,n,e,i,r,o,a)},a.prototype._Qt=function(t,n,e,i,r,o,a,u){var s=this;return s.jTt(s.Mf,t,n,e,i,r,!0),s.WB(new V(t,n,e,i,r,o||W.TableThemes.medium2,a),P,P,u)},a.prototype.addFromDataSource=function(t,n,e,i,r,o){var a,u,s,i,c,a;if(i||O(H().Exp_TableDataSourceNullError),I.$$)return(u=(a=this).Mf).suspendPaint(),vt(u),(s=new I.$$).bind(i),i=s.getRowCount()+1,c=s.getColumnCount(),(a=a.add(t,n,e,i,c,r,o)).D3(s),u.clearPendingChanges(),mt(u),u.resumePaint(),a},a.prototype.find=function(t,n){return this.Hq(t,n)},a.prototype.Hq=function(t,n,e){for(var i,r,o,a,u,s,i=this,r=i.U3,o=(r=!0===e&&i.zB?r.concat([i.zB]):r).length,u=0;u<o;u++)if((s=(a=r[u]).range()).row<=t&&t<s.row+E(s)&&s.col<=n&&n<s.col+R(s))return a;return B},a.prototype.findByName=function(t){return this._bt(t)},a.prototype._bt=function(t,n){for(var e,i,r,o,a,e=this,i=e.U3,r=(i=!0===n&&e.zB?i.concat([e.zB]):i).length,a=0;a<r;a++)if((o=i[a]).name().toLowerCase()===t.toLowerCase())return o;return B},a.prototype.pP=function(t,n,e,i){for(var r,o,a,u,s,c,r=this.U3,o=r.length,a=(0,D.Ec)(t,e,n,i),u=[],c=0;c<o;c++)s=r[c],a.containsRange(s.range())&&u.push(s);return u},a.prototype.AB=function(t,n,e,i){for(var r,o,a,u,s,r=this.U3,o=r.length,a=[],s=0;s<o;s++)(u=r[s]).range().intersect(t,n,e,i)&&a.push(u);return a},a.prototype.Uue=function(t){for(var n,e,i,r,o,a,u,s,n=this.U3,e=n.length,i=t.row,r=t.col,o=t.rowCount,a=t.colCount,s=0;s<e;s++)if((u=n[s]).range().intersect(i,r,o,a))return u},a.prototype.Dy=function(){var t,n,t,t=this,n=t.Mf,t=t.find(n.ui,n.ci);if(t)return n.j1(new D.Range(-1,t.iw,-1,t.Tx))},a.prototype.WB=function(t,n,e,i){var r,o;if(t)return(r=this).findByName(t.name())&&O(H().Exp_TableHasSameNameError),(o=r.Mf).suspendPaint(),t.Sg(r),o.Ut.DTt([],[t],1),r.U3.push(t),t.mTt||t.qSt(),!n&&t.showHeader()&&t.a5t(P,P,e,i),!n&&t.showFooter()&&t.l5t(),r.OTt(t),o.resumePaint(),o.Ut.Spe(),t},a.prototype.DK=function(t){var n,e,i,n=this,e=b(t,n.U3);return-1<e?((i=n.Mf)&&i.Ut.DTt([t],[],2),n.U3.splice(e,1),n.RTt([t],!1),n.U3.length<1&&i.Ut.Spe(),t):B},a.prototype.remove=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,e=this;if((t=At(t)?e.findByName(t):t)&&(n=n||0,t.s5t(),t=e.DK(t))){i=t.range(),r=e.Mf;try{if(C(r),o=i.row,a=i.row+E(i),u=i.col,s=i.col+R(i),f=c=void 0,l=t.showHeader(),h=t.headerIndex(),1!=(1&n))for(c=o;c<a;c++)for(f=u;f<s;f++)N(r,c,f,B),M(r,c,f,B);else if(t.QL()){if(l)for(c=h,f=u;f<s;f++)r.setValue(c,f,t.getColumnName(f-i.col));for(m=(v=(d=t.dataRange()).row)+E(d),b=p=g=void 0,c=v;c<m;c++)for(f=u;f<s;f++)(p=t.BSt[St(t,f)])&&(b=(g=t.ftt(Ct(t,c)))[p.dataField()],j(b)||r.setValue(c,f,b))}else if(l)for(c=h,f=u;f<s;f++)r.setValue(c,f,t.getColumnName(f-i.col));if(2==(2&n))for(c=o;c<a;c++)for(f=u;f<s;f++)w=r.Z_(c,f)||new D.Style,t.h5(c,f,w),r.setStyle(c,f,w)}finally{S(r)}t.cL(2)}return t},a.prototype.move=function(t,n,e){var i,r,o,i,o,i=this,r=i.Mf;if((t=At(t)?i.findByName(t):t)&&0<=n&&0<=e&&(o=t.range(),0===(o=(i=i.AB(n,e,E(o),R(o))).length)||1===o&&i[0]===t)){C(r);try{t.G5t(n,e)}finally{S(r)}}},a.prototype.resize=function(t,n){var e,i,r,o,a,n,a,u,s,c,f,l,e=this,i=e.Mf;if((t=At(t)?e.findByName(t):t)&&(r=t.range(),o=t.dataRange(),n=n,n=3===(a=arguments).length?(0,D.Ec)(r.row,r.col,a[1],a[2]):n)&&(a=E(n),u=R(n),0<=a)&&0<=u&&(s=e.AB(n.row,n.col,a,u)).length<=1){It(i);try{t.K5t(n),t.QL()||(c=i.conditionalFormats,f=i.b8,l=n.rowCount-r.rowCount,c&&c.qJ(r,o,l),f&&f.qJ(r,o,l))}finally{xt(i)}}},a.prototype.all=function(){var e=[];return y(this.U3,function(t,n){e.push(n)}),e},a.prototype.$St=function(t){for(var n,e,i,n=t||this.U3,e=n.length,i=0;i<e;i++)n[i].clearPendingChanges()},a.prototype.Yj=function(t,n,e,i){for(var r,o,a,u,s,r=[],o=this.U3,a=o.length,u=0;u<a;u++)(s=o[u]).Ky>=t&&s.iw>=n&&s.Ky+s.Sx<=t+e&&s.iw+s.Tx<=n+i&&r.push(s);return r},a.prototype.Zj=function(t,n,e,i){var r,o,a,u,r=this,o=r.AB(t,n,e,i),a=r.Yj(t,n,e,i),u=[];return 0<a.length?o.forEach(function(t){-1===a.indexOf(t)&&u.push(t)}):u=o,u},a.prototype.Wj=function(t,n,e){for(var i,r,o,a,i=t.length,o=0;o<i;o++)if((a=(r=t[o]).range()).row<=n&&n<a.row+E(a)&&(e<0||a.col<=e&&e<a.col+R(a)))return!0;return!1},a.prototype.jTt=function(t,n,e,i,r,o,a){var u,u,n,s;return n?gt(n)?e<0||r<1||e+r>t.getRowCount()?(a&&O(H().Exp_TableInvalidRow),!1):i<0||o<1||i+o>t.getColumnCount()?(a&&O(H().Exp_TableInvalidColumn),!1):(u=t.tables).Pl(e,i,r,o)?(a&&O(H().Exp_TableIntersectError),!1):u.findByName(n)?(a&&O(H().Exp_TableHasSameNameError),!1):ii(t,new D.Range(e,i,r,o))?(a&&O(H().Exp_TableRangeHasFilterError),!1):(n=(u=w&&t.iT(e,i,r,o))&&u.ranges,s=!0,n&&y(u,function(t,n){if(1<E(n)||1<R(n))return a&&O(H().Exp_ArrayFormulaTable),s=!1}),s):(a&&O(H().Exp_TableNameInvalid),!1):(a&&O(H().Exp_TableEmptyNameError),!1)},a.prototype.WI=function(t,n,e,i){for(var r,o,a,u,r=[],o=this.U3,a=0;a<o.length;a++)(u=o[a]).Ky>=t&&u.iw>=n&&u.Ky+u.Sx<=t+e&&u.iw+u.Tx<=n+i&&r.push(u.name());return r},a.prototype.oSt=function(t,n,e,i){var r,o,a,u,s,r=this.all();if(r)for(o=(0,D.Ec)(t,n,e,i),a=r.length,u=void 0,s=0;s<a;s++)if(u=r[s].range(),o.intersect(u.row,u.col,E(u),R(u))&&!o.containsRange(u))return!0;return!1},a.prototype.Pl=function(t,n,e,i){for(var r,o,a,u,r=this.U3,o=r.length,u=0;u<o;u++)if((a=r[u]).range().intersect(t,n,e,i))return!0;return!1},a.prototype._getTable=function(t,n,e,i,r){for(var o,a,u,s,c,f,o=t.tables.all(),a=o.length,s=[],c=0;c<a;c++)(f=(u=o[c]).range()).row>=n&&f.col>=e&&f.row+f.rowCount<=n+i&&f.colCount+f.col<=e+r&&s.push({table:u,index:c});return s},a.prototype.mx=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,d,o=e.tables.all(),a=o.length;if(!j(n)&&(s=i.row-n.row,c=i.col-n.col,0!==(f=this._getTable(t,n.row,n.col,n.rowCount,n.colCount)).length))for(l=0;l<a;l++)for(u=o[l],h=0;h<f.length;h++)if(d=f[h],(!r||l!==d.index)&&(d=d.table.range(),u.range().intersect(d.row+s,d.col+c,d.rowCount,d.colCount)))return e.jT(6,H().Exp_TableIntersectError),!0;return!1},a.prototype.t5t=function(t,n){for(var e,i,r,o,e=this,i=e.U3,r=0,o=i.length;r<o;r++)i[r].t5t(t,n);e.Mf.filterRowsVisibleInfo.rE(t,n)},a.prototype.JO=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,e,h,d,v,m,g,e=this,i=e.U3,r=[],o=0,a=i.length;o<a;o++)s=(u=i[o]).z3(),f=(c=u.cue&&!(u.jO&&1===u.Sx))?t-1:t,J(r,s)?u.JO(f,n,!0,!0):(l=u.JO(f,n,c,P,u.cue))&&r.push(s);e=e.Mf;try{for(C(e),d=h=void 0,o=0,a=i.length;o<a;o++)h=(u=i[o]).pTt(),d=u.dataRange(),0<h&&h!==E(d)&&(v=h,u.showHeader()&&(v+=1),u.showFooter()&&(v+=1),m=u.range(),g=(0,D.Ec)(m.row,m.col,v,R(d)),u.K5t(g,!0))}finally{S(e)}},a.prototype.qO=function(t,n){for(var e,i,r,o,e=this.U3,i=e.length,o=0;o<i;o++)(r=e[o]).qO(t,n)},a.prototype.n5t=function(t){for(var n,e,i,r,o,a,n=this.U3,e=n.length,a=0;a<e;a++)r=(i=n[a]).iw,o=i.endColumn(),r<=t&&t<=o&&i.n5t()},a.prototype.$pe=function(t){var n=this,e=n.Mf;(n.U3.length<1&&0<t.length||0<n.U3.length&&t.length<1)&&e.Ut.Spe(),n.U3=t},a.prototype.xP=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,e=this,i=e.U3,r=[],o=[],a=[],u=0,s=i.length;u<s;u++)f=(c=i[u]).z3(),((h=t<=(l=c.range()).row&&l.row+E(l)<=t+n)?a:(J(r,f)?c.xP(t,n,!0):(c.QL()&&c.x4t(t,n,Tt(!0)),(d=c.xP(t,n))&&r.push(f)),o)).push(c);e.Mf.filterRowsVisibleInfo.aE(t,n),e.Mf.Ut.DTt(a,[],2),e.$pe(o),e.RTt(a,!0),v=e.Mf;try{for(C(v),i=e.U3,g=m=void 0,u=0,s=i.length;u<s;u++)m=(c=i[u]).pTt(),g=c.dataRange(),0<m&&m!==E(g)&&(p=m,c.showHeader()&&(p+=1),c.showFooter()&&(p+=1),b=c.range(),w=(0,D.Ec)(b.row,b.col,p,R(g)),c.K5t(w,!0))}finally{S(v)}},a.prototype.NP=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=this,i=e.U3,r=[],o=[],a=i.length,s=0;s<a;s++)((f=t<=(c=(u=i[s]).range()).col&&c.col+R(c)<=t+n)?o:(u.NP(t,n),r)).push(u);e.Mf.Ut.DTt(o,[],2),e.$pe(r),e.RTt(o,!0)},a.prototype.d5=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,o=this,a=(0,D.Ec)(t,n,e,i),f=[],l=o.Mf;if(1==(1&r)){for(h=[],s=(u=o.U3).length,d=0;d<s;d++)c=u[d],(a.containsRange(c.range())?f:h).push(c);for(s=h.length,d=0;d<s;d++)(c=h[d]).d5(t,n,e,i);l&&l.Ut.DTt(f,[],2),o.$pe(h)}if(2==(2&r))for(s=(u=o.U3).length,d=0;d<s;d++)c=u[d],a.containsRange(c.range())&&(l&&l.Ut.YSt(c,"style",c.style()),c.style(B));return o.RTt(f,!0),f},a.prototype.RTt=function(t,n){var e;t&&0!==t.length&&(e=this.Mf,D.GC$.each(t,function(t,n){n.N5t()&&n.getSlicerData().onTableRemoved(n),n.g5t()&&(e&&e.Ut.YSt(n,Dn,n.b5t()),n.OSt=[])}),w)&&ke(this.Mf,t,n)},a.prototype.OTt=function(t){t&&t.N5t()&&t.getSlicerData().onTableAdded(t)},a.prototype.BTt=function(t){for(var n,e,i,r,n=1,e,i=t,r=this.LTt();!this.FTt(i,r);)i=t+(3<t.length?"":"_")+n,n++;return i},a.prototype.LTt=function(){for(var t,n,e,i,r,o,a,u,s,c,t=[],n,e,r=0,o=this.Mf.parent.sheets;r<o.length;r++)for(u=0,s=i=(a=o[r]).tables.all();u<s.length;u++)c=s[u],t.push(c);return t},a.prototype.FTt=function(t,n){for(var e,i,r,e=0,i=n;e<i.length;e++)if((r=i[e]).name().toLowerCase()===t.toLowerCase())return!1;return!0},a.prototype.Sl=function(t,n){var e,i,r,o,e,i=!1,r=B,o=this.find(t,n);return o&&(o.showHeader()&&t===o.headerIndex()?(r=o.q5t(n),j(r)||(r=d(r)),i=!0):(i=(r=o.Sl(t,n)).e5t,r=r.y4)),{e5t:i,y4:r}},a.prototype.Kbt=function(t,n,e){var i,r,o,a,i,r=!1,o=!0,a=this.find(t,n);return a&&!0!==a.eTt&&(a.showHeader()&&t===a.headerIndex()?(j(e)||(e=a.nTt(d(e),n-a.iw)),a.$5t(n,e)):a.showFooter()&&t===a.footerIndex()?a.d5t(n,e):r=a.Kbt(t,n,e)),r||!1},a.prototype.pMt=function(t,n,e,i,r,o){var a=this.find(t,n);if(w&&a){if(1<e||1<i)return this.Mf.jT(0,H().Exp_ArrayFormulaTable),!1;if(a.showHeader()&&t===a.headerIndex()&&r)return!1;!a.eTt&&a.showFooter()&&t===a.footerIndex()&&(j(r)||a.d5t(n,B),a.m5t(n-a.iw,r,o))}return!0},a.prototype.XSt=function(){for(var t,n,e,i,t=this.all(),n=0,e=t.length;n<e;n++)(i=t[n]).bindingPath()&&(i.H3=B)},a.prototype.KB=function(t,n){var e,i,r,o,a,e=[],i=this;if(i&&(r=i.all()))for(a=r.length-1;0<=a;a--)o=r[a],t.containsRange(o.range())&&(n&&(this.Mf&&this.Mf.Ut.DTt([o],[],2),i.U3.splice(a,1),o.U5t(P,P,n)),e.push(o));return e},a.prototype.JB=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,f,f,d,a=this,u=[],s=0,c=t.length;s<c;s++)f=t[s],h=l=void 0,o?h=f:(l=f.bindingPath()?P:f.z3(),(h=new V).Sg(a),h.fromJSON(Zt(Yt(f.toJSON()))),h.name(a.BTt(h.name())),u.push(h)),f=h.range(),h.rTt=!0,h.H5t(i+f.row-n,r+f.col-e),a.WB(h,o),o?(f=h.LSt)&&(f.Mf=a.Mf,f.refresh()):l&&h.V3(l),h.rTt=!1;for(s=0;s<u.length;s++)(d=u[s]).formulaFromJSON(),o||d.rCe(t[s].name())},a.prototype.qB=function(t){for(var n=0,e=t.length;n<e;n++)t[n].z5t()},a.prototype.toJSON=function(t,n){var e,i,r,o,e=this.U3,i=[];if(e)for(r=0;r<e.length;r++)o=t?this.BTt(e[r].name()):P,i.push(e[r].toJSON(o,n));return 0===i.length?P:i},a.prototype.wh=function(t){var n,e,i,r,o,a,u,u,a;if(t&&(n=t.rels,i=(e=this.U3).length,n)&&0<i){for(r=[],o=0;o<i;o++)a=e[o],u=ct(n),u=D.XFileConstants.Rr+u,a=a._id,n.c_.push({n_:D.XFileConstants.Lr,Id:u,Type:D.RelationshipConstants.lc,Target:"../tables/"+D.XFileConstants.du+a+"."+D.XFileConstants.Cr}),r.push({n_:"tablePart","r:id":u});t.c_||(t.c_=[]),t.c_.push({n_:ie,count:i,c_:r})}},a.prototype.fromJSON=function(t,n,e){var i,r,o,a;if(t){for(this.U3=[],this.dl(),i=0,r=t.length;i<r;i++)o=t[i],(a=new V).Sg(this),this.U3.push(a),a.fromJSON(o,n,e);this.Mf.Ut.Spe()}},a.prototype.yh=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,d,d,d,v,m,r=t&&t.c_,o=!D.Util.ko(i);if(r&&n){for((u=D.Util.wo(i,(a=this).Mf.parent&&a.Mf.parent.v2))||(a.U3=[]),a.dl(),s=e.tables,c=e.styleManager,f=[],l=0,h=r.length;l<h;l++)d=r[l][ee],(d=(d=ft(n.c_,d))&&d.Target)&&(v=(d=s[d=d.split("/").pop().slice(0,-4)]).name,m=void 0,(m=u?a.findByName(v):m)||((m=new V(v)).Sg(a),a.U3.push(m)),m.yh(d,c,i),f.push(m.range()),o)&&m._5t(c);D.Util.Co(i)&&D.Util.Ao(a.Mf,f,P,e),this.Mf.Ut.Spe()}},a.prototype.containTableHeaderTotalRowForSheet=function(){var t,n,t,e,i,r,o,a,u,s,c,f,l,t=this.Mf;if(t&&(n=t.getSelections(),r=i=e=void 0,t=t.tables)&&n)for(o=t.U3,c=s=u=a=void 0,f=0;f<n.length;f++)for(r=(i=(e=n[f]).row)+e.rowCount-1,l=0;l<o.length;l++)if(u=(a=o[l]).range(),s=a.headerIndex(),c=a.footerIndex(),!e.containsRange(u)&&(i<=s&&s<=r||i<=c&&c<=r))return!0;return!1},a.prototype.containTableHeaderTotalRow=function(){var t,n,e,i,r,o,e,t,a,u,s,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=r=void 0,i=t.tables)&&e){if(1<e.length)return n;e=e[0],s=u=a=void 0,(t=Lt(t,e))&&1===t.length&&(o=(r=e.row)+e.rowCount-1,u=(a=t[0]).headerIndex(),s=a.footerIndex(),r<=u&&u<=o||r<=s&&s<=o)&&(n=!0)}return n},a.prototype.noRoomToInsertColumn=function(){var t,n,e,n,i,r,n,e,i,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(i=(n=n[0]).row,r=n.col,n=n.colCount,e=e.find(i,r),i=t.getColumnCount(3),e)&&e.endColumn()+n>=i)},a.prototype.noRoomToInsertRow=function(){var t,n,e,n,i,r,n,e,i,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(i=(n=n[0]).row,r=n.col,n=n.rowCount,e=e.find(i,r),i=t.getRowCount(3),e)&&e.endRow()+n>=i)},a.prototype.checkTableRow=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!(!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range(),t)&&e)||t.jO||t.oL||1!==e.rowCount)},a.prototype.checkTableCol=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range())&&1===e.colCount)},a.prototype.isAcrossTables=function(){var t,n,e,i,e,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),i=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=Lt(t,e))&&(n=1<t.length)}return n},a.prototype.isWholeTableCol=function(){var t,n,e,i,e,t,t,r,t,o,e,t=this.Mf,n=!1;return t&&(e=t.getSelections(),i=t.tables)&&e&&(1<e.length?n=!0:(e=e[0],1===(t=Lt(t,e)).length&&(r=(t=t[0]).iw,t=t.Tx,o=e.col,e=e.colCount,n=r===o&&t===e))),n},a.prototype.containTableHeader=function(){var t,n,e,i,r,o,e,t,a,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=r=void 0,i=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=Lt(t,e))&&1===t.length&&(t=(a=t[0]).headerIndex(),o=(r=e.row)+e.rowCount-1,r<=t)&&t<=o&&(n=!0)}return n},a.prototype.eq=function(){var t,n,e,i,r,t,o,a,u,s,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),i=t.tables)&&e){if(r=t.getActiveRowIndex(),t=t.getActiveColumnIndex(),1<e.length||!i.find(r,t))return n;for(o=i.U3,a=e[0],u=void 0,s=0;s<o.length;s++)u=o[s],a&&a.intersect(u.Ky,u.iw,u.Sx,u.Tx)&&(n=!0)}return n},a.prototype.uSt=function(t){var n,e,i,r,o,a,u,s,c,n=-1,e,i=this.U3;if(i)for(r=i.length,s=u=a=o=void 0,c=0;c<r;c++)o=i[c].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(s=(a=o.row)+(u=o.rowCount)-1)&&(n=s);return n},a.prototype.sSt=function(t){var n,e,i,r,o,a,u,s,c,n=-1,e,i=this.U3;if(i)for(r=i.length,s=u=a=o=void 0,c=0;c<r;c++)o=i[c].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(s=(a=o.col)+(u=o.colCount)-1)&&(n=s);return n},a.prototype.yx=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,a,p,b,n,w,y,M,C,S,T,A,u=this;if(!(u.Mf.isActualProtected()||t&&e&&di(t,e)||0===(s=u.all()).length||(c=e&&s.some(function(t){return e.equals(t.range())}))))for(a&&(v=a.shiftInfo,m=a.applyDragFillAfterTableExpand,g=a.backupTableResizedArgs,v)&&(f=v.shiftCells,l=v.isCopy,h=v.isFirst,d=v.isHeaderPaste),a=n.row,p=n.col,b=n.rowCount,n=n.colCount,d&&(-1===a&&(a=0),-1===p&&(p=0),-1===b&&(b=t.getRowCount()),-1===n)&&(n=t.getColumnCount()),w=new D.Range(a,p,b,n),C=0,S=s;C<S.length;C++)(y=S[C]).VSt&&(M=y.range(),T=e&&e.equals(M),A=e&&0!==u.Mf.Ut.getSpans(e,3).length,f?l&&h&&w.col===M.col&&w.colCount===M.colCount&&w.row>M.row&&e.col===M.col&&e.colCount===M.colCount&&e.row>M.row&&w&&M.contains(w.row,w.col,1,w.colCount)&&e&&M.containsRange(e)&&(u.PTt(y,M,w),v.ignoreFooterShiftIndex=y.footerIndex()):e&&(T||A)||(y.TTt=r,u.GTt(y,M,w,i,o,g,m),delete y.TTt))},a.prototype.GTt=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,p,r,p,b,w,y,M,C,S,T,m,A,g,I,d,x,N,M,u=this,s=u.Mf,c=null,f=!1,l=n.row,h=n.col,d=n.rowCount,v=n.colCount,m=l+d-1,g=new D.Range(l,h,d,v);if(t.showFooter()){if(p=new D.Range(l+d-1,h,1,v),e.row===p.row&&e.col>=h&&e.col+e.colCount<=h+v)return;f=!0,g.rowCount--}if(r&&(p=t.showHeader()?d-1:d,r.push(new D.Range(l,h,p,v))),r=e.row,p=e.col,b=e.row+e.rowCount-1,w=e.col+e.colCount-1,y=l+d-1-(f?1:0),M=h+v-1,C=P,S=s.getRowCount(),T=g.contains(r-1,p)&&!g.contains(r,p),f||(T=T&&w<=M&&h<=p),m=g.contains(r,p-1)&&!g.contains(r,p)&&b<=m&&r>=n.row,A=g.contains(r,p)&&!g.contains(b,w)){if(g=zt(y,b)-l+1,I=zt(M,w)-h+1,M<w&&(d=F(s,new D.Range(l,1+M,d,w-M)))&&w>d.col&&(I=v),c=new D.Range(l,h,g,I),f&&(c.rowCount++,b++,y++),(C=y<b?F(s,new D.Range(y+1,h,c.row+c.rowCount-1,v)):C)&&0<(x=b-C.row+1)){if(F(s,new D.Range(S-Math.abs(x),h,Math.abs(x),v)))return void s.jT(6,H().Exp_TableAddRowNoEnoughRoom);!0!==a&&s.moveTo(C.row,h,c.row+c.rowCount,h,S-c.row-c.rowCount,v,q)}}else if(T&&!f){if(c=new D.Range(r,h,e.rowCount,v),(N=F(s,c,e))&&!e.containsRange(N))return}else if(m&&(c=new D.Range(l,p,n.rowCount,e.colCount),N=F(s,c,e))&&!e.containsRange(N))return;T&&!f&&jt(i)&&(t.useFooterDropDownList(!0),si(s,t),n=t.range()),c&&!n.containsRange(c)&&(M=n.union(c),u.UTt(t,M,o,!0))},a.prototype.PTt=function(t,n,e){var i,r,o,a,n,u,r,i=this,r=n.row,o=n.col,a=n.rowCount,n=n.colCount,u;new D.Range(r+(t.showHeader()?1:0),o,a-(t.showHeader()?1:0),n).contains(e.row,e.col,1,e.colCount)&&(r=new D.Range(r,o,a+e.rowCount,n),i.UTt(t,r))},a.prototype.UTt=function(t,n,e,i){var r=this.Mf,o=r.getParent();o&&o.commandManager().execute({cmd:Fn,sheetName:r.name(),tableName:t.name(),resizeToRange:n,backupTableResizedArgs:e,ignoreEventSuspend:i})},a.prototype.HL=function(t,n,e){var i,r,o,a,o,u,s,c,f,l,h,d,v,m,g,o,p,b,w,y,M,C,S,T,A,I,x,T,C,i,y,M,M,i,p,w,i=this,r=this.Mf,o=r.options,a=r.isActualProtected(),o=o.protectionOptions,u=!1!==o.allowSelectLockedCells,s=!1!==o.allowSelectUnlockedCells;if(!a||u||s){if(c=e.col,f=e.row,l=2,d=h=18,v=5,m=10,g=6,o=ge.TABLE_SELECT,p=ge.TABLE_CORNER_SELECT,b=ge.TABLE_COL_SELECT,w=ge.TABLE_ROW_SELECT,y=r.getActiveRowIndex(),M=r.getActiveColumnIndex(),-1===e.rowViewportIndex&&-1!==e.colViewportIndex&&(C=r.getCellRect(f,c,e.rowViewportIndex,e.colViewportIndex),(S=i.find(y,M))instanceof V)&&(T=r.Tb-r.frozenRowCount(),S.showHeader())&&y>=S.Ky&&y<S.Ky+S.Sx&&M>=S.iw&&M<S.iw+S.Tx&&S.Ky<T&&S.Ky+S.Sx>T&&e.col<S.iw+S.Tx&&e.col>=S.iw)if(t>C.x+5&&t<C.x+C.width-18&&n<C.height-5){for(A=r.getSelections(),I=0;I<A.length;I++)if(!((x=A[I]).col===e.col&&1===x.colCount&&x.row===S.Ky&&x.rowCount===S.Sx||x.col===e.col&&1===x.colCount&&-1===x.row&&x.rowCount===r.getRowCount()))return L(S,b,f,c,a,u,s)}else if(t>C.x+18)return L(S,"default",f,c,a,u,s);if(T=r.getCellRect(f,c),i.find(f,c)instanceof V&&-1!==e.colViewportIndex&&-1!==e.rowViewportIndex){if(C=!1,S=i.find(f,c),i=i.find(y,M),y=!0,1===(A=r.getSelections()).length&&(M=A[0]).row<=f&&M.row+M.rowCount>f&&M.col<=c&&M.col+M.colCount>c&&(y=!1),S===i&&(C=!0),c===S.iw&&f===S.Ky){if(y&&C&&(t<=T.x+2||n<=T.y+2))return L(S,o,f,c,a,u,s);if(t>T.x+2&&t<T.x+18&&n>T.y+2&&n<T.y+6)return L(S,p,f,c,a,u,s);if(t>T.x+18&&n>T.y+2&&n<T.y+6)return L(S,b,f,c,a,u,s);if(t>T.x+2&&t<T.x+18&&n>T.y+6)return L(S,w,f,c,a,u,s)}if(c===S.iw+S.Tx-1&&f===S.Ky){if(y&&C&&(t>=T.x+r.getColumnWidth(c)-2||n<=T.y+2))return L(S,o,f,c,a,u,s);if(t<T.x+r.getColumnWidth(c)-2&&n>T.y+2&&n<T.y+6)return L(S,b,f,c,a,u,s)}if(c===S.iw&&f===S.Ky+S.Sx-1){if(y&&C&&(t<=T.x+2||n>=T.y+r.getRowHeight(f)-2))return L(S,o,f,c,a,u,s);if(t>T.x+2&&t<T.x+18&&n<T.y+r.getRowHeight(f)-2)return L(S,w,f,c,a,u,s)}if(y&&C&&c>S.iw&&c<S.iw+S.Tx&&f===S.Ky&&n<=T.y+2)return L(S,o,f,c,a,u,s);if(c>S.iw&&c<S.iw+S.Tx&&f===S.Ky&&n>T.y+2&&n<T.y+6)return L(S,b,f,c,a,u,s);if(y&&C&&f>S.Ky&&f<S.Ky+S.Sx&&c===S.iw&&t<=T.x+2)return L(S,o,f,c,a,u,s);if(f>S.Ky&&f<S.Ky+S.Sx&&c===S.iw&&t>T.x+2&&t<T.x+18)return L(S,w,f,c,a,u,s);if(M=r.getColumnWidth(S.iw+S.Tx-1),i=r.getRowHeight(S.Ky+S.Sx-1),p=T.x+M,w=T.y+i,C&&(f>S.Ky&&f<S.Ky+S.Sx&&c===S.iw+S.Tx-1&&p-2<=t&&t<=p||c>S.iw&&c<S.iw+S.Tx&&f===S.Ky+S.Sx-1&&w-2<=n&&n<=w)){if(c===S.iw+S.Tx-1&&f===S.Ky+S.Sx-1&&w-10<=n&&p-10<=t)return B;if(y)return L(S,o,f,c,a,u,s)}}}return B},a.prototype.wR=function(t,n){var e,i,e,r,o,a,e=this,i=e.Mf;if(e.find(t,n)instanceof V){for(r=0,(e=e.find(t,n)).oL&&(r=1),o=0,e.jO&&(o=1);0<t&&0===i.getRowHeight(t-1);)t--;if(1===o&&n===e.iw&&t===e.Ky)return a=pt(i,e,!0),v(a,e.iw+e.Tx-1,a);if(n===e.iw&&t===e.Ky)return a=pt(i,e,!0),v(a,e.iw+e.Tx-1,a);if(t>e.Ky&&t<e.Ky+e.Sx-r&&n===e.iw)return t===e.Ky+o?(t=pt(i,e,!0),v(t,e.iw+e.Tx-1,t)):v(t-1,e.iw+e.Tx-1,t-1)}return null},a.prototype.xR=function(t,n){var e,i,e,r,o,a,a,u,s,c,f,l,l,h,u,d,e=this,i=e.Mf;if(e.find(t,n)instanceof V){for(r=0,(e=e.find(t,n)).oL&&(r=1),o=0,e.jO&&(o=1),a=i.getRowCount()-1;t+1<i.getRowCount()&&0===i.getRowHeight(t+1);)t++;if(a!==t&&n===e.iw+e.Tx-1&&t<e.Ky+e.Sx-r)return a=e.Ky+e.Sx,c=(u=e.iw)+(s=e.Tx)-1,f=v(t+1,e.iw,t+1),t===a-r-1&&(e.VSt?(l=wt(i,e),1===r&&Mt(i,e,a,l,u,c,1,!0,!1,!0)||(u=(h=(l=F(i,new D.Range(a,u,l-a+1,c-u+1)))&&l.row)===a,a!==i.getRowCount()&&(u?ai:ui)(i,e,t,1,!0))):f=v(t,1+c,t)),f;if(i.getRowCount()-1===t&&n===e.iw+e.Tx-1&&0===r){for(d=e.Ky+o;d+1<i.getRowCount()&&0===i.getRowHeight(d);)d++;return d+1===i.getRowCount()&&0===i.getRowHeight(d)?v(e.Ky,e.iw,e.Ky):v(d,e.iw,d)}}return null},a.prototype.fR=function(t,n){var e,i,e,r,o,a,e=this,i=e.Mf;if(e.find(t,n)instanceof V){for(r=0,(e=e.find(t,n)).oL&&(r=1),o=0,e.jO&&(o=1);0<n&&0===i.getColumnWidth(n-1);)n--;if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:a=bt(i,e),leadingCellCol:a,row:e.Ky+e.Sx-1-r};if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:a=bt(i,e),leadingCellCol:a,row:e.Ky+e.Sx-1-r};if(n>e.iw&&n<e.iw+e.Tx&&(t===e.Ky||t===e.Ky+o))return n===e.iw?{col:n=bt(i,e),leadingCellCol:n+1,row:e.Ky+e.Sx-1-r}:{col:n-1,leadingCellCol:n-1,row:e.Ky+e.Sx-1-r}}return null},a.prototype.SB=function(){for(var t,n,e,i,r,t,n=this.U3,e=n.length,r=0;r<e;r++)(i=n[r]).w5t()},a.prototype.cL=function(t,n){for(var e,i,r,o,a,u,s,u,s,e,i=this.U3,r=i.length,o=0;o<r;o++)a=i[o],t?(u=a.Ky,s=a.Ky+a.Sx-1,u<=n&&n<=s&&a.cL(0)):(u=a.iw,s=a.iw+a.Tx-1,u<=n&&n<=s&&a.cL(0))},a.prototype.AJ=function(t,n,e,i,r){for(var o,a,u,s,c,o=this.AB(t,n,e,i),a=[],u=0,s=o.length;u<s;u++)c=o[u].dataRange(),r?c.rowCount+=e:c.colCount+=i,a.push(c);return a},Me=a,A.TableManager=Me,(i=Ce=A.TableRemoveOptions||(A.TableRemoveOptions={}))[i.none=0]="none",i[i.keepData=1]="keepData",i[i.keepStyle=2]="keepStyle",D.GC$.extend(D.Y8.prototype,{D5t:function(t,n){var e,i,i,e,i=this.G8;i&&(i.tableChanges||(i.tableChanges=[]),delete(i=i.tableChanges).isRestored,i.push({type:"changeTableManager",table:t,oldTableManager:n}))},YSt:function(t,n,e,i){var r,o,o,r,o=this.G8;o&&(o.tableChanges||(o.tableChanges=[]),delete(o=o.tableChanges).isRestored,o.push({type:Zn,table:t,name:n,value:e,newValue:i}))},DTt:function(t,n,e){var i,r,r,i,i=this,r=i.G8;r&&(r.tableChanges||(r.tableChanges=[]),r=r.tableChanges,i=i.QSt,delete r.isRestored,r.push({type:zn,tableList:i.U3.slice(),changedTables:t,addedTables:n,changeType:e}))},A5t:function(t,n,e,i,r,o){var a,u,u,a,u=this.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(u=u.tableChanges).isRestored,u.push({tableName:t.name(),type:Yn,tableColumn:n,index:o,name:e,value:i,newValue:r}))},HTt:function(t,n,e){var i,r,o,i,i,i=this,r,o=t.getValue(n,e).value,i=i.G8;i&&(i.tableChanges||(i.tableChanges=[]),delete(i=i.tableChanges).isRestored,i.push({type:Wn,bindingManager:t,row:n,col:e,oldValue:o}))},B5t:function(t,n,e,i,r){var o,a,a,o,a=this.G8;a&&(a.tableChanges||(a.tableChanges=[]),delete(a=a.tableChanges).isRestored,a.push({type:Qn,table:t,key:i,row:n,count:e,stateType:r}))},_Tt:function(t,n,e){var i,r,o,i,r=this.G8;r&&(r.tableExpressionChanges||(r.tableExpressionChanges=[]),(o=r.tableExpressionChanges).push({type:Xn,table:t,expression:n,col:e}))},ETt:function(t,n,e,i){var r,o,a,r,o=this.G8;o&&(o.sheetExpressionChanges||(o.sheetExpressionChanges=[]),(a=o.sheetExpressionChanges).push({type:qn,table:t,expression:n,row:e,col:i}))},zTt:function(h){var d,v,t,m,n,e,i,r;if(h){for(d=null,pi(v=this.QSt,h._bindingChanges,!0),t=function(t){var e,n,i,r,o,a,u,s,c,s,f,l,e=h[t],n=void 0;switch(e.type){case zn:if(2===e.changeType)for(i=function(t){var n,t,n=e.changedTables[t],t=v.U3.findIndex(function(t){return t.name===n.name});0<=t&&v.U3.splice(t,1)},r=0;r<e.changedTables.length;r++)i(r);else if(1===e.changeType&&e.addedTables)for(o=e.addedTables,r=0;r<o.length;r++)(a=o[r])&&"Object"===a.constructor.name&&(a=bi(v,a),v.U3.push(a));m.Mf.Ut.Spe();break;case Yn:n=v.findByName(e.tableName),u=e.tableColumn,"name"===e.name&&(u=e.value),0<=(s=n.BSt.findIndex(function(t){return t.name()===u}))&&((c=n.BSt[s])[e.name](e.newValue),"name"===e.name)&&n.I5t(u,e.newValue,s);break;case Zn:(n=e.table)?(s=e.name,f=e.newValue,s===U?(n.Ky=f.row,n.iw=f.col,n.Sx=f.rowCount,n.Tx=f.colCount):s===Kn?(f=f&&f.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new z).fromJSON(t),n):t}),n.BSt=f):s===Dn?(f=f&&f.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new D.Style).fromJSON(t,!1,null),n):t}),n.OSt=f):("style"===s&&f&&f.buildInName&&(f=W.TableThemes[f.buildInName.toLowerCase()]),n[s](f))):"name"===e.name&&(n=v.findByName(e.value))&&n.name(e.newValue);break;case"changeTableManager":break;case Wn:(l=vi(v,e.bindingManager)).setValue(e.row,e.col,e.oldValue);break;case Qn:d=n=e.table,mi(n="Object"===n.constructor.name?v.findByName(n.name):n,e.row,e.count,e.key,e.stateType)}},m=this,n=0;n<h.length;n++)t(n);if(d)for(d.LSt&&d.LSt.refresh(),e=this.Mf.slicers&&this.Mf.slicers.all(),n=0;n<e.length;n++)if((i=e[n]).LSt===d.LSt&&i.gmi)for(r=0;r<i.gmi.length;r++)i.gmi[r].onDataChanged()}},VTt:function(t){var n,e,i,r,o,a,u,u,s,c,f,l,l;if(t)for(n=this.QSt,e=void 0,i=!1,pi(n,t.bindingChanges),r=t.length-1;0<=r;r--)switch(a=void 0,(o=t[r]).type){case zn:u=o.changedTables,n.$pe(o.tableList),u&&0<u.length&&u.forEach(function(t){t&&(i=!0,t.w5t(),t.qSt())});break;case Yn:a=n.findByName(o.tableName),(0<=(u=o.index)?s=a.BSt[u]:o.tableColumn)[o.name](o.value);break;case Zn:a=o.table,c=o.name,f=o.value,c===U?(l=a.footerIndex(),a.Ky=f.row,a.iw=f.col,a.Sx=f.rowCount,a.Tx=f.colCount,a.LSt&&gi(e,a.LSt),i&&-1!==l&&a.u5t(l)):c===Kn?a.BSt=f:c===Dn?a.OSt=f:a[c](f),a.cL(0);break;case"changeTableManager":a=o.table,l=o.oldTableManager,a.k5t(l);break;case Wn:o.bindingManager.setValue(o.row,o.col,o.oldValue);break;case Qn:mi(o.table,o.row,o.count,o.key,o.stateType),e=o}},YTt:function(t){var n,e,i,r,i,o,i;if(t){for(n=void 0,e=t.length-1;0<=e;e--)(i=t[e]).type===Xn&&(n=i.table,r=i.expression,i=i.col,o=void 0,o=n.BSt[i].footerFormula())&&-1<(i=Ot(o))&&(o.arguments[i]=r);n&&n.w5t()}},ZTt:function(t){var n,e,i,r,o;if(t)for(n=t.length-1;0<=n;n--)(e=t[n]).type===qn&&(i=e.expression,r=e.row,o=e.col,e.table.CTt(r,o,i))}}),D.Y8.ch(Rn,{priority:7e3,isValid:function(t){var n,n,t,n,t=-1<["getValue","setValue"].indexOf(t),n=0<(null==(n=null==(n=this.Mf.tables)?void 0:n.U3)?void 0:n.length);return!t||n},init:function(){this.QSt=new Me(this.Mf)},clearPendingChanges:function(t){var n=this.tables;n&&n.$St(t.tableList)},undoAddRows:function(t){var n,e,n,i,r,o,n=t.sheetArea;!j(n)&&n!==D.SheetArea.viewport||(n=(e=this).Mf,i=t.row,r=t.rowCount,(o=n.tables.AB(i,-1,r,-1)).forEach(function(t){t.x4t(i,r,Tt(!0))}))},getValue:function(t){var n,n,n,e,i,r,o,a;0<(null==(n=null==(n=this.Mf.tables)?void 0:n.U3)?void 0:n.length)&&(n=t.row,e=t.col,i=t.sheetArea,r=this.Mf.tables,a=o=void 0,3===i)&&r&&(o=r.find(n,e))&&(a=r.Sl(n,e),t.isValueGet=a.e5t,t.value=a.y4)},setValue:function(t){var n,e,i,r,o,a,r,u,n=t.row,e=t.col,i=t.value,r=t.sheetArea,o=this.Mf.tables;3===r&&o&&(a=o.find(n,e))&&(u=void 0,(r=t.changes)&&!(u=r.tableChanges)&&(r.tableChanges=[]),t.isValueSet=o.Kbt(n,e,i))},applyChanges:function(t){var n,e,t,i,r,e,n=this,e=t.changes,t=t.isUndo;e&&(i=e.tableChanges,r=e.tableExpressionChanges,e=e.sheetExpressionChanges,i&&(yi(n.QSt,i),t?n.VTt(i):n.zTt(i)),t)&&(r&&n.YTt(r),e)&&n.ZTt(e),n.QSt.dl()},undo:function(t){var n=t.tableChanges,e=t.tableExpressionChanges,t=t.sheetExpressionChanges;n&&!n.isRestored&&this.VTt(n),e&&this.YTt(e),t&&this.ZTt(t),this.QSt.dl()}}),D.Workbook.ch(Rn,{init:function(){D.Commands.D4t(this.commandManager())},onCultureChanged:function(){H()},preFromSJSFormat:function(t,n,e){var e,e,t,i,r,o,a,u,s,c,e=e&&!1===e.includeStyles;if(!e&&(t=(e=t.styles)&&e.tableStyles,i=n.styleManager,t)&&(i.addDefaultStyleName("defaultTableStyle",t.defaultTableStyle||"TableStyleMedium2"),0<(r=tt(t.count,0)))&&(o=K(t,"tableStyle")))for(a=0,u=o;a<u.length;a++)(s=u[a])&&0==+s.pivot&&0<s.count&&(c=new W.TableTheme).yh(s,i)},preToSJSFormat:function(t,n,e){var i,e,r,o,a,u,s,c,f,i=e&&e.fileType===D.OpenSaveFileType.excel,e=e&&!1===e.includeStyles;if(i&&!e)for(o=0,a=r=this.mp;o<a.length;o++)c=(s=(u=a[o]).Mf).getRowCount(),f=s.getColumnCount(),(u._gi===D.SheetType.tableSheet||u._gi===D.SheetType.ganttSheet)&&0<c&&0<f&&s.tables.WB(new V(s.name().replace(/ /g,"")+"Table",0,0,c,f,u.hl,{showHeader:!1}))},wh:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,p,i=this,r=t.tables,o=n&&n.styleManager,a=e&&e.fileType===D.OpenSaveFileType.excel,u=e&&!1===e.includeStyles;if(!u)for(s={},f=(c=0,D.Ap)(i);c<f;c++)if((l=(0,D.Tp)(i,c))&&(d=(h=l.tables)&&h.all())&&0<d.length)for(v=0,m=d;v<m.length;v++)g=m[v],p=(r=r||(t.tables={}))[D.XFileConstants.du+g._id]={},g.wh(p,t,n,e,s),(p=g.style())&&!p.builtInName()&&o.addTableStyle(p.wh(o)),a&&!u&&l.NMi&&h.DK(g)}})},"./dist/plugins/table/table.ns.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/table/table.res.en.js");n.SR={en:e}},"./dist/plugins/table/table.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Table_Var=n.Table_StdDev=n.Table_Sum=n.Table_Min=n.Table_Max=n.Table_Count_Numbers=n.Table_Count=n.Table_Average=n.Table_None=n.Table_Total=n.Exp_TableAddRowNoEnoughRoom=n.Exp_TableAddRowIntersectTable=n.Exp_TableAddRowIntersectSpan=n.Exp_TableDeleteCountInvalid=n.Exp_ColParamOutOfRange=n.Exp_RowParamOutOfRange=n.Exp_TableResizeToTable=n.Exp_TableResizeWithHidden=n.Exp_TableResizeWithFilter=n.Exp_TableResizeToSpan=n.Exp_TableResizeInvalidRange=n.Exp_ArrayFormulaTable=n.Exp_TableResizeOutOfRange=n.Exp_TableMoveOutOfRange=n.Exp_TableDataSourceNullError=n.Exp_TableRangeHasFilterError=n.Exp_TableHasSameNameError=n.Exp_TableIntersectError=n.Exp_TableInvalidColumn=n.Exp_TableInvalidRow=n.Exp_TableNameInvalid=n.Exp_TableEmptyNameError=n.Exp_DragDropChangePartOfTable=n.Exp_DragDropShiftTableCell=void 0,n.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",n.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",n.Exp_TableEmptyNameError="The table name cannot be empty.",n.Exp_TableNameInvalid="The table name is not valid.",n.Exp_TableInvalidRow="Invalid row index or row count.",n.Exp_TableInvalidColumn="Invalid column index or column count.",n.Exp_TableIntersectError="The tables cannot be intersected.",n.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",n.Exp_TableRangeHasFilterError="The current table range contains a filter range.",n.Exp_TableDataSourceNullError="Table datasource cannot be null.",n.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",n.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",n.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",n.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",n.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",n.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",n.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",n.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",n.Exp_RowParamOutOfRange="The param row out of data range of table.",n.Exp_ColParamOutOfRange="The param col out of data range of table.",n.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",n.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",n.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",n.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",n.Table_Total="Total",n.Table_None="None",n.Table_Average="Average",n.Table_Count="Count",n.Table_Count_Numbers="Count Numbers",n.Table_Max="Max",n.Table_Min="Min",n.Table_Sum="Sum",n.Table_StdDev="StdDev",n.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/plugins/touch/touch.js"),n)},"./dist/plugins/touch/touch.js":function(x,t,L){"use strict";var B,P,N,L,k,L,_,G,U,c,f,H,V,z,Y,i,M,p,D,j,Z,W,Q,o,J,K,X,q,$,tt,l,nt,et,it,rt,ot,at,ut,st,ct,ft,h,a,lt,ht,dt,O,vt,d,mt,E,z,u,gt,pt,bt,wt,yt,Mt,C,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,v,Xt,qt,$t,tn,nn,en,rn,on,an,un,sn,cn,fn,ln,hn;function R(t){return t.height}function F(t){return t.width}function dn(t){clearInterval(t)}function m(){return(new Date).valueOf()}function vn(t,n){var e,i,r,o,a,u,s,t;return t&&n&&(o=r=e=13,u=a=i=15,s=t.X-n.X,t=t.Y-n.Y,D(s)<13)&&D(t)<13&&K(s*s+t*t)<j(15,15)}function g(t){var t=t.jg();return t instanceof N.Worksheet?t:t&&t.Mf}function w(t){return t.getSelections()}function mn(t){return t.frozenTrailingColumnCount()}function gn(t){return t.frozenTrailingRowCount()}function pn(t,n){return t.getColumnCount(n)}function bn(t,n){return t.getRowCount(n)}function wn(t){var t=_(t).offset(),n=O.body,e=0,i=0;return t&&(e=t.top+n.clientTop||0,i=t.left+n.clientLeft||0),{A0:e,I0:i}}function n(){var t=this;t.j0t=[],t.WTt={length:0},t.QTt=new yt,t.KTt=new Mt}function yn(t,n){var n=Q(n.Y,n.X)-Q(t.Y,t.X);return o<n?n-=2*o:n<-o&&(n+=2*o),n}function Mn(t,n){return K((n.X-t.X)*(n.X-t.X)+(n.Y-t.Y)*(n.Y-t.Y))}function Cn(t,n,e){var i,r,t,n,i,i=new C(e._Center.X,e._Center.Y),r=new C(n.X-i.X,n.Y-i.Y),t=new C(t.X-i.X,t.Y-i.Y),n=j(1,W(Mn(n,i)/e._Radius,4)),i=yn(r,t);return a(i)?0:i*n}function Sn(t){return D(t)<=2220446049250313e-31}function Tn(t,n){var e=!1,i=!1,r;return{JTt:e=0!==t&&(r=X(n/t)/o*180)<20?!0:e,XTt:i=0===t||75<(r=X(n/t)/o*180)&&r<105?!0:i}}function e(){var t=this;t.qTt=0,t.$Tt=0,t.tAt=1,t.nAt=0,t.eAt=0,t._process=0,t.rAt=511,t.oAt=new Nt,t.aAt=20,t.uAt=new Ct}function r(){}function An(t,n){this.X=t,this.Y=n}function In(t){return new C(t?J(t.X):-1,t?J(t.Y):-1)}function s(){var t=this;t.DU=0,t.ak=0,t.sAt=10,t.cAt=[]}function xn(t,n,e,i,r){var o=this;t?o.cAt=t:(o.fAt=new C(n,e),o.lAt=i,o.hAt=r)}function Nn(t){this.dAt=t,this.vAt=0}function kn(t){this.dAt=t,this.vAt=0}function _n(t,n){var e=this;e.mAt=t,e.gAt=n,e.pAt=0,e.bAt=0,e.vAt=0,e.yAt=K(t*t+n*n)}function Dn(){var t=this;t.wAt=new C(0,0),t.tW=0,t.MAt=0,t.CAt=0}function jn(){this.wY=[]}function On(t,n,e){var i=this;i.nW=t,i.SAt=n,i.TAt=e}function En(t,n,e,i,r){var o=this;o.qZ=t,o.nW=n,o.AAt=e,o.JZ=i,o.TAt=r}function Rn(t,n,e,i,r,o){var a=this;a.qZ=t,a.nW=n,a.SAt=e,a.AAt=i,a.JZ=r,a.TAt=o}function Fn(t,n,e,i,r,o,a){var u=this;u.qZ=t,u.nW=n,u.SAt=e,u.TAt=i,u.IAt=r,u.xAt=o,u.NAt=a}function Ln(t,n,e,i){var r=this;r.qZ=t,r.kAt=n,r.nW=e,r.JZ=i}function Bn(t,n,e,i){var r=this;r.qZ=t,r.KZ=n,r.DAt=e,r.JZ=i}function Pn(t){this.JZ=t}function Gn(t){this.JZ=t}function Un(t){this.JZ=t}function Hn(t,n){var t=t*n;return 4<t?t=4:t<.5&&(t=.5),t}function Vn(t){this.Mf=t}function zn(t,n,e,i){var r,o,e,a,u,s,c,f,l,h,h,d,v,m,g,c,r=e,o=0,e=0,a=t.Jt,c=t.Fi(),f=c.Cy,l=t.dw(1).findRow(r),h=t.parent,h=h&&h.options.scrollByPixel&&h.options.scrollbarMaxAlign;if(l)if(0<n){for(u=t.vw(-1),o=f-l.y;u<r&&o<n;)o+=a.Gt(--r);e=n-o}else if(n<0){if(d=0,v=i,h){if(m=t.frozenRowCount(),g=t.getRowCount()-t.frozenTrailingRowCount()-1,s=(c=t.gw(t.Sy(c),m,g)).Ky,d=c.Xy,v=i+n,s<r||r===s&&v<d)return M}else s=t.mw().Ky;for(o=-(l.y+R(l)-f);r<s&&n<o;)o-=a.Gt(++r);e=n-o,h&&r===s&&v<d&&(n=(e=d+a.Gt(r))+o)}return{Ky:r,Xy:e,_At:n}}function Yn(t,n,e,i){var r,o,e,a,u,s,c,f,l,h,h,d,v,m,g,c,r=e,o=0,e=0,s=t.Jt,c=t.Fi(),f=c.Py,l=t.yw(1).findCol(r),h=t.parent,h=h&&h.options.scrollByPixel&&h.options.scrollbarMaxAlign;if(l)if(0<n){for(a=t.ww(-1),o=f-l.x;a<r&&o<n;)o+=s.Kt(--r);e=n-o}else if(n<0){if(d=0,v=i,h){if(m=t.frozenColumnCount(),g=t.getColumnCount()-t.frozenTrailingColumnCount()-1,u=(c=t.Cw(t.Gy(c),m,g)).iw,d=c.Xy,v=i+n,u<r||r===u&&v<d)return M}else u=t.Mw().iw;for(o=-(l.x+F(l)-f);r<u&&n<o;)o-=s.Kt(++r);e=n-o,h&&r===u&&v<d&&(n=(e=d+s.Kt(r))+o)}return{iw:r,Xy:e,EAt:n}}function Zn(t,n){return lt(-n/(t/n+1)+n+"")}function Wn(t,n){return lt(n*(-n/(t-n)-1)+"")}function y(t,n,e,i,r,o){t.fillStyle=n,t.fillRect(e,i,r,o)}function Qn(t,n,e,i,r){var o,a,u,a,s,c,f,l,a=N.I.He(0,"gc-columnHeader-normal"),u=a&&a.backgroundImage,a=a&&a.backgroundColor;if(u&&-1!==u.indexOf("linear-gradient"))for(s=N.mt.ri(u),o=t.createLinearGradient(n+i/2,e,n+i/2,e+r),c=0,f=s.length;c<f;c++)l=s[c],o.addColorStop(l.point,l.color);else a&&(o=a);return o}function Jn(){var t=N.I.He(0,"gc-rowHeader-normal");return t&&t.backgroundColor}function Kn(t,n){var e,i,r,o,a,o,u,s,i,c,f,l,h,d,v,m,g,p,b,a,o,w,d,w,d,d,w,b,o,p,e=t.Fi(),i=t.Dn,r,o=t.options.sheetAreaOffset,a=o.left,o=o.top,u=i.R7(!1),s=i.J(),i=i._7(),d=t.dw(1),v=qn(t),m=e.J7,g=e.Uy,p=e.X7,b=e.Ty,c=e.BA,a=1<=a?1:0,o=1<=o?1:0,l=F(e);s.save(),i.save(),w=t.vw(-1),(d=d.findRow(w))&&(f=e.Cy,0<(h=d.y-f-1-o))&&(n?(w=e.XC,y(s,d=Jn(),c,f,w-1,h+1),y(i,d,c,f,w-1,h+1),y(s,u,c+w,f,l-w-v.width,h),y(i,u,c+w,f,l-w-v.width,h)):(y(s,u,c,f,l,h),y(i,u,c,f,l,h))),E<b&&(y(s,u,c,p,l,h=b-E-o),y(i,u,c,p,l,h)),d=t.yw(1),f=e.LA,h=R(e),w=t.ww(-1),(b=d.findCol(w))&&(c=e.Py,0<(l=b.x-c-1-a))&&(n?(y(s,p=Qn(s,c,f,l+1,(o=e.qC)-1),c,f,l+1,o-1),y(i,p,c,f,l+1,o-1),y(s,u,c,f+o,l,h-o-v.height),y(i,u,c,f+o,l,h-o-v.height)):(y(s,u,c,f,l,h),y(i,u,c,f,l,h))),E<g&&(y(s,u,m,f,l=g-E-a,h),y(i,u,m,f,l,h)),i.restore(),s.restore()}function Xn(t,n,e,i,r,o){t.beginPath(),t.strokeStyle=n,t.moveTo(e,i),t.lineTo(r,o),t.stroke()}function qn(t){var n,e=t.options.sheetAreaOffset;return t.gj&&t.gj()||{x:e.left,y:e.top,width:0,height:0}}function $n(t,n){var e,i,r,o,a,u,o,u,s,c,s,o,t,s,f,e=t.Fi(),i,r=t.Dn.J(),o=t.dw(1),a=qn(t),u=t.vw(-1),o=o.findRow(u),u=V("gc-group").color;o&&(s=e.Cy,0<(c=o.y-s))&&n&&0<a.width&&0===e.XC&&Xn(r,u,e.b6-.5,s,e.b6-.5,o.y),s=t.yw(1),o=t.ww(-1),(t=s.findCol(o))&&(s=e.Py,0<(f=t.x-s))&&n&&0<a.height&&0===e.qC&&Xn(r,u,s,e.T6-.5,t.x,e.T6-.5)}function te(t,n){var e,i,r,o,o,i,a,u,s,c,f,l,h,f,h,f,t,e=t.Fi(),i=t.Dn,r=t.options.gridline.color,o=N.I.He(0,"gc-columnHeader-normal"),o=o&&o.borderBottomColor,i=i.J(),f=t.dw(1),l=qn(t),a=e.BA,s=F(e),h=t.vw(-1),f=f.findRow(h);f&&(u=e.Cy,0<(c=f.y-u))&&(Xn(i,r,a,f.y-.5,a+s-l.width,f.y-.5),n)&&(0===l.width&&Xn(i,r,e.BA-.5,u,e.BA-.5,f.y),Xn(i,o,e.b6-.5,u,e.b6-.5,f.y)),h=t.yw(1),u=e.LA,c=R(e),f=t.ww(-1),(t=h.findCol(f))&&(a=e.Py,0<(s=t.x-a))&&(Xn(i,r,t.x-.5,u,t.x-.5,u+c-l.height),n)&&(0===l.height&&Xn(i,r,a,e.LA-.5,t.x,e.LA-.5),Xn(i,o,a,e.T6-.5,t.x,e.T6-.5))}function ne(t,n){var e=0;return t||(e|=1),n||(e|=2),e}function ee(t,n){var e=0;return e=e|(0!==t?1:0)|(0!==n?2:0)}function b(t){this.Mf=t}function ie(t,n,e,i,r){var o,a,u,s,c,f,l,f,h,d,v,f,o=t.parent,a=t.rt,u=t.options,s=n.rowViewportIndex,c=n.colViewportIndex,f=w(t),l=M;return t.Oi&&0<f.length&&(h=(f=f[f.length-1]).row,d=f.row+f.rowCount-1,v=f.col,f=f.col+f.colCount-1,o&&!o.options.allowUserResize||(-1!==h&&-1===v&&0<=s&&c<0&&u.rowHeaderVisible?!(l=a.cD(t,n,r,2,i))||"sizeRow"!==l.action&&"sizeHiddenRow"!==l.action||2!==l.sheetArea||l.index===d||(l=M):-1===h&&-1!==v&&s<0&&0<=c&&u.colHeaderVisible&&(!(l=a.dD(t,n,r,1,e))||"sizeCol"!==l.action&&"sizeHiddenCol"!==l.action||1!==l.sheetArea||l.index===f||(l=M)))),l}function re(t,n,e,i){var r,o,a,u,a,s,c,c,c;if(0===t.selectionPolicy())return M;for(r=n.hitTestType,o=Se(t),a=w(t),u=3,t.Oi&&0<a.length&&(-1!==(a=a[a.length-1]).row&&-1===a.col?u=2:-1!==a.col&&-1===a.row&&(u=1)),s=0;s<o.length;s++)if((c=o[s])&&(c.x-=F(c),c.y-=R(c),c.width*=3,c.height*=3,c.contains(e,i)))return k(n.row)&&(c=t.dw(1))&&0<c.length&&(n.row=c[c.length-1].row),k(n.col)&&(c=t.yw(1))&&0<c.length&&(n.col=c[c.length-1].col),{x:e,y:i,type:u,isHeader:!1,isFirstIndicator:0===s};return 1===r&&t.JA(-1,n.col)?{x:e,y:i,type:1,isHeader:!0}:2===r&&t.JA(n.row,-1)?{x:e,y:i,type:2,isHeader:!0}:M}function oe(t,n,e,i){var r,o,n,a,u,u,s,c,f,l,s,f,n,s,f,r=M,o=n.rowViewportIndex,n=n.colViewportIndex;if(!k(o)&&!k(n)){if(a=t.parent,u=t.U5(),0<=o&&0<=n&&1===t.Ut.getSelections().length){if(u=t.JS(u),s=mn(t),c=gn(t),f=pn(t)-s,l=bn(t)-c,1===n&&0<s&&u.col<f&&u.col+u.colCount>f&&(s=t.Yy(n))&&0<s.length&&e>(f=s[s.length-1]).x+F(f))return r;if(1===o&&0<c&&u.row<l&&u.row+u.rowCount>l&&(n=t._y(o))&&0<n.length&&i>(s=n[n.length-1]).y+R(s))return r}(f=ye(t))&&(r||(f.x-=F(f),f.y-=R(f),f.width*=3,f.height*=3,f.contains(e,i)&&(r={action:"drag",side:"corner"})),a&&a.options.allowUserDragFill||r&&"corner"===r.side&&(r.side=M))}return r}function ae(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,s,r=!1,o=t.Ut.getSelections(),a=0,u=o.length;a<u;a++){if(s=o[a],f=(s=(c=3===i||k(i))?t.JS(s):s).row,l=s.col,h=s.rowCount,s=s.colCount,c)r=f<=n&&n<f+h&&l<=e&&e<l+s;else if(2===i)r=-1===l&&f<=n&&n<f+h;else if(1===i)r=-1===f&&l<=e&&e<l+s;else if(0===i)return r;if(r)break}return r}function ue(t,n,e,i,r){n===i&&e===r||(t.Ut.setCellState(n,e,N.CellStatesType.active,!1,N.SheetArea.viewport),t.k_&&t.k_(N.CellStatesType.active,n,e,N.SheetArea.viewport),t.Ut.setCellState(i,r,N.CellStatesType.active,!0,N.SheetArea.viewport),t.k_&&t.k_(N.CellStatesType.active,i,r,N.SheetArea.viewport))}function se(t,n,e,i){var n,n,r,o;n||(n=(n=w(t))[n.length-1],r=t.ui,o=t.ci,e?3===i?(t.ui=n.row+n.rowCount-1,t.ci=n.col+n.colCount-1):2===i?(t.ui=n.row+n.rowCount-1,t.ci=0):1===i&&(t.ui=0,t.ci=n.col+n.colCount-1):3===i?(t.ui=n.row,t.ci=n.col):2===i?(t.ui=n.row,t.ci=0):1===i&&(t.ui=0,t.ci=n.col),ue(t,r,o,t.ui,t.ci))}function ce(t,n,e,i){var n,n,r,o;n||(n=(n=w(t))[n.length-1],r=t.ui,o=t.ci,e&&(3===i?(t.ui=n.row,t.ci=n.col):2===i?(t.ui=n.row,t.ci=0):1===i&&(t.ui=0,t.ci=n.col)),ue(t,r,o,t.ui,t.ci))}function S(t){var n=this;n.jAt=!1,n.YZ=new Bt(t),n.OAt=new Ut(t),n.Mf=t}function fe(t,n,e){var i=this;i.kZ=e,i.AZ=new nn(n),i.DZ=new Ht(n),i.xZ=new en(t,"sheet",i.AZ,100,10),i.kZ.aW(i.xZ,!0)}function T(t,n){var n,e,t,n=hn.call(this,n,N.mt.gi(t.Ti))||this;return n.jTe=N.DialogFeatureType.touch,(e=n).RAt=32,e.BAt=45,e.f$={},e.Jet=!1,e.Vv=t,t=e.Xc(),(e.LAt=t).addClass("gc-toolstrip-default ui-state-default well"),t.appendTo(e.qc()),t.hide(),e.FAt(),e.PAt(),e.aY(),n}function le(t){var t=t.WL,n=!1;return t&&t.QP().forEach(function(t){t&&t.isSelected()&&(n=!0)}),n}function he(t,n,e){var i,r,e,i=c("span"),r=O.body;return i.className=e,i.style.font=t,i.style.cssFloat="left",i.textContent=n,r.insertBefore(i,M),e=_(i).width(),r.removeChild(i),e}function de(t,n,e,i,r){this._font="normal 12px Arial";var o=this;o.Zc=t,o._text=n,o.GAt=e,i&&(o.tT=i),r&&(o.UAt=r)}function ve(t){function n(){for(var t,n,e,t="separator",n=0,e=t+n.toString();O.getElementById(e);)e=t+(++n).toString();return e}this.Zc=n(),t&&(this.UAt=t)}function A(t){this.jS=t}function me(t,n,e,i,r){var o=this;o.RS=t,o.HAt=e,o.zAt=n,o.VAt=i,o.YAt=r}function ge(){}function I(t){this.w2=t}function pe(t,n,e){var i,r,t,i=this;i.AZ=new nn(i),i.xZ=new en(t,"tabStrip",i.AZ,1,-1),i.kZ=e,i.DZ=new sn(n),r=i.DZ,(t=i.xZ).RZ=function(t){return r.BZ(t)},t.LZ=function(t){return r.FZ(t)},t.PZ=function(t){return r.GZ(t)},t.UZ=function(t){return r.HZ(t)},t.ZAt=function(t){return r.WAt(t)}}function be(t,n,e,i){var t=t.BO();t.getState(n)?e.drawImage(t.getImage(n),i.x,i.y,F(i),R(i)):t.addImage(n)}function we(t,n){var e,i,r,o,a,u,u,s,c,f,u,l,h,l,l,l,s,e=t.Fi(),r=16,u=w(t);t.Oi&&0<u.length&&(s=(u=u[u.length-1]).row,c=u.row+u.rowCount-1,f=u.col,u=u.col+u.colCount-1,h="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(l=t.parent)&&!l.options.allowUserResize||(-1!==s&&-1===f&&t.getRowResizable(c)?(l=t.C0(c),i=d+h+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",l=R(o=t.getCellRect(c,pn(t,2)-1,l,-1)),Ce(t,c,u,o.x,o.y+l,{rowCheck:!0})&&(a=new N.Rect(e.b6-16,o.y+l-8,16,16))):-1===s&&-1!==f&&t.getColumnResizable(u)&&(l=t.S0(u),i=d+h+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+mt,s=F(o=t.getCellRect(bn(t,1)-1,u,-1,l)),Ce(t,c,u,o.x+s,o.y,{colCheck:!0}))&&(a=new N.Rect(o.x+s-8,e.T6-16,16,16)),i&&a&&be(t,i,n,a)))}function ye(t){var n,e,i,e,i,r,o,n=M,e=w(t),i=e.length;return t.Oi&&0<i&&(e=e[i-1],i=t.j1(e),n=new N.Rect(i.x+F(i)-(r=17),i.y+R(i),17,o=20)),n}function Me(t,n,e){var n,e,n,t,e,i,r,o,n=t.C0(n),e=t.S0(e),n=t.dw(n),t=t.yw(e),e=0,i=0,r=0,o=0;return 0<n.length&&(e=n[0].row,i=n[n.length-1].row),0<t.length&&(r=t[0].col,o=t[t.length-1].col),(0,N.Ec)(e,r,i-e+1,o-r+1)}function Ce(t,n,e,i,r,o){var a,u,s,a,u,t,n,a=t.C0(n),u=t.S0(e),s,a=t.Fi().c9(a,u),u=Me(t,n,e),t=u.row<=n&&n<=u.row+u.rowCount-1&&a.y<=r&&r<=a.y+R(a),n=u.col<=e&&e<=u.col+u.colCount-1&&a.x<=i&&i<=a.x+F(a);return o&&o.colCheck?n:(o&&o.rowCheck||n)&&t}function Se(t){var n,e,n,i,r,o,a,u,s,c,f,l,h,d,v,d,m,v,d,v,h,n,g,o,p,b,n=w(t),e=[];if(t.Oi&&0<n.length)for(n=n[n.length-1],i=t.j1(n),r=8,o=t.Fi(),a=n.row,u=n.row+n.rowCount-1,s=n.col,c=n.col+n.colCount-1,-1!==n.row&&-1!==n.col?(Ce(t,a,s,i.x,i.y)&&(e[0]=new N.Rect(i.x-8,i.y-8,16,16)),Ce(t,u,c,i.x+F(i),i.y+R(i))&&(e[1]=new N.Rect(i.x+F(i)-8,i.y+R(i)-8,16,16))):-1!==n.row?(f=o.c9(1,0),l=o.c9(1,1),h=f.x+(F(f)+F(l))/2-8,d=pn(t)-1-mn(t),(d=(v=t.yw(1)).findCol(d))&&(v=(m=t.yw(0))[0]||v[0])&&(h=v.x+(d.x+F(d)-v.x)/2-8),Ce(t,a,s,h+8,i.y,{rowCheck:!0})&&(e[0]=new N.Rect(h,i.y-8,16,16)),Ce(t,u,c,h+8,i.y+R(i),{rowCheck:!0})&&(e[1]=new N.Rect(h,i.y+R(i)-8,16,16))):-1!==n.col&&(f=o.c9(0,1),l=o.c9(1,1),d=f.y+(R(f)+R(l))/2-8,v=bn(t)-1-gn(t),(n=(h=t.dw(1)).findRow(v))&&(o=(g=t.dw(0))[0]||h[0])&&(d=o.y+(n.y+R(n)-o.y)/2-8),Ce(t,a,s,i.x,d+8,{colCheck:!0})&&(e[0]=new N.Rect(i.x-8,d,16,16)),Ce(t,u,c,i.x+F(i),d+8,{colCheck:!0}))&&(e[1]=new N.Rect(i.x+F(i)-8,d,16,16)),p=void 0,b=e.length-1;0<=b;b--)(!(p=e[b])||p.x<0||p.y<0)&&(e[b]=M);return e}function Te(t,n,e){var i,r,o,a;if((0,N.needPaintSelection)(t)&&!t.isEditing()&&n&&0!==t.selectionPolicy()&&(o=void 0,0<(r=(i=Se(t)).length))){for(e.save(),e.fillStyle=t.aR()||"white",e.strokeStyle=t.getSelectionBorderColor(),a=0;a<r;a++)(o=i[a])&&(e.beginPath(),e.arc(o.x+F(o)/2,o.y+R(o)/2,F(o)/2,0,2*Math.PI,!1),e.fill(),e.stroke());e.restore()}}function Ae(t,n){var e,i,e=ye(t);e&&be(t,i=d+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+mt,n,e)}B=this&&this.__extends||(ln=function(t,n){return(ln=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}ln(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.QAt=t.NZ=t.IZ=t.TouchToolStripSeparator=t.TouchToolStripItem=t.TouchToolStrip=t.TouchEventHandler=t.ZZ=t.ManipulationStartingEventArgs=t.ManipulationStartedEventArgs=t.ManipulationDeltaEventArgs=t.ManipulationCompletedEventArgs=t.QZ=t.TouchEventProvider=t.SR=void 0,P=L("Common"),N=L("Core"),L=L("./dist/plugins/touch/touch.res.en.js"),t.SR={en:L},k=P.Common.lt.ht,L=N.zc,G=(_=N.GC$).extend,U=_.isEmptyObject,c=N.mt.En,f=N.mt.vi,H=N.mt.Tt.mozilla,V=N.I.fl,z=N.mt.pi(),Y=z.ipad,i=Y||z.iphone,M=null,p=void 0,D=Math.abs,j=Math.min,Z=Math.max,W=Math.pow,Q=Math.atan2,o=Math.PI,J=Math.round,K=Math.sqrt,X=Math.atan,q=Math.log,$=Math.floor,tt=100,l="touch",nt="none",et="MSPointerDown",it="MSPointerMove",rt="MSPointerUp",ot="pointerdown",at="pointermove",ut="pointerup",st="touchstart",ct="touchmove",ft="touchend",h="MSPOINTER_TYPE_TOUCH",a=isNaN,lt=parseInt,ht=parseFloat,dt=window,O=document,vt=dt.gcGlobal,d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",mt="AAAAAElFTkSuQmCC",E=1,N.Of.touch=!0,z=new P.Common.ResourceManager(t.SR,"Touch"),u=z.getResource.bind(z),gt=400,pt=1e3,bt=20,n.prototype.KAt=function(t){this.QTt.KAt=t},n.prototype.JAt=function(t){this.QTt.JAt=t},n.prototype.XAt=function(n){var e=this;e.QTt.XAt=function(t){var t;n&&(n(t),t=e.AZ)&&t.qAt()}},n.prototype.$At=function(t){this.QTt.$At=t},n.prototype.tIt=function(t){this.QTt.tIt=t},n.prototype.nIt=function(t){this.KTt.nIt=t},n.prototype.eIt=function(t){this.KTt.eIt=t},n.prototype.iIt=function(t){this.KTt.iIt=t},n.prototype.rIt=function(t){this.oIt=t},n.prototype.aIt=function(t){this.uIt=t},n.prototype.sIt=function(t,n){var n=(n||this.cIt).RS;return N.mt.T0(t,n)},n.prototype.fIt=function(t,n){var e,i,r,o,a,i,u,i,s,t,r,e=this,i=n.pointerType,r=n.target,o=n.offsetX,a=n.offsetY;i!==n[h]&&i!==l||(u=(i=e.sIt(r,t)).I0,i=i.A0,(s=e.lIt(t,r,n.pointerId,new C(o+u,a+i),n.timeStamp))&&f(n),"sheet"===e.cIt.zAt&&(t=n.pageX-(o+u),r=n.pageY-(a+i),e.cIt.RS.canvasOffset={top:r,left:t}))},n.prototype.hIt=function(t){var n,e,i,e,r,n=this,e=t.pointerType,i=t.pointerId;if(e===t[h]||e===l){if(n.WTt[i]===p)return!1;e=n.sIt(t.target),(r=n.iE(i,new C(t.offsetX+e.I0,t.offsetY+e.A0),t.timeStamp))&&f(t)}},n.prototype.dIt=function(t){var n,e,i,e,r,n=this,e=t.pointerType,i=t.pointerId;if(e===t[h]||e===l){if(n.WTt[i]===p)return!1;e=n.sIt(t.target),(r=n.vIt(i,new C(t.offsetX+e.I0,t.offsetY+e.A0)))&&f(t)}},n.prototype.mIt=function(t){var n,e,i,e,r,n=this,e=t.pointerType,i=t.pointerId;if(e===t[h]||e===l){if(n.WTt[i]===p)return!1;e=n.sIt(t.target),(r=n.gIt(i,new C(t.offsetX+e.I0,t.offsetY+e.A0)))&&f(t)}},n.prototype.pIt=function(t,n){for(var e,i,r,o,a,u,e=wn(t.RS),i=n.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],u=H?m():n.timeStamp,r=this.lIt(t,n.target,a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0),u)||r;r&&f(n)},n.prototype.bIt=function(t){for(var n,e,i,r,o,a,u,n=this,e=wn(n.cIt.RS),i=t.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],u=H?m():t.timeStamp,r=n.iE(a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0),u)||r;r&&f(t)},n.prototype.yIt=function(t){for(var n,e,i,r,o,a,n=this,e=wn(n.cIt.RS),i=t.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],r=n.vIt(a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0))||r;r&&f(t)},n.prototype.wIt=function(t){for(var n,e,i,r,o,a,n=this,e=wn(n.cIt.RS),i=t.changedTouches,r=!1,o=0;o<i.length;o++)a=i[o],r=n.gIt(a.identifier,new C(a.pageX-e.I0,a.pageY-e.A0))||r;r&&f(t)},n.prototype.MIt=function(t){var n,e,n,e,n,n=this,e=n.cIt,n=n.CIt;e!==n&&(e=_(e.RS).offset(),n=_(n.RS).offset(),t.X+=e.left-n.left,t.Y+=e.top-n.top)},n.prototype.SIt=function(t,n){var e,i,r,o,a,u,s,e=this,i=e.j0t;for(e.CIt=M,e.AZ=M,o=0;o<i.length;o++)if(i[o]===t){if(a=i[o],s=u=M,a._Z&&!a._Z()){for(o=0;o<i.length;o++)if((r=i[o])!==a&&0<=r.YAt&&r.YAt<a.YAt&&(!r._Z||r._Z())){u=r;break}if(u===M)return!1}if(a.EZ&&!a.EZ()){for(o=0;o<i.length;o++)if((r=i[o])!==a&&0<=r.YAt&&r.YAt<a.YAt&&(!r.EZ||r.EZ())){s=r;break}if(s===M)return!1}u===M&&(u=a),s===M&&(s=a),e.cIt=a,e.CIt=u,e.TIt=s,e.KAt(s.jZ||M),e.JAt(u.RZ||M),e.tIt(u.LZ||M),e.$At(u.AIt||M),e.XAt(u.PZ||M),e.nIt(s.UZ||M),e.eIt(s.ZAt||M),e.iIt(s.IIt||M),e.rIt(u.oIt||M),e.aIt(u.uIt||M),u.HAt&&(e.AZ=a.HAt);break}return!0},n.prototype.lIt=function(t,n,e,i,r){var o=this;if(o.WTt[e]!==p)return!1;if(0===o.WTt.length&&!o.SIt(t,n))return!1;if(!o.CIt)return!1;if(!(o.WTt.length>=o.CIt.VAt)){if(o.AZ&&o.AZ.xIt())return!1;o.MIt(i),o.AZ&&0===o.WTt.length&&o.AZ.NIt(),o.WTt[e]={id:e,time:m(),position:i},o.WTt.length++,o.QTt.kIt(n,e,i,r),o.QTt.DIt(e,i,o.WTt.length,r),1===o.WTt.length&&o.KTt.DIt(i),1===o.WTt.length&&o.oIt&&o.oIt({JZ:i})}return!0},n.prototype.iE=function(t,n,e){var i=this;return i.WTt[t]!==p&&!(i.AZ&&i.AZ._It()||(i.MIt(n),i.WTt[t]={id:t,time:m(),position:n},i.QTt.EIt(t,n,e),0))},n.prototype.vIt=function(t,n){var e=this;return e.WTt[t]!==p&&(delete e.WTt[t],e.WTt.length--,!(e.AZ&&e.AZ.jIt()||(e.MIt(n),e.QTt.OIt(t),e.QTt.RIt(),0===e.WTt.length&&(e.KTt.OIt(n),e.KTt.RIt()),0===e.WTt.length&&e.uIt&&e.uIt({JZ:n}),e.AZ&&0===e.WTt.length&&0===e.QTt._process&&e.AZ.qAt(),0)))},n.prototype.gIt=function(t,n){return this.vIt(t,n)},n.prototype.aW=function(n,t){var e,i,r,o,a,u,s,c,f,l,h,d,v,i,m,g,r,p,b,w,y,M;function C(){_(O).bind(a,A).bind(u,I).bind(l,A).bind(h,I).bind(s,x).bind(c,x).bind(d,x).bind(v,x)}function S(){_(O).unbind(a).unbind(l).unbind(u).unbind(h).unbind(s).unbind(v).unbind(c).unbind(d)}function T(t){C(),e.fIt(n,t)}function A(t){e.hIt(t)}function I(t){e.dIt(t),0===e.WTt.length&&S()}function x(t){e.mIt(t),0===e.WTt.length&&S()}e=this,i="."+n.zAt,o=et+(r=".gcSheet"),a=it+r+i,u=rt+r+i,s="MSPointerCancel"+r+i,c="MSLostPointerCapture"+r+i,f=ot+r,l=at+r+i,h=ut+r+i,d="LostPointerCapture"+r+i,v="pointercancel"+r+i,i=st+r,m=ct+r,g=ft+r,r="touchcancel"+r,p=n.RS,b=e.j0t,0<=(w=P.Common.Uf.hD(b,n))&&t||w<0&&!t||(y=N.mt.m0(),t?y?(M=p.style,k(M.msTouchAction)||(M.msTouchAction=nt),k(M.touchAction)||(M.touchAction=nt),_(p).bind(o,T).bind(f,T)):(_(p).bind(i,function(t){e.pIt(n,t)}),_(p).bind(m,function(t){e.bIt(t)}).bind(g,function(t){e.yIt(t)}).bind(r,function(t){e.wIt(t)})):y?_(p).unbind(o).unbind(f):_(p).unbind(i).unbind(m).unbind(g).unbind(r),t?b.push(n):b.splice(w,1))},n.prototype.L0=function(){for(var t,n,e,t=this,n=t.j0t,e=n.length-1;0<=e;e--)t.aW(n[e],!1)},wt=n,t.TouchEventProvider=wt,e.prototype.kIt=function(t,n,e,i){var r,t,r=this;3===r._process&&r.BIt(!0),r.jAt=2===r._process&&1===r.oAt.LIt(),r.FIt=t,(t={}).rL=n,t.PIt=e,t.GIt=e,r.oAt.UIt(t),r.HIt=i,1<r.oAt.LIt()&&(r.zIt=!1,r.VIt=!1,1===r._process)&&r.YIt()},e.prototype.DIt=function(t,n,e,i){0===this._process&&1===e&&this.ZIt(this.oAt.WIt(0).GIt)},e.prototype.EIt=function(t,n,e){var i,r,r,o,r,a,u,s,i=this;if(0!==i.rAt&&i.oAt.QIt(t)){if(1===i._process&&1===i.oAt.LIt()){if(r=i.KIt(),!i.JIt(1)&&!i.JIt(2)&&!r)return;if(vn(n,r=i.oAt.XIt(t).GIt))return;o=D(n.X-r.X),r=D(n.Y-r.Y),i.qIt(o,r)}if(!(e-i.HIt<20)){if(i.oAt.XIt(t).$It=n,1<(a=i.oAt.LIt()))for(u=0;u<a;u++)if(!(s=i.oAt.WIt(u)).$It)return;for(i.txt(e),i.HIt=e,a=i.oAt.LIt(),u=0;u<a;u++)(s=i.oAt.WIt(u)).PIt=s.$It,s.$It=M}}},e.prototype.RIt=function(){var t=this;t.nxt&&(t.ixt(t.nxt),t.nxt=M)},e.prototype.OIt=function(t){var n=this;n.oAt.QIt(t)&&(n.oAt.rxt(t),2===n._process?0===n.oAt.LIt()&&(n.JIt(64)||n.JIt(256)||n.JIt(128)?n.oxt():n.BIt(!0)):3===n._process?n.BIt(!0):1===n._process&&n.BIt(!1))},e.prototype.txt=function(t){var n,e,i,r,o,a,u,u,r,s,c,t,s,r,n=this,u=n.axt(),e=u.uxt,i=u.sxt,u=u.u_,r=n.cxt(),a=r.L0t,o=r.fxt,r=r.hAt;n.qTt+=e,n.$Tt+=i,n.tAt*=o,n.nAt+=a,n.eAt+=r,(s={}).hAt=r,s.L0t=a,s.lxt=t-n.HIt,s.uxt=e,s.sxt=i,n.uAt.hxt(s),n.dxt=u,1!==n._process&&2!==n._process||1===n._process&&(c=n.YIt())||((t=new xt).CAt=r,t.MAt=a,t.tW=o,t.wAt=new C(e,i),s=new St(n.uAt),r=new Dt(n.FIt,n.vxt(),t,!1,u,s),n.mxt(r),r.gxt&&n.BIt(!0))},e.prototype.YIt=function(){var t,n,t=this;return t._process=2,n=new Ot(t.FIt,t.oAt.LIt(),t.vxt(),t.oAt.WIt(0).GIt),t.pxt(n),!!n.gxt&&(t.BIt(!0),!0)},e.prototype.qIt=function(t,n){var t=Tn(t,n);this.zIt=t.JTt,this.VIt=t.XTt},e.prototype.axt=function(){var t,n,e,i,e,r,t=0,n=0,e=this.bxt(),i=e.yxt,e=e.wxt,r=new C(i.X,i.Y);return{uxt:t=i.X-e.X,sxt:n=i.Y-e.Y,u_:r}},e.prototype.cxt=function(){var t,n,e,i,t,t=this,n=0,e=1,i=0;return t.JIt(16)&&1===t.oAt.LIt()&&t.KIt()&&(n=Cn(t.oAt.WIt(0).$It,t.oAt.WIt(0).PIt,t.fMt)),1<t.oAt.LIt()&&(n=(t=t.Mxt()).L0t,e=t.fxt,i=t.hAt),{L0t:n=n/o*180,fxt:e,hAt:i}},e.prototype.Mxt=function(){for(var t,n,e,i,r,o,a,n,u,s,c,f,l,h,d,v,m,v,g,p,b,w,v,m,y,t=this,n=t.bxt(),e=n.yxt,i=n.wxt,r=t.KIt(),o=r?t.fMt._Center:new C(0,0),a=0,n=1,u=0,s=0,c=0,f=0,l=0,h=t.oAt.LIt(),d=0;d<h;d++)m=(v=t.oAt.WIt(d)).$It,v=v.PIt,g=Mn(m,e),p=Mn(v,i),b=r?new C(v.X-o.X,v.Y-o.Y):new C(v.X-i.X,v.Y-i.Y),w=r?new C(m.X-o.X,m.Y-o.Y):new C(m.X-e.X,m.Y-e.Y),v=Mn(v,o),m=Mn(m,o),p>=t.aAt&&g>=t.aAt&&(c++,f+=g,l+=p,!r||v>=t.aAt)&&m>=t.aAt&&(a+=y=yn(b,w),s++);return 0<s&&t.JIt(16)?a/=s:a=0,0<c&&t.JIt(32)?(t.jAt||(n=f/l),u=(f-l)/c,t.Cxt=f/c):t.Cxt=0,{L0t:a,fxt:n,hAt:u}},e.prototype.JIt=function(t){return 0!=(this.rAt&t)},e.prototype.bxt=function(){for(var t,n,e,i,r,o,a,u,s,u,c,f,t=0,n=0,e=0,i=0,r=this.oAt,o=r.LIt(),a=0;a<o;a++)s=(u=r.WIt(a)).PIt,u=u.$It,t+=s.X,n+=s.Y,e+=u.X,i+=u.Y;return c=new C(t/o,n/o),{yxt:f=new C(e/o,i/o),wxt:c}},e.prototype.KIt=function(){var t=this.fMt;return t&&!a(t._Radius)},e.prototype.ZIt=function(t){var n,t,n=this,t=new Et(n.FIt,n.rAt,M,t);return t.KZ=511,n.Sxt(t),n.Txt=t.KZ,0===t.KZ?(n.BIt(!1),!1):(n.rAt=t.KZ,n.fMt=t.DAt,n._process=1,!0)},e.prototype.BIt=function(t){var n,e,t,n=this,e=3===n._process;n._process=0,n.Axt&&(dn(n.Axt),n.Axt=M),t&&(t=new _t(n.FIt,n.vxt(),e,In(n.dxt),new St(n.uAt)),3===n._process?n.nxt=t:n.ixt(t)),n.uAt.Ixt(),n.oAt.Ixt(),n.fMt=M,n.qTt=0,n.$Tt=0,n.tAt=1,n.nAt=0,n.eAt=0,n.zIt=!1,n.VIt=!1,n.rAt=0},e.prototype.oxt=function(){var t,n,e,e,e,t=this,n={},e=new St(t.uAt);n.xxt=t.JIt(64)?e.Nxt().X:0,n.kxt=t.JIt(64)?e.Nxt().Y:0,n.Dxt=t.JIt(256)?e.CAt():0,n._xt=t.JIt(128)?e.Ext():0,0===n.xxt&&0===n.kxt&&0===n.Dxt&&0===n._xt?t.BIt(!0):(n.jxt=new It(n.xxt,n.kxt),n.IAt=new Tt(n.Dxt),n.xAt=new At(n._xt),e=new St(M,n.xxt,n.kxt,n._xt,n.Dxt),e=new jt(t.FIt,t.vxt(),new xt,e,n.IAt,n.xAt,n.jxt),t.Oxt(e),n.jxt=e.NAt,n.IAt=e.IAt,n.xAt=e.xAt,n.jxt.pAt<=0&&n.jxt.bAt<=0&&n.jxt.Rxt(.003),n.IAt.Bxt()<=0&&n.IAt.Rxt(.002),n.xAt.Bxt()<=0&&n.xAt.Rxt(.003),e=m(),n.Lxt=e,n.Fxt=e,n.Pxt=0,n.Gxt=0,t._process=3,t.Axt=dt.setInterval(function(){try{t.Uxt(n)}catch(t){}},20))},e.prototype.Uxt=function(t){var n,e,i,r,o,a,u,e,r,o,a,i,u,s,r,o,n=this,e=m(),i=e-t.Fxt;if(0!=i){if(r=t.xxt,o=t.kxt,a=t.Dxt,u=t._xt,t.xxt=n.Hxt(i,t.jxt.pAt,t.xxt),t.kxt=n.Hxt(i,t.jxt.bAt,t.kxt),t.Dxt=n.Hxt(i,t.IAt.Bxt(),t.Dxt),t._xt=n.Hxt(i,t.xAt.Bxt(),t._xt),r=(r+t.xxt)/2,o=(o+t.kxt)/2,a=(a+t.Dxt)/2,u=(u+t._xt)/2,t.Fxt=e,e=!1,Sn(r)&&Sn(o)&&Sn(a)&&Sn(u)&&(e=!0),r=i*r,o=i*o,a=i*a,i=i*u,u=1,0<n.Cxt&&(n.Cxt+2*a<0&&(a=-n.Cxt/2+1),0!==n.Cxt)&&(u=(n.Cxt+2*a)/n.Cxt),n.eAt+=a,n.nAt+=i,n.qTt+=r,n.$Tt+=o,n.tAt*=u,n.Cxt+=a,n.dxt=new C(n.dxt.X+r,n.dxt.Y+o),t.Pxt+=r,t.Gxt+=o,e){if(r=J(t.Pxt),o=J(t.Gxt),Sn(r)&&Sn(o))return void n.BIt(!0)}else 1<=D(t.Pxt)&&(r=t.Pxt,t.Pxt-=r),1<=D(t.Gxt)&&(o=t.Gxt,t.Gxt-=o);(s=new xt).wAt=new C(r,o),s.tW=u,s.CAt=a,s.MAt=i,r=new St(M,t.xxt,t.kxt,t._xt,t.Dxt),o=new Dt(n.FIt,n.vxt(),s,!0,In(n.dxt),r),n.mxt(o),(o.gxt||e)&&n.BIt(!0)}},e.prototype.Hxt=function(t,n,e){var n,n;return Sn(e)||(n=e<0?e+n*t:e-n*t)<0&&0<e||0<n&&e<0?0:n},e.prototype.vxt=function(){var t,n,t=this,n=new xt;return n.CAt=t.eAt,n.MAt=t.nAt,n.tW=t.tAt,n.wAt=new C(t.qTt,t.$Tt),n},e.prototype.zxt=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,h,r=this,o=new xt,a=new xt,u=0,s=0,c=0,f=0,l=r.JIt(4)&&r.zIt,h=r.JIt(8)&&r.VIt;return!r.JIt(1)||h||t&&!r.JIt(64)||(o.wAt.X=n.wAt.X,a.wAt.X=e.wAt.X,u=i.Nxt().X),!r.JIt(2)||l||t&&!r.JIt(64)||(o.wAt.Y=n.wAt.Y,a.wAt.Y=e.wAt.Y,s=i.Nxt().Y),!r.JIt(32)||t&&!r.JIt(256)?(o.tW=n.tW,a.tW=1):(o.tW=n.tW,o.CAt=n.CAt,a.tW=e.tW,a.CAt=e.CAt,f=i.CAt()),!r.JIt(16)||t&&!r.JIt(128)||(o.MAt=n.MAt,a.MAt=e.MAt,c=i.Ext()),h=new St(M,u,s,c,f),new kt(o,a,h)},e.prototype.Sxt=function(t){this.KAt&&t&&this.KAt(t)},e.prototype.pxt=function(t){this.JAt&&t&&this.JAt(t)},e.prototype.ixt=function(t){var n,e,n=this;n.XAt&&t&&(e=n.zxt(!1,t.nW,t.nW,t.TAt),t.nW=e.nW,t.TAt=e.TAt,n.XAt(t))},e.prototype.Oxt=function(t){var n,e,n=this;n.$At&&t&&(e=n.zxt(!1,t.nW,t.SAt,t.TAt),t.nW=e.nW,t.SAt=e.SAt,t.TAt=e.TAt,n.$At(t))},e.prototype.mxt=function(t){var n,e,n=this;n.tIt&&t&&(e=n.zxt(t.AAt,t.nW,t.SAt,t.TAt),t.nW=e.nW,t.SAt=e.SAt,t.TAt=e.TAt,n.tIt(t))},yt=e,r.prototype.DIt=function(t){var n,e,n=this;n.Vxt++,1<n.Vxt||(e=m(),n.Yxt&&vn(t,n.Yxt)&&e-n.Zxt<400?n.DU++:(n.Yxt=t,n.DU=1),n.Wxt=t,n.Zxt=e)},r.prototype.RIt=function(){var t=this;t.nxt&&(t.nxt instanceof Rt?t.Qxt(t.nxt):t.nxt instanceof Ft&&t.Kxt(t.nxt),t.nxt=M)},r.prototype.OIt=function(t){var n,e,n=this;n.Vxt--,0<n.Vxt||(e=m(),vn(t,n.Wxt)?1e3<e-n.Zxt?n.nxt=new Ft(n.Wxt):1<n.DU?(n.DU=0,n.Jxt(new Lt(n.Yxt)),n.Yxt=M):n.nxt=new Rt(n.Wxt):n.Yxt=M)},r.prototype.Xxt=function(){this.Yxt=M},r.prototype.Qxt=function(t){this.nIt&&t&&this.nIt(t)},r.prototype.Jxt=function(t){this.eIt&&t&&this.eIt(t)},r.prototype.Kxt=function(t){this.iIt&&t&&this.iIt(t)},Mt=r,C=An,t.QZ=C,s.prototype.qxt=function(t){var n,e,i,r,o,a,o,n=this;if(0===n.DU)return 0;for(e=0,i=(1+n.DU)*n.DU/2,r=n.DU-1;0<=r;r--)o=0,a=n.$xt(r),0===t?o=a.uxt:1===t?o=a.sxt:2===t?o=a.hAt:3===t&&(o=a.L0t),o=n.tNt(o,a.lxt),e+=o*=r+1;return e/i},s.prototype.tNt=function(t,n){return t/n},s.prototype.$xt=function(t){return this.cAt[this.nNt(t)]},s.prototype.eNt=function(){return this.cAt[this.DU-1]},s.prototype.hxt=function(t){var n,e,i,n=this;for(10===n.DU&&n.iNt(),n.DU++,n.cAt[n.nNt(n.DU-1)]=t,e=20*n.sAt,i=0;i<n.DU;i++)t.lxt-n.cAt[i].lxt>e&&(n.iNt(),i--)},s.prototype.iNt=function(){var t=this;t.ak++,t.ak===t.sAt&&(t.ak=0),t.DU--},s.prototype.Ixt=function(){this.DU=0},s.prototype.nNt=function(t){return(this.ak+t)%this.sAt},Ct=s,xn.prototype.Nxt=function(){var t=this;return t.fAt||(t.fAt=new C(t.cAt.qxt(0),t.cAt.qxt(1))),t.fAt},xn.prototype.Ext=function(){var t=this;return k(t.lAt)&&(t.lAt=t.cAt.qxt(3)),t.lAt},xn.prototype.CAt=function(){var t=this;return k(t.hAt)&&(t.hAt=t.cAt.qxt(2)),t.hAt},St=xn,Nn.prototype.Bxt=function(){var t=this,n=t._DesiredExpansion,e=t._DesiredDeceleration,i=t.dAt;return a(n)||0===n?a(e)?t.vAt:e:.5*i*i/n},Nn.prototype.Rxt=function(t){this.vAt=t},Tt=Nn,kn.prototype.Bxt=function(){var t=this,n=t._DesiredRotation,e=t._DesiredDeceleration,i=t.dAt;return a(n)||0===n?a(e)?t.vAt:e:.5*i*i/n},kn.prototype.Rxt=function(t){this.vAt=t},At=kn,_n.prototype.rNt=function(){var t=this,n=t._DesiredDisplacement,e=t.yAt,i=t.mAt,r=t.gAt,o=t.Bxt();a(n)||0===n?a(o)||0===o?(t.pAt=0,t.bAt=0):(t.pAt=o*D(i)/e,t.bAt=o*D(r)/e):(t.pAt=.5*e*D(i)/n,t.bAt=.5*e*D(r)/n)},_n.prototype.Bxt=function(){var t=this,n=t._DesiredDeceleration;return a(n)&&a(t._DesiredDisplacement)?t.vAt:n},_n.prototype.Rxt=function(t){this.vAt=t,this.rNt()},It=_n,xt=Dn,jn.prototype.QIt=function(t){for(var n,e,i,n=this.wY,e=0;e<n.length;e++)if((i=n[e]).rL===t)return!0;return!1},jn.prototype.UIt=function(t){this.wY.push(t)},jn.prototype.rxt=function(t){for(var n,e,n=this.wY,e=0;e<n.length;e++)if(n[e].rL===t){n.splice(e,1);break}},jn.prototype.LIt=function(){return this.wY.length},jn.prototype.WIt=function(t){return this.wY[t]},jn.prototype.XIt=function(t){for(var n,e,i,n=this.wY,e=0;e<n.length;e++)if((i=n[e]).rL===t)return i;return M},jn.prototype.Ixt=function(){var t=this.wY;t.splice(0,t.length)},Nt=jn,kt=On,_t=En,t.ManipulationCompletedEventArgs=_t,Dt=Rn,t.ManipulationDeltaEventArgs=Dt,jt=Fn,Ot=Ln,t.ManipulationStartedEventArgs=Ot,Et=Bn,t.ManipulationStartingEventArgs=Et,Rt=Pn,Ft=Gn,Lt=Un,Vn.prototype.oNt=function(t,n){var e=this.fg;return e?t===N.Bf.Xl(e)&&n===N.Bf.ql(e)||N.Bf.$l(e,t,n):(e=c("canvas"),N.Bf.Wl(e,M,this.Mf),N.Bf.$l(e,t,n)),e},Vn.prototype.aNt=function(t,n,e,i){var r,o,a,o,a,u,s,r=this,o=N.Bf.Xl(t),a=N.Bf.ql(t),o=r.oNt(o,a),a=o.getContext("2d"),u=N.Bf.Kl(o),s=N.Bf.Jl(o);N.Lf.Vl(a,1,1),a.drawImage(t,0,0,F(o),R(o),0,0,F(o),R(o)),N.Lf.Vl(a,u,s),r.fg=o,r.uNt=n,r.sNt=e,r.cNt=i},Vn.prototype.fNt=function(t,n,e){var i,r,o,e,a,r,u,s,c,f,a,o,l,h,d,v,m,g,p,b,n,w,y,t,i,e,a,i=this,r=i.Mf,a=N.Bf.Xl(t),o=N.Bf.ql(t),l=mn(r),h=gn(r),d=0<l?1:0,v=0<h?1:0,m=i.sNt,g=qn(r),p=i.uNt,b=r.Fi(),n=n/i.cNt,w=t.getContext("2d"),y=N.Bf.Kl(t),t=N.Bf.Jl(t),i=i.fg;w.save(),w.fillStyle=e,w.fillRect(0,0,a,o),e=r.rowOutlines,a=r.columnOutlines,e&&e._e(r,w,M,!0),a&&a._e(r,w,M,!1),o=m.x+F(m),e=m.y+R(m),a=p.Hy-o-d,r=p.Ay-e-v,u=g.x+F(g),s=g.y+R(g),c=a*n,f=r*n,o*=y,e*=t,a*=y,r*=t,u*=y,s*=t,c*=y,f*=t,N.Lf.Vl(w,1,1),w.drawImage(i,o,e,a,r,u,s,c,f),0<l&&(o=p.Hy-d,e=m.y+R(m),a=p.zy+d,r=p.Ay-e-v,u=b.Hy-d,s=g.y+R(g),c=b.zy+d,f=r*n,w.drawImage(i,o*=y,e*=t,a*=y,r*=t,u*=y,s*=t,c*=y,f*=t)),0<h&&(o=m.x+F(m),e=p.Ay-v,a=p.Hy-o-d,r=p.Iy+v,u=g.x+F(g),s=b.Ay-v,c=a*n,f=b.Iy+v,w.drawImage(i,o*=y,e*=t,a*=y,r*=t,u*=y,s*=t,c*=y,f*=t)),0<l&&0<h&&(o=p.Hy-d,e=p.Ay-v,a=p.zy+d,r=p.Iy+v,u=b.Hy-d,s=b.Ay-v,c=b.zy+d,f=b.Iy+v,w.drawImage(i,o*=y,e*=t,a*=y,r*=t,u*=y,s*=t,c*=y,f*=t)),N.Lf.Vl(w,y,t),w.restore()},Vn.prototype.$Z=function(){var t,n,e,i,t=this,n=t.Mf,e=n.zoom(),i=n.Dn._7();i&&t.aNt(i.canvas,n.Fi(),qn(n),e)},Vn.prototype.iW=function(t){var n,e,t,i,r,o,o,r,n=this,e=n.Mf;e.endEdit()&&(t=Hn(t,n.cNt),i=e.zoom(),r=e.name(),i!==t)&&(e.ki(N.Events.ViewZooming,o={sheet:e,sheetName:r,oldZoomFactor:i,newZoomFactor:t,cancel:!1}),!0!==o.cancel)&&(e.g8(t=o.newZoomFactor),e.ki(N.Events.UserZooming,{sheet:e,sheetName:r,oldZoomFactor:i,newZoomFactor:t}),e.ki(N.Events.ViewZoomed,{sheet:e,sheetName:r,oldZoomFactor:i,newZoomFactor:t}),e.invalidateLayout(),(r=(o=e.Dn).J())&&n.fNt(r.canvas,t,o.R7(!1)),e.oht&&e.oht(M,t),e.CW)&&e.CW(M)},Vn.prototype.rW=function(t){var n,e,i,t,n,r,n=this,e=n.Mf,i=e.name(),t=Hn(t,n.cNt),n=e.zoom();if(t!==n){if(e.ki(N.Events.ViewZooming,r={sheet:e,sheetName:i,oldZoomFactor:n,newZoomFactor:t,cancel:!1}),!0===r.cancel)return;e.g8(t=r.newZoomFactor),e.ki(N.Events.UserZooming,{sheet:e,sheetName:i,oldZoomFactor:n,newZoomFactor:t}),e.ki(N.Events.ViewZoomed,{sheet:e,sheetName:i,oldZoomFactor:n,newZoomFactor:t})}e.Zw=!0,e.Ww=!0,e.zw()},Bt=Vn,t.ZZ=Bt,Pt=200,Gt=20,b.prototype.lNt=function(t){var n;this.Mf.my=t,this.tbe=!0},b.prototype.hNt=function(t){var n;this.Mf.ly=t,this.nbe=!0},b.prototype.dNt=function(){var t;this.Mf.invalidateLayout()},b.prototype.yy=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,f,d,v,m,g,p,b,w,d,y,M,C,u,S,T,A,I,I,A,T,I,x,N,l,o=this,a=o.Mf,u=a.options,s,c,f=zn(a,t,a.Tb,a.ly);if(f&&(l=f.Ky,h=f.Xy,t=f._At,a.Tb=l,!(0<a.My)))if(f=a.ot(),v=(d=a.Fi()).Cy,m=a.Sy(d),g=d.Iy,p=d.Ay,b=d.Ty,w=(f||d).x,d=F(d),u=u.sheetAreaOffset,S=a.Ny,d+=u.left,t<0)o.vNt=0,A=T=void(o.mNt=0),(T=(I=a.dw(1))&&0<I.length?I.findRow(l):T)&&(A=I[I.length-1]).row>=l&&(y=2+u.top,M=v+D(t),0<=(C=j(v+m,A.y+R(A))-M))&&(C-=y,o.hNt(h-R(T)),e.x=w,e.y=M,e.width=d,e.height=C,e.tx=w,e.ty=v,I=S?m:m+g+b,i.x=w,i.y=v+C,i.width=d,i.height=I-C);else if(0<t){if(A=a.vw(-1),I=T=void 0,(x=a.parent&&a.parent.options.scrollByPixel)&&0<h&&(t-=h,h=0),l===A&&0<h){if(0<o.vNt&&0<o.mNt){if(h=I=Zn(T=o.vNt+t,200),(t=I-o.mNt)<=0)return n;if(n&&20<=I)return!0}else{if(200<=h&&(t-=h-199,h=199,t<=0))return n;if(T=Wn(h,200),I=h,n&&20<=I)return!0}o.vNt=T,o.mNt=I}else o.vNt=0,o.mNt=0;t<(N=S?m:m+g)&&(y=2+u.top,M=v,C=m-t,0<gn(a)&&(C-=E),o.hNt(h),!S&&0<b&&(l=j(f.height-g-E,p-E+t),r.x=w,r.y=p-E,r.width=d,r.height=g+E,r.tx=w,r.ty=l),e.x=w,e.y=M,e.width=d,e.height=C+(S?0:j(t,b)-E),e.tx=w,e.ty=M+t,i.x=w,i.y=M,i.width=d,i.height=t+y)}return!1},b.prototype.wy=function(t,n,e,i,r){var o,a,u,s,c,f,l,c,h,d,v,m,g,p,b,h,w,y,M,C,S,T,A,I,x,N,N,x,k,_,I,N,o=this,a=o.Mf,u,s,c=Yn(a,t,a.Ab,a.my);if(c&&(f=c.iw,l=c.Xy,t=c.EAt,a.Ab=f,!(0<a.My)))if(c=a.ot(),d=(h=a.Fi()).Py,v=a.Gy(h),m=h.zy,g=h.Hy,p=h.Uy,b=(c||h).y,h=R(h),T=a.options.sheetAreaOffset,A=a.Vy,h+=T.top,t<0)o.gNt=0,x=I=void(o.pNt=0),(I=(N=a.yw(1))&&0<N.length?N.findCol(f):I)&&(x=N[N.length-1]).col>=f&&(w=2+T.left,y=d+D(t),0<=(M=j(d+v,x.x+F(x))-y))&&(M-=w,o.lNt(l-F(I)),e.x=y,e.y=b,e.width=M,e.height=h,e.tx=d,e.ty=b,N=A?v:v+m+p,i.x=d+M,i.y=b,i.width=N-M,i.height=h);else if(0<t){if(x=a.ww(-1),(k=a.parent&&a.parent.options.scrollByPixel)&&0<l&&(t-=l,l=0),f===x&&0<l){if(0<o.gNt&&0<o.pNt){if(l=S=Zn(C=o.gNt+t,200),(t=S-o.pNt)<=0)return n;if(n&&20<=S)return!0}else{if(200<=l&&(t-=l-199,l=199,t<=0))return n;if(C=Wn(l,200),S=l,n&&20<=S)return!0}o.gNt=C,o.pNt=S}else o.gNt=0,o.pNt=0;t<(_=A?v:v+m)&&(w=2+T.left,y=d,M=v-t,0<mn(a)&&(M-=E),o.lNt(l),I=0,!A&&0<p&&(N=j(c.width-(I=m)-E,g-E+t),r.x=g-E,r.y=b,r.width=I+E,r.height=h,r.tx=N,r.ty=b),e.x=y,e.y=b,e.width=M+(A?0:j(t,p)-E),e.height=h,e.tx=y+t,e.ty=b,i.x=y,i.y=b,i.width=t+w,i.height=h)}return!1},b.prototype.bNt=function(t,n,e,i){var r,o,a,u,s,c,n,f,l,h,d,e,l,v,m,g,p,b,m,g,l,w,y,M,C,S,n,w,y,M,C,S,t,i,v,n,w,y,M,C,S,r=this,o=r.Mf,a=!0,u=!0,s=o.Dn,c=s.J(),d=0!=(2&e),e=0!=(1&e);if(e||d)return l={},v={},m=o.ot(),g=o.Fi(),p=(m||g).y,b=R(g),m=(m||g).x,g=F(g),d&&(a=r.yy(n,i,n={},f={},l),w=l.y,y=F(l),M=R(l),C=l.tx,S=l.ty,k(l=l.x)||s.Ey(l,w,y,M,C,S),s.Ey(n.x,n.y,F(n),R(n),n.tx,n.ty)),e&&(u=r.wy(t,i,l={},h={},v),w=v.y,y=F(v),M=R(v),C=v.tx,S=v.ty,k(n=v.x)||s.Ey(n,w,y,M,C,S),s.Ey(l.x,l.y,F(l),R(l),l.tx,l.ty),d||(f=h)),(t=o.parent)&&!t.options.scrollbarShowMax&&(e&&(o.Zw=!0),d)&&(o.Ww=!0),r.dNt(),i=o.rowOutlines&&!o.rowOutlines.Oy()?1:0,v=o.columnOutlines&&!o.columnOutlines.Oy()?1:0,e&&d?s.D1(c,new N.Rect(f.x,f.y,F(f),R(f)+i),new N.Rect(h.x,h.y,F(h)+v,R(h))):s.D1(c,new N.Rect(f.x,f.y,F(f)+v,R(f)+i)),n=new N.Rect(m,p,g,b),(w=o.getSelections())&&0<w.length&&(y=o.getRangeRect(1,1,w[0]),M=Z(n.x+n.width,y.x+y.width),C=Z(n.y+n.height,y.y+y.height),n.x=j(n.x,y.x),n.y=j(n.y,y.y),n.width=M-n.x+1,n.height=C-n.y+1),s.O1(n),s.jy(c,n),te(o,!0),Kn(o,!0),r.yNt(e,d),$n(o,!0),S=o.options.sheetAreaOffset,o.options.rowHeaderVisible||s.q7(c,new N.Rect(m,p,2,b+S.top)),o.options.colHeaderVisible||s.q7(c,new N.Rect(m,p,g+S.left,2)),a&&u},b.prototype.yNt=function(t,n){var e=this.Mf;n&&e.tw(),t&&e.ow(),e.rt.By()},b.prototype.wNt=function(r,o,a){function u(t,n,e,i){return W(.75,t/=e)*i*(n?1:-1)}function t(t,n,e){return t=D(t),q(t/=e)/q(.75)*n}var s=this,c=s.Mf,n=200,e=10,i=20,f=100,l=t(r,10,200),h=t(o,10,200),d=r,v=o,m=0,g=0,p=!1,b=!1;s.H6=dt.setInterval(function(){var t,t,n,e,i;p&&b?(c.Jt.Rl(),(t=c.parent)&&!t.options.scrollbarShowMax&&(c.Zw=!0,c.Ww=!0),c.Jt.Bl(),c.ly=0,c.my=0,c.zw(),c.ow(),c.tw(),dn(s.H6),s.H6=M):(h+=20,100<(l+=20)&&100<h?(s.bNt(r-m,o-g,ne(p,b),a),b=p=!0):(100<l&&!p&&(s.bNt(r-m,0,1,a),p=!0),100<h&&!b&&(s.bNt(0,o-g,2,a),b=!0),t=u(l,0<r,10,200),n=u(h,0<o,10,200),e=$(d-t),i=$(v-n),s.bNt(e,i,ne(p,b),a),d=t,v=n,m+=e,g+=i))},20)},b.prototype.Ok=function(t){var n=this,e=n.Mf,i=e.Jt;n.H6&&(i.Bl(),dn(n.H6),n.H6=M),n.tbe=!1,n.nbe=!1,n.ebe=e.my,n.ibe=e.ly,n.gNt=0,n.pNt=0,n.vNt=0,n.mNt=0,n.MNt=e.Tb,n.CNt=e.Ab,t&&i.jl()},b.prototype.a9=function(t,n){var e,i,r,o,a,u,r,s,t,c,e,i,r=this.Mf.parent,o=r.options.scrollbarAppearance===N.ScrollbarAppearance.mobile,a=r.Xb,u=r.zb,r=r.ib,s=lt(t.X+""),t=lt(t.Y+""),c=ee(s,t);return o&&(0!==t&&(a.qy(N.ScrollbarState.show),r.$y(!0)),0!==s)&&(u.qy(N.ScrollbarState.show),r.$y(!1)),this.bNt(s,t,c,n)},b.prototype.SNt=function(t){var n,e,i,r,o,a,u,s,c,s,f,l,h,d,h,v,m,g,m,p,n=this,e=n.Mf,i=n.MNt,r=e.Tb,o=n.CNt,a=e.Ab,u;e.parent&&e.parent.options.scrollByPixel?(e.Jt.Bl(),e.zw(),n.TNt(),n.tbe=M,n.nbe=M,n.ebe=M,n.ibe=M):(c=(s=e.Fi()).Py,s=s.Cy,f=e.yw(1),h=e.Mw().iw,d=1,f&&0<f.length&&(l=f.findCol(a),a<h&&l&&l.x+F(l)-c<F(l)/2?a++:d=-1),h=e.dw(1),m=e.mw().Ky,g=1,h&&0<h.length&&(v=h.findRow(r),r<m&&v&&v.y+R(v)-s<R(v)/2?r++:g=-1),p=m=0,f&&0<f.length&&(m=c-(l=f.findCol(a)).x),h&&0<h.length&&(p=s-(v=h.findRow(r)).y),r!==i&&e.$A(r,0,i),a!==o&&e.o9(a,0,o),n.wNt(m*=d,p*=g,t))},b.prototype.TNt=function(){var t,n,e,i,r,o,a,t=this,n=t.Mf,e=t.MNt,i=n.Tb,r=t.CNt,o=n.Ab,a=n.zoom();e===i&&!t.nbe||n.ki(N.Events.TopRowChanged,{sheet:n,sheetName:n.name(),oldTopRow:e,newTopRow:i,oldOffset:D(t.ibe/a),newOffset:D(n.ly/a)}),r===o&&!t.tbe||n.ki(N.Events.LeftColumnChanged,{sheet:n,sheetName:n.name(),oldLeftCol:r,newLeftCol:o,oldOffset:D(t.ebe/a),newOffset:D(n.my/a)})},Ut=b,S.prototype.OZ=function(t){var n,e,i,r,o,a,u,s,i,c,f,l,h,n,c,d,v,n=this,e=n.Mf,i=e.Fi(),r=i.Py,o=i.Cy,a=i.J7,u=i.X7,s=i.Hy,i=i.Ay,c=t.JZ,f=e.Ny,l=e.Vy,h=0,n=n.ANt(c.X,c.Y),c=n.dragInfo,d=n.x,v=n.y;n&&(n.resizeInfo||c&&"corner"===c.side||n.selectionHitInfo)?h|=3:(o<=v&&(f&&v<i||!f&&v<u)&&(h|=2),r<=d&&(l&&d<s||!l&&d<a)&&(h|=1),h|=96,e.parent&&(h|=12)),t.KZ=h},S.prototype.BZ=function(t){var n,e,e,i,r,o,a,e,u,s,u,c,s,f,n=this,e={e:t,r:M};S.et(n,"preProcessManipulationStarted",e),e.r||(e=t.JZ,r=(i=n.Mf).parent,o=i.rt,a=i.Dn,u=(e=n.ANt(e.X,e.Y)).dragInfo,s=e.selectionHitInfo,(i.sw=e).resizeInfo?i.endEdit()&&o.gk(e):u&&"corner"===u.side?o.wk&&o.wk(e):s?i.endEdit()&&(u=s.isHeader,c=s.isFirstIndicator,s=s.type,u&&o.A9(e,!0),f=e.hitTestType,e.hitTestType=s,o.F9(e),e.hitTestType=f,se(i,u,c,s),i.INt=!1,a.PD()):(i.pW&&(i.pW().VW=!1),i.INt=!1,a.PD(),1<t.kAt&&r&&r.options.allowUserZoom?(n.jAt=!1,n.YZ.$Z()):(n.jAt=!0,n.OAt.Ok(1===t.kAt))))},S.prototype.FZ=function(t){var n,e,e,i,r,i,o,e,a,u,i,a,n=this,e={e:t,r:M};S.et(n,"preProcessManipulationDelta",e),e.r||(e=t.JZ,r=(i=n.Mf).rt,i=i.sw,o=e.X,e=e.Y,i&&(a=i.dragInfo,u=i.selectionHitInfo,i.resizeInfo?(r.fk={e:t,x:o,y:e},r.y9()):a&&"corner"===a.side?(r.fk={e:t,x:o,y:e},r.Zk&&r.Zk()):u||r.ob?u&&r.Rk&&r.rb&&!0!==r.FI&&(i=u.type,r.fk={e:t,x:o,y:e},3===i?r.Y9():2===i?r.Z9():1===i&&r.W9()):n.jAt?t.gxt=n.OAt.a9(t.SAt.wAt,t.AAt):(a=t.nW.tW,n.YZ.iW(a))))},S.prototype.GZ=function(t){var n,e,e,i,r,o,r,n=this,e={e:t,r:M};S.et(n,"preProcessManipulationCompleted",e),e.r||(i=(e=n.Mf).rt,e.INt=!0,o=(r=e.sw).selectionHitInfo,r.resizeInfo?i.C9():r.dragInfo&&i.Yk?(i.DD&&i.DD(),e.parent.touchToolStrip.xNt()):o||i.ob?(i.X9(),o&&ce(e,o.isHeader,o.isFirstIndicator,o.type),e.Dn.E1()):(e.pW&&(e.pW().VW=!0),n.jAt?n.OAt.SNt(t.AAt):(r=t.nW.tW,n.YZ.rW(r))))},S.prototype.HZ=function(t){var e,n,n,i,r,t,o,o,a,n,u,s,c,f,l,h,d,h,l,d,f,h,n,n,n,v,v,v,v,m,g,v,n,e=this,n={e:t,r:M};if(S.et(e,"preProcessTapped",n),n.r)e.Mf.repaint();else if(n=t.JZ,i=e.Mf,r=i.parent,t=!1,i.Nk=p,e.NNt(),i.Olt&&i.Olt(),(o=i.Ut.pI)&&o.CZ(),o=i.rt,n=(a=e.ANt(n.X,n.Y,!0)).filterButtonHitInfo,u=a.hitTestType,s=a.row,c=a.col,f=a.outlineHitInfo)i.isEditing()||(l=f.what,h=i.rowOutlines,d=i.columnOutlines,"rg"===l||"rgh"===l?h&&h.rpt(i,f):"cg"!==l&&"cgh"!==l||d&&d.rpt(i,f));else if(i.sw=a,n)i.endEdit()&&(h=n.rowFilter)&&h.openFilterDialog(n);else if(!a.resizeInfo&&i.JA(a.rowViewportIndex<0?-1:s,a.colViewportIndex<0?-1:c)){if(i.kNt&&!o.Yk&&r.touchToolStrip.xNt(),l=i.getActiveRowIndex(),d=i.getActiveColumnIndex(),f=a.cellTypeHitInfo){if(h=i.getCellType(f.row,f.col,u),f.sheet||(f.sheet=i),e.xk(h,f))if(n=f.sheetArea,!k(n)&&3!==n||s===l&&c===d)i.Dn.PD();else{if(i.suspendPaint(),!i.endEdit())return;if(n={sheet:i,sheetName:i.name(),row:l,col:d,cancel:!1},i.ki(N.Events.LeaveCell,n),!0===n.cancel)return;n=i.Ut.getSelections(),v=i.Ut.getSpan(s,c),v=[(0,N.Ec)(v.row,v.col,v.rowCount,v.colCount)],i.EA(n,v),i.ki(N.Events.FloatingElementSelected,{type:"worksheet"}),v=f.isReservedLocation&&f.isFocusAware,i.t4(s,c,p,p,v?0:1),v={sheet:i,sheetName:i.name(),row:s,col:c},i.ki(N.Events.EnterCell,v),i.ki(N.Events.EnterCellInternal,v),i.jA(n),i.Nk=!0,o.PA&&o.PA(s,c),i.resumePaint(),t=!0}h.processCellAndPaddingMouseDown(f),h.Ve(f)}if(f&&f.isReservedLocation)return!0;f&&(f.cellButtonHitInfo||f.outlineColumnHitInfo)&&(t=!0),i.ki(N.Events.CellClick,{sheet:i,sheetName:i.name(),sheetArea:u,row:a.row,col:a.col});try{if(o.Dk=a,m=i.isEditing(),g=i.endEdit(),i.Oi&&Y&&m&&g&&(o.shift=!1),m&&l===i.getActiveRowIndex()&&d===i.getActiveColumnIndex()&&!g)return}finally{o.Dk=M}k(s)||k(c)||(3===u&&o.PA&&o.PA(s,c),ae(i,s,c,u)&&!t?e.DNt=dt.setTimeout(function(){var t,n,t={x:a.x,y:a.y,handled:!1},n=r.touchToolStrip;i.ki(N.Events.TouchToolStripOpening,t),t.handled||n.open(a.x,a.y-100),e.NNt()},420):(i.ki(N.Events.FloatingElementSelected,{type:"worksheet"}),v=i.Ut.getSelections(),o.A9(a),n=i.Ut.getSelections(),i.EA(v,n),o.X9()))}},S.prototype.xk=function(t,n){return!(t&&t.activeOnClick&&!t.activeOnClick()&&n.isReservedLocation)},S.prototype._Nt=function(t,n){var e,i,e,t,n,r,o,e=this,i=e.Mf,e=e.ANt(t,n,!0);e&&0<=e.row&&0<=e.col&&0<=e.rowViewportIndex&&0<=e.colViewportIndex&&!e.resizeInfo&&i.JA(e.row,e.col)&&((t=i.isCtrlPressed(e.hitTestType))||i.IA(),n=i.C0(e.row),r=i.S0(e.col),o=!0,i.ui===e.row&&i.ci===e.col||(o=!1),i.O6(e.row,e.col,n,r,o),t?i.zw():i.n4(e.row,e.col,1,1),i.rt.S_(!1,!0),i.f6(i.Dg(),e.row,e.col))},S.prototype.WAt=function(t){var n,e,e,t,i,r,n=this,e={e:t,r:M};S.et(n,"preProcessDoubleTapped",e),!e.r&&(e=n.Mf,t=t.JZ,n.NNt(),i=e.sw)&&(r=!1,3===i.hitTestType?n._Nt(t.X,t.Y):r=e.rt.j_(i),r||e.ki(N.Events.CellDoubleClick,{sheet:e,sheetName:e.name(),sheetArea:i.hitTestType,row:i.row,col:i.col}))},S.prototype.ENt=function(t){var n,e,t,i,i,n=this,e=n.Mf,t=t.JZ,i=n.ANt(t.X,t.Y);e.isEditing()?i.row===e.ui&&i.col===e.ci||e.rt.C_(i):(n._target=i,(i=n.ANt(t.X,t.Y,!0))&&i.cellTypeHitInfo&&i.cellTypeHitInfo.isEditing||e.rt.C_(i))},S.prototype.jNt=function(t){var n,e,n,i,r,r,n=this,e=n.Mf;!e.isEditing()&&(i=!0,i=(!(n=n._target)||!((r=n.cellTypeHitInfo)&&r.isReservedLocation||(r=e.getCellType(n.row,n.col))&&r.isEditing()))&&i)&&e.rt.S_(!0)},S.prototype.ANt=function(t,n,e){var i,r,o,a,u,s,a,u,s,s,a,u,c,f,u,u,u,i,r=this.Mf;return r.Fi(),o={x:t,y:n,rowViewportIndex:M,colViewportIndex:M,row:-1,col:-1,resizeInfo:M,hitTestType:M,outlineHitInfo:M,filterButtonHitInfo:M,dragInfo:M,cellTypeHitInfo:M,selectionHitInfo:M},a=r.rowOutlines,u=r.columnOutlines,(s=!(s=a?a.hitTest(r,t,n):s)&&u?u.hitTest(r,t,n):s)?o.outlineHitInfo=s:(u=a=void 0,a=r.FL(n),u=r.PL(t),o.rowViewportIndex=a,o.colViewportIndex=u,o.row=r.GL(n,a),o.col=r.UL(t,u,n,a,o.row),0<=a&&a<=2&&0<=u&&(s=r.O_(a,u,p,o.row,o.col))&&(o.row=s.row,o.col=s.col),o.hitTestType=r.C6(a,u),f=c=u=a=s=void 0,s=ie(r,o,t,n,10),c=(c=(u=r.IB)&&u.hitTest(o,t,n))||(u=(u=(u=r.tables)&&u.find(o.row,o.col))&&u.IB)&&u.hitTest(o,t,n),r.kNt?(a=oe(r,o,t,n),o.dragInfo=a):s?o.resizeInfo=s:c?o.filterButtonHitInfo=c:e?o.cellTypeHitInfo=r.JL(o,t,n):(f=re(r,o,t,n),o.selectionHitInfo=f)),o},S.prototype.NNt=function(){var t=this,n=t.DNt;n&&(clearTimeout(n),t.DNt=M)},Ht=S,t.TouchEventHandler=Ht,(0,N.$e)(Ht),fe.prototype.oW=function(){var t,n,t,t=this,n=t.DZ,t=t.xZ;t.jZ=function(t){return n.OZ(t)},t.RZ=function(t){return n.BZ(t)},t.LZ=function(t){return n.FZ(t)},t.PZ=function(t){return n.GZ(t)},t.UZ=function(t){return n.HZ(t)},t.ZAt=function(t){return n.WAt(t)},t.oIt=function(t){return n.ENt(t)},t.uIt=function(t){return n.jNt(t)}},fe.prototype.uW=function(){var t=this,n=t.xZ;n&&(t.kZ.aW(n,!1),n.jZ=M,n.RZ=M,n.LZ=M,n.AIt=M,n.PZ=M,n.UZ=M,n.ZAt=M,n.IIt=M,n.oIt=M,n.uIt=M,t.xZ=M)},fe.prototype.sW=function(t){return this.AZ.sW()},fe.prototype.cW=function(t){return this.AZ.cW()},fe.prototype.fW=function(t){return this.AZ.fW()},Vt=fe,zt="gc-toolstrip-button",Yt="gc-toolstrip-text",Zt="gc-toolstrip-image",Wt="gc-toolstrip-item",Qt="gc-touch-sperate-line",Jt="height",Kt="width",v="px",Xt="button",B(T,hn=L),T.prototype.open=function(t,n){var e,i,r,o,a,u,e=this,i=g(e.Vv);if(i&&(N.hi.F1(M,!0),e.LAt.css({left:t,top:n}),e.$c(),e.Jet=!0,e.if(),!U(e.f$)))for(o in r=e.f$)r.hasOwnProperty(o)&&((u=!(a=r[o]).UAt||a.UAt.call(e))?_("#"+o).show():_("#"+o).hide())},T.prototype.add=function(t){var n,e,i,i;t&&(e=(n=this).f$,t instanceof tn?(i=t.name())&&(e[i]=t,n.ONt(t.RNt(Qt,n.BAt+v))):t instanceof $t&&(i=t.name(),n.getItem(i)||(e[i]=t,n.ONt(t.RNt(Zt,n.RAt+v,Yt,zt)))))},T.prototype.getItem=function(t){return this.f$[t]},T.prototype.getItems=function(){var t,n,e,i,t,n=[],e=this.f$;if(U(e))return M;for(i in e)e.hasOwnProperty(i)&&n.push(e[i]);return n},T.prototype.remove=function(t){var n,e,n=this;return n.getItem(t)?(_("#"+t).parent().remove(),e=n.f$[t],delete n.f$[t],e):M},T.prototype.clear=function(){var t=this;t.LAt&&(t.LAt.find("td."+Wt).remove(),t.f$={})},T.prototype.close=function(){var t,t,n,t=this;vt.cf(),t.LAt&&t.LAt.hide(),t.Jet=!1,t.uf(),(t=g(t.Vv))&&(t.Zg(),0<(n=w(t)).length)&&!t.kNt&&-1===n[0].row&&-1===n[0].col&&t.IA()},T.prototype.imageAreaHeight=function(t){var n=this;return 0===arguments.length?n.RAt:(0<t&&(n.RAt=t,n.LAt.find("span."+Zt).css(Jt,t+v)),n)},T.prototype.itemHeight=function(t){var n=this,e=n.LAt.find("button."+zt);return 0===arguments.length?ht(e.css(Jt)):(0<t&&e.css(Jt,t+v),n)},T.prototype.itemWidth=function(t){var n,e,i,r,n=this,e=n.LAt.find("button."+zt);return 0===arguments.length?ht(e.css(Kt)):(0<t&&(t<(r=ht(e.css(i="min-width")))&&e.css(i,t+v),e.css(Kt,t+v)),n)},T.prototype.separatorHeight=function(t){var n=this;return 0===arguments.length?n.BAt:(0<t&&(n.BAt=t,n.LAt.find("div."+Qt).css(Jt,t+v)),n)},T.prototype.FAt=function(){var t,n,t,t="table",n=this,t=_(c(t)).css({padding:0,display:t}).attr({cellspacing:0,cellpadding:0});n.BNt=_(c("tr")).appendTo(t),t.appendTo(n.LAt)},T.prototype.L0=function(){var t=this,n=t.LAt;n&&(t.Jet&&(vt.cf(),t.uf()),n.unbind("click"),n.remove(),t.LAt=M)},T.prototype.aY=function(){var i=this;i.LAt.bind("click",function(t){var t,n,e,t,t,t=t.target,n;t.tagName.toLowerCase()===Xt?e=t.id:(t=t.parentElement)&&t.tagName.toLowerCase()===Xt&&(e=t.id),t=i.f$[e],e&&t&&t.tT.call(i)})},T.prototype.ONt=function(t){this.LAt&&t&&_(c("td")).append(t).appendTo(this.BNt).addClass(Wt)},T.prototype.PAt=function(){var t,t,n,e,i,r,t;function o(t){for(var n,e,n=0,e=t+n;O.getElementById(e);)e=t+ ++n;return e}e=(t={0:d+(t="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+mt,1:d+t+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+mt,2:d+t+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:d+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],i=t[1],r=t[2],t=t[3],(n=this).LNt=new $t(o("wijspread_toolstrip_paste"),u().ToolStrip_PasteText,e,n.FNt),n.PNt=new $t(o("wijspread_toolstrip_cut"),u().ToolStrip_CutText,i,n.GNt),n.UNt=new $t(o("wijspread_toolstrip_copy"),u().ToolStrip_CopyText,r,n.HNt),n.zNt=new $t(o("wijspread_toolstrip_autofill"),u().ToolStrip_AutoFillText,t,n.VNt,n.YNt),n.add(n.LNt),n.add(n.PNt),n.add(n.UNt),n.add(new tn(n.YNt)),n.add(n.zNt)},T.prototype.YNt=function(){var t,n,e,i,t=g(this.Vv);if(!t)return!1;if(0===(n=w(t)).length)return!1;for(e=0;e<n.length;e++)if(-1===(i=n[e]).row&&-1===i.col)return!1;return!0},T.prototype.VNt=function(){var t,n;this.close(),(t=g(this.Vv))&&(n=w(t).length)<=1&&(t.kNt=!0,t.Dn.E1())},T.prototype.xNt=function(){var t=g(this.Vv);t&&(t.kNt=!1,t.Dn.E1())},T.prototype.HNt=function(){var t,n,t=g(this.Vv);t&&(n=le(t),this.ZNt=n?t.Qy().execute({cmd:"copyFloatingObjects",sheetName:t.name()}):t.eA(!0)),this.close()},T.prototype.GNt=function(){var t,n,t=g(this.Vv);t&&(n=le(t),this.ZNt=n?t.Qy().execute({cmd:"cutFloatingObjects",sheetName:t.name()}):t.tA(!0)),this.close()},T.prototype.FNt=function(){var t,n,e,t=this,n=t.ZNt,e=g(t.Vv);e&&!k(n)&&(e.isPasteFloatingObject&&e.isPasteFloatingObject()?e.Qy().execute({cmd:"pasteFloatingObjects",sheetName:e.name()}):e.rA({pasteHtml:n.copyHtml,pasteText:n.copyText})),t.close()},T.prototype.WNt=function(){var t=this,n="span."+Yt;_("#"+t.LNt.Zc).find(n).text(u().ToolStrip_PasteText),_("#"+t.PNt.Zc).find(n).text(u().ToolStrip_CutText),_("#"+t.UNt.Zc).find(n).text(u().ToolStrip_CopyText),_("#"+t.zNt.Zc).find(n).text(u().ToolStrip_AutoFillText)},qt=T,t.TouchToolStrip=qt,de.prototype.name=function(t){var n=this;return 0===arguments.length?n.Zc:(_("#"+n.Zc).attr("id",t),_("#"+n.Zc+"Text").attr("id",t+"Text"),_("#"+n.Zc+"Image").attr("id",t+"Image"),n.Zc=t,n)},de.prototype.text=function(t){var n=this;return 0===arguments.length?n._text:(n._text=t,_("#"+n.name()+"Text").text(t),n)},de.prototype.font=function(t){var n,e,n=this,e=_("#"+n.name()+"Text");return 0===arguments.length?n._font:(n._font=t,e.css("font",t),n)},de.prototype.foreColor=function(t){var n,e,n=this,e=_("#"+n.name()+"Text");return 0===arguments.length?n.Oft||e.css("color"):(e.css("color",t),n)},de.prototype.image=function(t){var n=this;return 0===arguments.length?n.GAt:(n.GAt=t,_("#"+n.name()+"Image").css("background-image","url("+t+")"),n)},de.prototype.RNt=function(t,n,e,i){var r,o,a,u,s,t,n,r,a,r=this,o=r.name(),a=r.font(),u=r.text(),s=_(c("span"));return s.attr("id",o+"Image"),s.addClass(t),s.css({"background-image":"url("+r.image()+")","background-repeat":"no-repeat",display:"block",height:n,"background-position-x":"50%"}),(t=_(c("span"))).attr("id",o+"Text"),t.addClass(e),t.css("font",a),t.text(u),(r=60)<(n=he(a,u,e))&&(r=n),(a=_(c(Xt))).attr("type",Xt),a.attr("id",o),a.addClass(i+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),a.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:r+v}),a.append(s),a.append(t),a[0]},$t=de,t.TouchToolStripItem=$t,ve.prototype.name=function(){return this.Zc},ve.prototype.RNt=function(t,n){var e=_(c("div"));return e.attr("id",this.name()),e.addClass(t),e.css({width:"1px",height:n,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),e[0]},tn=ve,t.TouchToolStripSeparator=tn,A.prototype.NIt=function(){this.QNt=2,this.jS.Oi=!0},A.prototype.qAt=function(){this.QNt=0,this.KNt=m()},A.prototype.xIt=function(){return 1===this.QNt},A.prototype.jIt=function(){return 1===this.QNt},A.prototype._It=function(){return 1===this.QNt},A.prototype.sW=function(){var t=this;if(2===t.QNt)return!0;if(t.KNt){if(m()-t.KNt<=200)return t.JNt++,!0;t.KNt=0,t.JNt=0}return t.QNt=1,t.jS.Oi=!1},A.prototype.cW=function(){var t=this;return t.JNt?(t.JNt--,!0):2===t.QNt||(t.QNt=0,!1)},A.prototype.fW=function(){return 2===this.QNt},nn=A,t.IZ=nn,en=me,t.NZ=en,ge.prototype.XNt=function(t,n){var e,i,r,o,i,r,e=t,i=e.touches,r=e.targetTouches,o=e.changedTouches;!1===e.isPrimary||i&&1<=i.length&&r&&1<=r.length&&(i[0].clientX!==r[0].clientX||i[0].clientY!==r[0].clientY)||(f(t),i=k(o)?e:o[0],(r=O.createEvent("MouseEvents")).initMouseEvent(n,!0,!0,dt,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,M),t.target.dispatchEvent(r))},ge.prototype.lIt=function(t){var n,n,n=t.pointerType;n&&n!==t[h]&&n!==l||(n=t.data).Vb||(n.Vb=!0,n.qNt=!1,n.XNt(t,"mouseover"),n.XNt(t,"mousemove"),n.XNt(t,"mousedown"))},ge.prototype.iE=function(t){var n,n,n=t.pointerType;n&&n!==t[h]&&n!==l||(n=t.data).Vb&&(n.qNt=!0,n.XNt(t,"mousemove"))},ge.prototype.vIt=function(t){var n,n,n=t.pointerType;n&&n!==t[h]&&n!==l||(n=t.data).Vb&&(n.XNt(t,"mouseup"),n.XNt(t,"mouseout"),n.qNt||n.XNt(t,"click"),n.Vb=!1)},ge.prototype.$Nt=function(t,n,e){var i,r,r,o,a,u,s,c,f,l,e,h,n,i=this,r=e.charAt(0),r=et+(e="."!==r?"."+e:e),o=it+e,a=rt+e,u=ot+e,s=at+e,c=ut+e,f=st+e,l=ct+e,e=ft+e,h=N.mt.m0();n?h?(n=t.style,k(n.msTouchAction)||(n.msTouchAction=nt),k(n.touchAction)||(n.touchAction=nt),_(t).bind(r,i,i.lIt).bind(u,i,i.lIt),_(O).bind(o,i,i.iE).bind(s,i,i.iE).bind(a,i,i.vIt).bind(c,i,i.vIt)):_(t).bind(f,i,i.lIt).bind(l,i,i.iE).bind(e,i,i.vIt):h?(_(t).unbind(r).unbind(u),_(O).unbind(o).unbind(s).unbind(a).unbind(c)):_(t).unbind(f).unbind(l).unbind(e)},rn=ge,t.QAt=rn,on="newSheet",an="tab",un="allSheets",I.prototype.BZ=function(t){var n,t,e,i,r,r,o,a,r,t,a,t,a,u,s,c,r,n=this,t=t.JZ,e=n.w2,i=e.im(),r=g(e.Vv);e.Og&&e.Rg(r,!1),r="resize",(a=(o=e.hitTest(t.X,t.Y)).element)===r?(e.Bg=!0,e.Lg=t.X):a!==an&&a!==on&&""!==a||(r=e.fg,t=N.Bf.Xl(r),a=N.Bf.ql(r),a=(t=n.oNt(t,a)).getContext("2d"),u=N.Bf.Kl(t),s=N.Bf.Jl(t),N.Lf.Vl(a,1,1),a.drawImage(r,0,0,F(t),R(t),0,0,F(t),R(t)),N.Lf.Vl(a,u,s),n.fg=t,n.t6t=e.om,n.n6t=e.tm(),n.e6t=e.Xv(),n.Rv=e.Jv()),n.i6t=e.N2(-1),n.r6t=e.Ym(e.Zm()),r=(c=i?e.$v:e.M2e).slice(0,n.t6t),n.uTe=0<r.length?r.reduce(function(t,n){return t+n}):0},I.prototype.FZ=function(t){var n,e,i,r,o,a,u,s,o,c,o,a,u,s,e,f,l,t,h,h,u,a,s,e,u,r,d,v,m,g,p,b,n,r,n=this,e=t.JZ.X,i=n.w2,r=i.im();i.Bg?(o=e-i.Lg,u=(a=i.Vv).options,s=a.Kg.clientWidth,u.tabStripRatio=a.Jg()+o/s,o=i.rm()/s,c=1,a.Jg()<o?(u.tabStripRatio=o,i.Lg=i.rm()):1<=a.Jg()?(u.tabStripRatio=1,i.Lg=s):i.Lg=e):(o=n.fg,a=n.t6t,o&&!k(a)&&(u=n.i6t,s=n.r6t,e=n.Rv,f=n.n6t,l=n.e6t,t=r?t.nW.wAt.X:t.nW.wAt.Y,h=n.o6t(t,a),i.om=h.om,h=h.Eft,(0<t&&a===u&&i.om===u||t<0&&a===s&&i.om===s)&&(h=0),0<t&&h+e<t?t=h+e:t<0&&t<h-e&&(t=h-e),0!==t)&&(a=(u=i.fg).getContext("2d"),s=N.Bf.Kl(u),e=N.Bf.Jl(u),a.save(),a.clearRect(0,0,N.Bf.Xl(u),N.Bf.ql(u)),u=i.ot(),i.wm(a,u),r?(r=f-n.uTe+t,N.Lf.Yl(a,r,0),i.Z2(a,void 0,!0),N.Lf.Yl(a,-r,0),N.Lf.Vl(a,1,1),g=R(u),a.drawImage(o,(d=0)*s,v=0,(m=f)*s,g*e,d*s,v,m*s,g*e),p=N.I.fl(""),2007<(b=lt(p.zIndex))&&(d=l,m=u.x+F(u)-i.rm()-d,a.drawImage(o,d*s,v,m*s,g*e,d*s,v,m*s,g*e)),d=F(u)-i.rm(),m=i.rm(),a.drawImage(o,d*s,v,m*s,g*e,d*s,v,m*s,g*e)):(m=F(u),r=n=g=v=void(d=0),0<t?(0<(g=l-(n=(v=f)+t))&&(N.Lf.Vl(a,1,1),a.drawImage(o,d*s,v*e,m*s,g*e,d*s,n*e,m*s,g*e),N.Lf.Vl(a,s,e)),r=l-f<=t?0:t-h,v=f,0<(g=h)&&(N.Lf.Yl(a,0,r),i.Z2(a,new N.Rect(d,v,m,g)),N.Lf.Yl(a,0,-r))):t<0&&(0<(g=l-(v=(n=f)+D(t)))&&(N.Lf.Vl(a,1,1),a.drawImage(o,d*s,v*e,m*s,g*e,d*s,n*e,m*s,g*e),N.Lf.Vl(a,s,e)),r=t-h,l-f<=D(t)&&(r=0),v=l-(g=D(h)),0<g)&&(N.Lf.Yl(a,0,r),i.Z2(a,new N.Rect(d,v,m,g)),N.Lf.Yl(a,0,-r)),N.Lf.Vl(a,1,1),a.drawImage(o,d*s,(v=0)*e,m*s,(g=f)*e,d*s,v*e,m*s,g*e),p=N.I.fl(""),2007<(b=lt(p.zIndex))&&(v=l,g=u.y+R(u)-i.rm()-v,a.drawImage(o,d*s,v*e,m*s,g*e,d*s,v*e,m*s,g*e)),v=R(u)-i.rm(),g=i.rm(),a.drawImage(o,d*s,v*e,m*s,g*e,d*s,v*e,m*s,g*e)),N.Lf.Vl(a,s,e),a.restore()))},I.prototype.GZ=function(t){var n=this.w2;n.Bg?(n.Bg=!1,n.Vv.Xg()):n.repaint()},I.prototype.HZ=function(t){var n,e,i,r,o,i,a,o,n=this.w2,e=n.Vv,i=t.JZ,r=g(e);n.Og&&n.Rg(r,!1),o=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],a=(i=n.hitTest(i.X,i.Y)).element,e.Bp=!0;try{0<=o.indexOf(a)?n.Pg(i.index,!0):a===an?n.Gg(i.index,i.position):a===on?n.Hg(i.position):a===un&&this.zg(t)}finally{e.Bp=!1,(o=g(e))!==r&&(o.Oi=!0,o.Zg())}},I.prototype.WAt=function(t){return this.w2.E2(t.JZ.X,t.JZ.Y)},I.prototype.oNt=function(t,n){var e=this.fg;return e?t===N.Bf.Xl(e)&&n===N.Bf.ql(e)||N.Bf.$l(e,t,n):(e=c("canvas"),N.Bf.Wl(e,this.w2.Vv),N.Bf.$l(e,t,n)),e},I.prototype.o6t=function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.w2,r=i.$v,o=i.M2e,a=e.i6t,u=e.r6t,s=i.im(),c=n,f=0;if(0<t){for(;a<=c&&!(t<f);)f+=(s?r:o)[c],c--;c<a&&(c=a)}else if(t<0&&-1!==u){for(;c<=u&&!(f<t);)f-=(s?r:o)[c],c++;u<c&&(c=u)}return{om:c,Eft:f}},I.prototype.zg=function(t){var n,e,n=this.w2,e=wn(n.getCanvas());n.zg({pageX:t.JZ.X+e.I0,pageY:t.JZ.Y+e.A0})},sn=I,pe.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},pe.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},pe.prototype.sW=function(t){return this.AZ.sW()},pe.prototype.cW=function(t){return this.AZ.cW()},pe.prototype.fW=function(t){return this.AZ.fW()},cn=pe,N.g7.prototype.PD=function(){var t,n,e,i,t=this,n=t.Mf,e=w(n),i=e.length;n.My<=0&&0<i&&t.E1(e[i-1],p,p,!0)},N.Worksheet.ch(l,{init:function(){this.kNt=!1,this.INt=!0},setHost:function(t){var n,e,e,t,n=this,e=n.parent,e=e&&e.kZ||new wt,t=new Vt(t[0],n,e);t.oW(),n.dW=t},dispose:function(t){var n=this;n.dW&&n.dW.uW(),!1!==t.clearCache&&(n.dW=M)},startEdit:function(){this.Oi&&this.Dn.PD()},paintAdornment:function(t){var n,t,n=this,t=t.ctx;n.Oi&&(n.isActualProtected()||we(n,t),n.kNt?Ae(n,t):Te(n,n.INt,t))},preProcessMouseDown:function(t){var n,e,n=t.e,e=this.dW;(i||e.sW(n))&&(f(n),t.r=!0)},preProcessMouseMove:function(t){var n,e,n=t.e,e=this.dW;(i||e.fW(n))&&(f(n),t.r=!0)},preProcessMouseUp:function(t){var n,e,n=t.e,e=this.dW;(i||e.cW(n))&&(f(n),t.r=!0)},preProcessMouseDbClick:function(t){(i||this.Oi)&&(t.r=!0)},preProcessMouseOut:function(t){i&&(t.r=!0)},preProcessMouseWheel:function(t){i&&(t.r=!0)}}),N.Workbook.ch(l,{init:function(){this.kZ=new wt},setHost:function(){var t=this;t.touchToolStrip=new qt(t,t.j2())},dispose:function(){var t=this,n=t.kZ,e=t.touchToolStrip;n&&n.L0(),e&&(e.L0(),t.touchToolStrip=M)},onCultureChanged:function(){var t=this.touchToolStrip;t&&t.WNt()}}),N.Hv.ch(l,{setHost:function(){var t,n,t=this,n=new cn(t.fg,t,t.Vv.kZ);n.oW(),t.dW=n},dispose:function(){var t=this,n=t.dW;n&&(n.uW(),t.dW=M)},preProcessMouseDown:function(t){var n=this.dW,e=t.e;(i||n.sW(e))&&(f(e),t.r=!1)},preProcessMouseMove:function(t){var n=this.dW,e=t.e;(i||n.fW(e))&&(f(e),t.r=!1)},preProcessMouseUp:function(t){var n=this.dW,e=t.e;(i||n.cW(e))&&(f(e),t.r=!1)},preProcessMouseDbClick:function(t){var n=g(this.Vv);(i||n&&n.Oi)&&(t.r=!1)},preProcessMouseOut:function(t){i&&(t.r=!1)}}),fn=".gcScrollbar",N.YM.ch(l,{initEvents:function(t){var n;(this.Hb=new rn).$Nt(t,!0,fn)},dispose:function(t){var n=this.Hb;n&&n.$Nt(t,!1,fn)}})},"./dist/plugins/touch/touch.res.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ToolStrip_AutoFillText=n.ToolStrip_CopyText=n.ToolStrip_CutText=n.ToolStrip_PasteText=void 0,n.ToolStrip_PasteText="Paste",n.ToolStrip_CutText="Cut",n.ToolStrip_CopyText="Copy",n.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(i,t,n){"use strict";var t,e,F,L,B,P,G,U,H,V,z,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt,gt,pt;Object.defineProperty(t,"__esModule",{value:!0}),t=n("Core"),e=n("Common"),F=n("CalcEngine"),L=n("./dist/plugins/validation/datavalidation.js"),B=e.Common.lt.ht,P=e.Common.ct,G=e.Common.zf,U=t.mt,H=t.Ec,V=U.pi(),z=U.Tt,Y=t.GC$,Z=U.En,W=U.yt,Q=U.vi,J=document,K=Math.max,X=Math.min,q="position",$="absolute",tt="border",nt="padding",et="box-shadow",it="font",rt="background-color",ot="top",at="left",ut="z-index",st="outline",ct="auto",ft="white",lt="none",ht="size",dt="gcUIElement",vt="min-height",mt="min-width",gt="max-width",pt="word-wrap",Y.extend(t.nk.prototype,{PA:function(n,e){var i,r,t,o,a,u,s,c,f,l,h,u,a,t,u,a,d,v,m,g,p,b,w,y,M,C,S,T,t,u,a,t,s,u,t,s,R,A,I,s,x,N,k,_,D,D,a,_,j,O,s,k;function E(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((t=(r=(i=this).Mf)&&r.parent)&&(o=r.G1())&&((a=t.getActiveSheet())||(u=t.getActiveSheetTab())&&(a=u.Mf),a)&&r.name()===a.name()&&(s=r.getDataValidator(n,e))&&(c=r.getCellRect(n,e),!i.Ek(c))&&(f=t.j2(),l=t.getHost(),h=U.gi(l),E(s,"showInputMessage")&&E(s,"inputMessage")&&(t=(u=G.Vi)((a=G.j0)(E(s,"inputTitle")),"\n","<br/>"),u=u(a(E(s,"inputMessage")),"\n","<br/>"),a=Z("span"),Y(a).css(q,$).css(tt,"1px #C0C0C0 solid").css(nt,"3px 8px 3px 8px").css(rt,"#FFFFFF").css(et,"1px 2px 5px rgba(0,0,0,0.4)").css(it,"normal normal normal 12px/normal Arial").width(ct).height(ct).css(ot,c.y+c.height+5).css(at,c.x+c.width/2).css(vt,"15px").css(mt,"20px").css(gt,"200px").css(pt,"break-word").css(ut,h).html((B(t)||""===t?"":"<b>"+t+"</b><br/>")+u).attr(dt,"gcValidationInputMessage").appendTo(f),r.KD=a),s)&&3===E(s,"type")&&E(s,"inCellDropdown")&&E(s,"condition")){for(d=E(s,"condition").getValidListImp(r,n,e),v=E(s,"condition").KJ(),m=d.length,g=Z("select"),p=r.getText(n,e),b=-1,w=J.createDocumentFragment(),y=new RegExp(String.fromCharCode(32),"g"),M=String.fromCharCode(160),C=0;C<m;C++)S=d[C].text,B(S)||F&&S instanceof F.CalcError||(b<0&&S===p&&(b=C),S instanceof Date&&(S=P.Pe(S,"M/d/yyyy h:mm:ss")),(T=Z("option")).value=S,T.text=S.replace(y,M),w.appendChild(T));g.appendChild(w),g.selectedIndex=0<b?b:0,t=r.getActualStyle(n,e),u=r.Dn,a=t&&t.font?t.font:u.Nn(),1<r.zoom()&&(a=u._n(a)),(t=r.Ut.getSpans(H(n,e,s=1,1)))&&0<t.length&&t[0]&&(s=t[0].colCount),u=e+s-1==r.getColumnCount()-1,t=r.Gt(n),s=r.parent&&r.parent.options.useTouchLayout,t=X(s?50:15,t),A=z.safari&&(V.ipad||V.iphone),I=V.android,_=k=N=x=s=void 0,_=A?(s=c.width+3,x=c.height+3,N=c.y-1.5,k=c.x-1.5,ft):(s=K(c.width+(u?0:t),r.defaults.colWidth),x=8<m?140:ct,N=c.y+c.height,k=(D=c.x+c.width+(u?0:t)-s)<r.uw().left?c.x:D,""),D=Y(g).css(st,lt).css(q,$).css(it,W(a)).css(ut,h).css(rt,_).width(s).height(x).css(at,k).attr(dt,"gcValidationSelect").appendTo(f).attr(ht,2<m?m:2).hide().bind("click",function(){I||(i.jk(g,n,e,d,v),A&&Y(r.a6t).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||Y(g).hide():i.jk(g,n,e,d,v),A&&Y(r.a6t).show()}).bind("change",function(){I&&i.jk(g,n,e,d,v)}),a=Y(l).height(),x=D.outerHeight()+1,A||(a<x+N&&x<N?N=c.y-x:(_=l.getBoundingClientRect(),(s=(j=window.innerHeight)-((O=_.y)+N))<x&&D.height(s))),D.css(ot,N),A&&D.bind("blur",function(){i.jk(g,n,e,d,v),Y(r.a6t).show()}),r.gf=g,(k=Z("input")).type="image",k.src=(0,L.Hrt)(),k.alt="v",Y(k).css(q,$).width(t).height(t).css(ot,c.y+c.height-(t+3)).css(at,c.x+c.width-(u?t:0)).css(ut,h).css(rt,ft).css(tt,"1px solid gray").attr(dt,"gcValidationButton").appendTo(f).bind("click",function(t){var n,n;r.isEditing()&&!r.endEdit()||(n=r.gf,Y(n).toggle().focus(),n=n.options[n.selectedIndex],B(n)||n.scrollIntoView({behavior:"instant",block:"nearest",inline:"start"}),A&&Y(r.a6t).toggle(),Q(t))}),r.a6t=k}}})},"./dist/plugins/validation/datavalidation.entry.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.HighlightPosition=n.HighlightType=n.DefaultDataValidator=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,e("./dist/plugins/validation/datavalidation-event.js");var i=e("./dist/plugins/validation/datavalidation.js");Object.defineProperty(n,"CriteriaType",{enumerable:!0,get:function(){return i.CriteriaType}}),Object.defineProperty(n,"DataValidationResult",{enumerable:!0,get:function(){return i.DataValidationResult}}),Object.defineProperty(n,"ErrorStyle",{enumerable:!0,get:function(){return i.ErrorStyle}}),Object.defineProperty(n,"DefaultDataValidator",{enumerable:!0,get:function(){return i.DefaultDataValidator}}),Object.defineProperty(n,"HighlightType",{enumerable:!0,get:function(){return i.HighlightType}}),Object.defineProperty(n,"HighlightPosition",{enumerable:!0,get:function(){return i.HighlightPosition}}),Object.defineProperty(n,"Hrt",{enumerable:!0,get:function(){return i.Hrt}}),Object.defineProperty(n,"kf",{enumerable:!0,get:function(){return i.kf}}),Object.defineProperty(n,"createNumberValidator",{enumerable:!0,get:function(){return i.createNumberValidator}}),Object.defineProperty(n,"createDateValidator",{enumerable:!0,get:function(){return i.createDateValidator}}),Object.defineProperty(n,"createTimeValidator",{enumerable:!0,get:function(){return i.createTimeValidator}}),Object.defineProperty(n,"createTextLengthValidator",{enumerable:!0,get:function(){return i.createTextLengthValidator}}),Object.defineProperty(n,"createFormulaValidator",{enumerable:!0,get:function(){return i.createFormulaValidator}}),Object.defineProperty(n,"createFormulaListValidator",{enumerable:!0,get:function(){return i.createFormulaListValidator}}),Object.defineProperty(n,"createListValidator",{enumerable:!0,get:function(){return i.createListValidator}})},"./dist/plugins/validation/datavalidation.js":function(I,t,n){"use strict";var e,x,i,v,n,r,f,L,N,k,_,B,o,h,d,D,a,P,s,m,j,u,n,G,U,H,O,V,E,l,z,Y,Z,W,R,Q,F,J,K,X,q,$,tt,g,p,b,nt,c,r,et,it,rt,ot,at,ut,st,ct,ft,e,w,lt,ht,dt,vt,mt,y,r,gt,e,r,r,r,r,r,r;function pt(t){if(D(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=u.Xf(m,t,!0);if(!isNaN(n)&&n.toString()===t)return n}return m}function bt(t){return!D(t)&&t instanceof Date?P(t):t}function wt(t,n){var e,i,r;if(!D(t))return 1===t||2===t?e=Ct(n.operator,n.value1,n.value2,1===t):3===t?n.value?e=kt(n.value):n.formula&&(e=Nt(n.formula)):4===t||5===t?(i=n.value1,r=n.value2,i&&"/OADate("===i.substr(0,8)&&(i=nt.dJ(i)),r&&"/OADate("===r.substr(0,8)&&(r=nt.dJ(r)),e=(5===t?At:Tt)(n.operator,i,r)):6===t?e=It(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(e=xt(n.formula)),e?e.condition():void 0}function yt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,o,o,s,c,u,v,d,n,i,e,r,r,l,a;return t.intersect(n,e,i,r)?(a=t.rowCount,u=t.colCount,s=b(0,t.row),c=b(0,t.col),h=l=f=!1,n=b(0,n),e=b(0,e),d=(o=o||[-1,-1])[0],o=o[1],-1===a&&(a=d-s,l=!0),-1===u&&(u=o-c,f=!0),-1===r&&(r=o-e,h=!0),s=(o=s)+a-1,u=(c=c)+u-1,d=(v=n)+(i=-1===i?d-n:i)-1,i=(n=e)+r-1,e=[],-1!==o&&-1!==c&&-1!==v&&-1!==n&&(0<n-c&&(r=g(o,c,l?-1:a,n-c),e.push(r)),0<u-i&&(r=g(o,1+i,l?-1:a,u-i),e.push(r)),0<v-o&&(l=g(o,b(n,c),v-o,f&&h?-1:p(i,u)-b(n,c)+1),e.push(l)),0<s-d)&&(a=g(1+d,b(n,c),s-d,f&&h?-1:p(i,u)-b(n,c)+1),e.push(a)),e.c6t=!0,e):[t]}function M(t,n){var n;if(!D(t))return"string"==typeof t&&(t=W(t)),t=3===n||!(t=4!==n&&5!==n||(n=parseFloat(t),isNaN(n))?t:q(t))||t instanceof Date?t:z(t)}function C(t){var n=this;n.id=C.f6t,C.f6t++,n.l6t=a(rt),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}function Mt(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="}function S(t){return o&&t&&"="===t[0]}function Ct(t,n,e,i){var r,o,a,u,n,s,c,e,r=m,o=m,a=m,u=m;return S(n)?r=d(n,"="):o=n,S(e)?a=d(e,"="):u=e,n=m,6===t&&((s=h(1,3,o,r)).integerValue(i),(c=h(1,5,u,a)).integerValue(i),n=h(0,1,m,m,m,m,m,s,c)),7===t&&((s=h(1,4,o,r)).integerValue(i),(c=h(1,2,u,a)).integerValue(i),n=h(0,0,m,m,m,m,m,s,c)),0<=t&&t<=5&&(n=h(1,t,o,r)).integerValue(i),(e=new y(n)).type(i?1:2),e.comparisonOperator(t),e}function St(t,n,e,i,r){var o,a,u,s,n,c,f,l,e,o=m,a=m,u=m,s=m;if(S(n)?o=d(n,"="):a=n,S(e)?u=d(e,"="):s=e,n=m,6===t&&(c=h(i,5,a,o),f=h(i,3,s,u),n=h(0,1,m,m,m,m,m,c,f)),7===t&&(c=h(i,2,a,o),f=h(i,4,s,u),n=h(0,0,m,m,m,m,m,c,f)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}n=h(i,l,a,o)}return(e=new y(n)).type(r),e.comparisonOperator(t),e}function Tt(t,n,e){return St(t,n,e,5,4)}function At(t,n,e){return St(t,n,e,13,5)}function It(t,n,e){var i,r,o,a,n,u,s,e,i=m,r=m,o=m,a=m;return S(n)?i=d(n,"="):r=n,S(e)?o=d(e,"="):a=e,n=m,6===t&&(u=h(7,3,r,i),s=h(7,5,a,o),n=h(0,1,m,m,m,m,m,u,s)),7===t&&(u=h(7,4,r,i),s=h(7,2,a,o),n=h(0,0,m,m,m,m,m,u,s)),0<=t&&t<=5&&(n=h(7,t,r,i)),(e=new y(n)).type(6),e.comparisonOperator(t),e}function xt(t){var t;return o?((t=new y(h(4,m,m,d(t,"="),4))).type(7),t):m}function Nt(t){var t;return o?((t=new y(i.Condition.fromFormula(t))).type(3),t):m}function kt(t){var t=new y(i.Condition.fromSource(t));return t.type(3),t}function _t(t){return t&&t.getExpressions&&0<t.getExpressions().length}function Dt(t){return this.JS(t)}function jt(t,n){if(t&&n&&n.length)return n.map(Dt.bind(t))}function Ot(t,n,e){var i,r,o,i=t.rowCount,r=t.colCount,o=g(t.row,t.col,i,r);return 0===t.row&&i===n&&(o.row=-1),0===t.col&&r===e&&(o.col=-1),o}function Et(t,n){var e=t.getRowCount(),i=t.getColumnCount();return n.map(function(t){return Ot(t,e,i)})}function Rt(t,n){var e,t,e=t.cellCache;return e||(t.cellCache=e={}),(t=e[n])||(e[n]=t={}),t}function Ft(r,t,n,o,a,u,s){var c,f,l,h,d,e,i,v,m,g,p,b,w,y,M,c=o.h6t,f=r.row,l=r.col,h=r.rowCount,d=r.colCount,e=f+h,i=l+d;if(t<=e-1&&(h=t-f),n<=i-1&&(d=n-l),e===t)for(v=function(t,n){var e,i,e,e=c.colCache;e||(c.colCache=e={}),(i=e[n])||(e[n]=i={}),(e=i.dv)&&e!==a&&e.FX(r,o),i.dv=a,i.cacheStartRowIndex=f,(D(i.cacheRowCount)||!0===s&&a.smt().some(function(t){return t.intersect(u,n,1,1)}))&&(i.cacheRowCount=h)},m=0,g=l;m<d;m++,g++)v(m,g);else if(i===n)for(p=function(t,n){var e,i,e,e=c.rowCache;e||(c.rowCache=e={}),(i=e[n])||(e[n]=i={}),(e=i.dv)&&e!==a&&e.FX(r,o),i.dv=a,i.cacheStartColIndex=l,(D(i.cacheColCount)||!1===s&&a.smt().some(function(t){return t.intersect(n,u,1,1)}))&&(i.cacheColCount=d)},b=0,w=f;b<h;b++,w++)p(b,w);else for(b=0,w=f;b<h;b++,w++)for(y=Rt(c,w),m=0,g=l;m<d;m++,g++)(M=y[g])&&M!==a&&M.FX(r,o),y[g]=a}function Lt(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,m,g,y,M,C,S,T,A,C,S,I,x,N,k,e=n.h6t,i=t.row,r=t.col,o=t.rowCount,a=t.colCount,u=n.eJ,s=u.getRowCount(),c=u.getColumnCount(),f=e.colCache,l=e.rowCache,h=e.cellCache;if(f)for(d=r;d<r+a;d++)if(m=(v=f[d])&&v.cacheStartRowIndex,g=v&&v.cacheRowCount,v&&(m<=i&&i<m+g||m<=i+o&&i+o<=m+g)){if(p=!1,i<s){for(b=m;b<=i;b++)w=Rt(e,b),b<i&&(w[d]=v.dv);(g=i+o)-(m=v.cacheStartRowIndex)===v.cacheRowCount?f[d]=j:(v.cacheStartRowIndex=g,v.cacheRowCount-=g-m),p=!0}else i+o===s&&(p=!(f[d]=j));p&&(y=v.dv)&&y.FX(t,n)}if(l)for(M=i;M<i+o;M++)if(C=(w=l[M])&&w.cacheStartColIndex,S=w&&w.cacheColCount,w&&(C<=r&&r<C+S||C<=r+a&&r+a<=C+S)){if(p=!1,r<c){for(T=C;T<=r;T++)A=Rt(e,M),T<r&&(A[T]=w.dv);(S=r+a)-(C=w.cacheStartColIndex)===w.cacheColCount?l[M]=j:(w.cacheStartColIndex=S,w.cacheColCount-=S-C),p=!0}else r+a===c&&(p=!(l[M]=j));p&&(y=w.dv)&&y.FX(t,n)}if(h)for(M=0,I=i,x=o;M<x;M++,I++)if(w=h[I])for(d=0,N=r,k=a;d<k;d++,N++)(y=w[N])&&y.FX(t,n),w[N]=j}function Bt(t){switch(t){case"none":return w.anyValue;case"whole":return w.wholeNumber;case"decimal":return w.decimalValues;case"list":return w.list;case"date":return w.date;case"time":return w.time;case"textLength":return w.textLength;case"custom":return w.custom}}function Pt(t){var n,e,i,n=[];if(t)for(e in t)(i=t[e])&&n.push(i);return n}function Gt(t,n,e){var i,r,o;if(t)for(r=(i=Object.keys(t)).length-1;0<=r&&n<=(o=+i[r]);r--)t[o+e]=t[o],delete t[o]}function T(t){this.eJ=t,this.YB={},this.h6t={},this.d6t=[]}function Ut(t){return t="string"==typeof t?'"'+t+'"':t}function Ht(t){var n=t.D5;return D(n)?(n=t.expected(),Ut(V(n))):n}function Vt(t){var n,e,i;return D(t)?m:0===(n=t.conType())?zt(t):1===n||7===n?(i=t.formula(),{firstFormula:i=D(i)?t.expected():i}):4===n?{firstFormula:D(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Ht(t)}:{firstFormula:m}}function zt(t){var n,e;return D(t)?m:(e=n=m,{firstFormula:n=t.item1()?(0===t.item1().conType()?zt:Vt)(t.item1()).firstFormula:n,secondFormula:e=t.item2()?(0===t.item2.conType?zt:Vt)(t.item2()).firstFormula:e})}function Yt(t){var n,n,n=typeof t;return"string"==n||"number"==n?H(t.toString()):D(t)||D((n=t).item1)?"":Yt(n.item1)}function A(t,n){var e,n;if(!D(t))return e=t,n=+(e=n&&S(t)?t.substr(1):e),isNaN(n)?t:n}function Zt(t){var n=t.row,e=t.col,i=t.rowCount,t=t.colCount;return-1===n&&-1===e?e=0:(-1!==n&&-1!==i&&n+i>x.MAX_ROW_COUNT&&(i=x.MAX_ROW_COUNT-n),-1!==e&&-1!==t&&e+t>x.MAX_COLUMN_COUNT&&(t=x.MAX_COLUMN_COUNT-e)),g(n,e,i,t)}function Wt(t){var t=t.map(Zt);return v.rangesToFormula(t,0,0,15,!1).split(", ").join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.createListValidator=t.createFormulaListValidator=t.createFormulaValidator=t.createTextLengthValidator=t.createTimeValidator=t.createDateValidator=t.createNumberValidator=t.kf=t.Hrt=t.DefaultDataValidator=t.HighlightPosition=t.HighlightType=t.ErrorStyle=t.DataValidationResult=t.CriteriaType=void 0,e=n("Common"),x=n("Core"),i=n("ConditionalFormatting"),v=n("SheetsCalc"),n=n("CalcEngine"),r=e.Common.ct,f=x.UsedRangeUtil.vh,L=x.UsedRangeUtil.hh,N=x.XFileConstants.Au,k=x.XFileConstants.Ou,_=x.XFileConstants.Ru,B="1",o=!!n,h=i.aJ,d=e.Common.zf.cJ,D=e.Common.lt.ht,a=e.Common.lt.tv,P=r.o0,s=x.GC$,m=null,j=void 0,n=(u=x.mt).p0,G=u.T1,U=u.G0,H=u.t1,O=u.e1,V=u.i1,E=u.vo,l=u.n1,z=u.g1,Y=u.b1,Z=u.p1,W=x.Util.mr,R=x.Util.addXLFNPrefix,Q=x.Util.pr,F=u.xr,J=u.C1,K=u.Hue,X=u.c1,q=u.Eve,$=x.range_parser.Dc,tt=x.range_parser.Oc,g=x.Ec,p=Math.min,b=Math.max,nt=e.Common.ct,c=".validator",rt={type:0,color:r="red"},ot={type:et=1,color:r,position:1},at={type:2,color:r,position:it=5,image:null},(e=ut=ut||{})[e.none=0]="none",e[e.whole=1]="whole",e[e.decimal=2]="decimal",e[e.list=3]="list",e[e.date=4]="date",e[e.time=5]="time",e[e.textLength=6]="textLength",e[e.custom=7]="custom",(r=st=st||{})[r.stop=0]="stop",r[r.warning=1]="warning",r[r.information=2]="information",ct={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},ft={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},e=window,(r=w=t.CriteriaType||(t.CriteriaType={}))[r.anyValue=0]="anyValue",r[r.wholeNumber=1]="wholeNumber",r[r.decimalValues=2]="decimalValues",r[r.list=3]="list",r[r.date=4]="date",r[r.time=5]="time",r[r.textLength=6]="textLength",r[r.custom=7]="custom",(r=lt=t.DataValidationResult||(t.DataValidationResult={}))[r.forceApply=0]="forceApply",r[r.discard=1]="discard",r[r.retry=2]="retry",(r=ht=t.ErrorStyle||(t.ErrorStyle={}))[r.stop=0]="stop",r[r.warning=1]="warning",r[r.information=2]="information",(r=dt=t.HighlightType||(t.HighlightType={}))[r.circle=0]="circle",r[r.dogEar=1]="dogEar",r[r.icon=2]="icon",(r=vt=t.HighlightPosition||(t.HighlightPosition={}))[r.topLeft=0]="topLeft",r[r.topRight=1]="topRight",r[r.bottomRight=2]="bottomRight",r[r.bottomLeft=3]="bottomLeft",r[r.outsideLeft=4]="outsideLeft",r[r.outsideRight=5]="outsideRight",mt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],C.prototype.value1=function(t,n){var e,e,t,e=this.condition(),e=e&&e.item1()?e.item1():e;return e?(t=e.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):e.expected():m},C.prototype.value2=function(t,n){var e,e,t,e=this.condition(),e=e&&e.item2()?e.item2():e;return e?(t=e.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):e.expected():m},C.prototype.isValid=function(t,n,e,i,r){var o,a,u,s,c,r,o=this,a=o.condition(),u=D(r)||!0===r;if(a){if(o.ignoreBlank()&&(D(i)||""===i))return!0;if(c=void 0,!D(s=i))switch(o.type()){case 0:return!0;case 2:case 1:c=u?pt(i):i,D(c)||(s=c);break;case 4:case 5:c=u?q(i):i,D(c)||(s=c)}t&&(t.EJ=!0),r=void 0;try{r=a.evaluate(t,n,e,s,s)}catch(t){r=!0}finally{t&&(t.EJ=!1)}return r}return!0},C.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(m),t._S.length=0},C.prototype.getValidList=function(t,n,e){var i=this.condition();return i!==m&&3===this.type()&&12===i.conType()?i.getValidList(t,n,e):m},C.prototype.highlightStyle=function(t){var n,e,i,r,n=this;if(0===arguments.length)return n.l6t;if(!D(t)){if(n.l6t.type!==t.type)switch(e=t.type){case 1:n.l6t=a(ot);break;case 2:n.l6t=a(at);break;default:n.l6t=a(rt)}for(r in i=n.l6t)i.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(i[r]=t[r]);return n.Mf&&n.Mf.repaint(),n}},C.prototype.toJSON=function(e){var i,r,t,i=this,r={};return mt.forEach(function(t){var n=i[t]();i[t].isDefault(n)||(r[t]=n&&n.toJSON?n.toJSON(e):n)}),t=i._S.map(Zt),r.ranges=v.rangesToFormula(t,0,0,15,!1),r.highlightStyle=JSON.stringify(i.l6t),s.isEmptyObject(r)?j:r},C.prototype.fromJSON=function(r,o,a){var u,t,n,e,t;r&&!s.isEmptyObject(r)&&(u=this,r.ranges&&(u._S=v.formulaToRanges(a,r.ranges,0,0,!0)[0].ranges),r.highlightStyle&&(u.l6t=JSON.parse(r.highlightStyle)),mt.forEach(function(t){var n,e,i,n=r[t];G(n)&&("condition"===t?((e=h()).fromJSON(r.condition,a,o),u.condition(e,!1),(i=e.ranges())&&i.length?u._S=i:e.ranges(u._S),e.context(a)):u[t](n,!1))}),t=r.validatorInfo)&&(n=a.Lp.useR1C1,e=wt(r.type,t),t=t.operator,e&&(e.ranges(u._S),e.ignoreBlank(u.ignoreBlank()),e.context(a),n&&U(e),u.condition(e)),D(t)||u.comparisonOperator(t))},C.prototype.clone=function(t){var n,n;return this.ZB?((n=this.condition())&&n.initExpression(),this):((n=new C).fromJSON(this.toJSON(t),!1,t||this.Mf),n._S=[],n)},C.prototype.context=function(t){var n;return t&&(this.DJ=t,n=this.condition())&&(n.ranges(this._S),n.context(t)),this.DJ},C.prototype.v6t=function(t){var n,e;if(t){for(n=this._S,e=0;e<n.length;e++)if(n[e].containsRange(t))return;n.push(t)}},C.prototype.FX=function(t,n){var e,i,r,o,a,u,s,c,t,f,e=this,i=e._S;t&&i.length&&(r=t.row,o=t.col,a=t.rowCount,u=t.colCount,c=!(s=[]),t=e.Mf,f=t&&[t.getRowCount(),t.getColumnCount()],i.forEach(function(t){var t=yt(t,r,o,a,u,f);t.c6t&&(c=!0),s.push(t)}),e._S=[].concat.apply([],s),c)&&n.m6t(e)},C.prototype.smt=function(){return this._S},C.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},C.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},C.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,f,l,s,h,d,v,i=this,r=!1;for(i.XJ(),a=0,u=(o=i._S).length;a<u;a++)c=(s=o[a]).row,f=s.rowCount,l=s.col,s=s.colCount,h=c===t.row&&f===t.rowCount&&t.col<=l&&s<=t.colCount,d=c===n.row&&f===n.rowCount&&n.col<=l&&s<=n.colCount,(v=h||d)&&(o[a]=g(c,l,f+e,s),r=!0);return r&&i.g6t(o),r},C.prototype.JO=function(t,n,e,i){var r,o,a,u,s,c,f;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),r=0;r<this._S.length;r++)if(a=(o=this._S[r]).row,e&&0<e.length){for(u=!1,s=0,c=e.length;s<c;s++)if((f=e[s])&&(!0!==i||f.containsRange(o))){if(f.row===a&&f.row+f.rowCount-n===a+o.rowCount&&a===t){o.rowCount+=n,u=!0;break}if(t<=a){o.row+=n;break}if(t<=a+o.rowCount){o.rowCount+=n;break}}if(u)break}else t<=a?o.row+=n:t<=a+o.rowCount&&(o.rowCount+=n);this.condition()&&this.condition().ranges(this._S)}},C.prototype.xP=function(r,o){var a;r<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,e,i,n=t.row,e=t.rowCount;r<n?((i=r+o-n)<=0?n-=o:(n-=1+i,t.rowCount-=i),t.row=n=n<0?r:n):n<=r&&r<n+e&&(t.rowCount-=p(o,n+e-r)),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},C.prototype.qO=function(t,n,e){var i,r,o,a,u,s,c,f;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),i=0;i<this._S.length;i++){if(r=this._S[i],e&&0<e.length){for(a=o=!1,u=0,s=e.length;u<s;u++)if((c=e[u])&&!c.containsRange(r))o=!0;else if(c&&c.col===r.col&&c.col+c.colCount-n===r.col+r.colCount&&c.col===t){r.colCount+=n,a=!0;break}if(o)continue;if(a)break}t<=(f=r.col)?r.col+=n:t<=f+r.colCount&&(r.colCount+=n)}this.condition()&&this.condition().ranges(this._S)}},C.prototype.NP=function(r,o){var a;r<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,e,i,n=t.col,e=t.colCount;r<n?((i=r+o-n)<=0?n-=o:(n-=i,t.colCount-=i),n<0&&(t.colCount+=n,n=0),t.col=n):n<=r&&r<n+e&&(t.colCount-=p(o,n+e-r)),(0<t.colCount||-1===t.col&&-1===t.colCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},C.prototype.rv=function(t,n,e,i){var r,o,a,u,o,a,s,c,f,e,a,r=this;e?((o=F(t,"sqref"))&&(a=v.formulaToRanges(n,o.c_[0],0,0,!0)[0].ranges),r._S=a):r._S=v.formulaToRanges(n,t.sqref,0,0,!0)[0].ranges,u=Bt(t.type),o=ft[t.operator],D(u)||r.type(u),D(o)&&(o=6),r.comparisonOperator(o),"1"===t.allowBlank?r.ignoreBlank(!0):r.ignoreBlank(!1),D(t.error)||r.errorMessage(l(t.error)),D(t.errorTitle)||r.errorTitle(l(t.errorTitle)),D(t.errorStyle)||r.errorStyle(ht[t.errorStyle]),D(t.prompt)||r.inputMessage(l(t.prompt)),"1"===t.showDropDown&&r.inCellDropdown(!1),D(t.promptTitle)||r.inputTitle(l(t.promptTitle)),"1"!==t.showErrorMessage&&r.showErrorMessage(!1),"1"!==t.showInputMessage&&r.showInputMessage(!1),(a=t.c_)&&0<a.length&&(e?a.forEach(function(t){var n;t&&(n=F(t,"f"),f=l(n&&n.c_[0]),"formula1"===t.n_&&(s=M(f,u)),"formula2"===t.n_)&&(c=M(f,u))}):a.forEach(function(t){t&&(f=l(X(t)),"formula1"===t.n_&&(s=M(f,u)),"formula2"===t.n_)&&(c=M(f,u))})),D(u)||(e=void 0,1===u||2===u?e=Ct(o,A(s,i),A(c,i),1===u):3===u?(f=s||c)&&(e='"'===f[0]&&'"'===f[f.length-1]?kt(Z(f)):Nt(z(f))):4===u||5===u?e=(5===u?At:Tt)(o,s,c):6===u?e=It(o,A(s,i),A(c,i)):7===u&&void 0!==s&&(e=xt(s)),e&&(a=e.condition())&&(a.ranges(r._S),a.ignoreBlank(r.ignoreBlank()),a.context(n),r.condition(a))),r.Mf=n,t.lossless&&t.lossless.highlightStyle&&(r.l6t=JSON.parse(t.lossless.highlightStyle))},C.f6t=1,y=C,t.DefaultDataValidator=y,r={errorStyle:n("errorStyle",0),ignoreBlank:n("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:n("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:n("inCellDropdown",!0),showInputMessage:n("showInputMessage",!0),showErrorMessage:n("showErrorMessage",!0),inputTitle:n("inputTitle",""),errorTitle:n("errorTitle",""),inputMessage:n("inputMessage",""),errorMessage:n("errorMessage",""),comparisonOperator:n("comparisonOperator",6),condition:n("condition",m),type:n("type",0)},s.extend(y.prototype,r),t.Hrt=Mt,t.kf=S,t.createNumberValidator=Ct,t.createDateValidator=Tt,t.createTimeValidator=At,t.createTextLengthValidator=It,t.createFormulaValidator=xt,t.createFormulaListValidator=Nt,t.createListValidator=kt,s.extend(x.Worksheet.prototype,{getDataValidator:function(t,n,e){var t=this.hG(t,n,e);return t?t[0]:j},hG:function(t,n,e){return 3===(e=D(e)?3:e)?this.b8.p6t(t,n):j},setDataValidator:function(t,n,e,i,r,o){var a,u,s,c,e,i,a=this,u=a.b8;arguments.length<5&&(r=e,o=i,e=-1===t?-1:1,i=-1===n?-1:1),3===(o=D(o)?3:o)&&(s=a.getDataValidator(t,n,o),(c=1===e&&1===i)&&s===r||(a.Ut.b6t(),e=g(t,n,e,i),u.y6t(e),r&&u.w6t(r,e),a.Ut.b6t(!0),i="validator",c&&(a.Rj(i,t,n,o,s,r),-1!==t&&-1===n?a.dj(t,o,i,r,s):-1===t&&-1!==n&&a.vj(n,o,i,r,s)),a.zw()))},isValid:function(t,n,e,i){var r,o,r=this;try{if(r.Ubt=t,r.Hbt=n,r.zbt=e,r.Gbt=!0,o=r.getDataValidator(t,n))return o.isValid(r,t,n,e,i)}finally{r.Ubt=-1,r.Hbt=-1,r.zbt=m,r.Gbt=!1}return!0},G1:function(){var t,n,e,n,n,t=this;return!(t.M6t||(t.M6t=!0,(n=t.KD)&&((e=n.parentNode)&&e.removeChild(n),t.KD=m),(n=t.a6t)&&(s(n).unbind("click"),(e=n.parentNode)&&e.removeChild(n),t.a6t=m),(n=t.gf)&&(s(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(e=n.parentNode)&&e.removeChild(n),t.gf=m),t.M6t=!1))},xyt:function(){var t,n,e,i,r,o,a,t=this,n=[],e=t.b8,i=e&&e.YB;if(i)for(r in i)_t(a=(o=i[r])&&o.condition())&&n.push({validator:o,sheet:t});return n},Sge:function(t,n){var t=this.getDataValidator(t,n);return t&&_t(t.condition())}}),s.extend(x.Workbook.prototype,{xyt:function(){var n,t,e,n=[],t,e;return this.sheets.forEach(function(t){var t=t.xyt();t&&t.length&&t.forEach(function(t){n.push(t)})}),n}}),s.extend(x.CellRange.prototype,{validator:function(t){var n,e,i,r,o,a,u,n=this,e=n.sheet,i=n.sheetArea,r=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?e.getDataValidator(r,o,i):(e.setDataValidator(r,o,a,u,t,i),n)}}),T.prototype.getUsedRange=function(){var t,n,e,i,r,o,a,u,s,c,t,n=this.p6t(),e={};if(n)for(i=void 0,r=0,o=n;r<o.length;r++)for(u=0,s=i=(a=o[r]).smt();u<s.length;u++)c=s[u],f(e,L(c));return e},T.prototype.L0=function(){this.eJ=m},T.prototype.GJ=function(t){return jt(this.eJ,t)},T.prototype.OX=function(t){return Et(this.eJ,t)},T.prototype.C8=function(t,n,e){var i,r,o,a,i=this,r=i.YB;if(D(n)?i.h6t={}:i.h6t.cellCache={},r)for(o in r)(a=r[o])&&(t&&delete a.C6t,i.fE(a,!0,n,e));i.S6t()},T.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},T.prototype.fE=function(n,t,e,i){var r=this,o=r.GJ(n.smt()),a=r.eJ,u=a.getRowCount(),s=a.getColumnCount();o&&(r.d6t.length=0,o.forEach(function(t){Ft(t,u,s,r,n,e,i)}),t||r.S6t())},T.prototype.RX=function(t){var n=this,t=n.GJ(t.smt());n.d6t.length=0,t.forEach(function(t){Lt(t,n)}),n.S6t()},T.prototype.BX=function(t){var n=this;t&&Lt(n.eJ.JS(t),n),n.S6t()},T.prototype.S6t=function(){var t,n,t=this.d6t;t.length&&(n=this.YB,t.forEach(function(t){t.smt().length?t.condition()&&t.condition().ranges(t.smt()):(delete n[t.id],delete t.Mf)}),t.length=0)},T.prototype.w6t=function(t,n){var e=this,i=e.eJ;if(n&&((t=t.Mf&&i!==t.Mf?t.clone(i):t).Mf=i,t.v6t(n)),i)return t.context(i),e.YB[t.id]=t,e.fE(t),t},T.prototype.y6t=function(t){var n,e;t&&(e=(n=this).eJ,n.BX(t),e.zw())},T.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},T.prototype.p6t=function(t,e){var n,i,r,n,o,i,i,i,i,i,n=this,i=n.YB;return 0===arguments.length||(r=[],n=n.h6t,e===j&&(e=-1),-1===(t=t===j?-1:t)&&-1===e)?Pt(i):((i=(i=n.colCache)&&i[e])&&(t>=i.cacheStartRowIndex&&t<i.cacheStartRowIndex+i.cacheRowCount||-1===t&&0===i.cacheStartRowIndex)?r.push(i.dv):(i=(i=n.rowCache)&&i[t])&&(e>=i.cacheStartColIndex&&e<i.cacheStartColIndex+i.cacheColCount||-1===e&&0===i.cacheStartColIndex)?r.push(i.dv):(i=n.cellCache)&&(-1!==t&&-1!==e?(o=i[t])&&o[e]&&r.push(o[e]):-1===t?s.each(i,function(t,n){var n=n[e];n&&-1===r.indexOf(n)&&r.push(n)}):(o=i[t])&&s.each(o,function(t,n){n&&-1===r.indexOf(n)&&r.push(n)})),r)},T.prototype.qJ=function(t,n,e){var i,r,o,a,u,s,c,i=this,r,o=i.eJ.Ut,a=i.YB,u=!1;if(!D(a)){for(s in o.b6t(),a)(c=a[s])&&c.qJ(t,n,e)&&(u=!0);u&&i.C8()}},T.prototype.jve=function(t,n,e){var i,r=this.h6t;r&&Gt(e?r.rowCache:r.colCache,t,n)},T.prototype.$J=function(t,n,e,i,r){var o,a,u,s,o=this,a=o.YB;if(a)for(u in a)(s=a[u])&&(e?s.JO(t,n,i,r):s.qO(t,n,i));o.jve(t,n,e),o.C8(j,t,e)},T.prototype.JO=function(t,n,e,i){this.$J(t,n,!0,e,i)},T.prototype.qO=function(t,n,e){this.$J(t,n,!1,e)},T.prototype.tX=function(t,n,e){var i,r,o,a,i=this,r=i.YB;if(r)for(o in r)(a=r[o])&&(e?a.xP(t,n):a.NP(t,n),0===a._S.length)&&(r[o]=j);i.C8()},T.prototype.xP=function(t,n){this.tX(t,n,!0)},T.prototype.NP=function(t,n){this.tX(t,n,!1)},T.prototype.toJSON=function(t){var n,e,i,r,n=this.YB,e=[];for(i in n)(r=n[i])&&e.push(r.toJSON(t));return e},T.prototype.fromJSON=function(t,e,i){var r=this,o=r.eJ;r.YB={},t&&t.length&&(t.forEach(function(t){var n=new y;n.fromJSON(t,e,i),n.Mf=o,r.YB[n.id]=n}),r.C8())},T.prototype.y8=function(t,n,e){this.eJ.setDataValidator(t,n,e)},gt=T,s.extend(x.Y8.prototype,{b6t:function(t){var n,e,i,r,o,a,u,n=this,e=n.G8;if(e&&(t||!e.originalValidators)){for(o in r=[],i=n.b8.YB)(a=i[o])&&(u=a._S.map(function(t){return g(t.row,t.col,t.rowCount,t.colCount)}),r.push({validator:a,ranges:u}));t?e.currentValidators=r:e.originalValidators=r}},T6t:function(t){var i,n,r;t&&(i=this.Mf,n=this.b8,r={},t.forEach(function(t){var n,e,n=t.validator;"Object"===n.constructor.name&&((e=new y).fromJSON(n,!1,i),n=e),n._S=t.ranges,n.condition()&&n.condition().ranges(n._S),r[n.id]=n}),n.YB=r,n.C8(!1))},ATt:function(t,n,e,i){this.b6t(),this.b8.JO(t,n,e,i),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,e){this.b6t(),this.b8.qO(t,n,e),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),x.Y8.ch("validator",{init:function(){this.b8=new gt(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalValidators:n.currentValidators)&&this.T6t(t)},undo:function(t){var t=t.originalValidators;t&&this.T6t(t)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=m)}}),x.Worksheet.ch("validator",{getUsedRange:function(t){var n,e,i;t.type&x.UsedRangeType.dataValidation&&(i=(e=(n=this).b8).getUsedRange(),f(t.range,i))},init:function(){var e=this;e.b8=e.Ut.b8,e._3(x.Events.FloatingElementSelected+c),e.D3(x.Events.FloatingElementSelected+c,function(t,n){"worksheet"!==n.type&&e.G1()})},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(x.Events.FloatingElementSelected+c)},onLayoutChanged:function(t){var n,e,i,r,o,a,u,s,c,n=t.changeType,e=t.row,i=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea,u=D(a)||3===a,s=this.Ut,c=this.tables;"addRows"===n&&u?s.ATt(e,i,c&&c.AJ(e,-1,i,-1,!0)):"deleteRows"===n&&u?s.A6t(e,i):"addColumns"===n&&u?s.NTt(r,o,c&&c.AJ(-1,r,-1,o,!1)):"deleteColumns"===n&&u?s.kTt(r,o):"clear"===n?3===a&&2==(2&t.type)&&s.I6t(g(e,r,i,o)):"setColumnCount"!==n&&"setRowCount"!==n||3!==a&&1!==a||s.x6t()},toJson:function(t,n){var e,n,n,e=this.b8,n=n&&n.ignoreStyle;e&&!n&&(n=e.toJSON(this))&&n.length&&(t.validations=n)},fromJson:function(t,n,e){var e,e,e=e&&e.ignoreStyle;t&&t.validations&&!e&&(e=t.validations,this.b8.fromJSON(e,n,this))},wh:function(t,n,e){var i,r,o,a,u,e,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,m,g,p,b,w,y,M,C,A,I,i=this,r=i.b8,o=e&&!1===e.includeStyles,a=e&&e.fileType===x.OpenSaveFileType.excel;if(!o&&r&&!i.NMi){for(l in u=r.YB,s=(e={n_:k,c_:[]}).c_,c=0,f=[],u)if((h=u[l])&&h._S&&0<h._S.length){if(c++,v=!(d={n_:_}),m=h.comparisonOperator(),g=h.ignoreBlank(),p=h.errorMessage(),b=h.errorTitle(),w=h.errorStyle(),y=h.inputMessage(),M=h.inCellDropdown(),C=h.inputTitle(),S=h.showErrorMessage(),T=h.showInputMessage(),6!==m&&(d.operator=ct[m]),!1!==g&&(d.allowBlank="1"),p&&(d.error=E(Q(p))),b&&(d.errorTitle=E(b)),0!==w&&(d.errorStyle=st[w]),y&&(d.prompt=E(Q(y))),!1===M&&(d.showDropDown="1"),C&&(d.promptTitle=E(C)),!1!==S&&(d.showErrorMessage="1"),!1!==T&&(d.showInputMessage="1"),m=h.condition(),g=h._S,d.sqref=Wt(g),m){if(p=h.type(),d.type=ut[p],w=(b=Vt(m)).firstFormula,y=b.secondFormula,a&&(J(w)||J(y)))continue;d.c_=[],M=i.name(),C=i.parent&&i.parent.r4(),O(w,M,C)||O(y,M,C)?(d.n_=_,D(w)||d.c_.push({n_:"formula1",c_:[{n_:"f",c_:[E(R(w))]}]}),D(y)||d.c_.push({n_:"formula2",c_:[{n_:"f",c_:[E(R(y))]}]}),d.c_.push({n_:"sqref",c_:[tt(g)]}),v=!0):(D(w)||(4===p||5===p?d.c_.push({n_:"formula1",c_:[bt(w)+""]}):d.c_.push({n_:"formula1",c_:[E(R(w))]})),D(y)||(4===p||5===p?d.c_.push({n_:"formula2",c_:[bt(y)+""]}):d.c_.push({n_:"formula2",c_:[E(R(y))]})))}h.l6t&&(d.lossless={highlightStyle:JSON.stringify(h.l6t)}),(v?f:s).push(d)}0<s.length&&(e.count=c,t.c_.push(e)),0<f.length&&(A=F(t,N)).c_.push(I={n_:"ext",r_:[1,9],c_:[{n_:k,c_:f,r_:[2],count:f.length}]})}},yh:function(t,n,e){var i,r,o,a,u,e,s,c,f,l,e,t,h,d,i=this,r=i.b8,o=r.YB,a;if(!(e&&!1===e.includeStyles)&&r&&v){if(u=x.Util.ko(e),(s=(e=F(t,k))&&e.c_)&&0<s.length)for(c=s.length-1;0<=c;c--)f=s[c],(l=new y).rv(f,i,j,u),o[l.id]=l;if(e=F(t,N),(t=K(e,"dataValidations"))&&t.c_&&0<t.c_.length)for(c=(h=t.c_).length-1;0<=c;c--)d=h[c],(l=new y).rv(d,i,!0,u),o[l.id]=l;r.C8()}}}),x.Style.ch("validator",{fromJson:function(t){var n;"validator"===t.p&&((n=new y).fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0)}}),e.gcGlobal.wf.push(function(t,n){!n&&t.G1&&t.G1()})},"./node_modules_local/@spreadjs/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(t,n,a){var u;!function(){"use strict";var e,i,t,n,r;function o(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,o)),n.exports}e={"./src/functions-db.ts":function(F,t,n){var a,s,p,u,d,v,m,g,b,w,t,y,M,n,C,r,c,S,e,n,i,n;function o(t,n,e){this.N6t=t,this.k6t=n,this.D6t=e}function f(t,n){return[t,n].join(",")}function l(t,n,e){var i=this;if(i.Ky=0,i._6t=t,i.E6t=e,i.j6t={},3===arguments.length){if(i.yft=i.mvt(t,n),t.rowCount<2||t.colCount<1||e.rowCount<2||e.colCount<1||i.yft<0||i._6t.colCount<=i.yft)throw r}else if(2===arguments.length&&(i.yft=-1,t.rowCount<2||t.colCount<1||e.rowCount<2||e.colCount<1))throw r}function h(t,n,e,i){for(var r,o,a,r=0,o=new S(t,n,e);o.O6t();)a=o.R6t(),(a=i?v(a):a)&&r++;return g(r)}function T(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,t,n,u=a?1:0,s=0,c=0,f=new S(t,n,e);f.O6t();)if(l=f.R6t(),v(l)){if(h=d(l),M(h))return w;u=a?u*h:u+h,s+=h*h,c++}else if(m(l))return l;return o||a?g(u):(t=Math.max(0,(c*s-u*u)/(c*(c-r))),n=i?Math.sqrt(t):t,c<=1?b:g(n))}function A(t,n,e){for(var i,r,o,a,a,i=0,r=0,o=new S(t,n,e);o.O6t();){if(a=o.R6t(),m(a))return a;if(v(a)){if(!s.Convert.sJ(a,a={value:0}))return w;i+=a.value,r++}}return 0===r?b:g(i/r)}function I(t,n,e){return h(t,n,e,!0)}function x(t,n,e){return h(t,n,e,!1)}function N(t,n,e){var n,t=new S(t,n,e);return t.O6t()?(n=t.R6t(),t.O6t()?s.Errors.Number:n):w}function k(t,n,e){for(var i,r,o,a,a,i=!1,r=-s.Functions.B6t,o=new S(t,n,e);o.O6t();){if(a=o.R6t(),m(a))return a;if(v(a)){if(a=d(a),M(a))return w;(!i||r<a)&&(r=a),i=!0}}return i?g(r):0}function _(t,n,e){for(var i,r,o,a,u,i=!1,r=s.Functions.B6t,o=new S(t,n,e);o.O6t();){if(a=o.R6t(),m(a))return a;if(v(a)){if(u=d(a),M(u))return w;(!i||a<r)&&(r=a),i=!0}}return i?g(r):0}function D(t,n,e){return T(t,n,e,!1,0,!1,!0)}function j(t,n,e){return T(t,n,e,!0,1)}function O(t,n,e){return T(t,n,e,!0,0)}function E(t,n,e){return T(t,n,e,!1,0,!0)}function R(t,n,e){return T(t,n,e,!1,1)}function L(t,n,e){return T(t,n,e,!1,0)}Object.defineProperty(t,"__esModule",{value:!0}),a=n("Common"),s=n("CalcEngine"),p=a.Common.$T,u=null,d=s.Convert.uJ,v=s.Convert.q8,m=s.Convert.BJ,g=s.Convert.L6t,b=s.Errors.DivideByZero,w=s.Errors.Value,t=s.Functions.F6t,y=s.Functions.OMt,M=isNaN,n=a.Common.zf,C=n.fJ,r=(0,s.sR)().Exp_InvalidCast,o.prototype.P6t=function(t){var n,t,n,t=(0,s.evaluateOperator)({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.N6t],t,this.k6t);return!!s.Functions.G6t(t)&&s.Convert.U6t(t)},c=o,l.prototype.mvt=function(t,n){var e,i;if(y(n)){for(e=0;e<t.colCount;e++)if((i=s.Convert.j(t[0][e]))&&this.H6t(i,n))return e;return-1}return s.Convert.z6t(n)-1},l.prototype.R6t=function(){var t=this;if(t.Ky<=0||t._6t.rowCount<=t.Ky)throw(0,s.sR)().Exp_InvalidOperation;return t._6t[t.Ky][t.yft]},l.prototype.O6t=function(){for(var t=this,n=!1,e=t._6t.rowCount;!n&&t.Ky<e;)t.Ky++,t.Ky<e&&(n=t.V6t());return n},l.prototype.Y6t=function(t){var n,e,i,r,o;if(y(t)){for(n=["=","<>","<=",">=","<",">"],e=s.Convert.j(t),r=i=void 0,i=0;i<n.length;i++)if(a.Common.zf.fJ(e,n[i]))return e=e.substring(n[i].length),o=a.Common.st.Z6t(e),M(o)?this.H6t("true",e)?t=!0:this.H6t("false",e)?t=!1:(t=e,r=0===i):t=o,new c(n[i],t,r);return new c("=",t)}return t?new c("=",t):u},l.prototype.W6t=function(t,n){var e,i,r,o,a,e=this,i=e.j6t,r=f(t,n),o=i[r];return o||i[a="_"+r]||(o=i[r]=e.Y6t(e.E6t[t][n]),i[a]=!0),o},l.prototype.V6t=function(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,t=this,n=!1,e=t.E6t,i=t.Ky,u=e.rowCount,s=e.colCount,c=t._6t,f=t.Q6t;if(!f){for(l=e[0],f=[],o=0;o<s;o++){if((a=t.mvt(c,l[o]))<0)return!1;f[o]=a}t.Q6t=f}for(r=1;!n&&r<u;r++)for(n=!0,o=0;n&&o<s;o++)(h=t.W6t(r,o))&&(d=c[i][f[o]],n="="===h.N6t&&(v=h.k6t,y(v))&&y(d)?(m=p.jJ(v,!0),g=h.D6t,m?p.OJ("^"+m+(g?"$":"")).test(d):g?d.toLowerCase()===v.toLowerCase():C(d,v,!0)):h.P6t(d));return n},l.prototype.H6t=function(t,n){return t.toLowerCase()===n.toLowerCase()},S=l,t("DAVERAGE",A,3,3,n=[n={K6t:!0,J6t:4,X6t:0},i={K6t:!0},n],e="!= 1",e),t("DCOUNT",I,3,3,n,e,e),t("DCOUNTA",x,3,3,n,e,e),t("DGET",N,3,3,n,e,e),t("DMAX",k,3,3,n,e,e),t("DMIN",_,3,3,n,e,e),t("DPRODUCT",D,3,3,n,e,e),t("DSTDEV",j,3,3,n,e,e),t("DSTDEVP",O,3,3,n,e,e),t("DSUM",E,3,3,n,e,e),t("DVAR",R,3,3,n,e,e),t("DVARP",L,3,3,n,e,e)},"./src/functions-eng.ts":function(_,t,n){var D,d,h,t,w,E,R,F,L,v,j,O,r,B,G,U,m,H,n,V,P,z,Y,e,g,Z,W,i,o,Q,a,a,J,a,K,o,a,u,X,q,$,tt,nt,a,et,u,it,o,a,s,rt,ot,at,ut,u,st,a,o,u,c,o,ct,ft,a,o,lt,u,c,o,u,c,o,u,c,o,ht,dt,vt,u,c,o,mt,gt,a,c,u,o,pt,bt,f,l,wt,p,b,yt,y,Mt,Ct,M,a,St,Tt,o,c,u,o,At,It,C;function S(t,n){return new d.Functions.q6t(t,n)}function xt(t,n){return{$6t:t,_c:n}}function T(t,n){for(var e=[],i,i=0;i<h(t);i++)e.push(xt(t[i],n[i]));return e.push(xt(null,0)),e}function Nt(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=100,r=.5*t,o=r*r;for(r=v(r,B(n)),a=d.Functions.nkt(n),u=1,s=0,c=B(n),l=.9*(f=r/a),h=!1;f!==l&&0!==i;)r*=o,a*=++s,u*=++c,l=f,f=e||h?f+r/a/u:f-r/a/u,i--,h=!h;return f}function kt(t,n){var e=v(n,10),t=parseInt(t,n);return G(t)?m:e/2<=t?t-e:t}function _t(t,n,e){t<0&&(t+=v(n,10));for(var i=t.toString(n),r=e-h(i),o,o=0;o<r;o++)i="0"+i;return i.toUpperCase()}function Dt(t,n){var t;return t<0||(t=kt(t,n),z(t))?m:t}function jt(t,n,e){var t=_t(t,e,n.y4);return 0<=t&&n.y4<h(t)&&n.ekt?m:t}function A(t,n,e,i,r){var t,e;return t<0||(t=kt(t,e),z(t))||r&&(t<-r||r-1<t)||(e=_t(t,i,n.y4),0<=t&&n.y4<h(e)&&n.ekt)?m:e}function I(t,n){var e=Number.POSITIVE_INFINITY,i=t.ikt(),r=t.rkt();return G(i)||i===e||G(r)||r===e?m:t.j(n)}function Ot(t,n,e,i){var r=t,o=n,a=e.ikt(),e=e.rkt();return{okt:t=i?r*a-o*e:r+a,akt:n=i?r*e+o*a:o+e}}function Et(t,n){for(var e,i,r,o,a,u,s,c,f,l,e=n?1:0,i=0,o=0;o<h(t);o++)if(d.Convert.Nh(t[o]))for(f=t[o],a=0;a<f.rowCount;a++)for(u=0;u<f.columnCount;u++){if(!(r=g(f.getValue(a,u))))return m;e=(c=Ot(e,i,r,n)).okt,i=c.akt}else if(d.Convert.LE(t[o]))for(l=t[o],s=0;s<l.getRangeCount();s++)for(a=0;a<l.getRowCount(s);a++)for(u=0;u<l.getColumnCount(s);u++){if(!(r=g(l.getValue(s,a,u))))return m;e=(c=Ot(e,i,r,n)).okt,i=c.akt}else{if(!(r=g(t[o])))return m;e=(c=Ot(e,i,r,n)).okt,i=c.akt}return I(S(e,i))}function Rt(t,n){return P(Nt(t,n,!0))}function Ft(t,n){return P(Nt(t,n,!1))}function Lt(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,e=17976931348623157e292,i=.5772156649015329,r=0,o=.25*t*t,a=1,u=0,s=1,c=2/t;if(0<n){for(u=-i,d=1;d<n;d++)u+=1/d,a*=d+1;if(s=c,1===n)r=1/t;else{for(f=v=a/n,d=g=m=1;d<n;d++){if(f+=l=(v/=n-d)*(g*=-o)/(m*=d),e-w(l)<w(f)||1<c&&e/c<s)return e;s*=c}if(l=w(f*=.5),1<s&&e/s<l||1<l&&e/l<s)return e;r=f*s}}for(b=-i,l=0===n?(u=b,1):(u+=1/n,1/a),f=(b+u-(p=2*L(t/2)))*l,h=1;f+=((b+=1/h)+(u+=1/(h+n))-p)*(l*=o/(h*(h+n))),h++,11102230246251565e-32<w(l/f););return f=.5*f/s,P(r+=f=0!=(1&n)?-f:f)}function Bt(t,n){var d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D;function j(t,n,e,i){var r=0,o=B(n[r]),a=e;for(r++,i&&(o+=t,a--);o=o*t+B(n[r]),r++,0!==--a;);return o}function O(t,n){var e,i,r,o,a,u,s,c,f,l,h,u,e,e=n?d:v,i=n?m:g,r=n?p:b,o=n?w:y,a,u=n?x:N,s,c;return t<=5?(l=t*t,n&&t<1e-5?1-l/4:(h=(l-(n?5.783185962946784:14.681970642123893))*(l-(n?30.471262343662087:49.2184563216946)),h*=f=j(l,n?A:I,3)/j(l,u,8,!0),n?h:h*t)):(f=5/t,h=j(l=n?25/(t*t):f*f,e,6)/j(l,i,6),u=j(l,r,7)/j(l,o,7,!0),(h=h*R(e=t-(n?D:_))-f*u*E(e))*k/F(t))}function u(t,n){var e,i,r,o,a,u,s,c,f,l,h,c,h,r,r=n?d:v,o=n?m:g,a=n?p:b,u=n?w:y,s,c=n?S:T,f,l,h=n?7:8;return t<=5?(e=(n?1:t)*j(i=t*t,n?M:C,n?7:5)/j(i,c,h,!0),e+.6366197723675814*(n?L(t)*O(t,!0):O(t,!1)*L(t)-1/t)):(e=5/t,c=j(i=n?25/(t*t):e*e,r,6)/j(i,o,6),h=j(i,a,7)/j(i,u,7,!0),(c=c*E(r=t-(n?D:_))+e*h*R(r))*k/F(t))}function e(t,n){var e=u(t,!0),i=u(t,!1),r=1,o=2*r,a;if(0===n)return e;if(1===n)return i;for(;a=o*i/t-e,e=i,i=a,o+=2,++r<n;);return a}return d=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],v=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],m=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],g=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],p=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],b=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],w=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],y=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],M=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],C=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],S=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],T=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],A=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],I=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],x=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],N=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],k=.7978845608028654,_=2.356194490192345,D=.7853981633974483,P(e(t,n))}function Pt(t){return Dt(t,2)}function Gt(t){return Dt(t,16)}function Ut(t){return Dt(t,8)}function Ht(t,n){return A(t,n,2,16)}function Vt(t,n){return A(t,n,2,8)}function zt(t,n){return jt(t,n,2)}function Yt(t,n){return jt(t,n,16)}function Zt(t,n){return jt(t,n,8)}function Wt(t,n){return A(t,n,16,2,512)}function Qt(t,n){return A(t,n,8,2,512)}function Jt(t,n){return A(t,n,16,8,536870912)}function Kt(t,n){return A(t,n,8,16,549755813888)}function Xt(t,n){var t,e,i,t=V(t*F(2)),e=2*t-1;return e=n.ekt?(i=2*(t=V(n.y4*F(2)))-1)-e:e}function qt(t){return Xt(t,{ekt:!1})}function $t(t){return 1-Xt(t,{ekt:!1})}function tn(t,n){return t===n||D.Common.st.ukt(t,n)?1:0}function nn(t,n){return n<=t?1:0}function en(t,n,e){return"i"!==e&&"j"!==e?d.Errors.Value:I(S(t,n),e)}function rn(t){return P(F(t.okt*t.okt+t.akt*t.akt))}function on(t){return P(t.akt)}function an(t){return 0===t.okt&&0===t.akt?d.Errors.DivideByZero:P(r(t.akt,t.okt))}function un(t){return I(S(t.okt,-t.akt))}function sn(t){return I(S(R(t.okt)*e(t.akt,!1),-E(t.okt)*e(t.akt,!0)))}function cn(t,n){var e,t,i,n,e=t.okt,t=t.akt,i=n.okt,n=n.akt;return I(S((e*i+t*n)/(i*i+n*n),(t*i-e*n)/(i*i+n*n)))}function fn(t){return I(S(j(t.okt)*R(t.akt),j(t.okt)*E(t.akt)))}function ln(t){var n,t,n=t.okt,t=t.akt;return I(S(L(F(n*n+t*t)),r(t,n)))}function hn(t){var n,t,e,n=t.okt,t=t.akt,e=Y.ckt(O,10);return I(S(e*L(F(n*n+t*t)),e*r(t,n)))}function dn(t){var n,t,e,n=t.okt,t=t.akt,e=Y.ckt(O,2);return I(S(e*L(F(n*n+t*t)),e*r(t,n)))}function vn(t,n){var e,t,i,t,e=t.okt,t=t.akt;return 0===e&&0===t?0<n?"0":m:(i=F(e*e+t*t),t=r(t,e),I(S(v(i,n)*R(n*t),v(i,n)*E(n*t))))}function mn(t){return P(t.okt)}function gn(t){return I(S(E(t.okt)*e(t.akt,!1),R(t.okt)*e(t.akt,!0)))}function pn(t){var n,t,e,t,n=t.okt,t=t.akt;return 0===n&&0===t?"0":(e=F(n*n+t*t),t=r(t,n),I(S(F(e)*R(t/2),F(e)*E(t/2))))}function bn(t,n){return I(S(t.okt-n.okt,t.akt-n.akt))}function wn(){return Et(arguments,!0)}function yn(){return Et(arguments,!1)}function Mn(t){for(var n,e,n=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"],e=0;n[e];e++)if(0===t.localeCompare(n[e]))return;return 1}function Cn(t,n,e){for(var i,r,o,a,u,s,c,f,r=0,o=1,i=0;t[i].$6t;i++)if(0===e.localeCompare(t[i].$6t))return{fkt:!0,vit:o,lkt:r=t[i]._c};if(n)for(i=0;n[i].$6t;i++)(a=e.substr(0,1))===(u=n[i].$6t.substr(0,1))&&Mn(e)&&(o=n[i]._c);for(i=0;t[i].$6t;i++)if(s=h(t[i].$6t),(c=e.substr(1,s))===(f=t[i].$6t.substr(0,s))&&Mn(e))return{fkt:!0,vit:o,lkt:r=t[i]._c};return{fkt:!1,vit:o,lkt:r}}function Sn(t,n,e){var i,r,o,a,u,s,c,f,a,l,u;if(x(n).unit&&x(e).unit)return _n(t,n,e);if(1!==(i=xn(n,e))){if(2===i)return Nn(t,n,e);if(An(n)&&An(e))return In(t,n,e);if(!Tn(n)&&!Tn(e))for(r=[K,et,ot,ut,ct,st,ft,dt,ft,vt,pt],o=0;o<h(r);o++)if(s=(u=Cn(a=r[o],y,n)).fkt,c=u.lkt,f=u.vit,a=(u=Cn(a,y,e)).fkt,l=u.vit,u=u.lkt,s&&a&&0!==c&&0!==l)return t*f/c*u/l}return U}function Tn(t){var t,n,e;if(!(0<=Ct.indexOf(t)))return e=(t=[t.slice(0,1),t.slice(1)])[1],0<=yt.indexOf(t[0])&&0<=Ct.indexOf(e)}function An(t){for(var n=0;n<s.length;n++)if(t===s[n].$6t)return 1;return"sec"===t.slice(1)||"s"===t.slice(1)}function In(t,n,e){var n,e,n=Cn(s,y,n),e=Cn(s,y,e);return t*n.vit/n.lkt*e.lkt/e.vit}function xn(t,n){var t,n,t=-1<t.indexOf("bit")||-1<t.indexOf("byte"),n=-1<n.indexOf("bit")||-1<n.indexOf("byte");return t&&n?2:n||t?1:0}function Nn(t,n,e){var n,e,n=kn(n),e=kn(e);return t*n.vit/n.lkt*e.lkt/e.vit}function kn(t){var n,t,e,i,n,r,o;if(-1<t.indexOf(f.bit)?(e=(n=[t.slice(0,-3),t.slice(-3)])[0],n=n[1]):-1<t.indexOf(f.byte)&&(e=(t=[t.slice(0,-4),t.slice(-4)])[0],n=t[1]),e)for(o=0;Mt[o].$6t;o++)e===Mt[o].$6t&&(i=Mt[o]._c);else i=1;return n===f.bit?r=bt[0]._c:n===f.byte&&(r=bt[1]._c),{vit:i,lkt:r}}function _n(t,n,e){var i,r,r=x(n);switch(r.unit){case l.Rank:i=En(t,e);break;case l.Reau:i=Rn(t,e);break;case l.C:case l.cel:i=Dn(t,e);break;case l.F:case l.fah:i=jn(t,e);break;case l.K:case l.kel:i=On(t*r.prefixNumber,e)}return i}function Dn(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return 9*t/5+32+b;case l.Reau:return.8*t;case l.cel:case l.C:return t;case l.F:case l.fah:return 9*t/5+32;case l.K:case l.kel:return e=i.prefixNumber,(t+p)/e}}function jn(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return t+b;case l.Reau:return 4*(t-32)/9;case l.F:case l.fah:return t;case l.C:case l.cel:return 5*(t-32)/9;case l.K:case l.kel:return e=i.prefixNumber,(5*(t-32)/9+p)/e}}function On(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return 9*t/5;case l.Reau:return.8*(t-p);case l.C:case l.cel:return t-p;case l.F:case l.fah:return 9*(t-p)/5+32;case l.K:case l.kel:return t/(e=i.prefixNumber)}}function En(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return t;case l.Reau:return.8*(t-b-32)*5/9;case l.C:case l.cel:return 5*(t-b-32)/9;case l.F:case l.fah:return t-b;case l.K:case l.kel:return e=i.prefixNumber,(p+5*(t-b-32)/9)/e}}function Rn(t,n){var e,i,i=x(n);switch(i.unit){case l.Rank:return 1.25*t*9/5+32+b;case l.Reau:return t;case l.C:case l.cel:return 1.25*t;case l.F:case l.fah:return 1.25*t*9/5+32;case l.K:case l.kel:return e=i.prefixNumber,(1.25*t+p)/e}}function x(t){var n,e,i,n=1;if(!l[t]){if("K"!==l[t.slice(1)]&&"kel"!==l[t.slice(1)])return{unit:void 0,prefixNumber:n};for(e=t.slice(0,1),t=t.slice(1),i=0;y[i].$6t;i++)e===y[i].$6t&&(n=y[i]._c)}return{unit:t,prefixNumber:n}}function Fn(t,n,e,i){var r,o;if(""===t&&""===n)return H;if(o={value:0},!0!==W(t,r={value:0})||!0!==W(n,o))return H;if(n=o.value,(t=r.value)<0||Z<t||t%1!=0)return m;if("bitOperator"===e){if(n<0||Z<n||n%1!=0)return m}else if("shiftOperator"===e&&0===t)return 0;return i(t,n)}function Ln(t,n){return Fn(t,n,"bitOperator",function(t,n){return t&n})}function Bn(t,n){return Fn(t,n,"bitOperator",function(t,n){return t|n})}function Pn(t,n){return Fn(t,n,"bitOperator",function(t,n){return t^n})}function Gn(t,n){return Fn(t,n,"shiftOperator",function(t,n){var t;return 48<=n?m:n<0&&t<1<<-n?0:Z<(t=t<<n)?m:t})}function Un(e,i){return Fn(e,i,"shiftOperator",function(t,n){return 53<n?m:0<=i?e>>i:e<<-i})}function N(t,n){var t;return""===t?m:!0===t||!1===t?H:(t=g(t))?n(t):m}function Hn(t){return N(t,function(t){return I($n(t),t.hkt())})}function Vn(t){return N(t,function(t){return oe(Kn(t),S(0,0))?m:I(k(Xn(t),Kn(t)),t.hkt())})}function zn(t){return N(t,function(t){return oe(t,S(0,0))?m:I(ne(t),t.hkt())})}function Yn(t){return N(t,function(t){return oe(qn(t),S(0,0))?m:I(ee(t),t.hkt())})}function Zn(t){return N(t,function(t){return oe(Xn(t),S(0,0))?m:I(ie(t),t.hkt())})}function Wn(t){return N(t,function(t){return oe($n(t),S(0,0))?m:I(re(t),t.hkt())})}function Qn(t){return N(t,function(t){return I(qn(t),t.hkt())})}function Jn(t){return N(t,function(t){return I(te(t),t.hkt())})}function Kn(t){var n,t,n=t.ikt(),t=t.rkt();return S(E(n)*e(t,!1),R(n)*e(t,!0))}function Xn(t){var n,t,n=t.ikt(),t=t.rkt();return S(R(n)*e(t,!1),-(E(n)*e(t,!0)))}function qn(t){var n,t,n=t.ikt(),t=t.rkt();return S(e(n,!0)*R(t),e(n,!1)*E(t))}function $n(t){var n,t,n=t.ikt(),t=t.rkt();return S(e(n,!1)*R(t),e(n,!0)*E(t))}function te(t){return k(Kn(t),Xn(t))}function ne(t){return k(i,Kn(t))}function ee(t){return k(i,qn(t))}function ie(t){return k(i,Xn(t))}function re(t){return k(i,$n(t))}function k(t,n){var e,t,i,n,r,r,e=t.ikt(),t=t.rkt(),i=n.ikt(),n=n.rkt();return Math.abs(n)<Math.abs(i)?S((e+t*(r=n/i))/(i+n*r),(t-e*r)/(i+n*r)):S((t+e*(r=i/n))/(n+i*r),(t*r-e)/(n+i*r))}function oe(t,n){return t.ikt()===n.ikt()&&t.rkt()===n.rkt()}Object.defineProperty(t,"__esModule",{value:!0}),D=n("Common"),d=n("CalcEngine"),h=D.Common.Uf.tR,t=void 0,w=Math.abs,E=Math.sin,R=Math.cos,F=Math.sqrt,L=Math.log,v=Math.pow,j=Math.exp,O=Math.E,r=Math.atan2,B=parseFloat,G=isNaN,U=d.Errors.NotAvailable,m=d.Errors.Number,H=d.Errors.Value,n=d.Functions.F6t,V=d.Functions.dkt,P=d.Convert.L6t,z=d.Convert.BJ,Y=d.Functions.MathHelper,e=Y.vkt,g=d.Functions.mkt,Z=0xffffffffffff,W=d.Convert.sJ,i=S(1,0),K=T(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,o=.00220462262184878,602214179421676e9,.0352739619495804,Q=7e3*o,a=o/100,a,a=o/112,a,a,J=o/14,110231131092439e-20,a=o/2240,a,a]),et=T(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,X=(u=(a=(o=1e4/254)/12)/3)/1760,1/1852,o,a,u,1e10,2834.64566929134,q=o/45,nt=105700083402462e-30,a=324077928966473e-31,$=6*o,tt=.00062136994949495,a,2834.64566929134]),s=T(["yr","day","hr","mn","sec","d","min","s"],[1,u=365.25,it=8766,o=525960,a=60*o,u,o,a]),ot=T(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,rt=.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),ut=T(["N","dyn","lbf","dy","pond"],[1,at=1e5,.22480894309971,1e5,101.971621297793]),st=T(["HP","W","h","w","PS"],[1,u=745.69987158227,1,u,1.013869665424]),ct=T(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,o=.239005736137667,o,a=624150964712042e4,o=1/(3600*u),u=1/3600,.737562149277265,c=.000947817120313317,a,o,u,c]),ft=T(["T","ga"],[1,1e4]),dt=T(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,a=.00492892159375,.00867368942321863,1/96,a,o=1e27*a,o,1/32256,lt=.000139870932189991,u=.00017406322338,u,c=.30078125,c,o=82073596535e-54,o,u=492892159375e-17,u,c=118251117638e-26,c,o=64467860511e-16,o,u=775941468987e-27,u,c=112266,c,c,c,o=1740632233796e-18,o,ht=4351580584491e-18,a]),vt=T(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),pt=T(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,u=10.7639104167097,u,c=144*u,c,o=u/9,o,mt=.000247105381467165,gt=.000247104393046628,1e20,1e20,.01,1e-4,4e-4,a=o/3097600,a,c=2.91553349598123e-7,c,u=8035216.07043214,u,u,u,o=111725076312873e-46,o]),bt=T(["bit","byte"],[1,.125]),f={bit:"bit",byte:"byte"},l={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},wt={day:"day",d:"d",yr:"yr",hr:"hr",mn:"mn",min:"min",sec:"sec",s:"s"},p=273.15,b=459.67,y=T(yt=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Mt=T(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Ct=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],a={J6t:5},c={J6t:8},u={J6t:8,gkt:!0},At=[{J6t:0,pkt:"<= 0"},o={J6t:2,pkt:"< 0"}],It=[M={J6t:0},{J6t:0,bkt:0}],C=[St={J6t:5,pkt:["checkLength 10"]},Tt={ykt:!0,J6t:2,bkt:1,pkt:["< 1","> 10"]}],n("BESSELI",Rt,2,2,o=[M,o]),n("BESSELJ",Ft,2,2,o),n("BESSELK",Lt,2,2,At),n("BESSELY",Bt,2,2,At),n("BIN2DEC",Pt,1,1,St),n("BIN2HEX",Ht,1,2,C,t,t,{wkt:1}),n("BIN2OCT",Vt,1,2,C,t,t,{wkt:1}),n("DEC2BIN",zt,1,2,[{J6t:0,pkt:["< -512","> 511"]},Tt],t,t,{wkt:1}),n("DEC2HEX",Yt,1,2,[{J6t:0,pkt:["< -549755813888","> 549755813887"]},Tt],t,t,{wkt:1}),n("DEC2OCT",Zt,1,2,[{J6t:0,pkt:["< -536870912","> 536870911"]},Tt],t,t,{wkt:1}),n("HEX2BIN",Wt,1,2,C,t,t,{wkt:1}),n("HEX2DEC",Gt,1,1,St),n("HEX2OCT",Jt,1,2,C,t,t,{wkt:1}),n("OCT2BIN",Qt,1,2,C,t,t,{wkt:1}),n("OCT2DEC",Ut,1,1,St),n("OCT2HEX",Kt,1,2,C,t,t,{wkt:1}),n("ERF",Xt,1,2,[M,{ykt:!0,J6t:0}],t,t,{wkt:1}),n("ERF.PRECISE",qt,1,1,M),n("ERFC",$t,1,1,M),n("ERFC.PRECISE",$t,1,1,M),n("DELTA",tn,1,2,It,t,t,{wkt:1}),n("GESTEP",nn,1,2,It,t,t,{wkt:1}),n("COMPLEX",en,2,3,[M,M,{J6t:5,bkt:"i"}],t,t,{wkt:2}),n("IMABS",rn,1,1,c),n("IMAGINARY",on,1,1,c),n("IMARGUMENT",an,1,1,c),n("IMCONJUGATE",un,1,1,c),n("IMCOS",sn,1,1,c),n("IMDIV",cn,2,2,[c,u]),n("IMEXP",fn,1,1,c),n("IMLN",ln,1,1,u),n("IMLOG10",hn,1,1,u),n("IMLOG2",dn,1,1,u),n("IMREAL",mn,1,1,c),n("IMSIN",gn,1,1,c),n("IMSQRT",pn,1,1,c),n("IMSUB",bn,2,2,[c,c]),n("IMPOWER",vn,2,2,[c,{J6t:2}]),n("IMPRODUCT",wn,1,255,t,-1,-1),n("IMSUM",yn,1,255,t,-1,-1),n("CONVERT",Sn,3,3,[{J6t:1},a,a]),n("BITAND",Ln,0,2),n("BITLSHIFT",Gn,0,2),n("BITOR",Bn,0,2),n("BITRSHIFT",Un,0,2),n("BITXOR",Pn,0,2),n("IMCOSH",Hn,1,1),n("IMCOT",Vn,1,1),n("IMCSC",zn,1,1),n("IMCSCH",Yn,1,1),n("IMSEC",Zn,1,1),n("IMSECH",Wn,1,1),n("IMSINH",Qn,1,1),n("IMTAN",Jn,1,1)},"./src/functions-fin.ts":function(F,t,n){var L,d,B,P,G,t,I,A,U,v,H,h,a,V,z,m,T,b,y,x,M,Y,Z,W,Q,J,g,K,N,n,X,q,$,u,p,k,C,tt,nt,et,it,e,i,r,t,o,rt,ot,at,s,ut,st,c,ct,ft,lt,f,ht,dt,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt;function S(t){return t.getMonth()}function _(t){return t.getDate()}function D(t){return t.getFullYear()}function kt(t,n){var e,e,e,e=D(t),e=new Date(e,n,1),e=p(D(e),S(e));_(t)>e&&t.setDate(e),t.setMonth(n)}function j(t){return t instanceof Date?L.Common.ct.o0(t):t}function l(t,n,e){var i,i,r,o,i=D(n)-D(t),i=S(n)-S(t)+12*i,r=_(n)-_(t),o=-1;return 0===e?o=d.Functions.Mkt(t,n):0<=I(e,[1,2,3])?o=j(n)-j(t):4===e&&(o=30*i+r),o}function _t(t,n,e,i,r){var o,a,n,o=y(1+t,n),a=P(o)?o:N;return 0===t?n:!h(a)&&(n=P(o=(o-1)/t)?o:N,!h(n))&&P(o=(-e*a-i)/((1+t*r)*n))?o:N}function w(t,n,e,i){var r,o,a,u,s,c,f,l,r=D(n),o=S(n),a=_(n),u=new Date(1,0,1),s=0,c=a===p(r,o),f=12/e,l=r-D(t);for(u.setFullYear(1),0<l&&(l=(l-1)*e);kt(u=new Date(r,o,a),o-++l*f),c&&(s=p(D(u),S(u)),u=new Date(D(u),S(u),s)),k(t,u)<0;);return i&&(kt(u=new Date(r,o,a),o- --l*f),c)&&(s=p(D(u),S(u)),u=new Date(D(u),S(u),s)),u}function Dt(t,n,e,i){return C(w(t,n,e,!1),t,i)}function O(t,n,e,i){var i,i=0<=I(i,[0,2,4,5])?360/e:3===i?365/e:C(w(t,n,e,!1),w(t,n,e,!0),1);return i}function jt(t,n,e,i){return C(t,w(t,n,e,!0),i)}function Ot(t,n,e){var i,r,n,o,a,i=D(n),r=S(n),n=_(n),o=new Date(i,r,n),a=r-S(t)+12*(i-D(t));if(kt(o,S(o)-a),n===p(i,r))for(;_(o)!==p(D(o),S(o));)o.setDate(_(o)+1);return _(t)>=_(o)&&a--,G((1+a/(12/e)).toString())}function E(t,n,e){return 0<n?(e.Ckt?e.Skt?x(t-e.Tkt)<x(e.Akt-e.Tkt)&&(e.Akt=t,e.Ikt=n):n<e.Ikt&&(e.Akt=t,e.Ikt=n):(e.Akt=t,e.Ikt=n,e.Ckt=!0),[!1,e]):n<0?(e.Skt?e.Ckt?x(t-e.Akt)<x(e.Akt-e.Tkt)&&(e.Tkt=t,e.xkt=n):-n<-e.xkt&&(e.Tkt=t,e.xkt=n):(e.Tkt=t,e.xkt=n,e.Skt=!0),[!1,e]):isNaN(n)?[!1,e]:(e.Nkt=t,[!0,e])}function Et(t,n,e,i,r){var o,a,u,o=w(t,e,i,!0),a=w(t,e,i,!1);if(0<=k(o,n))return C(t,n,r)/O(a,o,i,r);for(u=C(t,o,r)/O(a,o,i,r);;){if(a=new Date(D(o),S(o),_(o)),kt(o,S(o)+12/i),0<=k(o,n))return u+=C(a,n,r)/O(a,o,i,r);u+=1}}function Rt(t,n,e,i,r,o,a){for(var u,s,a,c,f,l,h,d,v,m,g,u=Dt(t,n,o,a),s=jt(t,n,o,a),a=O(t,n,o,a),c=G(Ot(t,n,o).toString()),f=0,l=100*e/o,h=1+i/o,d=s/a,v=0;v<c;v++)f+=l/y(h,d+v);return(m=r/y(h,c-1+s/a))+f-(g=u/a*l)}function Ft(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,e,i,v,m,g,p,b,w,c=C(u,t,a),f=C(t,s,a),l=C(u,s,a),h=O(t,n,o,a),d=G(Ot(t,n,o).toString()),e=100*e/o,i=1+i/o;if(h<f)switch(a){case 0:case 4:v=C(s,n,a),d=1+G(M(v/h).toString());break;default:for(m=new Date(D(s),S(s),_(s)),d=0;d<32767;d++)if(g=new Date(D(m),S(m),_(m)),kt(m,S(m)+12/o),0<=k(m,n)){d+=G((M(C(g,n,a))/O(g,m,o,a)).toString())+1;break}c=h*Et(u,t,s,o,a),f=h*Et(t,s,s,o,a),l=h*Et(u,s,s,o,a)}return(p=r/y(i,d-1+f/h))+e*((b=l/h/y(i,f/h))+(w=y(i,-f/h)*(y(i,-d)-1/i)/(1/i-1))-c/h)}function Lt(t,n){var t,e,t=t.substr(0,3),e={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return e[t]?q(e[t],n):-1}function Bt(t,n,e,i,r){var o,a=y(1+t,n);return 0===t?o=(e+i)/n:(o=i*t/(a-1)+e*t/(1-1/a),0<r&&(o/=1+t)),-o}function Pt(t,n,e,i,r){var o=y(1+t,n),a;return-(0===t?i+e*n:i*o+e*(0<r?1+t:1)*(o-1)/t)}function Gt(t,n,e,i,r,o,a){if(o<r||e<o||0!==a&&1!==a)return N;var u=Bt(n,e,i,0,a),s=0,c,f;for(1===r&&(t&&(s=u),a<=0&&(s+=t?i*n:-i),r++),c=r;c<=o;c++)f=0<a?Pt(n,c-2,u,i,1)-u:Pt(n,c-1,u,i,0),s+=t?u-f*n:f;return t?s:s*n}function Ut(t,n,e,i){var i,t,i=y(1+e,i),t=-(t*i*e+n*(i-1));return P(t)?t:N}function Ht(t,n,e,i,r){return I(i,[1,2,4])<0||0<=k(n,e)?N:t(n,e,i,r)}function Vt(t,n,e,i,r,o){function a(t,n,e,i){var r=0,o,a=0,u=100;for(t*=100/z(e),n/=e,n++,o=1;o<i;o++)r+=o*t/y(n,o);for(r+=i*(t+100)/y(n,i),o=1;o<i;o++)a+=t/y(n,o);return r=(r/=a+=(t+100)/y(n,i))/z(e)}var i;return I(o,[1,2,4])<0||0<k(n,e)?N:(i=a(i,r,o,Ot(n,e,o)),t?i/(1+r/o):i)}function zt(t,n,e,i,r,o,a,u,s){var c,f,i,n;if(I(a,[1,2,4])<0||0<k(n,e)||0<k(i,n))return N;for(c=new Date(D(i),S(i),_(i));kt(c,S(c)+12/a),k(c,e)<0;);return f=Et(i,n,c,a,u),i=Et(i,e,c,a,u),n=Et(n,e,c,a,u),t?(o*a+100*r*(i-f*(1+s*n/a)))/(s*n+a):(a*(o-s)+100*r*(i-f))/(n*s+100*r*f*n/a)}function Yt(t,n,e){var i,r,n,o;return 0===e?g:(i=(n<0?M:W)(n),r=y(10,M(X.ckt(e,10))),n=n-i,a(i+(o=t?n*r/e:n*e/r)))}function Zt(t,n,e,i){var r,o,a,u,s,c,r=v(n),o=0,u=1+t,s=.75<=u&&u<=1.25&&12<r&&i?2.5:0;if(e)for(a=0;a<r;a++){if(c=-(a-s)*n[a]*Math.pow(u,-(a-s)-1),isNaN(c))return o;o+=c}else for(a=0;a<r;a++){if(c=n[a]*Math.pow(u,-(a-s)),isNaN(c))return o;o+=c}return o}function R(t,n,e,i){var r,o,a,u,r=0,o=v(n);for(t<=-1&&(t=1e-10-1),a=0;a<o;a++){if((u=j(i[a])-j(i[0]))<0)return[!1,e];r+=n[a]/X.kkt(t,u/365)}return P(r)?e=isNaN(r)?5e-324:r:r===Number.POSITIVE_INFINITY?e=$:r===Number.NEGATIVE_INFINITY&&(e=-$),[!0,e]}function Wt(t,n,e,i){var r,o,a;return-1<t&&0!==t?(o=y(1+t,(r=e).Dkt-(i?1:0)),a=(y(1+t,r.Dkt)-1)/t,[!0,n=i?-r._kt*a/t+o*r.Dkt*(r.Ekt+r._kt*(r.uit+1/t)):r.Ekt*o+r._kt*(1+t*r.uit)*a+r.jkt,e]):[!1,n,e]}function Qt(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v){var m,g,p,r,b,w,e,y,M,m=0,g=0,p=e-r,r=e+r,b=2===t;if((p=p<o.Okt?e:p)===(r=r>o.Rkt?e:r))return b?[!1,i,o,a]:[!1,i,o];if(e=0===t?(w=n(a,u,s,p,f,l,h,d,v)-c,n(a,u,s,r,f,l,h,d,v)-c):1===t?(w=n(p,a,m,u),n(r,a,g,u)):(w=Wt(p,m,a),Wt(r,g,a)),A(w)){if(M=w[2],m=w[1],!(y=w[0]))return b?[y,i,o,M]:[y,i,o]}else m=w;if(A(e)){if(M=e[2],g=e[1],!(y=e[0]))return b?[y,i,o,M]:[y,i,o]}else g=e;return i=(g-m)/(r-p),b?[!0,i,o,M]:[!0,i,o]}function Jt(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,t;return i<e.Okt||i>e.Rkt?[!1,e]:(e=(t=E(i,d=t?Zt(i,r):n(r,o,a,i,s,c,f,l,h)-u,e))[1],[!!t[0],e])}function Kt(t,n,e,i,r){if(!(n>t.Rkt)){var i=R(n,i,e,r);if(e=i[1],!i[0])return i[0];t=(i=E(n,e,t))[1],i[0]}}function Xt(t,n,e){var i,r,n,i=0;return n<t.Okt||n>t.Rkt?[!1,t,e]:(e=(r=Wt(n,0,e))[2],i=r[1],r[0]?(t=(n=E(n,i,t))[1],[!!n[0],t,e]):[r[0],t,e])}function qt(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v,m,g,p,l=0,h=t?15:2;if(e.Ckt&&e.Skt)for(d=x(e.Akt-e.Tkt)/(x(e.Akt)+x(e.Tkt)),f=0;f<100+4*h;f++)if(g=void(m=v=0),g=f%4==0?1:f%4==2?2:3,p=void 0,e=(p=t?an(e,i,d,l,0,g):n?un(!0,e,l,0,0,g,R,d,r,i,Qt):un(!1,e,l,0,0,g,Rt,d,o,a,u,i,r,s,c))[1],t&&(i=p[2]),l=t?p[3]:p[2],p[0])return t?[!0,e,i]:[!0,e];return t?[!1,e,i]:[!1,e]}function $t(t,n,e,i,r,o,a,u,s,c,f){var l,h,d,v,m,g,p,p,p,d=0,v=t?15:2;if(n.Ckt&&n.Skt)for(h=x(n.Akt-n.Tkt)/(x(n.Akt)+x(n.Tkt)),l=0;l<100+4*v;l++)if(p=void(g=m=0),p=l%4==0?1:l%4==2?2:3,n=(p=t?un(!0,n,d,m,g,p,Zt,h,b,e,Qt):un(!1,n,d,m,g,p,Ft,h,a,u,s,e,i,c,f,r,o))[1],d=p[2],m=p[3],!(t&&p[0]===T||!t&&U(p[0]))){if(p[0])return[!0,n];if(n=(p=E(m,g=t?Zt(m,e):Ft(e,i,a,m,s,c,f,r,o)-u,n))[1],p[0])return[!0,n];if((h=x(n.Akt-n.Tkt)/(x(n.Akt)+x(n.Tkt)))<n.Bkt)return n.xkt<g&&(g=n.xkt,m=n.Tkt),n.Ikt<g&&(m=n.Akt),n.Nkt=m,[!0,n]}return[!1,n]}function tn(t,n,e,i,r,o,a,u,s,c,f,l,h){for(var d,v,m,g,p,b,w,w,y,y,M,y,w,M,w,C,d,S,T,C,g=e.Bkt/2,b=!1,v=0;v<20;v++){if(i<e.Okt||i>e.Rkt){if(!t||e.Skt&&e.Ckt||!(i<=-1))return[!1,e];i=-1,b=!0}if(w=t?R(i,r,0,o):n(r,o,a,i,s,c,f,l,h)-u,A(w)){if(p=w[1],!(m=w[0]))return[m,e]}else p=w;if(e=(w=E(i,p,e))[1],w[0])return[!0,e];if(b)return[!1,e];if(y=e.Skt&&e.Ckt?x(e.Akt-e.Tkt):e.Rkt-e.Okt,y=(x(i)<1e-10?y:x(i))/1e6,M=0,e=(w=t?Qt(1,R,i,0,y,e,r,o):Qt(0,n,i,0,y,e,r,o,a,u,s,c,f,l,h))[2],M=w[1]<0?w[1]:-w[1],!(m=w[0]))return[m,e];if(0===M)return[!1,e];if((y=i-1.000001*p/M)===i)return e.Nkt=i,[!0,e];if(t&&e.Skt&&e.Ckt&&y<(M=(w=[e.Akt,e.Tkt])[0])==y<(w=w[1])&&(C=!0,w<M&&(M=(d=[w,M])[0],w=d[1],C=!1),S=(d=[e.Ikt,e.xkt])[0],T=d[1],y=M+x((C?S:T)/(T-S))*(w-M)),C=x(y-i)/(x(i)+x(y)),i=y,C<g)return e.Nkt=i,[!0,e]}return[!1,e]}function nn(t,n,e){for(var i,r,o,e,a,u,s,c,f,i=t.Bkt/2,r=0;0===n[r];)r++;for(o=n.slice(r),a=[!1,null],u=[e],.1!==e&&u.push(.1),u.push(-.1,.99*t.Rkt,t.Okt+.01),s=0;!a[0]&&s<u.length;s++)en(a=rn(B(t),o,u[s],i),o);if(!a[0]){for(c=0,s=1,f=o.length;s<f;s++)c+=o[s];e=-c/o[0]-1,a=rn(B(t),o,e,i)}return a}function en(t,n){var e,i,r,r;t[0]&&(i=15,"number"==typeof(e=t[1].Nkt)&&-10<e&&e<10&&(1<(r=e.toString()).indexOf("000000000000")||1<r.indexOf("999999999999"))&&(i=14),.001<(r=fn(e=L.Common.st.E8(e,i),n))||r<-.001)&&(t[0]=!1)}function rn(t,n,e,i){for(var r,o,a,a,o,a,r=0;r<32;r++){if(e<t.Okt||e>t.Rkt)return[!1,t];if(t=(a=E(e,o=Zt(e,n,!1,!0),t))[1],a[0])return[!0,t];if(0===(a=Zt(e,n,!0,!0)))return[!1,t];if((o=e-1.0000001*o/a)===e)return t.Nkt=e,[!0,t];if(a=x(o-e)/(x(e)+x(o)),e=o,a<i)return t.Nkt=e,[!0,t]}return[!1,t]}function on(t,n,e){for(var i,r,o,a,u,s,c,f,l,r=t.Bkt/2,i=0;i<100;i++){if(u=a=o=void 0,e<t.Okt||e>t.Rkt)return[!1,t,n];if(n=(f=Wt(e,c=s=0,n))[2],s=f[1],!(u=f[0]))return[u,t,n];if(t=(l=E(e,s,t))[1],l[0])return[!0,t,n];if(n=(f=Wt(e,0,n,!0))[2],c=f[1],!(u=f[0]))return[u,t,n];if(0===c)return[!1,t,n];if((o=e-1.000001*s/c)===e)return t.Nkt=e,[!0,t,n];if(a=x(o-e)/(x(e)+x(o)),e=o,a<r)return t.Nkt=e,[!0,t,n]}return[!1,t,n]}function an(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,e,r;if(1===o){if(s=void 0,n=(c=Wt(a=(t.Akt+t.Tkt)/2,r,n))[2],r=c[1],!(u=c[0]))return[T,t,n,i];if(0===r)return[!0,t=E(a,r,t)[1],n,i];if(0===(s=Z(r*r-t.Ikt*t.xkt)))return[T,t,n,i]}else if(2===o){if(l=f=void 0,d=h=0,.1<e)return an(t,n,e,i,r,o=3);if(e=i%4,i++,0==e)f=t.Akt,h=t.Ikt;else if(2==e)f=t.Tkt,h=t.xkt;else if(n=(c=Wt(f=(t.Akt+t.Tkt)/2,h,n))[2],h=c[1],!(u=c[0]))return[T,t,n,i];if(n=(r=Qt(2,void 0,f,0,l=x(t.Akt-t.Tkt)/1e6,t,n))[3],t=r[2],d=r[1],!(u=r[0])||0===d)return[T,t,n,i];if((a=f-1.01*h/d)<t.Akt&&a<t.Tkt||a>t.Akt&&a>t.Tkt)return[T,t,n,i]}return[!1,t,n,i]}function un(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g){var p,b,b,w,y,M,C,C,S;switch(o){case 0:i=n.Akt-n.Ikt*((n.Tkt-n.Akt)/(n.xkt-n.Ikt));break;case 1:if(i=(n.Akt+n.Tkt)/2,p=t?a(i,c,r,s):a(l,h,s,i,f,d,v,m,g)-c,A(p)){if(r=p[1],!p[0])return[T,n,e,i,r,o]}else r=p;if(0===r)return[!0,n=E(i,r,n)[1],e,i,r,o];if(0===(b=Z(r*r-n.Ikt*n.xkt)))return[T,n,e,i,r,o];i+=(i-n.Akt)*r/b;break;case 3:i=(n.Akt+n.Tkt)/2;break;case 2:if(b=void 0,y=void(w=0),M=0,.1<u)return un(t,n,e,i,r,o=3,a,u,s,c,f,l,h,d,v);if(C=e%4,e++,0==C)b=n.Akt,w=n.Ikt;else if(2==C)b=n.Tkt,w=n.xkt;else if(b=(n.Akt+n.Tkt)/2,p=t?a(b,c,w,s):a(l,h,s,b,f,d,v,m,g)-c,A(p)){if(w=p[1],!p[0])return[T,n,e,i,r,o]}else w=p;if(y=x(n.Akt-n.Tkt)/1e6,n=(C=t?f(1,a,b,0,y,n,c,s):Qt(0,a,b,0,y,n,l,h,s,c,f,d,v,m,g))[2],M=C[1],!C[0]||0===M)return[T,n,e,i,r,o];if((i=b-1.01*w/M)<n.Akt&&i<n.Tkt||i>n.Akt&&i>n.Tkt)return[T,n,e,i,r,o]}return p=t?a(i,c,r,s):a(l,h,s,i,f,d,v,m,g)-c,A(p)&&(r=p[1],!p[0])?[T,n,e,i,r,o]:(S=E(i,r,n))[0]?[!0,n,e,i,r,o]:(u=x(n.Akt-n.Tkt)/(x(n.Akt)+x(n.Tkt)))<n.Bkt?(n.xkt<r&&(r=n.xkt,i=n.Tkt),n.Ikt<r&&(r=n.Ikt,i=n.Akt),n.Nkt=i,[!0,n,e,i,r,o]):[!1,n,e,i,r,o]}function sn(t,n,e,i,r){r=r?1:0;var o=y(1+t,n),o;return a(-(o=0===t?e*n+i:i*o+e*(1+t*r)*(o-1)/t))}function cn(t,n){for(var e=0;e<v(n);e++)n[e]!==m&&(t*=1+n[e]);return t}function fn(t,n){for(var e,i,r,o,a,u,e=arguments,i=0,r=1,a=1;a<v(e);a++){if((u=V(e[a],1,!0,!0,!1,!0)).isError)return u[0];for(o=0;o<v(u);o++)u[o]!==m&&(i+=u[o]/y(1+t,r),r++)}return i}function ln(t,n,e,i,r){var n;return r=r?1:0,0===t?a(-(e*n+i)):(n=y(1+t,n),-1===t?g:a(-(i+e*(1+t*r)*(n-1)/t)/n))}function hn(t,n,e,i,r){var n,t,r;return 0<=k(t,n)||(n=l(t,n,r),t=u(t,r),n<=0)||t<=0||(r=1-i*n/t)<=0?N:e/r}function dn(t,n,e){var i=v(n),r,o=0,a;if(i!==v(e))return N;if(n.some(function(t){return t===m}))return K;for(a=0;a<i;a++)o+=n[a]/y(1+t,(e[a]-e[0])/365);return o}function vn(t,n,e,i,r,o){return Gt(!1,t,n,e,i,r,o)}function mn(t,n,e,i,r,o){return Gt(!0,t,n,e,i,r,o)}function gn(t,n,e,i,r,o){var a;return e+1<=n||0!==o&&1!==o?N:Ut(i,_t(t,e,i,r,o),t,n-1)}function pn(t,n,e,i){return a(i*t*(n/e-1))}function bn(t,n,e,i,r){r=r?1:0;var o=y(1+t,n),o;return a(-(o=0===t?(e+i)/n:(e*o+i)/((1+t*r)*(o-1)/t)))}function wn(t,n,e,i,r,o){var e,r;return o=o?1:0,e+1<=n||(e=_t(t,e,i,r,o),h(e))||(r=Ut(i,e,t,n-1),h(r))?N:e-r}function yn(t,n,e,i){return Ht(Dt,t,n,e,i)}function Mn(t,n,e,i){return Ht(O,t,n,e,i)}function Cn(t,n,e,i){return Ht(jt,t,n,e,i)}function Sn(t,n,e){return j(w(t,n,e,!0))}function Tn(t,n,e){return Ht(Sn,t,n,e)}function An(t,n,e){return Ht(Ot,t,n,e)}function In(t,n,e){return j(w(t,n,e,!1))}function xn(t,n,e){return Ht(In,t,n,e)}function Nn(t){var n;return p(t.getFullYear(),t.getMonth())===t.getDate()}function kn(t,n,e,i,r,o){var a,u,n,s,c,f,l,h,d,v,m,g;if(I(r,[1,2,4])<0||0<k(t,n))return N;for(a=Ot(t,n,r),u=O(t,n,r,o),n=w(t,n,r,!1),s=C(n,t,o),0===o&&31===t.getDate()&&1===n.getMonth()&&Nn(n)&&s++,d=(h=100/(l=y(1+i/r,a-1+(f=(c=u-s)/u))))*(a-1+f),v=0;v<a;v++)h+=g=100*e/(r*y(1+i/r,m=v+f)),d+=g*m;return d/h/r}function _n(t,n,e,i,r){return i<0||e<0?N:Vt(!0,t,n,e,i,r)}function Dn(t,n,e,i,r){return r=r?1:0,0===t?0===n?g:a(-(e+i)/n):a(Y((n*(1+t*r)-i*t)/(e*t+n*(1+t*r)))/Y(1+t))}function jn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,f,v,m,s;if(I(o,[1,2,4])<0||0<k(t,n))return N;if((u=Ot(t,n,o))<=1)return s=Dt(t,n,o,a),c=jt(t,n,o,a),(h=r/100+e/o-(i/100+s/(f=O(t,n,o,a))*e/o))/(d=i/100+s/f*e/o)*(l=o*f/c);if(m=(s=tn(!(m={Okt:0,Rkt:1e3,Bkt:1e-10,Ckt:!(v=.1),Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0}),Rt,m,v,t,n,e,i,r,o,a))[1],!(f=s[0])){for(v=1e-10;v<m.Rkt;v*=2)m=Jt(!1,Rt,m,v,t,n,e,i,r,o,a)[1];m=(s=qt(!1,!1,m,t,n,e,i,r,o,a))[1],f=s[0]}return f?m.Nkt:N}function On(t,n,e,i,r){return 0<=k(t,n)?N:(i/e-1)/tt(t,n,r)}function En(t,n,e,i,r,o){var a,u,s,c;return 0<=k(t,n)?N:(c=1+(a=tt(e,n,o))*i,c/=r/100+(u=tt(e,t,o))*i,c--,c/tt(t,n,o))}function Rn(t,n,e,i,r,o,a){function u(t,n,e,i,r,o,a){var u,s,c,f,s,s,l,s=1/o,s=s<3?1:s<5?1.5:s<=6?2:2.5;if(o*=s,s=tt(n,e,a),h(s))return 0;for(f=(t-=c=W(s*o*t+.5))-i,u=0;u<r;u++){if((f-=c=W(o*t+.5))<0)return 0==(l=r-u)||1==l?W(.5*t+.5):0;t-=c}return c}var s=1/o;return 0<s&&s<1||1<s&&s<2||2<s&&s<3||4<s&&s<5||0<k(n,e)?N:u(t,n,e,i,r,o,a)}function Fn(t,n,e,i,r,o,a){function u(t,n,e,i,r,o,a){var u,s,n,e,a,i,c,u=t*o,s=t-i,n=tt(n,e,a);return h(n)?0:(i=H(a=(t-i-(e=n*o*t))/u),0===r?e:r<=i?u*(a<1?a:1):r===i+1?s-u*i-e:0)}return 0<k(n,e)?N:u(t,n,e,i,r,o,a)}function Ln(t,n,e,i,r,o,a,u,s){var c,f,l,h,c=.1;if(I(u,[1,2,4])<0||0<k(e,t)||0<k(t,i)||0<k(i,n))return N;if(f=(l=tn(!(f={Okt:0,Rkt:1e3,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0}),Ft,f,c,t,n,r,o,a,u,s,e,i))[1],h=l[0]){for(c=1e-10;c<f.Rkt;c*=2)f=Jt(!1,Ft,f,c,t,n,r,o,a,u,s,e,i)[1];f=(l=$t(!1,f,t,n,e,i,r,o,a,u,s))[1],h=l[0]}return h?f.Nkt:N}function Bn(t,n,e,i,r,o,a,u){return zt(!1,t,n,e,i,o,a,u,r)}function Pn(t,n,e,i,r,o,a,u){return zt(!0,t,n,e,i,o,a,u,r)}function Gn(t,n,e){var i,r,t,i=j(n)-j(t);return 0<=k(t,n)||365<i?N:0==(t=360-e*i)?g:t<0?N:a((r=365*e)/t)}function Un(t,n,e){var i=j(n)-j(t);return 0<=k(t,n)||365<i?N:(100-e)/e*(360/i)}function Hn(t,n){var e,i,r,o,a,u,s,c,f,n,e=v(t),i=[],r=!1,o=!1,a={Okt:-1,Rkt:9999999,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0};for(1<x(n)&&(n=.1),u=-1,c=s=0;c<e;c++)(f=t[c])!==m&&(0!==f&&(s=i.length+1,-1===u)&&(u=i.length),i.push(f),0<f&&(r=!0),f<0)&&(o=!0);return i=i.slice(u,s+1),r&&o&&!(v(i)<2)&&(a=(n=nn(a,i,n))[1],n[0])?a.Nkt:N}function Vn(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i=0,r=0,o=0,a=0,u=0,s=[],c=v(t);if(c<2)return g;for(f=0;f<c;f++)(l=t[f])!==m&&(s.push(l),o++,0!==l)&&(0<l?i++:r++);if(r<1||i<1)return g;for(h=0;h<o;h++)0!==(d=s[h])&&(0<d?a+=d/y(1+e,h):u+=d/y(1+n,h));return 0===u||0===a||e<=-1?g:y(-a*y(1+e,o)/(u*(1+e)),1/(o-1))-1}function zn(t,n,e,i){for(var r,o,a,u,s,r=.5,o=e-.5,a=e+.5,u=0,s=0;0<R(o,t,0,n)[1]*R(a,t,0,n)[1]&&u<i;)u++,o-=.5,a+=.5;return i<=u?[0,0]:[o,a]}function Yn(t,n,e,i){for(var r,o,i,a,u,s,c,f,l,h,r=100,o=i.Bkt,i=i.Skt&&i.Ckt?[i.Akt,i.Tkt]:zn(t,n,e,100),a=i[0],u=i[1],s=R(a,t,0,n)[1],c=R(u,t,0,n)[1],f=0,l=0;l<100&&!(0<s*c);l++)if((h=R(f=(a+u)/2,t,0,n)[1])*s<0?(u=f,c=h):(a=f,s=h),x(a-u)<o)return[!0,f];return[!1,f]}function Zn(t,n,e){var i,r,o,a,u,s,c,f,l,h,h,h,i=v(t),r;if(i!==v(n))return N;if(1===i)return d.Errors.NotAvailable;for(u=i-1;0<=u;u--)o=0<t[u]||o,a=t[u]<0||a,n[u]===m&&(0!==t[u]?n[u]=0:(t.splice(u,1),n.splice(u,1)));if(!o||!a)return N;for(s=!0,c=t[0],i=v(t),u=1;u<i;u++)s=s&&n[u-1]===n[u],c+=t[1];return 0===c?et:s?N:0===(f=t[0])?0===e?it:et:(l=(h=tn(!0,Qt,l={Okt:-1,Rkt:1e10,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0},e,t,n))[1],h[0]?(h=l.Nkt,Math.abs(h)<l.Bkt?et:h):(h=Yn(t,n,e,l))[0]?h[1]:N)}function Wn(t,n,e,i,r,o){var a,u,s,c,a,f;if(r=r?1:0,a=y(17976931348623157e282,1/t),s=(c=on(u={Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0,Okt:Q(-1e10,1-a),Rkt:J(1e10,a-1)},s={Dkt:t,_kt:n,Ekt:e,jkt:i,uit:r},o))[2],u=c[1],!(a=c[0])){for(f=2;(!u.Skt||!u.Ckt)&&f<100;f*=2)s=(c=Xt(u,o*f,s))[2],s=(c=Xt(u=c[1],o/f,s))[2],u=c[1];u=(c=qt(!0,!1,u,s))[1],a=c[0]}return a?u.Nkt:N}function Qn(t,n,e,i,r){var r,e,t,r=r/e,e=1<=r?(r=1)===i?t:0:t*y(1-r,i-1),t=t*y(1-r,i),r=e-(t<n?n:t);return r<0?0:r}function Jn(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,a=0,u=0,s=M(r),c=s,f=t-n,l=!1,v=1;v<=c;v++)l?d=u:(h=Qn(t,n,e,v,o))<(u=f/(i-(v-1)))?(d=u,l=!0):f-=d=h,v===c&&(d*=r+1-s),a+=d;return a}function Kn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,a,v,u=W(i),s=u,c=M(r),f=c,l=0;if(a)for(h=s+1;h<=f;h++)d=Qn(t,n,e,h,o),h===s+1?d*=J(r,u+1)-i:h===f&&(d*=r+1-c),l+=d;else a=e,v=void 0,i!==W(i)&&1<o&&e/2<=i&&(v=i-e/2,i=e/2,r-=v,a+=1),t-=Jn(t,n,e,a,i,o),l=Jn(t,n,e,e-i,r-i,o);return l}function Xn(t,n,e,i,r,o,a){return r<i||e<i||e<r?N:t<n&&0===i&&1===r?t-n:Kn(t,n,e,i,r,o,a)}function qn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A;if(I(o,[1,2,4])<0||0<=k(t,e))return N;if(1===o||0===a||4===a)return $n(t,n,e,i,r,o,a);for(u=t.getFullYear(),s=t.getMonth(),c=t.getDate(),f=e.getFullYear(),l=e.getMonth(),h=e.getDate(),d=n.getMonth(),v=n.getDate(),m=[],g=[],p=[],b=[31,28,31,30,31,30,31,31,30,31,30,31],w=0;w<o;w++)m[w]=(d+12*w/o)%12,g[w]=v<=b[m[w]]?v:b[m[w]],2===a?p[w]=360/o:3===a&&(p[w]=365/o);for(w=0;w<o;w++)M=m[w]<m[y=w===o-1?0:w+1]?2001:2002,p[w]=j(new Date(M,m[y],g[y]))-j(new Date(2001,m[w],g[w]));for(C=0,S=j(e);u<f||u===f&&s<l||u===f&&s===l&&c<h;){for(w=0;w<o&&(s<m[w]||s===m[w]&&c<g[w])&&(0===w||m[w-1]<m[w]);)w++;for(;w<o&&(m[w]<s||s===m[w]&&g[w]<=c)&&(s!==m[++w-1]||c!==g[w-1]););y=--w===o-1?0:w+1,M=12<=s+12/o?u+1:u,T=j(new Date(u,s,c)),C+=r*i/o*((A=Math.min(j(new Date(M,m[y],g[y])),S))-T)/p[w],u=M,s=m[y],c=g[y]}return C}function $n(t,n,e,i,r,o,a){var e=l(t,e,a),t=u(t,a);return e<0||t<=0?N:r*i*(e/t)}function te(t,n,e,i,r){var n,t;return 0<k(t,n)||(n=l(t,n,r),t=u(t,r),n<0)||t<=0?N:i*e*n/t}function ne(t,n,e,i,r){var o,t;return 0<=k(t,n)||(o=u(t,r),(t=l(t,n,r))<=0)||o<=0?N:(i-e)/i*(o/t)}function ee(t,n){return y(1+t/n,n)-1}function ie(t,n,e,i,r){var n,t;return 0<=k(t,n)||(n=l(t,n,r),t=u(t,r),n<=0)||t<=0?N:(i-e)/e*(t/n)}function re(t,n){return n*(y(1+t,1/n)-1)}function oe(t,n,e,i,r){var o,a,u,s,c,o;if(e+(r<12?1:0)<i)return N;if(0===t)return 0;for(a=q(1-y(n/t,1/e),3),s=u=0,c=1;c<=i;c++)u+=s=1===c?t*a*r/12:c===e+1?(t-u)*a*(12-r)/12:(t-u)*a;return s}function ae(t,n,e,i,r){var o,a,u,o=0,a=0;if(e<i)return N;if(t<=n)return 0;for(u=1;u<=i;u++)o+=a=J(a=r/e*(t-o),t-o-n);return a}function ue(t,n,e){return(t-n)/e}function se(t,n,e,i){return e<i?N:(t-n)*(e-i+1)*2/(e*(e+1))}function ce(t,n){return n<1?g:Yt(!0,t,n)}function fe(t,n){return 0===n?g:Yt(!1,t,n)}function le(t,n,e,i,r,o,a){return I(o,[1,2,4])<0||0<k(t,n)?N:Rt(t,n,e,i,r,o,a)}function he(t,n,e,i,r){var n,t;return 0<=k(t,n)||(n=l(t,n,r),t=u(t,r),n<=0)||t<=0?N:i-e*i*n/t}function de(t,n,e,i,r,o){var a,n,e,t,o;return 0<=k(t,n)||(a=l(t,n,o),n=l(e,n,o),e=l(e,t,o),t=u(t,o),e<=0)||t<=0||a<=0||n<=0||0==(o=1+a/t*r)?N:(100+n/t*i*100)/o-e/t*i*100}function ve(t,n,e,i,r,o,a,u,s){return I(u,[1,2,4])<0||0<k(e,t)||0<k(t,i)||0<k(i,n)?N:Ft(t,n,r,o,a,u,s,e,i)}function me(t,n,e){var i=j(n)-j(t);return 0<=k(t,n)||365<i?N:100*(1-e*i/360)}function ge(t){var t=Lt(t,2);return 0<=t?t:N}function pe(t,n,e,i,r){var o,r,n,e;function a(t){var t,n,t=t.substr(0,3),n;return 0<=I(t,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])?0:2}function u(t){var t,n,t=t.substr(0,3),n;return 0<=I(t,["BEF","LUF","ESP","ITL","LUX"])?0:2}return o=0,i||(o=u(e)),r.ekt||(r.y4=a(n)),n=Lt(n,r.y4),e=Lt(e,r.y4),0<=n&&0<=e?(r=t*e/n,i?r:q(r,o)):K}function be(t,n,e,i){var r,o,a;return(""!==t||""!==n||""!==e)&&(t=nt(t,r={value:0}),n=nt(n,o={value:0}),e=nt(e,a={value:0}),!0===t)&&!0===n&&!0===e?i(r,o,a):K}function we(t,n,e){return be(t,n,e,function(t,n,e){var e,n;return 0<n.value&&0<t.value&&0<e.value?(e=(Math.log(e.value)-Math.log(n.value))/Math.log(1+t.value),(n=Math.abs(e))<=179769e303?22250738585072014e-324<=n?e:0:g):N})}function ye(i,t,n){return be(i,t,n,function(t,n,e){if(0<n.value&&0<t.value&&0<=e.value){i=Math.pow(e.value/n.value,1/t.value)-1;var e=Math.abs(i);if(e<=179769e303)return 22250738585072014e-324<=e?i:0}return N})}Object.defineProperty(t,"__esModule",{value:!0}),L=n("Common"),d=n("CalcEngine"),B=L.Common.lt.tv,P=isFinite,G=parseInt,t=L.Common.lt,I=t.Rh,A=t.Nh,U=t.ht,v=L.Common.Uf.tR,H=d.Convert.z6t,h=d.Convert.BJ,a=d.Convert.L6t,V=d.Convert.iV,z=d.Convert.uJ,m=d.Convert.CalcConvertedError,T=null,b=void 0,y=Math.pow,x=Math.abs,M=Math.ceil,Y=Math.log,Z=Math.sqrt,W=Math.floor,Q=Math.max,J=Math.min,g=d.Errors.DivideByZero,K=d.Errors.Value,N=d.Errors.Number,n=d.Functions.F6t,X=d.Functions.MathHelper,q=X.Lkt,$=d.Functions.B6t,u=d.Functions.Fkt,p=d.Functions.Pkt,k=d.Functions.Gkt,C=d.Functions.Ukt,tt=d.Functions.Hkt,nt=d.Convert.sJ,et=2.98023223876953e-9,it=4.88281e-9,t={J6t:0,pkt:"< 1"},o={J6t:0,pkt:"< 0"},rt={bkt:.1,J6t:0},ot={bkt:2,J6t:0},at={bkt:1e3,J6t:0,pkt:"<= 0"},st={bkt:!(ut={J6t:5}),J6t:7},lt={bkt:0,J6t:2},dt={J6t:2,pkt:"= 0",zkt:g},mt={J6t:4,X6t:1,Vkt:!0,Ykt:!0},gt={J6t:4,X6t:1,Vkt:!0,Zkt:!0,Ykt:!0},pt={J6t:4,X6t:4,Vkt:!0,Ykt:!0,Zkt:!0,breakOnConvertError:!0},bt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,breakOnConvertError:!0},wt={J6t:4,X6t:11,Vkt:!0,Ykt:!0,breakOnConvertError:!0},yt=[s={J6t:6},s,c={J6t:2},f={bkt:0,J6t:2,pkt:["< 0","> 4"]}],Mt=[s,s,e={J6t:0},e,c,f],Ct=[s,s,r={J6t:0,pkt:"<= 0"}],St=[e,s,s,e,c,r,ht={bkt:0,J6t:2,pkt:["< 0","> 4","= 2"]}],At=[s,s,r,r,f],It=[r,ct={J6t:2,pkt:"<= 0"},r,ft={J6t:2,pkt:"< 1"},c,c],xt=[r,ft],Nt=[e,vt={J6t:2,pkt:"< 0"}],n("FV",sn,3,5,Tt=[e,e,e,i={bkt:0,J6t:0},i],b,b,{wkt:[3,4]}),n("FVSCHEDULE",cn,2,2,[e,mt],1,1),n("NPV",fn,2,b,e,"> 0","> 0"),n("PV",ln,3,5,Tt,b,b,{wkt:[3,4]}),n("RECEIVED",hn,4,5,At,b,b,{wkt:3}),n("XNPV",dn,3,3,[e,bt,bt],"!= 0","!= 0"),n("CUMIPMT",vn,6,6,It),n("CUMPRINC",mn,6,6,It),n("IPMT",gn,4,6,[e,t,t,e,i,lt],b,b,{wkt:[4,5]}),n("ISPMT",pn,4,4,[e,c,dt,e]),n("PMT",bn,3,5,[e,{J6t:0,pkt:"= 0",zkt:g},e,i,i],b,b,{wkt:[3,4]}),n("PPMT",wn,4,6,[e,t,e,e,i,i],b,b,{wkt:[4,5]}),n("COUPDAYBS",yn,3,4,yt,b,b,{wkt:3}),n("COUPDAYS",Mn,3,4,yt,b,b,{wkt:3}),n("COUPDAYSNC",Cn,3,4,yt,b,b,{wkt:3}),n("COUPNCD",Tn,3,4,yt,b,b,{wkt:3}),n("COUPNUM",An,3,4,yt,b,b,{wkt:3}),n("COUPPCD",xn,3,4,yt,b,b,{wkt:3}),n("DURATION",kn,5,6,Mt,b,b,{wkt:5}),n("MDURATION",_n,5,6,Mt,b,b,{wkt:5}),n("NPER",Dn,3,5,[{J6t:0,pkt:"<= -1"},e,e,i,i],b,b,{wkt:[3,4]}),n("YIELD",jn,6,7,[s,s,o,r,r,c,f],b,b,{wkt:6}),n("YIELDDISC",On,4,5,[s,s,r,r,f],b,b,{wkt:3}),n("YIELDMAT",En,5,6,[s,s,s,o,r,f],b,b,{wkt:5}),n("AMORDEGRC",Rn,6,7,St,b,b,{wkt:6}),n("AMORLINC",Fn,6,7,St,b,b,{wkt:6}),n("ODDFYIELD",Ln,8,9,[s,s,s,s,o,r,r,c,f],b,b,{wkt:8}),n("ODDLYIELD",Bn,7,8,[s,s,s,o,r,r,e,f],b,b,{wkt:7}),n("ODDLPRICE",Pn,7,8,[s,s,s,o,o,r,c,f],b,b,{wkt:7}),n("TBILLEQ",Gn,3,3,Ct),n("TBILLYIELD",Un,3,3,Ct),n("IRR",Hn,1,2,[gt,rt],0,0,{wkt:1}),n("MIRR",Vn,3,3,[gt,e,e],0,0),n("XIRR",Zn,2,3,[wt,pt,rt],"!= 2","!= 2",{wkt:2}),n("RATE",Wn,3,6,[r,e,e,i,{bkt:0,J6t:2,pkt:"< 0",zkt:K},rt],b,b,{wkt:[3,4,5]}),n("VDB",Xn,5,7,[o,o,vt,o,o,ot,st],b,b,{wkt:[5,6]}),n("ACCRINT",qn,6,8,[s,s,s,r,at,c,f],b,b,{wkt:[4,6,7]}),n("ACCRINTM",te,3,5,[s,s,r,at,f],b,b,{wkt:[3,4]}),n("DISC",ne,4,5,[s,s,r,r,f],b,b,{wkt:3}),n("EFFECT",ee,2,2,xt),n("INTRATE",ie,4,5,At,b,b,{wkt:3}),n("NOMINAL",re,2,2,xt),n("DB",oe,4,5,[o,e,ft,ft,{bkt:12,J6t:2,pkt:["< 1","> 12"]}],b,b,{wkt:3}),n("DDB",ae,4,5,[o,e,ct,ct,{bkt:2,J6t:0,pkt:"<= 0"}],b,b,{wkt:3}),n("SLN",ue,3,3,[e,e,dt]),n("SYD",se,4,4,[e,o,ft,ct]),n("DOLLARDE",ce,2,2,Nt),n("DOLLARFR",fe,2,2,Nt),n("PRICE",le,6,7,[s,s,o,o,r,c,f],b,b,{wkt:6}),n("PRICEDISC",he,4,5,At,b,b,{wkt:3}),n("PRICEMAT",de,5,6,[s,s,s,o,o,f],b,b,{wkt:5}),n("ODDFPRICE",ve,8,9,[s,s,s,s,o,o,r,c,f],b,b,{wkt:8}),n("TBILLPRICE",me,3,3,[s,s,r]),n("EURO",ge,1,1,ut),n("EUROCONVERT",pe,3,5,[e,ut,ut,st,{ykt:!0,J6t:2,bkt:3,pkt:"< 3",zkt:K}],b,b,{wkt:[3,4]}),n("PDURATION",we,3,3),n("RRI",ye,3,3)},"./src/functions-lookup.ts":function(b,t,n){var e,r,I,w,y,M,L,t,d,B,C,P,S,G,v,x,T,A,o,U,N,k,H,_,D,V,p,z,Y,u,n,a,j,Z,W,Q,J,s,K,c,X,q,$,tt,nt,t,i,e,et,f,it,rt,ot,l,h,at,ut,st;function ct(t,n,e){return t&&1===n&&1===e&&null===t[0][0]}function ft(t){return N(t)||k(t)||Array.isArray(t)}function lt(t,n,e,i){return{row:t,col:n,rowCount:e,colCount:i}}function O(t,n,e){var i,r;return C(t)?w:t.isArray||t.isReference?((i=t.colCount)<n&&(r=n,n=e,e=r),t[e*i+n]):t[0]}function E(t,n,e,i){return e&&(null===t||null===n)||!C(n)&&((C(t)||o(t,!0))&&o(n,!0)||a(t)&&a(n)||i&&(j(t)&&o(n)||j(n)&&o(t))||j(t)&&j(n))}function ht(t,n,e,i,r){if(t<0||n<0||n<t||e<t||n<e)return-1;if(r)Q=t,J=n,K=s=e,X=c=i;else if(c){if(J<++s){if(c!==X)return-1;s=K-1,c=!1}}else if(--s<Q){if(c!==X)return-1;s=K+1,c=!0}return s}function dt(t,n,e){var t=B(t),e=e;return t===n?e=0:n<t?e=1:t<n&&(e=2),e}function R(t,n,e){var e,e,t;return t===n?0:j(t)?n||0!==S(t)?o(n)&&!o(t)?1:a(n)?2:j(n)?((e=(0,I.Wkt)(t,n,e))<0?e=2:0<e&&(e=1),e):n instanceof Date?dt(t,n,1):-1:0:j(n)?t||0!==S(n)?o(t)?2:a(t)?1:t instanceof Date?dt(t,n,2):-1:0:a(t)&&o(n)?1:a(n)&&o(t)?2:(e=U(t),t=U(n),(e=d(e,15))===(t=d(t,15))?0:e<t?2:1)}function m(t,n,e){var t=O(t,n,e);return C(t)?0:t}function g(t,n,e,i){var r,o,a,u,s,c,f,l,h,r=-1,a=0,u=-1,s=-1,o=i?n.rowCount:n.colCount;if(--o<a)return-1;for(;a<=o;){for(c=w,f=void 0,l=t[0],1<=e!=(2===r)&&(u=s),f=s=ht(a,o,s=T((a+o)/2),0<=e,!0);!E(l,c)&&-1!==s&&!E(l,c=i?O(n,0,s):O(n,s,0));)s=ht(0,0,0,!1,!1),0<=e&&s<f?o=s:e<0&&f<s&&(a=s);if(-1===s&&1<=e!=(2===r))return u;if(-1===s)return-1;if(r=R(l,c,!1),1<=e&&1===r)a=s+1;else if(1<=e&&2===r)o=s-1;else if(e<=-1&&1===r)o=s-1;else if(e<=-1&&2===r)a=s+1;else if(0===r){for(;e<=-1&&a<s||0<=e&&s<o;){if(h=(h=0)<=e?s+1:s-1,null===(c=i?m(n,0,h):m(n,h,0)))return-1;if(!E(l,c))break;if(0!==(r=R(l,c,!1)))break;s=h}return s}}return 1<=e!=(2===r)?s:u}function vt(t,n,e){var i,r,n,t,o,a,u,s,t,c,f,l,h,i=n,r=t[0],n=j(r);if(r===w&&(r=0),o=i["_mc"+(t=e?n?"0":"1":n?"2":"3")]=i["_mc"+t]||(0,I.createMap)(),n&&(r=r.toLowerCase()),a=o.get(r),C(a)){if(a=-1,u=e?i.rowCount:i.colCount,s=e?i.colCount:1,t=M.tbt(r)){for(c=M.OJ(t),f=0;f<u;f++)if(c.lastIndex=0,c.test(i[f*s])){a=f;break}}else if(n)if(0===o.size){for(f=0;f<u;f++)if((l=i[f*s])===r||l&&l.toLowerCase&&l.toLowerCase()===r){a=f;break}}else{for(f=o.lp||0;f<u;f++){if((l=(l=i[f*s])&&l.toLowerCase&&l.toLowerCase())===r){a=f;break}o.has(l)||o.set(l,f)}o.lp=f}else for(r instanceof Date&&(r=v(r)),h=d(r,15),f=0;f<u;f++)if((l=(l=i[f*s])instanceof Date?v(l):l)===r||d(l,15)===h){a=f;break}o.set(r,a)}return a}function mt(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,c,s=w,h=-1,m=t[0],g=j(m),p=!u&&M.tbt(m),f=i?n.rowCount:n.colCount;for(g&&p&&(d=M.OJ(p)),l=0;l<f;l++)if(b=r?f-1-l:l,E(m,v=i?O(n,0,b):O(n,b,0),o,a))if(c=j(v),c=g&&c&&p?(d.lastIndex=0,d.test(v)?0:1):R(m,v,!1),1<=e&&1===c)c=-1,0<=h&&(c=R(v,s,!1)),(h<0||0<=h&&1===c)&&(h=b,s=v);else if(e<=-1&&2===c)c=-1,0<=h&&(c=R(v,s,!1)),(h<0||0<=h&&2===c)&&(h=b,s=v);else if(0===c)return b;return h}function gt(t,n){var e,i,r,o,a;if(!n)for(e=S(t),i=void 0,i=1;i<e;i++)if(2===(a=R(r=t[i-1],o=t[i],!1)))return;return 1}function pt(t,n,e,i,r,o){var t,a,t=ut.call(this,t,[lt(n,e,i,r)])||this;return t.getValue=function(t,n,e){var i=this,r=i.uit,r,r=0===r?i.getRow(0)+1+n:1===r?i.getColumn(0)+1+e:q.getValue.call(i,t,n,e);return r},(a=t).Ky=n,a.yft=e,a.Sx=i,a.Cyt=r,a.uit=o,t}function bt(t){var n=st.call(this,y)||this;return n.Kkt=t,n}function wt(t,n,e){var i,r,o,a,u,s,c,f,l;if(!t)return _;if(i=n!==y,r=t.row+(t.arrayFormulaMode&&t.arrayIdentity&&t.rowOffset||0),o=t.column+(t.arrayFormulaMode&&t.arrayIdentity&&t.columnOffset||0),t.source.getBaseRowCol&&(a=t.source.getBaseRowCol())&&(r=a.row,o=a.col),!(n=i?n:t.getReference(t.source,lt(r,o,t.rowCount,t.columnCount)))||1!==n.getRangeCount())return _;if(c=[],e){if(f=n.getRow(0)+1,1<(s=n.getRowCount(0))){for(u=0;u<s;u++)c.push([f+u]);return new I.CalcArray(c)}return f}if(l=n.getColumn(0)+1,1<(s=n.getColumnCount(0))){for(u=0;u<s;u++)c.push(l+u);return new I.CalcArray([c])}return l}function yt(t,n,e,i,r,o){var a,u,s,a,c,s,u,r;return t&&e instanceof I.CalcReference?(c=t.source&&t.source.Lbt.dynamicReferences,s=e.getRowCount(0),a=e.getColumnCount(0),u=e.create([{row:e.getRow(0),col:e.getColumn(0),rowCount:o?s:1,colCount:o?1:a}]),c&&Bt(t,e,u.getRow(0),u.getColumn(0),u.getRowCount(0),u.getColumnCount(0),o&&e.$gt[0].rowUndefine,!o&&e.$gt[0].colUndefine)):(e instanceof I.CalcArray?(s=e.getRowCount(),a=e.getColumnCount()):Array.isArray(e)&&(s=e.rowCount,a=e.colCount),u=e),o&&a<i||!o&&s<i||(u.Zbt=!0,(a=I.Convert.iV(u,0,!0,!1,!1)).isError)||a.isConvertError?D:0<=(s=r||r===y?g(n,a,1,o):vt(n,a,o))?t&&e instanceof I.CalcReference?(u=o?s:i-1,r=o?i-1:s,c&&Bt(t,e,e.getRow(0)+u,e.getColumn(0)+r,1,1),e.getValue(0,u,r)):o?m(a,i-1,s):m(a,s,i-1):p}function Mt(t,n){return wt(t,n,!0)}function Ct(t,n){return wt(t,n,!1)}function St(t){return ft(t)?I.CalcArrayHelper.getRowCount(t):1}function Tt(t){return ft(t)?I.CalcArrayHelper.getColumnCount(t):1}function At(t){return k(t)||N(t)?new tt(t):t}function It(t,n,e,i,r){return yt(t,n,e,i,r,!1)}function xt(t,n,e,i,r){return yt(t,n,e,i,r,!0)}function Nt(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,u,a,t,n,r,o,a=n.rowCount,u=n.colCount,s=1===a&&1===u,c=e.getRowCount(),f=e.getColumnCount(),l=1===a&&1<=u,h=1===c&&1<=f;if(s){if(1<c&&1<f)return _}else if(l&&u!==f||!l&&a!==c)return _;if((d=jt(t,n,r,o))===p)return i===y&&(i=p),s?i:new I.CalcArray([[i]]);if(d===_)return _;if(0<d){if(s)return e;if(d-=1,v=[],I.Convert.Nh(e)){if(l)for(m=0;m<c;m++)g=e.getValue(0,d),v.push([g]);else u=h?[e.getValue(0,d)]:[e.getValue(d,0)],v.push(u);return new I.CalcArray(v)}return e instanceof I.CalcReference?(t=(a=e).getRow(),n=a.getColumn(),r=c,o=f,l?(n=a.getColumn()+d,o=1):(t=a.getRow()+d,r=1),a.create([{row:t,col:n,rowCount:r,colCount:o}])):void 0}}function kt(t,n,e){var i,r,o,a,u,s,t,a,i=[];if(n)for(r=0;r<n.length;r++)i.push(n[r]);if(n.colCount<=n.rowCount?(i.colCount=n.colCount,i.rowCount=Math.ceil(i.length/i.colCount)):(i.rowCount=n.rowCount,i.colCount=Math.ceil(i.length/i.rowCount)),C(n.isReference)||(i.isReference=n.isReference),C(n.isArray)||(i.isArray=n.isArray),i.rangeCount=n.rangeCount,o=-1,u=i.colCount,s=i.rowCount,t=t,e===y)return a=s<u?It(y,t,i,s,!0):xt(y,t,i,u,!0),x(a)?p:a;if(a=I.Convert.iV(e,0,!0,!1,!1)){if(1<a.colCount&&1<a.rowCount)return p}else a=i;return 0<=(o=g(t,i,1,u<=s))?(u=a.colCount,(s=a.rowCount)<u?m(a,o,s-1):m(a,u-1,o)):p}function _t(t){var n=arguments;return t<1||S(n)<=t?_:C(n[t])?0:n[t]}function Dt(t,n,e){var t,n,i,r,o,t=t,n=n;return!n.isArray&&!n.isReference||(i=n.colCount,r=n.rowCount,o=-1,1<i&&1<r)||1===e&&!gt(n,!0)||-1===e&&!gt(n,!1)||(e===y?e=1:e===w&&(e=0),1===e?o=g(t,n,1,1<r):0===e?o=vt(t,n,1<r):-1===e&&(o=g(t,n,-1,1<r)),-1===o)?p:o+1}function jt(t,n,e,i){var n,r,o,a,u,a,u,t,s,c,f,s,r,n=n,r=n.colCount,o=n.rowCount;if(1<r&&1<o)return _;if(2===e&&(2===i||-2===i))return _;if(a=2===i&&!gt(n,!0),u=-2===i&&!gt(n,!1),a||u)return p;if(u=(a=t)&&t[0],t=-1,C(e)&&(e=0),-1===(i=!C(i)&&0!==i?i:1)&&(s=!0),0!==e&&2!==e||(c=0),1===i||-1===i){if(1===e)c=-1;else if(-1===e){if(M.jJ(u))return p;c=1}t=mt(a,n,c,1<o,s,!0,!0,0===e)}else if(2===i||-2===i){if(1===r&&1===o){if(!E(u,s=n[f=0]))return p;if(0===(r=R(u,s,!1)))return 1;if(0===e)return 0===r?1:p;if(1===e)return 2===r?1:p;if(-1===e)return 1===r?1:p}t=g(a,n,c=2===i?1:-1,1<o)}return-1!==t&&(0!==e||$t(u,n[t]))?!$t(u,n[t])&&(2===i&&1===e||-2===i&&-1===e)?t+2:t+1:p}function Ot(t,n,e,i){return t+=n,i?0!==e&&(t=(t+="[")+e.toString()+"]"):t+=e,t}function Et(t,n,e){return e||(t+="$"),t+=n}function Rt(t,n,e){e||(t+="$");for(var i=t.length;.1<n;n=parseInt(((n-1)/26).toString(),10))t=r.Common.zf.Eit(t,i,String.fromCharCode("A".charCodeAt(0)+(n-1)%26));return t}function Ft(t,n){if(n&&0<S(n)){for(var e=void 0,i=!(0,I.Swt)(n[0])&&"_"!==n[0],e=1;!i&&e<S(n);e++)i=!(0,I.Jkt)(n[e])&&"_"!==n[e];i?t=(t+="'")+n.replace("'","''")+"'":t+=n,t+="!"}return t}function Lt(t,n,e,i,r){var o,a,u,o=3===e||4===e||7===e||8===e,a=2===e||4===e||6===e||8===e,u="";return t<1&&(i||!o)||Z<t||n<1&&(i||!a)||W<n||e<1||8<e?_:(u=Ft(u,r),i?Et(u=Rt(u,n,a),t,o):(u=Ot(u,"R",t,o),Ot(u,"C",n,a)))}function Bt(t,n,e,i,r,o,a,u){var t,n,s,c,f,l,s;t&&t.identity&&!t.ITe&&(t=t.Xkt,n=n.getSource(),t)&&n.getRangeKey&&(s=e,c=i,f=r,l=o,a&&(s=f=-1),u&&(c=l=-1),s=n.getRangeKey(n,{id:n.id,row:s,col:c,rowCount:f,colCount:l}),t.qkt||(t.qkt={}),t.qkt[s]={id:n.id,row:e,col:i,rowCount:r,colCount:o,rowUndefine:a,colUndefine:u})}function Pt(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,c,u;function b(t){return!C(t)&&!t._error}if(u=(a=t)!==(o=w)&&a.acceptsReference,s=a!==w&&a.arrayFormulaMode,!ft(n))return e=e!==y?T(e):0,i=i!==y?T(i):0,e<0||i<0?_:1<e||1<i?D:n;if(n instanceof I.CalcReference){if(c={value:-1},f=n,(r=b(r=r===y?1:r)&&A(r,c)?c.value-1:o)>=f.getRangeCount())return D;if(r===o||r<0)return _;if(l=f.getRowCount(r),h=f.getColumnCount(r),d=f.getRow(r),v=f.getColumn(r),g=m=void 0,3===S(arguments)){if(1!==l&&1!==h)return D;1!==h?(i=e,e=1):1!==l&&(i=1)}if(-1===(e=b(e=C(e)?0:e)&&A(e,c)?c.value-1:o)){if(1!==l&&!u&&!s&&(d>a.row||a.row>=d+l))return _}else{if(e<-1||e===o)return _;if(l<=e&&!n.$gt[0].rowUndefine)return D;m=e+d}if(-1===(i=b(i=C(i)?0:i)&&A(i,c)?c.value-1:o)){if(1!==h&&!u&&!s&&(v>a.column||a.column>=v+h))return _}else{if(i<-1||i===o)return _;if(h<=i&&!n.$gt[0].colUndefine)return D;g=i+v}return-1===e&&-1===i?(m=d,g=v):-1===e?(m=d,h=1):l=-1===i?(g=v,1):h=1,(p=t.source&&t.source.Lbt.dynamicReferences)&&Bt(t,f,m,g,l,h,-1===e&&n.$gt[0].rowUndefine,-1===i&&n.$gt[0].colUndefine),(c=t.WK)&&c.Gue&&c.Gue(m,g,f.rT),f.create([lt(m,g,l,h)])}return I.Convert.Nh(n)?(l=(u=n).getRowCount(),e=e!==y?T(e):-1,i=i!==y?T(i):-1,1!==(r=r!==y?T(r)-1:1)?D:(-1===e&&-1===i?e=i=0:-1===i&&1===l&&(i=e,e=1),e=-1===e?0:e,i=-1===i?0:i,l=u.getRowCount(),h=u.getColumnCount(),e<0||i<0||r<0?_:(l<e&&1===l&&i===y&&(i=e,e=0),l<e||h<i?D:0===e&&0===i?u.slice(0,0,l,h):0===e?u.slice(0,i-1,l,1):0===i?u.slice(e-1,0,1,h):u.getValue(e-1,i-1)))):void 0}function Gt(t,n,e,i,r,o){var a,u,e,i,r;return t?n&&n instanceof I.CalcReference&&1===n.getRangeCount()?(a=r!==y?T(r):n.getRowCount(0),u=o!==y?T(o):n.getColumnCount(0),e=n.getRow(0)+e,i=n.getColumn(0)+i,a<0&&(e+=a+1,a=Math.abs(a)),u<0&&(i+=u+1,u=Math.abs(u)),Bt(t,n,e,i,a,u,C(r)&&n.$gt[0].rowUndefine,C(o)&&n.$gt[0].colUndefine),0===a||0===u||e<0||i<0?D:((r=t.WK)&&r.Gue&&r.Gue(e,i,n.rT),n.create([{row:e,col:i,rowCount:a,colCount:u}]))):_:p}function Ut(t,n,e){var i,r,o,a,u,s,c,f,o,e,u,a,s;return t?!n||"!"===n[0]||(o={row:i=t.row,col:r=t.column},a=(a=t.parser)||(t.parser=new I.Parser),(s=(u=t.source).parserContext)?(s.useR1C1=!e,s.row=o.row||0,s.column=o.col||0,s.baseIdentity=o,s.source=t.source):(u.parserContext=s=t.source?t.source.getParserContext(!e,o):new I.ParserContext(t.source,!e,o),s.onlyValidateSourceNameWithSpecial=!0),e?c=a.parse(s,n):(c=(o=(o=u.expressions)||(u.expressions={}))[n])||(c=a.parse(s,n),o[n]=c),!c)||(e=!1,7===c.type&&"ANCHORARRAY"===c.functionName&&(c=c.arguments[0],e=!0),!(c=8===c.type?c.source?(f=c.source).getCustomName(c.value):t.getName(c.value):c))||L.Rh(c.type,[1,13])<0||c.source instanceof I.ErrorSource?D:(f=c.source||t.source,25===c.type||26===c.type?f.getValueByName(c.nameIdentity):(u=c.getRange(i,r),a=null,a=(f=13===c.type?c.source:f).getReference(u),Bt(t,a=e?a.getSpillRef():a,a.getRow(0),a.getColumn(0),a.getRowCount(0),a.getColumnCount(0),a.$gt[0].rowUndefine,a.$gt[0].colUndefine),(s=t.WK)&&s.Gue&&s.Gue(c),a)):p}function Ht(t,n){var n,e="__hyperlink__",n=2===arguments.length?new String(H(n)):new String(H(t));return n[e]=H(t),n}function Vt(){for(var t,n=0,t=0;t<S(arguments);t++){if(0===arguments[t].length)return z;arguments[t].isReference&&(n+=arguments[t].rangeCount)}return n}function zt(t,n){var e,i,n,e=n.getRow(0),i=n.getColumn(0),n=n.getSource().getCalcSourceModel().getFormula(e,i);return n?"="+n:p}function Yt(t,n){var e,i,n,e=n.getRow(0),i=n.getColumn(0),n=n.getSource().getCalcSourceModel();return!(!n.ODt||!n.ODt(e,i))}function F(t,n){var e;return void 0===n&&(n=!1),(e=N(t)||k(t)?t.toArray(0,!1):t.length&&t[0].length?t:[[t]])?Zt(e,n):x(t)?t:_}function Zt(t,n){var n,e,i,r,o,a,u,e=t.rowCount,i=t.colCount;if(e||i||(e=t.length,i=t[0].length),r=t,n=void 0===n?!1:n){for(r=[],o=0;o<i;o++)for(r.push(a=[]),u=0;u<e;u++)a.push(t[u][o]);e=(n=[i,e])[0],i=n[1]}return r.rowCount=e,r.colCount=i,r}function Wt(t){return 1===t||-1===t}function Qt(t,o){var a=o.length;t.sort(function(t,n){for(var e,i,r,r,e=0;e<a;e++)if(r=(i=o[e])[0],0!==(r=(0,I.$kt)(t[r],n[r])))return i[1]?r:-r;return 0})}function Jt(t,e,n){var i;n?t.forEach(function(t,n){t.push(e[n][0])}):(i=e[0],t.forEach(function(t,n){t.push(i[n])}))}function Kt(t){if(t&&t.length&&0<=t.length){for(var n=0;n<t.length;n++)if("number"!=typeof t[n])return;return 1}}function Xt(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,C;if(void 0===n&&(n=1),void 0===e&&(e=1),r=[].concat(F(t,i=void 0===i?!1:i)),x(r))return r;if(o=r,a=[],N(n)||k(n)){if(l=(f=n.toArray(0,!1)).rowCount,h=f.colCount,d=0,N(e)||k(e)){if(d=(s=e.toArray(0,!1)).rowCount,1!==h){if(h<1||1!==s.colCount&&s.colCount!==h||1!==l||!Kt(f[0]))return _;if((v=[]).push(t),i)for(o=Zt(o,i),m=0;m<h;m++){for(g=[],p=0;p<o[0].length;p++)g.push(o[f[0][m]-1][p]);v.push(new I.CalcArray([g])),v.push((1===d?s[0]:s[m])[0])}else for(m=0;m<h;m++){for(g=[],p=0;p<o.length;p++)g.push([o[p][f[0][m]-1]]);v.push(new I.CalcArray(g)),v.push((1===d?s[0]:s[m])[0])}return qt.apply(qt,v)}if(1!==s.colCount||1!==d&&d!==l)return _;1===d&&(c=s[d=0][0])}else c=e;for(u=0;u<l;u++)a.push([f[u][0],u<d?s[u][0]:c])}else if(N(e)||k(e)){if(1!==(s=e.toArray(0,!1)).colCount||1!==s.rowCount)return _;a.push([n,s[0][0]])}else a.push([n,e]);for(b=o.colCount,w=[],y=0,M=a;y<M.length;y++){if(S=(C=M[y])[0],C=C[1],S<1||b<S||!Wt(C))return _;w.push([S-1,1===C])}return Qt(o,w),new I.CalcArray(i?Zt(o,i):o)}function qt(t,n,e){var i,r,o,a,u,s,c,e,f,l,h,d,v,m,g,p,b,w,y,M,C,S,S,C,T,A,y;for(void 0===e&&(e=1),i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];if(s=u=0,c=_,k(t)?o=t:N(t)&&(u=(a=t).getRow(),s=a.getColumn()),e=o||a){if(f=e.getColumnCount(),l=e.getRowCount(),x(t))return c;for(h=[],d=void 0,p=g=void(m=v=0),b=1,w=arguments.length;b<w;b+=2){if(M=[].concat(F(y=arguments[b])),x(M))return c;if(C=y.getRowCount(),S=y.getColumnCount(),v||(v=(d=1===S)?2:1,p=[].concat(F(t,!d))),!(!d&&1===C&&S===f||d&&1===S&&C===l))return c;if(S=k(y),N(y)&&(C=void 0,d?0<=(C=s-(T=y.getColumn()))&&C<f?g=C:S=!0:0<=(C=u-(A=y.getRow()))&&C<l?g=C:S=!0),S&&(m+=1,d?(g=f,f++):(g=l,l++),Jt(p,M,d)),!Wt(y=arguments[b+1]||1))return c;h.push([g,1===y])}return Qt(p,h),m&&p.forEach(function(t){t.length-=m}),new I.CalcArray(d?p:Zt(p,!0))}return c}function $t(t,n){return!!(t===n||G(t)&&G(n)&&v(t)===v(n)||x(t)&&x(n)&&t._code===n._code)}function tn(t,n){for(var e,i,r,o,e=0,i=t.length;e<i;e++)if(!$t(r=t[e],o=n[e]))return;return 1}function nn(t,n,o){var t,a,u,s;return void 0===o&&(o=!1),t=F(t,n=void 0===n?!1:n),x(t)?t:(u=[],s=(a=t).rowCount,a.forEach(function(t,n){var e,i,r;if(!t.duplicated){for(e=0,i=n+1;i<s;i++)tn(t,r=a[i])&&(r.duplicated=!0,e++);o&&0!==e||u.push(t)}}),new I.CalcArray(n?Zt(u,n):u))}function en(t,n,e){var t,i,r,o,a,t=F(t);if(x(t))return t;if(i=t,r=[].concat(F(n)),o=[],1===r.length&&r[0].length===i[0].length){for(a=0;a<r[0].length;a++)if(x(r[0][a]))return r[a][0];i.forEach(function(t,n){var e=[];t.forEach(function(t,n){r[0][n]&&e.push(t)}),o.push(e)})}else{if(i.length!==r.length)return _;for(a=0;a<r.length;a++){if(x(r[a][0]))return r[a][0];r[a][0]&&o.push(i[a])}}return 0===o.length?C(e)?Y:e:new I.CalcArray(o)}function rn(t,n){var e,i,r,o,a,u,s,c,f,l,h,t;if(k(n))return n.getValue(0,0);if(N(n)){if(i=(e=n).getColumn(),r=e.getRow(),o=e.getColumnCount(),a=e.getRowCount(),c=(u=t.row)-r,f=(s=t.column)-i,h=l=void 0,t=t.source===e.getSource(),1===a&&(!t||r!==u)&&0<=f&&f<o)h=s,l=r;else if(1===o&&(!t||i!==s)&&0<=c&&c<a)h=i,l=u;else{if(1!==a||1!==o)return _;h=i,l=r}return e.create([{row:l,col:h,rowCount:1,colCount:1}])}return n}function on(t,n){return n instanceof I.CalcReference?n.getSpillRef():D}function an(t,n,e){var i,r,i;return n instanceof I.CalcReference&&(!e||e instanceof I.CalcReference)?(r=(i=n.rT||t.source).hierarchicalCellIndexingHelper||i.Mf.getHierarchicalCellIndexingHelper&&i.Mf.getHierarchicalCellIndexingHelper())?(i=i.getBaseRowCol&&i.getBaseRowCol()||t.identity,r.getIndex(i,n,e)):u:D}function un(t,n,e,i,r){var o,a,o;return n instanceof I.CalcReference&&(!e||e instanceof I.CalcReference)?(a=(o=n.rT||t.source).hierarchicalCellIndexingHelper||o.Mf.getHierarchicalCellIndexingHelper&&o.Mf.getHierarchicalCellIndexingHelper())?(o=o.getBaseRowCol&&o.getBaseRowCol()||t.identity,a.getRank(o,n,e,1!==i,r)):u:D}function sn(t,n,e){var i,t;return n instanceof I.CalcReference?(t=(i=n.rT||t.source).hierarchicalCellIndexingHelper)?t.coordinateOffset(n,e,!1):u:D}function cn(t,n,e){var i,t;return n instanceof I.CalcReference?(t=(i=n.rT||t.source).hierarchicalCellIndexingHelper)?t.coordinateOffset(n,e,!0):u:D}function fn(t,n,e,i){var t,r,t;return n instanceof I.CalcReference?(r=(t=n.rT||t.source).hierarchicalCellIndexingHelper)?(t=t.getBaseRowCol&&t.getBaseRowCol(),r.coordinateExecute(t,n,e,i)):u:D}function ln(t){var t,n,t,t=t.source,n=t.Mf;return n&&n.getPageIndexByCell?(t=t.getBaseRowCol&&t.getBaseRowCol(),n.getPageIndexByCell(t.row,t.col)+1):u}function hn(t){var n,t,n,t=t.source.Mf;return t&&t.getPagesCount?t.getPagesCount():u}function dn(t,n,e,i){var t,r,t;return n instanceof I.CalcReference?(r=(t=n.rT||t.source).hierarchicalCellIndexingHelper)?(t=t.getBaseRowCol&&t.getBaseRowCol(),r.getProportion(t,n,e,i)):u:D}function vn(t,n,e,i){var t,r,t;return n instanceof I.CalcReference?(r=(t=n.rT||t.source).hierarchicalCellIndexingHelper)?(t=t.getBaseRowCol&&t.getBaseRowCol(),r.getCumulative(t,n,e,i)):u:D}function mn(t,n,e,i){var t,r,t;return n instanceof I.CalcReference&&(e||i)?(r=(t=n.rT||t.source).hierarchicalCellIndexingHelper)?(t=t.getBaseRowCol&&t.getBaseRowCol(),r.getYearOverYear(t,n,e,i)):u:D}function gn(t,n,e,i){var t,r,t;return n instanceof I.CalcReference?(r=(t=n.rT||t.source).hierarchicalCellIndexingHelper)?(t=t.getBaseRowCol&&t.getBaseRowCol(),r.getMonthOverMonth(t,n,e,i)):u:D}function pn(){var t,n,e,i,r,o,a,u,s,c,t=arguments,n=t.length;if(1===n)return new I.CalcArray(t[0]);for(i=e=0;i<n;i++)e=Math.max(e,t[i].colCount);for(r=[],o=0;o<n;o++)for(a=t[o],u=0;u<a.rowCount;u++){for(s=[],c=a.colCount,i=0;i<c;i++)s.push(a[u][i]);for(i=c;i<e;i++)s.push(p);r.push(s)}return new I.CalcArray(r)}function bn(){var t,n,e,i,r,o,a,u,s,c,t=arguments,n=t.length;if(1===n)return new I.CalcArray(t[0]);for(i=e=0;i<n;i++)e=Math.max(e,t[i].rowCount);for(r=[],o=0;o<e;o++){for(a=[],u=0;u<n;u++)for(c=o<(s=t[u]).rowCount,i=0;i<s.colCount;i++)a.push(c?s[o][i]:p);r.push(a)}return new I.CalcArray(r)}function wn(t,n,e,i){var r,o,a,u,s,c,f,r=t.rowCount,o=t.colCount,a=1===e||3===e,u=2===e||3===e,s=function(t){a&&t===w||u&&x(t)||i(t)};if(n)for(c=0;c<o;c++)for(f=0;f<r;f++)s(t[f][c]);else for(f=0;f<r;f++)for(c=0;c<o;c++)s(t[f][c])}function yn(t){for(var n,e,n=new Array(t),e=0;e<t;e++)n[e]=[];return n}function Mn(t,n,e){var i=[];return wn(t,e,n,function(t){i.push(t===w?0:t)}),new I.CalcArray([i])}function Cn(t,n,e){var i=[];return wn(t,e,n,function(t){i.push([t===w?0:t])}),new I.CalcArray(i)}function Sn(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;if(1!==i&&1!==r)return _;if(C(n)||n<=0)return V;if((o=Math.max(i,r))<=n)return new I.CalcArray(t);if(a=[],wn(t,!(u=[]),0,function(t){u.push(t),u.length===n&&(a.push(u),u=[])}),0<u.length){for(e=C(e)?p:e,s=u.length;s<n;s++)u.push(e);a.push(u)}return new I.CalcArray(a)}function Tn(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;if(1!==i&&1!==r)return _;if(C(n)||n<=0)return V;if((o=Math.max(i,r))<=n)return new I.CalcArray(t);if(a=yn(n),wn(t,!1,u=0,function(t){a[u].push(t),++u===n&&(u=0)}),0<u)for(e=C(e)?p:e,s=u;s<n;s++)a[s].push(e);return new I.CalcArray(a)}function An(t,n,e,i,r){var o,a,u,s,c,o=0===n&&e===t.rowCount,a=0===i&&r===t.colCount;if(o&&a)return new I.CalcArray(t);for(u=[],s=n;s<e;s++)c=t[s],u[s-n]=a?c:c.slice(i,r);return new I.CalcArray(u)}function In(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;return ct(t,i,r)?_:An(t,o=0<(n=i<(n=C(n)?i:n)||n<-i?i:n)?0:i+n,a=0<n?n:i,u=0<(e=r<(e=C(e)?r:e)||e<-r?r:e)?0:r+e,s=0<e?e:r)}function xn(t,n,e){var i,r,o,a,u,s,i=t.rowCount,r=t.colCount;return n=C(n)?0:n,e=C(e)?0:e,i<=n||n<=-i||r<=e||e<=-r?Y:An(t,o=0<=n?n:0,a=0<=n?i:i+n,u=0<=e?e:0,s=0<=e?r:r+e)}function Nn(t,n){var e,i,e=new Array(n);if("function"==typeof e.fill)e.fill(t,0,n);else for(i=0;i<n;i++)e[i]=t;return e}function kn(t,n,e,i){var r,o,a,u,s,c,f,r=t.rowCount,o=t.colCount;if(n=C(n)?r:n,e=C(e)?o:e,ct(t,r,o)||n<r||e<o)return _;if(u=o<e,!(a=r<n)&&!u)return new I.CalcArray(t);for(s=Nn(i=C(i)?p:i,e-o),c=[],f=0;f<r;f++)c.push(u?t[f].concat(s):t[f]);for(f=r;f<n;f++)c.push(Nn(i,e));return new I.CalcArray(c)}function _n(t){var n,e,n,i,r,e,e;if(x(t))return t;if(k(t)||N(t)){if(e=t.getRowCount(),n=t.getColumnCount(),1!==e&&1!==n)return _;if((e=I.Convert.iV(t,r=(i=1===e&&1===n)?1:5,!0,!0,!0)).isConvertError)return _;if(e.isError)return e[0];if(e.some(function(t){return t===I.Convert.CalcConvertedError}))return _;n=e}else{if(!A(t,e={}))return _;n=[e.value]}return n}function Dn(t,n){for(var e,i,r,o,a,u,s,e=[],i=I.Convert.iV(t[0],0,!1,!1,!1,!1),r=n?i.rowCount:i.colCount,o=1;o<t.length;o++){if(a=_n(t[o]),x(a))return a;for(u=0;u<a.length;u++){if(0===(s=a[u])||r<s||s<-r)return _;e.push(s)}}return 0===e.length?_:{array:i,indexNumbers:e}}function jn(){var t,n,e,i,r,o,a,t=Dn(arguments,!0);if(x(t))return t;for(n=t.array,e=t.indexNumbers,i=n.rowCount,r=[],o=0;o<e.length;o++)a=e[o],r.push(n[a=0<a?a-1:i+a]);return new I.CalcArray(r)}function On(){var t,n,e,i,r,o,a,u,s,t=Dn(arguments,!1);if(x(t))return t;for(n=t.array,e=t.indexNumbers,i=n.rowCount,r=n.colCount,o=yn(i),a=0;a<e.length;a++)for(u=0<(u=e[a])?u-1:r+u,s=0;s<i;s++)o[s].push(n[s][u]);return new I.CalcArray(o)}e=this&&this.__extends||(at=function(t,n){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}at(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),r=n("Common"),I=n("CalcEngine"),w=null,y=void 0,M=r.Common.$T,L=r.Common.lt,t=r.Common.ct,d=r.Common.st.E8,B=t.Z6t,C=L.ht,P=L.Fh,S=r.Common.Uf.tR,G=t.W0,v=t.o0,x=I.Convert.BJ,T=I.Convert.z6t,A=I.Convert.t9t,o=I.Convert.q8,U=I.Convert.uJ,N=I.Convert.LE,k=I.Convert.Nh,H=I.Convert.j,_=I.Errors.Value,D=I.Errors.Reference,V=I.Errors.Number,p=I.Errors.NotAvailable,z=I.Errors.Null,Y=I.Errors.Calc,u=I.Errors.Name,n=I.Functions.F6t,a=I.Functions.G6t,j=I.Functions.OMt,Z=1048576,W=16384,q=I.CalcReference.prototype,ut=I.CalcReference,e(pt,ut),pt.prototype.type=function(){return this.uit},pt.prototype.toArray=function(t,n){for(var e=this,i=[],r=e.Ky,o=e.yft,a=e.uit,u=e.getRangeCount(),s=e.Sx,c=e.Cyt,f,l,h,d,v,m,f=0;f<u;f++)for(n||i.push(h=[]),v=0;v<s;v++)for(n||h.push(d=[]),m=0;m<c;m++)l=0===a?r+1+v:1===a?o+1+m:q.getValue.call(e,f,r+v,o+m),(n?i:d).push(l);return(i=n||1!==u?i:i[0]).rowCount=s,i.colCount=c,i.rangeCount=u,i},$=pt,st=I.CalcArray,e(bt,st),bt.prototype.getRowCount=function(){return I.CalcArrayHelper.getColumnCount(this.Kkt)},bt.prototype.getColumnCount=function(){return I.CalcArrayHelper.getRowCount(this.Kkt)},bt.prototype.getValue=function(t,n){return I.CalcArrayHelper.getValue(this.Kkt,n,t)},tt=bt,t={J6t:7},e={J6t:2},f={J6t:2,pkt:"<= 0",zkt:_},it={J6t:2,pkt:["< 0","> 3"],zkt:_},rt={J6t:2,pkt:["= 0"],zkt:Y},ot={bkt:0,J6t:2},l={J6t:4,X6t:0,Vkt:!0},h={J6t:4,X6t:0,n9t:!0},n("ADDRESS",Lt,2,5,[i={J6t:2},i,et={bkt:1,J6t:2},nt={bkt:!0,J6t:7},{bkt:"",J6t:5}],y,y,{wkt:[2,3,4]}),n("INDEX",Pt,2,4,y,0,0,{wkt:[1,2,3],e9t:[0],i9t:!0,r9t:!0,o9t:3}),n("OFFSET",Gt,3,5,[{},i,i],0,0,{wkt:[3,4],e9t:[0],a9t:!0,r9t:!0,o9t:2,returnReference:!0}),n("ROW",Mt,0,1,y,-1,y,{r9t:!0,e9t:-1,expandColumns:!1}),n("COLUMN",Ct,0,1,y,-1,y,{wkt:0,r9t:!0,e9t:-1,expandRows:!1}),n("ROWS",St,1,1,y,-1,-1,{e9t:-1,expandColumns:!1,u9t:2}),n("COLUMNS",Tt,1,1,y,-1,-1,{e9t:-1,expandRows:!1,u9t:3}),n("TRANSPOSE",At,1,1,y,-1,-1),n("LOOKUP",kt,2,3,[l,{J6t:4,X6t:0,Vkt:!0,s9t:!0}],"!= 0","!= 0",{f9t:1}),n("HLOOKUP",It,3,4,[l,{},f,t],1,1,{r9t:!0,i9t:!0,e9t:[1]}),n("VLOOKUP",xt,3,4,[l,{},f,t],1,1,{r9t:!0,i9t:!0,e9t:[1]}),n("XLOOKUP",Nt,3,6,[l,l,{},{},{J6t:2,bkt:0},{J6t:2,bkt:1}],[1,2],[1,2],{wkt:[3,4,5]}),n("VSTACK",pn,1,255,h,-1,-1,y,!0),n("HSTACK",bn,1,255,h,-1,-1,y,!0),n("TOROW",Mn,1,3,[h,it,t],0,0,{wkt:[1,2]},!0),n("TOCOL",Cn,1,3,[h,it,t],0,0,{wkt:[1,2]},!0),n("WRAPROWS",Sn,2,3,[h,i],0,0,{wkt:[2],f9t:-1},!0),n("WRAPCOLS",Tn,2,3,[h,i],0,0,{wkt:[2],f9t:-1},!0),n("TAKE",In,2,3,[h,rt,rt],0,0,{wkt:[1,2]},!0),n("DROP",xn,2,3,[h,ot,ot],0,0,{wkt:[1,2]},!0),n("EXPAND",kn,2,4,[h,f,f],0,0,{wkt:[1,2,3]},!0),n("CHOOSEROWS",jn,2,255,y,-1,-1,y,!0),n("CHOOSECOLS",On,2,255,y,-1,-1,y,!0),n("CHOOSE",_t,2,255,i,">= 1",">= 1",{f9t:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var n={value:-1};return x(t)?-1:(A(t,n),n.value)}}),n("MATCH",Dt,2,3,[l,{J6t:4,X6t:0,Vkt:!0,Zbt:!0},e],1,1,{}),n("XMATCH",jt,2,4,[l,l,e,e],1,1,{}),n("INDIRECT",Ut,1,2,[{J6t:5},nt],y,y,{wkt:2,a9t:!0,r9t:!0}),n("HYPERLINK",Ht,1,2,y,y,y,{u9t:1}),n("AREAS",Vt,1,y,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),n("FORMULATEXT",zt,1,1,y,-1,y,{r9t:!0}),n("ISFORMULA",Yt,1,1,y,-1,y,{r9t:!0}),n("SORT",Xt,1,4,y,[0,1,2],[0,1,2],{wkt:[1,2,3]},!0),n("SORTBY",qt,2,y,y,[0,"%= 1"],[0,"%= 1"],y,!0),n("UNIQUE",nn,1,3,y,[0],[0],{wkt:[1,2]},!0),n("FILTER",en,2,3,y,[0,1,2],[0,1,2],y,!0),n("@",rn,1,1,y,[0],[0],{r9t:!0},!0),n("ANCHORARRAY",on,1,1,y,[0],[0],{r9t:!0},!0),n("R.INDEX",an,1,2,y,-1,-1,{r9t:!0}),n("R.RANK",un,1,4,y,-1,-1,{r9t:!0}),n("R.R",sn,2,2,y,-1,-1,{r9t:!0}),n("R.A",cn,2,2,y,-1,-1,{r9t:!0}),n("R.V",fn,1,255,y,-1,-1,{r9t:!0}),n("R.CURRENTPAGE",ln,0,0,y,-1,-1,{r9t:!0},!1),n("R.PAGESCOUNT",hn,0,0,y,-1,-1,{r9t:!0}),n("R.PROPORTION",dn,1,3,y,-1,-1,{r9t:!0}),n("R.CUMULATIVE",vn,1,3,y,-1,-1,{r9t:!0}),n("R.MOM",gn,1,3,y,-1,-1,{r9t:!0}),n("R.YOY",mn,2,3,y,-1,-1,{r9t:!0})},"./src/functions-stat.ts":function(v,t,m){var g,B,M,V,P,x,N,y,ot,O,k,T,A,_,h,D,at,ut,st,ct,j,I,p,G,U,R,E,H,C,ft,F,L,b,lt,z,Y,e,d,Z,W,Q,ht,w,t,J,K,n,X,q,$,i,tt,r,m,nt,o,et,it,a,u,rt,s,c,dt,f,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,St,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,s,Et,Rt,Ft,Lt,Bt,pt,Pt,Gt,Ut,Ht,Vt,zt,Yt,Zt;function Wt(t){for(var n,e,n=0,e=0;e<t.length;e++)t[e]!==w&&n++;return n}function Qt(t){var n,e,i,e,n=6,e=0===t?0:3<=(i=.5*Math.abs(t))?1:i<1?((((((((.000124818987*(e=i*i)-.001075204047)*e+.005198775019)*e-.019198292004)*e+.059054035642)*e-.151968751364)*e+.319152932694)*e-.5319230073)*e+.797884560593)*i*2:(((((((((((((-45255659e-12*(i-=2)+.00015252929)*i-19538132e-12)*i-.000676904986)*i+.001390604284)*i-.00079462082)*i-.002034254874)*i+.006549791214)*i-.010557625006)*i+.011630447319)*i-.009279453341)*i+.005353579108)*i-.002141268741)*i+.000535310849)*i+.999936657524;return 0<t?.5*(e+1):.5*(1-e)}function Jt(t,n,e){var i,r,o,a,u,r,i=M(t);if(n!==t[0]){for(u=t[a=0],o=1;o<i&&t[o]<n;o++)t[o]!==u&&(u=t[a=o]);t[o]!==u&&(a=o),r=n===t[o]?e?a/(i-1):(o+1)/(i+1):0===a?0:(r=(n-t[a-1])/(t[a]-t[a-1]),e?(a-1+r)/(i-1):(a+r)/(i+1))}else r=e?0:1/(i+1);return r}function Kt(t,n,e,i){var r,t,t,r=[];return vn(t,r),0===(t=M(r))||n<r[0]||r[t-1]<n?G:0!==(t=1===t?1:Jt(r,n,i))?j(t*ot(10,e))/ot(10,e):t}function Xt(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,d,i=300,r=1e-50,o=1e-20,a=t+n,u=t+1,s=t-1,c=1,f=1-a*e/u,l=f=1/(f=ut(f)<r?r:f),h=1;h<=300&&(l=(l*=(f=1/(f=ut(f=1+(v=(n-h)*h*e/((s+(d=h+h))*(t+d)))*f)<r?r:f))*(c=ut(c=1+v/c)<r?r:c))*(d=(f=1/(f=ut(f=1+(v=0-(t+h)*(a+h)*e/((t+d)*(u+d)))*f)<r?r:f))*(c=ut(c=1+v/c)<r?r:c)),!(ut(d-1)<o));h++);return l}function S(t){var n;return[22250738585072014e-324,17976931348623157e292,ot(2,-53),ot(2,-52),F.ckt(2,10)][t-1]||0}function qt(t,n,e){var i,r,o,i=0,r=0;if(n<1)return 0;for(o=1;o<=n;o++)if(e<(r+=ut(ft(t[i=n-o]))))return i;return i}function $t(t,n,e){var i,r,o,a,u;if(e<1||1e3<e||t<-1.1||1.1<t)return NaN;for(i=2*t,a=o=r=0,u=1;u<=e;u++)o=r,a=i*(r=a)-o+ft(n[e-u]);return.5*(a-o)}function tn(t){var n,e,i,r,r,n=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],e=qt(n,15,S(3)),i=1/st(S(3)),r=at(k(ct(S(2)/12),-ct(12*S(1))));return t<10?NaN:r<=t?4930380657631324e-47:t<i?$t((r=10/t)*r*2-1,n,e)/t:1/(12*t)}function nn(t){var n,e,n=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],e=qt(n,43,.1*S(3));return t<=-1?NaN:ut(t)<=.375?t*(1-t*$t(t/.375,n,e)):ct(t+1)}function en(t){var n,e,i,r,o,a,u,s,r=1,o=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(171<t)return 1e308;if(t===C(t))if(0<t)for(n=1,a=2;a<t;a++)n*=a;else n=1e308;else{if(1<ut(t)){for(i=ut(t),u=C(i),e=1;e<=u;e++)r*=i-e;i-=u}else i=t;for(s=o[24],e=23;0<=e;e--)s=s*i+o[e];n=1/(s*i),1<ut(t)&&(n*=r,t<0)&&(n=-h/(t*n*A(h*t)))}return n}function rn(t){var n,e,i,r,o,a,u,s,e=0,i=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],r=t;if(t<=0)return 1e308;if(1===t||2===t)return 0;for(o=1/((r=t<=7?t+(e=C(7-t)):r)*r),a=2*h,u=i[9],n=8;0<=n;n--)u=u*o+i[n];if(s=u/r+.5*ct(a)+(r-.5)*ct(r)-r,t<=7)for(n=1;n<=e;n++)s-=ct(r-1),--r;return s}function on(t,n){var e,i,t,n,i=t=t;return t<n&&(t=n),(i=n<i?n:i)<0?NaN:0===i?ht:10<=i?(e=tn(i)+tn(t)-tn(i+t),-.5*ct(t)+.9189385332046728+e+(i-.5)*ct(i/(i+t))+t*nn(-i/(i+t))):10<=t?(e=tn(t)-tn(i+t),n=ai(i),lt(n)?NaN:ft(n)+e+i-i*ct(i+t)+(t-.5)*nn(-i/(i+t))):ct(en(i)*(en(t)/en(i+t)))}function an(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,s=S(3),c=ct(s),f=S(1),l=ct(f),h=t,d=n,v=e;if(d/(d+v)<t&&(h=1-h,d=e,v=n),(d+v)*h/(d+1)<s)i=0,l<(o=d*ct(O(h,f))-ct(d)-on(d,v))&&0!==h&&(i=at(o)),h===t&&d===n||(i=1-i);else{if(0===(m=v-T(v))&&(m=1),i=0,l<=(o=d*ct(h)-on(m,d)-ct(d))&&(r=(i=at(o))*d,1!==m))for(u=C(O(c/ct(h),4)),g=1;g<=u;g++)i+=(r=r*((a=g)-m)*h/a)/(d+a);if(1<v){for(o=d*ct(h)+v*ct(1-h)-on(d,v)-ct(v),p=C(O(o/l,0)),r=at(o-p*l),w=v*(b=1/(1-h))/(d+v-1),y=0,v===(u=C(v))&&(u-=1),g=1;g<=u&&!(w<=1&&r/s<=y);g++)1<(r=(v-(a=g)+1)*b*r/(d+v-a))&&(p-=1,r*=f),0===p&&(y+=r);i+=y}i=O(k(i=h===t&&d===n?i:1-i,1),0)}return i}function un(t){var t,t;return t=ft(t=.7071067811865475*-t),x(t)?p:(t=d(t*st(2)),lt(t)?NaN:.5*(2-2*t))}function sn(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p;function b(t,n){return t<0&&0<n||0<t&&n<0}for(r=1e-307,o=222045e-21,a=t.Sl(n),u=t.Sl(e),c=0;c<1e3&&!b(a,u);c++)ut(a)<=ut(u)?((n+=2*((s=n)-e))<0&&(n=0),e=s,u=a,a=t.Sl(n)):(e+=2*((s=e)-n),n=s,a=u,u=t.Sl(e));if(0===a)return n;if(0===u)return e;if(!b(a,u))return i.l9t=!0,0;for(d=u,m=l=a,g=.5*((v=f=n)+(h=e)),p=!0,c=0;c<500&&ut(m)>r&&e-n>O(ut(n),ut(e))*o;)(p=p&&l!==d&&d!==m&&m!==l&&n<(g=f*m*d/(m-l)/(d-l)+v*d*l/(d-m)/(l-m)+h*l*m/(l-d)/(m-d))&&g<e)||(g=.5*(n+e),h=e,d=u,p=!0),f=h,h=v,v=g,l=d,d=m,b(a,m=t.Sl(g))?(e=v,u=m):(n=v,a=m),p=p&&2*ut(m)<=ut(d),++c;return v}function cn(t,n){for(var e,i,r,o,a,e=M(n),i=0;i<e;i++)a=(o=(r=ft(n[i]))-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*o*a,t.N++,t.h9t+=r}function fn(t){var n,e,i,r,o,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],e=1.000000000190015,r=t,o=t+5.5;for(o-=(t+.5)*ct(o),i=0;i<=5;i++)e+=n[i]/++r;return-o+ct(2.5066282746310007*e/t)}function ln(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,g,g,i=0===e||1===e?0:at(fn(t+n)-fn(t)-fn(n)+t*ct(e)+n*ct(1-e)),r=(t+1)/(t+n+2)<=e;for(r&&(o=t,t=n,n=o,e=1-e),a=4450147717014403e-323,u=100,f=t-1,d=h=(l=1)/(h=ut(h=1-(s=t+n)*e/(c=t+1))<a?a:h),v=1,m=2;v<=100;v++,m+=2)if(d=(d*=(h=1/(h=ut(h=1+(g=v*(n-v)*e/((f+m)*(t+m)))*h)<a?a:h))*(l=ut(l=1+g/l)<a?a:l))*(g=(h=1/(h=ut(h=1+(g=-(t+v)*(s+v)*e/((t+m)*(c+m)))*h)<a?a:h))*(l=ut(l=1+g/l)<a?a:l)),ut(ft(g-1))<5e-324)return g=i*d/t,r?1-g:g;return U}function hn(t,n){for(var e,i,r,o,a,e=M(n),i=0;i<e;i++)(r=n[i])!==w&&(a=(o=r-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*o*a,t.N++,t.h9t+=r)}function dn(t){t.sort(function(t,n){return t-n})}function vn(t,n){for(var e,i,e=0;e<M(t);e++)(i=t[e])!==w&&n.push(i);dn(n)}function mn(t){for(var n,e,n=[],e=0;e<M(t);e++)vn(t[e],n);return n}function gn(t,n,e){var i,r,e,i,r,o,a,u,s,c,f,l,h,i=Math.expm1||function(t){return at(t)-1},r=Math.log1p||function(t){return ct(1+t)};return t<=0?0:1<=t?1:1===e?ot(t,n):1===n?-i(e*r(-t)):(i=.5-t+.5,r=r(-t),a=ct(o=t),(c=(u=n)/(n+(s=e))<t)&&(u=e,s=n,o=i,a=r,r=ct(i=t)),e=pn(o,u,s),e=(e/=u)*(h=1<u&&1<s&&(f=u/(u+s))<.97&&(l=s/(u+s))<.97?bn(o,u,s)*o*i:at(u*a+s*r-wn(!1,u,s))),(e=1<(e=c?.5-e+.5:e)?1:e)<0?0:e)}function pn(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,v,u=222045e-21,s=1,c=1,f=1-(n+e)/(n+1)*t,a=0===f?(i=0,r=1):(i=1)*(r=1/f),o=1,l=1,h=5e4,d=!1;i=(s=(i+(m=l*(e-l)*t/(((v=n+2*l)-1)*v))*s)*r)+(v=-(n+l)*(n+e+l)*t/(v*(v+1)))*i*r,0!==(f=(c=(f+m*c)*r)+v*f*r)&&(d=ut(a-(o=i*(r=1/f)))<ut(a)*u),a=o,(l+=1)<5e4&&!d;);return a}function bn(t,n,e){var i,r,o,a,u,o,s;return 1===n?1===e?1:2===e?-2*t+2:t<=.01?e+e*at((e-1)*ct(1-t))-1:e*ot(.5-t+.5,e-1):1===e?2===n?n*t:n*ot(t,n-1):t<=0&&!(n<1&&0===t)||1<=t&&!(e<1&&1===t)?0:(i=ct(S(2)),r=ct(S(1)),o=ct(t<.1?1+t:1-t),u=(n-1)*(a=ct(t)),o=(e-1)*o,s=wn(!1,n,e),u<i&&r<u&&o<i&&r<o&&s<i&&r<s&&u+o<i&&r<u+o?ot(t,n-1)*ot(.5-t+.5,e-1)/wn(!0,n,e):at(u+o-s))}function wn(t,n,e){var i,r,o,e,a,n,e,u,e,s,u,i,i=e,r=n,o;return e<n&&(e=i,i=r,r=e),t&&i+r<171.624376956302?yn(i)/yn(i+r)*yn(r):(n=(a=6.02468004077673)-.5,e=Cn(i),e=(e/=Cn(i+r))*Cn(r),u=i+r+n,e=t?e*st(u/(i+n)/(r+n)):ct(e)+.5*(ct(u)-ct(i+n)-ct(r+n)),u=i/(r+n),i=-i*ct(1+(s=r/(i+n)))-r*ct(1+u)-n,t?at(i)*e:i+e)}function l(t){var n,e,i,r,n=Cn(t),e,i=t+6.02468004077673-.5,r=ot(i,t/2-.25);return n=(n*=r)/at(i)*r,n=t<=20&&t===F.d9t(t)?j(n):n}function yn(t){var n,e,i,r,o,n=ct(h),e=ct(S(2)),i;return 171.624376956302<t?U:1<=t?l(t):.5<=t?l(t+1)/t:-.5<=t?e<=(r=l(t+2)-ct(t+1)-ct(ut(t)))?U:l(t+2)/(t+1)/t:e<=(o=l(1-t)+ct(ut(A(h*t))))-n?0:o<0&&e<n-o?U:at(n-o)*(A(h*t)<0?-1:1)}function Mn(t){var n;return 171.624376956302<=t?l(t):1<=t?ct(l(t)):.5<=t?ct(l(t+1)/t):l(t+2)-ct(t+1)-ct(t)}function Cn(t){var n,e,i,r,o,a,n=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],e=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(t<=1)for(i=n[12],r=e[12],o=11;0<=o;--o)i=i*t+n[o],r=r*t+e[o];else for(a=1/t,i=n[0],r=e[0],o=1;o<=12;++o)i=i*a+n[o],r=r*a+e[o];return i/r}function Sn(t,n){return t<=0?0:Tn(n/2,t/2)}function Tn(t,n){var e,e,e=t*ct(n)-n-Mn(t),e=at(e);return t+1<n?1-e*In(t,n):e*An(t,n)}function An(t,n){for(var e,i,r,o,a,e=.5*S(3),i=t,r=1/t,o=r,a=1;o+=r=r*n/(i+=1),a+=1,e<r/o&&a<=1e4;);return 1e4<a?p:o}function In(t,n){for(var e,i,r,o,a,u,s,c,f,l,a,h,d,v,m,g,e=S(3),i=.5*e,r=1/e,o=0,u=1-t,s=n+2-t,f=n+1,l=1,h=s*n,d=n,v=f/h,m=!1;c=f*(s+=2)-l*(a=(u+=1)*(o+=1)),0!=(a=h*s-d*a)&&(m=ut((v-(g=c/a))/g)<=i,v=g),l=f,d=h,h=a,ut(f=c)>r&&(l*=e,f*=e,d*=e,h*=e),!m&&o<1e4;);return m?v:p}function xn(t,n){var e,i;if(t<=0)return 0;if(1391e3<n*t)e=at((.5*n-1)*ct(.5*t)-.5*t-ct(2)-Mn(.5*n));else{for(i=n%2<.5?(e=.5,2):(e=1/st(2*t*h),1);i<n;)e*=t/i,i+=2;e=1425<=t?at(ct(e)-t/2):e*at(-t/2)}return e}function Nn(t,n,e,i){var r,o,e,t,r=L(e,t);return lt(r)||(o=ft(r),r=L(i-e,n-t),lt(r))||(e=ft(r),r=L(i,n),lt(r))?r:(t=ft(r),E(o*e/t))}function kn(t,n,e){var i,r,o,i=gn(n/(n+t*t),n/2,.5);switch(e){case 1:return.5*i;case 2:return i;case 3:return ot(1+t*t/n,-(n+1)/2)/(st(n)*wn(!0,.5,n/2));case 4:return o=.5*gn(r=n/(t*t+n),.5*n,.5),t<0?o:1-o}return p}function _n(n,e,i){return{Sl:function(t){return n-kn(t,e,i)}}}function Dn(t,n,e){var i,r,t,i={l9t:!1},r,t=sn(_n(t,n,e),.5*n,n,i);return i.l9t?G:t}function jn(t,n){for(var e=!1,i=0,r,o,a,u,s,o=0;o<M(n);o++)for(s=n[o],a=0;a<M(s);a++)if(u=s[a],b(u)||Z(u)||W(u))r=W(u)?0:ft(u),(!e||t&&i<r||!t&&r<i)&&(i=r),e=!0;else if(lt(u))return u;return i}function On(t,n,e,i){for(var r,o,a,u,s,i,r=0,o=0,a=0,u=0;u<M(n);u++)(s=n[u])!==w&&(s<e?r++:e<s?a++:o++);return 0===o?G:(i=(0===i?a:r)+1,t?i:i+(o-1)/2)}function En(t,n,e){for(var i,r,o,a,u,s,c,f,o=0;o<M(t);o++)for(s=!!(u=t[o]).isArray,c=!!u.isReference,a=0;a<M(u);a++)if((r=u[a])!==V)if(W(r)){if(B.ExcelCompatibleCalcMode){if(s)continue;if(c){n.n++;continue}}if(B.Convert.sJ(r,f={value:0}))n.v9t+=i=f.value,n.m9t+=i*i;else if(!u.isArray&&!u.isReference)return p;n.n++}else{if(lt(r))return r;!b(r)||e&&"boolean"==typeof r&&u.isArray||(i=ft(r),n.v9t+=i,n.m9t+=i*i,n.n++)}}function Rn(t,n,e,i){var r,t,i,r={v9t:0,m9t:0,n:0},t=En(t,r,i);return lt(t)?t:r.n<=n?I:(i=O(0,(r.n*r.m9t-r.v9t*r.v9t)/(r.n*(r.n-n))),i=e?st(i):i,E(i))}function Fn(t,n,e){var i,r,o,a,u,s,c,f,l,h,o=0,a=0,u=0,s=0,f=M(n);if(f!==M(e))return G;for(c=0;c<f;c++)i=n[c],r=e[c],i!==w&&r!==w&&(o+=i,a+=r,s++);if(s<=1)return I;for(l=o/s,h=a/s,c=0;c<f;c++)i=n[c],r=e[c],i!==w&&r!==w&&(u+=(i-l)*(r-h));return E(t?u/s:u/(s-1))}function Ln(t,n){for(var e,i,r,o,a,u,e=t?1:0,i=0,a=0;a<M(n);a++)for(r=n[a],u=0;u<M(r);u++)if((o=r[u])!==w){if(o<=0)return U;e=t?e*o:e+1/o,i++}return t?i<=0?I:E(ot(e,1/i)):0===e?I:E(i/e)}function Bn(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,F,S,T,A,I,x,u,N,L,k,u,_,D,j,O,E,R,k,N,o=n.rowCount,a=n.colCount,f=(e=t?e!==P?H(e,1,!1,!0,!0):n:(u=e!==P?e:function(t,n){var e=[];for(s=0;s<t;s++)for(e[s]=[],c=0;c<n;c++)e[s][c]=s*n+c+1;return new B.CalcArray(e)}(o,a),H(u,1,!1,!0,!0))).rowCount,l=e.colCount;if(o===f&&a===l&&(i||!r)){for(v=t?f*l:ft(f*l),u=void(x=I=A=T=S=0),s=0;s<f;s++)for(c=0;c<l;c++)m=e[s][c],g=n[s][c],S+=m,T+=m*m,A+=g=t?ct(g):g,I+=g*g,x+=m*g;return M=v*T-S*S,d=i?(v*x-S*A)/M:x/T,u=i?(A*T-S*x)/M:0,t&&(d=at(d),u=at(u)),w=[[d,u]],r&&(w[1]=[],w[2]=[],w[3]=[],w[4]=[],u=I-u*A-d*x,_=(k=v*x-S*A)*k/((N=v*T-S*S)*(L=v*I-A*A)),v<3?(w[1][0]=U,w[1][1]=U,w[2][1]=U,w[3][0]=U):(w[1][0]=st(u*v/(N*(v-2))),w[1][1]=st(u*T/(N*(v-2))),w[2][1]=st((L-k*k/N)/(v*(v-2))),w[3][0]=1==_?U:_*(v-2)/(1-_)),w[2][0]=_,w[3][1]=v-2,w[4][0]=L/v-u,w[4][1]=u),new B.CalcArray(w)}if(1===a&&o===f||1===o&&a===l){if(g=[],m=[],v=f,d=l,1===a){for(s=0;s<v;s++)g[s]=n[s][0],t&&(g[s]=ct(g[s]));m=e}else{for(s=0;s<d;s++)g[s]=n[0][s],t&&(g[s]=ct(g[s]));for(s=0;s<d;s++)for(m[s]=[],c=0;c<v;c++)m[s][c]=e[c][s]}for(D=[],h=0;h<d+1;h++)D[h]=[];for(p=0;p<d+1;p++)for(b=0;b<d+2;b++)D[p][b]=0;for(j=[],p=0;p<d+2;p++)j[p]=0;for(O=r?[]:V,h=0;h<v;h++)for(j[d+1]+=g[h]*g[h],D[0][d+1]+=g[h],j[0]=D[0][d+1],s=0;s<d;s++)for(D[0][s+1]+=m[h][s],D[s+1][0]=D[0][s+1],D[s+1][d+1]+=m[h][s]*g[h],j[s+1]=D[s+1][d+1],c=s;c<d;c++)D[c+1][s+1]+=m[h][s]*m[h][c],D[s+1][c+1]=D[c+1][s+1];if(D[0][0]=v,r){for(p=0;p<d+1;p++)for(O[p]=[],b=0;b<d+1;b++)O[p][b]=0;for(s=0;s<d+1;s++)O[s][s]=1}for(s=E=i?0:1;s<d+1;s++){if(0===D[s][s]){for(y=!1,c=s+1;!y&&c<d+1;c++)if(0!==D[c][s]){for(h=0;h<d+2;h++)M=D[s][h],D[s][h]=D[c][h],D[c][h]=M;if(r)for(h=0;h<d+1;h++)M=O[s][h],O[s][h]=O[c][h],O[c][h]=M;y=!0}if(!y)return U}for(C=1/D[s][s],h=E;h<d+2;h++)D[s][h]*=C;if(r)for(h=E;h<d+1;h++)O[s][h]*=C;for(c=E;c<d+1;c++)if(c!==s){for(C=-D[c][s],h=E;h<d+2;h++)D[c][h]+=C*D[s][h];if(r)for(h=E;h<d+1;h++)O[c][h]+=C*O[s][h]}i||(D[0][d+1]=0)}for(w=t?[[],d+1]:[[]],s=0;s<d+1;s++)w[0][s]=t?at(D[d-s][d+1]):D[d-s][d+1];if(r){if(t)w[1]=[],w[2]=[],w[3]=[],w[4]=[];else for(p=1;p<5;p++)for(w[p]=[],b=0;b<d+1;b++)w[p][b]=0;for(N=k=R=void 0,k=j[d+1]-j[0]*j[0]/v,R=j[d+1],s=0;s<d+1;s++)R-=D[s][d+1]*j[s];if(N=k-R,w[2][0]=0==k?U:N/k,w[4][0]=N,w[4][1]=R,0===(M=i?v-d-1:v-d)){for(s=0;s<d+1;s++)w[1][s]=U;w[2][1]=U}else{for(F=R/ft(M),i||(w[1][d]=G),s=E;s<d+1;s++)w[1][d-s]=st(F*O[s][s]);w[2][1]=st(F)}for(w[3][0]=0===R?U:ft(M)*N/(R*ft(d)),w[3][1]=ft(M),s=2;s<5;s++)for(c=2;c<d+1;c++)w[s][c]=G}return new B.CalcArray(w)}return U}function Pn(t,n){for(var e,i,r,o,a,u,s,c,f,r=0,o=0,a=0,f=[],u=0;u<M(n);u++)for(c=n[u],f.push(c),s=0;s<M(c);s++)(e=c[s])!==w&&(r+=e,a++);for(i=r/a,u=0;u<M(n);u++)for(c=f[u],s=0;s<M(c);s++)(e=c[s])!==w&&(o+=t?(e-i)*(e-i):ut(e-i));return t?E(o):0===a?I:E(o/a)}function Gn(t,n,e,i){var r,o;for(n=n!==P?H(n,0,!1,!0,!1):t,e=e!==P?H(e,0,!1,!0,!1):n,r=0;r<t.rowCount;r++)for(o=0;o<t.colCount;o++)if(!b(t[r][o]))return p;for(r=0;r<n.rowCount;r++)for(o=0;o<n.colCount;o++)if(!b(n[r][o]))return p;for(r=0;r<e.rowCount;r++)for(o=0;o<e.colCount;o++)if(!b(e[r][o]))return p;return g.Common.eit(t,n,e,i,ft,B.CalcArray,p,G)}function Un(t,n,e,i){return n=n!==P?H(n,1,!1,!0,!0):t,e=e!==P?H(e,1,!1,!0,!0):n,g.Common.iit(t,n,e,i,B.CalcArray,U,G)}function Hn(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i=0,r=0,o=0,a=0,u=M(n),s=0;if(u!==M(e))return G;for(c=0;c<u;c++)f=n[c],l=e[c],f!==w&&l!==w&&(i+=f,r+=l,o+=l*l,a+=l*f,s++);return 0===s||s*o-r*r==0?I:E((d=i/s-r/s*(h=(s*a-r*i)/(s*o-r*r)))+h*t)}function Vn(){return z(arguments,2,1)}function zn(){return Y(arguments,2,7)}function Yn(t,n){return e([t,n],16)}function Zn(){return z(arguments,2,4)}function Wn(){return jn(!0,arguments)}function Qn(){return z(arguments,2,5)}function Jn(){return jn(!1,arguments)}function Kn(t,n){return e([t,n],14)}function Xn(t,n){return e([t,n],15)}function qn(){for(var t,n,e,i,r,o,a,t=arguments,n=0,e=0,i=0;i<M(t);i++)for(a=t[i],r=0;r<M(a);r++)o=a[r],b(o,!0)||Z(o)?(n+=ft(o),e++):o!==V&&!W(o)||e++;return 0===e?I:E(n/e)}function $n(){return e(arguments,12)}function te(){return e(arguments,13)}function ne(){return Ln(!0,arguments)}function ee(){return Ln(!1,arguments)}function ie(t,n){var e,i,r,o,a,e=0,i=[];for(vn(t,i),r=Wt(i),a=o=y((r*n/2).toString());a<r-o;a++)e+=ft(i[a]);return e/(r-2*o)}function re(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,e=0,a=n.rowCount,u=n.colCount,i=0;i<a;i++)for(r=0;r<u;r++)n[i][r]!==w&&e++;for(s=t.rowCount,c=t.colCount,f=[],l=[],h=e+1,i=e=0;i<a;i++)for(r=0;r<u;r++)(o=n[i][r])!==w&&(f[e]=ft(o),e++);for(d=f.slice(0),dn(f),i=0;i<h;i++)l[i]=[0];for(i=0;i<s;i++)for(r=0;r<c;r++)if(o=t[i][r],b(o)){for(v=ft(o),m=!1,g=0;!m&&g<e;g++)v<=f[g]&&(l[d.indexOf(f[g])][0]++,m=!0);m||l[e][0]++}return new B.CalcArray(l)}function oe(t,n,e){return On(!0,n,t,e)}function ae(){var t,n,e,i,r,o,a,u,s,c,f,l,h,t=arguments,e=0,i=0,r=0,o=0,a=M(t),h=[];if(0<a){for(h.push(l=t[0]),c=0;c<M(l);c++)(n=l[c])!==w&&(e+=n,i+=n*n,o++);if(o<=3)return I;if(u=e/o,0===(s=st((o*i-e*e)/(o*(o-1)))))return I;for(f=0;f<a;f++)for(l=h[f],c=0;c<M(l);c++)(n=l[c])!==w&&(r+=ot((n-u)/s,4));return E(o*(o+1)*r/((o-1)*(o-2)*(o-3))-3*(o-1)*(o-1)/((o-2)*(o-3)))}}function ue(t,n,e){return Kt(t,n,e,!0)}function se(t,n,e){return Kt(t,n,e,!1)}function ce(t,n){return e([t,n],17)}function fe(){return z(arguments,2,2)}function le(){return z(arguments,2,3)}function he(t){for(var n,e,n=0,e=0;e<M(t);e++)t[e]!==V&&""!==t[e]||n++;return n}function de(t,n,e){var i,r,i,t,i=t.source&&t.source.Lbt,r=0,i=i.S9t||new B.Functions.RangeCriteriaManager,t=t.Xkt;return i.T9t(n,e[0],t&&t.delay?-1:1).RDt(function(){r++}),r}function ve(){return Pn(!1,arguments)}function me(){return Rn(arguments,1,!0,!0)}function ge(){return Y(arguments,2,8)}function pe(){return Rn(arguments,0,!0,!1)}function be(){return Y(arguments,2,10)}function we(){return Rn(arguments,1,!1,!1)}function ye(){return Y(arguments,2,11)}function Me(){return Rn(arguments,0,!1,!1)}function Ce(t,n){return Fn(!0,t,n)}function Se(){return Pn(!0,arguments)}function Te(t,n,e){var t=vi(t/2);return lt(t)?t:-ft(t)*(n/st(e))}function Ae(t,n,e){return 1===e?I:n*Dn(t,e-1,2)/st(e)}function Ie(t,n){var e,i,r,o,a,u,s,c,f,l,r=0,o=0,a=0,u=0,f=0,l=M(t);if(l!==M(n))return G;for(c=0;c<l;c++)e=t[c],(i=n[c])!==w&&e!==w&&(r+=e,o+=i,a+=i*i,u+=i*e,f++);return 0===f||f*a-o*o==0?I:E(r/f-o/f*(s=(f*u-o*r)/(f*a-o*o)))}function xe(t,n,e,i){return Bn(!1,t,n,e,i)}function Ne(t,n){var e,i,r,o,a,u,s,c,f,c,f,e=0,i=0,r=0,o=0,a=0,u=M(n);if(u!==M(t))return G;for(s=0;s<u;s++)c=t[s],(f=n[s])===w||c===w||lt(f)||lt(c)||(e+=c=ft(c),i+=f=ft(f),r+=f*f,o+=f*c,a++);return a*r-i*i==0?I:E((a*o-i*e)/(a*r-i*i))}function ke(t,n,e,i){return Bn(!0,t,n,e,i)}function _e(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,r=0,o=0,a=0,u=0,s=0,c=0,f=M(t);if(f!==M(n))return G;for(l=0;l<f;l++)h=t[l],d=n[l],h!==w&&d!==w&&(r+=h,o+=h*h,a+=d,u+=d*d,s+=d*h,c++);return c*(c-2)==0||c*u-a*a==0?I:st((c*o-r*r-(c*s-a*r)*(c*s-a*r)/(c*u-a*a))/(c*(c-2)))}function De(t){var n,e,i,e=t,i=e+5.5;return i-=(e+.5)*ct(i),n=1.000000000190015+76.18009172947146/(t+1),ct(2.506628274631001*(n=(n=(n-=86.50532032941678/(t+2))+24.01409824083091/(t+3)-1.231739572450155/(t+4))+.001208650973866179/(t+5)-5395239384953e-18/(t+6))/e)-i}function je(t,n,e,i,r){var t,r,i,o,a,u,r,i;return t<i||r<t||i===r?U:(t=(t-i)/(r-i),r=De(n+e),i=De(n),o=De(e),a=ct(t),u=ct(1-t),r=at(r-i-o+n*a+e*u),i=t<(n+1)/(n+e+2)?r*Xt(n,e,t)/n:1-r*Xt(e,n,1-t)/e,E(i))}function Oe(t,n,e,i,r,o){var t;return t<r||o<t||r===o?U:(t=(t-r)/(o-r),i?gn(t,n,e):bn(t,n,e)/(o-r))}function Ee(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,e,S,T,A,I,t,x,N,n,k,_,D,j,o=2.30753,a=.27061,u=.99229,s=.04481,c=3e-308,f=1e-300,l=c,h=1-222e-18,d=5,v=6,m=2,M=on(n,e),g=t<=.5?(w=t,S=n,A=e,0):(w=1-t,S=e,A=n,1),I=st(-ct(w*w)),k=I-(o+a*I)/(1+(u+s*I)*I),j=1<S&&1<A?(n=k*st((e=2/((t=1/(S+S-1))+(x=1/(A+A-1))))+(I=(k*k-3)/6))/e-(x-t)*(I+5/6-2/(3*e)),S/(S+A*at(n+n))):(x=(I=A+A)*ot(1-(x=1/(9*A))+k*st(x),3))<=0?1-at((ct((1-w)*A)+M)/A):(x=(4*S+I-2)/x)<=1?at((ct(w*S)+M)/S):1-2/(x+1);for(I=1-S,x=1-A,_=0,y=1,j<l?j=l:h<j&&(j=h),D=O(f,ot(10,-13-2.5/(S*S)-.5/(w*w))),p=N=T=0;p<1e3;p++){for((k=((k=an(j,S,A))-w)*at(M+I*ct(j)+x*ct(1-j)))*_<=0&&(T=O(ut(y),c)),C=1,b=0;b<1e3;b++){if(ut(y=C*k)<T&&0<=(N=j-y)&&N<=1){if(T<=D)return E((r-i)*(j=0!==g?1-j:j)+i);if(ut(k)<=D)return E((r-i)*(j=0!==g?1-j:j)+i);if(0!==N&&1!==N)break}C/=3}if(N===j)return E((r-i)*(j=0!==g?1-j:j)+i);j=N,_=k}return E((r-i)*(j=0!==g?1-j:j)+i)}function Re(t,n,e){var i,r,o,a;if(n<2*t)return Re(n-t,n,1-e);for(o=r=i=0,a=1;i<t||r<t||o<n-t;)i<t&&a<1?a*=(n-t+ ++i)/i:r<t?(r++,a*=e):(o++,a*=1-e);return a}function Fe(t,n,e,i){return i*(n-t)/(t+1)*e/(1-e)}function Le(t,n,e,i){return i*t/(n-t+1)*(1-e)/e}function Be(t,n,e,i){var r,o,r,r,a,u,s,c;if(0===e&&i===t)return 1;if(0===n)return 0===e?1:0;if(1===n)return i===t?1:0;if(e===i)return Re(e,t,n);if(0===(r=e<=(r=Math.floor(t*n))&&r<=i?Re(o=r,t,n):(r=Re(e,t,n),(a=Re(i,t,n))<r?(o=e,r):(o=i,a))))return 0;for(s=u=r,c=o;c<i&&0!==(s=Fe(c,t,n,s));c++)u+=s;for(s=r,c=o;e<c&&0!==(s=Le(c,t,n,s));c--)u+=s;return u}function Pe(t,n,e,i){return n<t?U:i?Be(n,e,0,t):Re(t,n,e)}function Ge(t,n,e){var i;return t+n-1<=0?U:(i=L(t+n-1,n-1),lt(i)?i:E(ft(i)*ot(e,n)*ot(1-e,t)))}function Ue(t,n,e,i){if(t+n-1<=0)return U;if(i)return 1-gn(1-e,t+1,n);for(var r=ot(e,n),o,o=0;o<t;o++)r*=(o+n)/(o+1)*(1-e);return r}function He(t,n,e){for(var i,r,o,a,i=0,r=t;i+1<r;)e<=(a=Be(t,n,0,o=T((i+r)/2)))?r=o:i=o;return r}function Ve(t,n){var e,i,r,o,a,u,s,c,f,t,l,l,e=ct(st(h)),i=1/st(h),s=0,c=t,f=.5*c,t=n%2==0;if(1<n&&(s=at(-f)),l=d(-st(c)),lt(l))return l;if(l=ft(l),o=t?s:2*l,2<n){if(c=.5*(n-1),a=t?1:.5,20<f){for(r=t?0:e,u=ct(f);a<=c;)r=ct(a)+r,o+=at(u*a-f-r),a+=1;return o}for(r=t?1:i/st(f),u=0;a<=c;)u+=r*=f/a,a+=1;return u*s+o}return o}function ze(t,n,e){return(e?Sn:xn)(t,n)}function Ye(t,n){var t=oi(1-t,.5*n,2);return ft(t)}function Ze(n,e){return{Sl:function(t){return n-Sn(t,e)}}}function We(t,n){var e,i,t,e,i={l9t:!1},t=sn(Ze(t,n),.5*n,n,i);return i.l9t?G:t}function Qe(t,n){var e,i,r,o,a,u,s,e=0,r=t.rowCount,o=t.colCount;if(r!==n.rowCount||o!==n.colCount)return G;if(1<r&&1<o)i=(r-1)*(o-1);else if(1<r&&1===o)i=r-1;else{if(!(1===r&&1<o))return G;i=o-1}for(a=0;a<M(t);a++)if(u=t[a],s=n[a],u!==w&&s!==w){if(0===s)return I;e+=(u-s)*(u-s)/s}return e<0?U:Ve(e,i)}function Je(t,n){var e,i,r,o,a,u,s,c,f,l,t,n,h,d,v,m,g,e=B.ExcelCompatibleCalcMode?5:1,i=H(t,e,!0,!1,!1,!0),r=H(n,e,!0,!1,!1,!0),o=0,a=0,u=0,s=0,c=0,h=M(r);if(h!==M(i))return G;for(v=d=0;v<h;v++){if(m=i[v],g=r[v],lt(m))return m;if(lt(g))return g;m!==w&&g!==w&&(o+=m,a+=g,u+=m*m,s+=g*g,d++)}if(d<=1)return I;if(f=o/d,l=a/d,t=st((d*u-o*o)/(d*(d-1))),n=st((d*s-a*a)/(d*(d-1))),0===t||0===n)return I;for(v=0;v<h;v++)m=i[v],g=r[v],m!==w&&g!==w&&(c+=(m-f)*(g-l));return E(c/ft((d-1)*t*n))}function Ke(t,n,e){var t=at(-n*t);return E(e?1-t:n*t)}function Xe(t,n,e){var i,r,o,t,i,r,o,t=je(n*t/(n*t+e),.5*n,.5*e,0,1);return lt(t)?t:1-ft(t)}function qe(t,n,e,i){var r;return i?1-gn(e/(e+n*t),e/2,n/2):ot(n/e,n/2)*ot(t,n/2-1)/(ot(1+t*n/e,(n+e)/2)*wn(!0,n/2,e/2))}function $e(t,n,e){var i,t,i,t=Ee(1-(1-t),e/2,n/2,0,1);return lt(t)?t:(1/ft(t)-1)*(e/n)}function ti(t,n,e){var i,t,i,t=Ee(1-t,e/2,n/2,0,1);return lt(t)?t:(1/ft(t)-1)*(e/n)}function ni(t){return ct((1+t)/(1-t))/2}function ei(t){var n,t,n=at(2*t)-1,t=at(2*t)+1;return!N(n)&&0<n&&!N(t)&&0<t?1:n/t}function ii(t,n){var e,i,e,e,t,n,i,e={N:0,M:0,Q:0,h9t:0};return hn(e,t),t=e.N-1,1===e.N||0==(i=e.Q/(e.N-1))||(e.N=0,e.M=0,e.Q=0,e.h9t=0,hn(e,n),n=e.N-1,1===e.N)||0==(e=e.Q/(e.N-1))?I:(i=Xe(i/e,t,n),lt(i)?i:1<(e=2*(1-ft(i)))?2-e:e)}function ri(t,n,e,i){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,d,w,y,M,C,S,T,A;if(!1===i)return i=ot(e,n),x(i)||!N(i)?I:(r=1/(i*en(n)))*(u=(o=ot(t,n-1))*(a=at(-t/e)));if(M=1/3,C=1e8,S=1e37,A=-88,(t/=e)<=0)return U;if((T=1e3)<n)return y=hi(s=3*st(n)*(ot(t/n,1/3)+1/(9*n)-1),0,1,!0),lt(y)?y:ft(y);if(1e8<t)return 1;if(t<=1||t<n){if(y=ai(n+1),lt(y))return y;for(v=n*ct(t)-t-ft(y),w=m=1,p=n;w+=m=m*t/(p+=1),2220446049250313e-31<m;);v+=ct(w),w=0,-88<=v&&(w=at(v))}else{if(y=ai(n),lt(y))return y;for(v=n*ct(t)-t-ft(y),m=0,w=(f=(c=t)+(s=1))/(l=t*(b=(p=1-n)+t+1));;){if(h=(b+=2)*f-(d=(p+=1)*(m+=1))*s,0<ut(d=b*l-d*c)){if(ut(w-(g=h/d))<=k(2220446049250313e-31,2220446049250313e-31*g))break;w=g}s=f,c=l,l=d,ut(f=h)>=S&&(s/=S,c/=S,f/=S,l/=S)}v+=ct(w),w=1,-88<=v&&(w=1-at(v))}return w}function oi(t,n,e){var i,r,o,a,R,F,L,B,P,G,U,u,H,V,s,z,Y,Z,W,Q,J,K,X,q,$,tt,c,f,l,h,d,v,m,nt,g,et,it,rt,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,m,O,E,i=4.67,r=6.66,o=6.73,a=13.32,R=60,F=70,L=84,B=105,P=120,G=127,U=140,u=1175,H=210,V=252,s=2264,z=294,Y=346,Z=420,W=462,Q=606,J=672,K=707,X=735,q=889,$=932,tt=966,c=1141,f=1182,l=1278,h=1740,d=2520,v=5040,m=5e-7,nt=.01,g=5e-7,et=20,it,rt;if(t<2e-6)return 0;if(.999998<t)return ht;if(S=2*n,w=n-1,E=ai(n),lt(E))return E;if(M=ft(E),S<-1.24*ct(t)){if((y=ot(t*n*at(M+.6931471805599453*n),1/n))<m)return NaN}else if(.32<S){if(E=di(t,0,1),lt(E))return E;m=ft(E),2.2*S+6<(y=S*ot(m*st(C=.222222/S)+1-C,3))&&(y=-2*(ct(1-t)-w*ct(.5*y)+M))}else for(y=.4,p=ct(1-t)+M+.6931471805599453*w;j=(i+2*(A=y))/(C=1+y*(i+y))-.5-(o+y*(a+3*y))/(T=y*(o+y*(r+y))),y-=(1-at(p+.5*y)*T/C)/j,.01<ut(A/y-1););for(O=1;O<=20;O++){if(E=ri(C=.5*(A=y),n,1,!0),lt(E))return E;if(j=(T=t-ft(E))*at(.6931471805599453*n+M+C-w*ct(y)),ut(A/(y+=j*(1+.5*j*(I=(210+(p=.5*j-(b=j/y)*w)*(140+p*(105+p*(84+p*(70+60*p)))))/420)-b*w*(I-b*((x=(420+p*(735+p*(966+p*(c+l*p))))/d)-b*((N=(210+p*(462+p*(707+932*p)))/d)-b*((k=(252+p*(672+f*p)+w*(294+p*(889+h*p)))/v)-b*((_=(84+s*p+w*(u+606*p))/d)-b*(D=(120+w*(346+127*w))/v))))))))-1)>g)return.5*e*y}return.5*e*y}function ai(t){return rn(t)}function ui(t,n,e,i){return t>k(n,e)||t<O(0,n-i+e)||i<n||i<e?U:Nn(t,n,e,i)}function si(t,n,e,i,r){var o,a;if(t>k(n,e)||t<O(0,n-i+e)||i<n||i<e)return U;if(r){for(a=o=0;a<=t;a++)o+=Nn(a,n,e,i);return o}return Nn(t,n,e,i)}function ci(t,n,e){return d((ct(t)-n)/e)}function fi(t,n,e,i){var i;return i?d((ct(t)-n)/e):(i=(ct(t)-n)/e,.3989422804014327*at(-i*i/2)/e/t)}function li(t,n,e){var t,t,t=vi(t);return lt(t)?t:(t=ft(t),E(at(n+e*t)))}function hi(t,n,e,i){return i?d((t-n)/e):E(at(-(t-n)*(t-n)/(2*e*e))/(st(2*h)*e))}function di(t,n,e){var i,r,o,i,o,i,o=t-.5;if(ut(o)<=.42)r=o*(((-25.44106049637*(i=o*o)+41.39119773534)*i-18.61500062529)*i+2.50662823884)/((((3.13082909833*i-21.06224101826)*i+23.08336743743)*i-8.4735109309)*i+1);else{if(i=t,!(2220446049250313e-31<(i=0<o?1-t:i)))return 1e-300<i?(r=-2*ct(t),i=ct(6.283185307179586*r),r=st(r*(1-(i=i/r+(2-i)/(r*r)+(6*i-14-i*i)/(2*r*r*r)))),o<0?-r:r):o<0?-ht:ht;r=(((2.32121276858*(i=st(-ct(i)))+4.85014127135)*i-2.29796479134)*i-2.78718931138)/((1.63706781897*i+3.54388924762)*i+1),o<0&&(r=-r)}return o=.3989422804014327*at(-.5*(i=+r)*i),i=hi(r,0,1,!0),lt(i)?i:n+e*(r-=(i-t)/o)}function vi(t){return di(t,0,1)}function mi(t,n){return n?un(t):at(-ot(t,2)/2)/st(2*h)}function gi(t,n){var e,i,r,o,a,u,s,c,f,l,e=0,i=0,r=0,o=0,a=0,u=M(t);if(u!==M(n))return G;for(c=s=0;c<u;c++)f=t[c],l=n[c],Q(f)&&Q(l)&&(e+=f,i+=l,r+=f*f,o+=l*l,a+=f*l,s++);return s*r-e*e==0||s*o-i*i==0?I:(s*a-e*i)/st((s*r-e*e)*(s*o-i*i))}function pi(t,n){var e,i,r,o,a,u,s,c,f,l,h,h,e=0,i=0,r=0,o=0,a=0,u=0,s=M(n);if(s!==M(t))return G;for(c=0;c<s;c++)f=n[c],l=t[c],Q(f)&&Q(l)&&(e+=f,i+=l,r+=f*f,o+=l*l,a+=f*l,u++);return 0===(h=st((u*r-e*e)*(u*o-i*i)))?I:E((h=(u*a-e*i)/h)*h)}function bi(t,n,e){var i,r,i=0;if(e)for(r=0;r<=t;r++)i+=at(-n)*ot(n,r)/B.Functions.nkt(r);else i=at(-n)*ot(n,t)/B.Functions.nkt(t);return E(i)}function wi(t,n,e,i){var r,o,a,u,s,c,f,r=e;if(i!==P&&(r=ft(i),x(r)))return p;if(a=o=0,(u=M(t))!==M(n))return G;for(s=0;s<u;s++)if(c=t[s],f=n[s],c!==w&&f!==w){if(f<=0||1<f)return U;e<=c&&c<=r&&(o+=f),a+=f}return 1!==a?U:o}function yi(){for(var t,n,e,i,r,o,a,u,s,c,f,l,t=arguments,n=0,e=0,i=0,a=0,f=[],u=0;u<M(t);u++)for(f.push(l=t[u]),s=0;s<M(l);s++)(c=l[s])!==w&&(n+=c,e+=c*c,a++);if(a<=2)return I;if(r=n/a,0===(o=st((a*e-n*n)/(a*(a-1)))))return I;for(u=0;u<M(f);u++)for(l=f[u],s=0;s<M(l);s++)(c=l[s])!==w&&(i+=ot((c-r)/o,3));return E(a*i/((a-1)*(a-2)))}function Mi(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,t=arguments,n=0,r=0,c=[],o=0;o<M(t);o++){if(s=t[o],1===M(t)&&0===M(s))return R;for(a=0;a<M(s);a++)f={value:0},(u=s[a])!==w&&"boolean"!=typeof u&&J(u,f)&&(n+=f.value,r++,c.push(f.value))}if(r<=2)return I;for(e=n/r,o=d=h=l=0;o<c.length;o++)h+=ot(d=c[o]-e,2),l+=ot(d,3);return 0===(i=st(h/r))?I:E(l/r/i/i/i)}function Ci(t,n,e){return(t-n)/e}function Si(t,n,e){var i,r,o,a,t,u,s,c,f,l;if(1!==e&&2!==e)return U;if(r=t/st(i=n),o=i/(i+t*t),a=i-2,t=i%2,i=s=u=1,f=c=2+t,2<=a)for(l=C(c);l<=a&&(u+=s=s*o*(f-1)/f)!==i;l+=2)i=u,f+=2;return 1!=t?e*(1-(.5+.5*r*st(o)*u)):e*(1-(.5+.3183098862*(r*o*(u=1===n?0:u)+D(r))))}function Ti(t,n,e){return kn(t,n,e?4:3)}function Ai(t,n){return Si(t,n,1)}function Ii(t,n){return Si(t,n,2)}function xi(t,n){var e,i,e,r,o,a,t,u,t,s,c,t,i,t,e=1e-12,t=t/2,i=t;if(1e20<n)return vi(t);if(t=i<.5?(c=0,2*i):2*((c=1)-i),ut(n-2)<e)u=0<t?st(2/(t*(2-t))-2):ht;else if(ft(n)<1+e)u=0<t?-_(a=1.5707963267948966*(t+1)):ht;else{if(o=((94.5/((e=48/((i=1/(n-.5))*i))+(r=((20700*i/e-98)*i-16)*i+96.36))-3)/e+1)*st(1.5707963267948966*i)*n,.05+i<(s=ot(o*t,2/n))){if(t=vi(.5*t),lt(t))return t;t=ft(t),n<5&&(r+=.3*(n-4.5)*(t+.6)),s=(((((.4*(s=t*t)+6.3)*s+36)*s+94.5)/(r=(((.05*o*t-5)*t-7)*t-2)*t+e+r)-s-3)/e+1)*t,s=.002<(s*=i*s)?at(s)-1:.5*s*s+s}else s=((1/(((n+6)/(n*s)-.089*o-.822)*(n+2)*3)+.5/(n+4))*s-1)*(n+1)/(n+2)+1/s;u=st(n*s)}return E(u=0!==c?-u:u)}function Ni(t,n){return t<.5?-Dn(1-t,n,4):Dn(t,n,4)}function ki(t,n,e,i){var r,o,a,a,u,s,c,f,l,f,h,d,v,m,g,p,b,w,y,i,i,f={N:0,M:0,Q:0,h9t:0};if(1!==e&&2!==e)return U;if(1===i){if(b=p=g=m=v=d=h=void 0,M(t)!==M(n))return G;for(w=M(t),b=0;b<w;b++)t[b]=t[b]-n[b];for(b=m=g=p=h=0;b<w;b++)m+=v=(d=(y=t[b])-m)/(p+1),g+=p*d*v,p++,h+=y;if(p-1==0||0===p)return I;if(a=st(g/(p-1)),x(a)||!N(a))return U;a=(r=h/p)/(a/st(p)),c=p-1}else f.N=0,f.M=0,f.Q=0,f.h9t=0,cn(f,t),u=f.Q/(f.N-1),r=f.h9t/f.N,l=f.N,f.N=0,f.M=0,f.Q=0,f.h9t=0,cn(f,n),s=f.Q/(f.N-1),o=f.h9t/f.N,f=f.N,c=2!==i?1/((i=u/l/(u/l+s/f))*i/ft(l-1)+(1-i)*(1-i)/ft(f-1)):ft(l+f-2),a=(r-o)/st(u/ft(l)+s/ft(f));return i=ln(.5*c,.5,c/(c+(a=ut(a))*a)),lt(i)?i:.5*e*ft(i)}function _i(t,n,e,i){var r=at(-ot(t/e,n));return E(i?1-r:n/ot(e,n)*ot(t,n-1)*r)}function Di(t,n,e){var i,r,o,a,e,u,s,c,s,i,i=0,r=0,o=0,u=0;if(e!==P&&(i=ft(e),x(i)))return p;for(c=0;c<M(t);c++)(s=t[c])!==w&&(r+=s=ft(s),o+=s*s,u++);return 0===u?G:1===u||(a=r/u,0===(e=e!==P?i:st((u*o-r*r)/(u*(u-1)))))?I:(i=d((a-n)/(e/st(u))),lt(i)?i:E(1-ft(i)))}function ji(t,n){t=ft(C(t)),n=ft(C(n));var e=1,i;if(t<0||n<0||t<n)return U;for(i=t-n+1;i<=t;i++)e*=i;return E(e)}function Oi(t,n){return Fn(!1,t,n)}function Ei(){for(var t,n,e,i,r,o,a,t=0,n=[],e=mn(arguments),i=M(e),r=0;r<i;r++){for(o=0,a=r+1;a<i;a++)e[r]===e[a]&&o++;t<o?(t=o,(n=[]).push([e[r]])):o===t&&n.push([e[r]])}return 0===t?G:new B.CalcArray(n)}function Ri(t,n){return e([t,n],18)}function Fi(t,n){return e([t,n],19)}function Li(t,n,e){return On(!1,n,t,e)}function Bi(t,n){var n,n,n=n;return 0<=t&&t<2147483647&&0<=n&&n<2147483647&&(t=Math.pow(y(t),y(n)),(n=Math.abs(t))<=179769e303)?22250738585072014e-324<=n?t:0:U}function Pi(t){var n,n;return""!==t&&!0===J(t,n={value:0})?(t=.3989422804014327*Math.exp(-n.value*n.value*.5),(n=Math.abs(t))<=179769e303?22250738585072014e-324<=n?t:0:U):p}function Gi(t,n,e,i){var r,o,a,u,r={value:0};return t=K(t,r),n=J(n,o={value:0}),e=K(e,a={value:0}),4===arguments.length&&i?i=K(i,u={value:0}):(i=e,u=a),!0===t&&!0===n&&!0===e&&!0===i?(n=o.value,e=a.value,i=u.value,0<=(t=r.value)&&t<=2147483646&&0<=n&&n<=1&&0<=e&&e<=t&&e<=i&&i<=t?Be(t,n,e,i):U):p}function Ui(t){var n,e,n;if(0<t)t=Math.exp(rn(t));else{if(0===(e=t+(n=Math.abs(y(t)))))return U;t=Math.pow(-1,n-1)*Math.exp(rn(-e))*Math.exp(rn(1+e))/Math.exp(rn(n+1-e))}return(n=Math.abs(t))<=179769e303?22250738585072014e-324<=n?t:0:U}function Hi(t){t=Qt(t)-.5;var n=Math.abs(t);return n<=179769e303?22250738585072014e-324<=n?t:0:U}Object.defineProperty(t,"__esModule",{value:!0}),g=m("Common"),B=m("CalcEngine"),M=g.Common.Uf.tR,V=null,P=void 0,x=isNaN,N=isFinite,y=parseInt,ot=Math.pow,O=Math.max,k=Math.min,T=Math.floor,A=Math.sin,_=Math.tan,h=Math.PI,D=Math.atan,at=Math.exp,ut=Math.abs,st=Math.sqrt,ct=Math.log,j=Math.round,I=B.Errors.DivideByZero,p=B.Errors.Value,G=B.Errors.NotAvailable,U=B.Errors.Number,R=B.Errors.Null,E=B.Convert.L6t,H=B.Convert.iV,C=B.Convert.z6t,ft=B.Convert.uJ,F=B.Functions.MathHelper,L=F.g9t,b=B.Convert.q8,lt=B.Convert.BJ,z=B.Functions.b9t,Y=B.Functions.y9t,e=B.Functions.w9t,d=B.Functions.dkt,Z=B.Functions.G6t,W=B.Functions.OMt,Q=B.Functions.q8,ht=B.Functions.B6t,w=B.Convert.CalcConvertedError,t=B.Functions.F6t,J=B.Convert.sJ,K=B.Convert.t9t,m={J6t:0,pkt:["< 0",">= 1"]},f={J6t:4,X6t:1,Vkt:!0,Ykt:!0,Zkt:!0,n9t:!0},vt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,n9t:!0},mt={J6t:4,X6t:1,Ykt:!0,Zkt:!0},gt={J6t:4,X6t:0,Vkt:!0},wt={J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},yt={J6t:4,X6t:0,Vkt:!0,Ykt:!0,Zkt:!0,n9t:!0},St=[c={J6t:4,X6t:1,Vkt:!0,Ykt:!0,Zkt:!0},{J6t:2}],Tt=[c,r={J6t:0},{bkt:3,J6t:2,pkt:"< 1"}],At=[nt={J6t:0,pkt:["<= 0",">= 1"]},o={J6t:0,pkt:"<= 0"},$={J6t:2,pkt:"< 1"}],It=[nt,o,o,et={bkt:0,J6t:0},it={bkt:1,J6t:0}],xt=[i={J6t:2,pkt:"< 0"},i,a={J6t:0,pkt:["< 0","> 1"]},n={J6t:7}],Nt=[i,a,nt],kt=[u={J6t:0,pkt:"< 0"},rt={J6t:0,pkt:["< 1","> 10000000000"]}],_t=[a,tt={J6t:2,pkt:["< 1","> 10000000000"]}],Dt=[dt={J6t:4,X6t:1,Vkt:!0,Ykt:!0},dt],jt=[u,o,n],Ot=[u,s={J6t:0,pkt:["< 1",">= 10000000000"]},s],s=[a,s,s],Et=[c,c],Rt=[u,o,o,n],Ft=[a,o,o],Lt=[a,r,o],Bt=[r,r,o,n],pt=[pt={J6t:4,X6t:1,Vkt:!0},pt],Pt=[i,u,n],Gt=[u,$],Ut=[bt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,M9t:!0},bt,q={J6t:2},{J6t:2,pkt:["< 1","> 3"]}],Ht=[u,o,o,n],zt=[Mt={J6t:4,X6t:1,Ykt:!0,M9t:!0},{},X={bkt:!0,J6t:7},{bkt:!(Vt=[c,r]),J6t:7}],Yt=[r,c,et],Zt=[Ct={J6t:4,X6t:1,Vkt:!0,Ykt:!0,C9t:!0,Zkt:!0},r],t("TREND",Gn,1,4,[{J6t:4,X6t:0,Ykt:!0},{},{},X],[0,1,2],[0,1,2],{wkt:[1,2,3]}),t("GROWTH",Un,1,4,[Mt,{},{},X],"!= 3","!= 3",{wkt:[1,2,3]}),t("FORECAST",Hn,3,3,[r,c,c],"> 0","> 0"),t("AVERAGE",Vn,1,P,P,-1,-1),t("STDEV",zn,1,P,P,-1,-1),t("STDEV.S",zn,1,P,P,-1,-1),t("PERCENTILE",Yn,2,2,P,0,0),t("PERCENTILE.INC",Yn,2,2,P,0,0),t("MAX",Zn,1,P,P,-1,-1),t("MAXA",Wn,1,P,wt,-1,-1),t("MIN",Qn,1,P,P,-1,-1),t("MINA",Jn,1,P,wt,-1,-1),t("LARGE",Kn,2,2,Zt,0,0),t("SMALL",Xn,2,2,Zt,0,0),t("AVERAGEA",qn,1,P,yt,-1,-1),t("MEDIAN",$n,1,P,f,-1,-1),t("MODE",te,1,P,f,-1,-1),t("MODE.SNGL",te,1,P,f,-1,-1),t("GEOMEAN",ne,1,P,vt,-1,-1),t("HARMEAN",ee,1,P,f,-1,-1),t("TRIMMEAN",ie,2,2,[c,m],0,0),t("FREQUENCY",re,2,2,[mt,mt],-1,-1),t("RANK",oe,2,3,Yt,[1],[1],{wkt:2}),t("RANK.EQ",oe,2,3,Yt,[1],1,{wkt:2}),t("KURT",ae,1,P,f,-1,-1),t("PERCENTRANK",ue,2,3,Tt,0,0,{wkt:2}),t("PERCENTRANK.INC",ue,2,3,Tt,0,0,{wkt:2}),t("PERCENTRANK.EXC",se,2,3,Tt,0,0,{wkt:2}),t("QUARTILE",ce,2,2,St,0,0),t("QUARTILE.INC",ce,2,2,St,0,0),t("COUNT",fe,1,P,P,-1,-1,{f9t:-1}),t("COUNTA",le,1,P,P,-1,-1,{f9t:-1}),t("COUNTBLANK",he,1,1,gt,-1,-1),t("COUNTIF",de,2,2,[gt,gt],[0],[0],{f9t:[1],r9t:!0}),t("AVEDEV",ve,1,P,f,-1,-1),t("STDEVA",me,1,P,yt,-1,-1),t("STDEVP",ge,1,P,P,-1,-1),t("STDEV.P",ge,1,P,P,-1,-1),t("STDEVPA",pe,1,P,yt,-1,-1),t("VAR",be,1,P,P,-1,-1),t("VAR.S",be,1,P,P,-1,-1),t("VARA",we,1,P,yt,-1,-1),t("VARP",ye,1,P,P,-1,-1),t("VAR.P",ye,1,P,P,-1,-1),t("VARPA",Me,1,P,yt,-1,-1),t("COVAR",Ce,2,2,Dt,-1,-1),t("COVARIANCE.P",Ce,2,2,Dt,-1,-1),t("DEVSQ",Se,1,P,f,-1,-1),t("CONFIDENCE",Te,3,3,At),t("CONFIDENCE.NORM",Te,3,3,At),t("CONFIDENCE.T",Ae,3,3,At),t("INTERCEPT",Ie,2,2,[f,f],-1,-1),t("LINEST",xe,1,4,zt,[0,1],[0,1],{wkt:[1,2,3],o9t:1}),t("SLOPE",Ne,2,2,[f,f],-1,-1,{o9t:1}),t("LOGEST",ke,1,4,zt,[0,1],[0,1],{wkt:[1,2,3]}),t("STEYX",_e,2,2,Dt,-1,-1),t("BETADIST",je,3,5,[r,o,o,et,it],P,P,{wkt:[3,4]}),t("BETA.DIST",Oe,4,6,[r,o,o,n,et,it],P,P,{wkt:[5,6]}),t("BETAINV",Ee,3,5,It,P,P,{wkt:[3,4]}),t("BETA.INV",Ee,3,5,It,P,P,{wkt:[3,4]}),t("BINOMDIST",Pe,4,4,xt),t("BINOM.DIST",Pe,4,4,xt),t("NEGBINOMDIST",Ge,3,3,[q,q,m]),t("NEGBINOM.DIST",Ue,4,4,[i,$,m,n]),t("CRITBINOM",He,3,3,Nt),t("BINOM.INV",He,3,3,Nt),t("CHIDIST",Ve,2,2,kt),t("CHISQ.DIST.RT",Ve,2,2,kt),t("CHISQ.DIST",ze,3,3,[u,tt,n]),t("CHIINV",Ye,2,2,_t),t("CHISQ.INV.RT",Ye,2,2,[a,$]),t("CHISQ.INV",We,2,2,_t),t("CHITEST",Qe,2,2,Dt,-1,-1),t("CHISQ.TEST",Qe,2,2,Dt,-1,-1),t("CORREL",Je,2,2,P,-1,-1,{o9t:1}),t("EXPONDIST",Ke,3,3,jt),t("EXPON.DIST",Ke,3,3,jt),t("FDIST",Xe,3,3,Ot),t("F.DIST",qe,4,4,[u,rt,rt,n]),t("F.DIST.RT",Xe,3,3,Ot),t("FINV",$e,3,3,s),t("F.INV.RT",$e,3,3,s),t("F.INV",ti,3,3,[a,tt,tt]),t("FISHER",ni,1,1,{J6t:0,pkt:["<= -1",">= 1"]}),t("FISHERINV",ei,1,1,r),t("FTEST",ii,2,2,Et,-1,-1),t("F.TEST",ii,2,2,Et,-1,-1),t("GAMMADIST",ri,4,4,Rt),t("GAMMA.DIST",ri,4,4,Rt),t("GAMMAINV",oi,3,3,Ft),t("GAMMA.INV",oi,3,3,Ft),t("GAMMALN",ai,1,1,o),t("GAMMALN.PRECISE",ai,1,1,o),t("HYPGEOMDIST",ui,4,4,[i,i,i,i]),t("HYPGEOM.DIST",si,5,5,[i,i,i,i,n]),t("LOGNORMDIST",ci,3,3,[o,r,o]),t("LOGNORM.DIST",fi,4,4,[o,r,o,n]),t("LOGINV",li,3,3,Lt),t("LOGNORM.INV",li,3,3,Lt),t("NORMDIST",hi,4,4,Bt),t("NORM.DIST",hi,4,4,Bt),t("NORMINV",di,3,3,Lt),t("NORM.INV",di,3,3,Lt),t("NORMSDIST",d,1,1,r,P,P),t("NORMSINV",vi,1,1,a),t("NORM.S.INV",vi,1,1,a),t("NORM.S.DIST",mi,2,2,[r,n]),t("PEARSON",gi,2,2,pt,-1,-1),t("RSQ",pi,2,2,pt,[0,1],[0,1]),t("POISSON",bi,3,3,Pt),t("POISSON.DIST",bi,3,3,Pt),t("PROB",wi,3,4,[bt,dt,r],[0,1],[0,1],{wkt:3}),t("SKEW",yi,1,P,f,-1,-1),t("STANDARDIZE",Ci,3,3,[r,r,o]),t("TDIST",Si,3,3,[u,$,q]),t("T.DIST",Ti,3,3,[r,$,n]),t("T.DIST.RT",Ai,2,2,Gt),t("T.DIST.2T",Ii,2,2,Gt),t("TINV",xi,2,2,_t),t("T.INV.2T",xi,2,2,_t),t("T.INV",Ni,2,2,[{J6t:0,pkt:["<= 0","> 1"]},tt]),t("TTEST",ki,4,4,Ut,[0,1],[0,1]),t("T.TEST",ki,4,4,Ut,[0,1],[0,1]),t("WEIBULL",_i,4,4,Ht),t("WEIBULL.DIST",_i,4,4,Ht),t("ZTEST",Di,2,3,Vt,0,0,{wkt:2}),t("Z.TEST",Di,2,3,Vt,0,0,{wkt:2}),t("PERMUT",ji,2,2),t("COVARIANCE.S",Oi,2,2,Dt,-1,-1),t("MODE.MULT",Ei,1,P,vt,-1,-1),t("PERCENTILE.EXC",Ri,2,2,[c,nt],0,0),t("QUARTILE.EXC",Fi,2,2,[wt,q],0,0),t("RANK.AVG",Li,2,3,Yt,1,1,{wkt:2}),t("PERMUTATIONA",Bi,2,2,[r,r]),t("PHI",Pi,1,1),t("BINOM.DIST.RANGE",Gi,3,4,[{bkt:0},{bkt:0},{bkt:0}]),t("GAMMA",Ui,1,1,o),t("GAUSS",Hi,1,1,r),t("SKEW.P",Mi,1,P,yt,-1,-1)},CalcEngine:function(t){t.exports=a("CalcEngine")},Common:function(t){t.exports=a("Common")}},i={},n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.Functions=void 0,r=o("CalcEngine"),Object.defineProperty(n,"Functions",{enumerable:!0,get:function(){return r.Functions}}),o("./src/functions-db.ts"),o("./src/functions-eng.ts"),o("./src/functions-fin.ts"),o("./src/functions-lookup.ts"),o("./src/functions-stat.ts"),(((u={}).Spread=u.Spread||{}).CalcEngine=u.Spread.CalcEngine||{}).AdvancedFunctions=t}(),t.exports=u.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@spreadjs/js-calc-advancedfunctions/index.js":function(t,n,e){t.exports=e("./node_modules_local/@spreadjs/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@spreadjs/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(t,n,a){var u;!function(){"use strict";var e,i,t,n,r;function o(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t](n,n.exports,o)),n.exports}e={"./src/functions-basic.ts":function(F,t,L){var s,I,c,B,a,P,G,f,U,H,V,T,t,z,b,h,A,Y,Z,l,W,d,Q,J,K,x,X,q,$,tt,nt,et,it,N,k,rt,ot,g,w,y,_,D,j,O,at,v,ut,st,ct,E,R,ft,lt,ht,dt,o,vt,mt,gt,pt,bt,wt,yt,Mt,Ct,u,St,m,t,Tt,At,It,xt,Nt,kt,_t,Dt,jt,Ot,Et,Rt,n,Ft,e,Lt,Bt,Pt,Gt,i,Ut,r,Ht,Vt,p,M,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,qt,$t;function tn(t,n){for(;0!==n;){var e=t%n;t=n,n=e}return t}function nn(t,n,e,i){return 0===n||0===t?0:0!==e&&t<0?!0===i?m(t/Math.abs(n))*Math.abs(n):St(t/Math.abs(n))*Math.abs(n):!0===i?St(t/Math.abs(n))*Math.abs(n):m(t/Math.abs(n))*Math.abs(n)}function en(e,t,n){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M;function C(t){return t.getRowCount?t.getRowCount()!==e[1].getRowCount()||t.getColumnCount()!==e[1].getColumnCount():t.rowCount!==u||t.colCount!==s}function S(n){var e=n.getSource();return function(t){return{id:e.id,source:e,row:n.getRow(0)+x(t/s),col:n.getColumn(0)+t%s,rowCount:1,colCount:1}}}if(r=(i=e[0]).source&&i.source.Lbt,e[1].Zbt=!0,a=r.calcOnDemand?(o={rowCount:e[1].getRowCount(),colCount:e[1].getColumnCount()},function(t){return I.Convert.Nbt(e[1].getValueByIndex(t),1,!I.ExcelCompatibleCalcMode,!0)}):(o=E(e[1],1,2,!1,!1,!0),function(t){return o[t]}),u=o.rowCount,s=o.colCount,c=[],h=r.dynamicReferences,(d=h&&i.Xkt)&&j(e[1])&&!n&&(o.getRef=S(e[1])),m=0,g=t?(f=[],n?function(t){l=a(t),f.push(l)}:function(t){(l=a(t))!==_&&f.push(l)}):function(t){if((l=a(t))!==_){if(D(l))return m=l,!0;m+=l}},p=o.getRef?function(t){return Xn(d,o.getRef(t)),g(t)}:g,b=r.S9t||new I.Functions.RangeCriteriaManager,C(e[2]))return k;if(e.length<=3)v=p;else{for(w=4;w<T(e);w+=2)if(C(e[w]))return k;if(!d){for(y=[],w=2;w<T(e);w+=2)y.push(e[w],e[w+1]);return b.Fde(y,p,1),t?t(f):m}for(w=4;w<T(e);w+=2)d&&j(e[w])&&(e[w].getRef=S(e[w])),M=d&&(d.delay||j(e[w])),c.push(b.T9t(e[w],e[w+1],M?-1:0));v=function(t){for(var n=0;n<c.length;n++)if(e[2*n+4].getRef&&Xn(d,e[2*n+4].getRef(t)),!c[n].A9t(t))return;return p(t)}}return b.I9t(e[2],e[3],v,d&&d.delay?-1:1),t?t(f):m}function rn(t,n){return n=n<0?x(n):Math.ceil(n),(t&&n%2==0||!t&&n%2!=0)&&(n+=n<0?-1:1),n}function on(t,n,e){return 0<n&&e<0?y:n<0&&0<e?(e=-e,t?m(n/e)*e:St(n/e)*e):t?St(n/e)*e:m(n/e)*e}function an(t,n,e){var i,r,o,t,i=u.x9t(d(e)),r=St(n=e<0?n/i:n*i),o=m(n);return t&&(t=r,r=o,o=t),n=n<0?r:o,R(n=e<0?n*i:n/i)}function un(t,n,e,i){var r=n?-1:1,o=0,a,u,s;if(T(e)!==T(i))return w;for(s=0;s<T(e);s++)a=e[s],u=i[s],a!==_&&u!==_&&(o+=t?(a-u)*(a-u):a*a+r*u*u);return R(o)}function sn(t){return R(d(t))}function cn(t){return t=ut(t),isNaN(t)?k:m(t)}function fn(t,n){var e=1,i;if(t<n)return y;for(n=K(t-n,n),i=1;i<=n;i++)e=e*(t-i+1)/i;return R(e)}function ln(t,n){for(var e=1,i,i=1;i<=n;i++)e*=t+i-1;for(i=2;i<=n;i++)e/=i;return R(e)}function hn(t,n){var e,i,r,o,a,u,u;if(!t||255<t.length)return 0;if(0===(e=t.length))return 0;if("-"===t[0])return y;for(i=0;i<e&&" "===t[i];)i++;if(r=0,i===e)return 0;for(a=e-(o=1);i<=a;a--){if((u=0<=(u=t.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)?u-87:u-48)<0||n<=u)return y;r+=u*o,o*=n}return r}function dn(t){return 180*t/$}function vn(t){return rn(!0,t)}function mn(t){return rn(!1,t)}function gn(t){return wt(t)}function pn(t){for(var n=1,e,e=t;1<e;e-=2)n*=e;return n}function bn(t){return R(q(t))}function wn(t,n){return t-n*x(t/n)}function yn(){return $}function Mn(t,n){var t;return 0===t&&n<0?N:0===t&&0===n||(t=I.Functions.MathHelper.N9t(t,n))===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY||isNaN(t)?y:t}function Cn(){for(var t,n,e,i,r,o,t=arguments,n=0,e=0;e<T(t);e++){if(o=r=void 0,D(i=t[e]))return i;if(j(i)||O(i)){if((r=E(i,1,!0,!0,!1)).isError)return r[0]}else r=E(i,1,!0,!0,!0);for(o=0;o<T(r);o++)r[o]!==_&&(n+=r[o])}return n}function Sn(){var t,n,e,i,r,o;if(!I.ExcelCompatibleCalcMode)return Cn.apply(null,arguments);for(t=arguments,e=n=0;e<T(t);e++){if(o=r=void 0,D(i=t[e]))return i;if(j(i)||O(i)){if((r=E(i,5,!0,!0,!1,!0)).isError)return r[0]}else r=E(i,1,!0,!0,!1,!0);for(o=0;o<T(r);o++)r[o]!==_&&(n+=r[o])}return n}function Tn(t){return 0===t?0:-1}function An(){for(var t,n,e,i,r,o,t=arguments,n=0,e=0;e<T(t);e++)for(r=t[e],i=0;i<T(r);i++){if((o=r[i])===_)return k;if(o<0)return y;n=tn(n,v(o))}return n}function In(){for(var t,n,e,i,r,o,a,t=arguments,n=1,e=[],i=0;i<T(t);i++)for(o=t[i],r=0;r<T(o);r++)if((a=o[r])!==_){if((a=v(a))<0)return y;if(0===a)return 0;e.push(a)}for(r=0;r<T(e);r++)n=n/tn(n,a=e[r])*a;return n}function xn(){return yt(arguments,2,6)}function Nn(t){return Q(t)}function kn(t,n){return l((t/n).toString())}function _n(t){for(var n,e,i,n=arguments,e=[],i=1;i<T(n);i++)e[i-1]=n[i];return jn(t,0,e)}function Dn(t){for(var n,e,i,n=arguments,e=[],i=1;i<T(n);i++)e[i-1]=n[i];return jn(t,1,e)}function jn(t,n,e){var i=k;return 0<=z(t,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])?i=yt(e,n,t):0<=z(t,[7,107,8,108,10,110,11,111])&&(i=Ct(e,n,t)),i}function On(t,n,e){for(var i,r,o,i=arguments,r=[],o=3;o<T(i);o++)r[o-3]=i[o];return Mt(r,e,n,t)}function En(t,n){return on(!0,t,n)}function Rn(t,n){return on(!1,t,n)}function Fn(t,n,e){return nn(t,n,e,!0)}function Ln(t,n,e){return nn(t,n,e,!1)}function Bn(t,n,e){var t=""+t.toString(n);return e&&t.length<e?Array.apply(null,{length:e-t.length+1}).join(0)+t:t}function Pn(t,n){return t<0&&0<n||n<0&&0<t?y:m(t/n+.5)*n}function Gn(t,n){return u.Lkt(t,n)}function Un(t,n){return an(!1,t,n)}function Hn(t,n){return an(!0,t,n)}function Vn(t){return R(X(t))}function zn(t,n){return St(t/d(n))*d(n)}function Yn(t,n){return m(t/d(n))*d(n)}function Zn(t,n){return 1===n?N:R(u.ckt(t,n))}function Wn(t){return R(u.ckt(t,10))}function Qn(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,l,f,g,p,b,w,y,M,C,S,o=t.source&&t.source.Lbt,a=o&&o.dynamicReferences,u=i!==A&&j(i);return i=i!==A?i:n,c=s=0,f=O(n),l=O(i),(f?1:n.getRangeCount())!==(l?1:i.getRangeCount())?k:((h=i)===n||l||(v=f?n.getRowCount():n.getRowCount(0),m=f?n.getColumnCount():n.getColumnCount(0),v===i.getRowCount(0)&&m===i.getColumnCount(0))||(l=i.getRow(0),f=i.getColumn(0),h=i.create([{row:l,col:f,rowCount:v,colCount:m}]),d=!0),h.Zbt=!0,p=h.toArray(g=r?5:1,2,!1),u&&(b=h.getRow(0),w=h.getColumn(0),y=t.Xkt,M=i.getSource(),u=y&&M.getRangeKey,d)&&!a&&u&&Xn(y,{id:M.id,source:M,row:b,col:w,rowCount:v,colCount:m}),(C=o.S9t||new I.Functions.RangeCriteriaManager).I9t(n,e,function(t){var n=p[t];if(D(n))return S=n,!0;n&&n!==_&&(s+=n,c++),a&&u&&Xn(y,{id:M.id,source:M,row:b+x(t/m),col:w+t%m,rowCount:1,colCount:1})},y&&y.delay?-1:1),S||(r?0===c?N:R(s/c):R(s)))}function Jn(t,n,e,i){return Qn(t,n,e,i)}function Kn(t,n,e,i){return Qn(t,n,e,i,!0)}function Xn(t,n){var e,e,e=n&&n.source;e&&e.getRangeKey&&(e=e.getRangeKey(e,n),t.qkt||(t.qkt={}),t.qkt[e]=n)}function qn(){return en(arguments)}function $n(){return en(arguments,function(t){var n=null;return n=0<t.length?Math.max.apply(null,t):n})}function te(){return en(arguments,function(t){var n=null;return n=0<t.length?Math.min.apply(null,t):n})}function ne(){for(var t,n,e,i,t=arguments,n=T(t),e=[t[0],t[1]],i=1;i<n;i++)e[i+1]=t[i];return en(e,function(t){return t.length},!0)}function ee(t){return en(arguments,function(t){for(var n,e,i,r,n=0,e=0,i=0;i<t.length;i++){if(r=t[i],D(r))return r;n+=r,e++}return 0===e?N:R(n/e)})}function ie(t){for(var n,e,i,n=[],e=0,i=[];e<t;e++)i[e]=0;for(e=0;e<t;e++)n[e]=i.slice(0),n[e][e]=1;return new I.CalcArray(n)}function re(){for(var t,n,e,i,r,o,a,u,s,c,f,t=arguments,n=0,i=[],f=0,e=0;e<T(t);e++){if((a=E(t[e],1,!0,!0,!1,!0)).isError)return a[0];if(a.isConvertError)return k;if(0===e)r=a.rowCount,o=a.colCount,f=T(a);else if(a.rowCount!==r||a.colCount!==o)return k;i.push(a)}for(e=0;e<f;e++){for(u=1,s=0;s<T(t);s++){if((c=i[s][e])===_){if(1===f)return k;u=0;break}u*=c}n+=u}return R(n)}function oe(){for(var t,n,e,i,r,o,t=arguments,o=0,e=0;e<T(t);e++)for(r=t[e],i=0;i<T(r);i++)(n=r[i])!==_&&(o+=n*n);return R(o)}function ae(t,n){return un(!1,!0,t,n)}function ue(t,n){return un(!1,!1,t,n)}function se(t,n){return un(!0,!1,t,n)}function ce(t,n,e,i){for(var r,o,a=0,r=0;r<T(i);r++){if(o=ut(i[r]),Y(o))return k;a+=o*nt(t,n+r*e)}return R(a)}function fe(t){return R(Q(t*$))}function le(t){return $*t/180}function he(t){return R(Math.sin(t))}function de(t){var t=he(t);return 0===t?N:1/t}function ve(t){return R(Math.cos(t))}function me(t){var t=ve(t);return 0===t?N:1/t}function ge(t){return R(Math.tan(t))}function pe(t){return 0===t?N:R(1/Math.tan(t))}function be(t){return R(Math.asin(t))}function we(t){return R(Math.acos(t))}function ye(t){return R(u.vkt(t,!0))}function Me(t){var t;return 709<t||t<-709?0:0===(t=ye(t))?N:1/t}function Ce(t){return R(u.vkt(t,!1))}function Se(t){var t;return 709<t||t<-709?0:0===(t=Ce(t))?N:1/t}function Te(t){return R(q(t+Q(t*t+1)))}function Ae(t){return R(q(t+Q(t*t-1)))}function Ie(t){return R(Math.atan(t))}function xe(t){return R(t<0?Math.PI+Math.atan(1/t):Math.atan(1/t))}function Ne(t,n){return 0===t&&0===n?N:R(Math.atan2(n,t))}function ke(t){var n=X(t),t=X(-t);return R(n-t)/(n+t)}function _e(t){var n;return 0===t?N:10<t?1:t<-10?-1:1/ke(t)}function De(t){return R(q((1+t)/(1-t))/2)}function je(t){return De(1/t)}function Oe(t){var n=t.rowCount,e=1,i,r,o,a,u,s,c,f;if(1<t.rangeCount||n!==t.colCount)return k;for(i=0;i<n-1;i++){if(0===t[i][i]){for(s=!1,r=i+1;!s&&r<n;r++)if(0!==t[r][i]){for(a=i;a<n;a++)c=t[i][a],t[i][a]=t[r][a],t[r][a]=c;e*=-1,s=!0}if(!s)return 0}for(o=i+1;o<n;o++)if(0!==t[o][i])for(f=t[o][i]/t[i][i],u=i;u<n;u++)t[o][u]-=f*t[i][u]}for(i=0;i<n;i++)e*=t[i][i];return e}function Ee(t){var n=t.rowCount,e=[],i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b;if(1<t.rangeCount||n!==t.colCount)return k;for(i=0;i<n;i++)for(e[i]=[n],a=0;a<n;a++)e[i][a]=i===a?1:0;for(r=0;r<n;r++){if(0===t[r][r]){for(b=!1,u=r+1;!b&&u<n;u++)if(0!==t[u][r]){for(c=r;c<n;c++)g=t[r][c],t[r][c]=t[u][c],t[u][c]=g;for(f=1;f<n;f++)p=e[r][f],e[r][f]=e[u][f],e[u][f]=p;b=!0}if(!b)return y}for(s=0;s<n;s++)if(s!==r&&0!==t[s][r]){for(v=t[s][r]/t[r][r],l=r;l<n;l++)t[s][l]-=v*t[r][l];for(h=0;h<n;h++)e[s][h]-=v*e[r][h]}}for(o=0;o<n;o++)for(m=t[o][o],d=0;d<n;d++)e[o][d]/=m;return new I.CalcArray(e)}function Re(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=t.rowCount,i=t.colCount,r=n.rowCount,o=n.colCount,a=[];if(i!==r)return k;for(c=0;c<e;c++)for(a[c]=u=[],s=t[c],f=0;f<o;f++){for(l=h=0;l<r;l++)h+=s[l]*n[l][f];u[f]=h}return new I.CalcArray(a)}function Fe(){for(var t,n,e,i,r,o,a,t=arguments,n=0,e=1,r=0;r<T(t);r++)for(i=t[r],o=0;o<T(i);o++){if((a=v(i[o]))<0||170<a)return y;n+=a,e*=wt(a)}return n<0||170<n?y:wt(n)/e}function Le(){return d(2*tt()-1)}function Be(t,n){var t,n;return n<t?y:(t=et(t),n=x(n)+1,x(Math.random()*(n-t))+t)}function Pe(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=["M","D","C","L","X","V","I"],i=[1e3,500,100,50,10,5,1],o=7,a=[],r=lt(n)?n?0:4:n;if(4<r||r<0)return k;for(u=0;u<7;u+=2){if(2<=u&&i[u-2]-i[u]<=t){for(c=(s=u)-2,f=void 0,f=0;f<r&&s+1<7&&i[c]-i[s+1]<=t;f++)s++;a.push(e[s]),a.push(e[c]),t=t+i[s]-i[c]}if(1<=u&&i[u-1]<=t&&(a.push(e[u-1]),t-=i[u-1]),1<=u&&i[u-1]-i[u]<=t){for(h=(l=u)-1,d=void 0,d=0;d<r&&l+1<7&&i[h]-i[l+1]<=t;d++)l++;a.push(e[l]),a.push(e[h]),t=t+i[l]-i[h]}for(;i[u]<=t;)a.push(e[u]),t-=i[u]}return a.join("")}function Ge(t){var n,e,i,r,o,a,u,s,c,f;if(!t.length)return 0;if(255<t.length)return k;for(e=(t=t.toLowerCase()).length-1,r=n=0,u=-1;0<=e&&" "===t[e];)e--;for(s=0;s<=e&&" "===t[s];)s++;c=!1,s<=e&&"-"===t[s]&&(c=!0,s++);do{for(f=t[i=e],--e;s<=e&&(t[e].charCodeAt(0)|" ".charCodeAt(0))===f.charCodeAt(0);)--e;switch(f){case"i":o=i-e,a=1;break;case"v":o=5*(i-e),a=5;break;case"x":o=10*(i-e),a=10;break;case"l":o=50*(i-e),a=50;break;case"c":o=100*(i-e),a=100;break;case"d":o=500*(i-e),a=500;break;case"m":o=1e3*(i-e),a=1e3;break;default:return k}}while(u<=a?(n+=o-r,u=a,r=0):r+=o,s<=e);return 0!==r&&(n-=r),n=c?-n:n}function Ue(t,n,e,i){var r,e,o,a,u,s,c;if(void 0===n&&(n=1),void 0===i&&(i=1),0===(t=void 0===t?1:t)||0===n)return g;if(t<0||n<0)return k;if("string"==typeof(r=e=void 0===e?1:e)||e instanceof Date){if(!I.Convert.sJ(e,e={}))return k;r=e.value}for(o=[],a=0,u=r;a<t;a++)for(o.push(s=[]),c=0;c<n;c++)s.push(u),u+=i;return new I.CalcArray(o)}function He(t,n,e,i,r){var o,a,u,s,c,f;if(void 0===n&&(n=1),0===(t=void 0===t?1:t)||0===n)return g;if(t<0||n<0)return k;if((i=void 0===i?1:i)<(e=void 0===e?0:e))return k;if((r=void 0===r?!1:r)&&(e!==x(e)||i!==x(i)))return k;for(o=i-e,r&&o++,a=[],u=0;u<t;u++)for(a.push(s=[]),c=0;c<n;c++)f=e+tt()*o,r&&(f=l(f)),s.push(f);return new I.CalcArray(a)}function Ve(t,n){for(var e,i,r,o,a,o=!0,e=0;e<T(n);e++)for(r=n[e],i=0;i<T(r);i++){if(I.ExcelCompatibleCalcMode){if("string"==typeof r[i]||b(r[i]))continue;o=!1}if(a={value:h},r[i]=Tt(r[i],a)?a.value:_,t){if(!r[i])return!1}else if(r[i]&&r[i]!==_)return!0}return I.ExcelCompatibleCalcMode&&o?k:!!t}function ze(){return Ve(!0,arguments)}function Ye(){return Ve(!1,arguments)}function Ze(t){var t,n;return(!I.ExcelCompatibleCalcMode||"string"!=typeof t)&&(n=I.Convert.YK(t,t={}))?!t.value:k}function We(t,n,e){var i,n,r,t,e,i,n=n,r=ft(t);return!D(t)&&(t=e!==A?e:2!==T(arguments)&&null,at(r.value,e={}),e.value)?n:t}function Qe(t,n){return D(t)?n:t}function Je(t,n){var e,i,r,r;if(!D(t)&&j(t)){if(1<t.getRangeCount())return k;if(i=e=0,r=this.k9t)if(e=r.row,i=r.col,(r=t.$gt&&t.$gt[0])&&1===r.rowCount&&1===r.colCount)i=e=0;else if(r&&(e+1>r.rowCount||i+1>r.colCount))return n;t=t.getValue(0,e,i)}return Qe(t,n)}function Ke(){return!0}function Xe(){return!1}function qe(t,n){return It(t)?n:t}function $e(){for(var t,n,e,t=0,n=arguments.length;t<n;t+=2){if(e={value:!1},D(arguments[t]))return arguments[t];if(!at(arguments[t],e))return k;if(e.value)return arguments[t+1]}return w}function ti(){var t,n,e,i,r,t=arguments;if(t.length<3)return k;if(D(n=t[0]))return n;for(n===h&&(n=0),i=t.length-(e=1);e<i;e++){if(r=t[e],e++,D(r))return r;if(r===h&&(r=0),o(n)&&o(r)){if(n.toUpperCase()===r.toUpperCase())return t[e]}else if(n===r)return t[e]}return t.length%2==0?t[t.length-1]:w}function ni(){for(var t,n,e,i=0,t=0;t<T(arguments);t++)for(e=arguments[t],n=0;n<T(e);n++)e[n]&&i++;return!!(i%2)}function ei(t,n,e){var i,r,o,a,u,i=t.source&&t.source.Lbt&&t.source.Lbt.MX;if(!i)return g;r=t.localScopes;try{if(t.lambdaFunctionCallDepth++,r.enterScope(),r.saveThenSwitchClosure(n.closure),(a=n.parameters).length!==e.length)return k;for(u=0;u<a.length;u++)t.localScopes.setVariable(a[u].value,e[u]);o=i.evaluate(n.calculation,t,!1,!1)}finally{t.lambdaFunctionCallDepth--,r.exitScope(),r.restoreClosure()}return o}function ii(t){return!O(t)||1===t.getColumnCount()&&1===t.getRowCount()}function ri(t){return O(t)?t instanceof I.TwoDimensionalCalcArray?t.getCalculatedValue():t.getValue(0,0):t}function oi(t,n,e){return t[n*t.colCount+e]}function ai(){var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,t=arguments,n=T(t),e=t[0],i=t[n-1];if(!(0,I.isLambdaFunction)(i))return k;for(r=[],a=o=0,u=1;u<n-1;u++){if(s=lo(t[u],0),D(s))return s;o=Math.max(o,s.rowCount),a=Math.max(a,s.colCount),r.push(s)}if(i.parameters.length!==r.length)return k;for(c=[],f=0;f<o;f++){for(l=[],h=0;h<a;h++){for(v=!(d=[]),u=0;u<r.length;u++){if(!(f<r[u].rowCount&&h<r[u].colCount)){v=!0;break}d.push(oi(r[u],f,h))}if(v)l.push(w);else{if((m=ei(e,i,d))&&m.pause)return m;if(!ii(m))return g;m=ri(m),l.push(m)}}c.push(l)}return new I.CalcArray(c)}function ui(t,n,e,i){var r,o,a,u,s,c;if(e=lo(e,0,!1),D(e))return e;if(!(0,I.isLambdaFunction)(i)||2!==i.parameters.length)return k;for(r=e.rowCount,o=e.colCount,a=n,u=0;u<r;u++)for(s=0;s<o;s++)if(c=oi(e,u,s),(a=n===h&&0===u&&0===s?c:ei(t,i,[a,c]))&&a.pause)return a;return a}function si(t,n,e,i){var r,o,a,u,s,c,f,l;if(e=lo(e,0,!1),D(e))return e;if(!(0,I.isLambdaFunction)(i)||2!==i.parameters.length)return k;for(r=e.rowCount,o=e.colCount,a=[],u=n,s=0;s<r;s++){for(c=[],f=0;f<o;f++){if(l=oi(e,s,f),(u=n===h&&0===s&&0===f?l:ei(t,i,[u,l]))&&u.pause)return u;if(!ii(u))return g;u=ri(u),c.push(u)}a.push(c)}return new I.CalcArray(a)}function ci(t,n,e,i){var r,o,a,u,s;if(!(0,I.isLambdaFunction)(i)||2!==i.parameters.length)return k;if(n<=0||e<=0)return k;for(r=[],o=0;o<n;o++){for(a=[],u=0;u<e;u++){if((s=ei(t,i,[o+1,u+1]))&&s.pause)return s;if(!ii(s))return g;s=ri(s),a.push(s)}r.push(a)}return new I.CalcArray(r)}function fi(t,n,e){var i,r,o,a,u,s,c;if(!(0,I.isLambdaFunction)(e)||1!==e.parameters.length)return 2===arguments.length?w:k;if(n=lo(n,0,!1),D(n))return n;for(i=n.rowCount,r=n.colCount,o=[],a=0;a<i;a++){for(u=[],s=0;s<r;s++)u.push(oi(n,a,s));if((c=ei(t,e,[new I.CalcArray([u])]))&&c.pause)return c;if(!ii(c))return g;c=ri(c),o.push([c])}return new I.CalcArray(o)}function li(t,n,e){var i,r,o,a,u,s,c;if(!(0,I.isLambdaFunction)(e)||1!==e.parameters.length)return 2===arguments.length?w:k;if(n=lo(n,0,!1),D(n))return n;for(i=n.rowCount,r=n.colCount,o=[],a=0;a<r;a++){for(u=[],s=0;s<i;s++)u.push(oi(n,s,a));if((c=ei(t,e,[new I.CalcArray([u])]))&&c.pause)return c;if(!ii(c))return g;c=ri(c),o.push(c)}return new I.CalcArray([o])}function hi(t){for(var n,e,i,r,o,n=t.getFullYear(),e=t.getMonth(),i,r=t.getDate(),o=0;o<e;o++)r+=bt(n,o);return r}function di(t){if(o(t)){if(7!==T(t)||Y(l(t)))return k}else if(!Y(t)){if(x(t)<1||17<x(t))return y;t=t.toString()}var n=["1","2","3","4","5","6","7"],e=[0,0,0,0,0,0,0],i;switch(T(t)){case 1:if(0<=z(t,n)){e[((i=l(t))+4)%7]=1,e[(i+5)%7]=1;break}return y;case 2:if("1"===t[0]&&0<=z(t[1],n)){e[((i=l(t[1]))+5)%7]=1;break}return y;case 7:for(i=0;i<7;i++)e[i]=l(t[i]);break;default:return k}return e}function vi(t,n,e,i,r){var o,a,o=S(n,3);if(D(o))return o;for(a=v(o),i=i.map(function(t){return dt(t)?f(t):t});e<0;++e)n.setDate(n.getDate()-1),a=0===a?6:a-1,(t&&(5===a||6===a)||!t&&r[a]||0<=i.indexOf(f(n)))&&e--;for(;0<e;--e)n.setDate(n.getDate()+1),a=6===a?0:a+1,(t&&(5===a||6===a)||!t&&r[a]||0<=i.indexOf(f(n)))&&e++;return f(n)}function mi(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,h;if(o&&(u=di(t=t!==A?t:"0000011"),D(u)))return u;if(a=n!==A?E(n,4,!0,!0,!1):a){if(a.isError)return a[0];for(s=T(a),c=[],f=0;f<s;f++)l=a[f],d=(h=U(l)).getDay(),h=T(u)?u[S(h,3)]:6===d||0===d,-1===c.indexOf(l)&&!h&&e<=l&&l<=i&&c.push(l);r-=T(c)}return r}function gi(t,n,e,i,r,o){var a,u,s,c,c,c,a=v(f(n)),u=v(f(e)),s=!1;if(u<a&&(c=n,n=e,e=c,c=a,a=u,u=c,s=!0),c=o(n,e,c=u-a+1,i),!t||!D(c)){if(c<=0)return 0;c=mi(i,r,a,u,c,t),c=s?-c:c}return c}function pi(t,n,e){var i,e;return n=I.Convert.r0(n),(i=new Date(n.getFullYear(),n.getMonth(),1)).setMonth(i.getMonth()+e),e=bt(i.getFullYear(),i.getMonth()),i.setDate(t?e:K(n.getDate(),e)),i}function bi(t,n,e){t<=1899&&(t+=1900);var t=new Date(t,n-1,e);return t<new Date(1899,11,30)?y:t}function wi(t,n,e){var i=U(0);return i.setHours(t),i.setMinutes(n),i.setSeconds(e),i.setMilliseconds(0),i.getHours()<0&&i.getMinutes()<0&&i.getSeconds()<0?y:i}function yi(t){var n,e,i,r;if(!(n=!o(t)||(n=H(t))||(n=new Date(t))&&!Y(n.valueOf())?n:null))return k;if(i=n.getFullYear(),r=hi(n),i<1900)return k;for(e=1900;e<i;e++)r+=365,vt(e)&&r++;return r}function Mi(t){var n;return(n=o(t)?(n=H(t))||a.Z6t(t):n)?(60*(60*n.getHours()+n.getMinutes())+n.getSeconds())/86400:k}function Ci(){return new Date}function Si(){var t=new Date;return t.setHours(0,0,0,0),t}function C(t){if(I.ExcelCompatibleCalcMode){var n=t.getMilliseconds();if(500<n)return new Date(t.getTime()+1e3-n)}return t}function Ti(t){return(t=C(t)).getHours()}function Ai(t){return(t=C(t)).getMinutes()}function Ii(t){return(t=C(t)).getSeconds()}function xi(t){return(t=C(t)).getDate()}function Ni(t){return(t=C(t)).getMonth()+1}function ki(t){return(t=C(t)).getFullYear()}function _i(t,n){var e,i,e;return t=C(t),1===n||17===n||b(n)||2===n||11===n||12===n||13===n||14===n||15===n||16===n?(e=hi(t),i=new Date(t.getFullYear(),0,1).getDay(),2===n?--i:11===n||12===n||13===n||14===n||15===n?i=i-n+10:16===n&&(i+=1),(e=e-1-(6-(i=i<0?7+i:i)))<0&&(e=0),7===i&&16===n?v(e/7)+(e%7!=0?1:0):1+v(e/7)+(e%7!=0?1:0)):21===n?Gi(t):y}function S(t,n){var e,i,e=(t=C(t)).getDay();switch(n){case 1:case 17:return e+1;case 2:case 11:return 0===e?7:e;case 3:return 0===e?6:e-1;case 12:case 13:case 14:case 15:case 16:return 0==(i=(e+18-n)%7)?7:i;default:return y}}function Di(t,n){return pi(!1,t,n)}function ji(t,n){return pi(!0,t,n)}function Oi(t,n,e){return vi(!0,t,n,e)}function Ei(t,n,e,i){var e=di(e=b(e)&&0===n?1:e);return D(e)?e:"1111111"===e.join("")?k:vi(!1,t,n,i,e)}function Ri(t,n,e){function i(t,n,e){var i,t,r,t,i=v(f(n)-f(t)),t=t.getDay(),r=0;return i+=t,0<t&&(r=1),6!==(t=n.getDay())&&r++,e-(i+=7-t)/7*2+r}return gi(!1,t,n,A,e,i)}function Fi(t,n,e,i){var r,o,a,u,s,c,f,r=di(i=i!==A?i:"0000011"),a=o=0;if(D(r))return r;for(u=0;u<T(r);u++)1===r[u]&&o++;if(e<30){for(u=0;u<e;u++)r[(v(S(t,3))+u)%7]&&a++;return e-=a}for(s=e,u=f=c=0;u<s&&v(S(t,3)+u)%7!=0;u++)c++;for(u=0;u<c;u++)r[(v(S(t,3))+u)%7]&&a++;for(u=0;u<s&&(v(S(n,3))+7-u)%7!=6;u++)f++;for(u=0;u<f;u++)r[(v(S(n,3))+7-u)%7]&&a++;return e=e-v((s=s-c-f)/7)*o-a}function Li(t,n,e,i){return gi(!0,t,n,e,i,Fi)}function Bi(t,n,e){var i,e,r;function o(){var t=[];return t[0]=function(t,n){return n.getFullYear()-t.getFullYear()+(n.getMonth()<t.getMonth()||n.getMonth()===t.getMonth()&&n.getDate()<t.getDate()?-1:0)},t[1]=function(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())+(n.getDate()<t.getDate()?-1:0)},t[2]=function(t,n){return(n.getTime()-t.getTime())/864e5},t[3]=function(t,n){var t=new Date(n.getFullYear(),n.getMonth()+(n.getDate()<t.getDate()?-1:0),t.getDate());return(n.getTime()-t.getTime())/864e5},t[4]=function(t,n){return n.getMonth()-t.getMonth()+(n.getMonth()<t.getMonth()||n.getMonth()===t.getMonth()&&n.getDate()<t.getDate()?12:0)+(n.getDate()<t.getDate()?-1:0)},t[5]=function(t,n){var e,i,r,t,o,e=n.getFullYear()+(n.getMonth()<t.getMonth()||n.getMonth()===t.getMonth()&&n.getDate()<t.getDate()?-1:0),i=t.getMonth(),r=t.getDate(),t=vt(t.getFullYear());return 1!==i||29!==r||vt(e)||r--,!t&&1===i&&28===r&&vt(e)&&r++,(n-(o=new Date(e,i,r)))/864e5},t}if(t.setHours(0,0,0,0),n.setHours(0,0,0,0),I.ExcelCompatibleCalcMode&&(t<Et||Rt<n))return y;if(e=e.toLocaleUpperCase(),i=o(),e=z(e,["Y","M","D","MD","YM","YD"]),n<t)return y;if(e<0)throw(0,I.sR)().Exp_NotSupported;return(r=i[e])(t,n)}function Pi(t,n){var e,t,i,e={value:0};return Tt(t,e)&&Tt(n,t={value:0})?(i=2958465,r(e.value)&&r(t.value)?x(e.value)-x(t.value):y):k;function r(t){return 0<=t&&t<1+i}}function Gi(t){var n,n,e,n,i;return isNaN(t)?y:(n=new Date(1900,1,28),t.getTime()<=n.getTime()&&t.setDate(t.getDate()-1),1900===(n=t.getFullYear())?n+=400:9999===n&&(n-=400),t.setYear(n),t.getTime()<new Date(n,11,29).getTime()&&n--,e=r(n+1),t.getTime()<e.getTime()&&(e=r(n)),n=60*t.getTimezoneOffset()*1e3,i=60*e.getTimezoneOffset()*1e3,l(((t.getTime()-n-e.getTime()+i)/864e5/7).toString())+1);function r(t){var t,n,t=new Date(t,0,4),n=t.getDay();return 0===n&&(n=7),t.setDate(t.getDate()+1-n),t}}function Ui(t){var n,e,i,r,t,o,n=t.toString(),e="",r=[];if(t<0&&(n=n.substr(1),e="-"),t=n.split("."),(o=T(t))<1||2<o)return k;for(2===o&&(r.push(t[1]),r.push(".")),n=t[0],i=T(n)-3;0<=i;i-=3)r.push(n.substr(i,3)),0<i&&r.push(",");return r.push(n.substring(0,i+3)),r.reverse(),e+r.join("")}function Hi(t,n){for(var e,i,r,o,a,u,e=[],o=T(t),i=0;i<o;i++){if(a=t[i],0===(u=T(a))&&"concat"===n)return it;for(r=0;r<u;r++)b(a[r])||e.push(st(a[r]))}return e.join("")}function Vi(t,n,e){for(var i,r,o,a,i=[],r=0,o=0;o<n.length;o++)"fourByte"===(a=mt(n[o]))?0===r?r++:(r=0,i.push(n[o-1]+n[o])):i.push(n[o]);return i.length<=e?n:i.splice(t?0:i.length-e,e).join("")}function zi(t){for(var n=[],e,i,e=0;e<T(t);e++)0<=(i=t.charCodeAt(e))&&i<=31||127===i||128<=i&&i<=159||n.push(t[e]);return n.join("")}function Yi(t){var n,e,i,r,o;for(t=t.trim(),n=[],e=!0,i=0;i<T(t);i++)(o=" "===(r=t.charAt(i))||"\t"===r||"\n"===r)&&!e||n.push(r),e=!o;return n.join("")}function Zi(t,n){function e(t){var n=Ui(t),e=[];return t<0&&(n=n.substr(1)),e.push("$"),e.push(n),t<0&&(e.push(")"),e.unshift("(")),e.join("")}return e(t=ut(Gn(t,n)))}function Wi(t,n,e){var i,r,i,o,a,u,i=0;if(n<0&&(t/=i=v(nt(10,d(n)))),t=ut(Gn(t,J(0,n))),n<0&&(t*=i),r=e?t.toString():Ui(t),0<n)if(-1===(i=r.indexOf(".")))for(r+=".",o=0;o<n;o++)r+="0";else for(u=a=r.length-(i+1);u<n;u++)r+="0";return r}function Qi(t,n){var e,i;if(""===n)return st(t);"string"==typeof(t=b(t)?0:t)&&(t=t.trim());try{return(e=s.Formatter&&s.Formatter.GeneralFormatter)?(i=new e(n)).format(t):t.toString()}catch(t){return k}}function Ji(t){var n,t;return t?"boolean"==typeof t?k:"string"!=typeof(t=t instanceof Date?a.o0(t).toString():t)?t:(n=H(t),b(n)?Ki(t):(t=f(n),D(t)?Mi(n):t)):0}function Ki(t){var n,e,e,i,r,o,a,u,n=s.Common.CultureManager.Fe().NumberFormat;if(t=t.trim(),e="$"===n.currencySymbol?"\\$":"[$".concat(n.currencySymbol,"]"),t=(t=c.qT("^(".concat(e,"|[+-]\\s*").concat(e,")")).test(t)?t.replace(c.bue(e),""):t).replace(/^[+-]\s+/,function(t){return t[0]}),e=Z(t),Y(e))return k;for(i=(t="."===(t="-"===t[0]&&"."===t[1]?t.replace(t[1],"0."):t)[0]?"0"+t:t).length,u=a=r=0;r<i;r++){for(o=t[r];r<i&&(0,I.isDigit)(o.charCodeAt(0));)o=t[++r];if(r===i){if(a&&r-a<=3)return k;break}if(o===n.numberGroupSeparator){if(u||a&&r-a<=3)return k;a=r}else if(o===n.numberDecimalSeparator){if(u||a&&r-a<=3)return k;u=r}}return ut(t)}function Xi(t){return t.toLowerCase()}function qi(t){return t.toUpperCase()}function $i(t){var n,e,i,r,o,n=T(t),e=[];if(0<n)for(i=t.toUpperCase(),r=t.toLowerCase(),o=1,e[0]=i[0];o<n;)e[o]=((0,I.Swt)(t[o-1])?r:i)[o],o++;return e.join("")}function tr(t){return String.fromCharCode(t)}function nr(t){return t[0].charCodeAt(0)}function er(t,n,e,i){var r,r,t,r=T(t);return n=K(n,r+1),e=K(e||0,r-n+1),r=t.substring(0,n-1),t=t.substr(n-1+e),r.concat(i).concat(t)}function ir(t,n,e,i){var r,o,a,u,s,c,c,f;if(wr()||I.usedbcs){for(r=[],o=void 0,u=a=0;u<t.length;u++)o=t[u],"doubleByte"===(s=mt(t[u]))&&(a++,o=t[u]),r[u+a]=o;return n=K(n,(c=r.length)+1),e=K(e||0,c-n+1),b(r[n-1])?(r[n-1]=" ",r[n]=" "):b(r[n-2])&&2<=n&&(r[n-2]=" ",r[n-1]=" "),c=r.slice(0,n-1).join(""),f=r.slice(n-1+e).join(""),c.concat(i).concat(f)}return er(t,n,e,i)}function rr(t,n,e,i){var r,o,a,u,s,i,r;if(""===n)return t;if(o=T(n),3<T(arguments)){if(s=void(u=0),(a=v(i))<1)return k;for(s=0;s<a;s++){if(-1===(u=t.indexOf(n,u)))return t;u+=o}i=t.substring(0,u-o),r=t.substr(u),r=i.concat(e).concat(r)}else r=B.qS(t,n,e);return r}function or(){return Hi(arguments,"concatenate")}function ar(){return Hi(arguments,"concat")}function ur(t,n){var t,e,i,r,n,o,a;if(t.isReference&&0===t.length)return it;if(t={value:!1},e=!!b(n[0])||n[0],!At(e,t))return k;for(e=t.value,r=[],n=[],o=T(i=arguments),a=2;a<o;a++)sr(r,i[a],e);return sr(n,i[0],!1),cr(r,n)}function sr(t,n,e){var i,r,i=T(n);if(0!==i)for(r=0;r<i;r++)b(n[r])||""===n[r]?e||t.push(""):t.push(st(n[r]))}function cr(t,n){if(0===t.length)return"";if(1===n.length)return t.join(n[0]);for(var e=t[0],i=1,r=0;i<t.length;i++,r++)e+=n[r=r===n.length?0:r]+t[i];return e}function fr(t,n){return Vi(!0,t,n)}function lr(t,n){return Vi(!1,t,n)}function hr(t,n,e){var i,r,o,a,u,s,c,f,l;if(wr()||I.usedbcs){for(i=[],r=void 0,a=void(o=0),a=u=0;a<n.length;a++)r=n[a],"fourByte"===(s=mt(n[a]))?o%2==0?o++:(o++,r=n[a-1]+n[a],i[i.length]=r):("doubleByte"===s&&(u++,r=n[a]),i[a-(c=0<o?o/2:0)+u]=r);return(f=(i=t?i:pt(i)).length)<=e?n:(l=void 0,t?0<(l=i.slice(0,e-1<0?0:e)).length&&b(l[l.length-1])&&(l[l.length-1]="\u200b"):0<(l=i.slice(f-e)).length&&b(l[0])&&(l[0]="\u200b"),l.join(""))}return Vi(t,n,e)}function dr(t,n){return hr(!0,t,n)}function vr(t,n){return hr(!1,t,n)}function mr(t,n,e){n--;var i=T(t);return i<=n?"":i<n+e?t.substr(n):t.substr(n,e)}function gr(t,n,e){var i,r,r;return wr()||I.usedbcs?(r=(i=gt(t)).length,--n<0?k:r<=n?"":(r<n+e?i.slice(n):(r=i.slice(n,n+e),"singleByte"!==mt(r[r.length-1])&&(r[r.length-1]="\u200b",b(r[0]))&&(r[r.length]="\u200b"),r)).join("")):mr(t,n,e)}function pr(t,n){var e=[],i;if(n<0||32767<n*T(t))return k;for(i=0;i<n;i++)e.push(t);return e.join("")}function br(t){return t?t.length:0}function wr(){var t;return!!s.Common.CultureManager.Fe().isJCKCulture}function yr(t){var n,e,i,r;if(!t)return 0;if(wr()||I.usedbcs){for(e=n=0;e<t.length;e++)8203!==t[e].charCodeAt(0)&&(i=mt(t[e]),r=s.Common.CultureManager.Fe(),"doubleByte"===i)&&9390!==t[e].charCodeAt(0)&&("ja-jp"!==(r&&r.name().toLocaleLowerCase())||711!==t[e].charCodeAt(0)&&9356!==t[e].charCodeAt(0)&&8212!==t[e].charCodeAt(0))&&n++;return t.length+n}return t.length}function Mr(t,n,e){var n;return e<1||T(n)<e||-1===(n=n.indexOf(t,e-1))?k:n+1}function Cr(t,n,e){var i,r,o,o,i,r;return wr()||I.usedbcs?(i=gt(n),r=gt(t),o=i.length,e<1||o<e||(o=Tr(i),i=Tr(r),-1===(r=o.indexOf(i,e-1)))?k:r+1):Mr(t,n,e)}function Sr(t,n,e){var i=-1,r,r,r=c.jJ(t),i;return-1===(i=r?(r=c.OJ(r).exec(n),b(r)?-1:r.index):n.toLowerCase().indexOf(t.toLowerCase(),e-1))?k:i+1}function Tr(t){for(var n=0;n<t.length;n++)b(t[n])&&t[n-1]&&2!==t[n-1].length&&(t[n]="\u200b");return t.join("")}function Ar(t){for(var n=0;n<t.length;n++)b(t[n])&&(t[n]="\u200b")}function Ir(t,n,e){var i,r,o,o;return wr()||I.usedbcs?(i=gt(n),r=gt(t),o=i.length,e<1||o<e||(o=Sr(Tr(r),Tr(i),e))===k?k:o):Sr(t,n,e)}function xr(t,n){return t===n}function Nr(t){return o(t)?t:""}function kr(t){var t;return!t||(t=t)<=0||1114111<t?k:55296<=t&&t<=57343?w:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function _r(t){var t,n,t,t=st(t);return""===t||null===t?k:55296<=(n=t.charCodeAt(0))&&n<=56319?1===t.length?k:56320<=(t=t.charCodeAt(1))&&t<=57343?n|t<<8:1:56320<=n&&n<=57343?n-53248+53248:n}function Dr(t){var n,e;function i(t){for(var n,e,i,r,o,a,u,s,c,f,n=["\u0e25\u0e49\u0e32\u0e19","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19",""],e=["\u0e28\u0e39\u0e19\u0e22\u0e4c","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],i=["\u0e25\u0e1a","\u0e1a\u0e32\u0e17","\u0e16\u0e49\u0e27\u0e19","\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c","\u0e22\u0e35\u0e48","\u0e40\u0e2d\u0e47\u0e14",","," ","\u0e3f"],r="",o=t+"",a=o.length,u=a;0<u;--u){if(c=e[s=l(o[a-u])],1==(f=1<u?(u-1)%6:6)&&2===s&&(c=i[4]),1===s)switch(f){case 0:case 6:r+=u<a?i[5]:c;break;case 1:break;default:r+=c}else{if(0===s){0==f&&(r+=n[f]);continue}r+=c}r+=n[f]}return r}return t?(n=Math.abs(l(t)),e=parseFloat((Math.abs(t)-n).toFixed(2)),0!==n?0===e?(t<0?"\u0e25\u0e1a":"")+i(n)+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":(t<0?"\u0e25\u0e1a":"")+i(n)+"\u0e1a\u0e32\u0e17"+i(100*e)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":0!==e?(t<0?"\u0e25\u0e1a":"")+i(100*e)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":"\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19"):k}function jr(a,u,t,n,e){var i,r,i=function(t,n){for(var e,i,r,o,e=-1,i=-1,r=0;r<u.length;r++)-1===(o=t?a.indexOf(u[r],n):a.lastIndexOf(u[r],n))||-1!==e&&!(t?o<e:e<o)||(e=o,i=r);return{index:e,delimiterIndex:i}};if(1===n&&(a=a.toLocaleLowerCase(),u=u.map(function(t){return t.toLocaleLowerCase()})),0<t){for(r=i(!0),t--;-1!==r.index&&0<t;)r=i(!0,r.index+1),t--;if(1===e&&-1===r.index&&0===t)return{index:a.length,delimiterIndex:-1,isMatchEnd:!0}}else{for(r=i(!1),t++;-1!==r.index&&t<0;)r=i(!1,r.index-1),t++;if(1===e&&-1===r.index&&0===t)return{index:-1,delimiterIndex:-1,isMatchEnd:!0}}return{isMatchEnd:!1,index:r.index,delimiterIndex:r.delimiterIndex}}function Or(t,n,e,i,r,o){var a,e,i,r,u,a=t.length;return b(n)||0===n.length||n.some(function(t){return t.length>a})?w:n.some(function(t){return 0===t.length})?0<e?t:"":a<e?k:(i=(e=jr(t,n,e,i,r)).index,r=e.delimiterIndex,(u=e.isMatchEnd)?-1===i?t:"":-1!==i?t.substring(i+n[r].length):b(o)?w:o)}function Er(t,n,e,i,r,o){var a,n,e,u,a=t.length;return b(n)||0===n.length||n.some(function(t){return t.length>a})?w:n.some(function(t){return 0===t.length})?0<e?"":t:a<e?k:(e=(n=jr(t,n,e,i,r)).index,(u=n.isMatchEnd)?-1===e?"":t:-1!==e?t.substring(0,e):b(o)?w:o)}function Rr(t,n,e){return"function"==typeof t.replaceAll?t.replaceAll(n,e):t.replace(new RegExp(c.D9t(n),"g"),e)}function Fr(t,n,e){var i,r,o;if(b(n))return[t];if(i=n[0],1<n.length)for(r=1;r<n.length;r++)t=Rr(t,n[r],i);return o=t.split(i),o=e?o.filter(function(t){return 0<t.length}):o}function Lr(t,n,e,i,r,o){var a,r,u;return 0===t.length||b(n)&&b(e)||n&&(0===n.length||n.some(function(t){return 0===t.length}))||e&&(0===e.length||e.some(function(t){return 0===t.length}))?k:(1===r&&(t=t.toLowerCase(),e=e&&e.map(function(t){return t.toLowerCase()}),n=n&&n.map(function(t){return t.toLowerCase()})),r=(r=(a=Fr(t,e,i)).map(function(t){return Fr(t,n,i)})).filter(function(t){return 0<t.length}),u=J.apply(null,r.map(function(t){return t.length})),o=b(o)?w:o,r.forEach(function(t){for(var n=u-t.length;0<n;)t.push(o),n--}),new I.CalcArray(r))}function Br(t){return D(t)}function Pr(t){return!!D(t)&&t._code!==w._code}function Gr(t){return!!D(t)&&t._code===w._code}function Ur(t){if(!b(t)&&D(t)){var t=z(t._code,[it._code,N._code,k._code,rt._code,ot._code,y._code,w._code]);if(0<=t)return t+1}return w}function Hr(t){return ct(t,I.ExcelCompatibleCalcMode)}function Vr(t){return m(d(t))%2==0}function zr(t){return m(d(t))%2!=0}function Yr(t){return ht(t)||dt(t)?ut(t):lt(t)?t?1:0:D(t)?t:0}function Zr(t){return b(t)}function Wr(t){return lt(t)}function Qr(t){return o(t)}function Jr(t){return!o(t)}function Kr(t){return j(t)}function Xr(t){return lt(t)?4:ht(t)||dt(t)?1:o(t)?2:D(t)?16:O(t)?64:(0,I.isLambdaFunction)(t)?128:k}function qr(){return w}function $r(t,n){var e,i,r,t,e=0,i=t.source.Mf;if(!O(n)){if(n instanceof I.CalcReference||b(n))return t=n&&(n.rT||n.references[0].rT)||t.source,i.parent.getSheetIndex(t.Mf.name())+1;if(ct(n)||o(n))for(;e<i.parent.sheets.length;e++)if(n.toUpperCase()===i.parent.sheets[e].name().toUpperCase())return e+1}return w}function to(t,n){var e,i,r,r,e=t.source.Mf;return b(n)?e.parent.sheets.length:O(n)||ct(n)?w:o(n)?k:n instanceof I.CalcReference?(r=n.references)?r.length:(r=n.rT||t.source,e.parent.getSheetIndex(r.Mf.name())+1):w}function no(){var t=new I.Functions.AsyncFunction("REFRESH",1,3);t.evaluate=eo,I.Functions.Mmt.REFRESH=t}function eo(t,n){return n}function io(t){return 55296<=t&&t<=57343}function ro(t,n){return!(t<55296||56319<t)&&56320<=n&&n<=57343}function oo(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==L.g)return L.g;try{return new Function("return this")}catch(t){}}function ao(t){var n,e,i,r,o,a,u,n=oo();if(n&&n.encodeURIComponent)return encodeURIComponent(t).replace(/[!~'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()});if(e="",(i=t.length-1)<0)return"";for(r=0;r<=i;r++)if((o=t.charCodeAt(r))>="A".charCodeAt(0)&&o<="Z".charCodeAt(0)||o>="0".charCodeAt(0)&&o<="9".charCodeAt(0)||o>="a".charCodeAt(0)&&o<="z".charCodeAt(0)||o==="-".charCodeAt(0)||o==="_".charCodeAt(0)||o===".".charCodeAt(0))e+=t[r];else{if(a=void 0,io(o)){if(i===r||!ro(o,t.charCodeAt(r+1)))return null;a=[o,t.charCodeAt(r+1)],r++}else a=[o];for(u=0;u<a.length;u++)e=(e+="%")+a[u].toString(16).toUpperCase()}return e}function uo(t){for(var n,e,n=t,e=0;e<n.length;e++)if(!b(n[e])&&"string"!=typeof n[e])return;return 1}function so(t,n,e){var n,e,t;return uo(arguments)?So(n)?w:(n=c.bue(n,e))?(e=t.match(n))?1===(t=e.length)?e[0]:1<t?e[0]===e.input?new I.CalcArray([e.slice(1)]):new I.CalcArray([e]):void 0:w:k:k}function co(t,n,e){var n;return uo(arguments)?So(n)?w:(n=c.bue(n,e))?n.test(t):k:k}function fo(t,n,e,i){var n;return uo(arguments)?So(n)||So(e)?w:(n=c.bue(n,i))?t.replace(n,e):k:k}function lo(t,n,e){var i;return void 0===e&&(e=!0),t!==h||e?D(t)?w:O(t)?E(t,n,!0,!0,!1):E(t,n,!0,!0,!0):k}function ho(t){for(var n,e,i,r,o,a,t,t,u,s,c,s,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(i=n[0],o=[],a=[],t=(t=(r=n[1])&&r.getSource()&&r.getSource().getSheet()||t.source&&t.source.Mf)&&t.pivotTables&&r&&t.pivotTables.findPivotTable(r.getRow(),r.getColumn()),b(t))return rt;for(u=2;u<n.length;u+=2)c=n[u+1],s={fieldName:s=j(s=n[u])?s.getValueByIndex(0):s,itemName:c},(j(c)||O(c)?a:o).push(s);return j(i)&&(i=i.getValueByIndex(0)),0<a.length?vo(i,t,o,a):t.evaluateGetPivotDataFunction(i,o)}function vo(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,d,h,m,g,p,b,w,y,M,C,S,T,A,r=1,o=1,a=[],u=[],s=[],c=0,f=i;c<f.length;c++){if(h=(l=f[c]).fieldName,d=l.itemName,D(d))return d;if((j(d)||O(d))&&(l.itemName=E(d,0,!1,!1,!1),l.itemName.isError))return l.itemName[0];d=(v=n.getField(h)).pivotArea,r=(h=l.itemName.rowCount)<r?r:h,o=(m=l.itemName.colCount)<o?o:m,m<h||h===m&&1===d?a.push(l):(h<m||h===m&&2===d)&&u.push(l)}for(g=0;g<r;g++){for(p=[],b=0;b<o;b++){for(w=[],y=0,M=a;y<M.length;y++)1<(C=M[y]).itemName.colCount?1<C.itemName.rowCount?w.push({fieldName:C.fieldName,itemName:C.itemName[g]&&C.itemName[g][b]}):w.push({fieldName:C.fieldName,itemName:C.itemName[0]&&C.itemName[0][b]}):1<C.itemName.rowCount?w.push({fieldName:C.fieldName,itemName:C.itemName[g]&&C.itemName[g][0]}):w.push({fieldName:C.fieldName,itemName:C.itemName[0]&&C.itemName[0][0]});for(S=0,T=u;S<T.length;S++)1<(A=T[S]).itemName.rowCount?1<A.itemName.colCount?w.push({fieldName:A.fieldName,itemName:A.itemName[g]&&A.itemName[g][b]}):w.push({fieldName:A.fieldName,itemName:A.itemName[g]&&A.itemName[g][0]}):1<A.itemName.colCount?w.push({fieldName:A.fieldName,itemName:A.itemName[0]&&A.itemName[0][b]}):w.push({fieldName:A.fieldName,itemName:A.itemName[0]&&A.itemName[0][0]});p.push(n.evaluateGetPivotDataFunction(t,e.concat(w)))}s.push(p)}return new I.CalcArray(s)}function mo(){var t,n,e,i,r,o,a,u,s,c,u,f,l,h,d,v,m,g,p,t=arguments,n=T(t);if(n<2||n%2!=0)return w;for(i=0;i<n;i+=2){if(u=t[i+1],s=lo(a=t[i],2),c=lo(u,0),D(s))return s;if(D(c))return c;if(s.isError||c.isError)return w;if(u=s.length,f=c.length,b(o))o=f;else if(o!==f)return w;if(f<u)return w;if(u<f){if(!1===r||1<u)return w;for(b(e)&&(e=[]),l=c.rowCount,h=c.colCount,d=s[0],v=0;v<l;v++){for(m=e[v],b(m)&&(m=e[v]=[]),g=0;g<h;g++)b(m[g])&&(m[g]={}),m[g][d]=c[g+v*h];e[v]=m}r=!0}else{if(!0===r)return w;for(b(e)&&(e={}),p=0;p<f;p++)e[s[p]]=c[p];r=!1}}return r?new I.CalcArray(e):e}function go(){var t,n,i,t;function e(t){for(var n,e,n=i.length,e=0;e<n;e++)if(t=t[i[e]],b(t))return w;return t}return n=(t=arguments)[0],i=t[1].split("."),b(t=n)||"object"!=typeof n?w:(O(n)?t.array=t.array.map(function(t){return Array.isArray(t)?t.map(e):e(t)}):t=e(t),t)}function po(t){var n,e,i,r,o;try{if(n=t&&JSON.parse(t),Array.isArray(n)&&0<n.length){for(e=!0,i=0;i<n.length;i++)if(!Array.isArray(n[i])){e=!1;break}if(e)n=new I.CalcArray(n);else{for(r=[],o=0;o<n.length;o++)r.push([n[o]]);n=new I.CalcArray(r)}}return n}catch(t){return k}}function bo(t){return yo(t,"AaK9#@BXHN\uff27S")}function wo(t){return yo(t,"\uff21\uff41\uff2b\uff19\uff03\uff20\uff22\uff38\uff3a\uff2e\uff33")}function yo(t,n){var e,i,r,o,e="";if("number"===(i=t?typeof t:i)||"boolean"===i)e=t+"";else if(t instanceof Date)e=a.o0(t).toString();else{if("object"===i)return k;"string"===i&&(e=t)}return(o=(r=new I._9t(!0,n)).checkText(e)).CheckedText}function Mo(){var t=new I.Functions.AsyncFunction("WEBSERVICE",1,1);t.defaultValue=function(){return""},t.evaluate=Co,I.Functions.Mmt.WEBSERVICE=t}function Co(n,t){var t,i,r,o,t=t;if(!t||t.length>xt)return k;if(i=null,XMLHttpRequest&&(i=new XMLHttpRequest),r=function(t){n.setAsyncResult(t)},o=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===i)return k;try{i.open("GET",t,!0),i.onreadystatechange=function(){var t,n,e;4===i.readyState&&(200!==i.status||!(n=(t=i.response)&&t.type)||-1===n.indexOf("text")&&-1===o.indexOf(n)?r(k):((e=new FileReader).onloadend=function(){r(e.result)},e.onerror=function(){r(k)},e.readAsText(t)))},i.onerror=function(){r(k)},i.timeout=Nt,i.ontimeout=function(){r(k)},i.responseType="blob",i.send(null)}catch(t){return k}}function So(t){return""===t||b(t)}function To(t){return kt.a0(t)||kt.a0(t,jt)}function Ao(t){for(var n,e,i,r,o,n="",e=!1,i=0,r=t.length;i<r;i++)'"'===(o=t[i])?e=!e:e||"Y"!==o||(o=Dt),n+=o;return n}function Io(t){return t.split(Dt).join("y")}function xo(t){return t.formatters[0].E9t}function No(t){return t.j9t&&t.j9t.cultureInfo()||P.Fe(t.cultureName)||P.Fe()}function ko(t,n,e,i){return Fo(t,n,e,No(i=xo(i)),i.O9t)}function _o(){return/qqqq|qqq|qq|q|QQQQ|QQQ|QQ|Q|yyyy|yyy|yy|y|ww|w/g}function Do(t,n,e){var i,r,t;return t?(t=(i=t.index)+t[0].length,e<i?[n.slice(e,i),t]:e===i?["",t]:["",e]):[n.slice(e),e]}function jo(t){return Hn(Ni(t)/3,0)}function Oo(t,n){return _i(t,b(n)?n:v(n))}function Eo(t){var t=new Date(t.getTime()),n=(t.getDay()+6)%7,n=t.getDate()-n,e;return t.setDate(3+n),t.getFullYear()}function Ro(t,n,e,i){var r=Eo(n),o=n.getFullYear();return V(r===o?n:new Date(r,0,1),t,i,e)}function Fo(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o="",a=0,u=i.DateTimeFormat.eras,s=_o(),l=0;o+=(f=Do(c=s.exec(n),n,a))[0],a=f[1],c;l++)switch(c[0]){case"QQQQ":case"qqqq":o+=Ot[jo(t)];break;case"QQQ":case"qqq":o+="Q".concat(jo(t));break;case"QQ":case"qq":o+=G(jo(t),2);break;case"Q":case"q":o+=jo(t);break;case"yyyy":case"yyy":o+=u?Ro("ee",t,r,i):G(Eo(t),4);break;case"yy":o+=u?Ro("ee",t,r,i):G(Eo(t)%100,2);break;case"y":o+=u?Ro("e",t,r,i):(Eo(t)%100).toString();break;case"ww":h=Oo(t,e),D(h)?o+=h:o+=G(h,2);break;case"w":o+=Oo(t,e)}return o.toString()}function Lo(){function t(){this.R9t=[{J6t:6},{J6t:5},{J6t:2}],this.Ul={}}(t.prototype=new I.Functions.Function("DATEPART",2,3)).evaluate=function(t,n,e){var i,r,o,o,i;return So(n)||!To(n)?"":((i=this.Ul)[n=(r=21===e&&/Y/g.test(n)&&/w/g.test(n))?Ao(n):n]||(o=s.Formatter&&s.Formatter.GeneralFormatter,i[n]=o?new o(n):h),i=(o=i[n]).format(t),r&&(i=Io(i)),/q|Q|w|y/g.test(i)?ko(t,i,e,o):i)},I.Functions.Mmt.DATEPART=new t}function Bo(t,n){if(!t||8!==t.type)throw(0,I.sR)().Exp_FormulaInvalid;if(-1!==n.indexOf(t.value))throw(0,I.sR)().Exp_FormulaInvalid;if(-1<t.value.indexOf("."))throw(0,I.sR)().Exp_FormulaInvalid}function Po(t){var n=crypto&&crypto.randomUUID&&crypto.randomUUID();return b(n)&&(n="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),n=32===t?n.split("-").join(""):n}function Go(t,n,e){var i=t.length,r=n.length;return 0===i||0===r||i<r?w:((e=void 0===e?0:e)&&(t=t.toUpperCase(),n=n.toUpperCase()),t.lastIndexOf(n)===i-r)}function Uo(t,n,e){var i=t.length,r=n.length;return 0===i||0===r||i<r?w:((e=void 0===e?0:e)&&(t=t.toUpperCase(),n=n.toUpperCase()),0===t.indexOf(n))}function Ho(t,n){return void 0===n&&(n=4),(t=t instanceof Date?t:new Date(t)).getMonth()<n-1?t.getFullYear()-1:t.getFullYear()}Object.defineProperty(t,"__esModule",{value:!0}),s=L("Common"),I=L("CalcEngine"),c=s.Common.$T,B=s.Common.zf,a=s.Common.ct,P=s.Common.CultureManager,G=s.Common.zf.B9t,f=a.o0,U=a.Y0,H=a.yU,V=a.L9t,T=s.Common.Uf.tR,t=s.Common.lt,z=t.Rh,b=t.ht,h=null,A=void 0,Y=isNaN,Z=parseFloat,l=parseInt,W=Math.round,d=Math.abs,Q=Math.sqrt,J=Math.max,K=Math.min,x=Math.floor,X=Math.exp,q=Math.log,$=Math.PI,tt=Math.random,nt=Math.pow,et=Math.ceil,it=I.Errors.Null,N=I.Errors.DivideByZero,k=I.Errors.Value,rt=I.Errors.Reference,ot=I.Errors.Name,g=I.Errors.Calc,w=I.Errors.NotAvailable,y=I.Errors.Number,_=I.Convert.CalcConvertedError,D=I.Convert.BJ,j=I.Convert.LE,O=I.Convert.Nh,at=I.Convert.YK,v=I.Convert.z6t,ut=I.Convert.uJ,st=I.Convert.j,ct=I.Convert.q8,E=I.Convert.iV,R=I.Convert.L6t,ft=I.skt.tryExtractToSingleValue,lt=I.Functions.G6t,ht=I.Functions.q8,dt=a.W0,o=I.Functions.OMt,vt=I.Functions.F9t,mt=I.Functions.P9t,gt=I.Functions.G9t,pt=I.Functions.U9t,bt=I.Functions.Pkt,wt=I.Functions.nkt,yt=I.Functions.b9t,Mt=I.Functions.H9t,Ct=I.Functions.y9t,u=I.Functions.MathHelper,St=u.z9t,m=u.d9t,t=I.Functions.F6t,Tt=I.Convert.sJ,At=I.Convert.YK,It=I.Convert.Sft,xt=2048,Nt=1e4,kt=s.Formatter.Hf,_t=21,Dt="(&}",jt=["qqqq","qqq","qq","q","QQQQ","QQQ","QQ","Q","YYYY","YYY","YY","Y","ww","w"],Ot={1:"1st quarter",2:"2nd quarter",3:"3rd quarter",4:"4th quarter"},Et=new Date(1899,11,30),Rt=new Date(9999,11,31),Ft={J6t:0,pkt:"= 0",zkt:N},e={J6t:0,pkt:"= 0",zkt:0},Lt={bkt:1,J6t:0,pkt:"= 0",zkt:0},Bt={J6t:2,pkt:"< 0"},Pt={J6t:0,pkt:["> 134217728","< -134217728"]},Gt={J6t:1},i={J6t:2},Ut={bkt:1,J6t:2},r={bkt:1,J6t:2,pkt:"< 0",zkt:k},Ht={bkt:1,J6t:2,pkt:["= 0"],zkt:k},Vt={bkt:0,J6t:2,pkt:["< 0","> 1"],zkt:k},p={J6t:5},M={J6t:6},zt={J6t:2,pkt:"< 0",zkt:k},Zt={bkt:!(Yt={J6t:5,zkt:k}),J6t:7},Wt={bkt:[],J6t:4,X6t:4,Vkt:!0,Ykt:!0,M9t:!0},Qt={J6t:4,X6t:1,Ykt:!0,M9t:!0},Jt={J6t:4,X6t:1,Vkt:!0,Ykt:!0,n9t:!0},Kt={J6t:4,X6t:3,Vkt:!0,Ykt:!0,n9t:!0},Xt={J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},qt={J6t:4,X6t:2,Vkt:!0,Ykt:!0,n9t:!0},$t=[0,"%= 1 && >= 3"],t("ABS",sn,1,1,n={J6t:0}),t("ACOS",we,1,1,{J6t:0,pkt:["> 1","< -1"]}),t("ACOT",xe,1,1,n),t("ASIN",be,1,1,{J6t:0,pkt:["> 1","< -1"]}),t("ATAN",Ie,1,1,n),t("ATAN2",Ne,2,2,[n,n]),t("COS",ve,1,1,n),t("SEC",me,1,1,Pt),t("CEILING",En,2,2,[e,e]),t("ODD",vn,1,1,Gt),t("EVEN",mn,1,1,Gt),t("FLOOR",Rn,2,2,[e,e]),t("LN",bn,1,1,{J6t:1,pkt:"<= 0"}),t("SQRT",Nn,1,1,{J6t:0,pkt:"< 0"}),t("SIN",he,1,1,n),t("CSC",de,1,1,Pt),t("TAN",ge,1,1,n),t("COT",pe,1,1,Pt),t("SIGN",Tn,1,1,{J6t:1,pkt:"> 0",zkt:1}),t("GCD",An,1,A,Jt,-1,-1),t("LCM",In,1,A,Jt,-1,-1),t("PRODUCT",xn,1,A,A,-1,-1),t("POWER",Mn,2,2,[n,n]),t("MOD",wn,2,2,[n,{J6t:0,pkt:"= 0",zkt:N}]),t("QUOTIENT",kn,2,2,[n,Ft],A,A),t("SUBTOTAL",_n,2,A,i,"!= 0",A,{u9t:4}),t("_SUBTOTALFORSTATUSBAR",Dn,2,5e3,i,"!= 0",A,{u9t:4}),t("INT",cn,1,1,A,A,A),t("MROUND",Pn,2,2,[e,e]),t("ROUND",Gn,2,2,[n,i]),t("ROUNDDOWN",Un,2,2,[n,i]),t("ROUNDUP",Hn,2,2,[n,i]),t("TRUNC",Un,1,2,[n,{bkt:0,J6t:2}],A,A,{wkt:1}),t("EXP",Vn,1,1,n),t("LOG",Zn,1,2,[{J6t:0,pkt:"<= 0"},{bkt:10,J6t:0,pkt:"<= 0"}],A,A,{wkt:1}),t("LOG10",Wn,1,1,{J6t:0,pkt:"<= 0"}),t("SUM",Sn,1,A,A,-1,-1),t("SUMIF",Jn,2,3,A,[0,2],A,{wkt:2,e9t:[2],i9t:!0,o9t:4,f9t:1,r9t:!0}),t("AVERAGEIF",Kn,2,3,A,[0,2],A,{wkt:2,e9t:[2],i9t:!0,f9t:1,r9t:!0}),t("SUMIFS",qn,3,A,A,[0,"%= 1"],A,{e9t:$t,i9t:!0,o9t:4,f9t:"%= 0",r9t:!0}),t("SUMPRODUCT",re,1,A,A,-1,-1,{o9t:1}),t("SUMSQ",oe,1,A,Jt,-1,-1),t("SUMX2MY2",ae,2,2,Jt,-1,-1),t("SUMX2PY2",ue,2,2,Jt,-1,-1),t("SUMXMY2",se,2,2,Jt,-1,-1),t("SERIESSUM",ce,4,4,[n,i,i,{J6t:4,X6t:1,Vkt:!0,Ykt:!0,M9t:!0}],3,3),t("PI",yn,0,0),t("SQRTPI",fe,1,1,{J6t:0,pkt:"< 0"}),t("DEGREES",dn,1,1,Gt),t("RADIANS",le,1,1,n),t("COSH",Ce,1,1,n),t("SECH",Se,1,1,n),t("ACOSH",Ae,1,1,{J6t:0,pkt:"< 1"}),t("SINH",ye,1,1,n),t("CSCH",Me,1,1,n),t("ASINH",Te,1,1,n),t("TANH",ke,1,1,n),t("COTH",_e,1,1,{J6t:0}),t("ATANH",De,1,1,{J6t:0,pkt:["<= -1",">= 1"]}),t("ACOTH",je,1,1,{J6t:0}),t("MDETERM",Oe,1,1,Qt,-1,-1),t("MINVERSE",Ee,1,1,Qt,-1,-1),t("MMULT",Re,2,2,[Qt,Qt],-1,-1),t("FACT",gn,1,1,{J6t:3,pkt:["< 0","> 170"]}),t("FACTDOUBLE",pn,1,1,{J6t:3,pkt:["< 0","> 300"]}),t("MULTINOMIAL",Fe,1,A,{J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),t("RAND",Le,0,0,A,A,A,{V9t:!0}),t("RANDBETWEEN",Be,2,2,[n,n],A,A,{V9t:!0}),t("COMBIN",fn,2,2,[Bt,Bt]),t("COMBINA",ln,2,2,[Bt,Bt]),t("DECIMAL",hn,2,2,[{bkt:"0",J6t:5},{J6t:0,pkt:["> 36","< 2"]}]),t("CEILING.MATH",Fn,1,3,[n,{J6t:0,bkt:1},{J6t:0,bkt:0}]),t("FLOOR.MATH",Ln,1,3,[n,{J6t:0,bkt:1},{J6t:0,bkt:0}]),t("BASE",Bn,2,3,[{J6t:0,pkt:["< 0",">= 9007199254740992"]},{J6t:3,pkt:["> 36","< 2"]},{J6t:3,bkt:0,pkt:["< 0",">= 256"]}]),t("ROMAN",Pe,1,2,[{J6t:2,pkt:["< 0","> 3999"],zkt:k},{bkt:0}],A,A,{wkt:1}),t("ARABIC",Ge,1,1,p),t("CEILING.PRECISE",zn,1,2,[e,Lt]),t("ISO.CEILING",zn,1,2,[e,Lt]),t("FLOOR.PRECISE",Yn,1,2,[e,Lt]),t("MAXIFS",$n,3,A,A,[0,"%= 1"],[0,"%= 1"],{e9t:$t,i9t:!0,f9t:"%= 0",r9t:!0}),t("MINIFS",te,3,A,A,[0,"%= 1"],[0,"%= 1"],{e9t:$t,i9t:!0,f9t:"%= 0",r9t:!0}),t("AVERAGEIFS",ee,3,A,A,[0,"%= 1"],[0,"%= 1"],{e9t:$t,i9t:!0,f9t:"%= 0",r9t:!0}),t("COUNTIFS",ne,2,A,A,"%= 0","%= 0",{e9t:["%= 0 && >= 2"],i9t:!0,f9t:"%= 1",r9t:!0}),t("MUNIT",ie,1,1,{J6t:2,pkt:"<= 0",zkt:k}),t("SEQUENCE",Ue,1,4,[i,i,n,n],A,A,{wkt:[0,1,2,3]},!0),t("RANDARRAY",He,0,5,[i,i,n,n],A,A,{V9t:!0,wkt:[0,1,2,3,4]},!0),t("AGGREGATE",On,3,A,A,"> 1","> 1",{o9t:1,r9t:!0,u9t:4}),t("AND",ze,1,A,Xt,-1,-1),t("OR",Ye,1,A,Xt,-1,-1),t("NOT",Ze,1,1),t("IF",We,2,3,A,[1,2],[1,2],{f9t:[1,2],wkt:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var t;return I.Convert.BJ(t)?-1:(at(t,t={value:!1}),t.value?1:2)}}),t("IFERROR",Je,2,2,A,A,A,{f9t:-1}),t("TRUE",Ke,0,0),t("FALSE",Xe,0,0),t("IFNA",qe,2,2,A,A,A,{f9t:-1}),t("IFS",$e,2,254,A,A,A,{f9t:-1}),t("SWITCH",ti,3,253,A,A,A,{f9t:-1}),t("XOR",ni,1,A,Kt,-1,-1),t("LET",A,3,253,A,A,A,{argsValidator:function(t,n,e,i){var r,o;if(e%2==0)throw(0,I.sR)().Exp_FormulaInvalid;for(r=[],o=0;o<i.length-1;o+=2)Bo(i[o],r),r.push(i[o].value)}}),t("LAMBDA",A,1,253,A,A,A,{argsValidator:function(t,n,e,i){for(var r,o,r=[],o=0;o<i.length-1;o++)Bo(i[o],r),r.push(i[o].value)}}),t("MAP",ai,2,A,A,-1,-1,{isContextSensitive:!0},!0),t("REDUCE",ui,3,3,A,-1,-1,{isContextSensitive:!0},!0),t("SCAN",si,3,3,A,-1,-1,{isContextSensitive:!0},!0),t("BYROW",fi,1,2,A,-1,-1,{isContextSensitive:!0},!0),t("BYCOL",li,1,2,A,-1,-1,{isContextSensitive:!0},!0),t("MAKEARRAY",ci,3,3,[r,r],A,A,{isContextSensitive:!0},!0),t("DATE",bi,3,3,[{J6t:2,pkt:["< 0","> 9999"]},i,i]),t("TIME",wi,3,3,[i,i,i]),t("DATEVALUE",yi,1,1,{iTe:!0}),t("TIMEVALUE",Mi,1,1,{iTe:!0}),t("NOW",Ci,0,0,A,A,A,{V9t:!0}),t("TODAY",Si,0,0,A,A,A,{V9t:!0}),t("HOUR",Ti,1,1,M),t("MINUTE",Ai,1,1,M),t("SECOND",Ii,1,1,M),t("DAY",xi,1,1,M),t("MONTH",Ni,1,1,M),t("YEAR",ki,1,1,M),t("WEEKNUM",_i,1,2,[M,Ut],A,A,{wkt:1}),t("WEEKDAY",S,1,2,[M,Ut],A,A,{wkt:1}),t("EDATE",Di,2,2,[M,i]),t("EOMONTH",ji,2,2,[M,i]),t("WORKDAY",Oi,2,3,[M,i,Wt],2,2,{wkt:2}),t("WORKDAY.INTL",Ei,2,4,[M,i,{bkt:"0000011"},Wt],[3],[2,3],{wkt:[2,3]}),t("DAYS360",I.Functions.Mkt,2,3,[M,M,{bkt:!1,J6t:7}],A,A,{wkt:2}),t("NETWORKDAYS",Ri,2,3,[M,M],2,2,{wkt:2}),t("NETWORKDAYS.INTL",Li,2,4,[M,M],[2,3],[2,3],{wkt:[2,3]}),t("YEARFRAC",I.Functions.Hkt,2,3,[M,M,{bkt:0,J6t:2}],A,A,{wkt:2}),t("DATEDIF",Bi,3,3,[M,M,p]),t("DAYS",Pi,2,2),t("ISOWEEKNUM",Gi,1,1,M),t("CLEAN",zi,1,1,p),t("TRIM",Yi,1,1,p),t("DOLLAR",Zi,1,2,[n,{bkt:2,J6t:2,pkt:"> 99",zkt:k}],A,A,{wkt:1}),t("FIXED",Wi,1,3,[n,{bkt:2,J6t:2},{bkt:!1,J6t:7}],A,A,{wkt:[1,2]}),t("TEXT",Qi,2,2,[{},p]),t("VALUE",Ji,1,1,A,A,A),t("LOWER",Xi,1,1,p),t("UPPER",qi,1,1,p),t("PROPER",$i,1,1,p),t("CHAR",tr,1,1,{J6t:2,pkt:["> 255","< 1"],zkt:k}),t("CODE",nr,1,1,{J6t:5,iTe:!0}),t("REPLACE",er,4,4,[p,{J6t:2,pkt:"< 1",zkt:k},zt,p],A,A,{wkt:2}),t("SUBSTITUTE",rr,3,4,[p,{J6t:5},p],A,A,{wkt:3}),t("CONCATENATE",or,1,A,{J6t:4,X6t:0,Vkt:!0,n9t:!0},A,-1),t("LEFT",fr,1,2,[p,r],A,A,{wkt:1}),t("MID",mr,3,3,[p,{J6t:2,pkt:"<= 0",zkt:k},zt]),t("RIGHT",lr,1,2,[p,r],A,A,{wkt:1}),t("REPT",pr,2,2,[p,i]),t("LEN",br,1,1,p),t("FIND",Mr,2,3,[p,p,Ut],A,A,{wkt:2}),t("SEARCH",Sr,2,3,[p,p,r],A,A,{wkt:2}),t("EXACT",xr,2,2,[p,p]),t("T",Nr,1,1),t("UNICHAR",kr,1,1,[{J6t:2,zkt:k}]),t("UNICODE",_r,1,1),t("BAHTTEXT",Dr,1,1,[{J6t:0,zkt:k}]),t("CONCAT",ar,1,A,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),t("TEXTJOIN",ur,3,A,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),t("FINDB",Cr,2,3,[p,p,Ut],A,A,{wkt:2}),t("LEFTB",dr,1,2,[p,r],A,A,{wkt:1}),t("RIGHTB",vr,1,2,[p,r],A,A,{wkt:1}),t("MIDB",gr,3,3,[p,zt,zt]),t("LENB",yr,1,1,p),t("REPLACEB",ir,4,4,[p,{J6t:2,pkt:"< 1",zkt:k},zt,p],A,A,{wkt:2}),t("SEARCHB",Ir,2,3,[p,p,r],A,A,{wkt:2}),t("TEXTAFTER",Or,2,6,[p,qt,Ht,Vt,Vt,p],[1],[1],{wkt:[2,3,4,5]}),t("TEXTBEFORE",Er,2,6,[p,qt,Ht,Vt,Vt,p],[1],[1],{wkt:[2,3,4,5]}),t("TEXTSPLIT",Lr,2,6,[p,qt,qt,Zt,Vt,p],[1,2],[1,2],{wkt:[1,2,3,4,5]},!0),t("ENCODEURL",ao,0,1,p),t("ISERROR",Br,1,1,A,A,A,{f9t:-1}),t("ISERR",Pr,1,1,A,A,A,{f9t:-1}),t("ISNA",Gr,1,1,A,A,A,{f9t:-1}),t("ERROR.TYPE",Ur,1,1,A,A,A,{f9t:-1}),t("ISNUMBER",Hr,1,1,A,A,A,{f9t:-1}),t("ISEVEN",Vr,1,1,n,A,A),t("ISODD",zr,1,1,n,A,A),t("N",Yr,1,1,A,A,A),t("ISBLANK",Zr,1,1,A,A,A,{f9t:-1}),t("ISLOGICAL",Wr,1,1,A,A,A,{f9t:-1}),t("ISTEXT",Qr,1,1,A,A,A,{f9t:-1}),t("ISNONTEXT",Jr,1,1,A,A,A,{f9t:-1}),t("ISREF",Kr,1,1,A,-1,A,{f9t:-1}),t("TYPE",Xr,1,1,A,A,-1,{f9t:-1}),t("NA",qr,0,0),t("SHEET",$r,0,1,A,-1,A,{r9t:!0}),t("SHEETS",to,0,1,A,-1,A,{r9t:!0}),t("GETPIVOTDATA",ho,2,253,A,-1,-1,{r9t:!0}),t("OBJECT",mo,2,A,A,-1,-1),t("PROPERTY",go,2,2,A),t("FILTERJSON",po,1,1,A),t("ASC",bo,1,1),t("DBCS",wo,1,1),t("ISOMITTED",A,1,1,A,-1,-1),t("GC.REGEXEXTRACT",so,2,3),t("GC.REGEXMATCH",co,2,3,A),t("GC.REGEXREPLACE",fo,3,4,A),t("SJS.REGEXEXTRACT",so,2,3),t("SJS.REGEXMATCH",co,2,3,A),t("SJS.REGEXREPLACE",fo,3,4,A),Lo(),Mo(),no(),t("SJS.UUID",Po,0,1,A),t("SJS.ENDWITH",Go,2,3,[{J6t:5},{J6t:5},{J6t:2}]),t("SJS.STARTWITH",Uo,2,3,[{J6t:5},{J6t:5},{J6t:2}]),t("SJS.FISCALYEAR",Ho,1,2)},CalcEngine:function(t){t.exports=a("CalcEngine")},Common:function(t){t.exports=a("Common")}},i={},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.Functions=void 0,r=o("CalcEngine"),Object.defineProperty(n,"Functions",{enumerable:!0,get:function(){return r.Functions}}),o("./src/functions-basic.ts"),(((u={}).Spread=u.Spread||{}).CalcEngine=u.Spread.CalcEngine||{}).BasicFunctions=t}(),t.exports=u.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@spreadjs/js-calc-basicfunctions/index.js":function(t,n,e){t.exports=e("./node_modules_local/@spreadjs/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@spreadjs/js-calc/dist/gc.spread.calcengine.js":function(t,n,o){var a;!function(){"use strict";var e,i,t;function r(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,r)),n.exports}e={"./src/Parser.ts":function(b,k,t){var n,c,y,s,f,M,h,d,w,I,x,_,C,t,g,N,U,H,l,D,j,O,E,e,R,F,t,V,i,z,Y,Z,W,Q,J,r,o;function S(){throw(0,y.sR)()[U]}function L(t,n,e){throw C.I5((0,y.sR)()[e||N],[t,n])}function K(t){return t<=255}function X(t){return t<=127}function T(t){return t===(0,y.getBoolean)().boolean_true||t===I}function A(t){return t===(0,y.getBoolean)().boolean_false||t===x}function B(t){return 48<=t&&t<=57}function q(t){var t=t.charCodeAt(0);return!(t<=255)||(t<=127?96<=(t|=32)&&t<=122:0===e[t]||1===e[t])}function $(t){var t=t.charCodeAt(0);return!(t<=255)||(t<=127?t<=57?48<=t:96<=(t|=32)&&t<=122:0===e[t]||1===e[t])}function tt(t){var t=t.charCodeAt(0);return t<=127?48<=t&&t<=57:8===e[t]||10===e[t]}function P(t,n,e,i,r,o){for(var a,u,s,c,f,l,a=t.length,u=e===i?0:1,s=[],c=0,f=n+1;f<a;f++)if((l=t[f])===r&&(s.push(l),c++,l=t[++f]),l===e&&u++,l===i)if(u--,e===i&&f+2<a&&t[f+1]===e)s.push(e),f++,c++;else{if(0===u)return{result:s,endIndex:f,skipCount:c};s.push(l)}else s.push(l);o&&L(i,e,H)}function nt(t,n,e){for(var i,r,o,a,u,s,c,i=t.length,r=i-n,o=(0,y.getErrorList)(),a=0;a<o.length;a++)if(n+(s=(u=o[a]).length)<=i&&(c=t.slice(n,n+s),s<=r)&&u===c.join("").toUpperCase())return{result:c,endIndex:n+s-1};e&&L([t[n],n])}function et(t){return 0!==t.type&&(7!==t.type||"ANCHORARRAY"===t.functionName)&&t.type<9}function it(t,n,e){for(var i,r,o,a,u,i=t.length,r=0,o=[],a=n;a<i;a++)if(B((u=t[a]).charCodeAt(0)))0===r?r=2:3===r?r=4:1===r?r=2:5!==r&&6!==r||(r=7),o.push(u);else if(u===e){if(2===r)r=4;else{if(0!==r&&1!==r)return{};r=3}o.push(".")}else if("+"===u||"-"===u){if(0===r)r=1;else{if(5!==r)return{num:o,endIndex:a-1};r=6}o.push(u)}else if("E"===u||"e"===u){if(2!==r&&4!==r)return{};r=5,o.push(u)}else if(2===r||4===r||7===r)return{num:o,endIndex:a-1};return 2===r||4===r||7===r?{num:o,endIndex:i-1}:{}}function G(t,n){R.apply(t,n)}function a(t,n,e,i,r){var o,a,i;this.R1t=[],r=r||0,(o=this).y4=t,a=Array.isArray(t)?t.join(""):t,o.uit=n,o.lp=e,o.ywt=i||e+t.length-1,0===n&&0===r&&t&&(T(i=a.toUpperCase())||A(i))&&(r=5,a=i),o.Awt=a,o.Twt=r}function u(t){this.priority=t=void 0===t?5e3:t}function rt(t){for(var n,e,i,n=0,e=t;n<e.length;n++)if(0===(i=e[n]).type&&","!==i.value||i.arguments&&rt(i.arguments))return 1}function ot(t,n,e){t.lit=n,t.ywt=e}function at(t){var n=t.value;n&&n[0]===s&&n[n.length-1]===f&&(t.value=n.substring(1,n.length-1),t.Bve=!0)}function v(){}function m(t,n,e,i){this.lyt=!1,this.Nme=!1,this.ignoreError=!1;var r=this;r.useR1C1=n,r.baseIdentity=e,r.option=i,r.source=t}function ut(t,n,e){var i,r,r,o;if(B(+t[0]))return 1;if(0<(r=(i=t).lastIndexOf("[")))return 1;if(0===r){if(!(0<(r=t.lastIndexOf("]"))))return 1;if(!st(o=t.slice(1,r)))return 1;i=t.slice(r+1)}return!ct(i,n,e)}function st(t){var n,e;if(t&&0!==t.length)for(e=0;e<t.length;e++)if(n=t[e],z[n]||k.operaterTypesMap[n])return;return 1}function ct(t,n,e){var i,r;if(t&&0!==t.length){if(!n){if(tt(t[0]))return!1;if(lt(t))return!1;if(Y.test(t[0]))return!1}for(r=0;r<t.length;r++)if(i=t[r],n){if("*"===i||":"===i||"["===i||"]"===i||"?"===i||"\\"===i||"/"===i)return!1}else if(Z[i]||k.operaterTypesMap[i]||"\u3000"===i&&(e||c.Common.CultureManager.Fe().isJCKCulture))return!1}return!0}function ft(t){var n,e,t,n=t.search(/[0-9]/),e=t.substr(0,n),t=parseInt(t.substr(n),10);return(n<=2||3===n&&e<="XFD")&&t<=y.MAX_ROW_COUNT}function lt(t){var t=t.join("").toUpperCase();return!!("RC"===t||"C"===t||"R"===t||W.test(t)||Q.test(t)&&ft(t))}function ht(t,n,e){if(!n||0===n.length)return[];var i=n,r;if(ut(n,!1,t.lyt)||e&&ut(e,!1,t.lyt)){for(i=["'"],r=0;r<n.length;r++)"'"===n[r]&&i.push("'"),i.push(n[r]);if(e)for(i.push(":"),r=0;r<e.length;r++)"'"===e[r]&&i.push("'"),i.push(e[r]);i.push("'")}else if(e)for(i.push(":"),r=0;r<e.length;r++)i.push(e[r]);return i}function p(){return null!==o&&o.apply(this,arguments)||this}n=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(k,"__esModule",{value:!0}),k.DefaultTokenResolver=k.Mge=k.Cmt=k.ParserContext=k.Parser=k.TokenResolver=k.FormulaToken=k.isNumber=k.Jkt=k.Swt=k.isDigit=k.isActualFalse=k.isActualTrue=k.operaterTypesMap=k.preOperaterTypesMap=k.Z9t=void 0,c=t("Common"),y=t("./src/calc.common.ts"),s="[",f="]",M=void 0,h=null,d="string",w="boolean",I="TRUE",x="FALSE",_="ARRAY",C=c.Common.zf,t=c.Common.lt,g=t.ht,N="Exp_FormulaInvalidChar",U="Exp_FormulaInvalid",H="Exp_NoSyntax",k.Z9t=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," ","."],k.preOperaterTypesMap={"+":0,"-":1},k.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},l={":":0," ":1,".":2,"^":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},D=".",O=";",E=j=",",e=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],k.isActualTrue=T,k.isActualFalse=A,k.isDigit=B,k.Swt=q,k.Jkt=$,k.isNumber=tt,R=[].push,a.prototype.type=function(){return this.uit},a.prototype.subType=function(){return this.Twt},a.prototype.stringValue=function(){return this.Awt},F=a,k.FormulaToken=F,u.prototype.resolveToken=function(t,n,e,i,r){return 0},u.prototype.unparse=function(t,n,e,i){return!0},k.TokenResolver=t=u,v.prototype.setParserOption=function(t){var n,e;t!==M&&c.Common.CultureManager.Fe()?(e=("object"==typeof t&&t.NumberFormat?t:c.Common.CultureManager.Fe()).NumberFormat,n=t?e:{}):e=n={},j=v.listSeparator=n.listSeparator||",",D=n.numberDecimalSeparator||".",!t&&v.numberDecimalSeparator||(v.numberGroupSeparator=e.numberGroupSeparator||",",v.numberDecimalSeparator=e.numberDecimalSeparator||"."),O=v.arrayGroupSeparator=n.arrayGroupSeparator||";",E=v.arrayListSeparator=n.arrayListSeparator||","},v.prototype.parseDotOperator=function(t,n,e){var i,r,o,a,u,o,i=n[e];if(!(n[e-1]&&"#"===n[e-1].y4&&"."!==i.Awt[0]||n[e+1]&&":"===n[e+1].y4||0!==i.uit||0!==i.Twt||(0,y.W9t)(t.source,i.Awt)||!(0<=(r=i.Awt.lastIndexOf("."))))){if(0<=(o=i.Awt.substring(r+1)).indexOf("]"))return 0;if(a=new F(i.Awt.substring(0,r).split(""),0,i.lp,i.lp+r-1),u=new F(["."],5,i.lp+r,i.lp+r),(o=new F(o.split(""),0,i.lp+r+1,i.ywt)).Q9t=!0,r===i.Awt.length-1)return 0===r?n.splice(e,1,u):n.splice(e,1,a,u),1+this.parseDotOperator(t,n,e);if(0<r)return n.splice(e,1,a,u,o),2+this.parseDotOperator(t,n,e);if(0===r)return n.splice(e,1,u,o),1}return 0},v.prototype.parse=function(t,n){var n,e,i;if(n=(0,y.Fve)(n),this.setParserOption(t.culture),n=n.split(""),this.J9t=n,t.X9t=!1,e=this.parseToTokens(t,n,!t.ignoreError),t.source&&!t.source.skipDotOperator&&t.X9t)for(i=0;i<e.length;i++)i+=this.parseDotOperator(t,e,i);return this.buildExpressionTree(t,e,!t.ignoreError)},v.prototype.unparse=function(t,n,e){return this.q9t(t,n,e=void 0===e?[]:e),e.join("")},v.prototype.q9t=function(t,n,e){var i,r;if(n)for(!n.$9t||t.lyt||t.Nme||e.push("@"),this.setParserOption(t.culture),i=t.getResolvers(),r=0;r<i.length&&!i[r].unparse(t,this,n,e);r++);},v.prototype.parseToTokens=function(r,t,n){var e,i,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,w,M,C,S,T,A,I,I,x,x,N,N;for(void 0===n&&(n=!0),e=this,i=function(t,n,e,i){return 0<n.length&&(0<=n.indexOf(".")&&(r.X9t=!0),t.push(new F(n,0,e,i))),[]},o=t.length,a=[],u=[],s=-1,c=[],h=0;h<o&&" "===t[h];)h++;for("="===t[h]&&h++,m=l=h;m<o;m++)if(b=void 0,64===(p=(g=t[m]).charCodeAt(0)))c=i(a,c,l),a.push(new F(t[m],4,m,m)),l=m+1;else if(97<=p&&p<=122||65<=p&&p<=90)c.push(g);else if(34===p)0<c.length&&(c=i(a,c,l)),(b=P(t,m,'"','"',"",n))?(w=new F(b.result,0,m,b.endIndex,3),b.skipCount&&(w.Ewt=t.slice(m,b.endIndex+1).join(""),w.ywt+=b.skipCount),a.push(w),l=(m=b.endIndex)+1):(G(c,t.slice(m,o)),m=o-1);else if(39===p)if(b=P(t,m,"'","'","",n)){if(0<c.length&&(c=i(a,c,l),l=m),y=[],-1<(w=b.result.join("")).indexOf(":")&&-1===w.indexOf("["))for(C=(M=w.split(":")).length,S=0;S<C;S++)T="'"+M[S]+"'",A=l+M[S].length-1,0===S?A++:S===C-1&&(A=b.endIndex),c=i(y,T.split(""),l,A),l=A+1,S!==C-1&&(y.push(new F(":",5,l,l,11)),l++);y&&0<y.length?G(a,y):(c.push("'"),G(c,b.result),c.push("'")),m=b.endIndex}else c.push("'"),m=o-1;else if(91===p)(b=P(t,m,"[","]","'",n))?(c.push("["),G(c,b.result),c.push("]"),m=b.endIndex):e._isR1C1&&0===c.length&&("R"===c[0]||"r"===c[0]||"C"===c[0]||"c"===c[0])||(G(c,t.slice(m,o)),m=o-1);else if(13!==p&&10!==p)if(35===p)l=(I=nt(t,m))?(a.push(new F(I.result,0,m,m+I.result.length-1,6)),(m=I.endIndex)+1):(c=i(a,c,l),a.push(new F(t[m],6,m,m)),m+1);else if(33===p)c.length,0<(I=a.length)&&0===a[I-1].uit?(x=a[I-1],R.apply(x.y4,c),a[I-1]=new F(x.y4,0,x.lp,m,12)):a.push(new F(c,0,l,m,12)),c=[],l=m+1;else if(43===p||45===p)x=0===a.length?null:a[a.length-1],l=(0!==c.length?(c=i(a,c,l),a.push(new F(g,5,m))):(x&&7===x.uit&&a.pop(),!x||2!==x.Twt&&6!==x.uit&&0!==x.uit?a.push(new F(g,4,m)):a.push(new F(g,5,m))),m+1);else if(g===D||B(p))!(0<c.length)&&(N=it(t,m,D)).num?(d=N.endIndex,N=N.num,l=d<=o-2&&"!"===t[d+1]?(G(c,N),d):(a.push(new F(N,0,m,d,4)),d+1),m=d):c.push(g);else if(123===p)0<c.length&&(n?L(g,m):c=i(a,c,l)),f=new F(_,1,m,m,1),a.push(f),u[++s]=f,l=m+1;else if(g===O&&0<=s&&u[s].value===_)c=i(a,c,l),s<0&&n&&L(g,m),a.push(new F(O,3,m,m)),l=m+1;else if(125===p)c=i(a,c,l),d<0&&n&&L(g,m),v=u[s],s--,v=new F(g,v.uit,m,m,2),a.push(v),l=m+1;else if(32===p)c=i(a,c,l),l=m+1;else if(g===j||g===E||g===O)c=i(a,c,l),s<0||1!==u[s].uit?a.push(new F(j,5,m,m,10)):a.push(new F(g,3,m,m)),l=m+1;else if(37===p)c=i(a,c,l),a.push(new F(t[m],6,m,m)),l=m+1;else if(m+2<=o&&k.operaterTypesMap[g+t[m+1]])c=i(a,c,l),a.push(new F(t.slice(m,m+2),5,m,m+1,5)),l=++m+1;else if(k.operaterTypesMap[g])c=i(a,c,l),a.push(new F(g,5,m,m)),l=m+1;else if("("===g)0<c.length?(f=new F(c,1,l,m,1),c=[]):f=new F(g,2,m,m,1),a.push(f),u[++s]=f,l=m+1;else if(")"===g)c=i(a,c,l),l=(s<0?(n&&L(g,m),i(a,g,m)):(v=u[s],s--,v=new F(g,v.uit,m,m,2),a.push(v)),m+1);else if(":"===g)c=i(a,c,l),a.push(new F(g,5,m,m,11)),l=m+1;else if("\r"!==g&&"\n"!==g){if("\\"===g){if(o<=++m){n&&L(g,m);continue}c.push(g),g=t[m]}c.push(g)}return i(a,c,l),a},v.prototype.buildExpressionTree=function(t,n,e){var i,n,i,n,r;return this.tDt(n),i=t.keepUnknownFormulas,t.nDt=!1,n=this.eDt(t,n,e),i&&(0===n.length||rt(n))?h:(i=this.iDt(t,n,e),e&&(i||S(),this.rDt(i,t)),t.nDt&&this.oDt(i,new y.LocalScopes,!1,!1,t,e),!(r=(n=t.source)&&n.G3)&&i&&(i.lMt=!0),i)},v.prototype.rDt=function(t,n){for(var e,i,r,o,a,u,s;10===t.type;)t=t.value;if(e=this,9===t.type)t.value||S(),e.rDt(t.value,n),t.value2?e.rDt(t.value2,n):3<t.operatorType&&S();else if(7===t.type)if(r=(i=t.arguments).length,o=t.function,(0,y.isExpression)(o))this.rDt(o,n);else for(a=!1!==n.Hve,o&&a&&o.aDt(o.minArgs,o.maxArgs,r,i),u=0;u<r;u++)s=i[u],o&&a?o.uDt(s,u):(0,y.sDt)(s,u),e.rDt(s,n);else 8!==t.type||!n.Mf||c.Common.$T.qT("^[A-Za-z_\\@\\\\\xa1\xa4\xa7\xa8\xaa\\u00AD\\u00AF-\\u00BA\\u00BC-\\u00DF\xf7\\u0100-\\uFFFF][A-Za-z0-9_\\.\\@\\\\\\?\\#\xa1\xa4\xa7\xa8\xaa\\u00AD\\u00AF-\\u00BA\\u00BC-\\u00DF\xf7\\u0100-\\uFFFF]*$").test(t.value)||"["===t.value[0]||S()},v.prototype.iDt=function(t,n,e){for(var i,r,o,a,u,s,c,i=this.cDt(t,n,e),u=3;u<i.length;)if(s=i[u],9!==(c=i[u-2]).type&&e&&S(),s&&9===s.type){for(;3<=u&&l[s.value]>=l[c.value];)o=i[u-3],a=i[u-1],r=(0,y.rbt)(c.operatorType,o,a),i.splice(u-3,3,r),3<=(u-=2)&&(c=i[u-2]);u+=2}else u++;if(1===i.length)return i[0];for(u=i.length-2;0<u;u-=2)o=i[u-1],a=i[u+1],9!==i[u].type&&e&&S(),r=(0,y.rbt)(i[u].operatorType,o,a),i.splice(u-1,3,r);return r},v.prototype.fDt=function(t,n,e){var i,r,o,a,u,s,c,f;if(!t||t.length<=0)return t;for(o=[],a=[],u=(i=t)[i.length-1],s=r=0;s<=i.length;s++)c=i[s],s===i.length||e(c)?(r===s?(f=(c||u).ywt,o.push((0,y.xde)(f,f))):o.push(this.iDt(n,a)),r=s+1,a=[]):a.push(c);return o},v.prototype.cDt=function(t,n,e){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,i=[],r=(n=Array.isArray(n)?n:[n]).length,o=0;o<r;o++){if(10===(u=a=n[o]).type){if((s=0<i.length?i[i.length-1]:M)&&7===s.type){c=this.fDt(a.value,t,function(t){return t.value===j}),i[i.length-1]=(0,y.lDt)(s,c,s.lit,a.ywt);continue}a.value=this.iDt(t,a.value),u=a}else 7===a.type&&(a.arguments=this.fDt(a.arguments,t,f=function(t){return 0===t.type&&t.value===j}));i.push(u)}for(n=i,i=[],r=n.length,o=0;o<r;o++){if(9===(u=a=n[o]).type)if(0===a.operatorType||1===a.operatorType)if(o===r-1)e&&S();else{for(l=o;!g(n[l])&&9===n[l].type&&n[l].operatorType<=1;)l++;if(g(n[l])){if(!e)return;S()}for(h=n[l],d=l-1;o<=d;d--)h=u=(0,y.rbt)(n[d].operatorType,h);u=h,o=l}else if(2===a.operatorType){if(0!==o){u=(0,y.rbt)(a.operatorType,i[i.length-1]),i[i.length-1]=u;continue}e&&S()}else if("#"===a.value){if(0!==o){if(n[o+1]&&8===n[o+1].type&&8===i[i.length-1].type){i[i.length-1].value+="#"+n[o+1].value,o++;continue}v=t.getFunction("ANCHORARRAY"),u=(0,y.YJ)(v,[i[i.length-1]],a.lit),i[i.length-1]=u;continue}e&&S()}else if("@"===a.value){if(n[o+1]&&9!==n[o+1].type){v=t.getFunction("@"),u=(0,y.YJ)(v,[n[o+1]],a.lit),!1===(m=t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray)&&(7===n[o+1].type?u=n[o+1]:u.function=M),i[i.length]=u,o++;continue}u.type=8}i.push(u)}return i},v.prototype.eDt=function(t,n,e){for(var i,r,o,i=[],r=0,o=n.length;r<o;)r=this.resolveToken(t,n,i,r,e);return i},v.prototype.addDynamicCell=function(t){var n,e,n=t.source&&t.source.getCalcService&&t.source.getCalcService();n&&(n.tMt||(n.tMt={}),e=t.source.id+","+t.row+","+t.column,n.tMt[e]={id:t.source.id,row:t.row,col:t.column})},v.prototype.resolveToken=function(t,n,e,i,r){for(var o,a,u,s,c,f,s,s,f,s,o=n[i],a=t.getResolvers(),u=0;u<a.length;u++)if(s=a[u].resolveToken(t,this,n,i,r)){f=i-1,(c=s.expr)&&s.index!==M?i=s.index-1:c=s,o.Q9t&&(c.hDt=o.Awt),(s=0<e.length?e[e.length-1]:h)&&et(c)&&(et(s)||"#"===s.value)&&(s=n[f].ywt)<o.lp-1&&(f=(0,y.rbt)(17," "),t.Jde&&ot(f,s+1,o.lp),e.push(f)),(15===c.operatorType||c.function&&c.function.haveDynamicListener)&&this.addDynamicCell(t),t.Jde&&(s=n[Math.min(i,n.length-1)],ot(c,o.lp,s.ywt+1)),e.push(c);break}return i+1},v.prototype.resolveSubTokens=function(t,n,e,i,r){for(var o=[];e<n.length&&2!==n[e].Twt;)if(e=this.resolveToken(t,n,o,e,i),r){e--;break}return{exprs:o,index:e+1}},v.prototype.tDt=function(t){t.forEach(function(t){1===t.uit&&t.Awt!==_&&(t.Awt=t.Awt.toUpperCase())})},v.prototype.dDt=function(t,n,e){9===t.type&&18===t.operatorType&&(t.value=e||this.unparse(n,t),t.type=8,delete t.operatorType)},v.prototype.oDt=function(t,n,e,i,r,o){var a,u,u,s,c,f,l;if(t)if(Array.isArray(t))for(a=0;a<t.length;a++)this.oDt(t[a],n,e,i,r,o);else if(9===t.type&&18===t.operatorType&&(u=this.unparse(r,t),n.hasVariable(u))&&this.dDt(t,r,u),8===t.type)n.hasVariable(t.value)&&(t.type=100,t.vDt=e,t.mDt=i,t.value=n.getVariable(t.value),o||(t.value=t.value.replace(/\./g,"_")));else if(7===t.type){if(u=t.functionName,s=t.function,c=t.arguments,"LET"===u){for(n.enterScope(),f=c.length-1,a=0;a<f;a+=2){if(l=c[a],this.dDt(l,r),8!==l.type)return;this.oDt(c[a+1],n,e,i,r,o),n.setVariable(l.value,l.value),this.oDt(l,n,e,i,r,o)}this.oDt(c[f],n,e,i,r,o),n.exitScope()}else if("LAMBDA"===u){for(n.enterScope(),f=c.length-1,a=0;a<f;a++){if(8!==(l=c[a]).type)return;at(l),n.setVariable(l.value,l.value),this.oDt(l,n,e,i,r,o)}this.oDt(c[f],n,e,i,r,o),n.exitScope()}else for(a=0;a<c.length;a++)e=(0,y.getFunctionAcceptsArray)(s,a),i=(0,y.getFunctionAcceptsReference)(s,a),this.oDt(c[a],n,e,i,r,o);(0,y.isExpression)(s)&&this.oDt(s,n,e,i,r,o),u&&n.hasVariable(u)&&(t.isLocalFunctionName=!0,t.functionName=n.getVariable(u))}else 9===t.type&&(e=i=(0,y.gDt)(t.operatorType)),this.oDt(t.value,n,e,i,r,o),this.oDt(t.value2,n,e,i,r,o)},k.Parser=v,m.prototype.getExternalSource=function(t,n){for(var e,i,r,e,i=this.source.getCalcService().getAllSourceModels(),r=0;r<i.length;r++)if(C.Dbt(i[r].getSource().getName(),n))return i[r].getSource();return h},m.prototype.getExternalSourceToken=function(t){return t.getName()},m.prototype.setSource=function(t){this.source=t},m.prototype.getResolvers=function(){var t=(this.source||this.Mf).getCalcService();return t&&t.getResolvers()},m.prototype.addResolver=function(t){var n=(this.source||this.Mf).getCalcService();n&&n.addResolver(t)},m.prototype.getFunction=function(t){var n,e,i,n=t,e=(0,y.getMapping)()&&(0,y.getMapping)().builtInFunctionsMapping;if(!g(e))for(i in e)e[i].alias===t&&(n=i);return this.source&&this.source.getCustomFunction(n)||y.Functions.findGlobalFunction(t)},i=m,k.ParserContext=i,y.CalcSource.prototype.getParserContext=function(t,n,e){return new i(this,t,n,e)},z={"'":1,"[":1,"]":1,"?":1,"%":1," ":1},Y=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/,Z={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0,",":!0,"`":!0,"+":!0,"~":!0,"\uff01":!0,"":!0,"\u3001":!0,"\uff5d":!0,"\uff5b":!0,"\u3010":!0,"\u3011":!0,"-":!0,"\uff1b":!0,"\uff1a":!0,"\u2018":!0,"\u201c":!0,"\u201d":!0,"\u2019":!0,"\uff0c":!0,"\u3002":!0,"=":!0},k.Cmt=ct,W=/^(R|C|RC)?(0*[1-9]\d*)/,Q=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,k.Mge=ht,n(p,o=t),p.prototype.resolveToken=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,v,g,p,b,w,v,v,v,o=e[i],a=o.Awt,u=o.y4,f=o.uit,l=null,v=o.Twt,m=t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray;if(0===f&&12===v){if(v=void 0,i++,(v=a&&"'"===(v=a).charAt(0)?v.substring(1,v.length-1):v)&&(l=t.getExternalSource("",v)),!(o=e[i]))return(s=new y.Expression(8)).value=a,s;a=o.Awt,f=o.uit}if(0===f)0===o.Twt?T(h=a.toUpperCase())||A(h)?(o.Twt=5,o.Awt=h,(s=new y.Expression(4)).value=T(h)):(s=new y.Expression(8)).value=a:4===o.Twt?((s=new y.Expression(2)).value=parseFloat(a),s.originalValue=a):3===o.Twt?(s=new y.Expression(3)).value=a:5===o.Twt?(s=new y.Expression(4)).value=T(a):6===o.Twt?(s=new y.Expression(5)).value=y.CalcError.parse(a):7===o.Twt&&((s=new y.Expression(8)).value=a);else if(1===f){if(a===_){for(s=new y.Expression(6),i++,h=[[]],p=g=c=0;i<e.length&&2!==e[i].Twt;){if(o=e[i],i<e.length-1&&4===o.uit&&"-"===o.Awt&&4===e[i+1].Twt&&((o=e[++i]).y4.unshift("-"),o.Awt="-"+o.Awt),3===o.uit){if(o.Awt===O){if(g!==p)throw C.I5((0,y.sR)().Exp_InvalidArrayColumns,[o.lp]);h.push([]),c++,p=0}}else{if(0!==o.uit||4!==o.Twt&&3!==o.Twt&&5!==o.Twt&&6!==o.Twt)throw(0,y.sR)().Exp_InvalidArray;w=b=o.Awt,4===o.Twt?w=parseFloat(b):5===o.Twt?w="TRUE"===b.toUpperCase():6===o.Twt&&(w=y.CalcError.parse(b)),h[c].push(w),0===c&&g++,p++}i++}if(g!==p)throw C.I5((0,y.sR)().Exp_InvalidArrayColumns,[o.lp]);return i++,s.value=new y.CalcArray(h),{expr:s,index:i}}if(0<u.length)return"SINGLE"===a&&(v=t.source)&&v.G3&&(a="@"),"LET"!==((s=new y.Expression(7)).functionName=a)&&"LAMBDA"!==a||(t.nDt=!0),v=t.getFunction(s.functionName)||y.Functions.findGlobalFunction(s.functionName),!1===m&&v&&!0===v.isDynamicArrayFunction&&(v=M),s.function=v,l&&(s.source=l),(d=n.resolveSubTokens(t,e,i+1,void 0,"@"===u[0]&&m))?(s.arguments=d.exprs,{expr:s,index:d.index}):(s.arguments=[],s)}else if(4===f)s=(0,y.rbt)(k.preOperaterTypesMap[a],a);else if(6===f||5===f)v=k.operaterTypesMap[a],s=(0,y.rbt)(v="."===a?18:v,a);else if(2===f){if(s=new y.Expression(10),d=n.resolveSubTokens(t,e,i+1))return s.value=d.exprs,{expr:s,index:d.index};r&&S()}else 3===f&&((s=new y.Expression(0)).value=a);return l&&s&&(s.source=l,s={expr:s,index:i+1}),s},p.prototype.unparse=function(t,n,e,i){var r,o,a,u,u,u,r=this;if(6===e.type||4===e.type||2===e.type||5===e.type||3===e.type)r.pDt(t,e,i);else if(9===e.type)r.bDt(t,n,e,i);else if(10===e.type)i.push("("),n.q9t(t,e.value,i),i.push(")");else if(7===e.type)e.source&&!(o=this.unparseSource(t,i,e.source,e.endSource))&&i.push("#","R","E","F","!"),"ANCHORARRAY"!==(a=(0,y.isFunction)(e.function)&&e.function.name||e.functionName)||t.lyt?"@"!==a||t.lyt?(!e.functionName&&(0,y.isExpression)(e.function)?r.unparse(t,n,e.function,i):("@"===(a=e.isLocalFunctionName&&t.lyt?y.XLPMPrefix+a:a)&&(a="SINGLE"),G(i,(a=(u=(u=(0,y.getMapping)()&&(0,y.getMapping)().builtInFunctionsMapping)&&u[a])&&u.alias?u.alias:a).split(""))),i.push("("),r.unparseArguments(t,n,e,i),i.push(")")):(t.Nme||i.push("@"),n.q9t(t,e.arguments[0],i)):(n.q9t(t,e.arguments[0],i),i.push("#"));else{if(1===e.type||8===e.type)return r.unparseRefenceExpressions(t,n,e,i),!0;if(100!==e.type)return!1;u=e.value,G(i,(u=t.lyt?(e.Bve?y.XLOPPrefix:y.XLPMPrefix)+u:e.Bve?s+u+f:u).split(""))}return!0},p.prototype.unparseArguments=function(t,n,e,i){for(var r=0;r<e.arguments.length;r++)0!==r&&i.push(j),n.q9t(t,e.arguments[r],i)},p.prototype.unparseSource=function(t,n,e,i){if(t.getExternalSourceToken){if(e){var e=ht(t,t.getExternalSourceToken(e).split(""),i&&t.getExternalSourceToken(i).split(""));if(!(0<e.length))return!1;R.apply(n,e)}return n.push("!"),!0}return!1},p.prototype.unparseRefenceExpressions=function(t,n,e,i){var r;if(e.source&&!this.unparseSource(t,i,e.source,e.endSource))return void i.push("#","R","E","F","!");8===e.type&&i.push(e.value)},p.prototype.bDt=function(t,n,e,i){var r=e.operatorType;2===r?(n.q9t(t,e.value,i),i.push("%")):0===r||1===r?(i.push(k.Z9t[r]),n.q9t(t,e.value,i)):18===r?(n.q9t(t,e.value,i),i.push(k.Z9t[r]),e.value2&&e.value2.yDt?i.push(e.value2.value):n.q9t(t,e.value2,i)):(n.q9t(t,e.value,i),i.push(k.Z9t[r]),n.q9t(t,e.value2,i))},p.prototype.pDt=function(t,n,e){var i,r,o,a,u,s,c,f,l,i=(0,y.sR)().Exp_InvalidArray;if(3===n.type)e.push('"'),e.push(C.Vi(n.value,'"','""')),e.push('"');else if(2===n.type)r=n.originalValue||n.value.toString(),"."!==D&&(r=r.replace(".",D)),e.push(r);else if(4===n.type)e.push(n.value?(0,y.getBoolean)().boolean_true:(0,y.getBoolean)().boolean_false);else if(6===n.type){if(e.push("{"),(o=n.value).getRowCount()<=0)throw i;for(a=0,u=o.getRowCount();a<u;a++)for(1<=a&&e.push(O),s=0,c=o.getColumnCount();s<c;s++){if(0!==s&&e.push(E),(f=o.getValue(a,s))===M||f===h)throw i;(l=typeof f)==d?(e.push('"'),e.push(C.Vi(f,'"','""')),e.push('"')):l==w?e.push(f?(0,y.getBoolean)().boolean_true:(0,y.getBoolean)().boolean_false):"number"==l&&"."!==D?e.push(f.toString().replace(".",D)):e.push(f.toString())}e.push("}")}else 5===n.type?e.push(n.value.toString()):n.type},k.DefaultTokenResolver=p},"./src/calc.common.ts":function(_,D,t){var L,B,y,n,P,G,M,U,C,H,V,z,Y,Z,W,Q,J,K,X,q,$,tt,nt,et,it,j,a,O,S,rt,ot,T,d,at,E,t,ut,st,ct,A,g,s,ft,lt,ht,dt,vt,e,mt,v,u,R,gt,I,pt,bt,wt,yt,Mt,Ct,St,F,Tt,c,At,t,It,xt,Nt,kt,_t,Dt,jt,Ot,n,m,Et,Rt,Ft,Lt,Bt,Pt,Gt,Ut,x,Ht,Vt,zt,Yt,Zt,Wt,Qt,Jt,Kt,Xt,e,qt,$t,tn;function nn(t){return t&&t.toUpperCase()}function en(t){var n,e;if(t){if(7===t.type&&("SUBTOTAL"===t.functionName||"AGGREGATE"===t.functionName))return!0;for(n=t.arguments&&t.arguments.length,e=0;e<n;e++)if(en(t.arguments[e]))return!0;if(en(t.value)||en(t.value2))return!0}return!1}function rn(t,n){var e,t,e=t&&t.getCustomNameInfo&&t.getCustomNameInfo(n);return e=!e&&t?(t=t.op().getGlobalSourceModel())&&t.getSource().getCustomNameInfo(n):e}function on(t){return 15===t||16===t||17===t}function an(t){return t=-1<(t=-1<t.indexOf(D.XLPMPrefix)?t.replace(/_xlpm\./g,""):t).indexOf(D.XLOPPrefix)?t.replace(/_xlop\.([a-zA-Z0-9_]+)/g,"[$1]"):t}function un(t){var t=String(t&&t.message),t;return"maximum call stack size exceeded"===(t=t.toLowerCase())||"too much recursion"===t||"out of stack space"===t}function i(t,n){if(j(n)){var e=i.CDt(t);if(!e)throw(0,D.sR)().Exp_NotSupported;this._error=e.error,this._code=e.code}else this._error=t,this._code=n}function sn(t){return isNaN(t)||!isFinite(t)}function p(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w;if(!t)return!(n.value=0);i=typeof t;try{if(i===M)e=t;else if(i===U){if(/[\f\n\r\t\v]/.test(t))return!1;if(0===(t=(r=t).trim()).length)return!(n.value=0);if(a=(o=y.Common.CultureManager.Fe().NumberFormat).numberDecimalSeparator,u=o.numberGroupSeparator,"."!==a&&"."!==u&&0<=t.indexOf(".")||","!==a&&","!==u&&0<=t.indexOf(","))return!1;if(c=s=!1,f=t[0],l=t[t.length-1],"("===t[0]&&")"===l){if(c=!0,"+"===(f=(t=t.substring(1,t.length-1).trim())[0])||"-"===f)return!1;l=t[t.length-1]}if("%"===f?(s=!0,t=t.substring(1)):"%"===l?(s=!0,t=t.substring(0,t.length-1)):"$"===f&&(t=t.substring(1)),""===t)return!1;if(0<=t.indexOf(u)&&(h=S.qT("^\\ *[\\+|\\-]?\\ *\\d+(\\"+u+"\\d{3,})+(\\"+a+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$"),d=S.qT("^0+\\"+u),h.test(t))&&!d.test(t)&&(t=t.replace(S.qT("[ \\"+u+"]"),"")),(v=S.qT("^\\d+(\\-\\d+)+$")).test(t)&&!(m=S.qT("^(((0?[1-9]|10|11|12)-(\\d{1,2}|[2-9]\\d{3}|19\\d{2}))|((0?[1-9]|10|11|12)-((0|1|2)?[\\d]|30|31)-(\\d{1,2}|[2-9]\\d{3}|19\\d{2}))|(([2-9]\\d{3}|19\\d{2})-(0?[1-9]|10|11|12)-((0|1|2)?[\\d]|30|31)))$")).test(t))return!1;if(" "===(t=t.trim())[1]&&("+"===t[0]?t=t.replace(/^\+ +/,"+"):"-"===t[0]&&(t=t.replace(/^\- +/,"-"))),(t="."!==a?t.replace(a,"."):t).indexOf(a)!==t.lastIndexOf(a))return!1;if(2<=t.length&&"0"===t[0]&&"x"===t[1])return!1;if(e=Number(t).valueOf(),s&&(e/=100),sn(e=c?-e:e)){if(!(97<=(g=(t=r.trim()).charCodeAt(0))&&g<=122||48<=g&&g<=57||65<=g&&g<=90))return!1;if(g|=32,4<t.length&&97<=g&&g<=122&&(p=(p=t[0]+t[1]+t[2]).toUpperCase(),!yt[p]))return!1;if(f=t[0],l=t[t.length-1],"/"===f||"-"===f||":"===f||"/"===l||"-"===l)return!1;if((h=S.qT("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,\\z\\Z]")).test(t))return!1;if((h=S.qT("(^[a-zA-Z]{1,2}(\\/|\\s|\\-))|(^\\d+\\s+\\d+$)")).test(t))return!1;if((w=(b=y.Common.CultureManager.getCultureInfo())&&b.DateTimeFormat&&b.DateTimeFormat.shortDatePattern)&&w.indexOf("d")<w.indexOf("M")?e=y.Common.ct.yU(t):sn((e=new Date(t+" 00:00:00")).valueOf())&&(e=new Date(t)),sn(e.valueOf()))return!1;e=T.o0(e)}}else if(i===C)e=t?1:0;else{if(!(t instanceof Date))return!1;e=T.o0(t)}}catch(t){return!1}return n.value=e,!0}function cn(t){var n={value:0};if(p(t,n))return n.value;throw(0,D.sR)().Exp_InvalidCast}function fn(t,n){return n&&(t===A||t===g||typeof t===U&&""===t.trim())}function ln(t,n){try{if(t){if(typeof t!==C)if(t instanceof Date)t=0!==T.o0(t);else{if(!mn(t))return!1;t=0!==t}}else t=!1}catch(t){return!1}return n.value=t,!0}function hn(t,n,e,i,r){var o,a,u;if(!b(t)){if(o={value:A},a=mt,0!==n&&fn(t,i))return a;switch(n){case 1:case 5:if(e&&5!==n){if(typeof t===C&&r)return a;t=p(t,o)?o.value:a}else typeof t!==M&&(t=t instanceof Date?T.o0(t):a);break;case 11:t=p(t,o)?o.value:a;break;case 4:typeof t===U?t=(u=y.Common.ct.yU(t))!==g&&u!==A?T.o0(u):a:e?t=p(t,o)?o.value:a:typeof t===M||t instanceof Date||(t=a);break;case 3:e?t=p(t,o)?o.value:a:typeof t!==C&&(t=a);break;case 2:t=t===A||t===g?"":t.toString()}}return t}function dn(t,n){this.array=t,this.referenceInTwoDimension=n}function vn(){return null!==Ot&&Ot.apply(this,arguments)||this}function mn(t,n){var e=typeof t;return e===M||e===z&&t instanceof Date||!n&&(e===C||!isNaN(t)&&!isNaN(parseFloat(t))&&!et.Nh(t))}function b(t){return t instanceof v}function gn(t){return t instanceof Mt}function pn(t){return t instanceof At}function w(){}function bn(t){this.type=t}function f(t,n){var e=this;e.rT=t,n?(e.$gt=n,e.SDt=n.length):e.SDt=1}function r(t){this.id=r.sourceId,r.sourceId++,this.Lbt=t,this.Mbt=null}function wn(t,n,e){var i=new c(5);return n&&(i.source=n),e&&(i.endSource=e),i.value=t,i}function yn(t,n,e,i){var r=new c(7);return r.arguments=n,t instanceof c?(r.function=t.function,r.functionName=t.functionName,r.source=t.source,(e=e===g?t.lit:e)===g&&(i=t.ywt)):(r.function=t.name&&t,r.functionName=t.name||t),kn(r,e,i=n&&0<n.length&&i===g?n[n.length-1].ywt:i),r}function Mn(t,n,e,i){var r=new c(7);return r.arguments=n,r.function=t,kn(r,e,i),r}function Cn(t,n){var e=new c(12);return e.value=t,e.needExpendIndexs=n,e}function Sn(t,n,e,i,r){var o=new c(9);return o.operatorType=t,o.value=n,18===t&&e&&e.hDt&&((e=In(e.hDt,e.lit,e.ywt)).yDt=!0),o.value2=e,i===g&&_e(n)&&(i=n.lit),r===g&&(_e(e)?r=e.ywt:_e(n)&&(r=n.ywt)),kn(o,i,r),o}function Tn(t){var n=new c(10);return n.value=t,n}function An(t,n){var e=new c(11);return kn(e,t,n),e}function In(t,n,e){var i=new c(3);return i.value=t,kn(i,n,e),i}function xn(t){var n=new c(2);return n.value=t,n}function Nn(t){var n=new c(4);return n.value=t,n}function kn(t,n,e){n!==g&&(t.lit=n),e!==g&&(t.ywt=e)}function _n(){}function h(t,n){return t.charAt(n)}function Dn(t,n){for(var e=t.length,i=!1;n<e&&!isNaN(+h(t,n));)n++,i=!0;for(n<e&&"."===h(t,n)&&n++;n<e&&!isNaN(+h(t,n));)n++,i=!0;if(n<e&&("E"===h(t,n)||"e"===h(t,n)))for(i=!1,++n<e&&("+"===h(t,n)||"-"===h(t,n))&&n++;n<e&&!isNaN(+h(t,n));)n++,i=!0;return{TDt:i,lp:n}}function jn(t){return"string"==typeof t}function On(t){this.ADt=t}function En(t,n){if(!t||8===t.type&&0<=t.value.indexOf("'"))throw(0,D.sR)().Exp_FormulaInvalid}function o(){this.context=[{}],this.closure={},this.backupClosure=[]}function l(t,n,e,i){void 0===n&&(n=0),void 0===e&&(e=0),this.name=t,this.minArgs=n,this.maxArgs=e;var t=this;t.IDt=i,t.typeName=""}function Rn(t,n,e,i){return qt.call(this,t,n,e,i)||this}function Fn(t,n){for(var e,t,i,t,r,o,e=$t.call(this,"LAMBDA")||this,t=t.arguments,i=t.slice(0,t.length-1),t=t[t.length-1],r=i.length,o=0;o<i.length;o++)if(i[o].Bve){r=o;break}return e.minArgs=r,e.maxArgs=i.length,e.parameters=i,e.calculation=t,e.closure=n,e}function Ln(t,n){return n.name=nn(n.name),m.Tmt[nn(t)]=n}function Bn(t){var n,e,i;return t?(t=nn(t),n=m.Mmt,e=m.Tmt,i=(0,D.getMapping)()&&(0,D.getMapping)().builtInFunctionsMapping,n&&(Hn(i,t)||n[t])||e&&e[t]):Un()}function Pn(){return Un()}function Gn(t){var n,e;t?(t=nn(t),n=m.Mmt,e=m.Tmt,n[t]?delete n[t]:e[t]&&delete e[t]):(m.Mmt={},m.Tmt={})}function Un(){var t,n,e,i,r,t=m.Mmt,n=m.Tmt,e=[];for(i in t)e.push(t[i]);for(r in n)e.push(n[r]);return e}function Hn(t,n){var e,i,e=m.Mmt;if(!j(t))for(i in t)if(t[i].alias===n)return e[i];return g}function Vn(t,n,e){this.okt=t,this.akt=n,this.mit=e||"i"}function zn(t){function n(t){var n,e,i,r,o,a,u,s,c,f,l,n=0,e=0,i=!1,u=0,s=0,c=0,f=t.length;if(!t)throw(0,D.sR)().Exp_ArgumentNull;if(0===f)throw Bt;if(c<f&&("+"===h(t,c)||"-"===h(t,c))&&c++,c=(l=Dn(t,c)).lp,r=l.TDt,c<f&&("+"===h(t,c)||"-"===h(t,c))?(u=c,c=(l=Dn(t,++c)).lp,o=l.TDt,c<f&&("i"===h(t,c)||"j"===h(t,c))&&(a=h(t,c),c++,i=!0),s=c-u):c<f&&("i"===h(t,c)||"j"===h(t,c))?(a=h(t,c),s=++c,o=r,r=!(i=!0)):u=c,c<f)throw Bt;if(0<u){if(!r)throw Bt;n=parseInt(t.substr(0,u),10)}if(0<s){if(!i)throw Bt;if(1===s||2===s&&"+"===h(t,u))e=1;else if(2===s&&"-"===h(t,u))e=-1;else{if(!o)throw Bt;e=parseInt(t.substr(u,s-1),10)}}return new Pt(n,e,a)}try{return t?"number"==typeof t?new Pt(t,0):"string"==typeof t?n(t):null:new Pt(0,0)}catch(t){return null}}function Yn(t,n,r){var i,o,e;if(j(t))throw(0,D.sR)().Exp_InvalidFunctionName;if(t=t.toUpperCase(),m.Mmt[t])throw(0,D.sR)().Exp_InvalidOverrideFunction;if(i=m.Mmt[t]){if(!r||!r.override)throw(0,D.sR)().Exp_OverrideNotAllowed}else m.Mmt[t]=i=new Rt(t,0,255);return n&&"function"==typeof n&&(i.evaluate=n),"function"==typeof r.argsValidator&&(o=i.aDt,i.aDt=function(t,n,e,i){o(t,n,e,i),r.argsValidator(t,n,e,i)}),"function"==typeof r.subExpressionValidator&&(e=i.uDt,i.uDt=function(t,n){e(t,n),r.subExpressionValidator(t,n)}),et.y0(r,function(t,n){var e;0<=a(t,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])?(e=new xt(n),i[t]=function(t){return e.xDt(t)}):0<=a(t,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])?(e=new xt(n),i[t]=function(){return e.NDt()}):r.hasOwnProperty(t)&&(i[t]=n)}),i}function Zn(t,n,e,i,r,o,a,u,s){return u=u||{},e!==g&&(u.minArgs=e),i!==g&&(u.maxArgs=i),o!==g&&(u.acceptsReference=o),a!==g&&(u.acceptsArray=a),r!==g&&(u.R9t=r),u.wkt!==g&&(u.acceptsMissingArgument=u.wkt),u.V9t!==g&&(u.isVolatile=u.V9t),u.r9t!==g&&(u.isContextSensitive=u.r9t),u.a9t!==g&&(u.haveDynamicListener=u.a9t),u.e9t!==g&&(u.skipPrecedent=u.e9t),u.o9t!==g&&(u.arrayArgumentEvaluateMode=u.o9t),u.f9t!==g&&(u.acceptsError=u.f9t),s!==g&&(u.isDynamicArrayFunction=s),Yn(t,n,u)}function Wn(t){return"boolean"==typeof t}function Qn(t){return"number"==typeof t}function Jn(t){return t%400==0||t%4==0&&t%100!=0||1900===t}function Kn(t,n){switch(n){case 0:case 2:case 4:return 360;case 1:return Zt(t.getFullYear())?366:365;case 3:return 365;default:return-1}}function Xn(t,n){return t-n}function qn(t,n){return 0<=a(n,[0,2,4,6,7,9,11])?31:0<=a(n,[3,5,8,10])?30:1===n?Zt(t)?29:28:void 0}function $n(t,n,e,i){var r,o,e,a,u,i,t,s,r=e.getFullYear(),o=e.getMonth(),e=e.getDate(),a=i.getFullYear(),u=i.getMonth(),i=i.getDate();return t?(t=1===o&&Wt(r,o)===e,s=1===u&&Wt(a,u)===i,n?(t&&(e=30),s&&(i=30)):(t&&s&&(i=30),t&&(e=30)),31===i&&30<=e&&(i=30)):31===i&&(n?(i=1,u++):i=30),360*(a-r)+30*(u-o)+i-(e=31===e?30:e)}function te(t,n,e){var i,r,o,i=1;return 0<t-n&&(o=t,t=n,n=o,i=-1),r=0<=a(e,[1,2,3])?i*Ut(d(n)-d(t)):0<=a(e,[4,5])?i*$n(!1,5===e,t,n):i*$n(!0,6===e,t,n)}function ne(t){var n,n,e,n=0===t?0:3<=(e=.5*s(t))?1:e<1?((((((((.000124818987*(n=e*e)-.001075204047)*n+.005198775019)*n-.019198292004)*n+.059054035642)*n-.151968751364)*n+.319152932694)*n-.5319230073)*n+.797884560593)*e*2:(((((((((((((-45255659e-12*(e-=2)+.00015252929)*e-19538132e-12)*e-.000676904986)*e+.001390604284)*e-.00079462082)*e-.002034254874)*e+.006549791214)*e-.010557625006)*e+.011630447319)*e-.009279453341)*e+.005353579108)*e-.002141268741)*e+.000535310849)*e+.999936657524;return 0<t?.5*(n+1):.5*(1-n)}function ee(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,o=e<100,a=2===e||102===e,u=a||3===e||103===e,s=5===e||105===e,c=4===e||104===e||s,f=9===e||109===e,l=1===e||101===e||f||i,h=6===e||106===e,d=h?1:0,v=!1,m=0,A=!1,g=0;g<O(t);g++){if(I=t[g],x=void 0,u){if(!a&&!(I instanceof Ct)&&I instanceof Mt){d+=I.getColumnCount()*I.getRowCount();continue}x=Vt(I,0,!1,!1,!1,a)}else N=1,D.ExcelCompatibleCalcMode&&!gn(I)&&!pn(I)||(N=5),x=Vt(I,N,!1,!1,!1,!0);if(x.isError)return x[0];if(x.isConvertError)return R;for(k=x.rangeCount,_=x.isReference,p=0;p<k;p++)for(b=1<k?x[p]:x,_&&(w=I.getRow(p),y=I.getColumn(p)),M=0;M<O(b);M++)if(2===n||!_||!I.isHiddenRow(p,M,o))for(S=b[M],C=0;C<O(S);C++)if(!(1!==n&&2!==n&&_&&I.isSubtotal(p,M+w,C+y)||null===(T=S[C])||T===mt)){if(T&&T._error&&!u)return r&&(r.sumx=0,r.sumx2=0,r.n=0),T;u&&!j(T)&&(!a||""!==T&&F.q8(T,!0))?d++:c&&(!v||s&&T<d||!s&&d<T)?d=T:l?i?(r.sumx=E.tge(r.sumx,T),r.sumx2+=T*T,r.n++,r.values.push(T),r.values[0]!==T&&(r.allSame=!1)):(d=E.tge(d,T),m++):h&&(d*=T,m++),v=!0}}return l?f?d:i?void 0:0===m?pt:zt(d/m):h?zt(0<m?d:0):d}function ie(t,n,e){var i,r,i,o,a,u,s,i=e%100,r=7==i||8==i,i=7==i||10==i?1:0,o={sumx:0,sumx2:0,n:0,values:[],allSame:!1},a=ee(t,n,e,!0,o);if(a&&a._error)return a;if(o.n<=i)return pt;if(o.allSame)a=0;else if(E.ukt(o.n*o.sumx2,o.sumx*o.sumx))for(u=o.sumx/o.n,s=a=0;s<o.n;s++)a+=ht(o.values[s]-u,2);else a=o.sumx2-o.sumx*o.sumx/o.n;return a/=o.n-i,zt(r?Math.sqrt(a):a)}function re(t,n,d,a){var v,m,g,p,b,n,e,i,r,o,u,s,c,f,l,h,f,w,y,M;if(null===d)return R;if((d=parseInt(d,10))<=0||19<d)return R;function C(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=[],e=Vt(t,b?0:5,!1,!1,!1,!1);if(e.isConvertError)return R;for(l=e.rangeCount,h=e.isReference,i=0;i<l;i++)for(r=1<l?e[i]:e,h&&(o=t.getRow(i),a=t.getColumn(i)),u=0;u<O(r);u++)if(!(h&&t.isHiddenRow(i,u,!1)&&v))for(c=r[u],s=0;s<O(c);s++)if(!(h&&m&&t.isSubtotal(i,u+o,s+a)||null===(f=c[s])||g&&Yt(f)||Yt(f)&&p)){if(!g&&Yt(f)&&3!==d)return f;typeof f===z&&0===Object.keys(f).length||n.push(f)}return n}function S(t){var n,e,i,r,o,n=t.getRow(0),e=t.getColumn(0),i=t.getRowCount(0),r=t.getColumnCount(0);if(1===i&&1===r)o=t.getValue(0,0,0);else if(1!==i&&1===r&&n<=a.row&&a.row<n+i)o=t.getValue(0,a.row-n,0);else{if(!(1===i&&1!==r&&e<=a.column&&a.column<e+r))return R;o=t.getValue(0,0,a.column-e)}return o===A||""===o?I:isNaN(parseInt(o,10))?R:parseFloat(o)}if(v=1===(n=n||0)||3===n||5===n||7===n,m=1===n||2===n||3===n||0===n,g=2===n||3===n||6===n||7===n,b=(p=2===d)||3===d,n=12===d,e=13===d,f=(i=14===d)||(r=15===d)||(o=16===d)||(u=17===d)||(s=18===d)||(c=19===d),l=[],h=O(t),f){if(2!==h)return R;if((l=C(t[0]))._error)return l;if(f=void 0,t[1]===A)return I;if(t[1]instanceof At)f=S(t[1]);else if(t[1]instanceof Mt)f=t[1].array[0][0];else{if(isNaN(parseInt(t[1],10)))return R;f=x(t[1])}return f._error?f:ye([l,f=17!==d&&19!==d?f:Ut(f)],d)}for(w=0;w<h;w++)if(!(t[w]instanceof At))return R;for(w=0;w<h;w++){if(!((y=C(t[w]))instanceof Array))return y;l.push.apply(l,y)}return n||e?ye([l],d):7===d||8===d||10===d||11===d?ie(l,M=m?1:0,d):ee(l,1,d)}function oe(t){var t=t.charCodeAt(0);return 0<=t&&t<129||63728===t||65377<=t&&t<65440||63729<=t&&t<63732?"singleByte":55296<=t&&t<=57343?"fourByte":"doubleByte"}function ae(t){for(var n,e,n=[],e=0;e<t.length;e++)j(t[e])?(n[e]=t[e+1],e++):n[e]=t[e];return n.length===t.length-1&&(n[n.length]=g),n}function ue(t){for(var n,e,i,r,o,a,u,n=[],i=0,o=0,r=0;r<t.length;r++){if(e=t[r],"doubleByte"===(a=oe(t[r]))||"fourByte"===a)if("fourByte"===a){if(i%2==0){i++;continue}o++,i++,e=t[r-1]+t[r]}else o++,e=t[r];n[r-(u=0<i?i/2:0)+o]=e}return ae(n)}function se(t,n){var e,i;for(void 0===n&&(n=!0),e=[],i=0;i<O(t);i++)fe(t[i],e,n);return e}function ce(t){t.sort(function(t,n){return t-n})}function fe(t,n,e){var i,r;for(void 0===e&&(e=!0),i=0;i<O(t);i++)(r=t[i])!==mt&&n.push(r);e&&ce(n)}function le(t){for(var n,e,t,i,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t=se(t),0===(i=O(t))?I:i%2==0?(x(t[i/2-1])+x(t[i/2]))/2:t[rt((i/2).toString())]}function he(t){for(var n,e,i,r,o,a,u,s,c,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(i=A,r=0,o=se(t,!1),a=O(o),u=0;u<a;u++){for(s=c=0;s<a;s++)s!==u&&o[s]===o[u]&&c++;r<c&&(r=c,i=o[u])}return 0===r?bt:i}function de(t,n){return me(!0,t,n)}function ve(t,n){return me(!1,t,n)}function me(t,n,e){var i,n,i=[];return fe(n,i),n=O(i),e<1||n<e?I:(e=(t?vt:dt)(e),t?i[n-e]:i[e-1])}function ge(t,n){var t,n,e;return t=Vt(t,1,!0,!0,!1,!0),n=x(n),t.isError?t[0]:t.isConvertError||ot(n)?R:(fe(t,t=[]),!O(t)||n<0||1<n?I:(e=(n=n*(O(t)-1))%1,n=rt(n.toString()),0==e?t[n]:x(t[n])+e*(x(t[n+1])-x(t[n]))))}function pe(t,n){var n=a(n,[0,1,2,3,4]);return n<0?I:ge(t,.25*n)}function be(t,n){for(var e,i,r,o,n,a,o,n,e=O(t),i=[],r=0;r<e;r++)Ht(t[r],!0)&&i.push(t[r]);return!i.length||(o=i.length,ce(i),a=(n=n*(o+1)-1)%1,n<0)||o-1<n?I:(n=i[o=dt(n)],0==a?n:n+a*(i[o+1]-n))}function we(t,n){var n=a(n,[1,2,3]);return n<0?I:be(t,.25*(n+1))}function ye(t,n){var e,i,r,o,a,u,s,c,e,i=13===n,r=14===n,o=15===n,a=16===n,u=17===n,s=18===n,c=19===n;return 12===n?le(t):i?he(t):r?de(t[0],t[1]):o?ve(t[0],t[1]):a?ge(t[0],t[1]):u?pe(t[0],t[1]):s?be(t[0],t[1]):c?we(t[0],t[1]):wt}function Me(t){for(var n=1,e,e=t;1<e;e--)n*=e;return n}function Ce(t,n,e){var i=t.getDate(),r=n.getDate(),o=t.getMonth(),a=n.getMonth(),t=t.getFullYear(),n=n.getFullYear(),i=31===i?30:i;return e?r=31===r?30:r:31===r&&(i<30?(r=1,12<++a&&(a=1,n++)):r=30),30*(12*(n-t)+a-o)+r-i}function Se(t,n,e){var i,r,o,o,i,a,u,s,c,f,i=te(t,n,e);return i<0&&(i=-i,o=t,t=n,n=o),i/(r=1===e?(o=t.getFullYear(),i=n.getFullYear(),c=s=u=a=void 0,(a=new Date(t.valueOf())).setFullYear(a.getFullYear()+1),s=0<n-a?(c=i+1-o,a=new Date(o,0,1),u=new Date(i+1,0,1),Ut(d(u)-d(a))-365*(i+1-o)):(c=1,Zt(o)&&t.getMonth()<nt||Zt(i)&&256*n.getMonth()+n.getDate()>=256*tt+29?1:0),365+(f=x(s)/x(c))):Kn(new Date,e))}function Te(t,n,e){return e<0||4<e?I:Se(t,n,e)}function Ae(t,n,e,i){var r,o,a;if(this.criteria=t,"function"==typeof n&&(r=n,n=null),e&&(e.Zbt=!0),n=n||Vt(e,0,2,!1,!1),r){for(o=[],a=0;a<O(n);a++)o[a]=r(n[a]);n=o}(this.array=n).DDt&&t!==A&&"function"!=typeof t&&(this.useMap=!0),"function"!=typeof t&&(this.A9t=this.Pde)}function N(){this.referenceCache=(0,G.createMap)()}function k(){}function Ie(n,e,i){var r,t;try{r=(t=y.Common.CultureManager.getCultureInfo()).localeCompare?i?t.localeCompare(n,e):t.localeCompare(n.toLowerCase(),e.toLowerCase()):i?_t(n,e):_t(n.toLowerCase(),e.toLowerCase())}catch(t){r=i?_t(n,e):_t(n.toLowerCase(),e.toLowerCase())}return r}function xe(t,n,e){var i,r,o,a,u,o,r,r,s,o;if(void 0===e&&(e=!0),b(t))return t;if(b(n))return n;if(o=typeof n===C,(r=typeof t===C)||o)i=r&&o?t===n?0:n<t?1:-1:r?1:-1;else{if(u=typeof n===U,r=(o=(a=typeof t===U)||u)?"":0,t=t===A||t===g?r:t,n=n===A||n===g?r:n,r=function(){return t===n?0:a&&u?Ie(t,n,e):a?1:u?-1:(t=E.E8(t,15),n=E.E8(n,15),t-n)},!o){if(o={value:0},!p(t,s={value:0})||!p(n,o))return R;t=s.value,n=o.value}i=r()}return i}function Ne(t){return t instanceof kt.Function}function ke(t){return t instanceof kt.LambdaFunction}function _e(t){return t instanceof c}function De(t,n){return!Ne(t)||t.acceptsArray(n)}function je(t,n){return!Ne(t)||t.acceptsReference(n)}function Oe(t){return t&&t.arrayArgumentEvaluateMode}function Ee(t){var n=tn.call(this,A)||this;return n.oyt=t,n}function Re(t,n){return{row:t,col:n}}L=this&&this.__extends||(jt=function(t,n){return(jt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}jt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),B=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(D,"__esModule",{value:!0}),D.ErrorSource=D.getFunctionArrayArgumentEvaluateMode=D.getFunctionAcceptsReference=D.getFunctionAcceptsArray=D.isExpression=D.isLambdaFunction=D.isFunction=D.$kt=D.Wkt=D.LocalScopes=D.sDt=D.charAtFunc=D.skt=D.addStartEndIndexToExpression=D.createBooleanExpression=D.createNumberExpression=D.createStringExpression=D.xde=D.Ayt=D.rbt=D.createExpandExpression=D.lDt=D.YJ=D.kyt=D.Syt=D.CalcSource=D.CalcReference=D.Expression=D.ExpressionType=D.Convert=D.TwoDimensionalCalcArray=D.CalcArray=D.CalcError=D.usedbcs=D.getErrorList=D.getBoolean=D.getMapping=D.sR=D.isStackOverflowError=D.Fve=D.gDt=D.W9t=D.MAX_COLUMN_COUNT=D.MAX_ROW_COUNT=D.BAND_INDEX_CONST=D.XLOPPrefix=D.XLPMPrefix=D.ErrorCodeList=D.SR=D.ExcelCompatibleCalcMode=void 0,D._9t=D.missingArgument=D.Errors=D.Functions=void 0,y=t("Common"),n=t("./src/calcEngine.res.en.ts"),P=t("./src/text_Filter/text_Filter.ts"),Object.defineProperty(D,"_9t",{enumerable:!0,get:function(){return P._9t}}),G=t("./src/map.ts"),D.ExcelCompatibleCalcMode=!1,D.SR={en:n.resource},D.ErrorCodeList=[0,7,15,23,29,42,36,99,100],D.XLPMPrefix="_xlpm.",D.XLOPPrefix="_xlop.",M="number",U="string",C="boolean",H="TRUE",V="FALSE",z="object",Y="#NULL!",Z="#DIV/0!",W="#VALUE!",Q="#REF!",J="#NAME?",K="#N/A",X="#NUM!",q="#SPILL!",$="#CALC!",tt=1,nt=2,D.BAND_INDEX_CONST=-2147483648,D.MAX_ROW_COUNT=1048576,D.MAX_COLUMN_COUNT=16384,et=y.Common.lt,it=et.Nh,j=et.ht,a=et.Rh,O=y.Common.Uf.tR,S=y.Common.$T,rt=parseInt,ot=isNaN,T=y.Common.ct,d=T.o0,at=y.Common.zf,E=y.Common.st,D.W9t=rn,D.gDt=on,D.Fve=an,D.isStackOverflowError=un,t=new y.Common.ResourceManager(D.SR,"CalcEngine"),D.sR=t.getResource.bind(t),D.getMapping=ut=function(){return kt&&kt.resourceMapping},D.getBoolean=st=function(){var t=(0,D.getMapping)()&&(0,D.getMapping)().booleanMapping;return{boolean_true:t&&t.boolean_true||H,boolean_false:t&&t.boolean_false||V}},D.getErrorList=ct=function(){var e,i,t,e=[],i=(0,D.getMapping)()&&(0,D.getMapping)().clacErrorMapping,t;return[Y,Z,W,Q,J,K,X,q,$].forEach(function(t){var n=i&&i[t];e.push(n||t)}),e},A=null,g=void 0,s=Math.abs,ft=Math.exp,lt=Math.log,ht=Math.pow,dt=Math.floor,vt=Math.ceil,D.missingArgument=e,mt={},i.prototype.toString=function(){var t,n,t=(0,D.getMapping)()&&(0,D.getMapping)().clacErrorMapping,n;return t&&t[this._error]||this._error},i.prototype.clone=function(){return new i(this._error)},i.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},i.parse=function(t){var t=i.CDt(t);return t?new i(t.error,t.code):g},i.ibt=function(t){for(var n=0;n<D.ErrorCodeList.length;n++)if(t===D.ErrorCodeList[n])return new i((0,D.getErrorList)()[n],t);return g},i.CDt=function(t){var n,e,i;if(t)for(n=(0,D.getErrorList)(),e=0;e<n.length;e++)if((i=n[e])===t||i===nn(t))return{error:i,code:D.ErrorCodeList[e]};return g},v=i,D.CalcError=v,u={Name:new v(J),Null:new v(Y),DivideByZero:new v(Z),NotAvailable:new v(K),Value:new v(W),Reference:new v(Q),Number:new v(X),Spill:new v(q),Calc:new v($)},D.Errors=u,R=u.Value,gt=u.Reference,I=u.Number,pt=u.DivideByZero,bt=u.NotAvailable,wt=u.Null,yt={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},dn.prototype.getRowCount=function(){return this.array.length},dn.prototype.getColumnCount=function(){var t=this.array[0];return t&&t.length||0},dn.prototype.getValue=function(t,n){var e,i,r,e=this.array,i=t;return"number"!=typeof n&&(i=t.row,n=t.column),i<0||n<0||i>=e.length||n>=e[0].length?R:this.array[i][n]},dn.prototype.getValueByIndex=function(t){var n=this.getColumnCount(),e=dt(t/n),i;return this.getValue(e,t%n)},dn.prototype._Dt=function(){var t,n,e,i,r,o,t=this,n=0,e=0;if(n=t.getRowCount())for(e=t.getColumnCount(),i=0;i<n;i++)for(r=0;r<e;r++)pn(o=this.array[i][r])&&(this.array[i][r]=o.getValueByIndex(0))},dn.prototype.toArray=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m;if(void 0===n&&(n=!0),c=s=0,f=[],d=mt,s=(u=this).getRowCount())for(c=u.getColumnCount(),v=0;v<s;v++)for(n||f.push(h=[]),m=0;m<c;m++){if(l=u.getValue(v,m),u.referenceInTwoDimension&&pn(l)&&(l=l.getValueByIndex(0)),e&&b(l))return(f=[l]).isError=!0,f;if(l=hn(l,t,!1,o),i&&l===d)return(f=[l]).isConvertError=!0,f;(n?f:h).push(l)}return f.rowCount=s,f.colCount=c,f.rangeCount=1,f},dn.prototype.slice=function(t,n,e,i){var r,o,a,u,s,c,r=this,o=r.array,a=[];for(n=n<0?0:n,e=(t=t<0?0:t)+e>r.getRowCount()?r.getRowCount()-t:e,i=n+i>r.getColumnCount()?r.getColumnCount()-n:i,s=0;s<e;s++)for(a.push(u=[]),c=0;c<i;c++)u.push(o[s+t][c+n]);return new dn(a)},Mt=dn,D.CalcArray=Mt,L(vn,Ot=Mt),vn.prototype.getCalculatedValue=function(){var t,n,t=this.array[0];return 1===t.length?t[0]:"number"!=typeof t[0]?B([],t,!0):(n=0,t.forEach(function(t){"number"==typeof t&&(n+=t)}),n)},vn.prototype.getActualValue=function(){return 1===this.array[0].length?this.array[0][0]:B([],this.array[0],!0)},D.TwoDimensionalCalcArray=Ct=vn,St=["o","n","s","b","d"],w.Sft=function(t){return b(t)&&t._code===D.ErrorCodeList[5]},w.L6t=function(t){return isNaN(t)||!isFinite(t)?I:t},w.iV=function(t,n,e,i,r,o,a,u){var s,c,f;if(t&&t.length&&t.rowCount&&t.colCount)return t;if(gn(t))(s=t.toArray(n,e,i,r,o)).isArray=!0;else if(pn(t))(s=t.toArray(n,e,i,r,o,a,u)).isReference=!0;else{if(it(t)){if(s=[],0===t.length)return s;if(it(t[0]))return w.EDt(t,n,!0);for(c=0;c<t.length;c++)(f=hn(t[c],n,!1))===w.CalcConvertedError&&(s.isConvertError=!0),s.push(f);s.rowCount=1,s.colCount=t.length}else t=hn(t,n,!0,o),i&&w.BJ(t)?(s=[R]).isError=!0:t===w.CalcConvertedError?(s=[w.CalcConvertedError]).isConvertError=!0:(e?s=[]:(s=[[]])[0]).push(t),s.rowCount=1,s.colCount=1;s.rangeCount=1}return s},w.EDt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m;if(!t||!t.length||!t[0].length)return(i=[]).isError=!0,[[R]];if(0===n)return t;if(o=t.length,a=t[0].length,h=l=!(f={value:A}),d=w.CalcConvertedError,!(i=t[r=St[n]]))for(t[r]=i=[],v=0;v<o;v++)for(u=t[v],s=i[v]=[],m=0;m<a;m++){if(b(c=u[m])){l=l||(i.isError=!0)}else{switch(n){case 1:case 5:e&&5!==n?c=p(c,f)?f.value:(h||(i.isConvertError=h=!0),0):typeof c===M||c instanceof Date||(h||(i.isConvertError=h=!0),c=d);break;case 3:e?c=ln(c,f)?f.value:(h||(i.isConvertError=h=!0),!1):typeof c!==C&&(h||(i.isConvertError=h=!0),c=d);break;case 2:c=c===A||c===g?"":c.toString()}}s.push(c)}return i},w.z6t=function(t){var t=cn(t);if(s(t)<1e21)return parseInt(t.toString(),10);throw(0,D.sR)().Exp_InvalidCast},w.t9t=function(t,n){var e;return""!==t&&!!p(t,n)&&s(n.value)<1e21&&(n.value=parseInt(n.value.toString(),10),!0)},w.U6t=function(t){if(!t)return!1;if(typeof t===C)return t;if(t instanceof Date)return 0!==T.o0(t);if(w.q8(t))return 0!==t;if(w.BJ(t))return!1;throw(0,D.sR)().Exp_InvalidCast},w.j=function(t){var n,e,i,r,o,a;try{if(t===g||t===A)return"";if(typeof t===C)return t?H:V;if(typeof t===U)return t;if(t instanceof Date)return T.o0(t).toString();if(gn(t))throw(0,D.sR)().Exp_InvalidCast;if(typeof t!==M)return t.toString();if(n="",t<0&&(n="-",t=-t),-1!==(r=(i=-1===(i=(e=E.E8(t,kt.CALC_PRECISION||15)).toString()).indexOf("e")&&20<i.length?e.toExponential():i).indexOf("e-"))){if(o=+i.substring(r+2),(a=-1===i.indexOf(".")?1:r-1)+o<20)return n+t.toFixed(a+o-1);o<10&&(i=i.replace("e-","e-0"))}return n+i.toUpperCase()}catch(t){throw(0,D.sR)().Exp_InvalidCast}},w.r0=function(t){var n={value:A};if(w.kDt(t,n))return n.value;throw(0,D.sR)().Exp_InvalidCast},w.kDt=function(t,n){var e,i,r,o;if(t)if(!0===t)n.value=y.Common.ct.Y0(1);else if(t instanceof Date)n.value=new Date(t.valueOf());else if(typeof t===U){if(!(e=y.Common.ct.yU(t)))if(isNaN(t)){if(e=new Date(t),isNaN(e.valueOf()))return!1;try{if(i=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=at.s6t(at.cJ(t.replace(/ |\n/g,"")," ")," "),(o=i.exec(r))&&4===o.length&&(-1===o.indexOf(e.getFullYear().toString())||-1===o.indexOf(e.getMonth().toString())||-1===o.indexOf(e.getDate().toString())))return!1}catch(t){return!1}}else if(!(e=y.Common.ct.Y0(parseFloat(t))))return!1;n.value=e}else{if(typeof t!==M)return!1;n.value=y.Common.ct.Y0(t)}else n.value=y.Common.ct.Y0(0);return!0},w.CalcConvertedError=mt,w.Nh=gn,w.q8=mn,w.BJ=b,w.LE=pn,w.Nbt=hn,w.Ybt=fn,w.jDt=sn,w.uJ=cn,w.sJ=p,w.YK=ln,F=w,D.Convert=F,(n=Tt=D.ExpressionType||(D.ExpressionType={}))[n.unknow=0]="unknow",n[n.reference=1]="reference",n[n.number=2]="number",n[n.string=3]="string",n[n.boolean=4]="boolean",n[n.error=5]="error",n[n.array=6]="array",n[n.function=7]="function",n[n.name=8]="name",n[n.operator=9]="operator",n[n.parentheses=10]="parentheses",n[n.missingArgument=11]="missingArgument",n[n.expand=12]="expand",n[n.structReference=13]="structReference",n[n.field=14]="field",n[n.fieldItem=15]="fieldItem",n[n.tableSheetReference=22]="tableSheetReference",n[n.nameIdentity=25]="nameIdentity",n[n.externalNameIdentity=26]="externalNameIdentity",n[n.LocalName=100]="LocalName",bn.prototype.hmt=function(){return A},bn.prototype.offset=function(t,n,e,i,r){return A},bn.prototype.offsetWhenCopy=function(t,n,e,i,r,o,a,u,s,c){return A},bn.prototype.getRange=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];return A},bn.prototype.forEachNodes=function(n){n(this),this.value&&this.value.forEachNodes&&this.value.forEachNodes(n),this.value2&&this.value2.forEachNodes&&this.value2.forEachNodes(n),this.arguments&&this.arguments.forEach&&this.arguments.forEach(function(t){t.forEachNodes&&t.forEachNodes(n)})},c=bn,D.Expression=c,f.prototype.getRangeCount=function(){return this.SDt},f.prototype.getSource=function(){return this.rT},f.prototype.create=function(t){return new f(this.rT,t)},f.prototype.getKey=function(){var n,e,n=[],e=this.rT;return this.$gt.forEach(function(t){n.push(e.getRangeKey(e,t))}),1===n.length?n[0]:0===n.length?A:n.join(",")},f.prototype.toArray=function(t,n,e,i,r,o,a){var u=this.rT,s=u.referenceToArray;return s&&s.call(u,this,t,n,e,i,r,o,a)},f.prototype.getRow=function(t){return this.$gt?this.$gt[t||0].row:0},f.prototype.getColumn=function(t){return this.$gt?this.$gt[t||0].col:0},f.prototype.getRowCount=function(t){return this.$gt?this.$gt[t||0].rowCount:this.rT.getRowCount()},f.prototype.getColumnCount=function(t){return this.$gt?this.$gt[t||0].colCount:this.rT.getColumnCount()},f.prototype.getValue=function(t,n,e){var i,r,e;if(typeof t===M?(i=arguments[1],r=e,n=t):(i=t.row,r=t.col),n=n||0,0<=i||0<=r){if(!(e=this.$gt))return this.rT.getValue(i,r);if(n<e.length)return this.rT.getValue(i+e[n].row,r+e[n].col)}return gt},f.prototype.getValueByIndex=function(t){var n=this.getColumnCount(),e=dt(t/n),i;return this.getValue(0,e,t%n)},f.prototype.isHiddenRow=function(t,n,e){return this.rT.isHiddenRow(n+this.getRow(t),e)},f.prototype.isSubtotal=function(t,n,e){var i,r,i=this.rT;return 0===t&&n<i.getRowCount()&&e<i.getColumnCount()&&en(r=i.getCalcSourceModel().ODt(n,e))},f.prototype.getSpillRef=function(){var t,n,e,t,i,r,o,o,a,a,t=this;if(1===t.getRowCount()&&1===t.getColumnCount()&&(r=new f(n=t.getSource(),[i=Re(e=t.getRow(),t=t.getColumn())]),n)&&n.t8){if(o=n.t8.getAnchorCell(e,t))return o.isValid?(i.rowCount=o.rowCount,i.colCount=o.colCount,r):u.Spill;if(a=(o=n.getCalcSourceModel()).sT(e,t))return a.row===e&&a.col===t?(i.rowCount=a.rowCount,i.colCount=a.colCount,new f(n,[i])):void 0;if(!(a=o.pB(e,t))||33!==a.type)return a&&("@"===a.functionName||a)?(i.rowCount=1,i.colCount=1,new f(n,[i])):gt;r.isSpillError=!0,i.rowCount=1,i.colCount=1}return gt},At=f,D.CalcReference=At,r.prototype.getCalcService=function(){return this.Lbt},r.prototype.op=function(){return this.Lbt},r.prototype.setCalcService=function(t){this.Lbt=t},r.prototype.getCalcSourceModel=function(){return this.Mbt},r.prototype.setCalcSourceModel=function(t){this.Mbt=t},r.prototype.getValue=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return A},r.prototype.getName=function(t){return""},r.prototype.getField=function(t){return A},r.prototype.getFieldItem=function(t){return A},r.prototype.setValue=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},r.prototype.getReference=function(t){return new At(this,t&&[t])},r.prototype.getSources=function(t){return[this]},r.prototype.referenceToArray=function(t,n,e,i,r,o,a,u){return t.toArray(n,e,i,r,o,a,u)},r.prototype.setFormula=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},r.prototype.setArrayFormula=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},r.prototype.getRowCount=function(){return 1e3},r.prototype.getColumnCount=function(){return 100},r.prototype.isHiddenRow=function(t,n){return!1},r.prototype.startCalculation=function(){},r.prototype.endCalculation=function(t){},r.prototype.getCustomFunction=function(t){return A},r.prototype.getCustomName=function(t){return A},r.prototype.getCustomNameInfo=function(t){return A},r.prototype.refresh=function(){},r.prototype.toJSON=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i]},r.prototype.wh=function(t,n){for(var e,i,e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i]},r.sourceId=1,t=r,D.CalcSource=t,D.Syt=wn,D.kyt=wn(gt),D.YJ=yn,D.lDt=Mn,D.createExpandExpression=Cn,D.rbt=Sn,D.Ayt=Tn,D.xde=An,D.createStringExpression=In,D.createNumberExpression=xn,D.createBooleanExpression=Nn,D.addStartEndIndexToExpression=kn,_n.getArrayValue=function(t,n,e){return t?n<t.getRowCount()&&e<t.getColumnCount()?t.getValue(n,e):e>=t.getColumnCount()&&1===t.getColumnCount()&&n<t.getRowCount()?t.getValue(n,0):n>=t.getRowCount()&&1===t.getColumnCount()&&e<t.getColumnCount()?t.getValue(0,e):R:R},_n.tryExtractToSingleValue=function(t){var n,e,n=!0;return(pn(t)||gn(t))&&((e=F.iV(t,0,!1,!0)).isError?t=e[0]:1===e.rowCount&&1===e.colCount?t=e[0][0]:(t=e,n=!1)),{value:t,success:n}},D.skt=_n,D.charAtFunc=h,On.prototype.xDt=function(t){var n,e,i,r,o,a,u,s,c,n=this.ADt;if(-1===(n=et.Nh(n)?n:[n])[0])return!0;for(e=0;e<n.length;e++)if(o=r=void 0,jn(i=n[e])){for(a=i.split(" && "),u=!0,s=0;s<a.length;s++)r=(c=a[s].split(" "))[0],o=rt(c[1]),"!="===r&&t!==o||">"===r&&o<t||">="===r&&o<=t||"%="===r&&t%2===o||(u=!1);if(u)return!0}else if(t===i)return!0;return!1},On.prototype.NDt=function(){return this.ADt},xt=On,D.sDt=En,o.prototype.getVariable=function(t){var n,e;for(t=nn(t),e=this.context.length-1;0<=e&&(n=this.context[e][t])===g;e--);return n=n===g&&this.closure?this.closure[t]:n},o.prototype.setVariable=function(t,n){t=nn(t),this.context[this.context.length-1][t]=n},o.prototype.hasVariable=function(t){return t=nn(t),this.getVariable(t)!==g},o.prototype.enterScope=function(){this.context.push({})},o.prototype.exitScope=function(){this.context.pop()},o.prototype.saveThenSwitchClosure=function(t){this.backupClosure.push(this.closure),this.closure=t},o.prototype.restoreClosure=function(){0<this.backupClosure.length?this.closure=this.backupClosure.pop():this.closure={}},o.prototype.createClosure=function(){var t,n,t={};for(this.copyTo(this.closure,t),n=0;n<this.context.length;n++)this.copyTo(this.context[n],t);return t},o.prototype.copyTo=function(t,n){for(var e,i,r,e=Object.keys(t),i=0;i<e.length;i++)n[r=e[i]]=t[r]},D.LocalScopes=o,m=kt=kt||{},(e=Et=m.ArrayArgumentEvaluateMode||(m.ArrayArgumentEvaluateMode={}))[e.normal=0]="normal",e[e.allwaysExpand=1]="allwaysExpand",e[e.neverExpand=2]="neverExpand",l.prototype.description=function(){var t=this,n=(0,D.sR)().wmt;return t.IDt||n&&n[t.name]},l.prototype.acceptsArray=function(t){return!1},l.prototype.acceptsReference=function(t){return!1},l.prototype.acceptsError=function(t){return!1},l.prototype.acceptsMissingArgument=function(t){return!1},l.prototype.isVolatile=function(){return!1},l.prototype.isContextSensitive=function(){return!1},l.prototype.acceptsExpressionArgument=function(t){return!1},l.prototype.isBranch=function(){return!1},l.prototype.findTestArgument=function(){return-1},l.prototype.findBranchArgument=function(t){return-1},l.prototype.expandRows=function(){return!0},l.prototype.expandColumns=function(){return!0},l.prototype.skipPrecedent=function(t){return!1},l.prototype.returnReference=function(){return!1},l.prototype.evaluate=function(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},l.prototype.evaluateWithContext=function(t,n){var e=this,n=n;return e.isContextSensitive()&&(n=[t].concat(n)),e.evaluate.apply(e,n)},l.prototype.toJSON=function(){var t,n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},l.prototype.fromJSON=function(t){if(t)for(var n in t)t[n]!==g&&(this[n]=t[n])},l.prototype.aDt=function(t,n,e,i){if(e<t||n<e)throw(0,D.sR)().Exp_FormulaInvalid},l.prototype.uDt=function(t,n){En(t,n)},l.ZX=function(t,n,e){var i,r,i=new l(t,0,255);if(n&&"function"==typeof n&&(i.evaluate=n),e)for(r in e)e.hasOwnProperty(r)&&"override"!==r&&(i[r]=e[r]);return i},Rt=l,m.Function=Rt,L(Rn,qt=Rt),Rn.prototype.isContextSensitive=function(){return!0},Rn.prototype.evaluate=function(t,n){return this.evaluateAsync.apply(this,arguments)},Rn.prototype.evaluateAsync=function(t,n){this.evaluate.apply(this,arguments)},Rn.prototype.defaultValue=function(){return 0},Rn.prototype.evaluateMode=function(){return 0},Rn.prototype.evaluateWhenArgumentsIsSame=function(){return!0},Rn.prototype.interval=function(){return 1e4},m.AsyncFunction=Rn,L(Fn,$t=Rt),Fn.prototype.acceptsArray=function(t){return!0},Fn.prototype.acceptsReference=function(t){return!0},Fn.prototype.acceptsError=function(t){return!0},m.LambdaFunction=Fn,m.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},m.Mmt={},m.Tmt={},m.defineGlobalCustomFunction=Ln,m.findGlobalFunction=Bn,m.findGlobalFunctions=Pn,m.removeGlobalFunction=Gn,Bt=(0,D.sR)().Exp_Format,Vn.prototype.ikt=function(){return this.okt},Vn.prototype.rkt=function(){return this.akt},Vn.prototype.hkt=function(){return this.mit},Vn.prototype.j=function(t){t=t||"i";var n=this,e=n.okt,n=n.akt,i="",r=m.CALC_PRECISION;return r&&(e=E.E8(e,r),n=E.E8(n,r)),0===e&&0!==n||(i+=e.toString()),-1===n?i+="-":0!==e&&0<n&&(i+="+"),-1!==n&&0!==n&&1!==n&&(i+=n.toString()),0!==n&&(i+=t),i},Pt=Vn,m.q6t=Pt,m.mkt=zn,Gt=F.sJ,Ut=F.z6t,x=F.uJ,Ht=F.q8,Vt=F.iV,zt=F.L6t,Yt=F.BJ,m.F6t=Zn,m.B6t=179769e303,m.G6t=Wn,m.OMt=jn,m.q8=Qn,m.F9t=Jn,Zt=Jn,m.Fkt=Kn,m.Gkt=Xn,m.Pkt=qn,Wt=qn,m.Ukt=te,m.dkt=ne,m.b9t=ee,m.y9t=ie,m.H9t=re,m.P9t=oe,m.U9t=ae,m.G9t=ue,m.w9t=ye,m.nkt=Me,m.Mkt=Ce,m.Hkt=Te,Ae.prototype.RDt=function(t){var n,e,i,r,n=this.criteria,e=this.array;if(!j(n))if(this.useMap){if(i=e.DDt.get(n))for(r=0;r<i.length;r++)if(t(i[r]))return}else if("function"==typeof n){for(r=0;r<O(e);r++)if(n(e[r])&&t(r))return}else for(r=0;r<O(e);r++)if(n===e[r]&&t(r))return},Ae.prototype.A9t=function(t){return this.criteria&&this.criteria(this.array[t])},Ae.prototype.Pde=function(t){return this.criteria===this.array[t]},Ae.prototype.dispose=function(){delete this.criteria,delete this.array},Qt=Ae,m.RangeCriteria=Qt,(e=Jt=Jt||{})[e.unCompatibleDoubleEqual=0]="unCompatibleDoubleEqual",e[e.compatibleDoubleEqual=1]="compatibleDoubleEqual",e[e.stringEqual=2]="stringEqual",N.prototype.dispose=function(){delete this.referenceCache},N.prototype.p9t=function(t){var n,e,i;if(j(t))return[4,0];if(Ht(t)||!jn(t))return[4,t];switch((e=(n=j(t)?"":t.toUpperCase())[0])+(i=n[1])){case"<>":return[2,2===n.length?null:n.substring(2)];case"<=":return[0,2===n.length?null:n.substring(2)];case">=":return[1,2===n.length?null:n.substring(2)]}switch(e){case"=":return[4,1===n.length?null:n.substring(1)];case"<":return[3,1===n.length?null:n.substring(1)];case">":return[5,1===n.length?null:n.substring(1)]}return[4,t.toUpperCase()]},N.BDt=function(t){return 0===t.toString().trim().length},N.LDt=function(t){return Wn(t)||m.OMt(t)&&("TRUE"===t.toUpperCase()||"FALSE"===t.toUpperCase())},N.FDt=function(t){return Wn(t)?t:"TRUE"===t.toUpperCase()},N.getCompareFunction=function(t){return 0===t?function(t,n){return t<=n}:1===t?function(t,n){return n<=t}:2===t?function(t,n){return t!==n}:3===t?function(t,n){return t<n}:4===t?function(t,n){return t===n}:5===t?function(t,n){return n<t}:void 0},N.prototype.PDt=function(t,n,e,i){var r,o,a,u,s,c,r=null,a=S.tbt(n);return a&&(u=n.replace(/\*+/g,"*"))!==n&&(a=S.tbt(u)),r=4===e||2===e?a?"^[\\s\\S]*$"===a?D.ExcelCompatibleCalcMode?4===e?function(t){return m.OMt(t)}:function(t){return!m.OMt(t)}:4===e?function(t){return""!==t&&m.OMt(t)}:function(t){return!(b(t)||""!==t&&m.OMt(t))}:(s=S.OJ(a),4===e?function(t){return s.lastIndex=0,m.OMt(t)&&s.test(t)}:function(t){return!b(t)&&(s.lastIndex=0,!m.OMt(t)||!s.test(t))}):""===n?4===e?function(t){return""===t||j(t)}:function(t){return""!==t&&!j(t)}:4===e?(o=this.GDt(t,Jt.stringEqual,i,function(t){return t&&t.toUpperCase&&t.toUpperCase()}),n):D.ExcelCompatibleCalcMode?function(t){return n!==(t&&t.toUpperCase&&t.toUpperCase())}:function(t){return!b(t)&&n!==(t&&t.toUpperCase&&t.toUpperCase())}:(c=N.getCompareFunction(e),D.ExcelCompatibleCalcMode?function(t){return jn(t)&&c(t.toUpperCase(),n)}:a?function(t){return!b(t)&&!Qn(t=j(t)?"":t)&&!T.W0(t)&&c(t.toString().toUpperCase(),n)}:function(t){return!b(t)&&(j(t)&&(t=""),c(t.toString().toUpperCase(),n))}),new Qt(r,o,t,i)},N.prototype.GDt=function(t,n,e,i){var n,r,o,a,u;if(pn(t)&&this.referenceCache){if(n=t.getKey()+","+n,!(r=this.referenceCache.get(n)))for(r=[],-1!==e&&this.referenceCache.set(n,r),o=t.toArray(0,2,!1,!1),a=0;a<O(o);a++)r[a]=i(o[a]);return 2===e?r.Kyn=n:1!==e||r.DDt||(r.DDt=u=(0,G.createMap)(),r.forEach(function(t,n){var e=u.get(t);e||u.set(t,e=[]),e.push(n)})),r}return i},N.prototype.T9t=function(t,n,e){var i,r,o,i,a,u,s,c,f,l,h,i=this.p9t(n),r=i[0],o=i[1],i=null,u={value:o},s={value:0},c=N.getCompareFunction(r);if(b(o=jn(o)&&(f=v.parse(o))?f:o)&&(4===r||0===r||1===r?i=function(t){return o._code===(t&&t._code)}:2===r&&(i=function(t){return o._code!==(t&&t._code)})),D.ExcelCompatibleCalcMode){if(null===o)4===r?i=function(t){return j(t)}:2===r&&(i=function(t){return!j(t)});else if(N.LDt(o))l=N.FDt(o),i=4===r?l:2===r?function(t){return t!==l}:function(t){return Wn(t)&&c(t,l)};else if(!N.BDt(o)&&Gt(o,u))i=4===r?(a=this.GDt(t,Jt.compatibleDoubleEqual,e,function(t){return j(t)||""===t||N.LDt(t)||!p(t,s)?g:s.value}),u.value):2===r?function(t){return!Qn(t=T.W0(t)?d(t):t)||t!==u.value}:function(t){return Qn(t=T.W0(t)?d(t):t)&&c(t,u.value)};else if(m.OMt(o))return this.PDt(t,o,r,e)}else if(null===o)i=4===r?function(t){return j(t)}:2===r?function(t){return!b(t)&&!j(t)&&!N.BDt(t)}:n;else if(!N.LDt(o)||4!==r&&2!==r){if(4===r&&y.Common.ut(o,Date))o=o.getTime(),i=function(t){if(t&&F.kDt(t,s))return s.value.getTime()===o};else if(!N.BDt(o)&&Gt(o,u))i=4===r?(a=this.GDt(t,Jt.unCompatibleDoubleEqual,e,function(t){return j(t)||N.BDt(t)||!p(t,s)?g:s.value}),u.value):2===r?function(t){return!(b(t)||(t=T.W0(t)?d(t):t,!j(t)&&!N.BDt(t)&&p(t,s)&&s.value===u.value))}:function(t){if(t=T.W0(t)?d(t):t,!j(t)&&!N.BDt(t)){if(p(t,s))return c(s.value,u.value);if(m.OMt(t))return c(t.toString().toUpperCase(),o.toString().toUpperCase())}return!1};else if(m.OMt(o))return this.PDt(t,o,r,e)}else h=o.toString().toUpperCase(),i=4===r?function(t){return N.LDt(t)&&t.toString().toUpperCase()===h}:2===r?function(t){return!(b(t)||N.LDt(t)&&t.toString().toUpperCase()===h)}:function(t){return Wn(t)&&c(t,h)};return new Qt(i,a,t,e)},N.prototype.I9t=function(t,n,e,i){var r;this.T9t(t,n,i).RDt(e)},N.prototype.Fde=function(t,e,n){for(var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,i=[],r=[],o="s",a=[],u=0;u<t.length;u+=2)"function"!=typeof(s=this.T9t(t[u],t[u+1],0<n?2:-1)).criteria?(i.push(s.array),r.push(s.criteria),o+=s.array.Kyn):a.push(s);if(1<=i.length){if(c=this.referenceCache&&this.referenceCache.get(o),f=i.length,h=l=void 0,!c){for(d=i[0].length,c=(0,G.createMap)(),this.referenceCache&&this.referenceCache.set(o,c),c.oAn=[],v=1;v<f;v++)c.oAn[v]=(0,G.createMap)();for(v=0;v<d;v++){for(h=i[0][v],l=1;l<f;l++)(m=c.oAn[l].get(i[l][v]))||(m=c.oAn[l].size+1,c.oAn[l].set(i[l][v],m)),h+=","+m;(g=c.get(h))||c.set(h,g=[]),g.push(v)}}for(h=r[0],l=1;l<f;l++){if(!(m=c.oAn[l].get(r[l])))return;h+=","+m}if(p=c.get(h))for(b=void 0,b=1<a.length?function(t){for(var n=0;n<a.length;n++)if(!a[n].A9t(t))return;return e(t)}:1===a.length?(w=a[0],function(t){if(w.A9t(t))return e(t)}):e,v=0;v<p.length;v++)if(b(p[v]))return}else a[0].RDt(function(t){for(var n=1;n<a.length;n++)if(!a[n].A9t(t))return;return e(t)})},m.RangeCriteriaManager=N,k.d9t=function(t){var n=dt(t);return E.ukt(t,n+1)?n+1:n},k.x9t=function(t){var n=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][t];return 308<t&&(t=308),j(n)?ht(10,parseFloat(t)):n},k.z9t=function(t){var n=vt(t);return E.ukt(t,n-1)?n-1:n},k.Lkt=function(t,n){for(var e,i,r,o,a,u,u,e=k.x9t(s(n)),i=vt,r=dt,o=n,a=o<0?t/e:t*e;2<s(o)&&a===1/0;)o=Math.round(o/2),e=k.x9t(s(o)),a=o<0?t/e:t*e;return u=(t=a).toExponential(),t=(t=(u=rt(u.split("e")[1])+1)<=15&&-85<=u?parseFloat(t.toFixed(15-u)):t)<0?i(t-.5):r(t+.5),zt(t=n<0?t*e:t/e)},k.g9t=function(t,n){var e,i;if(t<0||n<0||t<n)return I;for(e=1,n=Math.min(t-n,n),i=1;i<=n;i++)e=e*(t-i+1)/i;return zt(e)},k.N9t=function(t,n){if(t<0&&s(n)<1){var e=(1/n).toPrecision(15);if(parseFloat(e)===parseInt(e,10)&&parseInt(e,10)%2!=0)return-ht(-t,n)}return ht(t,n)},k.kkt=function(t,n){var n=.5<s(t)?ht(1+t,n):ft(n*lt(1+t));return isFinite(n)?ot(n)&&(n=5e-324):n===Number.POSITIVE_INFINITY?n=m.B6t:n===Number.NEGATIVE_INFINITY&&(n=-m.B6t),n},k.vkt=function(t,n){return(ft(t)+(n?-1:1)*ft(-t))/2},k.ckt=function(t,n){return ot(t)?t:ot(n)?n:1!==n&&1===t||0!==n&&n!==Number.POSITIVE_INFINITY?lt(t)/lt(n):NaN},m.MathHelper=k,D.Functions=kt,_t=function(t,n){var e=t.localeCompare(n);return 0===e&&t!==n?n<t?1:-1:e},D.Wkt=Ie,D.$kt=xe,D.isFunction=Ne,D.isLambdaFunction=ke,D.isExpression=_e,D.getFunctionAcceptsArray=De,D.getFunctionAcceptsReference=je,D.getFunctionArrayArgumentEvaluateMode=Oe,L(Ee,tn=t),Ee.prototype.startCalculation=function(){},Ee.prototype.endCalculation=function(t){},Ee.prototype.getValue=function(){return u.Reference},Ee.prototype.getReference=function(){var t=new At(this,[Re(0,0)]);return t.getValue=function(){return u.Reference},t},Ee.prototype.referenceToArray=function(){var t=[u.Reference];return t.isError=!0,t},Ee.prototype.getName=function(){return this.oyt},Ee.prototype.setValue=function(){},D.ErrorSource=Ee},"./src/calc.entry.ts":function(t,n,e){var i,r,o,a,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/Parser.ts"),n),r(e("./src/evaluator.ts"),n),r(e("./src/referenceExpression.ts"),n),r(e("./src/map.ts"),n),o=e("./src/calc.ts"),Object.defineProperty(n,"supportRowColumnFormula",{set:function(t){o.supportRowColumnFormula=t},get:function(){return o.supportRowColumnFormula}}),Object.defineProperty(n,"approximatelyEqual",{set:function(t){o.approximatelyEqual=t},get:function(){return o.approximatelyEqual}}),r(e("./src/calc.ts"),n),a=e("./src/calc.common.ts"),Object.defineProperty(n,"ExcelCompatibleCalcMode",{set:function(t){a.ExcelCompatibleCalcMode=t},get:function(){return a.ExcelCompatibleCalcMode}}),Object.defineProperty(n,"usedbcs",{set:function(t){a.usedbcs=t},get:function(){return a.usedbcs}}),r(e("./src/calc.common.ts"),n)},"./src/calc.ts":function(M,d,t){var n,m,Q,J,K,X,g,r,C,S,T,w,q,$,I,at,ut,tt,nt,x,o,a,G,t,et,l,v,N,k,it,st,ct,_,u,D,j,O,E,R,U,F,L,B,P,H,V,z,Y,Z,W,ft,lt;function ht(t,n){var e,i,r,o,a,u,s,e=t.w3&&t.w3.getSource();e&&(i=t.row,r=t.column,o=e.getValue(i,r),(s=(u=e&&e.Mf)&&t.isDefault)&&(u.vle=t.isDefault()),e.setValue(i,r,n,o,$,!0),s)&&delete u.vle}function e(t){this.aT=[],this.w3=t}function i(t,n){var t=V.call(this,t)||this;return t.name=n,t.delay=0,t}function s(t,n,e){var t=z.call(this,t)||this;return t.id=n,t.name=e,t.delay=0,t}function c(){this.calculationMode=0,this.rO={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.dynamicReferences=!0,this.HDt=0,this.zDt=0,this.VDt=[];var t=this;t.j3t=new K.Parser,t.MX=new X.Evaluator(t),t.YDt=t.mwt&&t.mwt(),t.addResolver(new K.DefaultTokenResolver),t.ZDt={WDt:!0}}function dt(){}function vt(t,n,e,i,r,o){mt(t.QDt,t.qkt)&&(t.QDt&&(gt(e,t,t.QDt,!1),delete t.QDt),t.qkt)&&(gt(e,t,t.qkt,!0,o),t.QDt=t.qkt,delete t.qkt)}function mt(t,n){return(!et(t)||!et(n))&&(et(t)||et(n)||Object.keys(t).join()!==Object.keys(n).join())}function gt(t,n,e,i,r){var o,a,u,s,u;for(o in e)e.hasOwnProperty(o)&&(a=e[o],u=t.rO[a.id])&&(At(a)?(s=u.uT(!0)).JDt(a.rowUndefine?-1:a.row,a.colUndefine?-1:a.col,a.rowUndefine?-1:a.rowCount,a.colUndefine?-1:a.colCount,n,i,!0,r):((u=u.oT(a.row,a.col,!0))&&u.KDt(0,n,i),r&&u&&u.k1&&n.delay++))}function f(t,n){this.I8=0,this.x8=0,this.XDt=[],this.qDt=[],this.$Dt=[],this.dataTable={},this.dataTableByName={},this.AE=[],this.IE=[],this.t_t=0;var e=this;e.rT=n,e.Lbt=t}function h(t,n,e){var t=Y.call(this,t)||this;return t.row=n,t.column=e,t.delay=0,t}function pt(t,n,e){t[n]||(t[n]=[]),t[n].push(e)}function bt(t,n,e){var i,r,i=t[n];if(i)for(r=0;r<i.length;r++)if(i[r]===e)return void i.splice(r,1)}function p(t,n){var t=Z.call(this,t)||this;return t.row=n,t}function b(t,n){var t=W.call(this,t)||this;return t.column=n,t}function wt(t,n){var t=ft.call(this,t)||this;return t.name=n,t}function yt(t,n,e,i,r){var o,a,u,s,o=0;for(-1===i&&(n=0,i=t.rT.getRowCount()),-1===r&&(e=0,r=t.rT.getColumnCount()),a=0;a<i;a++)for(u=0;u<r;u++)(s=t.oT(a+n,u+e,!0))&&s.k1&&o++;return o}function y(t){return lt.call(this,t)||this}function Mt(t,n){var e,i,i;for(e in t)(i=t[e])&&(n?Mt(i):(i=i.calc)&&i.CMt())}function Ct(t,n){var n;t.function||(n=n.getNameInfo(t.functionName))&&(t.functionName=n.Zc)}function St(t,n,e,F,L,B,P){for(var i,r,o,a,G,U,u,H,s,V,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,z,k,A,I,x,_,D,j,O,E,E,D,_,j,O,R,Y,i=t.row,r=t.column,o=[],a=0,G=t.arrayIdentity?t.arrayIdentity.row:i,U=t.arrayIdentity?t.arrayIdentity.col:r,H=u=0,c=F,f=L,l=s=!(o[a]={expr:n,acceptsArray:B||!1,acceptsRef:P||!1,index:-1});0<=a;){if(h=o[a],a--,d=h.acceptsArray,v=h.acceptsRef,n=h.expr,m=q,n)if(7===n.type){if(A=(T=n).arguments.length,!T.function){if(!t){m=(0,Q.Syt)(at);continue}T.function=t.getFunction(T.functionName),Ct(T,t)}if(I=T.function,x=h.index,S=h.neeedExpendindexs,x<0?(h.arrayArgumentEvaluateMode=l,h.arrayFormulaCatchValue=e,(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&(l=(0,Q.getFunctionArrayArgumentEvaluateMode)(I)),h.args=[]):((0,Q.getFunctionAcceptsArray)(I,x)?u--:s&&(S||(h.neeedExpendindexs=S=[]),T.arguments[x],S.push(x)),h.args.push(g)),x===A-1){if(l=h.arrayArgumentEvaluateMode,e=h.arrayFormulaCatchValue,z=!1,(N=h.args)&&0<N.length)for(k=0;k<N.length;k++)if(N[k]!==T.arguments[k]){z=!0;break}m=z?(0,Q.YJ)(T,N):n,S&&0<S.length&&(m=(0,Q.createExpandExpression)(m,S),s=!0)}else 0===x&&I&&3===(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&3===l&&(l=0),s=!1,x++,h.index=x,(0,Q.getFunctionAcceptsArray)(I,x)&&u++,o[++a]=h,o[++a]={expr:T.arguments[x],acceptsArray:(0,Q.getFunctionAcceptsArray)(I,x),acceptsRef:(0,Q.getFunctionAcceptsReference)(I,x),index:-1}}else if(1===n.type&&n.hmt())H&&(w=(b=n.source||t.source).getRowCount(),y=b.getColumnCount(),M=n.rowRelative?(n.row+G)%Q.MAX_ROW_COUNT%w:n.row,C=n.columnRelative?(n.column+U)%Q.MAX_COLUMN_COUNT%y:n.column,n=(0,J.knt)(n.source&&b,q,M=M<0?M+w:M,C=C<0?C+y:C,!1,!1));else if(1===n.type||13===n.type){if(13===n.type){if(p=(A=n).getRange(i,r),A.Fwt(i,r,t.source.id),!p){A._error?(delete A._error,m=g=ut,t.n_t=1):g=m=n;continue}n=(0,J.lJ)(A.source===t.source?q:A.source,q,p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1)}I=n.source,x=n,H&&(b=I||t.source,w=Q.MAX_ROW_COUNT,y=Q.MAX_COLUMN_COUNT,_=x.rowRelative?(x.row+G)%w:x.row,D=x.columnRelative?(x.column+U)%y:x.column,E=void 0,(j=(j=x.endRowRelative?(x.endRow+G)%w:x.endRow)<0?j+w:j)<(_=_<0?_+w:_)&&(E=_,_=j,j=E),(O=(O=x.endColumnRelative?(x.endColumn+U)%y:x.endColumn)<0?O+y:O)<(D=D<0?D+y:D)&&(E=D,D=O,O=E),(w=b.getRowCount())<=_?(_%=w,j%=w):w<=j&&(j=w-1),(y=b.getColumnCount())<=D?(D%=y,O%=y):y<=O&&(O=y-1),n.row===Q.BAND_INDEX_CONST&&(_=j=Q.BAND_INDEX_CONST),n.column===Q.BAND_INDEX_CONST&&(D=O=Q.BAND_INDEX_CONST),n=(0,J.lJ)(I,n.endSource,_,D,j,O,!1,!1,!1,!1)),v&&(d||!e&&1!==l&&3!==l)||i<0||r<0||4===l||x.source&&x.source.ayt||(0<u&&!e&&1!==l&&3!==l||0===u||2===l?(p=x.getRange(i,r),m=e||(v||d)&&1===l?!x.isFullColumn&&1!==p.rowCount&&c>=p.rowCount||!x.isFullRow&&1!==p.colCount&&f>=p.colCount?(0,Q.Syt)(nt):(M=(x.isFullColumn?0:p.row)+(1===p.rowCount?0:c),C=(x.isFullRow?0:p.col)+(1===p.colCount?0:f),(0,J.knt)(I,n.endSource,M,C,!1,!1)):1<p.rowCount&&1<p.colCount||1<p.rowCount&&!x.isFullColumn&&(i<p.row||i>=p.row+p.rowCount)||1<p.colCount&&!x.isFullRow&&(r<p.col||r>=p.col+p.colCount)?(0,Q.Syt)(tt):(M=x.isFullColumn||1<p.rowCount?i:p.row,C=x.isFullRow||1<p.colCount?r:p.col,(0,J.knt)(I,n.endSource,M,C,!1,!1))):s=!0)}else if(9===n.type)E=(0,Q.gDt)(n.operatorType),e&&et(n.value2)&&(E=!1),-1===h.index?(h.index=n.value2?0:1,o[++a]=h,o[++a]=rt(n.value,E,E,-1)):0===h.index?(g!==n.value&&(m=(0,Q.rbt)(n.operatorType,g,n.value2),h.expr=m),s&&((S=[]).push(0),h.neeedExpendindexs=S,s=!1),h.index=1,o[++a]=h,o[++a]=rt(n.value2,E,E,-1)):(m=n.value2&&g!==n.value2?(0,Q.rbt)(n.operatorType,n.value,g):et(n.value2)&&g!==n.value?(0,Q.rbt)(n.operatorType,g,$):n,S=h.neeedExpendindexs,s&&(S?S.push(1):S=[n.value2&&n.value2===V?1:0]),S&&(m=(0,Q.createExpandExpression)(m,S),s=!0));else if(10===n.type)-1===h.index?(h.index=0,o[++a]=h,o[++a]=rt(n.value,d,v,-1)):n.value!==g&&(m=(0,Q.Ayt)(g));else if(8===n.type)1===h.index?(H--,m=g,h.context&&(t=h.context)):(H++,o[++a]=rt(n,d,v,1,t),_=t,j=D=void 0,n.source?(j=n.source,(_=new X.EvaluateContext(j)).cloneFrom(t),D=j.getCustomName(n.value)):(D=t.getName(n.value),t.source.getCustomName(n.value)||(_=new X.GloableEvaluateContext(t.source)).cloneFrom(t)),D=D||(0,Q.Syt)(at),o[++a]=rt(D,d,v,-1,t=_||t));else if(6===n.type)if(O=n,!d&&(0<u||e||1===l||3===l))s=!0,V=n;else if(!d&&0===u)if(c>=O.value.RowCount&&1<O.value.RowCount||f>=O.value.colCount&&1<O.value.colCount)m=(0,Q.Syt)(nt);else try{1===O.value.RowCount&&(c=0),1===O.value.colCount&&(f=0),m=typeof(R=O.value.getValue(c,f))===st?(0,Q.createStringExpression)(R):typeof R===it?(0,Q.createNumberExpression)(R):typeof R===ct?(0,Q.createBooleanExpression)(R):R._error?(0,Q.Syt)(R):(Y=new K.Parser).parse(t.source.getParserContext(t.useR1C1,ot(0,0)),R.toString())}catch(t){m=(0,Q.Syt)(nt)}g=m=m===q?n:m}return m}function Tt(t,n,e,F,L,B,P){for(var i,r,o,a,G,U,u,H,s,V,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,z,A,I,I,x,N,Y,Z,A,x,k,_,D,j,O,E,E,_,j,D,O,k,h,v,d,R,W,i=t.row,r=t.column,o=[],a=0,G=t.arrayIdentity?t.arrayIdentity.row:i,U=t.arrayIdentity?t.arrayIdentity.col:r,H=u=0,c=F,f=L,l=s=!(o[a]={expr:n,acceptsArray:B||!1,acceptsRef:P||!1,index:-1});0<=a;){if(h=o[a],a--,d=h.acceptsArray,v=h.acceptsRef,n=h.expr,m=q,n)if(7===n.type){if(A=(z=(T=n).arguments).length,!T.function){if(!t){m=(0,Q.Syt)(at);continue}I=T.functionName,T.function=t.getFunction(I),Ct(T,t)}if(I=T.function,x=h.index,S=h.neeedExpendindexs,x<0?(h.arrayArgumentEvaluateMode=l,h.arrayFormulaCatchValue=e,(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&(l=(0,Q.getFunctionArrayArgumentEvaluateMode)(I)),h.args=[]):((0,Q.getFunctionAcceptsArray)(I,x)?u--:s&&(S||(h.neeedExpendindexs=S=[]),T.arguments[x],S.push(x)),h.args.push(g)),x===A-1){if(l=h.arrayArgumentEvaluateMode,e=h.arrayFormulaCatchValue,Y=!1,(N=h.args)&&0<N.length)for(Z=0;Z<N.length;Z++)if(N[Z]!==T.arguments[Z]){Y=!0;break}m=Y?(0,Q.YJ)(T,N):n,S&&0<S.length&&(m=(0,Q.createExpandExpression)(m,S),s=!0)}else 0===x&&I&&3===(0,Q.getFunctionArrayArgumentEvaluateMode)(I)&&3===l&&(l=0),s=!1,x++,h.index=x,(0,Q.getFunctionAcceptsArray)(I,x)&&u++,o[++a]=h,o[++a]={expr:T.arguments[x],acceptsArray:(0,Q.getFunctionAcceptsArray)(I,x),acceptsRef:(0,Q.getFunctionAcceptsReference)(I,x),index:-1}}else if(1===n.type&&n.hmt())H&&(w=(b=n.source||t.source).getRowCount(),y=b.getColumnCount(),M=n.rowRelative?(n.row+G)%Q.MAX_ROW_COUNT%w:n.row,C=n.columnRelative?(n.column+U)%Q.MAX_COLUMN_COUNT%y:n.column,n=(0,J.knt)(n.source&&b,q,M=M<0?M+w:M,C=C<0?C+y:C,!1,!1));else if(1===n.type||13===n.type){if(13===n.type){if(p=(A=n).getRange(i,r),A.Fwt(i,r,t.source.id),!p){A._error?(delete A._error,m=g=ut,t.n_t=1):g=m=n;continue}n=(0,J.lJ)(A.source===t.source?q:A.source,q,p.row,p.col,p.row+p.rowCount-1,p.col+p.colCount-1)}x=n.source,k=n,H&&(b=x||t.source,w=Q.MAX_ROW_COUNT,y=Q.MAX_COLUMN_COUNT,_=k.rowRelative?(k.row+G)%w:k.row,D=k.columnRelative?(k.column+U)%y:k.column,E=void 0,(j=(j=k.endRowRelative?(k.endRow+G)%w:k.endRow)<0?j+w:j)<(_=_<0?_+w:_)&&(E=_,_=j,j=E),(O=(O=k.endColumnRelative?(k.endColumn+U)%y:k.endColumn)<0?O+y:O)<(D=D<0?D+y:D)&&(E=D,D=O,O=E),(w=b.getRowCount())<=_?(_%=w,j%=w):w<=j&&(j=w-1),(y=b.getColumnCount())<=D?(D%=y,O%=y):y<=O&&(O=y-1),n.row===Q.BAND_INDEX_CONST&&(_=j=Q.BAND_INDEX_CONST),n.column===Q.BAND_INDEX_CONST&&(D=O=Q.BAND_INDEX_CONST),n=(0,J.lJ)(x,n.endSource,_,D,j,O,!1,!1,!1,!1)),P||v&&(d||!e&&1!==l&&3!==l)||i<0||r<0||(0<u&&!e&&1!==l&&3!==l||0===u||2===l?(p=k.getRange(i,r),m=e||(v||d)&&1===l?!k.isFullColumn&&1!==p.rowCount&&c>=p.rowCount||!k.isFullRow&&1!==p.colCount&&f>=p.colCount?(0,Q.Syt)(nt):(M=(k.isFullColumn?0:p.row)+(1===p.rowCount?0:c),C=(k.isFullRow?0:p.col)+(1===p.colCount?0:f),(0,J.knt)(x,n.endSource,M,C,!1,!1)):1<p.rowCount&&1<p.colCount||1<p.rowCount&&!k.isFullColumn&&(i<p.row||i>=p.row+p.rowCount)||1<p.colCount&&!k.isFullRow&&(r<p.col||r>=p.col+p.colCount)?(0,Q.Syt)(tt):(M=k.isFullColumn||1<p.rowCount?i:p.row,C=k.isFullRow||1<p.colCount?r:p.col,(0,J.knt)(x,n.endSource,M,C,!1,!1))):s=!0)}else if(9===n.type)E=(0,Q.gDt)(n.operatorType),_=v&&t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray,-1===h.index?(e&&et(n.value2)&&(E=d=!1),h.index=n.value2?0:1,o[++a]=h,o[++a]=rt(n.value,E||d,E||_,-1)):0===h.index?(g!==n.value&&(m=(0,Q.rbt)(n.operatorType,g,n.value2),h.expr=m),s&&((S=[]).push(0),h.neeedExpendindexs=S,s=!1),h.index=1,o[++a]=h,o[++a]=rt(n.value2,E||d,E||_,-1)):(m=n.value2&&g!==n.value2?(0,Q.rbt)(n.operatorType,n.value,g):et(n.value2)&&g!==n.value?(0,Q.rbt)(n.operatorType,g,$):n,S=h.neeedExpendindexs,s&&(S?S.push(1):S=[n.value2&&n.value2===V?1:0]),S&&(m=(0,Q.createExpandExpression)(m,S),s=!0));else if(10===n.type)-1===h.index?(h.index=0,o[++a]=h,o[++a]=rt(n.value,d,v,-1)):n.value!==g&&(m=(0,Q.Ayt)(g));else if(8===n.type)1===h.index?(n.jwt=$,H--,m=g,h.context&&(t=h.context)):n.jwt||(n.jwt=!0,H++,o[++a]=rt(n,d,v,1,t),D=t,O=j=void 0,n.source?(O=n.source,(D=new X.EvaluateContext(O)).cloneFrom(t),j=O.getCustomName(n.value)):(j=t.getName(n.value),t.source.getCustomName(n.value)||(D=new X.GloableEvaluateContext(t.source)).cloneFrom(t)),j=j||(0,Q.Syt)(at),o[++a]=rt(j,d,v,-1,t=D||t));else if(6===n.type)if(h=(k=n).value,!d&&(0<u||e||1===l||3===l))s=!0,V=n;else if(!d&&0===u)if(v=h.getRowCount(),d=h.getColumnCount(),v<=c&&1<v||d<=f&&1<d)m=(0,Q.Syt)(nt);else if(e||!(t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray))try{1===v&&(c=0),1===d&&(f=0),m=typeof(R=k.value.getValue(c,f))===st?(0,Q.createStringExpression)(R):typeof R===it?(0,Q.createNumberExpression)(R):typeof R===ct?(0,Q.createBooleanExpression)(R):R._error?(0,Q.Syt)(R):(W=new K.Parser).parse(t.source.getParserContext(t.useR1C1,ot(0,0)),R.toString())}catch(t){m=(0,Q.Syt)(nt)}g=m=m===q?n:m}return m}function rt(t,n,e,i,r){return{expr:t,acceptsArray:n,acceptsRef:e,index:i,context:r}}function ot(t,n){return{row:t,col:n}}function A(t,n,e,i){return{row:t,col:n,rowCount:e,colCount:i}}function At(t){return-1===t.row||-1===t.col||t.rowUndefine||t.colUndefine||1<t.rowCount*t.colCount}function It(t,n,e,i,r){i===r||!et(i)&&!et(r)||et(t)||(!et(i)&&et(r)&&t.removeRowAndColInfo(n,e),et(i)&&!et(r)&&t.addRowAndColInfo(n,e))}n=this&&this.__extends||(H=function(t,n){return(H=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}H(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(d,"__esModule",{value:!0}),d.Rwt=d.eV=d.h0t=d.Pyt=d.RangeCalc=d.NameCalc=d.ColumnCalc=d.RowCalc=d.CellCalc=d.CalcSourceModel=d.CalcArrayHelper=d.CalcService=d.PathCalc=d.NameIDCalc=d.BaseCalc=d.supportRowColumnFormula=d.approximatelyEqual=void 0,m=t("Common"),Q=t("./src/calc.common.ts"),J=t("./src/referenceExpression.ts"),K=t("./src/Parser.ts"),X=t("./src/evaluator.ts"),g=t("./src/map.ts"),r=m.Common.ut,C=m.Common.J8,S=m.Common.X8,T=m.Common.zf,w=m.Common.ct,q=null,$=void 0,I=Math.abs,at=Q.Errors.Name,ut=Q.Errors.Reference,tt=Q.Errors.Value,nt=Q.Errors.NotAvailable,x=Q.Errors.Calc,o=Q.Convert.Nh,a=Q.Convert.LE,G=T.Gmt,t=m.Common.lt,et=t.ht,l=Math.min,v={},N="rowSliceListeners",k="nameIDListeners",it="number",st="string",ct="boolean",d.approximatelyEqual=_=function(t,n,e){var i;return!!((t=void 0===t?0:t)===(n=void 0===n?0:n)||r(t,Q.CalcError)&&r(n,Q.CalcError)&&t._code===n._code)||(i=1,r(t,Date)&&r(n,Date)?i=864e5:r(t,Date)?t=w.o0(t):r(n,Date)&&(n=w.o0(n)),I(n-t)/i<e)},d.supportRowColumnFormula=!1,e.prototype.getKey=function(){return""},e.prototype.hasListeners=function(){for(var t,n,e,i,r,o,t,n,e=0,i=this.aT;e<i.length;e++)if((o=this[r=i[e]])&&0<o.size)return!0;return!1},e.prototype.Iwt=function(t,n,e){var t,i,r,o,t=n.e_t?(this.i_t||(this.i_t=(0,g.createMap)()),this.i_t):(this[t]||(this.aT.push(t),this[t]=(0,g.createMap)()),this[t]),i=n.getKey();n.ebt&&1<=n.ebt.length&&(n.e_t||(o=(r=n.ebt)[r.length-1]).push(this),i="?"+i),e?t.set(i,n):t.delete(i)},e.prototype.KDt=function(t,n,e){var i,r,i=this[t],r=n.getKey();r="!"+r,i||(this.aT.push(t),i=this[t]=(0,g.createMap)()),e?i.set(r,n):i.delete(r)},e.prototype.mB=function(){for(var t,n,e,i,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(e=this.aT,i=0;i<e.length;i++)(r=this[e[i]])&&r.forEach(function(t){t&&t.r_t()});this.i_t&&this.i_t.forEach(function(t){t&&t.r_t()})},e.prototype.o_t=function(){for(var t,n,e,i,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(e=this.aT,i=0;i<e.length;i++)(r=this[e[i]])&&r.forEach(function(t){t&&!t.k1&&t.vyt()})},e.prototype.CTe=function(){for(var t,n,e,i,r,t,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r=!1,(t=(i=this)[0])&&t.forEach(function(t){t&&t.k1&&(r=!0)}),r||(null==(t=i.w3.uT())?void 0:t.CTe(i.row,i.column))},e.prototype.STe=function(t){var n,t,n=t?1:-1,t=this[0];t&&t.forEach(function(t){t&&(t.delay+=n)})},e.prototype.a_t=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(r=(i=this).aT,o=(e=t[0])?1:-1,a=t[1],u=0;u<r.length;u++)(s=this[r[u]])&&s.forEach(function(t,n){if("?"===n[0]){if(!e&&i.u_t)for(;0<=i.u_t.indexOf(t);)i.u_t.splice(i.u_t.indexOf(t),1),t.delay--}else t&&(t.delay+=o,e)&&t.s_t&&t.s_t()});if((c=a?a.$bt:i.node&&i.node.$bt)&&c.isDynamicArray)for(f=0;f<c.rowCount;f++)for(l=0;l<c.colCount;l++)0===f&&0===l||(h=i.w3.getNode(f+c.row,l+c.col))&&h.calc&&h.calc.a_t(e)},e.prototype.r_t=function(){},e.prototype.vyt=function(){},e.prototype.CMt=function(){},e.prototype.yB=function(){},e.prototype.c_t=function(){return this.w3.op()},d.BaseCalc=u=e,n(i,V=u),i.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.name},i.prototype.yB=function(){var t=this;t.w3.f_t(t.name,!0)},i.prototype.CMt=function(){var t=this;t.w3.f_t(t.name,!1)},i.prototype.r_t=function(){this.c_t().onAddAdjust(this,3)},i.prototype.vyt=function(){this.c_t().I3(this,3)},D=i,d.NameIDCalc=D,n(s,z=u),s.prototype.getKey=function(){var t=this;return t.w3.getName()+","+t.id+"#"+t.name},s.prototype.yB=function(){var t=this;t.w3.cyt(t.id,t.name,!0)},s.prototype.CMt=function(){var t=this;t.w3.cyt(t.id,t.name,!1)},s.prototype.c_t=function(){return this.w3.Lbt},s.prototype.r_t=function(){this.c_t().onAddAdjust(this,6)},s.prototype.vyt=function(){this.c_t().I3(this,6)},d.PathCalc=s,c.prototype.l_t=function(t,n,e){var i,r,o,i=this;if(i.h_t=i.h_t||{},r=i.h_t[n]=i.h_t[n]||[],e)r.push(t);else for(o=0;o<r.length;o++)r[o]===t&&(r.splice(o,1),o--)},c.prototype.AMt=function(t){var n,n,n=this,n=n.h_t&&n.h_t[t];n&&n.forEach(function(t){t.vyt()})},c.prototype.recalcAfterOperate=function(t){this.AMt(t),this.IsSuspended()||this.recalculateAll(!1)},c.prototype.getResolvers=function(){return this.VDt},c.prototype.addResolver=function(t){for(var n,e,n=this.VDt,e=0;;e++)if(!n[e]||t.priority>n[e].priority){n.splice(e,0,t);break}},c.prototype.dispose=function(){var t=this;t.rO={},t.d_t=q,delete t.calcListener},c.prototype.cloneFrom=function(t){var n=this;n.useR1C1=t.useR1C1,n.HDt=t.HDt,n.v_t=t.v_t,n.calcOnDemand=t.calcOnDemand,n.dynamicReferences=t.dynamicReferences},c.prototype.Hyt=function(){return this.YDt},c.prototype.getExternalSource=function(t,n){for(var e,i,r,o,e,i=this.getAllSourceModels(),r=0,o=i.length;r<o;r++)if(T.Dbt(i[r].getSource().getName(),n))return i[r].getSource();return q},c.prototype.getSourceModel=function(t){var n=this.rO[t.id];return n||(n=t.createSourceModel?t.createSourceModel(this):this.createSourceModel(this,t),this.rO[t.id]=n,t.setCalcSourceModel(n),t.setCalcService(this)),n},c.prototype.getGlobalSourceModel=function(t){return this.d_t||((t=t||new Q.CalcSource).createSourceModel?this.d_t=t.createSourceModel(this):this.d_t=this.createSourceModel(this,t),t.setCalcSourceModel(this.d_t)),this.d_t},c.prototype.setSourceModel=function(t,n){(this.rO[t.id]=n).setCalcService(this)},c.prototype.getAllSourceModels=function(){var t,n,e,t=[],n=this.rO;for(e in n)t.push(n[e]);return t},c.prototype.removeSource=function(t){var n,e,i,r,o,t;for(r in this.suspend(),(n=this.rO[t.id])&&(""!==t.getName()&&this.onRemoveSource(t),delete this.rO[t.id]),this.clearDirties(),e=this.rO)(i=e[r]).Bde(!1);o=this.x3&&this.x3.Mf,t=t&&t.Mf,o&&t&&t===o&&(this.x3=null),this.resume(!1)},c.prototype.clearSource=function(){this.rO={},this.x3=null,this.clearDirties()},c.prototype.ignoreDirty=function(){return this.v_t},c.prototype.suspend=function(t){this.HDt++,this.v_t=!!t},c.prototype.resume=function(t,n,e,i){var r=this;r.HDt--,r.HDt<0&&(r.HDt=0),r.IsSuspended()||(r.m_t=q,r.v_t=!1,r.recalculateAll(t,n,i,e))},c.prototype.suspendAdjust=function(){this.zDt++},c.prototype.resumeAdjust=function(){var t=this;t.zDt--,t.zDt<0&&(t.zDt=0)},c.prototype.isAdjustSuspended=function(){return 0<this.zDt},c.prototype.clearDirties=function(t){var n,e,i,r,o,a,u,n=this,e=n.y3,i=n.Kyt;if(e){for(o in r=!1,e)if(e.hasOwnProperty(o))if(t&&t[o])r=!0;else{for(a=e[o];a;)u=a.C3,a.k1=!1,a=u?(a.C3=u.DF=$,u):q;delete e[o],i&&!et(i[o])&&delete i[o]}r||(n.y3=n.Kyt=q)}},c.prototype.Zct=function(){this.ZDt.WDt=!1,this.ZDt={WDt:!0}},c.prototype.resumeWithoutCalc=function(){this.HDt--,this.HDt<0&&(this.HDt=0),this.clearDirties({3:!0,6:!0}),this.v_t=!1,this.AMt(1),this.y3&&this.recalculateAll(!1,!0),this.Zct()},c.prototype.IsSuspended=function(){return 0<this.HDt},c.prototype.Ude=function(t){var n,e,i,r,n=this;for(r in n.RE=Date.now(),n.S9t=new Q.Functions.RangeCriteriaManager,n.MX.startCache(t),i=n.rO)(e=i[r]).getSource().startCalculation()},c.prototype.Hde=function(t){var n,e,i,r,n=this,i=n.rO;for(r in i)(e=i[r]).getSource().endCalculation(t);n.MX.endCache(),n.S9t.dispose(),this.Zct(),delete n.RE},c.prototype.recalculateAll=function(t,n,e,i){var r,t,r=this;!i&&1===r.calculationMode||r.IsSuspended()||(r.PE=!0,t&&r.y3&&delete r.tMt,r.Ude(n),t=r.zde(t,n,i)||[],r.Vde(i),r.Hde(e),delete r.PE,r.p_t&&(r.p_t.forEach(function(t){t[0].gF(t[1].row,t[1].col,t[1].rowCount,t[1].colCount)}),r.Ude(!0),t=t.concat(r.zde(!1,!0,i)),r.Vde(i),r.Hde(e),delete r.p_t),t&&t.forEach(function(t){r.I3(t,0)}))},c.prototype.MTe=function(){var e,i,t,n,r,o,a,u,s,c,f,l,h,d,e=this;if(e.Zct(),i={},e.y3)for(t in e.y3)if(e.y3.hasOwnProperty(t))for(i[t]=[],n=e.y3[t];n;)i[t].push(n),n=n.C3;if(e.zde(!0,!1),!(r=e.y3))return[];for(t in r)r.hasOwnProperty(t)&&r[t].w3.initDelay(e,parseInt(t,10));for(o=r[0];o;o=o.C3)a=o.row,u=o.column,o.STe(!0),(s=o.w3.uT(!1))&&s.a_t(a,u,!0);do{if(f=!1,r[0])for(o=r[0];o;o=c)c=o.C3,o.delay<=0&&(a=o.row,u=o.column,e.b_t(o,0),o.STe(!1,null),(s=o.w3.uT(!1))&&s.a_t(a,u,!1),f=!0)}while(f);do{if(f=!1,r[0])for(o=r[0];o;o=c)c=o.C3,o.CTe()||(e.b_t(o,0),f=!0)}while(f);if(l=[],r[0])for(n=e.y3[0];n;)l.push({row:n.row,col:n.column,rowCount:1,colCount:1,sheetName:n.w3.getSource().getName()}),n=n.C3;if(i)for(d in h=function(t){var n;i[t]&&(n=parseInt(t,10),i[t].forEach(function(t){e.I3(t,n)}))},i)h(d);return e.Zct(),l},c.prototype.zde=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,i=this;if(!1!==t||!n)for(o in r=i.rO)r[o].Bde(t,n);if(a=i.y3){if(i.calcOnDemand||!1!==t||i.w_t(),a[1]&&a[1].w3.addListenersToDirty(i,1),a[2]&&a[2].w3.addListenersToDirty(i,2),!1===t){for(u in a)a.hasOwnProperty(u)&&(s=a[u])&&(s.w3.addListenersToDirty(i,parseInt(u,10)),s.processed=!0);for(u in a)a.hasOwnProperty(u)&&((s=a[u]).processed?delete s.processed:s.w3.addListenersToDirty(i,parseInt(u,10)))}if(c=[],"function"==typeof e)for(f=a[0],l=void 0,c=[];f;)l=f.C3,e(f)||(c.push(f),i.b_t(f,0)),f=l;return i.calcListener&&a[0]&&(h=i.kle(a[0]),i.calcListener(h)),c}},c.prototype.processDynamicRef=function(){var n,t,e,i,r,o,a,u,s,c,n=this;if(n.tMt){if(e=null,t=n.y3)for(e=[],i=void 0,r=t[0];r;r=i)e.push(r),i=r.C3;for(a in o=n.rO)(u=o[a]).Bde(!0,!1);if(t=n.y3)for(i=void 0,r=t[0];r;r=i)i=r.C3,n.b_t(r,0);for(s in n.tMt)n.tMt.hasOwnProperty(s)&&(c=n.tMt[s],u=n.rO[c.id])&&u.processDynamicListenerForCell(c.row,c.col);delete n.tMt,e&&0<e.length&&e.forEach(function(t){n.I3(t,0)}),this.Zct()}},c.prototype.w_t=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,o,i,g,t=this,n,e=t.y3[0];e;e=e.C3)e.isVolatile&&(i=e.row,r=e.column,a=(o=e.w3).rT,s=!0,(u=o.M_t(i,r)||o.ODt(i,r))&&(c=ot(i,r),f=a.getValue(i,r),l=!1,m=v=d=h=$,(o=o.sT(i,r))&&!0!==o.isDynamicArray&&(l=!0,h=o.row,d=o.col,v=o.rowCount,m=o.colCount),i=t.evaluateParsedFormula(a,u,c,l,!0,o&&!0!==o.isDynamicArray&&A(h,d,v,m),t.allowDynamicArray),e.QDt||e.qkt||(f===i?s=!1:f instanceof Date?(i instanceof Date&&f.valueOf()===i.valueOf()||typeof i===it&&(g=w.o0(f))===i)&&(s=!1):typeof f===it&&typeof i===it&&(s=f!==i))),u)&&!s&&t.b_t(e,0)},c.prototype.kle=function(t){for(var n=0;t;)n++,t=t.C3;return n},c.prototype.Vde=function(t){var n,e,i,r,o,n=this;if((!n.calcOnDemand||t)&&(e=n.y3)){for(i in e)e.hasOwnProperty(i)&&e[i].w3.initDelay(n,parseInt(i,10));for(i in e)e.hasOwnProperty(i)&&e[i].w3.adjustDelayOfListeners(n,parseInt(i,10),!0);do{for(i in r=!1,e)e.hasOwnProperty(i)&&(o=e[i].w3.calculateDirtyNodes(n,parseInt(i,10)))&&(r=!0)}while(r);for(i in e)e.hasOwnProperty(i)&&e[i].w3.calculateIterations(n,parseInt(i,10));n.clearDirties(),n.y3=n.Kyt=$}},c.prototype.initParserContext=function(t){var n;this.x3||(this.x3=t.getParserContext(this.useR1C1))},c.prototype.getParserContext=function(t){var n,e,n=this,e=n.x3;return e||(t?n.x3=e=t.getParserContext(n.useR1C1):e=new K.ParserContext(q,n.useR1C1)),e.setSource(t),e},c.prototype.parseWithContext=function(t,n){return this.j3t.parse(t,n)},c.prototype.unparseWithContext=function(t,n){return this.j3t.unparse(t,n)},c.prototype.I3=function(t,n){var e,e,i,r,r,o,e=this;isNaN(n)||!t||t.k1||(!e.Vct||0!==n||(r=e.h_t&&e.h_t[e.Vct])&&0<=r.indexOf(t))&&(r=e.y3,o=e.Kyt,r||(r=e.y3={},o=e.Kyt={}),e=r[n],i=o[n],t.k1=!0,e?i.C3=t:r[n]=t,t.DF=i,t.C3=q,o[n]=t)},c.prototype.b_t=function(t,n){var e,i,e,r,o,e=this;!isNaN(n)&&t&&t.k1&&(t.k1=!1,i=e.y3,e=e.Kyt,r=t.DF,o=t.C3,r?r.C3=o:i&&(o?i[n]=o:delete i[n]),o?o.DF=r:e&&(r?e[n]=r:delete e[n]),t.DF=q,t.C3=q)},c.prototype.evaluateExpression=function(t,n,e,i,r){var o;return this.MX.evaluateExpression(n,t.getEvaluatorContext(e,!1,void 0,n),!1,i,r)},c.prototype.onClearExpr=function(t,n){this.MX&&this.MX.asyncManager.clearCell(t,n)},c.prototype.parse=function(t,n,e,i,r,o,a,u){var s,c,t,f,a,s=this,c=s.m_t,t=s.getParserContext(t);return t.useR1C1=!a&&s.useR1C1,t.ignoreError=o,t.keepUnknownFormulas=u,t.row=e,t.column=i,t.culture=r,c?(f=c[n])||(a=s.j3t.parse(t,n),c[n]=a):s.j3t.parse(t,n)},c.prototype.unparse=function(t,n,e,i,r,o,a){var t,e,t=this.getParserContext(t);return t.useR1C1=this.useR1C1,t.row=e,t.column=i,t.culture=r,t.addSheetName=a,o&&(t.lyt=!0,t.useR1C1=!1),e=this.j3t.unparse(t,n),t.lyt=!1,e},c.prototype.recalculate=function(t,n,e,i){var t,r,i,t=this.getSourceModel(t),r=this;-1===e?t.gF(n,0,1,t.cC()):-1===n?t.gF(0,e,t.rC(),1):t.Gde(n,e),this.IsSuspended()||(this.recalculateAll(!1,i),i&&1===r.calculationMode&&!r.IsSuspended()&&(i=t.oT(n,e),t.recalculateCell)&&i instanceof u&&t.recalculateCell(i))},c.prototype.recalculateByName=function(t,n){var e,t;n&&(t=(e=this.getSourceModel(t)).C_t(G(n),!0),this.I3(t,3),this.IsSuspended()||this.recalculateAll(!1))},c.prototype.recalcRange=function(t,n,e,i,r){var t=this.getSourceModel(t);-1===e?t.gF(n,0,i,t.cC()):-1===n?t.gF(0,e,t.rC(),r):t.gF(n,e,i,r),this.IsSuspended()||this.recalculateAll(!1)},c.prototype.evaluate=function(t,n,e,i,r){var o,n,o=this,n=n instanceof Q.Expression?n:o.parse(t,n,e,i);return o.MX.evaluateExpression(n,t.getEvaluatorContext(ot(e,i),!1,void 0,n),!1,r,r)},c.prototype.Abt=function(t,n,e,i,r){var o,a,u;if(!et(n)){if(o=this.MX,(a=r)||((a=t.getEvaluatorContext(e,!1,q,n)).S_t=i),o.asyncManager.startCalcCell(t,e),u=this.MX.evaluateExpression(n,a,i,!0,!0),o.asyncManager.endCalcCell(),!r)return new Promise(function(t,n){o.asyncManager.T_t(e.Tbt)?a.A_t=t:t(u)}).then(function(t){return o.asyncManager.I_t(e.Tbt),t});o.asyncManager.x_t(e.Tbt)&&a.A_t(u)}},c.prototype.evaluateParsedFormula=function(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,t,o,e,s,u,v,m,g,t,e,n;if(!et(n)){if(f=e.row||0,l=e.col||0,h=o?o.row:f,d=o?o.col:l,(t=t.getEvaluatorContext(e,i,o,n,s)).N_t=u,e=4===arguments.length&&i||a,this.allowDynamicArray&&!i&&(t.k_t=!n.ensureSingle),(o=this.MX.evaluateExpression(n,t,r,e&&!n.ensureSingle,e&&!n.ensureSingle,c))&&o.pause)return o;if(i&&arguments.length<=5)return o;if(!i&&a&&(Q.Convert.LE(o)||Q.Convert.Nh(o)))return o;if(Q.Convert.LE(o)){if(s=o.getRowCount(0),u=o.getColumnCount(0),1!==o.getRangeCount())return tt;try{if(v=i?f-h:f-o.getRow(0),m=i?l-d:l-o.getColumn(0),g=ot(0,0),1!==s||1!==u)if(1===s&&1<u&&0<=m&&m<u)g.col=m;else if(1<s&&1===u&&0<=v&&v<s)g.row=v;else{if(!(i&&v<s&&m<u))return i?nt:tt;g.row=v,g.col=m}o=o.getValue(g,0)}catch(t){return tt}}else if(Q.Convert.Nh(o))if(i){if(e=(t=o).getRowCount(),n=t.getColumnCount(),1!==e&&e<=f-h||1!==n&&n<=l-d)return nt;o=o.getValue(1===e?0:f-h,1===n?0:l-d)}else o=o.getValueByIndex(0);return o!==$&&o!==q||!1===r?o:0}},c.prototype.onAddAdjust=function(t,n){this.YDt.Qyt(t,n)},c.prototype.onRemoveSource=function(t){this.YDt.nwt(t)},c.prototype.createSourceModel=function(t,n){return new R(t,n)},d.CalcService=c,dt.getLength=function(t,n){return o(t)?t.getRowCount()*t.getColumnCount():a(t)?t.getRowCount(n=n||0)*t.getColumnCount(n):void 0},dt.getRowCount=function(t,n){return o(t)?t.getRowCount():a(t)?t.getRowCount(n=n||0):void 0},dt.getColumnCount=function(t,n){return o(t)?t.getColumnCount():a(t)?t.getColumnCount(n=n||0):void 0},dt.getValueByIndex=function(t,n,e){var i;return o(t)?t.getValueByIndex(n):a(t)?(i=t.getColumnCount(e=e||0),t.getValue(e,parseInt((n/i).toString(),10),n%i)):void 0},dt.getValue=function(t,n,e,i){return o(t)?t.getValue(n,e):a(t)?t.getValue(i=i||0,n,e):void 0},d.CalcArrayHelper=dt,f.prototype.getNode=function(t,n,e){var i,r,o,i=this,r=q;return 0<=t&&0<=n?(o=i.dataTable[t],e&&!o&&(o=i.dataTable[t]={},t>i.I8)&&(i.I8=t),o&&(r=o[n],e)&&!r&&(r=o[n]={},n>i.x8)&&(i.x8=n)):-1===t&&0<=n?(r=i.IE[n],e&&!r&&(r=i.IE[n]={},n>i.x8)&&(i.x8=n)):0<=t&&-1===n?(r=i.AE[t],e&&!r&&(r=i.AE[t]={},n>i.x8)&&(i.x8=n)):-1===t&&-1===n&&(r=i.xE,e)&&!r&&(r=i.xE={}),r},f.prototype.getNodeByName=function(t,n){var e,i,e=this,i=e.dataTableByName[t];return i=n&&!i?e.dataTableByName[t]={}:i},f.prototype.pB=function(t,n){var t=this.getNode(t,n);return t&&t.WK},f.prototype.Fyt=function(t,n){var t=this.getNode(t,n);return t&&t.eyt},f.prototype.sT=function(t,n){return this.getWorkingNodeInfo(t,n,2)},f.prototype.M_t=function(t,n){return this.getWorkingNodeInfo(t,n,1)},f.prototype.ODt=function(t,n,e){return this.getWorkingNodeInfo(t,n,0,e)},f.prototype.D_t=function(t){var t=this.getNodeByName(t);return t&&t.eyt},f.prototype.$yt=function(t){var t=this.getNodeByName(t);return t&&t.WK},f.prototype.Ile=function(t,n){var t=this.getNode(t,n);return t&&t.xle},f.prototype.Nle=function(t,n,e,i){var r=this.oT(t,n,!!e);r&&(i&&i.push([t,n,r.isDefault()]),r.isDefault(!!e))},f.prototype.clearAll=function(){var t=this;t.clear(-1,-1,-1,-1),t.dataTable={},t.dataTableByName={},t.AE=[],t.IE=[],t.xE=q},f.prototype.clear=function(t,n,e,i,r,o){this.d5(t,n,e,i,r,o)},f.prototype._Mt=function(){var t=this;Mt(t.AE),Mt(t.IE),Mt(t.dataTable,!0),Mt(t.dataTableByName),t.DMt()},f.prototype.DMt=function(){var t=this;t.dataTable={},t.dataTableByName={},t.AE=[],t.IE=[],t.xE=q,t.XDt=[],t.qDt=[],t.__t=q,t.E_t=q},f.prototype.addRows=function(t,n){var e,i,r,e=this,i=e.rC();if(!(t<0||i<t||n<0))for(C(e.dataTable,i,t,n),C(e.AE,i,t,n),r=0;r<n;r++)e.dataTable[t+r]&&(e.dataTable[t+r]={rs:"n"})},f.prototype.deleteRows=function(t,n,e){var i,r,i=this,r=i.rC();e&&(r+=n),t<0||r<=t||n<=0||(S(i.dataTable,r,t,n=r<t+n?r-t:n),S(i.AE,r,t,n))},f.prototype.rge=function(t,n){t<n&&this.d5(t,-1,n-t,-1)},f.prototype.addColumns=function(t,n){var e,i,r,o,a,e=this,i=e.rC(),r=e.cC();if(!(t<0||r<t||n<0)){for(o=0;o<i;o++)(a=e.dataTable[o])&&t<r&&C(a,r,t,n);C(this.IE,r,t,n)}},f.prototype.deleteColumns=function(t,n,e){var i,r,o,a,u,i=this,r=i.rC(),o=i.cC();if(e&&(o+=n),!(t<0||o<=t||n<0)){for(a=0;a<r;a++)(u=this.dataTable[a])&&S(u,o,t,n);S(this.IE,o,t,n)}},f.prototype.oge=function(t,n){t<n&&this.d5(-1,t,-1,n-t)},f.prototype.j_t=function(t,n,e){var i,e,r,o,o,i=[t,n];return e&&(i.newValue=e),e=this.getSource(),(r=this.getNode(t,n))?((o=r.$bt)&&(o.row!==t||o.col!==n)||e.setFormula(t,n,this.getFormula(t,n),o,!0),o=r.calc&&r.calc.isDefault&&r.calc.isDefault(),i.push(r.WK,r.eyt,r.$bt,o)):e.setFormula(t,n,null,null,!0),i},f.prototype.Vyt=function(t,n,e,i){t&&t.push(this.j_t(n,e,i))},f.prototype.pj=function(){var t=this.getSource(),t=t&&t.getSheet(),t=t&&t.Ut;return t&&t.pj()},f.prototype.kMt=function(t,n,e,i,r,o){var a,u,a=this;-1===t?a.iwt(n,e,i):-1===n?a.ewt(t,e,i):(u=a.rT.Mf,o&&u&&(u.vle=!0),a.Gyt(t,n,e,i,r),o&&u&&delete u.vle)},f.prototype.bB=function(t,n,e,i){var r=this.getNode(t,n,!!e);r&&(i&&i.push([t,n,r.WK]),r.WK=e)},f.prototype.O_t=function(t,n,e,i,r,o,a,u){var s=this.getNode(t,n,!!e);s&&(this.Vyt(a,t,n),s.WK=e,(s.eyt||i)&&(s.eyt=i),(s.$bt||r)&&(s.$bt=r),s.isVolatile&&!e?this.R_t(s):(o||s.isVolatile)&&(s.isVolatile=o),u)&&(s.xle=u)},f.prototype.zyt=function(t,n,e){this.O_t(t,n,$,$,$,!1,e)},f.prototype.Lyt=function(t,n,e,i,r,o){var n=this.getNode(n,e);n&&n.WK&&t.O_t(i,r,n.WK,n.eyt,n.$bt,n.isVolatile,o,n.calc&&n.calc.isDefault&&n.calc.isDefault())},f.prototype.B_t=function(t,n){var t=this.dataTable[t];return t&&t[n]},f.prototype.Yyt=function(t,n,e){var t=this.getNode(t,n,!!e);t&&(t.eyt=e)},f.prototype.Uyt=function(t,n,e){var t=this.getNode(t,n,!!e);t&&(t.$bt=e)},f.prototype.rwt=function(t,n){var t=this.getNode(t,n);return t&&t.calc},f.prototype.L_t=function(t,n,e){var t=this.getNode(t,n,!0);t&&(t.calc&&t.calc.isVolatile&&this.R_t(t),t.calc&&t.calc.isPivotData&&this.F_t(t),t.calc=e)&&(e.node=t)},f.prototype.owt=function(t,n,e){var t=this.getNode(t,n,!0);t&&t.calc&&(t.calc.isVolatile&&this.R_t(t),t.calc.isPivotData&&this.F_t(t),this.Lbt.b_t(t.calc,e),t.calc=$)},f.prototype.P_t=function(t,n,e,i,r){var o,a,u,s,o=this,a=o.usedRange;0<=e&&0<=i?(s=(u=(u=o.dataTable[e])||(o.dataTable[e]={}))[i],(u[i]=r)&&r.calc&&(r.calc.isDefault&&r.calc.isDefault()&&(r.xle=!0),delete r.calc),a&&It(a,e,i,s,r)):0<=e&&-1===i&&0<=t&&-1===n?o.AE[e]=r:0<=i&&-1===e&&0<=n&&-1===t&&(o.IE[i]=r)},f.prototype.SE=function(t,n,e,i){var r,o,a,r=this,o=r.getNode(t,n),a=r.getNode(e,i);o&&o.WK?r.P_t(t,n,e,i,o):a&&a.WK&&r.P_t(t,n,e,i,q),a&&a.WK?r.P_t(e,i,t,n,a):o&&o.WK&&r.P_t(e,i,t,n,q)},f.prototype.G_t=function(t,n,e){t.rbe||(t.rbe={},this.$Dt.push(t),n)||ht(t,e)},f.prototype.U_t=function(t){delete t.rbe},f.prototype.H_t=function(){for(var t,n,e,i,r,o,t=this,n=[],e={},i=t.$Dt,r=t.$Dt.length,o=0;o<r;o++)i[o].rbe&&i[o].rbe!==e&&(i[o].rbe=e,n.push(i[o]));return t.$Dt=n,t.$Dt},f.prototype.lwt=function(){return this.XDt},f.prototype.z_t=function(){return this.qDt},f.prototype.nbt=function(t){t.isVolatile||(t.isVolatile=!0,this.XDt.push(t))},f.prototype.V_t=function(t){t.isPivotData||(t.isPivotData=!0,this.qDt.push(t))},f.prototype.R_t=function(t){var t,n,e,i,r;if(t.isVolatile=$,(t=this).t_t++,100<t.t_t){for(t.t_t=0,n=[],e=t.XDt,i=t.XDt.length,r=0;r<i;r++)e[r].isVolatile&&n.push(e[r]);t.XDt=n}},f.prototype.F_t=function(t){var t,n,e,i,r;for(t.isPivotData=$,n=[],e=(t=this).qDt,i=t.qDt.length,r=0;r<i;r++)e[r].isPivotData&&n.push(e[r]);t.qDt=n},f.prototype.getCalcService=function(){return this.Lbt},f.prototype.setCalcService=function(t){this.Lbt=t},f.prototype.op=function(){return this.Lbt},f.prototype.getSource=function(){return this.rT},f.prototype.hasFormula=function(t,n,e){return t=t!==$?t:-1,n=n!==$?n:-1,!!this.ODt(t,n,e)},f.prototype.setFormula=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,o,l,d,v,c=this;if(e&&0===e.length&&(e=q),f=s&&e&&!i,r||f||!c.EF(t,n,1,1)||c.Y_t(),l=c.getFormula(t,n,$,!0),h=c.sT(t,n),o||l!==e&&(""!==l||e)&&(l||""!==e)||l===e&&h){if(o=c.op(),l=q,o)try{d=0<=t?t:0,v=0<=n?n:0,l=i||(e?o.parse(c.rT,e,d,v,!1,r,$,s):q),c.SB(t,n,l,$,!1,a,u)}catch(t){if(!r&&!f)throw t}0<=t&&0<=n&&c.rT.setFormula(t,n,e,$)}},f.prototype.getFormula=function(t,n,e,i){var r,i,o,r=this.op();return r&&(i=this.ODt(t,n,i))?(t=(o=this.sT(t,n))&&!0!==o.isDynamicArray?o.row:t,n=o&&!0!==o.isDynamicArray?o.col:n,r.unparse(this.rT,i,t,n,e)):q},f.prototype.setFormulaByName=function(t,n,e,i,r){var o,a,a,u;if(t&&(t=G(t),n&&0===n.length&&(n=q),(a=(o=this).getFormulaByName(t))!==n)&&(""!==a||n)&&(a||""!==n)){if(a=o.op(),u=q,a)try{u=n?a.parse(o.rT,n,0,0,!1,e):q,o.twt(t,u,$,!1,i,r)}catch(t){if(!e)throw t}o.rT.setFormula({name:t},n)}},f.prototype.getFormulaByName=function(t){var n,t,n=this.op();return n&&t&&(t=this.$yt(G(t)))?n.unparse(this.rT,t,0,0):q},f.prototype.Y_t=function(){throw(0,Q.sR)().Exp_ArrayFormulaPart},f.prototype.rC=function(){return l(this.rT.getRowCount())},f.prototype.cC=function(){return l(this.rT.getColumnCount())},f.prototype.setArrayFormula=function(n,e,i,r,t,o,a,u,s){var c,f,l,h,d,v,m,h,t,c=this;if(t&&0===t.length&&(t=q),!c.rT.G3&&c.EF(n,e,i,r)&&c.Y_t(),n=n<0?0:n,e=e<0?0:e,l=c.op()){if(l.suspend(),c.d5(n,e,i,r,a),t){try{l.forceR1C1Formula?(h=l.useR1C1,l.useR1C1=!0,f=t?l.parse(c.rT,t,n,e,!1,o,!1):q,l.useR1C1=h):f=t?l.parse(c.rT,t,n,e,!1,o,o):q}catch(t){if(o)return;throw t}for(d=n;d<n+i;d++)for(v=e;v<e+r;v++)c.SB(d,v,f,A(n,e,i,r),!1,a,u,s)}0<=n&&0<=e&&c.rT.setArrayFormula(n,e,i,r,l.unparse(c.rT,f,n,e)),(h=(m=c.rT).t8)&&h.Fgt(n,e,i,r),l.resume(!(t=function(t){return t.w3===c&&t.row>=n&&t.row<n+i&&t.column>=e&&t.column<e+r}),$,t,!1)}},f.prototype.getWorkingNodeInfo=function(t,n,e,i){var r,o,a,r=this,a=r.rT;return t>=a.getRowCount()||n>=a.getColumnCount()?o:(0<=t&&0<=n?(!(o=!(o=r.getNode(t,n))||0===e&&!o.WK||1===e&&!o.eyt||2===e&&!o.$bt?r.getNode(t,-1):o)||0===e&&!o.WK||1===e&&!o.eyt||2===e&&!o.$bt)&&(o=r.getNode(-1,n)):o=0<=t&&-1===n?r.getNode(t,-1):-1===t&&0<=n?r.getNode(-1,n):r.getNode(-1,-1),i&&o&&o.calc&&o.calc.isDefault&&o.calc.isDefault()?void 0:o&&(0===e&&o.WK||1===e&&o.eyt||2===e&&o.$bt))},f.prototype.SB=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,v,f,l,m,c,g,v,c,p,v,i,h=this,d=h.op();d.Z_t&&d.MX.asyncManager.endCalcCell(),f=(v=i!==$&&null!==i)?i.row:t,l=v?i.col:n,m=h.rT,c=new X.EvaluateContext(m,ot(f,l),v),e&&e.sMt||(g=d.allowDynamicArray?Tt(c,e,v,v?t-i.row:0,v?n-i.col:0,!0,!0):St(c,e,v,v?t-i.row:0,v?n-i.col:0),(v=c.n_t)&&(delete c.n_t,1===v)&&(c=d.unparse(m,e,f,l),e=d.parse(m,c,f,l)),(g=g===e?$:g)&&(g.ensureSingle=e.ensureSingle),et(g)&&!et(e&&e.aMt)&&(e.sMt=!0)),i!==$&&(p=i),0<=t&&0<=n?(r!==$&&!r||(v=e?d.unparse(m,e,t,n):$,m.setFormula(t,n,v,p),s)||null==(c=h.oT(t,n))||!c.isDefault()||null==(l=null==(f=m.Mf)?void 0:f.Ut)||l.setDefaultValue(t,n,v,q,"expr",q,!0),h.Gyt(t,n,e,g,p,o,a)):0<=t&&-1===n?h.ewt(t,e,g,o,a):-1===t&&0<=n&&h.iwt(n,e,g,o,a),d.IsSuspended()||(1===d.calculationMode?(i=h.oT(t,n),h.recalculateCell(i),h.lge(i,h),h.Lbt.b_t(i,0)):d.recalculateAll(!1,void 0,u))},f.prototype.twt=function(t,n,e,i,r,o){var a,u,s,c,i,f,a=this,u=a.op(),s,c=Tt(new X.EvaluateContext(a.rT,ot(0,0),!1),n,!1,0,0);c=c===n?$:c,i!==$&&!i||r||(i=a.getFormulaByName(t),f=n?u.unparse(a.rT,n,0,0):$,a.rT.setFormulaByName&&a.rT.setFormulaByName(t,f,i)),a.W_t(t,n,c,null,o),r||u.recalculateAll(!1)},f.prototype.getRowExpression=function(t){return this.pB(t,-1)},f.prototype.getColumnExpression=function(t){return this.pB(-1,t)},f.prototype.W_t=function(t,n,e,i,r){var o,a,u,o,a=this.C_t(t,!0);a&&(r||a.CMt(),(u=this.getNodeByName(t,!0)).WK=n,i&&(i[0].push("dataTable",t),i[1]=u.WK),e=n&&e?e:$,u.eyt=e,r||a.yB(),a.vyt())},f.prototype.Gyt=function(t,n,e,i,r,o,a){var u,s,c,o,u,u,s=this,c=s.oT(t,n,!0);c&&(s.Vyt(o,t,n),u=null==(u=(o=s.rT).Mf)?void 0:u.vle,c.isDefault(!!u),(u=s.Lbt).onClearExpr(o,ot(t,n)),gt(u,c,c.QDt,!1),delete c.QDt,delete c.qkt,c.CMt(),s.bB(t,n,e),e?((i||s.Fyt(t,n))&&s.Yyt(t,n,i),r&&!0===r.isDynamicArray||s.Uyt(t,n,r)):(s.Yyt(t,n,$),s.Uyt(t,n,$)),s.cMt||c.yB(),c.vyt())},f.prototype.ewt=function(t,n,e,i,r){var o,a,o=this,a=o.cwt(t,!0);a&&(o.Vyt(i,t,-1),r||a.CMt(),o.bB(t,-1,n),(e||o.Fyt(t,-1))&&o.Yyt(t,-1,e),r||a.yB(),a.vyt())},f.prototype.iwt=function(t,n,e,i,r){var o,a,o=this,a=o.uwt(t,!0);a&&(o.Vyt(i,-1,t),r||a.CMt(),o.bB(-1,t,n),(e||o.Fyt(-1,t))&&o.Yyt(-1,t,e),r||a.yB(),a.vyt())},f.prototype.d5=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,d,m,g,p,b,a=this,u=t<0?0:t,s=n<0?0:n,c,f,l=u+(t<0?a.rC():e)-1,h=s+(n<0?a.cC():i)-1,m=function(t,n){var e,e;o&&(e=a.oT(t,n))&&e.isDefault()||(d=a.Fyt(t,n),v=a.pB(t,n),(d||v)&&(e=(d=a.sT(t,n))&&!0!==d.isDynamicArray?A(d.row,d.col,d.rowCount,d.colCount):$,a.SB(t,n,q,e,!0,r)))},g=a.usedRange,p=u;p<=l&&0<=p;p++)if(a.dataTable[p])for(n<0&&(m(p,-1),g)&&g.removeRowAndColInfo(p,-1),b=s;b<=h&&0<=b;b++)p===u&&t<0&&(m(-1,b),g)&&g.removeRowAndColInfo(-1,b),m(p,b),g&&g.removeRowAndColInfo(p,b);t<0&&n<0&&m(t,n)},f.prototype.EF=function(t,n,e,i){return this.mMt(t,n,e,i,!0,!0)},f.prototype.mMt=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,a=this,u=t<0?0:t,s=n<0?0:n,c=t<0?a.rC():e,f=n<0?a.cC():i,l=u+(0===c?1:c)-1,h=s+(0===f?1:f)-1,d=!1,v=[],m=[],b=a.dataTable,w=u;w<=l&&0<=w&&!(w>a.I8);w++)if(p=b[w])for(y=s;y<=h&&0<=y&&!(y>a.x8);y++)if(g=p[y])if(C=void 0,(M=g.$bt)&&!M.isDynamicArray){if(M.row<u||M.row+M.rowCount-1>l||M.col<s||M.col+M.colCount-1>h){if(r)return S=M.row===t&&0===e,T=M.col===n&&0===i,!S&&!T;d=!0}w!==M.row&&w!==u||(v.push(A(M.row,M.col,M.rowCount,M.colCount)),C=g.WK,m.push(C),y=M.col+M.colCount-1)}else o||(C=g.WK)&&(v.push({row:w,col:y}),m.push(C));return!r&&{hasPart:d,ranges:v,formulas:m}},f.prototype.getCalcObj=function(){for(var t,n,e,i,r,o,a,u,s,c,f,l,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(i=t[1],r=this,o=(e=t[0]).row,a=e.column,u=null,isNaN(o)||isNaN(a))e.name&&(u=r.C_t(e.name,i));else if(0<=o&&0<=a)if(e.hmt())u=r.oT(o,a,i);else for(s=e.endRow,c=e.endColumn,u=[],f=o;f<=s;f++)for(l=a;l<=c;l++)u.push(r.oT(f,l,i));else 0<=o?u=r.cwt(o,i):0<=a&&(u=r.uwt(a,i));return u},f.prototype.C_t=function(t,n){var e,i,r,e=this,i=q,r=e.getNodeByName(t,n);return r&&!(i=r.calc)&&n&&(i=new D(e,t),(r.calc=i).node=r),i},f.prototype.MMt=function(t){var n,e,i,r,n=this.dataTable;for(e in n)for(i in n[e])(r=n[e][i])&&r.calc&&t(r.calc)},f.prototype.oT=function(t,n,e){var i,r,o,a,o,i=this,r=q;if(0<=t&&0<=n){if(!(a=(o=i.dataTable)[t])){if(!e)return r;a=o[t]={},t>i.I8&&(i.I8=t)}if(!(o=a[n]))return e&&(o=a[n]={},r=new U(i,t,n),(o.calc=r).node=o,n>i.x8)&&(i.x8=n),r;!(r=o.calc)&&e&&(r=new U(i,t,n),(o.calc=r).node=o,t>i.I8&&(i.I8=t),n>i.x8)&&(i.x8=n)}return r},f.prototype.cwt=function(t,n){var e,i,e=this,i=q;return 0<=t&&!(i=e.rwt(t,-1))&&n&&(i=new F(e,t),e.L_t(t,-1,i),t>e.I8)&&(e.I8=t),i},f.prototype.uwt=function(t,n){var e,i,e=this,i=q;return 0<=t&&!(i=e.rwt(-1,t))&&n&&(i=new L(e,t),e.L_t(-1,t,i),t>e.x8)&&(e.x8=t),i},f.prototype.uT=function(t){var n=this;return!n.__t&&t&&(n.__t=new P(n)),n.__t},f.prototype.vwt=function(t,n){var e,i,e=this;return t=G(t),e.E_t||(e.E_t={}),i=!(i=e.E_t[t])&&n?e.E_t[t]=new B(e,t):i},f.prototype.updateNameCalc=function(t,n){var t=this.vwt(G(t));t&&(t.updateListening(!0,n),t.vyt())},f.prototype.Q_t=function(t,n){for(var e,i,r,o,e=this,i=l(e.x8,t+n-1),r=t;-1!==r&&r<=i;r++)e.isEmpty(-1,r)&&(o=e.uwt(r,!0),e.Lbt.I3(o,2))},f.prototype.K_t=function(t,n){for(var e,i,r,o,e=this,i=l(e.I8,t+n-1),r=t;-1!==r&&r<=i;r++)e.isEmpty(r,-1)&&(o=e.cwt(r,!0),e.Lbt.I3(o,1))},f.prototype.Gde=function(t,n){var e,i,i,e=this;e.B_t(t,n)?(i=e.oT(t,n,!0),e.Lbt.I3(i,0)):(i=e.uT(!1))&&i.o_t(t,n,1,1),e.K_t(t,1),e.Q_t(n,1)},f.prototype.gF=function(t,n,e,i){for(var r,o,a,u,s,c,f,r=this,o=null,a=l(r.I8,t+e-1),u=l(r.x8,n+i-1),s=t;s<=a;s++)for(c=n;c<=u;c++)r.B_t(s,c)&&(o=r.oT(s,c,!0),r.Lbt.I3(o,0));r.K_t(t,e),r.Q_t(n,i),(f=r.uT(!1))&&f.o_t(t,n,e,i)},f.prototype.p3=function(){var n,t,n=this;n.MMt(function(t){t.J_t(n)}),(t=n.uT(!1))&&t.J_t(n)},f.prototype.Yde=function(){for(var t,n,e,e,i,r,e,t=this,n=t.lwt().concat(t.H_t()).concat(t.z_t()),i=0;i<n.length;i++)(r=n[i])&&(r.isVolatile||r.rbe||r.isPivotData)&&r instanceof U&&!r.k1&&(e=t.oT(r.row,r.column,!0),t.Lbt.I3(e,0),(e=t.cwt(r.row,!1))&&!t.$_t(e)&&t.K_t(r.row,1),e=t.uwt(r.column,!1))&&!t.$_t(e)&&t.Q_t(r.column,1)},f.prototype.$_t=function(t){return t.k1},f.prototype.isDirtyColumn=function(t){return t.k1},f.prototype.isEmpty=function(t,n){return!(!this.rwt(t,n)&&!this.pB(t,n))},f.prototype.processDynamicListenerForCell=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.rT,r=e.M_t(t,n)||e.ODt(t,n);r&&(o=ot(t,n),a=!1,f=c=s=u=void 0,(l=e.sT(t,n))&&!0!==l.isDynamicArray&&(a=!0,u=l.row,s=l.col,c=l.rowCount,f=l.colCount),h=e.Lbt,d=e.rT.getCalcSourceModel().oT(t,n),h.evaluateParsedFormula(e.rT,r,o,a,!0,l&&!0!==l.isDynamicArray&&A(u,s,c,f),h.allowDynamicArray,!1,d),vt(d,i,h,t,n,!1))},f.prototype.recalculateCell=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,f,d,v,n,h,v,a,d,h,p,e=this,i=e.rT,r=t.row,o=t.column,a=e.M_t(r,o)||e.ODt(r,o),u=i,s=u&&u.Mf,c={};if(a){if(et(a.ensureSingle)&&(a.ensureSingle=t.isDefault&&t.isDefault()),f=ot(r,o),l=i.getValue(r,o,$,!0),h=!1,g=m=v=d=void 0,(p=e.sT(r,o))&&!0!==p.isDynamicArray&&(h=!0,d=p.row,v=p.col,m=p.rowCount,g=p.colCount),p&&p.isDynamicArray&&(c.$bt=p),(b=e.Lbt).Z_t&&b.MX.asyncManager.startCalcCell(e.rT,f),f=b.evaluateParsedFormula(e.rT,a,f,h,!0,p&&!0!==p.isDynamicArray&&A(d,v,m,g),b.allowDynamicArray,n,t),n&&f&&f.pause)return f;if(vt(t,i,b,r,o,n),n&&0<t.delay)return{pause:"newDetectedRefs"};if(d=Q.Convert.LE(f)||Q.Convert.Nh(f),v=!1,n=void 0,h||!b.allowDynamicArray||a.ensureSingle||!a.t8t&&!d||(m=f.getRowCount?f.getRowCount():1,g=f.getColumnCount?f.getColumnCount():1,e.Uyt(r,o,n={row:r,col:o,rowCount:m,colCount:g,isDynamicArray:v=!0})),h=void 0,d&&((h=Q.Convert.iV(f,0,!1,!1,!1)).isError||h.isConvertError?(f=tt,d=!1):(m=h.rowCount,g=h.colCount,0===m||0===g?(f=x,d=!1):1===m&&1===g?(f=h[0][0],et(f)&&(f=0),d=!1):v||(a.$9t=!0,f=Q.Functions.findGlobalFunction("@").evaluate({row:r,column:o},f),d=!1))),d)n.nE=u.setArray(r,o,m,g,h),v=p&&p.rowCount||1,a=p&&p.colCount||1,n.nE&&(v<m||a<g)&&(b.p_t=b.p_t||[],b.p_t.push([e,n]));else if((d=u.updateItem&&u.updateItem(r,o,f))||l!==f){if(l instanceof Date){if(!d&&f instanceof Date&&l.valueOf()===f.valueOf())return c;if(typeof f===it){if(h=w.o0(l),!d&&h===f)return c;f=w.Y0(f)}}(p=s&&t.isDefault)&&(s.vle=t.isDefault()),i.setValue(r,o,f,l,$,s&&s.vle),p&&delete s.vle}b.Z_t&&b.MX.asyncManager.endCalcCell(),u.Vbt&&u.Vbt(r,o)}return c},f.prototype.recalculateNameID=function(t){var n,e,i,r,n,n=this,e=n.rT,i=n.D_t(t)||n.$yt(t);!i||(r=e.getValueByName?e.getValueByName(t):e.getValue({name:t}))===(n=n.Lbt.evaluateParsedFormula(n.rT,i,{name:t},!1,!0))||r instanceof Date&&n instanceof Date&&r.valueOf()===n.valueOf()||(e.setValueByName?e.setValueByName(t,n):e.setValue({name:t},n))},f.prototype.Bde=function(t,n){var e,i,r,t,o,e=this;if(!1!==t){if(e.dataTableByName)for(i in e.dataTableByName)e.dataTableByName.hasOwnProperty(i)&&(r=e.dataTableByName[i]).calc&&r.calc.vyt();t=e.cC(),o=e.rC(),e.Q_t(0,t),e.K_t(0,o),e.gF(0,0,o,t)}else n||e.Yde()},f.prototype.Zde=function(t){for(var n,e,i,r;t.y3[1];){for(i=(e=(n=t.y3[1]).w3).cC(),r=0;r<i;r++)t.I3(e.oT(n.row,r,!0),0);t.b_t(n,1)}},f.prototype.Wde=function(t){for(var n,e,i,r;t.y3[2];){if(0<(i=(e=(n=t.y3[2]).w3).rC()))for(r=0;r<i;r++)t.I3(e.oT(r,n.column,!0),0);else n.o_t();t.b_t(n,2)}},f.prototype.n8t=function(t,n){for(var e,i,e=t.length,i=n;i;)t[e]=i,e++,i=i.C3},f.prototype.lge=function(t,n){var e,i,r,o,n,r,e=t.row,i=t.column,r=n.cwt(e,!1),o=n.uwt(i,!1),n=n.uT(!1);t.o_t(),r&&r.o_t(),o&&o.o_t(),n&&((r=t.node&&t.node.$bt)&&r.isDynamicArray?n.o_t(e,i,r.rowCount,r.colCount):n.o_t(e,i,1,1))},f.prototype.addListenersToDirty=function(t,n){var e,i,r,o,a,u,s,c,f;if(1===n)this.Zde(t);else if(2===n)this.Wde(t);else if(0===n)for(e=[],t.y3[2]&&this.n8t(e,t.y3[2]),i=t.y3[0];i;i=i.C3)for(r=i.w3,this.lge(i,r),this.Zde(t);t.y3[2];){for(o=t.y3[2],a=!1,u=0;u<e.length;u++)if(e[u]===o){a=!0;break}if(a);else{for(s=(r=(e[e.length]=o).w3).rC(),c=0;c<s;c++)t.I3(r.oT(c,o.column,!0),0)}t.b_t(o,2)}else if(3===n)for(f=t.y3[3];f;f=f.C3)f.o_t()},f.prototype.initDelay=function(t,n){var e,i,r,o,a,u,s;if(0===n)for(e=null,i=t.y3[0];i;i=e)i.QDt&&(gt(t,i,i.QDt,!1),delete i.QDt),e=i.C3,o=(r=i.w3).rC(),a=r.cC(),u=void 0,i.row<o&&i.column<a?(d.supportRowColumnFormula&&(u=r.uwt(i.column,!1))&&(u.delay=0),i.delay=0,delete i.u_t):t.b_t(i,0),u||i.node.WK||t.b_t(i,0);else if(3===n)for(s=t.y3[3];s;s=s.C3)s.delay=0},f.prototype.adjustDelayOfListeners=function(t,n,e){var i,r,o,a,u,s,r,c;if(0===n)for(i=t.y3[n];i;i=i.C3)r=i.w3,o=i.row,a=i.column,u=r.cwt(o,!1),s=r.uwt(a,!1),r=r.uT(!1),i.a_t(e),u&&u.a_t(e),s&&s.a_t(e),r&&r.a_t(o,a,e);else if(3===n)for(c=t.y3[3];c;c=c.C3)c.a_t(e)},f.prototype.calculateDirtyNodes=function(t,n,e){var i,r,o,a,u,s,c,f,l,u,h,d,v,u,m,i=!1,r=null;if(0===n){for(a=t.y3[n];a;a=o)if(o=a.C3,u=!1,e&&a.i9t&&(u=!0,delete a.i9t),(a.delay<=0||u)&&(a.rbe&&this.U_t(a),r=a.w3,s=a.row,c=a.column,f=r.cwt(s,!1),!(l=r.uwt(c,!1))||!l.delay)){if(u=r.uT(!1),(h=r.recalculateCell(a,!a.e8t||a.e8t<32))&&h.pause){if(a.e8t=a.e8t?a.e8t+1:1,h.branch)for(o=a,d=0;d<h.branch.length;d++)!h.branch[d].k1&&h.branch[d]!==a||(a.delay++,(v=h.branch[d]).u_t=v.u_t||[],v.u_t.push(a))}else delete a.e8t,t.b_t(a,0),a.a_t(!1,h),f&&f.a_t(!1),l&&l.a_t(!1),u&&u.a_t(s,c,!1),(u=a.node&&a.node.WK)&&u.lMt&&delete u.lMt;i=!0}i||e||(i=this.calculateDirtyNodes(t,n,!0))}else if(3===n)for(m=t.y3[n];m;m=o)o=m.C3,0===m.delay&&(m.P6t?m.P6t():(r=m.w3).recalculateNameID(m.name),t.b_t(m,3),m.a_t(!1),i=!0);return i},f.prototype.calculateIterations=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,c;if(0===n&&(e=t.y3[n]))if(r=!(i=null),t.iterativeCalculation){for(a in t.rO)t.rO.hasOwnProperty(a)&&((u=t.rO[a].getSource()).clearValueCache&&u.clearValueCache(),u.startIterativeCalc)&&u.startIterativeCalc();for(s=0;r&&s<t.iterativeCalculationMaximumIterations;s++)for(r=!1,i=e;i;i=i.C3)delete i.e8t,o=i.node&&i.node.WK&&i.node.WK.lMt,this.G_t(i,!o,q),o&&(i.node.WK.lMt=$),c=i.w3,f=i.row,l=i.column,h=c.getSource().getValue(f,l),c.recalculateCell(i),r||(c=c.getSource().getValue(f,l),(0,d.approximatelyEqual)(h,c,t.iterativeCalculationMaximumChange))||(r=!0);for(a in t.rO)t.rO.hasOwnProperty(a)&&(u=t.rO[a].getSource()).endIterativeCalc&&u.endIterativeCalc()}else for(i=e;i;i=i.C3)o=i.node&&i.node.WK&&i.node.WK.lMt,this.G_t(i,!o,0),o&&(i.node.WK.lMt=$),delete i.e8t},f.prototype.cyt=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,F,L,v,m,g,p,b,w,y,M,C,S,T,A,I,d,x,f,N,k,B,_,D,j,x,d,d,v,O,w,E,b,P,R,x,h,a,u=this;if(o&&u.U_t(t),i){for(;12===i.type;)i=i.value;for(;10===i.type;)i=i.value;for(;12===i.type;)i=i.value;if(r){for(;12===r.type;)r=r.value;for(;10===r.type;)r=r.value;for(;12===r.type;)r=r.value}if(13===i.type){if((d=i.getRange(n,e,!0))===q)return;i=1===d.rowCount&&1===d.colCount?(0,J.knt)(i.source,q,d.row,d.col,!1,!1):(0,J.lJ)(i.source,q,d.row,d.col,d.row+d.rowCount-1,d.col+d.colCount-1,!1,!1,!1,!1)}if(r&&r!==i&&8===r.type){if(r.source instanceof Q.ErrorSource)return;if(c=r.value,A=i.source||r.source||a||u.rT,(x=(d=u.Lbt.getGlobalSourceModel()||A.getCalcSourceModel()).getSource()).addUsedCustomName&&x.addUsedCustomName(c),!(I=A.getCalcSourceModel()))return;(f=I.vwt(c,!0))&&f.Iwt(0,t,o),(f=A.getCustomName(c))||(l=d.vwt(c,!0)).Iwt(0,t,o),r=null,f||(f=x.getCustomName(c),I=d),f&&u.cyt(t,n,e,f,q,o,I.getSource())}if(1===i.type&&i.endSource){if(k=(N=i).source.getSources(N.endSource))for(s=0;s<k.length;s++)(B=(0,J.lJ)(k[s],q,N.row,N.column,N.endRow,N.endColumn,N.rowRelative,N.columnRelative,N.endRowRelative,N.endColumnRelative,n,e)).isFullRow=N.isFullRow,B.isFullColumn=N.isFullColumn,u.cyt(t,n,e,B,q,o)}else if(1===i.type){if(_=u.rT,I=(A=i.source||_).getCalcSourceModel(),_&&_.G3&&A&&_.id!==A.id&&A.getSheet&&A.getSheet()&&_.addReferenceSheetName(A.getSheet().name()),!I&&A.ayt&&A.cyt&&A.cyt(t,o,i),I)if(D=i,j=t.row===$||t.column===$,x=D.Tyt(),v=(d=(0,J.getRangeForReference)(D,n,e)).row,g=d.col,m=v+(b=d.rowCount)-1,p=g+(w=d.colCount)-1,0===x){if(0<=n&&0<=e)if(At(d))h=I.uT(!0),j?h.i8t(v,g,b,w,t,o):h.JDt(v,g,b,w,t,o);else for(S=v;S<=m;S++)for(T=g;T<=p;T++)y=I.oT(S,T,!0),j?y&&y.Iwt(3,t,o):y&&y.Iwt(0,t,o);else if(0<=n&&-1===e)for(S=v;S<=m;S++)for(T=g;T<=p;T++)D.columnRelative||D.endColumnRelative?(M=I.cwt(S,!0))&&M.r8t(t.row,-T,o):(y=I.oT(S,T,!0))&&y.Iwt(1,t,o);else if(0<=e&&-1===n)for(S=v;S<=m;S++)for(T=g;T<=p;T++)D.rowRelative||D.endRowRelative?(C=I.uwt(T,!0))&&C.o8t(t,-S,o):(y=I.oT(S,T,!0))&&y.Iwt(2,t,o)}else if(1===x){if(0<=n&&0<=e)h=I.uT(!0),j?h.i8t(v,g,b,w,t,o):h.JDt(v,g,b,w,t,o);else if(!(0<=n&&-1===e)&&-1===n&&0<=e&&!D.rowRelative&&!D.endRowRelative)for(v=D.row,m=D.endRow,S=v;S<=m;S++)(M=I.cwt(S,!0))&&M.Iwt(2,t,o)}else if(2===x){if(0<=n&&0<=e)h=I.uT(!0),j?h.i8t(v,g,b,w,t,o):h.JDt(v,g,b,w,t,o);else if(!(0<=n&&-1===e)&&-1===n&&0<=e)for(T=g;T<=p;T++)(C=I.uwt(T,!0))&&C.Iwt(2,t,o)}else 3===x&&(h=I.uT(!0),j?h.i8t(0,0,Q.MAX_ROW_COUNT,Q.MAX_COLUMN_COUNT,t,o):h.JDt(0,0,Q.MAX_ROW_COUNT,Q.MAX_COLUMN_COUNT,t,o))}else if(9===i.type)u.cyt(t,n,e,i.value,r&&9===r.type&&r.value,o),i.value2&&u.cyt(t,n,e,i.value2,r&&9===r.type&&r.value2,o);else if(8===i.type)!i.jwt&&(i.jwt=!0,A=i.source||a||u.rT,c=G(i.value),(f=A.getCustomName(c))?I=A.getCalcSourceModel():(f=(I=u.Lbt.getGlobalSourceModel()||A.getCalcSourceModel()).getSource().getCustomName(c))||(v=(d=A.getCalcSourceModel())&&d.vwt(c,!0))&&v.Iwt(0,t,o),l=I.vwt(c,!0))&&(l.Iwt(0,t,o),f&&u.cyt(t,n,e,f,q,o,I.getSource()),i.jwt=$);else if(7===i.type){if(!i.jwt){if(i.jwt=!0,O=i.function)if((0,Q.isExpression)(O))for(u.cyt(t,n,e,O,r&&7===r.type&&r.function instanceof Q.Expression&&r.function,o),E=i.arguments.length,s=0;s<E;s++)u.cyt(t,n,e,i.arguments[s],r&&7===r.type&&r.arguments[s],o);else for(O&&((b=O.u9t)&&u.Lbt.l_t(t,b,o),O.isVolatile()&&(o?u.nbt(t):u.R_t(t)),"GETPIVOTDATA"===O.name&&(o?u.V_t(t):u.F_t(t)),O instanceof Q.Functions.AsyncFunction)&&(u.Lbt.Z_t=!0),E=i.arguments.length,s=0;s<E;s++)O&&O.skipPrecedent(s)&&u.a8t(t,i,s,O,n,e)&&(t.e_t=!0),P=!1,this.Lbt.dynamicReferences&&O&&O.isBranch()&&O.findTestArgument()!==s&&t instanceof U&&(i.u8t=!0,R=n+","+e,i.s8t=i.s8t||{},i.s8t[R]=i.s8t[R]||[],i.s8t[R][s]=[],P=!0,t.ebt=t.ebt||[],t.ebt.push(i.s8t[R][s])),u.cyt(t,n,e,i.arguments[s],r&&7===r.type&&r.arguments[s],o),P&&t.ebt.pop(),delete t.e_t;else for(!i.isLocalFunctionName&&i.functionName&&((w=new Q.Expression(8)).value=i.functionName,u.cyt(t,n,e,w,i,o)),E=i.arguments.length,s=0;s<E;s++)u.cyt(t,n,e,i.arguments[s],r&&7===r.type&&r.arguments[s],o);i.jwt=$}}else 25===i.type||26===i.type?(h=(I=(A=(x=i).source||u.rT).getCalcSourceModel()).C_t(x.value,!0))&&h.Iwt(0,t,o):22!==i.type&&14!==i.type||(22===i.type&&(_=u.rT,A=i.source||_,_)&&_.G3&&A&&_.id!==A.id&&A.getSheet&&A.getSheet()&&_.addReferenceSheetName(A.getSheet().name()),(a=i).Iwt&&a.Iwt(t,o))}},f.prototype.a8t=function(t,n,e,i,r,o){var n,e,i,r,n=n.arguments[e];return!((n=12===n.type?n.value:n)&&n.function&&n.function.name||(i.i9t?!this.Lbt.dynamicReferences||!n||1!==n.type&&13!==n.type||(e=n.source||this.rT,this.Lbt.lb&&e&&e.getRangeKey&&((i=n.getRange(r,o)).rowUndefine&&(i.row=i.rowCount=-1),i.colUndefine&&(i.col=i.colCount=-1),i.id=e.id,r=e.getRangeKey(e,i),t.qkt||(t.qkt={}),t.qkt[r]=i,t.i9t=!0),0):!n||1!==n.type&&13!==n.type&&22!==n.type))},f.prototype.f_t=function(t,n){var e=this.getNodeByName(t);e&&(e.eyt||e.WK)&&this.cyt(this.C_t(t),0,0,e.eyt||e.WK,e.WK,n)},f.prototype.c8t=function(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,a=this,u=t+e,s=n+i,h=t;h<u;h++)if(this.dataTable[h])for(d=n;d<s;d++)c=a.Fyt(h,d),f=a.pB(h,d),(c||f)&&(l=a.sT(h,d),v=a.oT(h,d),o&&v.isDefault()||(l&&!0!==l.isDynamicArray?a.cyt(v,l.row,l.col,c||f,f,r):a.cyt(v,h,d,c||f,f,r),r&&v.qkt&&(gt(v.c_t(),v,v.qkt,!0,!1),v.QDt=v.qkt,delete v.qkt),r)||v.QDt&&gt(v.c_t(),v,v.QDt,!1,!1))},f.prototype.f8t=function(t,n,e){for(var i,r,o,i=t+n,r=t;-1!==r&&r<i;r++)(o=this.getColumnExpression(r))&&this.cyt(this.uwt(r,!1),-1,r,o,o,e)},f.prototype.l8t=function(t,n,e,i){this.c8t(t,n,e,i,!0)},f.prototype.mF=function(t,n,e,i,r){this.c8t(t,n,e,i,!1,r)},f.prototype.h8t=function(t,n){},f.prototype.hwt=function(t,n){},f.prototype.d8t=function(t,n){this.f8t(t,n,!0)},f.prototype.dwt=function(t,n){this.f8t(t,n,!1)},f.prototype.v8t=function(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,u=t+e,s=n+i,c=this,f=t;f<u;f++)if(this.dataTable[f])for(l=n;l<s;l++)(h=this.oT(f,l,!1))&&(c.Vyt(a,f,l),r&&h.mB(),o)&&h.o_t()},f.prototype.m8t=function(t,n,e,i,r){var o,a,u,s,c,c,o=this,a=o.AE;if(-1!==t&&a)for(u=l(t+n,a.length),s=t;s<u;s++)(c=a[s])&&c.calc&&(o.Vyt(r,s,-1),c=c.calc,e&&c.mB(),i)&&c.o_t()},f.prototype.g8t=function(t,n,e,i,r){var o,a,u,s,c,c,o=this,a=o.IE;if(-1!==t&&a)for(u=l(t+n,a.length),s=t;s<u;s++)(c=a[s])&&c.calc&&(o.Vyt(r,-1,s),c=c.calc,e&&c.mB(),i)&&c.o_t()},f.prototype.Ryt=function(t,n,e,i,r,o,a){var u,s,a,c;(r||o)&&(u=this,s=void 0,a&&(s=u.pj()),0<=t&&0<=n?(u.v8t(t,n,e,i,r,o,s),u.m8t(t,e,r,o,s),u.g8t(n,i,r,o,s),u.__t&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i)):0<=t&&-1===n?(u.v8t(t,0,e,u.cC(),r,o,s),u.m8t(t,e,r,o,s),u.__t&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i)):-1===t&&0<=n?(u.v8t(0,n,u.rC(),i,r,o,s),u.g8t(n,i,r,o,s),u.__t&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i)):-1===t&&-1===n&&(a=u.rC(),c=u.cC(),u.v8t(0,0,a,c,r,o,s),u.m8t(0,a,r,o,s),u.g8t(0,c,r,o,s),u.__t)&&(r&&u.__t.mB(t,n,e,i),o)&&u.__t.o_t(t,n,e,i))},f.prototype.getAllNodes=function(){var t,n,e,i,r,o,a,u,s,t=[],n=this.dataTable,e=this.AE,i=this.IE,r=this.xE;for(a in r&&t.push(r),e)e.hasOwnProperty(a)&&(o=e[a])&&t.push(o);for(a in i)i.hasOwnProperty(a)&&(o=i[a])&&t.push(o);for(u in n)if(n.hasOwnProperty(u)&&(s=n[u]))for(a in s)s.hasOwnProperty(a)&&(o=s[a])&&t.push(o);return t},f.prototype.toJSON=function(t){d.supportRowColumnFormula?this.rT.toJSON(t,this.dataTable,this.I8,this.x8,this.IE):this.rT.toJSON(t,this.dataTable,this.I8,this.x8)},f.prototype.wh=function(t,n){d.supportRowColumnFormula?this.rT.wh(t,this.dataTable,this.I8,this.x8,this.IE,n):this.rT.wh(t,this.dataTable,this.I8,this.x8,void 0,n)},R=f,d.CalcSourceModel=R,n(h,Y=u),h.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.row+","+t.column},h.prototype.yB=function(){var t=this;t.w3.l8t(t.row,t.column,1,1)},h.prototype.CMt=function(){var t=this;t.w3.mF(t.row,t.column,1,1)},h.prototype.r_t=function(){this.w3.op().onAddAdjust(this,0)},h.prototype.vyt=function(){this.w3.op().I3(this,0)},h.prototype.J_t=function(n){for(var t,e,i,r,t=this.w3.op(),e=this.aT,i=0;i<e.length;i++)(r=this[e[i]])&&r.forEach(function(t){t&&t.w3&&t.w3!==n&&(t.k1||t.vyt&&t.vyt())})},h.prototype.o_t=function(){for(var t,n,e,i,r,o,a,u,t=this.w3.op(),n=this.aT,e=0;e<n.length;e++)(i=this[n[e]])&&i.forEach(function(t){t&&!t.k1&&t.vyt()});if((r=this.node&&this.node.$bt)&&r.isDynamicArray)for(o=0;o<r.rowCount;o++)for(a=0;a<r.colCount;a++)0===o&&0===a||(u=this.w3.getNode(o+r.row,a+r.col))&&u.calc&&u.calc.o_t()},h.prototype.s_t=function(){var t,n,e,i,r,i,n,o,i,e,n,t=this,n=t.w3,e=n.getCalcService();e&&e.Z_t&&(!(r=(i=t.Z_t)&&t.p8t)&&et(i)&&(i=n.getSource())&&(n=i.getName(),i=(o=e.MX.asyncManager).b8t[n])&&(e=i[t.row])&&(n=e[t.column])&&((r=n[0])?(t.Z_t=!0,(t.p8t=r).y8t=t):t.Z_t=!1),r)&&0===r.evaluateMode&&(r.yL=!1)},h.prototype.isDefault=function(t){if(et(t))return this.Hte;this.Hte=t},U=h,d.CellCalc=U,n(p,Z=u),p.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.row+",-1"},p.prototype.yB=function(){this.w3.h8t(this.row,1)},p.prototype.CMt=function(){this.w3.hwt(this.row,1)},p.prototype.r8t=function(t,n,e){(e?pt:bt)(this,N,{row:t,columnOffset:n,columnCount:1})},p.prototype.r_t=function(){this.w3.op().onAddAdjust(this,1)},p.prototype.vyt=function(){this.w3.op().I3(this,1)},F=p,d.RowCalc=F,n(b,W=u),b.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+"-1,"+t.column},b.prototype.yB=function(){this.w3.d8t(this.column,1)},b.prototype.CMt=function(){this.w3.dwt(this.column,1)},b.prototype.o8t=function(t,n,e){this.Iwt(2,t,e)},b.prototype.r_t=function(){this.w3.op().onAddAdjust(this,2)},b.prototype.vyt=function(){this.w3.op().I3(this,2)},L=b,d.ColumnCalc=L,n(wt,ft=u),wt.prototype.getKey=function(){var t,n,e,t=this,n=t.w3,e;return(null===n?"":n.rT.id+",")+t.name},wt.prototype.updateListening=function(t,n){for(var r,r,o,a,u,s,e,i,o=this,a=o.aT,e=function(t){var t,n,e,i,t=o[a[t]];if(t)for(n=[],t.forEach(function(t){t&&n.push(t)}),e=n.length,i=0;i<e;i++)s=(u=n[i]).node,u.CMt(),s&&u.w3.SB(null!=(r=u.row)?r:-1,null!=(r=u.column)?r:-1,s.WK,s.$bt,!0)},i=0;i<a.length;i++)e(i)},wt.prototype.updateListeningOnRemoved=function(){for(var e,t,i,r,o,a,u,s,n,c,e=this,t=e.aT,u=e.w3,s=u.op(),n=0;n<t.length;n++)(c=e[t[n]])&&c.forEach(function(t){var t,n;t&&(i=t.w3,r=t.row,o=t.col,r=r===$?-1:r,o=o===$?-1:o,a=i.pB(r,o),t=i.sT(r,o),a)&&(n=s.Hyt().adjustFormulaOnRemoveName(u,a,e.name))!==a&&i.SB(r,o,n,t,!0)})},wt.prototype.vyt=function(){for(var t,n,e,t=this.aT,n=0;n<t.length;n++)(e=this[t[n]])&&e.forEach(function(t){t&&t.vyt()})},B=wt,d.NameCalc=B,n(y,lt=u),y.prototype.processListener=function(t,n,e,i,r,o,a,u,s){var c,f,l,h,d,d,v,c,c=this,f=c[t],l=c[t+"c"],h=n+","+e+","+i+","+r;if(3!==t||o instanceof D)if(o.e_t)lt.prototype.Iwt.call(this,t,o,a);else{if(o.ebt&&1<=o.ebt.length&&((v=(d=o.ebt)[d.length-1]).push(this),h="?"+h),u&&(h="!"+h),f||(c.aT.push(t),c[t]=f=(0,g.createMap)(),c[t+"c"]=l=new m.Common.rbush(16)),!(d=f.get(h))){if(!a)return;f.set(h,d={}),d.content=(0,g.createMap)(),d.minY=n,d.minX=e,d.maxY=-1===n?-1:i+n-1,d.maxX=-1===e?-1:r+e-1,u&&s&&(d.content.delay=yt(c.w3,n,e,i,r)),l.insert(d)}c=o.getKey(),a?d.content.has(c)||(d.content.set(c,o),u&&s&&d.content.delay&&0===t&&o.delay++):d.content.has(c)&&(d.content.delete(c),d.content.size<1)&&(delete d.content,f.delete(h),l.remove(d))}},y.prototype.JDt=function(t,n,e,i,r,o,a,u){this.processListener(0,t,n,e,i,r,o,a,u)},y.prototype.i8t=function(t,n,e,i,r,o){this.processListener(3,t,n,e,i,r,o)},y.prototype.mB=function(t,n,e,i){this.visit(0,t,n,e,i)},y.prototype.visit=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,o=this.aT,a=this.c_t();if(v.minX=e,v.minY=n,v.maxX=e+r-1,v.maxY=n+i-1,0===t){for(u=0;u<o.length;u++)if(s=this[o[u]])for(f=(c=this[o[u]+"c"]).search(v),l=0;l<f.length;l++)(h=f[l].content).forEach(function(t){t.r_t()});this.i_t&&this.i_t.forEach(function(t){t&&t.r_t()})}else for(u=0;u<o.length;u++)if(s=this[o[u]])for(f=(c=this[o[u]+"c"]).search(v),l=0;l<f.length;l++)(d=f[l]).w8t&&d.w8t.WDt||(d.w8t=a.ZDt,(h=d.content).delay=0,h.forEach(function(t){t.vyt()}))},y.prototype.o_t=function(t,n,e,i){this.visit(1,t,n,e,i)},y.prototype.J_t=function(n){for(var t,e,i,t=this.aT,e=0;e<t.length;e++)(i=this[t[e]])&&i.forEach(function(t){t&&t.content.forEach(function(t){t&&t.w3&&t.w3!==n&&t.vyt&&t.vyt()})})},y.prototype.CTe=function(t,n){var e,n,i,r,o;if(v.minX=n,v.minY=t,v.maxX=n,v.maxY=t,e=!1,n=this["0c"])for(i=n.search(v),r=0;r<i.length;r++)if((o=i[r].content)&&o.forEach(function(t){t&&t.k1&&(e=!0)}),e)return!0;return e},y.prototype.a_t=function(t,n,e){var i,r,o,a,u,s,c,f,i=this.aT,r=e?1:-1;for(v.minX=n,v.minY=t,v.maxX=n,v.maxY=t,o=0;o<i.length;o++)if(a=this[i[o]])for(s=(u=this[i[o]+"c"]).search(v),c=0;c<s.length;c++)(f=s[c].content).delay=(f.delay||0)+r,e&&1===f.delay?f&&f.forEach(function(t){t.delay++,t.s_t&&t.s_t()}):e||0!==f.delay||f&&f.forEach(function(t){t.delay--})},y.prototype.yB=function(){},y.prototype.CMt=function(){},P=y,d.RangeCalc=P,d.Pyt=St,d.h0t=Tt,d.eV=ot,d.Rwt=A},"./src/calcEngine.res.en.ts":function(t,n){var n,e,i,r,o,a,e,u,s;function c(t,n){return{description:t,parameters:n}}function f(t,n,e,i){return{name:t,repeatable:n,optional:e,enum:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,n.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFormulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",Exp_DuplicatedChar:"Duplicated Character",Exp_ArgumentOutOfRangeException:"Argument Out Of Range Exception",Exp_ArgumentException:"Argument Exception",wmt:{ABS:c("This function calculates the absolute value of the specified value.",[f("number")]),ACCRINT:c("This function calculates the accrued interest for a security that pays periodic interest.",[f("issue"),f("first_interest"),f("settlement"),f("rate"),f("par"),f("frequency"),f("basis")]),ACCRINTM:c("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[f("issue"),f("settlement"),f("rate"),f("par"),f("basis")]),ACOS:c("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[f("number")]),ACOSH:c("This function calculates the inverse hyperbolic cosine of the specified value.",[f("number")]),ADDRESS:c("This function uses the row and column numbers to create a cell address in text.",[f("row_num"),f("column_num"),f("abs_num"),f("a1style"),f("sheet_text")]),AGGREGATE:c("This function aggregate a list of numbers using a specified built-in function.",[f("function_num"),f("options"),f("ref1"),f("ref2",!0)]),AMORDEGRC:c("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[f("cost"),f("date_purchased"),f("first_period"),f("salvage"),f("period"),f("rate"),f("basis")]),AMORLINC:c("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[f("cost"),f("date_purchased"),f("first_period"),f("salvage"),f("period"),f("rate"),f("basis")]),AND:c("Check whether all arguments are True, and returns True if all arguments are True.",[f("logical1"),f("logical2")]),ASIN:c("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[f("number")]),ASINH:c("This function calculates the inverse hyperbolic sine of a number.",[f("number")]),ATAN:c("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[f("number")]),ATAN2:c("This function calculates the arctangent of the specified x- and y-coordinates.",[f("x_num"),f("y_num")]),ATANH:c("This function calculates the inverse hyperbolic tangent of a number.",[f("number")]),AVEDEV:c("This function calculates the average of the absolute deviations of the specified values from their mean.",[f("number1"),f("number2",!0)]),AVERAGE:c("This function calculates the average of the specified numeric values.",[f("number1"),f("number2",!0)]),AVERAGEA:c("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[f("value1"),f("value2",!0)]),AVERAGEIF:c("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[f("range"),f("criteria"),f("[average_range]")]),AVERAGEIFS:c("This function calculates the average of all cells that meet multiple specified criteria.",[f("average_range"),f("criteria_range1"),f("criteria1"),f("criteria_range2",!0),f("criteria2",!0)]),BESSELI:c("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[f("value"),f("order")]),BESSELJ:c("This function calculates the Bessel function of the first kind.",[f("value"),f("order")]),BESSELK:c("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[f("value"),f("order")]),BESSELY:c("This function calculates the Bessel function of the second kind.",[f("value"),f("order")]),BETADIST:c("This function calculates the cumulative beta distribution function.",[f("x"),f("alpha"),f("beta"),f("lower"),f("upper")]),BETAINV:c("This function calculates the inverse of the cumulative beta distribution function.",[f("probability"),f("alpha"),f("beta"),f("lower"),f("upper")]),BIN2DEC:c("This function converts a binary number to a decimal number",[f("number")]),BIN2HEX:c("This function converts a binary number to a hexadecimal number.",[f("number"),f("places")]),BIN2OCT:c("This function converts a binary number to an octal number.",[f("number"),f("places")]),BINOMDIST:c("This function calculates the individual term binomial distribution probability.",[f("number_s"),f("trials"),f("probability_s"),f("cumulative")]),CEILING:c("This function rounds a number up to the nearest multiple of a specified value.",[f("number"),f("significance")]),CHAR:c("This function returns the character specified by a number.",[f("number")]),CHIDIST:c("This function calculates the one-tailed probability of the chi-squared distribution.",[f("value"),f("deg_freedom")]),CHIINV:c("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[f("probability"),f("deg_freedom")]),CHITEST:c("This function calculates the test for independence from the chi-squared distribution.",[f("actual_range"),f("expected_range")]),CHOOSE:c("This function returns a value from a list of values.",[f("index_num"),f("value1"),f("value2",!0)]),CLEAN:c("This function removes all non-printable characters from text.",[f("text")]),CODE:c("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[f("text")]),COLUMN:c("This function returns the column number of a reference.",[f("reference")]),COLUMNS:c("This function returns the number of columns in an array.",[f("array")]),COMBIN:c("This function calculates the number of possible combinations for a specified number of items.",[f("number"),f("number_chosen")]),COMPLEX:c("This function converts real and imaginary coefficients into a complex number.",[f("real_num"),f("image_num"),f("suffix")]),CONCATENATE:c("This function combines multiple text strings or numbers into one text string.",[f("text1"),f("text2",!0)]),CONFIDENCE:c("This function returns confidence interval for a population mean.",[f("alpha"),f("standard_dev"),f("size")]),CONVERT:c("This function converts a number from one measurement system to its equivalent in another measurement system.",[f("number"),f("from_unit"),f("to_unit")]),CORREL:c("This function returns the correlation coefficient of the two sets of data.",[f("array1"),f("array2")]),COS:c("This function returns the cosine of the specified angle.",[f("number")]),COSH:c("This function returns the hyperbolic cosine of the specified value.",[f("number")]),COUNT:c("This function returns the number of cells that contain numbers.",[f("value1"),f("value2",!0)]),COUNTA:c("This function returns the number of number of cells that contain numbers, text, or logical values.",[f("value1"),f("value2",!0)]),COUNTBLANK:c("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[f("cellrange")]),COUNTIF:c("This function returns the number of cells that meet a certain condition",[f("cellrange"),f("criteria")]),COUNTIFS:c("This function returns the number of cells that meet multiple conditions.",[f("criteria_range1"),f("criteria1"),f("criteria_range2",!0),f("criteria2",!0)]),COUPDAYBS:c("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[f("settlement"),f("maturity"),f("frequency"),f("basis")]),COUPDAYS:c("This function returns the number of days in the coupon period that contains the settlement date.",[f("settlement"),f("maturity"),f("frequency"),f("basis")]),COUPDAYSNC:c("This function calculates the number of days from the settlement date to the next coupon date.",[f("settlement"),f("maturity"),f("frequency"),f("basis")]),COUPNCD:c("This function returns a date number of the next coupon date after the settlement date.",[f("settlement"),f("maturity"),f("frequency"),f("basis")]),COUPNUM:c("This function returns the number of coupons due between the settlement date and maturity date.",[f("settlement"),f("maturity"),f("frequency"),f("basis")]),COUPPCD:c("This function returns a date number of the previous coupon date before the settlement date.",[f("settlement"),f("maturity"),f("frequency"),f("basis")]),COVAR:c("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[f("array1"),f("array2")]),CRITBINOM:c("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[f("trials"),f("probability_s"),f("alpha")]),CUMIPMT:c("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[f("rate"),f("nper"),f("pval"),f("start_period"),f("end_period"),f("paytype")]),CUMPRINC:c("This function returns the cumulative principal paid on a loan between the start and end periods.",[f("rate"),f("nper"),f("pval"),f("start_period"),f("end_period"),f("paytype")]),DATE:c("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[f("year"),f("month"),f("day")]),DATEDIF:c("This function returns the number of days, months, or years between two dates.",[f("start_date"),f("end_date"),f("unit")]),DATEVALUE:c("This function returns a DateTime object of the specified date.",[f("date_text")]),DAVERAGE:c("This function calculates the average of values in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),DAY:c("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[f("date")]),DAYS360:c("This function returns the number of days between two dates based on a 360-day year.",[f("start_date"),f("end_date"),f("method")]),DB:c("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[f("cost"),f("salvage"),f("life"),f("period"),f("month")]),DCOUNT:c("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[f("database"),f("field"),f("criteria")]),DCOUNTA:c("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[f("database"),f("field"),f("criteria")]),DDB:c("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[f("cost"),f("salvage"),f("life"),f("period"),f("factor")]),DEC2BIN:c("This function converts a decimal number to a binary number.",[f("number"),f("places")]),DEC2HEX:c("This function converts a decimal number to a hexadecimal number",[f("number"),f("places")]),DEC2OCT:c("This function converts a decimal number to an octal number",[f("number"),f("places")]),DEGREES:c("This function converts the specified value from radians to degrees",[f("angle")]),DELTA:c("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[f("number1"),f("number2")]),DEVSQ:c("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[f("number1"),f("number2",!0)]),DGET:c("This function extracts a single value from a column of a list or database that matches the specified conditions.",[f("database"),f("field"),f("criteria")]),DISC:c("This function calculates the discount rate for a security.",[f("settlement"),f("maturity"),f("price"),f("redemption"),f("basis")]),DMAX:c("This function returns the largest number in a column of a list or database that matches the specified conditions.",[f("database"),f("field"),f("criteria")]),DMIN:c("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[f("database"),f("field"),f("criteria")]),DOLLAR:c("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[f("number"),f("decimals")]),DOLLARDE:c("This function converts a fraction dollar price to a decimal dollar price.",[f("fractional_dollar"),f("fraction")]),DOLLARFR:c("This function converts a decimal number dollar price to a fraction dollar price.",[f("decimal_dollar"),f("fraction")]),DPRODUCT:c("This function multiplies the values in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),DSTDEV:c("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),DSTDEVP:c("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),DSUM:c("This function adds the numbers in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),DURATION:c("This function returns the Macaulay duration for an assumed par value of $100.",[f("settlement"),f("maturity"),f("coupon"),f("yield"),f("frequency"),f("basis")]),DVAR:c("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),DVARP:c("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[f("database"),f("field"),f("criteria")]),EDATE:c("This function calculates the date that is the indicated number of months before or after a specified date.",[f("start_date"),f("months")]),EFFECT:c("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[f("nominal_rate"),f("npery")]),EOMONTH:c("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[f("start_date"),f("months")]),ERF:c("This function calculates the error function integrated between a lower and an upper limit.",[f("lower_limit"),f("upper_limit")]),ERFC:c("This function calculates the complementary error function integrated between a lower limit and infinity.",[f("lowerlimit")]),"ERROR.TYPE":c("This function returns a number corresponding to one of the error values.",[f("error_val")]),EURO:c("This function returns the equivalent of one Euro based on the ISO currency code.",[f("code")]),EUROCONVERT:c("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[f("number"),f("source"),f("target"),f("full_precision"),f("triangulation_precision")]),EVEN:c("This function rounds the specified value up to the nearest even integer.",[f("number")]),EXACT:c("This function returns true if two strings are the same; otherwise, false.",[f("text1"),f("text2")]),EXP:c("This function returns e raised to the power of the specified value.",[f("number")]),EXPONDIST:c("This function returns the exponential distribution or the probability density.",[f("value"),f("lambda"),f("cumulative")]),FACT:c("This function calculates the factorial of the specified number.",[f("number")]),FACTDOUBLE:c("This function calculates the double factorial of the specified number.",[f("number")]),FALSE:c("This function returns the value for logical FALSE.",[]),FDIST:c("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[f("value"),f("deg_freedom1"),f("deg_freedom2")]),FIND:c("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[f("find_text"),f("within_text"),f(n="[start_num]")]),FINV:c("This function returns the inverse of the F probability distribution.",[f("probability"),f("deg_freedom1"),f("deg_freedom2")]),FISHER:c("This function returns the Fisher transformation for a specified value.",[f("value")]),FISHERINV:c("This function returns the inverse of the Fisher transformation for a specified value.",[f("value")]),FIXED:c("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[f("number"),f("decimals"),f("no_commas")]),FLOOR:c("This function rounds a number down to the nearest multiple of a specified value.",[f("number"),f("significance")]),FORECAST:c("This function calculates a future value using existing values.",[f("value"),f("Yarray"),f("Xarray")]),FREQUENCY:c("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[f("data_array"),f("bins_array")]),FTEST:c("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[f("array1"),f("array2")]),FV:c("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[f("rate"),f("numper"),f("paymt"),f("pval"),f("type")]),FVSCHEDULE:c("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[f("principal"),f("schedule")]),GAMMADIST:c("This function returns the gamma distribution.",[f("x"),f("alpha"),f("beta"),f("cumulative")]),GAMMAINV:c("This function returns the inverse of the gamma cumulative distribution.",[f("probability"),f("alpha"),f("beta")]),GAMMALN:c("This function returns the natural logarithm of the Gamma function, G(x).",[f("value")]),GCD:c("This function returns the greatest common divisor of two numbers.",[f("number1"),f("number2")]),GEOMEAN:c("This function returns the geometric mean of a set of positive data.",[f("number1"),f("number2",!0)]),GESTEP:c("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[f("number"),f("step")]),GROWTH:c("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[f("y"),f("x"),f("newx"),f("constant")]),HARMEAN:c("This function returns the harmonic mean of a data set.",[f("number1"),f("number2",!0)]),HEX2BIN:c("This function converts a hexadecimal number to a binary number.",[f("number"),f("places")]),HEX2DEC:c("This function converts a hexadecimal number to a decimal number.",[f("number")]),HEX2OCT:c("This function converts a hexadecimal number to an octal number.",[f("number"),f("places")]),HLOOKUP:c("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[f("lookup_value"),f("table_array"),f("row_index_num"),f("range_lookup",!(s=[{value:"TRUE",description:"Approximate match"},{value:"FALSE",description:"Exact match"}]),!0,s)]),HOUR:c("This function returns the hour that corresponds to a specified time.",[f("time")]),HYPGEOMDIST:c("This function returns the hypergeometric distribution.",[f("sample_s"),f("number_sample"),f("population_s"),f("number_pop")]),IF:c("This function performs a comparison and returns one of two provided values based on that comparison.",[f("logical_test"),f("value_if_true"),f("value_if_false")]),IFERROR:c("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[f("value"),f("value_if_error")]),IMABS:c("This function returns the absolute value or modulus of a complex number.",[f("complexnum")]),IMAGINARY:c("This function returns the imaginary coefficient of a complex number.",[f("complexnum")]),IMARGUMENT:c("This function returns the argument theta, which is an angle expressed in radians.",[f("complexnum")]),IMCONJUGATE:c("This function returns the complex conjugate of a complex number.",[f("complexnum")]),IMCOS:c("This function returns the cosine of a complex number.",[f("complexnum")]),IMDIV:c("This function returns the quotient of two complex numbers.",[f("complexnum"),f("complexdenom")]),IMEXP:c("This function returns the exponential of a complex number.",[f("complexnum")]),IMLN:c("This function returns the natural logarithm of a complex number.",[f("complexnum")]),IMLOG2:c("This function returns the base-2 logarithm of a complex number.",[f("complexnum")]),IMLOG10:c("This function returns the common logarithm of a complex number.",[f("complexnum")]),IMPOWER:c("This function returns a complex number raised to a power.",[f("complexnum"),f("powernum")]),IMPRODUCT:c("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[f("complexnum1"),f("complexnum2",!0)]),IMREAL:c("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[f("complexnum")]),IMSIN:c("This function returns the sine of a complex number in the x+yi or x+yj text format.",[f("complexnum")]),IMSQRT:c("This function returns the square root of a complex number in the x+yi or x+yj text format.",[f("complexnum")]),IMSUB:c("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[f("complexnum1"),f("complexnum2")]),IMSUM:c("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[f("complexnum1"),f("complexnum2",!0)]),INDEX:c("This function returns a value or the reference to a value from within an array or range.",[f("array"),f("row_num"),f("column_num"),f("area_num")]),INDIRECT:c("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[f("ref_text"),f("[a1_style]")]),INT:c("This function rounds a specified number down to the nearest integer.",[f("number")]),INTERCEPT:c("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[f("dependent"),f("independent")]),INTRATE:c("This function calculates the interest rate for a fully invested security.",[f("settlement"),f("maturity"),f("investment"),f("redemption"),f("basis")]),IPMT:c("This function calculates the payment of interest on a loan.",[f("rate"),f("per"),f("nper"),f("pval"),f("fval"),f("type")]),IRR:c("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[f("arrayvals"),f("estimate")]),ISBLANK:c("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[f("cellreference")]),ISERR:c("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[f("cellreference")]),ISERROR:c("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[f("cellreference")]),ISEVEN:c("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[f("cellreference")]),ISLOGICAL:c("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[f("cellreference")]),ISNA:c("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[f("cellreference")]),ISNONTEXT:c("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[f("cellreference")]),ISNUMBER:c("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[f("cellreference")]),ISODD:c("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[f("cellreference")]),ISPMT:c("This function calculates the interest paid during a specific period of an investment.",[f("rate"),f("per"),f("nper"),f("pv")]),ISREF:c("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[f("cellreference")]),ISTEXT:c("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[f("cellreference")]),KURT:c("This function returns the kurtosis of a data set.",[f("number1"),f("number2"),f("number3"),f("number4",!0)]),LARGE:c("This function returns the nth largest value in a data set, where n is specified.",[f("array"),f("n")]),LCM:c("This function returns the least common multiple of two numbers.",[f("number1"),f("number2")]),LEFT:c("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[f("text"),f("num_chars")]),LEN:c("This function returns the length of the number of characters in a text string.",[f("text")]),LINEST:c("This function calculates the statistics for a line.",[f("y"),f("x"),f("constant"),f("stats")]),LN:c("This function returns the natural logarithm of the specified number.",[f("value")]),LOG:c("This function returns the logarithm base Y of a number X.",[f("number"),f("base")]),LOG10:c("This function returns the logarithm base 10 of the number given.",[f("number")]),LOGEST:c("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[f("y"),f("x"),f("constant"),f("stats")]),LOGINV:c("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[f("probability"),f("mean"),f("standard_dev")]),LOGNORMDIST:c("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[f("x"),f("mean"),f("standard_dev")]),LOOKUP:c("This function searches for a value and returns a value from the same location in a second area.",[f("lookup_value"),f("lookup_vector"),f("result_vector")]),LOWER:c("This function converts text to lower case letters.",[f("text")]),MATCH:c("This function returns the relative position of a specified item in a range.",[f("lookup_value"),f("lookup_array"),f("match_type")]),XMATCH:c("This function returns the relative position of an item in an array. By default, an exact match is required.",[f("lookup_value"),f("lookup_array"),f(i="match_mode",!(u=[{value:"1",description:"Search first-to-last (default)"},{value:"-1",description:"Search last-to-first (reverse search)"},{value:"2",description:"Perform a binary search that relies on lookup_array being sorted in ascending order. If not sorted, invalid results will be returned. "},{value:"-2",description:"Perform a binary search that relies on lookup_array being sorted in descending order. If not sorted, invalid results will be returned."}]),!0,e=[{value:"0",description:"Exact match (default)"},{value:"-1",description:"Exact match or next smallest item"},{value:"1",description:"Exact match or next largest item"},{value:"2",description:"A wildcard match where *, ?, and ~ have special meaning."}]),f("search_mode",!(a=[{value:"0",description:"Case sensitive"},{value:"1",description:"Case insensitive"}]),!0,u)]),XLOOKUP:c("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[f("lookup_value"),f("lookup_array"),f("return_array"),f(r="[if_not_found]"),f(i,!(o="[pad_with]"),!0,e),f("search_mode",!(e="[significance]"),!0,u)]),MAX:c("This function returns the maximum value, the greatest value, of all the values in the arguments.",[f("number1"),f("number2",!0)]),MAXA:c("This function returns the largest value in a list of arguments, including text and logical values.",[f("value1"),f("value2",!0)]),MDETERM:c("This function returns the matrix determinant of an array.",[f("array")]),MDURATION:c("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[f("settlement"),f("maturity"),f("coupon"),f("yield"),f("frequency"),f("basis")]),MEDIAN:c("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[f("number1"),f("number2",!0)]),MID:c("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[f("text"),f("start_num"),f("num_chars")]),MIN:c("This function returns the minimum value, the least value, of all the values in the arguments.",[f("number1"),f("number2",!0)]),MINA:c("This function returns the minimum value in a list of arguments, including text and logical values.",[f("value1"),f("value2",!0)]),MINUTE:c("This function returns the minute corresponding to a specified time.",[f("time")]),MINVERSE:c("This function returns the inverse matrix for the matrix stored in an array.",[f("array")]),MIRR:c("This function returns the modified internal rate of return for a series of periodic cash flows.",[f("values"),f("finance_rate"),f("reinvest_rate")]),MMULT:c("This function returns the matrix product for two arrays.",[f("array1"),f("array2")]),MOD:c("This function returns the remainder of a division operation.",[f("dividend"),f("divisor")]),MODE:c("This function returns the most frequently occurring value in a set of data.",[f("number1"),f("number2",!0)]),MONTH:c("This function returns the month corresponding to the specified date value.",[f("date")]),MROUND:c("This function returns a number rounded to the desired multiple.",[f("number"),f("multiple")]),MULTINOMIAL:c("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[f("number1"),f("number2",!0)]),MUNIT:c("The function returns the unit matrix for the specified dimension.",[f("dimension")]),N:c("This function returns a value converted to a number.",[f("value")]),NA:c("This function returns the error value #N/A that means not available.",[]),SHEET:c("Returns the sheet number of reference sheet.",[f("[value]")]),SHEETS:c("Returns the number of sheets in a reference.",[f("[reference]")]),NEGBINOMDIST:c("This function returns the negative binomial distribution.",[f("number_f"),f("number_s"),f("probability_s")]),NETWORKDAYS:c("This function returns the total number of complete working days between the start and end dates.",[f("start_date"),f("end_date"),f("holidays")]),NOMINAL:c("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[f("effect_rate"),f("npery")]),NORMDIST:c("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[f("x"),f("mean"),f("standard_dev"),f("cumulative")]),NORMINV:c("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[f("probability"),f("mean"),f("standard_dev")]),NORMSDIST:c("This function returns the standard normal cumulative distribution function.",[f("value")]),NORMSINV:c("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[f("probability")]),NOT:c("This function reverses the logical value of its argument.",[f("logical")]),NOW:c("This function returns the current date and time.",[]),NPER:c("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[f("rate"),f("paymt"),f("pval"),f("fval"),f("type")]),NPV:c("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[f("rate"),f("value1"),f("value2",!0)]),OBJECT:c("This function converts the property/expression sequence to an object.",[f("property1",!0),f("expression1",!0)]),OCT2BIN:c("This function converts an octal number to a binary number.",[f("number"),f("places")]),OCT2DEC:c("This function converts an octal number to a decimal number.",[f("number")]),OCT2HEX:c("This function converts an octal number to a hexadecimal number.",[f("number"),f("places")]),ODD:c("This function rounds the specified value up to the nearest odd integer.",[f("number")]),ODDFPRICE:c("This function calculates the price per $100 face value of a security with an odd first period.",[f("settlement"),f("maturity"),f("issue"),f("first_coupon"),f("rate"),f("yield"),f("redemption"),f("frequency"),f("basis")]),ODDFYIELD:c("This function calculates the yield of a security with an odd first period.",[f("settlement"),f("maturity"),f("issue"),f("first_coupon"),f("rate"),f("price"),f("redemption"),f("frequency"),f("basis")]),ODDLPRICE:c("This function calculates the price per $100 face value of a security with an odd last coupon period.",[f("settlement"),f("maturity"),f("last_interest"),f("rate"),f("yield"),f("redemption"),f("frequency"),f("basis")]),ODDLYIELD:c("This function calculates the yield of a security with an odd last period.",[f("settlement"),f("maturity"),f("last_interest"),f("rate"),f("price"),f("redemption"),f("frequency"),f("basis")]),OFFSET:c("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[f("reference"),f("rows"),f("cols"),f("height"),f("width")]),OR:c("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[f("logical1"),f("logical2",!0)]),PEARSON:c("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[f("array_ind"),f("array_dep")]),PERCENTILE:c("This function returns the nth percentile of values in a range.",[f("array"),f("n")]),PERCENTRANK:c("This function returns the rank of a value in a data set as a percentage of the data set.",[f("array"),f("x"),f("significance")]),PERMUT:c("This function returns the number of possible permutations for a specified number of items.",[f("number"),f("number_chosen")]),PI:c("This function returns PI as 3.1415926536.",[]),PMT:c("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[f("rate"),f("nper"),f("pval"),f("fval"),f("type")]),POISSON:c("This function returns the Poisson distribution.",[f("nevents"),f("mean"),f("cumulative")]),POWER:c("This function raises the specified number to the specified power.",[f("number"),f("power")]),PPMT:c("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[f("rate"),f("per"),f("nper"),f("pval"),f("fval"),f("type")]),PRICE:c("This function calculates the price per $100 face value of a periodic interest security",[f("settlement"),f("maturity"),f("rate"),f("yield"),f("redemption"),f("frequency"),f("basis")]),PRICEDISC:c("This function returns the price per $100 face value of a discounted security.",[f("settlement"),f("maturity"),f("discount"),f("redemption"),f("basis")]),PRICEMAT:c("This function returns the price at maturity per $100 face value of a security that pays interest.",[f("settlement"),f("maturity"),f("issue"),f("rate"),f("yield"),f("basis")]),PROB:c("This function returns the probability that values in a range are between two limits.",[f("x_range"),f("prob_range"),f("lower_limit"),f("upper_limit")]),PRODUCT:c("This function multiplies all the arguments and returns the product.",[f("number1"),f("number2",!0)]),PROPER:c("This function capitalizes the first letter in each word of a text string.",[f("text")]),PROPERTY:c("This function returns the value of property path in object.",[f("data_expression"),f("property_path")]),PV:c("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[f("rate"),f("numper"),f("paymt"),f("fval"),f("type")]),QUARTILE:c("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[f("array"),f("quart")]),QUOTIENT:c("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[f("numerator"),f("denominator")]),RADIANS:c("This function converts the specified number from degrees to radians.",[f("angle")]),RAND:c("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:c("This function returns a random number between the numbers you specify.",[f("bottom"),f("top")]),RANGEBLOCKSPARKLINE:c("This function returns a rangetemplate.",[f("template_range"),f("data_expression")]),RANK:c("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[f("number"),f("ref"),f("order")]),RATE:c("This function returns the interest rate per period of an annuity.",[f("nper"),f("pmt"),f("pval"),f("fval"),f("type"),f("guess")]),RECEIVED:c("This function returns the amount received at maturity for a fully invested security.",[f("settlement"),f("maturity"),f("investment"),f("discount"),f("basis")]),REPLACE:c("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[f("old_text"),f("start_num"),f("num_chars"),f("new_text")]),REPT:c("This function repeats text a specified number of times.",[f("text"),f("number_times")]),RIGHT:c("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[f("text"),f("num_chars")]),ROMAN:c("This function converts an Arabic numeral to a Roman numeral text equivalent.",[f("number"),f("form")]),ROUND:c("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[f("number"),f("num_digits")]),ROUNDDOWN:c("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[f("number"),f("num_digits")]),ROUNDUP:c("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[f("number"),f("num_digits")]),ROW:c("This function returns the number of a row from a reference.",[f("reference")]),ROWS:c("This function returns the number of rows in an array.",[f("array")]),RSQ:c("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[f("array_dep"),f("array_ind")]),SEARCH:c("This function finds one text string in another text string and returns the index of the starting position of the found text.",[f("find_text"),f("within_text"),f(n)]),SECOND:c("This function returns the seconds (0 to 59) value for a specified time.",[f("time")]),SERIESSUM:c("This function returns the sum of a power series.",[f("x"),f("n"),f("m"),f("coefficients")]),SIGN:c("This function returns the sign of a number or expression.",[f("cellreference")]),SIN:c("This function returns the sine of the specified angle.",[f("angle")]),SINH:c("This function returns the hyperbolic sine of the specified number.",[f("number")]),SKEW:c("This function returns the skewness of a distribution.",[f("number1"),f("number2",!0)]),SLN:c("This function returns the straight-line depreciation of an asset for one period.",[f("cost"),f("salvage"),f("life")]),SLOPE:c("This function calculates the slope of a linear regression.",[f("array_dep"),f("array_ind")]),SMALL:c("This function returns the nth smallest value in a data set, where n is specified.",[f("array"),f("n")]),SQRT:c("This function returns the positive square root of the specified number.",[f("value")]),SQRTPI:c("This function returns the positive square root of a multiple of pi (p).",[f("multiple")]),STANDARDIZE:c("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[f("x"),f("mean"),f("standard_dev")]),STDEVA:c("This function returns the standard deviation for a set of numbers, text, or logical values.",[f("value1"),f("value2",!0)]),STDEVP:c("This function returns the standard deviation for an entire specified population (of numeric values).",[f("number1"),f("number2",!0)]),STDEVPA:c("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[f("value1"),f("value2",!0)]),STEYX:c("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[f("array_dep"),f("array_ind")]),SUBSTITUTE:c("This function substitutes a new string for specified characters in an existing string.",[f("text"),f("old_text"),f("new_text"),f("instance_num")]),SUBTOTAL:c("This function calculates a subtotal of a list of numbers using a specified built-in function.",[f("function_num"),f("ref1"),f("ref2",!0)]),SUM:c("This function returns the sum of cells or range of cells.",[f("number1"),f("number2",!0)]),SUMIF:c("This function adds the cells using a given criteria.",[f("range"),f("criteria"),f("sum_range")]),SUMIFS:c("This function adds the cells in a range using multiple criteria.",[f("sum_range"),f("criteria_range1"),f("criteria1"),f("criteria_range2",!0),f("criteria2",!0)]),SUMPRODUCT:c("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[f("array1"),f("array2",!0)]),SUMSQ:c("This function returns the sum of the squares of the arguments.",[f("number1"),f("number2",!0)]),SUMX2MY2:c("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[f("array_x"),f("array_y")]),SUMX2PY2:c("This function returns the sum of the sum of squares of corresponding values in two arrays.",[f("array_x"),f("array_y")]),SUMXMY2:c("This function returns the sum of the square of the differences of corresponding values in two arrays.",[f("array_x"),f("array_y")]),SYD:c("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[f("cost"),f("salvage"),f("life"),f("period")]),T:c("This function returns the text in a specified cell.",[f("value")]),TAN:c("This function returns the tangent of the specified angle.",[f("angle")]),TANH:c("This function returns the hyperbolic tangent of the specified number.",[f("number")]),TBILLEQ:c("This function returns the equivalent yield for a Treasury bill (or T-bill)",[f("settlement"),f("maturity"),f("discount")]),TBILLPRICE:c("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[f("settlement"),f("maturity"),f("discount")]),TBILLYIELD:c("This function returns the yield for a Treasury bill (or T-bill).",[f("settlement"),f("maturity"),f("priceper")]),TDIST:c("This function returns the probability for the t-distribution.",[f("x"),f("deg_freedom"),f("tails")]),TEXT:c("This function formats a number and converts it to text.",[f("value"),f("format_text")]),TIME:c("This function returns the TimeSpan object for a specified time.",[f("hour"),f("minute"),f("second")]),TIMEVALUE:c("This function returns the TimeSpan object of the time represented by a text string.",[f("time_text")]),TINV:c("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[f("probability"),f("deg_freedom")]),TODAY:c("This function returns the date and time of the current date.",[]),TRANSPOSE:c("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[f("array")]),TREND:c("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[f("y"),f("x"),f("newx"),f("constant")]),TRIM:c("This function removes extra spaces from a string and leaves single spaces between words.",[f("text")]),TRIMMEAN:c("This function returns the mean of a subset of data excluding the top and bottom data.",[f("array"),f("percent")]),TRUE:c("This function returns the value for logical TRUE.",[]),TRUNC:c("This function removes the specified fractional part of the specified number.",[f("number"),f("num_digits")]),TTEST:c("This function returns the probability associated with a t-test.",[f("array1"),f("array2"),f("tails"),f("type")]),TYPE:c("This function returns the type of value.",[f("value")]),UPPER:c("This function converts text to uppercase letters.",[f("text")]),VALUE:c("This function converts a text string that is a number to a numeric value.",[f("text")]),VAR:c("This function returns the variance based on a sample of a population, which uses only numeric values.",[f("number1"),f("number2",!0)]),VARA:c("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[f("value1"),f("value2",!0)]),VARP:c("This function returns variance based on the entire population, which uses only numeric values.",[f("number1"),f("number2",!0)]),VARPA:c("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[f("value1"),f("value2",!0)]),VDB:c("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[f("cost"),f("salvage"),f("life"),f("start_period"),f("end_period"),f("factor"),f("no_switch")]),VLOOKUP:c("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[f("lookup_value"),f("table_array"),f("col_index_num"),f("range_lookup",!1,!0,s)]),WEEKDAY:c("This function returns the number corresponding to the day of the week for a specified date.",[f("date"),f("type")]),WEEKNUM:c("This function returns a number that indicates the week of the year numerically.",[f("date"),f("weektype")]),DATEPART:c("This function formats a date and converts it to text.",[f("date"),f("format_text"),f("weektype")]),WEIBULL:c("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[f("x"),f("alpha"),f("beta"),f("cumulative")]),WORKDAY:c("This function returns the number of working days before or after the starting date.",[f("start_date"),f("days"),f("holidays")]),XIRR:c("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[f("values"),f("dates"),f("guess")]),XNPV:c("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[f("rate"),f("values"),f("dates")]),YEAR:c("This function returns the year as an integer for a specified date.",[f("date")]),YEARFRAC:c("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[f("start_date"),f("end_date"),f("basis")]),YIELD:c("This function calculates the yield on a security that pays periodic interest.",[f("settlement"),f("maturity"),f("rate"),f("price"),f("redemption"),f("frequency"),f("basis")]),YIELDDISC:c("This function calculates the annual yield for a discounted security.",[f("settlement"),f("maturity"),f("price"),f("redemption"),f("basis")]),YIELDMAT:c("This function calculates the annual yield of a security that pays interest at maturity.",[f("settlement"),f("maturity"),f("issue"),f("rate"),f("price"),f("basis")]),ZTEST:c("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[f("array"),f("x"),f("sigma")]),HBARSPARKLINE:c("This function returns a data set used for representing a Hbar sparkline",[f("value"),f("colorScheme"),f("axisVisible"),f("barHeight")]),VBARSPARKLINE:c("This function returns a data set used for representing a Vbar sparkline",[f("value"),f("colorScheme"),f("axisVisible"),f("barWidth")]),VARISPARKLINE:c("This function returns a data set used for representing a variance sparkline",[f("variance"),f("reference"),f("mini"),f("maxi"),f("mark"),f("tickunit"),f("legend"),f("colorPositive"),f("colorNegative"),f("vertical")]),LOLLIPOPVARISPARKLINE:c("This function returns a data set used for representing an absolute or relative lollipop variance sparkline",[f("plannedValue"),f("actualValue"),f("index"),f("absolute"),f("reference"),f("mini"),f("maxi"),f("tickunit"),f("legend"),f("colorPositive"),f("colorNegative"),f("lollipopHeaderColor"),f("vertical")]),PIESPARKLINE:c("This function returns a data set used for representing a pie sparkline",[f("range|percentage"),f("color",!0)]),AREASPARKLINE:c("This function returns a data set used for representing a area sparkline",[f("points"),f("mini"),f("maxi"),f("line1"),f("line2"),f("colorPositive"),f("colorNegative")]),SCATTERSPARKLINE:c("This function returns a data set used for representing a scatter sparkline",[f("points1"),f("points2"),f("minX"),f("maxX"),f("minY"),f("maxY"),f("hLine"),f("vLine"),f("xMinZone"),f("xMaxZone"),f("yMinZone"),f("yMaxZone"),f("tags"),f("drawSymbol"),f("drawLines"),f("color1"),f("color2"),f("dash")]),LINESPARKLINE:c("This function returns a data set used for representing a line sparkline",[f("data"),f("dataOrientation"),f("dateAxisData"),f("dateAxisOrientation"),f("setting")]),COLUMNSPARKLINE:c("This function returns a data set used for representing a column sparkline",[f("data"),f("dataOrientation"),f("dateAxisData"),f("dateAxisOrientation"),f("setting")]),WINLOSSSPARKLINE:c("This function returns a data set used for representing a win/loss sparkline",[f("data"),f("dataOrientation"),f("dateAxisData"),f("dateAxisOrientation"),f("setting")]),BULLETSPARKLINE:c("This function returns a data set used for representing a bullet sparkline",[f("measure"),f("target"),f("maxi"),f("good"),f("bad"),f("forecast"),f("tickunit"),f("colorScheme"),f("vertical"),f("measureColor"),f("targetColor"),f("maxiColor"),f("goodColor"),f("badColor"),f("forecastColor"),f("allowMeasureOverMaxi"),f("barSize")]),SPREADSPARKLINE:c("This function returns a data set used for representing a spread sparkline",[f("points"),f("showAverage"),f("scaleStart"),f("scaleEnd"),f("style"),f("colorScheme"),f("vertical")]),STACKEDSPARKLINE:c("This function returns a data set used for representing a stacked sparkline",[f("points"),f("colorRange"),f("labelRange"),f("maximum"),f("targetRed"),f("targetGreen"),f("targetBlue"),f("tragetYellow"),f("color"),f("highlightPosition"),f("vertical"),f("textOrientation"),f("textSize")]),BOXPLOTSPARKLINE:c("This function returns a data set used for representing a boxplot sparkline",[f("points"),f("boxPlotClass"),f("showAverage"),f("scaleStart"),f("scaleEnd"),f("acceptableStart"),f("acceptableEnd"),f("colorScheme"),f("style"),f("vertical")]),CASCADESPARKLINE:c("This function returns a data set used for representing a cascade sparkline",[f("pointsRange"),f("pointIndex"),f("labelsRange"),f("minimum"),f("maximum"),f("colorPositive"),f("colorNegative"),f("vertical"),f("itemTypeRange"),f("colorTotal")]),PARETOSPARKLINE:c("This function returns a data set used for representing a pareto sparkline",[f("points"),f("pointIndex"),f("colorRange"),f("target"),f("target2"),f("highlightPosition"),f("label"),f("vertical"),f("targetColor"),f("target2Color"),f("labelColor"),f("barSize")]),MONTHSPARKLINE:c("This function returns a data set used for representing a month sparkline",[f("year"),f("month"),f("dataRange"),f("emptyColor"),f("startColor"),f("middleColor"),f("endColor")]),YEARSPARKLINE:c("This function returns a data set used for representing a year sparkline",[f("year"),f("dataRange"),f("emptyColor"),f("startColor"),f("middleColor"),f("endColor")]),GAUGEKPISPARKLINE:c("This function returns a data set used for representing a gauge KPI sparkline",[f("targetValue"),f("currentValue"),f("minValue"),f("maxValue"),f("showLabel"),f("targetValueLabel"),f("currentValueLabel"),f("minValueLabel"),f("maxValueLabel"),f("fontArray"),f("minAngle"),f("maxAngle"),f("radiusRatio"),f("gaugeType"),f("colorRange"),f("...")]),HISTOGRAMSPARKLINE:c("This function returns a data set used for representing a histogram sparkline",[f("dateRange"),f("continuous"),f("paintLabel"),f("scale"),f("barWidth"),f("barColor"),f("labelFontStyle"),f("labelColor"),f("edgeColor")]),"CEILING.PRECISE":c("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[f("number"),f(e)]),"COVARIANCE.S":c("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[f("array1"),f("array2")]),"FLOOR.PRECISE":c("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[f("number"),f(e)]),"PERCENTILE.EXC":c("This function returns the nth percentile of values in a range.",[f("array"),f("k")]),"QUARTILE.EXC":c("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[f("array"),f("quart")]),"RANK.AVG":c("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[f("number"),f("ref"),f("[order]")]),"MODE.MULT":c("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[f("number1"),f("number2",!0)]),"STDEV.P":c("This function returns the standard deviation for an entire specified population (of numeric values).",[f("number1"),f("number2",!0)]),"VAR.P":c("This function returns variance based on the entire population, which uses only numeric values.",[f("number1"),f("number2",!0)]),"COVARIANCE.P":c("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[f("array1"),f("array2")]),"MODE.SNGL":c("This function returns the most frequently occurring value in a set of data.",[f("number1"),f("number2",!0)]),"PERCENTILE.INC":c("This function returns the nth percentile of values in a range.",[f("array"),f("k")]),"QUARTILE.INC":c("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[f("array"),f("quart")]),"RANK.EQ":c("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[f("number"),f("ref"),f("[order]")]),STDEV:c("This function returns standard deviation is estimated based on a sample.",[f("number1"),f("number2",!0)]),"STDEV.S":c("This function returns standard deviation is estimated based on a sample.",[f("number1"),f("number2",!0)]),"VAR.S":c("This function returns the variance based on a sample of a population, which uses only numeric values.",[f("number1"),f("number2",!0)]),"BETA.INV":c("This function calculates the inverse of the cumulative beta distribution function.",[f("probability"),f("alpha"),f("beta"),f("[lower]"),f("[upper]")]),"BINOM.DIST":c("This function calculates the individual term binomial distribution probability.",[f("number_s"),f("trials"),f("probability_s"),f("cumulative")]),"BINOM.INV":c("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[f("trials"),f("probability_s"),f("alpha")]),"CHISQ.DIST.RT":c("This function calculates the one-tailed probability of the chi-squared distribution.",[f("value"),f("deg_freedom")]),"CHISQ.INV.RT":c("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[f("probability"),f("deg_freedom")]),"CHISQ.TEST":c("This function calculates the test for independence from the chi-squared distribution.",[f("actual_range"),f("expected_range")]),"CONFIDENCE.NORM":c("This function returns confidence interval for a population mean.",[f("alpha"),f("standard_dev"),f("size")]),"EXPON.DIST":c("This function returns the exponential distribution or the probability density.",[f("value"),f("lambda"),f("cumulative")]),"F.DIST.RT":c("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[f("value"),f("deg_freedom1"),f("deg_freedom2")]),"F.INV.RT":c("This function returns the inverse of the F probability distribution.",[f("probability"),f("deg_freedom1"),f("deg_freedom2")]),"F.TEST":c("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[f("array1"),f("array2")]),"GAMMA.DIST":c("This function returns the gamma distribution.",[f("x"),f("alpha"),f("beta"),f("cumulative")]),"GAMMA.INV":c("This function returns the inverse of the gamma cumulative distribution.",[f("probability"),f("alpha"),f("beta")]),"LOGNORM.INV":c("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[f("probability"),f("mean"),f("standard_dev")]),"NORM.DIST":c("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[f("x"),f("mean"),f("standard_dev"),f("cumulative")]),"NORM.INV":c("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[f("probability"),f("mean"),f("standard_dev")]),"NORM.S.INV":c("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[f("probability")]),"PERCENTRANK.INC":c("This function returns the rank of a value in a data set as a percentage of the data set.",[f("array"),f("n"),f(e)]),"POISSON.DIST":c("This function returns the Poisson distribution.",[f("nevents"),f("mean"),f("cumulative")]),"T.INV.2T":c("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[f("probability"),f("deg_freedom")]),"T.TEST":c("This function returns the probability associated with a t-test.",[f("array1"),f("array2"),f("tails"),f("type")]),"WEIBULL.DIST":c("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[f("x"),f("alpha"),f("beta"),f("cumulative")]),"Z.TEST":c("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[f("array"),f("x"),f("[sigma]")]),"T.DIST.RT":c("This function returns the right-tailed t-distribution.",[f("x"),f("deg_freedom")]),"T.DIST.2T":c("This function returns the two-tailed t-distribution.",[f("x"),f("deg_freedom")]),"ISO.CEILING":c("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[f("number"),f(e)]),"BETA.DIST":c("This function returns the beta distribution.",[f("x"),f("alpha"),f("beta"),f("cumulative"),f("lower"),f("upper")]),"GAMMALN.PRECISE":c("This function returns the natural logarithm of the gamma function.",[f("value")]),"ERF.PRECISE":c("This function returns the error function.",[f("lowerlimit")]),"ERFC.PRECISE":c("This function returns the complementary ERF function.",[f("lowerlimit")]),"PERCENTRANK.EXC":c("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[f("array"),f("x"),f(e)]),"HYPGEOM.DIST":c("This function returns the hypergeometric distribution.",[f("sample_s"),f("number_sample"),f("population_s"),f("number_pop"),f("cumulative")]),"LOGNORM.DIST":c("This function returns the log normal distribution of x.",[f("x"),f("mean"),f("stdev"),f("cumulative")]),"NEGBINOM.DIST":c("This function returns the negative binomial distribution.",[f("number_f"),f("number_s"),f("probability_s"),f("cumulative")]),"NORM.S.DIST":c("This function returns the standard normal distribution.",[f("z"),f("cumulative")]),"T.DIST":c("This function returns the t-distribution.",[f("x"),f("deg_freedom"),f("cumulative")]),"F.DIST":c("This function returns the F probability distribution.",[f("x"),f("deg_freedom1"),f("deg_freedom2"),f("cumulative")]),"CHISQ.DIST":c("This function returns the chi-squared distribution.",[f("x"),f("deg_freedom"),f("cumulative")]),"F.INV":c("This function returns the inverse of the F probability distribution.",[f("probability"),f("deg_freedom1"),f("deg_freedom2")]),"T.INV":c("This function returns the left-tailed inverse of the t-distribution.",[f("probability"),f("deg_freedom")]),"CHISQ.INV":c("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[f("probability"),f("deg_freedom")]),"CONFIDENCE.T":c("This function returns the confidence interval for a Student's t distribution.",[f("alpha"),f("standard_dev"),f("size")]),"NETWORKDAYS.INTL":c("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[f("start_date"),f("end_date"),f("[weekend]"),f("[holidays]")]),"WORKDAY.INTL":c("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[f("start_date"),f("days"),f("[weekend]"),f("[holidays]")]),REFRESH:c("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[f("formula"),f("evaluateMode"),f("interval")]),DAYS:c("This function returns the number of days between two dates.",[f("end_date"),f("start_date")]),ISOWEEKNUM:c("This function returns the number of the ISO week number of the year for a given date.",[f("date")]),BITAND:c('This function returns a bitwise "AND" of two numbers.',[f("number1"),f("number2")]),BITLSHIFT:c('This function returns a bitwise "OR" of two numbers.',[f("number"),f("shift_amount")]),BITOR:c('This function returns a bitwise "OR" of two numbers.',[f("number1"),f("number2")]),BITRSHIFT:c('This function returns a bitwise "OR" of two numbers.',[f("number"),f("shift_amount")]),BITXOR:c('This function returns a bitwise "XOR" of two numbers.',[f("number1"),f("number2")]),IMCOSH:c("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[f("complexnum")]),IMCOT:c("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[f("complexnum")]),IMCSC:c("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[f("complexnum")]),IMCSCH:c("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[f("complexnum")]),IMSEC:c("This function returns the secant of a complex number in x+yi of x+yj text format.",[f("complexnum")]),IMSECH:c("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[f("complexnum")]),IMSINH:c("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[f("complexnum")]),IMTAN:c("This function returns the tangent of a complex number in x+yi or x+yj text format.",[f("complexnum")]),PDURATION:c("This function returns the number of periods required by an investment to reach a specified value.",[f("rate"),f("pval"),f("fval")]),RRI:c("This function returns an equivalent interest rate for the growth of an investment.",[f("nper"),f("pval"),f("fval")]),ISFORMULA:c("This function tests whether contains a formula of a referenced cell.",[f("cellreference")]),IFNA:c("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[f("value"),f("value_if_na")]),IFS:c("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[f("logical_test1"),f("value_if_true1"),f("logical_test2",!0),f("value_if_true2",!0)]),SWITCH:c("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[f("expression"),f("value1"),f("result1"),f("[default_or_value2]",!0),f("[result2]",!0)]),XOR:c("This function returns a logical exclusive or of all arguments.",[f("logical",!0)]),AREAS:c("This function returns the number of areas in a reference.",[f("reference")]),FORMULATEXT:c("This function returns a formula as a string.",[f("reference")]),HYPERLINK:c("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[f("link_location"),f("friendly_name")]),ACOT:c("This function calculates the inverse arccotangent of a number.",[f("number")]),ACOTH:c("This function calculates the inverse hyperbolic arccotangent of a number.",[f("number")]),ARABIC:c("This function converts a Roman numeral text to an Arabic numeral equivalent.",[f("text")]),BASE:c("This function converts a number into a text representation with the given radix (base).",[f("number"),f("radix"),f("[min_length]")]),"CEILING.MATH":c("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[f("number"),f(e),f("[mode]")]),COMBINA:c("This function calculates the number of possible combinations with repetitions for a specified number of items.",[f("number"),f("number_chosen")]),COT:c("This function returns the cotangent of the specified angle.",[f("angle")]),COTH:c("This function returns the hyperbolic cotangent of the specified number.",[f("value")]),CSC:c("This function returns the cosecant of the specified angle.",[f("angle")]),CSCH:c("This function returns the hyperbolic cosecant of the specified number.",[f("value")]),DECIMAL:c("This function converts a text representation of a number in a given base into a decimal number.",[f("text"),f("radix")]),"FLOOR.MATH":c("This function round a number down to the nearest integer or to the nearest multiple of significance.",[f("number"),f(e),f("[mode]")]),SEC:c("This function returns the secant of the specified angle.",[f("angle")]),SECH:c("This function returns the hyperbolic secant of the specified value.",[f("value")]),"BINOM.DIST.RANGE":c("This function calculates the probability of a trial result using a binomial distribution.",[f("trials"),f("probability_s"),f("number_s"),f("[number_s2]")]),GAMMA:c("This function returns the gamma function value.",[f("number")]),MAXIFS:c("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[f("max_range"),f("criteria_range1"),f("criteria1"),f("criteria_range2",!0),f("criteria2",!0)]),GAUSS:c("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[f("number")]),MINIFS:c("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[f("min_range"),f("criteria_range1"),f("criteria1"),f("criteria_range2",!0),f("criteria2",!0)]),PERMUTATIONA:c("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[f("number"),f("number_chosen")]),PHI:c("This function returns the value of the density function for a standard normal distribution.",[f("value")]),"SKEW.P":c("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[f("number1"),f("number2",!0)]),BAHTTEXT:c('This function converts a number to Thai text and adds a suffix of "Baht"',[f("number")]),CONCAT:c('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[f("text1"),f("text2",!0)]),FINDB:c("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[f("find_text"),f("within_text"),f(n)]),LEFTB:c("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[f("text"),f("num_bytes")]),LENB:c("This function returns the length of the number of bytes in a text string.",[f("text")]),MIDB:c("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[f("text"),f("start_num"),f("num_bytes")]),REPLACEB:c("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[f("old_text"),f("start_byte"),f("num_bytes"),f("new_text")]),RIGHTB:c("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[f("text"),f("num_bytes")]),SEARCHB:c("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[f("find_text"),f("within_text"),f(n)]),TEXTJOIN:c("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[f("delimiter"),f("ignore_empty"),f("text1"),f("text2",!0)]),UNICHAR:c("This function returns the Unicode character of a given numeric reference.",[f("number")]),UNICODE:c("This function returns the number corresponding to the first character of the text.",[f("text")]),ENCODEURL:c("This function returns a URL-encoded string.",[f("text")]),BC_QRCODE:c("This function returns a data set for representing a QRCode",[f("value"),f("color"),f("backgroundColor"),f("errorCorrectionLevel"),f("model"),f("version"),f("mask"),f("connection"),f("connectionNo"),f("charCode"),f("charset"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_EAN13:c("This function returns a data set for representing a EAN13.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("addOn"),f("addOnLabelPosition"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_EAN8:c("This function returns a data set for representing a EAN8.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_CODABAR:c("This function returns a data set for representing a CODABAR.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("checkDigit"),f("nwRatio"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_CODE39:c("This function returns a data set for representing a CODE39.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("labelWithStartAndStopCharacter"),f("checkDigit"),f("nwRatio"),f("fullASCII"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_CODE93:c("This function returns a data set for representing a CODE93.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("checkDigit"),f("fullASCII"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_CODE128:c("This function returns a data set for representing a CODE128.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("codeSet"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_GS1_128:c("This function returns a data set for representing a GS1_128.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_CODE49:c("This function returns a data set for representing a CODE49.",[f("value"),f("color"),f("backgroundColor"),f("showLabel"),f("labelPosition"),f("grouping"),f("groupNo"),f("fontFamily"),f("fontStyle"),f("fontWeight"),f("textDecoration"),f("textAlign"),f("fontSize"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_PDF417:c("This function returns a data set for representing a PDF417.",[f("value"),f("color"),f("backgroundColor"),f("errorCorrectionLevel"),f("rows"),f("columns"),f("compact"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),BC_DATAMATRIX:c("This function returns a data set for representing a DATAMATRIX.",[f("value"),f("color"),f("backgroundColor"),f("eccMode"),f("ecc200SymbolSize"),f("ecc200EncodingMode"),f("ecc00_140SymbolSize"),f("structuredAppend"),f("structureNumber"),f("fileIdentifier"),f("quietZoneLeft"),f("quietZoneRight"),f("quietZoneTop"),f("quietZoneBottom")]),FILTER:c("This function filter a range or array.",[f("array"),f("include"),f("if_empty")]),RANDARRAY:c("This function returns an array of random numbers.",[f("rows"),f("columns"),f("min"),f("max"),f("whole_number")]),SEQUENCE:c("This function returns a sequence of numbers.",[f("rows"),f("columns"),f("start"),f("step")]),SINGLE:c("This function returns a single value when given a value, range or array.",[f("value")]),SORT:c("This function sorts a range or array.",[f("array"),f("sort_index"),f("sort_order"),f("by_col")]),SORTBY:c("This function sorts a range or array based on the values in a corresponding range or array.",[f("array"),f("by_array1"),f("sort_order1"),f("by_array2",!0),f("sort_order2",!0)]),UNIQUE:c("This function returns the unique values from a range or array.",[f("array"),f("by_col"),f("exactly_once")]),QUERY:c("This function returns data from data manager tables in a worksheet.",[f("tableAndRows"),f("columns"),f("returnObject")]),LET:c("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[f("name1"),f("name_value1"),f("name2",!0),f("name_value2",!0),f("calculation")]),IMAGE:c("This function input an URL or a base64 string to show an image in cell",[f("source"),f("[alt_text]"),f("[sizing]"),f("[height]"),f("[width]"),f("[clipY]"),f("[clipX]"),f("[clipHeight]"),f("[clipWidth]"),f("[vAlign]"),f("[hAlign]")]),GETPIVOTDATA:c("This function extracts data stored in a PivotTable",[f("data_field"),f("pivot_table"),f("[field1, item1]"),f("...")]),WEBSERVICE:c("This function returns data from a web service",[f("url")]),FILTERJSON:c("This function parses json string to a scalar value, an object or an array of objects.",[f("json_string")]),ASC:c("The ASC function changes full-width(double-byte) characters to half-width(single-byte) characters, Use with double-byte character sets (DBCS).",[f("text")]),DBCS:c("The DBCS function converts half-width(single-byte) letters within a character string to full-width(double-byte) characters.",[f("text")]),LAMBDA:c("Creates a function value, which can be called within formulas.",[f("parameter_or_calculation"),f("[parameter_or_calculation]",!0)]),MAP:c("Returns an array formed by mapping each value in the array(s) to a new value by applying a LAMBDA to create a new value.",[f("array"),f("lambda_or_array",!0)]),REDUCE:c("Reduces an array to an accumulated value by applying a LAMBDA to each value and returning the total value in the accumulator.",[f("init_value"),f("array"),f("function")]),SCAN:c("Scans an array by applying a LAMBDA to each value and returns an array that has each intermediate value.",[f("init_value"),f("array"),f("function")]),MAKEARRAY:c("Returns a calculated array of a specified row and column size, by applying a LAMBDA.",[f("rows"),f("cols"),f("function")]),BYCOL:c("Applies a LAMBDA to each column and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 3 columns by 1 row.",[f("array"),f("function")]),BYROW:c("Applies a LAMBDA to each row and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 1 column by 2 rows.",[f("array"),f("function")]),ISOMITTED:c("Checks whether the value in a LAMBDA is missing and returns TRUE or FALSE.",[f("argument")]),TEXTBEFORE:c("Returns text that occurs before a given character or string.",[f("text"),f("delimiter"),f("[instance_num]"),f(i,!1,!0,a),f("[match_end]"),f(r)]),TEXTAFTER:c("Returns text that occurs after given character or string.",[f("text"),f("delimiter"),f("[instance_num]"),f(i,!1,!0,a),f("[match_end]"),f(r)]),TEXTSPLIT:c("Splits text strings by using column and row delimiters.",[f("text"),f("col_delimiter"),f("[row_delimiter]"),f("[ignore_empty]"),f(i,!1,!0,a),f(o)]),"SJS.REGEXEXTRACT":c("Extracts matching substrings according to a regular expression.",[f("text"),f("regular_expression"),f("[modifiers]")]),"SJS.REGEXMATCH":c("Whether a piece of text matches a regular expression.",[f("text"),f("regular_expression"),f("[modifiers]")]),"SJS.REGEXREPLACE":c("Replaces part of a text string with a different text string using regular expressions.",[f("text"),f("regular_expression"),f("replacement"),f("[modifiers]")]),VSTACK:c("Appends arrays vertically and in sequence to return a larger array.",[f("array1"),f("[array2]",!0)]),HSTACK:c("Appends arrays horizontally and in sequence to return a larger array.",[f("array1"),f("[array2]",!0)]),TOROW:c("Returns the array in a single row.",[f("array"),f("[ignore]"),f("[scan_by_column]")]),TOCOL:c("Returns the array in a single column.",[f("array"),f("[ignore]"),f("[scan_by_column]")]),WRAPROWS:c("Wraps the provided row or column of values by rows after a specified number of elements to form a new array.",[f("vector"),f("wrap_count"),f(o)]),WRAPCOLS:c("Wraps the provided row or column of values by columns after a specified number of elements to form a new array.",[f("vector"),f("wrap_count"),f(o)]),TAKE:c("Returns a specified number of contiguous rows or columns from the start or end of an array.",[f("array"),f("rows"),f("[columns]")]),DROP:c("Excludes a specified number of rows or columns from the start or end of an array.",[f("array"),f("rows"),f("[columns]")]),EXPAND:c("Expands or pads an array to specified row and column dimensions.",[f("array"),f("rows"),f("[columns]"),f(o)]),CHOOSEROWS:c("Returns the specified rows from an array.",[f("array"),f("row_num1"),f("[row_num2]",!0)]),CHOOSECOLS:c("Returns the specified columns from an array.",[f("array"),f("col_num1"),f("[col_num2]",!0)]),"SJS.UUID":c("Returns the random UUID.",[f("number")]),"SJS.ENDWITH":c("Returns whether str1 ends with str2.",[f("within_text"),f("find_text"),f(i,!1,!0,a)]),"SJS.STARTWITH":c("Returns whether the string str1 starts with str2.",[f("within_text"),f("find_text"),f(i,!1,!0,a)]),"R.INDEX":c("(ReportSheet Specific) Returns the index of the specified cell in the parent measured extension.",[f("reference"),f("[context_reference]")]),"R.RANK":c("(ReportSheet Specific) Returns the rank of the specified cell in the parent node.",[f("reference"),f("[context_reference]"),f("[order]"),f("[rank_mode]")]),"SJS.FISCALYEAR":c("return fiscal year.",[f("date"),f("[start_month]")]),"R.R":c("(ReportSheet Specific) Relative offset according to the specified cell.",[f("reference"),f("offset")]),"R.A":c("(ReportSheet Specific) Absolute offset based on the specified cell.",[f("reference"),f("offset")]),"R.V":c("(ReportSheet Specific) Returns the data in the cell after the coordinate shift.",[f("reference"),f("[offset]",!0)]),"R.CURRENTPAGE":c("(ReportSheet Specific) Returns the current page number of the report.",[]),"R.PAGESCOUNT":c("(ReportSheet Specific) Returns the total number of current reports.",[]),"R.PROPORTION":c("(ReportSheet Specific) Returns the percentage of the specified cell in its parent node.",[f("value_reference"),f("[context_reference1]"),f("[context_reference2]")]),"R.CUMULATIVE":c("(ReportSheet Specific) Returns the accumulated value of the current cell.",[f("value_reference"),f("[context_reference1]"),f("[context_reference2]")]),"R.MOM":c("(ReportSheet Specific) Returns the ring data of the target cell.",[f("value_reference"),f("[context_reference1]"),f("[context_reference2]")]),"R.YOY":c("(ReportSheet Specific) Returns the year-on-year data of the target cell.",[f("value_reference"),f("context_reference1"),f("[context_reference2]")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",d2t:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(k,t,n){var e,O,E,o,i,R,F,l,h,u,a,s,L,B,p,S,A,P,c,f,_,I,d,v,D,j,b,G,U,H,V,z,Y,r,Z;function W(t,n,e,i){return{row:t,col:n,rowCount:e,colCount:i}}function Q(t,n){var e,i,r,o,a,u;if(!n.ITe)for(e=t.getRangeCount(),i=t.rT,r=n.Xkt,o=0;o<e;o++)(a=t.$gt[o]).id=i.id,i.getRangeKey&&(u=i.getRangeKey(i,a),r)&&(r.qkt||(r.qkt={}),r.qkt[u]=a)}function J(t){return t&&t.getRowCount&&(1<t.getRowCount()||1<t.getColumnCount())}function m(t,n,e,i,r,o){this.M8t=0,this.C8t=0,this.S8t=0,this.localScopes=new E.LocalScopes,this.lambdaFunctionCallDepth=0;var a=this;a.source=t,a.arrayFormulaMode=!!e,a.ECe=!(!t||!t.Qpe),a.identity=n||a.T8t(0,0),a.arrayIdentity=i,a.row=i?i.row:a.identity.row||0,a.column=i?i.col:a.identity.col||0,a.rowOffset=i?a.identity.row-i.row:a.row,a.columnOffset=i?a.identity.col-i.col:a.column,a.WK=r,a.Xkt=o}function g(t,n){this.id=t.M8t,t.M8t++,this.ctx=t,this.row=t.row+(t.arrayFormulaMode&&t.rowOffset||0),this.col=t.column+(t.arrayFormulaMode&&t.columnOffset||0),this.node=n}function w(t,n,e,i,r,o,a,u){var a,u,a=Z.call(this,t,isNaN(u)?R:{row:a,col:u},n,isNaN(o)?R:{row:e,col:i,rowCount:r,colCount:o})||this,u=t.op().getGlobalSourceModel(t);return a.A8t=u&&u.getSource(),a}function K(t,n){return t&&n?t.row===n.row&&t.col===n.col:t===n}function y(t){this.service=t,this.asyncManager=new G(this)}function X(t,n){this.id=t,this.Y6=F,this.yL=!1,this.R1t=[],this.I8t=!1,n!==F&&(this.evaluateMode=n)}function M(t){var n=this;n.x8t=[],n.N8t=-1,n.b8t={},n.MX=t,n.k8t=0}function q(t){for(var n,e,e=0;e<t.R1t.length;e++)(n=t.R1t[e]).yL=!1,0<n.R1t.length&&q(n)}function C(t){var n,e,t,n=!0,e=t;return t&&t.getValue&&((t=s(t,0,!1,!1)).isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,n=!1)),{value:e,success:n}}function $(t,n,e){var i,r,o,i=P,r=1===t.rowCount,o=1===t.colCount;return r&&o?t[0][0]:(r&&e<t.colCount?i=t[0][e]:o&&n<t.rowCount?i=t[n][0]:n<t.rowCount&&e<t.colCount&&(i=t[n][e]),i)}function T(t,n,e,i){return a(n)?n:a(e)?e:(0,E.isLambdaFunction)(n)||(0,E.isLambdaFunction)(e)?S:t<=2?tt(t,n,e):t<=14?nt(t,n,e,i):18===t?E.Functions.Mmt.PROPERTY.evaluate(n,e):rt(t,n,e)}function x(t,n,e){var i=t.row,t=t.column;return(e=e||n).$9t=!0,E.Functions.findGlobalFunction("@").evaluate({row:i,column:t},n)}function tt(t,n,e){var n,i,r,o,a,u,s,c;if(0===t)return n;if(""===n&&1===t)return S;if(!n)return 0;if((n=C(n)).success)return N(t,n.value);if(e){for(i=[],o=(r=n.value).rowCount,a=r.colCount,u=0;u<o;u++)for(s=i[u]=[],c=0;c<a;c++)s[c]=N(t,r[u][c]);return new E.CalcArray(i)}}function nt(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,r=t<=7?N:8===t?et:it,o=C(n),a=C(e);if(o.success&&a.success)return r(t,o.value,a.value,i);for(n=o.value,e=a.value,u=o.success?1:n.rowCount,s=o.success?1:n.colCount,c=a.success?1:e.rowCount,f=a.success?1:e.colCount,l=Math.max(u,c),h=Math.max(s,f),d=[],v=0;v<l;v++){for(m=[],g=0;g<h;g++)p=o.success?n:$(n,v,g),b=a.success?e:$(e,v,g),m.push(p===P||b===P?P:r(t,p,b,i));d.push(m)}return new E.CalcArray(d)}function N(t,n,e,i){var r,n,o,e;function a(t){return"string"==typeof t&&0===t.trim().length}if(a(n)||a(e))return S;if(!u(n,r={value:0}))return n instanceof E.CalcError?n:S;if(n=r.value,e!==F){if(!u(e,r))return e instanceof E.CalcError?e:S;o=r.value}else o=0;return 1===t?-n:2===t?n/100:3===t?E.ExcelCompatibleCalcMode&&!i?n+o:O.Common.st.tge(n,o):4===t?E.ExcelCompatibleCalcMode&&!i?n-o:O.Common.st.tge(n,-o):5===t?n*o:6===t?o?n/o:c:7===t?!n&&o<0?c:0===n&&0===o||(e=E.Functions.MathHelper.N9t(n,o))===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY||isNaN(e)?f:e:void 0}function et(t,n,e){if(8===t)return a(n)?n:("number"==typeof n&&(n=O.Common.st.E8(n,E.Functions.CALC_PRECISION||15)),a(e)?e:("number"==typeof e&&(e=O.Common.st.E8(e,E.Functions.CALC_PRECISION||15)),E.Convert.j(n)+E.Convert.j(e)))}function it(t,n,e){var n=(0,E.$kt)(n,e,!1);return a(n)?n:9===t&&0===n||10===t&&0!==n||11===t&&n<0||12===t&&n<=0||13===t&&0<n||14===t&&0<=n}function rt(t,n,e){var i,r,o,t,a,u,s,c,f,o,a,s,t;if(!n||!e||(1!==n.getRangeCount()||1!==e.getRangeCount())&&16!==t||n.endSource||e.endSource)return S;if(!(i=n.getSource())||i!==e.getSource())return S;if(16===t)r=n.$gt.concat(e.$gt);else{if(o=15===t?l:h,t=15===t?h:l,a=n.getRow(0),u=n.getColumn(0),s=e.getRow(0),c=e.getColumn(0),f=o(a,s),o=o(u,c),a=t(a+n.getRowCount(0),s+e.getRowCount(0))-f,s=t(u+n.getColumnCount(0),c+e.getColumnCount(0))-o,a<1||s<1)return E.Errors.Null;r=[W(f,o,a,s)]}return(t=new E.CalcReference(i,r)).V9t=!0,t}function ot(t,n){var e,i,r,o,e=!0;switch(n.J6t){case 0:i=U(t),r=!0;break;case 1:i=parseFloat(t),r=!0;break;case 2:i=H(t),r=!0;break;case 3:i=parseInt(t,10),r=!0;break;case 4:(i=s(t,n.X6t,n.Vkt||!1,n.Ykt||!1,n.M9t||!1,n.Zkt,n.s9t,n.C9t)).isError&&(i=i[0],e=!1),i.isConvertError&&(i=S,e=!1);break;case 5:i=V(t),n.iTe&&""===i&&(i=S,e=!1);break;case 6:z(t,o={value:R})?i=o.value:(i=S,e=!1);break;case 7:i=Y(t);break;case 8:!(i=E.Functions.mkt(t))||n.gkt&&0===i.ikt()&&0===i.rkt()?(i=E.Errors.Number,e=!1):i={okt:i.ikt(),akt:i.rkt()};break;default:i=t}return r&&isNaN(i)&&(i=S,e=!1),{D8t:i,_8t:e}}function at(t,n,e){var i,r,o,a,o;for(Array.isArray(n)||(n=[n]),i=t.D8t,r=0;r<n.length;r++)if(a=(o=n[r].split(" "))[0],o=parseInt(o[1],10),"<"===a&&i<o||">"===a&&o<i||"<="===a&&i<=o||">="===a&&o<=i||"="===a&&i===o||"!="===a&&i!==o||"checkLength"===a&&i.length>o)return t.D8t=e===F?E.Errors.Number:e,void(t._8t=!1)}function ut(t,n){var e,i,r,o,a,u,e=[];if(!n)return{ADt:t,_8t:!0};if(n.n9t)for(o=0;o<t.length;o++)e.push(n);else e=Array.isArray(n)?n:[n];for(r=0;r<e.length;r++){if((a=e[r]).K6t&&!t[r])throw(0,E.sR)().Exp_ArgumentNull;if(u=t[r]!==F){if(i=ot(t[r],a),a.pkt&&at(i,a.pkt,a.zkt),!i._8t)break;t[r]=a.ykt?{ekt:u,y4:i.D8t}:i.D8t}else t[r]=a.ykt?{ekt:u,y4:a.bkt}:a.bkt}return i?{ADt:t,_8t:i._8t,Y6:i.D8t}:void 0}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateOperator=t.AsyncFunctionNode=t.Evaluator=t.GloableEvaluateContext=t.AsyncEvaluateContext=t.EvaluateContext=void 0,O=n("Common"),E=n("./src/calc.common.ts"),o=n("./src/calc.ts"),i=O.Common.lt.ht,R=null,F=void 0,l=Math.min,h=Math.max,u=E.Convert.sJ,a=E.Convert.BJ,s=E.Convert.iV,L=E.Convert.Nh,B=E.Convert.LE,p=E.Errors.Reference,S=E.Errors.Value,A=E.Errors.Name,P=E.Errors.NotAvailable,c=E.Errors.DivideByZero,f=E.Errors.Number,_=E.Errors.Calc,I="LAMBDA",m.prototype.T8t=function(t,n){return{row:t,col:n}},m.prototype.E8t=function(t){return t},m.prototype.getValue=function(t,n){return t?this.E8t(t).getValue(n):p},m.prototype.getReference=function(t,n){return t?this.E8t(t).getReference(n):p},m.prototype.getSheetRangeReference=function(t){return!t||!t.source||!t.endSource||t.source instanceof E.ErrorSource?p:this.E8t(t.source).getSheetRangeReference(t)},m.prototype.getFunction=function(t){var n=this;return n.source?n.source.getCustomFunction(t):R},m.prototype.getName=function(t,n){var e,i,n,e,e=this,i=R;return n?i=n.getCustomName(t):e.source&&(i=e.source.getCustomName(t)),i=!i&&e.source?(e=(n=e.source.op())&&n.getGlobalSourceModel())&&e.getSource().getCustomName(t):i},m.prototype.getNameInfo=function(t){return(0,E.W9t)(this.source,t)},m.prototype.getField=function(t){var n=this;return n.source?n.source.getField(t):R},m.prototype.getFieldItem=function(t){var n=this;return n.source?n.source.getFieldItem(t):R},m.prototype.j8t=function(){return 0<this.S8t},m.prototype.O8t=function(){this.S8t++},m.prototype.R8t=function(){this.S8t--},m.prototype.SetAsyncResult=function(t,n){this.source.op().MX.SetAsyncResult(t,n)},m.prototype.cloneFrom=function(t){var n=this;n.acceptsReference=t.acceptsReference,n.arrayFormulaMode=t.arrayFormulaMode},d=m,t.EvaluateContext=d,E.CalcSource.prototype.getEvaluatorContext=function(t,n,e,i,r){return new d(this,t,n,e,i,r)},g.prototype.setAsyncResult=function(t){this.node.Y6=t,this.node.yL=!0,this.ctx.SetAsyncResult(this,t);var n=this.ctx.source;n.B8t||(n.B8t=!0,setTimeout(function(){n.refresh(),delete n.B8t},200))},g.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},g.prototype.L8t=function(){for(var t,n,e,t=this.node&&this.node.parent,n=t&&t.R1t||[],e=0;e<n.length;e++)if(!n[e].yL)return!1;return!0},g.prototype.MCe=function(){var t=this.node&&this.node.parent;t&&t.SCe&&(t.yL=!0)},v=g,t.AsyncEvaluateContext=v,e(w,Z=d),w.prototype.getName=function(t){var n=this;return n.A8t?n.A8t.getCustomName(t):R},t.GloableEvaluateContext=w,y.prototype.evaluateExpression=function(t,n,e,i,r,o){var t,t,e,i,t=void 0===t.type&&t.WK?t.WK:t,t=this.evaluate(t,n,!!i,!!r);return t&&t.pause?t:(0,E.isLambdaFunction)(t)?_:t===F||t===R?!1===e?t:0:((L(t)&&!i||B(t)&&!r)&&(t=this.getOneValue(n,t)),E.ExcelCompatibleCalcMode||o?t:(e=15,"number"==typeof t&&-10<t&&t<10&&(1<(i=t.toString()).indexOf("000000000000")||1<i.indexOf("999999999999"))&&(e=14),O.Common.st.E8(t,E.Functions.CALC_PRECISION||e)))},y.prototype.evaluate=function(t,n,e,i){var r,o,a,u;if(!t)throw(0,E.sR)().Exp_ExprIsNull;if(void 0===t.type){if(t._error)return t;t.WK&&(t=t.WK)}for(;10===t.type;)t=t.value;if(r=this,a=R,12===t.type?(a=t.needExpendIndexs,t=t.value):n.k_t&&(e=!0,a=[]),2<=(u=t.type)&&u<=6)o=r.evaluateConst(t,n,e);else if(1===u||13===u||22===u)o=r.evaluateReference(t,n,i,e);else if(8===u)o=r.evaluateName(t,n,e,i);else if(100===u)o=r.evaluateLocalName(t,n,e,i);else if(9!==u||t.value2){if(9===u)o=r.evaluateBinaryOperation(t,n,e,i,a);else if(7===u){if(t.u8t&&n.N_t&&(o=r.evaluateBranchFunction(t,n,e,i,a))&&o.pause)return o;o=r.evaluateFunction(t,n,e,i,a)}else if(11===u)o=F;else if(14===u)o=r.evaluateField(t,n);else if(15===u)o=r.evaluateFieldItem(t,n);else if(n.evaluate)return n.evaluate(t,e,i)}else o=r.evaluateUnaryOperation(t,n,e,i,a);return o},y.prototype.evaluateConst=function(t,n,e){var t=t.value;return!L(t)||e||n&&(n.arrayFormulaMode||n.j8t())?t:t.getValue(0,0)},y.prototype.evaluateReference=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,s,d,v,m,g,s,d;if(!n)return S;if(r=t.source||n.source,o=isNaN(n.row)?0:n.row,a=isNaN(n.column)?0:n.column,u=t.getRange&&t.getRange(o,a),s=t.type,!u)return 13===s?S:p;if(c=u.row<0?0:u.row,f=u.col<0?0:u.col,l=u.rowCount,h=u.colCount,r.evaluateReference)return r.evaluateReference(t,n,e);if(u.row<0&&(u.rowUndefine=!0),u.col<0&&(u.colUndefine=!0),i&&(s=r.getRowCount(),d=r.getColumnCount(),(-1===l||s<l)&&(l=s),-1===h||d<h)&&(h=d),e||n.arrayFormulaMode)return t.endSource?n.getSheetRangeReference({source:t.source,endSource:t.endSource,row:c,col:f,rowCount:l,colCount:h}):n.getReference(r,u);if(i&&(1<l||1<h)){for(v=[],m=0;m<l;m++)for(v[m]=[],g=0;g<h;g++)v[m][g]=r.getValue(m+c,g+f);return new E.CalcArray(v)}if(1<l||1<h)if(s=o>=u.row&&o<u.row+l,d=a>=u.col&&a<u.col+h,s&&d)c=o,f=a;else{if(!s&&!d)return S;if(s&&1===h)c=o;else{if(!d||1!==l)return S;f=a}}else if(-1===u.row&&-1===l){if(1!==h)return S;c=o}else if(-1===u.col&&-1===h){if(1!==l)return S;f=a}return(1<l||1<h||-1===l||-1===h)&&n.WK&&n.WK.ensureSingle&&(t.$9t=!0),r.getValue(c,f)},y.prototype.evaluateName=function(t,n,e,i){var r,t,t;return n&&(t=(n=t.source?(r=t.source).getEvaluatorContext(n.identity,n.arrayFormulaMode,n.arrayIdentity):n).getName(t.value))?(t=(0,o.h0t)(n,t,!1,0,0,e,i),this.evaluate(t,n,e,i)):A},y.prototype.evaluateLocalName=function(t,n,e,i){var r,o,a,u,s,c;if(!t.value||!n||!n.localScopes.hasVariable(t.value))return A;if(r=n.localScopes.getVariable(t.value),(o=n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray)||(e=t.vDt,i=t.mDt),n.arrayFormulaMode&&n.j8t())return r;if(!L(r)||e){if(!B(r)||i)return r;if(a=r,e&&1===a.getRangeCount()){for(u=[],s=0;s<a.getRowCount(0);s++)for(u[s]=[],c=0;c<a.getColumnCount(0);c++)u[s][c]=a.getValue(0,s,c);return new E.CalcArray(u)}}return this.getOneValue(n,r)},y.prototype.evaluateUnaryOperation=function(n,e,i,t,r){var o,a,o,o=!1;return r&&0<r.length&&(o=i=!0),(a=e.k_t)&&(i=!0),(o=this.evaluate(n.value,e,i,o))&&o.pause||E.Convert.BJ(o)?o:o===E.missingArgument?P:this.evaluateWithArgs(n,function(t){var t=t[0];return t&&t.getRowCount&&i&&e.WK&&(e.WK.ensureSingle&&!i?t=x(e,t):e.WK.t8t=!0),T(n.operatorType,t,i)},e,r,[o],i,t)},y.prototype.evaluateBinaryOperation=function(e,i,r,t,n){var o,a,o,u,s,c,f,l,h,h,o=i.k_t,a=[r=o?!0:r,r],u=[o=(0,E.gDt)(e.operatorType),o];if(n&&0<n.length)for(s=0;s<n.length;s++)a[n[s]]=!0,u[n[s]]=!0;for(c=e===i.WK,f=[e.value,e.value2],l=[],s=0;s<2;s++){if((h=this.evaluate(f[s],i,a[s],u[s]))&&h.pause)return h;if(E.Convert.BJ(h=h))return h;if(h===E.missingArgument&&f[s].value&&!f[s].value.table)return P;l[s]=h}return this.evaluateWithArgs(e,function(t){var n=t[0],t=t[1];return e.operatorType<=14&&i.WK&&(J(n)||J(t))&&(i.WK&&i.WK.ensureSingle&&!r?(n=x(i,n,f[0]),t=x(i,t,f[1])):i.WK.t8t=!0),n&&n instanceof E.TwoDimensionalCalcArray&&(n=n.getCalculatedValue()),t&&t instanceof E.TwoDimensionalCalcArray&&(t=t.getCalculatedValue()),T(e.operatorType,n,t,c)},i,n,l,r,t)},y.prototype.evaluateField=function(t,n){var e,n;return n?(n=(n=t.source?(e=t.source).getEvaluatorContext(n.identity,n.arrayFormulaMode,n.arrayIdentity):n).getField(t.value),i(n)&&t.value&&!t.value.table?P:n):A},y.prototype.evaluateFieldItem=function(t,n){var e,n;return n?(n=(n=t.source?(e=t.source).getEvaluatorContext(n.identity,n.arrayFormulaMode,n.arrayIdentity):n).getFieldItem(t.value),i(n)?P:n):A},y.prototype.startCache=function(t){this.F8t={},!t&&this.service.Z_t&&this.asyncManager.startCalc()},y.prototype.endCache=function(){this.F8t=R},y.prototype.evaluateBranchFunction=function(t,n,e,i,r){var o,a,u,s,u,r,e,u,o=n.row+","+n.column;if(!(t.P8t&&t.P8t[o]&&t.P8t[o].WDt)&&(0,E.isFunction)(t.function))return a=t.function,u=t.arguments.length,s=a.findTestArgument(),r=(u=this.preprocessFunction(n,a,u,r,e)).acceptsArrays,e=u.keepArrayValuesFlagSet,(u=this.testArgGetBranch(n,a,t,r[s],!1,s))&&u.pause?u:(e&&delete n.k_t,0<=u.branchArgument&&"number"==typeof u.branchArgument?(t.P8t=t.P8t||{},t.P8t[o]=n.source.getCalcService().ZDt,{pause:"Branch",branch:t.s8t[o][u.branchArgument]}):void(u.testArgValue._error||delete t.u8t))},y.prototype.evaluateLetFunction=function(t,n,e,i){var r,o,a,u,s,a,s,c,r=t.arguments.length,o=this;for(n.localScopes.enterScope(),this.service.Z_t&&this.asyncManager.startCalcFunction(t.function,t,n),u=1;u<r-1;u+=2){if(s=t.arguments[u-1],a=t.arguments[u],s=s.value,(a=o.evaluate(a,n,e,i))&&a.pause)return a;n.localScopes.setVariable(s,a)}return this.service.Z_t&&this.asyncManager.endCalcFunction(),(c=o.evaluate(t.arguments[r-1],n,e,i))&&c.pause||n.localScopes.exitScope(),c},y.prototype.evaluateLambdaFunction=function(t,n,e,i){return n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray&&(n.WK.t8t=!0),new E.Functions.LambdaFunction(t,n.localScopes.createClosure())},y.prototype.evaluateISOMITTEDFunction=function(t,n,e,i){var t=t.arguments[0];return t&&100===t.type&&null===n.localScopes.getVariable(t.value)},y.prototype.preprocessFunction=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,o=[],a=[],u=t.k_t,s=!1,c=R;for(!u&&(1===n.arrayArgumentEvaluateMode||4===n.arrayArgumentEvaluateMode&&r)&&(s=u=t.k_t=!0),f=0;f<e;f++)o[f]=n.acceptsArray(f),a[f]=n.acceptsReference(f),n.isBranch()&&t.WK&&t.WK.ensureSingle&&!r&&(a[f]=o[f]=!1);if(i&&0<i.length||u){for(c=[],f=0;f<e;f++)c[f]=!0;for(l=u?e:i.length,f=0;f<l;f++)a[h=u?f:i[f]]=o[h]=!0,(d=!(n.acceptsReference(h)&&!n.acceptsArray(h)))&&u&&n.acceptsReference(h)&&(d=!1),c[h]=d}return n.isBranch()&&(t.arrayFormulaMode||t.j8t())&&(o[n.findTestArgument()]=!0,a[n.findTestArgument()]=!0),{acceptsArrays:o,acceptsReferences:a,getReferenceValues:c,keepArrayValuesFlagSet:s}},y.prototype.testArgGetBranch=function(t,n,e,i,r,o){var a,i,u,s,u=-1,s=t.k_t;return t.arrayFormulaMode&&(t.k_t=!0),n.acceptsArray(o)&&t.O8t(),i=this.evaluate(e.arguments[o],t,i,r),null!=(a=null==t?void 0:t.source)&&a.updateBranchPrecedents&&t.source.updateBranchPrecedents(e,t,r),i&&i.pause?i:(n.acceptsArray(o)&&t.R8t(),t.k_t=s,{testArgValue:i,branchArgument:u=B(i)||L(i)?u:n.findBranchArgument(i)})},y.prototype.evaluateFunction=function(t,n,e,i,r){var o;try{o=!t.function||(0,E.isExpression)(t.function)?this.evaluateLambdaFunctionCall(t,n,e,i,r):this.evaluateBuildInFunction(t,n,e,i,r)}catch(t){if((0,E.isStackOverflowError)(t)){if(2<=n.lambdaFunctionCallDepth)throw t;o=f}else o=S}return o},y.prototype.evaluateBuildInFunction=function(t,u,n,s,e){var c,i,f,l;return t&&t.function&&(0,E.isFunction)(t.function)?(c=t.function,i=t.functionName,f=this,l=u.C8t,"LET"===i?f.evaluateLetFunction(t,u,n,s):i===I?f.evaluateLambdaFunction(t,u,n,s):"ISOMITTED"===i?f.evaluateISOMITTEDFunction(t,u,n,s):f.evaluateFunctionCore(t,function(t,n,e){var i,r,i,o,a,o,r=ut(t,c.R9t);return t=r.ADt,r._8t?c.isContextSensitive()?(u.acceptsReference=s||u.j8t(),c instanceof E.Functions.AsyncFunction?(f.G8t=f.G8t||{},c.evaluateWhenArgumentsIsSame()?f.evaluateAsyncFunction(u,n,c,l,t,e):f.evaluateWithCache(c,t,function(){return f.evaluateAsyncFunction(u,n,c,l,t,e)},f.G8t)):(u.Whe=n,c.evaluateWithContext(u,t))):((i=u.arrayFormulaMode)&&(c.k9t={row:u.rowOffset,col:u.columnOffset}),o=(0,E.getMapping)()&&(0,E.getMapping)().builtInFunctionsMapping,a=o&&o[c.name]&&o[c.name].specialFun,o=function(){return a&&a.apply(c,t)||c.evaluate.apply(c,t)},i=i&&!u.ECe?f.evaluateWithCache(c,t,o,f.F8t):o(),delete c.k9t,i):r.Y6},u,n,s,e)):A},y.prototype.tryGetLambdaFunction=function(t,n,e,i){var r,t;if((0,E.isExpression)(t.function))r=this.evaluate(t.function,n,e,i);else if(t.isLocalFunctionName?r=n.localScopes.getVariable(t.functionName):(t=n.getName(t.functionName,t.source))&&(r=this.evaluate(t,n,e,i)),!r)return A;return r&&r.pause||a(r)||(0,E.isLambdaFunction)(r)?r:S},y.prototype.evaluateLambdaFunctionCall=function(t,u,s,c,n){var f,e,l,e,f=this,e=this.tryGetLambdaFunction(t,u,s,c);return e&&e.pause||a(e)?e:((e=(0,E.YJ)(l=e,t.arguments)).WK=t,this.evaluateFunctionCore(e,function(t){var n,e,i,r,o,a,n=u.localScopes;try{if(u.lambdaFunctionCallDepth++,n.enterScope(),n.saveThenSwitchClosure(l.closure),(i=t.length)<l.minArgs||i>l.maxArgs)return S;for(r=l.parameters,o=0;o<r.length;o++)a=o<i?t[o]:null,u.localScopes.setVariable(r[o].value,a);e=f.evaluate(l.calculation,u,s,c)}finally{u.lambdaFunctionCallDepth--,n.exitScope(),n.restoreClosure()}return e},u,s,c,n))},y.prototype.evaluateFunctionCore=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,h,d,v,m,g,p,b,w,y,y,M,C,S,T;if(!t||!t.function||!(0,E.isFunction)(t.function))return A;if(a=t.arguments.length,u=this,s=t.function,c=[],l=R,s instanceof E.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(s,t,e),0!==a){if(s.name===I&&this.service.Z_t&&this.asyncManager.startCalcFunction(s,t.WK,e),d=(h=u.preprocessFunction(e,s,a,o,i)).acceptsArrays,v=h.acceptsReferences,l=h.getReferenceValues,h=h.keepArrayValuesFlagSet,p=g=m=void 0,s.isBranch()){if(g=s.findTestArgument(),(b=u.testArgGetBranch(e,s,t,d[g],v[g],g))&&b.pause)return b;m=b.testArgValue,p=b.branchArgument}for(w=0;w<a;w++){if(g===w)f=m;else{if(0<=p&&w!==p){c[w]=null;continue}if(s.acceptsArray(w)&&e.O8t(),y=e.ITe,s.skipPrecedent(w)&&!s.i9t?e.ITe=!0:e.ITe=!1,f=s.acceptsExpressionArgument(w)?t.arguments[w]:u.evaluate(t.arguments[w],e,d[w],v[w]),e.ITe=y,f&&f.pause)return f;s.acceptsArray(w)&&e.R8t()}if(!s.acceptsArray(w)&&L(f)||!s.acceptsReference(w)&&B(f))if(y=L(f)?f:R,M=B(f)?f:R,y&&1===y.getRowCount()&&1===y.getColumnCount())f=y.getValue(0,0);else if(M&&1===M.getRowCount(0)&&1===M.getColumnCount(0))f=M.getValue(0,0,0);else{if(S=!(C=[]),o)for(T=0;T<o.length;T++)C.push(o[T]),o[T]===w&&(S=!0);S||(C.push(w),o=C),!s.acceptsReference(w)&&f.referenceInTwoDimension&&f._Dt()}if(E.Convert.BJ(f)&&!s.acceptsError(w))return s instanceof E.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),f;f!==E.missingArgument||s.acceptsMissingArgument(w)||(f=R),(c[w]=f)&&"INDIRECT"!==t.functionName&&f.V9t&&f.rT&&Q(f,e)}s.name===I&&this.service.Z_t&&this.asyncManager.endCalcFunction()}return h&&delete e.k_t,u.evaluateWithArgs(t,n,e,o,c,i,r,l)},y.prototype.evaluateAsyncFunction=function(t,n,e,i,r,o){var a,u,t,a=this.asyncManager.getNode();if(a.yL)u=a.Y6;else if(a.canEvaluate()){if(t=new v(t,a),u=e.evaluateWithContext(t,r),t.notAsync)return u;u===F?u=a.Y6!==F?a.Y6:e.defaultValue():1===a.evaluateMode&&(a.yL=!0)}else u=a.Y6!==F?a.Y6:e.defaultValue();return a.Y6=u,o||this.asyncManager.endCalcFunction(),u},y.prototype.evaluateWithCache=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,e,d,v;if(i)if(o=!1,r=i[t.name+n.length])for(a=0;a<r.length;a++){if(o=!1,(u=r[a]).args.length===n.length){for(o=!0,s=0;s<n.length;s++)if((c=u.args[s])!==(f=n[s])){if(!(c instanceof E.CalcReference&&f instanceof E.CalcReference)){o=!1;break}if(l=c.SDt,c.rT!==f.rT||l!==f.SDt){o=!1;break}for(h=0;h<l;h++)if(c.getRow(h)!==f.getRow(h)||c.getColumn(h)!==f.getColumn(h)||c.getRowCount(h)!==f.getRowCount(h)||c.getColumnCount(h)!==f.getColumnCount(h)){o=!1;break}}o&&!K(u.k9t,t.k9t)&&(o=!1)}if(o)return u.flag++,u.value}else r=i[t.name+n.length]=[];if(e=e(),i&&e!==F){if(100<=(d=r.length)){for(v=[],a=0;a<d;a++)0<r[a].flag&&v.push(r[a]);v.sort(function(t,n){return n.flag-t.flag}),d=Math.min(50,v.length),r=v.slice(0,d),i[t.name+n.length]=r}r.push({args:n,value:e,flag:0,k9t:t.k9t})}return e},y.prototype.SetAsyncResult=function(t){var n;t.L8t()&&(t.MCe(),(n=t.ctx).identity&&n.identity.Tbt?this.service.Abt(n.source,n.WK,n.identity,n.S_t,n):n.source.op().recalculate(n.source,t.row,t.col,!0))},y.prototype.evaluateWithArgs=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,f=e.k_t;if(f&&!(i&&0<i.length)&&(i=[],s=7===t.type&&t.function)&&r.forEach(function(t,n){(!s.acceptsArray(n)&&L(t)||!s.acceptsReference(n)&&B(t))&&i.push(n)}),i&&0<i.length){if(!(l=this.U8t(e,t,r,i,u)))return P;for(h=[],d=l[0].length,v=l[0][0].length,m=0;m<d;m++)for(h[m]=[],g=0;g<v;g++)try{for(p=[],b=0;b<r.length;b++)p[b]=l[b][m][g];if(c=n(p,t,m+1!==d||g+1!==v),B(c)&&!f){if(7===t.type&&(s=t.function).returnReference&&s.returnReference())return c;c=this.getOneValue(e,c)}h[m][g]=c,e.WK.t8t=!0}catch(t){if((0,E.isStackOverflowError)(t))throw t;h[m][g]=S}return new E.CalcArray(h,f)}try{if(c=n(r,t),15===t.operatorType&&c&&c.V9t&&Q(c,e),(e.arrayFormulaMode||e.source&&e.source.Lbt&&e.source.Lbt.allowDynamicArray)&&e.j8t())return c;if(!L(c)||o){if(!B(c)||a)return c;if(w=c,o&&1===w.getRangeCount()){for(y=[],M=0;M<w.getRowCount(0);M++)for(y[M]=[],C=0;C<w.getColumnCount(0);C++)y[M][C]=w.getValue(0,M,C);return new E.CalcArray(y)}!o&&e.WK&&e.WK.ensureSingle&&(1<c.getColumnCount()||1<c.getRowCount())&&(t.$9t=!0)}return this.getOneValue(e,c)}catch(t){if((0,E.isStackOverflowError)(t))throw t;return S}},y.prototype.getOneValue=function(t,n){var e,i,r,o,a,o;return B(n)?(o=(r=n).getRowCount(0),a=r.getColumnCount(0),n=1<r.getRangeCount()||!t.arrayFormulaMode&&1<o&&1<a?S:(i=-1!==t.rowOffset||-1!==t.columnOffset?(e=1===o?0:t.arrayFormulaMode?t.rowOffset:t.rowOffset-r.getRow(0),1===a?0:t.arrayFormulaMode?t.columnOffset:t.columnOffset-r.getColumn(0)):(e=1===o?0:t.row-r.getRow(0),1===a?0:t.column-r.getColumn(0)),o<=e||a<=i?P:r.getValue(0,e,i))):L(n)&&(o=n,n=!t.arrayFormulaMode||-1===t.rowOffset&&-1===t.columnOffset?o instanceof E.TwoDimensionalCalcArray?o.getActualValue():o.getValue(0,0):(e=1===o.getRowCount()?0:t.rowOffset,i=1===o.getColumnCount()?0:t.columnOffset,e>=o.getRowCount()||i>=o.getColumnCount()?P:o.getValue(e,i))),B(n)||L(n)?this.getOneValue(t,n):n},y.prototype.U8t=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,n,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,o=1,a=1,u=-1,s=!0,c=!0,h=1,d=1,v=7===n.type?n:R,n=v&&v.function,m=t.arrayFormulaMode||t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray;if(n&&(0,E.isFunction)(n)&&!n.expandRows()&&(s=!1),n&&(0,E.isFunction)(n)&&!n.expandColumns()&&(c=!1),n&&(0,E.isFunction)(n)&&n.isBranch()&&(m||t.j8t())){if(u=n.findTestArgument(),p=!(g=[]),i)for(b=0;b<i.length;b++)g.push(i[b]),i[b]===u&&(p=!0);if(p||L(e[u])||B(e[u])){for(w=0;w<v.arguments.length;w++)w!==u&&O.Common.Uf.hD(g,w)<0&&(L(e[w])||B(e[w]))&&g.push(w);i=g}}for(y=[],C=i[M=0],S=e.length,I=[],T=0;T<S;T++)A=e[T],l=f=R,h=d=1,T===C?(f=L(A)?A:R,l=B(A)?A:R,(f||l)&&(h=f&&f.getRowCount()||(s&&l?l.getRowCount(0):1),d=f&&f.getColumnCount()||(c&&l?l.getColumnCount(0):1)),C=++M<i.length?i[M]:-1):r===F&&(f=L(A)?A:R,l=B(A)?A:R,f||l)&&(h=f&&f.getRowCount()||(s&&l?l.getRowCount(0):1),d=f&&f.getColumnCount()||(c&&l?l.getColumnCount(0):1)),I[T]=[f,l,A,h,d],o=o<h?h:o,a=a<d?d:a;for(T=0;T<S;T++){if(x=y[T]=[],f=(N=I[T])[0],l=N[1],A=N[2],h=N[3],d=N[4],(f||l)&&(1!==h&&h!==o||1!==d&&d!==a)&&(-1===u||T===u)&&!m)return;for(k=0;k<o;k++)for(_=x[k]=[],D=0;D<a;D++)1!==h&&h<=k||1!==d&&d<=D?_[D]=P:f?(j=f.getValue(1===h?0:k,1===d?0:D),L(j)&&(j=j.getValue(0,0)),_[D]=j):l?!r||r[T]?_[D]=l.getValue(0,1===h?0:k,1===d?0:D):_[D]=l.create([W(l.getRow(0)+(1===h?0:k),l.getColumn(0)+(1===d?0:D),1,1)]):_[D]=A}return y},t.Evaluator=y,X.prototype.canEvaluate=function(){for(var t,n,t=this.R1t,n=0;n<t.length;n++)if(!t[n].yL)return!1;return!0},b=X,t.AsyncFunctionNode=b,M.prototype.startCalc=function(){var t,n,e,i,r,o,a,u,s;if(this.k8t)for(n in this.b8t)if(e=this.b8t[n])for(i in e)if(r=e[i])for(o in r)if((a=r[o])&&(a.root.R1t=[],0<(t=a.length)))for(u=0;u<t;u++)0===(s=a[u]).evaluateMode&&(s.yL=!1)},M.prototype.startCalcCell=function(t,n){var e,i,r,o,a,t,u,t,n,e=this,i=t.getName(),r=n.row,o=n.col;e.source=t,n.Tbt?(a=(t=(t=e.b8t["-"])||(e.b8t["-"]={}))[n.Tbt])?a=a[0]:(u=new b(-1),t[n.Tbt]=[],(a=t[n.Tbt][0]=[]).root=u):(a=(n=(n=(t=(t=e.b8t[i])||(e.b8t[i]={}))[r])||(t[r]={}))[o])||(u=new b(-1),(a=n[o]=[]).root=u),e.k8t++,e.N8t=0,e.cellNodes=a,e.row=r,e.col=o,e.x8t[0]=a.root,e.evaluateMode=-1},M.prototype.x_t=function(t){for(var n,e,n=this.b8t["-"][t][0].root.R1t,e=0;e<n.length;e++)if(!n[e].yL)return!1;return!0},M.prototype.T_t=function(t){return 0<this.b8t["-"][t][0].length},M.prototype.I_t=function(t){delete this.b8t["-"][t]},M.prototype.startCalcFunction=function(t,n,e){var r,i,o,a,u,s,c,f,l,n,h,d,v,m,g,r=this,i=n.arguments,o=!1;if(0!==r.x8t.length&&r.cellNodes||(o=!0,r.startCalcCell(e.source,e.identity)),a=r.evaluateMode,t instanceof E.Functions.AsyncFunction?u=t.evaluateMode():s=!0,"REFRESH"===t.name?(u=i[1]?r.MX.evaluate(i[1],e,!1,!1):0,r.evaluateMode=u):-1!==a&&(u=a),f=e.identity?e.identity.Tbt||e.identity.row+"|"+e.identity.col:"0",n.H8t&&n.H8t[f]?(c=n.H8t[f]).I8t&&(c.I8t=!1,r.cellNodes.push(c)):(n.H8t=n.H8t||{},c=n.H8t[f]=new b(r.cellNodes.length,u),s&&(c.SCe=!0),r.cellNodes.push(c)),r.currentNode=c,r.x8t[r.N8t].R1t.indexOf(c)<0&&(r.x8t[r.N8t].R1t.push(c),c.parent=r.x8t[r.N8t],c.R1t=[]),r.x8t.push(c),r.N8t++,2===u&&-1===a){for(l=6e4,n=r.intervals,h=t.interval()||6e4,"REFRESH"===t.name&&(c.isRefresh=!0,h=i[2]?r.MX.evaluate(i[2],e,!1,!1):6e4),n||(r.intervals=n={}),(d=n[h])||"object"!=typeof window||((d=n[h]=[]).intervalObj=window.setInterval(function(){var t,n,e,i,t=r.MX.service;if(1!==t.calculationMode&&!t.IsSuspended())for(n=r.intervals[h],v=0;v<n.length;v++)(i=(e=n[v]).node).yL=!1,i.isRefresh&&q(i),t.recalculate(e.source,e.row,e.col,!0),r.source.refresh()},h)),m=!1,v=0;v<d.length;v++)if((g=d[v]).source===r.source&&g.node===c&&g.row===r.row&&g.col===r.col){m=!0;break}m||d.push({source:r.source,node:c,row:r.row,col:r.col})}return o&&r.endCalcCell(),c},M.prototype.getNode=function(){return this.currentNode},M.prototype.endCalcFunction=function(){this.currentNode.SCe&&0===this.currentNode.R1t.length&&(this.currentNode.yL=!0),this.x8t.pop(),this.N8t--,this.currentNode=this.currentNode.parent},M.prototype.endCalcCell=function(){var t=this;t.N8t=-1,t.x8t=[]},M.prototype.clearCell=function(t,n){var e,i,r,o,i,i,r,a,a,u,s,c,f,l,h,e=this;if(e.k8t&&(i=t.getName(),r=n.row,o=n.col,e.source=t,(i=e.b8t[i])&&(i=i[r])&&(r=i[o])&&((a=(a=r[0])&&a.y8t)&&(delete a.Z_t,delete a.p8t),r.forEach(function(t){t.yL=!1,t.I8t=!0,delete t.Y6}),i[o]=F,e.k8t--),"object"==typeof window))for(s in u=e.intervals)if(c=u[s]){for(f=[],l=0;l<c.length;l++)(h=c[l]).source===t&&h.row===n.row&&h.col===n.col||f.push(h);f.length?f.length!==c.length&&(f.intervalObj=c.intervalObj,u[s]=f):(u[s]=F,window.clearInterval(c.intervalObj))}},M.prototype.setAsyncResult=function(t,n){t.Y6=n},M.prototype.addRows=function(t,n,e){this.z8t(t,n,e,!0)},M.prototype.deleteRows=function(t,n,e){this.z8t(t,n,e,!1)},M.prototype.z8t=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,r=this;if(r.k8t){if(o=t.getName(),a=r.b8t[o]){for(s in u={},a)(c=a[s])&&(f=parseInt(s,10),i?u[l=n<=f?f+e:f]=c:f<n?u[f]=c:n+e<=f&&(u[f-e]=c));r.b8t[o]=u}for(d in h=r.intervals)if(v=h[d]){for(m=[],g=0;g<v.length;g++)(p=v[g]).source===t&&i&&p.row>=n?p.row+=e:p.source===t&&!i&&(p.row<n||p.row>=n+e)&&(p.row=p.row<n?p.row:p.row-e,m.push(p));i||m.length===v.length||(m.intervalObj=v.intervalObj,h[d]=m)}}},M.prototype.addColumns=function(t,n,e){this.V8t(t,n,e,!0)},M.prototype.deleteColumns=function(t,n,e){this.V8t(t,n,e,!1)},M.prototype.V8t=function(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,r=this;if(r.k8t){if(o=t.getName(),a=r.b8t[o])for(u in a)if(s=a[u]){for(f in c={},s)(l=s[f])&&l.length&&(h=parseInt(f,10),i?c[d=n<=h?h+e:h]=l:h<n?c[h]=l:n+e<=h&&(c[h-e]=l));a[u]=c}for(m in v=r.intervals)if(g=v[m]){for(p=[],b=0;b<g.length;b++)(w=g[b]).source===t&&i&&w.col>=n?w.col+=e:w.source===t&&!i&&(w.col<n||w.col>=n+e)&&(w.col=w.col<n?w.col:w.col-e,p.push(w));i||p.length===g.length||(p.intervalObj=g.intervalObj,v[m]=p)}}},M.prototype.changeSourceName=function(t,n){var e,i,e=this;e.k8t&&(i=e.b8t[t])&&(e.b8t[n]=i,delete e.b8t[t])},G=M,t.evaluateOperator=T,U=E.Convert.uJ,H=E.Convert.z6t,V=E.Convert.j,z=E.Convert.kDt,Y=E.Convert.U6t},"./src/map.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMap=void 0;var e=(i.prototype.has=function(t){return!!this.Y8t[this.Z8t(t)]},i.prototype.get=function(t){var t=this.Y8t[this.Z8t(t)];return t&&t.value},i.prototype.delete=function(t){var t,n,e,i,t=this.Z8t(t),n=this.Y8t[t];if(!n)return!1;if(this.size--,this.size){if(e=void 0,n!==this.W8t)for(e=this.W8t;e&&e.next!==n;)e=e.next;i=n.next,e?e.next=i:this.W8t=i,i&&(i.prev=e)}else this.W8t=null;return delete this.Y8t[t],delete this.Q8t[t],!0},i.prototype.set=function(t,n){var e,i,e,e=this.Y8t,i=this.Z8t(t);return e[i]?e[i].value=n:(this.size++,e=e[i]={key:t,keyStamp:i,value:n,next:this.W8t},this.W8t=e),this},i.prototype.clear=function(){var t,n,t=this.Y8t;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&delete t[n];this.Q8t={},this.W8t=null,this.size=0},i.prototype.forEach=function(t,n){for(var e=this.W8t;e;)for(t.call(n,e.value,e.key,this);(e=e.next)&&!this.Y8t[e.keyStamp];);},i.prototype.toString=function(){return"[object Map]"},i.prototype.Z8t=function(t){switch(typeof t){case"undefined":return"undefined";case"object":if(null===t)return"null";break;case"boolean":return"?"+t;case"number":return"+"+t;case"string":return","+t}return""},i);function i(t){if(this.Y8t=Object.create(null),this.Q8t={},this.W8t=null,this.size=0,t)for(var n=0,e=t.length;n<e;n++)this.set(t[n][0],t[n][1])}function r(){return new(Map&&-1!==Map.toString().indexOf("[native code]")&&new Map([[1,1]]).size?Map:e)}n.createMap=r},"./src/referenceExpression.ts":function(t,n,e){var i,r,b,o,e,w,s,y,M,a,u;function c(t){return u.call(this,t)||this}function f(t,n,e,i,r,o){var a=new M(1);return a.row=e,a.column=i,a.rowRelative=r,a.columnRelative=o,t&&(a.source=t),n&&(a.endSource=n),a}function l(t,n,e,i,r,o,a,u,s,c,f,l,h){var d,v,m,g,p,l,d=new M(1);return w(r)||(r=s?y(r+f,b.MAX_ROW_COUNT-1)-f:y(r,b.MAX_ROW_COUNT-1)),w(o)||(o=c?y(o+l,b.MAX_COLUMN_COUNT-1)-l:y(o,b.MAX_COLUMN_COUNT-1)),0===(u?i+l:i)&&(c?o+l:o)===b.MAX_COLUMN_COUNT-1&&(i=o=b.BAND_INDEX_CONST),d.isFullRow=i===b.BAND_INDEX_CONST,f=f||0,l=l||0,m=e-(a?0:f),g=i-(u?0:l),p=r-(s?0:f),l=o-(c?0:l),0===(a?e+f:e)&&(s?r+f:r)===b.MAX_ROW_COUNT-1&&(e=r=b.BAND_INDEX_CONST),d.isFullColumn=e===b.BAND_INDEX_CONST,p<m&&(v=e,e=r,r=v,v=a,a=s,s=v),l<g&&(v=i,i=o,o=v,v=u,u=c,c=v),d.row=e,d.column=i,d.endRow=r,d.endColumn=o,d.rowRelative=a,d.columnRelative=u,d.endRowRelative=s,d.endColumnRelative=c,d.isArrayReference=h,d.isFullColumn&&d.isFullRow&&(d.rowRelative=!1,d.endRowRelative=!1),t&&(d.source=t),n&&(d.endSource=n),d}function h(t,n,e){var i={row:-1,col:-1,rowCount:-1,colCount:-1},r,o,a,u;return t.isFullRow?(i.col=-1,i.colCount=-1):(a=t.columnRelative?(a=t.column+e)>=b.MAX_COLUMN_COUNT?a%b.MAX_COLUMN_COUNT:a:t.column,t.hmt()?(i.col=a,i.colCount=1):(u=t.endColumnRelative?(u=t.endColumn+e)>=b.MAX_COLUMN_COUNT?u%b.MAX_COLUMN_COUNT:u:t.endColumn,i.col=a<=u?a:u,i.colCount=s(u-a)+1)),t.isFullColumn?(i.row=-1,i.rowCount=-1):(r=t.rowRelative?(r=t.row+n)>=b.MAX_ROW_COUNT?r%b.MAX_ROW_COUNT:r:t.row,t.hmt()?(i.row=r,i.rowCount=1):(o=t.endRowRelative?(o=t.endRow+n)>=b.MAX_ROW_COUNT?o%b.MAX_ROW_COUNT:o:t.endRow,i.row=r<=o?r:o,i.rowCount=s(o-r)+1)),i}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeForReference=n.lJ=n.knt=n.ReferenceExpression=void 0,r=e("Common"),b=e("./src/calc.common.ts"),o=void 0,e=r.Common.lt,w=e.ht,s=Math.abs,y=Math.min,u=b.Expression,i(c,u),c.prototype.hmt=function(){var t=this;return t.endRow===o||t.endColumn===o},c.prototype.Tyt=function(){var t=this;return t.isFullRow&&t.isFullColumn?3:t.isFullRow?1:t.isFullColumn?2:0},c.prototype.getRange=function(t,n){return h(this,t,n)},c.prototype.offset=function(t,n,e,i,r){var o,a,u,a,o=this,a=o.source,u=o.endSource;return o.hmt()?f(a,u,o.row+(o.rowRelative||e?t:0),o.column+(o.columnRelative||e?n:0),o.rowRelative,o.columnRelative):((a=l(a,u,o.row+(o.rowRelative||e?t:0),o.column+(o.columnRelative||e?n:0),o.endRow+(o.isFullColumn||!o.endRowRelative&&!e?0:t),o.endColumn+(o.isFullRow||!o.endColumnRelative&&!e?0:n),o.rowRelative,o.columnRelative,o.endRowRelative,o.endColumnRelative,i,r)).isFullRow=o.isFullRow,a.isFullColumn=o.isFullColumn,a)},c.prototype.offset2=function(t,n,e,i,r,o){var a,u,s,a=this,u;return(a.endRowRelative?a.endRow+r:a.endRow)>=b.MAX_ROW_COUNT-1&&(e=0),(s=a.endColumnRelative?a.endColumn+o:a.endColumn)>=b.MAX_COLUMN_COUNT-1&&(i=0),l(a.source,a.endSource,a.row+(a.isFullColumn?0:t),a.column+(a.isFullRow?0:n),a.endRow+(a.isFullColumn?0:e),a.endColumn+(a.isFullRow?0:i),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,r,o)},M=c,n.ReferenceExpression=M,n.knt=f,n.lJ=l,n.getRangeForReference=h},"./src/text_Filter/charProcess.ts":function(t,n){var e,i,r;function o(){this.otherChar=0,this.control=1,this.numeric=2,this.mathSymbol=3,this.symbol=4,this.punctuation=5,this.space=6,this.upperCase=7,this.lowerCase=8,this.katakana=9,this.hiragana=10,this.farEastPunctuation=11,this.hangul=12,this.fullWidth=32768}function a(){this.minValue="\0",this.maxValue="\uffff",this.ANSI_START=0,this.ANSI_END=255,this.BOTH_WIDTH_START=65280,this.BOTH_WIDTH_END=65519,this.FULL_ALPHA_START=65281,this.FULL_UPPER_START=65313,this.FULL_UPPER_END=65338,this.FULL_ALPHA_END=65374,this.CJK_HALF_SYMBOL_START=65377,this.CJK_HALF_SYMBOL_END=65380,this.KANA_HALF_START=65381,this.KANA_HALF_END=65439,this.HANGUL_HALF_START=65440,this.HANGUL_HALF_END=65500,this.FULL_SYMBOL_START=65504,this.FULL_SYMBOL_END=65510,this.HALF_VARIANTS_START=65512,this.HALF_VARIANTS_END=65518,this.KATAKANA_VOICED="\uff9e",this.KATAKANA_SEMI_VOICED="\uff9f",this.tab="\t",this.space=" ",this.K8t=new Array("\0","\x80","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"),this.blocks=new Array("BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"),this.J8t=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"],this.X8t=new e,this.q8t=[this.X8t.symbol|this.X8t.fullWidth,this.X8t.numeric|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.upperCase|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.lowerCase|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.farEastPunctuation,this.X8t.katakana,this.X8t.hangul,this.X8t.symbol|this.X8t.fullWidth,this.X8t.symbol],this.$8t=new Array("\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"),this.tEt=new Array("\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"),this.nEt=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"],this.eEt=new Array(0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0),this.iEt=["\u2018","\u2019","\u201c","\u201d"],this.rEt=["\u30fc"],this.oEt=new Array("\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"),this.aEt=new Array(" ","\uff64","\uff61","\uff62","\uff63",'"','"',"'","'","\uff9e","\uff9f","\xa5")}function u(){this.charCategory=new i,this.charType=new e}Object.defineProperty(n,"__esModule",{value:!0}),n.uEt=n.sEt=n.CharType=void 0,e=o,n.CharType=e,i=a,n.sEt=i,u.prototype.isAlphabet=function(t){var n=this;return n.isUpper(t)||n.isLower(t)},u.prototype.isHiragana=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.hiragana||n.charCategory.rEt[0]===t},u.prototype.getCharType=function(t){var n,e,i,n=this,e=n.charType.otherChar,i=n.belongTo(t);if("\x7f"===t||"\0"<=t&&t<="\x1f"||"\x80"<=t&&t<="\x9f")return n.charType.control;if("A"<=t&&t<="Z")return n.charType.upperCase;if("a"<=t&&t<="z")return n.charType.lowerCase;if("0"<=t&&t<="9")return n.charType.numeric;switch((n.isFullWidthSymbol(t)||n.isHalfWidthSymbol(t))&&(e=n.charType.symbol),8216!==t.charCodeAt(0)&&8217!==t.charCodeAt(0)&&8220!==t.charCodeAt(0)&&8221!==t.charCodeAt(0)||(e=n.charType.punctuation),12288===t.charCodeAt(0)&&(e=n.charType.space),n.charCategory.blocks[i]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return n.multiWidthDetails(t);case"KATAKANA":return n.charType.katakana|n.charType.fullWidth;case"HIRAGANA":return n.charType.hiragana|n.charType.fullWidth}return n.isFarEastBlock(i,t)&&(e|=n.charType.fullWidth),e},u.prototype.isLower=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.lowerCase},u.prototype.isUpper=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.upperCase},u.prototype.belongTo=function(t){for(var n,e,i,r,n=this,e=0,i=83,r=i>>1;1<i-e;)t>=n.charCategory.K8t[r]?e=r:i=r,r=i+e>>1;return r},u.prototype.isFullWidthSymbol=function(t){for(var n=0;n<u.fullWidthSymbolArray.length;n++)if(t===u.fullWidthSymbolArray[n])return!0;return!1},u.prototype.isHalfWidthSymbol=function(t){for(var n=0;n<u.halfWidthSymbolArray.length;n++)if(t===u.halfWidthSymbolArray[n])return!0;return!1},u.prototype.multiWidthDetails=function(t){for(var n,e,i,r,n=this,e=0,i=n.charCategory.J8t.length,r=i>>1;1<i-e;)t>=n.charCategory.J8t[r]?e=r:i=r,r=i+e>>1;return n.charCategory.q8t[r]},u.prototype.isFarEastBlock=function(t,n){var e,i,e=this;switch(e.charCategory.blocks[t]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(i=0;i<e.charCategory.iEt.length;i++)if(n===e.charCategory.iEt[i])return!0;if(255<n.charCodeAt(0))return!0;if(8216===n.charCodeAt(0)||8217===n.charCodeAt(0)||8220===n.charCodeAt(0)||8221===n.charCodeAt(0))return!0}return!1},u.prototype.isFullWidth=function(t){var n,e,i,n=this;return!!n.isFullWidthSymbol(t)||!n.isHalfWidthSymbol(t)&&(e=n.belongTo(t),i=n.isFarEastBlock(e,t),"HALFWIDTH_AND_FULLWIDTH_FORMS"===n.charCategory.blocks[e]?(n.multiWidthDetails(t)&n.charType.fullWidth)===n.charType.fullWidth:i)},u.prototype.toHalfWidth=function(t){return this.toHalfWidthEx(t)},u.prototype.toHalfWidthEx=function(t){var n,e,i,r,o,r,r,n=this,e=n.getCharType(t),i=n.isMultiWidth(t);if((e&n.charType.fullWidth)===n.charType.fullWidth)switch(e&~n.charType.fullWidth){case n.charType.punctuation:case n.charType.upperCase:case n.charType.lowerCase:case n.charType.symbol:case n.charType.numeric:case n.charType.mathSymbol:!1!==(r=n.getFullHalfWidthSpecialChar(t,!1))?t=r:i&&(o="!",t=String.fromCharCode(t.charCodeAt(0)-(n.charCategory.K8t[81].charCodeAt(0)+1)+"!".charCodeAt(0)));break;case n.charType.katakana:if((r=t.charCodeAt(0)-(n.charCategory.K8t[62].charCodeAt(0)+1))<0||91<r)return t;if(t=n.charCategory.tEt[r],0<(r=n.charCategory.eEt[r]))return t+=String.fromCharCode((1===r?n.charCategory.KATAKANA_VOICED:n.charCategory.KATAKANA_SEMI_VOICED).charCodeAt(0));break;case n.charType.space:t=" ";break;case n.charType.hangul:}return t},u.prototype.isMultiWidth=function(t){var n,e,n,n=this,e=n.belongTo(t),n=n.charCategory.blocks[e];return"KATAKANA"===n||"CJK_SYMBOLS_AND_PUNCTUATION"===n||"HALFWIDTH_AND_FULLWIDTH_FORMS"===n||"BASIC_LATIN"===n&&" "<=t},u.prototype.getFullHalfWidthSpecialChar=function(t,n){for(var e,n,i,r,o,i=this,n=!0===n?(e=i.charCategory.aEt,i.charCategory.oEt):(e=i.charCategory.oEt,i.charCategory.aEt),r=-1,o=0;o<e.length;){if(e[o]===t){r=o;break}o++}return-1!==r&&o<n.length&&n[o]},u.prototype.toFullWidth=function(t){var n,e,i,r,o,o,t,n={},e=this;if(n.text=t,n.processedAll=!1,0!==t.length){if(i=t.substring(0,1),e.isMultiWidth(i)){if(i<e.charCategory.K8t[1])return" "===i?n.text="\u3000":(r="!",n.text=String.fromCharCode(i.charCodeAt(0)-"!".charCodeAt(0)+(e.charCategory.K8t[81].charCodeAt(0)+1))),n;if((e.multiWidthDetails(i)&e.charType.katakana)===e.charType.katakana){if(i.charCodeAt(0)<e.charCategory.KANA_HALF_START)return o=e.getFullHalfWidthSpecialChar(i,!0),n.text=!1!==o?o:i,n;if(i=e.charCategory.$8t[i.charCodeAt(0)-e.charCategory.KANA_HALF_START],t.length<2)return n.text=i,n;1!=(o=t.charCodeAt(1)-(e.charCategory.KATAKANA_VOICED.charCodeAt(0)-1))&&2!=o||(n.processedAll=!0,0!==(t=e.charCategory.eEt[i.charCodeAt(0)-(e.charCategory.K8t[62].charCodeAt(0)+1)])&&((2&Math.abs(t))==o&&(i=String.fromCharCode(i.charCodeAt(0)+1)),i=String.fromCharCode(i.charCodeAt(0)+1))),1==o&&"\u30a6"===i&&(i="\u30f4")}}n.text=i}return n},u.prototype.isUpperKana=function(t){return!this.isLowerKana(t)},u.prototype.isLowerKana=function(t){return-1!==u.lowerKana.search(t)},u.prototype.hasLowerKana=function(t){return-1!==u.upperKana.search(t)||this.isLowerKana(t)},u.prototype.toUpperKana=function(t){var n=u.lowerKana.search(t);return-1===n?t:u.upperKana.substr(n,1)},u.prototype.toLowerKana=function(t){var n=u.upperKana.search(t);return n>=u.upperKana.length-4&&n<u.upperKana.length||-1===n?t:u.lowerKana.substr(n,1)},u.prototype.toKatakana=function(t){var n,e,n=this;return n.isCharOfType(t,n.charType.hiragana|n.charType.fullWidth)?!1!==(e=n.getFullHalfWidthSpecialChar(t,!1))?e:String.fromCharCode(t.charCodeAt(0)-n.charCategory.K8t[61].charCodeAt(0)+n.charCategory.K8t[62].charCodeAt(0)):t},u.prototype.isCharOfType=function(t,n){return this.getCharType(t)===n},u.prototype.isKatakana=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.katakana},u.prototype.toHiragana=function(t){var n=this;return!n.isKatakana(t)||(n.isFullWidth(t)||(t=n.toFullWidth(t).text),!n.isCharOfType(t,n.charType.katakana|n.charType.fullWidth))||"\u30f7"<=t&&t<="\u30ff"?t:"\u30f5"===t?"\u304b":"\u30f6"===t?"\u3051":String.fromCharCode(t.charCodeAt(0)+n.charCategory.K8t[61].charCodeAt(0)-n.charCategory.K8t[62].charCodeAt(0))},u.prototype.isDigit=function(t){var n=this;return(n.getCharType(t)&~n.charType.fullWidth)===n.charType.numeric},u.prototype.isSurrogate=function(t){return null!==t&&t.charCodeAt(0)>="\ud800".charCodeAt(0)&&t.charCodeAt(0)<="\udfff".charCodeAt(0)},u.lowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30f5\u30f6\u3095\u3096",u.upperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30ab\u30b1\u304b\u3051",u.fullWidthSymbolArray=new Array("\u3001","\u3002","\uff0c","\uff0e","\u30fb","\uff1a","\uff1b","\uff1f","\uff01","\u309b","\u309c","\xb4","\uff40","\xa8","\uff3e","\uffe3","\uff3f","\u30fd","\u30fe","\u309d","\u309e","\u3003","\u4edd","\u3005","\u3006","\u3007","\u30fc","\u2014","\u2010","\uff0f","\u301c","\u2016","\uff5c","\u2026","\u2025","\u2018","\u2019","\u201c","\u201d","\uff08","\uff09","\u3014","\u3015","\uff3b","\uff3d","\uff5b","\uff5d","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff0b","\u2212","\xb1","\xd7","\xf7","\uff1d","\u2260","\uff1c","\uff1e","\u2266","\u2267","\u221e","\u2234","\u2642","\u2640","\xb0","\u2032","\u2033","\u2103","\uffe5","\uff04","\xa2","\xa3","\uff05","\uff03","\uff06","\uff0a","\uff20","\xa7","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u203b","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uff07","\uff02","\uff0d","\u3033","\u3034","\u3035","\u303b","\u303c","\u30ff","\u309f","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2284","\u2285","\u228a","\u228b","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\xac","\u21d2","\u21d4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212b","\u2030","\u266f","\u266d","\u266a","\u2020","\u2021","\xb6","\u266e","\u266b","\u266c","\u2669","\u25ef","\uff3c","\uff5e","\uffe0","\uffe1","\uffe2","\u2015"),u.halfWidthSymbolArray=new Array("\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","\uff61","\uff62","\uff63","\uff64","\uff65","\xa1","\xa4","\xa5"),n.uEt=u},"./src/text_Filter/emoji_helper.ts":function(t,n,e){var i,r;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),n.cEt=void 0,i=e("./src/calc.common.ts"),o.isEmoji=function(t,n,e){e.emojiCharLength=0;try{if(o.isEmojiEnclosedAlphanumericSymbol(t,n))return e.emojiCharLength=2,!0;if(o.isEmojiInSpecificRange(t,n)||o.isEmojiInUnicodeStandardSymbol(t,n))return o.isHighSurrogate(t,n)?e.emojiCharLength=2:e.emojiCharLength=1,!0}catch(t){}return!1},o.isEmojiEnclosedAlphanumericSymbol=function(t,n){return!(n>=t.length-1||o.isHighSurrogate(t,n)||!o.contains(o.fEt,o.convertToUtf32(t,n))||o.lEt!==o.convertToUtf32(t,n+1))},o.isEmojiInSpecificRange=function(t,n){for(var e,i,r,e=o.convertToUtf32(t,n),i=Math.floor(o.hEt.length/2),r=0;r<i;r++)if(o.hEt[2*r]<=e&&e<=o.hEt[2*r+1])return!0;return!1},o.isEmojiInUnicodeStandardSymbol=function(t,n){var t=o.convertToUtf32(t,n);return o.contains(o.dEt,t)},o.contains=function(t,n){for(var e,i,r,e=0,i=t.length-1;e<=i;){if(t[r=Math.floor((e+i)/2)]===n)return!0;t[r]>n?i=r-1:e=r+1}return!1},o.convertFromUtf32=function(t){if(t<0||1114111<t||55296<=t&&t<=57343)throw new Error((0,i.sR)().Exp_ArgumentOutOfRangeException);return t<65536?String.fromCharCode(t):(t-=65536,String.fromCharCode(Math.floor(t/1024)+55296,t%1024+56320))},o.convertToUtf32=function(t,n){var e,t;if(n<0||n>=t.length)throw new Error((0,i.sR)().Exp_ArgumentOutOfRangeException);if((e=t.charCodeAt(n)-55296)<0||2047<e)return t.charCodeAt(n);if(1023<e)throw new Error((0,i.sR)().Exp_ArgumentException);if(n>=t.length-1)throw new Error((0,i.sR)().Exp_ArgumentException);if((t=t.charCodeAt(n+1)-56320)<0||1023<t)throw new Error((0,i.sR)().Exp_ArgumentException);return 1024*e+t+65536},o.isHighSurrogate=function(t,n){var t=t.charCodeAt(n);return 55296<=t&&t<=56319},o.isLowSurrogate=function(t,n){var t=t.charCodeAt(n);return 56320<=t&&t<=57343},o.lEt=8419,o.fEt=[35,48,49,50,51,52,53,54,55,56,57],o.hEt=[9728,9983,9984,10175,10240,10495,11008,11263,19904,19967,65936,65999,118784,119039,119040,119295,119296,119375,119552,119647,126976,127023,127024,127135,127136,127231,127232,127487,127488,127743,127744,128511,128512,128591,128640,128767,128768,128895],o.dEt=[169,174,8194,8195,8197,8252,8265,8482,8505,8596,8597,8598,8599,8600,8601,8617,8618,8986,8987,9193,9194,9195,9196,9200,9203,9410,9642,9643,9654,9664,9723,9724,9725,9726,10548,10549,12336,12349,12951,12953],n.cEt=o},"./src/text_Filter/text_Filter.ts":function(t,n,e){var r,o,a,u,s,i,e;function c(t,n,e){void 0===e&&(e=!0);var i=this;i.format=n,i.includeFormat="",i.excludeFormat="",i.includeNormalChar="",i.excludeNormalChar="",i.allowTypes=u.All,i.excludeTypes=u.All,i.include=!0,i.autoConvert=t,i.charExInstance=new r.uEt,i.keepInvalidChar=e,i.parseFormat(i.format)}Object.defineProperty(n,"__esModule",{value:!0}),n._9t=n.CharacterType=void 0,r=e("./src/text_Filter/charProcess.ts"),o=e("./src/text_Filter/emoji_helper.ts"),a=e("./src/calc.common.ts"),(e=u=n.CharacterType||(n.CharacterType={}))[e.DBCS_UpperAlphabet=2147483650]="DBCS_UpperAlphabet",e[e.SBCS_UpperAlphabet=1073741825]="SBCS_UpperAlphabet",e[e.DBCS_LowerAlphabet=2147483656]="DBCS_LowerAlphabet",e[e.SBCS_LowerAlphabet=1073741828]="SBCS_LowerAlphabet",e[e.DBCS_Number=2147483680]="DBCS_Number",e[e.SBCS_Number=1073741840]="SBCS_Number",e[e.DBCS_Binary=2147483776]="DBCS_Binary",e[e.SBCS_Binary=1073741888]="SBCS_Binary",e[e.DBCS_Hexadecimal=2147484160]="DBCS_Hexadecimal",e[e.SBCS_Hexadecimal=1073742080]="SBCS_Hexadecimal",e[e.DBCS_Symbol=2147485696]="DBCS_Symbol",e[e.SBCS_Symbol=1073742848]="SBCS_Symbol",e[e.DBCS_NumberSymbol=2147491840]="DBCS_NumberSymbol",e[e.SBCS_NumberSymbol=1073745920]="SBCS_NumberSymbol",e[e.DBCS_Katakana=2147516416]="DBCS_Katakana",e[e.SBCS_Katakana=1073758208]="SBCS_Katakana",e[e.DBCS_Space=2147614720]="DBCS_Space",e[e.SBCS_Space=1073807360]="SBCS_Space",e[e.TwoBytes=2148007936]="TwoBytes",e[e.FourBytes=2147745792]="FourBytes",e[e.DBCS_ShiftJIS=2148532224]="DBCS_ShiftJIS",e[e.DBCS_JISX0208=2149580800]="DBCS_JISX0208",e[e.Emoji=4194304]="Emoji",e[e.IVS=8388608]="IVS",e[e.DBCS_Hiragana=2164260864]="DBCS_Hiragana",e[e.Upper_SBCS_Katakana=1207959552]="Upper_SBCS_Katakana",e[e.Upper_DBCS_Katakana=2415919104]="Upper_DBCS_Katakana",e[e.Upper_DBCS_Hiragana=2684354560]="Upper_DBCS_Hiragana",e[e.All=3321888768]="All",e[e.DBCS_All=2214592512]="DBCS_All",e[e.SBCS_All=1107296256]="SBCS_All",e[e.DBCS=2147483648]="DBCS",e[e.SBCS=1073741824]="SBCS",s={"\uff21":u.DBCS_UpperAlphabet,A:u.SBCS_UpperAlphabet,"\uff41":u.DBCS_LowerAlphabet,a:u.SBCS_LowerAlphabet,"\uff2b":u.DBCS_Katakana,K:u.SBCS_Katakana,"\uff19":u.DBCS_Number,9:u.SBCS_Number,"\uff03":u.DBCS_NumberSymbol,"#":u.SBCS_NumberSymbol,"\uff20":u.DBCS_Symbol,"@":u.SBCS_Symbol,"\uff22":u.DBCS_Binary,B:u.SBCS_Binary,"\uff38":u.DBCS_Hexadecimal,X:u.SBCS_Hexadecimal,"\uff2a":u.DBCS_Hiragana,"\uff3a":u.DBCS_All,"\uff2d":u.DBCS_ShiftJIS,"\uff29":u.DBCS_JISX0208,H:u.SBCS_All,N:u.Upper_SBCS_Katakana,"\uff2e":u.Upper_DBCS_Katakana,"\uff27":u.Upper_DBCS_Hiragana,"\uff33":u.DBCS_Space,S:u.SBCS_Space,"\uff34":u.FourBytes,"\uff24":u.TwoBytes,"\uff25":u.Emoji,"\uff36":u.IVS},c.prototype.parseFormat=function(t){var n=this;n.includeFormat=n.getIncludeFormat(t),n.excludeFormat=n.getExcludeFormat(t),n.parseIncludeFormat(n.includeFormat),n.parseExcludeFormat(n.excludeFormat)},c.prototype.getIncludeFormat=function(t){var n,e,i;if(null===t||0===t.length)return"";for(n="",e=0;e<t.length;e++)if("\\"===(i=t.substring(e,e+1))){if(e===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;n=n+i+t.substring(e+1,e+2),e++}else{if("^"===i)return n;n+=i}return n},c.prototype.getExcludeFormat=function(t){var n,e,i,r;if(null===t||0===t.length)return"";for(e="",i=n=0;i<t.length;i++)if("\\"===(r=t.substring(i,i+1))){if(i===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;0!==n&&(e=e+r+t.substring(i+1,i+2)),i++}else if("^"===r){if(1<++n)throw(0,a.sR)().Exp_DuplicatedChar}else 0!==n&&(e+=r);return e=1===n?"^"+e:e},c.prototype.parseIncludeFormat=function(t){var n,e,i,i,n=this;if(null===t||0===t.length)n.allowTypes=u.All,n.includeNormalChar="",n.includeFormat="";else for(n.allowTypes=0,n.includeNormalChar="",e=0;e<t.length;e++)switch(t.charCodeAt(e)){case 94:break;case 92:if(e===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;n.includeNormalChar=n.includeNormalChar+t.substring(e+1,e+2),e++;break;default:i=t[e],(i=s[i])?n.allowTypes|=i:n.includeNormalChar=n.includeNormalChar+t.substring(e,e+1)}},c.prototype.parseExcludeFormat=function(t){var n,e,i,i,n=this;if(null===t||0===t.length)n.excludeTypes=u.All,n.excludeNormalChar="",n.excludeFormat="";else if("^"===t)n.excludeTypes=u.All,n.excludeNormalChar="",n.excludeFormat="^";else for(n.excludeTypes=0,n.excludeNormalChar="",e=0;e<t.length;e++)switch(t.charCodeAt(e)){case 94:0===e&&(n.include=!1);break;case 92:if(e===t.length-1)throw(0,a.sR)().Exp_FormulaInvalid;n.excludeNormalChar=n.excludeNormalChar+t.substring(e+1,e+2),e++;break;default:i=t[e],(i=s[i])?n.excludeTypes|=i:n.excludeNormalChar=n.excludeNormalChar+t.substring(e,e+1)}},c.prototype.checkText=function(t){for(var n,e,i,r,o,a,n=this,e=t.length,i={IsInputValid:!0,CheckedText:""},r=0;r<e;)"\t"!==(o=t.substring(r,r+1))&&"\r"!==o&&"\n"!==o?(a=n.check(t,r),n.isNullOrUndefined(a.index)?(o=a,r++):(r=a.index,o=a.strValue),""===o&&(i.IsInputValid=!1)):r++,i.CheckedText+=o;return i},c.prototype.check=function(t,n){var e,i,r,e=this,i=null!==n?t.substring(n,n+1):t,r;return e.IsValid(i)?i:e.autoConvert?null!==n?e.Convert(t,n):e.Convert(i):""},c.prototype.IsValid=function(t){var n=this;return(""===n.excludeFormat||!n.IsValidProcess(t,n.excludeTypes,n.excludeNormalChar))&&(""===n.includeFormat||n.IsIncludeValid(t))},c.prototype.Convert=function(t,n){var e,i,r,o,a,u,s,s,c,c,f,e=this,i=null===n?t:t.substring(n,n+1),r=!1;if(e.charExInstance.isAlphabet(i))return o=e.charExInstance.isLower(i)?i.toUpperCase():i.toLowerCase(),(r=e.IsValid(o))?o:(i=e.charExInstance.isFullWidth(i)?e.charExInstance.toHalfWidth(i):e.charExInstance.toFullWidth(i).text,(r=e.IsValid(i))?i:(o=e.charExInstance.isFullWidth(o)?e.charExInstance.toHalfWidth(o):e.charExInstance.toFullWidth(o).text,(r=e.IsValid(o))?o:e.keepInvalidChar?i:""));if(e.charExInstance.isHiragana(i)){if(e.charExInstance.isLowerKana(i)){if(a=e.charExInstance.toUpperKana(i),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(i)&&(u=e.charExInstance.toLowerKana(i),r=e.IsValid(u)))return u;if(o=e.charExInstance.toKatakana(i),r=e.IsValid(o))return o;if(e.charExInstance.isLowerKana(o)){if(a=e.charExInstance.toUpperKana(o),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(o)&&(u=e.charExInstance.toLowerKana(o),r=e.IsValid(u)))return u;if(s=e.charExInstance.toHalfWidthEx(o),r=e.IsValid(s))return s;if(e.charExInstance.isLowerKana(s)){if(s=e.charExInstance.toUpperKana(s),r=e.IsValid(s))return s}else if(e.charExInstance.hasLowerKana(s)&&(s=e.charExInstance.toLowerKana(s),r=e.IsValid(s)))return s;return e.keepInvalidChar?i:""}if(e.charExInstance.isKatakana(i)){if(e.charExInstance.isLowerKana(i)){if(a=e.charExInstance.toUpperKana(i),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(i)&&(u=e.charExInstance.toLowerKana(i),r=e.IsValid(u)))return u;if(s=!1,o=i,e.charExInstance.isFullWidth(i)){if(0<(c=e.charExInstance.toHalfWidthEx(i)).length&&(r=e.IsValid(c)))return c;if(e.charExInstance.isLowerKana(c)){if(c=e.charExInstance.toUpperKana(c),r=e.IsValid(c))return c}else if(e.charExInstance.hasLowerKana(c)&&(c=e.charExInstance.toLowerKana(c),r=e.IsValid(c)))return c}else{if(null===n){if(o=e.charExInstance.toFullWidth(i).text,!e.charExInstance.isKatakana(o))return e.keepInvalidChar?i:"";if(r=e.IsValid(o))return o}else{if(n+1<t.length?(o=(c=e.charExInstance.toFullWidth(t.substring(n,n+2))).text,s=c.processedAll):o=e.charExInstance.toFullWidth(i).text,!e.charExInstance.isKatakana(o))return e.keepInvalidChar?i:"";if(r=e.IsValid(o))return n++,s&&n++,(f={}).index=n,f.strValue=o,f}if(e.charExInstance.isLowerKana(o)){if(a=e.charExInstance.toUpperKana(o),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(o)&&(u=e.charExInstance.toLowerKana(o),r=e.IsValid(u)))return u}if(o=e.charExInstance.toHiragana(o),r=e.IsValid(o))return null!==n?(n++,s&&n++,(f={}).index=n,"\u3094"===(f.strValue=o)&&(f.strValue=s?"\u3046\u309b":""),f):"\u3094"===o?e.keepInvalidChar?i:"":o;if(e.charExInstance.isLowerKana(o)){if(a=e.charExInstance.toUpperKana(o),r=e.IsValid(a))return a}else if(e.charExInstance.hasLowerKana(o)&&(u=e.charExInstance.toLowerKana(o),r=e.IsValid(u)))return u}return i=e.charExInstance.isFullWidth(i)?e.charExInstance.toHalfWidth(i):e.charExInstance.toFullWidth(i).text,(r=e.IsValid(i))||e.keepInvalidChar?i:""},c.prototype.IsIncludeValid=function(t){var n=this;return n.IsValidProcess(t,n.allowTypes,n.includeNormalChar)},c.prototype.IsValidProcess=function(t,n,e){var i,e,r,i=this;if(-1!==e.indexOf(t))return!0;if("\t"===t||"\r"===t||"\n"===t)return!0;if(0===n)return!1;if(e=!1,n===u.All||(n&u.Emoji)==(0|u.Emoji)&&o.cEt.isEmoji(t,0,{})||(n&u.FourBytes)==(0|u.FourBytes)&&i.IsFourBytes(t))return!0;if(1===t.length&&1<t.length)return!1;if(i.charExInstance.isFullWidth(t)){if((n&u.DBCS)!=(0|u.DBCS))return!1;(n&u.DBCS_All)==(0|u.DBCS_All)&&"\u3000"!==t||(n&u.DBCS_LowerAlphabet)==(0|u.DBCS_LowerAlphabet)&&i.IsLower(t)||(n&u.DBCS_UpperAlphabet)==(0|u.DBCS_UpperAlphabet)&&i.IsUpper(t)||(n&u.DBCS_Number)==(0|u.DBCS_Number)&&i.IsNumber(t)||(n&u.DBCS_Binary)==(0|u.DBCS_Binary)&&i.IsBinary(t)||(n&u.DBCS_Hexadecimal)==(0|u.DBCS_Hexadecimal)&&i.IsHex(t)||(n&u.DBCS_Symbol)==(0|u.DBCS_Symbol)&&i.IsSymbol(t)||(n&u.DBCS_NumberSymbol)==(0|u.DBCS_NumberSymbol)&&i.IsNumberSymbol(t)||(n&u.Upper_DBCS_Katakana)==(0|u.Upper_DBCS_Katakana)&&i.IsKatakana(t)&&i.IsUpperKana(t)||(n&u.Upper_DBCS_Hiragana)==(0|u.Upper_DBCS_Hiragana)&&i.IsHiragana(t)&&i.IsUpperKana(t)||(n&u.DBCS_Space)==(0|u.DBCS_Space)&&i.IsFormatSpace(t)||(n&u.FourBytes)==(0|u.FourBytes)&&i.IsFourBytes(t)||(n&u.TwoBytes)==(0|u.TwoBytes)&&!i.IsFourBytes(t)&&"\u3000"!==t?e=!0:(n&u.DBCS_Katakana)==(0|u.DBCS_Katakana)&&i.IsKatakana(t)?e=!(r=i.IsHiragana(t))||!!i.include||(n&u.DBCS_Hiragana)==(0|u.DBCS_Hiragana):(n&u.DBCS_Hiragana)==(0|u.DBCS_Hiragana)&&i.IsHiragana(t)&&(e=!(r=i.IsKatakana(t))||!!i.include||(n&u.DBCS_Katakana)==(0|u.DBCS_Katakana))}else{if((n&u.SBCS)!==u.SBCS)return!1;((n&u.SBCS_All)===u.SBCS_All&&" "!==t||(n&u.SBCS_LowerAlphabet)===u.SBCS_LowerAlphabet&&i.IsLower(t)||(n&u.SBCS_UpperAlphabet)===u.SBCS_UpperAlphabet&&i.IsUpper(t)||(n&u.SBCS_Number)===u.SBCS_Number&&i.IsNumber(t)||(n&u.SBCS_Binary)===u.SBCS_Binary&&i.IsBinary(t)||(n&u.SBCS_Hexadecimal)===u.SBCS_Hexadecimal&&i.IsHex(t)||(n&u.SBCS_Symbol)===u.SBCS_Symbol&&i.IsSymbol(t)||(n&u.SBCS_NumberSymbol)===u.SBCS_NumberSymbol&&i.IsNumberSymbol(t)||(n&u.SBCS_Katakana)===u.SBCS_Katakana&&i.IsKatakana(t)||(n&u.Upper_SBCS_Katakana)===u.Upper_SBCS_Katakana&&i.IsKatakana(t)&&i.IsUpperKana(t)||(n&u.SBCS_Space)===u.SBCS_Space&&i.IsFormatSpace(t))&&(e=!0)}return e},c.prototype.IsUpper=function(t){return this.charExInstance.isUpper(t)},c.prototype.IsLower=function(t){return this.charExInstance.isLower(t)},c.prototype.IsNumber=function(t){return this.charExInstance.isDigit(t)},c.prototype.IsBinary=function(t){return"0"===(t=this.IsFullWidth(t)?this.ToHalfWidth(t):t)||"1"===t},c.prototype.IsHex=function(t){var n=this;return"A"===(t=n.IsFullWidth(t)?n.ToHalfWidth(t):t)||"B"===t||"C"===t||"D"===t||"E"===t||"F"===t||"a"===t||"b"===t||"c"===t||"d"===t||"e"===t||"f"===t||n.IsDigit(t)},c.prototype.IsNumberSymbol=function(t){var n=this;return t=n.IsFullWidth(t)?n.ToHalfWidth(t):t,n.IsDigit(t)||"+"===t||"-"===t||"$"===t||"%"===t||"\\"===t||","===t||"."===t},c.prototype.IsKatakana=function(t){return this.charExInstance.isKatakana(t)},c.prototype.IsHiragana=function(t){return this.charExInstance.isHiragana(t)},c.prototype.IsFullWidth=function(t){return this.charExInstance.isFullWidth(t)},c.prototype.ToHalfWidth=function(t){return this.charExInstance.toHalfWidth(t)},c.prototype.IsDigit=function(t){return this.charExInstance.isDigit(t)},c.prototype.IsFourBytes=function(t){var n,e,i,n=this.charExInstance,e=t.substring(0,1);if(2===e.length)for(i=0;i<e.length;i++)if(n.isSurrogate(e[i]))return!0;return!1},c.prototype.IsFormatSpace=function(t){return" "===t||"\u3000"===t},c.prototype.IsSymbol=function(t){var n=this;return n.charExInstance.isHalfWidthSymbol(t)||n.charExInstance.isFullWidthSymbol(t)},c.prototype.IsUpperKana=function(t){return this.charExInstance.isUpperKana(t)},c.prototype.isNullOrUndefined=function(t){return null==t},n._9t=c},Common:function(t){t.exports=o("Common")}},i={},t=r("./src/calc.entry.ts"),((a={}).Spread=a.Spread||{}).CalcEngine=t}(),t.exports=a.Spread.CalcEngine},"./node_modules_local/@spreadjs/js-calc/index.js":function(t,n,e){t.exports=e("./node_modules_local/@spreadjs/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js":function(t,n,e){var i,r,o,a;function u(t){var n,n,n=o[t];return void 0!==n||(n=o[t]={exports:{}},r[t].call(n.exports,n,n.exports,u)),n.exports}r={"./dist/src/calculation/calcSource.js":function(t,n,e){"use strict";var i,c,f,r,o,a,u;function s(){this.row=[],this.field=[]}function l(t,n){var t=u.call(this,t)||this;return t.nM=n,t.MEt={},t}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerCalcSource=n.DataManagerReference=void 0,c=e("CalcEngine"),f=e("./dist/src/dataSource/utils.js"),s.prototype.parseRowIndex=function(t,n,e){var i=n.num;return n.relative||(-1===n.num?i=t-1:i--),e*n.relative+i},s.prototype.getValueImp=function(t){var n,e,i,r,o,a,u,s,n=this.table.length();if(this.field.vEt&&this.field.vEt[this.rowString])return this.field.vEt[this.rowString];if(e=[],0===this.row.length)for(i=0;i<n;i++)e.push(this.field.getValue(i));for(r=0;r<this.row.length;r++)if(2===(o=this.row[r]).length)for(a=this.parseRowIndex(n,o[0],t),u=this.parseRowIndex(n,o[1],t),s=a;s<=u;s++)e.push(this.field.getValue(s));else if(o.type)if("key"===o.type)i=this.table.mEt(o.value),e=e.concat(this.field.getValues(i));else for(s="odd"===o.type?1:0;s<n;s+=2)e.push(this.field.getValue(s));else i=this.parseRowIndex(n,o,t),e.push(this.field.getValue(i));if(1===e.length)e=e[0];else if(0===e.length)return null;return(0,f.isArray)(e)&&(e=(0,f.isArray)(e[0])?new c.CalcArray(e):new c.CalcArray([e])),this.gEt||(this.field.vEt=this.field.vEt||{},this.field.vEt[this.rowString]=e),e},s.prototype.getValuesImp=function(t,n,e,i,r,o){var t=this.field.getValues(t,n,e,i,r,o);return(0,f.isArray)(t[0])?new c.CalcArray(t):new c.CalcArray([t])},s.prototype.getValue=function(t,n,e,i,r,o){return this.pEt(),(0,f.isArray)(t)?this.getValuesImp(t,n,e,i,r,o):this.getValueImp(t)},s.prototype.pEt=function(){this.field=this.table.rRt(this.Pq)},n.DataManagerReference=s,u=c.CalcSource,i(l,u),l.prototype.yEt=function(){return this._allFieldNames},l.prototype.wEt=function(t,n){2===arguments.length?this.MEt[t]=n:1===arguments.length&&delete this.MEt[t]},l.prototype.pe=function(t,n,e,i,r,o,a){this.DJ=t,this.ak=n,this.pwn=e,this.GOt=i,this.obe=r,this.abe=o,this.R6t=a},l.prototype.getField=function(t){var n=this.DJ,e=this.ak,i=this.pwn,r=this.obe,o=this.abe,a=this.R6t;return t.getValue(n,e,i,r,o,a)},l.prototype.getValue=function(){var t=this.GOt;return t&&"number"==typeof this.DJ?this.nM._getValueByField(t,this.DJ):null},n.DataManagerCalcSource=l},"./dist/src/calculation/functions/functions.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f,l,h;function d(){(0,i.addScopeCustomFunctions)(),(0,r.addParentCustomFunctions)(),(0,o.addChildrenCustomFunctions)(),(0,a.addOnlyChildrenCustomFunctions)(),(0,u.addLevelCustomFunctions)(),(0,s.addLevelRowNumberCustomFunctions)(),(0,c.addQueryFunction)(),(0,f.addWindowOverFunctions)(),(0,l.addWindowFunctions)(),(0,h.addTriggerFieldValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addCustomFunctions=void 0,i=e("./dist/src/calculation/functions/scope.js"),r=e("./dist/src/calculation/functions/hierarchyParent.js"),o=e("./dist/src/calculation/functions/hierarchyChildren.js"),a=e("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),u=e("./dist/src/calculation/functions/hierarchyLevel.js"),s=e("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),c=e("./dist/src/calculation/functions/query.js"),f=e("./dist/src/calculation/functions/windowOvers/windowOvers.entry.js"),l=e("./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js"),h=e("./dist/src/calculation/functions/triggerFieldValue.js"),n.addCustomFunctions=d},"./dist/src/calculation/functions/hierarchyChildren.js":function(t,n,e){"use strict";var u,s,i,r;function o(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new i.CalcFunction(r,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,e,i){var r,o,n,a,r=[],o=t.source.nM,n=t.source.DJ;return o.CEt()&&(a=o.SEt(n),!(0,s.isNullOrUndefined)(a))&&0<e&&!(0,s.isNullOrEmpty)(i)&&((0,s.traversalTree)(a,{invoking:function(t){var n,n,n;return 0===--e?(n=t.lp,n=o._dataSource.TEt(n),n=o._getValueByField(i,n),r.push(n),{cancelDeepRecursion:!0}):0===t.children.length?{cancelDeepRecursion:!0}:void 0},invoked:function(){e++}}),t.source.DJ=n),new u.CalcArray([r])},u.Functions.defineGlobalCustomFunction(r,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addChildrenCustomFunctions=void 0,u=e("CalcEngine"),s=e("./dist/src/dataSource/utils.js"),i=e("./dist/src/calculation/functions/utils.js"),r="CHILDREN",n.addChildrenCustomFunctions=o},"./dist/src/calculation/functions/hierarchyLevel.js":function(t,n,e){"use strict";var i,r,o,a;function u(){function t(){}(t.prototype=new o.CalcFunction(a)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,r.isNullOrUndefined)(n)))return n.level},i.Functions.defineGlobalCustomFunction(a,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/calculation/functions/utils.js"),a="LEVEL",n.addLevelCustomFunctions=u},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(t,n,e){"use strict";var i,r,o,a;function u(){function t(){}(t.prototype=new o.CalcFunction(a)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,r.isNullOrUndefined)(n)))return n.getCurrentIndex()+1},i.Functions.defineGlobalCustomFunction(a,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelRowNumberCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/calculation/functions/utils.js"),a="LEVELROWNUMBER",n.addLevelRowNumberCustomFunctions=u},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(t,n,e){"use strict";var a,u,i,r;function o(){function t(){this.R9t=[{J6t:5}]}(t.prototype=new i.CalcFunction(r,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){var e,i,r,o,e=[],i=t.source.nM,r=t.source.DJ;return i.CEt()&&(o=i.SEt(r),(0,u.isNullOrUndefined)(o)||(0,u.isNullOrEmpty)(n)||((0,u.traversalTree)(o,function(t){var t,t,t;0===t.children.length&&(t=t.lp,t=i._dataSource.TEt(t),t=i._getValueByField(n,t),e.push(t))}),t.source.DJ=r)),new a.CalcArray([e])},a.Functions.defineGlobalCustomFunction(r,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addOnlyChildrenCustomFunctions=void 0,a=e("CalcEngine"),u=e("./dist/src/dataSource/utils.js"),i=e("./dist/src/calculation/functions/utils.js"),r="ONLYCHILDREN",n.addOnlyChildrenCustomFunctions=o},"./dist/src/calculation/functions/hierarchyParent.js":function(t,n,e){"use strict";var i,a,r,o;function u(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new r.CalcFunction(o,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,e){var i,r,o,o,n,o,n,i=t.source.nM,r=t.source.DJ;if(i.CEt()&&(o=i.SEt(r),!(0,a.isNullOrUndefined)(o))&&0<n&&!(0,a.isNullOrEmpty)(e)&&!(o=s(o,n)).isRoot)return n=o.lp,o=i._dataSource.TEt(n),n=i._getValueByField(e,o),t.source.DJ=r,n},i.Functions.defineGlobalCustomFunction(o,new t)}function s(t,n){return 0===n||t.isRoot?t:s(t.parent,n-1)}Object.defineProperty(n,"__esModule",{value:!0}),n.addParentCustomFunctions=void 0,i=e("CalcEngine"),a=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/calculation/functions/utils.js"),o="PARENT",n.addParentCustomFunctions=u},"./dist/src/calculation/functions/query.js":function(t,n,e){"use strict";var c,f,i;function r(){var t;c.Functions.findGlobalFunction(i)||((t=new c.Functions.AsyncFunction(i,1,3)).isContextSensitive=function(){return!0},t.evaluateAsync=function(i,r,o,a){var t,u,n,t;function s(){var t,t,t,t;null!=(t=null==(t=null==(t=i.ctx)?void 0:t.Xkt)?void 0:t.node)&&t.WK?(t=u.IEt(r,o,a))&&(a?i.setAsyncResult(t[0]):i.setAsyncResult(new c.CalcArray(t))):u.IEt(r,o,a,s,!0)}function e(t){var n,e,n=u.IEt(r,o,a,s);if(n){if(a){if(e=n[0],t)return e}else if(e=new c.CalcArray(n),t)return e;i.setAsyncResult(e)}}if(t=i.ctx.source,t=(n=(u=t instanceof f.DataManagerCalcSource?t.nM.QOt:i.ctx.source.Mf.parent.dataManager()).xEt(r,o,a)).table){if(t.length())return e(!0);t.NEt().then(function(){e()})}},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},c.Functions.defineGlobalCustomFunction(i,t))}Object.defineProperty(n,"__esModule",{value:!0}),n.addQueryFunction=void 0,c=e("CalcEngine"),f=e("./dist/src/calculation/calcSource.js"),i="QUERY",n.addQueryFunction=r},"./dist/src/calculation/functions/scope.js":function(t,n,e){"use strict";var i,r,o,a,u;function s(){function t(){}function n(){}(t.prototype=new o.CalcFunction(a,2,2)).isContextSensitive=function(){return!0},t.prototype.isReverseArgs=function(){return!0},t.prototype.evaluate=function(t,n,e){return t.source.ak=n.start,t.source.DJ=n.context,e},i.Functions.defineGlobalCustomFunction(a,new t),(n.prototype=new o.CalcFunction(u,0,255)).isContextSensitive=function(){return!0},n.prototype.evaluate=function(t){for(var n,e,i,r,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return i={start:t.source.ak,context:t.source.DJ},r=t.source.MEt,t.source.ak=0,t.source.DJ=c(r.groupContext,n),i},i.Functions.defineGlobalCustomFunction(u,new n)}function c(t,n){var n=f(t.groupOptions.slice(0,t.path.length),n);return l(t.path,n)?t.entireScope:h(t.path,n)}function f(t,n){var e,i;if(n&&0<n.length){for(e=-1,t.reverse(),i=0;i<t.length;i++)if(t[i].field!==n[i]){(0,r.isNullOrUndefined)(n[i])&&n.length<=i&&(e=t.length-i-1);break}return e}return-1}function l(t,n){return-1===n||t.length-1<=n}function h(t,n){var e,i=[];return d(t[n],i),i}function d(t,n){var e,i,r,o,a,u,s,c,e=n.length,i=t.recordRowNumbers;if(i)for(r=0,o=i.length;r<o;r++)n[e+r]=i[r];else for(u=0,s=a=t.children;u<s.length;u++)d(c=s[u],n)}Object.defineProperty(n,"__esModule",{value:!0}),n.addScopeCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/calculation/functions/utils.js"),a="CALCULATE",u="REMOVEFILTERS",n.addScopeCustomFunctions=s},"./dist/src/calculation/functions/triggerFieldValue.js":function(t,n,e){"use strict";var i,r,o;function a(){function t(){}(t.prototype=new o.CalcFunction(n.TRIGGERFIELDVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,e){var t=t.source.nM._dataSource,i=t.getFieldValue(n,0);return(0,r.isUndefined)(i)&&e?t.getFieldOriginalValue(n,0):i},i.Functions.defineGlobalCustomFunction(n.TRIGGERFIELDVALUE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addTriggerFieldValueCustomFunctions=n.TRIGGERFIELDVALUE=void 0,i=e("CalcEngine"),r=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/calculation/functions/utils.js"),n.TRIGGERFIELDVALUE="TRIGGERFIELDVALUE",n.addTriggerFieldValueCustomFunctions=a},"./dist/src/calculation/functions/utils.js":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CalcFunction=void 0;var e=e("./dist/src/dataManager.common.js");n.CalcFunction=e.CalcFunction},"./dist/src/calculation/functions/windowFunctions/cumeDist.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.CUMEDIST)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,r.expandContext)(t,function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,n=t.indexes,e=t.begin,i=t.length,r=t.result,o=t.orders,a=t.isOrderValid,u=t.reader,s=i-e,c=a&&1===o.length,f=a&&o[0].field,l=function(t){return u(f,n[t])},h=function(t,n){return u(o[n].field,t)},d=function(t){return n[t]},v=e;v<i;v++)if(a){if(m=n[v],g=void 0,b=n[p=v+1],c)(g=u(f,m))===u(f,b)&&(p=(-1!==(w=A(l,g,p,i-1))?w:p)+1);else{for(g=[],M=!(y=void 0),C=0;C<o.length;C++){if(f=o[C].field,(y=u(f,m))!==u(f,b)){M=!1;break}g.push(y)}M&&(p=(-1!==(w=I(d,h,g,p,i-1))?w:p)+1)}for(S=(p-e)/s,T=p-v;0<T;)T--,r.push(S);v=p-1}else r.push(1)})},i.Functions.defineGlobalCustomFunction(r.CUMEDIST,new t)}function A(t,n,e,i){for(var r,o,a,u,s,r=e,o=i,a=-1;r<=o;)n===(s=t(u=Math.floor((r+o)/2)))?(r=u+1,a=u):o=u-1;return a}function I(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=i,a=r,u=-1,s=e.length-1;o<=a;){for(f=t(c=Math.floor((o+a)/2)),l=!0,h=s;0<=h;h--)if(n(f,h)!==e[h]){l=!1;break}l?(o=c+1,u=c):a=c-1}return u}Object.defineProperty(n,"__esModule",{value:!0}),n.addCumeDistCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addCumeDistCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/denseRank.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.DENSERANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,r.expandContext)(t,function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,n=t.indexes,e=t.begin,i=t.length,r=t.result,o=t.orders,a=t.reader,u=t.isOrderValid,s=0,l=!1;for(u&&((h=1===o.length)?d=o[0].field:c=[]),v=e;v<i;v++){if(u)if(m=n[v],h)(f=a(d,m))===c&&v!==e||(s+=1,c=f);else{for(f=[],g=o.length-1;0<=g;g--)p=a(o[g].field,m),f.unshift(p),p!==c[g]&&(l=!0);!l&&v!==e||(l=!1,s+=1,c=f)}else s=1;r.push(s)}})},i.Functions.defineGlobalCustomFunction(r.DENSERANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addDenseRankCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addDenseRankCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js":function(t,n,e){"use strict";var i,g,r,p,e;function o(){function t(){}(t.prototype=new r.CalcFunction(r.FIRSTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return s(t,n,p.first,1)},i.Functions.defineGlobalCustomFunction(r.FIRSTVALUE,new t)}function a(){function t(){}(t.prototype=new r.CalcFunction(r.LASTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return s(t,n,p.last,1)},i.Functions.defineGlobalCustomFunction(r.LASTVALUE,new t)}function u(){function t(){}(t.prototype=new r.CalcFunction(r.NTHVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,e){return s(t,n,p.nth,e)},i.Functions.defineGlobalCustomFunction(r.NTHVALUE,new t)}function s(t,n,d,v){var e,m=t.source.nM.Cve(n);return(0,r.expandContext)(t,function(t){var n,e,i,r,o,a,t,u,s,c,f,l,h,n=t.indexes,e=t.begin,i=t.length,r=t.result,o=t.frame,a=t.evaluateWindowIndexes,t=t.buildFrameGroups;if((0,g.isNumber)(v)&&0<v)for(v=Math.floor(v),u={startIndex:e,endIndex:e,lastStartIndex:e,lastEndIndex:e},s=t(n,e),c=e;c<i;c++)a(o,e,c,n,u,s),-1===u.startIndex&&-1===u.endIndex?r.push(null):d===p.first?r.push(m(n[u.startIndex])):d===p.last?r.push(m(n[u.endIndex])):!((f=u.startIndex+v-1)<=u.endIndex)||void 0!==u.gapStartIndex&&void 0!==u.gapEndIndex&&(l=u.gapStartIndex-u.startIndex)<v&&(f=void 0!==u.currentIndex?1==(h=v-l)?u.currentIndex:h-1+u.gapEndIndex:v-l+u.gapEndIndex,u.endIndex<f)?r.push(null):r.push(m(n[f]))})}Object.defineProperty(n,"__esModule",{value:!0}),n.addNthValueCustomFunctions=n.addLastValueCustomFunctions=n.addFirstValueCustomFunctions=void 0,i=e("CalcEngine"),g=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),(e=p=p||{})[e.first=0]="first",e[e.last=1]="last",e[e.nth=2]="nth",n.addFirstValueCustomFunctions=o,n.addLastValueCustomFunctions=a,n.addNthValueCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/leadLag.js":function(t,n,e){"use strict";var i,h,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.LEAD,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,e,i){return u(t,n,e,i)},i.Functions.defineGlobalCustomFunction(r.LEAD,new t)}function a(){function t(){}(t.prototype=new r.CalcFunction(r.LAG,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,e,i){return u(t,n,e,i,!0)},i.Functions.defineGlobalCustomFunction(r.LAG,new t)}function u(t,n,s,c,f){var e,l=t.source.nM.Cve(n);return(0,r.expandContext)(t,function(t){var n,e,i,r,o,a,u,n=t.indexes,e=t.begin,i=t.length,r=t.result;if(s=(0,h.isNullOrUndefined)(s)?1:s,(0,h.isNumber)(s)&&0<=s)for(s=Math.floor(s),c=(0,h.isNullOrUndefined)(c)?null:c,o=e;o<i;o++)u=a=void 0,(u=f?e<=(a=o-s):(a=o+s)<i)?r.push(l(n[a])):r.push(c)})}Object.defineProperty(n,"__esModule",{value:!0}),n.addLagCustomFunctions=n.addLeadCustomFunctions=void 0,i=e("CalcEngine"),h=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addLeadCustomFunctions=o,n.addLagCustomFunctions=a},"./dist/src/calculation/functions/windowFunctions/nTile.js":function(t,n,e){"use strict";var i,f,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.NTILE,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,c){return(0,r.expandContext)(t,function(t){var n,e,i,t,r,o,a,u,s,n=t.begin,e=t.length,i=t.result;if((0,f.isNumber)(c)&&0<c&&c<e)for(t=e-n,a=(r=Math.floor(t/c))+(0<(o=t%c)?1:0),o--,u=n,s=1;u<e;u++)i.push(s),0===--a&&(a=r+(0<o?1:0),o--,s++);else for(u=n;u<e;u++)i.push(u-n+1)})},i.Functions.defineGlobalCustomFunction(r.NTILE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addNTileCustomFunctions=void 0,i=e("CalcEngine"),f=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addNTileCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/percentRank.js":function(t,n,e){"use strict";var i,r,o;function a(){function t(){}(t.prototype=new o.CalcFunction(o.WPERCENTRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,r.evaluateRank)(t,function(t,n){return 1===n?0:(t-1)/(n-1)})},i.Functions.defineGlobalCustomFunction(o.WPERCENTRANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWPercentRankCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowFunctions/rank.js"),o=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWPercentRankCustomFunctions=a},"./dist/src/calculation/functions/windowFunctions/rank.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.WRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return a(t)},i.Functions.defineGlobalCustomFunction(r.WRANK,new t)}function a(t,w){return(0,r.expandContext)(t,function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,n=t.indexes,e=t.begin,i=t.length,r=t.result,o=t.orders,a=t.isOrderValid,u=t.reader,s=1,l=!1,h=i-e,d=!1;for(a&&((d=1===o.length)?v=o[0].field:c=[]),m=e;m<i;m++){if(a)if(g=n[m],d)(f=u(v,g))===c&&m!==e||(s=m-e+1,w&&(s=w(s,h)),c=f);else{for(f=[],p=o.length-1;0<=p;p--)b=u(o[p].field,g),f.unshift(b),b!==c[p]&&(l=!0);!l&&m!==e||(l=!1,s=m-e+1,w&&(s=w(s,h)),c=f)}r.push(s)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateRank=n.addWRankCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWRankCustomFunctions=o,n.evaluateRank=a},"./dist/src/calculation/functions/windowFunctions/rowNumber.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.ROWNUMBER)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,r.expandContext)(t,function(t){for(var n,e,i,r,n=t.begin,e=t.length,i=t.result,r=n;r<e;r++)i.push(r-n+1)})},i.Functions.defineGlobalCustomFunction(r.ROWNUMBER,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addRowNumberCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),n.addRowNumberCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/util.js":function(t,n,e){"use strict";var v,e;function r(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function i(t,n,e){return t.map(function(t){return n(t.field,e)})}function o(t,n){if(t!==n){if((0,v.isNullOrUndefined)(t)||(0,v.isNullOrUndefined)(n)||t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1}return!0}function a(t,n,e){var i,e,i=t.DJ;return t.DJ=e,e=r(t,n),t.DJ=i,e}function u(t,n){var e,t,i,r,o,a,u,s,c,f,l,h,d;if(!(0,v.isNullOrUndefined)(t.source.MEt)&&!(0,v.isNullOrUndefined)(t.source.MEt.extendContext))return e=t.source.DJ,i=(t=t.source.MEt.extendContext).begin,r=t.evaluator,o=e.length,a=!1,s=r.options.windowFrame,c=r.options.orders,f=!(u=void 0,v.isNullOrUndefined)(c)&&0<c.length,l=function(t,n){return r.Qhe(t).getValue(n)},h=r.Khe.bind(r),d=r.ube.bind(r),u=(0,v.isNullOrUndefined)(t.valueCache)?t.valueCache=[]:(a=!0,t.valueCache),a||n({indexes:e,begin:i,length:o,result:u,frame:s,orders:c,isOrderValid:f,reader:l,evaluateWindowIndexes:h,buildFrameGroups:d}),u[0]}Object.defineProperty(n,"__esModule",{value:!0}),n.expandContext=n.evaluateExpressionValue=n.isEqualValues=n.getOrderByValues=n.evaluateExpression=n.CUMEDIST=n.DENSERANK=n.NTHVALUE=n.LASTVALUE=n.FIRSTVALUE=n.LAG=n.LEAD=n.NTILE=n.WPERCENTRANK=n.WRANK=n.ROWNUMBER=n.CalcFunction=void 0,v=e("./dist/src/dataSource/utils.js"),e=e("./dist/src/calculation/functions/utils.js"),n.CalcFunction=e.CalcFunction,n.ROWNUMBER="ROWNUMBER",n.WRANK="W_RANK",n.WPERCENTRANK="W_PERCENTRANK",n.NTILE="NTILE",n.LEAD="LEAD",n.LAG="LAG",n.FIRSTVALUE="FIRSTVALUE",n.LASTVALUE="LASTVALUE",n.NTHVALUE="NTHVALUE",n.DENSERANK="DENSERANK",n.CUMEDIST="CUMEDIST",n.evaluateExpression=r,n.getOrderByValues=i,n.isEqualValues=o,n.evaluateExpressionValue=a,n.expandContext=u},"./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c,f;function l(){(0,i.addRowNumberCustomFunctions)(),(0,r.addWRankCustomFunctions)(),(0,o.addDenseRankCustomFunctions)(),(0,a.addWPercentRankCustomFunctions)(),(0,u.addCumeDistCustomFunctions)(),(0,c.addNTileCustomFunctions)(),(0,s.addLeadCustomFunctions)(),(0,s.addLagCustomFunctions)(),(0,f.addFirstValueCustomFunctions)(),(0,f.addLastValueCustomFunctions)(),(0,f.addNthValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowFunctions=void 0,i=e("./dist/src/calculation/functions/windowFunctions/rowNumber.js"),r=e("./dist/src/calculation/functions/windowFunctions/rank.js"),o=e("./dist/src/calculation/functions/windowFunctions/denseRank.js"),a=e("./dist/src/calculation/functions/windowFunctions/percentRank.js"),u=e("./dist/src/calculation/functions/windowFunctions/cumeDist.js"),s=e("./dist/src/calculation/functions/windowFunctions/leadLag.js"),c=e("./dist/src/calculation/functions/windowFunctions/nTile.js"),f=e("./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js"),n.addWindowFunctions=l},"./dist/src/calculation/functions/windowOvers/ascDesc.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.ORDERASC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return u(arguments[0].source,arguments[1],!0)},i.Functions.defineGlobalCustomFunction(r.ORDERASC,new t)}function a(){function t(){}(t.prototype=new r.CalcFunction(r.ORDERDESC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return u(arguments[0].source,arguments[1],!1)},i.Functions.defineGlobalCustomFunction(r.ORDERDESC,new t)}function u(t,n,e){return{field:(0,r.getFieldOption)(t,n),ascending:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderDescCustomFunctions=n.addOrderAscCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderAscCustomFunctions=o,n.addOrderDescCustomFunctions=a},"./dist/src/calculation/functions/windowOvers/orderBy.js":function(t,n,e){"use strict";var i,u;function r(){function t(){}(t.prototype=new u.CalcFunction(u.ORDERBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,e,i,r,o,a,t,n=arguments[0].source,e=[],i=1,r=arguments.length;i<r;i++)a=void 0,a=s(o=arguments[i])?(0,u.evaluateExpression)(n,o):{field:(0,u.getFieldOption)(n,o),ascending:!0},e.push(a);return e},i.Functions.defineGlobalCustomFunction(u.ORDERBY,new t)}function s(t){var t=(0,u.getExprFunctionName)(t);return t===u.ORDERASC||t===u.ORDERDESC}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderByCustomFunctions=void 0,i=e("CalcEngine"),u=e("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderByCustomFunctions=r},"./dist/src/calculation/functions/windowOvers/partitionBy.js":function(t,n,e){"use strict";var i,a;function r(){function t(){}(t.prototype=new a.CalcFunction(a.PARTITIONBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,e,i,r,o,t,n=arguments[0].source,e=[],i=1,r=arguments.length;i<r;i++)e.push({field:(0,a.getFieldOption)(n,o=arguments[i]),ascending:!0});return e},i.Functions.defineGlobalCustomFunction(a.PARTITIONBY,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addPartitionByCustomFunctions=void 0,i=e("CalcEngine"),a=e("./dist/src/calculation/functions/windowOvers/util.js"),n.addPartitionByCustomFunctions=r},"./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js":function(t,n,e){"use strict";var i,u,s,c,a,e;function r(){function t(){}(t.prototype=new c.CalcFunction(c.FRAMERANGE,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,e,i){var t=t.source,r=t.MEt.windowFrameOrder,o;return l({type:u.WindowOverFrameType.RANGE},t,n,e,r,u.WindowOverFrameType.RANGE,i)},i.Functions.defineGlobalCustomFunction(c.FRAMERANGE,new t)}function o(){function t(){}(t.prototype=new c.CalcFunction(c.FRAMEROWS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,e,i){var t=t.source,r=t.MEt.windowFrameOrder,o;return l({type:u.WindowOverFrameType.ROWS},t,n,e,r,u.WindowOverFrameType.ROWS,i)},i.Functions.defineGlobalCustomFunction(c.FRAMEROWS,new t)}function f(){function t(){}(t.prototype=new c.CalcFunction(c.FRAMEGROUPS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,e,i){var t=t.source,r=t.MEt.windowFrameOrder,o;return l({type:u.WindowOverFrameType.GROUPS},t,n,e,r,u.WindowOverFrameType.GROUPS,i)},i.Functions.defineGlobalCustomFunction(c.FRAMEGROUPS,new t)}function l(t,n,e,i,r,o,a){var e,e,e=(0,c.unparseExpression)(n,e);return t.begin=h(e,u.WindowOverFramePreceding.CurrentRow,u.WindowOverFramePreceding.UnBounded,o,r),v(i)?t.exclude=m(i):((0,s.isNullOrUndefined)(i)||(e=(0,c.unparseExpression)(n,i),t.end=h(e,u.WindowOverFrameFollowing.CurrentRow,u.WindowOverFrameFollowing.UnBounded,o,r)),v(a)&&(t.exclude=m(a))),d(t,r,o),t}function h(t,n,e,i,r){var e,t,e,o;return"[@]"===t?{type:a.current,option:{type:n}}:"-1"===t?{type:a.unbounded,option:{type:e}}:(e=/^\[@([-\+])(\d+(\.\d+)?)\]$/.exec(t))&&(t=e[1],e=Number(e[2]),o=void 0,"-"===t?o=u.WindowOverFramePreceding.NPreceding:"+"===t&&(o=u.WindowOverFrameFollowing.NFollowing),i===u.WindowOverFrameType.ROWS||i===u.WindowOverFrameType.GROUPS?e=Math.floor(e):r&&("-"===t?o=u.WindowOverFrameFollowing.NFollowing:"+"===t&&(o=u.WindowOverFramePreceding.NPreceding)),0!==e)?{type:a.range,value:Number(t+e),option:{type:o,offset:e}}:{type:a.current,option:{type:n}}}function d(t,n,e){var i=t.begin,r=t.end,o=!1;r?(n&&e===u.WindowOverFrameType.RANGE?(i.type===a.unbounded||i.type===a.current&&(r.type===a.unbounded||r.type===a.current||r.type===a.range&&r.value<=0)||i.type===a.range&&(r.type===a.unbounded||0<=i.value&&r.type===a.current||r.type===a.range&&i.value>=r.value))&&(o=!0):(i.type===a.unbounded||i.type===a.current&&(r.type===a.unbounded||r.type===a.current||r.type===a.range&&0<=r.value)||i.type===a.range&&(r.type===a.unbounded||i.value<=0&&r.type===a.current||r.type===a.range&&i.value<=r.value))&&(o=!0),t.begin=t.begin.option,t.end=t.end.option,o||(t.begin.offset=-1,t.end.offset=-1)):t.begin=t.begin.option}function v(t){return("number"==typeof t||t&&2===t.type&&"number"==typeof t.value)&&((t=t.value?t.value:t)===u.WindowOverFrameExcludeMode.current||t===u.WindowOverFrameExcludeMode.group||t===u.WindowOverFrameExcludeMode.none||t===u.WindowOverFrameExcludeMode.ties)}function m(t){return"number"==typeof t?t:t.value}Object.defineProperty(n,"__esModule",{value:!0}),n.addFrameGroupsCustomFunctions=n.addFrameRowsCustomFunctions=n.addFrameRangeCustomFunctions=void 0,i=e("CalcEngine"),u=e("./dist/src/dataSource/dataSource.interface.js"),s=e("./dist/src/dataSource/utils.js"),c=e("./dist/src/calculation/functions/windowOvers/util.js"),(e=a=a||{})[e.unbounded=-1]="unbounded",e[e.current=0]="current",e[e.range=1]="range",n.addFrameRangeCustomFunctions=r,n.addFrameRowsCustomFunctions=o,n.addFrameGroupsCustomFunctions=f},"./dist/src/calculation/functions/windowOvers/util.js":function(t,n,e){"use strict";var i,e;function r(t,n){return t.getCalcService().unparse(t,n,0,0)}function o(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function a(t,n){return t.getCalcService().parse(t,n,0,0)}function u(t,n,e){t.wEt("windowFrameOrder",!1===(e&&0<e.length&&e[0].ascending));var e=t.getCalcService().evaluateExpression(t,n,{row:0,col:0});return t.wEt("windowFrameOrder"),e}function s(t,n){var t=r(t,n),t;return t=14===n.type?t.replace(/[\[\]]/g,""):"=".concat(t)}function c(t){return(0,i.isNullOrUndefined)(t)?null:t.functionName||t.function&&t.function.name}function f(t){return c(t)===n.PARTITIONBY}function l(t){return c(t)===n.ORDERBY}function h(t){var t=c(t);return t===n.FRAMERANGE||t===n.FRAMEROWS||t===n.FRAMEGROUPS}function d(t){return c(t)===n.WINDOWDEF}function v(t,n,e,i){var r,o,a;return f(n)?(r=m(t,n),l(e)?(o=m(t,e),h(i)&&(a=g(t,i,o))):h(e)?a=g(t,e):p(e)&&h(i)&&(a=g(t,i,o))):l(n)?(o=m(t,n),h(e)&&(a=g(t,e,o))):h(n)?a=g(t,n):p(n)&&(l(e)?(o=m(t,e),h(i)&&(a=g(t,i,o))):h(e)&&(a=g(t,e))),{partitions:r,orders:o,windowFrame:a}}function m(t,n){var e=o(t,n);return e.formula=r(t,n),e}function g(t,n,e){var e=u(t,n,e);return e.formula=r(t,n),e}function p(t){return t&&3===t.type}Object.defineProperty(n,"__esModule",{value:!0}),n.isStringExpression=n.getOverOptions=n.isWindowDef=n.isWindowFrame=n.isOrderBy=n.isPartitionBy=n.getExprFunctionName=n.getFieldOption=n.evaluateFrameExpression=n.parseFormula=n.evaluateExpression=n.unparseExpression=n.WINDOWDEF=n.WINDOWOVERDECONSTRUCT=n.FRAMEGROUPS=n.FRAMEROWS=n.FRAMERANGE=n.ORDERDESC=n.ORDERASC=n.ORDERBY=n.PARTITIONBY=n.WINDOWOVER=n.CalcFunction=void 0,i=e("./dist/src/dataSource/utils.js"),e=e("./dist/src/calculation/functions/utils.js"),n.CalcFunction=e.CalcFunction,n.WINDOWOVER="WINDOW",n.PARTITIONBY="PARTITIONBY",n.ORDERBY="ORDERBY",n.ORDERASC="ORDERASC",n.ORDERDESC="ORDERDESC",n.FRAMERANGE="FRAMERANGE",n.FRAMEROWS="FRAMEROWS",n.FRAMEGROUPS="FRAMEGROUPS",n.WINDOWOVERDECONSTRUCT="WINDOWOVERDECONSTRUCT",n.WINDOWDEF="WINDOWDEF",n.unparseExpression=r,n.evaluateExpression=o,n.parseFormula=a,n.evaluateFrameExpression=u,n.getFieldOption=s,n.getExprFunctionName=c,n.isPartitionBy=f,n.isOrderBy=l,n.isWindowFrame=h,n.isWindowDef=d,n.getOverOptions=v,n.isStringExpression=p},"./dist/src/calculation/functions/windowOvers/windowOver.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.WINDOWOVER,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,e,i,r){var o=t.Whe.D5;return o||(t.Whe.D5=o=a(t.source,t.Whe)),t.source.nM._getValueByField(o,t.source.DJ)},i.Functions.defineGlobalCustomFunction(r.WINDOWOVER,new t)}function a(t,n){var t=(0,r.unparseExpression)(t,n);return"="===t[0]?t:"="+t}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js":function(t,n,e){"use strict";var i,f;function r(){function t(){}(t.prototype=new i.Functions.Function(f.WINDOWOVERDECONSTRUCT,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,e,i,r){var t,o,a,u,s,a,e,i,c,r,t=t.source,o=(0,f.unparseExpression)(t,n),a=(0,f.getOverOptions)(t,e,i,r),u=a.partitions,s=a.orders,a=a.windowFrame,e=l(e,t)||l(i,t)||l(r,t)||{},i={windowExpression:n,windowFormula:o,partitions:u||e.partitions,orders:s||e.orders,windowFrame:a||e.windowFrame,formulaFromWindowChaining:void 0,windowDefineName:e.windowDefineName},c;return 0<Object.keys(e).length&&(r="=".concat(f.WINDOWOVER,"(").concat(o),i.partitions&&(r+=",".concat(i.partitions.formula)),i.orders&&(r+=",".concat(i.orders.formula)),i.windowFrame&&(r+=",".concat(i.windowFrame.formula)),i.formulaFromWindowChaining=r+=")"),i},i.Functions.defineGlobalCustomFunction(f.WINDOWOVERDECONSTRUCT,new t)}function l(t,n){var e,e,e,t,e,e,e,i,r,e,n;if((0,f.isStringExpression)(t))return t=t.value,(e=null==(e=null==(e=null==(e=n.nM._dataSource)?void 0:e.options)?void 0:e.schema)?void 0:e.window)&&e[t]&&(e=e[t])&&(e=(0,f.parseFormula)(n,e),(0,f.isWindowDef)(e))?(i=e.arguments[0],r=e.arguments[1],e=e.arguments[2],(n=(0,f.getOverOptions)(n,i,r,e)).windowDefineName=t,n):{windowDefineName:t}}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDeconstructCustomFunctions=void 0,i=e("CalcEngine"),f=e("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDeconstructCustomFunctions=r},"./dist/src/calculation/functions/windowOvers/windowOverDefine.js":function(t,n,e){"use strict";var i,r;function o(){function t(){}(t.prototype=new r.CalcFunction(r.WINDOWDEF,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,e,i){return(0,r.getOverOptions)(t.source,n,e,i)},i.Functions.defineGlobalCustomFunction(r.WINDOWDEF,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDefineCustomFunctions=void 0,i=e("CalcEngine"),r=e("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDefineCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOvers.entry.js":function(t,n,e){"use strict";var i,r,o,a,u,s,c;function f(){(0,i.addWindowOverCustomFunctions)(),(0,c.addWindowOverDefineCustomFunctions)(),(0,s.addWindowOverDeconstructCustomFunctions)(),(0,r.addPartitionByCustomFunctions)(),(0,o.addOrderByCustomFunctions)(),(0,a.addFrameRangeCustomFunctions)(),(0,a.addFrameRowsCustomFunctions)(),(0,a.addFrameGroupsCustomFunctions)(),(0,u.addOrderAscCustomFunctions)(),(0,u.addOrderDescCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverFunctions=void 0,i=e("./dist/src/calculation/functions/windowOvers/windowOver.js"),r=e("./dist/src/calculation/functions/windowOvers/partitionBy.js"),o=e("./dist/src/calculation/functions/windowOvers/orderBy.js"),a=e("./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js"),u=e("./dist/src/calculation/functions/windowOvers/ascDesc.js"),s=e("./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js"),c=e("./dist/src/calculation/functions/windowOvers/windowOverDefine.js"),n.addWindowOverFunctions=f},"./dist/src/calculation/queryFunctionResolver.js":function(t,n,e){"use strict";var e,f,l,i;function h(e,i,r){return function(t){var n=[];return n.push(t.kEt(t.mEt(e),i||t._dataSource.DEt,r)),n}}function d(){}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryFunctionSolver=void 0,e=e("Common"),f=null,l=e.Common.zf.fJ,d.parseParam=function(r,o,a,u){for(var s,c,t,n,s=Object.keys(u.tables),c=new d,t=function(t){var t,n,t,e,i,t=s[t];r===t?(c.getValue=function(t){return t.ASt(f,f,o,a)},c.table=u.tables[t]):l(r,t)&&(c.table=u.tables[t],n=r[t.length],t=r.substr(t.length+1),"#"===n?(e=parseInt(t,10),c.getValue=function(t){var n=[];return n.push(t.kEt(e,o||t._dataSource.DEt,a)),n}):"/"===n?c.getValue=h(t,o,a):"?"===n?1===(i=t.split("=",2)).length?c.getValue=h(t,o,a):c.getValue=function(t){return t.ASt(i[1],i[0],o,a)}:delete c.table)},n=0;n<s.length;n++)t(n);return c},n.QueryFunctionSolver=d},"./dist/src/calculation/tokenResolver.js":function(t,n,e){"use strict";var i,r,s,l,c,o,a,u,f;function h(t){var n=u.call(this,14)||this;return n.value=t,n}function d(t){return f.call(this,t)||this}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerTokenResolver=void 0,r=e("CalcEngine"),s=e("./dist/src/calculation/calcSource.js"),l=e("./dist/src/dataSource/utils.js"),u=r.Expression,i(h,u),h.prototype.Iwt=function(t,n){var e;this.value instanceof s.DataManagerReference&&this.value.table._Et(t,this.value.Pq[0],n)},c=h,f=r.TokenResolver,i(d,f),d.prototype.resolveToken=function(t,n,e,i,r){var e,o,t,t,e,a,u,e=e[i],o=e.Awt,t=t.source,t=t&&t.nM;if(t&&0===e.uit&&"["===o[0]&&"]"===o[o.length-1]&&(e=new s.DataManagerReference,-1!==(a=this.EEt(e,o,1)))&&(e.rowString=o.substring(1,a),-1!==(a=this.jEt(e,o,a))))return e.table=t,e.Pq=e.field,e.field=t.bEt(e.field),{expr:u=new c(e),index:i+1}},d.prototype.EEt=function(t,r,n){var o,e,i,a,u;function s(t,n){for(var e=n?t+1:t;"0"<=r[e]&&r[e]<="9";)e++;for(;" "===r[e];)e++;return{value:parseInt(r.substring(t,e),10),end:e}}function c(t){for(var n=t;n<r.length&&"["!==r[n]&&"]"!==r[n]&&","!==r[n];)n++;return{type:"key",value:r.substring(t,n).trim(),end:n}}function f(t){var n,e,i,e,n=r[t],e=r[t+1];return"@"===n?(o=!0,"+"===e||"-"===e?(i=s(t+1,!0)).end<=t+1?-1:{num:i.value,end:i.end,relative:!0}:{num:0,end:t+1,relative:!0}):"#"===n?(i=s(t+1)).end>t+1?{num:i.value,end:i.end,relative:!1}:"last"===r.substr(t+1,4)?{num:-1,end:t+5,relative:!1}:"odd"===r.substr(t+1,3)?{type:"odd",end:t+4}:"even"===r.substr(t+1,4)?{type:"even",end:t+5}:-1:"$"!==n||(e=c(t+1)).end>=r.length?-1:e}for(o=!1,e=null;n<r.length&&"["!==(i=r[n])&&"]"!==i;)if(e||"@"!==i&&"#"!==i&&"$"!==i){if(","===i&&e)e=!1;else if(" "!==i)break;n++}else{if(-1===(a=f(n)))return-1;if(":"!==r[a.end]||(0,l.isNullOrUndefined)(a.num))t.row.push(a),n=a.end;else{for(n=a.end+1;" "===r[n];)n++;if(-1===(u=f(n))||(0,l.isNullOrUndefined)(u.num))return-1;t.row.push([a,u]),n=u.end}e=!0}return t.gEt=o,!1===e?-1:n},d.prototype.jEt=function(t,e,n){var i,r,o;function a(t){for(var n=t;"]"!==e[n];)n++;return{str:e.substring(t,n),end:n}}function u(t){for(var n=t;"."!==e[n]&&"]"!==e[n];)n++;return{str:e.substring(t,n),end:n}}for(i=null;n<e.length;)if("["!==(r=e[n])||i){if("]"===r)break;if(" "===r)n++;else if("."===r&&i)n++,i=!1;else{if("."===r||i)return-1;o=u(n),t.field.push(o.str),n=o.end,i=!0}}else{if((o=a(n+1)).end<=n+1)return-1;t.field.push(o.str),n=o.end+1,i=!0}return n===e.length-1?n:-1},d.prototype.unparse=function(t,n,e,i){var r,o,a,u,s,c;if(14!==e.type)return!1;if(i.push("["),0<(r=e.value.rowString).length&&i.push(r),0<(o=e.value.Pq).length)for(a="@"===r||""===r,u=0,s=o.length;u<s;u++)c=o[u],!a||-1<c.indexOf(" ")?i.push("[".concat(c,"]")):i.push(c),u<s-1&&i.push(".");return i.push("]"),!0},n.DataManagerTokenResolver=d},"./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js":function(t,n,e){"use strict";var i,r,o,a,u;function s(t){this.QSt={},this.N3=t}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerProxy=void 0,i=e("CalcEngine"),r=e("./dist/src/dataManager.entry.js"),o=e("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),a=e("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),s.prototype.getTable=function(t){var n,e;if(!(0,r.isNullOrUndefined)(t)){if(this.QSt[t])return this.QSt[t];if((n=this.N3.tables)[t])return this.QSt[t]=new a.ReportTable({dataManagerTable:n[t]}),this.QSt[t];for(e in t=t.toUpperCase(),n)if(n.hasOwnProperty(e)&&e.toUpperCase()===t)return this.QSt[t]=new a.ReportTable({dataManagerTable:n[e]}),this.QSt[t];return(0,o.isFormulaInWhitelist)(t)?(this.QSt[t]=this.generateFormulaTableByFormula(t),this.QSt[t]):void 0}},s.prototype.getCalcService=function(){var t=this.N3.Lp;return t.allowDynamicArray=!0,t},s.prototype.getTables=function(){return this.QSt},s.prototype.getRelationshipsByTable=function(t){var n,e,n=this.N3.relationships;return t&&(e=t.table(),n=n.filter(function(t){return t.sourceTable===e||t.targetTable===e})),n},s.prototype.generateFormulaTableByFormula=function(t){var n,e,n,n=this.getCalcService(),e=new i.CalcSource(n),n=(0,o.getFormulaResult)(n,e,t.replace(/__\d+__\d+/g,""));return new a.ReportTable({formulaTable:{name:t,formulaResult:n}})},s.prototype.clearTableDataCache=function(){var t,n,t=this.QSt;for(n in t)t.hasOwnProperty(n)&&t[n].clearTableDataCache()},n.DataManagerProxy=s},"./dist/src/data-manager-report/data-manager-proxy/report-table.js":function(t,n,e){"use strict";var u,i;function r(t){var e,n,t,e=this,n=t.dataManagerTable,t=t.formulaTable;n?(this._le=n,this.sbe={}):this.jle=t,this.jle&&(this.Ele=this.jle.formulaResult.map(function(t){var n={};return n[e.jle.name]=t,n}))}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTable=void 0,u=e("./dist/src/dataManager.entry.js"),Object.defineProperty(r.prototype,"name",{get:function(){return(this._le||this.jle).name},enumerable:!1,configurable:!0}),r.prototype.table=function(){return this._le},r.prototype.getFields=function(){return this._le.ltt()},r.prototype.getData=function(t){var n,e,i,r;if(this.jle)if(t)for(n=[],e=0,i=t;e<i.length;e++)r=i[e],n.push(this.Ele[r]);else n=this.Ele;else n=this._le.getDataSync(t);return n},r.prototype.length=function(){return this.jle?this.Ele.length:this._le.length()},r.prototype.getValueByField=function(t,n,e){var i,r,o,a;return this.jle?(0,u.formatCalcError)(this.jle.formulaResult[n]):(i=void 0,(r=this.sbe[t])&&r.hasOwnProperty(n)?i=r[n]:((o=this._le.columns)[a=t]&&"string"==typeof o[t].value&&(a=o[t].value),i=this._le._getValueByField(a,n),(r=r||(this.sbe[t]={}))[n]=i),t.startsWith("=")&&!e?(0,u.formatCalcError)(i):i)},r.prototype.hasField=function(n){return this.jle?n===this.jle.name:(n=n.toUpperCase(),0<Object.keys(this._le.columns).filter(function(t){return t.toUpperCase()===n}).length)},r.prototype.getFieldByNameIgnoreCase=function(t){return this.jle?{fieldName:this.name}:this._le.Ole(t)},r.prototype.reset=function(){this.jle||(this._le.XOt={})},r.prototype.clearTableDataCache=function(){this.sbe={}},n.ReportTable=r},"./dist/src/data-manager-report/data-manager-report.js":function(t,n,e){"use strict";var n,i,r,o;Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/src/dataManager.js"),r=e("./dist/src/data-manager-report/tree-data-generator/index.js"),(o=n.Common.lt.Dh)(i.DataManager.prototype,{generateTreeData:function(t){var n;new r.TreeDataGenerator(this,t).generateTreeData()}})},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js":function(t,n,e){"use strict";var j,O,E,i;function r(t,n,e,i,r){this.N3=t,this.DJ=n,this.Rle=e,this.Lle=i,this.Ble=r}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportCrossHelper=void 0,j=e("./dist/src/dataManager.entry.js"),O=e("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),E=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),r.prototype.processCrossCells=function(t){var a=this;try{t.forEach(function(t){var n,o,e,n=t.leftParent.data.groups,o=t.upParent.data.groups,e=a.Fle(t);e?e.data.groups.forEach(function(e){var i,r,i=[],r=[];n.forEach(function(t){t===e&&i.push(t);for(var n=t.leftParent||t.upParent;n;){if(n===e)return void i.push(t);if(n.cellNode===e.cellNode)return;n=n.leftParent||n.upParent}}),o.forEach(function(t){t===e&&r.push(t);for(var n=t.upParent||t.leftParent;n;){if(n===e)return void r.push(t);if(n.cellNode===e.cellNode)return;n=n.upParent||n.leftParent}}),a.Ple(t,i,r)}):a.Ple(t,n,o)})}catch(t){}},r.prototype.Fle=function(t){for(var n,e,n=t.leftParent;n;){for(e=t.upParent;e;){if(e===n)return n;e=e.upParent||e.leftParent}n=n.leftParent||n.upParent}return null},r.prototype.Ple=function(e,t,n){var o,a,u,s,c,i,r,f,l,h,d,v,m,g,h,h,o=this,a=e.indexOfLeftParentChildren,u=e.indexOfUpParentChildren,s={},c=[],i,r=this.Rle.getRelationshipsMap()[e.relationshipMapKey];for(t.forEach(function(e,i){var t,r;e.crossChildren[a]||(e.crossChildren[a]=[]),t=e.valuePath,s[t]||(s[t]={}),r=s[t],n.forEach(function(t,n){t.crossChildren[u]||(t.crossChildren[u]=[]);var n={vg:e,hg:t,vIndex:i,hIndex:n,crossChildren:[],crossRecordRowNumbers:[]};r[t.valuePath]=n,c.push(n)})}),r&&r.forEach(function(t,i){var n,r,n=o.Lle.generateParentPaths(e.leftParent,t),r=o.Lle.generateParentPaths(e.upParent,t);n.forEach(function(e){r.forEach(function(t){var n=s[e],n=null==n?void 0:n[t];n&&n.crossRecordRowNumbers.push(i)})})}),f=0,l=c;f<l.length;f++)d=(h=l[f]).vg,v=h.hg,m=h.vIndex,g=h.hIndex,h=h.crossRecordRowNumbers,h=this.Ule(d,v,h,e),d.crossChildren[a][g]=h,v.crossChildren[u][m]=h},r.prototype.Ule=function(t,n,e,i,r){var o,a,u,u,s,c,o,o=this.N3;return t&&n||(u=(u=(a=t||n)&&a.cellNode)&&u.relationshipMapKey,s=i.relationshipMapKey,void 0!==u&&s!==u&&e&&e.length&&(c=(0,O.getTableNameByCellNode)(i),o=o.getTable(c))&&r&&(e=this.Lle.zle(i,e,o,r,s,u,a))),"No"===i.templateCell.expansionDirection?this.Vle(t,n,e,i):this.Yle(t,n,e,i)},r.prototype.Vle=function(t,n,e,i){var r,o,a,u,s,c,f,l,a,h,d,v,m,g,p,g;if(i.templateCell.dataColumn?(a=i.templateCell.dataColumn.tableName,u=i.templateCell.dataColumn.columnName):i.templateCell.formula&&"No"!==i.templateCell.expansionDirection&&(0,O.isFormulaInWhitelist)(i.templateCell.formula)&&(a=(0,O.getTableNameByCellNode)(i),u=i.templateCell.formula),s=[],c={},(0,j.isNullOrUndefined)(a))r=i.templateCell.value;else{if(!(o=this.N3.getTable(a)))return[];E.DataManagerReportSortHelper.parseSortOptionsToSorts(i.templateCell),f=(this.Rle.getTableNameCacheFromParent(i)||a).toUpperCase(),l=this.Rle.getRelationshipsMap()[i.relationshipMapKey],e.forEach(function(t){var t=l[t]&&l[t][f];void 0===t||c[t]||(s.push(t),c[t]=!0)}),a=s.map(function(t){return o.getValueByField(u,t)}),r=this.Zle(a,i)}for(h={value:r,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:e,cellNode:i,state:"normal",Qle:c},0===s.length&&(h.defaultFormula=(0,O.generateDefaultFormulaByTemplateCell)(i.templateCell),h.state="new"),d=0,v=i.children;d<v.length;d++)p=g=void 0,(m=v[d]).leftParent===i?g=h:m.upParent===i&&(p=h),g=this.Ule(g,p,e,m,o),h.childrenArray.push(g);return i.data.groups.push(h),[h]},r.prototype.Yle=function(l,h,d,v){var a,t,n,t,m,g,u,n,p,t,b,e,i,r,o,s,c,f,w,y,M,C,t,n,t,S,T,A,I,x,N,k,_,D,_,a=this,m=[],g=v.templateCell,u=g.dataSetting,n=u.type;if(g.dataColumn?(t=g.dataColumn.tableName,b=g.dataColumn.columnName):g.formula&&"No"!==g.expansionDirection&&(0,O.isFormulaInWhitelist)(g.formula)&&(t=(0,O.getTableNameByCellNode)(v),b=g.formula),(0,j.isNullOrUndefined)(t))m.push({value:g.value,leftParent:l,upParent:h,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:v,state:"normal",sortValues:[v.templateCell.value],Qle:{}});else{if(!(p=this.N3.getTable(t)))return[];if(E.DataManagerReportSortHelper.parseSortOptionsToSorts(g),e=(this.Rle.getTableNameCacheFromParent(v)||t).toUpperCase(),i=this.Rle.getRelationshipsMap()[v.relationshipMapKey],r=[],o=[],s={},c=[],!d){for(f=i.length,w=[],y=0;y<f;)w.push(y++);d=w}d.forEach(function(t){var n,n,n=null==(n=i[t])?void 0:n[e];void 0!==n&&(r.push(n),s[n]||(o.push(n),s[n]=!0),c[n]||(c[n]=[]),c[n].push(t))}),0===d.length?m.push({value:void 0,leftParent:l,upParent:h,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:v,state:"new",sortValues:[],Qle:{},defaultFormula:(0,O.generateDefaultFormulaByTemplateCell)(g)}):"Group"===n?(r.forEach(function(s,c){for(var t,f,n,n,e,i,r,o,n=p.getValueByField(b,s),n=[{value:n,advancedGroupSortName:n}],e=function(n){var t,e,t,i,r,o,a,u,e=n.advancedGroupSortName+"",t=m.find(function(t){return t.value===n.value});if(t)t.recordRowNumbers.push(d[c]),t.Qle[s]||(t.Qle[s]=!0);else{if(i=[],null!=(f=g.Kle)&&f.length)for(r=0,o=g.Kle;r<o.length;r++)a=o[r],(u=void 0,j.isNullOrUndefined)(a.column)||(u=p.getValueByField(a.column,s)),i.push(u);m.push({value:n.value,Jle:e,leftParent:l,upParent:h,childrenArray:[],crossChildren:[],recordRowNumbers:[d[c]],cellNode:v,state:"normal",sortValues:i,Qle:((t={})[s]=!0,t)})}},i=0,r=n=null!=(t=u.bins)&&t.length?a.Lle.getAdvancedGroupValue(p,s,u):n;i<r.length;i++)e(o=r[i])}),null!=(t=u.bins)&&t.length&&(M={},C={},m.forEach(function(t){C[t.Jle]=!0}),u.bins.forEach(function(t,n){var n,e;M[t.caption]=n,n=t.caption,C[t.caption]||!0!==t.alwaysVisible||m.push(e={value:n,Jle:n,recordRowNumbers:[],childrenArray:[],leftParent:l,upParent:h,crossChildren:[],state:"new",cellNode:v,sortValues:[],Qle:{}})}),m.sort(function(t,n){var e,i;return M[t.Jle+""]-M[n.Jle+""]}))):"List"===n?o.forEach(function(t,n){var e,e,i,r,o,a,u,s,i=p.getValueByField(b,t),r=[];if(null!=(e=g.Kle)&&e.length)for(o=0,a=g.Kle;o<a.length;o++)u=a[o],(s=void 0,j.isNullOrUndefined)(u.column)||(s=p.getValueByField(u.column,t)),r.push(s);m.push({value:i,leftParent:l,upParent:h,childrenArray:[],crossChildren:[],recordRowNumbers:c[t],cellNode:v,state:"normal",sortValues:r,Qle:((e={})[t]=!0,e)})}):(t=o.map(function(t){return p.getValueByField(b,t)}),n=g.dataSetting,t=(0,O.calc)(t,n.aggregation),m.push({value:t,leftParent:l,upParent:h,childrenArray:[],crossChildren:[],recordRowNumbers:d,cellNode:v,state:"normal",sortValues:[t],Qle:s}))}for(S=0,T=m;S<T.length;S++)for(I=(A=T[S]).recordRowNumbers,x=0,N=v.children;x<N.length;x++)D=_=void 0,(k=N[x]).leftParent===v?_=A:k.upParent===v&&(D=A),_=this.Ule(_,D,I,k,p),A.childrenArray.push(_);return null!=(n=this.Ble)&&n.sortGroupsBySortCondition(m,v,null==(t=this.DJ)?void 0:t.cellNodeGetter),m.forEach(function(t){v.data.groups.push(t)}),m},r.prototype.Zle=function(t,n){var n,e,n=n.templateCell.dataSetting;return n&&"Group"===n.type?(e=[],t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),1<e.length?e:e[0]):"List"===n.type?t.map(function(t){return t}):(0,O.calc)(t,n&&n.aggregation||"Sum")},n.DataManagerReportCrossHelper=r},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js":function(t,n,e){"use strict";var h,_,R,C,i;function r(t,n,e,i){this.N3=t,this.DJ=n,this.Xle=new h.CalcSource(t.getCalcService()),this.$le={},this.Ble=i,this.Rle=e}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportGroupHelper=void 0,h=e("CalcEngine"),_=e("./dist/src/dataManager.entry.js"),R=e("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),C=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),r.prototype.generateCellNodeTreeData=function(n,t,e,i,r,o,a){var u,s,c,f,l,c,h,s,s,d,v,m,g,p,b,w,y,M,u,M,c=this.N3,l=(0,R.getTableByCellNode)(c,n),c=[],h={};if(n.templateCell.dataColumn?f=n.templateCell.dataColumn.columnName:n.templateCell.formula&&(0,R.isFormulaInWhitelist)(n.templateCell.formula)?f=n.templateCell.formula:(s=this.the(t,e),s={value:n.templateCell.value,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:t,upParent:e,crossChildren:[],state:"normal",cellNode:n,sortValues:[],valuePath:s+"/"+n.templateCell.value},c.push(s)),!l&&0===c.length)return[];for(C.DataManagerReportSortHelper.parseSortOptionsToSorts(n.templateCell),d=this.Rle&&this.Rle.generateRelationshipMapKeyByCellNode(n),m=c=(v=0)===c.length?this.Qqn(h,n,l,f,d,t,e,i,r,o,a):c;v<m.length;v++)for(p=(g=m[v]).recordRowNumbers,b=0,w=n.children;b<w.length;b++)(y=w[b]).leftParent&&y.upParent?g.childrenArray.push([]):(u=M=void 0,y.leftParent?M=g:y.upParent&&(u=g),M=this.generateCellNodeTreeData(y,M,u,p,l,d,a),g.childrenArray.push(M),null!=(u=y.slices)&&u.forEach(function(t){delete t.groupMapCache,delete t.groupsCache}));return null!=(s=this.Ble)&&s.sortGroupsBySortCondition(c,n,this.DJ&&this.DJ.cellNodeGetter),c.forEach(function(t){return n.data.groups.push(t)}),c},r.prototype.clearCache=function(t){t&&(this.Xle=null)},r.prototype.Qqn=function(t,i,n,e,r,o,a,u,s,c,f){var l,h,d,v,l,m,g,h,p,b,w,h,y,M,p,C,S,T,d=[],v={},l=null==(l=this.Rle)?void 0:l.getRelationshipsMap(),m=i.templateCell,g=m.dataSetting;if(r&&l&&l[r]||u)if(h=0===(null==(h=null==l?void 0:l[r])?void 0:h.length),p=!s&&u&&0===u.length,h||p?u=void 0:void 0!==c&&r!==c&&u&&u.length&&(u=this.zle(i,u,n,s,r,c,o||a)),b=u?u.length:r?l[r].length:0,w=this.the(o,a),g&&"Summary"===g.type)d=this.nhe(i,n,e,u,r,o,a,w);else{if(0===b)h={value:void 0,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:o,upParent:a,crossChildren:[],state:"new",cellNode:i,sortValues:[],valuePath:w+"/",defaultFormula:(0,R.generateDefaultFormulaByTemplateCell)(m)},d.push(h);else{for(y=0;y<b;y++)M=u?u[y]:y,this.ehe(d,t,v,i,n,e,M,r,o,a,w,f);"No"===m.expansionDirection&&(C=(p=d[0])&&Array.isArray(p.value))&&(p.Jle=p.Jle.toString(),p.valuePath+=p.value.toString())}g&&"Group"===g.type&&g.bins&&g.bins.length&&(S={},T={},d.forEach(function(t){T[t.Jle]=!0}),g.bins.forEach(function(t,n){var n,e;S[t.caption]=n,n=t.caption,T[t.caption]||!0!==t.alwaysVisible||d.push(e={value:n,Jle:n,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:o,upParent:a,crossChildren:[],state:"new",cellNode:i,sortValues:[],valuePath:w+"/"+n})}),d.sort(function(t,n){var e,i;return S[t.Jle+""]-S[n.Jle+""]}))}return d},r.prototype.ehe=function(s,c,f,l,t,n,h,e,d,v,m,g){var p,i,r,i,n,b,o,i,r,w,r,y,e,M,a,u,C,S,T,A,r,I,x,N,k,p=this,o,i=(null==(i=this.Rle)?void 0:i.getTableNameCacheFromParent(l))||(null==t?void 0:t.name),r=null==(r=this.Rle)?void 0:r.getRelationshipsMap(),w=r?r[e][h][i.toUpperCase()]:h;if(void 0!==w){if(r=t.getValueByField(n,w),y=[{value:r,advancedGroupSortName:r}],e=l.templateCell.dataSetting,M=[],null!=(i=l.templateCell.Kle)&&i.length)for(a=0,u=l.templateCell.Kle;a<u.length;a++)T=(C=u[a]).column,A=C.formula,(S=void 0,_.isNullOrUndefined)(T)?(0,_.isNullOrUndefined)(A)||(S=t.getValueByField(A,w)):S=t.getValueByField(C.column,w),M.push(S);for(e&&"Group"===e.type&&(null!=(n=e.bins)&&n.length||e.formula)&&(y=this.getAdvancedGroupValue(t,w,e),r=(r=l.templateCell.Hle)||(l.templateCell.Hle=[]),I=(I=r[w])||(r[w]=[]),y.forEach(function(t){var t=t.value+"";-1===I.indexOf(t)&&I.push(t)})),x=e&&"List"===e.type,N=function(t){var t,n,e,a,i,r,o,u,t=y[t],n=t.value,e=t.advancedGroupSortName,a=c[n];a&&!x||(i=!0,x&&(a=f[w])&&(i=!1),"No"===l.templateCell.expansionDirection&&(a=s[0])&&(i=!1,r=a.value,o=a.Jle,Array.isArray(r)||(r=[a.value]),Array.isArray(o)||(o=[a.Jle]),a.Qle[w]||(r.push(t.value),o.push(t.advancedGroupSortName)),a.value=r,a.Jle=o,a.valuePath=m+"/",c[n]=a),i&&(a={value:t.value,Jle:e,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:d,upParent:v,crossChildren:[],state:"normal",cellNode:l,valuePath:m+"/"+t.value+(x?"/"+w:""),sortValues:M,slices:[]},s.push(a),c[n]=a,x)&&(f[w]=a)),null!=(b=l.slices)&&b.length&&(u=a.value,l.slices.forEach(function(t,n){var e,i,r,e,i,o,e=t.groupsCache,i=t.groupMapCache,r=(r=(e=e||(t.groupsCache={}))[u+""])||(e[u+""]=[]),e=(e=(i=i||(t.groupMapCache={}))[u+""])||(i[u+""]={}),i=t.templateCell.dataColumn.tableName,o=t.templateCell.dataColumn.columnName;p.ehe(r,e,f,t,p.N3.getTable(i),o,w,void 0,void 0,void 0,""),void 0===a.slices[n]&&(a.slices[n]={childrenArray:[r]})})),a.recordRowNumbers.push(h),null!=g&&g.ignoreMultipleTableJoinCache||a.Qle[w]||(a.Qle[w]=!0)},k=0;k<y.length;k++)N(k)}},r.prototype.the=function(t,n){var e,i,t,e="";return t?(i=(0,_.isNullOrUndefined)(t.value)?"":t.value,e=void 0!==t.valuePath?t.valuePath:i.toString()):n&&(t=(0,_.isNullOrUndefined)(n.value)?"":n.value,e=void 0!==n.valuePath?n.valuePath:t.toString()),e},r.prototype.nhe=function(t,n,e,i,r,o,a,u){for(var s,s,c,f,l,h,d,v,m,g,p,b,w,s,s,y,c=t.templateCell.dataSetting,f=null==(s=this.Rle)?void 0:s.getRelationshipsMap(),l=(i||f[r]).length,h=[],d=[],v={},m,g=((null==(s=this.Rle)?void 0:s.getTableNameCacheFromParent(t))||(null==n?void 0:n.name)).toUpperCase(),p=0;p<l;p++)b=i?i[p]:p,w=f?f[r][b][g]:b,h.push(b),v[w]||(d.push(w),v[w]=!0);return s=d.map(function(t){return n.getValueByField(e,t)}),s=(0,R.calc)(s,(null==c?void 0:c.aggregation)||"Sum"),[y={value:s=(0,_.isNullOrUndefined)(s)?0:s,Jle:"",recordRowNumbers:h,Qle:v,childrenArray:[],leftParent:o,upParent:a,crossChildren:[],state:"normal",cellNode:t,valuePath:u+"/"+s,sortValues:[],slices:[]}]},r.prototype.zle=function(t,e,n,i,r,o,a){var u,u,s,c,f,o,l,u,h,t,d,t,v,m,v,g,p,b,w,y,M,C,S,T,A,I,x,N,N,k,_,D,j,O,E,u=this.Rle.getRelationshipsMap(),s=u[r],c=u[o],f=i.name,o=null==(u=t.templateCell.ihe)?void 0:u.condition,l=[],u=a.cellNode,h=a.valuePath,t="".concat(r,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col),d=this.$le[t];if(d=d||(this.$le[t]=[]),t=null==s?void 0:s[0],v=n.name.toUpperCase(),m=f.toUpperCase(),v=(null==t?void 0:t.hasOwnProperty(v))&&t.hasOwnProperty(m),o){if(v){if((g=this.rhe(r,f=m))&&c){for(p=[],b=[],w=[],y=0,M=e;y<M.length;y++)if(!w[S=c[C=M[y]][f]]&&(T=g[S]))for(w[S]=!0,A=0,I=T;A<I.length;A++)b[x=I[A]]||(null!=(N=d[x])&&N[h]?p.push(x):(void 0===(N=l[x])&&(N=this.ohe(s[x],a),l[x]=N),N&&(p.push(x),b[x]=!0,d[x]||(d[x]={}),d[x][h]=!0)));return p}}else if(n===i){if(k=[],s)return _=this.Rle.getTableNameCacheFromParent(u),D=(0,R.toUpperCase)(_||i.name),s.forEach(function(t,n){-1!==e.indexOf(t[D])&&k.push(n)}),k}else if(n!==i)return null}else if(n===i){if(p=[],c){for(_=this.Rle.getTableNameCacheFromParent(u),j=(0,R.toUpperCase)(_||i.name),O=0,E=e;O<E.length;O++)C=E[O],p.push(c[C][j]);return p}}else if(n!==i)return null;return e},r.prototype.rhe=function(t,n){var e,i,r,o,a,u,s,c,e,i=this.Rle.getRelationshipsMap()[t];if(i){for(r=[],u=a=o=void 0,n=n.toUpperCase(),s=0,c=i.length;s<c;s++)(u=r[a=(o=i[s])[n]])||(r[a]=u=[]),u.push(s);return r}},r.prototype.getAdvancedGroupValue=function(t,n,e){var i,r,o,e,o,a,u,s,c,f,l,l,l,i=this.N3,r=[],o=e.formula,e=e.bins;if(o)(o=o.trim()).startsWith("=")||(o="="+o),o=t.getValueByField(o,n),r.push({value:o,advancedGroupSortName:o});else if(e)for(a=0,u=e;a<u.length;a++)if(c=(s=u[a]).caption,f=s.groupBy){if("string"==typeof f)if((l=i.getCalcService().parse(this.Xle,f,0,0)).type===h.ExpressionType.name){if(l=(0,R.fieldExpressionToField)(l.value),r.push({value:t.getValueByField(l,n),advancedGroupSortName:c}),!1!==s.stopIfTrue)break}else if((l=t.getValueByField(f,n,!0))&&!(l instanceof h.CalcError)&&(r.push({value:c,advancedGroupSortName:c}),!1!==s.stopIfTrue))break}else if(0===r.length&&(r.push({value:s.caption,advancedGroupSortName:s.caption}),!1!==s.stopIfTrue))break;return r},r.prototype.ohe=function(t,n,e){var i,r,o,a,u,s,i,i,e,c,o,r=n.cellNode,o=this.Rle.getTableNameCacheFromParent(r)||(0,R.getTableNameByCellNode)(r,!0)||r.templateCell.value+"";return o=o.toUpperCase(),a=this.N3.getTable(o),u=t[o],s=!1,i=null==(i=this.Rle)?void 0:i.getRelationshipsMap(),null!=e&&e.relationshipMapKey&&i[e.relationshipMapKey]&&(i=i[e.relationshipMapKey][0])&&(e=(this.Rle.getTableNameCacheFromParent(e)||(0,R.getTableNameByCellNode)(e,!0)||e.templateCell.value+"").toUpperCase(),s=!(i.hasOwnProperty(o)&&i.hasOwnProperty(e))),void 0===u&&a?s:!(!(c=n.Qle)[u]&&a)&&(!(o=n.leftParent||n.upParent)||this.ohe(t,o,r))},r.prototype.generateParentPaths=function(e,t){var i,n,r,o,n,a,r,u,s,c,f,l,u,u,h,d,v,i=[],n=e.templateCell,r=n.dataColumn,o=n.dataSetting,n=n.expansionDirection,a=this.Rle.getTableNameCacheFromParent(e)||(null==r?void 0:r.tableName),r=null==r?void 0:r.columnName,u=null==a;return u&&(r=e.templateCell.formula||e.templateCell.value+"",a=(0,R.getTableNameByCellNode)(e,!0)||e.templateCell.value+""),a=null==a?void 0:a.toUpperCase(),s=t[a],(0,_.isNullOrUndefined)(s)?i=u?["/"+e.templateCell.value]:(u=e.data.groups.map(function(t){return"/"+t.value}),u=o&&"List"===o.type?u.map(function(t,n){return"".concat(t,"/").concat(e.data.groups[n].recordRowNumbers[0])}):u):(c=void 0,(c=e.templateCell.Hle?e.templateCell.Hle[s]||[]:(f=void 0,[f="No"===n?null==(u=(l=e.data.groups).filter(function(t){return t.Qle[s]})[0])?void 0:u.value.toString():this.N3.getTable(a).getValueByField(r,s)])).forEach(function(t){i.push("/"+t)}),o&&"List"===o.type&&i.forEach(function(t,n){i[n]+="/".concat(s)})),e.leftParent?(h=this.generateParentPaths(e.leftParent,t),d=[],h.forEach(function(n){i.forEach(function(t){d.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),d):e.upParent?(h=this.generateParentPaths(e.upParent,t),v=[],h.forEach(function(n){i.forEach(function(t){v.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),v):i},n.DataManagerReportGroupHelper=r},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js":function(t,n,e){"use strict";var z,T,x,o,a,u,i;function r(t,n){var e,i,r;if(this.hhe={},this.tTe=[],this.N3=t,this.DJ=n,this.Xle=new o.CalcSource(t.getCalcService()),this.vhe={},this.mhe=[],this.ghe={},null!=n&&n.parameter){for(r in e={},i=n.parameter)i.hasOwnProperty(r)&&(e[r.toUpperCase()]=i[r]);this.ghe=e}}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportJoinHelper=void 0,z=e("./dist/src/dataManager.entry.js"),T=e("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),x=e("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),o=e("CalcEngine"),a=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),u=/\[@([^\]]+\.[^\]]+)\]/i,r.prototype.generateJoinRelationIndexMap=function(t){var t,t,t,t=this.phe(t),t=this.bhe(t),t=this.yhe(t);this.whe(t)},r.prototype.clearCache=function(t){this.vhe={},t&&(this.Xle=null,this.hhe={},this.tTe=[])},r.prototype.setNodeTableCache=function(t,n,e){void 0===this.mhe[t]&&(this.mhe[t]=[]),this.mhe[t][n]=e},r.prototype.Mhe=function(t,n){return this.mhe[t]&&this.mhe[t][n]},r.prototype.getTableNameCacheFromParent=function(t){var n,e,i,r,n=t.relationshipMapKey,e=this.Mhe(t.templateCell.row,t.templateCell.col);if(e)return e;for(i=t.leftParent&&t.upParent,r=t.leftParent||t.upParent;!i&&r&&r.relationshipMapKey===n;){if(e=this.Mhe(r.templateCell.row,r.templateCell.col))return e;i=t.leftParent&&t.upParent,r=r.leftParent||r.upParent}},r.prototype.getRelationshipsMap=function(){return this.hhe},r.prototype.relationshipGraphs=function(t){if(!t)return this.tTe;this.tTe=t},r.prototype.getRelationshipGraphTableIndex=function(t){var n,e,i,n=this.relationshipGraphs(),e=t&&t.name;if(n&&void 0!==e)for(e=e.toUpperCase(),i=0;i<n.length;i++)if(n[i].tables.find(function(t){return t.name.toUpperCase()===e}))return i;return-1},r.prototype.generateRelationshipMapKeyByCellNode=function(t){var n,e,i,r,o,a,o,n,u,s,e,c,f,l,f,l,h,e,c,c,l;if(t)return t.relationshipMapKey||(r=t.leftParent||t.upParent,o=t.leftParent&&t.upParent,a=(0,x.getTableNameByCellNode)(t,!(i=""))||t.templateCell.value+"",i=o?(o=a,this.Che(t),u=void 0,(n=(null==(n=t.templateCell.filter)?void 0:n.condition)||t.templateCell.ihe)&&(s=t.templateCell.ihe.condition,u=this.She(s),o=this.The(u,o,t)),e=this.Ahe(t.leftParent),c=this.Ahe(t.upParent),e||c?e&&c?(f=this.generateRelationshipMapKeyByCellNode(t.leftParent),l=this.generateRelationshipMapKeyByCellNode(t.upParent),"".concat(f,"__CROSS__").concat(o,"__CROSS__").concat(l)):(f=void 0,l=this.generateRelationshipMapKeyByCellNode(t.leftParent),h=this.generateRelationshipMapKeyByCellNode(t.upParent),c=c?h:l,f=-1<(e=e?l:h).indexOf(a)?e:-1<c.indexOf(a)?c:l||h||a,n?this.The(u,f,t):f):o):(this.Che(t),(null!=(e=t.templateCell.filter)&&e.condition||t.templateCell.ihe)&&(r&&!(i=r.relationshipMapKey)&&(r.relationshipMapKey=i=this.generateRelationshipMapKeyByCellNode(r)),s=t.templateCell.ihe.condition,c=this.She(s),i=this.The(c,i=i||a,t)),i||(this.Ahe(r)?-1<(l=this.generateRelationshipMapKeyByCellNode(r)).indexOf(a)?l:"".concat(l,"__AND__").concat(a):a)),t.relationshipMapKey=i)},r.prototype.The=function(t,e,i){var n,r,o,t,n=this,r=t.rules,o=t.relation,t=t.conditions;return r.forEach(function(t){var n,n,n;e=(0,z.isNullOrUndefined)(t.formula)?"Cell"===t.value.type||"DataColumn"===t.value.type?"object"==typeof t.value.data&&t.value.data.tableName?(0,x.toUpperCase)(e+"__"+o+"__"+(0,z.combineName)(null!=(n=t.tableName)?n:i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.tableName,t.value.data.columnName)):"object"==typeof t.value.data&&t.value.data.formulaTableName?(0,x.toUpperCase)(e+"__"+o+"__"+(0,z.combineName)(null!=(n=t.tableName)?n:i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.formulaTableName)):(0,x.toUpperCase)(e+"__"+o+"__"+(0,z.combineName)(null!=(n=t.tableName)?n:i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,x.toUpperCase)(e+"__"+o+"__"+(0,z.combineName)(i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,x.toUpperCase)(e+"__"+o+"__"+t.formula)}),t&&t.forEach(function(t){e=n.The(t,e,i)}),e},r.prototype.phe=function(t){var n=[];return(0,x.traverse)(t,n),n},r.prototype.bhe=function(t){var o,n,o=this,n=[];return t.forEach(function(t){var r=[];t.forEach(function(t){var n,e,i,e=t.templateCell;o.Che(t),null!=(n=e.ihe)&&n.condition&&(i=o.She(e.ihe.condition)),r.push({reportDataTableRelation:i,currentNode:t})}),n.push(r)}),n},r.prototype.parseFilterOptionToFilterConditionTree=function(t){var n,e,i,r,o,a,u,s,c,f,l,n="And",e=[],i=[];if((0,x.hasOrCondition)(t))for(n="Or",o=0,a=r=t.or;o<a.length;o++)u=a[o],(0,x.isSimpleFilterCondition)(u)?e.push(this.Ihe(u)):i.push(this.parseFilterOptionToFilterConditionTree(u));else if((0,x.hasAndCondition)(t))for(c=0,f=s=t.and;c<f.length;c++)l=f[c],(0,x.isSimpleFilterCondition)(l)?e.push(this.Ihe(l)):i.push(this.parseFilterOptionToFilterConditionTree(l));else e.push(this.Ihe(t));return{rules:e,conditions:i,relation:n}},r.prototype.Ihe=function(t){var n,e,e;return t.operator||void 0===t.formula?((0,z.isNullOrUndefined)(t.value)||(e=t.value,n={type:(0,x.getValueType)(e),data:e}),(0,z.isNullOrUndefined)(t.cell)||(n={type:"Cell",data:e="string"==typeof(e=t.cell)&&e.startsWith("=")?e.substring(1):e}),(0,z.isNullOrUndefined)(t.dataColumn)||(n={type:"DataColumn",data:e=t.dataColumn}),(0,z.isNullOrUndefined)(t.parameter)||(n={type:"Parameter",data:e=t.parameter}),(0,z.isNullOrUndefined)(t.formula)||(n={type:"Formula",data:e=void 0===(e=t.formula)||(e=e.trim()).startsWith("=")?e:"="+e}),{tableName:t.tableName,column:t.column,operator:t.operator,value:n}):{formula:e=void 0===(e=t.formula)||(e=e.trim()).startsWith("=")?e:"="+e}},r.prototype.She=function(t){var n,e,i,r,o,n=this.xhe(t.rules),e=[];if(t.conditions)for(i=0,r=t.conditions;i<r.length;i++)o=r[i],e.push(this.She(o));return{rules:n,conditions:e,relation:t.relation}},r.prototype.xhe=function(t){var o,a,u,o=this,a=[],u=this.N3;return t.forEach(function(t){var n,e,n,i,r,r;(0,z.isNullOrUndefined)(t.formula)?("Cell"===(e={tableName:t.tableName,column:t.column,operator:t.operator,value:{type:t.value.type,data:t.value.data}}).value.type&&"string"==typeof e.value.data&&x.cellNameReg.test(e.value.data)&&o.DJ.cellNodeGetter&&((i=(n=o.DJ.cellNodeGetter(e.value.data))&&n.templateCell)?i.formula&&"No"!==i.expansionDirection&&(0,x.isFormulaInWhitelist)(i.formula)?(r=(0,x.getFormulaResult)(u.getCalcService(),o.Xle,i.formula),e.value.data={formulaResult:r,formulaString:i.formula,formulaTableName:(0,x.getTableNameByCellNode)(n)}):i.dataColumn?e.value.data=i.dataColumn:e.value.data=i.value:e.value.data=""),"Parameter"===e.value.type&&"string"==typeof e.value.data&&o.ghe&&(r=o.ghe[e.value.data.toUpperCase()],e.value.type=(0,x.getValueType)(r),e.value.data=r),"Formula"===e.value.type&&"string"==typeof e.value.data&&(e.value.data=(0,x.lbe)(o.N3.getCalcService(),o.Xle,e.value.data,o.ghe)),a.push(e)):((n=t.formula.trim()).startsWith("=")||(n="="+n),a.push({formula:n}))}),a},r.prototype.yhe=function(t){var r,n,r=this,n=[];return t.forEach(function(t){var i=[];t.forEach(function(t){var n,e,n,n=t.reportDataTableRelation;n&&(e=r.Nhe(n,t.currentNode)),n={currentNode:t.currentNode,relations:e},i.push(n),r.hbe(t.currentNode)}),n.push(i)}),n},r.prototype.hbe=function(t){var n,e,t,i,r,n=this,t=t.templateCell;"Group"===(null==(e=null==t?void 0:t.dataSetting)?void 0:e.type)&&void 0!==(i=t.dataSetting.formula)&&(t.dataSetting.formula=(0,x.lbe)(this.N3.getCalcService(),this.Xle,t.dataSetting.formula,this.ghe)),a.DataManagerReportSortHelper.parseSortOptionsToSorts(t),null!=t&&t.Kle&&(r=t.Kle).forEach(function(t){void 0!==t.formula&&(t.formula=(0,x.lbe)(n.N3.getCalcService(),n.Xle,t.formula,n.ghe))})},r.prototype.Nhe=function(t,n){var e,i,r,o,e=[];if(t.conditions)for(i=0,r=t.conditions;i<r.length;i++)o=r[i],e.push(this.Nhe(o,n));return{rules:this.khe(t.rules,n),relation:t.relation,conditions:e}},r.prototype.khe=function(t,n){var i,r,o,i=this,r=[],o=(0,x.getTableNameByCellNode)(n);return t.forEach(function(t){var n,e,n,t,n,t,e=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,z.isNullOrUndefined)(e)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,z.isNullOrUndefined)(t.value.data)?r.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?r.push({type:"Join",relationHostTable:null!=(n=t.tableName)?n:o,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString&&r.push({type:"Join",relationHostTable:o,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):(e.startsWith("=")||(e="="+e),(n=(e=(0,x.lbe)(i.N3.getCalcService(),i.Xle,e,i.ghe)).match(u))?(n=(t=n[1].split("."))[0],t=t[1],r.push({type:"Join",formula:e,relationHostTable:o,relationTargetTable:n,relationTargetColumn:t})):r.push({type:"Static",formula:e}))}),r},r.prototype.whe=function(t){var u,s,u=this,s=this.N3;t.forEach(function(t){t.forEach(function(t){var n,e,i,r,o,a,n=t.currentNode,e=(0,x.getTableByCellNode)(s,n),i=t.relations&&(t.relations.rules.length||t.relations.conditions.length),r=n.leftParent&&n.upParent&&"V"===u.currentTreeDirection,o=(0,x.isCellInCrossCell)(n)&&"V"===u.currentTreeDirection;i?(a=u.generateRelationshipMapKeyByCellNode(n),u.hhe[a]&&0!==u.hhe[a].length&&!o||(u.hhe[a]=u.Dhe(t.relations,n))):r?(a=u.generateRelationshipMapKeyByCellNode(n),u.hhe[a]&&0!==u.hhe[a].length||(u.hhe[a]=u.dbe(n))):e&&u._he(e,n)})})},r.prototype.Dhe=function(t,n){var e,i,t,r,o,a,u,s,c,f,l,h,d,v,m,f,h,l,g,p,b,w,w,y,M,C,S,T,A,I,w,e=t.rules,i=t.relation,t=t.conditions;if((0,x.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection)return[];for(r=this.N3,o=[],a=[],u=0,s=e;u<s.length;u++)"Join"===(c=s[u]).type?(f=c.relationHostTable,l=c.relationHostColumn,h=c.relationTargetTable,d=c.relationTargetColumn,v=c.relationCondition,m=c.formula,f=r.getTable(f),h=r.getTable(h),f&&h&&(l=this.buildTableRelationshipMap(f,l,m||v,h,d),o.push({sourceTable:f,targetTable:h,sourceFieldIndexMap:l.sourceFieldIndexMap,targetFieldIndexMap:l.targetFieldIndexMap}))):a.push(c);if(p=!1,n.leftParent&&n.upParent&&"V"===this.currentTreeDirection?o.length?p=!0:g=this.dbe(n):(b=(0,x.getTableByCellNode)(r,n))&&(w="H"===this.currentTreeDirection?n.upParent:n.leftParent,g=(w=this.hhe[w&&w.relationshipMapKey])&&w[0]&&w[0].hasOwnProperty(b.name.toUpperCase())?w:this._he(b,n,!0)),o.length?("And"!==i&&void 0!==i||(o=this.Ehe(o)),y=this.Ohe(o,n,i,e.filter(function(t){return"Join"===t.type})),p&&(g=[].concat(y))):y=g,a.length&&(y=this.Rhe(y,a,n,i,!!o.length,g)),C=e.length?[y]:[],null!=t&&t.length)for(S=void 0,T=0,A=t;T<A.length;T++)I=A[T],S=this.Dhe(I,n),C.push(S);return"And"===i||void 0===i?(w=(0,x.getTableNameByCellNode)(n),M=this.Lhe(C,w)):"Or"===i&&(M=this.Bhe(C,n)),M},r.prototype.dbe=function(t){var n,e,i,e,n,i;return(!t.leftParent||!t.upParent||"H"!==this.currentTreeDirection)&&(t.templateCell.dataColumn||!(0,z.isNullOrUndefined)(t.templateCell.formula)&&(0,x.isFormulaInWhitelist)(t.templateCell.formula))&&(n=this.getRelationshipsMap(),e=t.leftParent.relationshipMapKey,i=t.upParent.relationshipMapKey,e=n&&n[e]||[],n=n&&n[i]||[],e[0])&&n[0]?(i=(0,x.getTableNameByCellNode)(t),this.vbe(e,n,i)):[]},r.prototype.vbe=function(t,n,e){var i,r,o,a,u,r,s,i=Object.keys(t[0]),r=Object.keys(n[0]),o=i.length>r.length?t:n,a=o===t?n:t,u=i.length>r.length?i:r,r=u===i?r:i,s;return 1===r.length&&-1<u.indexOf(r[0])?this.Lhe([t,n],e):this.mbe(o,a,e)},r.prototype.mbe=function(i,a,t){var u,n,e,s,r,o,c,f,l,n,u=[],n=Object.keys(i[0]),e=Object.keys(a[0]),s=(0,x.getArraySameItems)(n,e);if(s.length)for(l in r=s[0],o={},c={},i.forEach(function(t,n){var t=t[r];o[t]||(o[t]=[]),o[t].push(n)}),a.forEach(function(t,n){var t=t[r];c[t]||(c[t]=[]),c[t].push(n)}),f=function(t){var n,e;o.hasOwnProperty(t)&&c[t]&&(n=o[t],e=c[t],n.forEach(function(t){var o=i[t];e.forEach(function(t){for(var n,e,i,r,t,t,n=a[t],e=!0,i=1;i<s.length;i++)if(r=s[i],o[r]!==n[r]){e=!1;break}e&&(t=Object.assign({},o),t=Object.assign(t,n),u.push(t))})}))},o)f(l);else(n=this.N3.getTable(t))&&(u=this.gbe(n));return u},r.prototype.Rhe=function(e,t,n,i,m,g){var r,o,p,b,w,y,a,u,s,c,f,l,h,d,v,M,C,S,r=n.templateCell.dataColumn.tableName.toUpperCase(),o=this.N3;if(e=[].concat(e),p=o.getTable(r),b=this.getTableNameCacheFromParent(n)||r,w=[],y=[],t.forEach(function(r){var o,t,a,n,u,s,c,f,l,h,n,d,v,o=r.field,t=r.operator,a=r.value,n=r.formula,u=r.valueType,c=!1,h=!1;(0,z.isNullOrUndefined)(t)?(0,z.isNullOrUndefined)(n)||(o=n,h=!0):"object"!=typeof a?s=T.ValueComparatorFactory.createComparator(t):(a instanceof Date||"Date"===u)&&(s=T.ValueComparatorFactory.createDateComparator(t),a=new Date(a),f=a.setHours(0,0,0,0),l=a.setHours(23,59,59,59),a=a.getTime(),c=!0),void 0!==o&&!p.hasField(o)&&-1<o.indexOf("@")&&!o.startsWith("=")&&(o="="+o),(s||h)&&(n=void 0,"And"===i||void 0===i?n=w[w.length-1]||e:"Or"===i&&(n=(n=y[y.length-1])||(m?g:e)),d=[],v=[],n.forEach(function(t){var n,e,i,n=!1,e=null==t?void 0:t[b];null!=e&&(i=null!=(i=p.getValueByField(o,e))?i:"",n=h?i:c?(i=new Date(i).getTime(),s(i,a,f,l)):("Formula"===u&&(a=p.getValueByField(r.value,e)),s(i,a))),(n?d:v).push(t)}),w.push(d),y.push(v))}),"And"===i||void 0===i)return w[w.length-1];if("Or"===i){for(a=[],u=0,s=w;u<s.length;u++)c=s[u],a=a.concat(c);if(m){for(f={},l=0,h=e;l<h.length;l++)v=(d=h[l])[r],(0,z.isNullOrUndefined)(v)||(f[v]=!0);for(M=0,C=a;M<C.length;M++)v=(S=C[M])[r],(0,z.isNullOrUndefined)(v)||f[v]||e.push(S);return e}return a}},r.prototype.Ehe=function(t){for(var n,e,i,r,o,a,u,n=[],e=[],i=[];t.length;){for(o=[r=t[0]],i=[0],a=1,u=t.length;a<u;a++)r.targetTable===t[a].targetTable&&(o.push(t[a]),i.push(a));for(n.push(r),1<o.length&&e.push(o),a=i.length-1;-1<a;a--)t.splice(i[a],1)}return this.Fhe(e),n},r.prototype.Fhe=function(t){for(var n,e,i,r,o,a,u,s,c,n=0,e=t;n<e.length;n++){for(o=(r=(i=e[n])[0]).sourceFieldIndexMap,a=r.targetFieldIndexMap,u=1,s=i.length;u<s;u++){for(c in o)o.hasOwnProperty(c)&&(o[c]=(0,x.getArraySameItems)(o[c],i[u].sourceFieldIndexMap[c]));for(c in a)a.hasOwnProperty(c)&&(a[c]=(0,x.getArraySameItems)(a[c],i[u].targetFieldIndexMap[c]))}r.sourceFieldIndexMap=o,r.targetFieldIndexMap=a}},r.prototype.buildTableRelationshipMap=function(e,t,i,r,o){var n,a,n,u,s,c,f,l,a,a,h,d,v,m,g,p,b,w,y,a,M,C,a,n=(0,z.isNullOrUndefined)(t)?t:e.getFieldByNameIgnoreCase(t),a=(0,z.isNullOrUndefined)(o)?o:r.getFieldByNameIgnoreCase(o);if(n&&(t=n.fieldName),a&&(o=a.fieldName),n=(0,x.toUpperCase)("".concat(e.name,"__").concat(t,"__").concat(i,"__").concat(r.name,"__").concat(o)),this.vhe[n])return this.vhe[n];function S(t,n,e){t[n]?t[n].push(e):t[n]=[e]}if(u=[],s=[],c=[],f=e.length(),l=r.length(),i.startsWith("=")){for(a="".concat(r.name,".").concat(o),a="\\[@".concat(a,"\\]"),h=new RegExp(a,"i"),d=function(t,n){var t=i.replace(h,'"'.concat(t,'"'));return e.getValueByField(t,n)},(v=r.hasField(o))||o.startsWith("=")||(o="="+o),m=0;m<l;m++)g=r.getValueByField(o,m),(0,z.isNullOrUndefined)(g)||S(c,g,m);for(p=Object.keys(c),b=function(n){var e=[];p.forEach(function(t){d(t,n)&&c[t].forEach(function(t){return e.push(t)})}),(u[n]=e).forEach(function(t){S(s,t,n)})},w=0;w<f;w++)b(w)}else{for(y=T.ValueComparatorFactory.createComparator(i),a=e.hasField(t),v=r.hasField(o),a||t.startsWith("=")||(t="="+t),v||o.startsWith("=")||(o="="+o),w=0;w<f;w++)g=e.getValueByField(t,w),(0,z.isNullOrUndefined)(g)||S(c,g,w);for(M=Object.keys(c),b=void 0,b="Equal"===i?function(n){var t,e,t,t=r.getValueByField(o,n);(0,z.isNullOrUndefined)(t)||(e=[],(t=c[t])&&t.forEach(function(t){return e.push(t)}),(s[n]=e).forEach(function(t){S(u,t,n)}))}:function(n){var e,i,e=r.getValueByField(o,n);(0,z.isNullOrUndefined)(e)||(i=[],M.forEach(function(t){y(t,e)&&c[t].forEach(function(t){return i.push(t)})}),(s[n]=i).forEach(function(t){S(u,t,n)}))},C=0;C<l;C++)b(C)}return a={sourceTable:e,targetTable:r,sourceFieldIndexMap:u,targetFieldIndexMap:s},this.vhe[n]=a},r.prototype.Ohe=function(t,F,L,n){var B,P,G,e,U,i,r,o,o,r,a,u,s,c,f,i,l,s,c,f,H,V,h,d,v,m,g,p,b,c,o,w,y,M,B=this,P=[],G=F.upParent&&F.leftParent,e=F.upParent||F.leftParent,U="";if(e&&(U=this.generateRelationshipMapKeyByCellNode(e),G))if(r=F.upParent,o=F.leftParent,o=this.generateRelationshipMapKeyByCellNode(o),r=this.generateRelationshipMapKeyByCellNode(r),a=this.hhe[o],u=this.hhe[r],a&&u&&a[0]&&u[0])s=Object.keys(a[0]),c=Object.keys(u[0]),f=s.length,i=c.length,l=[],t.forEach(function(t){var n=t.sourceTable.name.toUpperCase(),t=t.targetTable.name.toUpperCase();-1===l.indexOf(n)&&l.push(n),-1===l.indexOf(t)&&l.push(t)}),s=(0,x.getArraySameItems)(s,l).length,c=(0,x.getArraySameItems)(c,l).length,U=(f=f<i&&s||0===c)?o:r,i=(U=f&&0===s?void 0:U)===r?a:u;else{if(u&&u[0])return[];e=F.leftParent,U=this.generateRelationshipMapKeyByCellNode(e)}for(H=[],V=[],h=function(t,n){var e,i,r,o,a,u,s,i,o,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,k,_,D,j,O,E,R,i=t.sourceTable,r=t.sourceFieldIndexMap,o=t.targetTable,a=t.targetFieldIndexMap,u=i.name.toUpperCase(),s=o.name.toUpperCase();if(P=V[V.length-1]||P,r&&a){if(i=B.hhe[U],U&&i||V.length){if(c=s,f=a,l=u,(P=(o=P).length&&"And"===L?P:i)[0]&&void 0===P[0][c]&&(f=r,l=s,void 0===P[0][c=u]))return P=o,n||H.push(t),!1;for(d=[],v=0,m=(h=[].concat(P)).length;v<m;v++)d[g=h[v][c]]||(d[g]=[]),d[g].push(v);if(p=[],b=F.templateCell.row,w=F.templateCell.col,l=l.toUpperCase(),y=(0,z.combineName)(l,b,w),M=f.length,C=B.pbe(h,c,l,f)){for(S=0;S<M;S++)if(void 0!==(T=f[S])&&void 0!==(A=d[S]))for(N=x=I=0,k=T.length;N<k;N++)for(I=T[N],_=0,D=A.length;_<D;_++)x=A[_],void 0===(j=Object.assign({},h[x]))[l]?j[l]=I:(j[y]=I,B.setNodeTableCache(b,w,y)),p.push(j);P=p}}else{if(U&&!i&&G)return!0;for(S in P=[],a)if(a.hasOwnProperty(S))for(O=0,E=a[S];O<E.length;O++)R=E[O],P.push(((e={})[s]=+S,e[u]=R,e))}V.push(P)}},d=0,v=t;d<v.length&&!h(m=v[d]);d++);for(g=0,p=H;g<p.length&&!h(b=p[g],!0);g++);return"And"===L||void 0===L?P=this.Phe(V[V.length-1],n,F,"And"):"Or"===L&&(P=this.Phe(this.Bhe(V,F),n,F,"Or")),G&&P&&i&&P[0]&&i[0]&&(c=Object.keys(P[0]),o=Object.keys(i[0]),w=(0,x.getArraySameItems)(c,o),y=[],P.forEach(function(n,t){for(var e,i,r,o,a,e=w.map(function(t){return n[t]}),i=y,r=0,o=e;r<o.length;r++)i[a=o[r]]||(i[a]=[]),i=i[a];i.push(t),w.forEach(function(t){delete n[t]})}),M=[],i.forEach(function(r){for(var t,n,e,i,o,t=w.map(function(t){return r[t]}),n=y,e=0,i=t;e<i.length;e++)o=i[e],n=n&&n[o];n&&n.forEach(function(t){var n,e,i,n=P[t],e=Object.assign({},r);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);M.push(e)})}),P=M,"And"===L||void 0===L?P=this.Phe(M,n,F,"And"):"Or"===L&&(P=this.Phe(M,n,F,"Or"))),P},r.prototype.pbe=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,r={},o=0,a=t;o<a.length;o++)s=(u=a[o])[n],c=u[e],void 0!==s&&void 0!==c&&(r[s]||(r[s]={}),r[s][c]=!0);for(s in i)if(i.hasOwnProperty(s))for(f=i[s],l=r[s],h=0,d=f;h<d.length;h++)if(c=d[h],void 0===l||!l[c])return!0;return!1},r.prototype.Phe=function(t,n,e,i){var f,l,r,f=this;return t&&(l=this.getTableNameCacheFromParent(e),r=n.map(function(t){var n,e,i,r,o,t,a,u,s,c,n=t.relationHostColumn,e=t.relationTargetColumn,i=t.relationCondition,r=t.relationHostTable,o=t.relationTargetTable,t=t.formula;return(0,z.isNullOrUndefined)(t)?(a=T.ValueComparatorFactory.createComparator(i),r=r.toUpperCase(),o=o.toUpperCase(),u=f.N3.getTable(r),s=f.N3.getTable(o),c=(l||r).toUpperCase(),function(t){return a(u.getValueByField(n,t[c]),s.getValueByField(e,t[o]))}):null}),"And"===i?t=t.filter(function(t){for(var n,e,i,n=0,e=r;n<e.length;n++)if((i=e[n])&&!i(t))return!1;return!0}):"Or"===i&&(t=t.filter(function(t){for(var n,e,i,n=0,e=r;n<e.length;n++)if(!(i=e[n])||i(t))return!0;return!1}))),t},r.prototype.Lhe=function(i,r){var t,o,n,e,a,u,s,c,f,l,h,d,v,m;if(i.some(function(t){return t&&0===t.length}))return[];if(i.length<=1)return i[0]||[];if(void 0===r)return[];for(i.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),t=i[0],o=[],r=this.bbe(i,r),n=function(t,n){var e={};i[t].forEach(function(t){var t=t[r];void 0!==t&&(e[t]=!0)}),o.push(e)},e=0,a=i.length;e<a;e++)n(e,a);for(u=o[0],e=1,a=o.length;e<a;e++)for(c in s=o[e],u)u.hasOwnProperty(c)&&u[c]&&(s[c]||(u[c]=!1));for(f=[],l=new RegExp("^".concat(r,"(__\\d+__\\d+)?$")),h=function(n){var t=Object.keys(n),e=!0;t.forEach(function(t){var t;l.test(t)&&(t=n[t],e=e&&!(0,z.isNullOrUndefined)(t)&&u[t])}),e&&f.push(n)},d=0,v=t;d<v.length;d++)h(m=v[d]);return f},r.prototype.Bhe=function(t,n){var e,i,r,o,a,u,s,c,f,l;if((t=t.filter(function(t){return t.length})).length<=1)return t[0]||[];if(void 0===(e=(0,x.getTableNameByCellNode)(n)))return[];for(t.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),i=t[0],r={},o=0,a=i;o<a.length;o++)s=(u=a[o])[e],(0,z.isNullOrUndefined)(s)||(r[s]=!0);for(c=1,f=t.length;c<f;c++)(l=t[c]).forEach(function(t){var n=t[e];(0,z.isNullOrUndefined)(n)||r[n]||(r[n]=!0,i.push(t))});return i},r.prototype.bbe=function(t,n){var t,t,t=t.map(function(t){return Object.keys(t[0])}),t=t.reduce(function(t,n){return(0,x.getArraySameItems)(t,n)},t[0]);return-1<t.indexOf(n)?n:t[0]},r.prototype._he=function(t,n,e){var i=this.generateRelationshipMapKeyByCellNode(n);return(0,x.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection?[]:(this.hhe[i]&&!e||(this.hhe[i]=this.gbe(t)),this.hhe[i])},r.prototype.gbe=function(t){for(var n,e,i,r,o,n=[],e=t.name.toUpperCase(),i=0,r=t.length();i<r;i++)(o={})[e]=i,n.push(o);return n},r.prototype.Ahe=function(t){return!!t&&(this.Che(t),!!t.templateCell.ihe||this.Ahe(t.leftParent)||this.Ahe(t.upParent))},r.prototype.Che=function(t){var n,e,t,i,e,t,n=t.templateCell,e=n.filter&&n.filter.condition;n.ihe||(t=this.nTe(t),e&&t.push(e),t.length&&(e=(0,x.deepCloneFilterCondition)(i={and:t}),t=this.parseFilterOptionToFilterConditionTree(e),n.ihe={condition:t}))},r.prototype.nTe=function(t){var n,e,i,r,e,o,a,u,s,c,f,n,l,i=[],r=[],e=this.N3,o=(0,x.getTableByCellNode)(e,t),a=null==o?void 0:o.table();return t.leftParent&&(s=null==(u=(0,x.getTableByCellNode)(e,t.leftParent))?void 0:u.table())!==a&&(c=this.getRelationshipGraphTableIndex(o),f=this.getRelationshipGraphTableIndex(u),n=null==(n=this.relationshipGraphs()[f])?void 0:n.tableToTableRelationPath,c===f)&&n&&(l=n[a.name.toUpperCase()][s.name.toUpperCase()])&&l.forEach(function(t){var n;-1===r.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},i.push(n),r.push(t))}),t.upParent&&(s=null==(u=(0,x.getTableByCellNode)(e,t.upParent))?void 0:u.table())!==a&&(c=this.getRelationshipGraphTableIndex(o),f=this.getRelationshipGraphTableIndex(u),n=null==(e=this.relationshipGraphs()[f])?void 0:e.tableToTableRelationPath,c===f)&&n&&(l=n[a.name.toUpperCase()][s.name.toUpperCase()])&&l.forEach(function(t){var n;-1===r.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},i.push(n),r.push(t))}),i},n.DataManagerReportJoinHelper=r},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js":function(t,n,e){"use strict";var i,h,d,s,v,r;function o(t){this.N3=t,this.Xle=new i.CalcSource(t.getCalcService())}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportSortHelper=void 0,i=e("CalcEngine"),h=e("./dist/src/dataManager.entry.js"),d=e("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),s=void 0,v="number",o.prototype.sortGroupsBySortCondition=function(c,f,l){var n,u,e,t,i,n=f.templateCell.Kle,u=[];if(n){for(n.forEach(function(t,n){var e,i,r,o,a,u,s,a;if(!(0,h.isNullOrUndefined)(t.cell)&&d.cellNameReg.test(t.cell)&&(e=l(t.cell)))if((i=(0,d.wbe)(e,f))||e===f)for(r=0,o=c;r<o.length;r++)u=(u=(a=o[r]).sortValues)||(a.sortValues=[]),s=void 0,e===f?s=a.value:(a=(0,d.ybe)(a,e))&&(s=a[0].value),u[n]=s;else t.order=void 0}),t=function(a){var i,t,o,i=n[a];i&&i.order&&(i.list&&i.list.length?(t=i.list,o={},t.forEach(function(t,n){return o[t]=n}),e=function(t,n){var r,e,t,r=!1,e,t=function(t,n){var e,i,t,n,e=t.sortValues[a],i=n.sortValues[a];return u[a+1]&&e===i?(r=!0,u[a+1](t,n)):(t=o[e+""],n=o[i+""],t!==s&&n!==s?t-n:t!==s?-1:n!==s?1:e===i?0:i<e?1:-1)}(t,n);return!r&&"desc"===i.order?-t:t},u[a]=e):(0,h.isNullOrUndefined)(i.cell)&&(0,h.isNullOrUndefined)(i.column)&&(0,h.isNullOrUndefined)(i.formula)||(e=function(t,n){var r,o,e,t,r=!1,o="desc"===i.order,e,t=function(t,n){var e,i,t,n,e=t.sortValues[a],i=n.sortValues[a];return u[a+1]&&e===i?(r=!0,u[a+1](t,n)):(t=(0,h.isNullOrUndefined)(e)||""===e||typeof e==v&&isNaN(e),n=(0,h.isNullOrUndefined)(i)||""===i||typeof i==v&&isNaN(i),t||n?t&&n?0:t&&!n?o?-1:1:!t&&n?o?1:-1:void 0:e===i?0:(0,d.isGreaterThan)(i,e)?-1:1)}(t,n);return!r&&o?-t:t},u[a]=e))},i=n.length-1;-1<i;i--)t(i);e&&(c.sort(e),this.Mbe(c,f))}},o.parseSortOptionsToSorts=function(t){var n;null!=(n=t.sorts)&&n.length&&!t.Kle&&(t.Kle=t.sorts.map(function(t){var n,e,n,t,n=(0,h.isNullOrUndefined)(t.desc),e=n?t.asc:t.desc,n={order:n?"asc":"desc",list:t.list};return(e=(e=(0,h.isNullOrUndefined)(e)?"":e).trim()).startsWith("=")?(t=e.substring(1),d.cellNameReg.test(t)?n.cell=t:n.formula=e):n.column=e,n}))},o.prototype.Mbe=function(i,r){var o=this;r.children.forEach(function(t){var n,n,e,n=null==(n=t.data)?void 0:n.groups;null!=n&&n.length&&(e=t.leftParent===r,n.sort(function(t,n){var t,n,t=e?t.leftParent:t.upParent,n=e?n.leftParent:n.upParent;return i.indexOf(t)-i.indexOf(n)})),o.Mbe(n,t)})},n.DataManagerReportSortHelper=o},"./dist/src/data-manager-report/tree-data-generator/index.js":function(t,n,e){"use strict";var i,r,o,a,u,c,s;function f(t,n){var e=this;this.generateTreeDataInternal=function(t){var t,n,t=t.root;try{e.Rle.generateJoinRelationIndexMap(t),n=e.Lle.generateCellNodeTreeData(t)}catch(t){n=[]}finally{t.data.groups=n}},this.Uhe=new u.DataManagerProxy(t),this.DJ=n,this.Rle=new r.DataManagerReportJoinHelper(this.Uhe,n),this.Ble=new o.DataManagerReportSortHelper(this.Uhe),this.Lle=new a.DataManagerReportGroupHelper(this.Uhe,n,this.Rle,this.Ble),this.Hhe=new i.DataManagerReportCrossHelper(this.Uhe,n,this.Rle,this.Lle,this.Ble)}function l(t,n){var e,e;t.templateCell.dataColumn&&void 0!==t.templateCell.dataColumn.tableName&&(n[t.templateCell.dataColumn.tableName.toUpperCase()]=!0),(e=t.templateCell.filter)&&e.condition&&h(e.condition,n),null!=(e=t.children)&&e.forEach(function(t){l(t,n)})}function h(t,n){var e,i,r,o,a,u;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(e=0,i=t.and;e<i.length;e++)h(r=i[e],n);if(t.or)for(o=0,a=t.or;o<a.length;o++)h(u=a[o],n)}}function d(t,n){n=n.toUpperCase();for(var e=0;e<t.length;e++)if(t[e].tables.find(function(t){return t.name.toUpperCase()===n}))return e;return-1}function v(t){var n,i,a,e,r,o,u,s,n=t.tables,i=t.relationships;if(n.length&&i.length){for(e in a={},n.forEach(function(t){var e,r,o,n,e=t.table(),r=e.name.toUpperCase();a[r]||(a[r]={}),o=a[r],(n=i.filter(function(t){return t.targetTable===e||t.sourceTable===e}).map(function(t){var n=t.sourceTable===e?t.targetTable:t.sourceTable;return{table:n,relationship:t,tableName:n.name.toUpperCase()}})).forEach(function(t){var n,e,i;if(t.tableName!==r){for(n in a)a.hasOwnProperty(n)&&n!==r&&n!==t.tableName&&(e=a[n])[r]&&((i=[].concat(e[r])).push(t.relationship),!e[t.tableName]||e[t.tableName].length>i.length)&&(e[t.tableName]=i);o[t.tableName]||(o[t.tableName]=[t.relationship])}})}),a)if(a.hasOwnProperty(e))for(o in r=a[e])if(r.hasOwnProperty(o)&&a[o])for(u in a[o])a[o].hasOwnProperty(u)&&u!==e&&(s=r[o].concat(a[o][u]),!a[e][u]||a[e][u].length>s.length)&&(a[e][u]=s);Object.values(a).forEach(function(t){Object.values(t).forEach(function(t){t.reverse()})}),t.tableToTableRelationPath=a}}Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0,i=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js"),r=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js"),o=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),a=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),u=e("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),c=e("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),f.prototype.generateTreeData=function(){var t,n,e,t,t,t=this.DJ,n=t.crossCells,e=t.verticalExpansionTrees,t=t.horizontalExpansionTrees;this.zhe();try{this.eTe()}catch(t){}this.Rle.currentTreeDirection="H",t.forEach(this.generateTreeDataInternal),this.Rle.currentTreeDirection="V",e.forEach(this.generateTreeDataInternal),(t=n.filter(function(t){return!n.includes(t.leftParent)&&!n.includes(t.upParent)})).length&&this.Hhe&&this.Hhe.processCrossCells(t),this.Rle.clearCache(!0),this.Lle.clearCache(!0),this.Uhe.clearTableDataCache(),this.Sbe()},f.prototype.zhe=function(){this.Rle.clearCache(),this.Lle.clearCache()},f.prototype.getUsedTableRelationshipGraphsForUT=function(){return this.eTe(),this.Rle.relationshipGraphs()},f.prototype.eTe=function(){for(var t,u,s,n,e,t,t=this.Uhe,u=[].concat(t.getRelationshipsByTable()),s=[],n=this.Tbe(),e=function(){var t,n,e,i,r,n,e,i,r,o,a,n,t=u.shift(),n=t.sourceTable,e=t.targetTable,i=n.name.toUpperCase(),r=e.name.toUpperCase(),n=new c.ReportTable({dataManagerTable:n}),e=new c.ReportTable({dataManagerTable:e}),i=d(s,i),r=d(s,r);-1===i&&-1===r?s.push(o={relationships:[t],tables:[n,e]}):-1===i&&-1!==r?(s[r].relationships.push(t),s[r].tables.push(n)):-1!==i&&-1===r?(s[i].relationships.push(t),s[i].tables.push(e)):(i===r&&-1===s[i].relationships.indexOf(t)?s[i]:(a=s[r],(n=s.splice(i,1))[0].relationships.forEach(function(t){a.relationships.push(t)}),n[0].tables.forEach(function(t){a.tables.push(t)}),a)).relationships.push(t)};u.length;)e();(t=s.filter(function(t){return t.tables.map(function(t){return t.name.toUpperCase()}).some(function(t){return n[t]})})).forEach(function(t){v(t)}),this.Rle.relationshipGraphs(t)},f.prototype.Tbe=function(){var t,n,n={};return this.DJ&&(this.DJ.horizontalExpansionTrees.forEach(function(t){l(t.root,n)}),this.DJ.verticalExpansionTrees.forEach(function(t){l(t.root,n)}),null!=(t=this.DJ.crossCells))&&t.forEach(function(t){l(t,n)}),n},f.prototype.Sbe=function(){var n,t,e,i,t,n=this,t=this.DJ,e=t.verticalExpansionTrees,i=t.horizontalExpansionTrees,t=t.crossCells;i.forEach(function(t){n.Abe(t.root)}),e.forEach(function(t){n.Abe(t.root)}),t&&t.forEach(function(t){n.Abe(t)})},f.prototype.Abe=function(t){var n,e,n=this;t&&(t.nM=void 0,(e=t.templateCell)&&(e.ihe=void 0,e.Kle=void 0,e.Hle=void 0,this.cCe(t)),t.children.forEach(function(t){n.Abe(t)}))},f.prototype.cCe=function(t){var t=t.data.groups;t&&t.length&&t.forEach(function(t){t.Qle=void 0,t.Jle=void 0,t.sortValues=void 0})},n.TreeDataGenerator=f},"./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/src/data-manager-report/tree-data-generator/utils/utils.js":function(R,t,n){"use strict";var r,o,n,a,u,s,c,f,e;function l(t,n,e){var i=r(r([],e=void 0===e?[]:e,!0),[t],!1);0<t.children.length?t.children.forEach(function(t){l(t,n,i)}):n.push(i)}function i(t,n){var e,n,i,e=0;switch(n){case"Avg":e=t.length?t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)/t.length:0;break;case"Count":e=t.length;break;case"Max":e=Math.max.apply(Math,t);break;case"Min":e=Math.min.apply(Math,t);break;case"None":e=0;break;case"Sum":e=t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)}return n=15,"number"==typeof e&&-10<e&&e<10&&(1<(i=e.toString()).indexOf("000000000000")||1<i.indexOf("999999999999"))&&(n=14),a(e,o.Functions.CALC_PRECISION||n)}function h(t,n){return t&&t.length&&n&&n.length?t.filter(function(t){return-1<n.indexOf(t)}):[]}function d(t,n){var e;return t&&0!==t.length?n&&0!==n.length?(e=[].concat(t),n.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),e):t:n||[]}function v(t){return t.toUpperCase()}function m(t){return!(!(t=t.replace(/__\d+__\d+/g,"").slice(t.indexOf("=")+1,t.length).trim()).startsWith("{")||!t.endsWith("}"))}function g(t,n,e){var n,t,i,e,r,o,a,u,s,c,t=t.parse(n,e,0,0),i=[],e=null==(n=null==t?void 0:t.value)?void 0:n.array;if(e)for(r=0,o=e;r<o.length;r++)for(u=0,s=a=o[r];u<s.length;u++)c=s[u],i.push(c);return i}function p(t,n){var e=n.nM;return e||(n.templateCell.dataColumn?e=t.getTable(n.templateCell.dataColumn.tableName):n.templateCell.formula&&m(n.templateCell.formula)&&(e=t.getTable("".concat(n.templateCell.formula,"__").concat(n.templateCell.row,"__").concat(n.templateCell.col))),n.nM=e),e}function b(t,n){var e="";return t.templateCell.dataColumn?e=t.templateCell.dataColumn.tableName:t.templateCell.formula&&(n||m(t.templateCell.formula))&&(e="".concat(t.templateCell.formula,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col)),e.toUpperCase()}function w(t){var t=t.match(e);return t&&t[1]}function y(t){return t&&t.and}function M(t){return t&&t.or}function C(t){return t&&!t.or&&!t.and}function S(t){var n;switch(typeof t){case"string":return"String";case"boolean":return"Boolean";case"number":return"Number"}if(isNaN(t)&&!isNaN(Date.parse(t)))return"Date"}function T(t,n){for(var e,i,r,e="",i="A".charCodeAt(0),r=n+1;0<r;r=parseInt((r-1)/26+"",10))e=String.fromCharCode(i+(r-1)%26)+e;return e+(t+1)}function A(t){var n,e,n=Array.isArray(t)?[]:{};for(e in t)t.hasOwnProperty(e)&&(n[e]="and"===e||"or"===e?A(t[e]):t[e]);return n}function I(t){return!!t&&(!(!t.leftParent||!t.upParent)||I(t.leftParent||t.upParent))}function x(t,n){return!(!t||!n)&&(t===n||x(t.leftParent,n)||x(t.upParent,n))}function N(t,n){var e,i,r,o;if(t&&t.childrenArray&&t.childrenArray.length&&n)for(e=void 0,i=0,r=t.childrenArray;i<r.length;i++)if(e=(o=r[i])&&o[0]&&o[0].cellNode===n?o:N(o[0],n))return e}function k(t,n){var e,i,r,o,a;return t instanceof Date&&(t=u(t)),n instanceof Date&&(n=u(n)),r=(e=typeof t)===s,o=(i=typeof n)===s,a=i===c,e==i||e!==c&&!a?e===f&&o||(!r||i!==f)&&(r&&o?t.toLowerCase()>n.toLowerCase():n<t):a}function _(t,n,e,i){var i;return i&&(D(i,i=j(t,n,e)),void 0===(e=O(t,n,i))||e.startsWith("=")||(e="="+e)),e}function D(t,n){var e,i,r,o,a;if(8===n.type)void 0!==(e=t[n.value.toUpperCase()])&&("string"==(i=typeof e)?n.type=3:"boolean"==i?n.type=4:"number"==i?n.type=2:e instanceof Date&&(e=e.toString(),n.type=3),n.value=e);else{if(n.arguments)for(r=0,o=n.arguments;r<o.length;r++)D(t,a=o[r]);n.value&&D(t,n.value),n.value2&&D(t,n.value2)}}function j(t,n,e){return t.parse(n,e,0,0)}function O(t,n,e){return t.unparse(n,e,0,0)}function E(t){var t=t.newRecordDefaultValueGenerator?t.newRecordDefaultValueGenerator():void 0,n;return n=t&&void 0!==t.formula?t.formula:n}r=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.generateDefaultFormulaByTemplateCell=t.expressionToFormula=t.formulaToExpression=t.xbe=t.lbe=t.isGreaterThan=t.ybe=t.wbe=t.isCellInCrossCell=t.deepCloneFilterCondition=t.rowColToCellName=t.getValueType=t.isSimpleFilterCondition=t.hasOrCondition=t.hasAndCondition=t.fieldExpressionToField=t.getTableNameByCellNode=t.getTableByCellNode=t.getFormulaResult=t.isFormulaInWhitelist=t.toUpperCase=t.getArrayUnionItems=t.getArraySameItems=t.calc=t.traverse=t.cellNameReg=t.formulaWhitelist=void 0,o=n("CalcEngine"),n=n("Common"),a=n.Common.st.E8,u=n.Common.ct.o0,s="string",c="number",f="boolean",t.formulaWhitelist=[],t.cellNameReg=/^([A-Z]+)(\d+)$/,t.traverse=l,t.calc=i,t.getArraySameItems=h,t.getArrayUnionItems=d,t.toUpperCase=v,t.isFormulaInWhitelist=m,t.getFormulaResult=g,t.getTableByCellNode=p,t.getTableNameByCellNode=b,e=/\[@(.*?)\]/,t.fieldExpressionToField=w,t.hasAndCondition=y,t.hasOrCondition=M,t.isSimpleFilterCondition=C,t.getValueType=S,t.rowColToCellName=T,t.deepCloneFilterCondition=A,t.isCellInCrossCell=I,t.wbe=x,t.ybe=N,t.isGreaterThan=k,t.lbe=_,t.xbe=D,t.formulaToExpression=j,t.expressionToFormula=O,t.generateDefaultFormulaByTemplateCell=E},"./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js":function(t,n){"use strict";var e;function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ValueComparatorFactory=void 0,i.createComparator=function(t){switch(t){case"Equal":return function(t,n){return t+""==n+""};case"NotEqual":return function(t,n){return t+""!=n+""};case"GreaterThanOrEqual":return function(t,n){var t=i.parseValue(t,n);return t.recordValue>=t.ruleValue};case"GreaterThan":return function(t,n){var t=i.parseValue(t,n);return t.recordValue>t.ruleValue};case"LessThanOrEqual":return function(t,n){var t=i.parseValue(t,n);return t.recordValue<=t.ruleValue};case"LessThan":return function(t,n){var t=i.parseValue(t,n);return t.recordValue<t.ruleValue};case"StartWith":return function(t,n){return(t+"").startsWith(n+"")};case"NotStartWith":return function(t,n){return!(t+"").startsWith(n+"")};case"EndWith":return function(t,n){return(t+"").endsWith(n+"")};case"NotEndWith":return function(t,n){return!(t+"").endsWith(n+"")};case"Contains":return function(t,n){return-1<(t+"").indexOf(n+"")};case"NotContains":return function(t,n){return-1===(t+"").indexOf(n+"")};case"In":return function(t,n){return-1<(n+"").indexOf(t+"")};case"NotIn":return function(t,n){return-1===(n+"").indexOf(t+"")};default:return function(){return!0}}},i.parseValue=function(t,n){return"number"==typeof t?isNaN(n)?{recordValue:t+"",ruleValue:n+""}:{recordValue:t,ruleValue:+n}:isNaN(t)?{recordValue:t+"",ruleValue:n+""}:"number"==typeof n?{recordValue:+t,ruleValue:n}:{recordValue:t,ruleValue:n}},i.createDateComparator=function(t){switch(t){case"Equal":case"Contains":case"In":return function(t,n,e,i){return e<=t&&t<=i};case"NotEqual":case"NotContains":case"NotIn":return function(t,n,e,i){return i<t||t<e};case"GreaterThanOrEqual":case"StartWith":case"NotEndWith":return function(t,n,e,i){return e<=t};case"GreaterThan":return function(t,n,e,i){return i<t};case"LessThanOrEqual":case"NotStartWith":case"EndWith":return function(t,n,e,i){return t<=i};case"LessThan":return function(t,n,e,i){return t<e};default:return function(){return!0}}},n.ValueComparatorFactory=i},"./dist/src/dataManager.common.js":function(t,e,n){"use strict";var i,r,o,n,n,a,u,s;function c(){return null!==s&&s.apply(this,arguments)||this}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(e,"__esModule",{value:!0}),e.CalcFunction=e.sR=e.SR=void 0,r=n("CalcEngine"),o=n("Common"),n=n("./dist/src/res.en.js"),e.SR={en:n.resource},n=new o.Common.ResourceManager(e.SR,"DataManager"),e.sR=n.getResource.bind(n),s=r.Functions.Function,i(c,s),c.prototype.description=function(){var t=this,n=(0,e.sR)().zve;return t.IDt||(n?n[t.name]:s.prototype.description.call(this))},e.CalcFunction=c},"./dist/src/dataManager.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/dataSource/dataSource.entry.js"),n),r(e("./dist/src/table/table.entry.js"),n),r(e("./dist/src/viewField/viewField.entry.js"),n),r(e("./dist/src/view/view.entry.js"),n),r(e("./dist/src/interfaces/interface.js"),n),r(e("./dist/src/interfaces/styleOptions.js"),n),r(e("./dist/src/interfaces/validatorOptions.js"),n),r(e("./dist/src/interfaces/conditionalFormatOptions.js"),n),r(e("./dist/src/dataManager.js"),n),r(e("./dist/src/dataManager.common.js"),n),r(e("./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js"),n),r(e("./dist/src/data-manager-report/data-manager-report.js"),n),r(e("./dist/src/data-manager-report/tree-data-generator/index.js"),n),r(e("./dist/src/query.js"),n)},"./dist/src/dataManager.js":function(t,n,e){"use strict";var i,r,o,y,a,u,s,c,f,l,h,d;function M(t){var t=t.split(/\s*=\s*/);return 2===t.length?[t[0].split("."),t[1].split(".")]:[]}function v(t,n){this.rV={},this.tables={},this.relationships=[],this.OEt={},n=n||new i.CalcService,this.updateCalcService(n),(0,u.addCustomFunctions)(),t&&this.Ibe(t)}function m(t){return t instanceof o.View}Object.defineProperty(n,"__esModule",{value:!0}),n.isView=n.DataManager=void 0,i=e("CalcEngine"),r=e("./dist/src/table/table.js"),o=e("./dist/src/view/view.js"),y=e("./dist/src/dataSource/utils.js"),a=e("./dist/src/dataSource/dataSource.js"),u=e("./dist/src/calculation/functions/functions.entry.js"),s=e("./dist/src/calculation/tokenResolver.js"),c=e("./dist/src/calculation/queryFunctionResolver.js"),f=e("./dist/src/relationship.js"),l=null,h=i.Convert.LE,v.prototype.Ibe=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,l,h,d,v,m,g,p,b,w,n,e=0,i=(0,y.keys)(t.tables);e<i.length;e++){if(r=i[e],a={},u=(o=t.tables[r]).fields)for(s in u)u.hasOwnProperty(s)&&(c=u[s],a[s]={name:c.name,dataType:c.dataType,spread:c.spread});if(f={schema:{columns:a}},(l=o.dimensions)&&(f.schema.dimensions=l),o.measures&&0<Object.keys(o.measures).length&&(f.schema.measures=(0,y.clone)(o.measures,!0)),o.source)f.remote={read:{url:o.source}};else{if(!o.localSource)continue;f.data=o.localSource}if(l=this.addTable(r,f),o.primaryKey&&l.primaryKey(o.primaryKey),h=o.relationships)for(d in h)if(h.hasOwnProperty(d)){if(b=p=g=m=void 0,(v=h[d]).on){if(0===(w=M(v.on)).length)continue;m=w[0][0],p=w[0][1],g=w[1][0],b=w[1][1]}else{if(!(v.with&&v.source&&o.primaryKey))continue;m=r,p=o.primaryKey,g=v.source,b=v.with}this.addRelationship(this.tables[m],p,d,this.tables[g],b,g+"_"+b)}}this.queries=t.queries},v.prototype.addTable=function(t,n){this.RTe(t);var n=new r.Table(t,n);return(this.tables[t]=n).REt(this),n},v.prototype.removeTable=function(t){for(var n,e,i,n=this.tables[t],e=this.relationships,i=e.length-1;0<=i;i--)e[i].sourceTable!==n&&e[i].targetTable!==n||(e[i].VP(),e.splice(i,1));n.REt(l),delete this.tables[t],this.RTe(t)},v.prototype.addRelationship=function(t,n,e,i,r,o){var t=new f.Relationship(t,n,e,i,r,o);return this.relationships.push(t),t},v.prototype.removeRelationship=function(t){for(var n,e,n=this.relationships,e=0;e<n.length;e++)if(n[e].sourceRelationshipName===t){n[e].VP(),n.splice(e,1);break}},v.prototype.updateCalcService=function(t){for(var n,e,i,r,o,n,e=!0,i=0,r=t.getResolvers();i<r.length;i++)if((o=r[i])instanceof s.DataManagerTokenResolver){e=!1;break}e&&t.addResolver(new s.DataManagerTokenResolver(8e3)),this.Lp=t},v.prototype.xEt=function(t,n,e){var i,r;return h(t)?t=t.getValueByIndex(0):(0,y.isString)(t)||(t=""+t),(0,y.isString)(n)?n=[n]:h(n)?n=n.toArray(0,!0):n&&n.array&&(n=n.array[0]),i=t+"-"+(n&&n.join(",")),r=(r=this.OEt[i])||(this.OEt[i]=c.QueryFunctionSolver.parseParam(t,n,e,this))},v.prototype.IEt=function(t,n,e,i,r){var t,n,t=this.xEt(t,n,e);return r?t.table._dataSource.unbind(a.ONCHANGE,i):i&&t.table&&t.table._dataSource.bind(a.ONCHANGE,i),n=0===(n=t.getValue?t.getValue(t.table):[[]]).length?[[]]:n},v.prototype.RTe=function(t){var n,e,i,r,o,a,n=this.OEt;if(n)for(i=t+"-",r=0,o=e=Object.keys(n);r<o.length;r++)(a=o[r]).startsWith(i)&&delete n[a]},v.prototype.toJSON=function(){var t,n,e,i,t=this.tables,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e].toJSON());return{tables:n,relationships:i=this.relationships.map(function(t){return{sourceTableName:t.sourceTable.name,sourceFieldName:t.sourceFieldName,sourceRelationshipName:t.sourceRelationshipName,targetTableName:t.targetTable.name,targetFieldName:t.targetFieldName,targetRelationshipName:t.targetRelationshipName}}),queries:this.queries}},v.prototype.fromJSON=function(t){var o,n,e,e,i,r,a,u,s,c,o=this,n=this.tables={},e=t.tables,e=Promise.all(e.map(function(t){var n,e,i,r,n,n=t.dataSourceOption.schema,e=n&&n.columns;if(e)for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&"date"===r.dataType&&Array.isArray(r.lookup)&&(r.lookup=r.lookup.map(function(t){return new Date(t)}));return(n=o.addTable(t.name,t.dataSourceOption)).BEt=!0,n.fromJSON(t)}));for(this.relationships=[],r=0,a=i=t.relationships;r<a.length;r++)s=n[(u=a[r]).sourceTableName],c=n[u.targetTableName],this.addRelationship(s,u.sourceFieldName,u.sourceRelationshipName,c,u.targetFieldName,u.targetRelationshipName);return t.queries&&(this.queries=t.queries),e},n.DataManager=v,n.isView=m},"./dist/src/dataSource/dataReader/basicReader.js":function(t,n,e){"use strict";var r,o,i;function a(t){var n,e,i,t,n=this;n.LEt=t,(0,r.isNullOrUndefined)(t)||(n.Pq=t.Pq,e=t.dataPath,i=t.countPath,t=t.parse,(0,r.isFunction)(e)?n.FEt=e:n.FEt=function(t){return(0,r.isString)(e)&&e?(0,r.q$)(t,e):t},(0,r.isFunction)(i)?n.PEt=i:n.PEt=function(t){return(0,r.isString)(i)&&i?parseInt((0,r.q$)(t,i),10):o},(0,r.isFunction)(t)&&(n.parse=t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BasicReader=void 0,r=e("./dist/src/dataSource/utils.js"),o=void 0,a.prototype.parse=function(t){return this.GEt=t,Promise.resolve(t)},a.prototype.read=function(t){return Promise.resolve(this.FEt(t))},a.prototype.readSync=function(t){return this.FEt(t)},a.prototype.total=function(t){return this.PEt(t)},n.BasicReader=a},"./dist/src/dataSource/dataReader/columnJsonReader.js":function(t,n,e){"use strict";var i,r,l,o,a,u;function s(t){var n,c,f,n=u.call(this,t)||this,c=n,f=t.dataPath;return(0,l.isFunction)(f)?c.FEt=f:c.FEt=function(t){var n,e,i,r,o,a,u,s;for(t=(0,l.isString)(f)?(0,l.q$)(t,f):t,n=c.Pq=c.Pq||(0,l.keys)(t),e=c.GEt=[],i=t[n[0]].length,r=0;r<i;r++){for(o={},a=0,u=n;a<u.length;a++)o[s=u[a]]=t[s][r];e.push(o)}return e},n}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnJsonReader=void 0,r=e("./dist/src/dataSource/dataReader/basicReader.js"),l=e("./dist/src/dataSource/utils.js"),u=r.BasicReader,i(s,u),s.prototype.parse=function(r){var o=this;return new Promise(function(t,n){var e,i;(0,l.isNullOrUndefined)(r)&&n("value cannot be null or empty"),e=o.Pq=o.Pq||(0,l.keys)(r),(i=(0,l.reduce)(e,function(t,n){return t&&(0,l.isArray)(r[n])},!0))||n("The value of each property in column JSON should be an array"),t(r)})},n.ColumnJsonReader=s},"./dist/src/dataSource/dataReader/csvReader.js":function(t,n,e){"use strict";var i,r,h,o,a,u;function s(t){var n=u.call(this,t)||this;return n.UEt=t.delimiter||['"'],n.HEt=t.separator||",",n}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CsvReader=void 0,r=e("./dist/src/dataSource/dataReader/basicReader.js"),h=e("./dist/src/dataSource/utils.js"),u=r.BasicReader,i(s,u),s.prototype.parse=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,n=this,e=n.UEt,i=n.HEt,r=t.split(""),o=0,a=r.length,u=[];o<a;){for(f=[];o<a&&"\r"!==r[o]&&"\n"!==r[o];){if(s=c=o,-1<(0,h.indexOf)(e,r[o])){for(s=c=++o;o<a;){if(-1<(0,h.indexOf)(e,r[o])){if(-1===(0,h.indexOf)(e,r[o+1]))break;r[++o]=""}c=++o}for(-1<(0,h.indexOf)(e,r[o])&&++o;o<a&&"\r"!==r[o]&&"\n"!==r[o]&&i!==r[o];)++o}else for(;o<a&&"\r"!==r[o]&&"\n"!==r[o]&&i!==r[o];)c=++o;f.push(r.slice(s,c).join("")),i===r[o]&&++o}"\r"!==r[o]&&"\n"!==r[o]||++o,0<f.length&&u.push(f)}return l=u.shift(),n.GEt=(0,h.isNullOrUndefined)(n.Pq)?(0,h.map)(u,function(t){return(0,h.zipObject)(l,t)}):(0,h.map)(u,function(t){return(0,h.pick)((0,h.zipObject)(l,t),n.Pq)}),n.Pq=n.Pq||l,Promise.resolve(n.GEt)},n.CsvReader=s},"./dist/src/dataSource/dataReader/jsonReader.js":function(t,n,e){"use strict";var i,e,r,o,a;function u(t){return a.call(this,t)||this}i=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.JsonReader=void 0,e=e("./dist/src/dataSource/dataReader/basicReader.js"),a=e.BasicReader,i(u,a),n.JsonReader=u},"./dist/src/dataSource/dataReader/xmlReader.js":function(t,n,e){"use strict";var i,r,o,a,u,s;function c(t){var e,i,r,e=s.call(this,t)||this,i=e,r=t.dataPath;return(0,o.isFunction)(r)?i.FEt=r:i.FEt=function(t){var n;return t=(0,o.isString)(r)?(0,o.q$)(t,r):t,(0,o.isNullOrUndefined)(t)||((n=i.Pq)?t=t.map(function(t){return(0,o.pick)(t,n)}):e.Pq=(0,o.keys)(t[0])),t},e}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.XmlReader=void 0,r=e("./dist/src/dataSource/dataReader/basicReader.js"),o=e("./dist/src/dataSource/utils.js"),s=r.BasicReader,i(c,s),c.prototype.parse=function(t){var n,t,t,n,t=(new DOMParser).parseFromString(t.trim(),"text/xml"),t=this.documentToJSObject(t);return Promise.resolve(t)},c.prototype.documentToJSObject=function(t){for(var n,e,i,r,n={},e=t.children,i=0,r=e.length;i<r;i++)this.elementToJSObject(e[i],n);return n},c.prototype.elementToJSObject=function(t,n){var e,i,r,o,a,u,s,c,e=t.children,i=e.length,r=t.nodeName;if(0===i)n[r]=t.textContent;else{for(o={},void 0!==(a=n[r])?Array.isArray(a)?n[r].push(o):n[r]=[a,o]:n[r]=o,u=t.attributes,s=0;s<u.length;s++)o[(c=u[s]).nodeName]=c.nodeValue;for(s=0;s<i;s++)this.elementToJSObject(e[s],o)}},n.XmlReader=c},"./dist/src/dataSource/dataSource.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/dataSource/dataSource.js"),n),r(e("./dist/src/dataSource/dataSource.interface.js"),n),r(e("./dist/src/dataSource/utils.js"),n)},"./dist/src/dataSource/dataSource.interface.js":function(t,n){"use strict";var e,i,r,o,a,u,u,u,u,u;Object.defineProperty(n,"__esModule",{value:!0}),n.TriggerWhenType=n.FrameExcludeTies=n.FrameExcludeGroup=n.FrameExcludeCurrentRow=n.FrameExcludeNoOthers=n.OrderDesc=n.OrderAsc=n.WindowOverFrameExcludeMode=n.WindowOverFrameType=n.WindowOverFrameFollowing=n.WindowOverFramePreceding=void 0,(u=e=n.WindowOverFramePreceding||(n.WindowOverFramePreceding={}))[u.UnBounded=-2]="UnBounded",u[u.NPreceding=-1]="NPreceding",u[u.CurrentRow=0]="CurrentRow",(u=i=n.WindowOverFrameFollowing||(n.WindowOverFrameFollowing={}))[u.UnBounded=2]="UnBounded",u[u.NFollowing=1]="NFollowing",u[u.CurrentRow=0]="CurrentRow",(u=r=n.WindowOverFrameType||(n.WindowOverFrameType={}))[u.ROWS=0]="ROWS",u[u.RANGE=1]="RANGE",u[u.GROUPS=2]="GROUPS",(u=o=n.WindowOverFrameExcludeMode||(n.WindowOverFrameExcludeMode={}))[u.none=0]="none",u[u.current=1]="current",u[u.group=2]="group",u[u.ties=3]="ties",n.OrderAsc="ASC",n.OrderDesc="DESC",n.FrameExcludeNoOthers="none",n.FrameExcludeCurrentRow="current",n.FrameExcludeGroup="group",n.FrameExcludeTies="ties",(u=a=n.TriggerWhenType||(n.TriggerWhenType={})).onNew="onNew",u.onNewAndUpdate="onNewAndUpdate"},"./dist/src/dataSource/dataSource.js":function(F,d,t){"use strict";var n,v,e,i,r,c,o,a,u,s,b,f,m,w,h,g,p,y,M,l,C,L,S,B,T,A;function I(t){return"".concat(C).concat(t)}function x(t){return"string"==typeof t&&-1<t.indexOf(C)}function N(t){return x(t)?w:t}function P(t,n){var e=n;return"odata"!==t&&"odata4"!==t||!n.value?"graphql"!==t&&"rest"!==t||!n.data||(e=n.data):e=n.value,e}function k(t,n){var e,i,r,e={};for(i in t)t.hasOwnProperty(i)&&(r=n[i],e[i]=(0,b.isNullOrUndefined)(r)?t[i]:r);return e}function _(t,n,e,i,r){var o,a,u,s,c,f,l;for("string"==typeof e?o=a=e:(o=e.childrenField1||"children",a=e.childrenField2||"children"),u=t[o]||[],s=n[a]||[],c=0;c<u.length;c++)f=u[c],l=s[c],i&&i(f,l,t,n),_(f,l,e,i,r),r&&r(f,l,t,n)}function D(t,n){var e,i,r,o,a;if((0,b.isNullOrUndefined)(t)||(0,b.isNullOrUndefined)(n))return t===n;if(e=(0,b.keys)(t),i=(0,b.keys)(n),e.length===i.length){for(r=0,o=e;r<o.length;r++)if(t[a=o[r]]!==n[a])return;return 1}}function j(t,n){for(var e,i,r,o,e=[],i=0;i<n;i++){for(o in r={},t)t.hasOwnProperty(o)&&(r[o]=t[o].data[i]);e[i]=r}return e}function O(t){return"xml"===t?"xml":"csv"===t?"text":"json"}function G(t){var n,n,t,e,e,e,e,e,n=null==(n=t.schema)?void 0:n.type,t=t.remote;n&&t&&((e=t.read)&&"object"==typeof e&&(e.dataType=O(n)),(e=t.update)&&"object"==typeof e&&(e.dataType=O(n)),(e=t.delete)&&"object"==typeof e&&(e.dataType=O(n)),(e=t.create)&&"object"==typeof e&&(e.dataType=O(n)),e=t.batch)&&"object"==typeof e&&(e.dataType=O(n))}function U(){}function E(t){var n,e,n=A.call(this)||this;return n.R1t=[],(e=n)._data=t.data,e.zEt=t.isRoot,e.VEt=t.getData,e.YEt=t.getFieldData,e.ZEt=t.idField,e.WEt=!(0,b.isNullOrUndefined)(t.idField),e.QEt=t.sequenceField,e.KEt=!(0,b.isNullOrUndefined)(t.sequenceField),Object.defineProperty(e,"data",{get:function(){return e.VEt(e.lp)}}),Object.defineProperty(e,"isRoot",{get:function(){return e.zEt}}),Object.defineProperty(e,"id",{get:function(){var t;return e.WEt?(t=e.YEt(e.ZEt,e.lp),(0,b.isNullOrUndefined)(t)?t=e._id:e._id!==t&&(e._id=t),t):e._id},set:function(t){e._id=t,(0,b.isNullOrUndefined)(e.JEt)&&(e.JEt=t)}}),Object.defineProperty(e,"parentId",{get:function(){return(0,b.isNullOrUndefined)(e.parent)?w:e.parent.id}}),Object.defineProperty(e,"parent",{get:function(){return e.sft},set:function(t){e.setParent(t),(0,b.isNullOrUndefined)(e.XEt)&&!(0,b.isNullOrUndefined)(t)&&(e.XEt=t.id)}}),Object.defineProperty(e,"level",{get:function(){return e.YAt},set:function(t){e.YAt=t}}),Object.defineProperty(e,"children",{get:function(){return e.R1t},set:function(t){e.R1t=t}}),Object.defineProperty(e,"sequence",{get:function(){return e.KEt?e.YEt(e.QEt,e.lp):e.qEt},set:function(t){e.qEt=t,(0,b.isNullOrUndefined)(e.$Et)&&(e.$Et=t)}}),n}function R(t){this.tjt={},this.njt=[],this.ejt=!0,this.Mue=!1;var n=this;Object.defineProperty(this,"options",{get:function(){return n.LEt},set:function(t){n.setDataSourceOptions(t)}}),n._events={},n.options=v({data:m,batch:!1},t),this.ijt(t.remote,t.data),n.bind([h,p,y,d.ONCHANGE,g],t),this.rjt(t.schema),n.ajt()}n=this&&this.__extends||(T=function(t,n){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}T(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),v=this&&this.__assign||function(){return(v=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(d,"__esModule",{value:!0}),d.DataSource=d.HierarchyNode=d.ONCHANGE=d.DELETE=d.UPDATE=d.INSERT=d.CREATE=void 0,e=t("./dist/src/dataSource/dataSource.interface.js"),i=t("./dist/src/dataSource/dataTransport/localDataTransport.js"),r=t("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),c=t("./dist/src/dataSource/event.js"),o=t("./dist/src/dataSource/dataReader/jsonReader.js"),a=t("./dist/src/dataSource/dataReader/columnJsonReader.js"),u=t("./dist/src/dataSource/dataReader/csvReader.js"),s=t("./dist/src/dataSource/dataReader/xmlReader.js"),b=t("./dist/src/dataSource/utils.js"),f=t("Common"),m=null,w=void 0,d.CREATE="create",d.INSERT="insert",d.UPDATE="update",d.DELETE="delete",h="onBeforeSend",g="onFailed",p="onBeforeEnd",y="onReady",M="user cancel the request at step ",d.ONCHANGE="onChange",l=Number.NaN,C="__HIERARCHY__",n(E,A=U),E.prototype.sjt=function(){return this.qEt},E.prototype.setParent=function(t,n){var e=!(0,b.isNullOrUndefined)(this.parent);e&&this.parent.cjt(this),this.sft=t,(0,b.isNullOrUndefined)(t)?e&&(this.level=l):(this.level=t.level+1,(0,b.isNullOrUndefined)(n)?t.fjt(this):t.ljt(this,n))},E.prototype.updateChildrenLevel=function(){var n=this.level;this.children.forEach(function(t){t.level=n+1,t.updateChildrenLevel()})},E.prototype.promote=function(t){this.setParent(t,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},E.prototype.demote=function(n,t){this.parent=n,(t=!1!==t)?this.updateChildrenLevel():this.children.forEach(function(t){t.parent=n})},E.prototype.getCurrentIndex=function(){return this.parent&&this.parent.children.indexOf(this)},E.prototype.getPrevSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()-1]},E.prototype.getNextSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()+1]},E.prototype.ljt=function(t,n){this.children.splice(n,0,t)},E.prototype.fjt=function(t){this.children.push(t)},E.prototype.cjt=function(t){var t=this.children.indexOf(t);this.children.splice(t,1)},E.prototype.getChildrenIndexes=function(t){var n=[];return(0,b.traversalTree)(this,{invoked:function(t){n.push(t.lp)}},t?function(t){return-t.sequence}:w),n},E.prototype.getChildrenCount=function(){var t=0;return(0,b.traversalTree)(this,{invoked:function(){t++}}),t},E.prototype.getFieldValue=function(t){return this.YEt(t,this.lp)},S=E,d.HierarchyNode=S,R.prototype.setDataSourceOptions=function(t,n){var e,i,r,o,a,i,u,i,s,e=this;G(t),i=e.LEt,e.LEt=t,a=(r=i&&i.remote&&i.remote.read&&i.remote.read.url)!==(o=t&&t.remote&&t.remote.read&&t.remote.read.url),e.ijt(t.remote,t.data),i=i&&i.schema,u=t&&t.schema,(i=i&&u&&(i.type!==u.type||i.dataPath!==u.dataPath||i.countPath!==u.countPath))&&e.rjt(t.schema),(s=e.ojt)&&(a||i)&&(e.ajt(),e.load().then(function(){n&&n()}).catch(function(){n&&n()}))},R.prototype.ijt=function(t,n){this.hjt=t?new r.RemoteDataTransport(t):new i.LocalDataTransport({data:n||[]})},R.prototype.rjt=function(t){var n,e;"json"===(e=(t=t||{}).type||"json")?n=new o.JsonReader(t):"columnJson"===e?n=new a.ColumnJsonReader(t):"csv"===e?n=new u.CsvReader(t):"xml"===e&&(n=new s.XmlReader(t)),this.djt=n},R.prototype.ajt=function(){this._data={},this.vjt=0,this.DEt=[]},R.prototype.mjt=function(t,n,e){var i,r,o,a,u,i=this,r={};for(o in i._data)i._data.hasOwnProperty(o)&&(a=i._data[o],0!==n?(u=a.data.splice(t,n),r[o]={data:u}):t>=a.data.length?a.data[t]=e[o]:a.data.splice(t,0,e[o]));return i.vjt=i.vjt-n,e&&i.vjt++,j(r,n)},R.prototype.gjt=function(t,n){var e,i,r,o,e=this,i={};for(r in e._data)e._data.hasOwnProperty(r)&&(o=e._data[r],i[r]={data:o.data.slice(t,n)});return j(i,n-t)},R.prototype.pjt=function(t,n,e){var i,r;if(!(0,b.isNullOrUndefined)(n))if(i=this,e)for(r in n)Object.prototype.hasOwnProperty.call(i._data,r)&&(i._data[r].data[t]=n[r]);else for(r in i._data)i._data.hasOwnProperty(r)&&(i._data[r].data[t]=n[r])},R.prototype.bjt=function(t){var n,e,i,n=this,e={};for(i in n._data)n._data.hasOwnProperty(i)&&(e[i]=n._data[i].data[t]);return e},R.prototype.yjt=function(t){var t,n,e;return!(!t||!t.reload)||(n=(t=this).wjt,0===(e=t.vjt))||((0,b.isNullOrUndefined)(n),!1)},R.prototype.Mjt=function(t,n){var e,i,e=this.tjt;return e[t]||(i=void 0,n?i=f.Common.ct.yU(t,n):(i=f.Common.ct.dJ(t),(0,b.isNullOrUndefined)(i)&&(i=new Date(t)),isNaN(i)&&(i=new Date(t.replace(" ","T")))),e[t]=i),e[t]},R.prototype.Cjt=function(t,n){return n?0===n.split("|").indexOf(t):!!t},R.prototype.Sjt=function(t,n){return+(t=(t=n?t.replace(n,"."):t).replace(/,/g,""))||0},R.prototype.Nbe=function(t){return t.toString()},R.prototype.Tjt=function(t,n,e,i){var r=t;return"rowOrder"===n?t:(i&&n&&"boolean"!==n&&(r+=""),"date"===n?"NULL"===r||""===r?null:this.Mjt(r,e):"boolean"===n?this.Cjt(r,e):"number"===n?this.Sjt(r,e):"string"===n?this.Nbe(r):t)},R.prototype.Ajt=function(t,n){var e="number"==typeof t;return(0,b.isNullOrUndefined)(n)||(0,b.isNullOrUndefined)(t)||"string"!=typeof t&&!e?t:this.Tjt(t,n.dataType,n.dataPattern,e)},R.prototype.Ijt=function(t,n){var e,i,r,o;for(e in t)t.hasOwnProperty(e)&&(i=t[e])&&(o="number"==typeof(r=n[e]),(0,b.isNullOrUndefined)(r)||"string"!=typeof r&&!o||(n[e]=this.Tjt(r,i.dataType,i.dataPattern,o)))},R.prototype.xjt=function(t,n,e){for(var i,r,o,a,i=this._data[t].data,r=0;r<i.length;r++)a="number"==typeof(o=i[r]),(0,b.isNullOrUndefined)(o)||"string"!=typeof o&&!a||(i[r]=this.Tjt(o,n,e,a));this.isHierarchy()&&"rowOrder"===n&&(this.ejt=!0)},R.prototype.Njt=function(t,n){var e,i;t===n||(0,b.isNullOrEmpty)(n)||((e=this)._data[n]=e._data[t],delete e._data[t],i=e.kjt(t),e.Djt(t,(0,b.isNullOrEmpty)(i)?t:i,n))},R.prototype.kbe=function(){var t,n,e,i,n=this,e=null==(t=n.LEt.schema)?void 0:t.columns;if(e)for(i in e)if(n._be(e[i].trigger))return!0;return!1},R.prototype._be=function(t){var n=this;return t&&t.formula&&(0,b.isFormula)(t.formula)&&(t.when===e.TriggerWhenType.onNew||t.when===e.TriggerWhenType.onNewAndUpdate&&!(0,b.isNullOrEmpty)(t.fields)&&(-1<t.fields.indexOf("*")||t.fields.split(",").map(function(t){return t.trim()}).every(function(t){return-1<n.DEt.indexOf(t)})))},R.prototype.Dbe=function(t){var n,n,e,t,e=this,t=null==(n=null==(n=e.LEt.schema)?void 0:n.columns[t])?void 0:n.trigger;if(e._be(t))return t},R.prototype.jbe=function(t){var n,e,i,r,o,a,e=this,r=null==(n=e.LEt.schema)?void 0:n.columns;if(!(0,b.isNullOrUndefined)(r))for(o in r)!r.hasOwnProperty(o)||!(a=e.Dbe(o))||t&&t!==a.when||((i=i===w?{}:i)[o]=a);return i},R.prototype.gCe=function(t){var n,n,n,e,e;return"formula"===(null==(n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t])?void 0:n.dataType)},R.prototype.Obe=function(){var t,n,e,i,r,o,t,n=this.LEt.schema,i={};if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(n.columns))for(r in e=n.columns)e.hasOwnProperty(r)&&"formula"===(o=e[r]).dataType&&(i[r]=o.value);return i},R.prototype.Ebe=function(t){var n,n,n,n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t];return"formula"===(null==n?void 0:n.dataType)&&(null==n?void 0:n.value)},R.prototype.kjt=function(t){var n,e=this.LEt.schema,i,e,r;if(!((0,b.isNullOrUndefined)(e)||(0,b.isNullOrUndefined)(e.columns)||(e=(i=e.columns)[t],(0,b.isNullOrUndefined)(e))||(r=e.dataName,(0,b.isNullOrEmpty)(r))))return r},R.prototype.Djt=function(t,n,e){var i=this,r=i.LEt.schema,i,r;(0,b.isNullOrUndefined)(r)&&(i.LEt.schema=r={}),i=r.columns,(0,b.isNullOrUndefined)(i)&&(r.columns=i={}),r=i[t],(0,b.isNullOrUndefined)(r)&&(i[t]=r={}),(0,b.isNullOrEmpty)(r.dataName)&&(r.dataName=n),(0,b.isNullOrEmpty)(e)||(i[e]=i[t],delete i[t])},R.prototype.Rbe=function(t){var n,e,i,r,o,n=this,e,i=n.Bjt()[1];for(r in t)o=t[r],t[r]=n.Ajt(o,i[r])},R.prototype._jt=function(t){var n=this;return t=n.Ejt(t,{isServerToClient:!0}),n.Rbe(t),t},R.prototype.jjt=function(t){var n=this;return t=(0,b.clone)(t,!0),n.Ojt(t),t=n.Ejt(t)},R.prototype.Ejt=function(t,n){var e,i,r,n,o,a,u,i=(e=this).LEt.schema,r=(n=n||{}).isServerToClient,n=n.isClone;if(!(0,b.isNullOrUndefined)(t)&&!(0,b.isNullOrUndefined)(i)&&!(0,b.isNullOrUndefined)(i.columns)){for(u in o=i.columns,a=[],o)(0,b.isNullOrUndefined)(o[u].dataName)||o[u].dataName===u||a.push(r?[o[u].dataName,u]:[u,o[u].dataName]);0<a.length&&(t=n?(0,b.clone)(t,!0):t,(0,b.isArray)(t)?t.forEach(function(t){e.Rjt(a,t)}):(0,b.isObject)(t)&&e.Rjt(a,t))}return t},R.prototype.Rjt=function(t,e){t.forEach(function(t){var n=t[0],t=t[1];e[t]=e[n],delete e[n]})},R.prototype.Bjt=function(){var t,n,e,i,r,o,t,n=this.LEt.schema;if((0,b.isNullOrUndefined)(n)||(0,b.isNullOrUndefined)(n.columns))return[{},{}];for(o in i={},r={},e=n.columns)e.hasOwnProperty(o)&&((0,b.isNullOrUndefined)(e[o].dataName)||(i[e[o].dataName]=o),e[o].dataType||e[o].dataPattern)&&(r[o]={dataType:e[o].dataType,dataPattern:e[o].dataPattern});return[i,r]},R.prototype.Ljt=function(){var t,n,e,i,r,o,t,n=this.LEt.schema,e=[];if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(n.columns))for(r in i=n.columns)i.hasOwnProperty(r)&&(o=i[r]).isPrimaryKey&&e.push(r);return e},R.prototype.Ojt=function(t){var n,e,n,i,n=this;!(0,b.isNullOrUndefined)(t)&&n.isHierarchy()&&"Level"===n.Fjt()&&(e=n.Pjt(),(0,b.isNumber)(e))&&(i=t[n=n.Gjt()],t[n]=i-e)},R.prototype.Ujt=function(e){var t,n;return this.njt.map(function(t,n){t.lp=n,e||(t.sequence=n+1);var n=t._data;return t._data=w,n})},R.prototype.Hjt=function(t){var n=this,e=n.zjt,i=n.njt=[];return(0,b.traversalTree)(e,function(t){t.level=t.parent.level+1,i.push(t)},t?{isOrderChildren:!0,getValue:function(t){return t.qEt}}:w),n.Ujt(t)},R.prototype.Vjt=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,o=this,a=!(0,b.isNullOrEmpty)(i),u=n,s=i;for(n=o.Yjt(n),e=o.Yjt(e),i=o.Yjt(i),c={},f=0;f<t.length;f++)l=t[f],h=new S(o.Zjt({data:l,idField:u,sequenceField:s})),d=l[n],c[h.id=d]=h,a&&(h.sequence=l[i]);for((v=new S({isRoot:!0})).level=r-1,f=0;f<t.length;f++)d=t[f][n],m=t[f][e],h=c[d],(0,b.isNullOrUndefined)(g=c[m])?(v.id=m,h.parent=v):h.parent=g;return o.zjt=v,o.Hjt(a)},R.prototype.Wjt=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,o=this,a=!(0,b.isNullOrEmpty)(i),u=n,s=i;for(n=o.Yjt(n),e=o.Yjt(e),i=o.Yjt(i),c=w,f=0;f<t.length;f++)((l=t[f][e])<c||c===w)&&(c=l);for(c===w&&(c=0),(h=o.zjt=new S({isRoot:!0})).level=c+r-1,d=[h],f=0;f<t.length;f++){for(v=t[f],m=new S(o.Zjt({data:v,idField:u,sequenceField:s})),g=(0,b.isNullOrEmpty)(n)?I(f):v[n],l=v[e]+r,m.id=g,a&&(m.sequence=v[i]),p=d[d.length-1];p.level>=l;)p=d.pop().parent;m.parent=p,d.push(m)}return o.Hjt(a)},R.prototype.Qjt=function(t,e,n,i,r){var r,o,a,u,s,c,f,l,o=this,a=o.njt=[],u=!(0,b.isNullOrEmpty)(i),s=e,c=i;return e=o.Yjt(e),n=o.Yjt(n),i=o.Yjt(i),(f=o.zjt=new S({isRoot:!0})).level=r-1,l=[f],(0,b.traversalTree)(((r={})[n]=t,r),{invoking:function(t){var n=new S(o.Zjt({data:t,idField:s,sequenceField:c}));n.id=(0,b.isNullOrEmpty)(e)?I(a.length):t[e],u&&(n.sequence=t[i]),n.parent=l[l.length-1],a.push(n),l.push(n)},invoked:function(){l.pop()}},u?i:w,n),o.Ujt(u)},R.prototype.Kjt=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,p,a=this,u=!(0,b.isNullOrEmpty)(r),s=n,c=r;for(n=a.Yjt(n),e=a.Yjt(e),r=a.Yjt(r),f={},l=0;l<t.length;l++)h=t[l],d=new S(a.Zjt({data:h,idField:s,sequenceField:c})),v=h[e],d.id=(0,b.isNullOrEmpty)(n)?I(l):h[n],f[v]=d,u&&(d.sequence=h[r]);for(m=a.Bjt(),(g=new S({isRoot:!0})).level=o-1,l=0;l<t.length;l++)d=f[v=t[l][e]],p=i(a.Jjt(t[l],m,l)),(0,b.isNullOrUndefined)(p=f[p])?d.parent=g:d.parent=p;return a.zjt=g,a.Hjt(u)},R.prototype.Jjt=function(a,e,t){var u=this,t={index:t};return Object.defineProperty(t,"data",{get:function(){var i,r,o,t,n,i=e[0],r=e[1],o={},t=function(t){var n,e;a.hasOwnProperty(t)&&(n=a[t],e=i[t]||t,Object.defineProperty(o,e,{get:function(){return u.Ajt(n,r[e])}}))};for(n in a)t(n);return o}}),t},R.prototype.Zjt=function(t){var n=this;return{data:t.data,idField:t.idField,sequenceField:t.sequenceField,getData:n.bjt.bind(n),getFieldData:n.Xjt.bind(n)}},R.prototype.qjt=function(t){var n,e,i,r,n,o,a,u,s,c,f,l,h,r,e=this,i=e.LEt.schema;return e.isHierarchy()&&(r=i.hierarchy.type.trim(),n=null==(n=i.hierarchy.column)?void 0:n.trim(),o=i.hierarchy.levelOffset||0,a=e.Ljt(),u=e.$jt(t),"Parent"===r?(s=a[0],t=e.Vjt(t,s,n,u,o)):"Level"===r?(s=a[0],t=e.Wjt(t,s,n,u,o)):"ChildrenPath"===r?(s=a[0],t=e.Qjt(t,s,n,u,o)):"Custom"===r&&(s=a[0],r=i.hierarchy.parse,t=e.Kjt(t,s,n,r,u,o)),e.t7t(),e.ejt=!1),t},R.prototype.t7t=function(){var t,n,e,i,r,t=this,n=t.$jt(),e=t.njt.slice();for((0,b.isNullOrEmpty)(n)||e.sort(function(t,n){return t.sjt()-n.sjt()}),i=0;i<e.length;i++)(r=e[i]).prev=e[i-1],r.next=e[i+1]},R.prototype.$jt=function(t){var n,e,i,r,o,n=this,e=n.LEt.schema;if(!(0,b.isNullOrUndefined)(e)&&!(0,b.isNullOrUndefined)(e.columns))for(r in i=e.columns)if(Object.prototype.hasOwnProperty.call(i,r)&&"rowOrder"===(o=i[r]).dataType&&(o.n7t||n.e7t(r,t)))return o.n7t=!0,r},R.prototype.e7t=function(t,n){var e,i,r;if(!(0,b.isNullOrUndefined)(t)&&(0,b.isArray)(n)){if(0===n.length)return!0;for(t=(e=this).Yjt(t),i=0;i<n.length;i++)if(r=n[i][t],!(0,b.isNullOrUndefined)(r))return(0,b.isNumber)(r)}},R.prototype.qX=function(){var t=this;return!(!t.isHierarchy()||"Parent"===t.Fjt()&&(0,b.isNullOrUndefined)(t.$jt()))},R.prototype.i7t=function(){return this.options.schema.hierarchy.summaryFields},R.prototype.Pjt=function(){return this.options.schema.hierarchy.levelOffset},R.prototype.r7t=function(){return this.options.schema.hierarchy.unparse},R.prototype.Gjt=function(){return this.options.schema.hierarchy.column},R.prototype.Fjt=function(){return this.options.schema.hierarchy.type},R.prototype.o7t=function(){var t,n;return this.Ljt()[0]},R.prototype.isHierarchy=function(){var t,t,n,n=this.options.schema;return!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(n.hierarchy)&&!(0,b.isNullOrUndefined)(null==(t=n.hierarchy.type)?void 0:t.trim())&&!(0,b.isNullOrUndefined)(null==(t=n.hierarchy.column)?void 0:t.trim())&&("Custom"!==n.hierarchy.type||(0,b.isFunction)(n.hierarchy.parse)&&(0,b.isFunction)(n.hierarchy.unparse))},R.prototype.a7t=function(){return this.ejt},R.prototype.u7t=function(){this.ejt=!0},R.prototype.SEt=function(t){var n=this;return t=n.s7t(t),n.c7t(t)},R.prototype.c7t=function(t){var n,e;return this.njt[t]},R.prototype.f7t=function(){return this.zjt},R.prototype.l7t=function(t){var n,e=this.i7t();if(!(0,b.isNullOrUndefined)(e))return e[t]},R.prototype.h7t=function(t,n){var e,t,e,e=this,t=e.l7t(t);if(!(0,b.isNullOrEmpty)(t)&&(e=e.SEt(n),!(0,b.isNullOrUndefined)(e))&&0<e.children.length)return t},R.prototype.Yjt=function(t){var n,e,i,r,n,e=this.LEt.schema;if(!(0,b.isNullOrUndefined)(e)&&!(0,b.isNullOrUndefined)(e.columns))for(r in i=e.columns)if(r===t)return i[r].dataName||t;return t},R.prototype.d7t=function(t,n,e){var i=this;return i.v7t(e,(0,b.isNumber)(t)?i.s7t(t):t,i.s7t(n))},R.prototype.v7t=function(t,n,e){var i=this,r=i.njt,o=i.$jt(),a,u=function(t){return i.isHierarchy()?i.njt[t].sequence:i._data[o].data[t]};return t?(n=r[e].next&&r[e].next.lp,(0,b.isNullOrUndefined)(n)?(a=u(e),Math.floor(a)===a?a+=.5:a=(a+Math.ceil(a))/2):a=(u(e)+u(n))/2):(n=r[e].prev&&r[e].prev.lp,a=(0,b.isNullOrUndefined)(n)?(a=u(e))<=1?a/2:a-.5:(u(n)+u(e))/2),a},R.prototype.Cue=function(){return this.Mue},R.prototype.Sue=function(t){this.Mue=t},R.prototype.m7t=function(t,n,e,i){var r,o,a,u,s,c,n,f,l,c,h,d,c,r,o,d,h,a=this,u=a.$jt(),s=a.isHierarchy();if((0,b.isNullOrUndefined)(u)&&!s||n===e||(0,b.isNullOrUndefined)(n)||(0,b.isNullOrUndefined)(e))return!1;if(e=a.s7t(e),i=(0,b.isNumber)(i)?a.s7t(i):i,n=a.s7t(n),l=(f=a.njt)[n],c=f[e],s){if(c.parent!==l.parent)return!1;r=0,(t=(d=(h=l.parent.children).indexOf(l))<(c=h.indexOf(c)))?(r=null==(o=l.getNextSibling())?void 0:o.lp,h.splice(c+1,0,l),h.splice(d,1)):(r=n,h.splice(d,1),h.splice(c,0,l)),"Custom"===a.Fjt()&&a.g7t(r),!(0,b.isNullOrUndefined)(i)&&(o=f[i],d=l.parent===o,h=l.parent.parent===o.parent,d||h)&&(i=w)}return c=a.v7t(t,i,e),s&&(0,b.isNullOrUndefined)(u)&&(l.sequence=c),a.p7t(t,e,n),a.b7t(n,((r={})[u]=c,r)),!0},R.prototype.p7t=function(t,n,e){var i,r,e,i,i=this,r;i.isHierarchy()&&(e=i.c7t((0,b.isNumber)(e)?e:i.njt.length-1),i=i.c7t(n),(0,b.isNullOrUndefined)(e.prev)||(e.prev.next=e.next),(0,b.isNullOrUndefined)(e.next)||(e.next.prev=e.prev),t?(e.prev=i,e.next=i.next,(0,b.isNullOrUndefined)(i.next)||(i.next.prev=e),i.next=e):(e.next=i,e.prev=i.prev,(0,b.isNullOrUndefined)(i.prev)||(i.prev.next=e),i.prev=e))},R.prototype.y7t=function(t,n){var e,i,r,e=this,i;if(e.isHierarchy())for(n=n||1,r=0;r<n;r++)e.w7t(r+t)},R.prototype.w7t=function(t){var n,t=this.c7t(t);(0,b.isNullOrUndefined)(t.prev)||(t.prev.next=t.next),(0,b.isNullOrUndefined)(t.next)||(t.next.prev=t.prev)},R.prototype.M7t=function(t){var n,e,e,i,r,o,a,u,r,n,s,c,f,l;if(this.isHierarchy()&&(r=(i=this).njt,o=i.Gjt(),!(a=r[t=i.s7t(t)]).parent.isRoot)){for(u=i.Fjt(),r=a.parent.children.slice(a.getCurrentIndex()+1),n=a.parent.parent,a.promote(n),"Parent"===u?i.b7t(t,((n={})[o]=N(a.parentId),n)):"Level"===u&&i.C7t(t),s=0,c=r;s<c.length;s++)(f=c[s]).parent=a,l=f.lp,"Parent"===u?i.b7t(l,((e={})[o]=a.id,e)):"Level"===u&&i.b7t(l,((e={})[o]=f.level,e));"Custom"===u&&i.g7t(t)}},R.prototype.S7t=function(t,n){this.T7t(t,n)},R.prototype.T7t=function(t,n,e){var n,n,n,i,r,o,a,e,u,e;this.isHierarchy()&&(n=!1!==n,r=(i=this).njt,o=i.Gjt(),t=e?t:i.s7t(t),e=(a=r[t]).getPrevSibling(),(0,b.isNullOrUndefined)(e)||(u=a.children.slice(),a.demote(e,n),e=i.Fjt(),n?"Parent"===e?i.b7t(t,((n={})[o]=N(a.parentId),n)):"Level"===e?i.C7t(t):"Custom"===e&&i.g7t(t):"Parent"===e?(i.b7t(t,((n={})[o]=N(a.parentId),n)),u.forEach(function(t){var t;i.b7t(t.lp,((t={})[o]=N(a.parentId),t))})):"Level"===e?i.b7t(t,((n={})[o]=r[t].level,n)):"Custom"===e&&i.g7t(t)))},R.prototype.b7t=function(t,n,e,i){this.A7t(t,n,e,i)},R.prototype.A7t=function(t,n,e,i){var r;this.I7t({action:d.UPDATE,index:t,item:n,x7t:!0,N7t:!0}),e&&e({type:d.UPDATE,success:!0})},R.prototype.C7t=function(t,n,e){for(var i,r,o,a,u,s,c,r=this,o=r.njt,a=r.Gjt(),u=o[t].getChildrenIndexes().concat(t),s=0;s<u.length;s++)c=u[s],r.b7t(c,((i={})[a]=o[c].level,i),n,e)},R.prototype.g7t=function(i,r,o){var a=this,u=!1,s=a.Gjt();(0,b.traversalTree)(a.zjt,function(t){var n,e,n,t;(u=i===t.lp?!0:u)&&(n=t.lp,t=a.k7t(t),(0,b.isNullOrUndefined)(t)||a.b7t(n,((n={})[s]=t,n),r,o))})},R.prototype.k7t=function(t){var n,e,i,r,e,i,n=this,e=n.Gjt(),i=n.r7t(),r,e=t.data[e],i=i(n.D7t(t));if(e!==i)return i},R.prototype.D7t=function(t){var n={};return Object.defineProperty(n,"data",{get:function(){return t.data}}),Object.defineProperty(n,"index",{get:function(){return t.getCurrentIndex()}}),Object.defineProperty(n,"parentData",{get:function(){return t.parent.isRoot?m:t.parent.data}}),n},R.prototype._7t=function(t,n,e){var i=this,t=i.c7t(t);return i.E7t(t.parent,n?t.getCurrentIndex():t.getCurrentIndex()+1,e)},R.prototype.j7t=function(t){var n=this,t=n.c7t(t),e=t.getPrevSibling(),n,n=(0,b.isNullOrUndefined)(e)?n.v7t(!1,w,t.lp):n.v7t(!1,e.lp,t.lp);return{sequence:n,offset:0}},R.prototype.O7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.j7t(t).sequence,(n=e._7t(t,!0,n)).sequence=i,e.p7t(!1,t),n},R.prototype.R7t=function(t){var n=this,t=n.c7t(t),e=t.getNextSibling(),e,e=(0,b.isNullOrUndefined)(e)?n.v7t(!0,w,t.lp):n.v7t(!0,e.lp,t.lp);return{sequence:e,offset:n.B7t(t)}},R.prototype.L7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.R7t(t).sequence,(n=e._7t(t,!1,n)).sequence=i,e.p7t(!0,t),n},R.prototype.F7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.j7t(t).sequence,(n=e._7t(t,!0,n)).sequence=i,e.T7t(t,!0,!0),e.p7t(!1,t),n},R.prototype.P7t=function(t){var n,t,e,i,e,e,n=this,t=n.c7t(t),e=t.children,e=0<e.length?(e=e[e.length-1],i=n.v7t(!0,w,e.lp),n.B7t(t)):(i=n.v7t(!0,w,t.lp),1);return{sequence:i,offset:e}},R.prototype.G7t=function(t,n){var e,i,n,e=this;return t=e.s7t(t),i=e.P7t(t).sequence,(n=e._7t(t,!1,n)).sequence=i,e.U7t(e.njt.length-1),e.p7t(!0,t),n},R.prototype.U7t=function(t){var n,t,e,n,t=this.c7t(t),e=t.getPrevSibling();(0,b.isNullOrUndefined)(e)||t.demote(e)},R.prototype.E7t=function(t,n,e){var i,r,o,a,a,i,i=this,r=i.njt,o=i.o7t(),a=i.$jt(),a=new S(i.Zjt({idField:o,sequenceField:a})),i=i.vjt+1;return(0,b.isNullOrUndefined)(e)||(0,b.isNullOrUndefined)(e[o])?a.id=I(i):a.id=e[o],a.lp=i-1,a.setParent(t,n),r.push(a),a},R.prototype.Xme=function(t){var n,e,n,n=this,e=this.f7t(),n=n.E7t(e,void 0,t);return n.sequence=1,n},R.prototype.H7t=function(t){var n,e,i,r,o,a,i,n,e,r=this,o=r.$jt(),a=r.Gjt(),i=r.Fjt();return"Parent"===i?((n={})[a]=N(t.parentId),n=n):"Level"===i?((e={})[a]=t.level,n=e):"Custom"===i&&(e=r.k7t(t),(0,b.isNullOrUndefined)(e)||((i={})[a]=e,n=i)),(0,b.isNullOrEmpty)(o)||((n=n||{})[o]=t.sjt()),n},R.prototype.z7t=function(t,n,e){var i,t,r,n,i=this,t=i.SEt(t);return n?(n=t.getNextSibling(),(0,b.isNullOrUndefined)(n)||(r=!1===e?n:t)):r=!1===e?t:t.getPrevSibling(),i.B7t(r)},R.prototype.B7t=function(t){var n,e,i,n=1,e=function(t){return t.children.reduce(function(t,n){return t+e(n)},t.children.length)};return(0,b.isNullOrUndefined)(t)?0:(i=e(t))+1},R.prototype.V7t=function(t){var n=this,t=n.SEt(t);return n.B7t(t)},R.prototype.Y7t=function(t){var n,e,e,n=this;n.isHierarchy()&&(e=n.o7t(),!(0,b.isNullOrUndefined)(e)&&x(t[e])&&(t[e]=w),"Parent"===n.Fjt())&&x(t[e=n.Gjt()])&&(t[e]=w)},R.prototype.Z7t=function(t,n){var e,i,e,r,o,a,u,i=this;i.isHierarchy()&&"Parent"===i.Fjt()&&(e=i.o7t(),(0,b.isNullOrUndefined)(e)||(o=(r=i.c7t(t)).children,a=r.id=r.JEt=i.Xjt(e,t),u=i.Gjt(),o.forEach(function(t){var t;t.XEt=a,i.b7t(t.lp,((t={})[u]=a,t))}),n&&(0,b.isNullOrEmpty)(n[u])&&!r.parent.isRoot&&!x(r.parentId)&&i.b7t(t,((e={})[u]=r.parentId,e))))},R.prototype.Tue=function(t){for(var n,e,i,r,o,n=[],e,i=0,r=(0,b.keys)(t);i<r.length;i++)t[o=r[i]].spread&&n.push(o);return n},R.prototype.Aue=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,i=(0,b.keys)(t);if(0===i.length)return t;for(r={},o=0,a=i;o<a.length;o++)if(s=t[u=a[o]],0<=n.indexOf(u))for(c={},e&&(e[u]=c),h=f=(l=0,b.keys)(s);l<h.length;l++)d=h[l],0<=i.indexOf(d)?(r[u+"_"+d]=s[d],e&&(c[u+"_"+d]=d)):(r[d]=s[d],e&&(c[d]=d));else r[u]=s,e&&(e[u]=u);return r},R.prototype.Iue=function(t,e){var i,n,n,r,i=this,n=i.LEt,n=n&&n.schema&&n.schema.columns;return t=n&&0<(r=i.Tue(n)).length?t.map(function(t,n){return i.Aue(t,r,0===n?e:w)}):t},R.prototype.xue=function(t){var n,e,e,e,n=this,e=n.LEt,e=e&&e.schema&&e.schema.columns;return t=e&&0<(e=n.Tue(e)).length?n.Aue(t,e):t},R.prototype.Nue=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=(0,b.keys)(n);if(0===e.length)return t;for(i={},r=0,o=e;r<o.length;r++)if("object"==typeof(u=n[a=o[r]]))for(i[a]=s={},l=c=(f=0,b.keys)(u);f<l.length;f++)s[u[h=l[f]]]=t[h];else"string"==typeof u&&(i[a]=t[u]);return i},R.prototype.kue=function(t){var n,e,n=this,e=n.Due;return t=e?t&&n.Nue(t,e):t},R.prototype.load=function(c){var f,n,t,l,f=this,n=f.options.remote;return n&&n.read&&!(0,b.isFunction)(n.read)&&(0,b.isNullOrEmpty)(n.read.url)?(f.ki(y,{type:"read",success:!(t="InvalidRemoteOption"),reason:t}),Promise.resolve([])):(l=f.W7t(c),f.yjt(l)?(f.ojt=!0,f.Q7t(l).then(function(t){var t={type:"read",data:n&&n.read&&!(0,b.isFunction)(n.read)?P(n.read.adapter,t):t};return f.ki(p,t)?Promise.reject({cancel:!0,type:"read",step:h}):f.djt.parse(t.data)}).then(function(t){return f.wjt=f.djt.total(t),f.djt.read(t)}).then(function(t){var n,e,i,r,o,a,u,s;if(f._data=(!c||!c.reload)&&f._data||{},f.vjt=f.vjt||0,f.DEt=(!c||!c.reload)&&f.DEt||[],t){for(t=(0,b.isArray)(t)?t:[t],t=f.qjt(t),f.Due={},t=f.Iue(t,f.Due),n=0,i=(e=f.Bjt())[0],r=e[1],o=0,a=t.length;o<a;o++)for(u in t[o])s=t[o][u],u=i[u]||u,f._data[u]||(f._data[u]={data:[]},f.DEt.push(u)),f._data[u].data[0+o]=f.Ajt(s,r[u]);f.Lbe(),f.vjt=0+t.length,t=f.K7t(l).data,f.ki(d.ONCHANGE,{action:d.INSERT,index:0,items:t})}return f.wjt=f.vjt,f.ki(y,{type:"read",success:!0,items:t}),t}).catch(function(t){var t=t&&!0===t.cancel?M+t.step:f.J7t(t);return f.ki(y,{type:"read",success:!1,reason:t}),Promise.reject(t)})):Promise.resolve(f.K7t(l).data))},R.prototype.Lbe=function(t){var t,n,e,i,r,o,a,u,n=this,e=function(t){n._data[t]||(n._data[t]={data:[]},n.DEt.push(t))};if(t)for(i=0,r=t;i<r.length;i++)e(o=r[i]);else if(a=null==(t=n.options.schema)?void 0:t.columns)for(u in a)a[u].spread||"formula"===a[u].dataType||e(u)},R.prototype.$ue=function(t,n){for(var e,i,r,o,a,u,s,c,f,e=[],i=0,r=n.fields;i<r.length;i++)for(u=0,s=a=t[o=r[i]].data;u<s.length;u++)c=s[u],(f={})[n.as]=o,f[n.valueAs]=c,e.push(f);return e},R.prototype.AP=function(t){for(var n,e,i,r,o,a,u,n=[],e,i=0,r=Object.keys(t);i<r.length;i++)for(a=t[o=r[i]].data,u=0;u<a.length;u++)n[u]||(n[u]={}),n[u][o]=a[u];return n},R.prototype.loadSync=function(t,n){var e,i,n,r,n,o,a,u,s,c,f,e=this;if(e.ojt=!0,i=(0,b.isNullOrUndefined)(t)?n?e.AP(e._data):(n=e.hjt.getDataSync(),e.wjt=e.djt.total(n),e.djt.readSync(n)):e.$ue(e._data,t),e._data={},e.vjt=0,e.DEt=[],i){for(i=(0,b.isArray)(i)?i:[i],r=0,o=(n=e.Bjt())[0],a=n[1],u=0,s=i.length;u<s;u++)for(c in i[u])f=i[u][c],c=o[c]||c,e._data[c]||(e._data[c]={data:[]},e.DEt.push(c)),e._data[c].data[0+u]=e.Ajt(f,a[c]);return e.Lbe(),e.vjt=0+i.length,i=e.K7t().data,e.wjt=e.vjt,i}return[]},R.prototype.length=function(){return"number"==typeof this.wjt?this.wjt:this.vjt},R.prototype.setLength=function(t){var n=this,e=n._data,i;n.wjt?this.wjt=t:e&&(this.vjt=t)},R.prototype.K7t=function(t){var n,e,i,r,o,a,u,n=this,e=n.X7t(),i=0,r=n.vjt,o=e?n.s7t(0):0,a=n.q7t||[];for(e||(a=[]),u=[];0<r&&o<n.vjt;)a[o]||(u.push(n.bjt(o)),r--),o++;return{data:u}},R.prototype.$7t=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,e=this,i=e.X7t(),r=0,o=e.vjt,a=i?e.s7t(0):0,u=e.q7t||[];if(0===(u=i?u:[]).length){for(s=[],c=0;c<t.length;c++)s[f=t[c]]=e.bjt(f);return{data:s}}for(l=[],h=0;0<o&&a<e.vjt;)u[a]||(-1<t.indexOf(h)&&(l[h]=e.bjt(a)),h++,o--),a++;return{data:l}},R.prototype.tOt=function(t){return(t?this.$7t(t):this.K7t()).data},R.prototype.nOt=function(t,n){var e,i,e,i,e,r,o,a,u,s,i=this,e=i.Fjt(),r=[];if(!(0,b.isNullOrUndefined)(n)&&t.length===n.length)if("Level"===e)for(o=0;o<t.length;o++)a=t[o],r.push(k(a,n[o]));else"ChildrenPath"===e&&(u=i.Yjt(i.Gjt()),s=[((e={})[u]=r,e)],_(((i={})[u]=t,i),((e={})[u]=n,e),u,function(t,n){var t,n,t=k(t,n);delete t[u],n=s[s.length-1],(0,b.isArray)(n[u])||(n[u]=[]),n[u].push(t),s.push(t)},function(){s.pop()}));return r},R.prototype.eOt=function(t){var n,e,i,r,i,o,a,n,u,s,c,f,l,e,h,d,e,r=this,i=r.Fjt();if(!(0,b.isNullOrUndefined)(t)){if(o=r.f7t(),u=r.Gjt(),"Level"===i){for(a="children",c=r.Yjt(u),(n={})[a]=[],n.data={},f=[n=n],l=0;l<t.length;l++){for(h=(e=t[l])[c],d=f[f.length-1];d.data.level>=h;)f.pop(),d=f[f.length-1];(e={data:e})[a]=[],e=e,d[a].push(e),f.push(e)}s=function(t){return t.data}}else"ChildrenPath"===i&&((i={})[a=u]=t,n=i,s=function(t){return t});_(o,n,{childrenField2:a},function(t,n){r._jt(s(n)),r.pjt(t.lp,s(n))})}},R.prototype.iOt=function(e,i,r,n){var o=this;return o.rOt({body:e},i).then(function(t){var n,t,t,n="batch"===i,t={type:i,batch:n,data:o.nOt(e,t)};return o.ki(p,t)?Promise.reject({cancel:!0,type:i,batch:n,step:p}):(e=t.data,o.eOt(e),t={type:i,success:!0,batch:n,items:(0,b.isArray)(e)?e:[e]},delete o.oOt,delete o.q7t,delete o.aOt,delete o.uOt,r&&r(t),o.ki(y,t),n?Promise.resolve(o.K7t()):w)}).catch(function(t){var t,t,t=t&&!0===t.cancel?M+t.step:o.J7t(t),t={type:i,success:!1,reason:t};o.ki(g,{type:t}),n&&n(t)})},R.prototype.sOt=function(){var t,t,t=this;if(t.isHierarchy())return"Level"===(t=t.Fjt())||"ChildrenPath"===t},R.prototype.cOt=function(e,i,t,n){var r,o,r,a,u,s,c,f,l,o=this,r=o.Fjt();return i=i||o.q7t||[],"Level"===r?(a=o.f7t(),u=[],(0,b.traversalTree)(a,function(t){var t,n,t=t.lp;i[t]||(n=o.bjt(t),("create"===e||"batch"===e&&o.isInserted(t,!0))&&o.Y7t(n),n=o.jjt(n),u.push(n))}),o.iOt(u,e,t,n)):"ChildrenPath"===r?(a=o.f7t(),s=o.Gjt(),c=o.Yjt(s),l=[((r={})[c]=f=[],r)],(0,b.traversalTree)(a,{invoking:function(t){var t,n,t,t=t.lp;i[t]||(n=o.bjt(t),("create"===e||"batch"===e&&o.isInserted(t,!0))&&o.Y7t(n),delete n[s],n=o.jjt(n),0<l.length&&(t=l[l.length-1],(0,b.isArray)(t[c])||(t[c]=[]),t[c].push(n)),l.push(n))},invoked:function(t){i[t.lp]||l.pop()}}),o.iOt(f,e,t,n)):Promise.resolve(void 0)},R.prototype.fOt=function(){var t,n,e,i,r,o,a,t,u,s,c,f,i,n=this;if(n.isHierarchy()){for(e=n.njt,i=n.f7t(),r=e.reduce(function(t,n){return(t[n.JEt]=n).id=n.JEt,n.sequence=n.$Et,n.parent=m,t},((t={})[i.JEt]=i,t)),o=0;o<e.length;o++)n.isInserted(o,!0)||((a=e[o]).parent=r[a.XEt]);if(t=n.options.schema.hierarchy.levelOffset||0,i.level=t-1,"Level"===n.Fjt()){for(u=n.Gjt(),s=w,o=0;o<e.length&&!n.isInserted(o,!0);o++)f=void 0,((f=(c=n.lOt(o))?c[u]:n.Xjt(u,o))<s||s===w)&&(s=f);i.level=s+t-1}n.njt=[],i=!(0,b.isNullOrEmpty)(n.$jt()),n.Hjt(i)}},R.prototype.cancelChanges=function(){var e,t,i,r,o,a,e=this,t=e.getHeldActions();t&&0!==t.length&&(e.fOt(),e.t7t(),i=e.aOt,r=e.q7t||[],o=e.oOt||[],a=[],(0,b.forEach)(t,function(t){var n=t.sourceIndex,t=t.type;t===d.UPDATE?(e.pjt(n,i[n]),o[n]=[!!o[n]&&o[n][0],!1]):t===d.DELETE?(r[n]=w,o[n]&&o[n][0]?a.push(n):o[n]&&o[n][1]&&(e.pjt(n,i[n]),o[n]=[!1,!1]),(0,b.isNullOrUndefined)(e.wjt)||(e.wjt+=1)):t===d.INSERT&&a.push(n)}),(0,b.forEachRight)(a,function(t){e.mjt(t,1),o.splice(t,1),(0,b.isNullOrUndefined)(e.wjt)||--e.wjt}),e.clearBatchCache_())},R.prototype.getChanges=function(){return this.hOt(!1)},R.prototype.isDataLengthChanged=function(){return this.getChanges().some(function(t){return"delete"===t.type||"insert"===t.type})},R.prototype.submitChanges=function(r){var o,n,a,u,s,c,f,l,o=this;return o.hasCachedActions()?o.sOt()?(n=(o.q7t||[]).slice(),o.cOt("batch",w,function(){for(var t=o.vjt-1;0<=t;t--)!0===n[t]&&(o.mjt(t,1),o.njt[t].parent=m,o.njt.splice(t,1));o.njt.forEach(function(t,n){t.lp=n})})):(a=o.aOt,u=o.q7t||[],s=o.oOt||[],c=o.getHeldActions(),f=[],l=d.UPDATE,(0,b.isNullOrUndefined)(c)||c.forEach(function(t){t.dataItem=o.kue(o.jjt(t.dataItem)),t.oldDataItem=o.kue(o.jjt(t.oldDataItem))}),o.rOt({body:c},"batch").then(function(t){var t,e,i,t,t={type:l,batch:!0,data:t};return o.ki(p,t)?Promise.reject({cancel:!0,type:l,batch:!0,step:p}):(((e=t.data)||[]).forEach(function(t){t.succeed&&t.data&&(o._jt(t.data),t.data=o.xue(t.data))}),e.length,c.length,i=[],(0,b.forEach)(c,function(t,n){var n=e[n];n.succeed?t.type===d.UPDATE?(a&&(a[t.sourceIndex]=w),s[t.sourceIndex][1]=w):t.type===d.INSERT?(n.data&&(o.pjt(t.sourceIndex,n.data),o.Z7t(t.sourceIndex,n.data)),s[t.sourceIndex]=[],a[t.sourceIndex]=w):t.type===d.DELETE&&f.push(t.sourceIndex):i.push({localAction:t,response:n})}),(0,b.forEachRight)(f,function(t){u.splice(t,1),o.mjt(t,1),a&&a.splice(t,1),s.splice(t,1),o.isHierarchy()&&(o.njt[t].parent=m,o.njt.splice(t,1))}),o.isHierarchy()&&o.njt.forEach(function(t,n){t.lp=n}),0<i.length?(t={type:l,errorData:i},o.ki(g,{type:t})||(o.uOt=[],(0,b.forEach)(i,function(t,n){var e=t.response,t=t.localAction,i=t.sourceIndex;t.type===d.DELETE&&(u[i]=w),o.dOt(i,{type:t.type,success:!1,reason:e.reason}),r(i,e.reason,t.type)}))):delete o.uOt,Promise.resolve(o.K7t()))}).catch(function(t){var t,n,t=t&&!0===t.cancel?M+t.step:o.J7t(t),n;o.ki(g,{type:{type:l,reason:t}})})):Promise.resolve(void 0)},R.prototype.getHeldActions=function(){var t=this;return t.hasCachedActions()?t.hOt(!0):m},R.prototype.hOt=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,a,a,n=this,e=[],i=n.oOt||[],r=n.q7t||[],o=n.aOt,s=n.isHierarchy(),c=0;c<n.vjt;c++){if(a=i[c],!(u=null)===r[c])u={type:d.DELETE,dataItem:n.bjt(c)};else if(a&&a[0])u={type:d.INSERT,dataItem:n.bjt(c)},t&&s&&n.Y7t(u.dataItem);else if(a&&a[1]){if(f=o[c],l=n.bjt(c),!t)for(h in f=v({},f))f.hasOwnProperty(h)&&f[h]===l[h]&&(delete f[h],delete l[h]);u={type:d.UPDATE,dataItem:l,oldDataItem:f}}u&&(s&&u.type===d.INSERT&&x((a=n.c7t(c).parent).id)&&(a=a.isRoot?w:a.lp,t?u.sourceParentIndex=a:u.parentIndex=(0,b.isNumber)(a)?n.TEt(a):w),t?u.sourceIndex=c:u.index=this.TEt(c),e.push(u))}return e},R.prototype.clearBatchCache_=function(){var t=this;delete t.q7t,delete t.aOt,delete t.uOt},R.prototype.hasCachedActions=function(){var t,n,t,e,i,r,o,a,u,t=this;if(t.X7t()&&(n=t.oOt,t=t.q7t,n||t)){if(t)for(e=0,i=t;e<i.length;e++)if(r=i[e])return!0;if(n)for(o=0,a=n;o<a.length;o++)if((u=a[o])&&(!0===u[0]||!0===u[1]))return!0}return!1},R.prototype.bind=function(t,n){var e,i,r,o,a,u,s,e=this;if(n)for(o=i=(r=0,b.isArray)(t)?t:[t];r<o.length;r++)a=o[r],(u=(0,b.isFunction)(n)?n:n[a])&&(s=e._events[a]=e._events[a]||new c.Event).addHandler(u,e)},R.prototype.unbind=function(t,n){var e,t,e=this;(0,b.isNullOrUndefined)(t)?((0,b.forEach)(e._events,function(t){t.removeAllHandlers()}),e._events={}):(t=e._events[t])&&(n?t.removeHandler(n,e):t.removeAllHandlers())},R.prototype.ki=function(t,n){var e,i,e=this,i=e._events[t];return!!i&&((n=n||{}).cancel=!1,n.eventName=t,i.raise(e,n),n.cancel)},R.prototype.vOt=function(t){var n=this;return n._events.hasOwnProperty(t)&&n._events[t].hasHandlers},R.prototype.W7t=function(t){return t=v({},t)},R.prototype.mOt=function(t){return t},R.prototype.getDirtyIndexes=function(){var t,n=this.oOt||[];return(0,b.keys)(n).map(function(t){return parseInt(t,10)})},R.prototype.gOt=function(t,n){var e=this,i;return(e.oOt||[])[t=n?t:e.s7t(t)]||[]},R.prototype.isInserted=function(t,n){return this.gOt(t,n)[0]},R.prototype.isUpdated=function(t){return this.gOt(t)[1]},R.prototype.getErrorInfo=function(t){var n=this,e=n.uOt;if(!(0,b.isNullOrUndefined)(e))return e[t=n.s7t(t)]},R.prototype.dOt=function(t,n){var e=this,i;(e.uOt=e.uOt||[])[t]=n},R.prototype.pOt=function(){this.oOt=w,this.q7t=w,this.aOt=w,this.uOt=w},R.prototype.lOt=function(t){var n=this,e;return(n.aOt=n.aOt||[])[t]},R.prototype.insertItem=function(t,n,e,i){var r=this;t=r.s7t(t),r.I7t({action:d.INSERT,index:t,item:n,N7t:!0}),r.isHierarchy()&&"Custom"===r.Fjt()&&r.g7t(t),e&&e({type:d.CREATE,success:!0})},R.prototype.updateItem=function(t,n,e,i){var r;this.I7t({action:d.UPDATE,index:t,item:n}),e&&e({type:d.UPDATE,success:!0})},R.prototype.updateItemValues=function(t,n,e,i){var r;this.I7t({action:d.UPDATE,index:t,item:n,x7t:!0}),e&&e({type:d.UPDATE,success:!0})},R.prototype.resetItem=function(t,n,e){var i,r,o,i=this,r,o=(i.aOt=i.aOt||[])[t=i.s7t(t)];i.isHierarchy()&&(o=i.bOt(t,o)),i.pjt(t,o),i.clearChangedStatus(t),i.dOt(t),n&&n({type:d.UPDATE,success:!0})},R.prototype.bOt=function(t,n){var e,i,t,r,o,e,a,e=this,i;return e.isHierarchy()?(t=e.bjt(t),r=e.Fjt(),o=e.Gjt(),e=e.$jt(),a=v({},n),"Parent"!==r&&"Level"!==r&&"Custom"!==r||(a[o]=t[o]),(0,b.isNullOrEmpty)(e)||(a[e]=t[e]),a):n},R.prototype.saveItem=function(t,n,e){var i,r,o,a,u,s,o,c,i=this;t=i.s7t(t),a=(o=(r=i.oOt||[])[t]||[])[0],u=o[1],0<o.length&&(a||u)&&(i.isHierarchy()&&(c=!(o=(s=i.njt)[t].parent).isRoot&&r[o.lp]&&r[o.lp][0])?e&&e({type:d.CREATE,success:!1}):i.yOt(t,i.bjt(t),a?d.INSERT:d.UPDATE,n,e))},R.prototype.yOt=function(n,e,t,i,r){var o=this,t=t===d.INSERT,a=t?d.CREATE:d.UPDATE,u=o.X7t(),s=o.wOt(a),c=o.MOt();u||!s||c?c&&(o.oOt[n]=[],o.aOt[n]=w,i)&&i({type:a,success:!0}):o.sOt()?o.cOt(t?d.CREATE:d.UPDATE,w,i,r):(t&&o.Y7t(e),e=o.jjt(e),e=o.kue(e),o.rOt({body:e},t?d.CREATE:d.UPDATE).then(function(t){var t,t,t={type:a,data:k(e,t)};return o.ki(p,t)?Promise.reject({cancel:!0,type:a,step:p}):(o._jt(t.data),t.data=o.xue(t.data),o.pjt(n,t.data),o.oOt[n]=[],o.aOt[n]=w,o.dOt(n),t={type:a,success:!0,items:[t.data]},a===d.CREATE&&o.Z7t(n),i&&i(t),o.ki(y,t),w)}).catch(function(t){var t,t,t=t&&!0===t.cancel?M+t.step:o.J7t(t),t={type:a,success:!1,reason:t};o.dOt(n,t),o.ki(g,{type:t}),r(t)}))},R.prototype.I7t=function(t){var n,e,i,r,o,a,u,s,c,f,l,l,n=this,e=n.X7t(),i=n.aOt=n.aOt||[];e&&(r=n.q7t=n.q7t||[]),o=t.action,a=t.index,u=t.item,s=t.x7t,a=(c=t.N7t)?a:n.s7t(a),n.oOt=n.oOt||[],f=n.oOt,o===d.INSERT?(0===n.vjt&&0===n.DEt.length&&n.COt(),n.vjt<a&&(n.vjt=a),(0,b.isNullOrUndefined)(l=a)&&(l=n.vjt),n.mjt(l,0,u),i.length>=a?i.splice(a,0,v({},u)):i[a]=v({},u),e&&(r.length>=a?r.splice(a,0,w):r[a]=w),f.length>=a?f.splice(a,0,[!0]):f[a]=[!0],(0,b.isNullOrUndefined)(n.wjt)||(n.wjt+=1),n.ki(d.ONCHANGE,{action:o,index:a,items:[t.item]})):o===d.UPDATE&&(l=n.bjt(a),i[a]||(i[a]=v({},l)),n.pjt(a,u,s),n.oOt[a]?n.oOt[a]=[n.oOt[a][0],!0]:n.oOt[a]=[!1,!0],D(u,i[a])&&n.clearChangedStatus(a),n.ki(d.ONCHANGE,{action:o,index:a,items:[t.item],oldItems:[l]}))},R.prototype.clearChangedStatus=function(t){var n=this;!(n.oOt[t][1]=!1)!==n.oOt[t][0]&&(n.aOt[t]=w)},R.prototype.get=function(t){var n,e,i,r,o,a,n=this,e=n._data;if(t=n.s7t(t),e&&t<n.vjt){for(i={},r=0,o=n.DEt;r<o.length;r++)i[a=o[r]]=e[a].data[t];return i}return w},R.prototype.Xjt=function(t,n){var e=this,i=e._data;return i&&i[t]&&n<e.vjt?i[t].data[n]:w},R.prototype.getFieldValue=function(t,n){var e=this,i=e._data;return n=e.s7t(n),i&&i[t]&&n<e.vjt?i[t].data[n]:w},R.prototype.getFieldOriginalValue=function(t,n){var e,i,e,e=this,i=e._data;return n=e.s7t(n),i&&i[t]&&n<e.vjt?(e=e.lOt(n),(0,b.isNullOrUndefined)(e)?i[t].data[n]:e[t]):w},R.prototype.Fbe=function(t){var n,e,i,r,o,a,u,n=this,e=n.s7t(t),i=n.lOt(e),r=n._data,a={};for(u in r)r.hasOwnProperty(u)&&(a[u]=o=r[u].data[e],(0,b.isUndefined)(o))&&(a[u]=i[u]);return a},R.prototype.SOt=function(n,e,i){var o,t,r,a,u,s,c,u,o=this,t;o.X7t()||!o.wOt(d.DELETE)||o.MOt()||o.isInserted(n)||!o.sOt()?o.isHierarchy()&&(n=o.s7t(n),r=o.c7t(n),u=(c=r.getChildrenIndexes(!0).concat(n)).map(function(i,r){return function(t,n){for(var e=r;e<c.length;e++)c[e]>i&&c[e]--;o.TOt(c[r],1,t,n)}}),(0,b.promiseSerialExecute)(u).then(function(t){o.X7t()||(c.sort(function(t,n){return n-t}),c.forEach(function(t){o.tX(t,1,!1)}),o.njt.forEach(function(t,n){t.lp=n})),"Custom"===o.Fjt()&&o.g7t(n+(o.X7t()?c.length:0));var t=t[t.length-1];t.removedCount=c.length,e&&e(t)}).catch(function(t){i&&i(t)})):(n=o.s7t(n),r=o.c7t(n),u=(a=r.getChildrenIndexes(!0).concat(n)).reduce(function(t,n){return t[n]=!0,t},[]),o.bind(p,s=function(){a.forEach(function(t){o.tX(t,1,!1)}),o.njt.forEach(function(t,n){t.lp=n})}),o.cOt(d.DELETE,u,function(t){o.unbind(p,s),t.removedCount=a.length,e&&e(t)},function(t){o.unbind(p,s),i&&i(t)}))},R.prototype.remove=function(t,n,e,i){var r=this;r.isHierarchy()?r.SOt(t,e,i):r.TOt(t,n,e,i)},R.prototype.TOt=function(e,i,r,n){var o,a,u,t,s,o=this,a=o.X7t();e<0||e>=(a?o.vjt:o.length())||(u=d.DELETE,a||!o.wOt(d.DELETE)||o.MOt()||o.isInserted(e)?(!a&&o.isHierarchy()||o.tX(e,i),r&&r(t={type:u,success:!0})):(s=o.gjt(e,e+i),o.Ejt(s),s=s.map(function(t){return o.kue(t)}),o.rOt({body:s},d.DELETE).then(function(t){var n;return o.ki(p,{type:u,data:s})?Promise.reject({cancel:!0,type:u,step:p}):(s&&s[0]&&!a&&(e=o.Bbe(e,s[0])),o.isHierarchy()||o.tX(e,i),o.Ejt(s,{isServerToClient:!0}),s=s.map(function(t){return o.xue(t)}),o.dOt(e),n={type:u,success:!0,items:[s]},r&&r(n),o.ki(y,n),w)}).catch(function(t){var t,t,t=t&&!0===t.cancel?M+t.step:o.J7t(t),t={type:u,success:!1,reason:t};o.dOt(e,t),o.ki(g,{type:t}),n(t)})))},R.prototype.tX=function(t,n,e){var i,r,o,a,u,r,s,c,f,l,h,r,i=this,r=i.X7t(),a=i.oOt||[],u=i.aOt||[];if(r){for(r=void 0,s=i.q7t=i.q7t||[],c=n,f=[],o=[],i.isHierarchy()?((l=i.njt)[r=t].parent=m,i.y7t(t,n)):r=i.s7t(t),h=r;h<i.vjt&&(!0!==s[h]&&o.length<n&&(o.push(i.bjt(h)),f.push(h),s[h]=!0,--c),0!==c);h++);(0,b.forEachRight)(f,function(t){a[t]&&a[t][0]&&(s.splice(t,1),a.splice(t,1),u.splice(t,1),i.mjt(t,1))})}else o=i.mjt(t,n),a.splice(t,n),u.splice(t,n),i.isHierarchy()&&((l=i.njt)[t].parent=m,i.y7t(t,n),l.splice(t,n),!1!==e)&&l.forEach(function(t,n){t.lp=n});r=o.length,(0,b.isNullOrUndefined)(i.wjt)||(i.wjt-=r,i.wjt=Math.max(i.wjt,0)),i.ki(d.ONCHANGE,{action:d.DELETE,items:o})},R.prototype.COt=function(){var t,n,e,i,n=this,e=null==(t=n.options.schema)?void 0:t.columns;if(e)for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n._data[i]={data:[]},n.DEt.push(i))},R.prototype.MOt=function(){return(0,b.isNullOrUndefined)(this.options.remote)},R.prototype.X7t=function(){var t;return!!this.options.batch&&!this.MOt()},R.prototype.wOt=function(t){var n,e,n,n=this,e=n.options,n=n.hjt;return!!e.autoSync&&!(0,b.isNullOrUndefined)(n.LEt[t])},R.prototype.rOt=function(t,n){var e,i,e=this,i=n||d.UPDATE;return!(t=e.hjt.setupRequestOptions(t,n||d.UPDATE))||e.ki(h,{type:i,requestParams:t})?Promise.reject({cancel:!0,type:i,step:h}):e.hjt.postData(t)},R.prototype.Q7t=function(t){var n=this;return t=n.mOt(t),!(t=n.hjt.setupRequestOptions(t,"read"))||n.ki(h,{type:"read",requestParams:t})?Promise.reject({cancel:!0,type:"read",step:h}):n.hjt.getData(t)},R.prototype.J7t=function(t){return(0,b.isString)(t)?t:t instanceof Error?t.message:"some error happened"},R.prototype.mTe=function(){var t=this.q7t;return!((0,b.isNullOrUndefined)(t)||0===t.length)},R.prototype.s7t=function(t){var n,e,i,r,o,n=this.q7t;if((0,b.isNullOrUndefined)(n)||0===n.length)return t;for(r=i=e=0,o=n.length;r<=o;r++)if(n[r])i+=1;else{if(e===t)break;e+=1}return t+i},R.prototype.TEt=function(t){var n,e,i,n=this.q7t;if(!(0,b.isNullOrUndefined)(n)&&0!==n.length)for(e=0,i=Math.min(n.length,t);e<=i;e++)n[e]&&--t;return t},R.prototype.Bbe=function(t,n){var e,i,r,o,a,e=this.gjt(t,t+1);if(!e||!D(e[0],n))for(i=this.length(),o=t+1,a=t-1;0<=a||o<i;){if(o<i){if(r=o,(e=this.gjt(r,r+1))&&D(e[0],n))return r;o++,o=Math.min(i,o)}if(0<=a){if(r=a,(e=this.gjt(r,r+1))&&D(e[0],n))return r;a--,a=Math.max(-1,a)}}return t},d.DataSource=R},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(t,n){"use strict";var e,i;function r(t){t&&(this._data=t.data,this.LEt=e({},t))}e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDataTransport=void 0,r.prototype.getData=function(t){var n;return Promise.resolve(this._data)},r.prototype.getDataSync=function(){return this._data},r.prototype.postData=function(t){var n;return Promise.resolve(this._data)},r.prototype.setupRequestOptions=function(t,n){return{}},n.LocalDataTransport=r},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(t,n,e){"use strict";var s,a,u,i,c,f,l,h,d,v,m,r;function o(t){var n;this.LEt=s({},t)}s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteDataTransport=void 0,e("./node_modules/whatwg-fetch/fetch.js"),a=e("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),u=e("./dist/src/dataSource/utils.js"),i=null,c=void 0,f="jsonp",l="read",h="create",d="update",v="delete",m="Content-Type",o.prototype.getData=function(t){var n,e,i,r,o,n=this,e,i=this.LEt[t.requestType],r=t.dataType,o=r===f?a:fetch;return t.requestData=c,(t.requestType=c,u.isFunction)(i)?i(t):o(t.url,t).then(function(t){if(t.ok)return n.AOt(r)?t.json():t.text();throw t})},o.prototype.postData=function(t){var n,e,i,r,o,n=this,e,i=this.LEt[t.requestType],r=t.dataType,o=t.requestData;return t.requestData=c,(t.requestType=c,u.isFunction)(i)?i(o,t):fetch(t.url,t).then(function(t){if(t.ok)return n.AOt(r)?t.json():t.text();throw t})},o.prototype.AOt=function(t){return void 0===t||"json"===t||t===f},o.prototype.setupRequestOptions=function(t,n){var e,i,r,o,a,u,e,r;if(t=t||{},i=(e=this).LEt[n])return r=i.body,(o=t.body)?(t.headers=t.headers||{},e.LEt.dataConverter?(t.body=o=e.LEt.dataConverter(o,n||l),t.headers[m]="application/plain;"):(t.body="string"==typeof o?o:JSON.stringify(o),t.headers[m]="application/json; charset=utf-8")):r&&(t.body="string"==typeof r?r:JSON.stringify(r),t.headers={},t.headers[m]="application/json; charset=utf-8"),e=i.method,n===l?(i.dataType===f&&(a={mode:"no-cors"}),u={method:e||"GET"}):n===h||n===d||"batch"===n?u={method:e||"POST"}:n===v&&(u={method:e||"DELETE"}),(r=i.options)&&r.mode&&(a={mode:r.mode}),s(s(s(s(s({},i),u),a),t),{requestType:n,requestData:o})},n.RemoteDataTransport=o},"./dist/src/dataSource/event.js":function(t,n){"use strict";var r,s,e;function i(t,n,e){var i=this;i.handler=t,i.owner=n,i.priority=e}function o(){this.IOt=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.Event=n.EventHandler=void 0,r=i,n.EventHandler=r,s=null,Object.defineProperty(o.prototype,"hasHandlers",{get:function(){return 0<this.IOt.length},enumerable:!1,configurable:!0}),o.prototype.addHandler=function(t,n,e){var i=this,t=new r(t,n,e=void 0===e?1:e);i.IOt.push(t),i.sortHandlers()},o.prototype.removeHandler=function(t,n){for(var e,i,r,o,a,e=this,i=e.IOt,r=i.length,o=0;o<r;o++)if((a=i[o]).handler===t&&a.owner===n){e.IOt.splice(o,1);break}},o.prototype.sortHandlers=function(){this.IOt.sort(function(t,n){var t=t.priority,n=n.priority;return t<n?1:n<t?-1:0})},o.prototype.removeHandlersByPriority=function(t){for(var n,e,i,r,o,a,u,n=this,e=n.IOt,i=e.length,r=s,o=s,a=0;a<i;a++)if((u=e[a]).priority===t)r===s&&(r=a),o=a;else if(r!==s)break;r!==s&&o!==s&&n.IOt.splice(r,o-r+1)},o.prototype.removeAllHandlers=function(){this.IOt.length=0},o.prototype.raise=function(t,n){var e,i,i,r,o,a,u,e=!1,i=function(){e=!0};for(n===s?n={stopPropagation:i}:n.stopPropagation=i,r=(i=this).IOt.length,o=i.IOt.slice(0,r),a=0;a<r&&!e;a++)(u=o[a]).handler.call(u.owner,t,n)},n.Event=o},"./dist/src/dataSource/utils.js":function(F,c,t){"use strict";var r,a,u,s,f,l;function n(t){return t&&!(0,c.isArray)(t)&&"object"==typeof t}function e(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"boolean"==typeof t}function h(t,n){var e,i,r,o,a;if((0,c.isArray)(t))for(e=0;e<t.length;e++)n(t[e],e,t);else for(r=0,o=i=Object.keys(t);r<o.length;r++)n(t[a=o[r]],a,t)}function d(t,n){var e,i,r,o,a;if((0,c.isArray)(t))for(e=t.length-1;0<=e;e--)n(t[e],e,t);else for((i=Object.keys(t)).reverse(),r=0,o=i;r<o.length;r++)n(t[a=o[r]],a,t)}function v(t){return Object.keys(t)}function m(t,n,e){if((0,c.isArray)(t))return t.reduce(n,e);throw new Error("NOT SUPPORT")}function g(t,n,e){return t.indexOf(n,e=void 0===e?0:e)}function p(t,n){for(var e=0,i=t.length;e<i;e++)if(n(t[e],e,t))return e;return-1}function b(t,n){var e,i,r,o,a,u,s;if(void 0===n&&(n=!1),!x(t)&&"object"==typeof t){if(t&&(0,c.isArray)(t))return t.map(function(t){return b(t,n)});if(t&&"object"==typeof t){for(e={},r=0,o=i=v(t);r<o.length;r++)u=t[a=o[r]],n?(s=D(u),e[a]="object"===s||"array"===s?b(u,n):u):e[a]=u;return e}}return t}function w(t,n,e){var i,r,o,a,u,s;if(void 0===e&&(e=!1),!x(t)&&!x(n)){if(t instanceof Date&&n instanceof Date)return t.valueOf()===n.valueOf();if(e)if((0,c.isArray)(t)&&(0,c.isArray)(n)){if(t.length===n.length){for(i=0;i<t.length;i++)if(!w(t[i],n[i],e))return!1;return!0}}else if("object"==typeof t&&"object"==typeof n&&(r=Object.keys(t),o=Object.keys(n),r.length===o.length)){for(a=0,u=r;a<u.length;a++)if(s=u[a],!n.hasOwnProperty(s)||!w(t[s],n[s]))return!1;return!0}}return t===n}function y(t,n){return!w(t,n,!0)}function M(t,n){var e,i,r;for(void 0===t&&(t=[]),void 0===n&&(n=[]),e={},i=Math.min(t.length,n.length),r=0;r<i;r++)e[t[r]]=n[r];return e}function C(t){return"string"==typeof t}function S(t,n){var e,i,r,o;if(C(n))return t[n];for(e={},i=0,r=n;i<r.length;i++)e[o=r[i]]=t[o];return e}function T(t,n){if((0,c.isArray)(t))return t.map(n);throw new Error("NOT SUPPORT")}function A(t){return void 0===t}function I(t){return null===t}function x(t){return A(t)||I(t)}function N(t){return""===t||x(t)}function k(t){return t&&"="===t[0]}function _(t){return t&&-1<t.indexOf(".")}function D(t){var n;return Object.prototype.toString.call(t).match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}function L(t,n,e,i){n<0||n>t.length||e<0||e>t.length||n===e||i<=0||t.splice.apply(t,r([e-(n<e?i-1:0),0],t.splice(n,i),!1))}function j(t,n){var t=t.parent;t&&(n(t),j(t,n))}function O(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,r=t[i||"children"]||[];for(N(e)?o=r.slice():(c=s=void 0,"string"==typeof e?a=e:"function"==typeof e?u=e:"object"==typeof e&&(a=e.field,u=e.getValue,s=e.compareFn,c=e.isOrderChildren),o=c?r:r.slice(),a?o.sort(function(t,n){return t[a]-n[a]}):u?o.sort(function(t,n){return u(t)-u(n)}):s&&o.sort(s)),"object"==typeof(f=n)&&(f=n.invoking,l=n.invoked),d=0;d<o.length;d++){if(v=o[d],f&&(h=f(v,t))&&h.cancel)return h;if((h=h&&h.cancelDeepRecursion?h:O(v,n,e,i))&&h.cancel)return h;if(l&&(h=l(v,t))&&h.cancel)return h}}function B(t){return t}function P(e){return void 0===e&&(e=0),new Promise(function(t,n){setTimeout(function(){t("timeout")},e)})}function E(t){var n=t.callback,e=t.timeout,e=void 0===e?5e3:e,t=t.retryCount,i=void 0===t?1:t;return Promise.race([n(),P(e)]).then(function(t){if("timeout"!==t)return Promise.resolve(t);if(0<i)return E({callback:n,retryCount:--i});throw"timeout"})}function G(t,n){return R(t.map(function(t){return function(){return new Promise(t)}}),n)}function R(t,e){var i=[];return t.reduce(function(t,n){return t.then(function(t){return i.push(Promise.resolve(t)),e?E({callback:n,timeout:e.timeout,retryCount:e.retryCount}):n()})},Promise.resolve({})).then(function(t){return i.shift(),i.push(Promise.resolve(t)),Promise.all(i)})}function U(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))}function H(t){return!x(t._error||t._code)}function V(t){var n;return x(t)||x(n=t._error||t._code)?t:n}function z(n,t){var e,e,i,r,o;if(x(n)||""===n)return"";if(e=U(t),!t||"General"===t||e)return"boolean"==typeof n||n instanceof Boolean?(n=u?n?u.getBoolean().boolean_true:u.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(i=(e=s.Fe(s.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(i=e.defaultDatePattern),l.Pe(n,i)):(n="number"==typeof n?f.Ge(n.toString()):n).toString();try{return(r=a.Formatter&&a.Formatter.GeneralFormatter)?(o=null,(o="string"==typeof t?new r(t):t).format(n,{})):n.toString()}catch(t){return n.toString()}}function Y(t,n){var e,i;if(!x(t)&&!x(n))for(e=n.split(".");0<e.length;)t=t[i=e.shift()];return t}function Z(t){var n,e,i,r,o;if(t&&0<t.length){for(n={},e=[],i=0,r=t;i<r.length;i++)n[o=r[i]]||(n[o]=!0,e.push(o));return e}return t}r=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(c,"__esModule",{value:!0}),c.getUniqueArray=c.q$=c.format=c.formatCalcError=c.isCalcError=c.promiseAllSerial=c.promiseSerialExecute=c.traversalTree=c.bubbleTree=c.swapArrayItems=c.getActualType=c.isRelation=c.isFormula=c.isNullOrEmpty=c.isNullOrUndefined=c.isNull=c.isUndefined=c.map=c.pick=c.isString=c.zipObject=c.isNotDeepEqual=c.isEqual=c.clone=c.findIndex=c.indexOf=c.reduce=c.keys=c.forEachRight=c.forEach=c.isBoolean=c.isNumber=c.isFunction=c.isObject=c.isArray=void 0,a=t("Common"),u=t("CalcEngine"),s=a.Common.CultureManager,f=a.Common.st,l=a.Common.ct,c.isArray=a.Common.lt.Nh,c.isObject=n,c.isFunction=e,c.isNumber=i,c.isBoolean=o,c.forEach=h,c.forEachRight=d,c.keys=v,c.reduce=m,c.indexOf=g,c.findIndex=p,c.clone=b,c.isEqual=w,c.isNotDeepEqual=y,c.zipObject=M,c.isString=C,c.pick=S,c.map=T,c.isUndefined=A,c.isNull=I,c.isNullOrUndefined=x,c.isNullOrEmpty=N,c.isFormula=k,c.isRelation=_,c.getActualType=D,c.swapArrayItems=L,c.bubbleTree=j,c.traversalTree=O,c.promiseSerialExecute=G,c.promiseAllSerial=R,c.isCalcError=H,c.formatCalcError=V,c.format=z,c.q$=Y,c.getUniqueArray=Z},"./dist/src/interfaces/conditionalFormatOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.c=void 0,n.c=0},"./dist/src/interfaces/interface.js":function(t,n){"use strict";var e,i,r,o,a,a,a,a;Object.defineProperty(n,"__esModule",{value:!0}),n.RelationshipMap=n.RowColumnStates=n.StateRuleDirection=n.ViewArea=n.DEFAULT_VIEW_NAME=void 0,n.DEFAULT_VIEW_NAME="defaultView",(a=e=n.ViewArea||(n.ViewArea={}))[a.colHeader=1]="colHeader",a[a.viewport=3]="viewport",(a=i=n.StateRuleDirection||(n.StateRuleDirection={}))[a.none=0]="none",a[a.row=1]="row",a[a.column=2]="column",a[a.both=3]="both",(a=r=n.RowColumnStates||(n.RowColumnStates={}))[a.hover=1]="hover",a[a.readonly=4]="readonly",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty",a[a.inserted=128]="inserted",a[a.updated=256]="updated",a[a.pin=1024]="pin",a[a.primaryKey=2048]="primaryKey",a[a.required=4096]="required",(a=o=n.RelationshipMap||(n.RelationshipMap={}))[a.OneToOne=0]="OneToOne",a[a.OneToMany=1]="OneToMany"},"./dist/src/interfaces/styleOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.s=void 0,n.s=0},"./dist/src/interfaces/validatorOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.v=void 0,n.v=0},"./dist/src/query.js":function(r,t,n){"use strict";var i,t,ot,Y,at,u,l,e,o,ut,s;function Z(t,n,e){var i,r,o,a,u,i,s,c,f,l;if(n&&0<(i=(0,ot.keys)(n)).length)for(r=0,o=i;r<o.length;r++)u=n[a=o[r]],(0,ot.isFormula)(u)&&(t=t.replace(new RegExp("\\[@"+a+"\\]","g"),u.substring(1)));if(e&&0<(i=(0,ot.keys)(e)).length)for(s=0,c=i;s<c.length;s++)l=e[f=c[s]],(0,ot.isFormula)(l)&&(t=t.replace(new RegExp("\\[@"+f+"\\]","g"),l.substring(1)));return t}function W(t,n,e){var i,r,o,a,u,i,s,c,f,l;if(n&&0<(i=(0,ot.keys)(n)).length)for(r=0,o=i;r<o.length;r++)u=n[a=o[r]],(0,ot.isFormula)(u)&&t===a&&(t=u);if(e&&0<(i=(0,ot.keys)(e)).length)for(s=0,c=i;s<c.length;s++)l=e[f=c[s]],(0,ot.isFormula)(l)&&t===f&&(t=l);return t}function Q(t,n){return t&&t[n]||n}function st(t){for(var n,e,n=[],e=0;e<t.length;e++)n[t[e]]=e;return n}function ct(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e=[t],i=0;i<n;){for(r=0,o=e.length;r<o;r++)if((a=e.shift()).childrenArray&&a.childrenArray[0])for(s=a.childrenArray[u=0];u<s.length;u++)c=s[u],e.push(c);i++}for(f=[],l=0,h=e;l<h.length;l++)f.push((d=h[l]).recordRowNumbers[0]);return{indexMap:f,queue:e}}function d(t,n,e){var i,t,i=t?n:e,t=t?e:n;return(0,ot.isNullOrUndefined)(i)&&(0,ot.isNullOrUndefined)(t)?0:(0,ot.isNullOrUndefined)(i)?-1:(0,ot.isNullOrUndefined)(t)?1:"number"==typeof i||i instanceof Date?i-t:t<i?1:i<t?-1:0}function a(t,n,u,s){for(var e,c,i,r,o,a,f,l,h,e=[t],c=0;c<n.length;){for(i=0,r=e.length;i<r;i++)if((o=e.shift()).sort(function(t,n){var e,i,r,o,a,e=0;if(u&&0<u.length){if(r=(i=u[c]||u[0])._f||i.field,0===(e=d(i.ascending,t[r],n[r])));}else if(s&&0<s.length)for(o=0,a=s;o<a.length;o++)if(r=(i=a[o])._f||i.field,0===(e=d(i.ascending,t[r],n[r])))return e;return e}),c<n.length-1)for(a=n[c+1].field,f=0,l=o;f<l.length;f++)h=l[f],e.push(h[a]);c++}}function M(t,n,e,i){for(var r,o,a,u,s,c,r,o={},a=0,u=(0,ot.keys)(t);a<u.length;a++)s=u[a],-1!==e.indexOf(s)?(c=i(s))!==s&&(t[c]=t[s],delete t[s]):-1===n.indexOf(s)&&(o[s]=t[s],delete t[s]);return o}function C(t,n,e,i){for(var r,o,r=i;0<=r;r--)if(t[o=e[r].caption||e[r].field]!==n[o])return;return 1}function c(w,y){var t,n;if(2<=y.length)for(t=function(e){for(var t,n,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,t=e===y.length-1?"$rows":y[e+1].field,n=[],i=y[e-1].caption||y[e-1].field,r=y[e].caption||y[e].field,o=y[e].summaryFields,a=o.map(function(t){return t.caption}),u=o.map(function(t){var n=(0,at.tse)(e);return t.caption+"_"+t.slice+n}),s=function(t){var n=(0,at.tse)(e);return n?t.substring(0,t.lastIndexOf(n)):t},c=0,f=w;c<f.length;c++)if(h=(l=f[c])[i],0!==n.length&&C(n[n.length-1],l,y,e-1)){for(M(l,a.concat(r,t),u,s),p=0,b=a;p<b.length;p++)g=b[p],n[n.length-1][g]+=l[g];n[n.length-1][r].push(l)}else{for((d=M(l,a.concat(r,t),u,s))[i]=h,v=0,m=a;v<m.length;v++)d[g=m[v]]=l[g];d[r]=[l],n.push(d)}w=n},n=y.length-1;0<n;n--)t(n);return w}function ft(t,n,e,i,r){var i,o;n=c(n,e),(i&&0<i.length||r&&0<r.length)&&a(n,e,i,r),n&&0<n.length&&(t[o=(i=e[0]).caption||i.field]=n)}function lt(E,D,t,R){var n,n,e,i,r,j,n,o,a,u,s,c,F,O,f,l,h,d,L,P,v,m,g,p,o,B,G,U,b,w,H,V,t,y,n,M,C,S,T,S,z,A,I,x,N,k,_,e={},i=[],n=E.select;if(n&&(o=n.fields,r=n.limit,j=n.skip,o))for(a=0,u=o;a<u.length;a++)s=u[a],(0<=D.indexOf(s)||0<=s.indexOf("."))&&i.push({value:s}),e[s]=!0;if(c=[],F=E.calculate)for(l=O=(f=0,ot.keys)(F);f<l.length;f++)h=l[f],d=F[h],d=R.Pbe(d)?(0,Y.parseWindowOverByOption)(d):d,c.push({caption:h,value:d}),e[h]&&(delete e[h],e[d]=!0);if(L=null==(n=t.schema)?void 0:n.dimensions)for(m=P=(v=0,ot.keys)(L);v<m.length;v++)g=m[v],p=L[g],c.push({caption:g,value:p}),e[g]&&(delete e[g],e[p]=!0);if(o=E.groupBy,B=[],o)for(G=null==(n=t.schema)?void 0:n.measures,U=function(t){for(var n,e,i,r,o,a,c,u,s,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,A,A,I,A,x,N,k,_,x,D,j,O,A,n=[],e=[],i=[],r=void 0,o=void 0,a=[],c={},u,s=0,f=(0,ot.keys)(t);s<f.length;s++)for(h=t[l=f[s]],d=[l],m=d="="!==l[v=0]&&0<=l.indexOf(",")?l.split(","):d;v<m.length;v++){if(b={field:g=W(p=g=m[v],F,L),summaryFields:[],caption:h.caption||p},h.summarize&&(b.summaryFields=h.summarize.map(function(t){for(var n,e,i,r,o,a,u,s,n,a=0,u=(0,ot.keys)(t);a<u.length;a++)"having"===(s=u[a])?o=Z(t[s],F):"pivot"===s?i=t[s]:(e=Z(Q(G,t[s]),F,L),c[r=s]=!0);return{formula:e,filter:o,slice:i,caption:r}})),w=h.calculate)for(C=y=(M=0,ot.keys)(w);M<C.length;M++)T=w[S=C[M]],T=Z(T=R.Pbe(T)?(0,Y.parseWindowOverByOption)(T):T,F),a.push({caption:S,value:T});if((A=h.where)&&(A=Z(A,F),e.push(A)),A=h.orderBy){for(x="ASC"===A[A=I=(0,ot.keys)(A)[0]],N=0,k=a;N<k.length;N++)if(I===(_=k[N]).caption&&R.Pbe(_.value)){I=(0,Y.parseWindowOverByOption)(_.value);break}i.push({field:I,ascending:x,_f:A})}if(r=h.includeDetailRows,o=!!E.nest,x=h.attributes)for(D=0,j=x;D<j.length;D++)O=j[D],c[O]=!0;n.push(b),A=h.caption||p,c[A]=!0}B.push({groupByInfos:n,groupFilterInfos:e,groupSortInfos:i,includeDetailRows:r,includeDetailRowsForNest:o,groupCalculateInfos:a,groupSelectFields:c})},b=0,w=o;b<w.length;b++)U(H=w[b]);if((t=E.where)&&(V=Z(t,F,L)),y=[],n=E.orderBy)for(M=0,C=n;M<C.length;M++){for(z="ASC"===(S=C[M])[S=T=(0,ot.keys)(S)[0]],A=0,I=c;A<I.length;A++)if(T===(x=I[A]).caption&&R.Pbe(x.value)){T=(0,Y.parseWindowOverByOption)(x.value);break}y.push({field:T,ascending:z,_f:S})}if(N={},k=E.window)for(_ in k)k.hasOwnProperty(_)&&(N[_]=(0,Y.parseWindowOverByOption)(k[_],!0));return{selectFields:e,relatedColumns:i,calculateColumns:c,windows:N,limit:r,skip:j,filterExpression:V,groupInfos:B,sortInfos:y}}function ht(t,n,e,i,r,o,a,u,s,c){var f,l,h,d,v;if(void 0===u&&(u=0),f=[],l=c.length,0<=(a=void 0===a?0:a))for(h=u,d=0===a?l:Math.min(u+a,l);h<d;h++)f.push((0,at.nse)(t,n,e,i,r,c[h],o,!0,!0,s));else for(h=l-1-u,v=Math.max(0,l+a-u);v<=h;h--)f.push((0,at.nse)(t,n,e,i,r,c[h],o,!0,!0,s));return f}function dt(t){for(var n,e,n=[],e=0;e<t;e++)n[e]=e;return n}function vt(t){var n,e,i,r,r;if(0===t.length)return"";if(1===t.length)return t[0];for(n=[],e=0,i=t;e<i.length;e++)r="="===(r=i[e])[0]?r.slice(1):r,n.push(r);return"=AND("+n.join(",")+")"}function mt(t,n,e){return"string"==typeof n?f(t,t.Ywt(n,0,0),e):[]}function f(t,n,e,i){for(var r,o,a,u,r=[],o=0,a=i||0;a<e.length;a++)u=e[a],!0===t.nMt(n,u,0)&&(r[o]=u,o++);return r}function gt(e,t,n,i,r,o,a){var u,s,c,f,u=(0,l.ese)(e,t,n,r,i);if(a=a||r.length,0===(o=o||0)&&a>=r.length)r.sort(function(t,n){return u(e,i,t,n)});else for((s=r.slice(o,a)).sort(function(t,n){return u(e,i,t,n)}),c=0,f=s.length;c<f;c++)r[c+o]=s[c]}function h(t,n){var t=new e.FieldManager(ut,t);return n=t.prepareFields(n),{fieldMgr:t,columnInfos:n}}function v(i,t,r){var n=i.POt;return new o.GroupManager(t,n.wEt.bind(n),i.QOt,function(t,n,e){gt(i,r,ut,n,t,e)},function(t,n,e){return f(i,t,n,e)})}function pt(t,n,e,i){var i,r,i,t,o,e,a,e,i=h(t,i),r=i.fieldMgr,i=i.columnInfos,t=v(t,n,i),o=r.buildGroupFields(n,e),e=t.groupBy(o,e),a=e.rootNode,e=e.indexMap;return r.transposeSliceFields(o),{rootNode:a,newIndexMap:e,fieldMgr:r,groupMgr:t,columnInfos:i=(0,u.ise)(i,r,n)}}function m(t){for(var n,e,i,r,n={},e=0,i=t;e<i.length;e++)n[(r=i[e]).name]=!0;return n}function S(t,n){for(var e,i,r,o,a,e=[],i,r=0,o=(0,ot.keys)(t);r<o.length;r++)"="!==(a=o[r])[0]&&0<=a.indexOf(",")?e.push.apply(e,a.split(",")):e.push(n&&t[a].caption||a);return e}function g(t,n){var e,i,r,o,e=[];if(Array.isArray(t))for(i=0,r=t;i<r.length;i++)o=r[i],e.push.apply(e,o[n]);else e.push.apply(e,t[n]);return e}function T(t,n){var e,i,r;if(!(n.length<=0)){for(e=[],i=t,r=0;r<n.length;r++)i=g(i,n[r]);return e=i}}function p(t,n,e){for(var i,r,o,a,u,s,c,f,i=n(),r=[],o=0;o<t.length;o++)if(0<(u=e(a=t[o])).length)for(s=0;s<u.length;s++)!1!==(f=i[c=u[s]]).nde&&r.push(f.options);return[r,[]]}function b(t){var n,e,n,e;return w(t[0]).windowOverInfos}function w(t){for(var n,e,i,r,o,a,u,u,s,c,c,f,l,h,n={},e=[],o=0;o<t.length;o++)i=(a=t[o]).partitionKey,r=a.orderKey,(0,ot.isNullOrUndefined)(n[a.partitionKey])&&(u={partitions:a.partitions,orderedFunctions:[]},n[a.partitionKey]={index:e.length,orderMap:{},windowOverInfo:u},e.push(u)),s=(u=n[a.partitionKey]).orderMap,(0,ot.isNullOrUndefined)(s[a.orderKey])&&(c={orders:a.orders,functions:[]},s[a.orderKey]={index:u.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:c},u.windowOverInfo.orderedFunctions.push(c)),c=a.frameKey+"__"+a.windowFormula,(0,ot.isNullOrUndefined)(s[a.orderKey].functionMap[c])&&(s[a.orderKey].functionMap[c]=!0,s[a.orderKey].orderFunctions.functions.push({orders:s[a.orderKey].orderFunctions.orders,windowOverFormula:a.windowOverFormula,windowFormula:a.windowFormula,windowFrame:a.windowFrame}));return f=function(t){var n,t,t,e,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[r];1<n.length&&(e=n[t=t.index],n.splice(t,1),n.push(e))},1<e.length?(h=e[o=(l=n[i]).index],e.splice(o,1),e.push(h),f(l)):1===e.length&&f(n[i]),{windowOverInfoMap:n,windowOverInfos:e}}function y(t,n){for(var e,i,e=0;e<n.length;e++)i=n[e],t.Xhe(i)}function A(t,n,e,i,r,o){for(var a,u,s,c,f,l,a,u=0,s=b(p(t,r,o));u<s.length;u++)I(f=(c=s[u]).partitions,l=c.orderedFunctions,n,e,i)}function bt(t,e,n,i){return y(e,t),A(t,function(t){i=pt(e,t,i,n).newIndexMap},function(t){gt(e,n,ut,t,i)},function(t,n){return n(e.XOt[t],i)},function(){return e.XOt},function(t){return e.Gbe(t)}),i}function I(t,n,e,i,r){var o,a,u,s,c;if((0,ot.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,e(t);else for(o=0;o<n.length;o++)for(u=(a=n[o]).orders,(0,ot.isArray)(u)&&0<u.length&&i(u),s=a.functions,c=0;c<s.length;c++)r(s[c].windowOverFormula,function(t,n){return t.evaluateWindowFunction(n)})}function x(t){for(var e,n,i,r,o,a,e=(0,at.ose)(t),n,i=function(n){n.sourceTable.name===t.name?(0,at.ose)(n.targetTable).forEach(function(t){var t=n.sourceRelationshipName+"."+t.value;e.push({name:t,value:t})}):n.targetTable.name===t.name&&(0,at.ose)(n.sourceTable).forEach(function(t){var t=n.targetRelationshipName+"."+t.value;e.push({name:t,value:t})})},r=0,o=t.QOt.relationships;r<o.length;r++)i(a=o[r]);return e}function N(t){for(var n,e,i,r,o,a,n,e={},i=0,r=(0,ot.keys)(t);i<r.length;i++)e[a=0<=(a=o=r[i]).indexOf(".")?o.replace(".","_"):a]=t[o];return e}function k(t){for(var n,e,i,r,o,a,u,s,n=0,e=t.groupBy;n<e.length;n++)for(i=e[n],o=0,a=r=Object.keys(i);o<a.length;o++)0<=(u=a[o]).indexOf(".")&&(i[s=u.replace(".","_")]=i[u],i[s].caption||(i[s].caption=u),delete i[u])}function Mt(t,n){var t=t._dataSource.options;n?(t.schema||(t.schema={}),t.schema.window=n):t.schema&&(delete t.schema.window,0===Object.keys(t.schema).length)&&delete t.schema}function wt(t,n){var t=t._dataSource.options,e=n;return t.schema?t.schema.window?(e=i(i({},t.schema.window),n),t.schema.window=e):t.schema.window=n:t.schema={window:n},e}function yt(t,n,e,i,r,o){var i,a,i=i||ht(e,r,ut,ut,ut,ut,0,0,!1,o),a=e.name+s+Math.floor(1e3*Math.random());return t.push(a),(e=n.addTable(a,{data:i})).fetchSync(),o=dt(e.length()),{table:e,viewColumnInfos:r=(0,at.ose)(e),viewIndexMap:o}}function Ct(t,n){for(var e,i,r,e=0,i=n;e<i.length;e++)-1<(r=i[e]).indexOf(s)&&t.removeTable(r)}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t=n("./dist/src/dataManager.js"),ot=n("./dist/src/dataSource/utils.js"),Y=n("./dist/src/table/windowOverField.js"),at=n("./dist/src/view/view.js"),u=n("./dist/src/view/view-group.js"),l=n("./dist/src/view/view-sort.js"),e=n("./dist/src/viewField/fieldManager.js"),o=n("./dist/src/viewField/groupManager.js"),ut=void 0,t.DataManager.prototype.query=function(t){var n,t,e,i,r,o,e;return"string"==typeof t?n=this.queries[t]:(n=t).name&&(this.queries[t.name]=t),t=this.Ube(n),n.nest&&(r=m(i=x(e=this.tables[n.from])),o=dt(e.length()),e=ht(e,i,ut,ut,ut,r,0,0,!1,o),this.Hbe(n.groupBy,n.nest,t,e,1)),t},t.DataManager.prototype.Hbe=function(t,n,e,i,r){var o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,o=1,a="nested_"+r+"_";if(t&&0<t.length&&n)for(u=0,s=t;u<s.length;u++)for(f=S(c=s[u],!1),l=S(c,!0),h=c[f[f.length-1]].includeDetailRows,v=0,m=d=T(e,l);v<m.length;v++)p=(g=m[v]).$rows.map(function(t){return N(i[t])}),b=a+o++,(w=this.addTable(b,{data:p})).fetchSync(),(y=(0,ot.clone)(n)).from=b,k(y),M=this.Ube(y),this.removeTable(b),this.Hbe(y.groupBy,y.nest,M,p,r+1),h||delete g.$rows,Object.assign(g,M)},t.DataManager.prototype.Ube=function(t){var n,e,i,r,o,a,F,t,u,s,c,f,L,B,l,h,d,v,m,P,g,G,U,p,H,t,b,w,s,c,f,t,y,l,V,z,Y,M,C,S,Z,W,T,A,Q,C,I,x,N,J,k,K,_,N,I,X,D,x,N,j,k,O,E,q,$,tt,R,nt,et,it,rt,n=this,e=n.tables[t.from];if(e){if(r=!(i=[]),t.unpivot&&(r=!0,e._dataSource.rse=e._dataSource._data,e.fetchSync(t.unpivot)),o=dt(e.length()),a=(0,at.ose)(e),u=(t=lt(t,F=n.relationships.filter(function(t){return t.sourceTable.name===e.name}).map(function(t){return t.sourceRelationshipName}),e.options,e)).selectFields,s=t.relatedColumns,c=t.calculateColumns,f=t.windows,L=t.limit,B=t.skip,l=t.filterExpression,h=t.groupInfos,d=t.sortInfos,0<s.length)for(v=0,m=s;v<m.length;v++)P=m[v],a.push(P);if(0<c.length)for(g=0,G=c;g<G.length;g++)U=G[g],a.push(U);if((p=f)&&0<Object.keys(f).length&&(H=(t=e._dataSource.options.schema)&&t.window,p=wt(e,p)),l&&(o=mt(e,l,o)),b=Object.keys(u).filter(function(t){return e.Pbe(t)}),w=function(o,t,a){t.forEach(function(t){for(var t,n,e,i,r,t=t.field,n,e=0,i=a.Gbe(t);e<i.length;e++)r=i[e],o.push(r)})},d&&0<d.length&&h.length<=0&&w(b,d,e),0<b.length&&(l&&(c=(s=a.reduce(function(t,n){return t[e.Pbe(n.value)?0:1].push(n),t},[[],[]]))[0],f=s[1],wt((t=yt(i,n,e,null,a=f,o)).table,p),e=t.table,o=t.viewIndexMap,a=t.viewColumnInfos.concat(c)),o=bt(b,e,a,o)),d&&0<d.length&&h.length<=0&&gt(e,a,ut,d,o),y={},0<(0,ot.keys)(u).length&&(l=ht(e,a,ut,ut,ut,u,L,B,!1,o))&&0<l.length&&(y.$r=l),0<h.length)for(V=st(o),z=o.slice(0),Y=a.slice(0),M=0;M<h.length;M++){if(S=(C=h[M]).groupByInfos,Z=C.groupSelectFields,W=C.groupCalculateInfos,T=C.groupFilterInfos,A=C.groupSortInfos,Q=C.includeDetailRows,C=C.includeDetailRowsForNest,x=(I=pt(e,S,o,a)).rootNode,N=I.newIndexMap,J=I.fieldMgr,k=I.groupMgr,o=N,a=K=I.columnInfos,0<(_=void 0,ot.keys)(Z).length){if(I=(N=ct(x,S.length)).indexMap,X=N.queue,_=ht(e,a,k,J,S,Z,0,0,!0,o=I),Q&&y.$r||C)for(D=0;D<_.length;D++)_[D].$rows=X[D].recordRowNumbers.map(function(t){return V[t]});if(x=A&&0<A.length||d&&0<d.length,0<W.length||0<T.length||x){for(j=(N=yt(i,n,e,_)).table,k=N.viewIndexMap,O=N.viewColumnInfos,wt(j,p),b=[],E=0,q=W;E<q.length;E++)for($=q[E],O.push($),R=0,nt=tt=j.Gbe($.value);R<nt.length;R++)et=nt[R],b.push(et);0<T.length&&(k=mt(j,it=vt(T),k)),A&&0<A.length?w(b,A,j):d&&0<d.length&&w(b,d,j),k=bt(b,j,O,k),ft(y,rt=ht(j,O,ut,ut,ut,ut,0,0,!1,k),S,A,d)}else ft(y,_,S)}o=z,a=Y}return Mt(e,H),r&&(e._dataSource._data=e._dataSource.rse,e.fetchSync(ut,!0)),Ct(n,i),y}},s="_VirtualTable_"},"./dist/src/relationship.js":function(t,n,e){"use strict";var i,f,r,o;function a(t,n,e,i,r,o){this.sourceTable=t,this.sourceFieldName=n,this.sourceRelationshipName=e,this.targetTable=i,this.targetFieldName=r,this.targetRelationshipName=o,e&&(this.sourceField=t.xOt(n,e,i,r,this)),o&&(this.targetField=i.xOt(r,o,t,n,this))}Object.defineProperty(n,"__esModule",{value:!0}),n.Relationship=void 0,i=e("./dist/src/interfaces/interface.js"),f=e("./dist/src/dataSource/utils.js"),r=void 0,a.prototype.Gf=function(t,n,e,i,r,o){return new a(t||this.sourceTable,n||this.sourceFieldName,e||this.sourceRelationshipName,i||this.targetTable,r||this.targetFieldName,o||this.targetRelationshipName)},a.prototype.NOt=function(t){return t===this.targetRelationshipName},a.prototype.VP=function(){this.sourceTable&&this.sourceTable.kOt(this),this.targetTable&&this.targetTable.kOt(this)},a.prototype.DOt=function(t){return this.relationshipMap===i.RelationshipMap.OneToMany&&t===this.sourceRelationshipName?i.RelationshipMap.OneToOne:this.relationshipMap},a.prototype._Ot=function(){var t,n,t=this.sourceTable,n=this.sourceFieldName;if(t.EOt())return t.jOt(n)&&!t.OOt()?i.RelationshipMap.OneToOne:i.RelationshipMap.OneToMany},a.prototype.ROt=function(t){var n=this.relationshipMap;return(0,f.isNullOrUndefined)(n)&&(n=this.relationshipMap=this._Ot()),(0,f.isNullOrUndefined)(n)?t:n===i.RelationshipMap.OneToOne?{uit:"object"}:{uit:"array"}},a.prototype.BOt=function(){var e,i,r,t,o,n,a,u,s;function c(t,n,e){t[n]?(t[n].push(e),t.uit="array"):t[n]=[e]}for(e=this.sourceField.LOt={uit:"object"},i=this.targetField.LOt=this.ROt({}),r=this.ROt({uit:"object"}),t=this.sourceTable.getDataSync(),o=this.targetTable.getDataSync(),n=0;n<t.length;n++)a=t[n][this.sourceFieldName],(0,f.isNullOrUndefined)(a)||c(r,a,n);for(u=function(n){var t=o[n][s.targetFieldName];(0,f.isNullOrUndefined)(t)||r[t]&&(i[n]=r[t],r[t].forEach(function(t){c(e,t,n)}))},s=this,n=0;n<o.length;n++)u(n);this.targetField.type=r.uit,this.sourceField.type=e.uit},a.prototype.dl=function(){this.sourceField.LOt=r,this.targetField.LOt=r,this.targetTable.FOt(),this.sourceTable.FOt()},n.Relationship=a},"./dist/src/res.en.js":function(t,n){"use strict";var e,i,n;function r(t,n){return{description:t,parameters:n}}function o(t,n,e,i){return{name:t,optional:n,repeatable:e,enum:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,n.resource={zve:{WINDOW:r("(TableSheet Specific) Determines the rows as the window by partitioning and ordering to apply the window function.",[o("window_function"),o("partition_by",!0),o("order_by",!0),o("frame_rows\\range\\groups",!0)]),WINDOWDEF:r("(TableSheet Specific) Define a shorthand that allow to be reused by the WINDOW function.",[o("partition_by",!0),o("order_by",!0),o("frame_rows\\range\\groups",!0)]),PARTITIONBY:r("(TableSheet Specific) Divides the rows into partitions.",[o("field_function",!(n=[{value:"0",description:"This is the default case, no rows are excluded."},{value:"1",description:"The current row is excluded, the other peers of the current row remain."},{value:"2",description:"The current row and the peers are all excluded."},{value:"3",description:"The current row remain, the other peers are excluded."}]),!0)]),ORDERBY:r("(TableSheet Specific) Defines the logical order in each partition.",[o("field_function",!(i=[{value:"-1",description:"Indicates the lower following of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@+n]",description:"Indicates the n following of the current, if the order is ascending."},{value:"[@-n]",description:"Indicates the n following of the current, if the order is descending."}]),!0)]),ORDERASC:r("(TableSheet Specific) Specifies ascending order for the specified field.",[o("field_function")]),ORDERDESC:r("(TableSheet Specific) Specifies descending order for the specified field.",[o("field_function")]),FRAMEROWS:r("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending rows against the current row.",[o("beginning_function",!(e=[{value:"-1",description:"Indicates the upper boundary of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@-n]",description:"Indicates the n preceding of the current, if the order is ascending."},{value:"[@+n]",description:"Indicates the n preceding of the current, if the order is descending."}]),!1,e),o("ending_function",!0,!1,i),o("exclude_mode",!0,!1,n)]),FRAMERANGE:r("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the value in the current row.",[o("beginning_function",!1,!1,e),o("ending_function",!0,!1,i),o("exclude_mode",!0,!1,n)]),FRAMEGROUPS:r('(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the counting "groups" relative to the current group.',[o("beginning_function",!1,!1,e),o("ending_function",!0,!1,i),o("exclude_mode",!0,!1,n)]),CUMEDIST:r("(TableSheet Specific) The cumulative distribution of a value within a group of values.",[]),W_PERCENTRANK:r("(TableSheet Specific) Calculates the percentage of the relative rank of a row within a partition of rows.",[]),ROWNUMBER:r("(TableSheet Specific) Returns the number of the current row within its partition.",[]),W_RANK:r("(TableSheet Specific) Returns the rank of each row within the partition of a result set.",[]),DENSERANK:r("(TableSheet Specific) Returns the rank of the current row within its partition, without gaps.",[]),LEAD:r("(TableSheet Specific) Provides access to the value from a row at a given physical offset that follows the current row.",[o("value_function"),o("offset",!0),o("default_value",!0)]),LAG:r("(TableSheet Specific) Provides access to the value from a row at a given physical offset that before the current row.",[o("value_function"),o("offset",!0),o("default_value",!0)]),NTILE:r("(TableSheet Specific) Divides a partition into N buckets, assigns each row its bucket number.",[o("n")]),FIRSTVALUE:r("(TableSheet Specific) Access to the value from the first row within the window frame.",[o("value_function")]),LASTVALUE:r("(TableSheet Specific) Access to the value from the last row within the window frame.",[o("value_function")]),NTHVALUE:r("(TableSheet Specific) Access to the value from the n-th row within the window frame.",[o("value_function"),o("n")]),CALCULATE:r("(TableSheet Grouping Specific) Expand the group context for the formula.",[o("formula"),o("remove_filters_function")]),REMOVEFILTERS:r("(TableSheet Grouping Specific) Select the context of the upper group level.",[o("group_field_function",!0,!0)]),CHILDREN:r("(TableSheet Hierarchy Specific) Retrieves the value of the children that be a certain offset from the parent.",[o("level_offset"),o("field_function")]),ONLYCHILDREN:r("(TableSheet Hierarchy Specific) Retrieves the value of the children that be not parent.",[o("field_function")]),PARENT:r("(TableSheet Hierarchy Specific) Retrieves the value of the parent that be a certain offset from the current.",[o("level_offset"),o("field_function")]),LEVEL:r("(TableSheet Hierarchy Specific) Retrieves the level of the current.",[]),LEVELROWNUMBER:r("(TableSheet Hierarchy Specific) Retrieves the row number of the current under its parent.",[])}}},"./dist/src/table/calcField.js":function(t,n,e){"use strict";var i,r,h,d,o,a,u;function s(t,n,e,i){var r,n,o,r=u.call(this)||this;if(r.eCe=0,r.calcSource=n.POt,r.calcService=r.calcSource.getCalcService(),r.GOt=t,(n=r.calcSource).Vbe=n.Vbe||[],n.Vbe.indexOf(t)<0){n.Vbe.push(t);try{o=r.expression=e||r.calcService.parse(r.calcSource,t,0,0),r.calcService&&o&&(r.w3=r.calcService.getGlobalSourceModel(),r.w3.cyt(r,0,0,o,o,!0))}catch(t){}n.Vbe.pop()}return r.Tl=[],r.zbe=(0,h.isNullOrUndefined)(i)?0:i,r}i=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CalcField=void 0,r=e("CalcEngine"),h=e("./dist/src/dataSource/utils.js"),d=void 0,u=r.BaseCalc,i(s,u),s.prototype.getKey=function(){var t=this;return"T:"+t.calcSource.nM.name+":"+t.GOt},s.prototype.vyt=function(){this.c_t().I3(this,3)},s.prototype.c_t=function(){return this.calcService},s.prototype.P6t=function(){this.C8()},s.prototype.C8=function(){this.Tl=[],this._me=d,this.eCe=0},s.prototype.getValue=function(t){var n,e,i;if(!this.expression)return"Invalid Formula";for((n=this.calcService).Ybe=n.Ybe||[],n.Zbe=n.Zbe||[],e=0;e<n.Ybe.length;e++)if(n.Ybe[e]===this&&n.Zbe[e]===t)return n.Wbe=!0,this.zbe;if(0!==n.Ybe.length||(i=this.Tl[t],(0,h.isUndefined)(i)&&!(0,h.isUndefined)(t))){this.calcSource.pe(t),n.Ybe.push(this),n.Zbe.push(t);try{i=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:t,col:0},1<n.Ybe.length)}catch(t){}n.Wbe?i=r.Errors.Calc:1===n.Ybe.length&&(this.Tl[t]=i),n.Ybe.pop(),n.Zbe.pop(),0===n.Ybe.length&&delete n.Wbe}return i},s.prototype.getValues=function(t,n,e,i,r,o){var a,u,s,c,f,l;if(n=(0,h.isNumber)(n)?n:0,e=(0,h.isNumber)(e)?e:t.length-1,a=[],this._me!==t||this.eCe!==t.length)for(u=t.length,this._me=t,this.eCe=u,s=0;s<u;s++)a.push(this.getValue(t[s]));if(0===a.length)if(i!==d&&r!==d){for(c=n;c<i;c++)a.push(this.Tl[t[c]]);for(o!==d&&a.push(this.Tl[t[o]]),c=r+1,f=e+1;c<f;c++)a.push(this.Tl[t[c]])}else for(c=n,l=e+1;c<l;c++)a.push(this.Tl[t[c]]);else a=a.slice(n,e+1),i!==d&&r!==d&&(o!==d?a.splice(i-n,r-i+1,a[o-n]):a.splice(i-n,r-i+1));return a},s.prototype.getValueWithContext=function(t){var n,t,n=this.calcSource.DJ,t=this.getValue(t);return this.calcSource.DJ=n,t},s.prototype.insertItem=function(t,n){},s.prototype.getOriginalValue=function(t){},s.prototype.getRelatedTable=function(){},s.prototype.getRelationMaps=function(){},s.prototype.getHostTableIndexes=function(t){},n.CalcField=s},"./dist/src/table/hierarchyField.js":function(t,n,e){"use strict";var i,r,o,a;function u(t,n){this.GOt=t,this.nM=n,this.UOt=new r.CalcField(this.l7t(),n),this.HOt=new o.TableField(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchyField=void 0,i=e("./dist/src/dataSource/utils.js"),r=e("./dist/src/table/calcField.js"),o=e("./dist/src/table/tableField.js"),u.prototype.getKey=function(){return this.UOt.getKey()},u.prototype.vyt=function(){this.UOt.vyt()},u.prototype.c_t=function(){return this.UOt.c_t()},u.prototype.P6t=function(){this.C8()},u.prototype.l7t=function(){return this.nM.isHierarchy()?this.nM._dataSource.l7t(this.GOt):void 0},u.prototype.C8=function(){var t=this.l7t();(0,i.isNullOrEmpty)(t)?this.UOt=null:(0,i.isNullOrUndefined)(this.UOt)||t!==this.UOt.GOt?this.UOt=new r.CalcField(t,this.nM):this.UOt.C8(),this.HOt=new o.TableField(this.GOt,this.nM)},u.prototype.zOt=function(t){var n,n,n=this.nM;if(n.isHierarchy())return n=n.SEt(t),!(0,i.isNullOrUndefined)(n)&&0<n.children.length},u.prototype.getValue=function(t){return(!(0,i.isNullOrUndefined)(this.UOt)&&this.zOt(t)?this.UOt:this.HOt).getValue(t)},u.prototype.getValues=function(t,n){for(var e,i,r,e=[],i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},u.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},u.prototype.setItemValue=function(t,n,e,i){this.HOt.setItemValue(t,n,e,i)},u.prototype.hasItem=function(t){this.HOt.hasItem(t)},u.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},u.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},u.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},u.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},u.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.HierarchyField=u},"./dist/src/table/table.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/table/tableEvents.js"),n),r(e("./dist/src/table/table.js"),n)},"./dist/src/table/table.js":function(t,n,e){"use strict";var i,r,o,p,a,u,s,h,v,m,c,w,f,l,d,e,g,b,y;function M(t,n,e){var i={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,onSucceeded:t,onFailed:n,onEnd:e,invoke:function t(){0===i.asyncCount&&i.syncDone&&(i.failedArgs?i.onFailed&&i.onFailed(i.failedArgs):i.onSucceeded&&i.onSucceeded(i.succeededArgs),i.onEnd)&&i.onEnd(i.succeededArgs||i.failedArgs)},execute:function t(n){n&&(i.onEnd=n),i.syncDone=!0,i.invoke()},suspend:function t(){return i.asyncCount++,{succeed:function t(n){i.succeededArgs=n,i.resume()},fail:function t(n){i.failedArgs=n,i.resume()}}},resume:function t(){i.asyncCount--,i.invoke()}};return i}function C(t,n){var e,i,r,o;for(e in t)if(t.hasOwnProperty(e))for(r in i=t[e],n)if(n.hasOwnProperty(r)&&i===(o=n[r])&&i.rb)return!0}function S(t,n){return C(n.views,t.VOt)}function T(t,n){return-1<t.indexOf("[".concat(n,"]"))||-1<t.indexOf("[@".concat(n))||-1<t.indexOf("[@[".concat(n))}function A(t,n,e,i){var r,o,a,t,u,s,c,f;if(0!==n){for(r=t&&"="===t[0]?function(t){return(0,p.formatCalcError)(i(t))}:i,t=e&&e.dataType,u=e&&e.dataMap,s=!!t,c=0;c<n;c++)f=r(c),u&&!(0,p.isNullOrUndefined)(u[f])&&(f=u[f]),s||(0,p.isNullOrUndefined)(f)||(a=f,s=!0),(o=o||{})[f=f instanceof Date?new Date(f.getFullYear(),f.getMonth(),f.getDate()).toISOString():f]||(o[f]=[]),o[f]&&o[f].push(c);return o.K$=t||(s?typeof a:"object"),o}}function I(t,n,e,i){var r,o,a,a,u;for(r in t)t.hasOwnProperty(r)&&(o=t[r],a=(a=i&&i[r])&&a.dataMap,o)&&(u=e[r],o[u=(u=a&&!(0,p.isNullOrUndefined)(a[u])?a[u]:u)instanceof Date?u.toISOString():u]?o[u].push(n):o[u]=[n])}function x(t,n,e,i,r,o){var t,e,o,t=t[e],e=o&&o.dataMap;t&&r!==i&&(e&&((0,p.isNullOrUndefined)(e[i])||(i=e[i]),(0,p.isNullOrUndefined)(e[r])||(r=e[r])),i instanceof Date&&(i=i.toISOString()),r instanceof Date&&(r=r.toISOString()),o=t[i])&&(1<o.length?o.splice(o.indexOf(n),1):delete t[i],t[r]?t[r].push(n):t[r]=[n])}function N(t,n,e){var i,r,o,a,u;for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]))for(o in r)if(r.hasOwnProperty(o)&&(0,p.isArray)(r[o])&&(a=r[o],(0,p.isArray)(a))){for(u=0;u<a.length;u++)a[u]>=n+e?a[u]-=e:a[u]>=n&&a[u]<n+e&&(a.splice(u,1),u--);0===a.length&&delete r[o]}}function k(t,n){var t;this.Qbe=void 0,this.YOt={},this.ZOt={},this.WOt=0,Object.defineProperty(this,"name",{get:function(){return this.Zc},set:function(t){var n,e,i,r,e,n=this.Zc;if(this.Zc=t,e=this.QOt){for(i in this.VOt)this.VOt.hasOwnProperty(i)&&(r=this.VOt[i]).KOt(n,t);delete(e=e.tables)[n],e[t]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(t){var n,n,e,n,i,e=this;e.JOt=!0,n=e.options,i=e.length(),e._dataSource.setDataSourceOptions(t,function(){e.ase(i,e.columns)}),e.pCe((null==(n=n.schema)?void 0:n.window)||{},(null==(n=t.schema)?void 0:n.window)||{})}}),this.name=t,t=n instanceof r.DataSource?n:new r.DataSource(n),this._dataSource=t,this.views={},this.VOt={},this.Pq=[],this.XOt={},this.qOt=l,this.JOt=!0,this.aT={}}function _(t){var n,t,e,i,n={data:t.data,remote:t.remote,autoSync:t.autoSync,batch:t.batch,schema:t.schema},t=t.remote;return t&&(e=n.remote={},(i=t.read)&&!(0,p.isFunction)(i)&&(e.read=i),(i=t.create)&&!(0,p.isFunction)(i)&&(e.create=i),(i=t.update)&&!(0,p.isFunction)(i)&&(e.update=i),(i=t.delete)&&!(0,p.isFunction)(i)&&(e.delete=i),i=t.batch)&&!(0,p.isFunction)(i)&&(e.batch=i),n}function D(){return null!==y&&y.apply(this,arguments)||this}i=this&&this.__extends||(b=function(t,n){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}b(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Table=n.updateFilterIndexesCacheOnRemove=n.updateFilterIndexesCacheOnUpdate=n.updateFilterIndexesCacheOnInsert=n.generateFilterIndexCache=n.isInCalcField=void 0,r=e("./dist/src/dataSource/dataSource.js"),o=e("./dist/src/calculation/calcSource.js"),p=e("./dist/src/dataSource/utils.js"),a=e("./dist/src/dataSource/dataSource.interface.js"),u=e("./dist/src/view/view.js"),s=e("./dist/src/interfaces/interface.js"),h=e("./dist/src/table/tableEvents.js"),v=e("./dist/src/table/calcField.js"),m=e("./dist/src/table/tableField.js"),c=e("./dist/src/table/hierarchyField.js"),w=e("./dist/src/table/windowOverField.js"),f=e("./dist/src/table/triggerCalcField.js"),l=null,d=void 0,n.isInCalcField=T,n.generateFilterIndexCache=A,n.updateFilterIndexesCacheOnInsert=I,n.updateFilterIndexesCacheOnUpdate=x,n.updateFilterIndexesCacheOnRemove=N,k.prototype._Et=function(t,n,e){var i,r,n;"="===(n=!(0,p.isNullOrUndefined)(n)&&""!==n?n:"*")[0]?(i=this.bEt(n)).Iwt(0,t,e):(r=(r=this.aT[n])||(this.aT[n]={}),n=t.getKey(),e?r[n]=t:delete r[n])},k.prototype.o_t=function(t,n){var e,i,e=function(t,n){for(var e in t)n&&e.startsWith("T:")||t[e].vyt()};if((0,p.isNullOrUndefined)(t))for(i in this.aT)this.aT[i]&&e(this.aT[i],n);else-1<t.indexOf(".")&&(t=t.split(".")[0]),e(this.aT[t]),e(this.aT["*"])},k.prototype.REt=function(t){var n,e;if(this.QOt=t)this.POt=new o.DataManagerCalcSource(t.Lp,this);else for(n in this.POt=l,this.VOt)this.VOt.hasOwnProperty(n)&&(e=this.VOt[n]).$Ot(this)},k.prototype.Ywt=function(t,n,e){var i=this.POt;return i.getCalcService().parse(i,t,n||0,e||0)},k.prototype.wde=function(t){var n=this.POt;return n.getCalcService().unparse(n,t,0,0)},k.prototype.nMt=function(t,n,e){var i=this.POt;return(0,p.isNumber)(n)&&i.pe(n),i.getCalcService().evaluateExpression(i,t,{row:n||0,col:e||0})},k.prototype._fe=function(t,n,e){var i=this.POt;return i.pe(n,d,d,e),i.getCalcService().evaluateExpression(i,t,{row:n||0,col:0})},k.prototype.getDataSync=function(t){return this._dataSource.tOt(t)},k.prototype.NEt=function(t,n){var e,i,r,o,a,u,e=this;if(t){if(0<=t.indexOf(e))return l}else{if(e.tRt)return e.tRt;i=!0,t=[],n=[]}for(t.push(e),n.push(new Promise(function(t){if(e.JOt)return e.fetch().finally(t);t(null)})),r=e.Pq,o=0;o<r.length;o++)(u=(a=r[o]).targetTable)&&u.NEt(t,n);if(i)return e.tRt=Promise.all(n),e.tRt},k.prototype.fetch=function(n){var e,i,r,e=this;return!0!==n&&void 0!==e.Qbe?e.Qbe:(e.BEt&&(i=e.columns),r=e.length(),e.Qbe=e._dataSource.load({reload:n}),e.Qbe.then(function(t){return e.ase(r,i,n),Promise.resolve(t)}).finally(function(){e.Qbe=void 0}))},k.prototype.isFetched=function(){return!this.JOt},k.prototype.cPt=function(t){var n,e,i,r,o,a,u,s,n=this,e={};if(t&&(i=n.columns))for(a=r=(o=0,p.keys)(i);o<a.length;o++)(s=i[u=a[o]]).value&&"="===s.value[0]&&(e[u]=s),"workTime"===s.value&&(e[u]=s),"TaskResources"===s.dataType&&(e[u]=s);return e},k.prototype.Kbe=function(e){var i,t,n,r,o,t,a,u,i=this,t=i._dataSource.options.schema,n=i.get(0),r=t&&t.columns;if(r)for(o in(0,p.isNullOrUndefined)(n)&&(n={}),r)n.hasOwnProperty(o)||r[o].spread||(n[o]=r[o]);n&&(t=(0,p.keys)(n),a=i.columns=i.cPt(!0),u=i.Pq=i.Pq.filter(function(t){return t.sourceField||t.targetField}),t.forEach(function(t){var n=e&&e[t];a[t]=i.nRt(t,n,r&&r[t]),u.push({name:t})}))},k.prototype.ase=function(t,n,e){var i,r,o,a,u,s,c,i=this,r=i._dataSource.options.schema;if((i.JOt||e)&&(i.Kbe(n),i.JOt=!1),e&&i.ARt(),r&&r.columns){for(u in a=[],o=r.columns)o[u]&&o[u].indexed&&a.push(u);i.eRt(a)}if(e&&i.clearIndexes(),i.createIndexes(i.qOt||[]),i.BEt=!1,i.dl(),e)for(c in i._dataSource.pOt(),s=i.views)s.hasOwnProperty(c)&&s[c].iM(t!==i.length());i.Jbe=d},k.prototype.fetchSync=function(t,n,e){var i,r,n,o,t,i=this,r=i.length(),n=i._dataSource.loadSync(t,n),o=d,t=(0,p.isNullOrUndefined)(t);return e&&(o=i.columns,t)&&i.Kbe(o),i.ase(r,o,!t),n},k.prototype.nRt=function(t,n,e){var o,i,r,a,o=this,i={jOt:!1};if(!(0,p.isNullOrUndefined)(n)){for(a in n)n.hasOwnProperty(a)&&!(0,p.isNullOrUndefined)(n[a])&&(i[a]=n[a]);r=n.W5,n.jOt&&(i.jOt=n.jOt)}return i.value=t,i.name=t,e&&"formula"===e.dataType&&(i.value="="===e.value[0]?e.value:"="+e.value,i.readonly=!0,i.caption=t),Object.defineProperty(i,"dataType",{get:function(){return r},set:function(t){var t;r!==t&&("rowOrder"!==r&&"rowOrder"!==t||!o.isHierarchy()||o.setHierarchyOptionChanged(),"formula"!==(r=t)&&o._dataSource.xjt(this.name,this.dataType,this.dataPattern),t=this.value,o.dl(t),o.rRt(t))}}),Object.defineProperty(i,"isPrimaryKey",{get:function(){return this.jOt},set:function(t){this.jOt!==t&&(this.jOt=t,o.qOt||(o.qOt=[]),o.qOt.slice().sort().join(",")!==o.Ljt(!0).slice().sort().join(","))&&o.createIndexes(o.qOt)}}),Object.defineProperty(i,"mappedName",{get:function(){return this.value},set:function(n){var e;this.value===n||(0,p.isNullOrEmpty)(n)||(e=this.value,o._dataSource.Njt(e,n),o.dl(e),o.rRt(n),o.oRt(e,n),o.aRt(e,n),o.Pq.forEach(function(t){t.name===e&&(t.name=n)}),o.qOt=(o.qOt||[]).map(function(t){return t===e?n:t}),o.columns[n]=o.columns[e],delete o.columns[e],this.name=this.value=n)}}),Object.defineProperty(i,"relationship",{get:function(){for(var t,n,e,i,t,n=0,e=o.QOt.relationships;n<e.length;n++){if((i=e[n]).sourceTable===o&&i.sourceFieldName===this.value)return{table:i.targetTable,field:i.targetFieldName,sourceName:i.sourceRelationshipName,targetName:i.targetRelationshipName};if(i.targetTable===o&&i.targetFieldName===this.value)return{table:i.sourceTable,field:i.sourceFieldName,sourceName:i.sourceRelationshipName,targetName:i.targetRelationshipName}}},set:function(t){for(var n,e,i,r,n,e=0,i=o.QOt.relationships;e<i.length;e++)if((r=i[e]).sourceRelationshipName===t.sourceName){o.QOt.removeRelationship(r.sourceRelationshipName);break}t.table&&t.field&&o.QOt.addRelationship(o,this.value,t.sourceName,t.table,t.field,t.targetName)}}),i},k.prototype.length=function(){return this._dataSource.length()},k.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},k.prototype.isInserted=function(t){return this._dataSource.isInserted(t)},k.prototype.isUpdated=function(t){return this._dataSource.isUpdated(t)||this.uRt(t)},k.prototype.getErrorInfo=function(t){return this._dataSource.getErrorInfo(t)},k.prototype.uRt=function(t){var n,e,i,r,o,r,a,u,s,n=this,e=n.Pq;for(n.WOt++,i=0;i<e.length;i++)if(o=(r=e[i]).targetTable,r=r.LOt,o&&S(o,n)&&r&&r[t]&&!o.WOt)for(a=0,u=r[t];a<u.length;a++)if(s=u[a],o.isUpdated(s))return n.WOt--,!0;n.WOt--},k.prototype.Xbe=function(){this.Pq.reduce(function(t,n){var n=n.CRt;return n&&t.push(n),t},[]).forEach(function(t){t.VP()})},k.prototype.qbe=function(t){for(var n,e,i,n=t.ltt(),e=0;e<n.length;e++)(i=n[e].CRt)&&(i.sourceTable===t?i.Gf(this):i.Gf(d,d,d,this))},k.prototype.kbe=function(){return this._dataSource.kbe()},k.prototype.$be=function(){var t,n,e,i,r,o,a,u,s,t=this.Jbe;if((0,p.isNullOrUndefined)(t)){for(n=this.name+"__TriggerFormula__"+Math.floor(1e3*Math.random()),(t=this.Jbe=new g(n,{data:[]})).REt(this.QOt),t.fetchSync(),t._dataSource.Lbe(this._dataSource.DEt),e=this._dataSource.jbe(),r=0,o=i=this._dataSource.DEt;r<o.length;r++)a=o[r],t.twe(a,e[a]);for(a in this.columns)this.columns.hasOwnProperty(a)&&(u=this.columns[a].value,(0,p.isFormula)(u))&&t.nwe(a,u);for(a in s=this._dataSource.Obe())s.hasOwnProperty(a)&&t.nwe(a,s[a]);t.dl()}return t},k.prototype.ewe=function(t,n,e){var i,r;if(!(0,p.isNullOrUndefined)(t)&&0<Object.keys(t).length){for(r in i=this.$be(),e?(i._dataSource.insertItem(0,e),i._dataSource.updateItem(0,n)):i._dataSource.insertItem(0,n),i.qbe(this),t)t.hasOwnProperty(r)&&(n[r]=i._getValueByField(r,0));i._dataSource.remove(0,1),i.dl(),i.Xbe()}},k.prototype.iwe=function(t){this.ewe(this._dataSource.jbe(),t)},k.prototype.rwe=function(t,n){var n,i,r,e,o,n=this.vRt(n),i=this._dataSource.jbe(a.TriggerWhenType.onNewAndUpdate),r=Object.keys(t),e=function(t){var e;i.hasOwnProperty(t)&&-1===(e=(0,f.getWatchedFields)(i[t])).indexOf("*")&&!r.some(function(n){return e.some(function(t){return t===n})})&&delete i[t]};for(o in i)e(o);this.ewe(i,t,n)},k.prototype.insertItem=function(n,e,i,t){var r,o,a,r=this;for(o in this.iwe(e),e)e.hasOwnProperty(o)&&this.o_t(o);this.ki(h.Events.ItemInserting,a={index:n,data:e}),this._dataSource.insertItem(n,e,function(t){r.sRt(n,e),r.cRt(n,e),r.dl(),r.Jhe(),r.ki(h.Events.ItemInserted,a),i&&i(t)},t)},k.prototype.updateItem=function(t,n,e,i){var r,o,a,u,s,c,f,l;for(s in this.rwe(n,t),r=[],o={},a={},u=[],n)n.hasOwnProperty(s)&&(c=n[s],f=this._getValueByField(s,t),(0,p.isNotDeepEqual)(c,f))&&(r=r.concat(this.sge(t,s)),a[s]=f,o[s]=c,u.push(s),this.o_t(s));this.ki(h.Events.ItemUpdating,l={index:t,data:o,originalData:a,changingFields:u}),this._dataSource.updateItemValues(t,o,this.owe(t,o,a,l,r,e),i)},k.prototype.owe=function(r,o,a,u,s,c){var f=this;return function(t){var n,e,i;for(n in o)o.hasOwnProperty(n)&&(e=a[n],i=o[n],f.lRt(r,e,i),f.hRt(r,n,e,i));f.dl(),f.Jhe(),f.uge(r,s),f.ki(h.Events.ItemUpdated,u),c&&c(t)}},k.prototype.fRt=function(n,e,i,r,o,a,u){var s=this;return function(t){s.lRt(n,e,i),s.hRt(n,r,e,i),s.dl(),s.Jhe(),s.uge(n,a),s.ki(h.Events.ItemUpdated,o),u&&u(t)}},k.prototype.dRt=function(t,n,e,i,r,o){var a,u,s,a=this.sge(t,e),u=n[e],s={index:t,data:n,field:e,originalValue:i,newValue:u};this.ki(h.Events.ItemUpdating,s),this._dataSource.updateItem(t,n,this.fRt(t,i,u,e,s,a,r),o)},k.prototype.updateItemValue=function(t,n,e,i,r){var o,a,u,s,s,a=this.sge(t,n),u=this._getValueByField(n,t),s=this.vRt(t);s[n]=e,this.ki(h.Events.ItemUpdating,s={index:t,data:s,field:n,originalValue:u,newValue:e}),this._dataSource.updateItemValues(t,((o={})[n]=e,o),this.fRt(t,u,e,n,s,a,i),r)},k.prototype.resetItem=function(n,t,e){var i,t,e,r,e,o,a,u,i=this,t=M(t,e);this.mRt(n,t.suspend),this._dataSource.isUpdated(n)&&(this.o_t(d,!0),e=t.suspend(),r=e.succeed,e=e.fail,o=this.vRt(n),a=this.gRt(n),u=this.sge(n),this.ki(h.Events.ItemResetting,{index:n}),this._dataSource.resetItem(n,function(t){i.pRt(n,o,a),i.dl(),i.Jhe(),i.uge(n,u),i.ki(h.Events.ItemReset,{index:n,originalData:o,dataBeforeChanged:a}),r(t)},e)),t.execute()},k.prototype.pRt=function(t,n,e){var i,r,o,a,a,i=this,r=i.columns;if(!(0,p.isNullOrUndefined)(n)&&!(0,p.isNullOrUndefined)(e))for(o in r)r.hasOwnProperty(o)&&(a=(a=r[o]).value instanceof Function?a.value.name:a.value,i.hRt(t,a,n[a],e[a]))},k.prototype.mRt=function(s,c){var f,l,t,n,f=this,l=f.Pq;for(f.WOt++,t=function(t){var t,i,t,n,e,r,o,a,u,a,t=l[t],i=t.targetTable,t=t.LOt;if(i&&S(i,f)&&t&&t[s]&&!i.WOt){for(n=[],e=0,r=t[s];e<r.length;e++)o=r[e],i.isInserted(o)?n.push(o):i.isUpdated(o)&&(u=(a=c()).succeed,a=a.fail,i.resetItem(o,u,a));0<n.length&&(n.sort(function(t,n){return n-t}),n.forEach(function(t){var n=c(),e=n.succeed,n=n.fail;i.qCt(t,1,e,n)}))}},n=0;n<l.length;n++)t(n);f.WOt--},k.prototype.saveItem=function(n,t,e){var i,t,e,r,e,r,o,e,i=this,t=M(t,e),e=t.suspend(),r=e.succeed,e=e.fail;this.bRt(n,r,e),(this._dataSource.isUpdated(n)||this._dataSource.isInserted(n))&&(r=t.suspend(),o=r.succeed,e=r.fail,this.ki(h.Events.ItemSaving,{index:n}),this._dataSource.saveItem(n,function(t){i.dl(),i.Jhe(),i.ki(h.Events.ItemSaved,{index:n}),o(t)},e)),t.execute()},k.prototype.bRt=function(t,n,e){var n,i,r,o,a,u,s,u,c,f,l,h,d,h,n=M(n,e),i=n.suspend,r=this,o=r.Pq;for(r.WOt++,a=0;a<o.length;a++)if(s=(u=o[a]).targetTable,u=u.LOt,s&&S(s,r)&&u&&u[t]&&!s.WOt)for(c=0,f=u[t];c<f.length;c++)l=f[c],(s.isUpdated(l)||s.isInserted(l))&&(d=(h=i()).succeed,h=h.fail,s.saveItem(l,d,h));n.execute(function(){return r.WOt--})},k.prototype.get=function(t){return this._dataSource.get(t)},k.prototype.nv=function(t){return this._dataSource.s7t(t)},k.prototype.mTe=function(){return this._dataSource.mTe()},k.prototype.remove=function(t,n,e,i){var r,o,a,u,a,r=this;void 0===n&&(n=1),u=(a=(o=M(function(){r.qCt(t,n,e,i)},i)).suspend()).succeed,a=a.fail,this.yRt(t,n,u,a),o.execute()},k.prototype.qCt=function(n,e,i,t){var r,o,a,r=this;this.o_t(d,!0),o=this.Zc,a={index:n,count:e,tableName:o},this.ki(h.Events.ItemRemoving,a),this._dataSource.remove(n,e,function(t){"number"==typeof t.removedCount&&(a.count=t.removedCount),r.dl(),r.Jhe(),r.wRt(),r.MRt(n,e),r.ki(h.Events.ItemRemoved,a),i&&i(t)},t)},k.prototype.yRt=function(s,c,t,n){var t,f,e,l,i,h,r,t=M(t,n),f=t.suspend,e=this,l=e.Pq;for(e.WOt++,i=function(t){var t,i,n,e,n,t,n,r,o,a,u,t=l[t],i=t.targetTable,n=t.CRt,e=t.LOt;if(i&&n.NOt(t.name)&&e&&h.uCe(s,c,e)&&!i.WOt){for(t=(n=f()).succeed,n=n.fail,r=[],o=void 0,a=function(t){var n=e[s+t];n&&(r=r.concat(Object.keys(n).map(function(t){return n[t]})))},u=0;u<c;u++)a(u);if(0===r.length)return"continue";r.sort(function(t,n){return n-t}),o=r.map(function(e){return function(t,n){i.remove(e,1,t,n)}}),(0,p.promiseSerialExecute)(o).then(t).catch(n)}},h=this,r=0;r<l.length;r++)i(r);t.execute(function(){return e.WOt--})},k.prototype.uCe=function(t,n,e){for(var i=0;i<n;i++)if(e[t+i])return!0;return!1},k.prototype.getChanges=function(){return this._dataSource.getChanges()},k.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},k.prototype.submitChanges=function(t,i,r){var o=this;return new Promise(function(n,e){o.SRt(t,function(t){n(t),i&&i(t)},function(t){e(t),r&&r(t)})})},k.prototype.SRt=function(i,n,e){var r,t,o,a,o,r=this,t=M(function(){r.wRt(),r.ki(h.Events.ChangesSubmitting,d),r._dataSource.submitChanges(function(t,n,e){i?i(t,n,e):r.ki(h.Events.ChangesSubmittedRowFailed,{index:t,reason:n,type:e})}).then(function(t){r.ki(h.Events.ChangesSubmitted,t),n(t)}).catch(function(t){e(t)})}),o=t.suspend(),a=o.succeed,o=o.fail;this.TRt(a,o),t.execute()},k.prototype.TRt=function(t,n){var t,e,i,r,o,a,u,a,a,s,a,t=M(t,n),e=t.suspend,i=this,r=i.Pq;for(i.WOt++,o=0;o<r.length;o++)u=(a=r[o]).targetTable,a=a.LOt,u&&a&&!u.WOt&&(s=(a=e()).succeed,a=a.fail,u.submitChanges(d,s,a));t.execute(function(){return i.WOt--})},k.prototype.cancelChanges=function(n,t){var e,i,e=this,i=M(function(){var t={isDataLengthChanged:e.isDataLengthChanged()};e.ki(h.Events.ChangesCancelling,d),e._dataSource.cancelChanges(),e.dl(),e.Jhe(),e.wRt(),e.ARt(),e.ki(h.Events.ChangesCancelled,t),n&&n(d)});this.IRt(i.suspend),i.execute()},k.prototype.IRt=function(t){var n,e,i,r,o,r,r,a,r,n=this,e=n.Pq;for(n.WOt++,i=0;i<e.length;i++)o=(r=e[i]).targetTable,r=r.LOt,o&&r&&!o.WOt&&(a=(r=t()).succeed,r=r.fail,o.cancelChanges(a,r));n.WOt--},k.prototype.xRt=function(t){return t instanceof v.CalcField||t instanceof c.HierarchyField||t instanceof f.TriggerCalcField},k.prototype.NRt=function(){var t,e,n,i,r,o,t=this.options.schema.hierarchy.column,e=[new RegExp("(\\[@)(".concat(t,")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)"))];for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(i=this.XOt[n])instanceof c.HierarchyField&&(i.C8(),e.push(new RegExp("(\\[@)(".concat(i.GOt,")\\]"))));for(n in r=function(t){var n;Object.prototype.hasOwnProperty.call(o.XOt,t)&&(n=o.XOt[t])instanceof v.CalcField&&e.some(function(t){return t.test(n.GOt)})&&n.C8()},(o=this).XOt)r(n)},k.prototype.FOt=function(){var t,n;for(t in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,t)&&(n=this.XOt[t],this.xRt(n)?n.C8():this.XOt[t]=d)},k.prototype.removeCalcCache=function(t){this.XOt[t]=d},k.prototype.dl=function(t,n){var e,i,r;if(t){for(e=this.XOt[t],this.xRt(e)?e.C8():this.XOt[t]=d,i=0;i<this.Pq.length;i++)if(t===(r=this.Pq[i]).name||t===r.sourceField)return void(r.LOt&&r.CRt.dl())}else for(this.FOt(),i=0;i<this.Pq.length;i++)(r=this.Pq[i]).CRt&&r.CRt.dl()},k.prototype.primaryKey=function(t){var t,n,e,i,r,o,a,u,s,c;if(0===arguments.length)return this.qOt||(this.Ljt(),this.createIndexes(this.qOt)),this.qOt.join(",");if(!(0,p.isNullOrUndefined)(t)&&(this.qOt=(this.qOt||[]).concat(t.split(",")),t=this._dataSource.options.schema,!(0,p.isNullOrUndefined)(t))){for(i in e=[],n=t.columns=t.columns||{})Object.prototype.hasOwnProperty.call(n,i)&&(r=n[i]).isPrimaryKey&&e.push(i);if(0===e.length)this.qOt.forEach(function(t){""===t||(0,p.isNullOrUndefined)(t)||(n[t]=n[t]||{},n[t].isPrimaryKey=!0)});else{for(o=0;o<e.length;o++)a=e[o],this.columns&&this.columns[a]&&(this.columns[a].isPrimaryKey=!0);for(u=this.qOt.slice().sort(),e.sort(),s=e,c=0;c<u.length||c<s.length;c++)if(u[c]!==s[c])return void(this.qOt=s)}}},k.prototype.getIndexes=function(){return(0,p.keys)(this.YOt)},k.prototype.kRt=function(){return(0,p.keys)(this.ZOt)},k.prototype.createIndexes=function(t){for(var n,e,i,r,n=this.YOt,e=0,i=t;e<i.length;e++)n[r=i[e]]||(n[r]=this.DRt(r))},k.prototype.eRt=function(t,n){for(var e,i,r,o,e=this.ZOt,i=0,r=t;i<r.length;i++)e[o=r[i]]&&!n||(e[o]=this._Rt(o))},k.prototype.dropIndexes=function(t){for(var n,e,i,r,n=this.YOt,e=0,i=t;e<i.length;e++)n[r=i[e]]&&delete n[r]},k.prototype.clearIndexes=function(){this.YOt={}},k.prototype.oRt=function(t,n){var e=this.YOt;(0,p.isNullOrUndefined)(e[t])||(e[n]=e[t],delete e[t])},k.prototype.ARt=function(){this.ZOt={}},k.prototype.aRt=function(t,n){var e=this.ZOt;(0,p.isNullOrUndefined)(e[t])||(e[n]=e[t],delete e[t])},k.prototype.wRt=function(){var t=this.getIndexes();this.clearIndexes(),this.createIndexes(t)},k.prototype.ERt=function(){var t=this.kRt();this.ARt(),this.eRt(t)},k.prototype.DRt=function(t){for(var n,e,i,r,o,e=this.length(),i=0;i<e;i++)(n=n||{})[o="string"!=typeof(o=(r=this.get(i))[t])?String(o):o]||(n[o]=[]),n[o]&&n[o].push(i);return n},k.prototype._Rt=function(n){var e=this;return A(n,this.length(),this.jRt(n),function(t){return e._getValueByField(n,t)})},k.prototype.ORt=function(t){return!!this.YOt[t]},k.prototype.search=function(t,n){if(!(0,p.isNullOrUndefined)(t)&&!(0,p.isNullOrUndefined)(n))return(0,p.isString)(t)||(t=String(t)),this.ORt(n)?this.RRt(t,n):this.BRt(t,n)},k.prototype.mEt=function(t){var e,n,i,r,o,a,e=this.primaryKey().split(",");if(0===e.length||!this.YOt[e[0]])return[];if(1===e.length)return this.YOt[e[0]][t];if((t=t.split("|")).length!==e.length)return[];for(n=0;n<t.length;n++)t[n]=t[n].trim();for(i={},r={},this.YOt[e[0]][t[0]].forEach(function(t){i[t]=1}),o=function(n){a.YOt[e[n]]&&a.YOt[e[n]][t[n]].forEach(function(t){i[t]===n&&(r[t]=n)}),i=r,r={}},a=this,n=1;n<t.length;n++)o(n);return Object.keys(i)},k.prototype.kEt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g;if(e){for(i={},r=0;r<n.length;r++)o=n[r],a=this._dataSource._data[o],i[o]=a&&a.data[t];for(s=0,c=u=this.QOt.relationships;s<c.length;s++)if((f=c[s]).sourceTable===this&&f.targetTable!==this){for(l={},h=f.sourceRelationshipName+".",m=d=(v=0,p.keys)(f.targetTable.columns);v<m.length;v++)l[g=m[v]]=f.sourceTable._getValueByField(h+g,t);i[f.sourceRelationshipName]=l}}else for(i=[],r=0;r<n.length;r++)i.push(this.rRt(n[r]).getValue(t));return i},k.prototype.ASt=function(t,n,e,i){for(var r,o,a,u,r=[],o=this.length(),a=0;a<o;a++)u=n&&this.rRt(n).getValue(a),n!==l&&u!==t&&String(u)!==t||r.push(this.kEt(a,e||this._dataSource.DEt,i));return r},k.prototype.BRt=function(t,n){for(var e,i,r,o,a,e=[],i=this.length(),r=0;r<i;r++)(a=(o=this.get(r))[n])!==t&&String(a)!==t||e.push(o);return e},k.prototype.RRt=function(t,n){var e,i,n,r,o,a,u,e,i,n=this.YOt[n][t],r=[];if(n)for(o=0,a=n;o<a.length;o++)u=a[o],r.push(this.get(u));return r},k.prototype.sRt=function(t,n){var e,i,r,o,e=this.YOt;for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&(r[o=n[i]]?r[o].push(t):r[o]=[t])},k.prototype.cRt=function(t,n){var e=this._dataSource.options.schema;I(this.ZOt,t,n,e&&e.columns)},k.prototype.lRt=function(t,n,e){var i,r,o,a,i=this.YOt;for(r in i)i.hasOwnProperty(r)&&(o=i[r])&&e!==n&&((a=o[n])&&1<a.length?a.splice(a.indexOf(t),1):delete o[n],o[e]?o[e].push(t):o[e]=[t])},k.prototype.hRt=function(t,n,e,i){x(this.ZOt,t,n,e,i,this.jRt(n))},k.prototype.cge=function(){var t,n,e,t=[];if(this.ZOt)for(e in n=this.ZOt)this.Pbe(e)&&t.push(e);return t},k.prototype.bCe=function(){var t=this.cge();t&&0<t.length&&this.eRt(t,!0)},k.prototype.wCe=function(t){var n,n;return!!(0,p.isFormula)(t)||"formula"===(null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.dataType)||this._dataSource.gCe(t)},k.prototype.sge=function(t,n){var e,i,r,e=[];if(this.ZOt)for(r in i=this.ZOt)this.wCe(r)&&(n===d||T(r,n)&&!this.Pbe(r))&&e.push({field:r,originValue:this._getValueByField(r,t)});return e},k.prototype.uge=function(t,n){var e,i,r;if(n&&0<n.length)for(e=0;e<n.length;e++)i=n[e].field,r=n[e].originValue,this.hRt(t,i,r,this._getValueByField(i,t))},k.prototype.MRt=function(t,n){N(this.ZOt,t,n)},k.prototype.LRt=function(t,n){var e,i,r,o,e=this.ZOt,i=e&&e[t];if(i)for(r in i)if(i.hasOwnProperty(r)&&(o=i[r],(0,p.isArray)(o))&&o.some(function(t){return t===n}))return r},k.prototype.jOt=function(t){return 0<=this.Ljt().indexOf(t)},k.prototype.OOt=function(){return 1<this.Ljt().length},k.prototype.EOt=function(){return 0<this.Ljt().length},k.prototype.Ljt=function(t){var t,n,e,i,r,o,a,u;if(!this.qOt||t)if(t=this._dataSource.options.schema,(0,p.isNullOrUndefined)(t)||(0,p.isNullOrUndefined)(t.columns)||0===Object.keys(t.columns).length)for(n in this.qOt=[],this.columns)this.columns[n].isPrimaryKey&&this.qOt.push(n);else{for(n in i=[],e=t.columns=t.columns||{})e.hasOwnProperty(n)&&(r=e[n]).isPrimaryKey&&i.push(n);for(this.qOt||(this.qOt=[]),o=this.qOt.slice().sort(),i.sort(),a=i,u=0;u<o.length||u<a.length;u++)if(o[u]!==a[u]){this.qOt=a;break}}return this.qOt},k.prototype.defaultView=function(){var i=this;return i.FRt?Promise.resolve(i.FRt):new Promise(function(e,t){i.fetch().then(function(t){var n,n,n,n=i.get(0),n=(0,p.keys)(n),n=i.addView(s.DEFAULT_VIEW_NAME,n);i.FRt=n,e(n)})})},k.prototype.addView=function(t,n,e,i){var n=new u.View(t,n,e,i);return(this.views[t]=n).PRt(this),n},k.prototype.GRt=function(t,n){var n=new u.View(t,n);return n.PRt(this),this.QOt.rV[t]=n},k.prototype.removeView=function(t){var n=this.views;n[t].PRt(l),delete n[t],this.URt(t)},k.prototype.URt=function(t){var n,e,i,n=this.QOt.tables;for(e in n)n.hasOwnProperty(e)&&delete(i=n[e]).VOt[t]},k.prototype.HRt=function(t){return this.views[t]},k.prototype.zRt=function(t){for(var n,e,i,n=0,e=this.Pq;n<e.length;n++)if((i=e[n]).name===t)return i;return null},k.prototype.Ole=function(t){for(var n,e,i,n=0,e=this.Pq;n<e.length;n++)if((i=e[n]).name.toUpperCase()===t.toUpperCase())return{field:i,fieldName:i.name};return null},k.prototype.VRt=function(t){var n,e,i,n=this.getDataSync(t),e=[];if(t)for(i=0;i<t.length;i++)e.push(n[t[i]]);else for(i=0;i<n.length;i++)e.push(n[i]);return e},k.prototype.vRt=function(t){return this.VRt([t])[0]},k.prototype.gRt=function(t){return this._dataSource.lOt(t)},k.prototype.YRt=function(t,n){for(var e,i,e=[],i=0;i<n.length;i++)e.push(this._getValueByField(t,n[i]));return e},k.prototype.twe=function(t,n){var e=this.XOt[t];return e&&e instanceof f.TriggerCalcField||(this.XOt[t]=e=new f.TriggerCalcField(t,n,this)),e},k.prototype.bEt=function(t){var n;return this.XOt[t]||!this.CEt()||(0,p.isNullOrEmpty)(this._dataSource.l7t(t))||(this.XOt[t]=new c.HierarchyField(t,this)),this.XOt[t]||"="!==t[0]||this.Xhe(t),this.XOt[t]||("="===(null==(n=this.awe(t))?void 0:n[0])?(this.Xhe(n),this.XOt[t]=new v.CalcField(n,this)):"="===t[0]?this.XOt[t]=new v.CalcField(t,this):this.XOt[t]=new m.TableField(t,this)),this.XOt[t]},k.prototype.Gbe=function(t){return(0,p.isNullOrEmpty)(t)||!(0,p.isString)(t)?[]:(0,w.addWindowOverFormulas)(this.POt,this.awe(t))},k.prototype.awe=function(t){var n,n,n;return(0,p.isFormula)(t)?t:(n=null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.value,(0,p.isFormula)(n)?n:this._dataSource.Ebe(t))},k.prototype.Pbe=function(t){return!(0,p.isNullOrEmpty)(t)&&("object"==typeof t&&"string"==typeof t.aggregate||0<this.Gbe(t).length)},k.prototype.nwe=function(t,n){var e=this.XOt[t];return e&&e instanceof v.CalcField||(this.XOt[t]=e=new v.CalcField(n||t,this)),e},k.prototype.Cve=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,n=this.XOt;if(t.D5?e=t.D5:(e="="!==(e=this.wde(t))[0]?"="+e:e,t.D5=e),o=(r=e).indexOf("=[@"),a=e.lastIndexOf("]"),u=0===o&&a===e.length-1){for(l=f=!1,h=s=o+3,d=c=a-1;h<d&&("["!==e[h]&&s===o+3&&(f=!0,o=h),"]"!==e[d]&&c==a-1&&(l=!0,a=d),!f||!l);h++,d--);r=e.slice(o,a+1)}return i=n[r],(0,p.isNullOrUndefined)(i)&&(i=n[r]=u?new m.TableField(r,this):new v.CalcField(r,this,t)),u?function(t){return i.getValue(t)}:function(t){return i.getValueWithContext(t)}},k.prototype.uwe=function(t,n){var e,i,r,o,o,e=this;if(!(0,p.isNullOrEmpty)(t)&&!(0,p.isNullOrUndefined)(n)&&0!==n.length)for(i=1===n.length&&(0,w.isWindowOverFormula)(t),r=0;r<n.length;r++)o=n[r],o=(0,w.deconstructWindowOverFunction)(e,o),i&&(o.originalWindowOverFormula=t),e.qhe(o.windowOverFormula,o)},k.prototype.Xhe=function(t){var n,e,n=this;return!this.XOt[t]&&0<(e=n.Gbe(t)).length&&(n.uwe(n.awe(t),e),!0)},k.prototype.qhe=function(t,n){var e,i,r,o,a,u,s;if(!(this.XOt[t]&&this.XOt[t]instanceof w.WindowOverCalcField)){if(e=n.partitions,i=n.orders,(0,p.isArray)(e))for(r=0;r<e.length;r++)o=e[r],this.columns[o.field]||this.rRt(o.field);if((0,p.isArray)(i))for(r=0;r<i.length;r++)a=i[r],this.columns[a.field]||this.rRt(a.field);u=n.formulaFromWindowChaining||t,s=this.XOt[u],(0,p.isNullOrUndefined)(s)&&(s=new w.WindowOverCalcField(u,this,n)),this.XOt[u]=s,this.XOt[t]=s,(0,p.isNullOrUndefined)(n.originalWindowOverFormula)||(this.XOt[n.originalWindowOverFormula]=s)}return this.XOt[t]},k.prototype.pCe=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,e=Object.keys(t),i=Object.keys(n),r=[],o=0,a=e.concat(i);o<a.length;o++)if(u=a[o],!n.hasOwnProperty(u)||t[u]!==n[u])for(c=0,f=s=Object.keys(this.XOt);c<f.length;c++)if(l=f[c],(h=this.XOt[l])instanceof w.WindowOverCalcField&&h.options.windowDefineName===u&&-1<l.indexOf('"'.concat(u,'"'))){for(delete this.XOt[l],d=0,v=Object.keys(this.XOt);d<v.length;d++)m=v[d],this.XOt[m]===h&&delete this.XOt[m];r.push(l)}for(g=0,p=r;g<p.length;g++)this.Xhe(b=p[g])},k.prototype.Jhe=function(){this.$he(!0)&&this.bCe()},k.prototype.$he=function(t){},k.prototype.fme=function(){return 1===Object.keys(this.views).length},k.prototype.ZRt=function(t){var t=this.XOt[t];return t&&t.setValue},k.prototype.WRt=function(t,n,e){this.rRt(t);var i=this.XOt[t];return this.o_t(t),i&&i.setValue&&i.setValue(n,e)},k.prototype.QRt=function(t,n,e,i,r){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.setItemValue&&o.setItemValue(n,e,i,r)},k.prototype.KRt=function(t,n){this.rRt(t);var t=this.XOt[t];return t&&t.hasItem&&t.hasItem(n)},k.prototype.JRt=function(t,n,e,i,r){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.insertItem&&o.insertItem(n,e,i,r)},k.prototype._getValueByField=function(t,n,e){return this.rRt(t),this.XOt[t].getValue(n,e)},k.prototype.XRt=function(t,n){return this.rRt(t),this.XOt[t].getOriginalValue(n)},k.prototype.swe=function(t,n){return this.rRt(t),this.XOt[t].getRelatedModelIndex(n)},k.prototype.qRt=function(t){return this.rRt(t),this.XOt[t].getRelatedTable()},k.prototype.$Rt=function(t){return this.rRt(t),this.XOt[t].getRelationMaps()},k.prototype.tBt=function(t){for(var n,e,i,r,o,a,n=this,e,i,r=0,o=n.QOt.relationships;r<o.length;r++){if((a=o[r]).sourceTable===n&&a.sourceFieldName===t)return a.targetTable;if(a.targetTable===n&&a.targetFieldName===t)return a.sourceTable}},k.prototype.nBt=function(t,n){return this.rRt(t),this.XOt[t].getHostTableIndexes(n)},k.prototype.rRt=function(t){return this.XOt[t]||this.bEt(t),this.XOt[t]},k.prototype.xOt=function(t,n,e,i,r){var n={name:n,sourceField:t,targetTable:e,targetField:i,CRt:r};return this.Pq.push(n),n},k.prototype.kOt=function(t){for(var n=this.Pq.length-1;0<=n;n--)this.Pq[n].CRt===t&&this.Pq.splice(n,1)},k.prototype.eBt=function(){for(var t,n,e,i,t=[this],n=this.Pq,e=0;e<n.length;e++)i=n[e].targetTable,-1===t.indexOf(i)&&t.push(i);return t},k.prototype.iBt=function(n){var e,t,i,e=this,t=e.Pq,i={};return t.forEach(function(t){var t=t.name;i[t]=e._getValueByField(t,n)}),i},k.prototype.ltt=function(){return this.Pq},k.prototype.rBt=function(t){var t=this.jRt(t);return t&&t.dataType},k.prototype.jRt=function(t){var n,e,i,n=this,e=n._dataSource.options.schema;return e&&e.columns&&e.columns[t]?i=e.columns[t]:(0,p.isNullOrUndefined)(n.columns)||(i=n.columns[t]),i},k.prototype.oBt=function(t){var n,e,t;return 0===t.length?[]:((t=(e=(n=this).zRt(t[0]))&&e.targetTable?e.targetTable.oBt(t.slice(1)):[]).unshift(e),t.filter(function(t){return!(0,p.isNullOrUndefined)(t)}))},k.prototype.toJSON=function(){var t,n,e,t=this.views,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e].toJSON());return{name:this.name,dataSourceOption:_(this._dataSource.options),primaryKey:this.primaryKey(),views:n,columns:this.aBt(this.columns)}},k.prototype.fromJSON=function(t){for(var e,t,n,i,r,o,a,e=this,n,i=0,r=t.views;i<r.length;i++)o=r[i],(a=this.addView(o.name,o.columns,!1,o.options)).fromJSON(o);return this.columns=t.columns,this.columns&&Object.keys(this.columns).forEach(function(t){var n;"="===t[0]&&e.columns[t]&&e.columns[t].value===t&&e.columns[t].caption&&"="!==e.columns[t].caption[0]&&(n=e.columns[t].caption,e.columns[n]=e.columns[t],delete e.columns[t])}),this.primaryKey(t.primaryKey),null!=(t=this.options)&&t.remote&&!this.options.remote.read?Promise.resolve(null):this.fetch()},k.prototype.bind=function(t,n){this._dataSource.bind(t,n)},k.prototype.unbind=function(t,n){this._dataSource.unbind(t,n)},k.prototype.ki=function(t,n){return this._dataSource.ki(t,n)},k.prototype.vOt=function(t){return this._dataSource.vOt(t)},k.prototype.aBt=function(t){var n,e;for(n in t)t.hasOwnProperty(n)&&!(0,p.isNullOrUndefined)(t[n])&&((e=t[n]).W5=e.dataType);return t},k.prototype.z7t=function(t,n,e){return this._dataSource.z7t(t,n,e)},k.prototype.V7t=function(t){return this._dataSource.V7t(t)},k.prototype.d7t=function(t,n,e){return this._dataSource.d7t(t,n,e)},k.prototype.uBt=function(){return this._dataSource.$jt()},k.prototype.qX=function(){return this._dataSource.qX()},k.prototype.m7t=function(t,n,e,i){return this.CEt()&&this.NRt(),this._dataSource.m7t(t,n,e,i)},k.prototype.CEt=function(){return this._dataSource.isHierarchy()},k.prototype.isHierarchy=function(){return this.CEt()},k.prototype.getHierarchyType=function(){return this._dataSource.Fjt()},k.prototype.isHierarchyOptionChanged=function(){return this._dataSource.a7t()},k.prototype.setHierarchyOptionChanged=function(){this._dataSource.u7t()},k.prototype.rebuildHierarchyStructure=function(){return this._dataSource.load({reload:!0})},k.prototype.SEt=function(t){return this._dataSource.SEt(t)},k.prototype.f7t=function(){return this._dataSource.f7t()},k.prototype.getHierarchyRootNode=function(){return this.f7t()},k.prototype.M7t=function(t){this._dataSource.M7t(t),this.NRt()},k.prototype.S7t=function(t,n){this._dataSource.S7t(t,n),this.NRt()},k.prototype.O7t=function(t,n){return this._dataSource.O7t(t,n)},k.prototype.L7t=function(t,n){return this._dataSource.L7t(t,n)},k.prototype.F7t=function(t,n){return this._dataSource.F7t(t,n)},k.prototype.G7t=function(t,n){return this._dataSource.G7t(t,n)},k.prototype.Xme=function(t){return this._dataSource.Xme(t)},k.prototype.H7t=function(t){return this._dataSource.H7t(t)},k.prototype.h7t=function(t,n){return this._dataSource.h7t(t,n)},k.prototype.isColumnSpreadChanged=function(){return this._dataSource.Cue()},k.prototype.setColumnSpreadChanged=function(t){this._dataSource.Sue(t)},n.Table=e=k,i(D,y=e),D.prototype.getDataSync=function(t){var n,e,i,r,n=[];if(t)for(e=0;e<t.length;e++)n.push(this._dataSource.Fbe(t[e]));else for(i=0,r=this._dataSource.length();i<r;i++)n.push(this._dataSource.Fbe(i));return n},g=D},"./dist/src/table/tableEvents.js":function(t,n){"use strict";var e;function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Events=void 0,i.ItemInserting="ItemInserting",i.ItemInserted="ItemInserted",i.ItemUpdating="ItemUpdating",i.ItemUpdated="ItemUpdated",i.ItemResetting="ItemResetting",i.ItemReset="ItemReset",i.ItemSaving="ItemSaving",i.ItemSaved="ItemSaved",i.ItemRemoving="ItemRemoving",i.ItemRemoved="ItemRemoved",i.ChangesSubmitting="ChangesSubmitting",i.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",i.ChangesSubmitted="ChangesSubmitted",i.ChangesCancelling="ChangesCancelling",i.ChangesCancelled="ChangesCancelled",n.Events=i},"./dist/src/table/tableField.js":function(t,n,e){"use strict";var c,s,f,i;function l(a,u,s){return function(t,n,e,i){var r=a.map[t],o=r;return(0,c.isNullOrUndefined)(o)&&(r=a.map[t]=[]),n[u.targetField]=s._getValueByField(u.sourceField,t),a.relatedTable.JRt(a.subField,void 0,n,function(t){r.push(t.index),t.index=r.length-1,e&&e(t)},i)}}function r(t,a){var r,u,o,t,t,r=this;this.Oit=[],u="string"==typeof t?t.split("."):t,!(o=u[0]&&a.zRt(u[0]))&&u[0]&&(t=a.Ole(u[0]))&&(o=t.field,u[0]=t.fieldName),o&&o.targetTable?(this.relatedTable=o.targetTable,this.map=o.LOt,this.setValue=null,this.map||(o.CRt.BOt(),this.map=o.LOt),this.getRelationMaps=function(){var t=[{name:o.name,relationshipMap:o.CRt.DOt(o.name)}];if(this.relatedTable)return this.subField?t.concat(this.relatedTable.$Rt(this.subField)):t},this.getHostTableIndexes=function(t){var n,e,t,e,i,n=[t];return this.relatedTable?(this.subField&&(n=this.relatedTable.nBt(this.subField,t)),t=void 0,t=(e=o.CRt).targetTable===this.relatedTable?e.targetRelationshipName:e.sourceRelationshipName,e=this.relatedTable.zRt(t),i=e.LOt,n.reduce(function(t,n){return t.concat(i[n])},[])):n},this.getRelatedModelIndex=function(t){var t=this.map[t];if(!(0,c.isNullOrUndefined)(t))return this.relatedTable.swe(this.subField,t[0])},"object"===o.type?1===u.length?(this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.vRt(t[0])},this.setValue=function(t){var n=t[u[0]];return t[o.sourceField]=n?n[o.targetField]:null,t}):(this.subField=u.slice(1).join("."),this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable._getValueByField(r.subField,t[0],!0)},this.getOriginalValue=function(t){var t=this.map[t];return(0,c.isNullOrUndefined)(t)?s:this.relatedTable.XRt(this.subField,t[0])},this.setItemValue=function(t,n,e,i){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.QRt(r.subField,t[0],n,e,i)},this.hasItem=function(t){var t=r.map[t];return!(0,c.isNullOrUndefined)(t)&&r.relatedTable.KRt(r.subField,t[0])},this.insertItem=l(this,o,a)):1===u.length?this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?[]:r.relatedTable.VRt(t)}:(t=u[1]-1,isNaN(t)?(this.subField=u.slice(1).join("."),this.getValue=function(t){var t=r.map[t];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.YRt(r.subField,t)},this.getOriginalValue=function(t){var t=this.map[t];return(0,c.isNullOrUndefined)(t)?s:this.relatedTable.XRt(this.subField,t)},this.hasItem=function(t){var t=r.map[t];return t&&0<t.length},this.insertItem=l(this,o,a)):2===u.length?(this.arrayFieldIndex=u[1]-1,this.getValue=function(t){var t,t,t=r.map[t],t=t&&t[r.arrayFieldIndex];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable.vRt(t)}):(this.arrayFieldIndex=t,this.subField=u.slice(2).join("."),this.getValue=function(t){var t,t,t=r.map[t],t=t&&t[r.arrayFieldIndex];return(0,c.isNullOrUndefined)(t)?s:r.relatedTable._getValueByField(r.subField,t)},this.getOriginalValue=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];return(0,c.isNullOrUndefined)(t)?s:this.relatedTable.XRt(this.subField,t)},this.setItemValue=function(t,n,e,i){var t,t,t=r.map[t],t=t&&t[r.arrayFieldIndex];if(!(0,c.isNullOrUndefined)(t))return r.relatedTable.QRt(r.subField,t,n,e,i)},this.getRelatedModelIndex=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];if(!(0,c.isNullOrUndefined)(t))return this.relatedTable.swe(this.subField,t)}))):(0===u.length?this.getValue=function(t){return a._dataSource.get(t)}:1===u.length?(this.getValue=function(t){return a._dataSource.getFieldValue(u[0],t)},this.getOriginalValue=function(t){return a._dataSource.getFieldOriginalValue(u[0],t)},this.getRelatedTable=function(){return a},this.setItemValue=function(t,n,e,i){return a.updateItemValue(t,u[0],n,e,i)},this.hasItem=function(t){return a._dataSource.length()>t},this.insertItem=function(t,n,e,i){var r=(0,c.isNullOrUndefined)(t)?a.length():t;return a.insertItem(r,n,function(t){t.index=r,e&&e(t)},i)},this.setFieldValue=function(t,n,e){var t;a._dataSource.updateItemValues(t,((t={})[n]=e,t))}):(this.getValue=function(t){for(var n,e,n=a._dataSource.getFieldValue(u[0],t),e=1;n&&e<u.length;e++)n=(0,c.isArray)(n)?n[u[e]-1]:n[u[e]];return n},this.setItemValue=function(t,n,e,i){var r,o,o,o=a._getValueByField(u[0],t);if(!(0,c.isNullOrUndefined)(o))return o=(0,c.clone)(o,!0),this.setValue(((r={})[u[0]]=o,r),n),a.updateItemValue(t,u[0],o,e,i)}),this.setValue=function(t,n){for(var e,i,r,o,e=t,i=t,r=u.length,o=0;i&&o<r;o++)e=(0,c.isArray)(i)?i[u[o]-1]:i[u[o]],o!==r-1&&(i=e);return i!==e&&(e!==n||(0,c.isNullOrUndefined)(e)&&(0,c.isNullOrUndefined)(n))&&(i[u[r-1]]=n),t})}Object.defineProperty(n,"__esModule",{value:!0}),n.TableField=void 0,c=e("./dist/src/dataSource/utils.js"),s=null,f=void 0,r.prototype.getValue=function(t){return null},r.prototype.getValues=function(t,n,e,i,r,o){var a,u,e;if(n=(0,c.isNumber)(n)?n:0,e=(0,c.isNumber)(e)?e:t.length-1,(a=this.Oit).length!==t.length||this._me!==t)for(this._me=t,this.Oit=a=[],u=a.length;u<t.length;u++)a.push(this.getValue(t[u]));return e=a.slice(n,e+1),i!==f&&r!==f&&(o!==f?e.splice(i-n,r-i+1,e[o-n]):e.splice(i-n,r-i+1)),e},r.prototype.setValue=function(t,n){return null},r.prototype.setItemValue=function(t,n,e,i){},r.prototype.setFieldValue=function(t,n,e){},r.prototype.hasItem=function(t){},r.prototype.insertItem=function(t,n){},r.prototype.getOriginalValue=function(t){return null},r.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.qRt(this.subField):this.relatedTable},r.prototype.getRelationMaps=function(){return[]},r.prototype.getHostTableIndexes=function(t){return[t]},r.prototype.getRelatedModelIndex=function(t){return t},n.TableField=r},"./dist/src/table/triggerCalcField.js":function(t,n,e){"use strict";var r,o,a,u,s,c,i;function f(t,n,e){var i,n,t;this.GOt=t,this.nM=e,this.HOt=new c.TableField(t,e),i="=[@".concat(t,"]"),n?(this.MU=n,this.cwe=n.when===a.TriggerWhenType.onNewAndUpdate,this.cwe&&(this.fwe=h(n),this.lwe=-1<n.fields.indexOf("*"),this.hwe=this.lwe||-1<this.fwe.indexOf(t)),i=n.formula,n=["[@".concat(t,"]"),"[@[".concat(t,"]]")],(-1<i.indexOf(n[0])||-1<i.indexOf(n[1]))&&(this.dwe=!0),this.dwe&&(t="".concat(o.TRIGGERFIELDVALUE,'("').concat(t,'", ').concat(this.hwe?0:1,")"),this.vwe=l(l(i,n[0],t),n[1],t),this.mwe=new s.CalcField(this.vwe,this.nM,void 0,r.Errors.Calc))):this.gwe=!0,this.UOt=new s.CalcField(i,e,void 0,r.Errors.Calc)}function l(t,n,e){return t.split(n).join(e)}function h(t){return t.fields.split(",").reduce(function(t,n){return n=n.trim(),(0,u.isNullOrEmpty)(n)||t.push(n),t},[])}Object.defineProperty(n,"__esModule",{value:!0}),n.getWatchedFields=n.TriggerCalcField=void 0,r=e("CalcEngine"),o=e("./dist/src/calculation/functions/triggerFieldValue.js"),a=e("./dist/src/dataSource/dataSource.interface.js"),u=e("./dist/src/dataSource/utils.js"),s=e("./dist/src/table/calcField.js"),c=e("./dist/src/table/tableField.js"),f.prototype.getKey=function(){return this.UOt.getKey()},f.prototype.vyt=function(){this.UOt.vyt()},f.prototype.c_t=function(){return this.UOt.c_t()},f.prototype.P6t=function(){this.C8()},f.prototype.C8=function(){this.UOt.C8(),this.mwe&&this.mwe.C8(),this.HOt=new c.TableField(this.GOt,this.nM),this.pwe=!1},f.prototype.getValue=function(t){var n,e,i,n=this,e=this.HOt.getValue(t),i=(0,u.isUndefined)(e);return i?e=!this.gwe&&(i=!this.cwe||this.lwe?i:this.fwe.some(function(t){return!(0,u.isUndefined)(n.nM._dataSource.getFieldValue(t,0))}))?this.dwe?(this.hwe&&!this.pwe&&(this.pwe=!0),this.evaluateSelfTrigger(t)):this.evaluateTrigger(t):this.nM.XRt(this.GOt,0):!this.hwe||this.pwe||r.Convert.BJ(e)||(this.pwe=!0,e=this.dwe?this.evaluateSelfTrigger(t):this.evaluateTrigger(t)),e},f.prototype.evaluateTrigger=function(t){var t=this.UOt.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},f.prototype.evaluateSelfTrigger=function(t){var t=this.mwe.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},f.prototype.getValues=function(t,n){for(var e,i,r,e=[],i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},f.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},f.prototype.setItemValue=function(t,n,e,i){this.HOt.setItemValue(t,n,e,i)},f.prototype.hasItem=function(t){this.HOt.hasItem(t)},f.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},f.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},f.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},f.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},f.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.TriggerCalcField=f,n.getWatchedFields=h},"./dist/src/table/windowOverField.js":function(t,n,e){"use strict";var i,a,h,r,d,j,O,f,l,E,o,u,s;function c(t,n,e){var i=s.call(this,e.windowFormula,n)||this;return i.GOt=t,i.options=e,i.Qhe=function(t){return n.rRt(t)},i.tde={evaluator:i},i.nde=!0,i.Sve(),i.Tve(),i}function R(t,n,e,i,r){var o,a,u,s,c;for(void 0===r&&(r=!1),o=e,a=i,u=E;o<=a;)n<=(c=t(s=Math.floor((o+a)/2)))?(r?o=s+1:a=s-1,u=s):r?a=s-1:o=s+1;return u}function F(t,n,e,i,r){var o,a,u,s,c;for(void 0===r&&(r=!1),o=e,a=i,u=E;o<=a;)(c=t(s=Math.floor((o+a)/2)))<=n?(r?a=s-1:o=s+1,u=s):r?o=s+1:a=s-1;return u}function y(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=i,a=r,u=E,s=e.length-1;o<=a;){for(f=!0,l=t(c=Math.floor((o+a)/2)),h=s;0<=h;h--)if(e[h]!==n(l,h)){f=!1;break}f?(a=c-1,u=c):o=c+1}return u}function L(t,n,e,i,r){for(var o,a,u,s,c,f,l,h,o=i,a=r,u=E,s=e.length-1;o<=a;){for(f=!0,l=t(c=Math.floor((o+a)/2)),h=s;0<=h;h--)if(e[h]!==n(l,h)){f=!1;break}f?(o=c+1,u=c):a=c-1}return u}function B(t,n,e,i){for(var r,o,a,u,r=e,o=i,a=E;r<=o;)t(u=Math.floor((r+o)/2))===n?(r=u+1,a=u):o=u-1;return a}function P(t,n,e,i){var r,o,a,u,s;for(void 0===i&&(i=!1),r=n,o=e,a=E;r<=o;)s=t(u=Math.floor((r+o)/2)),(0,O.isNullOrUndefined)(s)?(i?o=u-1:r=u+1,a=u):i?r=u+1:o=u-1;return a}function G(t){return(0,O.isNumber)(t)&&-1<t?t:0}function v(t,n,e){var i,r,n;return(0,O.isNullOrEmpty)(n)||!(0,O.isString)(n)?[]:(e=e||[],(i=t.getCalcService()).dCe=i.dCe||{},i.dCe.hasOwnProperty(n)?(i.Wbe=!0,[]):(i.dCe[n]=!0,r=(0,d.parseFormula)(t,n),delete i.dCe[n],n=i.Wbe,0===Object.keys(i.dCe).length&&(delete i.dCe,delete i.Wbe),n?[]:(m(t,r,e),e)))}function m(t,n,e){var i,r,o,a,u,s,c;if(n.function)if((0,d.getExprFunctionName)(n)===d.WINDOWOVER)e.push("="+(0,d.unparseExpression)(t,n));else for(i=0,r=n.arguments;i<r.length;i++)m(t,o=r[i],e);else if(14===n.type)n.value&&n.value.field instanceof f.CalcField&&!n.value.field.inCircular&&(n.value.field.inCircular=!0,v(t,n.value.field.GOt,e),delete n.value.field.inCircular);else for(a=0,u=Object.keys(n);a<u.length;a++)(c=n[s=u[a]])instanceof l.Expression&&m(t,n[s],e)}function g(t){var n;return!(0,O.isNullOrEmpty)(t)&&("string"==(n=typeof t)&&-1<t.indexOf(d.WINDOWOVER)||"object"==n&&"string"==typeof t.aggregate)}function p(t){var n=t.indexOf(d.WINDOWOVER);return(0,O.isFormula)(t)?1===n:0===n}function b(t,n){var e,i,r,o,a,u,s,c,f,e=[],i=d.WINDOWOVER.length,r=i+2,o=0,a=0;do{if(-1===(o=t.indexOf(d.WINDOWOVER,o)))break;for(a=o+i,u=0,s="=".concat(d.WINDOWOVER),c=0;a<t.length;a++)if((" "!==(f=t[a])||" "===f&&(!1===n||0<c))&&(s+=f),"("===f)u++;else if(")"===f){if(0===--u)break}else"["===f?c++:"]"===f&&c--}while(a!==t.length&&(e.push(s),o=a,t.length-o>=r));return e}function w(t,n){var t,e,i,r,o,t=t.nMt(t.Ywt(n.replace(d.WINDOWOVER,d.WINDOWOVERDECONSTRUCT))),e=(t.partitions||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field)},"p"),i=(t.orders||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field,"_").concat(n.ascending)},"o"),r="f",o=t.windowFrame;return o&&(r+="__".concat(o.type),o.begin&&(r+="__p__".concat(o.begin.type,"__").concat(o.begin.offset)),o.end)&&(r+="__f__".concat(o.end.type,"__").concat(o.end.offset)),a({partitionKey:e,orderKey:i,frameKey:r,windowOverFormula:n},t)}function M(t){return"["===t[0]&&"]"===t[t.length-1]}function C(t){return(0,O.isFormula)(t)?t.slice(1):M(t)?t:"[".concat(t,"]")}function S(t,n){var e;return(0,O.isNumber)(t)?e=0===t?"[@]":"[@".concat(t,"]"):"current"===t?e="[@]":"unbounded"===t&&(e="-1"),e||(n?"-1":"")}function T(t,n){var e,i,e=[];if(e.push(S(n.from,!0)),i=S(n.to,!1),(0,O.isNullOrEmpty)(i)||e.push(i),!(0,O.isNullOrEmpty)(n.exclude))switch(n.exclude){case h.FrameExcludeNoOthers:e.push(0);break;case h.FrameExcludeCurrentRow:e.push(1);break;case h.FrameExcludeGroup:e.push(2);break;case h.FrameExcludeTies:e.push(3)}return"".concat(t,"(").concat(e.join(),")")}function A(t,n){var n,e,i,e,r,o,a,t,o,o,u,s,c,f,l,f,o,r,e;if("string"==typeof t||(0,O.isNullOrUndefined)(t))return t;if(n=!n,e=t.aggregate,!(0,O.isNullOrEmpty)(e)||!n){if(i=[],n&&(0,O.isFormula)(e)&&(e=e.slice(1)),n&&i.push(e),e=t.window,o=t.partitionBy,a=t.orderBy,t=t.frame,(r=!1,O.isArray)(o)?(o=o.filter(function(t){return!(0,O.isNullOrEmpty)(t)}).map(C).join(),i.push("".concat(d.PARTITIONBY,"(").concat(o,")"))):n&&!(0,O.isNullOrEmpty)(e)&&(r=!0,i.push('"'.concat(e,'"'))),!(0,O.isNullOrUndefined)(a)&&0<Object.keys(a).length){if(0<(o=Object.keys(a)).length){for(u=[],s=0,c=o;s<c.length;s++)l=C(f=c[s]),(f=a[f])===h.OrderAsc?u.push("".concat(d.ORDERASC,"(").concat(l,")")):f===h.OrderDesc?u.push("".concat(d.ORDERDESC,"(").concat(l,")")):u.push(l);i.push("".concat(d.ORDERBY,"(").concat(u.join(),")"))}}else!n||r||(0,O.isNullOrEmpty)(e)||(r=!0,i.push('"'.concat(e,'"')));return(0,O.isNullOrUndefined)(t)?!n||r||(0,O.isNullOrEmpty)(e)||i.push('"'.concat(e,'"')):(o=t.rows,r=t.range,e=t.groups,o?i.push(T(d.FRAMEROWS,o)):r?i.push(T(d.FRAMERANGE,r)):e&&i.push(T(d.FRAMEROWS,e))),"=".concat(n?d.WINDOWOVER:d.WINDOWDEF,"(").concat(i.join(),")")}}i=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.parseWindowOverByOption=n.deconstructWindowOverFunction=n.getWindowOverFormulas=n.isWindowOverFormula=n.hasWindowOverFormulas=n.processWindowOverFormula=n.addWindowOverFormulas=n.WindowOverCalcField=void 0,h=e("./dist/src/dataSource/dataSource.interface.js"),r=e("./dist/src/calculation/functions/windowFunctions/util.js"),d=e("./dist/src/calculation/functions/windowOvers/util.js"),j=e("./dist/src/dataSource/dataSource.interface.js"),O=e("./dist/src/dataSource/utils.js"),f=e("./dist/src/table/calcField.js"),l=e("CalcEngine"),E=-1,s=f.CalcField,i(c,s),c.prototype.P6t=function(){},c.prototype.C8=function(){this.Tl=[],this.nde=!0,this.Sve()},c.prototype.getValue=function(t){return this.Tl[t]},c.prototype.XBt=function(t,n,e,i){var r,o,a,u,r=this;if(r.Tl||(r.Tl=[]),e=(0,O.isNumber)(e)?e:0,i=(0,O.isNumber)(i)?i:t.length-1,(0,O.isArray)(n))for(a=e,u=0;a<=i;a++,u++)o=t[a],r.Tl[o]=n[u];else for(a=e;a<=i;a++)o=t[a],r.Tl[o]=n;return r.Tl},c.prototype.Sve=function(){var t,n,e,i,t=this,n=t.options,e=t.Ave={};if((0,O.isArray)(n.orders))for(i=0;i<n.orders.length;i++)e[n.orders[i].field]={}},c.prototype.Tve=function(){var t=this,n=t.options.windowFormula,e=[r.ROWNUMBER,r.WRANK,r.DENSERANK,r.WPERCENTRANK,r.CUMEDIST,r.LEAD,r.LAG,r.NTILE,r.FIRSTVALUE,r.LASTVALUE,r.NTHVALUE];t.Ive=!e.some(function(t){return-1<n.indexOf(t)})},c.prototype.nMt=function(t,n,e,i,r,o,a){var u,t,n,u=this;return u.calcSource.pe(t,n,e,void 0,i,r,o),(t=7===arguments.length)&&u.calcSource.wEt("extendContext",a),n=u.calcService.evaluateExpression(u.calcSource,u.expression,{row:0,col:0}),t&&u.calcSource.wEt("extendContext"),n},c.prototype.ede=function(t,n,e,i,r,o,a,u){var s=this,c=s.tde.valueCache,f,o;!(0,O.isNullOrUndefined)(c)||-1===n&&-1===e||(s.tde.begin=(0,O.isNumber)(r)?r:n,o=s.nMt(t,n,e,o,a,u,s.tde),(0,O.isNumber)(i)&&(n=e=i),c=s.tde.valueCache,(0,O.isNullOrUndefined)(c)||(o=c,n=r,e=void 0),s.XBt(t,o,n,e))},c.prototype.xve=function(t){return this.Ave[t]},c.prototype.Nve=function(t,n,e){var i=n[e];return i=void 0===i?n[e]=this.calcSource.nM._getValueByField(t,e):i},c.prototype.evaluateWindowFunction=function(t,n){var e=this;e.ide(t,n||0),e.rde(),e.nde=!1},c.prototype.rde=function(){this.tde.begin=void 0,this.tde.valueCache=void 0},c.prototype.ide=function(t,n){var e=this,i=e.options.windowFrame;i&&i.begin&&-1===i.begin.offset&&i.end&&-1===i.end.offset||(e.Ive?e.ode(e.options.windowFrame,t,n):e.ede(t,n,void 0,void 0,n))},c.prototype.ode=function(t,n,e){for(var i,r,o,a,u,i=this,r={startIndex:e,endIndex:e,lastStartIndex:e,lastEndIndex:e},o=i.ube(n,e),a=e,u=n.length;a<u;a++)i.Khe(t,e,a,n,r,o),i.ede(n,r.startIndex,r.endIndex,a,e,r.gapStartIndex,r.gapEndIndex,r.currentIndex)},c.prototype.Khe=function(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,t,d,t,a=this,h=j.WindowOverFrameExcludeMode.none;(r.gapStartIndex=r.gapEndIndex=r.currentIndex=void 0,O.isNullOrUndefined)(t)?f=(0,O.isNullOrUndefined)(a.options.orders)||0===a.options.orders.length?(u=j.WindowOverFrameType.ROWS,s=j.WindowOverFramePreceding.UnBounded,j.WindowOverFrameFollowing.UnBounded):(u=j.WindowOverFrameType.RANGE,s=j.WindowOverFramePreceding.UnBounded,j.WindowOverFrameFollowing.CurrentRow):(u=t.type,h=t.exclude||h,d=t.begin,t=t.end,d?(s=d.type,c=d.offset):s=j.WindowOverFramePreceding.UnBounded,t?(f=t.type,l=t.offset):f=j.WindowOverFrameFollowing.CurrentRow,u!==j.WindowOverFrameType.RANGE&&u!==j.WindowOverFrameType.GROUPS||!(0,O.isNullOrUndefined)(a.options.orders)&&0!==a.options.orders.length||(u=j.WindowOverFrameType.ROWS,s=j.WindowOverFramePreceding.UnBounded,f=j.WindowOverFrameFollowing.UnBounded)),d=i.length-1,u===j.WindowOverFrameType.RANGE?(r.startIndex=r.lastStartIndex,r.endIndex=r.lastEndIndex,s===j.WindowOverFrameFollowing.NFollowing?r.startIndex=a.ude(s,c,n,d,e,i,-1===r.startIndex?e+1:r.startIndex,!0):r.startIndex=a.ade(s,c,n,e,i,-1===r.startIndex?n:r.startIndex),f===j.WindowOverFramePreceding.NPreceding?r.endIndex=a.ade(f,l,n,e,i,-1===r.endIndex?n:r.endIndex,!0):r.endIndex=a.ude(f,l,n,d,e,i,-1===r.endIndex?e+1:r.endIndex),r.startIndex>r.endIndex?(r.startIndex=-1,r.endIndex=-1):(a.Dme(s,f,n,d,r),r.lastStartIndex=r.startIndex,r.lastEndIndex=r.endIndex,a.bwe(i,r,e,h))):u===j.WindowOverFrameType.GROUPS?(t=a.wwe(o,e),s===j.WindowOverFrameFollowing.NFollowing?r.startIndex=a.ywe(s,c,d,e,o,t,!0):r.startIndex=a.Mwe(s,c,n,e,o,t),f===j.WindowOverFramePreceding.NPreceding?r.endIndex=a.Mwe(f,l,n,e,o,t,!0):r.endIndex=a.ywe(f,l,d,e,o,t),a.Dme(s,f,n,d,r),a.Cwe(r,e,h,o&&o[t])):u===j.WindowOverFrameType.ROWS&&(s===j.WindowOverFrameFollowing.NFollowing?r.startIndex=a.cde(s,c,d,e):r.startIndex=a.sde(s,c,n,e),f===j.WindowOverFramePreceding.NPreceding?r.endIndex=a.sde(f,l,n,e):r.endIndex=a.cde(f,l,d,e),a.Dme(s,f,n,d,r),a.Swe(i,r,e,h))},c.prototype.Twe=function(t,n){t.startIndex<=n&&n<=t.endIndex&&(t.startIndex===n&&t.endIndex===n?(t.startIndex=-1,t.endIndex=-1):t.startIndex===n?t.startIndex=n+1:t.endIndex===n?t.endIndex=n-1:(t.gapStartIndex=n,t.gapEndIndex=n))},c.prototype.bwe=function(r,t,n,e){var o,i,a,u,s,c,f,l,h,d,v,m,g,p,b,w,o=this;if(e===j.WindowOverFrameExcludeMode.current)o.Twe(t,n);else if(e!==j.WindowOverFrameExcludeMode.none){if(f=c=s=void 0,a=(i=o.options.orders)&&0<i.length){for(u=[],l=[],h=[],v=d=void 0,m=r[n],g=i.length-1,p=0;p<=g;p++)d=i[p].field,v=o.xve(d),l.push(d),h.push(v),u.push(o.Nve(d,v,m));s=function(t){return r[t]},c=function(t,n){return o.Nve(l[n],h[n],t)},f=function(t){var n,e,i,n=r[t],e=!(0,O.isNumber)(n);if(!e)for(i=g;0<=i;i--)if(u[i]!==o.Nve(l[i],h[i],n)){e=!0;break}return!e}}e===j.WindowOverFrameExcludeMode.group?a&&t.startIndex<=n&&n<=t.endIndex&&(f((b=n)-1)&&(b=y(s,c,u,t.startIndex,n-1))===E&&(b=n),f((w=n)+1)&&(w=L(s,c,u,n+1,t.endIndex))===E&&(w=n),t.gapStartIndex=b,t.gapEndIndex=w,b===t.startIndex&&(t.startIndex=w+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),w===t.endIndex&&(t.endIndex=b-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),t.startIndex>t.endIndex)&&(t.startIndex=-1,t.endIndex=-1):e===j.WindowOverFrameExcludeMode.ties&&a&&t.startIndex<=n&&n<=t.endIndex&&(b=E,f(n-1)&&(b=y(s,c,u,t.startIndex,n-1)),w=E,f(n+1)&&(w=L(s,c,u,n+1,t.endIndex)),t.gapStartIndex=b,t.gapEndIndex=w,b===E&&w===E?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):b===E?t.gapStartIndex=n+1:w===E?t.gapEndIndex=n-1:t.currentIndex=n)}},c.prototype.Cwe=function(t,n,e,i){var r,o,a,r=this;(0,O.isNullOrUndefined)(i)||(e===j.WindowOverFrameExcludeMode.current?r.Twe(t,n):e===j.WindowOverFrameExcludeMode.group?(o=i.begin,a=i.end,t.startIndex<o&&a<t.endIndex?(t.gapStartIndex=o,t.gapEndIndex=a):t.startIndex===o&&t.endIndex===a?(t.startIndex=-1,t.endIndex=-1):t.startIndex<=a&&t.startIndex>=o?t.startIndex=a+1:t.endIndex<=a&&t.endIndex>=o&&(t.endIndex=o-1)):e===j.WindowOverFrameExcludeMode.ties&&(o=i.begin,a=i.end,t.startIndex===o&&t.endIndex===a?(t.startIndex=n,t.endIndex=n):t.startIndex<=o&&a<=t.endIndex?(t.gapStartIndex=o,t.gapEndIndex=a,t.currentIndex=n):t.startIndex<=a&&t.startIndex>=o?n<t.startIndex?t.startIndex=a+1:(t.gapStartIndex=t.startIndex,t.gapEndIndex=a,t.currentIndex=n):t.endIndex<=a&&t.endIndex>=o&&(n>t.startIndex?t.endIndex=o-1:(t.gapStartIndex=o,t.gapEndIndex=t.endIndex,t.currentIndex=n))))},c.prototype.Swe=function(r,t,n,e){var o,i,a,u,s,c,f,l,h,d,v,m,g,p,b,w,o=this;if(e===j.WindowOverFrameExcludeMode.current)o.Twe(t,n);else if(e!==j.WindowOverFrameExcludeMode.none){if(f=c=s=void 0,a=(i=o.options.orders)&&0<i.length){for(u=[],l=[],h=[],v=d=void 0,m=r[n],g=i.length-1,p=0;p<=g;p++)d=i[p].field,v=o.xve(d),l.push(d),h.push(v),u.push(o.Nve(d,v,m));s=function(t){return r[t]},c=function(t,n){return o.Nve(l[n],h[n],t)},f=function(t){var n,e,i,n=r[t],e=!(0,O.isNumber)(n);if(!e)for(i=g;0<=i;i--)if(u[i]!==o.Nve(l[i],h[i],n)){e=!0;break}return!e}}e===j.WindowOverFrameExcludeMode.group?(!a||(t.startIndex<n&&n<t.endIndex?(f((b=n)-1)&&(b=y(s,c,u,t.startIndex,n-1))===E&&(b=n),f((w=n)+1)&&(w=L(s,c,u,n+1,t.endIndex))===E&&(w=n),t.gapStartIndex=b,t.gapEndIndex=w,b===t.startIndex&&(t.startIndex=w+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),w===t.endIndex&&(t.endIndex=b-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0)):n<=t.startIndex?f(t.startIndex)&&(w=L(s,c,u,t.startIndex,t.endIndex))!==E&&(t.startIndex=w+1):n>=t.endIndex&&f(t.endIndex)&&(b=y(s,c,u,t.startIndex,t.endIndex))!==E&&(t.endIndex=b-1),t.startIndex>t.endIndex))&&(t.startIndex=-1,t.endIndex=-1):e===j.WindowOverFrameExcludeMode.ties&&(a?(t.startIndex<=n&&n<=t.endIndex?(b=E,f(n-1)&&(b=y(s,c,u,t.startIndex,n-1)),w=E,f(n+1)&&(w=L(s,c,u,n+1,t.endIndex)),t.gapStartIndex=b,t.gapEndIndex=w,b===E&&w===E?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):b===E?t.gapStartIndex=n+1:w===E?t.gapEndIndex=n-1:t.currentIndex=n):n<t.startIndex?f(t.startIndex)&&(w=L(s,c,u,t.startIndex,t.endIndex))!==E&&(t.startIndex=w+1):n>t.endIndex&&f(t.endIndex)&&(b=y(s,c,u,t.startIndex,t.endIndex))!==E&&(t.endIndex=b-1),t.startIndex>t.endIndex&&(t.startIndex=-1,t.endIndex=-1)):(t.startIndex=n,t.endIndex=n))}},c.prototype.Dme=function(t,n,e,i,r){t===j.WindowOverFramePreceding.UnBounded?n===j.WindowOverFramePreceding.NPreceding?-1!==r.startIndex&&-1===r.endIndex&&(r.startIndex=-1):n===j.WindowOverFrameFollowing.NFollowing&&-1!==r.startIndex&&-1===r.endIndex&&(r.endIndex=i):t===j.WindowOverFramePreceding.NPreceding?n===j.WindowOverFramePreceding.NPreceding||n===j.WindowOverFramePreceding.CurrentRow?-1===r.startIndex&&-1!==r.endIndex&&(r.startIndex=e):n!==j.WindowOverFrameFollowing.NFollowing&&n!==j.WindowOverFrameFollowing.UnBounded||(-1===r.startIndex&&(r.startIndex=e),-1===r.endIndex&&(r.endIndex=i)):t===j.WindowOverFramePreceding.CurrentRow?n===j.WindowOverFrameFollowing.NFollowing&&-1===r.endIndex&&(r.endIndex=i):t===j.WindowOverFrameFollowing.NFollowing&&(n===j.WindowOverFrameFollowing.NFollowing?-1!==r.startIndex&&-1===r.endIndex?r.endIndex=i:-1===r.startIndex&&-1!==r.endIndex&&(r.endIndex=-1):n===j.WindowOverFrameFollowing.UnBounded&&-1===r.startIndex&&-1!==r.endIndex&&(r.endIndex=-1))},c.prototype.sde=function(t,n,e,i){var r;switch(t){case j.WindowOverFramePreceding.UnBounded:r=e;break;case j.WindowOverFramePreceding.NPreceding:r=e<=(r=i-G(n))?r:-1;break;default:j.WindowOverFramePreceding.CurrentRow;r=i}return r},c.prototype.cde=function(t,n,e,i){var r;switch(t){case j.WindowOverFrameFollowing.UnBounded:r=e;break;case j.WindowOverFrameFollowing.NFollowing:r=(r=i+G(n))<=e?r:-1;break;default:j.WindowOverFrameFollowing.CurrentRow;r=i}return r},c.prototype.Mwe=function(t,n,e,i,r,o,a){var u,s,s;switch(t){case j.WindowOverFramePreceding.UnBounded:u=e;break;case j.WindowOverFramePreceding.NPreceding:u=e,(0,O.isNullOrUndefined)(r)||(s=r[o-G(n)],u=(0,O.isNullOrUndefined)(s)?-1:a?s.end:s.begin);break;case j.WindowOverFramePreceding.CurrentRow:u=i,(0,O.isNullOrUndefined)(r)||(s=r[o],u=a?s.end:s.begin);break;default:u=i}return u},c.prototype.ywe=function(t,n,e,i,r,o,a){var u,s,s;switch(t){case j.WindowOverFrameFollowing.UnBounded:u=e;break;case j.WindowOverFrameFollowing.NFollowing:u=e,(0,O.isNullOrUndefined)(r)||(s=r[o+G(n)],u=(0,O.isNullOrUndefined)(s)?-1:a?s.begin:s.end);break;case j.WindowOverFrameFollowing.CurrentRow:u=i,(0,O.isNullOrUndefined)(r)||(s=r[o],u=a?s.begin:s.end);break;default:u=i}return u},c.prototype.ade=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,d,g,p,b,w,y,M,C,S,T,A,I,x,N,b,k,u=this,c=u.options.orders;switch(t){case j.WindowOverFramePreceding.NPreceding:if(n=G(n),s=e,1===c.length&&e<=(s=i))if(f=c[0].field,l=c[0].ascending,h=u.xve(f),d=u.Nve(f,h,r[i]),(0,O.isNullOrUndefined)(d)){if(v=r[i-1],d!==(m=u.Nve(f,h,v)))return s;s=o}else(0,O.isNumber)(d)&&(d=!1===l?d+n:d-n,g=function(t){return u.Nve(f,h,r[t])},b=r[p=i-1],s=(y=(w=!(0,O.isNumber)(b)||i===e)||(!1===l?d<u.Nve(f,h,b):d>u.Nve(f,h,b)))?a?w?-1:p:i:a?!1===l?R(g,d,o,p,!0):F(g,d,o,p):!1===l?F(g,d,o,p,!0):R(g,d,o,p));break;case j.WindowOverFramePreceding.UnBounded:s=e;break;default:j.WindowOverFramePreceding.CurrentRow;if(e<(s=i)){if(1===c.length){if(M=c[0].field,C=u.xve(M),S=u.Nve(M,C,r[i]),v=r[i-1],S!==(T=u.Nve(M,C,v)))return s}else{for(S=[],A=[],I=[],C=M=void 0,x=r[i],N=0;N<c.length;N++)M=c[N].field,C=u.xve(M),A.push(M),I.push(C),S.push(u.Nve(M,C,x));for(v=void 0,b=S.length-1,v=r[i-1],k=b;0<=k;k--)if(S[k]!==u.Nve(A[k],I[k],v))return s}s=o}}return s},c.prototype.ude=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,w,v,y,M,C,S,M,T,A,I,x,N,k,_,y,D,s=this,f=s.options.orders;switch(t){case j.WindowOverFrameFollowing.NFollowing:n=G(n),c=i,1===f.length&&(l=f[0].field,h=f[0].ascending,d=s.xve(l),v=s.Nve(l,d,o[r]),m=function(t){return s.Nve(l,d,o[t])},(0,O.isNullOrUndefined)(v)?(g=!0,r!==e&&(p=o[r-1],g=!(0,O.isNumber)(p)||v!==s.Nve(l,d,p)),c=a,g&&(b=o[r+1],c=(w=!(0,O.isNumber)(b)||v!==s.Nve(l,d,b))?r:P(m,a,i,!1===h))):(0,O.isNumber)(v)&&(v=!1===h?v-n:v+n,b=o[y=r+1],c=(w=(M=!(0,O.isNumber)(b)||r===i)||(!1===h?v>s.Nve(l,d,b):v<s.Nve(l,d,b)))?u?M?-1:y:r:u?!1===h?F(m,v,a,i,!0):R(m,v,a,i):!1===h?R(m,v,a,i,!0):F(m,v,a,i)));break;case j.WindowOverFrameFollowing.UnBounded:c=i;break;default:j.WindowOverFrameFollowing.CurrentRow;if(1===f.length)C=f[0].field,S=s.xve(C),M=s.Nve(C,S,o[r]),m=function(t){return s.Nve(C,S,o[t])},g=!0,r!==e&&(p=o[r-1],g=!(0,O.isNumber)(p)||M!==s.Nve(C,S,p)),c=a,g&&(b=o[r+1],c=(w=!(0,O.isNumber)(b)||M!==s.Nve(C,S,b))?r:B(m,M,a,i));else{for(T=[],A=[],I=[],N=x=void 0,k=o[r],_=0;_<f.length;_++)x=f[_].field,N=s.xve(x),A.push(x),I.push(N),T.push(s.Nve(x,N,k));y=function(t){var n,e,i,n=o[t],e=!(0,O.isNumber)(n);if(!e)for(i=f.length-1;0<=i;i--)if(T[i]!==s.Nve(A[i],I[i],n)){e=!0;break}return e},c=a,g=!0,(g=r!==e?y(r-1):g)&&((w=y(r+1))||(c=L(D=function(t){return o[t]},m=function(t,n){return s.Nve(A[n],I[n],t)},T,a+1,i))===E)&&(c=r)}}return c},c.prototype.ube=function(t,n){var e,i,r,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,e=this,i=e.options.orders,r=e.options.windowFrame&&e.options.windowFrame.type;if(i&&0<i.length&&r===j.WindowOverFrameType.GROUPS){if(r=t[n],o=[{begin:n,end:n}],1<t.length-n){for(a=[],u=[],s=[],f=c=void 0,l=r,h=i.length-1,d=0;d<=h;d++)c=i[d].field,f=e.xve(c),u.push(c),s.push(f),a.push(e.Nve(c,f,l));for(d=n+1,v=t.length;d<v;d++){for(m=t[d],g=[],p=!0,b=0;b<=h;b++)w=e.Nve(u[b],s[b],m),g.push(w),a[b]!==w&&(p=!1);p?o[o.length-1].end=d:(a=g,o[o.length]={begin:d,end:d})}}return o}},c.prototype.wwe=function(t,n){var e,i,r;if(!(0,O.isNullOrUndefined)(t))for(e=0,i=t.length;e<i;e++)if((r=t[e]).begin<=n&&n<=r.end)return e},n.WindowOverCalcField=c,n.addWindowOverFormulas=v,n.processWindowOverFormula=m,n.hasWindowOverFormulas=g,n.isWindowOverFormula=p,n.getWindowOverFormulas=b,n.deconstructWindowOverFunction=w,n.parseWindowOverByOption=A},"./dist/src/viewField/fieldManager.js":function(t,n,e){"use strict";var o,s,D,a,j,b,u,I;function c(i,r,o,a){return function(t,n){var n,e,n=i.getField(n),e=o&&!(0,u.isGroupSlice)(n.name)&&n.extra&&n.extra.caption||n.name;return a&&n instanceof b.ColumnDataReaderField||(t[e]=n.getValue(r)),t}}function i(t,n){this.Pq=[],this.Z={},this.positionOfField=[],this.keysOfBaseField=[],this.sBt=t,this.cBt={},this.nM=n}function r(t,n){for(var n,e,i,r,o,a,u,s,n=n.valueRelation,e=n.split("."),i=t(n),r="",o=!1,a=!1,u=0;u<e.length;u++)s=i[u],(0,D.isNullOrEmpty)(e[u])||(r+=".".concat(e[u])),!a&&s&&"array"===s.type&&s.name===e[u]&&(o=a=!0,r+=".".concat(j.RelationTemplateToken));return{isOneToMany:o,relationTemplate:r.slice(1)}}function f(t,n,e,i){var r,o,r=R(t),o;return{valueRelation:t,valueCaption:n||r,valueIndex:e,valueCrossKey:i}}function O(t){for(var n,e,i,r,o,n=t.columns,e=t.crossKeys,i=t.initialOptionIndex,r=[],o=0;o<n.length;o++)r.push(f(n[o].value,n[o].caption,i+o,e[o]));return r}function E(t,n){return l(t,n,"")}function l(t,n,e){return!(0,D.isNullOrEmpty)(n)&&0<=t.indexOf(n)?l(t=t.replace(n,e),n,e):t}function w(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function h(t){var t,t="string"==typeof t||(0,D.isNullOrUndefined)(t)?t:"function"==typeof t?t.name:t.value;return(t||"").split(".")}function R(t){var t=h(t);return t[t.length-1]}function F(t){if(!(0,D.isNullOrEmpty)(t.formatter))return t.formatter}function L(t){var t=h(t);return t[t.length-2]}function B(t,n){var t=h(t);return n&&t.splice(t.length-1,0,""),t.slice(0,t.length-1).join(".")}function P(t){return"string"==typeof t?[t]:t||[]}function y(t){for(var n,e,i,r,o,n=0,e={},i=0;i<t.length;i++)r=t[i].caption,(0,D.isArray)(r)?(t[i].caption=r.map(function(t){return null==t?void 0:t.toString()}),e[i]=r.length,n<e[i]&&(n=e[i])):t[i].caption=null==r?void 0:r.toString();for(i in e)if(e[i]<n)for(o=n-e[i],r=t[i].caption;0<o;)r.unshift(),o--;for(i=0;i<t.length;i++)r=t[i].caption,(0,D.isArray)(r)&&1===r.length&&(t[i].caption=r[0])}function d(t,n){var t,t,t,e,t=t.qRt(n);if(!((0,D.isNullOrUndefined)(t)||(t=t._dataSource.options.schema,(0,D.isNullOrUndefined)(t))||(t=t.columns,(0,D.isNullOrUndefined)(t))||(e=t[R(n)],(0,D.isNullOrUndefined)(e))))return e.lookup}function v(t,n){return m(t,n)||g(t,n)}function m(t,n){return(0,D.isArray)(d(t,n))}function g(t,n){var e,i,r,o,n,e=d(t,n);if((0,D.isObject)(e)&&(e=e.name),(0,D.isString)(e))return i=t.qRt(n),r=R(n),o=R(e),n=t.QOt.relationships.find(function(t){return t.sourceTable===i&&t.sourceFieldName===r&&t.sourceRelationshipName===o}),!(0,D.isNullOrUndefined)(n)}function p(t,n,e){var i=R(e),e=T(t,function(t){return t.sourceFieldName===i&&t.sourceTable===n});return e?{relationTable:e.targetTable,relationPrimaryKey:e.targetFieldName,relationTableName:e.sourceRelationshipName}:{}}function M(t,n,e){var i,n,r,o,n,o,n,r,o,i,i=n.over,n=n.attributes;return!((0,D.isNullOrEmpty)(i)||(0,D.isNullOrEmpty)(e)||e===i||C(t,e)||(r=h(e),n=!(o=m(t,i))&&g(t,i)&&n&&0<n.length,!o&&!n)||(o=p(t,S(t,i),i),-1<r.indexOf(o.relationTableName)))&&(n=t.$Rt(i),r=t.$Rt(e),!(!n.every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne})||!r.every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne}))||(o=(0,D.findIndex)(n,function(t){return t.relationshipMap===a.RelationshipMap.OneToMany}),i=(0,D.findIndex)(r,function(t){return t.relationshipMap===a.RelationshipMap.OneToMany}),-1<o&&o===i&&n[o].name===r[i].name?n.slice(o+1).every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne})&&r.slice(o+1).every(function(t){return t.relationshipMap===a.RelationshipMap.OneToOne}):void 0))}function C(t,n){var e=S(t,n),i=R(n);return e.jOt(i)||T(t,function(t){return t.sourceTable===e&&t.sourceFieldName===i||t.targetTable===e&&t.targetFieldName===i})}function S(t,n){return t.qRt(n)}function T(t,n){return t.QOt.relationships.find(n)}function A(t){var i=t.ascending,e=t.compare;return e?function(t,n){return e(t.extra.caption,n.extra.caption,i)}:function(t,n){var t=t.extra.caption,n=n.extra.caption,e=i?t:n,n=i?n:t;return n<e?1:e<n?-1:0}}o=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.isValidCross=n.isLookupRelationField=n.isLookupListField=n.isLookupField=n.getLookupBy=n.FieldManager=void 0,s=e("CalcEngine"),D=e("./dist/src/dataSource/utils.js"),a=e("./dist/src/interfaces/interface.js"),j=e("./dist/src/viewField/utils.js"),b=e("./dist/src/viewField/fields.js"),u=e("./dist/src/viewField/groupManager.js"),i.prototype.hde=function(){return this.nM.length()},i.prototype.fBt=function(t,n){return this.nM._getValueByField(t,n)},i.prototype.lBt=function(t,n){return this.nM.XRt(t,n)},i.prototype.hBt=function(t){return this.nM.iBt(t)},i.prototype.dBt=function(t){return T(this.nM,t)},i.prototype.vBt=function(t){return S(this.nM,t)},i.prototype.mBt=function(t){return this.nM._dataSource._data[t].data},i.prototype.gBt=function(t){return!(0,D.isNullOrUndefined)(this.nM._dataSource._data[t])},i.prototype.oBt=function(t){return this.nM.oBt(t.split("."))},i.prototype.pBt=function(){return this.nM.POt},i.prototype.bBt=function(t){return d(this.nM,t)},i.prototype.yBt=function(t){return v(this.nM,t)},i.prototype.wBt=function(t){return m(this.nM,t)},i.prototype.MBt=function(t){return g(this.nM,t)},i.prototype.getTable=function(){return this.nM},i.prototype.getField=function(t){return this.Pq[t]},i.prototype.getFieldByPosition=function(t){return this.getField(this.positionOfField[t])},i.prototype.getFieldByName=function(t){return this.Z[t]},i.prototype.getFields=function(t){return this.Pq.filter(t)},i.prototype.kve=function(t,n,e,i,r){var o=this;c(o,e,i,r)(t,o.positionOfField[n])},i.prototype.getFieldValues=function(t,n,e){var i=this;return i.positionOfField.reduce(c(i,t,n,e),{})},i.prototype.CBt=function(t){var n=this;return n.positionOfField.filter(function(t){return-1===n.keysOfBaseField.indexOf(t)}).reduce(c(n,t),{})},i.prototype.moveFields=function(t,n,e){(0,D.swapArrayItems)(this.Pq,t,n,e)},i.prototype.moveFieldsByIndexes=function(t){var n=this;t.forEach(function(t){t.field=n.Pq[t.oldIndex]}),t.forEach(function(t){n.Pq[t.newIndex]=t.field})},i.prototype.removeFields=function(t,n){for(var e,i,r,o,a,e,i=0,r=this.Pq.splice(t,n||1);i<r.length;i++)o=r[i],-1<(a=this.keysOfBaseField.indexOf(o.key))&&this.keysOfBaseField.splice(a,1),-1<(a=this.positionOfField.indexOf(o.key))&&this.positionOfField.splice(a,1)},i.prototype.reset=function(){var e=this;e.positionOfField=e.keysOfBaseField.slice(),e.Pq=e.Pq.reduce(function(t,n){return-1<e.keysOfBaseField.indexOf(n.key)?t.concat(n):t},[]),e.Z={},e.Pq.forEach(function(t){e.Z[t.name]=t})},i.prototype.Awe=function(t,n){var e=this,i=e.cBt,r=i[t],n=n||e.pBt(),o=n.getCalcService(),r;return r=r||(i[t]=e.fixExpression(o.parse(n,t,0,0)))},i.prototype.SBt=function(t){var n=this,r=n.Awe(t),o=n.pBt(),a=o.getCalcService();return function(t,n,e,i){var t,n;return o.pe(t,n,e),(t=4===arguments.length)&&o.wEt("extendContext",i),n=a.evaluateExpression(o,r,{row:0,col:0}),t&&o.wEt("extendContext"),n}},i.prototype.TBt=function(t,n){var e=this,r=e.Awe(t,n),o=n||e.pBt(),a=o.getCalcService();return function(t,n,e,i){var t,n;return o.pe(t,n,e),(t=4===arguments.length)&&o.wEt("extendContext",i),n=a.MX.evaluateExpression(r,o.getEvaluatorContext({row:0,col:0},!1),!1,!0),t&&o.wEt("extendContext"),(0,D.isNullOrUndefined)(n.toArray)?[]:n.toArray()}},i.prototype.fixExpression=function(t){var n,e,i,r,o,a,u,n=this;if(t.function)for(t.function.isReverseArgs&&t.function.isReverseArgs()&&t.arguments.reverse(),e=0,i=t.arguments;e<i.length;e++)r=i[e],n.fixExpression(r);else for(o=0,a=Object.getOwnPropertyNames(t);o<a.length;o++)t[u=a[o]]instanceof s.Expression&&n.fixExpression(t[u]);return t},i.prototype.ABt=function(t){var n=this;return t.key=n.Pq.length,n.Pq.push(t),n.Z[t.name]=t},i.prototype.addDataBaseField=function(t,n,e){var i=this,t=i.addColumnDataField(t,n,e);return i.IBt(t)},i.prototype.addReaderBaseField=function(t,n,e){var i,t,i=this,t=i.addColumnDataReaderField(t,"function"==typeof n?n:function(t){return i.fBt(n,t)},e,i.hde.bind(i));return i.IBt(t)},i.prototype.IBt=function(t){var n=this,e=t.key;return n.keysOfBaseField.push(e),n.positionOfField.push(e),t},i.prototype.addColumnDataField=function(t,n,e){return this.ABt(new b.ColumnDataField(t,n,e))},i.prototype.addColumnDataReaderField=function(t,n,e,i){return this.ABt(new b.ColumnDataReaderField(t,n,e,i))},i.prototype.addDataField=function(t,n){return this.ABt(new b.DataField(t,n))},i.prototype.addFormulaField=function(t,n){return this.ABt(this.xBt(t,n))},i.prototype.xBt=function(t,n){return new b.FormulaField(t,n,this.SBt(n))},i.prototype.addCategoryFormulaField=function(t,n,e){return this.ABt(this.NBt(t,n,e))},i.prototype.NBt=function(t,n,e){return new b.CategoryFormulaField(t,n,this.SBt(n),e,e?this.Awe(e):null)},i.prototype.addCategoryField=function(t,n){return this.ABt(this.kBt(t,n))},i.prototype.kBt=function(t,n){return new b.CategoryField(t,n)},i.prototype.addSliceCategoryField=function(t){return this.ABt(new b.SliceCategoryField(t))},i.prototype.DBt=function(t,n,e,i,r){for(var o,a,u,s,c,f,l,f,h,d,v,s,o=this,a=t.fieldExtra,u=t.field,h=0,d=e.length;h<d;h++)c=(f=e[h]).result,l=f.key,(0,D.isUndefined)(l)&&(v=f.value,t.field.addKey(v,f.recordRowNumbers[0]),s=t.field.getMap(),l=f.key=s[v]),f=t.sliceFields[l],(0,D.isUndefined)(f)&&(s=u.getValueByKey(l),(f=o.addSliceCategoryField((0,j.combineName)(s,"s",n.name))).setFieldExtra(a),f.setFieldManager(o),t.sliceFields[l]=f,t.sliceKeys.push(f.key)),f.setData(c,i,r)},i.prototype._Bt=function(n,t,e,i){var r=this;return(0,j.isField)(n)?r.getFieldByName(n):(0,D.isFormula)(n)?r.EBt((0,j.combineName)(n,"".concat(i,"_formula_source")),t,n,e):(0,D.isRelation)(n)?new b.ColumnDataReaderField((0,j.combineName)(n,"".concat(i,"_related_source")),function(t){return r.fBt(n,t)},{value:n},r.hde.bind(r)):r.getFieldByName(n)},i.prototype.EBt=function(t,n,e,i){var r,t=this.xBt((0,j.combineName)(t,n),e);return t.evaluateFormulaBy(i),t},i.prototype.buildGroupFields=function(t,s){var c=this,e,f,l=[];return t.forEach(function(t,n){var u,n,n;(0,D.isNullOrEmpty)(t.field)||(f=(0,D.isNullOrUndefined)(f)?e={}:f.group={},u=(0,j.combineName)(t.field,n),n=c._Bt(t.field,u,s,"group_field"),(n=c.addCategoryField(u,n)).setFieldExtra(t),n.setFieldManager(c),l.push(n.key),f.field=n,"boolean"==typeof t.ascending&&(f.sort=t.ascending?"asc":"desc"),(0,D.isNullOrUndefined)(t.summaryFields)||t.summaryFields.forEach(function(t,n){var n,e,i,e,r,o,a,o;(0,D.isNullOrEmpty)(t.formula)||(n=(0,j.combineName)(t.formula,n,u),(e=c.addCategoryFormulaField(n,t.formula,t.filter)).setFieldExtra(t),e.setFieldManager(c),(0,D.isNullOrUndefined)(f.formulas)&&(f.formulas=[]),i=f.formulas.push(e)-1,l.push(e.key),(0,D.isNullOrUndefined)(t.slice))||(e=t.slice,o=(r=(0,D.isString)(e))?e:e.field,a=c._Bt(o,n,s,"slice"),(a=c.kBt((0,j.combineName)(o,"slice_category",n),a)).setFieldManager(c),(0,D.isNullOrUndefined)(f.slices)&&(f.slices=[]),o=c.NBt((0,j.combineName)(o,"slice_formula_result",n),t.formula),f.slices.push({field:a,formula:o,formulaIndex:i,sliceKeys:[],fieldExtra:r?{}:e,sliceFields:{},addSliceField:c.DBt.bind(c)}))}),(0,D.isNullOrUndefined)(t.windowOrderedFunctions))||(f.windowFunctionOptions=t.windowOrderedFunctions.map(function(t){return{orders:t.orders,fields:t.functions.map(function(t){return c.nM.XOt[t.windowOverFormula]})}}))}),c.positionOfField=l.concat(c.keysOfBaseField),e},i.prototype.transposeSliceFields=function(n){var e=this,i,r;n.slices&&n.slices.forEach(function(t){var t;i=e.positionOfField.indexOf(n.formulas[t.formulaIndex].key),r=t.sliceKeys,(0,D.isNullOrUndefined)(t.fieldExtra.sort)||(r=r.map(function(t){return e.getField(t)}).sort(A(t.fieldExtra.sort)).map(function(t){return t.key})),(t=e.positionOfField).splice.apply(t,o([i+1,0],r,!1))}),n.group&&e.transposeSliceFields(n.group)},i.prototype.prepareFields=function(a){for(var u,s,c,f,t,n,e,i,r,o,r,l,h,d,v,m,g,p,u=this,s=[],c=0,f=0;c<a.length;c++,f++)if(n=w(t=a[c]),e=t.value,i=t.cross){if(o=(r=u.jBt(a,c)).crossColumnOptions,r=r.endColIndex,l=o.columns.length,0!==(h=u.OBt(o))){for(d=function(t,n){var e,i,e,r,o,e=f+t,i=c+n,e=u.getField(e);e.setFieldExtra(a[i]),e.setFieldManager(u),r={value:e.name,name:e.name,isCross:!0,RBt:i},e.isReadonly()&&(r.readonly=!0),(o=e.extra)&&(0,b.setFieldExtraProperties)(function(t){o[t]&&(r[t]=o[t])}),s.push(r),v=++t,m=n=l<=++n?0:n},p=g=0;g<h;)d(g,p),g=v,p=m;c=r,f+=h-1}}else u.gBt(n)?u.addDataBaseField(n,u.mBt(n),t):u.addReaderBaseField(n,e,t),s.push(a[c]);return y(s),s},i.prototype.jBt=function(t,n){var e,i,r,o,r,a,u,e=this,i=n,r=t[n],o=r.cross,r=e.BBt(o,[r],i);if("string"==typeof o){for(u=a=n;n<t.length&&!(++u<t.length&&o!==t[u].cross);)n++;r=e.BBt(o,t.slice(a,u),i)}return{crossColumnOptions:r,endColIndex:n}},i.prototype.BBt=function(t,n,e){var t="string"==typeof t?this.sBt.cross[t]:t;return{initialOptionIndex:e,crossKeys:n.map(function(t){return t.LBt}),cross:t,columns:n,lookup:this.FBt(t,n)}},i.prototype.FBt=function(n,t){var e=this;return t.every(function(t){return e.isValidCross(n,t.value)})&&this.bBt(n.over)},i.prototype.isValidCross=function(t,n){return M(this.nM,t,n)},i.prototype.OBt=function(t){var n=this,e=t.lookup,i=0;return(0,D.isArray)(e)?i=n.PBt(t):((0,D.isString)(e)||(0,D.isObject)(e))&&(i=n.GBt(t)),i},i.prototype.GBt=function(t){var n,e,i,r,o,a,u,s,c,f,l,t,h,d,v,m,g,h,p,e,b,w,y,M,C,S,T,A,I,x,N,k,_,x,k,n=this,e=t.cross,i=n.sBt.showCrossValueHeader,r=P(e.caption),o=0,a=O(t),u=e.over,s=R(u),c=u,f=e.attributes||[],l=f.length,t=B(f[0],!0),h=n.UBt(n.vBt(c),c),d=h.relationTableName||L(f[0]),v=h.relationTable||n.HBt(d),m=v.length(),g=h.relationPrimaryKey||n.zBt(d,s),h=e.filter?n.TBt(E(e.filter,t),v.POt):null;for((0,D.isNullOrUndefined)(h)||0<(e=h(null)).length&&(p=e.reduce(function(t,n){var e;return t["object"==typeof n?n[g]:n]=!0,t},{})),b=[],w=0;w<l;w++)y=R(f[w]),M=F(f[w]),b.push({fieldName:y,formatter:M});for(C=0;C<m;C++)if(S=v._getValueByField(g,C),(0,D.isNullOrUndefined)(p)||p[S]){for(T=r.slice(),w=0;w<l;w++)y=b[w].fieldName,A=v._getValueByField(y,C),M=b[w].formatter,(0,D.isNullOrUndefined)(M)||(A=(0,D.format)(A,M)),T.push(A);for(I=0;I<a.length;I++)N=(x=a[I]).valueRelation,k=x.valueCaption,_=x.valueIndex,x=x.valueCrossKey,k=i?T.concat(k):T,n.VBt({path:k,value:(0,j.combineName)(N,S,u,x),valueRelation:N,dimRelationPath:c,dimRelationKey:s,dimTableName:d,dimTableKeyFieldValue:S,initialOptionIndex:_}),o++}return o},i.prototype.PBt=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,g,b,n=this,e=t.cross,i=t.lookup,r=n.sBt.showCrossValueHeader,o=P(e.caption),a=0,u=O(t),s=e.over,c=R(s),f=s,l=i.length,h=0;h<l;h++)for(d=o.slice(),v=i[h],d.push(v),m=0;m<u.length;m++)p=(g=u[m]).valueRelation,b=g.valueCaption,w=g.valueIndex,g=g.valueCrossKey,b=r?d.concat(b):d,n.VBt({path:b,value:(0,j.combineName)(p,v,s,g),valueRelation:p,dimRelationPath:f,dimRelationKey:c,dimTableKeyFieldValue:v,initialOptionIndex:w}),a++;return a},i.prototype.setCrossFieldValues=function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.Pq,i=t.length,r=e.filter(function(t){return t instanceof b.CrossField});if(0<r.length)for(o=0;o<i;o++)for(a=t[o],u={},s=0;s<r.length;s++)c=r[s],n.YBt(c,a,u)},i.prototype.YBt=function(t,n,e){var i,r,o,a,i=this,r=t.dimRelationPath,o=e[r];if((0,D.isNullOrUndefined)(o)&&t.isOneToMany&&(o=e[r]=i.fBt(r,n)),(0,D.isArray)(o))for(a=0;a<o.length;a++)if(t.ZBt(o[a],t.dimTableKeyFieldValue)&&(0,D.isNullOrUndefined)(t.getValueIndex(n))){t.setValueIndex(n,a);break}},i.prototype.zBt=function(n,e){var t=this,i=t.dBt(function(t){return t.sourceFieldName===e&&t.sourceRelationshipName===n});return i?i.targetFieldName:(i=t.dBt(function(t){return t.targetFieldName===e&&t.targetRelationshipName===n}))?i.sourceFieldName:void 0},i.prototype.HBt=function(n){var t,e=this.dBt(function(t){return t.sourceRelationshipName===n||t.targetRelationshipName===n})||{},e=e.sourceRelationshipName===n?e.sourceField:e.targetField;return e?e.targetTable:{length:function(){return 0}}},i.prototype.UBt=function(t,n){return p(this.nM,t,n)},i.prototype.WBt=function(t){var n=this,t=new b.CrossField(t,n.fBt.bind(n),n.lBt.bind(n),n.hBt.bind(n));return n.ABt(t),n.IBt(t),t},i.prototype.VBt=function(t){var n,t,n,e,n,n=this,t=n.WBt(t);t.isReadonly()||(e=(n=r(n.oBt.bind(n),t)).isOneToMany,n=n.relationTemplate,e&&(t.isOneToMany=e,t.valueArrayRelation=n))},i.prototype.isCrossField=function(t){return t instanceof b.CrossField},i.prototype.clearCrossFieldData=function(){for(var t,n,e,i,t,n=this.Pq,e=0;e<n.length;e++)(i=n[e])instanceof b.CrossField&&i.clearData()},i.prototype.resetCrossFieldRowValues=function(t){for(var n,e,i,r,o,n=this,e=n.Pq,i={},r=0;r<e.length;r++)(o=e[r])instanceof b.CrossField&&(o.clearValue(t),n.YBt(o,t,i))},i.prototype.removeCrossFieldValues=function(t,n){for(var e,i,r,o,e,i=this.Pq,r=0;r<i.length;r++)(o=i[r])instanceof b.CrossField&&o.removeData(t,n)},i.prototype.setCrossFieldInsertedIndex=function(t,n,e){for(var i,r,o,a,u,i,r=this.Pq,o=B(t.valueRelation,!0),a=0;a<r.length;a++)(u=r[a])instanceof b.CrossField&&u.isOneToMany&&t.dimTableKeyFieldValue===u.dimTableKeyFieldValue&&(0,D.isNullOrUndefined)(u.getValueIndex(n))&&o===B(u.valueRelation,!0)&&u.setValueIndex(n,e)},n.FieldManager=i,n.getLookupBy=d,n.isLookupField=v,n.isLookupListField=m,n.isLookupRelationField=g,n.isValidCross=M},"./dist/src/viewField/fields.js":function(t,n,e){"use strict";var i,s,u,e,r,o,a,c,r,f,l,h,d,v,m,g,p,b,w,y,M;function C(t){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit"].forEach(t)}function S(t){var n=(this.name=t).indexOf(u.FieldNameDelimiter);-1<n&&(t=t.slice(0,n)),this.fieldValue=t}function T(t,n){var t=v.call(this,t)||this;return t.data=n||[],t}function A(t,n,e){var t=m.call(this,t,n)||this;return t.column=e,t}function I(t,n,e,i){var t=g.call(this,t)||this;return t.column=e,t.setFieldExtra(e),t.getValue=n,t.getLength=i,t}function x(t,n,e){var t=p.call(this,t)||this;return t.setFieldExtra({value:n}),t.formula=n,t.P6t=e,t}function N(t,n){return t._error||t._code?"Calc Error ".concat(n,":").concat(t._error,",").concat(t._code):t}function k(t,n){var t=b.call(this,t)||this;return t.QBt=n,t.KBt={},t.Oit=[],t}function _(t,n,e,i,r){var t=w.call(this,t)||this;return t.P6t=e,t.formula=n,t.filter=i,t.filterExpression=r,t}function D(t){return y.call(this,t)||this}function j(t,n,e,i){var r=M.call(this,t.value)||this;return r.path=t.path,r.valueRelation=t.valueRelation,r.valueField=-1<t.valueRelation.indexOf(".")?t.valueRelation.split(".").pop():t.valueRelation,r.dimRelationPath=t.dimRelationPath,r.dimRelationKey=t.dimRelationKey,r.dimTableName=t.dimTableName,r.isDateDimValue=t.dimTableKeyFieldValue instanceof Date,r.dimTableKeyFieldValue=r.isDateDimValue?t.dimTableKeyFieldValue.getTime():t.dimTableKeyFieldValue,r.initialOptionIndex=t.initialOptionIndex,r.getValueByField=O(t,i,n),r.getOriginalValueByField=O(t,i,e),r.data=[],r}function O(t,e,i){return(0,s.isFunction)(t.valueRelation)?function(t,n){return(0,s.isFunction)(t)?t(e(n)):i(t,n)}:i}i=this&&this.__extends||(d=function(t,n){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CrossField=n.SliceCategoryField=n.CategoryFormulaField=n.CategoryField=n.FormulaField=n.ColumnDataReaderField=n.ColumnDataField=n.DataField=n.Field=n.setFieldExtraProperties=void 0,s=e("./dist/src/dataSource/utils.js"),u=e("./dist/src/viewField/utils.js"),n.setFieldExtraProperties=C,S.prototype.setFieldExtra=function(n){var e,t,e=this;(0,s.isUndefined)(e.extra)&&(e.extra={}),(0,s.isNullOrUndefined)(n)||(n.field&&(e.fieldValue=n.field),C(function(t){e.JBt(t,n)}),(0,s.isNullOrUndefined)(n.caption)&&0<=(t=e.name.indexOf(u.FieldNameDelimiter))&&(e.extra.caption=e.name.substring(0,t)))},S.prototype.JBt=function(t,n){var e,n=n[t];n&&(this.extra[t]=n)},S.prototype.setFieldManager=function(t){this.fieldManager=t},S.prototype.getFieldManager=function(){return this.fieldManager},S.prototype.getValue=function(t){return this.data[t]},S.prototype.getOriginalValue=function(t){return this.getValue(t)},S.prototype.getLength=function(){return this.data.length},S.prototype.XBt=function(t,n,e,i){var r,o,a,u,r=this;if(r.data||(r.data=[]),e=(0,s.isNumber)(e)?e:0,i=(0,s.isNumber)(i)?i:t.length-1,(0,s.isArray)(n))for(a=0,u=n.length;e<=i&&a<u;a++)o=t[e=a+e],r.data[o]=n[a];else for(a=e;a<=i;a++)o=t[a],r.data[o]=n;return r.data},S.prototype.qBt=function(t,n){var e,i,r,o,e=this;for(e.data||(e.data=[]),r=0,o=t.length;r<o;r++)i=t[r],e.data[i]=n(i);return e.data},n.Field=e=S,i(T,v=e),n.DataField=r=T,i(A,m=r),n.ColumnDataField=A,i(I,g=e),n.ColumnDataReaderField=I,i(x,p=r),x.prototype.evaluateFormulaBy=function(t){var n=this,e=n.formula,i=n.P6t;return n.qBt(t,function(t){return N(i(t),e)})[t[0]]},n.FormulaField=x,i(k,b=e),k.prototype.getKey=function(t){return this.KBt[t]},k.prototype.getMap=function(){return this.KBt},k.prototype.getValueByKey=function(t){return this.Oit[t]},k.prototype.$Bt=function(t,n){this.KBt[n]=t,this.Oit[t]=n},k.prototype.getValue=function(t){var n=this;return n.data&&0<n.data.length?n.Sl(t):n.QBt?n.QBt.getValue(t):void 0},k.prototype.Sl=function(t){var n=this;return n.Oit[n.data[t]]},k.prototype.addKey=function(t,n){var e=this,i=e.getKey(t);return(0,s.isUndefined)(i)&&e.$Bt(i=n,t),i},k.prototype.getSourceField=function(){return this.QBt},n.CategoryField=r=k,i(_,w=r),_.prototype.evaluateFormulaBy=function(t,n,e){var i,r,e,i=this,r=0;return(0,s.isNullOrUndefined)(e)&&(e=t,r=n||0),e=i.P6t(e,r),i.XBt(t,i.addKey(e,t[n]),n),e},n.CategoryFormulaField=_,i(D,y=r),D.prototype.setData=function(t,n,e){var i=this,t=i.addKey(t,n[e]);i.XBt(n,t,e)},n.SliceCategoryField=D,i(j,M=e),j.prototype.setFieldExtra=function(t){M.prototype.setFieldExtra.call(this,t),this.extra.caption=this.path},j.prototype.ZBt=function(t,n){var e,i;return this.isDateDimValue&&t instanceof Date?t.getTime()===n:t===n},j.prototype.tLt=function(t,n){var e=this,i=e.isOneToMany,r=e.dimRelationPath,o=e.dimTableKeyFieldValue;return!i&&e.ZBt(n(r,t),o)?t:this.data[t]},j.prototype.getDimValue=function(){var t=this,n=t.isDateDimValue,t=t.dimTableKeyFieldValue;return n?new Date(t):t},j.prototype.getValueIndex=function(t){return this.tLt(t,this.getValueByField)},j.prototype.setValueIndex=function(t,n){this.data[t]=n},j.prototype.clearData=function(){this.data=[]},j.prototype.clearValue=function(t){this.data[t]=void 0},j.prototype.removeData=function(t,n){this.data.splice(t,n)},j.prototype.isReadonly=function(){return(0,s.isFormula)(this.valueRelation)||(0,s.isFunction)(this.valueRelation)},j.prototype.Sl=function(t,n){var e,i,r,o,e,a,e=this,i=e.isOneToMany,r=e.valueArrayRelation,o=e.valueRelation,e=e.tLt(t,n);if((0,s.isNumber)(e))return a=void 0,n(a=i?r.replace(u.RelationTemplateToken,e+1):o,t)},j.prototype.getValue=function(t){return this.Sl(t,this.getValueByField)},j.prototype.getOriginalValue=function(t){return this.Sl(t,this.getOriginalValueByField)},j.prototype.getRelationField=function(t){var n=this,e=n.isOneToMany,i=n.valueArrayRelation,r=n.valueRelation,n=n.getValueIndex(t);return e?(0,s.isNumber)(n)?i.replace(u.RelationTemplateToken,n+1):void 0:r},n.CrossField=j},"./dist/src/viewField/groupManager.js":function(t,n,e){"use strict";var r,h,o,a,u,s,i;function c(t,n){var e,i,r,o,a;if((0,h.isNullOrUndefined)(t)||(0,h.isNullOrUndefined)(n))return t===n;if(e=Object.keys(t),i=Object.keys(n),e.length!==i.length)return!1;for(r=0,o=e;r<o.length;r++)if(t[a=o[r]]!==n[a])return!1;return!0}function f(t){for(var n,e,i,n=[],e=t.split(o.FieldNameDelimiter).reverse(),i=0;i<e.length;i+=2)n.push(e[i]);return n}function l(t){return 1===f(t).length}function d(t){return 2===f(t).length}function v(t){return 3===f(t).length}function m(t){return 2===t.split(o.FieldNameDelimiter).length}function g(t){var t=t.split(o.FieldNameDelimiter);return t[t.length-2]}function p(t,n,e,i,r){this.LEt=t,this.wEt=n,this.wwn=i||function(){},this.xwe=r||function(){return[]};var t=this.fCe=new u.DataManagerProxy(e);this.Vhe=new a.DataManagerReportGroupHelper(t,void 0,void 0,new s.DataManagerReportSortHelper(t))}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.GroupManager=n.getGroupFieldName=n.isGroupField=n.isGroupSlice=n.isGroupSummary=n.isGroupCategory=n.getGroupOptionIndexesFrom=void 0,h=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/viewField/utils.js"),a=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),u=e("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),s=e("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),n.getGroupOptionIndexesFrom=f,n.isGroupCategory=l,n.isGroupSummary=d,n.isGroupSlice=v,n.isGroupField=m,n.getGroupFieldName=g,p.prototype.dl=function(){this.fCe.clearTableDataCache()},p.prototype.isGrouped=function(t){return c(t,this.LEt)},p.prototype.groupBy=function(t,n){var e,i,r,o,e=this,i=e.Yhe(t),r,o={childrenArray:[this.Vhe.generateCellNodeTreeData(i,void 0,void 0,n,void 0,void 0,{ignoreMultipleTableJoinCache:!0})]};return{rootNode:o,indexMap:e.eLt(n,function(){return e.iLt(t,o)})}},p.prototype.Yhe=function(t){var n,e,i,r,e=this,i,r=(t.field.getSourceField()||t.field).fieldValue;return{templateCell:{sorts:t.sort?[((n={})[t.sort]=r,n)]:void 0,dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:r}},data:{groups:[]},field:t.field,group:t.group,children:t.group?[this.Yhe(t.group)]:[],slices:t.slices&&t.slices.length?t.slices.map(function(t){return e.Zhe(t)}):[],formulas:t.formulas}},p.prototype.Zhe=function(t){var n,e,i,n=r({},t),e,i=(n.field.getSourceField()||n.field).fieldValue;return n.templateCell={dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:i}},n.children=[],n.data={groups:[]},n},p.prototype.eLt=function(t,n){var e,i,i,e=this,i=e.LEt;return e.DJ={path:[],groupOptions:i,entireScope:t},e.wEt("groupContext",e.DJ),i=n(),e.DJ=null,e.wEt("groupContext"),i},p.prototype.iLt=function(t,n){for(var e,i,r,o,a,u,e=this,i,r=[],o=0,a=n.childrenArray&&n.childrenArray[0];o<a.length;o++)u=a[o],e.aLt(u,t,r);return r},p.prototype.aLt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,i=this,r=e.length,o=t.recordRowNumbers;if(i.uLt(t),t.childrenArray&&t.childrenArray[0]&&0!==t.childrenArray[0].length)for(f=s=t.childrenArray[c=0];c<f.length;c++)l=f[c],i.aLt(l,n.group,e);else{for(a=0,u=o.length;a<u;a++)e[r+a]=o[a];t.key=n.field.addKey(t.value,e[r])}if(i.sLt(n.formulas,e,r),i.dde(n.windowFunctionOptions,e,r),t.slices)for(a=0,d=(h=t.slices).length;a<d;a++){for(v=h[a],g=(m=n.slices[a]).formula,p=0,b=s=v.childrenArray&&v.childrenArray[0];p<b.length;p++)(l=b[p]).result=i.cLt(g,l.recordRowNumbers);m.addSliceField(m,n.formulas[m.formulaIndex],s,e,r)}i.fLt()},p.prototype.Iwe=function(t,n,e){var i=t.filter;if(!(0,h.isNullOrEmpty)(i))return this.xwe(t.filterExpression,n,e)},p.prototype.Nwe=function(t,n,e){for(var i,r,o,a,u,s,c,i=[],a=0,u=t.length;a<u;a++)c=(s=t[a]).filter,(0,h.isNullOrEmpty)(c)||(r!==c?(r=c,o=i[a]=this.xwe(s.filterExpression,n,e)):i[a]=o);return i},p.prototype.sLt=function(t,n,e){var i,r,o;if(t)for(i=this.Nwe(t,n,e),r=0,o=t.length;r<o;r++)t[r].evaluateFormulaBy(n,e,i[r])},p.prototype.cLt=function(t,n){var e;if(t)return e=this.Iwe(t,n),t.evaluateFormulaBy(n,void 0,e)},p.prototype.dde=function(t,n,e){var i,r,o,a,u,s,c,f,l;if(t)for(i=this,r=0,o=t.length;r<o;r++)for(u=(a=t[r]).orders,s=a.fields,(0,h.isArray)(u)&&0<u.length&&i.wwn(n,u,e),c=0,f=s.length;c<f;c++)(l=s[c]).evaluateWindowFunction(n,e)},p.prototype.uLt=function(t){this.DJ.path.push(t)},p.prototype.fLt=function(){this.DJ.path.pop()},n.GroupManager=p},"./dist/src/viewField/utils.js":function(t,e){"use strict";function n(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.join(e.FieldNameDelimiter)}function i(t){return-1<t.indexOf(e.FieldNameDelimiter)}Object.defineProperty(e,"__esModule",{value:!0}),e.isField=e.combineName=e.RelationTemplateToken=e.CaptionDelimiter=e.FieldNameDelimiter=void 0,e.FieldNameDelimiter="__",e.CaptionDelimiter="\\",e.RelationTemplateToken="{{}}",e.combineName=n,e.isField=i},"./dist/src/viewField/viewField.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/viewField/groupManager.js"),n),r(e("./dist/src/viewField/fieldManager.js"),n),r(e("./dist/src/viewField/fields.js"),n),r(e("./dist/src/viewField/utils.js"),n)},"./dist/src/view/view-cross.js":function(t,n,e){"use strict";var n,i,r,o,e,a;Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/src/view/view.js"),r=e("./dist/src/dataSource/utils.js"),o=e("./dist/src/viewField/fieldManager.js"),e=n.Common.lt.Dh,a=void 0,e(i.View.prototype,{YBt:function(){var t=this;t.lLt.setCrossFieldValues(t.iRt)},hLt:function(){var t=this;t.lLt&&(t.lLt.clearCrossFieldData(),t.YBt())},dLt:function(t,n){var e=this;e.lLt&&e.lLt.removeCrossFieldValues(t,n)},vLt:function(t){var n=this;n.lLt&&n.lLt.resetCrossFieldRowValues(t)},mLt:function(t,n){var e,i;return"string"==typeof t&&(e=!0,i=t,e=!(!(0,r.isNullOrUndefined)(this.LEt.cross)&&(t=this.LEt.cross[i],!(0,r.isNullOrUndefined)(t)))&&e)&&(t={over:i,attributes:[""]}),(0,o.isValidCross)(this.gLt,t,n)},pLt:function(){return this.bLt()&&(0,r.isNullOrUndefined)(this.lLt)},bLt:function(){return this.yLt.some(function(t){return t.cross})},wLt:function(t){for(var e,i,n,r,o,a,u,s,c,f,l,h,d,v,e=this,i=[],n=function(n,t){i.push({newIndex:t,columnInfos:e.yLt.filter(function(t){return t.RBt===n}),fields:e.lLt?e.lLt.getFields(function(t){return t.initialOptionIndex===n}):[]})},r=0,o=t;r<o.length;r++)n(u=(a=o[r]).oldIndex,s=a.newIndex);for(c=function(t,n,e){t.forEach(function(t){return t.RBt=e}),n.forEach(function(t){return t.initialOptionIndex=e})},f=0,l=i;f<l.length;f++)c(d=(h=l[f]).columnInfos,v=h.fields,s=h.newIndex)},MLt:function(){var n=this,t;return n.CLt.map(function(t){return n.SLt(t)})},TLt:function(t,n){var e,i,r,r,o,a,o,a,u,o,e=this,i=e.MLt(),r=e.ALt(i);if(0<r.length&&(t=r[t],n=r[n]),(r=e.ILt[t])&&"string"==typeof r.cross){if(o=e.ILt[t-1]||{},a=e.ILt[t+1]||{},o.cross===r.cross||a.cross===r.cross)return!0;if(o=e.ILt[n],a=e.ILt[t<n?n+1:n-1]||{},o.cross===r.cross||a.cross===r.cross)return!0}return u=function(t,n){return-1<i.indexOf(t)?u(t+n,n):t},(o=function(t,n){var t=e.ILt[u(t,-1)]||{},n=e.ILt[u(n,1)]||{};if("string"==typeof t.cross&&t.cross===n.cross)return!0})(t-1,t+1)||(t<n?o(n,n+1):o(n-1,n))},xLt:function(t){for(var e,i,n,r,e=this,i=0,n=function(t){return t&&0===t.length?a:t},r=function(){var n=e.yLt[i];n.RBt===t?(e.NLt=e.NLt&&e.NLt.filter(function(t){return t.field!==n.value}),e.kLt=e.kLt&&e.kLt.filter(function(t){return t.field!==n.value}),e.DLt=e.DLt&&e.DLt.filter(function(t){return t.field!==n.value}),e._Lt=e._Lt&&e._Lt.filter(function(t){return t.field!==n.value}),e.yLt.splice(i,1),e.lLt&&e.lLt.removeFields(i)):i++};i<e.yLt.length;)r();e.NLt=n(e.NLt),e.kLt=n(e.kLt),e.DLt=n(e.DLt),e._Lt=n(e._Lt)},ELt:function(){var e=this;e.ILt.forEach(function(t,n){(0,r.isNullOrUndefined)(t.cross)||((0,r.isNullOrUndefined)(t.LBt)&&(t.LBt=n),e.yLt[n].LBt=t.LBt)})}})},"./dist/src/view/view-event.js":function(t,n,e){"use strict";var n,S,g,e,n,i,p;function f(n){var t,e,i,r,o,a,u,t=[],e=[],i=Object.keys(g.Events);if((0,S.isArray)(n))for(r=function(n){(i.some(function(t){return t===n})?t:e).push(n)},o=0,a=n;o<a.length;o++)r(u=a[o]);else(i.some(function(t){return t===n})?t:e).push(n);return[t,e]}Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),S=e("./dist/src/dataSource/utils.js"),g=e("./dist/src/table/tableEvents.js"),e=e("./dist/src/view/view.js"),n=n.Common.lt.Dh,i=null,p=void 0,n(e.View.prototype,{bind:function(t,n){var e=this,t=f(t),i=t[0],t=t[1];0<t.length&&(e.jLt(t,n),this.gLt.bind(t,n)),0<i.length&&this.D3(i,this.OLt(n),n)},D3:function(t,n,e){var i,n,i=this,n=i.RLt(n);i.jLt(t,n,null,e),i.gLt.bind(t,n)},unbind:function(t,n){var e,i,r,o,a,u,s,c,e=this,i=f(t),r=i[0],o=i[1];if(0<o.length)for(e.nge(o,n),a=0;a<o.length;a++)u=o[a],this.gLt.unbind(u,n);if(0<r.length&&(s=this.nge(r,null,null,n),e.gLt))for(c=0;c<s.length;c++)e.gLt.unbind(t,s[c])},ki:function(t,n){return this.gLt.ki(t,n)},vOt:function(t){return this.gLt.vOt(t)},Dge:function(t){for(var n,e,t,i,r,o,a,u,n=this,e=n.gLt.name,t=(0,S.isArray)(t)?t:[t],i=n.BLt[e]=n.BLt[e]||{},r=[],o=0,a=t;o<a.length;o++)u=a[o],r=r.concat(i[u]||[]);return r},jLt:function(t,n,e,i){var r,o,a,u,s,c,f,l,l,c,r=this;if(n)for(o=(e||r.gLt).name,s=a=(u=0,S.isArray)(t)?t:[t];u<s.length;u++)c=s[u],(f=(0,S.isFunction)(n)?n:n[c])&&(l=(l=r.BLt[o]=r.BLt[o]||{})[c]=l[c]||[],(0,S.isNullOrUndefined)(i)||(c=(0,S.isFunction)(i)?i:i[c],f.ege=c),l.push(f))},nge:function(t,n,e,i){var r,o,e,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,r=this,o=(e||r.gLt).name,e=(0,S.isArray)(t)?t:[t],a=[];if((0,S.isNullOrUndefined)(i))if(n)for(u=0,s=e;u<s.length;u++)c=s[u],(f=(0,S.isFunction)(n)?n:n[c])&&-1<(d=(h=(l=r.BLt[o]=r.BLt[o]||{})[c]=l[c]||[]).indexOf(f))&&(a=a.concat(h.splice(d,1)));else for(v=0,m=e;v<m.length;v++)for(c=m[v],h=(l=r.BLt[o]=r.BLt[o]||{})[c]=l[c]||[],l[c]=[],g=0;g<h.length;g++)p=h[g],a.push(p);else for(b=0,w=e;b<w.length;b++){for(c=w[b],h=(l=r.BLt[o]=r.BLt[o]||{})[c]=l[c]||[],y=[],M=(0,S.isFunction)(i)?i:i[c],g=0;g<h.length;g++)(p=h[g]).ege===M&&y.push(g);for(C=y.length-1;0<=C;C--)a=a.concat(h.splice(d=y[C],1))}return a},OLt:function(o){var a=this;return function(t,n){var e,i,r;if(a.LLt(n),(0,S.isArray)(o))for(e=0,i=o;e<i.length;e++)(r=i[e]).call(a,t,n);else o&&o.call(a,t,n)}},LLt:function(t){var n=this;t.hasOwnProperty("row")||Object.defineProperty(t,"row",{get:function(){return(0,S.isNumber)(t.Ky)||(t.Ky=n.FLt(t.index)),t.Ky}})},RLt:function(e){var i=this;return function(t,n){i.PLt()&&e.call(i,t,n)}},PLt:function(t){return(0,S.isBoolean)(t)&&(this.rb=!t),!this.rb},GLt:function(n,e){var i=this;return i.PLt(!1),{success:function(t){i.PLt(!0),n&&n(t)},fail:function(t){i.PLt(!1),e&&e(t)}}},v7:function(){var r=this;r.D3(g.Events.ItemInserting,function(t,n){var e=n.index,n=n.data;r.ULt(n),e===r.length()&&r.Dit()&&r.HLt(n,e)}),r.D3(g.Events.ItemInserted,function(t,n){var e=n.index,n=n.data;r.zLt(e,n)}),r.D3(g.Events.ItemUpdating,function(t,n){var e=n.data,i=n.index,n=n.originalData;r.kwe(e,n,i)}),r.D3(g.Events.ItemUpdated,function(t,n){var e=n.data,i=n.index,n=n.originalData;r.YLt(e,n,i)}),r.D3(g.Events.ItemReset,function(t,n){var e=n.index,i=n.originalData,n=n.dataBeforeChanged;r.ZLt(e,i,n)}),r.D3(g.Events.ItemRemoved,function(t,n){var e=n.index,n=n.count;r.WLt(e,n)}),r.D3(g.Events.ChangesSubmitted,function(t,n){r.QLt()}),r.D3(g.Events.ChangesCancelled,function(t,n){r.KLt(n.isDataLengthChanged)})},wpt:function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.BLt;for(e in n)if(n.hasOwnProperty(e))for(r in i=n[e])if(i.hasOwnProperty(r))for(a=0,u=o=i[r];a<u.length;a++)s=u[a],(c=t.gLt.QOt.tables[e])&&c.unbind(r,s);t.BLt={}},$Ot:function(t){var n,e,i,r,o,a,u,s,c,n,e=this.BLt,i=t.name,r=e[i];for(o in r)if(r.hasOwnProperty(o))for(u=0,s=a=r[o];u<s.length;u++)c=s[u],t&&t.unbind(o,c);e[i]=p},KOt:function(t,n){var e,i,r,e,i=this.BLt,r=i[t];delete i[t],i[n]=r},jge:function(t,n){for(var e,i,r,o,a,e=this,i,r=0,o=e.Dge(n.eventName);r<o.length;r++)a=o[r],(0,S.isNullOrUndefined)(a.ege)||a.call(e,t,n)},JLt:function(){var t,n,e,i,r,o,a,u,u;if(this.XLt())for(e=(n=t=this).name,i=t.yLt,r=t.gLt,o=0,a=i;o<a.length;o++)u=a[o],(0,S.isFunction)(u.value)||(0,S.isFormula)(u.value)||!(0,S.isRelation)(u.value)||(u=r.qRt(u.value),!(0,S.isNullOrUndefined)(u)&&(0,S.isNullOrUndefined)(u.VOt[e])&&(u.VOt[e]=n,t.qLt(u)))},qLt:function(e){var v,m,t,h,d,t,o,v=this,m=v.gLt,t=m.QOt.relationships.reduce(function(t,n){return n.sourceTable===m&&n.targetTable===e?{relationshipName:n.sourceRelationshipName,relationFieldName:n.sourceFieldName}:n.sourceTable===e&&n.targetTable===m?{relationshipName:n.targetRelationshipName,relationFieldName:n.targetFieldName}:t},{}),h=t.relationshipName,d=t.relationFieldName,t=function(t,l){var n=v.RLt(function(o,a){var e,t,n,u,n,i,r,s,c,f,e=function(t,n){var t=t.value.split(".");return t[t.length-1-n]},t=v.ILt.filter(function(t){return(0,S.isRelation)(t.value)&&e(t,1)===h}),n=t;if(a.eventName!==g.Events.ItemUpdating&&a.eventName!==g.Events.ItemUpdated||(n=n.filter(function(n){return a.changingFields.some(function(t){return e(n,0)===t})})),u=[p],n.forEach(function(n){var t,e,i,r,t=!(0,S.isNullOrUndefined)(n.cross);t?(i=("string"==typeof n.cross?v.LEt.cross[n.cross]:n.cross).over,(0,S.isNullOrUndefined)(v.NLt)||-1<(r=(0,S.findIndex)(v.NLt,function(t){return-1<t.field.indexOf(n.value)&&-1<t.field.indexOf(i)}))&&(e=v.NLt[r].field)):v.$Lt(n.value)&&u.push(n.value),l.call(v,n.value,t,e)(o,a)}),a.eventName===g.Events.ItemInserted||a.eventName===g.Events.ItemRemoved||a.eventName===g.Events.ItemUpdated){if(a.eventName===g.Events.ItemUpdated&&(n=a.changingFields.some(function(t){return d===t}),i=t.some(function(t){if(!(0,S.isNullOrUndefined)(t.cross)){var n=("string"==typeof t.cross?v.LEt.cross[t.cross]:t.cross).over.split(".").pop();if(a.changingFields.some(function(t){return n===t}))return!0}return!1}),n||i))for(c=r=m.nBt(t[s=0].value,a.index);s<c.length;s++)f=c[s],v.vLt(f);v.tFt(p,!0,u,p)}v.jge(o,a)});v.jLt(t,n,e),e.bind(t,n)},o=function(t,n,e,i){var r,r,r,o,a,u,s,c,f,l,f,h,d;if(v.Dit())for(a=0,u=o=i.relatedViewIndexes||m.nBt(t,i.index);a<u.length;a++)s=u[a],l=f=c=void 0,l=n?(v.vLt(s),c=m.LRt(e,s),(r={})[e]=c,f=r,v.nFt(s,((r={})[e]=!0,r))[e]):(c=m.LRt(t,s),(r={})[t]=c,f=r,m._getValueByField(t,s)),f=v._we(s,f),v.iFt(f,c,t,s),v.hRt(s,t,c,l),m.hRt(s,t,c,l);else if(n)for(h=0,d=o=i.relatedViewIndexes||m.nBt(t,i.index);h<d.length;h++)s=d[h],v.vLt(s)};t(g.Events.ItemRemoving,function(e,i){return function(t,n){i&&(n.relatedViewIndexes=m.nBt(e,n.index))}}),t(g.Events.ItemRemoved,function(e,i,r){return function(t,n){o(e,i,r,n)}}),t(g.Events.ItemInserted,function(e,i,r){return function(t,n){o(e,i,r,n)}}),t(g.Events.ItemUpdating,function(c,f,l){return function(t,n){var e,e,i,r,o,a,u,s,s;if(v.Dit())for(i=n.relatedViewIndexes=m.nBt(c,n.index),n.relatedViewValues=[],r=0,o=i;r<o.length;r++)a=o[r],s=u=void 0,f?u=(s=v.nFt(a,((e={})[l]=!0,e)))[l]:(u=m._getValueByField(c,a),(e={})[c]=u,s=e),s=v._we(a,s),n.relatedViewValues[a]=u,v.iFt(s,u,c,a)}}),t(g.Events.ItemUpdated,function(c,f,l){return function(t,n){var e,i,r,o,a,u,s;if(v.Dit())for(r=0,o=i=n.relatedViewIndexes||m.nBt(c,n.index);r<o.length;r++)a=o[r],u=n.relatedViewValues[a],s=void 0,f?(s=v.nFt(a,((e={})[l]=!0,e))[l],c=l):s=m._getValueByField(c,a),v.hRt(a,c,u,s),m.hRt(a,c,u,s)}})}})},"./dist/src/view/view-filter.js":function(t,n,e){"use strict";var b,h,v,n,d,i;function m(t){return r(t[0])}function r(t){return t&&void 0!==t.Vce}function a(t,n){for(var e,i,r,o,a,u,s,e=["field","value","operator","relation"],i=t[0],r=[],o=0;o<e.length;o++)i.hasOwnProperty(a=e[o])&&r.push(a);for(u=0,s=t.length;u<s;u++)if(!c(t[u],n[u],r))return;return 1}function c(t,n,e){var i,r;for(e=e||["field","value","operator","relation"],i=0;i<e.length;i++)if(t[r=e[i]]!==n[r])return;return t.ort===n.ort}function g(t,n){for(var e,i,r,o,a,e={},i=0;i<t.length;i++)if(!e[r=t[i].field]){for(o=e[r]=[],a=i;a<t.length;a++)t[a].field===r&&o.push(t[a]);n(r,o)}}Object.defineProperty(n,"__esModule",{value:!0}),b=e("./dist/src/dataSource/utils.js"),h=e("./dist/src/table/table.js"),v=e("./dist/src/view/view-util.js"),n=e("Common"),d=e("./dist/src/view/view.js"),(i=n.Common.lt.Dh)(d.View.prototype,{buildInFilter:function(u){var s,c,f,l,t,h,n,e,i,r,e,o,a,s=this.gLt,c={};if(1<u.length){for(f=[],l=[],t=function(i){var t,n,e,r,t,o,a,t=u[i],n=t.field,e=t.operator,r=t.value,t=t.relation,o=c[n];o=o||(c[n]=s.jRt(n)),l.push(t),a=(0,d.rFt)(h.gLt,h.yLt,h.lLt,n,u[i]),a=(0,v.mapGetValueFunc)(o,a),a=(0,v.oFt)(h,e,r,a),f.push(function(t,n,e){return a(t,e,n[i])})},h=this,n=0;n<u.length;n++)t(n);return(0,v.aFt)(f,l)}return i=(e=u[0]).field,r=e.operator,e=e.value,o=s.jRt(i),a=(0,d.rFt)(this.gLt,this.yLt,this.lLt,i,u[0]),a=(0,v.mapGetValueFunc)(o,a),a=(0,v.oFt)(this,r,e,a,i),function(t,n,e){return a(t,e,n[0])}},uFt:function(t){var n=this,e=n.ZOt,i;return n.gLt.ZOt[t]||e[t]},eRt:function(t,n){var e=this,i=e.gLt,r=e.yLt,o,a=[],u=[];t.forEach(function(n){(o=r.filter(function(t){return t.value===n})[0])&&((0,v.isViewColumn)(o)?a:u).push(n)}),i.eRt(u,n),e.sFt(a)},sFt:function(t){for(var n,e,i,r,o,n,e=this.ZOt,i=0,r=t;i<r.length;i++)e[o=r[i]]||(e[o]=this._Rt(o))},cFt:function(){this.ZOt={}},_Rt:function(t){var n=this.lLt.getFieldByName(t);return(0,h.generateFilterIndexCache)(t,(0,b.isNullOrUndefined)(n)?0:this.length(),this.jRt(t),function(t){return n.getValue(t)})},cRt:function(t,n){var e=this,i,r=e.gLt._dataSource.options.schema;e.Yce(t),(0,h.updateFilterIndexesCacheOnInsert)(this.ZOt,t,n,r&&r.columns)},hRt:function(t,n,e,i){var r=this;r.Yce(t,!1,n),r.fge(n),(0,h.updateFilterIndexesCacheOnUpdate)(r.ZOt,t,n,e,i,r.jRt(n))},pRt:function(t,n,e){var i,r,o,a,u,u,i=this,r=i.yLt;if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(e))for(o=0,a=r;o<a.length;o++)u=(u=a[o]).value instanceof Function?u.value.name:u.value,i.hRt(t,u,n[u],e[u])},MRt:function(t,n){var e=this;e.Zce(t,n),(0,h.updateFilterIndexesCacheOnRemove)(e.ZOt,t,n)},fFt:function(t){var e,i,r,n,o,a,u,s,c,f,l,h,d;if(t){if(i=(e=this).iRt,r=[],o=(n=e.lFt).length,n&&0<o&&(r=i.slice(0,o)),a=o,"string"==typeof t)for(u=e.Ywt(t,0,0),s=o;s<i.length;s++)c=i[s],!0===e.nMt(u,c,0)&&(r[a]=c,a++);else if("function"==typeof t)for(s=o;s<i.length;s++)c=i[s],t(e.getRowData(c,!0))&&(r[a]=c,a++);else{if(i.length!==e.length())return e.Wce(),void e.Qce(t,r,i);for(d in(0,b.isArray)(t)||(t=[t]),(0,b.isNullOrUndefined)(e.Jce)&&(e.Jce={}),f=e.isHierarchy(),e.qce(t,function(t,n){e.Qce(n,r,i.slice()),f&&m(n)&&e.afe(n),e.tfe(t,n)}),l=[],h=function(n){t.some(function(t){return t.field===n})?f&&m(e.Jce[n].options)||l.push(n):delete e.Jce[n]},e.Jce)h(d);r=e.nfe(l)}e.iRt=r}},Qce:function(t,i,n){var r,e,o,a,u,s,c,f,l,h,d,r=this,e=(r.lFt||[]).length,o=e;for((0,b.isArray)(t)||(t=[t]),u=[],s=[],c=0;c<t.length;c++)f=t[c],((0,v.isFieldListFilterInfo)(f)?u:s).push(f);if(l=i,h=n,0<u.length&&(l=i.slice(),g(t=u,function(t,n){var t=t,e=r.uFt(t);e||(r.eRt([t]),e=r.uFt(t)),(0,v.hFt)(l,o,e,n,h),h=l,l=i.slice()}),l=h),0<s.length)for(l=i.slice(),t=s,a=this.buildInFilter(t),c=e;c<h.length;c++){d=h[c];try{a(r.gLt,t,d)&&(l[o]=d,o++)}catch(t){}}r.iRt=l},tfe:function(t,n){var e,i,r,o,e=this;if(!(0,b.isNullOrUndefined)(t))for(i=e.lFt||[],r=e.Jce[t]={options:n,count:e.iRt.length-i.length},o=i.length;o<e.iRt.length;o++)r[e.iRt[o]]=!0},afe:function(e){for(var i,r,t,n,o,a,u,s,c,f,l,h,d,v,m,g,p,i=this,r=[],t=function(t){var n=e[t];r.push(i.yLt.find(function(t){return t.value===n.field}))},n=0;n<e.length;n++)t(n);for(o=i.lFt||[],a=i.iRt.slice(0,o.length),n=o.length;n<i.iRt.length;n++)if(u=i.iRt[n],0===(s=i.getHierarchyNode(u,!0)).children.length)for(c=function(t,n){return(0,b.formatCalcError)(i.ufe(t,n))},f=i.ufe.bind(i),l=0;l<e.length;l++){for(d="="===(h=e[l]).field[0]?c:f,v=s,m=0;m<h.Vce.length&&(g=h.Vce[m],(p=d(r[l],v.modalIndex))===g);m++)v=v.parent;if(m===h.Vce.length){a.push(u);break}}i.iRt=a},Wce:function(){this.Jce=null},Yce:function(t,n,e){var i,r,o,a,u,s,c,f,l,i=this,r=i.Jce;if(r&&!(-1<(o=i.lFt||[]).indexOf(t))){for(u in a=i.iRt,r)((0,b.isNullOrUndefined)(e)||u===e||!1===n&&(0,b.isFormula)(u)&&(0,h.isInCalcField)(u,e)&&!i.gLt.Pbe(u))&&(c=(s=r[u]).options,f=a.slice(0,o.length),l=a.slice(0,o.length).concat(t),i.Qce(c,f,l),-1<i.iRt.indexOf(t)?s[t]||(s[t]=!0,s.count+=1):s[t]&&(delete s[t],--s.count));i.iRt=a}},fge:function(t){var n,e,i,r,o,a,u,s,c,n=this,e=n.Jce;if(e&&!n.mme()){for(o in i=n.lFt||[],r=n.iRt,e)(0,b.isFormula)(o)&&((0,b.isNullOrUndefined)(t)||(0,h.isInCalcField)(o,t))&&n.gLt.Pbe(o)&&(u=(a=e[o]).options,s=r.slice(0,i.length),c=r.slice(),n.Qce(u,s,c),(a=n.iRt).count=n.iRt.length,a.options=u);n.iRt=r}},Zce:function(t,n){var e,i,r,o,a,u,s,c,f,e=this,i=e.Jce;if(i&&!(-1<(r=e.lFt||[]).indexOf(t)))for(o in i)if(i.hasOwnProperty(o)){for(u=(a=i[o]).options,delete a.options,delete a.count,s=Object.keys(a),c=0;c<s.length;c++)t+n<=(f=+s[c])?s[c]=f-n:t<=f&&f<t+n&&(s.splice(c,1),c--);(a=s.reduce(function(t,n){return t[n]=!0,t},{})).options=u,a.count=s.length,i[o]=a}},nfe:function(t){var n,e,i,r,o,a,u,s,n=this;if(0<t.length){if(e=n.lFt||[],i=n.iRt,r=n.Jce,1===t.length&&i.length-e.length===r[t[0]].count)return i;for(o=i.slice(0,e.length),a=e.length;a<i.length;a++){for(u=i[a],s=0;s<t.length&&r[t[s]][u];s++);s===t.length&&o.push(u)}return o}return n.iRt},dFt:function(){var t,n,e,i,r,o,a,u,t=this.iRt;for(t||(this.gFt(),t=this.iRt),i=(e=this.lFt).length,e&&0<i&&(n=t.slice(0,i)),r=[],o=this.length(),u=a=0;u<o;u++)(!n||n.indexOf(u)<0)&&(r[a]=u,a++);n&&0<n.length?this.iRt=n.concat(r):this.iRt=r,this.cFt()},HLt:function(t,n){var e=this,i=e.NLt;e.Dit()&&e.autoFilter&&(0,v.addFilterInfoForFieldValue)(i,t,e,void 0,void 0,n)},iFt:function(t,n,e,i){var r=this,o=r.NLt;r.Dit()&&r.autoFilter&&(0,v.addFilterInfoForFieldValue)(o,t,r,n,e,i)},vFt:function(){var t=this;t.mFt()&&t.filter(t.NLt)},mFt:function(){return this.autoFilter&&this.NLt},Dit:function(){var t,n=this.NLt;return(0,b.isArray)(n)&&0<n.length},filter:function(t){var n=this;return n.iRt||n.gFt(),t?(n.isHierarchy()&&n.$ce(),n.fFt(t),n.isHierarchy()&&n.yFt(!0)):n.isHierarchy()?n.gFt():(this.dFt(),n.bde()),this.NLt=(0,b.isArray)(t)&&0<t.length?t:null,this.iRt.length},$ce:function(){var e=this;e.bFt().forEach(function(t){var n;e.getHierarchyNode(t,!0).modalIndex=t})},yFt:function(t){var n,e,i,r,o,a,u,s,c,t,f,n=this,e=n.iRt;if(!(0,b.isNullOrUndefined)(e)&&0!==e.length){for(t||n.$ce(),i=[],r=1,o=0;o<e.length;o++)a=e[o],(u=n.getHierarchyNode(a,!0)).visit=r,(0,b.bubbleTree)(u,function(t){t.isRoot||(t.visit=r)}),(0,b.traversalTree)(u,function(t){t.visit=r});for(c in n.Jce)if(m(n.Jce[c].options)){s=n.Jce[c];break}if(!(0,b.isNullOrUndefined)(s)){for(a in r=2,t=s.options,f=s.count,delete s.options,delete s.count,s)s.hasOwnProperty(a)&&(u=n.getHierarchyNode(+a,!0),(0,b.isNumber)(u.visit))&&(u.visit=r,(0,b.bubbleTree)(u,function(t){t.isRoot||(t.visit=r)}));s.options=t,s.count=f}(0,b.traversalTree)(n.getHierarchyRootNode(),function(t){t.visit===r&&(i.push(t.modalIndex),delete t.visit,delete t.modalIndex)}),n.iRt=i}},bFt:function(){var t=this,n=t.iRt,e,i=t.isHierarchy(),e=t.wFt;return i&&!(0,b.isNullOrUndefined)(e)||(t.gFt(),t.sort(t.kLt),e=t.iRt,t.iRt=n,i&&(t.wFt=e)),e},qce:function(t,r){var o=this;(0,b.isNullOrUndefined)(o.Jce)&&(o.Jce={}),g(t,function(t,n){var e=o.Jce[t],i;!(0,b.isNullOrUndefined)(e)&&e.options.length===n.length&&a(e.options,n)||r(t,n)})}})},"./dist/src/view/view-group.js":function(t,n,e){"use strict";var i,r,p,u,b,w,y,e,o,f;function s(s,c,f){for(var l,h,d,v,m,t,n,g,e,i,r,l=[],h=-1,d=-1,v=y.GROUP_COLUMN_WIDTH,m={},t=function(t){for(var n,e,i,r,n=s[t],e=0,i=f;e<i.length;e++)r=i[e],n.value===r.field&&(n.GFt=!0,m[(0,w.combineName)(n.value,(0,p.findIndex)(f,function(t){return t.field===n.value}))]={colInfo:n,index:t})},n=0;n<s.length;n++)t(n);for(e=function(t,n){var e,i,r,o,a,u,e=c.getField(g[t]),i=e.name,r,o={caption:e.extra.caption,value:i,name:i,isGroup:!0};-1<(d=(0,p.findIndex)(f,function(t,n){return(0,w.combineName)(t.field,n)===i}))&&(v=(0,y.getGroupColumnWidth)(f[d].field,s),h=d,o.DFt=!0,a=m[i],(0,p.isNullOrUndefined)(a)||(a.colInfo._Ft=t,o._Ft=a.index+n)),o.OFt=h,o.width=v,(u=e.extra)&&(0,b.setFieldExtraProperties)(function(t){u[t]&&(o[t]=u[t])}),l.push(o)},i=0,r=(g=c.positionOfField).length-c.keysOfBaseField.length;i<r;i++)e(i,r);return l}function g(t,n,e){for(var e,i,r,o,a,u,s,c,e=e?e.length:0,i={},r=e;r<t.length;r++)i[t[r]]=!0;for(o=0,a=e,u=n.length,s=t.length;o<u&&a<s;o++)i[c=n[o]]&&(t[a]=c,a++)}function M(t,n){var e,i,r,o,a;if(t&&0<t.length){for(e=[],i=n.length,0<(r=t.length)&&(e=t.slice(0)),o=r,a=0;a<i;a++)-1===t.indexOf(n[a])&&(e[o]=n[a],o++);return e}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.ise=void 0,i=e("Common"),r=e("./dist/src/view/view.js"),p=e("./dist/src/dataSource/utils.js"),u=e("./dist/src/viewField/groupManager.js"),b=e("./dist/src/viewField/fields.js"),w=e("./dist/src/viewField/utils.js"),y=e("./dist/src/view/view-util.js"),e=i.Common.lt.Dh,o=null,f=void 0,n.ise=s,e(r.View.prototype,{groupBy:function(t){var n,e,n=this;return 0===arguments.length||!(0,p.isArray)(t)||n.hasHierarchyColumn()||0===(t=0<(e=n.yLt.filter(function(t){return t.isCross})).length?t.filter(function(n){return!e.some(function(t){return t.value===n.field})}):t).length?n.MFt:(n.iRt||n.gFt(),n.CFt(t),void(this.MFt=t))},windowOver:function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,i=this,r=!1,a=function(){return o=!i.iRt||(r=i.iRt.length!==i.length())?i.qFt():i.iRt.slice()},u=i.gLt.fme(),s=!1,c=!1,o=!u||(s=i.vde(),c=i.Dit(),e)||s||c?a():(i.iRt||i.gFt(),i.iRt);if((0,p.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,o=i.mde(t,o).indexMap;else for(f=0;f<n.length;f++)for(h=(l=n[f]).orders,(0,p.isArray)(h)&&0<h.length&&i.gde(o,h),d=l.functions,v=0;v<d.length;v++)(m=i.gLt.XOt[d[v].windowOverFormula]).evaluateWindowFunction(o);!u||s&&!r||(c?e||g(i.iRt,o,i.lFt):i.iRt=M(i.lFt,o))},removeGroupBy:function(){var t=this;t.isHierarchy()||(t.AFt(),t.IFt(),t.SFt(),t.MFt=o,t.xFt(),t.NFt())},AFt:function(){var t;this.kFt()},IFt:function(){var t,n,e,i,r,o,a,u,s,c,t=this,n=t.gLt,e=t.NLt,i=t.ZOt,r=t.getColumnInfos();if(e){for(c=e.length-1;0<=c;c--)o=e[c],(a=r.filter(function(t){return t.name===o.field})[0]).DFt?(u=(0,y.getColumnName)(r[a._Ft]),(s=i[o.field])&&(n.ZOt[u]=i[o.field],delete i[o.field]),o.field=u):a.isGroup&&(e.splice(c,1),delete i[o.field]);t.NLt=0===e.length?f:e}},xFt:function(){var t,n,e,i,r,t=this;if(t.kLt){for(n=[],e=0,i=t.kLt;e<i.length;e++)delete(r=i[e]).EFt,r.jFt?(0,u.isGroupField)(r.field)&&(delete r.jFt,delete r.OFt,r.field=(0,u.getGroupFieldName)(r.field),n.push(r)):n.push(r);t.kLt=0===n.length?f:n}t._Lt=f,t.DLt=t.kLt},CFt:function(t){var n,e,i,e;t&&((n=this).kFt(),i=(e=n.mde(t)).rootNode,e=e.indexMap,n.FFt=i,n.iRt=e,n.SFt(),n.TFt(t))},mde:function(t,n){var e,n,i,r,o,e,t,e=this,n=n||e.iRt,i=e.lLt||e.RFt(),r=e.BFt||e.LFt(t),o=n;return e.length()>n.length?((0,p.isNullOrUndefined)(e.Efe)&&(e.Efe=e.qFt()),o=e.Efe):e.Efe=f,e=i.buildGroupFields(t,o),t=r.groupBy(e,n),i.transposeSliceFields(e),t},kFt:function(){var t,n,n=this;(n.BFt=null)!=(t=n.lLt)&&t.reset(),n.FFt=null},pde:function(t){var n=this,e=this.autoGroup&&this.MFt;return e&&((0,p.isString)(t)?n.$Lt(t):!((0,p.isArray)(t)&&0<t.length)||t.some(function(t){return n.$Lt(t)}))},PFt:function(t){var n=this;n.pde(t)&&n.CFt(n.MFt)},$Lt:function(n){var t=this;return t.MFt&&t.MFt.some(function(t){return-1<t.field.indexOf(n)||t.summaryFields&&t.summaryFields.some(function(t){return t.formula&&-1<t.formula.indexOf(n)||t.slice&&("string"==typeof t.slice?-1<t.slice.indexOf(n):t.slice.field&&-1<t.slice.field.indexOf(n))})})},LFt:function(t){var n=this,e=n.gLt,i=e.POt;return n.BFt=new u.GroupManager(t,i.wEt.bind(i),e.QOt,n.gde.bind(n)),n.BFt},SFt:function(){for(var t,n,e,i,t=this,n=t.getColumnInfos(),e=n.length-1;0<=e;e--)(i=n[e]).isGroup&&n.splice(e,1),i.GFt&&(i.GFt=f,i._Ft=f);t.setColumnInfos(n)},TFt:function(t){for(var n,e,i,r,o,a,u,n=this,e=s(n.yLt,n.lLt,t),i=n.UFt,r,o=0,a=n.getColumnInfos();o<a.length;o++)u=a[o],i||(u.visible=!1),e.push(u);n.setColumnInfos(e)},HFt:function(t){var e,n,i,r,o,a,u,s,c,f;if(t){for(n=(e=this).FFt,i=[],r=e.yLt,o=Array.isArray(t)?t:[t],a=[],u=[],s=function(t){var n,t,n=o[t],t=r.filter(function(t){return t.value===n.field})[0];(t&&(0,p.isNumber)(t.OFt)?(n.jFt=!0,n.EFt=e.zFt([n]),n.OFt=t.OFt,a):u).push(n)},c=0;c<o.length;c++)s(c);f=e.zFt(u),u.forEach(function(t){return t.EFt=f}),e.VFt(n,i,0,a,u),e.iRt=i}},VFt:function(t,n,e,i,r){var o,t,a,u,s,c,f,l,h,d,v,o=this,t=t.childrenArray&&t.childrenArray[0];if(t)for(1<t.length&&0<i.length&&0<(s=i.filter(function(t){return t.OFt===e})).length&&(c=s[0].EFt,t.sort(function(t,n){return c(o.gLt,s,t.key,n.key)})),f=0,l=t;f<l.length;f++)if(u=(h=l[f]).recordRowNumbers)for(1<u.length&&0<r.length&&(c=(s=r)[0].EFt,u.sort(function(t,n){return c(o.gLt,s,t,n)})),a=n.length,d=0,v=u.length;d<v;d++)n[a+d]=u[d];else o.VFt(h,n,e+1,i,r)},setGroupSliceColumnSettings:function(t,n){var e=this,i=t[n];t.isGroup&&e.isGroupSliceColumn(t)&&e.getGroupSliceColumns(t).forEach(function(t){return t[n]=i})},isGroupSliceColumn:function(t){return t.isGroup&&(0,u.isGroupSlice)(t.value)},getGroupSliceColumns:function(t){var n,e,i,r,o,a,n,e=[],i=t.OFt,r=this.yLt;if(t.isGroup)for(o=0;o<r.length;o++)(a=r[o]).OFt===i&&(0,u.isGroupSlice)(a.value)&&e.push(a);return e},updateColumnSettingToGroupOptions:function(t,i){var n,e,r,o,a,n,e=this.MFt;if(e&&t.isGroup)switch(o=function(n,e){(0,b.setFieldExtraProperties)(function(t){!(0,p.isNullOrUndefined)(i)&&i!==t||(n[t]=e[t])})},(r=(0,u.getGroupOptionIndexesFrom)(t.value)).length){case 1:o(e[r[0]],t);break;case 2:o(e[r[0]].summaryFields[r[1]],t);break;case 3:o(a="string"==typeof(a=e[r[0]].summaryFields[r[1]].slice)?e[r[0]].summaryFields[r[1]].slice={field:a}:a,t)}},detailColumnsVisible:function(t){var n,e,n,i,n=this;if(0===arguments.length)return n.UFt;if(n.UFt!==t&&(n.UFt=t,n.BFt))for(e=n.getColumnInfos(),i=(n=n.lLt).positionOfField.length-n.keysOfBaseField.length;i<e.length;i++)e[i].visible=t}})},"./dist/src/view/view-sort.js":function(t,n,e){"use strict";var i,d,v,m,e;function u(i){return i.iRt.reduce(function(t,n){var e=i.getHierarchyNode(n,!0);return(0,d.isNullOrUndefined)(e)||(t[e.id]=n),t},{})}function s(n,e){return function(t){(0,d.isNullOrUndefined)(n[t.id])||e.push(n[t.id])}}function g(t,n,e,i,r){for(var o,a,u,s,o={},a=(0,v.rFt)(t,n,e,r,o,!1),u=0;u<i.length;u++)if(s=a(o,u,o),!(0,d.isNullOrUndefined)(s)&&!(0,d.isCalcError)(s))return s;return null}function p(t,n,e,i,r,o){var a,u,s,c,f,l,h;if(1===r.length)return o=o||0,a=r[0],u=(0,v.rFt)(t,n,e,a.field,a),s=void 0,s=a.compare?function(t,n,e,i){var e,t,e=u(t,e,n[o]),t=u(t,i,n[o]);return n[o].compare(e,t,n[o].ascending)}:null===(c=g(t,n,e,i,a.field))?function(){return 0}:(f=a.ascending,function(t,n,e,i){var e,t,e=u(t,e,n[o]),t=u(t,i,n[o]);return(0,m.compareValue)(f,c,e,t)});for(l=0;l<r.length;l++)a=r[l],(h=(0,v.ZFt)(t,n,a.field)).isGroup&&(0,d.isNullOrUndefined)(a.ascending)&&(a.compare=function(t,n){return t===n?0:1}),a.WFt=p(t,n,e,i,[a],l);return m.multiSort}function c(t){return!t.gLt.fme()||t.Dit()}Object.defineProperty(n,"__esModule",{value:!0}),n.ese=void 0,i=e("Common"),d=e("./dist/src/dataSource/utils.js"),v=e("./dist/src/view/view.js"),m=e("./dist/src/view/view-util.js"),e=i.Common.lt.Dh,n.ese=p,e(v.View.prototype,{zFt:function(t,n){return p(this.gLt,this.yLt,this.lLt,this.iRt,t,n)},QFt:function(t){var n;t&&((n=this).isHierarchy()?(n.wFt=null,n.DLt=(0,m.getSortInfos)(t),n.KFt(t)):n.MFt?(n._Lt=(0,m.getSortInfos)(t),n.HFt(t)):(n.DLt=(0,m.getSortInfos)(t),n.JFt(t)))},JFt:function(t){var n,e,i,r,o,a,a,o,o;t&&(i=(e=(n=this).lFt).length,a=void 0===(a=(o=(r=Array.isArray(t)?t:[t])[0]).startRow)?0:a,o=void 0===(o=o.endRow)?n.length():o,n.gde(n.iRt,t,i+a,o))},gde:function(t,n,e,i){var r,o,a,u,s,c;if(n&&(r=this,0!==(o=Array.isArray(n)?n:[n]).length))if(a=r.zFt(o),i=i||t.length,0===(e=e||0)&&i>=t.length)t.sort(function(t,n){return a(r.gLt,o,t,n)});else for((u=t.slice(e,i)).sort(function(t,n){return a(r.gLt,o,t,n)}),s=0,c=u.length;s<c;s++)t[s+e]=u[s]},XFt:function(){var t,n,e,t=this,n=t.gLt.uBt();return!(0,d.isNullOrUndefined)(n)&&(0,d.isNullOrUndefined)(t.kLt)?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&(e={field:n,ascending:!0},t.isHierarchy()?t.KFt(e):t.JFt(e)),!0):(0,d.isNullOrUndefined)(n)&&(0,d.isNullOrUndefined)(t.kLt)&&t.isHierarchy()?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&t.$Ft(),!0):void 0},KFt:function(e){var i,t,n,r,o,a;e&&(t=(i=this).getHierarchyRootNode(),n=[],r=Array.isArray(e)?e:[e],o=u(i),a=i.zFt(r),r.forEach(function(t){return t.EFt=a}),(0,d.traversalTree)(t,s(o,n),{isOrderChildren:i.tOi,compareFn:function(t,n){return a=(e=r)[0].EFt,(0,d.isNullOrUndefined)(o[t.id])||(0,d.isNullOrUndefined)(o[n.id])?0:a(i.gLt,e,o[t.id],o[n.id])}}),i.iRt=n)},$Ft:function(){var t,n,e,i,t=this,n=t.getHierarchyRootNode(),e=[],i=u(t);(0,d.traversalTree)(n,s(i,e),{field:"sequence",isOrderChildren:!1}),t.iRt=e},NFt:function(){var t=this;t.tPt()&&t.sort(t.kLt)},tPt:function(){return this.autoSort&&this.kLt},sort:function(t){var n=this;n.iRt||n.gFt(),n.QFt(t),this.kLt=t},vde:function(t){var n=this;return n.tPt()||n.pde(t)},bde:function(t,n){var e,i,r,o,a,a,u,a,e=this;if(!e.vde(t)&&(n||c(e))&&e.tme()){for(i=e.getColumnInfos(),r=[],o=i.length-1;0<=o;o--)if(a=i[o],0<(a=e.Gbe(a)).length){a=(u=e.gLt.XOt[a[a.length-1]]).options,(0,d.isArray)(a.partitions)&&0<a.partitions.length&&a.partitions.forEach(function(t){return r.push({field:t.field,ascending:t.ascending})}),(0,d.isArray)(a.orders)&&0<a.orders.length&&a.orders.forEach(function(t){return r.push({field:t.field,ascending:t.ascending})});break}0<r.length&&e.JFt(r)}},nPt:function(t){var n=this,e=n.autoSort,i=n.DLt&&0<n.DLt.length,r=n._Lt&&0<n._Lt.length;n.bde(t),e&&i&&(n.isHierarchy()?n.KFt(n.DLt):n.JFt(n.DLt)),n.PFt(t),e&&r&&n.HFt(n._Lt)}})},"./dist/src/view/view-style.js":function(t,n,e){"use strict";var n,e,i;Object.defineProperty(n,"__esModule",{value:!0}),n=e("Common"),e=e("./dist/src/view/view.js"),(i=n.Common.lt.Dh)(e.View.prototype,{getStyleRules:function(){return this.LEt.styleRules},getStyleRule:function(t){var n=this.getStyleRules();return t?n[t]:n},addStyleRule:function(t,n,e){var i,r;t&&(i={},n&&(i.style=n),e&&(i.rule=e),(r=this.getStyleRules())[t]=i)},removeStyleRule:function(t){var n;delete this.getStyleRules()[t]},clearStyleRules:function(){this.LEt.styleRules={}}})},"./dist/src/view/view-util.js":function(F,r,t){"use strict";var w,c,I,u,s,f,y,x;function n(t,n,e,i){var r,t,r=t?e:i,t=t?i:e;return(0,I.isNullOrUndefined)(r)&&(0,I.isNullOrUndefined)(t)?0:(0,I.isNullOrUndefined)(r)?-1:(0,I.isNullOrUndefined)(t)?1:"number"==typeof n||n instanceof Date?r-t:t<r?1:r<t?-1:0}function e(t,n,e,i,r){var o,a;if(e instanceof Date)if(-1<u.indexOf(n))e=e.getTime(),o=i,i=function(t,n,e){return o(t,n,e)&&o(t,n,e).getTime()};else{if(-1<s.indexOf(n))return function(){return!1};if(-1<f.indexOf(n))return function(){return!0}}return a=l(t,n,e,r),function(t,n,e){return a(i(t,n,e))}}function l(t,n,e,i){var r,o,a,u,s,s,s,r=e+"",o=r&&r.length;switch((0,I.isString)(e)&&(a=c.Common.$T.jJ(e)),u=t.gLt,n){case"eq":return s=function(t){return t===e},(0,I.isNullOrUndefined)(e)&&(s=function(t){return t===y||t===x}),a?function(t){return new RegExp("^"+a+"$").test(t)}:s;case"neq":return s=function(t){return t!==e},(0,I.isNullOrUndefined)(e)&&(s=function(t){return t!==y&&t!==x}),a?function(t){return!new RegExp("^"+a+"$").test(t)}:s;case"lt":return function(t){return null!==t&&t<e};case"lte":return function(t){return null!==t&&t<=e};case"gt":return function(t){return e<t};case"gte":return function(t){return e<=t};case"startswith":return a?function(t){return new RegExp("^"+a).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)===e};case"doesnotstartwith":return a?function(t){return!new RegExp("^"+a).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)!==e};case"endswith":return a?function(t){return new RegExp(a+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1!==(t+"").indexOf(e,(t+"").length-o)};case"doesnotendwith":return a?function(t){return!new RegExp(a+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1===(t+"").indexOf(e,(t+"").length-o)};case"contains":return a?function(t){return new RegExp(a).test(t)}:function(t){return"string"==typeof(t+"")&&0<=(t+"").indexOf(e)};case"doesnotcontain":return a?function(t){return!new RegExp(a).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(e)<0};case"top":case"bottom":return(s=t.uFt(i))||(t.eRt([i]),s=t.uFt(i)),e=h(Object.keys(s),n,e),function(t){return-1<e.indexOf(t)};case"above":return e=d(u._dataSource._data[i].data,u.jRt(i)),function(t){return e<t};case"below":return e=d(u._dataSource._data[i].data,u.jRt(i)),function(t){return t<e};case"quarter":return function(t){return v(e,t)};case"month":return function(t){return(t&&t.getMonth())===e};default:return function(){return!1}}}function h(t,n,e){for(var i,r,o,a,i=[],r=0,o=t;r<o.length;r++)a=o[r],isNaN(a)||i.push(parseFloat(a));return e>=i.length||("top"===n?i=m(i,e):"bottom"===n&&(i=b(i,e))),i}function d(t,n){var e,i,r,o,a,e=0;if(!t||0===t.length)return e;for(i=n&&n.dataMap,r=0,o=t;r<o.length;r++)a=o[r],"number"==typeof(a=i&&"number"==typeof i[a]?i[a]:a)&&(e+=a);return e/t.length}function v(t,n){var e=n&&n.getMonth();switch(t){case 0:return e<=2;case 1:return 3<=e&&e<=5;case 2:return 6<=e&&e<=8;case 3:return 9<=e;default:return!1}}function i(t,n,e,i){for(var r,o,a,u,r=0,o=0,a=n.length;o<a&&0===(r=(u=n[o]).WFt(t,n,e,i));o++);return r}function o(t){return Array.isArray(t)?t:[t]}function a(t,n){var e,i;if(0===t.length)return[];for(e=t.slice(0),i=0;i<n;i++)-1===t.indexOf(i)&&e.push(i);return e}function m(t,n){for(var e,i,r,e=g(t.slice(0,n)),i=n;i<t.length;i++)t[i]>e[0]&&(r=e[0],e[0]=t[i],t[i]=r,g(e));return e}function g(t){for(var n,e,n=t.length,e=Math.floor(n/2);0<=e;e--)p(t,e,n);return t}function p(t,n,e){var i,r,o,i,i=2*n+1,r=2*n+2,o=n;i<e&&t[i]<t[o]&&(o=i),n!==(o=r<e&&t[r]<t[o]?r:o)&&(i=t[n],t[n]=t[o],t[o]=i,p(t,o,e))}function b(t,n){for(var e,i,r,e=M(t.slice(0,n)),i=n;i<t.length;i++)t[i]<e[0]&&(r=e[0],e[0]=t[i],t[i]=r,M(e));return e}function M(t){for(var n,e,n=t.length,e=Math.floor(n/2);0<=e;e--)C(t,e,n);return t}function C(t,n,e){var i,r,o,i,i=2*n+1,r=2*n+2,o=n;i<e&&t[i]>t[o]&&(o=i),n!==(o=r<e&&t[r]>t[o]?r:o)&&(i=t[n],t[n]=t[o],t[o]=i,C(t,o,e))}function S(t,n){for(var e,i,r,o,e=0,i=t;e<i.length;e++)if(o=n(r=i[e]))return o}function T(t){var n,t,e,i,n=t.style,t=(t=(n=n||(t.style={})).cellButtons)||(n.cellButtons=[]),e=(e=n.dropDowns)||(n.dropDowns=[]);(i=S(t,function(t){return"openDateTimePicker"===t.command}))||t.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent"}),(i=S(e,function(t){return"dateTimePicker"===t.type}))||e.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}function A(n,t){var e,i,e=(0,I.findIndex)(t,function(t){return N(t)===n});return-1<e&&(i=t[e]).width||r.GROUP_COLUMN_WIDTH}function N(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function k(t){return!t.JOt}function _(t){var n,e,i,r,o,n=k(t);if(n){for(t.WOt++,i=0,r=e=t.eBt();i<r.length&&(!(o=r[i])||o.WOt||(n=_(o)));i++);t.WOt--}return n}function D(t){return t.isGroup||t.isCross}function j(t){return O(t[0])}function O(t){return t.operator===x}function E(t){return t[0].operator!==x&&t[0].ort}function R(l,h,d,v,m,g){for(var p,b,t,n,e,i,p=d.isHierarchy(),b={},t=function(n){var t,e,i,r,o,a,u,s,c,f;if(n&&!b[n.field]&&((0,I.isNullOrUndefined)(m)||n.field===m)){if(b[n.field]=!0,(t=d.uFt(n.field))||(d.eRt([n.field]),t=d.uFt(n.field)),e=t&&Object.keys(t),r=void 0,(i=h[n.field])instanceof Date){for((o=new Date(i)).setHours(0,0,0,0),a=o.toISOString().slice(0,10),r=!0,u=0,s=e;u<s.length;u++)if((c=s[u]).startsWith(a)){r=!1;break}}else r=(0,I.isNullOrUndefined)(i)?-1===e.indexOf("null")&&-1===e.indexOf("undefined"):-1===e.indexOf(i+"");if(!l.some(function(t){return t.field===n.field&&t.value===i})&&r&&(j(l)?(l.push(w(w({},n),{value:i,isAdded:!0})),p&&L(d,l[l.length-1],m,i,g)):(E(l)||i===v&&void 0===v)&&l.push(w(w({},n),{value:i,operator:"eq",relation:"or",isAdded:!0}))),-1<e.indexOf(v+"")&&1===t[v].length&&v!==i)for(f=0;f<l.length;f++)if(l[f].value===v&&l[f].isAdded){l.splice(f,1);break}}},n=0,e=l;n<e.length;n++)t(i=e[n])}function L(t,n,e,i,r){var e,o,a,u;if(n.field===e||(0,I.isNullOrUndefined)(e)){if(e=void 0,n.Vce)(e=n.Vce.slice())[0]=i;else{for(a=(o=t.getHierarchyNode(r,!0)).parent,u=[i];!a.isRoot;)u.push(a.getFieldValue(n.field)),a=a.parent;e=u}n.Vce=e}}function B(t){var n,e,i,r,r;if((0,I.isNullOrUndefined)(t))return t;for(n=[],e=0,i=t;e<i.length;e++)r=i[e],(r=w({},r)).getValue&&delete r.getValue,n.push(r);return n}function P(i,r){var t,o,a,t,o=function(n,e,i,t){return t.every(function(t){return t(n,e,i)})},a=function(){for(var t,n,e,t=[],n=[i[0]],e=1;e<i.length;e++)"or"===r[e]?(t.push(n),n=[i[e]]):n.push(i[e]);return 0<n.length&&t.push(n),t}();return function(n,e,i){return a.some(function(t){return o(n,e,i,t)})}}function G(t,i){var r;return t&&t.dataMap?(r=JSON.parse(JSON.stringify(t.dataMap)),function(t,n,e){var t=i(t,n,e);return void 0!==r[t]?r[t]:t}):i}function U(t,n,e,i,r){var o,a,u,i,s,c,f,l,h,d,v,m,g,p,b,w,o=[],a=!1,u=!1,i=i.map(function(t){var n=t.value;return n===y&&(a=!0),n===x&&(u=!0),t.value});for(a&&!u&&i.push(x),u&&!a&&i.push(y),s=0,c=i;s<c.length;s++)for(f=c[s],h=0,d=l=e&&e[f]||[];h<d.length;h++)o[v=d[h]]=!0;for(m=n,g=t.reduce(function(t,n){return t[n]=!0,t},{}),p=0,b=r;p<b.length;p++)!o[w=b[p]]||0<n&&g[w]||(t[m]=w,m++)}function H(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,u=[],s=i.map(function(t,n){return n}),c=[];if(r&&r.length&&(f=!(s=[]),i.forEach(function(t,n){-1<o.indexOf(n)?(u.push(n),s.push(x)):(u.push(x),s.push(n)),t.isCross&&(f=!0)}),t=r[t],n=r[n],f)){for(l=[],h=[],d=0;d<i.length;d++)(i[d].isCross?(l[i[d].RBt]||(l[i[d].RBt]=[],c.push(l[i[d].RBt])),v=l[i[d].RBt]):c).push(d),t===d&&(t=c.length-1),n===d&&(n=c.length-1);for(m=0,g=o;m<g.length;m++)p=g[m],h.push(c.indexOf(p));u=[],s=[],c.forEach(function(t,n){-1<h.indexOf(n)?(u.push(n),s.push(x)):(u.push(x),s.push(n))}),e=1}if((0,I.swapArrayItems)(s,t,n,e),s=s.filter(function(t){return!(0,I.isNullOrUndefined)(t)}),r&&r.length){for(d=0;d<u.length;d++)void 0===u[d]&&(u[d]=s.shift());if(c&&c.length){for(b=[],w=0;w<u.length;w++)if(y=u[w],Array.isArray(c[y]))if("string"==typeof(M=a[w].cross)){for(C=[u[w]];w+1<a.length&&M===a[w+1].cross;)C=C.concat(u[w+1]),w++;for(S=c[C[0]].length,T=[],A=0;A<S;A++)for(d=0;d<C.length;d++)T.push(c[C[d]][A]);b=b.concat(T)}else b=b.concat(c[y]);else b.push(c[y]);u=b}}else u=s;return u}w=this&&this.__assign||function(){return(w=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(r,"__esModule",{value:!0}),r.ePt=r.hFt=r.mapGetValueFunc=r.aFt=r.removeExtraInfos=r.addFilterInfoForFieldValue=r.isFieldListFilterInfo=r.isFieldListFilter=r.isViewColumn=r.isTableDataReady=r.getColumnName=r.getGroupColumnWidth=r.applyDateTimePicker=r.array_find=r.generatePinnedColumnIndexMap=r.getSortInfos=r.multiSort=r.oFt=r.compareValue=r.GROUP_COLUMN_WIDTH=void 0,c=t("Common"),I=t("./dist/src/dataSource/utils.js"),u=["eq","neq","lt","lte","gt","gte"],s=["startswith","doesnotstartwith","endswith","contains"],f=["doesnotendwith","doesnotcontain"],y=null,x=void 0,r.GROUP_COLUMN_WIDTH=100,r.compareValue=n,r.oFt=e,r.multiSort=i,r.getSortInfos=o,r.generatePinnedColumnIndexMap=a,r.array_find=S,r.applyDateTimePicker=T,r.getGroupColumnWidth=A,r.getColumnName=N,r.isTableDataReady=_,r.isViewColumn=D,r.isFieldListFilter=j,r.isFieldListFilterInfo=O,r.addFilterInfoForFieldValue=R,r.removeExtraInfos=B,r.aFt=P,r.mapGetValueFunc=G,r.hFt=U,r.ePt=H},"./dist/src/view/view.entry.js":function(t,n,e){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./dist/src/view/view.js"),n),r(e("./dist/src/view/view-style.js"),n),r(e("./dist/src/view/view-event.js"),n),r(e("./dist/src/view/view-group.js"),n),r(e("./dist/src/view/view-sort.js"),n),r(e("./dist/src/view/view-filter.js"),n),r(e("./dist/src/view/view-cross.js"),n)},"./dist/src/view/view.js":function(t,n,e){"use strict";var o,h,T,a,v,i,b,r,y,u,w,s,c;function f(t){return{rule:{area:a.ViewArea.colHeader,direction:a.StateRuleDirection.column,state:t},style:{decoration:{icons:[{src:""}]}}}}function l(t){(0,T.isNullOrUndefined)(t.styleRules)&&(t.styleRules=(0,T.clone)(s,!0))}function d(t){return t instanceof Date&&!isNaN(t.valueOf())}function m(t){return r.Common.ct.Q0(t)}function g(t){var n=r.Common.ct.dJ(t);return n&&!d(n)&&(n=r.Common.ct.iPt(t)),d(n)?n:null}function p(t){var n,e,i,r,n=[],e=t.columns;if(e)for(i in e)e.hasOwnProperty(i)&&("="===(r=(0,T.clone)(e[i])).value[0]&&r.name&&(r.value=r.name),n.push(r));return n}function M(t){return 0===t?"":"_"+t}function C(t,n,e,i){var r,o,i,i;return(0,T.isNullOrUndefined)(e)||(o=e.value,e.isCross||e.isGroup?i&&(i=i.getFieldByName(o))&&(r=i.getValue(n)):o&&("string"==(i=typeof o)?r=A(t,e,n):"function"==i&&(r=e.value(t.iBt(n))))),r}function S(i,f,t,r,e,o,a,u,s,n){var l,c,h,d,v,m,g,p,l={},c=[],h=!!e;if(f.forEach(function(t,n){var e,n,e=t.value;a&&!a[e]||(t.isCross?r&&(l[t.value]=r.getFieldByPosition(n).getValue(o)):t.isGroup?r&&r.kve(l,n,o,u,s):e&&("string"==typeof e?(n=u&&t.caption||e,l[n]=A(i,t,o)):"function"==typeof e&&c.push({name:e.name,caption:t.caption,value:e})))}),0<c.length&&(d=i.iBt(o),c.forEach(function(t){l[t.name]=t.value(d)})),h&&r&&e&&n){for(m in v=r.getFieldValues(o,u,s))!v.hasOwnProperty(m)||s&&a&&!a[m]||(l[m]=v[m]);for(g=function(s){for(var c,t,n,c=e[s].summaryFields,t=function(e){var t,n,t,i,r,o,a,u,t=c[e];if(t&&t.slice){for(n=M(s),t=t.caption+"_"+t.slice+n,i={},o=0,a=r=f.filter(function(t){var n=(0,b.getGroupOptionIndexesFrom)(t.value);return t.isGroup&&3===n.length&&+n[0]===s&&+n[1]===e});o<a.length;o++)i[(u=a[o]).caption]=v[u.value];l[t]=i}},n=0;n<c.length;n++)t(n)},p=0;p<e.length;p++)g(p)}return l}function A(t,n,e){return I(t._getValueByField(n.value,e),n)}function I(t,n){var n=n&&n.dataMap;return t=n?n[t]||t:t}function x(t,n){var e,i,r,o,e=t.value,i=t.dataMap,r=n[e];if(i)for(o in i)if(r===i[o]){n[e]=r=isNaN(o)?o:+o;break}}function N(t,n){var e,i,e=[];for(i in t)t[i]!==n[i]&&e.push(i);return e}function k(t,n){var e,i,e={};for(i in t)n.hasOwnProperty(i)||(e[i]=t[i]);return e}function _(t,n,e){for(var i,r,i=0;i<n.length;i++)if((r=n[i]).value===e||r.caption===e)return!t.columns[r.value]||(0,T.isFormula)(t.columns[r.value].value)||(0,T.isFormula)(r.value)?(0,v.isViewColumn)(r)?{value:r.value,isGroup:r.isGroup,isCross:r.isCross}:{value:r.value}:r.value;return e===t.uBt()||t.columns[e]?e:t.XOt[e]?{value:e}:u}function D(i,t,n){return!1!==n&&"="===t[0]?function(t,n,e){return(0,T.formatCalcError)(i(t,n,e))}:i}function j(n,t,e,i,r,o){var a,u,s,c,f,l,h,d,a=_(n,t,i);return r?(0,v.isViewColumn)(a)?(r.getValue=e.getFieldByName(a.value),D(function(t,n,e){return e.getValue.getValue(n)},a.value,o)):a.value?(r.getValue=n.XOt[a.value],(0,T.isNullOrUndefined)(r.getValue)&&(r.getValue={getValue:function(t){return n._getValueByField(a.value,t)}}),D(function(t,n,e){return e.getValue.getValue(n)},a.value,o)):(r.getValue=n._dataSource._data[a].data,n.mTe()?(u={},s=n.nv.bind(n),function(t,n,e){var i=u[n];return i===w&&(u[n]=i=s(n)),e.getValue[i]}):function(t,n,e){return e.getValue[n]}):(c=String(a.value),f=String(a),a.value?D(function(t,n){return t._getValueByField(c,n)},c,o):n.mTe()?(l={},h=n.nv.bind(n),d=n._dataSource._data[f].data,function(t,n){var e=l[n];return e===w&&(l[n]=e=h(n)),d[e]}):function(t,n){return t._dataSource._data[f].data[n]})}function O(t,n,e,i){void 0===e&&(e=!0),void 0===i&&(i={}),this.rPt=10,this.lFt=[],this.CLt=[],this.oPt=[],this.ZOt={},this.dme=0,this.rb=!1,this.BLt={};var r=this;r.name=t,Object.defineProperty(r,"tableName",{get:function(){var t;return null==(t=r.gLt)?void 0:t.name}}),r.ILt=(0,T.clone)(n=n||[]).map(function(t){return"string"==typeof t?{value:t}:t}),r.yLt=n.map(function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),t}),r.aPt=e,r.autoSort=!0,r.autoFilter=!1,r.autoGroup=!0,r.UFt=!0,r.yde=!1,l(i),(r.LEt=i).styleRules||r.clearStyleRules()}o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,e,i,r,e=1,i=arguments.length;e<i;e++)for(r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},h=this&&this.__spreadArray||function(t,n,e){if(e||2===arguments.length)for(var i=0,r=n.length,o;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.View=n.rFt=n.ZFt=n.nse=n.tse=n.ose=void 0,T=e("./dist/src/dataSource/utils.js"),a=e("./dist/src/interfaces/interface.js"),v=e("./dist/src/view/view-util.js"),i=e("./dist/src/viewField/fieldManager.js"),b=e("./dist/src/viewField/groupManager.js"),r=e("Common"),y=e("./dist/src/table/windowOverField.js"),u=null,w=void 0,s={pin:f(a.RowColumnStates.pin),primaryKey:f(a.RowColumnStates.primaryKey),readonly:f(a.RowColumnStates.readonly),required:f(a.RowColumnStates.required)},n.ose=p,n.tse=M,n.nse=S,n.ZFt=_,n.rFt=j,O.prototype.XLt=function(){var t,n=this.gLt;return(0,v.isTableDataReady)(n)},O.prototype.Ywt=function(t,n,e){var i=this.gLt;return i&&i.Ywt(t,n,e)},O.prototype.wde=function(t){var n,e=this.gLt.POt;return e.getCalcService().unparse(e,t,0,0)},O.prototype.nMt=function(t,n,e){var n=this.RJ(n),e=this.uPt(e);return this.sPt(t,n,e)},O.prototype.sPt=function(t,n,e){return this.jfe(t,n,(0,T.isNumber)(e)?(0,v.getColumnName)(this.yLt[e]):w)},O.prototype.jfe=function(t,n,e){var i,r,t,i=this.gLt;if(i)return!(r=!1,T.isNullOrEmpty)(e)&&(0,T.isNullOrUndefined)(i.XOt[e])&&(r=!0,i.XOt[e]=this.lLt.getFieldByName(e)),t=i._fe(t,n,e),r&&delete i.XOt[e],t},O.prototype.cPt=function(){var t=this,n=t.gLt;n&&(t.aPt&&t.yLt.length<=0&&(t.yLt=p(n),t.ILt=(0,T.clone)(t.yLt)),t.fPt(),t.lPt())},O.prototype.PRt=function(t){var n=this;t?(n.gLt=t,n.JLt(),n.bLt()?n.XLt()&&(n.RFt(),n.cPt()):n.cPt(),t.$he=n.$he.bind(n),n.XLt()&&(n.hPt(),n.dPt=!0,n.yde||(n.yde=!0,n.Mde(),n.$he())),n.v7()):(n.wpt(),n.gLt=t)},O.prototype.fPt=function(){var t,t,n,t,e,i,r,o,a,u,s,c,f,l,n=null==(t=null==(t=this.gLt._dataSource.options)?void 0:t.schema)?void 0:t.columns;if(n)for(t=this.yLt,i=(e=this.isHierarchy())&&this.gLt._dataSource.options.schema.hierarchy.column,r=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],o=0,a=t;o<a.length;o++)if("string"==typeof(u=a[o]).value&&(s=n[u.value])){for(c=0,f=r;c<f.length;c++)(0,T.isNullOrUndefined)(u[l=f[c]])&&(u[l]=s[l]);u.dataType=s.dataType,"date"===s.dataType&&(0,v.applyDateTimePicker)(u),"formula"===s.dataType&&(u.readonly=!0),!e||u.value!==i&&"rowOrder"!==s.dataType||(u.readonly=!0),s.n7t&&"rowOrder"!==s.dataType&&(u.readonly=!1,delete s.n7t)}},O.prototype.lPt=function(){for(var t,n,e,i,r,t=this.LEt.defaultColumnWidth||60,n,e=0,i=this.yLt;e<i.length;e++)r=i[e],(0,T.isNullOrUndefined)(r.width)&&(r.width=t)},O.prototype.tme=function(){var n=this,t;return n.yLt.some(function(t){return n.Pbe(t)})},O.prototype.vme=function(){var t=this;return!t.mme()&&t.tme()&&t.gLt.fme()},O.prototype.Pbe=function(t){return!(0,v.isViewColumn)(t)&&this.gLt.Pbe(t.value)},O.prototype.Gbe=function(t){return!(0,v.isViewColumn)(t)&&this.gLt.Gbe(t.value)},O.prototype.Xhe=function(t){return!(0,v.isViewColumn)(t)&&this.gLt.Xhe(t.value)},O.prototype.Cde=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,n=this,e=n.gLt,i=e.XOt,r=[];if(t){if(a=[],o=1===Object.keys(e.views).length)for(u=n.getColumnInfos(),s=0;s<u.length;s++)c=u[s],f=n.Gbe(c),a=a.concat(f);for(l in i)if(i.hasOwnProperty(l)&&(h=i[l])instanceof y.WindowOverCalcField&&!1!==h.nde&&!h.options.nme&&(r.push(h.options),h.options.nme=!0,o))for(d=h.options.windowOverFormula.slice(1),v=0;v<a.length;v++)if(-1<(m=a[v]).indexOf(d)){h.options.Sde=!0;break}if(o){for(g=[],p=[],v=0;v<r.length;v++)delete(b=r[v]).nme,(b.Sde?(delete b.Sde,g):p).push(b);return[g,p]}}else for(u=n.getColumnInfos(),s=0;s<u.length;s++)if(c=u[s],0<(w=n.Gbe(c)).length)for(v=0;v<w.length;v++)!1!==(h=i[d=w[v]]).nde&&r.push(h.options);return[r,[]]},O.prototype.Tde=function(t){for(var n,e,i,t,r,e,o,a,u,s,c,f,n=this,e=t[0],i=t[1],t=n.Ade(e),r=t.windowOverInfoMap,e=t.windowOverInfos,o=[],a=0;a<i.length;a++)u=i[a],(0,T.isNullOrUndefined)(r[u.partitionKey])||(0,T.isNullOrUndefined)(r[u.partitionKey].orderMap[u.orderKey])?o.push(u):(s=r[u.partitionKey].orderMap[u.orderKey],c=u.frameKey+"__"+u.windowFormula,(0,T.isNullOrUndefined)(s.functionMap[c])&&(s.functionMap[c]=!0,s.orderFunctions.functions.push({orders:u.orders,windowOverFormula:u.windowOverFormula,windowFormula:u.windowFormula,windowFrame:u.windowFrame})));return[f=n.Ade(o).windowOverInfos,e]},O.prototype.Ade=function(t){for(var n,e,i,r,o,a,u,s,s,c,f,f,n,l,h,d,v,e={},i=[],a=0;a<t.length;a++)r=(u=t[a]).partitionKey,o=u.orderKey,(0,T.isNullOrUndefined)(e[u.partitionKey])&&(s={partitions:u.partitions,orderedFunctions:[]},e[u.partitionKey]={index:i.length,orderMap:{},windowOverInfo:s},i.push(s)),c=(s=e[u.partitionKey]).orderMap,(0,T.isNullOrUndefined)(c[u.orderKey])&&(f={orders:u.orders,functions:[]},c[u.orderKey]={index:s.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:f},s.windowOverInfo.orderedFunctions.push(f)),f=u.frameKey+"__"+u.windowFormula,n=c[u.orderKey].functionMap[f],l=u.windowFrame&&u.windowFrame.exclude,((0,T.isNullOrUndefined)(n)||(0,T.isNullOrUndefined)(n[l]))&&(c[u.orderKey].functionMap[f]=((n={})[l]=!0,n),c[u.orderKey].orderFunctions.functions.push({orders:c[u.orderKey].orderFunctions.orders,windowOverFormula:u.windowOverFormula,windowFormula:u.windowFormula,windowFrame:u.windowFrame}));return h=function(t){var n,t,t,e,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[o];1<n.length&&(e=n[t=t.index],n.splice(t,1),n.push(e))},1<i.length?(v=i[a=(d=e[r]).index],i.splice(a,1),i.push(v),h(d)):1===i.length&&h(e[r]),{windowOverInfoMap:e,windowOverInfos:i}},O.prototype.Mde=function(){for(var t,n,e,i,t=this,n=t.getColumnInfos(),e=0;e<n.length;e++)i=n[e],t.Xhe(i)},O.prototype.$he=function(t){var n,e,n,i,n,r,o,a,u,s,c,f,e=this;if(0===e.dme){for(t&&null!=(n=e.BFt)&&n.dl(),i=(n=e.Tde(e.Cde(t)))[0],n=n[1],r=0,o=i;r<o.length;r++)u=(a=o[r]).partitions,s=a.orderedFunctions,e.windowOver(u,s,!0);for(c=0,f=n;c<f.length;c++)u=(a=f[c]).partitions,s=a.orderedFunctions,e.windowOver(u,s,t);return!0}},O.prototype.gme=function(){this.dme++},O.prototype.pme=function(){0<this.dme&&this.dme--,this.dme<=0&&(this.dme=0,this.$he(!0),this.fge(),this.gLt.bCe())},O.prototype.mme=function(){return 0!==this.dme},O.prototype.gFt=function(t){this.XFt()||(this.iRt=this.qFt(t))},O.prototype.qFt=function(t){var n,e,i,t,r,o,n=[],e=t||this.length(),i=this.lFt,t=i.length;for(0<t&&(n=i.slice(0)),r=t,o=0;o<e;o++)-1===i.indexOf(o)&&(n[r]=o,r++);return n},O.prototype.jRt=function(t){return w},O.prototype.RFt=function(){var t=this,n=t.gLt;return t.iRt||t.gFt(),t.lLt=new i.FieldManager(t.LEt,n),t.ELt(),t.yLt=t.lLt.prepareFields(t.yLt),t.YBt(),t.lLt},O.prototype.getLookup=function(t){return(0,i.getLookupBy)(this.gLt,t)},O.prototype.isLookupField=function(t){return(0,i.isLookupField)(this.gLt,t)},O.prototype.isLookupListField=function(t){return(0,i.isLookupListField)(this.gLt,t)},O.prototype.isLookupRelationField=function(t){return(0,i.isLookupRelationField)(this.gLt,t)},O.prototype.RJ=function(t){return this.iRt||this.gFt(),this.iRt[t]},O.prototype.FLt=function(t){return this.iRt||this.gFt(),this.iRt.indexOf(t)},O.prototype.length=function(){return this.gLt.length()},O.prototype.visibleLength=function(){return this.iRt||this.gFt(),this.iRt.length},O.prototype.getDirtyIndexes=function(){var n=this;return n.gLt.getDirtyIndexes().map(function(t){return n.FLt(t)})},O.prototype.isInserted=function(t){var n=this,t=n.RJ(t);return n.vPt(t)},O.prototype.vPt=function(t){return this.gLt.isInserted(t)},O.prototype.isUpdated=function(t){var n,t,t,n=this,t=n.RJ(t);return n.rb=!0,t=n.gLt.isUpdated(t),n.rb=!1,t},O.prototype.getErrorInfo=function(t){var n,t=this.RJ(t);return this.gLt.getErrorInfo(t)},O.prototype.kbe=function(){return this.gLt.kbe()},O.prototype.insertItem=function(t,n,e,i){var r,o,r=this;return r.isHierarchy()?0===(o=r.visibleLength())?void this.addHierarchyFirstItem(n,e,i):void(t<o?r.addHierarchyItemBefore(t,n,e,i):r.addHierarchyItemAfter(o-1,n,e,i)):r.mPt(t,n,e,i)},O.prototype.insertItems=function(t,n,e){var u,s,n,i,r,c,f,e,u=this,s=this,n=s.GLt(n,e),i=n.success,r=n.fail,c=0,f=0,e=t.map(function(a){return function(t,n){var e,i,r,o,e=a.row,i=a.isAfter,r=a.data;c<e&&(c=e),f++,0===(o=s.visibleLength())?u.addHierarchyFirstItem(r,t,n):i?s.addHierarchyItemAfter(e,r,t,n):s.addHierarchyItemBefore(e,r,t,n)}});return(0,T.promiseSerialExecute)(e).then(function(t){t.row=c,t.addedCount=f,i&&i(t)}).catch(function(t){r&&r(t)})},O.prototype.mPt=function(n,t,e,i){var r,e,o,i,e,a,u,t,s,c,f,l,a,h,d,r=this,e=r.GLt(e,i),o=e.success,i=e.fail,e=r.visibleLength();return n=e<n?e:n,a=r.RJ(n),u=r.gPt(t),r.ULt(u),(0,T.isNullOrUndefined)(a)&&(r.Dit()?(a=r.length(),r.HLt(u,a)):a=n),t=r.gLt.uBt(),s=!(0,T.isNullOrUndefined)(t),c=r.isHierarchy(),f=a,l=n<e,s&&!c&&(h=a=void 0,d=!1,l?(a=r.RJ(n-1),h=f):(h=r.RJ(n-1),d=!0),u[t]=r.gLt.d7t(a,h,d)),(s||c)&&(f=r.Dit()?r.length():e),r.gLt.insertItem(f,u,function(t){r.zLt(f,u,l,n),o&&o(t)},i)},O.prototype.zLt=function(t,n,e,i){var r,o,a,u,s,a,s,r=this,o=!(r.vme()&&!r.Dit());e?(a=r.length()-1,r.cRt(a,n),u=r.autoFilter,(s=!(0,T.isNullOrUndefined)(r.NLt))&&(r.autoFilter=!0),o&&((0,T.isNumber)(i)&&!r.tPt()?r.iRt.splice(i,0,a):r.iRt.push(a)),r.tFt(w,!s),s&&(r.autoFilter=u)):(r.cRt(t,n),a=r.length(),s=!r.autoFilter&&!!r.iRt,(s=(0,T.isNullOrUndefined)(e)&&(0,T.isNullOrUndefined)(i)&&r.isHierarchy()?!1:s)&&o&&r.iRt.push(a-1),r.tFt(a,s))},O.prototype.gPt=function(t){var n,e,i,r,o,a,u,a,n={};if(this.isHierarchy())for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);for(r=0,o=i=this.yLt;r<o.length;r++)u=t[e=(a=o[r]).value instanceof Function?a.value.name:a.value],(0,T.isUndefined)(u)||("string"==typeof(a=a.value)?n[a]=u:a(n,u));return n},O.prototype.Dwe=function(t,n,e,i){var r=this;r.ULt(t),r.iFt(t,n,e,i)},O.prototype.jwe=function(a,u,t,r){var n,s,o,c,f,l,h,d,v,e,i,m,g,p,b,w,y,M,C,S,n=this,s=n.gLt,o=n.lLt,c=Object.keys(a),f=this.yLt;if(n.vPt(u)&&c.some(function(n){return f.some(function(t){return t.isCross&&t.value===n})}))return!1;for(l={},h=[],d=function(t,n,e,i){var r,o,r,r=s.qRt(n);r.name!==s.name?(o=l[r.name],(0,T.isNullOrUndefined)(o)&&(l[r.name]=o={}),r=s.swe(i?i.getRelationField(u):n,u),(0,T.isNullOrUndefined)(o[r])&&(o[r]={}),o[r][e]=t):a[n]=t},v=function(t,n,e){var i;h.push({data:((i={})[t.valueField]=a[n],i[t.dimRelationKey]=t.getDimValue(),i),valueRelation:t.valueRelation,onSucceeded:e})},e=function(t){var n,e,i,n,n=f[t],e=n.value;n.isCross&&-1<c.indexOf(e)&&(i=o.getFieldByPosition(t),n=s.KRt(i.valueRelation,u),i.isOneToMany?(n=n&&(0,T.isNumber)(i.getValueIndex(u)))?d(a[e],i.valueRelation,i.valueField,i):v(i,e,function(t){o.setCrossFieldInsertedIndex(i,u,t.index)}):n?(d(a[e],i.valueRelation,i.valueField),d(i.getDimValue(),i.dimRelationPath,i.dimRelationKey)):v(i,e),r[e]=a[e])},i=0;i<f.length;i++)e(i);if(0<(m=Object.keys(l)).length)for(g=0;g<m.length;g++)for(y in p=m[g],b=this.gLt.QOt.tables[p],w=l[p])w.hasOwnProperty(y)&&b.updateItem(Number(y),w[y]);if(0<h.length)for(M=0,C=h;M<C.length;M++)S=C[M],s.JRt(S.valueRelation,u,S.data,S.onSucceeded);return Object.keys(a).length===Object.keys(r).length?(n.VLt(a,t,u),n.YLt(a,t,u),!0):void 0},O.prototype.VLt=function(t,n,e){var i=this;i.Owe(e,t,n),i.kwe(t,n,e)},O.prototype.kwe=function(t,n,e){var i,r,o,i=this;for(r in t)(0,T.isNotDeepEqual)(t[r],n[r])&&(o=n[r],i.Dwe(t,o,r,e))},O.prototype.YLt=function(t,n,e){var i,r,o,a,i=this,r=[];for(o in t)(0,T.isNotDeepEqual)(t[o],n[o])&&(a=n[o],r.push(o),i.hRt(e,o,a,t[o]));i.tFt(w,!0,r,w)},O.prototype.updateItem=function(t,n,e,i,r){var o,r,a,e,u,i,s,c,e,o,o=r&&r.hasAddNewRowData,r=r&&r.currentModelIndex,a=this,e=a.GLt(e,i),u=e.success,i=e.fail,s=o?r:a.RJ(t),c=this.getRowData(s,!0),e={},o=a.jwe(n,s,c,e);if(!(0,T.isBoolean)(o))return a.VLt(n,c,s),a.gLt.updateItem(s,k(n,e),function(t){a.YLt(n,c,s),u(t)},i);o?u({index:s,data:n,originalData:c,changingFields:N(n,c)}):i()},O.prototype.Owe=function(t,n,e){var i,r,o,a,u,s,c,f,l;for(e=e||this.getRowData(t,!0),i=(0,T.clone)(e,!0),r=Object.keys(n),a=0,u=o=this.yLt;a<u.length;a++)(c=(s=u[a]).value)instanceof Function&&!(0,T.isUndefined)(n[c.name])&&-1<r.indexOf(c.name)&&c(i,n[c.name]);for(f in i)i.hasOwnProperty(f)&&(l=i[f],(0,T.isNotDeepEqual)(l,e[f]))&&(n[f]=l)},O.prototype._we=function(t,i){var n,r,e,o,n=this,r=this.yLt,e=function(n){var t,e;i.hasOwnProperty(n)&&(t=i[n],(0,T.isUndefined)(t)||x(e=r.find(function(t){return t.value===n}),i))};for(o in i)e(o);return n.Owe(t,i),i},O.prototype.resetItem=function(t,n,e){var i=this,n=i.GLt(n,e),r=n.success,e=n.fail,o=i.RJ(t),a=this.getRowData(o,!0),u=i.bPt(o);if(!(0,T.isNullOrUndefined)(t)&&!(0,T.isNullOrUndefined)(o))return i.kwe(u,a,o),i.gLt.resetItem(o,function(t){i.ZLt(o,a,u),r(t)},e);e()},O.prototype.ZLt=function(t,n,e){var i=this;i.vLt(t),i.pRt(t,n,e),i.tFt(w,!0,w,w)},O.prototype.saveItem=function(t,n,e){var i=this,n=i.GLt(n,e),r=n.success,e=n.fail,n=i.RJ(t);return i.gLt.saveItem(n,function(t){r(t)},e)},O.prototype.getRowData=function(t,n,e,i,r,o){var a,n,a=this,n=n?t:a.RJ(t);return a.nFt(n,e,i,r,o)},O.prototype._ve=function(t,n){var e=this;return C(e.gLt,e.RJ(t),n,e.lLt)},O.prototype.yPt=function(t){return this.isHierarchy()&&this.wPt(t)},O.prototype.wPt=function(t,n){var e=this,i=e.gLt.uBt(),r,i=e.isHierarchy()||!(0,T.isNullOrUndefined)(i),o=(0,T.isNullOrUndefined)(e.MFt),t=!(0<e.lFt.length)||e.lFt.length<t&&(!(0,T.isNumber)(n)||e.lFt.length<n);return i&&o&&t},O.prototype.MPt=function(){var t=this;return!!(0,T.isNullOrUndefined)(t.kLt)||!!t.kLt[0].ascending},O.prototype.CPt=function(t,n){var e,i,r,o,e=this,r=e.getHierarchyNode(t).parent;if(n){for(o=t+1;o<e.visibleLength();o++)if(e.getHierarchyNode(o).parent===r){i=o;break}}else for(o=t-1;0<=o;o--)if(e.getHierarchyNode(o).parent===r){i=o;break}return i},O.prototype.m7t=function(t,n){var e,i,r,o,o,a,u,s,c,f,l,i,e=this;if(t!==n&&e.wPt(t,n)){if(o=(r=t<n)?n+1:n-1,(i=e.isHierarchy())&&1===Math.abs(t-n)&&(n=e.CPt(t,r)),o=e.gLt.m7t(r,e.RJ(t),e.RJ(n),e.RJ(o))){if(a=e.iRt,s=1,c=[u=e.RJ(t)],i)for(c=[],l=(f=t)+(s=e.gLt.V7t(u));f<l;f++)c.push(e.RJ(f));r?(i=e.gLt.V7t(e.RJ(n)),a.splice.apply(a,h([n+i,0],c,!1)),a.splice(t,s)):(a.splice(t,s),a.splice.apply(a,h([n,0],c,!1))),e.wFt=w}return o}},O.prototype.moveUp=function(t){var n,e=1;0<t&&this.m7t(t,t-1)},O.prototype.moveDown=function(t){var n=this,e=1;t<n.visibleLength()-1&&n.m7t(t,t+1)},O.prototype.SPt=function(){for(var t,n,e,i,r,o,a,t=this,n=t.gLt._dataSource.options.schema.hierarchy.outlineColumn,e=t.yLt,i=-1,r=-1,o=0;o<e.length;o++){if(a=e[o],!(0,T.isNullOrEmpty)(a.outlineColumn)){i=o;break}-1!==r||a.value!==n&&((0,T.isNullOrUndefined)(n)||a.value!==n.value)||(r=o)}return-1!==i?{index:i,options:e[i].outlineColumn}:{index:r,options:n}},O.prototype.getHierarchyColumnOptions=function(){return this.SPt().options},O.prototype.getHierarchyColumnIndex=function(){return this.SPt().index},O.prototype.hasHierarchyColumn=function(t){var n=this,e=n.isHierarchy(),n=e&&n.getHierarchyColumnIndex();return(0,T.isNumber)(t)?e&&n===t:!(!e||-1===n)},O.prototype.isHierarchy=function(){return this.gLt.CEt()},O.prototype.getHierarchyNode=function(t,n){var e,n,e=this;if(e.isHierarchy())return n=n?t:e.RJ(t),e.gLt.SEt(n)},O.prototype.getHierarchyRootNode=function(){var t=this;if(t.isHierarchy())return t.gLt.f7t()},O.prototype.promoteHierarchyLevel=function(t){var n;this.isHierarchy()&&this.gLt.M7t(this.RJ(t))},O.prototype.demoteHierarchyLevel=function(t,n){var e=this;e.isHierarchy()&&e.gLt.S7t(e.RJ(t),n)},O.prototype.hasRowOrder=function(){var t;return!(0,T.isNullOrUndefined)(this.gLt.uBt())},O.prototype.hasHierarchyRowOrder=function(){return this.gLt.qX()},O.prototype.addHierarchyItemBefore=function(t,n,e,i){var r,o,r=this;r.yPt(t)&&(o=r.gLt.O7t(r.RJ(t),n),r.APt(n,o),r.mPt(t,n,e,i))},O.prototype.addHierarchyItemAfter=function(t,n,e,i){var r,o,a,r=this;if(r.yPt(t))return o=r.gLt.V7t(r.RJ(t)),a=r.gLt.L7t(r.RJ(t),n),r.APt(n,a),r.mPt(t+o,n,e,i),o},O.prototype.addHierarchyItemAbove=function(t,n,e,i){var r,o,r=this;r.yPt(t)&&(o=r.gLt.F7t(r.RJ(t),n),r.APt(n,o),r.mPt(t,n,e,i))},O.prototype.addHierarchyItemBelow=function(t,n,e,i){var r,o,a,r=this;if(r.yPt(t))return o=r.gLt.V7t(r.RJ(t)),a=r.gLt.G7t(r.RJ(t),n),r.APt(n,a),r.mPt(t+o,n,e,i),o},O.prototype.addHierarchyFirstItem=function(t,n,e){var i,r,i=this,r=i.gLt.Xme(t);i.APt(t,r),i.mPt(0,t,n,e)},O.prototype.APt=function(t,n){var e,i,r,e,i=this.gLt.H7t(n);if(!(0,T.isNullOrUndefined)(i))for(r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},O.prototype.h7t=function(t,n){if(this.isHierarchy())return this.gLt.h7t(t,n)},O.prototype.fetch=function(e){var i,n,t,t,i=this,n=i.gLt.QOt.tables,t=(0,T.keys)(n);if(0<t.length)return t=t.map(function(t){var t=n[t];return t&&t.fetch(e)}),Promise.all(t).then(function(t){i.yde||i.JLt(),i.pLt()&&(i.RFt(),i.cPt()),!e&&i.yde||(i.yde||i.Mde(),i.$he()),i.dPt||i.hPt();var n=i;return(n.dp||n.vp)&&(n.dp&&n.dp(),n.vp)&&n.vp(),i.yde=!0,t})},O.prototype.iM=function(t){var n=this;n.Wce(),n.cFt(),t&&n.gFt(),n.hLt(),n.tFt(w,!0)},O.prototype.hPt=function(){for(var t,n,e,i,r,o,t,n=0,e=this.yLt;n<e.length;n++)(i=e[n]).cross||(r=i.lookup,(0,T.isArray)(r)?"string"==typeof i.value&&-1===i.value.indexOf(".")&&0<(r=(0,T.getUniqueArray)(r)).length&&((o=(o=i.style)||(i.style={})).cellType||(o.cellType={type:"combobox",items:r})):(0,T.isString)(r)&&r?this.IPt(i,r):(0,T.isObject)(r)&&this.IPt(i,r.name,r.columns))},O.prototype.IPt=function(t,n,e){var i,t,r,i,o,i,o,n,i,i=t.style,t=(t=(i=i||(t.style={})).cellButtons)||(i.cellButtons=[]),r=(r=i.dropDowns)||(i.dropDowns=[]),i=(0,v.array_find)(t,function(t){return"openMultiColumn"===t.command}),o=(0,v.array_find)(r,function(t){return"multiColumn"===t.type});i||o||(o=(i=this.xPt(n)).table,n=i.field,o&&n&&o!==this.gLt&&(i=o.columns)&&(t.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),r.push({type:"multiColumn",option:{dataSource:o.views[a.DEFAULT_VIEW_NAME]||o.addView(a.DEFAULT_VIEW_NAME),bindingInfos:this.NPt(i,e),valuePath:n}})))},O.prototype.xPt=function(t){for(var n,e,i,r,o,a,i,r=0,o=this.gLt.QOt.relationships;r<o.length;r++)if((a=o[r]).sourceRelationshipName===t){n=a.targetTable,e=a.targetFieldName;break}return{table:n,field:e}},O.prototype.NPt=function(n,t){return t?t.map(function(t){return(0,T.isString)(t)?{name:t,width:"*"}:{name:t.value,width:(0,T.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}}):(0,T.keys)(n).map(function(t){var t=n[t];return{name:t.value,width:(0,T.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}})},O.prototype.oV=function(){for(var t,n,e,i,t=this,n=t.gLt.length(),e=[],i=0;i<n;i++)e.push(t.nFt(i));return e},O.prototype.ULt=function(t){for(var n,e,i,r,o,r,n,e=0,i=this.yLt;e<i.length;e++)"string"==typeof(o=(r=i[e]).value)&&(x(r,t),t.hasOwnProperty(o))&&(r=this.gLt.bEt(o))&&r.relatedTable&&r.setValue&&r.setValue(t)},O.prototype.kPt=function(t,n){var e,i,r,e=this.lFt;if(e&&0<e.length){for(i=0;i<n;i++)-1<(r=e.indexOf(t+i))&&e.splice(r,1);for(i=0;i<e.length;i++)e[i]>t&&(e[i]-=n)}},O.prototype.removeRowData=function(n,e,t,i){var r,t,o,i,t,a,r=this,t=r.GLt(t,i),o=t.success,i=t.fail,t=r.gLt,a=r.RJ(n);(0,T.isNullOrUndefined)(n)||(0,T.isNullOrUndefined)(a)||(0,T.isNullOrUndefined)(e)?i():t.remove(a,e,function(t){r.WLt(a,t.removedCount||e,n),o(t)},i)},O.prototype.removeItems=function(t,n,e){var a,u,n,i,r,s,c,f,e,a=this,u=this,n=u.GLt(n,e),i=n.success,r=n.fail,s=u.gLt,c=[],f=0,e=t.map(function(o){return function(e,t){var n,i,r,n=1;a.isHierarchy()&&(n+=(i=a.getHierarchyNode(o)).getChildrenCount()),r=u.RJ(o),s.remove(r,n,function(t){var n=t.removedCount||1;u.WLt(r,t.removedCount||1,o),c.push({index:r,count:n}),f+=n,u.rebuildFieldGetter(),e()},t)}});return(0,T.promiseSerialExecute)(e).then(function(t){t.removedItems=c,t.totalRemovedCount=f,i&&i(t)}).catch(function(t){r&&r(t)})},O.prototype.WLt=function(t,n,e){var r,o,i,a,u,r=this;if(r.kPt(t,n),(0,T.isNumber)(e)||(e=r.FLt(t)),!r.mFt()&&(!r.vme()||r.Dit())){for(o=r.iRt.slice(e,e+n),i=function(t,n){var e,i,e=r.iRt[t],i=o.reduce(function(t,n){return n<e?t+1:t},0);0<i&&(r.iRt[t]-=i)},a=0,u=r.iRt.length;a<u;a++)i(a,u);r.iRt.splice(e,n)}r.dLt(t,n),r.MRt(t,n),r.tFt(void 0,!0)},O.prototype.getChanges=function(){for(var t,n,e,i,r,t,n=this.gLt.getChanges(),e=0,i=n;e<i.length;e++)(r=i[e]).index=this.FLt(r.index);return n},O.prototype.isDataLengthChanged=function(){return this.gLt.isDataLengthChanged()},O.prototype.submitChanges=function(i){var r=this,t=r.GLt(),n=t.success,t=t.fail,e;return r.gLt.submitChanges(function(t,n,e){var t;i&&(t=r.FLt(t),i(t,n,e))}).then(function(t){return r.QLt(),n(),t}).catch(t)},O.prototype.QLt=function(){},O.prototype.cancelChanges=function(){var t,n,e,n,i,t=this,n=t.GLt(),e=n.success,n=n.fail,i=t.isDataLengthChanged();t.gLt.cancelChanges(function(){t.KLt(i),e()},n)},O.prototype.KLt=function(t){this.iM(t)},O.prototype.DPt=function(t,n){var e,i,r,t,o,e=this,i=e.TLt(t,n),r=e.ILt.map(function(t,n){return{index:n,option:t}}),t=e._Pt(t,n);if(r=t.map(function(t){return r[t]}),e.ILt=r.map(function(t){return t.option}),i)return i;o=[],r.forEach(function(t,n){(0,T.isNullOrUndefined)(t.option.cross)||t.index===n||o.push({oldIndex:t.index,newIndex:n})}),e.wLt(o)},O.prototype.EPt=function(){var e,t,i,e=this,t=e.CLt;return t&&0<t.length?(i=[],t.forEach(function(t,n){i.push(e.yLt[t].value)}),i):[]},O.prototype.jPt=function(t){var n,e=this.yLt;return(0,T.isNullOrUndefined)(t)?[]:t.map(function(n){return(0,T.findIndex)(e,function(t){return t.value===n})})},O.prototype.OPt=function(t,n,e){var i,r,t,n,o,a,u,s,c,f,f,l,h,i=this;if(i.yLt.forEach(function(t,n){t.RPt=n}),r=i.oPt,t=(0,v.ePt)(t,n,e,i.yLt,i.oPt,i.CLt,i.ILt),n=i.CLt.map(function(t){return i.yLt[t]}),i.yLt=t.map(function(t){return i.yLt[t]}),n&&n.length){for(o=[],a=i.yLt.length,u=-1,s=0,c=n;s<c.length;s++)f=c[s],f=i.yLt.indexOf(f),u=Math.max(f,u),o.push(f);for(l=0;l<a;l++)-1===o.indexOf(l)&&o.push(l);i.oPt=o,i.CLt=o.slice(0,n.length)}return h=i.yLt.reduce(function(t,n,e){return n.RPt!==e&&t.push({oldIndex:n.RPt,newIndex:e}),delete n.RPt,t},[]),i.yLt.forEach(function(t){for(var n,e,i,r,i,n=0,e=h;n<e.length;n++)if(r=(i=e[n]).oldIndex,i=i.newIndex,t._Ft===r){t._Ft=i;break}}),i.lLt&&i.lLt.moveFieldsByIndexes(h),h.map(function(t){return t.oldIndex=i.BPt(t.oldIndex,r),t.newIndex=i.BPt(t.newIndex),t})},O.prototype.SLt=function(t){var n,e,n,i,n=this,e=n.yLt,n=n.ILt,i=e[t];return i.isCross?i.RBt:(0,T.findIndex)(n,function(t){return t.value===i.value})},O.prototype.ALt=function(t){var n=this,e=n.CLt,i=n.ILt;return t=t||e.map(function(t){return n.SLt(t)}),(0,v.generatePinnedColumnIndexMap)(t,i.length)},O.prototype._Pt=function(t,n){var e,i,r,o,i,i,a;if(t!==n)return i=(e=this).CLt,r=e.ILt.map(function(t,n){return{index:n}}),o=i.map(function(t){return e.SLt(t)}),0<(i=(0,v.generatePinnedColumnIndexMap)(o,r.length)).length&&(t=i[t],n=i[n]),i=o.map(function(t){var t=r[t];return t.LPt=!0,t}),(0,T.swapArrayItems)(r,t,n,1),a=r.filter(function(t){return!t.LPt}),i.forEach(function(t,n){a.splice(o[n],0,t)}),a.map(function(t){return t.index})},O.prototype.getColumnInfos=function(e,i,r){for(var o,a,u,s,t,c,n,o=[],a=this.yLt,u=this.oPt,s=this.gLt,t=function(t){var t,n,t,t=!(0<u.length)||r||(0,T.isNullOrUndefined)(u[t])?t:u[t],n=a[t];if(s.jOt(n.value)&&(n.isPrimaryKey=!0),!e||!n.isGroup){if(i&&n.isCross&&(t=n.RBt,(n=c.ILt[t]).RBt=t,o.some(function(t){return t===n})))return"continue";o.push(n)}},c=this,n=0;n<a.length;n++)t(n);return o},O.prototype.ife=function(t){var n=this;return(0,v.getColumnName)((0,T.isNumber)(t)?n.getColumn(t):t)},O.prototype.FPt=function(t){var t=this.gLt.qRt(t);return!(0,T.isNullOrUndefined)(t)&&t!==this.gLt},O.prototype.setColumnInfos=function(t,n){for(var e,i,r,o,a,e={},i=0;i<this.yLt.length;i++)"string"==typeof(r=this.yLt[i]).value&&r.value===r.name&&(e[r.value]=!0);for(o=0;o<t.length;o++)"string"!=typeof(a=t[o]).value||e[a.value]||this.Xhe(a);this.yde&&(this.yLt=t,this.$he()),this.yLt=t,this.PPt(),this.Gfe(),n&&this.cPt()},O.prototype.Gfe=function(){for(var t,n,e,i,r,o,a,t=this.ILt,n=0;n<t.length;n++)for(e=t[n],i=this.yLt,r=0;r<i.length;r++)if(o=i[r],e.value===o.value){for(a in o)o.hasOwnProperty(a)&&"_"!==a.charAt(0)&&(e[a]=o[a]);break}},O.prototype.PPt=function(){for(var t,n,e,i,r,o,a,u,t=this.ILt,n=t.length-1;0<=n;n--)"string"==typeof(e=t[n].value)&&"="===e[0]&&t.splice(n,1);for(i=this.yLt,r=n=0;n<i.length;)o=i[n],a=t[r],o.isGroup||o.isCross?n++:a&&a.cross?r++:(u=o.value)===(e=a&&a.value)?(n++,r++):"string"!=typeof u||"="!==u[0]&&"formula"!==o.dataType?n++:(u!==o.name&&(o.name=u),t.splice(r,0,o),n++,r++)},O.prototype.GPt=function(t){var n;return!!this.gLt.ZRt(t)},O.prototype.Xfe=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,e=this,i=e.NLt;if(e.mFt())e.Wce(),e.filter();else{for(a in r=e.iRt,o=e.Jce)if(o.hasOwnProperty(a)){for(s=(u=o[a]).options,c=u.count,delete u.options,delete u.count,f=0;f<t.length;f++)l=t[f],(0,T.isNullOrUndefined)(u[l])||(delete u[l],c--);if(0<n.length)for(e.iRt=n,e.filter(s),h=0;h<e.iRt.length;h++)u[d=e.iRt[h]]=!0,c++;u.options=s,u.count=c}e.Jce=o,e.iRt=r}e.NLt=i},O.prototype.togglePinnedRows=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b;if((0,T.isNullOrUndefined)(t)||this.hasHierarchyColumn())return this.lFt&&this.lFt.length;for(n=this.lFt,e=this.iRt,i=t.length,r=[],o=[],a=[],u=n.length,s=0;s<i;s++)-1<(c=e[t[s]])&&(-1<(f=n.indexOf(c))?(o.push(f),a):r).push(c);if(n.length-(h=o.length)+(l=r.length)>this.rPt)return-1;if(0<h)for(o.sort(),s=h-1;0<=s;s--)n.splice(o[s],1);for(s=0;s<l;s++)n.push(r[s]);if(0<h||0<l){for(d=[],v=e.length,0<(m=n.length)&&(d=n.slice(0)),c=m,s=0;s<v;s++)-1===n.indexOf(e[s])&&(d[c]=e[s],c++);if(!this.mFt()&&!this.tPt())for(s=0;s<h;s++)g=e[o[s]],p=d.indexOf(g),b=this.UPt(g,u,d),d.splice(p,1),d.splice(b=p<b?b-1:b,0,g),m<u&&u--;this.iRt=d,this.Xfe(r,a),this.vFt(),this.bde(w,0<h),this.NFt()}return n.length},O.prototype.togglePinnedColumns=function(t){var n,e,i,r,o,a,u,s,c,f,l,h,n=this;if((0,T.isNullOrUndefined)(t))return this.CLt&&this.CLt.length;for(e=this.oPt,i=0<e.length,t=t.filter(function(t){var t=i?e[t]:t;return!n.yLt[t].isCross}),r=this.CLt,o=t.length,a=[],u=[],s=0;s<o;s++)-1<(c=i?e[t[s]]:t[s])&&(-1<(f=r.indexOf(c))?u.push(f):a.push(c));if(r.length-(h=u.length)+(l=a.length)>this.rPt)return-1;if(0<h)for(u.sort(),s=h-1;0<=s;s--)r.splice(u[s],1);for(s=0;s<l;s++)r.push(a[s]);return(0<l||0<h)&&(this.oPt=(0,v.generatePinnedColumnIndexMap)(r,this.yLt.length)),r.length},O.prototype.uPt=function(t){var n,e=this.oPt;return e&&0<e.length?e[t]:t},O.prototype.BPt=function(t,n){var e;return(n=n||this.oPt)&&0<n.length?n.indexOf(+t):+t},O.prototype.getRowDataAsync=function(e){var i=this;return i.fetch().then(function(t){var n=i.RJ(e);return i.nFt(n)})},O.prototype.UPt=function(t,n,e){for(var i=n;i<e.length;i++)if(e[i]>t)return i;return e.length},O.prototype.nFt=function(t,n,e,i,r){var o=this;return S(o.gLt,o.yLt,o.BFt,o.lLt,o.MFt,t,n,e,i,r)},O.prototype.rebuildFieldGetter=function(){var e,t,e=this.gLt;e&&(t=this.yLt).forEach(function(t,n){var t=t.value;"string"==typeof t&&e.rRt(t)})},O.prototype.ufe=function(t,n){return A(this.gLt,t,n)},O.prototype.bPt=function(a){var u,t,s,c,f,l,n,e,i,u=this,t=u.yLt,s={},c=[],f=!!u.MFt,l=u.gLt;if(t.forEach(function(t,n){var e,n,i,r,o,e=t.value;t.isCross?s[t.value]=u.lLt.getFieldByPosition(n).getOriginalValue(a):e&&!t.isGroup&&("string"==typeof e?(n=0<=e.indexOf("."),i="="===e[0],r=l.XOt&&(0,T.isNullOrUndefined)(l.XOt[e]),(!f||n||i||r)&&(s[e]=I(i?l._getValueByField(e,a):l.XRt(e,a),t))):"function"==typeof e&&c.push({name:e.name,caption:t.caption,value:e}))}),0<c.length&&(n=l.iBt(a),c.forEach(function(t){s[t.name]=t.value(n)})),f)for(i in e=this.lLt.CBt(a))e.hasOwnProperty(i)&&(s[i]=e[i]);return s},O.prototype.addColumn=function(t){"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),this.yLt.push(t),this.Xhe(t)&&this.yde&&this.$he()},O.prototype.getColumn=function(t){var n=this;return(0,T.isNullOrUndefined)(t)?n.getColumnInfos():t<0||t>=n.yLt.length?void 0:n.Dve(n.uPt(t))},O.prototype.Dve=function(t){var t;if(t!==w)return t=this.yLt[t],this.gLt.jOt(t.value)&&(t.isPrimaryKey=!0),t},O.prototype.removeColumn=function(t){for(var n,e,i,n=this.yLt,e=0;e<n.length;e++)if((i=n[e]).value===t){n.splice(e,1);break}},O.prototype.tFt=function(t,n,e,i){n||this.gFt(t);var n=this.mFt();n&&this.dFt(),this.vFt(),this.nPt(n?w:e),this.wFt=w,this.Efe=w},O.prototype.excludeInsertedPinnedRows=function(){for(var t,n,e,i,t=this,n=t.lFt,e=[],i=0;i<n.length;i++)t.isInserted(i)||e.push(n[i]);return e},O.prototype.toJSON=function(){var e,t,i,n,r,e=this,t={};if(e._Lt&&(t={sortBefore:(0,v.removeExtraInfos)(e.DLt),sortAfter:(0,v.removeExtraInfos)(e._Lt)}),0===(i=e.ILt).length)0===e.yLt.length&&e.cPt(),i=e.ILt=e.yLt;else for(n=function(n){var t,t,t,t=i[n].cross;(0,T.isNullOrUndefined)(t)&&(t=e.yLt.filter(function(t){return t.value===i[n].value})[0])&&(i[n]=t),(t=i[n].validator)&&"date"===t.type&&(d(t.value1)&&(t.value1=m(t.value1)),d(t.value2))&&(t.value2=m(t.value2))},r=0;r<i.length;r++)n(r);return o(o({},t),{name:e.name,options:e.LEt,columns:e.ILt,indexMap:e.iRt,columnIndexMap:e.oPt,autoSort:e.autoSort,sortInfo:(0,v.removeExtraInfos)(e.kLt),autoFilter:e.autoFilter,filterInfo:(0,v.removeExtraInfos)(e.NLt),autoGroup:e.autoGroup,groupInfo:e.MFt,detailColumnsVisible:e.UFt,pinnedRows:e.excludeInsertedPinnedRows(),pinnedColumns:e.CLt})},O.prototype.fromJSON=function(t){var n,e,i,r,o,a,n=this;if(n.iRt=t.indexMap,e=t.columnIndexMap,i=n.yLt,e&&i&&0<e.length&&e.length<i.length)for(r=e.length;r<i.length;r++)e[r]=r;for(r=0;r<i.length;r++)(o=i[r].validator)&&"date"===o.type&&("string"==typeof o.value1&&(a=g(o.value1))&&(o.value1=a),"string"==typeof o.value2)&&(a=g(o.value2))&&(o.value2=a);n.oPt=e,n.autoSort=t.autoSort,n.kLt=t.sortInfo,n.DLt=t.sortInfo,t.sortAfter&&(n.DLt=t.sortBefore,n._Lt=t.sortAfter),n.autoFilter=t.autoFilter,n.NLt=t.filterInfo,n.autoGroup=t.autoGroup,n.MFt=t.groupInfo,n.UFt=t.detailColumnsVisible,n.lFt=t.pinnedRows,n.CLt=t.pinnedColumns},n.View=O},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(t,n){var e,i,n,r,o,a;r=this,void 0!==(n="function"==typeof(e=o=function(t,n){"use strict";var e,i=5e3,r="callback",o=null;function l(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function h(n){try{delete window[n]}catch(t){window[n]=void 0}}function d(t){var t=document.getElementById(t);t&&document.getElementsByTagName("head")[0].removeChild(t)}function a(o){var a,u,s,c,f,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=o,s=a.timeout||i,c=a.jsonpCallback||r,f=void 0;return new Promise(function(t,n){var e,i,r,e=a.jsonpCallbackFunction||l(),i=c+"_"+e;window[e]=function(n){t({ok:!0,json:function t(){return Promise.resolve(n)}}),f&&clearTimeout(f),d(i),h(e)},u+=-1===u.indexOf("?")?"?":"&",(r=document.createElement("script")).setAttribute("src",""+u+c+"="+e),a.charset&&r.setAttribute("charset",a.charset),r.id=i,document.getElementsByTagName("head")[0].appendChild(r),f=setTimeout(function(){n(new Error("JSONP request to "+o+" timed out")),h(e),d(i),window[e]=function(){h(e)}},s),r.onerror=function(){n(new Error("JSONP request to "+o+" failed")),h(e),d(i),f&&clearTimeout(f)}})}n.exports=a})?e.apply(n,i=[n,t]):e)&&(t.exports=n)},"./node_modules/whatwg-fetch/fetch.js":function(t,n,e){"use strict";var u,i,r,o,a,s;function c(t){return t&&DataView.prototype.isPrototypeOf(t)}function f(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return t="string"!=typeof t?String(t):t}function h(n){var t={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return u.iterable&&(t[Symbol.iterator]=function(){return t}),t}function d(n){this.map={},n instanceof d?n.forEach(function(t,n){this.append(n,t)},this):Array.isArray(n)?n.forEach(function(t){this.append(t[0],t[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function v(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function m(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function g(t){var n,e,n=new FileReader,e=m(n);return n.readAsArrayBuffer(t),e}function p(t){var n,e,n=new FileReader,e=m(n);return n.readAsText(t),e}function b(t){for(var n,e,i,n=new Uint8Array(t),e=new Array(n.length),i=0;i<n.length;i++)e[i]=String.fromCharCode(n[i]);return e.join("")}function w(t){var n;return t.slice?t.slice(0):((n=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),n.buffer)}function y(){return this.bodyUsed=!1,this.HPt=function(t){(this.zPt=t)?"string"==typeof t?this.VPt=t:u.blob&&Blob.prototype.isPrototypeOf(t)?this.YPt=t:u.formData&&FormData.prototype.isPrototypeOf(t)?this.ZPt=t:u.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this.VPt=t.toString():u.arrayBuffer&&u.blob&&c(t)?(this.WPt=w(t.buffer),this.zPt=new Blob([this.WPt])):u.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this.WPt=w(t):this.VPt=t=Object.prototype.toString.call(t):this.VPt="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this.YPt&&this.YPt.type?this.headers.set("content-type",this.YPt.type):u.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u.blob&&(this.blob=function(){var t=v(this);if(t)return t;if(this.YPt)return Promise.resolve(this.YPt);if(this.WPt)return Promise.resolve(new Blob([this.WPt]));if(this.ZPt)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.VPt]))},this.arrayBuffer=function(){return this.WPt?v(this)||Promise.resolve(this.WPt):this.blob().then(g)}),this.text=function(){var t=v(this);if(t)return t;if(this.YPt)return p(this.YPt);if(this.WPt)return Promise.resolve(b(this.WPt));if(this.ZPt)throw new Error("could not read FormData body as text");return Promise.resolve(this.VPt)},u.formData&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function M(t){var n=t.toUpperCase();return-1<o.indexOf(n)?n:t}function C(t,n){var e=(n=n||{}).body;if(t instanceof C){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,e||null==t.zPt||(e=t.zPt,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new d(n.headers)),this.method=M(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e)throw new TypeError("Body not allowed for GET or HEAD requests");this.HPt(e)}function S(t){var e=new FormData;return t.trim().split("&").forEach(function(t){var t,n,t;t&&(n=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),e.append(decodeURIComponent(n),decodeURIComponent(t)))}),e}function T(t){var e,n,e=new d,n;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var t,n,t,t=t.split(":"),n=t.shift().trim();n&&(t=t.join(":").trim(),e.append(n,t))}),e}function A(t,n){n=n||{},this.type="default",this.status=void 0===n.status?200:n.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new d(n.headers),this.url=n.url||"",this.HPt(t)}e.r(n),e.d(n,{DOMException:function(){return s},Headers:function(){return d},Request:function(){return C},Response:function(){return A},fetch:function(){return I}}),(u={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self}).arrayBuffer&&(i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&-1<i.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,n){t=f(t),n=l(n);var e=this.map[t];this.map[t]=e?e+", "+n:n},d.prototype.delete=function(t){delete this.map[f(t)]},d.prototype.get=function(t){return t=f(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(f(t))},d.prototype.set=function(t,n){this.map[f(t)]=l(n)},d.prototype.forEach=function(t,n){for(var e in this.map)this.map.hasOwnProperty(e)&&t.call(n,this.map[e],e,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),h(e)},d.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),h(n)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),h(e)},u.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries),o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],C.prototype.clone=function(){return new C(this,{body:this.zPt})},y.call(C.prototype),y.call(A.prototype),A.prototype.clone=function(){return new A(this.zPt,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},A.error=function(){var t=new A(null,{status:0,statusText:""});return t.type="error",t},a=[301,302,303,307,308],A.redirect=function(t,n){if(-1===a.indexOf(n))throw new RangeError("Invalid status code");return new A(null,{status:n,headers:{location:t}})},s=self.DOMException;try{new s}catch(t){(s=function(t,n){this.message=t,this.name=n;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),s.prototype.constructor=s}function I(o,a){return new Promise(function(e,t){var n,i,n=new C(o,a);if(n.signal&&n.signal.aborted)return t(new s("Aborted","AbortError"));function r(){i.abort()}(i=new XMLHttpRequest).onload=function(){var t,n,t={status:i.status,statusText:i.statusText,headers:T(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL"),n="response"in i?i.response:i.responseText,e(new A(n,t))},i.onerror=function(){t(new TypeError("Network request failed"))},i.ontimeout=function(){t(new TypeError("Network request failed"))},i.onabort=function(){t(new s("Aborted","AbortError"))},i.open(n.method,n.url,!0),"include"===n.credentials?i.withCredentials=!0:"omit"===n.credentials&&(i.withCredentials=!1),"responseType"in i&&u.blob&&(i.responseType="blob"),n.headers.forEach(function(t,n){i.setRequestHeader(n,t)}),n.signal&&(n.signal.addEventListener("abort",r),i.onreadystatechange=function(){4===i.readyState&&n.signal.removeEventListener("abort",r)}),i.send(void 0===n.zPt?null:n.zPt)})}I.polyfill=!0,self.fetch||(self.fetch=I,self.Headers=d,self.Request=C,self.Response=A)},CalcEngine:function(t){"use strict";t.exports=e("CalcEngine")},Common:function(t){"use strict";t.exports=e("Common")}},o={},u.d=function(t,n){for(var e in n)u.o(n,e)&&!u.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},u.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},u.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a=u("./dist/src/dataManager.entry.js"),(i={}).Data=a,t.exports=i.Data},"./node_modules_local/@spreadjs/js-data-manager/index.js":function(t,n,e){t.exports=e("./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js")},"./node_modules_local/@spreadjs/js-sheets-common/dist/gc.spread.common.js":function(t){var a;!function(){"use strict";var e,i,t,n,r;function o(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},e[t].call(n.exports,n,n.exports,o)),n.exports}e={"./src/common/common.entry.ts":function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),n.B3=n.rbush=n.CultureManager=n.CultureInfo=n.zf=n.$T=n.st=n.ct=n.Uf=n.lt=n.ft=void 0,o=e("./src/common/util/colorhelper.ts"),Object.defineProperty(n,"ft",{enumerable:!0,get:function(){return o.ft}}),a=e("./src/common/util/types.ts"),Object.defineProperty(n,"lt",{enumerable:!0,get:function(){return a.lt}}),u=e("./src/common/util/arrayhelper.ts"),Object.defineProperty(n,"Uf",{enumerable:!0,get:function(){return u.Uf}}),s=e("./src/common/util/datetimehelper.ts"),Object.defineProperty(n,"ct",{enumerable:!0,get:function(){return s.ct}}),Object.defineProperty(n,"B3",{enumerable:!0,get:function(){return s.getSR}}),c=e("./src/common/util/numberhelper.ts"),Object.defineProperty(n,"st",{enumerable:!0,get:function(){return c.st}}),f=e("./src/common/util/regexhelper.ts"),Object.defineProperty(n,"$T",{enumerable:!0,get:function(){return f.$T}}),l=e("./src/common/util/stringhelper.ts"),Object.defineProperty(n,"zf",{enumerable:!0,get:function(){return l.zf}}),h=e("./src/common/util/rbush.ts"),Object.defineProperty(n,"rbush",{enumerable:!0,get:function(){return h.rbush}}),d=e("./src/common/util/common.ts"),Object.defineProperty(n,"HandleExcelSpecialDate",{set:function(t){d.HandleExcelSpecialDate=t},get:function(){return d.HandleExcelSpecialDate}}),r(e("./src/common/util/common.ts"),n),v=e("./src/common/culture/cultureInfo.ts"),Object.defineProperty(n,"CultureInfo",{enumerable:!0,get:function(){return v.CultureInfo}}),Object.defineProperty(n,"CultureManager",{enumerable:!0,get:function(){return v.CultureManager}}),r(e("./src/common/util/functionhelper.ts"),n)},"./src/common/culture/cultureInfo.ts":function(F,t,n){var e,i,u,a,r,c,o,s,f,i,l,n,h,d,v,m,L,n,i,g,e,p,b,w,y,B,M,i,C,S,T,A;function I(t){return t.split("\xa0").join(" ").toUpperCase()}function x(t){for(var n,e,i,n=[],e=0,i=t.length;e<i;e++)n[e]=I(t[e]);return n}function N(t,n,e){var t=I(t),n=n.indexOf(t);return n=-1===n?e.indexOf(t):n}function k(t){if(t){var t=t.charCodeAt(0);if(11904<=t&&t<12032||8208<=t&&t<8252||12288<=t&&t<40960||43360<=t&&t<43392||44032<=t&&t<55215||63744<=t&&t<64256||65280<=t&&t<65535)return!0}return!1}function P(t,n,e){var i;return" "===t||e&&"\u3000"===t?0:(i=e&&e(t),n.lineBreakingForbidStart&&-1!==n.lineBreakingForbidStart.indexOf(t)?!e||i?7:6:n.lineBreakingForbidEnd&&-1!==n.lineBreakingForbidEnd.indexOf(t)?!e||i?5:4:i?2:n.lineBreakingChar&&-1!==n.lineBreakingChar.indexOf(t)?3:1)}function _(t,n,e){var i,r,o,a,u,s;if(!t)return[];for(i=[t[0]],o=P(t[r=0],n,e),a=1;a<t.length;a++)u=P(t[a],n,e),v[s=o+""+u]&&i[++r]===c&&(i[r]=""),i[r]+=t[a],o=u;return i}function D(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"},scientificNotation:"0.##############E+00"},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={},this.displayName="",this.predefinedFormats={},this.TimelineDateOrder=[d.quarterOrMonth,d.date,d.year],this.TimelineDateSuffix={year:"",quarter:"",month:"",date:""},this.TextFormat={lineBreakingChar:[" ","-"]}}function j(){}function G(){var t,n,t=C.call(this)||this;return E.call(t,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),E.call(t,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!(n=["MMM yyyy","MMMM yyyy"]),n]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" H:mm:ss",t.name=function(){return"en-US"},t.displayName="English (United States)",t.id=1033,t.predefinedFormats={Accounting:'_([$$-409]* #,##0.00_);_([$$-409]* (#,##0.00);_([$$-409]* "-"??_);_(@_)',Comma:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',Currency:["[$$-409]#,##0","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);([$$-409]#,##0)","[$$-409]#,##0_);[Red]([$$-409]#,##0)"],Date:["m/d/yyyy","[$-409]dddd, mmmm dd, yyyy","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmm d, yyyy;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","m/d/yyyy;@","[$-409]d-mmm-yyyy;@"],Time:["[$-409]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","mm:ss.0;@","[h]:mm:ss;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@"],Special:{"Zip Code":"00000","Zip Code + 4":"00000-0000","Phone Number":"[<=9999999]###-####;(###) ###-####","Social Security Number":"000-00-0000"}},t}function U(){var t,n,e,i,r,i,t=S.call(this)||this,n,e;return E.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u5104",Trillions:"\u5146"}]),E.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],i=["1","2","3","4","5","6","7","8","9","10","11","12",""],i,"\u5348\u524d",!(i=["yyyy\u5e74M\u6708d\u65e5","yyyy\u5e74M\u6708dd\u65e5","yyyy\u5e74MM\u6708d\u65e5","yyyy\u5e74MM\u6708dd\u65e5"]),["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",r=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],r,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",i,"ggge/mmmm/d\u65e5"]),t.DateTimeFormat.eras=!0,t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.QPt=['gggee"\u5e74"MM"\u6708"dd"\u65e5','gggee"\u5e74"M"\u6708"d"\u65e5','ge"\u5e74"M"\u6708"d"\u65e5','ggge"\u5e74"M"\u6708"d"\u65e5','ggee"\u5e74"M"\u6708"d"\u65e5','gge"\u5e74"M"\u6708"d"\u65e5'],t.name=function(){return"ja-JP"},t.id=1041,t.displayName="Japanese (Japan)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\xa5-411]* #,##0.00_-;-[$\xa5-411]* #,##0.00_-;_-[$\xa5-411]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\xa5-411]#,##0_);[Red]([$\xa5-411]#,##0)","[$\xa5-411]#,##0_);([$\xa5-411]#,##0)","[$\xa5-411]#,##0;[Red][$\xa5-411]#,##0","[$\xa5-411]#,##0;-[$\xa5-411]#,##0","[$\xa5-411]#,##0;[Red]-[$\xa5-411]#,##0"],Date:["yyyy/mm/dd","[$-411]dddd, mmmm dd, yyyy",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"yyyy/m/d;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@"],Time:["[$-411]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@",'h"\u6642"mm"\u5206";@','h"\u6642"mm"\u5206"ss"\u79d2";@'],Special:{"\u90f5\u4fbf\u756a\u53f7":"[<=999]000;[<=9999]000-00;000-0000","\u96fb\u8a71\u756a\u53f7\uff08\u6771\u4eac)":"[<=99999999]####-####;(00) ####-####","\u6b63\u8ca0\u8a18\u53f7 \uff08+ = \u25b3; - = \u25b2)":'"\u25b3" #,##0;"\u25b2" #,##0',"\u6f22\u6570\u5b57\uff08\u5341\u4e8c\u4e07\u4e09\u5343\u56db\u767e\uff09":"[DBNum1][$-411]General","\u5927\u5b57 (\u58f1\u62fe\u5f10\u842c\u53c2\u9621\u56db\u767e)":"[DBNum2][$-411]General","\u5168\u89d2 (\uff11\uff12\uff13\uff14\uff15)":"[DBNum3][$-411]0","\u5168\u89d2 \u6841\u533a\u5207\u308a\uff08\uff11\uff12,\uff13\uff14\uff15\uff09":"[DBNum3][$-411]#,##0"}},t.TimelineDateOrder=[d.year,d.quarterOrMonth,d.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"\u6708",date:"\u65e5"},t.TextFormat={lineBreakingChar:[" ","\u3000","-"],lineBreakingForbidStart:["!","%",")",",",".",":",";","?","]","}","\uff01","\uff05","\uff09","\uff0c","\uff0e","\uff1a","\uff1b","\uff1f","\uff3d","\uff5d","\u300d","\u3002","\u3001","\u30fc"],lineBreakingForbidEnd:["(","[","{","\uff08","\uff3b","\uff5b","\u300c","$","\uff04","\\","\uffe5"],lineBreakingStrategy:function(t,n){return _(t,n,k)}},t}function O(){var t,n,e,i,r,i,t=T.call(this)||this,n,e;return E.call(t,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u4ebf",Trillions:"\u5146"}]),E.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],i=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],i,"\u4e0a\u5348",!(i=["yyyy\u5e74M\u6708","M\u6708d\u65e5","yyyy\u5e74M\u6708d\u65e5","h\u65f6mm\u5206","h\u65f6mm\u5206ss\u79d2"]),["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",r=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],r,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",i]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"zh-cn"},t.id=2052,t.displayName="Chinese (China)",t.isJCKCulture=!0,t.localeCompare=function(t,n){return t.localeCompare(n,"zh")},t.predefinedFormats={Accounting:'_ [$\xa5-804]* #,##0.00_ ;_ [$\xa5-804]* -#,##0.00_ ;_ [$\xa5-804]* "-"??_ ;_ @_ ',Comma:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ',Currency:["[$\xa5-804]#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]#,##0","[$\xa5-804]#,##0;[$\xa5-804]-#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]-#,##0"],Date:["yyyy/m/d","[$-804]dddd, mmmm dd, yyyy","yyyy-mm-dd;@",'[DBNum1][$-804]yyyy"\u5e74"m"\u6708"d"\u65e5";@','[DBNum1][$-804]yyyy"\u5e74"m"\u6708";@','[DBNum1][$-804]m"\u6708"d"\u65e5";@',"[$-409]yyyy/m/d h:mm AM/PM;@",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"mm/dd/yy;@","m/d/yy;@","yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["[$-804]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@",'h"\u65f6"mm"\u5206";@','h"\u65f6"mm"\u5206"ss"\u79d2";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2";@','[DBNum1][$-804]h"\u65f6"mm"\u5206";@','[DBNum1][$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@'],Special:{"\u90ae\u653f\u7f16\u7801":"000000","\u4e2d\u6587\u5c0f\u5199\u5b57\u6bcd":"[DBNum1][$-804]General","\u4e2d\u6587\u5927\u5199\u5b57\u6bcd":"[DBNum2][$-804]General"}},t.TimelineDateOrder=[d.year,d.quarterOrMonth,d.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"",date:"\u65e5"},t.TextFormat={lineBreakingChar:[" ","\u3000","-"],lineBreakingForbidStart:["!","%",")",",",".",":",";","?","]","}","\uff01","\uff05","\uff09","\uff0c","\uff0e","\uff1a","\uff1b","\uff1f","\uff3d","\uff5d"],lineBreakingForbidEnd:["(","[","{","\uff08","\uff3b","\uff5b"],lineBreakingStrategy:function(t,n){return _(t,n,k)}},t}function H(){var t,n,e,i,i,t=A.call(this)||this,n,e;return E.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"\u20a9",!1,{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]},4:{letters:["\uc870","\ucc9c","\ubc31","\uc2ed","\uc5b5","\ucc9c","\ubc31","\uc2ed","\ub9cc","\ucc9c","\ubc31","\uc2ed",""],numbers:["\u25cb","\uc77c","\uc774","\uc0bc","\uc0ac","\uc624","\uc721","\uce60","\ud314","\uad6c"]}},{Hundreds:"\ubc31",Thousands:"\ucc9c",Millions:"\ubc31\ub9cc",Billions:"10\uc5b5",Trillions:"\uc870"}]),E.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],i=["1","2","3","4","5","6","7","8","9","10","11","12",""],i,"\uc624\uc804",!(i=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""]),["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",i,i,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'","yyyy\ub144/mmmm/d\uc77c"]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"ko-kr"},t.id=1042,t.displayName="Korean (Korea)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\u20a9-412]* #,##0.00_-;-[$\u20a9-412]* #,##0.00_-;_-[$\u20a9-412]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red][$\u20a9-412]#,##0","[$\u20a9-412]#,##0;-[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red]-[$\u20a9-412]#,##0"],Date:["yyyy-mm-dd",'yyyy"\ub144" m"\uc6d4" d"\uc77c" dddd',"yyyy-mm-dd;@",'yyyy"\ub144" m"\uc6d4" d"\uc77c";@','yy"\u5e74" m"\u6708" d"\u65e5";@','yyyy"\ub144" m"\uc6d4";@','m"\uc6d4" d"\uc77c";@',"yy-m-d;@","yy-m-d h:mm;@",'m"\u6708"d"\u65e5";@',"[$-412]yy-m-d AM/PM h:mm;@","yy/m/d;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["[$-412]h:mm:ss AM/PM","h:mm;@","h:mm:ss;@","[$-412]AM/PM h:mm;@","[$-412]AM/PM h:mm:ss;@","[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'yyyy"-"m"-"d h:mm;@','[$-412]yyyy"-"m"-"d AM/PM h:mm;@','[$-409]yyyy"-"m"-"d h:mm AM/PM;@','h"\uc2dc" mm"\ubd84";@','h"\uc2dc" mm"\ubd84" ss"\ucd08";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84" ss"\ucd08";@'],Special:{"\uc6b0\ud3b8 \ubc88\ud638":"000-000","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 4\uc790\ub9ac)":"[<=999999]####-####;(0##) ####-####","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 3\uc790\ub9ac)":"[<=9999999]###-####;(0##) ###-####","\uc8fc\ubbfc\ub4f1\ub85d\ubc88\ud638":"000000-0000000","\uc22b\uc790(\ud55c\uc790)":"[DBNum1][$-412]General","\uc22b\uc790(\ud55c\uc790-\uac16\uc740\uc790)":"[DBNum2][$-412]General","\uc22b\uc790(\ud55c\uae00)":"[DBNum4][$-412]General"}},t.TimelineDateOrder=[d.year,d.quarterOrMonth,d.date],t.TimelineDateSuffix={year:"\ub144",quarter:"",month:"\uc6d4",date:"\uc77c"},t}function E(t,n,e){for(var i,r,o,a,i=this,o=0,a=n.length;o<a;o++)r=n[o],i[t][r]=e[o]}function V(t,n){var e;"object"==typeof document&&("function"!=typeof CustomEvent?(e=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):e=new CustomEvent("cultureChanged",{}),e.cultureInfo=t,r.gcCultureInfo=t,r.gcCultureObj=n,document.dispatchEvent(e))}function R(){this.KPt=1,this.JPt={}}e=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CultureManager=t.XPt=t.CultureInfo=t.TimelineDateOrder=void 0,i=n("./src/common/util/types.ts"),u=n("./src/common/util/common.ts"),a=n("./src/common/util/arrayhelper.ts"),r="undefined"!=typeof window?window:n.g,c=void 0,o=null,s=i.lt.y0,f=i.lt.Dh,n=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],h=(i=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(l=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),s(i,function(t,e){s(l,function(t,n){t<l.length-4&&h.push(e+" "+n)})}),h=h.concat(n),s(n,function(t,e){s(l,function(t,n){t<l.length-4&&h.push(e+" "+n)})}),(i=d=t.TimelineDateOrder||(t.TimelineDateOrder={}))[i.year=1]="year",i[i.quarterOrMonth=2]="quarterOrMonth",i[i.date=3]="date",v={"00":1,"01":1,"02":1,"03":1,"04":1,"05":1,"06":1,"07":1,12:1,15:1,21:1,22:1,23:1,24:1,25:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1,62:1,65:1,71:1,72:1,73:1,74:1,75:1},D.prototype.u2e=function(){return[" "]},D.prototype.tCe=function(t){var n,e,i,n=this,e,i={lineBreakingChar:n.u2e()};return n.TextFormat&&n.TextFormat.lineBreakingStrategy?n.TextFormat.lineBreakingStrategy(t,i):_(t,i)},D.prototype.hse=function(t){var n;return this.TextFormat&&this.TextFormat.lineBreakingStrategy?(n={lineBreakingChar:this.TextFormat.lineBreakingChar,lineBreakingForbidEnd:this.TextFormat.lineBreakingForbidEnd,lineBreakingForbidStart:this.TextFormat.lineBreakingForbidStart},this.TextFormat.lineBreakingStrategy(t,n)):_(t,this.TextFormat||{lineBreakingChar:[" ","-"]})},D.prototype.qPt=function(){var t,n,n,e;return this.$Pt||(n=(n=[n=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),n+" h:mm",n+" h:mm:ss",n+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(h),1041===this.id&&(e=t.eraFormatter,n=(n=n.concat(this.QPt)).concat(e)),n=n.concat(t.preselectedFormatters),this.$Pt=n),this.$Pt},D.prototype.tGt=function(t){var n=this;return n.nGt||(n.nGt=x(n.DateTimeFormat.monthNames),n.eGt=x(n.DateTimeFormat.monthGenitiveNames)),N(t,n.nGt,n.eGt)},D.prototype.iGt=function(t){var n=this;return n.rGt||(n.rGt=x(n.DateTimeFormat.abbreviatedMonthNames),n.oGt=x(n.DateTimeFormat.abbreviatedMonthGenitiveNames)),N(t,n.rGt,n.oGt)},D.prototype.aGt=function(t){var n=this;return n.uGt||(n.uGt=x(n.DateTimeFormat.dayNames)),n.uGt.indexOf(I(t))},D.prototype.sGt=function(t){var n=this;return n.cGt||(n.cGt=x(n.DateTimeFormat.abbreviatedDayNames)),n.cGt.indexOf(I(t))},m=D,t.CultureInfo=m,j.fGt=function(t){return t>=j.lGt()&&t<=j.hGt()},j.dGt=function(){var t,n,e,t=m.eras;if(t===c)return this.vGt;for(n=[],e=0;e<t.length;e++)n[e]=new Date(t[e].startDate.replace(/-/g,"/"));return n},j.mGt=function(t){var n,e,i,r,o;switch(t){case"g":n="symbol",e=j.gGt;break;case"gg":n="abbreviation",e=j.pGt;break;case"ggg":n="name",e=j.DEt;break;default:return[]}if(r=[],(i=m.eras)===c)return e;for(o=0;o<i.length;o++)r[o]=i[o][n];return r},j.hGt=function(){var t,t,t=m.eras;return t!==c&&0<t.length?((t=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.bGt},j.lGt=function(){var t=m.eras;return t!==c&&0<t.length?new Date(t[0].startDate.replace(/-/g,"/")):this.yGt},j.wGt=function(){var t=m.eras;return t!==c?t.length:this.MGt},j.CGt=function(){var t,n,e,i,r,t=m.eras;if(t===c)return this.SGt;for(n=[],e=1;e<t.length;e++)i=new Date(t[e-1].startDate.replace(/-/g,"/")),r=new Date(t[e].startDate.replace(/-/g,"/")),n[e-1]=r.getFullYear()-i.getFullYear()+1;return n[e-1]=99,n},j.TGt=function(t){var n,e,i,n={AGt:-1,IGt:-1};if(!j.fGt(t)){if(!(t>j.hGt()))return n;t=j.hGt()}for(e=0;e<j.wGt();e++)if(t<(i=e+1!==j.wGt()?j.dGt()[e+1]:j.xGt(j.hGt(),1))){n.AGt=e,n.IGt=t.getFullYear()-j.dGt()[e].getFullYear()+1;break}return n},j.xGt=function(t,n){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+n),new Date(t.valueOf())},j.NGt=function(t,n){var e;return j.dGt()[t].getFullYear()+n-1},j.kGt=function(t,n){var e,i;for(n=n.toUpperCase(),e=j.mGt(t),i=0;i<e.length;i++)if(e[i]===n)return i;return-1},j.DGt=function(t,n,e){var i,n,r,i,i,r,i=j,n=i.TGt(n),r=n.AGt;if(0<=r&&0<(i=i.mGt(t)).length)return i[r];if(0<=(i=n.IGt)){if("1"===(r=i.toString())&&e)return r="\u5143";if("ee"===t)return r=1===r.length?"0"+r:r;if("e"===t)return r}return""},j.vGt=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],j.MGt=5,j.SGt=[45,15,64,31,99],j.bGt=new Date(2117,11,31,23,59,59),j.yGt=new Date(1868,8,8),j._Gt=["1,m","2,t","3,s","4,h","5,r"],j.EGt=[0,1,2,3,0,1,2,3],j.DEt=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210","\u4ee4\u548c"],j.gGt=["M","T","S","H","R"],j.pGt=["\u660e","\u5927","\u662d","\u5e73","\u4ee4"],j.jGt=99,j.eraExcelFormatter="[$-ja-JP-x-gannen]",j.eraInternalFormatter="[$-411]",t.XPt=j,e(G,C=m),n=G,e(U,S=m),i=U,e(O,T=m),O.prototype.u2e=function(){return[" ","\u3000"]},g=O,e(H,A=m),e=H,p={invariant:new m,"en-us":new n,"ja-jp":new i,"zh-cn":new g,"ko-kr":new e},b={},w=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],y=["wmk1","wmk2"],R.instance=function(){return this.OGt||(this.OGt=new this)},R.prototype.culture=function(t){if(0===arguments.length)return R.RGt;t&&R.RGt!==t&&(R.RGt=t.toLowerCase(),this.KPt++,V(R.RGt,R.OGt.getCultureInfo()))},R.prototype.addCultureInfo=function(t,n,e){var i,r,o,a,i;if(n&&n instanceof m){if(i=n.NumberFormat&&n.NumberFormat.numberDecimalSeparator,r=n.NumberFormat.arrayListSeparator,o=n.NumberFormat.arrayGroupSeparator,i===n.NumberFormat.listSeparator||o===r)throw(a=new u.ResourceManager(u.SR)).getResource().Exp_Separator;p[t.toLowerCase()]=n}e&&"object"==typeof e&&(i=t.toLowerCase(),b[i]=f(!0,{},e),this.KPt++)},R.prototype.getCultureInfoDict=function(){return p},R.prototype.getCultureInfo=function(t){var n,e,i;if(0===arguments.length)return p[R.RGt];for(i in"string"==typeof t&&(t=t.toLowerCase()),e=o,n=p)if(i===t||n[i].id!==c&&n[i].id===t){e=n[i];break}return e},R.prototype.getLanguage=function(t){var t;return"string"==typeof t?(t=t.toLowerCase(),b[t]):o},R.prototype.getResources=function(t){var n,n,n=this.culture().toLowerCase();return"string"==typeof(t=t!==o&&t!==c?t:n)&&(n=t.toLowerCase(),this.JPt[n])?this.BGt(this.JPt[n]):o},R.prototype.BGt=function(t){var n,e,i,r,o,t,n,n="PivotTables",e="Sheets",i="CalcEngine",r="Functions",o="TableFunctions",t=f(!0,{},t);return t[n]&&this.LGt(t[n],y),t[e]&&this.LGt(t[e],w),(n=t[i])&&(t[r]=n.wmt,t[o]=n.d2t,delete n.wmt,delete n.d2t),t},R.prototype.LGt=function(t,n){for(var e,i,r,e=0,i=n;e<i.length;e++)delete t[r=i[e]]},R.prototype.FGt=function(t,n,e){var i,r,o,i=b[t.toLowerCase()];for(r in n)a.Uf.OS(w,r)||null!==(o=this.PGt(i,r,e))&&"string"==typeof o&&"string"==typeof n[r]&&(n[r]=o);n.wmt&&i.Functions&&this.GGt(i.Functions,n.wmt),n.d2t&&i.TableFunctions&&f(!0,n.d2t,i.TableFunctions)},R.prototype.PGt=function(t,n,e){var i,r;if(t.hasOwnProperty(n))return t[n];if(e&&(i=t[e])&&"object"==typeof i&&i.hasOwnProperty(n))return i[n];for(r in t)if((i=t[r])&&"object"==typeof i&&i.hasOwnProperty(n))return i[n];return null},R.prototype.GGt=function(t,n){var e,i,r,o,a,u,s,c,e={};for(i in n)if(t.hasOwnProperty(i))for(s in r=n[i],o=t[i],a=r.parameters,u=o.parameters,r.description=o.description,a)u.hasOwnProperty(s)&&"string"==typeof(c=u[s])&&(a[s].name=c);return e},R.prototype.Fe=function(t){var t=this.getCultureInfo(t),t;return t=(t=t||p[R.RGt])||new m},R.prototype.xat=function(t,n){var e,t,i,e,t=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,i=t.filterDialogDateFormatter;return i=0<=n.indexOf("g")||0<=n.indexOf("e")?t.EraFilterDialogDateFormatter||i:i},R.RGt="en-us",t.CultureManager=R.instance()},"./src/common/util/arrayhelper.ts":function(t,n){var r,o,e;function a(t,n){var e,i;for(e in n)n.hasOwnProperty(e)&&(i=n[e],Array.isArray(i)?(t[e]=[],a(t[e],n[e])):i!==r&&"object"==typeof i?(t[e]={},a(t[e],n[e])):t[e]=n[e])}function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Uf=void 0,r=null,o=void 0,i.Eit=function(t,n,e){t.splice(n,0,e)},i.ZP=function(t,n){t.push(n)},i.OS=function(t,n){return-1<t.indexOf(n)},i.VP=function(t,n){var n=t.indexOf(n);-1<n&&t.splice(n,1)},i.UGt=function(t,n){return t.slice(0,n).concat(t.slice(n+1))},i.hD=function(t,n,e){return t.indexOf(n,e)},i.d5=function(t,n,e){if(!(n<0))for(var i=0;i<e&&n+i<t.length;i++)t[n+i]=r},i.N2t=function(t,n){for(var e,i,i=e=(n=n<0?-1:n)+1;i<t.length;i++)if(t[i]!==o&&t[i]!==r)return i;return-1},i.tR=function(t){return t&&t.length},i.Gf=function(t){var n=[];return a(n,t),n},n.Uf=i},"./src/common/util/colorhelper.ts":function(t,n,r){var e,o,s,c,a,f,l,i,h,u;function d(t,n,e){return e<0&&(e+=240),240<e&&(e-=240),e<40?t+((n-t)*e+20)/40:e<120?n:e<160?t+((n-t)*(160-e)+20)/40:t}function v(t,n,e){var i,r,o,a,u;return 0===e?i=r=o=f(255*n/240+"",10):(u=a=void 0,i=m(a=2*n-(u=n<=120?f((n*(240+e)+120)/240+""):n+e-f((n*e+120)/240+"")),u,t+80),r=m(a,u,t),o=m(a,u,t-80)),{a:255,r:i,g:r,b:o}}function m(t,n,e){return s(f((255*d(t,n,e)+120)/240+""),255)}function g(t){var n,e,i,t,r,o,a,o,a,u,t,n=this,e=t.r,i=t.g,t=t.b,r=c(c(e,i),t),o=s(s(e,i),t),a=r+o;n.HGt=f((240*a+255)/510+"",10),0==(o=r-o)?(n.zGt=0,n.wv=160):(n.HGt<=120?n.zGt=f((240*o+a/2)/a+"",10):n.zGt=f((240*o+(510-a)/2)/(510-a)+"",10),a=(40*(r-e)+o/2)/o,u=(40*(r-i)+o/2)/o,t=(40*(r-t)+o/2)/o,n.wv=f(e===r?t-u+"":i===r?80+a-t+"":160+u-a+"",10),n.wv<0&&(n.wv+=240),240<n.wv&&(n.wv-=240))}function p(t){var n,e,i,r,n,o,a,u,n,i;return/^#[A-Fa-f0-9]+$/.test(t)?(n=t.replace(/^#/,""),r=i="",6===(e=n.length)||8===e?(i=n.substr(0,6),8===e&&(r=n.substr(6,2))):3!==e&&4!==e||(i=(n=n.split(3===e?/(.)/:/(..)/)).filter(Boolean).map(function(t){return parseInt(3===e?t+t:t,16)}).map(function(t){return t.toString(16).padStart(2,"0")}).join(""),4===e&&(r=n[3]+n[3])),[o=parseInt(i.slice(0,2),16),a=parseInt(i.slice(2,4),16),u=parseInt(i.slice(4,6),16),n=r?parseInt(r,16):255]):t.toLowerCase()in l?l[t.toLowerCase()]:null!==(i=h.exec(t))?(n=void 0===i[4]?255:255*+i[4],[i[1],i[2],i[3],n]):null}function b(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ft=void 0,e=r("./src/common/util/numberhelper.ts"),o=e.st.VGt,s=Math.min,c=Math.max,a=Math.abs,f=parseInt,l={aliceblue:[240,248,255,255],antiquewhite:[250,235,215,255],aqua:[0,255,255,255],aquamarine:[127,255,212,255],azure:[240,255,255,255],beige:[245,245,220,255],bisque:[255,228,196,255],black:[0,0,0,255],blanchedalmond:[255,235,205,255],blue:[0,0,255,255],blueviolet:[138,43,226,255],brown:[165,42,42,255],burlywood:[222,184,135,255],cadetblue:[95,158,160,255],chartreuse:[127,255,0,255],chocolate:[210,105,30,255],coral:[255,127,80,255],cornflowerblue:[100,149,237,255],cornsilk:[255,248,220,255],crimson:[220,20,60,255],cyan:[0,255,255,255],darkblue:[0,0,139,255],darkcyan:[0,139,139,255],darkgoldenrod:[184,134,11,255],darkgray:[169,169,169,255],darkgreen:[0,100,0,255],darkgrey:[169,169,169,255],darkkhaki:[189,183,107,255],darkmagenta:[139,0,139,255],darkolivegreen:[85,107,47,255],darkorange:[255,140,0,255],darkorchid:[153,50,204,255],darkred:[139,0,0,255],darksalmon:[233,150,122,255],darkseagreen:[143,188,143,255],darkslateblue:[72,61,139,255],darkslategray:[47,79,79,255],darkslategrey:[47,79,79,255],darkturquoise:[0,206,209,255],darkviolet:[148,0,211,255],deeppink:[255,20,147,255],deepskyblue:[0,191,255,255],dimgray:[105,105,105,255],dimgrey:[105,105,105,255],dodgerblue:[30,144,255,255],firebrick:[178,34,34,255],floralwhite:[255,250,240,255],forestgreen:[34,139,34,255],fuchsia:[255,0,255,255],gainsboro:[220,220,220,255],ghostwhite:[248,248,255,255],gold:[255,215,0,255],goldenrod:[218,165,32,255],gray:[128,128,128,255],green:[0,128,0,255],greenyellow:[173,255,47,255],grey:[128,128,128,255],honeydew:[240,255,240,255],hotpink:[255,105,180,255],indianred:[205,92,92,255],indigo:[75,0,130,255],ivory:[255,255,240,255],khaki:[240,230,140,255],lavender:[230,230,250,255],lavenderblush:[255,240,245,255],lawngreen:[124,252,0,255],lemonchiffon:[255,250,205,255],lightblue:[173,216,230,255],lightcoral:[240,128,128,255],lightcyan:[224,255,255,255],lightgoldenrodyellow:[250,250,210,255],lightgray:[211,211,211,255],lightgreen:[144,238,144,255],lightgrey:[211,211,211,255],lightpink:[255,182,193,255],lightsalmon:[255,160,122,255],lightseagreen:[32,178,170,255],lightskyblue:[135,206,250,255],lightslategray:[119,136,153,255],lightslategrey:[119,136,153,255],lightsteelblue:[176,196,222,255],lightyellow:[255,255,224,255],lime:[0,255,0,255],limegreen:[50,205,50,255],linen:[250,240,230,255],magenta:[255,0,255,255],maroon:[128,0,0,255],mediumaquamarine:[102,205,170,255],mediumblue:[0,0,205,255],mediumorchid:[186,85,211,255],mediumpurple:[147,112,219,255],mediumseagreen:[60,179,113,255],mediumslateblue:[123,104,238,255],mediumspringgreen:[0,250,154,255],mediumturquoise:[72,209,204,255],mediumvioletred:[199,21,133,255],midnightblue:[25,25,112,255],mintcream:[245,255,250,255],mistyrose:[255,228,225,255],moccasin:[255,228,181,255],navajowhite:[255,222,173,255],navy:[0,0,128,255],oldlace:[253,245,230,255],olive:[128,128,0,255],olivedrab:[107,142,35,255],orange:[255,165,0,255],orangered:[255,69,0,255],orchid:[218,112,214,255],palegoldenrod:[238,232,170,255],palegreen:[152,251,152,255],paleturquoise:[175,238,238,255],palevioletred:[219,112,147,255],papayawhip:[255,239,213,255],peachpuff:[255,218,185,255],peru:[205,133,63,255],pink:[255,192,203,255],plum:[221,160,221,255],powderblue:[176,224,230,255],purple:[128,0,128,255],rebeccapurple:[102,51,153,255],red:[255,0,0,255],rosybrown:[188,143,143,255],royalblue:[65,105,225,255],saddlebrown:[139,69,19,255],salmon:[250,128,114,255],sandybrown:[244,164,96,255],seagreen:[46,139,87,255],seashell:[255,245,238,255],sienna:[160,82,45,255],silver:[192,192,192,255],skyblue:[135,206,235,255],slateblue:[106,90,205,255],slategray:[112,128,144,255],slategrey:[112,128,144,255],snow:[255,250,250,255],springgreen:[0,255,127,255],steelblue:[70,130,180,255],tan:[210,180,140,255],teal:[0,128,128,255],thistle:[216,191,216,255],tomato:[255,99,71,255],turquoise:[64,224,208,255],violet:[238,130,238,255],wheat:[245,222,179,255],white:[255,255,255,255],whitesmoke:[245,245,245,255],yellow:[255,255,0,255],yellowgreen:[154,205,50,255]},g.prototype.YGt=function(t){var n,e,i,n=this,e=n.HGt,i=n.ZGt(n.HGt,500,!0);return v(n.wv,e+(i-e)*t,n.zGt)},g.prototype.ZGt=function(t,n,e){if(0!==n){if(e)return 0<n?(t*(1e3-n)+241*n)/1e3:t*(n+1e3)/1e3;240<(t=(t+=240*n/1e3)<0?0:t)&&(t=240)}return t},i=g,h=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*(\.\d+|\d(?:\.\d+)?))?\)/,b.j=function(t){var n,e,i,r,n=t.a,e=t.r,i=t.g,r=t.b;return 3===arguments.length&&(n=255,e=t,i=arguments[1],r=arguments[2]),4===arguments.length&&(n=t,e=arguments[1],i=arguments[2],r=arguments[3]),255===n?"#"+o(e,!0,2)+o(i,!0,2)+o(r,!0,2):"rgba("+e+","+i+","+r+","+n+")"},b.Tv=function(t,n){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(n):t.a===n.a&&t.r===n.r&&t.g===n.g&&t.b===n.b},b.rp=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},b.Km=function(t,n){var e,i,r,t,o,e=255-a(t.r-n.r),i=255-a(t.g-n.g),r=255-a(t.b-n.b),t=a(t.a-n.a);return!!(.9<=(o=((e/=255)+(i/=255)+(r/=255))/3)&&t<=.05)},b.Uv=function(t){var n,e,i,n=255^t.r,e=255^t.g,i=255^t.b;return b.j(t.a,n,e,i)},b.WGt=function(t){var n,e,i,i;return"object"==typeof document&&((n=b.xf)||(e=document.createElement("canvas"))&&e.getContext&&(n=b.xf=e.getContext("2d",{willReadFrequently:!0})),n||((i=r("canvas"))&&i.createCanvas&&(e=i.createCanvas(2,2),n=b.xf=e.getContext("2d")),n))?(n.clearRect(1,1,1,1),n.fillStyle=t,n.fillRect(1,1,1,1),(i=n.getImageData(1,1,1,1))?i.data:null):p(t)},b._=function(t){var n,e,i,r,t;return t instanceof b||null!==t&&"object"==typeof t?t:(r=i=e=n=0,t&&(t=b.WGt(t))&&(e=t[0],i=t[1],r=t[2],n=t[3]),{a:n,r:e,g:i,b:r})},b.Cv=function(t,n){var t,n;return 0===n?t:(t=new i(t),n=f((0<n?(240-t.HGt)*n:t.HGt*n)+"",10),b.QGt(t.wv,t.HGt+n,t.zGt))},b.YGt=function(t,n){var t,e,t,t=b._(t),e,t=new i(t).YGt(n);return b.j(t)},b.Dz=d,b.QGt=v,n.ft=b},"./src/common/util/common.ts":function(t,n,e){var r,i,e,o,a;function u(t,n){this.res=t,this.KGt=n,this.JPt=r.CultureManager.JPt,this.cachedResource=this.JGt(t,!0),this.XGt(this.cachedResource,n),this.KPt=0}function s(t,n,e,i){var r,o,a,u,s;if(t&&0<=e&&e<n){for(r=[],a=o=void 0,a=e;a<n;a++)void 0!==t[a]&&r.push(a);for(o=r.length,a=0;a<o;a++)s=t[u=r[o-a-1]],t[u]=null,t[Math.floor(u)+i]=s}}function c(t,n,e,i){var r,o,a,u,s,c;if(t&&0<=e&&e<n){for(r=[],a=e+i,u=o=void 0,u=e;u<n;u++)void 0!==t[u]&&(e<=u&&u<a?t[u]=null:a<=u&&r.push(u));for(o=r.length,u=0;u<o;u++)c=t[s=r[u]],t[s]=null,t[Math.floor(s)-i]=c}}function f(t,n){return t.hasOwnProperty(n)}function l(t,n){return t instanceof n}Object.defineProperty(n,"__esModule",{value:!0}),n.ut=n.kh=n.X8=n.J8=n.ResourceManager=n.SR=void 0,r=e("./src/common/culture/cultureInfo.ts"),i=e("./src/common/util/util.res.en.ts"),e=e("./src/common/util/types.ts"),n.SR={en:i},o=e.lt.Dh,u.prototype.getResource=function(){var t=this.JGt(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.XGt(this.cachedResource,this.KGt),this.cachedResource},u.prototype.XGt=function(t,n){var e,i;n&&(i=(e=r.CultureManager.culture()).toLowerCase(),this.JPt[i]=this.JPt[i]||{},this.JPt[i][n]=t,r.CultureManager.JPt=this.JPt)},u.prototype.JGt=function(t,n){var e,i,n,i,e=r.CultureManager.culture();return t&&e?(i=r.CultureManager.KPt,this.KPt!==i||n?(this.KPt=i,r.CultureManager.getLanguage(e)?(n=o(!0,{},t.en),r.CultureManager.FGt(e,n,this.KGt),n):(i=e.substr(0,2).toLowerCase(),t.hasOwnProperty(i)?t[i]:t.en)):void 0):{}},n.ResourceManager=u,n.J8=s,n.X8=c,n.kh=f,n.ut=l},"./src/common/util/datetimehelper.ts":function(t,D,n){var e,x,d,j,n,a,O,N,k,_,i,E,R,n,o,r;function F(t,n){if(e.HandleExcelSpecialDate)return e.HandleExcelSpecialDate.apply(null,[t,n]);switch(n){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:return}}function L(t,n,e,i){var r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,y,C,S,T,A,I,x,N,r=e.DateTimeFormat,o=r.Calendar.convert;if(!n||!n.length)return e&&e.name.length?o?L(t,r.fullDateTimePattern,e):t.toLocaleString():t.toString();function k(){return f||l||(f=h.test(n),l=!0),f}function _(t,n){return m?m[n]:F(t,n)}for(a=r.eras,s="",h=/([^d]|^)(d|dd)([^d]|$)/g,d=0,v=G(),!(u="s"===n)&&o&&(m=o.fromGregorian(t)),p=g=-2,b={y4:""},w=0;y=v.lastIndex,M=v.exec(n),y=n.slice(y,M?M.index:n.length),b.y4="",d+=B(y,b),s+=b.y4,M;w++)if(d%2==1)s+=M[0];else switch(C=_(t,0),S=t.getDay(),T=t.getHours(),A=t.getMinutes(),I=t.getSeconds(),x=t.getMilliseconds(),N=t.getTimezoneOffset(),M[0]){case"dddd":s+=r.dayNames[S];break;case"ddd":s+=r.abbreviatedDayNames[S];break;case"dd":f=!0,s+=O(_(t,2),2);break;case"d":f=!0,s+=_(t,2);break;case"MMMM":s+=(r.monthGenitiveNames&&k()?r.monthGenitiveNames:r.monthNames)[_(t,1)];break;case"MMM":s+=(r.abbreviatedMonthGenitiveNames&&k()?r.abbreviatedMonthGenitiveNames:r.abbreviatedMonthNames)[_(t,1)];break;case"MM":s+=O(_(t,1)+1,2);break;case"M":s+=_(t,1)+1;break;case"yyyy":case"yyy":s+=0<=g?j.XPt.DGt("ee",t,i):O(m?m[0]:C,4);break;case"yy":s+=0<=g?j.XPt.DGt("ee",t,i):O((m?m[0]:C)%100,2);break;case"y":s+=0<=g?j.XPt.DGt("e",t,i):((m?m[0]:C)%100).toString();break;case"hh":s+=O(c=0===(c=T%12)?12:c,2);break;case"h":s+=c=0===(c=T%12)?12:c;break;case"HH":s+=O(T,2);break;case"H":s+=T.toString();break;case"mm":s+=O(A,2);break;case"m":s+=A.toString();break;case"ss":s+=O(I,2);break;case"s":s+=I.toString();break;case"tt":s+=T<12?r.amDesignator:r.pmDesignator;break;case"t":s+=(T<12?r.amDesignator:r.pmDesignator).charAt(0);break;case"f":case"0":s+=O(x,3).charAt(0);break;case"ff":case"00":s+=O(x,3).substr(0,2);break;case"fff":case"000":s+=O(x,3);break;case"z":s+=((c=N/60)<=0?"+":"-")+E(R(c));break;case"zz":s+=((c=N/60)<=0?"+":"-")+O(E(R(c)),2);break;case"zzz":s+=((c=N/60)<=0?"+":"-")+O(E(R(c)),2)+":"+O(R(N%60),2);break;case"g":case"gg":case"ggg":a&&(g=(g===w-1||(s+=j.XPt.DGt(M[0],t,i)),w));break;case"e":case"ee":a?p=(p===w-1||(s+=j.XPt.DGt(M[0],t,i)),w):s+=O(m?m[0]:C,4);break;case"/":s+=r.dateSeparator;break;default:if(!/\[(H+|h+|m+|s+)\]/.test(M[0]))throw new Error((0,D.getSR)().Exp_InvalidDateFormat);s+=M[0]}return s.toString()}function B(t,n){for(var e,i,r,o,a,e=0,i=_,r=0,o=t.length;r<o;r++)switch(a=t.charAt(r)){case'"':i?n.y4+="'":e++,i=_;break;case"\\":i&&(n.y4+="\\"),i=!i;break;default:n.y4+=a,i=_}return e}function P(t,n){var e,i,e,e=new Date,i;return t.DateTimeFormat.eras&&n<100&&(n+=(e=j.XPt.TGt(e).IGt)-e%100)>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(n-=100),n}function G(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H+\]|\[h+\]|\[m+\]|\[s+\]/g}function U(t,n,e){var i,r,o,a,u,s,c,f,l,h,h;if(t.qGt){if(t.qGt[n])return t.qGt[n]}else t.qGt={};for(i=(i=(i=n).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),r="^",o={y4:""},a=[],s=u=0,c=G();(f=c.exec(i))!==N;)if(o.y4="",l=i.slice(u,f.index),u=c.lastIndex,s+=B(l,o),r+=o.y4,s%2==1)r+=f[0];else{switch(f[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":r+="(\\D+)";break;case"tt":case"t":r+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":r+=e?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":r+="(\\d{2}|\\d{4})";break;case"fff":case"000":r+="(\\d{3})";break;case"ff":case"00":r+="(\\d{2})";break;case"f":case"0":r+="(\\d)";break;case"zzz":r+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":r+="([+-]?\\d\\d?)";break;case"/":r+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw new Error((0,D.getSR)().Exp_InvalidDateFormat)}d.Uf.ZP(a,f[0])}return o.y4="",B(i.slice(u),o),h={$Gt:h=(r=r+o.y4+"$").toString().replace(/\s+/g,"\\s+"),QMt:a,tUt:new RegExp(h)},t.qGt[n]=h}function u(t){var t=t.getTimezoneOffset();return t=-402===(t=-507===(t=-321===(t=-485===t?-485-43/60:t)?-321-10/60:t)?-507-52/60:t)?-402-4/60:t}function s(){}Object.defineProperty(D,"__esModule",{value:!0}),D.ct=D.getSR=void 0,e=n("./src/common/util/common.ts"),x=n("./src/common/util/stringhelper.ts"),d=n("./src/common/util/arrayhelper.ts"),j=n("./src/common/culture/cultureInfo.ts"),n=n("./src/common/util/types.ts"),a=n.lt.ht,O=x.zf.B9t,N=null,k=parseInt,i=!(_=!1),E=Math.floor,R=Math.abs,n=new e.ResourceManager(e.SR,"Common"),D.getSR=n.getResource.bind(n),o={},s.L9t=function(t,n,e,i){return L(t,n,e=e||j.CultureManager.Fe(),i)},s.Pe=function(t,n,e){return L(t,n,e||j.CultureManager.Fe())},s.Mjt=function(t,n,e){var i,r,o,o,a,u=_,a=e;for(a.slice(1).forEach(function(t){t&&(u=!0)}),r=(a=u?a:a.concat(n.qPt())).length,i=1;i<r;i++)if((o=a[i])&&(u=!0,o=s.nUt(t,o,n)))return o;return N},s.yU=function(t,n,e){var i,r;return(n||e||void 0===(r=o[t]))&&(i=n?[t,n]:[t],r=s.Mjt(t,e||j.CultureManager.Fe(),i),n||e||(o[t]=r)),r&&new Date(r)},s.Z6t=function(t,n){return s.Mjt(t,j.CultureManager.Fe("invariant"),[t,n])},s.nUt=function(t,n,e){var i,r,n,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,S,T,T,n,t,A,I,n;if(t=t.trim(),(o=(n=U(i=e.DateTimeFormat,n,r=1041===e.id)).tUt.exec(t))===N)return N;for(a=n.QMt,p=l=f=c=s=u=N,w=b=_,y=g=m=v=h=0,M=a.length;y<M;y++)if(C=o[y+1])switch(a[y]){case"dd":case"d":if((f=k(C,10))<1||31<f)return N;break;case"MMMM":if((c=e.tGt(C))<0||11<c)return N;break;case"MMM":if((c=e.iGt(C))<0||11<c)return N;break;case"M":case"MM":case"%M":if((c=k(C,10)-1)<0||11<c)return N;break;case"e":case"ee":if((s=r&&"\u5143"===C?1:P(e,k(C,10)))<0||9999<s)return N;break;case"y":case"yy":case"yyy":case"yyyy":if((s=k(C,10))<0||9999<s)return N;break;case"h":case"hh":case"H":case"HH":if((h=k(C,10))<0)return N;break;case"m":case"mm":if((v=k(C,10))<0||59<v)return N;break;case"s":case"ss":if((m=k(C,10))<0||59<m)return N;break;case"tt":case"t":if(b=(S=C.toUpperCase())===i.pmDesignator.toUpperCase(),w=S===i.amDesignator.toUpperCase(),b||w)break;return N;case"f":case"0":if((g=100*k(C,10))<0||999<g)return N;break;case"ff":case"00":if((g=10*k(C,10))<0||999<g)return N;break;case"fff":case"000":if((g=k(C,10))<0||999<g)return N;break;case"dddd":if((l=e.aGt(C))<0||6<l)return N;break;case"ddd":if((l=e.sGt(C))<0||6<l)return N;break;case"zzz":if(2!==(S=C.split(/:/)).length)return N;if((d=k(S[0],10))<-12||13<d)return N;if((T=k(S[1],10))<0||59<T)return N;p=60*d+(x.zf.fJ(C,"-")?-T:T);break;case"z":case"zz":if((d=k(C,10))<-12||13<d)return N;p=60*d;break;case"g":case"gg":case"ggg":if(!(T=C)||!i.eras)return N;if((u=j.XPt.kGt(a[y],T))<0)return N}if(t=(n=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(I=i.Calendar.convert)&&(A=I.fromGregorian(t)),I||(A=[t.getFullYear(),t.getMonth(),t.getDate()]),s===N?s=A[0]:s<100&&(i.eras&&u!==N?s=j.XPt.NGt(u||0,s):s+=30<=s?1900:2e3),c===N&&(c=A[1]),f===N&&(f=n?A[2]:1),I){if((t=I.toGregorian(s,c,f))===N)return N}else{if(t.setFullYear(s,c,f),t.getDate()!==f)return N;if(l!==N&&t.getDay()!==l)return N}return b&&h<12?h+=12:w&&12===h&&(h=0),t.setHours(h,v,m,g),p!==N&&(n=t.getMinutes()-(p+t.getTimezoneOffset()),t.setHours(t.getHours()+n/60,n%60)),t},s.Y0=function(t){var n,e,i,n,t,i,r,o,a,n=t-25569,e,i=0<=n?1:-1,n=u(new Date(864e5*n)),t=(864e5*t*1440+i-3181192704e6+864e5*n)/1440,i=new Date(t),r,o,a=u(new Date(t+36e5*(0<=n?1:-1)));return 60<=R(n-a)?new Date(t+60*(a-n)*1e3):i},s.dJ=function(t){var t;if("/OADate("===t.substr(0,8))return t=parseFloat(t.substr(8,t.length-10)),s.Y0(t)},s.Q0=function(t){return"/OADate("+s.o0(t)+")/"},s.o0=function(t){var n;return!a(t)&&(t="number"!=typeof t&&"string"!=typeof t?t:new Date(t))instanceof Date?(n=u(t),(1440*t.getTime()+3181192704e6-864e5*n)/124416e6):0},s.iPt=function(t){var n,e,i,r,o,n=N,e=!0;if(a(t)?n=s.Y0(0):t instanceof Date?n=new Date(t.valueOf()):"string"==typeof t?((i=s.yU(t))||(isNaN(t)?!s.u6t(t)&&(i=new Date(t),isNaN(i.valueOf())&&(e=_),!(o=(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/).exec(t.replace(/ |\n/g,"").trim()))||4!==o.length||-1!==o.indexOf(i.getFullYear().toString())&&-1!==o.indexOf((i.getMonth()+1).toString())&&-1!==o.indexOf(i.getDate().toString()))||(e=_):(i=s.Y0(parseFloat(t)))||(e=_)),n=i):"number"==typeof t?n=s.Y0(t):e=_,e)return n;throw(0,D.getSR)().Exp_InvalidCast},s.u6t=function(t){var n,i,e,r,o,n=j.CultureManager.Fe().DateTimeFormat,i=s.eUt,e=function(n,t){var e=0;return t.forEach(function(t){t&&-1<n.indexOf(t)&&e++}),1<e},r=function(t,n){var t,e;return!!(t&&-1<t.indexOf(" "))&&2<=(e=(t=t.split(" ")).length)&&n.indexOf(t[e-2])<=-1&&!isNaN(t[e-1])},o=function(n){var e=!1;return i.forEach(function(t){-1<n.indexOf(t)&&(e=!0)}),e};return e(t,n.monthNames)||e(t,n.abbreviatedMonthNames)||e(t,n.dayNames)||e(t,n.abbreviatedDayNames)||r(t,n.monthNames.concat(n.abbreviatedMonthNames))||o(t)},s.W0=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},s.eUt=["@","#","!","`","^","$","*","(",")","&"],D.ct=s},"./src/common/util/functionhelper.ts":function(t,n,e){var V,z,Y,Z;function c(t){return t}function f(t,n,e,i,r,o,a,u,s,F,c){var f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,N,L,B,P,G,k,_,D,j,O,U,H,E,R,I=e[Y],x=e[Z],N=n[Y],L=n[Z],B=i[Y],P=i[Z],G=1===x,k=1===L;if(N===I&&L===x){for(g=I*x,f=O=j=D=_=0;f<I;f++)for(l=0;l<x;l++){if(d=o(e[f][l]),v=o(n[f][l]),t&&(z(d)||z(v)))return s;_+=d,D+=d*d,j+=v=F(v),O+=d*v}for(U=g*O-_*j,p=r?(j*D-_*O)/(g*D-_*_):0,(1<(H=(m=r?U/(g*D-_*_):O/D).toString()).indexOf("000000000000")||1<H.indexOf("999999999999"))&&(m=V.st.E8(m,12),p=V.st.E8(p,12)),b=[],f=0;f<B;f++)for(b[f]=[],l=0;l<P;l++){if(d=o(i[f][l]),t&&z(d))return s;b[f][l]=0==U?n[0][0]:c(V.st.tge(m*d,p))}return a?new a(b):b}if(k&&N===I||1===N&&L===x){for(d=[],v=[],T=x+1,A=x+2,f=0;f<I;f++){if(p=o(y=k?n[f][0]:n[0][f]),t&&z(p))return s;v[f]=G?F(p):p}for(f=0;f<I;f++)for(d[f]=[],l=0;l<x;l++){if(p=o(e[f][l]),t&&z(p))return s;d[f][l]=p}for(E=[],m=0;m<T;m++)for(E[m]=[],g=0;g<A;g++)E[m][g]=0;for(h=0;h<I;h++)for(E[0][T]+=v[h],f=0;f<x;f++)for(E[0][y=f+1]+=d[h][f],E[y][0]=E[0][y],E[y][T]+=d[h][f]*v[h],l=f;l<x;l++)E[C=l+1][y]+=d[h][f]*d[h][l],E[y][C]=E[C][y];for(E[0][0]=I,w=R=r?0:1;w<T;w++){if(t){if(0===E[w][w]){for(S=!1,l=w+1;!S&&l<T;l++)if(0!==E[l][w]){for(h=0;h<A;h++)C=E[w][h],E[w][h]=E[l][h],E[l][h]=C;S=!0}if(!S)return u}}else{for(f=w;f<T&&0===E[f][w];)f++;if(T<=f)return u;for(M=R;M<A;M++)y=E[w][M],E[w][M]=E[f][M],E[f][M]=y}for(y=1/E[w][w],M=R;M<A;M++)E[w][M]*=y;for(f=R;f<T;f++)if(f!==w)for(y=-E[f][w],M=0;M<A;M++)E[f][M]+=y*E[w][M];r||(E[0][T]=0)}for(b=[],k||(b[0]=[]),f=0;f<B;f++){for(k&&(b[f]=[]),y=E[0][T],l=0;l<x;l++){if(p=o(k?i[f][l]:i[l][f]),t&&z(p))return s;y+=E[l+1][T]*p}k?b[f][0]=c(y):b[0][f]=c(y)}return a?new a(b):b}return u}function i(t,n,e,i,r,o,a,u){return f(!0,t,n,e,i,r,o,u,a,c,c)}function r(t,n,e,i,r,o,a){for(var u,s,u=0;u<t[Y];u++)for(s=0;s<t[Z];s++)if(t[u][s]<=0)return o;return f(!1,t,n,e,i,c,r,a,null,Math.log,Math.exp)}Object.defineProperty(n,"__esModule",{value:!0}),n.iit=n.eit=void 0,V=e("./src/common/util/numberhelper.ts"),z=isNaN,Y="rowCount",Z="colCount",n.eit=i,n.iit=r},"./src/common/util/numberhelper.ts":function(F,t,n){var e,i,r,c,o,f,I,l,p,a,h,d,b,x,u,w,s,y,v,m,g,N,M,n,C,A,k,_,L,S,D,T;function B(t,n,e,i){return n&&0!==n.length&&"i"!==n?P(t,n,e.NumberFormat,i):e&&0<e.name.length?t.toLocaleString():t.toString()}function P(t,n,e,i){var r;return q(t,H(n),e,i)}function G(t,n){for(var e,i,t,r,n,o,a,r,o,a,e=u(w(t)),i={iUt:1,rUt:0};10<=e;)e/=10,i.iUt++;return r=(t=t.toString()).search(/e/gi),n=t.indexOf(n),-1!==r?(a=N(t,0,r),r=N(t,r+1),o=0,-1!==n&&(o=N(a,n+1).length),a=d(r),i.rUt=o=(o=o-a)<0?0:o):(o=0,-1!==n&&(o=N(t,n+1).length),i.rUt=o),i}function U(t){for(var n,e,i,n={oUt:t.charAt(0),aUt:0,tUt:0},e="",i=1;i<t.length;i++)if("+"===(e=t.charAt(i)))n.aUt=1;else{if("-"!==e){if("0"!==e)throw new Error(C().Exp_InvalidExponentFormat);n.tUt=t.length-i;break}n.aUt=-1}return n}function H(t){for(var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n={uUt:p,sUt:p,rCt:b,fxt:0,d0:0,cUt:0,fUt:p},e="",i=b,r=b,o=b,a=b,u=b,s=b,f=p,l=[],h=0;h<t.length;h++){if(c=t.charAt(h),i)e+=c,'"'===c&&(l.push(e),e="",i=b);else if(r){if("E"===f||"e"===f){if(!(0<=["+","-","0"].indexOf(c))){r=b,h--;continue}e+=c}else if("+"===f||"-"===f){if("0"!==c){r=b,h--;continue}e+=c}else if("0"===f){if("0"!==c){r=b,u||(u=x,n.fUt=U(e)),h--;continue}e+=c}}else if("*"!==f&&"_"!==f&&"\\"!==f||""===e)if("*"===c||"_"===c||"\\"===c)s=b,""!==e&&(l.push(e),e=""),e+=c;else if("'"===c)s=b,""!==e&&(l.push(e),e=""),l.push(c);else if('"'===c)s=b,i=x,""!==e&&(l.push(e),e=""),e+=c;else if(0<=S.indexOf(c))s=x,S.indexOf(f)<0&&""!==e&&(l.push(e),e=""),e+=c;else if("."!==c||o)if("%"===c)s=b,n.d0++,""!==e&&(l.push(e),e=""),l.push(c);else if("\u2030"===c)s=b,n.cUt++,""!==e&&(l.push(e),e=""),l.push(c);else if(","===c)if(s){for(d=void 0,""!==e&&(l.push(e),e=""),v=x,m="",g=h+1;g<t.length;g++)if(d=t.charAt(g),'"'===m)'"'===d&&(m="");else if("\\"===m||"_"===m)m="";else{if(0<=S.indexOf(d)){v=b;break}if("."===d||";"===d)break;m=d}v?n.fxt++:o||(d=t.charAt(h+1))&&0<=S.indexOf(d)&&(a=x)}else e+=c;else"E"===c||"e"===c?(s=b,r=x,""!==e&&(l.push(e),e="")):(s=b,0<=S.indexOf(f)&&""!==e&&(l.push(e),e="")),e+=c;else""!==e&&(l.push(e),e=""),n.uUt=l,l=[],o=x,s=b;else e+=c,l.push(e),e="";f=c}return""!==e&&(r&&!u&&(n.fUt=U(e)),l.push(e)),a&&(n.rCt=x),o?n.sUt=l:n.uUt=l,n}function V(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,r=n[0],o=1,a=0,u=b,s=t.length,c=0;c<s;c++)if("number"===(f=t[c].type)){for(l="",d=(h=t[c].value).length-1;0<=d;){if(!(1<=r&&r<=9||0===r&&o===n.length))throw new Error(C().Exp_InvalidNumberGroupSize);/\d/gi.test(h[d])?(u&&(l&&t.push({type:"number",value:l}),t.push({type:"groupSeparator",value:e}),l="",u=b),a++):a=0,l=h[d]+l,a===r&&0<r&&(u=x,a=0,o<n.length)&&(r=n[o],o++),d--}l&&t.push({type:f,value:l})}else"fillingChar"===f&&(i.infillIndex=t.length-s),t.push({type:f,value:t[c].value});t.splice(0,s)}function z(t,n,e,i,r,o){var a,a,u,s,u,a=nt(t,-n),a=(u=(a=(t=a=isFinite(a)?a:t).toString()).split(/e/i))[0],s=1<u.length?h(u[1],10):0;return a=(u=a.split("."))[0],u=1<u.length?u[1]:"",0<s?(a+=(u=l(u,s)).slice(0,s),u=N(u,s)):s<0&&(s=-s,u=(a=t<0?o+I(a.replace(o,""),1+s):I(a,1+s)).slice(-s,a.length)+u,a=a.slice(0,-s)),a+(u=0<n?r+(u=u.length>n?u.slice(0,n):l(u,n)):"")}function Y(t,n,e,i){var t=t;return 0<n&&(t=R(t*s(100,n),15)),0<e&&(t=R(t*s(1e3,e),15)),t=0<i?R(t/s(1e3,i),15):t}function Z(t){var n,e,i,n=p;if(t)for(n="",e=0;e<t.length;e++)i=t[e],/^(0|#|\?)+/g.test(i)&&(n+=i);return n}function j(t,n){return t===n||0!==t&&0!==n&&(w(t-n)<w(t)/T||(t=R(t,15),n=R(n,15),w(t-n)<w(t)/T))}function W(t,n){return j(t,-n)?0:t+n}function Q(t,n,e){var i,r,o,a,e,u,t,i={value:t,exponentValue:0},r,o=G(t,".").iUt,a=w(t),e=e?e.length:1;if(1<=a)e<o?(i.value=t/s(10,o-=e),i.exponentValue=o):i.exponentValue=0,-1===n.aUt&&(n.aUt=0);else if(a<1&&0<a){for(n.aUt=-1,u=s(10,e);10*a<u&&!j(10*a,u);)a*=10,i.exponentValue++;t=s(10,i.exponentValue),i.value*=v<t?0:t}return i}function J(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,u,v,m,g,p,b,w,y,M,C,S,T,A,s=u.numberGroupSizes,c=u.numberGroupSeparator,f=u.negativeSign,l=u.percentSymbol,h=u.perMilleSymbol,d=i.fUt,u=N(n,0,1);for(n=0===(v=1===(n=u===f?N(n,1):n).length&&"0"===n?0:n.length)?"":n,m=0,g="",p=t.length-1;0<=p;p--)if(b="",w=t[p],/^(0|#|\?)+/g.test(w)){if(g!==e){for(y=w.length,M=v-m-1;0<=M&&0<y;M--)b=(C=n.charAt(M))+b,y--,m++;for(S=y-1;0<=S;S--)m++,"0"===(T=w[S])?b=T+b:"?"===T&&(""!==b&&(o.push({type:"number",value:b}),b=""),o.push({type:"numberPlaceholder",value:T}));""!==(b=(g=w+g)===e&&m<v?n.substr(0,v-m)+b:b)&&o.push({type:"number",value:b})}}else i.fUt&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(w)?(a.replaceExponent=x,A="",A=(A=(A+=d.oUt)+_[d.aUt])+I(r.toString(),d.tUt),o.push({type:"exponent",value:A})):"_"===w[0]?o.push({type:"placeholder",value:w[1]}):"*"===w[0]?a.hasInfilling||(o.push({type:"fillingChar",value:w[1]}),a.hasInfilling=!0,a.infillIndex=o.length-1):"\\"===w[0]?2===w.length&&o.push({type:"text",value:w[1]}):'"'===w[0]&&'"'===w[w.length-1]?2<w.length&&o.push({type:"text",value:w.substr(1,w.length-2)}):w===l?o.push({type:"percent",value:w}):w===h?o.push({type:"permille",value:w}):D[w]?o.push({type:"currency",value:w}):o.push({type:"text",value:w});u===f&&e&&o.push({type:"text",value:u}),i.rCt===x&&V(o,s,c,a),o.reverse(),a.infillIndex=o.length-1-a.infillIndex}function K(t,n,e,i,r,o,a,u,s){var c,f,l,s,h,d,v,m,g,p,b,w,y,M,C,S,T,c=s.numberDecimalSeparator,f=s.percentSymbol,l=s.perMilleSymbol,s=n.indexOf(c),h=r.fUt;for((0<s||i!==A||e!==k)&&a.push({type:"decimalSeparator",value:c}),d=-1!==s?n.substring(s+1):"",m="",g=v=0;g<t.length;g++)if(p=t[g],/^(0|#|\?)+/g.test(p)){if(b="",m!==e){for(w=p.length,y=0,M=v;0<w&&0<d.length-v;)b+=d.charAt(M),w--,v++,y++,M++;for(C=y;0<w;)S=p[C],C++,v++,w--,"0"===S?b+=S:"?"===S&&(""!==b&&(a.push({type:"number",value:b}),b=""),a.push({type:"numberPlaceholder",value:S}));""!==b&&a.push({type:"number",value:b}),m+=p}}else h&&!u.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)?(u.replaceExponent=x,T="",T=(T=(T+=h.oUt)+_[h.aUt])+I(o.toString(),h.tUt),a.push({type:"exponent",value:T})):"_"===p[0]?a.push({type:"placeholder",value:p[1]}):"*"===p[0]?(a.push({type:"fillingChar",value:p[1]}),u.hasInfilling&&a.splice(u.infillIndex,1),u.hasInfilling=!0,u.infillIndex=a.length-1):"\\"===p[0]?2===p.length&&a.push({type:"text",value:p[1]}):'"'===p[0]&&'"'===p[p.length-1]?2<p.length&&a.push({type:"text",value:p.substr(1,p.length-2)}):p===f?a.push({type:"percent",value:p}):p===l?a.push({type:"permille",value:p}):D[p]?a.push({type:"currency",value:p}):a.push({type:"text",value:p})}function X(t,n){var e,i,e=t,i;return e=-1!==t.indexOf(n)?t.replace(/0+$/,""):e}function q(t,n,e,i){var r,o,a,u,s,c,c,f,l,h,d,v,m,t,f,l,g,r=[];return t=Y(t,n.d0,n.cUt,n.fxt),o=n.uUt,a=n.sUt,(o||a)&&(u=Z(o),s=(s=Z(a))||"",n.fUt&&(t=(c=Q(t,n.fUt,u)).value,c=c.exponentValue),f=G(t,"."),1<w(t)&&15<f.iUt+f.rUt&&(t=R(t,15)),l=e.numberGroupSizes,h=e.numberGroupSeparator,d=e.numberDecimalSeparator,v=e.negativeSign,t=z(t,m=y(f.rUt,s.length),l,h,d,v),""===(t=i?t:X(t,d))?r.push({type:"text",value:(o?o.join(""):"")+(a?a.join(""):"")}):(f={hasInfilling:b,infillIndex:-1,replaceExponent:b},"10"!==(l=t.split(d)[0])||isNaN(c)||(l="1",c+=(g=n&&n.fUt&&-1===n.fUt.aUt)?-1:1),o&&J(o,l,u,n,c,r,f,e),"0"!==l&&""===u&&a&&r.push({type:"number",value:l}),a&&K(a,t,s,u,n,c,r,f,e))),r}function $(t,n){var n,e,i,r,o,t,a,e,u,o,i,e,a,s,i,r,e;return(t=f(t)?"":c.zf.s6t(t,"")).match(/^[+-]?infinity$/i)?d(t):t.match(/^0x[a-f0-9]+$/i)?h(t,10):(r=(i=O(t,n=n.NumberFormat,e=n.numberNegativePattern))[0],o=i[1],""===r&&1!==e&&(r=(i=O(t,n,1))[0],o=i[1]),""===r&&(r="+"),t=(e=(e=(o=o[0]===n.currencySymbol?N(o,1):o).indexOf("e"))<0?o.indexOf("E"):e)<0?(a=o,p):(a=N(o,0,e),N(o,e+1)),o=(i=a.indexOf("."))<0?(u=a,p):(u=N(a,0,i),N(a,i+".".length)),u=u.split(",").join(""),a=r+(u=","!==(e=",".replace(/\u00A0/g," "))?u.split(e).join(""):u),o!==p&&(a+="."+o),(s=a[a.length-1])===n.percentSymbol&&(a=N(a,0,a.length-1),-1===(i=(a=c.zf.s6t(a,"")).indexOf("."))&&(i=a.length),r="",a=r=(r=(r=r+N(a,0,i-2)+".")+N(a,i-2,2))+N(a,i+1)),t!==p&&(""===(e=O(t,n,1))[0]&&(e[0]="+"),a+="e"+e[0]+e[1]),a.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?d(a):NaN)}function O(t,n,e){var i,n,i=n.negativeSign,n=n.positiveSign;if(4!==e&&2!==e||(i=" "+i,n=" "+n),4===e||3===e){if(c.zf.dT(t,i))return["-",N(t,0,t.length-i.length)];if(c.zf.dT(t,n))return["+",N(t,0,t.length-n.length)]}else if(2===e||1===e){if(c.zf.fJ(t,i))return["-",N(t,i.length)];if(c.zf.fJ(t,n))return["+",N(t,n.length)]}else{if(0!==e)throw new Error("");if(c.zf.fJ(t,"(")&&c.zf.dT(t,")"))return["-",N(t,1,t.length-2)]}return["",t]}function tt(t,n,e){if(0!==w(u(t)-t))throw new Error(C().Exp_BadFormatSpecifier);var t=(0<=t?t:L+t+1).toString(16),t=n?t.toLowerCase():t.toUpperCase();return!f(e)&&t.length<e?I(t,e):t}function nt(t,n){var e,i;return t=+t,n=+n,isNaN(t)||n%1!=0?NaN:(t=(e=t<0)?-t:t,typeof n===a||0===n?(t=Math.round(t),e?-t:t):(i=t.toString().split("e"),t=Math.round(+(i[0]+"e"+(i[1]?+i[1]-n:-n))),+((i=(t=e?-t:t).toString().split("e"))[0]+"e"+(i[1]?+i[1]+n:n))))}function E(t){var n=o.CultureManager.Fe().NumberFormat;return n="string"==typeof t?o.CultureManager.Fe(t).NumberFormat:n}function et(t){var n,e,i,r,n="";if(Array.isArray(t)&&0<t.length)for(e=0;e<t.length;e++)i=t[e].type,r=t[e].value,"placeholder"===i?n+=" ":"fillingChar"!==i&&(n+="numberPlaceholder"===i?" ":r);return n}function R(t,n){return t="number"==typeof t&&t.toString().length>=n?+t.toPrecision(n):t}Object.defineProperty(t,"__esModule",{value:!0}),t.st=void 0,e=n("./src/common/util/common.ts"),i=n("./src/common/util/types.ts"),r=n("./src/common/util/regexhelper.ts"),c=n("./src/common/util/stringhelper.ts"),o=n("./src/common/culture/cultureInfo.ts"),f=i.lt.ht,I=c.zf.B9t,l=c.zf.lUt,p=null,a=void 0,h=parseInt,d=parseFloat,x=!(b=!1),u=Math.floor,w=Math.abs,s=Math.pow,y=Math.min,v=Number.MAX_VALUE,m="#dot#",g="#group#",N=function(t,n,e){return t.substr(n,e)},M=function(t){return r.$T.qT(t)},n=new e.ResourceManager(e.SR),C=n.getResource.bind(n),A="##################0",k="################",_={1:"+",0:"","-1":"-"},L=4294967295,S=["0","#","?"],D={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"},T=Math.pow(2,48),t.st={yU:function(t){return $(t,o.CultureManager.Fe())},Z6t:function(t){return $(t,o.CultureManager.Fe("invariant"))},L9t:function(t,n,e,i){return B(t,n,e=e||o.CultureManager.Fe(),i)},Ge:function(t,n){var n,e,n;return t="string"==typeof t&&(e=(n=E(n)).numberDecimalSeparator,n=n.numberGroupSeparator,"."!==e&&(t=t.replace(M("[.]"),m)),","!==n&&(t=t.replace(M("[,]"),g)),"."!==e&&(t=t.replace(M(m),e)),","!==n)?t.replace(M(g),n):t},Jf:function(t,n){var n,e,n;return t="string"==typeof t&&(e=(n=E(n)).numberDecimalSeparator,n=n.numberGroupSeparator,"."!==e&&(t=t.replace(M("["+e+"]"),m)),","!==n&&(t=t.replace(M("["+n+"]"),g)),"."!==e&&(t=t.replace(M(m),".")),","!==n)?t.replace(M(g),","):t},hUt:function(t,n){var n,e,n;return!("string"==typeof t&&(e=(n=E(n)).numberDecimalSeparator,n=n.numberGroupSeparator,"."!==e&&"."!==n&&0<=t.indexOf(".")||","!==e&&","!==n&&0<=t.indexOf(",")))},dUt:function(t,n){return d(this.Jf(t,n))},VGt:tt,v0:H,vUt:q,ukt:j,tge:W,mUt:et,gUt:A,pUt:k,E8:R}},"./src/common/util/rbush.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.rbush=void 0;var o=Math.max,a=Math.min,h=Number.POSITIVE_INFINITY;function e(t,n){this.bUt=o(4,t||9),this.yUt=o(2,Math.ceil(.4*this.bUt)),n&&this.wUt(n),this.clear()}function f(t,n,e){if(!e)return n.indexOf(t);for(var i=0;i<n.length;i++)if(e(t,n[i]))return i;return-1}function u(t,n){l(t,0,t.children.length,n,t)}function l(t,n,e,i,r){(r=r||y(null)).minX=h,r.minY=h,r.maxX=-h,r.maxY=-h;for(var o=n,a=void 0;o<e;o++)a=t.children[o],d(r,t.leaf?i(a):a);return r}function d(t,n){t.minX=a(t.minX,n.minX),t.minY=a(t.minY,n.minY),t.maxX=o(t.maxX,n.maxX),t.maxY=o(t.maxY,n.maxY)}function s(t,n){return t.minX-n.minX}function c(t,n){return t.minY-n.minY}function v(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function m(t){return t.maxX-t.minX+(t.maxY-t.minY)}function g(t,n){return(o(n.maxX,t.maxX)-a(n.minX,t.minX))*(o(n.maxY,t.maxY)-a(n.minY,t.minY))}function p(t,n){var e=o(t.minX,n.minX),i=o(t.minY,n.minY),r=a(t.maxX,n.maxX),t=a(t.maxY,n.maxY);return o(0,r-e)*o(0,t-i)}function b(t,n){return t.minX<=n.minX&&t.minY<=n.minY&&(0<=n.maxX&&n.maxX<=t.maxX||t.minX<0)&&(0<=n.maxY&&n.maxY<=t.maxY||t.minY<0)}function w(t,n){return(-1===t.minY||-1===n.minY||t.minY<=n.maxY&&n.minY<=t.maxY)&&(-1===t.minX||-1===n.minX||t.minX<=n.maxX&&n.minX<=t.maxX)}function y(t){return{children:t,height:1,leaf:!0,minX:h,minY:h,maxX:-h,maxY:-h}}(n.rbush=e).prototype={all:function(){return this.QP(this.data,[])},search:function(t){var n,e,i,r,o,a,u,s,n=this.data,e=[],i=this.toBBox;if(w(t,n))for(r=[];n;){for(o=0,a=n.children.length;o<a;o++)u=n.children[o],w(t,s=n.leaf?i(u):u)&&(n.leaf?e.push(u):b(t,s)?this.QP(u,e):r.push(u));n=r.pop()}return e},collides:function(t){var n,e,i,r,o,a,u,n=this.data,e=this.toBBox;if(w(t,n))for(i=[];n;){for(r=0,o=n.children.length;r<o;r++)if(a=n.children[r],w(t,u=n.leaf?e(a):a)){if(n.leaf||b(t,u))return!0;i.push(a)}n=i.pop()}return!1},insert:function(t){return t&&this.Eit(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,n){if(t)for(var e=this.data,i=this.toBBox(t),r=[],o=[],a,u,s,c;e||r.length;){if(e||(e=r.pop(),u=r[r.length-1],a=o.pop(),c=!0),e.leaf&&-1!==(s=f(t,e.children,n)))return e.children.splice(s,1),r.push(e),this.MUt(r),this;c||e.leaf||!b(e,i)?u?(a++,e=u.children[a],c=!1):e=null:(r.push(e),o.push(a),e=(u=e).children[a=0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},QP:function(t,n){for(var e=[];t;)t.leaf?n.push.apply(n,t.children):e.push.apply(e,t.children),t=e.pop();return n},CUt:function(t,n,e,i){for(var r,o,a,u,s,c,f,l;i.push(n),!n.leaf&&i.length-1!==e;){for(f=l=h,r=0,o=n.children.length;r<o;r++)s=v(a=n.children[r]),(c=g(t,a)-s)<l?(l=c,f=s<f?s:f,u=a):c===l&&s<f&&(f=s,u=a);n=u||n.children[0]}return n},Eit:function(t,n,e){var i,e,r,i,i=this.toBBox,e=e?t:i(t),r=[],i=this.CUt(e,this.data,n,r);for(i.children.push(t),d(i,e);0<=n&&r[n].children.length>this.bUt;)this.SUt(r,n),n--;this.TUt(e,r,n)},SUt:function(t,n){var e,i,r,r,i,e=t[n],i=e.children.length,r=this.yUt;this.AUt(e,r,i),r=this.IUt(e,r,i),(i=y(e.children.splice(r,e.children.length-r))).height=e.height,i.leaf=e.leaf,u(e,this.toBBox),u(i,this.toBBox),n?t[n-1].children.push(i):this.xUt(e,i)},xUt:function(t,n){this.data=y([t,n]),this.data.height=t.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},IUt:function(t,n,e){for(var i,r,o,a,r,u,s,c,u=s=h,i=n;i<=e-n;i++)a=p(r=l(t,0,i,this.toBBox),o=l(t,i,e,this.toBBox)),r=v(r)+v(o),a<u?(u=a,c=i,s=r<s?r:s):a===u&&r<s&&(s=r,c=i);return c},AUt:function(t,n,e){var i=t.leaf?this.compareMinX:s,r=t.leaf?this.compareMinY:c,o,a;this.NUt(t,n,e,i)<this.NUt(t,n,e,r)&&t.children.sort(i)},NUt:function(t,n,e,i){t.children.sort(i);for(var r=this.toBBox,o=l(t,0,n,r),a=l(t,e-n,e,r),u=m(o)+m(a),s,c,s=n;s<e-n;s++)c=t.children[s],d(o,t.leaf?r(c):c),u+=m(o);for(s=e-n-1;n<=s;s--)c=t.children[s],d(a,t.leaf?r(c):c),u+=m(a);return u},TUt:function(t,n,e){for(var i=e;0<=i;i--)d(n[i],t)},MUt:function(t){for(var n=t.length-1,e=void 0;0<=n;n--)0===t[n].children.length?0<n?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():u(t[n],this.toBBox)},wUt:function(t){var n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(t[0])),this.compareMinY=new Function("a","b",n.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},"./src/common/util/regexhelper.ts":function(t,n,e){var r,i,o,a;function c(){}Object.defineProperty(n,"__esModule",{value:!0}),n.$T=void 0,r=e("./src/common/util/stringhelper.ts"),i=!0,o="empty",c.bue=function(t,n){var e;if(n&&c.yue[n]&&c.yue[n][t])e=c.yue[n][t];else try{null==n?(e=new RegExp(t),n=o):e=new RegExp(t,n),c.yue[n]||(c.yue[n]={}),c.yue[n][t]=e}catch(t){return null}return e.lastIndex=0,e},c.qT=function(t){var n=c.kUt[t],n;return(n=n||(c.kUt[t]=new RegExp(t,"g"))).lastIndex=0,n},c.OJ=function(t){var n=c.DUt[t],n;return(n=n||(c.DUt[t]=new RegExp(t,"gi"))).lastIndex=0,n},c.jJ=function(t,n,e){var i,r,o,a,u,s;if(c._Ut[t])return c.EUt[t];if(c.qT(i="[~?*]+").test(t)){for(r=[],o=t.split(""),u={".":!(a=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0,"\\":!0},s=0;s<o.length;s++)"~"===(a=o[s])&&s<o.length-1?("*"===(a=o[++s])||"?"===a?r.push("\\"):n&&r.push("~"),r.push(a)):"?"===a?r.push("."):"*"===a?(r.push("[\\s\\S]"),r.push(e?"+":"*")):(u[a]&&r.push("\\"),r.push(a));return r.join("")}return null},c.tbt=function(t,n,e){var t=c.jJ(t,n,e),t;return t=t&&"^"+t+"$"},c.jUt=function(t,n){for(var e,i,e="#"+t+"0#",i=1;0<n.indexOf(e);)e=r.zf.qS(e,"#"+t+(i-1)+"#","#"+t+i+"#"),i++;return e},c.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},c.kUt={},c.DUt={},c.yue={},c._Ut={},c.EUt={},n.$T=c},"./src/common/util/stringhelper.ts":function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.zf=void 0;var o=n("./src/common/util/regexhelper.ts");function a(t,n,e){return t.substr(n,e)}function u(t){return null==t}function i(t,n,e,i){var r,n;if(u(n))throw new Error;return""===n||!(n.length>t.length)&&(r=t,n=n,e&&(r=t.toLowerCase(),n=n.toLowerCase()),i(r,n))}r.zf={OS:function(t,n,e){return e&&(t=t.toLowerCase(),n=n.toLowerCase()),""===n||0<=t.indexOf(n)},hD:function(t,n,e){var e,i;return e?(e=t.toLowerCase(),i=n.toLowerCase(),e.indexOf(i)):t.indexOf(n)},cJ:function(t,n){if(!n)return t;for(var e=t;a(e,0,n.length)===n;)e=a(e,n.length);return e},s6t:function(t,n){if(!n)return t;for(var e=t;a(e,e.length-n.length,n.length)===n;)e=a(e,0,e.length-n.length);return e},Eit:function(t,n,e){var i,r;if(n<0||n>t.length||u(e))throw new Error;return(i=a(t,0,n))+e+(r=a(t,n,t.length-n))},VP:function(t,n,e){var i,r;if(u(e)&&(e=t.length-n),n<0||e<0||n+e>t.length)throw new Error;return(i=a(t,0,n))+(r=a(t,n+e,t.length-n-e))},fJ:function(t,n,e){return i(t,n,e=void 0===e?!1:e,function(t,n){return t.slice(0,n.length)===n})},dT:function(t,n,e){return i(t,n,e=void 0===e?!1:e,function(t,n){return t.slice(-n.length)===n})},Vi:function(t,n,e,i){if(n)return e=(""+e).replace(/\$/g,"$$$$"),t.replace(new RegExp(n,"g"+(i?"i":"")),e);throw new Error},OUt:function(t,n,e,i){return n=o.$T.D9t(n),r.zf.Vi(t,n,e,i)},gmt:function(t,n){var n=t.indexOf(n);return n<0||n>=t.length?t:a(t,0,n)},DU:function(t,n){for(var e=0,i=t.indexOf(n);0<=i;)e+=1,i=t.indexOf(n,i+1);return e},qS:function(t,n,e){return t.split(n).join(e)},I5:function(t,n){for(var e,i,r,e=t,i=0;i<n.length;i++)r=new RegExp("\\{"+i+"\\}","g"),e=e.replace(r,n[i]);return e},RUt:function(t,n,e){for(var i,r,i=t.toString(),r=i.length;r<n;r++)i=e?"0"+i:i+"0";return i},B9t:function(t,n){return r.zf.RUt(t,n,!0)},lUt:function(t,n){return r.zf.RUt(t,n,!1)},Dbt:function(t,n){return t===n||!t&&!n||t&&n&&t.toLowerCase()===n.toLowerCase()},Gmt:function(t){return t.toUpperCase()},j0:function(t){var n,e,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e=o.$T.qT("(?:&|<|>|\"|'|`)");return e.test(t)?t.replace(e,function(t){return n[t]}):t},dI:function(t){var n,e,n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},e=o.$T.qT("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return e.test(t)?t.replace(e,function(t){return n[t]}):t},TY:function(t){for(var n,e,n=t,e=/javascript:/gi;n.match(e);)n=n.replace(e,"");return n}}},"./src/common/util/types.ts":function(t,l){Object.defineProperty(l,"__esModule",{value:!0}),l.lt=void 0,l.lt={BUt:null,y0:function(t,n){var e,i,r,o;if(l.lt.Gh(t))for(i=0,r=t.length;i<r&&!1!==(e=n.call(t[i],i,t[i]));i++);else for(o in t)if(t.hasOwnProperty(o)&&!1===(e=n.call(t[o],o,t[o])))break;return t},_h:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Eh:function(t){return"function"===l.lt.Oh(t)},Nh:function(t){return Array.isArray?Array.isArray(t):"array"===l.lt.Oh(t)},jh:function(t){return l.lt.OMt(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},OMt:function(t){return"string"==typeof t},Oh:function(t){var n,e,i,r,o,a;if(null===t)return"null";if(!(n=l.lt.BUt))for(n=l.lt.BUt={},i=0,r=(e=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;i<r;i++)n["[object "+e[i]+"]"]=e[i].toLowerCase();return o=n.toString,"object"==(a=typeof t)||"function"==a?n[o.call(t)]||"object":a},Rh:function(t,n,e){var i,r;if(n){if(r=[].indexOf)return r.call(n,t,e);for(i=n.length,e=(e=l.lt.ht(e)?0:e)<0?Math.max(0,i+e):e;e<i;e++)if(e in n&&n[e]===t)return e}return-1},Bh:function(t,n){var e=n.length,i=t.length,r=0;if("number"==typeof e)for(;r<e;r++)t[i]=n[r],i++;else for(;void 0!==n[r];)t[i]=n[r],i++,r++;return t.length=i,t},Lh:function(t,n,e){var i,r,o,a,u,r=[];if(l.lt.Gh(t))for(o=0,a=t.length;o<a;o++)null!==(i=n(t[o],o,e))&&(r[r.length]=i);else for(u in u=void 0,t)t.hasOwnProperty(u)&&null!==(i=n(t[u],u,e))&&(r[r.length]=i);return r.concat([])},Dh:function(){for(var t,n,e,i,r,o,a,i,u,s,c,f,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(c=t.length,f=!(s=1),"boolean"==typeof(u=t[0]||{})&&(f=u,u=t[1]||{},s=2),"object"==typeof u||l.lt.Eh(u)||(u={}),c===s&&(u=this,--s);s<c;s++)if(!l.lt.ht(a=t[s]))for(o in a)e=u[o],u!==(r=a[o])&&(i=l.lt.Nh(r),f&&r&&(l.lt.Ph(r)||i)?(i=i?e&&l.lt.Nh(e)?e:[]:e&&l.lt.Ph(e)?e:{},u[o]=l.lt.Dh(f,i,r)):void 0!==r&&(u[o]=r));return u},Fh:function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);function i(){this.constructor=t}i.prototype=n.prototype,t.prototype=new i},Uh:function(t){return null!==t&&t===t.window},Ph:function(t){var n,e;if(!t||"object"!==l.lt.Oh(t)||t.nodeType||l.lt.Uh(t))return!1;n={}.hasOwnProperty;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(e in t);return void 0===e||n.call(t,e)},Gh:function(t){var n,e;return!l.lt.ht(t)&&(n=t.length,e=l.lt.Oh(t),!l.lt.Uh(t))&&(!(1!==t.nodeType||!n)||"array"===e||"function"!==e&&(0===n||"number"==typeof n&&0<n&&n-1 in t))},Hh:function(t,n){var n=n||[];return null!==t&&(l.lt.Gh(Object(t))?l.lt.Bh(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n},dt:null,ht:function(t){return null==t},q8:null,uJ:null,tv:function(t,n){if(void 0===n&&(n=!0),!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||l.lt.ht(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,i,r,e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(i in t)t.hasOwnProperty(i)&&(r=t[i],t.hasOwnProperty(i))&&e[i]!==r&&(e[i]="object"==typeof r?l.lt.tv(r):r);return n&&(e.toString=t.toString,e.valueOf=t.valueOf),e}}},"./src/common/util/util.res.en.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_Separator=n.Exp_InvalidCast=n.Exp_InvalidNumberFormat=n.Exp_BadFormatSpecifier=n.Exp_InvalidNumberGroupSize=n.Exp_InvalidSemicolons=n.Exp_InvalidExponentFormat=n.Exp_InvalidDateFormat=void 0,n.Exp_InvalidDateFormat="Invalid date format pattern",n.Exp_InvalidExponentFormat="invalid exponent format",n.Exp_InvalidSemicolons="invalid format : too many semicolons",n.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",n.Exp_BadFormatSpecifier="Bad Format Specifier",n.Exp_InvalidNumberFormat="Invalid number format pattern",n.Exp_InvalidCast="InvalidCastException",n.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in culture info."},"./src/plugins/commands/commands.entry.ts":function(t,n,e){var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.UndoManager=n.CommandManager=n.Key=void 0,i=e("./src/plugins/commands/commands.ts"),Object.defineProperty(n,"Key",{enumerable:!0,get:function(){return i.Key}}),Object.defineProperty(n,"CommandManager",{enumerable:!0,get:function(){return i.CommandManager}}),r=e("./src/plugins/commands/undomanager.ts"),Object.defineProperty(n,"UndoManager",{enumerable:!0,get:function(){return r.UndoManager}})},"./src/plugins/commands/commands.ts":function(t,n){var a,s,e,i;function r(t,n,e){var i,r;this.jS=t,this.LUt=n,this.Zc=e,i=this,Object.defineProperty(i,"shortcutKey",{get:function(){return i.FUt},set:function(t){var n,n,e,n=i.FUt;n!==t&&((n=(r=i.jS.PUt)[n])&&0<=(e=n.indexOf(i))&&n.splice(e,1),i.FUt=t)&&((n=r[t])||(r[t]=n=[]),n.splice(0,0,i))}})}function o(t){this.DJ=t,this.aT={},this.GUt={},this.PUt={}}Object.defineProperty(n,"__esModule",{value:!0}),n.CommandManager=n.Key=void 0,(i=a=n.Key||(n.Key={}))[i.left=37]="left",i[i.right=39]="right",i[i.up=38]="up",i[i.down=40]="down",i[i.tab=9]="tab",i[i.enter=13]="enter",i[i.shift=16]="shift",i[i.ctrl=17]="ctrl",i[i.space=32]="space",i[i.altkey=18]="altkey",i[i.home=36]="home",i[i.end=35]="end",i[i.pup=33]="pup",i[i.pdn=34]="pdn",i[i.backspace=8]="backspace",i[i.del=46]="del",i[i.esc=27]="esc",i[i.a=65]="a",i[i.c=67]="c",i[i.v=86]="v",i[i.x=88]="x",i[i.z=90]="z",i[i.y=89]="y",r.prototype.canUndo=function(){var t;return this.LUt.canUndo},r.prototype.execute=function(t,n,e){var i,r,o,a,i=this,o=!0;i.LUt&&n&&i.LUt.canUndo&&i.jS.UUt({command:n,result:r,vM:e,actionType:e});try{o=!1!==(r=(a=i.LUt.execute||i.LUt)(t,n,1===e))}catch(t){o=!1}return n&&o&&i.jS.HUt({command:n,result:r,vM:e,actionType:e}),r},s=r,o.prototype.register=function(t,n,e,i,r,o,a){var u,n,u=this,n=new s(u,n,t);u[t]=n,e&&(n.shortcutKey=u.getShortcutKey(e,i,r,o,a))},o.prototype.getCommand=function(t){return this[t]},o.prototype.execute=function(t){var n=this[t.cmd];if(n)return n.execute(this.DJ,t,0)},o.prototype.setShortcutKey=function(t,n,e,i,r,o){var a,t,t,u,s,a=this;if(t)(t=a[t])&&(t.shortcutKey=a.getShortcutKey(n,e,i,r,o));else if(t=a.getShortcutKey(n,e,i,r,o),u=a.getCommands(t))for(s=u.length-1;0<=s;s--)u[s].shortcutKey=void 0},o.prototype.getShortcutKey=function(t,n,e,i,r){var o,o;if(t)return(o=(o="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):a[t])||t)+(n?"+ctrl":"")+(e?"+shift":"")+(i?"+alt":"")+(r?"+window":"")},o.prototype.getCommands=function(t){return this.PUt[t]},o.prototype.addListener=function(t,n){this.aT[t]=n},o.prototype.removeListener=function(t){delete this.aT[t]},o.prototype.HUt=function(t){var n,e,n=this.aT;for(e in n)n.hasOwnProperty(e)&&n[e](t)},o.prototype.cM=function(t,n){this.GUt[t]=n},o.prototype.zUt=function(t){delete this.GUt[t]},o.prototype.UUt=function(t){var n,e,n=this.GUt;for(e in n)n.hasOwnProperty(e)&&n[e](t)},o.prototype.L0=function(){this.DJ=null},n.CommandManager=o},"./src/plugins/commands/undomanager.ts":function(t,n){var e;function i(t,n,e){var i=this;i.DJ=t,i.VUt=n=n<0?2147483647:n,i.Hw=e,i.Nmt=[],i.kmt=[],i.YUt=!1}Object.defineProperty(n,"__esModule",{value:!0}),n.UndoManager=void 0,i.prototype.dM=function(t,n){var e,i,r,o,e=this;if(t){if(1===n)e.kmt.push(t);else{if(i=e.VUt,r=e.Nmt.length,0<i&&i<=r)for(o=0;o<r-i+1;o++)e.Nmt.shift();e.Nmt.push(t),0===n&&(e.kmt=[])}e.YUt=!0}},i.prototype.canUndo=function(){return 0<this.Nmt.length},i.prototype.undo=function(){var t,n,e,i,r,t=this,n=t.Nmt,e=!0;if(t.Hw&&t.canUndo()){i=n[n.length-1];try{(r=t.DJ.commandManager()[i.cmd])&&(i.hM=!0,e=r.execute(t.DJ,i,1))}catch(t){e=!1}delete i.hM,!1!==e&&(n.pop(),t.YUt=!0,t.kmt.push(i))}return e},i.prototype.canRedo=function(){return 0<this.kmt.length},i.prototype.redo=function(){var t,n,e,i,r,t=this,n=t.kmt,e=!0;if(t.Hw&&t.canRedo()){i=n[n.length-1];try{(r=t.DJ.commandManager()[i.cmd])&&(i.hM=!0,e=r.execute(t.DJ,i,2))}catch(t){e=!1}delete i.hM,!1!==e&&(n.pop(),t.YUt=!0,t.Nmt.push(i))}return e},i.prototype.getRedoStack=function(){return this.kmt.slice()},i.prototype.getUndoStack=function(){return this.Nmt.slice()},i.prototype.maxSize=function(t){var n=this;return arguments.length<1?n.VUt:(0<=t&&(n.VUt=t),n)},i.prototype.clear=function(){this.Nmt=[],this.kmt=[]},i.prototype.aL=function(t){this.Nmt=this.Nmt.filter(t),this.kmt=this.kmt.filter(t)},i.prototype.L0=function(){this.DJ=null},i.prototype.setNewChangeStatus=function(t){this.YUt=t},i.prototype.getNewChangeStatus=function(){return this.YUt},n.UndoManager=i},"./src/plugins/formatter/formatter.entry.ts":function(t,n,e){var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/plugins/formatter/formatter.ts"),n)},"./src/plugins/formatter/formatter.res.en.ts":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_InvalidCast=n.Exp_ValueIllegal=n.Exp_TokenIllegal=n.Exp_DuplicatedDescriptor=n.Exp_ValueIsNull=n.Exp_FormatIllegal=n.Exp_InvalidBackslash=n.Exp_TokenIsNull=void 0,n.Exp_TokenIsNull="token is null",n.Exp_InvalidBackslash="the '\\' cannot be evaluated",n.Exp_FormatIllegal="format is illegal.",n.Exp_ValueIsNull="value is null",n.Exp_DuplicatedDescriptor="The type of descriptor was added.",n.Exp_TokenIllegal="token is illegal.",n.Exp_ValueIllegal="value is illegal.",n.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(g,t,n){var L,b,p,w,B,y,e,n,n,c,s,M,C,S,h,P,G,U,l,H,V,z,Y,Z,T,W,f,Q,J,K,X,d,A,I,u,x,v,q,N,m,k,$,tt,nt,et,e,it,rt,ot,at,ut,st,ct,ft,lt,ht,dt,vt,mt;function i(t,n){var n,t,e,i;if(_t.call(this,n),(n=this).Jq=t,e=E((t=n.Jq)[0],s,!1),i=t.indexOf("-"),!(e&&-1<i))throw new Error(c().Exp_TokenIllegal);n.ZUt=O(t,1,i-1),0<(t=b.zf.VP(t,0,i+1)).length&&(n.Iat=parseInt(t,16))}function r(t,n){this.formatCached=t,this.cultureName=n,this.typeName=""}function gt(t,n){var i,e,r,o,a,u,s,r;for(_t.call(this,n),i=this,u=0,s=(a=["<=","<>",">=",">","<","="]).length;u<s;u++)if(b.zf.fJ(t,e=a[u],!0)){r=b.zf.VP(t,0,e.length),r=parseFloat(r),A(r)||(o=r);break}if(o===M&&o===C)throw new Error(c().Exp_TokenIllegal);i.value=o,i.WUt=e,i.isMeetCondition=function(t){var n=i.WUt,e=i.value;switch(n){case"<=":return t<=e;case"<>":return t!==e;case">=":return e<=t;case">":return e<t;case"<":return t<e;case"=":return t===e}}}function _(t,n){_t.call(this,n);var n=this;if(n.token=t,n.type=parseInt(b.zf.VP(t,0,"dbnum".length),10),n.type<0||4<n.type)throw new Error(c().Exp_TokenIllegal)}function D(t,n,e,i,r,o){kt.call(this,n,e,i,o);var n=this;n.pU=n.QUt(It(t)),n.KUt=r,n.JUt=2,n.Hc()}function pt(t,n){var n,t,e;if(_t.call(this,n),n=this,"h"===(t=v(t)[0]))e=3600;else if("m"===t)e=60;else{if("s"!==t)throw new Error(c().Exp_TokenIllegal);e=1}n.XUt=function(t){var t=t/1e3/e;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}}function bt(t,n){var n,n;_t.call(this,n),null!==(n=Z.exec(t))&&(n=Number(n[1]),0<=--n)&&n<Y.length&&(t=Y[n]),this.foreColor=t}function j(t,n,e,i){var e,i,r,t,n,t;function o(t,n){var e,i,r,o,a,u,s,e=[],i='"';if(t!==M&&""!==t){for(r=!1,a=!(o=[]),u=0;u<t.length;u++)'"'!==(s=t[u])||r||(a=!a),r||a||s!==n?o.push(s):(e.push(o.join("")),o=[]),r="\\"===s&&!r;e.push(o.join(""))}return e}kt.call(this,n,e,i),(e=this).qUt=!1,e.JUt=1,e.$Ut=Ct(t),i=It(t),-1<(r=(i=Ct(i=n?Tt(i,e.j9t.Nat,e.j9t.currencySymbol()):i)).indexOf("/"))&&(t=o(i,"/"))&&2===t.length&&(e.tHt=t[1],n=t[0])&&(-1<(t=n.lastIndexOf(" "))?(e.nHt=O(n,0,t),e.eHt=O(n,t+1,n.length-t-1)):e.eHt=n),e.iHt=i}function o(t,n,e,i){kt.call(this,n,e,i),0<arguments.length?(o.rHt(t)||N(),this.$Ut=t):this.$Ut="General",this.JUt=0}function a(t,n,e,i){var r,e,r=this;kt.call(r,n,e,i),e=It(t,!1),e=At(e=Ct(e=n?Tt(e,r.j9t.Nat,r.j9t.currencySymbol()):e)),r.pU=e,r.JUt=3}function O(t,n,e){return t.substr(n,e)}function wt(t){return w.lt.ht(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:t.toString()}function yt(t,n){if("\\"===t[n])throw new Error(c().Exp_InvalidBackslash);if(0<n-1&&n-1<t.length&&"\\"===t[n-1]){if(n-2<0)return 1;if(0<n-2&&n-2<t.length)return"\\"!==t[n-2]}}function Mt(t){if(t)return"["+t+"]";throw new Error(c().Exp_TokenIsNull)}function Ct(t){var n,e,i,r,o;if(t===C||t===M||""===t)return t;for(n="",i=!1,r=e=0;r<t.length;r++)'"'===(o=t[r])?(i=!i,n+=o):i?n+=o:"["===o?e++:"]"===o?--e<0&&(e=0):0===e&&(n+=o);return n.toString()}function St(t){return t=Tt(t,"[",""),Tt(t,"]","")}function Tt(t,n,e){return!t||t===k.oHt||E(n,e,!0)?t:(n=n.replace(V,"\\$1"),t.replace(new RegExp(n,"g"),e))}function At(t){for(var n,e,i,r,o,n=t.length,e=!1,i="",r=0;r<n;r++)"\\"===(o=t.charAt(r))?(e=!e)&&"@"!==t.charAt(r+1)||(i+=o):(e=!1,i+=o);return i}function E(t,n,e){return e?v(t)===v(n):t===n}function It(t,n){var e,i,r,o;for(1===arguments.length&&(n=!0),e=!1,i="",r=0;r<t.length;r++){if('"'===(o=t[r]))e=!e;else if(!e&&!n&&"/"===o&&!yt(t,r))continue;i+=o}return i}function xt(t){for(var n,e,i,r,o,n="",e=!1,i=0,r=t.length;i<r;i++)'"'===(o=t[i])&&(e=!e),"E"===o||e||(n+=v(o));return n}function Nt(t,n){var e,i,r,o;if(t&&t!==k.oHt)for(i=xt(e=It(t)),r=0;r<n.length;r++)if(0===(o=i.indexOf(n[r]))||0<o&&"_"!==i[o-1]&&"*"!==i[o-1])return!0;return!1}function kt(t,n,e,i){this.j9t=t,this.aHt=n,this.cultureName=e,this.O9t=i}function _t(t){this.Nat=t}function Dt(t){var n,t,e,t=St(t);return t&&t!==k.oHt&&(e=t[0],-1<["<",">","="].indexOf(e)?(n=it).Name="ConditionalFormatPart":b.zf.fJ(t,"DBNum",!0)?(n=rt).Name="DBNumberFormatPart":E(t[0],s,!1)&&-1<t.indexOf("-")?(n=et).Name="LocaleIDFormatPart":Ot(t)?(n=at).Name="ABSTimeFormatPart":t.indexOf(s)<0&&3<=t.length&&((n=ut).Name="ColorFormatPart")),n}function jt(t,n){var e,t,e=!1,t=Nt(t=t?t.toString():k.oHt,["general"])?ct:ot.a0(t)?ot:Nt(t,["E+","E-","#",".",",","%","0","/","?"])||n?(e=!0,st):(e=!0,ft);return{uHt:e,uit:t}}function Ot(t){var n,e,i,n=v(t),e=n[0];if("h"===e||"m"===e||"s"===e){for(i=1;i<n.length;i++)if(e!==n[i])return;return 1}}function Et(t,n,e){var t,e,t=t?t.cultureInfo():I(e);return(n<4||4===n&&("ko-kr"===e||"ko-kr"===t.name()))&&(e=t.NumberFormat.dbNumber)?e[n]:M}function Rt(t,n,e,i,r){var o,e,o=t;if(!d(i)&&n instanceof Date){if(!(e=Et(e,i.type,r)))return t;o=i.sHt(o,e,!0),o=(o=(o=1===i.type?o.replace(new RegExp(G,"g"),U):o).replace("@"+h.cHt,p.ct.Pe(n,h.cHt))).replace("@"+h.fHt,p.ct.Pe(n,h.fHt)),o=i.sHt(o,e,!1)}return o}function Ft(t,n,e,i,r){var o,a,u,s,c,f,l;if(!d(i)&&(o=Et(e,i.type,r),!d(o)))for(a=!1,u=void 0,s=I(r),c=void 0,f=0,l=t.length;f<l;f++)"decimalSeparator"===t[f].type&&(a=!0,t[f].value=i.sHt(t[f].value,o,n),u=t[f].value),"number"===t[f].type&&(t[f].value=a?i.sHt(u+t[f].value,o,n).slice(1):i.sHt(t[f].value,o,n),"ja-JP"===s.name())&&1<t[f].value.length&&("\u4e00\u5343"!==(c=t[f].value.substr(0,2))&&"\u4e00\u767e"!==c&&"\u4e00\u5341"!==c||(t[f].value=t[f].value.substr(1)));return t}function R(t,n){var e=this;0===arguments.length?(e.formatCached="General",e.E9t=new ct):e.Hc(t,n)}function F(t,n){var e,i,e=mt.call(this,t,n)||this,i=e;return i.lHt=!0,i.PropertyChanged=[],k.Ji(t)&&(t="General"),i.formatCached=t,i.cultureName=n,i.init(),e}function Lt(t){for(var n,e,i,r,o,n=[],e=0,i=0,r=t.length,o=0;o<r;o++)"_"===t[o]?e++:(";"!==t[o]||0!==e&&e%2!=0||(n.push(t.substring(i,o)),i=o+1),e=0);return i<=r&&n.push(t.substring(i,r)),n}function Bt(r){for(var o,t,n,e,a,u,i,s,c,o=[],t=!1,n=!1,e="",a=function(t,n){return{type:t,content:n}},u=function(t){return!d(t)&&-1!=="yYdDhHmMsSeE".indexOf(t)},i=function(t,n){if(u(t)){for(var e=t,i=r[n+1];u(i)&&i.toLowerCase()===t.toLowerCase()&&(e+=i,n<r.length-1);)i=r[++n+1];o.push(a("symbolic",e))}else"a"===t&&"aaa"===r.slice(n,n+3).toLowerCase()?(o.push(a("symbolic",r.slice(n,n+3))),n+=2):o.push(a("text",t));return n},s=0;s<r.length;s++)if(c=r[s],t)o.push(a("text","\\"+c)),t=!1;else if(n&&'"'!==c)e+=c;else switch(c){case"\\":t=!0;break;case'"':n&&(o.push(a("text",'"'+e+'"')),e=""),n=!n;break;default:s=i(c,s)}return o}L=this&&this.__extends||(vt=function(t,n){return(vt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}vt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralFormatter=t.Hf=t.FormatterBase=void 0,b=n("./src/common/util/stringhelper.ts"),p=n("./src/common/util/datetimehelper.ts"),w=n("./src/common/util/types.ts"),B=n("./src/common/util/numberhelper.ts"),y=n("./src/common/culture/cultureInfo.ts"),e=n("./src/common/util/common.ts"),n=n("./src/plugins/formatter/formatter.res.en.ts"),w.lt.Dh(e.SR.en,n),n=new e.ResourceManager(e.SR),c=n.getResource.bind(n),s="$",w.lt.dt=function(t,n){if(w.lt.ht(t))return"null"===n;if(n){if(n instanceof Function&&t instanceof n)return!0;if(typeof t===n)return!0;if("function"===n&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===n.toLowerCase())return!0;if("DateTime"===n)return t instanceof Date;var t;if("TimeSpan"===n)return t instanceof Date&&0<=(t=p.ct.o0(t))&&t<1;"string"==typeof n&&"undefined number boolean string".indexOf(n)}return!1},w.lt.q8=function(t,n){return!!B.st.hUt(t,n)&&("string"!=typeof t||-1===t.search(/[\r\n\t]/g))&&(t=B.st.Jf(t,n),w.lt.dt(t,"number")||w.lt.dt(t,"DateTime")||w.lt.dt(t,"TimeSpan")||t&&!w.lt.dt(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(2<=t.length&&"0"===t[0]&&"x"===t[1]))},w.lt.uJ=function(t){return w.lt.ht(t)||""===t?0:w.lt.dt(t,"number")?t:w.lt.dt(t,"string")&&!isNaN(t)?B.st.yU(t):w.lt.dt(t,"boolean")?t?1:0:w.lt.dt(t,"DateTime")?p.ct.o0(t):w.lt.dt(t,"TimeSpan")?Math.floor(p.ct.o0(t)):parseFloat(t)},M=null,C=void 0,S=Math.abs,h={fHt:"yy",hHt:"y",cHt:"yyyy",dHt:"m",vHt:"mm",mHt:"mmm",gHt:"mmmm",pHt:"mmmmm",bHt:"d",yHt:"dd",wHt:"aaa",MHt:"aaaa",CHt:"h",SHt:"hh",THt:"m",AHt:"mm",IHt:"s",xHt:"ss",IGt:"e",NHt:"AM/PM",kHt:"A/P",DHt:"@mmmmm",_Ht:new Date(1899,11,30,0,0,0,0)},P=[h.hHt,h.fHt,h.cHt,h.dHt,h.vHt,h.mHt,h.gHt,h.pHt,h.bHt,h.yHt,h.wHt,h.MHt,h.CHt,h.SHt,h.THt,h.AHt,h.IHt,h.xHt,"ggg","gg","g","ee","e"],G="\u4e00\u5341",U="\u5341",l={EHt:0,jHt:1,OHt:2,_text:3},H=[{EHt:0,jHt:0,OHt:0,_text:0},{EHt:0,jHt:1,OHt:0,_text:0},{EHt:0,jHt:1,OHt:2,_text:0},{EHt:0,jHt:1,OHt:2,_text:3}],V=new RegExp("([.+?*$^\\[\\](){}|/])","g"),z=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt","M/d/yyyy H:m:s","M-d-yyyy H:m:s","M/d/yyyy h:m:s tt","M-d-yyyy H:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],Y=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"],Z=new RegExp("color\\s*(\\d+)","i"),T=w.lt.dt,W=w.lt.Nh,f=B.st,Q=f.gUt+"."+f.pUt,J=f.mUt,K=f.L9t,X=f.E8,d=w.lt.ht,A=isNaN,I=function(t){return y.CultureManager.Fe(t)},u=function(t){return I(t).DateTimeFormat},x=function(t){return I(t).NumberFormat},v=function(t){return t&&t.toLowerCase()},q=function(t){return t&&t.toUpperCase()},N=function(){throw new Error(c().Exp_FormatIllegal)},m=function(){return y.CultureManager.booleanMapping},k={oHt:"",I5:function(){for(var t,n,e,i,r,o,a,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(0===arguments.length)return M;for(r=e[0],o=1;o<arguments.length;o++)a=new RegExp("\\{"+(o-1)+"\\}","gm"),r=r.replace(a,arguments[o]);return r},Ji:function(t){return!t||t===k.oHt}},tt=function(t){var t=t.charCodeAt(0);return 48<=t&&t<=57},nt=function(t){var t=t.charCodeAt(0);return 9<=t&&t<=13||32===t||133===t||160===t},i.prototype.cultureInfo=function(){var t=this;return t.RHt||(t.RHt=I(t.Iat)),t.RHt},i.prototype.currencySymbol=function(){return this.ZUt?b.zf.Vi(this.ZUt,"\\.",'"."'):k.oHt},i.prototype.allowScience=function(){if(this.RHt)return!this.RHt.isJCKCulture},i.prototype.toString=function(){return this.Jq?Mt(this.Jq):k.oHt},i.Name="LocaleIDFormatPart",et=i,r.prototype.format=function(t,n){return M},r.prototype.parse=function(t){return M},r.prototype.formatString=function(t){return this.formatCached},r.prototype.toJSON=function(){var t,n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},r.prototype.fromJSON=function(t){if(t)for(var n in t)t[n]!==C&&(this[n]=t[n])},t.FormatterBase=e=r,gt.prototype.toString=function(){return Mt(this.WUt+this.value.toString())},it=gt,_.prototype.sHt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h;if(!t||t===k.oHt)return t;for(u=!(a=o=-1),l=(r=i=t).length-1;0<=l;l--)h=r[l],!A(h)&&!E(h," ",!1)||E(h,".",!1)&&!u?(E(h,".",!1)&&(u=!0),-1===o&&(o=l),a=l):-1<a&&-1<o&&(s=O(r,a,o-a+1),c=parseFloat(s),A(c)||(f=_.numberString(s,n,e),i=b.zf.VP(i,a,o-a+1),i=b.zf.Eit(i,a,f)),u=!(a=o=-1));return-1<a&&-1<o&&(s=O(r,a,o-a+1),c=parseFloat(s),A(c)||(f=_.numberString(s,n,e),i=b.zf.VP(i,a,o-a+1),i=b.zf.Eit(i,a,f))),i},_.prototype.toString=function(){if(-1<this.type)return Mt("DBNum"+this.type);throw new Error},_.numberString=function(t,n,e){var i,t,r,o,i=_.formatNumberString,t=t.split(".");if(t){if(1===t.length)return i(t[0],n.numbers,e?n.letters:M);if(2===t.length)return(r=i(t[0],n.numbers,e?n.letters:M))+"."+(o=i(t[1],n.numbers))}throw new Error(c().Exp_ValueIllegal)},_.formatNumberString=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,i=t,r=0,a=0;if(2===arguments.length){for(u="";r<i.length;r++)o=O(i,r,1),u+=n[a=parseInt(o,10)];return u}if(3===arguments.length){if(!e)return _.formatNumberString(t,n);for(s=0,c="",f=i.length,l=!1,h=[];r<f;r++)-1<(d=e.length-1-r)?h.push(e[d].toString()):h.push(k.oHt);for(v=[],m=h.length-1;0<=m;m--)v[h.length-m-1]=h[m];for(h=v,g=!1,m=0;m<f;m++)o=O(i,m,1),a=parseInt(o,10),p=void 0,b=k.oHt,0<f-m-16?(p=n[a],g=!(b="")):m!==f-1&&m!==f-5&&m!==f-9&&m!==f-13?"0"===o?(b=p="",s+=1):s=(b=(p="0"!==o&&0!==s?n[0]+n[a]:n[a],h[m]),0):"0"!==o&&0!==s?(p=n[0]+n[a],b=h[m],s=0):"0"!==o&&0===s||g?(p=n[a],b=h[m],s=0,g=!1):("0"===o&&3<=s?b=p="":11<=f?p="":(p="",b=h[m]),s+=1),(w=p+b===k.oHt)||(l=!1),m!==f-13||l||(b=h[m],l=!0),m!==f-9||l||(b=h[m],l=!0),m===f-1&&(b=h[m],l=!0),c=c+p+b;return 0===(y=parseInt(t,10))?n[0]:c}},rt=_,D.prototype.Hc=function(){var t,n,e,i,r,o,a,t=this,n={y4:t.pU},e;if(D.a0(n.y4)){if(i=t.BHt(n),r=u(this.cultureName).amDesignator&&u(this.cultureName).pmDesignator,t.hasJD=t.Vi(n.y4,h.pHt,'"'+h.DHt+'"',!0,!1,n,!1),t.Vi(n.y4,h.gHt,"MMMM",!0,!1,n,!1),t.Vi(n.y4,h.mHt,"MMM",!0,!1,n,!1),t.LHt(n.y4,n),t.Vi(n.y4,h.wHt,"ddd",!0,!0,n,!0),t.Vi(n.y4,h.MHt,"dddd",!0,!0,n,!0),i&&r||(t.Vi(n.y4,h.CHt,"H",!0,!0,n,!1),t.Vi(n.y4,h.SHt,"HH",!0,!0,n,!1)),t.aHt&&(t.j9t||I(t.cultureName).NumberFormat.dbNumber)&&(t.FHt=t.FHt||t.Vi(n.y4,h.cHt,'"@'+h.cHt+'"',!0,!1,n,!0),t.FHt=t.FHt||t.Vi(n.y4,h.fHt,'"@'+h.fHt+'"',!0,!1,n,!0)),t.KUt)for(o=0;o<t.KUt.length;o++)a=t.KUt[o],t.Vi(n.y4,a.Nat,"@"+a.Nat,!0,!0,n,!0);t.PHt=n.y4}else N()},D.prototype.formatString=function(){return this.pU},D.prototype.format=function(n){var t,e,i,r,o,a,u,s,c,f,l,t=this,e=k.oHt,i=M;try{if((i=(i=p.ct.iPt(n))&&A(i.valueOf())?M:i)?n=i:e=n.toString(),i&&(e=p.ct.L9t(i,t.PHt,t.j9t&&t.j9t.cultureInfo()||I(t.cultureName),t.O9t),t.hasJD&&(r=I(t.cultureName).DateTimeFormat.monthNames[i.getMonth()],e=b.zf.Vi(e,h.DHt,O(r,0,1))),t.KUt))for(o=24*(p.ct.o0(i)-p.ct.o0(h._Ht))*60*60*1e3,a=0;a<t.KUt.length;a++)s=(u=t.KUt[a]).XUt(o),d(s)||(c=u.Nat.replace("[","\\[").replace("]","\\]"),f=u.Nat.replace("[","").replace("]",""),l=b.zf.B9t(s+"",f.length),e=b.zf.Vi(e,"@"+c,l))}catch(t){e=wt(n)}return Rt(e,n,t.j9t,t.aHt,t.cultureName)},D.prototype.parse=function(n){var t,n,e,e,i;if(!n||n===k.oHt)return M;if(t=this,"true"===(e=v(n=n)))return!0;if("false"===e)return!1;if(t.PHt&&(e=p.ct.nUt(n,t.PHt,I(t.cultureName))))return e;try{return(i=p.ct.iPt(n))&&!A(i)?i:(i=new Date(n),A(i.valueOf())?n:i)}catch(t){return n}},D.prototype.QUt=function(t){for(var n,e,i,r,o,a,n=t,e="",i=!1,r=0;r<n.length;r++)'"'===(o=n[r])?i=!i:i||"Y"!==o&&"D"!==o&&"S"!==o&&"E"!==o&&"G"!==o&&("M"!==o||E("A",a=n[r-1],!0)||E("P",a,!0))||(o=v(o)),e+=o;return e},D.prototype.BHt=function(t){var n,e,i,r,o,a,n=u(this.cultureName).amDesignator,e=u(this.cultureName).pmDesignator,i=[h.NHt];for(i.push(n&&e?n+"/"+e:h.NHt),i.push(h.kHt),r=["tt","tt","t"],o=t.y4,a=0;a<3;a++){if(b.zf.OS(o,r[a]))return!0;if(b.zf.OS(o,i[a],!0))return t.y4=b.zf.Vi(o,i[a],r[a],!0),!0}return!1},D.prototype.LHt=function(t,n){for(var e,i,r,o,a,e=Bt(t),i=-1,r=-1,o=0;o<e.length;o++)"symbolic"===(a=e[o]).type?"m"===a.content[0].toLowerCase()?0<=i?(a.content=a.content.toLowerCase(),i=-1):(a.content=a.content.toUpperCase(),r=o):"s"===a.content[0].toLowerCase()?0<=r&&(e[r].content=e[r].content.toLowerCase(),r=-1):r=("h"===a.content[0].toLowerCase()&&(i=o),-1):"0"===a.content&&"."===e[o-1].content&&0<=r&&o===r+2&&(e[r].content=e[r].content.toLowerCase());n.y4=e.map(function(t){return t.content}).join("")},D.prototype.Vi=function(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p;if(i||r){for(u=[],s=!0,!D.hasDate(t)&&D.hasTime(t)&&(s=!1),c=!1,f=0;f<t.length;f++){if(l=t[f],D.hasTime(l)&&!c?s=!1:D.hasDate(l)&&!c&&(s=!0),i&&E(l,n[0],a)&&s||r&&E(l,n[0],a)&&!s){for(h=!0,d=0;d<n.length;d++)if(d+f>=t.length||!E(n[d],t[d+f],a)){h=!1;break}if(v=f+n.length-1,h&&1+v<t.length){for(m=t[v],g=-1,g=1+v;g<t.length&&E(m,t[g],a);g++);1+v<g&&(f=g,h=!1)}h&&!c&&u.splice(0,0,f)}'"'===l&&(c=!c)}if(o.y4=t,0<u.length){for(f=0;f<u.length;f++)o.y4=b.zf.VP(o.y4,p=u[f],n.length),o.y4=b.zf.Eit(o.y4,p,e);return!0}}return!1},D.hasTime=function(t){return-1<b.zf.hD(t,h.CHt[0],!0)||-1<b.zf.hD(t,h.IHt[0],!0)},D.hasDate=function(t){return-1<b.zf.hD(t,h.fHt[0],!0)||-1<b.zf.hD(t,h.bHt[0],!0)},D.a0=function(t,n){return Nt(t,n||P)},ot=D,t.Hf=ot,pt.Name="ABSTimeFormatPart",at=pt,bt.prototype.toString=function(){return Mt(this.foreColor)},bt.Name="ColorFormatPart",ut=bt,j.prototype.formatString=function(){return this.$Ut},j.prototype.format=function(t){var n,e,t,i,r,o,a,u,s,c,f,l,h,h,h,d,v,v,m,g,g,v;return T(t,"boolean")?t.toString().toUpperCase():(n=this,e=w.lt.uJ(t),A(e)||!isFinite(e)||A(t)?"string"==typeof t?t:M:(t=I(n.cultureName),n.eHt&&n.tHt?(c={value:0},f={value:0},l={value:0},h=n.GHt(),j.getFraction(e,h,c,f,l)?(1<(h=j.getGCD(f.value,l.value))&&(f.value/=h,l.value/=h),n.nHt?(s="",1===l.value&&(c.value+=f.value,f.value=0,l.value=0),(h=J(K(c.value,n.nHt,t)))&&"0"!==h&&(s=s+h+" "),0===c.value&&e<0&&(s+=t.NumberFormat.negativeSign),0===e&&(s+="0"),r=n.tHt,o=parseFloat(r),!A(o)&&0<o&&(0!==f.value&&0!==l.value&&(f.value*=o/l.value),l.value=o,r=r.replace(/^\d+/,j.toNumberPlaceholder(o)),u=(a=Math.ceil(f.value))-f.value,f.value=u<=.5&&0<=u?parseFloat(a.toString()):parseFloat((a-1).toString())),d=n.eHt,v=parseFloat(d),A(v)||0!==v||(v=d.length,(g=(m=f.value.toString()).length)<v?d=d.substr(0,v-(v-g)):v<g&&(m=m.substr(0,g-(g-v)),f.value=parseInt(m,10))),g=n.UHt(f.value,l.value,d,r,t),0===f.value&&(g=g.replace(/./g," "),""===h)?"0 "+g:""===(s+=g)?"0":s):(s="",v=c.value*l.value+f.value,r=n.tHt,0<(o=parseFloat(r))?(v*=o/l.value,l.value=o,s+=(v=(u=(a=Math.ceil(v))-v)<=.5&&0<=u?parseFloat(a.toString()):parseFloat((a-1).toString()))+"/"+l.value):s+=n.UHt(v,l.value,n.eHt,n.tHt,t),0===v?"0":s)):e.toString()):Ft(i=K(e,n.iHt,t),n.qUt,n.j9t,n.aHt,n.cultureName)))},j.prototype.parse=function(t){var n,e,e,i,r,i,o,a,r,i,o,u,n=this;if(t&&t!==k.oHt){if("TRUE"===(e=q(t))||e===m()&&m().boolean_true)return!0;if("FALSE"===e||e===m()&&m().boolean_false)return!1;if((e="("===t.charAt(0)&&")"===t.charAt(t.length-1))&&(t=t.substring(1,t.length-1)),i=n.eHt&&n.tHt,r=n.zHt(n.iHt).HHt,(i||r)&&0<(i=t.indexOf("/"))&&i<t.length-1&&(o=parseInt(t.substr(0,i),10),a=parseInt(t.substr(i+1),10),!isNaN(o))&&!isNaN(a)&&0!==a)return o/a;if(t=n.VHt(t),t=n.YHt(t),i=(r=n.zHt(t)).HHt,o=r.$6t,n.ZHt(o)&&(o=b.zf.OUt(o,x(n.cultureName).numberGroupSeparator,"",!1),u=f.dUt(o,n.cultureName),!A(u))&&isFinite(u)){if(i&&(u=X(u/100,15)),e){if(!(0<=u)||0===u&&"-"===o.charAt(0))return M;u=-1*S(u)}return u}}return M},j.prototype.GHt=function(){var t,n,e,i,r,t,n=this.tHt,e=0;if(n)for(i=n.length,r=0;r<i&&n[r].match(/[#?\d]/);r++)e++;return e},j.prototype.ZHt=function(t){for(var n,e,i,r,o,a,u,n="",e=0,i=0,r=0,o=M,a=x(this.cultureName),u=t.length-1;-1<u;u--){if(t[u]===a.numberDecimalSeparator)e++,0<r&&(o=!1),n="";else if("e"===v(t[u])){if(i++,n="",u===t.length-1)return!1}else if(t[u]===a.numberGroupSeparator)o=3===n.length,r++,n="";else if("-"===t[u]||"+"===t[u]){if(0<u&&"e"!==v(t[u-1]))return!1}else{if(!tt(t[u]))return!1;if(n+=t[u],0===u&&0===parseInt(n,10)&&o)return!1}if(1<e||1<i||!1===o)return!1}return!0},j.prototype.VHt=function(t){for(var n,e,i,t,r,o,a,a,u,n=t,e=[],i=0;i<n.length;i++)tt(n[i])&&e.push(i);for(r=[(t=x(this.cultureName)).currencyDecimalSeparator,t.currencyGroupSeparator,t.currencySymbol,s,t.nanSymbol,t.negativeInfinitySymbol,t.negativeSign,t.numberDecimalSeparator,t.numberGroupSeparator,t.percentDecimalSeparator,t.percentGroupSeparator,t.percentSymbol,t.perMilleSymbol,t.positiveInfinitySymbol,t.positiveSign],o=n.length-1;-1<o;o--)if(a=n[o],nt(a)&&r.indexOf(a.toString())<=-1)(o<e[0]||e[e.length-1]<o)&&(n=b.zf.VP(n,o,1));else if(("-"===a||"+"===a)&&(a=0<o?n[o-1].toString():M,(u=["e","E","(",x(this.cultureName).currencySymbol,s]).indexOf(a)<0))break;return n},j.prototype.YHt=function(t){var n,e;if(b.zf.fJ(t,s)){if((n=b.zf.VP(t,0,1)).indexOf(s)<0)return n}else if(e=x(this.cultureName).currencySymbol,s!==e&&b.zf.fJ(t,e)&&(n=b.zf.VP(t,0,e.length)).indexOf(e)<0)return n;return t},j.prototype.zHt=function(t){var n,e,i,n=x(this.cultureName).percentSymbol,e=!0,i=t;return b.zf.fJ(t,n)?i=b.zf.VP(t,0,n.length):b.zf.dT(t,n)?i=b.zf.VP(t,t.length-n.length,n.length):e=!1,{$6t:i,HHt:e=b.zf.OS(i,n)?!1:e}},j.prototype.UHt=function(t,n,e,i,r){var o,a,u,s,r,o,o=J(K(t,e,r)),a,u,s=J(K("0."+n,"#."+i,r,!0)),r=r&&r.NumberFormat&&r.NumberFormat.numberDecimalSeparator||".",o=o+"/"+s.substr(s.indexOf(r)+1);return""===e&&(o=t+o),""===i&&(o+=n),o},j.getGCD=function(t,n){var e,i,r;if(0===t)return S(n);if(0===n)return S(t);for(r=(e=Math.max(t,n))%(i=Math.min(t,n));0!==r;)r=(e=i)%(i=r);return S(i)},j.getFraction=function(t,n,e,i,r){var o,a,u,s,c,c,f,l,h,d,v,m,g,p,o=0,a=0,u=0,s=0,c=Math.ceil;for(0<t?o=1===(s=t-c(t)+1)?(s=0,t):c(t)-1:t<0&&(o=c(t),s=c(t)-t),c=Math.pow(10,n-1),(f=Math.pow(10,n)-1)<2&&(f=2),l=!1,h=0,d=c=c<2?2:c;d<=f&&(m=Math.round(v=d*s),p=S((g=m/d)-s),!((!l||p<S(h-s))&&(l=!0,h=g,a=m,u=d,p<1e-6)));d++);return e.value=o,i.value=a,r.value=u,l},j.toNumberPlaceholder=function(t){return t.toString().replace(/\d/g,"?")},st=j,o.rHt=function(t){for(var n,e,i,r,o,a,n="",e=!1,i=-1,r=t.length,o=0;o<r;o++)'"'===(a=t[o])?i=(e=!e)?o:-1:e||(n+=a);return 0<i&&(n+=t.substring(i,r)),!(0<=n.indexOf("0")||0<=n.indexOf("#")||0<=n.indexOf(".")||0<=n.indexOf("@"))},o.prototype.WHt=function(){var t,n,t=this;return t.QHt||(n=Tt(n=t.$Ut,"General",Q),t.QHt=new st(n,t.j9t,t.aHt,t.cultureName),t.QHt.qUt=!0),t.QHt},o.prototype.KHt=function(){var t=this;return t.JHt||(t.JHt=new st("0.#####E+00",t.j9t,t.aHt,t.cultureName),t.JHt.qUt=!0),t.JHt},o.prototype.formatString=function(){return b.zf.Vi(this.$Ut,"@NumberFormat","General")},o.prototype.format=function(t){var n,e,i,r,n=this;if(w.lt.q8(t,n.cultureName)){if(e=!n.j9t||n.j9t.allowScience(),(i=w.lt.uJ(t))!==C&&i!==M)return(99999999999<S(i)&&e||S(i)<1e-11&&0!==i?n.KHt():n.WHt()).format(t)}else{if(T(t,"string"))return r=At(r=b.zf.Vi(n.formatString(),'"',"")),t;if(T(t,"boolean"))return t.toString().toUpperCase()}return""},o.prototype.parse=function(t){var n,e,i,i,r,o,a,u,r,s,n,u,o,a,s,c;return k.Ji(t)?M:"number"==typeof t?t:(n=!1,e=t.trim(),0<(i=b.zf.hD(e,"-",!1))&&!E(e.charAt(i-1),"E",!0)&&(n=!0),o=(r=(i=I(this.cultureName)).DateTimeFormat).dateSeparator,a=r.timeSeparator,u=r.monthNames,r=r.abbreviatedMonthNames,s=function(t,n){var e,i,r;if(!n||0===n.length)return!1;for(e=!1,i=0,r=n.length;i<r;i++)if(b.zf.OS(t,n[i],!0)){e=!0;break}return e},(n||b.zf.OS(e,o,!1)||b.zf.OS(e,a,!1)||b.zf.OS(e,"/",!1)||b.zf.OS(e,":",!1)||b.zf.OS(e,"-",!1)||b.zf.OS(e,"\u5e74",!1)||b.zf.OS(e,"\u6708",!1)||b.zf.OS(e,"\u65e5",!1)||s(e,u)||s(e,r)||"ja-JP"===i.name()&&0<=y.XPt.gGt.indexOf(e[0].toUpperCase())&&b.zf.OS(e,".",!1))&&(n=p.ct.yU(e))?n:((a="("===(e=(o="-"===e.charAt(0))?b.zf.VP(e,0,1):e).charAt(0)&&")"===e.charAt(e.length-1))&&(e=(e=e.substring(1,e.length-1)).trim()),(u=this.WHt().parse(e))===M||u===C||(s=T(u,"number")&&(u<0||0===u&&"-"===e.charAt(0)),c=a&&(s||T(u,"boolean")))?t:(a||o)&&T(u,"number")?-1*S(u):u))},ct=o,a.prototype.format=function(t,n){var e,i,r,o,e=this;try{return r=i=void 0,r=t instanceof Date?p.ct.o0(t).toString():wt(t),o=e.XHt(e.pU),i=e.qHt(r,o.formatTokens,t,o.hasAtPart,n)}catch(t){return""}},a.prototype.parse=function(t){return t||""},a.prototype.formatString=function(){return this.pU},a.prototype.XHt=function(t){for(var n,e,i,r,o,a,u,n=[],e=!1,i="",r=!1,a=M,u=0;u<t.length;u++)o=t.charAt(u),r?('"'!==o?i+=o:(n.push(i+=o),i="",r=!1),a=o):"*"!==a&&"_"!==a&&"\\"!==a||""===i?"*"===o||"_"===o||"\\"===o?(a=o,""!==i&&(n.push(i),i=""),i+=o):"@"===o?(a=o,""!==i&&(n.push(i),i=""),n.push(o),e=!0):'"'===o?(a=o,""!==i&&n.push(i),i=o,r=!0):(i+=o,a=o):(n.push(i+=o),i="");return""!==i&&n.push(i),{formatTokens:n,hasAtPart:e}},a.prototype.qHt=function(t,n,e,i,r){var o,a,u,s,o=[],a=!1;if("string"!=typeof e||i||r)for(u=n.length-1;0<=u;u--)"*"===(s=n[u])[0]?a||(a=!0,o.push({type:"fillingChar",value:s[1]})):"_"===s[0]?o.push({type:"placeholder",value:s[1]}):'"'===s[0]&&'"'===s[s.length-1]?2<=s.length&&o.push({type:"text",value:s.substr(1,s.length-2)}):"\\@"===s?o.push({type:"text",value:"@"}):"@"===s[0]?o.push({type:"text",value:t}):o.push({type:"text",value:s});else o.push({type:"text",value:e});return o.reverse()},ft=a,lt=function(){return{pattern:z,formatter:["d-mmm","mmm-yy",u().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",u().shortDatePattern+" h:mm",u().shortDatePattern+" h:mm:ss",u().shortDatePattern+" h:mm:ss.0"]}},R.prototype.Hc=function(t,n){var e,i,r,o,a,u,s,c,f,l,h,d,d,v,m,g,m;for(t!==M&&t!==C||N(),(i=this).formatCached=e=t,o=r="",s=u=a=!1,c=[],f=0;f<t.length;f++)'"'===(l=t[f])?(u=!u,o+=l):u?o+=l:"["===l?(a&&N(),o&&(r=r||"",r+=o),o=l.toString(),a=!0):"]"===l?(a||N(),o?(h=(o+=l).toString(),(d=Dt(o.toString()))?"ABSTimeFormatPart"===d.Name?(c.push(new d(R.preProcessPart(h),h)),r+=o):h===y.XPt.eraExcelFormatter?(i.addPart(d,y.XPt.eraInternalFormatter),s=!0):i.addPart(d,h):(r+=d=R.partToNormalStr(h),e=Tt(t,h,d)),o=""):N(),a=!1):o+=l;o?a?N():r+=o:r=r||i.$Ht(),i.localeIDFormatPart&&(n=i.localeIDFormatPart.cultureInfo().name()),g=(m=jt(r,v=i.conditionalFormatPart)).uit,m=m.uHt?e:r,g?i.E9t=new g(m,i.localeIDFormatPart,i.dbNumberFormatPart,n,0<c.length?c:M,s):N()},R.prototype.$Ht=function(){var n,t,e,n=this,t="";return t=n.dbNumberFormatPart&&!(e=R.proNames.some(function(t){return"dbNumberFormatPart"!==t&&n[t]}))?"General":t},R.prototype.formatString=function(){for(var t,n,e,i,r,t=this,n="",e=0,i=R.proNames.length;e<i;e++)t[r=R.proNames[e]]&&(n+=t[r].toString());return n+=t.E9t.formatString()},R.prototype.addPart=function(t,n){for(var e,i,r,o,a,u,e=this,i=R.proNames,r=R.preProcessPart(n),o=0,a=i.length;o<a;o++)if(E(u=i[o],t.Name,!0)){if(e[u])throw new Error(c().Exp_DuplicatedDescriptor);e[u]=new t(r,n)}},R.prototype.format=function(t,n){return this.E9t.format(t,n)},R.prototype.parse=function(t){return this.E9t.parse(t)},R.checkFormatter=function(t){if(!t||t===k.oHt)throw new Error(c().Exp_TokenIllegal)},R.preProcessPart=function(t){R.checkFormatter(t);var t=St(t);return R.checkFormatter(t),t},R.partToNormalStr=function(t){var t=R.preProcessPart(t);return'"'+(t=t[0]===s?t.slice(1):t)+'"'},R.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],ht=R,L(F,mt=e),F.prototype.toJSON=function(){var t,n,t=this,n={formatCached:t.formatCached};return t.cultureName&&(n.customerCultureName=t.cultureName),"general"===v(t.formatCached)&&delete n.formatCached,n},F.prototype.hasFormattedColor=function(){var t,n,e,t=this;for(n in l)if(l.hasOwnProperty(n)&&(e=t.getFormatter(l[n]))&&e.colorFormatPart)return!0;return!1},F.prototype.formatString=function(t){var n,e,i,r,o,n=this;if(0===arguments.length){for(e=k.oHt,i=0,r=n.formatters.length;i<r;i++)e+=(o=n.formatters[i]).formatString(),i!==r-1&&(e+=";");return e}if(t)return n.formatters=M,n.formatCached=t,n.init(),n.tzt("formatString"),n;throw new Error(c().Exp_ValueIsNull)},F.prototype.getFormatter=function(t){var n=this;return n.formatters&&n.formatters[t]},F.prototype.getPreferredEditingFormatter=function(t){var n,e,i,r,n,e,e=u(this.cultureName),i=x(this.cultureName),r=F.defFormatter;return T(t,"TimeSpan")?r(e.longTimePattern):T(t,"DateTime")?(n=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",r(e.shortDatePattern+n)):w.lt.q8(t,this.cultureName)?1e21<=(e=w.lt.uJ(t))||e<=1e-17&&0<e||e<=-1e21||e<0&&-1e-17<=e?r(null!=(n=i.scientificNotation)?n:"0.##############E+00"):r(Q):r("General")},F.prototype.getPreferredDisplayFormatter=function(t,n){var e,i,n,r,o,a,u,o,s,c,c,s,c,f,l,h,d,d,s,o,c,e,s,v,m,g,c,e=this,i=F.defFormatter;if((n=n||{value:M}).value=M,k.Ji(t))return new F;if(r=n.value=e.parse(n=t),T(r,"DateTime")||T(r,"TimeSpan")){for(a=(o=lt()).pattern,u=o.formatter,0<(c=(s=(o=I(e.cultureName)).DateTimeFormat).preselectedFormatters).length&&(a=a.concat([c]),u=u.concat([c[0]])),"ja-JP"===o.name()&&(a=a.concat([s.eraFormatter]),u=u.concat(["ge.M.d"]),c=o.QPt.filter(function(t){return"ggge"===t.substr(0,4)}),a=a.concat([c]),u=u.concat(['ggge"\u5e74"M"\u6708"d"\u65e5']),s=o.QPt.filter(function(t){return"gge"===t.substr(0,3)}),a=a.concat([s]),u=u.concat(['gge"\u5e74"M"\u6708"d"\u65e5']),c=o.QPt.filter(function(t){return"ge"===t.substr(0,2)}),a=a.concat([c]),u=u.concat(['ge"\u5e74"M"\u6708"d"\u65e5'])),f=0;f<a.length;f++)for(l=a[f],h=0;h<l.length;h++)if(d=l[h],(d=p.ct.yU(t,d))&&d-r==0)return new F(u[f])}else if(w.lt.q8(r,e.cultureName)){if(o=(s=x(e.cultureName)).currencySymbol,c=s.numberDecimalSeparator,e=s.percentSymbol,s=s.numberGroupSeparator,v="E",c=(g=(m=b.zf.OS)(n,c))?".00":"",n[0]===o)return i(k.I5("{0}#,##0{1};[Red]({0}#,##0{1})",o,c));if(m(n,"E",!0))return i("0.00E+00");if(n[0].toString()===e||n[n.length-1].toString()===e)return i(k.I5("0{0}%",c));if(m(n,s))return i(k.I5("#,##0{0}",c))}return i("General")},F.prototype.format=function(n,t){var e,i,r,o,i,a,u;if(T(n,"boolean"))return(n=m()?n?m().boolean_true:m().boolean_false:n).toString().toUpperCase();if(r=0,o=(e=this).vn(n)){i=o.colorFormatPart,t&&i&&(t.conditionalForeColor=t.value=i.foreColor),(i=w.lt.q8(n,e.cultureName))&&(r=w.lt.uJ(n)),a=k.oHt;try{i&&o===e.getFormatter(l.jHt)&&0!==this.expressionNumber?(a=o.format(o.considerNegSymbol?r:S(r)))===M&&T(n,"string")&&(a=n):(a=o.value)===C&&(u=!e.lHt&&o===e.getFormatter(l._text),a=o.format(n,i||u)),t&&(t.content=W(a)?a:[{type:"text",value:a}]),W(a)&&(a=f.mUt(a))}catch(t){T(n,"string")&&(a=n.toString())}return a}return i&&r<0?"-".toString():!T(n,"string")&&(n===C||n===M)?k.oHt:n.toString()},F.prototype.parse=function(t){var n=this;return n.formatters&&0<n.formatters.length?n.formatters[0].parse(t):M},F.prototype.init=function(){var t,n,e,i,r,t=this,n=t.formatCached;for(k.Ji(n)&&N(),t.formatters=[],e=Lt(n),t.lHt=1===e.length,(!e||e.length<1||4<e.length)&&N(),i=0;i<e.length;i++)-1!==e[i].indexOf("@")&&-1===e[i].indexOf("\\@")&&(i!==e.length-1?N():this.hasAt=!0),r=new ht(e[i],t.cultureName),t.formatters.push(r);t.getFormatter(l.EHt)||N(),this.nzt()},F.prototype.nzt=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var t=(0===this.expressionNumber?1:this.expressionNumber)-1;l=w.lt.Dh({},H[t]),this.hasAt&&0!==this.expressionNumber&&(l._text=this.formatters.length-1)},F.prototype.vn=function(t){var n,e,i,r,r,o,t,a,u,s,c,f,n=this;if(n.nzt(),i=(e=n.getFormatter(l.EHt))&&e.conditionalFormatPart,r=n.getFormatter(l._text),i&&(l.OHt=2,this.hasAt||(l._text=3)),"string"==typeof t&&A(t))return r||(i?t:e);if(w.lt.q8(t,n.cultureName)||T(t,"boolean")){if(r=n.getFormatter(l.jHt),o=n.getFormatter(l.OHt),t=w.lt.uJ(t),a=i&&e.conditionalFormatPart.isMeetCondition(t),s=(u=r&&r.conditionalFormatPart)&&r.conditionalFormatPart.isMeetCondition(t),c=void 0,n.lHt||(i?a:0<t||0===t&&!o))c=e;else if(u?s:t<0)c=r;else if(o)c=o;else if(r){if(i&&u)return{value:f=t+""};c=r}return c&&(!i||u||c!==r||o||(c.considerNegSymbol=!0),i&&u&&c===r&&r.conditionalFormatPart&&r.conditionalFormatPart.isMeetCondition(1e-10)&&(c.considerNegSymbol=!0),this.expressionNumber<=1)&&(c.considerNegSymbol=!0),c}return M},F.prototype.tzt=function(t){var n,e,i,n=this;if(n.PropertyChanged)for(e=0;e<n.PropertyChanged.length;e++)"function"==typeof(i=n.PropertyChanged[e])&&i(n,t)},F.defFormatter=function(t){var n=F[t];return n||(n=new F(t),F[t]=n),n},t.GeneralFormatter=F},"./src/plugins/slicer/slicer.entry.ts":function(t,n,e){var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/plugins/slicer/slicer.ts"),n)},"./src/plugins/slicer/slicer.ts":function(t,n,e){var e,N,k,a,r,o,i,u,s,_,c,e,e;function p(t){return"object"==typeof t&&t!==k&&t.text!==N}function f(){}function l(t,n){var e,i,t;if(t!==k&&t!==N){if(I(t)===a)n.value=t;else if(I(t)===o)n.value=t?1:0;else if(t instanceof Date)n.value=_.o0(t);else{if(I(t)!==r)return;if(0===D(t=t.trim()))return;if(e=!1,"%"===t.charAt(D(t)-1)&&(e=!0,t=t.substr(0,D(t)-1)),2<=D(t)&&"0"===t[0]&&"x"===t[1])return;if(i=Number(t).valueOf(),isNaN(i)||!isFinite(i)){if(t=new Date(t),isNaN(t))return;i=_.o0(t)}e&&(i/=100),n.value=i}return 1}}function b(t){var n,e,i,r,o,a,u,s,c,f,l,h,d,v,m,g,n=t.ezt;for(n||(t.izt=[],t.rzt=[]),e=n?t.ozt:t.izt,i=t.azt,r=t.uzt,o=n?t.szt:t.rzt,a=t.Mct,u=t.czt,s=t.fzt,c=D(t.data),l={},h=0;h<c;h++){for(d=!1,v=void 0,m=0;m<D(a)&&(v=a[m],n&&v===t.lzt||(r[v]?(A(l[g=t.columnNames[v]])&&(l[g]=t.getColumnIndex(g)),f=t.fue(l[g],h),d=!r[v][f]):i[v]&&(d=!i[v][h]),!d));m++);!d&&n&&(u?(A(l[g=t.columnNames[v]])&&(l[g]=t.getColumnIndex(g)),d=!u[f=t.fue(l[g],h)]):s&&(d=!s[h])),d||(e[h]=!0)}for(m=0;m<D(e);m++)e[m]&&o.push(m)}function v(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?_.o0(t):t}function h(t){var n,e,i,n=t.hzt={};for(t.dzt=[],t.vzt=[],t.mzt=[],t.gzt=[],e=t.columnNames,i=0;i<D(e);i++)n[(e[i]+"").toUpperCase()]=i}function w(t,n){var e,i,r,o,a,u,s,c,f,l,l,h,h,d,e=t.dzt,i=t.vzt,r=t.pzt,o=t.mzt,a=t.gzt,u=t.data,s=a[n]=[];for(t.bzt=[],e[n]=[],i[n]=[],r[n]={},o[n]=[],c={},f=0;f<D(u);f++)l=p(l=u[f][n])?l.text.trim():l,e[n].push(l),(h=c[v(l)])?(h.list.push(f),s[f]=h.index):(h=[f],i[n].push(l),o[n].push(h),d=D(o[n])-1,r[n][l]=d,s[f]=d,c[v(l)]={list:h,index:d})}function d(t,n,e){var i,r,o,a,u,s,c,f,l,l,h,d,v,m,g,i=t.yzt,r=t.getColumnIndex(n),o=[];if(r&&(a=t.ezt?t.wzt:t.Mzt[r],u=t.izt,a)){for(i[r]||t.Czt(r),s=[],c=i[r],f=0;f<D(c);f++)l=p(l=t.data[f][r])?l.value:l,s[c[f]]=l;for(h=t.Szt[r],f=0;f<D(a);f++){for(d=a[f],v=!1,g=(m=t.Tzt(s,d)).start;g<=m.end;g++)if(u[h[g]]){v=!0;break}v!==e&&o.push(d)}}return o}function m(t,n){var e,i,r,o,a,u,e=[],i=t.getColumnIndex(n);if(0<=i){for(r=D(t.getData(n)),o=t.ezt?t.ozt:t.izt,a=0;a<r;a++)o[a]||(u=t.fue(i,a),-1===e.indexOf(u)&&e.push(u));return e}}function g(t,n){var e,i,r,o,a,u,s,c,f,l,e=[],i={},r=t.getColumnIndex(n);if(0<=r)for(o=t.czt||t.fzt,a=t.uzt[r]||t.azt[r],u=t.ezt&&r===t.lzt?o:a,c=D((s=!!t.azt[r])?t.getData(n):t.getExclusiveData(n)),f=0;f<c;f++)!u||u[f]||i[l=s?t.fue(r,f):f]||(i[l]=!0,e.push(l));return e}function y(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,e={},i=t.columnNames,o=D(i),r=0;r<o;r++)if(i[r]!==n)for(a=g(t,i[r]),u=0;u<D(a);u++)for(s=t.getRowIndexes(i[r],a[u]),c=0;c<D(s);c++)e[s[c]]||(e[s[c]]=!0);for(f={},o=D(t.data),r=0;r<o;r++)l=t.getExclusiveRowIndex(n,r),e[r]||(f[l]=!0);for(h=D(t.getExclusiveData(n)),d=[],r=0;r<h;r++)f[r]||d.push(r);return d}function M(t,n,e,i){var r,n,o,a,u,s,s,c,f,l,r=t.getColumnIndex(n),n=t.yzt;for(n[r]||t.Czt(r),o=[],a=n[r],u=0;u<D(a);u++)s=p(s=t.data[u][r])?s.value:s,o[a[u]]=s;for(c=[],u=0;u<D(e);u++)for(f=t.Tzt(o,e[u]),l=0;l<D(a);l++)a[l]>=f.start&&a[l]<=f.end&&(c[l]=!0);i?(t.fzt=c,t.wzt=e):(t.Mzt[r]=e,t.azt[r]=c,delete t.uzt[r],delete t.Azt[r]),b(t)}function C(t,n,e,i){for(var n,r,o,n=t.getColumnIndex(n),r=[],o=0;o<D(e);o++)r[e[o]]=!0;i?t.czt=r:(t.uzt[n]=r,t.Azt[n]=e,delete t.Mzt[n],delete t.azt[n]),b(t)}function S(t,n){t.ezt=!1,t.czt=[],t.szt=[],t.ozt=[],t.fzt=[],n&&t.onFiltered()}function T(t,n){var e,i,e=this;for(e.hzt={},e.dzt=[],e.vzt=[],e.pzt=[],e.mzt=[],e.gzt=[],e.uzt=[],e.Azt=[],e.azt=[],e.Mzt=[],e.izt=[],e.rzt=[],e.Mct=[],e.szt=[],e.ozt=[],e.ezt=!1,e.aT=[],e.Upt=0,e.bzt=[],e.Szt=[],e.yzt=[],e.lue=0,e.Izt(t,n),i=0;i<D(e.data);i++)e.izt[i]=!0,e.rzt.push(i)}function A(t){return t===N||t===k}function I(t){return typeof t}function D(t){return t?t.length:0}Object.defineProperty(n,"__esModule",{value:!0}),n.GeneralSlicerData=n.xzt=n.SlicerAggregateType=n.FilteredOutDataType=void 0,e=e("./src/common/util/datetimehelper.ts"),N=void 0,k=null,a="number",r="string",o="boolean",i=e.ct.o0,(e=u=n.FilteredOutDataType||(n.FilteredOutDataType={}))[e.all=0]="all",e[e.byCurrentColumn=1]="byCurrentColumn",e[e.byOtherColumns=2]="byOtherColumns",(e=s=n.SlicerAggregateType||(n.SlicerAggregateType={}))[e.average=1]="average",e[e.count=2]="count",e[e.counta=3]="counta",e[e.max=4]="max",e[e.min=5]="min",e[e.product=6]="product",e[e.stdev=7]="stdev",e[e.stdevp=8]="stdevp",e[e.sum=9]="sum",e[e.vars=10]="vars",e[e.varp=11]="varp",f.o0=function(t){return i(t)},f.quickSort=function(t){for(var n,e,i,n=D(t),e=[],i=0;i<n;i++)e[i]={index:i,value:t[i]};return f.quickSortImp(e)},f.quickSortImp=function(t){var n,e,i,r,o,a,u,s,c,n=t.length;if(n<=1)return t;for(e=f,r=t[i=Math.floor(n*Math.random())],o=[],a=[],u=[],s=0;s<n;s++)(i===s?u:(c=e.sortCompare(t[s].value,r.value))<0?o:0<c?a:u).push(t[s]);return e.quickSortImp(o).concat(u,e.quickSortImp(a))},f.isEquals=function(t,n){return!(!A(t)&&""!==t||!A(n)&&""!==n)||(t instanceof Date&&n instanceof Date?t.valueOf()===n.valueOf():I(t)===r&&I(n)===r?t.toLowerCase()===n.toLowerCase():t===n)},f.isGreaterThan=function(t,n){var e=I(t),i=I(n);return e===o?t=t?1:0:t instanceof Date&&(t=f.o0(t)),i===o?n=n?1:0:n instanceof Date&&(n=f.o0(n)),e===i||e!==a&&i!==a?e===r&&i===r?t.toLowerCase()>n.toLowerCase():n<t:i===a},f.sortCompare=function(t,n){var e,i,r,o,e=f,i=-1,r=A(t)||""===t||I(t)===a&&isNaN(t),o=A(n)||""===n||I(n)===a&&isNaN(n);return r&&o?i=0:r?i=1:o?i=-1:e.isEquals(t,n)?i=0:e.isGreaterThan(t,n)&&(i=1),i},_=f,n.xzt=_,T.prototype.inPreview=function(){return this.ezt},T.prototype.Izt=function(t,n){var e=this;e.data=t,e.columnNames=n,h(e)},T.prototype.vue=function(t){var n=this;n.mue&&0===n.lue&&(n.Nzt("onDataChanged",t),n.mue=!1)},T.prototype.gue=function(){this.lue++},T.prototype.pue=function(){var t=this;t.lue--,t.lue<=0&&(t.lue=0,t.vue())},T.prototype.onDataChanged=function(t){for(var n,e,i,r,o,a,u,s,c,f,l,c,l,f,h,d,v,m,n=this,e=new Array(D(n.columnNames)),i=n.Azt,r=n.vzt,o=n.uzt,a=n.dzt,s={},u=0;u<D(t);u++)f=(c=t[u]).data,l=c.columnName,c=c.row,A(s[l])&&(s[l]=n.getColumnIndex(l)),l=s[l],c>=n.data.length&&n.onRowsAdded(c,1,!1),f=p(n.data[c][l]=f)?f.text:f,a[l]&&(a[l][c]=f),e[l]=!0;for(h=0;h<D(e);h++)if(e[h]){for(d=i[h],i[h]=d?[]:void 0,o[h]=d?[]:void 0,v=[],u=0;d&&u<D(d);u++)v.push(r[h][d[u]]);for(w(n,h),u=0;u<D(v);u++)m=n.pzt[h][v[u]],i[h].push(m),o[h][m]=!0}b(n),n.mue=!0,n.vue(t)},T.prototype.Nzt=function(t){for(var n,e,i,r,o,n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(i=this.aT||[],r=0;r<D(i);r++)(o=i[r])[t]&&o[t].apply(o,n)},T.prototype.onColumnNameChanged=function(t,n){var e,i,r,e=this,i=e.hzt,r=e.getColumnIndex(t);r<0||(e.columnNames[r]=n,delete i[t.toUpperCase()],i[n.toUpperCase()]=r,e.Nzt("onColumnNameChanged",t,n))},T.prototype.onRowsAdded=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,A,I,x,i=this,r=D(i.columnNames),o=i.data,a=i.dzt,u=i.vzt,s=i.mzt,c=i.gzt,f=i.uzt,l=i.Azt,h=i.izt,d=i.rzt,v=i.Mct;for(i.bzt=[],m=0;m<n;m++)o.splice(t,0,new Array(r));for(g=0;g<r;g++){for(m=0;m<n;m++)a[g]&&a[g].splice(t,0,N);if(w=void 0,b=u[g]){for(y=k,M=0;M<D(b);M++){for(C=s[g][M],S=0;S<D(C);S++)C[S]>=t&&(C[S]+=n);_.isEquals(b[M],k)&&(y=C,w=M)}for(y||(y=[],b.push(k),w=D(b)-1,i.pzt[g].null=w,s[g].push(y),f[g]&&-1===v.indexOf(g)&&(f[g][w]=!0,l[g].push(w))),T=t;T<t+n;T++)y.push(T);for(p=t;p<t+n;p++)c[g].splice(p,0,w)}}for(A=!0,m=0;m<D(v);m++)I=c[g=v[m]][t],!0!==f[g][I]&&(A=!1);for(m=0;m<D(d);m++)d[m]>=t&&(d[m]+=n);for(p=D(o)-1;t+n<=p;p--)h[p]=h[p-n];for(x=0<D(v),p=t;p<t+n;p++)A&&d.push(p),h[p]=!x;e||i.Nzt("onRowsChanged",t,n,!0)},T.prototype.onRowsRemoved=function(t,n){this.kzt(t,n,!0)},T.prototype.kzt=function(t,n,e){var i,r,o,a,u,s,c,f,l,h,d,v,m,g,p,i=this,r=i.Azt,o=i.vzt,a=i.uzt,u=i.data,s=D(i.columnNames),c=i.dzt;for(u.splice(t,n),l=0;l<s;l++){if(c[l]&&c[l].splice(t,n),d=[],(h=r[l])&&e){for(f=0;f<D(h);f++){for(v=i.getRowIndexes(i.columnNames[l],h[f]),m=!0,g=0;g<D(v);g++)if(v[g]<t||v[g]>=t+n){m=!1;break}m||d.push(o[l][h[f]])}r[l]=[],a[l]=[]}if(w(i,l),h&&e)for(f=0;f<D(d);f++)p=i.pzt[l][d[f]],r[l].push(p),a[l][p]=!0}e&&b(i),i.Nzt("onRowsChanged",t,n,!1)},T.prototype.onColumnsRemoved=function(t,n){for(var e,i,r,o,a,u,s,c,f,l,h,d,v,e=this,i=e.data,r=[],o=e.Mct,a=t+n,u=t;u<a;u++)(s=e.columnNames[u])&&(c=u,r.push(s),-1!==o.indexOf(c))&&e.doUnfilter(s);for(f=e.uzt||e.azt,l=e.Azt||e.Mzt,h=e.hzt,u=0;u<D(i);u++)i[u].splice(t,n);for(d in e.bzt=[],e.columnNames.splice(t,n),e.dzt.splice(t,n),e.vzt.splice(t,n),e.pzt.splice(t,n),e.mzt.splice(t,n),e.gzt.splice(t,n),f.splice(t,n),l.splice(t,n),h)h[d]>=t+n&&(h[d]-=n);for(u=0;u<D(r);u++)delete h[(s=r[u]).toUpperCase()],t=e.getColumnIndex(s),-1!==(v=o.indexOf(t))&&o.splice(v,1),e.Nzt("onColumnRemoved",r[u])},T.prototype.Dzt=function(){return this.bzt},T.prototype._zt=function(){return this.Szt},T.prototype.Czt=function(t){var n,e,i,r,o,a,a,u,s,c,f,l,h,n=this,e=n.data;for(n.dzt[t]||w(n,t),i=D(e),r=[],o=0;o<i;o++)a=p(a=e[o][t])?a.value:a,r.push(a);for(u=_.quickSort(r),s=n.bzt[t]=[],c=n.Szt[t]=[],f=n.yzt[t]=[],l=0;l<D(u);l++)h=u[l],s.push(h.value),c.push(h.index),f[h.index]=l},T.prototype.getColumnIndex=function(t){var t=this.hzt[t.toUpperCase()];return void 0===t?-1:t},T.prototype.getFilteredRowIndexes=function(){var t=this;return t.ezt?t.szt:t.rzt},T.prototype.getFilteredOutRowIndexes=function(){for(var t,n,e,i,r,t=this,n=D(t.data),e=t.ezt?t.ozt:t.izt,i=[],r=0;r<n;r++)e[r]||i.push(r);return i},T.prototype.getData=function(t,n){var e,i,r,o,t,t,n,a,u,s,e=this,i=e.dzt,r=e.getColumnIndex(t);if(0<=r){if(n){for(e.bzt[r]||e.Czt(r),o=i[r],t=e.bzt[r],n=(t=e.Tzt(t,n)).start,a=t.end,u=[],s=n;s<=a;s++)u.push(o[e.Szt[r][s]]);return u}return i[r]||w(e,r),i[r]}return[]},T.prototype.aggregateData=function(t,n,e){var i,t,r,e,t,o,e,o,i,t,r,i=this,t=i.getColumnIndex(t);return t<0?N:(i.bzt[t]||i.Czt(t),o=D(t=i.bzt[t]),r=(e=i.Tzt(t,e)).start,e=e.end,5===n?o<=r?N:t[r]:4===n?e<0?N:t[e]:3===n?e<r?0:e-r+1:(i=(o=i.Ezt(t,n,r,e)).data1,t=o.data2,r=o.data3,1===n?i/=t:7===n||10===n?(i=(r*t-i*i)/(r*(r-1)),i=7===n?Math.sqrt(i):i):8!==n&&11!==n||(i=(r*t-i*i)/(r*r),i=8===n?Math.sqrt(i):i),i))},T.prototype.Ezt=function(t,n,e,i){for(var r,o,a,u,s,c,r=6===n?1:0,o=0,a=0,u=e;u<=i;u++)(s=t[u])===k&&s===N||l(s,c={value:k})&&(s=c.value,1===n?(r+=s,o++):2===n?r++:9===n?r+=s:6===n?r*=s:7!==n&&8!==n&&10!==n&&11!==n||(r+=s,o+=s*s,a++));return{data1:r,data2:o,data3:a}},T.prototype.Tzt=function(t,n){var e=D(t),i,r,o,a;if(n){if(n.min===-1/0)i=0;else for(o=0;o<e;o++)if(a=t[o],_.isEquals(n.min,a)||_.isGreaterThan(a,n.min)){i=o;break}if(i===N&&(i=e),r===1/0)r=e-1;else{for(o=e-1;0<=o;o--)if(a=t[o],_.isEquals(a,n.max)||_.isGreaterThan(n.max,a)){r=o;break}r===N&&(r=-1)}}else i=0,r=e-1;return{start:i,end:r}},T.prototype.getExclusiveData=function(t){var n=this,e=n.vzt,t=n.getColumnIndex(t);return 0<=t?(e[t]||w(n,t),e[t]):[]},T.prototype.getRowIndexes=function(t,n){var e=this,t=e.getColumnIndex(t);return 0<=t?(e.gzt[t]||w(e,t),e.mzt[t][n]):[]},T.prototype.getExclusiveRowIndex=function(t,n){var e=this,t=e.getColumnIndex(t);return e.fue(t,n)},T.prototype.fue=function(t,n){var e=this,i=e.gzt;return 0<=t?(i[t]||w(e,t),i[t][n]):-1},T.prototype.getFilteredIndexes=function(t){var n=[],e;return this.jzt(t,n,{}),n},T.prototype.jzt=function(t,n,e){for(var i,r,o,a,u,u,i=this,r=i.ezt?i.szt:i.rzt,o=i.getColumnIndex(t),a=0;a<D(r);a++)u=r[a],A(u=i.fue(o,u))||(e[u]?e[u]++:(e[u]=1,n.push(u)))},T.prototype.getFilteredRanges=function(t){return d(this,t,!1)},T.prototype.getFilteredOutRanges=function(t){return d(this,t,!0)},T.prototype.getFilteredOutIndexes=function(t,n){var e=this;return(0===n?m:1===n?g:y)(e,t)},T.prototype.attachListener=function(t){-1===this.aT.indexOf(t)&&this.aT.push(t)},T.prototype.detachListener=function(t){for(var n,e,n=this.aT||[],e=0;e<D(n);e++)if(n[e]===t){n.splice(e,1);break}},T.prototype.suspendFilteredEvents=function(){this.Upt++},T.prototype.resumeFilteredEvents=function(){var t=this;t.Upt--,0===t.Upt&&t.onFiltered()},T.prototype.doFilter=function(t,n,e){this.Ozt(t,n,e),this.onFiltered()},T.prototype.Ozt=function(t,n,e){var i,r,o,i=this,r=i.Mct,o=i.getColumnIndex(t);o<0||(e?(i.ezt=!0,i.lzt=o):i.ezt&&S(i,!1),r.indexOf(o)<0&&r.push(o),n.ranges?M(i,t,n.ranges,e):C(i,t,n.exclusiveRowIndexes,e))},T.prototype.clearPreview=function(){S(this,!0)},T.prototype.doUnfilter=function(t){this.Rzt(t),this.onFiltered()},T.prototype.Rzt=function(t){var n,t,t,n=this;n.ezt&&S(n,!1),(t=n.getColumnIndex(t))<0||(delete n.Mzt[t],delete n.azt[t],delete n.uzt[t],delete n.Azt[t],b(n),0<=(t=n.Mct.indexOf(t))&&n.Mct.splice(t,1))},T.prototype.onFiltered=function(){var t=this;0===t.Upt&&t.Nzt("onFiltered",{rowIndexes:t.getFilteredRowIndexes(),isPreview:t.ezt})},T.prototype.getListener=function(){return this.aT},n.GeneralSlicerData=T},"./src/plugins/sparkline/sparkline.entry.ts":function(t,n,e){var i,r,i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){t[i=void 0===i?e:i]=n[e]}),r=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./src/plugins/sparkline/sparkline.ts"),n)},"./src/plugins/sparkline/sparkline.ts":function(n,l,e){var i,r,h,d,it,J,v,m,rt,B,E,nt,_,I,ot,at,et,D,V,ut,z,F,st,ct,ft,lt,o,bt,ht,wt,dt,x,Z,Y,K,N,X,g,P,G,U,q,$,tt,j,yt,Mt,Ct,St,O,R,L,Tt,At,It,a,S,xt,Nt,p,b,w,y,M,kt,T,_t,Dt,jt,Ot,Et,Rt,Ft,C,u,s,c;function Lt(t){this.x=t.x,this.y=t.y}function Bt(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}function A(t,n){return{x:t,y:n}}function Pt(t,n,e,i){return{x:t,y:n,width:e,height:i}}function Gt(t,n){for(var e,i,r,o,a,e=t[0],i=e&&e.value?e.value:e,o=1,a=t.length;o<a;o++)r=(e=t[o])&&e.value?e.value:e,(n&&r<i||!n&&i<r)&&(i=r);return i}function H(t,n,e,i,r,o,a){o&&(t.strokeStyle=o),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(n,e),t.lineTo(i,r),t.stroke()}function Ut(t,n,e,i,r,o,a){t.save(),o&&(t.strokeStyle=o),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(n,e),t.lineTo(i,r),t.closePath(),t.stroke(),t.restore()}function Ht(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g;if(t.save(),s=[o,a],t.setLineDash)t.beginPath(),t.strokeStyle=u,t.setLineDash(s),t.stroke(),t.moveTo(n,e),t.lineTo(i,r);else for(t.beginPath(),t.lineWidth=1,t.strokeStyle=u,l=(i-n)/(c=V(D(i-n,2)+D(r-e,2))),h=(r-e)/c,v=d=0;d<c;)d+=m=ot(s[v%2],c-d),(g=++v%2)&&t.moveTo(n,e),n+=m*l,e+=m*h,g&&t.lineTo(n,e);t.stroke(),t.restore()}function vt(t,n,e,i,r,o,a,u,s,c,f,l){n?H(t,e,i,r,o,f,l):H(t,a,u,s,c,f,l)}function k(t,n,e,i,r,o,a,u){t.save(),a&&(t.fillStyle=a),t.textBaseline=u||$,t.beginPath(),t.font=r,t.textAlign=o,t.fillText(i="string"==typeof i?i:i+"",n,e),t.restore()}function W(t,n,e,i,r,o,a){n=Math.floor(n),e=Math.floor(e),i=Math.floor(i),r=Math.floor(r),a%2!=0&&(n===i?(n+=.5,i+=.5):e===r&&(e+=.5,r+=.5)),H(t,n,e,i,r,o,a)}function Vt(t,n,e,i,r,o,a,u,s,c){var f,l,h,d;switch(o=Math.round(o),a=Math.round(a),s){case 0:a=Math.round(e+u),d=Math.round(a),h=Math.round(o+u),f=Math.round((o+h)/2),l=Math.round(a-Math.sin(nt/3)*u);break;case 1:o=Math.round(n+i-u),h=Math.round(o),d=Math.round(a+u),f=Math.round(o+Math.sin(nt/3)*u),l=Math.round((a+d)/2);break;case 2:a=Math.round(e+r-u),d=Math.round(a),h=Math.round(o+u),f=Math.round((o+h)/2),l=Math.round(a+Math.sin(nt/3)*u);break;case 3:o=n+u,h=Math.round(o),d=Math.round(a+u),f=Math.round(o-Math.sin(nt/3)*u),l=Math.round((a+d)/2)}t.beginPath(),t.moveTo(o,a),t.lineTo(f,l),t.lineTo(h,d),t.closePath(),t.fillStyle=c,t.fill()}function zt(t,n,e,i,r){t.beginPath(),t.fillStyle=r,t.arc(n,e,i,0,2*Math.PI),t.fill()}function Yt(t,n,e,i,r,o){var n;n?zt(t,e+(n=r/2),i+n,n,o):gt(t,e,i,r,r,o)}function Zt(t,n,e,i,r,o,a,u,s,c,f,l,h,d,v){var m,g,p,b,w,y;s?(m=Math.floor(n+.5*i),g=Math.floor(u?c-f:c),p=Math.floor(l),b=Math.floor(f),w=Math.floor(m-d/2),y=Math.floor(u?g-d/2:g+b+d/2),W(t,m,g,m,g+b,o,p)):(m=Math.floor(u?c:c-f),g=Math.floor(e+.5*r),p=Math.floor(f),b=Math.floor(l),w=Math.floor(u?m+p+d/2:m-d/2),y=Math.floor(g-d/2),W(t,m,g,m+p,g,o,b)),h?Wt(t,n,e,i,r,w,y,d,s,u,o):s?Yt(t,v,w,u?y:y-=d,d,a):Yt(t,v,u?w-=d:w,y,d,a)}function Wt(t,n,e,i,r,o,a,u,s,c,f){t.save(),Vt(t,n,e,i,r,o,a,u,s?c?0:2:c?1:3,f),t.restore()}function Qt(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,c,o,g,v=4,m=void 0;t.save(),t.beginPath(),t.rect(n,e,i,r),t.clip(),t.font=s+yt,t.fillStyle=Z,t.fillStyle="black",c?(t.textBaseline=q,0<(m=s+(c=h<d?d:h)+o+4+d/2)?(t.textAlign=P,f?t.fillText(u,n+i/2+d/2,l-c/2):t.fillText(u,n+i/2+d/2,l+c/2)):(t.textAlign=U,f?t.fillText(u,n+i/2,l-c-d/2-s):t.fillText(u,n+i/2,l+c+d/2+4))):(t.textBaseline=tt,0<(m=(o=t.measureText(u).width)+h+a+4+d/2)?h+d/2<o?f?(t.textAlign=G,t.fillText(u,l-4,e+r/2)):(t.textAlign=P,t.fillText(u,l+d/2,e+r/2)):(t.textAlign=U,f?t.fillText(u,l+h/2,e+r/2+s):t.fillText(u,l-h/2,e+r/2+s)):f?(t.textAlign=P,t.fillText(u,g=l+h+d/2+4,e+r/2)):(t.textAlign=G,t.fillText(u,g=l-h-d/2-4,e+r/2))),t.restore()}function Jt(t){return h.ft.rp(v(t))<127.5?x:Z}function mt(t,n,e,i,r,o,a,u){var s,c,f,l,u,s=u;return it(u)&&(s=r),u=a?(c=n+s+o,l=i-2*s,f=t+r,e-2*r):(c=t+s,l=e-2*s,f=n+r,i-2*r),{left:c,top:f,width:l,height:u}}function Kt(t,n){for(var e,i,r,e=0,i=0,r=t.length;i<r;i++)e+=n&&!n(t[i])?0:t[i];return e}function Xt(t){return t*nt/180}function qt(t,n,e,i){for(var r,o,a,u,s,r=[],a=0,u=0,s=t.length;a<s;a++)n?(n(t[a])?r[u]=e?e(t[a]):t[a]:r[u]=0,u++):(o=ft(t[a]),!ct(o)&&isFinite(o)&&(r[u]=o,u++));return i&&i(r),r}function gt(t,n,e,i,r,o){var a=et(n+i),u=et(e+r);n=et(n),e=et(e),i=et(a-n),r=et(u-e),t.beginPath(),t.fillStyle=o,t.fillRect(n,e,i,r),t.fill()}function $t(t,n,e){return t=ot(t,n),t=at(t,e)}function pt(t,n,e,i,r){t.save(),t.rect(n,e,i,r),t.clip()}function tn(t,n){var e,i,r,o;return t&&n&&(e=at(t.x+t.width,n.x+n.width),i=at(t.y+t.height,n.y+n.height),r=ot(t.x,n.x),o=ot(t.y,n.y),e-r<=t.width+n.width)&&i-o<=t.height+n.height}function nn(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,a=e+r/2,u=i+o/2,s=5,c=ot(r,o)/2-5,f=-.5*nt,h=a+c*I(f),d=u+c*_(f),v=[],m=[];if(!(c<=0)){for(b=en(p=(g=qt(n.values,function(t){return!it(t)&&!ct(t)&&isFinite(t)},function(t){return ut(t)},function(t){1===t.length&&(t[1]=1-t[0])})).length,n.colors),w=Kt(g),t.save(),y=0;y<p;y++)l=f+g[y]/w*2*nt,t.beginPath(),t.moveTo(a,u),t.lineTo(h,d),t.arc(a,u,c,f,l,!1),t.lineTo(a,u),t.fillStyle=b[y],t.fill(),v.push(h),m.push(d),h=a+c*I(f=l),d=u+c*_(f);for(y=0;y<p;y++)H(t,a,u,v[y],m[y],x);t.restore()}}function en(t,n){var e,i,r,o,a,u,s,c,e=[],i=n.length;if(t<=i)e=n.slice(0,t);else{for(0===i?(e.push("darkgray"),i=1):e=n.slice(0),r=[],a=t-i+1,u=o=void 0,u=0;u<i;u++)r[u]=v(e[u]);for(u=i;u<t;u++){for(s in o=r[u%i])o.hasOwnProperty(s)&&(c=o[s],o[s]=E(c-c/a*(u/i)));o.a=255,e[u]=h.ft.j(o)}}return e}function rn(t){var n=c.call(this,A(t.x,t.y))||this;return n.value=t.value,n}function on(t,n,e){return{x:t,y:n,value:e}}function an(t){return isNaN(t)||t===1/0?0:t}function un(e,t,n,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,t,s,t,T,A,I,x,N,k,_,D,j,O,E;if(e.save(),a=t.points,u=t.mini,s=t.maxi,c=t.line1,f=t.line2,l=t.colorPositive,h=t.colorNegative,d=5,a=qt(a,function(t){return!it(t)&&!ct(t)&&isFinite(t)}),l=it(l)?"#787878":l,h=it(h)?ht:h,t=Gt(a,!1),s=it(s)?t:s,m=at(s,t),s=Gt(a,!0),u=it(u)?s:u,v=ot(u,s),g=(g=(m=m<0?0:m)<(g=0)?m:0)<(v=0<v?0:v)?v-1:g,p=a.length,t=mt(n,i,r,o,5),b=t.left,w=t.top,y=t.width,M=t.height,C=an(y/(p-1)),T=[],S=an((m-v)/M))for(N=x=void 0,k=w+an((m-g)/S),D=_=void 0,j=0;j<p;j++)x=a[j],_=b+C*j,D=w+an((m-x)/S),0===j&&T.push(new Dt(on(_,k,g))),0<j&&x*a[j-1]<0&&(I=T[T.length-1])&&(N=sn(I.x,I.y,_,D,k),T.push(new Dt(on(N,k,g)))),T.push(new Dt(on(_,D,x))),j===p-1&&T.push(new Dt(on(_,k,g)));for(e.beginPath(),O=0,E=T.length;O<E;O++)(A=T[O])&&(0===O?e.moveTo(A.x,A.y):e.lineTo(A.x,A.y),I=T[O-1],A.value===g)&&I&&(e.fillStyle=I.value>g?l:h,e.fill(),O!==E-1)&&(e.beginPath(),e.moveTo(A.x,A.y));function R(t){var t,n,t;t===rt&&typeof t!==F||(t=$t(t,m,v),t=et(w+(n=0!==S?(m-t)/S:M/2))-.5,H(e,b,t,b+y,t,Y))}R(c),R(f),e.restore()}function sn(t,n,e,i,r){return((n-r)*e+(r-i)*t)/(n-i)}function cn(r,t,n,F,L,B){var e,i,P,G,U,H,o,a,u,s,c,f,V,l,z,h,d,Y,Z,v,m,g,p,b,w,y,M,C,W,Q,J,M,S,T,A,I,x,N,k,_,D,t,j,O,E,R,t,e,i,n,e=t.points1,i=t.points2,P=t.minX,G=t.maxX,U=t.minY,H=t.maxY,o=t.hLine,a=t.vLine,u=t.xMinZone,s=t.xMaxZone,c=t.yMinZone,f=t.yMaxZone,V=t.tags,l=t.drawSymbol,z=t.drawLines,h=t.color1,d=t.color2,Y=t.dash,Z=4,t=mt(n,F,L,B,5),j=t.left,O=t.top,E=t.width,R=t.height;if(e&&!(e.length<=0)&&!((v=dn(e)).length<=0||i&&0<i.length&&(m=dn(i)).length<=0)){for(pt(r,n,F,L,B),r.beginPath(),l=!!it(l)||l,h=it(h)?bt:h,d=it(d)?ht:d,X(v,U,H,P,G),!it(u)&&!it(s)&&!it(c)&&!it(f)&&b<=u&&u<=w&&b<=s&&s<=w&&g<=c&&c<=p&&g<=f&&f<=p&&(t=at(b,u),e=ot(w,s),i=at(g,c),n=ot(p,f),gt(r,j+(t-b)*E/(w-b),O+(p-(n=n<=i?i+1:n))*R/(p-g),((e=e<=t?t+1:e)-t)*E/(w-b),(n-i)*R/(p-g),dt)),N=x=-lt,_=k=lt,C=v.length,y=0;y<C-1;y++)K(v,y,h,$),V&&(0===y&&(N<T&&(x=S,N=T),T<_)&&(k=S,_=T),N<I&&(x=A,N=I),I<_)&&(k=A,_=I);if(m&&0<m.length)for(X(m,g,p,b,w),C=m.length,y=0;y<C-1;y++)K(m,y,d,tt);V&&(q(x,N,ht),q(k,_,"#0000FF")),!it(o)&&g<=o&&o<=p&&(D=et(O+(p-o)*R/(p-g))-.5,hn(r,j,D,j+E,D,ht)),!it(a)&&b<=a&&a<=w&&(D=et(j+(a-b)*E/(w-b))-.5,hn(r,D,O,D,O+R,ht)),r.restore()}function K(t,n,e,i){M=t[n],W=M.x,Q=M.y,M=t[n+1],J=M.x,M=M.y,S=j+(W-b)*E/(w-b),A=j+(J-b)*E/(w-b),T=O+(p-Q)*R/(p-g),I=O+(p-M)*R/(p-g),z&&hn(r,S,T,A,I,e,Y),l&&(0===n&&i(S,T),i(A,I))}function X(t,n,e,i,r){var o,t,o=fn(t,!0),t=fn(t,!1);g=it(U)?o.y:n,p=it(H)?t.y:e,b=it(P)?o.x:i,w=(w=it(G)?t.x:r)<=b?b+1:w,p=p<=g?g+1:p}function q(t,n,e){r.beginPath(),r.arc(t-2,n-2,2,0,2*nt,!1),r.fillStyle=e,r.fill()}function $(t,n){r.beginPath(),r.strokeStyle=h,r.arc(t-2,n-2,2,0,2*nt,!1),r.stroke()}function tt(t,n){r.beginPath(),r.strokeStyle=d,r.strokeRect(t-2,n-2,4,4)}}function fn(t,n){for(var e,i,r,o,a,u,e=n?1:-1,i=n?ot:at,r=new T(A(e*lt,e*lt)),o=t.length,u=0;u<o;u++)a=t[u],r.x=i(r.x,a.x),r.y=i(r.y,a.y);return r}function ln(t,n,e,i){return e/i*(n-t)+t}function hn(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S;if(a){for(u=V(D(i-n,2)+D(r-e,2)),c=6,f=2,l=4,g=m=v=d=void(s=0),g=n<=i?(v=i,m=d=n,e):(v=n,m=d=i,r),b=e-(p=(r-e)/(i-n))*n,(h=[]).push(new T(A(m,g))),w=[6,4,2,4];s<u;)for(y=0,M=w.length;y<M;y++)(s+=w[y])<=u&&(m=ln(d,v,s,u),h.push(new T(A(m,g=p*m+b))));for(C=0,S=h.length;C<S-1;C+=2)H(t,h[C].x,h[C].y,h[C+1].x,h[C+1].y,o)}else H(t,n,e,i,r,o)}function dn(t){var n,e,i,r,o,n=[],e=t.length;if(0<e)if(e<(i=t[0].length)){if(2<=e)for(r=0;r<i;r++)n.push(new T(A(t[0][r],t[1][r])))}else if(2<=i)for(o=0;o<e;o++)n.push(new T(A(t[o][0],t[o][1])));return n}function vn(a,t,u,s,c,f){var n,e,i,r,o,l,h,d,v,m,g,p,b,w,y,M,C,t,g,S,T,A,S,I,x,b,N,k,i,w,r,d,_,D,j,n=t.measure,e=t.target,i=t.maxi,r=t.good,o=t.bad,l=t.forecast,h=t.tickUnit,d=t.colorScheme,v=t.vertical,m=5,g=t.measureColor,p=t.targetColor,b=t.maxiColor,w=t.goodColor,y=t.badColor,M=t.forecastColor,C=t.allowMeasureOverMaxi,t=t.barSize;if(!(it(i)||i<0)&&(it(t)||!(ct(t)||t<=0))){if(1<t&&(t=1),n=it(n)||n<0?0:n,r=it(r)||r<0?0:r,o=it(o)||o<0?0:o,e=it(e)?0:e,l=it(l)?0:l,h=it(h)?0:h,d=it(d)?"#A0A0A0":d,g=it(g)?"#252525":g,i<n&&!C&&(n=i,g=ht),i<r&&(r=i,g=ht),i<o&&(o=i,g=ht),i<e&&(e=0,g=ht),i<l&&(l=i,g=ht),S=mt(u,s,c,f,5,f-10,v),T=S.left,A=S.width,a.save(),S=it(t)?.2:(1-t)/2,I=it(t)?.6:t,x=C?at(i,n):i,O(it(b)?J(d,1.66):b,i,x,S,I),O(it(w)?J(d,1.33):w,r,x,S,I),O(it(y)?d:y,o,x,S,I),b=.25*t/.6,O(g,n,x,N=it(t)?.375:(1-b)/2,k=it(t)?.25:b),0<l&&(i=T,A<(w=A*(l/x))&&(w=A),r=it(t)?3:3*t/.6,vt(a,v,u+.5*c,i,u+.5*c,i-w,i,s+.5*f,i+w,s+.5*f,it(M)?"#3690BF":M,r)),0<e&&(d=et(T-(v?1:-1)*A*(e/x))-.5,vt(a,v,u+c*S,d,u+c*(1-S),d,d,s+f*S,d,s+f*(1-S),it(p)?ht:p,1)),0<h)for(_=E(x/h),D=void 0,j=0;j<=_;j++)D=et(T-A/x*h*(v?1:-1)*j)-.5,vt(a,v,u,D,u+.05*c,D,D,s+f,D,s+.95*f,wt,1);a.restore()}function O(t,n,e,i,r){var o,t,n;a.fillStyle=t,A<(t=A*(n/e))&&!C&&(t=A),n=new _t(v?Pt(u+c*i,T-t,c*r,t):Pt(T,s+f*i,t,f*r)),a.fillRect(n.x,n.y,n.width,n.height)}}function mn(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,n,v,n,v,m,g,p,b,w,y,M,C,S,T,A,I,x,I,N,k,_,D,j,a=n.spreadData,u=n.showAverage,s=n.scaleStart,c=n.scaleEnd,f=n.style,l=n.colorScheme,h=n.vertical,d=5,n=a.length;if(!(n<=0)){for(v=a[0].key,n=a[n-1].key,s=it(s)?v:s,c=it(c)?n:c,f=it(f)?4:f,l=it(l)?wt:l,m=(v=mt(e,i,r,o,5,o-10,h)).left,g=v.width,p=v.top,b=v.height,pt(t,e,i,r,o),t.beginPath(),t.strokeStyle=l,t.fillStyle=l,M=Gt(a,!(t.lineWidth=2)),S=0,T=a.length;S<T;S++)if(I=(A=a[S]).key,x=A.value,w=m+(h?-1:1)*g*(I-s)/(c-s),w=h?(w=ot(w,m),at(w,m-g)):(w=at(w,m),ot(w,m+g)),w=et(w),1===f)vt(t,h,I=p+b/2-(C=(C=x/2*b/M)<.5?.5:C),w,N=p+b/2+C,w,w,I,w,N);else if(4===f)vt(t,h,p,w,p+(C=(C=x*b/M)<1?1:C),w,w,p+b,w,p+b-C);else if(6===f)vt(t,h,p,w,p+b,w,w,p,w,p+b);else for(k=2,_=1;_<=x;_++){switch(f){case 2:y=p+b/2-5-(x/2-_)*b/M;break;case 3:y=p+b-5-(D=gn(x,b,3,A.randomNumbers))[_-1];break;default:y=p+b-_*b/M}y=et(y),t.beginPath(),t.fillRect(h?y:w,h?w:y,2,2)}u&&vt(t,h,p-5,w=m-(h?1:-1)*g*((j=pn(a))-s)/(c-s),p+b+5,w,w,p-5,w,p+b+5,ht),t.restore()}}function gn(t,n,e,i){for(var r,o,a,u,s,c,r=[],o=at(100,10*t),a=0,u=[],s=0;r.length<t;)c=E(i[s]*n),s++,(o<a||bn(c,u))&&(r.push(c),u.push([c-e,c+e])),a++;return r}function pn(t){for(var n,e,i,r,o,n=0,e=0,i=0,r=t.length;i<r;i++)e+=(o=t[i]).value,n+=o.key*o.value;return 0===e?0:n/e}function bn(t,n){for(var e,i,r,e=0,i=n.length;e<i;e++)if((r=n[e])[0]<=t&&t<=r[1])return;return 1}function wn(r,t,n,e,i,o,a){var u,s,c,f,l,h,d,v,m,g,F,p,b,w,L,y,t,t,M,C,S,T,A,I,x,N,k,_,I,D,j,O,E,u=t.points,s=u&&u.length,c=t.colorRange,f=t.labelRange,l=t.maximum,h=t.targetRed,d=t.targetGreen,v=t.targetBlue,m=t.targetYellow,g=t.color,F=t.highlightPosition,p=t.vertical,b=t.textOrientation,w=t.textSize,L=5;if(!(it(u)||s<=0)){if(g=it(g)?wt:g,it(c)||c.length!==s||yn(c))for(c=[],y=0;y<s;y++)c.push(J(g,1+y/s));for(t=Kt(u,function(t){return 0<t}),l=it(l)||l<t?t:l,b=it(b)?0:b,w=it(w)||w<=0?10:w,w=ct(w)?w:w*a.zoomFactor,t=mt(n,e,i,o,5,o-10,p),M=t.left,C=t.width,S=t.top,T=t.height,r.save(),A=M,D=0,j=s;D<j;D++)(I=u[D])<=0||(I=I/l*C,_=p?(x=n+.15*i,k=.7*i,N=A-I,I):(x=A,k=I,N=e+.15*o,.7*o),O=D+1===F?ht:c[D],r.save(),r.fillStyle=O,r.fillRect(x,N,k,_),(E=f&&f[D])&&(r.save(),r.fillStyle=Jt(O),r.textBaseline=tt,r.textAlign=U,r.font=w+yt,r.rect(x,N,k,_),r.clip(),1===b?(r.translate(x+k/2,N),r.rotate(Math.PI/2),r.fillText(E,_/2,0)):r.fillText(E,x+k/2,N+_/2),r.restore()),A+=(p?-1:1)*I,r.restore());R(X,h,function(t){return 0<t}),R(K,d),R(Y,v),R("yellow",m),r.restore()}function R(t,n,e){var i,e;n!==rt&&n!==B&&(n=l<n?l:n,!e||e(n))&&(e=(n=n<0?0:n)/l*C,p?(i=et(M-e)-.5,H(r,S,i,S+T,i,t)):(i=et(M+e)-.5,H(r,i,S,i,S+T,t)))}}function yn(t){for(var n=0,e=t.length;n<e;n++)if(it(t[n]))return 1}function Mn(t,n,e,i,r,o){H(t,f(n),f(e),f(i),f(r),it(o)?Z:o,1)}function Cn(e,i,r,t,n){var t,o,a,u,s,c,t=.4*t;switch(i=f(i),r=f(r),e.beginPath(),e.moveTo(i,r),o=t/2,a=V(3)*t/2,u=t/V(3),n){case 0:s=[-o,0,o],c=[a,u,a];break;case 2:s=[-o,0,o],c=[-a,-u,-a];break;case 3:s=[a,u,a],c=[-o,0,o];break;case 1:s=[-a,-u,-a],c=[-o,0,o];break;default:s=[],c=[]}s.forEach(function(t,n){e.lineTo(f(i+t),f(r+c[n]))}),e.lineTo(i,r),e.closePath(),e.fillStyle=x,e.fill()}function Sn(t,n,e,i,r,o,a){var u,s,c,f,e,l,h,d,v,m,g,p,b,w,u,f,y,e,b,e,e,t,M,u=e.value,s=e.colorScheme,c=e.axisVisible,f=e.barHeight,e=e.barWidth,l=5,h=5,d=!1,u=ft(u);if(!ct(u)){if(it(f=0===t?f:e))y=.7;else{if(ct(f)||f<=0)return;y=Math.min(1,f)}1<u?(u=1,d=!0):u<-1&&(u=-1,d=!0),s=it(s)?"grey":s,c=!!it(c)||c,n.save(),0===t?(e=o-10,b=a*y,b=0<=u?(d&&(v=new T(A(i+5+e-5,r+a/2))),m=new _t(Pt(i+5,r+a*(1-y)/2,e*u,b)),g=new T(A(i+5,r+1)),p=new T(A(i+5,r+a)),1):(e=ut(e*u),d&&(v=new T(A(i+5+5,r+a/2))),m=new _t(Pt(i+o-5-e,r+a*(1-y)/2,e,b)),g=new T(A(i+o-5,r+1)),p=new T(A(i+o-5,r+a)),3),w=it(f)?a:a*y):1===t&&(e=a-10,t=o*y,p=0<=u?(m=new _t(Pt(i+(1-y)/2*o,r+a-5-(M=e*u),t,M)),d&&(v=new T(A(i+o/2,r+a-5-M+5)),b=0),g=new T(A(i+1,r+a-5)),new T(A(i+o,r+a-5))):(u=ut(u),m=new _t(Pt(i+(1-y)/2*o,r+5,t,e*u)),d&&(v=new T(A(i+o/2,r+5+e-5)),b=2),g=new T(A(i+1,r+5)),new T(A(i+o,r+5))),w=it(f)?o:o*y),n.beginPath(),m&&(gt(n,m.x,m.y,m.width,m.height,s),pt(n,m.x,m.y,m.width,m.height)),v&&Cn(n,v.x,v.y,w,b),n.restore(),c&&g&&Mn(n,g.x,g.y,p.x,p.y),n.restore()}}function f(t){return et(t)-.5}function Tn(t,n,e,i,r,o){Sn(0,t,n,e,i,r,o)}function An(t,n,e,i,r,o){Sn(1,t,n,e,i,r,o)}function In(w,t,y,M,C,S,n){var e,i,r,o,a,u,T,s,c,A,I,f,l,h,x,N,e,F,L,k,B,d,v,_,n,t,m,m,m,t,D,j,l,l,g,p,b,s,e=t.variance,i=t.reference,r=t.mini,o=t.maxi,a=t.mark,u=t.tickUnit,T=t.legend,s=t.colorPositive,c=t.colorNegative,A=t.vertical,F=.5,L=.25,B=5,d=ht,v=bt,_=13*n.zoomFactor,n=ft(e);if(!(ct(n)||(c=it(c)?X:c,s=it(s)?K:s,u=it(u)?0:u,o=it(o)?1:o,r=it(r)?-1:r,(e=!it(i))||(i=0),h=A?(I=M+S-5,f=S-10,l=C-20,-1):(I=y+5,f=C-10,l=S-20,1),T&&(t=ft(t.variance),ct(t)||(m=(m=t.toString()).substr(m.indexOf(".")+1).length,x=2<=m?(100*t).toFixed(m-2)+"%":(100*t).toFixed(0)+"%")),o<n&&(n=o,k=!0),n<r&&(n=r,k=!0),i=$t(i,o,r),k&&(N=$t(l,60,15)),t=f/(m=ut(o-r)),D=I+h*ut(r-i)*t,(j=ut(n-i)*t)>ut(m)*t&&(j=ut(m+r)*t),l=I+h*f,A&&D<l)||!A&&l<D)){if(pt(w,y,M,C,S),i<n?O(s,0,5-f,f-5,0,1,M-D,$,q,D-y-C,P,G,-1,ut(o-n)*t):(j>ut(m)*t&&(j=ut(m+r)*t,D=I),O(c,1,-5,5,2,3,D-M-S,q,$,y-D,G,P,1,ut(r-n)*t)),e&&(l=I+h*(Math.abs(r-i)*t),R(y,l,y+C,l,l,M,l,M+S)),0<u)for(w.beginPath(),g=m/u,p=0;p<=g;p++)R(y,b=I+f/g*p*h,y+.1*C,b,b,M+.9*S,b,M+S,v,v);!it(a)&&r<=a&&a<=o&&(w.beginPath(),s=I-(A?1:-1)*ut(r-a)*t,R(y,s,y+.33*C,s,s,M+.66*S,s,M+S,d,d),w.fill()),w.restore()}function O(t,n,e,i,r,o,a,u,s,c,f,l,h,d){var v,m,g,p,b,n;A?gt(w,v=y+.25*C,m=0===n?D-j:D,g=.5*C,p=j,t):gt(w,v=0===n?D:D-j,m=M+.25*S,g=j,p=.5*S,t),k&&(pt(w,v,m,g,p),A?Cn(w,y+C/2,I+e,N,r):Cn(w,I+i,M+S/2,N,o),w.restore()),T&&(b=void 0,n=0,k&&(n=.4*N*V(3)/2+5+2),w.save(),w.beginPath(),w.font=_+yt,w.fillStyle=Z,A?(w.textAlign=U,E(b=_+j+a,d,t,u,s,v,m,g,p,A),w.fillText(x,y+C/2,D+h*(j-n))):(w.textBaseline=tt,E(b=w.measureText(x).width+j+c,d,t,f,l,v,m,g,p,A),w.fillText(x,D+h*(n-j),M+S/2)),w.restore())}function E(t,n,e,i,r,o,a,u,s,c){c?w.textBaseline=i:w.textAlign=i,0<t&&n<j&&(w.rect(o,a,u,s),w.clip(),c?w.textBaseline=r:w.textAlign=r,w.fillStyle=Jt(e))}function R(t,n,e,i,r,o,a,u,s,c){A?Mn(w,t,n,e,i,s):Mn(w,r,o,a,u,c)}}function xn(t,n,e,i,r,o,F){var a,u,s,c,f,l,h,d,L,v,m,g,n,p,b,w,y,B,M,P,w,b,C,S,G,U,H,T,V,A,z,I,x,Y,S,N,k,x,I,_,D,j,O,E,R,a=n.plannedValue,u=n.actualValue,s=n.index,c=n.absolute,f=n.reference,l=n.mini,h=n.maxi,d=n.tickUnit,L=n.legend,v=n.colorPositive,m=n.colorNegative,g=n.lollipopHeaderColor,n=n.vertical,P=[],S="",G=.9,U=10,H=13*F.zoomFactor,T=dt,V=!1;if(!(0===a.length||0===u.length||s<0||s>=a.length||s>=u.length||h<=l||ct(u[s])||ct(a[s]))){if(m=it(m)?X:m,v=it(v)?K:v,d=it(d)?0:d,c=!it(c)&&c,B=!it(f),g=it(g)?Z:g,c){for(A=0;A<a.length&&A<u.length;A++)P.push(u[A]-a[A]);h=Gt(P,!1),l=Gt(P,!0),0<h&&0<l?l=0:h<0&&l<0&&(h=0),M=P[s],B=!(f=0)}else h=it(h)?1:h,l=it(l)?-1:l,M=(u[s]-a[s])/Math.abs(a[s]),((f=$t(f,h,l))===h&&f<M||f===l&&M<f)&&(V=!0),it(a[s])&&(V=!0);if(B||(f=0),w=n?(p=i+o-10,b=o-20,-1):(p=e+10,b=r-20,1),!c&&L?(0<(I=ft((z=M-f).toString()))&&(S="+"),!ct(I)&&isFinite(I)?y=S+(y=2<=(Y=(x=I.toString()).substr(x.indexOf(".")+1).length)?(100*I).toFixed(2)+"%":100*I+"%"):isFinite(I)||(y=S+I)):y=(S=0<M?"+":S)+(y=2<=(Y=(x=(I=ft(M)).toString()).substr(x.indexOf(".")+1).length)?I.toFixed(2):I),c?C=!1:(h<M&&(M=h,C=!0),M<l&&(M=l,C=!0)),N=b/(S=ut(h-l)),k=p+w*ut(l-f)*N,(x=ut(M-f)*N*.9)>ut(S)*N&&(x=ut(S+l)*N),I=p+w*b,!(n&&k<I||!n&&I<k))if(c||0!==a[s]&&!V){if(pt(t,e,i,r,o),_=ut(Math.ceil((h-f)/d)),D=ut(Math.floor((f-l)/d)),c){if(5/N<d)if(n){for(O=1;O<=_;O++)W(t,e,E=k+d*N*O*-1*.9,e+r,E,T,1);for(O=1;O<=D;O++)W(t,e,E=k+d*N*O*1*.9,e+r,E,T,1)}else{for(O=1;O<=_;O++)W(t,R=k+d*N*O*1*.9,i,R,i+o,T,1);for(O=1;O<=D;O++)W(t,R=k+d*N*O*-1*.9,i,R,i+o,T,1)}}else if(0<d&&d<=h&&5/N<d)if(t.beginPath(),n){for(j=10<.1*r?10:.1*r,O=1;O<=_;O++)W(t,e,E=k+d*N*O*-1*.9,e+j,E,T,1);for(O=1;O<=D;O++)W(t,e,E=k+d*N*O*1*.9,e+j,E,T,1)}else{for(j=10<.1*o?10:.1*o,O=1;O<=_;O++)W(t,R=k+d*N*O*1*.9,i+o-j,R,i+o,T,1);for(O=1;O<=D;O++)W(t,R=k+d*N*O*-1*.9,i+o-j,R,i+o,T,1)}w=Math.floor(12*F.zoomFactor),(b=Math.floor(4*F.zoomFactor))%2!=0&&(b+=1),w%2!=0&&(w+=1),f<M?Zt(t,e,i,r,o,v,g,!0,n,k,x,b,C,w,c):(x>ut(S)*N&&(x=ut(S+l)*N,k=p),Zt(t,e,i,r,o,m,g,!1,n,k,x,b,C,w,c)),L&&(f<M?Qt(t,e,i,r,o,i-k,k-e-r,y,H,n,!0,k,x,w):Qt(t,e,i,r,o,k-i-o,e-k,y,H,n,!1,k,x,w)),B&&(n?W(t,e,k,e+r,k,Z,2):W(t,k,i,k,i+o,Z,2)),t.restore()}else n?W(t,e,k,e+r,k,Z,2):W(t,k,i,k,i+o,Z,2)}}function Nn(c,t,F,L,B,n){var e,i,P,r,o,a,u,s,f,l,G,h,d,v,m,r,o,a,u,g,p,b,w,y,U,F,L,B,n,H,M,C,S,V,z,Y,Z,T,A,I,x,N,k,_,W,Q,D,j,D,j,D,J,r,o,u,K,X,q,O,r,o,E,R,$,u,t,t,tt,e=t.points,i=t.boxPlotClass,P=t.showAverage,r=t.scaleStart,o=t.scaleEnd,a=t.acceptableStart,u=t.acceptableEnd,s=t.style,f=t.colorScheme,l=t.vertical,G=5,h=Gt(e,!1),d=Gt(e,!0);if(!(it(e)||(e=qt(e)).length<=0)){for((i=i===rt||typeof i!==st?Ot:i.toLocaleLowerCase())!==Ot&&i!==jt&&i!==Et&&i!==Rt&&i!==Ft&&(i=Ot),v=ft(r),v=ct(v)?d:v,m=ft(o),m=ct(m)?h:m,r=ft(a),o=ft(u),f!==rt&&typeof f===st||(f="#D2D2D2"),(s===rt||0!==s&&1!==s)&&(s=0),a=ht,d<v&&(f=a,v=d),m<h&&(f=a,m=h),pt(c,F,L,B,n),c.lineWidth=2,g=(u=mt(F,L,B,n,5,n-10,l)).left,p=u.width,b=u.top,w=u.height,y=l?-1:1,U=t.perc02,F=t.perc09,L=t.perc10,B=t.perc90,n=t.perc91,H=t.perc98,M=t.q1,V=d,z=h,Z=Y=1.5*(S=(C=t.q3)-M),T=t.stDev,A=Kt(e)/at(1,e.length),x=I=0,N=b+.1*w,k=.7*w,_=ut(m-v),W=0,Q=e.length;W<Q;W++)(D=e[W])<M&&M-1.5*S<=D&&D-(M-1.5*S)<Y&&(Y=D-(M-1.5*S),V=D),C<D&&D<=C+1.5*S&&C+1.5*S-D<Z&&(Z=C+1.5*S-D,z=D),j=!1,I=g+p*((D-v)/_)*y,i===Et&&(D<=M-1.5*S||C+1.5*S<=D)&&(j=!0,x=D<=M-3*S||C+3*S<=D?0:1),i===jt&&(D<=U||H<=D)&&(j=!0,x=1),i===Ft&&(D<=A-2*T||A+2*T<=D)&&(j=!0,x=D<=A-3*T||A+3*T<=D?0:1),D=bt,j&&(1===s?1===x?et(.2,.8,I,D):et(.3,.7,I,D):((j=.1*w)<2&&(j=2),c.beginPath(),c.strokeStyle=D,D=b+.45*w,J=I,c.arc(l?D:J,l?J:D,j/2,0,2*Math.PI),c.stroke()));switch((r<v||m<o)&&(f="#C0FF00"),r=at(v,r),(o=ot(m,o))<r?f=a:r<o&&vt(c,l,u=b+.9*w,r=g+p*((r-v)/_)*y,u,o=g+p*((o-v)/_)*y,r,u,o,u,wt),X=ut(g+p*((C-v)/_)*y-(K=g+p*((M-v)/_)*y)),O=g+p*(((q=t.median)-v)/_)*y,i){case jt:E=U,R=H;break;case Et:E=V,R=z;break;case Ft:X=ut(g+p*((A+T-v)/_)*y-(K=g+p*((A-T-v)/_)*y)),O=g+p*((A-v)/_)*y,E=v<($=A-2*T)?$:d,R=($=A+2*T)<m?$:h,P=!1;break;default:E=d,R=h}r=g+p*((E-v)/_)*y,o=g+p*((R-v)/_)*y,u=bt,1===s?nt("#F2F2F2",N,o,k,r-o,r,N,o-r,k):vt(c,l,t=b+.45*w,r,t,o,r,t,o,t,u),nt(f,N,K-X,k,X,K,N,X,k),vt(c,l,N,O,N+k,O,O,N,O,N+k,u),0===s&&(vt(c,l,N+.3*k,o,N+.7*k,o,o,N+.3*k,o,N+.7*k,u),vt(c,l,N+.3*k,r,N+.7*k,r,r,N+.3*k,r,N+.7*k,u)),i!==jt&&i!==Rt||(tt=t=void 0,R=i===jt?(E=F,n):(E=L,B),t=g+p*((E-v)/_)*y,et(.3,.7,tt=g+p*((R-v)/_)*y,u),et(.3,.7,t,u)),P&&et(.2,.8,I=g+p*((A-v)/_)*y,a),c.restore()}function nt(t,n,e,i,r,o,a,u,s){l?gt(c,n,e,i,r,t):gt(c,o,a,u,s,t)}function et(t,n,e,i){vt(c,l,N+k*t,e,N+k*n,e,e,N+k*t,e,N+k*n,i)}}function kn(t,n,e,i,r){n=et(n),e=et(e),n===(i=et(i))&&(n=i-=.5),e===(r=et(r))&&(e=r-=.5),t.moveTo(n,e),t.lineTo(i,r)}function Q(t,n,e,i,r,o,a,u,s,c,f){t.beginPath(),t.strokeStyle=e,n?kn(t,i,r,o,a):kn(t,u,s,c,f),t.stroke()}function _n(t,n,e,i,r){t.rect(n,e,i,r),t.clip()}function Dn(t,n,e,i,r,o){var a,u,s,c,f,l,h,d,v,m,g,p,b,o,a=o.labelText,u=o.fontSize,s=o.startBox,c=o.endBox,f=o.boxColor,l=o.isInRightOrTopOfBox,h=o.fillStyle;t.save(),t.beginPath(),t.font=u+yt,g=1,h=it(h)?Z:h,o.vertical?(p=U,l?0<(d=u+c-(s-e))&&s-c-e<c?(b=q,h=Jt(f),m=s-c+1,_n(t,n,s-c,i,c)):(b=$,m=s-c-1):m=0<(d=u-(e+r-s))&&e+r-s<c?(_n(t,n,s-c,i,c),b=$,h=Jt(f),s-1):(b=q,s+1),t.textAlign=p,t.textBaseline=b,t.fillStyle=h,t.fillText(a,n+i/2,m)):(b=tt,o=t.measureText(a),l?v=0<(d=o.width+c-(n+i-s))&&n+i-(s+c)<c?(_n(t,s,e,c,r),p=G,h=Jt(f),s+c-1):(p=P,s+c+1):0<(d=o.width-(s-n))&&s-n<c?(_n(t,s,e,c,r),v=s+1,p=P,h=Jt(f)):(p=G,v=s-1),t.textAlign=p,t.textBaseline=b,t.fillStyle=h,t.fillText(a,v,e+r/2)),t.restore()}function jn(t,n,e,i,r,o,F){var a,u,L,s,c,f,l,h,B,n,P,F,d,v,L,f,l,G,m,g,p,b,w,y,M,C,S,T,U,A,H,I,x,V,N,z,k,_,s,c,c,s,D,j,c,O,Y,D,_,k,E,O,_,N,R,E,R,n,E,a=n.points,u=n.labels,L=n.pointIndex,s=n.minimum,c=n.maximum,f=n.colorPositive,l=n.colorNegative,h=n.vertical,B=n.itemTypeRange,n=n.colorTotal,P=5,F=13*F.zoomFactor;if(!it(a)&&!((d=a.length)<=0||(v=parseInt(L,10),ct(v))||v<=0||d<v)){for(u=it(u)?[]:u,l!==rt&&typeof l===st||(l="#D6604D"),typeof n!==st&&(n=rt),f=J(L=f=f!==rt&&typeof f===st?f:"#8CBF64",1.3),G=J(l=l,1.3),m=1,y=[],T=C=M=w=b=p=g=0,U=d;T<U;T++)C=a[T],S=B[T],A=!1,H=1===m,(I=!it(S))&&(S===Ct?C=ut(C):S===Mt?C=-ut(C):S===St?(A=!0,H?g=C:C=g):I=!1),y[m]=[],x=y[m],ct(C)?(x[0]=0,x[1]=g,x[2]=0):(x[0]=ut(C),g=A?g:C+g,x[1]=0<C?p:g,x[2]=C),x[3]=m,b=ot(p,b),w=at(p,w),((V=m===d)&&!I||A)&&(M=b<0?-b:0,x[1]=0<C?0:C),I&&A&&!H||(p=C+p,V&&I&&(b=ot(p,b),w=at(p,w))),m++;N=!1,it(S)||(N=-1===(z=[Mt,Ct,St]).indexOf(S)),(it(S)||N)&&(g-=C),s=ft(s),ct(s)||0<s||b<s?s=k=b:M=-(k=s),c=ft(c),ct(c)||c<0||c<w?_=w:(_=c,M=-s),s=(c=mt(e,i,r,o,5,o-10,h)).left,D=c.width,j=c.top,c=c.height,O=h?-1:1,D=D/(Y=_-k),pt(t,e,i,r,o),t.beginPath(),t.lineWidth=1,k=(_=y[v])[2],E=B[v-1],O=s+O*(_[1]+M)*D,_=_[0]*D,R=E===St,E=(it(E)||N)&&v===d||R,N=n&&E?n:1===v||E?0<=k?L:l:0<=k?f:G,h?gt(t,j,O-_,c,_,N):gt(t,O,j,_,c,N),h?(1!==v&&(v!==d?Q(t,0<k,dt,e,O,j+c,O,e,O-_,j+c,O-_):Q(t,!0,dt,e,R=s-(g+M)*D,j+c,R)),v!==d&&Q(t,0<k,dt,j,O-_,e+r,O-_,j,O,e+r,O)):(1!==v&&(v!==d?Q(t,0<k,dt,O,i,O,j+c,O+_,i,O+_,j+c):Q(t,!0,dt,n=s+(g+M)*D,i,n,j+c)),v!==d&&Q(t,0<k,dt,O+_,j,O+_,i+o,O,j,O,i+o)),E=u[v-1],0<u.length&&!it(E)&&""!==E&&Dn(t,e,i,r,o,{labelText:E,vertical:h,isInRightOrTopOfBox:0<k,fontSize:F,startBox:O,endBox:_,boxColor:N}),Q(t,h,Z,e,s-M*D,e+r,s-M*D,s+M*D,i,s+M*D,i+o),t.restore()}}function On(e,t,i,r,o,a,n){var u,s,c,f,l,h,d,v,n,m,g,p,t,b,w,s,y,M,C,S,T,A,I,b,F,d,x,N,t,b,k,d,_,D,j,O,h,E,c,R,u=t.points,s=t.pointIndex,c=t.colorRange,f=t.target,l=t.target2,h=t.highlightPosition,d=t.label,v=t.vertical,n=13*n.zoomFactor,m=t.targetColor,g=t.target2Color,p=t.labelColor,t=t.barSize;if(!it(u)&&(it(t)||!(ct(t)||t<=0))&&(1<t&&(t=1),!((b=u.length)<=0||(w=parseInt(s,10),ct(w))||w<=0||b<w))){for(c=it(c)?[]:c,s=parseInt(d,10),s=ct(s)?0:s,y=1,C=[],S=M=0,T=u.length;S<T;S++)A=u[S],C[y]=[],I=C[y],A<0||ct(A)||it(A)?(I[0]=1===y?0:M,I[1]=0):(M+=A,I[0]=1===y?0:M-A,I[1]=A),y++;F=5,b=it(t)?5:v?o*(1-t)/2:a*(1-t)/2,d=mt(i,r,o,a,b,a-10,v,5),x=d.left,N=d.width,t=d.top,b=d.height,k=v?-1:1,d=N/M,pt(e,i,r,o,a),e.beginPath(),e.lineWidth=1,D=(_=C[w])[1],j=x+k*_[0]*d,O=_[1]*d,h=w===h?ht:0===c.length||typeof c[w-1]!==st?bt:c[w-1],v?gt(e,t,j-O,b,O,h):gt(e,j,t,O,b,h),1===s?E=(_[0]+D)/M*1e3:2===s&&(E=D/M*1e3),c=et(E)/10+"%",1!==s&&2!==s||!c||Dn(e,i,r,o,a,{labelText:c,vertical:v,isInRightOrTopOfBox:(_[0]+_[1])*d<N/2,fontSize:n,startBox:j,endBox:O,boxColor:h,fillStyle:p}),R=[it(m)?"#8CBF64":m,it(g)?"#EE5D5D":g],[f,l].forEach(function(t,n){var t,t,t=L(t),t=z(x+k*N*t);Q(e,v,R[n],i,t,i+o,t,t,r,t,r+a)}),e.restore()}function L(t){var t=ft(t),t;return t=1<(t=(t=ct(t)?0:t)<0?0:t)?1:t}}function En(t,n){switch(n){case 2:var e;return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function Rn(t,n,e){var n,e,i,r,o,n;return 1<(t=t<0?0:t)&&(t=1),n=v(n),e=v(e),i=n.a*(1-t)+e.a*t,r=n.r*(1-t)+e.r*t+"",o=n.g*(1-t)+e.g*t+"",n=n.b*(1-t)+e.b*t+"","rgba("+parseInt(r,10)+","+parseInt(o,10)+","+parseInt(n,10)+","+ft(i/255+"")+")"}function Fn(t,n,e){return t===n&&t===e?1:t<=n?0:e<=t?1:(t-n)/(e-n)}function Ln(t,n,e,i,r,o){var a=(o+r)/2;return r<=i&&i<=a?Rn(Fn(i,r,a),t,n):Rn(Fn(i,a,o),n,e)}function Bn(t){var n=lt,e=-lt;return t.forEach(function(t){t!==rt&&t!==B&&(t<n&&(n=t),e<t)&&(e=t)}),{min:n,max:e}}function Pn(t,e,i,r,o,a,u){var n,s,c;r?t.forEach(function(t,n){0!==t&&t!==rt&&t!==B&&(e[i+n]=r[n]||e[i+n])}):(n=Bn(t),s=n.min,c=n.max,t.forEach(function(t,n){0!==t&&t!==rt&&t!==B&&(e[i+n]=Ln(o,a,u,t,s,c))}))}function Gn(t,n,e,i,r,o){for(var a,u,s,c,f,l,h,d,v,m,g,p,b,w,y,M,C,S,T,a=n.year,u=n.month,s=n.values,c=n.emptyColor||"lightgray",f=n.startColor,l=n.middleColor,h=n.endColor,d="white",v=6,m=7,g=2,p=(r-14)/6,b=(o-16)/7,w=[],y=new Date(a,u-1,1).getDay(),M=0;M<42;M++)!(M<y)&&M<y+En(a,u)?w[M]=c:w[M]=d;for(Pn(s,w,y,n.colors,f,l,h),t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),S=C=0;S<6;S++)for(T=0;T<7;T++)t.fillStyle=w[C],C++,t.fillRect(e+S*p+2*(S+1),i+T*b+2*(T+1),p,b);t.restore()}function Un(t){for(var n,e,i,r,n=t.getFullYear(),e=t.getMonth(),i=t.getDate(),r=1;r<e+1;r++)i+=En(n,r);return i}function Hn(t,n,e,i,r,o,a){for(var u,s,c,f,l,h,d,F,v,m,g,p,b,s,n,w,y,f,l,L,M,C,S,T,A,I,x,N,k,_,D,j,O,O,E,R,u=n.year,s=n.values,c=n.emptyColor||"lightgray",f=n.startColor,l=n.middleColor,h=n.endColor,d="white",F=7,v=parseInt(366/7+"",10)+2,m=[],g=new Date(u,0,1).getDay(),p=Un(new Date(u,11,31)),b=0;b<7*v;b++)m[b]=!(b<g)&&b<g+p?c:d;for(Pn(s,m,g,n.colors,f,l,h),t.save(),t.rect(e,i,r,o),t.clip(),w=e+(n=15*(s=a.zoomFactor)),y=i,f=r-n,l=o,t.save(),t.translate(e+n/2,y+l),t.rotate(-Math.PI/2),t.font=13*s+yt,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(u+"",l/2,0),t.restore(),M=(f-(L=2)*(v+1))/v,C=(l-16)/7,x=[],A=S=0;A<v;A++)for(T=0;T<7;T++)x[S]=I={x:w+A*M+2*(A+1),y:y+T*C+2*(T+1),w:M,h:C},t.fillStyle=m[S],S++,t.fillRect(I.x,I.y,I.w,I.h);for(N=[],k={},_=0;_<12;_++)k[_]=Un(new Date(u,_,1))-1+g;for(D=k[11]+En(u,12)-1,A=S=0;A<v;A++)for(T=0;T<7;T++)g<=S&&S<g+p&&(O=(j=new Date(u,0,S-g+1)).getMonth(),I=x[S],(O=k[O])<=S&&S<7+O&&N.push({x1:I.x,y1:I.y-1,x2:I.x,y2:I.y+I.h+1}),S!==O&&0!==j.getDay()||N.push({x1:I.x-1,y1:I.y,x2:I.x+I.w+1+(S===O?2:0),y2:I.y}),D-7<S&&S<=D&&N.push({x1:I.x+I.w,y1:I.y-1,x2:I.x+I.w,y2:I.y+I.h+1}),S!==D&&6!==j.getDay()||N.push({x1:I.x-1-(S===D?2:0),y1:I.y+I.h,x2:I.x+I.w+1,y2:I.y+I.h})),S++;for(t.strokeStyle="black",t.lineWidth=2,E=0;E<N.length;E++)R=N[E],t.beginPath(),t.moveTo(R.x1,R.y1),t.lineTo(R.x2,R.y2),t.stroke();t.restore()}function Vn(t){var n,e,i,r,o,a,u,s,c,f,n=Xt(t.minAngle-90),e=Xt(t.maxAngle-90),i=t.minValueOption.value,r=t.maxValueOption.value,o=t.ranges,a=g,u=(e-n)/(r-i),s=[];return 0<o.length&&o.forEach(function(t){c=t.start,f=t.end,s.push({start:u*(c-i)+n,end:u*(f-i)+n,color:t.color})}),s.unshift({start:n,end:e,color:a}),{paintRanges:s,fillColor:a,targetValueRadian:u*(t.targetValueOption.value-i)+n,currentValueRadian:u*(t.currentValueOption.value-i)+n,minValueRadian:n,maxValueRadian:e}}function zn(t,n,e,i,r,o,a){var o,u,s,c,f,l,o,h,f,d,v,m,g,p,l,b,a,o=o.zoomFactor,u=t.currentValueOption.normalFontHeight*o,s=t.minValueOption.normalFontHeight*o,c=t.maxValueOption.normalFontHeight*o,f=t.minAngle,l=t.maxAngle,o=t.currentValueOption.normalFontWidth*o,h=90<ut(f)||90<ut(l),f=120<ut(f)||120<ut(l),l=M*ot(i,r);return a?(d=E(i/2*y),v=E(r*y),a=.03*(g=ot(d,m=h?v/2:v)),p={x:n+i/2,y:e+r/2+(h?0:g/2),outerRadius:g,innerRadius:g*t.radiusRatio,currentValuePoint:B,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:s<(b=(r-(h?2*g:g))/2),enoughShowMaxLabel:c<b,moreThanSemiCircle:h},h?f?2*u/3<b-a-at(c,s)&&o<i-2*l&&(p.currentValuePoint={x:p.x,y:p.y+g+a+u/2+at(c,s)},p.enoughShowCurrentLabel=!0):2*u/3<r/2-a&&o<i-2*l&&(p.currentValuePoint={x:p.x,y:p.y+2*a+u},p.enoughShowCurrentLabel=!0):u<b-a&&o<i-2*l&&(p.currentValuePoint={x:p.x,y:p.y+u},p.enoughShowCurrentLabel=!0)):(d=E(i/2*w),v=E(r*w),g=ot(d,m=h?v/2:v),p={x:n+i/2,y:e+r/2+(h?0:g/2),outerRadius:g,innerRadius:g*t.radiusRatio}),p}function Yn(t,n,e,i){return{x:t+I(e)*i,y:n+_(e)*i}}function Zn(t,n){return ut(n.x-t.x)<.01?{x:n.x,y:n.y,textAlign:U}:n.x>t.x?{x:n.x+a,y:n.y,textAlign:P}:n.x<t.x?{x:n.x-a,y:n.y,textAlign:G}:{x:n.x,y:n.y,textAlign:P}}function Wn(n,t,e,i,r,o,a){var u,s,e,i,c,f,a,l,h,d,v,m,v,g,v,v,s,p,b,w,y,M,C,S,T,A,a,C,M,w,a,p,C,y,M,b,S,w,u=a.zoomFactor,s=!!it(t.showLabel)||t.showLabel,e=zn(t,e,i,r,o,a,s);if(!(e.outerRadius<=0))return i={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},c=e.innerRadius,f=e.outerRadius,a=e.currentValuePoint,l=e.moreThanSemiCircle,h={x:e.x,y:e.y},v=(d=Vn(t)).paintRanges,m=d.fillColor,n.save(),v.forEach(function(t){n.beginPath(),n.strokeStyle=x,n.moveTo(h.x,h.y),n.fillStyle=t.color||m,n.arc(h.x,h.y,f,t.start,t.end,!1),n.lineTo(h.x,h.y),n.closePath(),n.fill(),n.stroke(),n.beginPath(),n.fillStyle=x,n.strokeStyle=x,n.moveTo(h.x,h.y),n.arc(h.x,h.y,c,t.start-kt,t.end+kt,!1),n.lineTo(h.x,h.y),n.closePath(),n.fill(),n.stroke()}),n.beginPath(),n.moveTo(h.x,h.y),n.fillStyle=Z,n.arc(h.x,h.y,f*O,0,2*nt,!1),n.fill(),v=Yn(h.x,h.y,d.targetValueRadian,c),g=Yn(h.x,h.y,d.targetValueRadian,f*L),Ht(n,v.x,v.y,g.x,g.y,At,It,N),v=Yn(h.x,h.y,d.currentValueRadian,f*L),H(n,h.x,h.y,v.x,v.y,Z,R*f),s&&(n.save(),n.beginPath(),n.textAlign=j,n.fillStyle=N,v=t.minValueOption.normalFontHeight*u,s=t.maxValueOption.normalFontHeight*u,p=t.minValueOption.normalFontWidth*u,b=t.maxValueOption.normalFontWidth*u,w=d.minValueRadian,y=d.maxValueRadian,M=t.currentValueOption.normalFontHeight*u,C=t.currentValueOption.normalFontWidth*u,A=T=S=void 0,e.enoughShowCurrentLabel&&(k(n,a.x,a.y,t.currentValueOption.label,t.currentValueOption.fontAfterZoom,U),i.showCurrentLabel=!0,S={x:a.x-C/2,y:a.y-M,width:C,height:M}),e.enoughShowMinLabel&&ut(I(w)*f)+p<r/2-Nt&&(a=Yn(h.x,h.y,d.minValueRadian,f),tn(T={x:(C=Zn(h,a)).x-p,y:C.y,width:p,height:v},S)||(k(n,C.x,C.y+E(v),t.minValueOption.label,t.minValueOption.fontAfterZoom,G),i.showMinLabel=!0)),e.enoughShowMaxLabel&&ut(I(y)*f)+b<r/2-Nt&&(M=Yn(h.x,h.y,d.maxValueRadian,f),tn(A={x:(w=Zn(h,M)).x,y:w.y,width:b,height:s},S)||(k(n,w.x,w.y+E(s),t.maxValueOption.label,t.maxValueOption.fontAfterZoom,P),i.showMaxLabel=!0)),e.enoughShowTargetLabel&&(a=t.targetValueOption.normalFontWidth*u,p=t.targetValueOption.normalFontHeight*u,C=t.targetValueOption.label,g=Yn(h.x,h.y,d.targetValueRadian,y=f+3*p/2),M=Zn(h,g),b=d.targetValueRadian,S=l?(o-2*y)/2+y:o-(o-f)/2,ut(I(b)*y)+a<r/2-Nt)&&ut(_(b)*y)+p/2+Nt/2<S&&(w=at(v,s)/2,k(n,M.x,M.y-(nt<b?w:-w),C,t.targetValueOption.fontAfterZoom,M.textAlign),i.showTargetLabel=!0),n.restore()),n.restore(),i}function Qn(t,n,e,i,r,o){var o,a,u,s,c,f,l,h,d,t,v,m,o,n,o=o.zoomFactor,a=t.showLabel,u=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,c=t.targetValueOption.normalFontHeight*o,f=t.currentValueOption.normalFontHeight*o,l=t.minValueOption.normalFontWidth*o,h=t.maxValueOption.normalFontWidth*o,d=t.targetValueOption.normalFontWidth*o,t=t.currentValueOption.normalFontWidth*o,o=.05*i,v=E(r*p),m=E(i*b),n={x:n+i*(1-b)/2,y:e+r*(p+(1-p)/2),graphWidth:m,graphHeight:v,targetValuePoint:B,currentValuePoint:B,minValuePoint:B,maxValuePoint:B};return a&&(u<(r-v)/2&&l<(i-m)/2-o&&(n.minValuePoint={x:n.x-l,y:n.y+u/3},n.enoughShowMinLabel=!0),s<(r-v)/2&&h<(i-m)/2-o&&(n.maxValuePoint={x:n.x-h,y:n.y-v+s/3},n.enoughShowMaxLabel=!0),(c<(r-v)/2||c/2<v)&&d<(i-m)/2-o-at(l,h)&&(n.targetValuePoint={x:n.x-d-at(l,h),y:B},n.enoughShowTargetLabel=!0),f<(r-v)/2||f/2<v)&&t<(i-m)/2-o&&(n.currentValuePoint={x:n.x+m+o,y:B},n.enoughShowCurrentLabel=!0),n}function Jn(t,n){var e,i,r,o,a,u,s,c,e=t.minValueOption.value,i=t.maxValueOption.value,r=t.ranges,o=g,a=n.graphHeight/(i-e),u=[];return 0<r.length&&r.forEach(function(t){s=t.start,c=t.end,u.push({start:n.y-a*(s-e),height:a*(c-s),color:t.color})}),u.unshift({start:n.y,height:n.graphHeight,color:o}),{paintRanges:u,fillColor:o,targetValueY:n.y-a*(t.targetValueOption.value-e),currentValueY:n.y-a*(t.currentValueOption.value-e)}}function Kn(n,t,e,i,r,o,a){var u,s,c,f,l,h,e,d,r,a,v,m,g,p,b,t,w,y,M,C,S,u=a.zoomFactor,s=t.showLabel,c=t.minValueOption,f=t.maxValueOption,l=t.currentValueOption,h=t.targetValueOption,e=Qn(t,e,i,r,o,a),d=e.graphWidth,r=e.graphHeight;if(!(d<=0||r<=0))return a={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},v=e.currentValuePoint,m=e.targetValuePoint,g=e.minValuePoint,p=e.maxValuePoint,b={x:e.x,y:e.y},w=(t=Jn(t,e)).paintRanges,y=l.normalFontHeight*u,M=h.normalFontHeight*u,C=t.targetValueY,S=t.currentValueY,n.save(),w.forEach(function(t){gt(n,b.x,t.start,d,-t.height,t.color)}),Ht(n,b.x-(L-1)*d,C,b.x+d,C,At,It,N),H(n,b.x,S,b.x+d*L,S,Z,Tt*r),s&&(n.save(),n.beginPath(),e.enoughShowMinLabel&&(k(n,g.x,g.y,c.label,c.fontAfterZoom,P,N),a.showMinLabel=!0),e.enoughShowMaxLabel&&(k(n,p.x,p.y,f.label,f.fontAfterZoom,P,N),a.showMaxLabel=!0),e.enoughShowTargetLabel&&!(o<C-i+M/2||C-i-xt<0)&&(k(n,m.x,t.targetValueY+h.normalFontHeight*u/3,h.label,h.fontAfterZoom,P,N),a.showTargetLabel=!0),e.enoughShowCurrentLabel&&!(o<S-i+y/2||S-i-xt<0)&&(k(n,v.x,t.currentValueY+l.normalFontHeight*u/3,l.label,l.fontAfterZoom,P,N),a.showCurrentLabel=!0),n.restore()),n.restore(),a}function Xn(t,n,e,i,r,o){var o,a,u,s,c,f,l,h,d,t,v,m,o,n,o=o.zoomFactor,a=t.showLabel,u=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,c=t.targetValueOption.normalFontHeight*o,f=t.currentValueOption.normalFontHeight*o,l=t.minValueOption.normalFontWidth*o,h=t.maxValueOption.normalFontWidth*o,d=t.currentValueOption.normalFontWidth*o,t=t.targetValueOption.normalFontWidth*o,o=.1*ot(i,r),v=E(r*b),m=E(i*p),n={x:n+i*(1-p)/2,y:e+r*(1-b)/2,graphWidth:m,graphHeight:v,targetValuePoint:B,currentValuePoint:B,minValuePoint:B,maxValuePoint:B};return a&&((d<3*(i-m)/4||d<m)&&f<(r-v)/2-Nt&&(n.currentValuePoint={x:B,y:n.y-f/2},n.enoughShowCurrentLabel=!0),(t<3*(i-m)/4||t<m)&&c<(r-v)/2-at(u,s)&&(n.targetValuePoint={x:B,y:n.y+v+at(u,s)+c/4*3},n.enoughShowTargetLabel=!0),l<3*(i-m)/4&&u<(r-v)/2-o&&(n.minValuePoint={x:n.x-l/2,y:n.y+v+u},n.enoughShowMinLabel=!0),h<3*(i-m)/4)&&s<(r-v)/2-o&&(n.maxValuePoint={x:n.x+m-h/2,y:n.y+v+s},n.enoughShowMaxLabel=!0),n}function qn(t,n){var e,i,r,o,a,u,s,c,e=t.minValueOption.value,i=t.maxValueOption.value,r=t.ranges,o=g,a=n.graphWidth/(i-e),u=[];return 0<r.length&&r.forEach(function(t){s=t.start,c=t.end,u.push({start:n.x+a*(s-e),width:a*(c-s),color:t.color||o})}),u.unshift({start:n.x,width:n.graphWidth,color:o}),{paintRanges:u,fillColor:o,targetValueX:n.x+a*(t.targetValueOption.value-e),currentValueX:n.x+a*(t.currentValueOption.value-e)}}function $n(n,t,e,i,r,o,a){var u,s,c,f,l,h,i,o,d,a,v,m,g,p,b,t,w,y,M,C,t,u=a.zoomFactor,s=t.showLabel,c=t.minValueOption,f=t.maxValueOption,l=t.currentValueOption,h=t.targetValueOption,i=Xn(t,e,i,r,o,a),o=i.graphWidth,d=i.graphHeight;if(!(o<=0||d<=0))return a={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},v=i.currentValuePoint,m=i.targetValuePoint,g=i.minValuePoint,p=i.maxValuePoint,b={x:i.x,y:i.y},w=(t=qn(t,i)).paintRanges,y=l.normalFontWidth*u,M=h.normalFontWidth*u,C=t.targetValueX,t=t.currentValueX,n.save(),w.forEach(function(t){gt(n,t.start,b.y,t.width,d,t.color)}),Ht(n,C,b.y,C,b.y+d*L,At,It,N),Ut(n,t,b.y+d-1,t,b.y-d*(L-1)-1,Z,o*Tt),s&&(n.save(),i.enoughShowMinLabel&&(k(n,g.x,g.y,c.label,c.fontAfterZoom,P,N),a.showMinLabel=!0),i.enoughShowMaxLabel&&(k(n,p.x,p.y,f.label,f.fontAfterZoom,P,N),a.showMaxLabel=!0),i.enoughShowTargetLabel&&!(r<C-e+M/2+S||C-e-M/2-S<0)&&(k(n,C-h.normalFontWidth*u/2,m.y,h.label,h.fontAfterZoom,P,N),a.showTargetLabel=!0),i.enoughShowCurrentLabel&&!(r<t-e+y/2+S||t-e-y/2-S<0)&&(k(n,t-l.normalFontWidth*u/2,v.y,l.label,l.fontAfterZoom,P,N),a.showCurrentLabel=!0),n.restore()),n.restore(),a}function te(t,n,e,i,r,o,a){t.save(),t.rect(e,i,r,o),t.clip(),0===n.gaugeType?Wn(t,n,e,i,r,o,a):1===n.gaugeType?Kn(t,n,e,i,r,o,a):2===n.gaugeType&&$n(t,n,e,i,r,o,a),t.restore()}function ne(t,n,e,i,r,o,a,u){var s,c,f,a,l,h,d,v,m,g,s=[],c=t.length,f=0,a=a.fontPixelSize;if(o&&(f=a+3),0!==c){for(l=i/c,h=t[0].value,d=1;d<c;d++)h=Math.max(h,t[d].value);for(v=0;v<c;v++)g=t[v].value/h*(r-f),s.push({x:n+v*l+l*(1-u)/2,textX:n+v*l,y:(m=e+r-f)-(g=g<0?0:g),width:l*u,textWidth:l,height:g,axis:t[v].axis})}return s}function ee(t,n,e,i){t.save(),t.fillStyle=e;for(var r=0;r<n.length;r++)t.fillRect(n[r].x,n[r].y,n[r].width,n[r].height);t.restore()}function ie(t,n,e,i){var r,o,a,u,s;for(t.save(),r=e.fontPixelSize,o=ue(e),t.textAlign="center",t.fillStyle=i,a=0;a<n.length;a++)s=u=void 0,u=n[a].x+n[a].width/2,s=n[a].y+n[a].height+5+r,t.save(),t.font=o,t.beginPath(),t.rect(n[a].textX,n[a].y+n[a].height+1,n[a].textWidth,r+3),t.clip(),t.textBaseline="bottom",t.fillText(n[a].axis,u,s),t.restore();t.restore()}function re(t,n,e,i){var r,o,a,u,s,o;if("none"!==i){for(t.save(),t.lineWidth=1,t.strokeStyle=i,t.beginPath(),r=0;r<n.length;r++)a=(o=n[r]).x,u=o.y,s=o.width,0===(o=o.height)||0===s||(H(t,a,u,a+s,u),H(t,a,u+o,a+s,u+o),n[r-1]&&n[r-1].height>=o&&1===e||H(t,a,u,a,u+o),n[r+1]&&n[r+1].height>o&&1===e)||H(t,a+s,u,a+s,u+o);t.stroke(),t.closePath(),t.restore()}}function oe(t,n,e,i,r){var o,a,u,s,c,f,o=!1;for(t.save(),t.font=r,u=(e-6)/(a=n.length),s=0,c=n;s<c.length;s++)if(f=c[s],t.measureText(f.axis).width>u){o=!0;break}return t.restore(),o}function ae(t,n,e,i,r,o,a){var u,s,c,f,l,h,d,n,v,e,i,u=n.barColor,s=n.values,c=n.paintLabel,f=n.barWidth,l=n.labelFontStyle,h=n.afterZoomFontStyle,d=n.edgeColor,n=n.labelColor;it(l)||(o<3*(v=h.fontPixelSize)||oe(t,s,r,o,ue(h)))&&(c=!1),ee(t,i=ne(s,e+3,i+3,r-6,o-6,c=c&&it(l)&&(e=Math.floor(12<=o/3?12:Math.floor(o/3)),h.fontPixelSize=e,h.fontSize=e+"px",oe(t,s,r,o,ue(h)))?!1:c,h,f),u,d),re(t,i,f,d),c&&ie(t,i,h,n)}function ue(t){return"".concat(t.fontStyle," ").concat(t.fontWeight," ").concat(t.fontSize," ").concat(t.fontFamily)}function se(t,n,e,i,r,o,a){var e,i,r,o,u,s,c,f,n;t.save(),t.rect(e,i,r,o),t.clip(),e=n.clipX,i=n.clipY,r=n.clipWidth,o=n.clipHeight,u=n.paintX,s=n.paintY,c=n.paintWidth,f=n.paintHeight,n=n.img,0<r&&0<o&&0<c&&0<f&&t.drawImage(n,e,i,r,o,u,s,c,f),t.restore()}function ce(t,n,e,i){this.X=t,this.Y=n,this.Width=e,this.Height=i,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height}function t(){this.Bzt=2,this.Lzt=o,this.Fzt=o,this.Pzt=lt,this.Gzt=-lt}i=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(l,"__esModule",{value:!0}),l.SparklineExRenders=l.SparklineRender=l.Uzt=l.Hzt=l.zzt=l.oCt=void 0,r=e("./src/common/util/types.ts"),h=e("./src/common/util/colorhelper.ts"),d=e("./src/common/util/arrayhelper.ts"),it=r.lt.ht,J=h.ft.YGt,v=h.ft._,m=d.Uf.hD,l.oCt={},rt=null,B=void 0,E=Math.floor,nt=Math.PI,_=Math.sin,I=Math.cos,ot=Math.min,at=Math.max,et=Math.round,D=Math.pow,V=Math.sqrt,ut=Math.abs,z=Math.ceil,F="undefined",st="string",ct=isNaN,ft=parseFloat,lt=Number.MAX_VALUE,o=new Date(""),bt="#969696",ht="#CB0000",wt="#646464",dt="#DCDCDC",x="white",Z="black",Y="blue",K="green",N="grey",X="red",g="lightgrey",P="left",G="right",U="center",q="top",$="bottom",tt="middle",j="start",yt="px Arial",Mt="-",Ct="+",St="=",O=.05,R=.03,L=1.06,Tt=.02,At=4,a=It=5,S=3,xt=10,Nt=8,p=.8,b=.25,w=.9,y=.7,M=.1,kt=1/45*nt,_t=Bt,i(rn,c=T=Lt),Dt=rn,jt="7ns",Ot="5ns",Et="tukey",Rt="bowley",Ft="sigma3",l.zzt=Wn,l.Hzt=Kn,l.Uzt=$n,C=ce,t.prototype.paint=function(t,n,e,i,r,o){var a,u,s,c,a=this;a.options=n,a.setting=n.settings,u=n.values,s=n.dateValues,c=n.zoomFactor,t.save(),t.rect(e,i,r,o),t.clip(),t.beginPath(),0===n.sparklineType&&a.c6(t,e,i,r,o,u,s,c),a.Vzt(t,e,i,r,o,u,s,c),a.Yzt(t,e,i,r,o,u,s,c),t.restore()},t.prototype.Zzt=function(t){return 0===this.options.sparklineType?3+this.Wzt(t)+1:3},t.prototype.Qzt=function(t,n){var e,i,r,o,a,a,u,s,c,f,e=this.Kzt;if(!e)if(e=this.Kzt=[],i=t.length,this.options.displayDateAxis){for(a=n.length,u=[],(u=0<(a=ot(i,a))?n.slice(0,a):u).sort(function(t,n){return t===n?0:(t=t===l.oCt?0:t)-(n=n===l.oCt?0:n)}),s=u.length,f=c=void 0,r=0;r<s;r++)if(typeof(c=u[r])!==F&&c!==rt){for(f=m(n,c);d.Uf.OS(e,f);)f=m(n,c,f+1);isNaN(c)||(o=t[f])!==B&&o!==rt&&isNaN(o)&&o!==l.oCt||e.push(f)}}else for(r=0;r<i;r++)typeof(o=t[r])!==F&&o!==rt&&isNaN(o)&&o!==l.oCt||e.push(r);return e},t.prototype.Sl=function(t,n){var n=n[t];return typeof n===F||n===rt?1===this.setting.options.displayEmptyCellsAs&&(n=0):n===l.oCt&&(n=0),n},t.prototype.c6=function(t,n,e,i,r,o,a,u){var s,c,f,l,h,d,v,m,g,p,b,g,w,y,M,C,S,T,s=this,c=s.Qzt(o,a),d=c.length-1;for(d<0&&(d=0),v=s.setting.options,m=s.linePos=[],y=v.displayEmptyCellsAs,f=0;f<d;f++)if(typeof(g=s.Sl(c[f],o))!==F&&g!==rt){if(typeof(p=s.Sl(c[b=f+1],o))===F||p===rt)if(1===y)p=0;else if(2===y)for(b=f+2;b<=d;b++)if(typeof(M=o[c[b]])!==F&&M!==rt){p=M;break}typeof p!==F&&p!==rt?(g=s.Jzt(c[f],{Width:i,Height:r},o,a,u),w=s.Jzt(c[b],{Width:i,Height:r},o,a,u),C=g.Width/2,l={X:g.X+C,Y:g.Y+C},h={X:w.X+C,Y:w.Y+C},m[f]={P1:l,P2:h}):f++}if(0<(S=m.length))for(t.strokeStyle=s.options.getColor(v.seriesColor),t.lineCap="round",t.lineWidth=s.Wzt(u),f=0;f<S;f++)(T=m[f])&&(t.beginPath(),l=T.P1,h=T.P2,t.moveTo(n+l.X,e+l.Y),t.lineTo(n+h.X,e+h.Y),t.stroke(),t.closePath())},t.prototype.Xzt=function(t,n,e){var i,r,o,a,u,e,s,c,f,l,n,i=this,r=i.options,o=i.setting.options,a=rt,u=i.Sl(t,n),e=i.Qzt(n,e),s=e.length,c=r.getColor.bind(i);return typeof u!==F&&u!==rt&&(i.Pzt!==lt&&i.Gzt!==-lt||i.qzt(n),u===i.Pzt&&o.showLow&&(a=c(o.lowMarkerColor)),typeof(a=u!==i.Gzt||!o.showHigh||typeof a!==F&&a!==rt?a:c(o.highMarkerColor))!==F&&a!==rt||(r.displayDateAxis?0===(f=m(e,t))&&o.showFirst&&(a=c(o.firstMarkerColor)):0===t&&o.showFirst&&(a=c(o.firstMarkerColor))),typeof a!==F&&a!==rt||(r.displayDateAxis?(l=m(e,t))===s-1&&o.showLast&&(a=c(o.lastMarkerColor)):t===s-1&&o.showLast&&(a=c(o.lastMarkerColor))),typeof(a=u<0&&o.showNegative&&(typeof a===F||a===rt)?c(o.negativeColor):a)!==F&&a!==rt||(0===(n=r.sparklineType)?o.showMarkers&&(a=c(o.markersColor)):1!==n&&2!==n||(a=c(o.seriesColor)))),a===B||a===rt?"Transparent":a},t.prototype.Vzt=function(t,n,e,i,r,o,a,u){for(var s,c,f,l,h,d,v,d,v,m,v,m,g,d,p,s=this,c={Width:i,Height:r},f=s.Qzt(o,a),l=f.length,h=s.options.sparklineType,p=0;p<l;p++)d=f[p],v=s.Xzt(d,o,a),d=s.Jzt(d,c,o,a,u),t.fillStyle!==v&&(t.fillStyle=v),0===h?(t.save(),v=n+d.X+d.Width/2,m=e+d.Y+d.Height/2,t.translate(v,m),t.rotate(45*nt/180),t.fillRect(0-d.Width/2,0-d.Height/2,d.Width,d.Height),t.restore()):(v=n+d.X+d.Width/4,v=E(v),m=e+d.Y,g=d.Width/2,d=d.Height,t.fillRect(v,m,g,d))},t.prototype.Yzt=function(t,n,e,i,r,o,a,u){var s,c,a,i,r,a,o,s,c,s=this,c=s.setting&&s.setting.options;c&&c.displayXAxis&&s.$zt(o,a)&&(a={Width:i,Height:r},i=s.Zzt(u),r=a.Width-s.Zzt(u),o=a=E(s.tVt(a,o,u))+.5,s=s.options.getColor(c.axisColor),(c=u)<1&&(c=1),t.strokeStyle!==s&&(t.strokeStyle=s),t.lineWidth!==c&&(t.lineWidth=c),t.beginPath(),t.moveTo(n+i,e+a),t.lineTo(n+r,e+o),t.stroke())},t.prototype.nVt=function(t){var n,t,n=this.eVt(t);return n===-lt||(t=this.iVt(t))===lt||n===t||n*t<=0},t.prototype.$zt=function(t,n){var e,i,r,o,a,u,e=this.nVt(t);if(2===this.options.sparklineType&&(r=(i=this.Qzt(t,n)).length,!e)&&0<r)for(u=0;u<r;u++)if(typeof(a=t[o=i[u]])!==F&&a!==rt)return!0;return e},t.prototype.rVt=function(t,n){var e=this.Lzt;return isNaN(e&&e.valueOf())&&this.oVt(t,n),this.Lzt},t.prototype.aVt=function(t,n){var e=this.Fzt;return isNaN(e&&e.valueOf())&&this.oVt(t,n),this.Fzt},t.prototype.oVt=function(t,n){for(var e,i,r,o,a,u,s,u,c,e=this,i=new Date(0,0,0),r=lt,o=e.Qzt(t,n),a=o.length,c=0;c<a;c++)s=n[u=o[c]],isNaN(s)||(u=e.Sl(u,t))!==rt&&typeof u===F||isNaN(u)||typeof s!==F&&s!==rt&&(i<s&&(i=s),s<r)&&(r=s);e.Fzt=i,e.Lzt=r},t.prototype.uVt=function(t,n,e,i){for(var r,o,a,u,s,c,f,l,h,d,v,m,g,n,r=this,o=r.rVt(n,e),a=r.aVt(n,e),u=[],l=r.Qzt(n,e),h=l.length,s=0;s<h;s++)(c=e[f=l[s]])&&!isNaN(c)&&u.push(c);if(u.sort(function(t,n){return t-n}),1<(d=u.length)&&o!==a){for(v=lt,g=void(m=0),s=1;s<d;s++)(c=(g=u[s])-u[s-1])<v&&0<c&&(v=c),m+=c;return n=(n=(t.Width-r.Zzt(i)-r.Zzt(i))*v/m/2)<2?2:n}return(t.Width-r.Zzt(i)-r.Zzt(i))/2},t.prototype.sVt=function(t,n,e,i){var r,n,r=this;return r.options.displayDateAxis?r.uVt(t,n,e,i):(n=r.Qzt(n,e).length,(t.Width-r.Zzt(i)-r.Zzt(i))/n)},t.prototype.cVt=function(t,n,e,i,r){var o,a,u,s,c,f,l,s,f,h,o=this,u=o.Zzt(r);return o.options.displayDateAxis?(a=o.sVt(t,e,i,r),(s=o.aVt(e,i))===(c=o.rVt(e,i))?u+a/2:(f=i[n])?(l=t.Width-u-o.Zzt(r),l-=a,s=s.valueOf()-c.valueOf(),u+E((f.valueOf()-c.valueOf())/s*l)):0):(a=o.sVt(t,e,i,r),f=m(o.Qzt(e,i),n),E(h=u+a*f))},t.prototype.fVt=function(t,n){var e,i,t,e=this,i=t.Width-e.Zzt(n)-e.Zzt(n);return i=at(i,0),t=t.Height-e.Zzt(n)-e.Zzt(n),{Width:i,Height:t=at(t,0)}},t.prototype.qzt=function(t){for(var n,e,i,r,n=this,e=t.length,r=0;r<e;r++)typeof(i=t[r])!==F&&i!==rt&&((i="number"!=typeof i?0:i)<n.Pzt&&(n.Pzt=i),i>n.Gzt)&&(n.Gzt=i)},t.prototype.eVt=function(t){var n,t,e,n=this;return n.Gzt!==-lt&&n.Gzt||n.qzt(t),0===(e=(t=n.setting.options).maxAxisType)?n.Gzt:1===e?t.groupMaxValue:2===e?t.manualMax:n.Gzt},t.prototype.iVt=function(t){var n,t,e,n=this;return n.Pzt!==lt&&n.Pzt||n.qzt(t),0===(e=(t=n.setting.options).minAxisType)?n.Pzt:1===e?t.groupMinValue:2===e?t.manualMin:void 0},t.prototype.lVt=function(t,n,e,i){var t=this.fVt(t,i),i=this.eVt(e),r=this.iVt(e),o=i-r,a,u;if(i===r){if(0===i)return 0;o=ut(i)}return(a=(a=e[n])||0)*(u=t.Height/o)},t.prototype.hVt=function(t,n,e,i){var r,o,a,o,o,r=this,o=r.options.sparklineType;if(0===o)return r.lVt(t,n,e,i);if(1!==o)return 2===o?typeof(a=e[n])===F||a===rt||0===a||isNaN(a)?0:(o=r.fVt(t,i),0<=a?o.Height/2:-o.Height/2):void 0;if(a=e[n],1===r.setting.options.displayEmptyCellsAs&&(typeof a===F||a===rt))return 0;if((o=r.lVt(t,n,e,i))>-r.Bzt&&o<r.Bzt){if(0<a)return o+r.Bzt;if(a<0)return o-r.Bzt}return o},t.prototype.dVt=function(t,n,e){var i,r,o,n,a,n,i=this,r=i.fVt(t,e),o=i.eVt(n),n=i.iVt(n);if(o===-lt||n===lt)return t.Height/2;if(a=o-n,o===n){if(0===o)return t.Height/2;(a=o)<0&&(o=0)}return n=r.Height/a,i.Zzt(e)+o*n},t.prototype.tVt=function(t,n,e){return 2===this.options.sparklineType?t.Height/2:this.dVt(t,n,e)},t.prototype.vVt=function(t,n,e,i){var r,t,i,o,a,t,a,u,r=this,t=r.fVt(t,i),i=r.eVt(e),o=r.iVt(e),a=i-o;if(i===o){if(0===i)return 0;a=i}return t=t.Height/a,typeof(a=r.Sl(n,e))!==F&&a!==rt||(a=0),i!==o&&0<i*o?(u=0)<=a?(a-o)*t:(a-i)*t:a*t},t.prototype.mVt=function(t,n,e,i){var r,o,a,u,s,r=this,o=r.options.sparklineType;return 0===o?r.vVt(t,n,e,i):1===o?(a=r.vVt(t,n,e,i),-(u=r.Bzt)<a&&a<u&&0!==(s=typeof(s=r.Sl(n,e))!==F&&s!==rt?s:0)?0<s?a+u:a-u:a):2===o?r.hVt(t,n,e,i):void 0},t.prototype.gVt=function(t,n,e,i,r){var o,a,i,u,s,c,f,c,f,s,t,e,o=this,a=o.sVt(n,e,i,r),i=o.cVt(n,t,e,i,r);return(a=E(a=a<0?0:a))%2==1&&(a+=1),u=o.hVt(n,t,e,r),s=o.tVt(n,e,r),c=o.eVt(e),f=o.iVt(e),c=c<(c=0)&&f<0?at(o.Zzt(r),s):0<=u?s-u:s,f=o.mVt(n,t,e,r),s=new C(i,c,a,ut(f)),0!==u&&(t=o.Zzt(r),s.Y<t&&s.Bottom<t+1?s.Height=E(s.Height+1):(e=n.Height-o.Zzt(r),s.Bottom>e&&s.Y>e-1&&(s.Y=e-f,s.Height=f))),s},t.prototype.Wzt=function(t){var t=this.setting.options.lineWeight*t;return t=t<1?1:t},t.prototype.Jzt=function(t,n,e,i,r){var o,a,i,r,t,u,e,o=this,a=o.Wzt(r);return++a<2&&(a=2),i=o.gVt(t,n,e,i,r),0===o.options.sparklineType&&(i.X=i.X+(i.Width-a)/2,typeof(r=o.Sl(t,e))!==F&&r!==rt?(0<=r?i.Y-=a/2:i.Y=i.Bottom-a/2,i.Width=a,i.Height=a):(i.Width=0,i.Height=0)),o.setting.options.rightToLeft&&(t=i.X,e=(u=n.Width-t)-i.Width,i=new C(e,i.Y,i.Width,i.Height)),i},l.SparklineRender=t,l.SparklineExRenders={PIESPARKLINE:nn,AREASPARKLINE:un,SCATTERSPARKLINE:cn,BULLETSPARKLINE:vn,SPREADSPARKLINE:mn,STACKEDSPARKLINE:wn,HBARSPARKLINE:Tn,VBARSPARKLINE:An,VARISPARKLINE:In,LOLLIPOPVARISPARKLINE:xn,BOXPLOTSPARKLINE:Nn,CASCADESPARKLINE:jn,PARETOSPARKLINE:On,MONTHSPARKLINE:Gn,YEARSPARKLINE:Hn,GAUGEKPISPARKLINE:te,HISTOGRAMSPARKLINE:ae,IMAGESPARKLINE:se}},canvas:function(t){t.exports=canvas}},i={},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.Slicers=n.Sparklines=n.Formatter=n.Commands=n.Common=void 0,r=o("./src/common/common.entry.ts"),n.Common=r,r=o("./src/plugins/commands/commands.entry.ts"),n.Commands=r,r=o("./src/plugins/formatter/formatter.entry.ts"),n.Formatter=r,r=o("./src/plugins/sparkline/sparkline.entry.ts"),n.Sparklines=r,r=o("./src/plugins/slicer/slicer.entry.ts"),n.Slicers=r,(a={}).Spread=t}(),t.exports=a.Spread},"./node_modules_local/@spreadjs/js-sheets-common/index.js":function(t,n,e){t.exports=e("./node_modules_local/@spreadjs/js-sheets-common/dist/gc.spread.common.js")},DataManager:function(t){"use strict";t.exports=GC.Data},Common:function(t){"use strict";t.exports=GC.Spread},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Core:function(t){"use strict";t.exports=GC.Spread.Sheets},Bindings:function(t){"use strict";t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},CellTypes:function(t){"use strict";t.exports=GC.Spread.Sheets.CellTypes},ConditionalFormatting:function(t){"use strict";t.exports=GC.Spread.Sheets.ConditionalFormatting},ContextMenu:function(t){"use strict";t.exports=GC.Spread.Sheets.ContextMenu},Filters:function(t){"use strict";t.exports=GC.Spread.Sheets.Filter},Sparkline:function(t){"use strict";t.exports=GC.Spread.Sheets.Sparklines},Touch:function(t){"use strict";t.exports=GC.Spread.Sheets.Touch},canvas:function(t){"use strict";t.exports=canvas}},i={},t=r("./all.entry.js"),(GC=void 0===GC?{}:GC).Spread=t}(),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&define.amd?define("@grapecity/spread-sheets",[],function(){return t}):"object"==typeof exports&&(exports.Spread=t.Spread)}(GC||{});